self.window=self,window.jsExecStartTimeStamp=Date.now(),(self.webpackChunk_tencent_alloy_builder=self.webpackChunk_tencent_alloy_builder||[]).push([["bundle_coresheet_lazy"],{"../core-sheet/js/lazy/modules.js":function(e,t,n){n.r(t),n.d(t,{app:function(){return O},component:function(){return q},config:function(){return B},network:function(){return R},other:function(){return A},util:function(){return Z}}),n("../node_modules/regenerator-runtime/runtime.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.promise.js"),n("../node_modules/core-js/modules/es.promise.finally.js");var o=n("../node_modules/i18next/dist/esm/i18next.js"),i=n("../node_modules/@tencent/dui/lib/components/Modal/index.js"),r=n("../node_modules/@tencent/docs-user-agent/dist/index.js"),s=n.n(r),a=n("../packages/common-utils/src/client/url.ts"),c=n("../packages/utils/src/safe.ts"),d=n("../spread-sheet/src/base/storage/storage.ts"),u=n("../spread-sheet/src/core/ui/toast/toast.tsx"),l=n("../spread-sheet/src/core/ui/toast/index.ts"),f=n("../spread-sheet/src/core/ark-extensions/extensions/size-limit-dialog.ts"),h=n("../spread-sheet/src/external/view/workbench/service/show-dialog.ts"),p=n("../spread-sheet/src/core/data/configService/spreadConfig.ts"),m=n("../spread-sheet/src/base/util/appConfig.ts"),g=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function s(e){try{c(o.next(e))}catch(t){r(t)}}function a(e){try{c(o.throw(e))}catch(t){r(t)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((o=o.apply(e,t||[])).next())}))},w=s().isMobilePhone||s().isAndroidPad||s().isIPad,v=s().isTencentDocsApp&&s().isTencentDocsAppVersionAboveOrEqual("2.2.0"),x="https://"+m.Z.getConfig("runtime.domainName")+"/desktop/trash",C="https://"+m.Z.getConfig("runtime.domainName")+"/desktop/m/trash",_=new(function(){function e(){var e=this;this.hasClicked=!1,this.fromTrash=!1,this.hasInited=!1,this.errorFun=function(t){void 0===t&&(t={}),e.hasClicked=!1;var n=o.ZP.t("还原文件失败，请重试{{value}}。",{value:t.retcode?" ("+t.retcode+")":""});if(w)(0,u.showToast)(n,{},{toastType:"typeWarning"});else{var i=document.querySelector(".dui-modal-visible");(0,u.showToast)(n,{top:"20px"},{toolToastCloseTime:5e3},i)}},this.hide=function(){var t;null===(t=e.dialogInstance)||void 0===t||t.close()}}var t=e.prototype;return t.start=function(){var e=(0,a.IZ)("fromTrash");if(e){var t=document.location.href;t=(0,a.oW)(t,"fromTrash"),history.replaceState(null,"",t),"1"===e&&this.setFromTrash(!0)}2===p.q.getConfig("docStatus")&&this.show()},t.hasClickedRecover=function(){return this.hasClicked},t.show=function(){this.hasInited||(this.bindEvents(),this.hasInited=!0,this.hasClicked=!1),this.showDialog()},t.showDialog=function(){var e=this;this.dialogInstance=i.default.confirm({title:o.ZP.t("提示"),content:o.ZP.t("回收站中的文档不能编辑，如要使用请还原文档。"),okText:o.ZP.t("还原"),cancelText:o.ZP.t("取消"),onClose:function(){e.handleDialogCancel()},onOk:function(){return g(e,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.handleDialogOk();case 2:case"end":return e.stop()}}),e,this)})))},onCancel:function(){e.handleDialogCancel()}})},t.handleDialogOk=function(){var e=this,t=p.q.getConfig("domainId"),n=p.q.getConfig("padId");return this.hasClicked=!0,new Promise((function(i){$.ajax({url:"/cgi-bin/online_docs/doc_recover",type:"POST",data:{domain_id:t,pad_id:n,xsrf:(0,c.f)()},success:function(r){var s,a=e.handleResponse(r),c=a?{retcode:a.retcode}:void 0;if(0!==(null===c||void 0===c?void 0:c.retcode))return 20010===a.retcode?((0,h.S)(f.iR.SIZE_LIMIT_RECOVER_OWNER,f.C2.OWNER_RECOVER,!0),!1):20013===a.retcode?((0,h.S)(f.iR.SIZE_LIMIT_RECOVER_COLLABOR,f.C2.COLLABOR_RECOVER,!0),!1):(e.isNormalUserExceedTimeLimit(a)?(0,l.showVipToast)({errorCode:a.retcode}).then((function(t){t?e.hide():e.errorFun(c)})).catch((function(){e.errorFun(c)})):e.errorFun(c),void i(!1));if(e.handleSuccess(),null===(s=a.folder_info)||void 0===s?void 0:s.folder_id){var d=o.ZP.t("还原成功");w?(0,u.showToast)(d,{},{toastType:"typeSuccess"}):(0,u.showToast)(d,{},{toolToastCloseTime:2e3})}e.handleExtra(t,n,a),setTimeout(e.reloadForce,2e3),e.hide(),i(!0)},error:function(t){e.errorFun(t),i(!1)}})}))},t.handleSuccess=function(){var e=o.ZP.t("还原成功");w?(0,u.showToast)(e,{},{toastType:"typeSuccess"}):(0,u.showToast)(e,{},{toolToastCloseTime:2e3})},t.handleExtra=function(e,t,n){var o;this.fromTrash&&(0,d.G)("RECOVER",{domainId:e,localPadId:t,padType:p.q.getConfig("docType"),title:p.q.getConfig("title"),url:p.q.getConfig("shortLink"),list_item_type:1,parent_folder_id:null===(o=n.folder_info)||void 0===o?void 0:o.folder_id})},t.handleResponse=function(e){var t=e;if("string"===typeof e)try{t=JSON.parse(e)}catch(n){t={}}return t},t.handleErrorCase=function(e){var t=this;return!(!e||0!==e.retcode)||((0,l.showVipToast)({errorCode:e.retcode}).then((function(e){e&&t.hide()})).finally((function(){t.errorFun(e?{retcode:e.retcode}:void 0)})),!1)},t.isNormalUserExceedTimeLimit=function(e){return e&&110805===e.retcode},t.handleDialogCancel=function(){var e;if(w){if(v)return void(null===(e=n.g.mqq)||void 0===e||e.invoke("QQApi","jumpNativeList",{target:"Trash"},(function(e){})));this.goBackAdaptor()}else n.g.location.href=x},t.goBackAdaptor=function(){var e,t,o;s().isMiniProgram?null===(e=n.g.wx)||void 0===e||e.miniProgram.navigateBack():this.fromTrash&&(null===(t=n.g.mqq)||void 0===t?void 0:t.ui)&&"0"!==(null===(o=n.g.mqq)||void 0===o?void 0:o.QQVersion)?n.g.mqq.ui.popBack():s().isIPad?n.g.location.href=x:n.g.location.href=C},t.setFromTrash=function(e){this.fromTrash=e},t.bindEvents=function(){var e=this;document.addEventListener("visibilitychange",(function(){e.start()}))},t.reloadForce=function(){n.g.location.reload()},e}()),b=n("../spread-sheet/src/base/event/event.ts"),y=new(function(){function e(){this.isUserDeleting=!1}var t=e.prototype;return t.initAfterCanvas=function(){_.start(),this.registerEvent()},t.getExport=function(){return{}},t.registerEvent=function(){var e=this;b.ZP.network.listen("deletePad",(function(){e.handleDelete()})),b.ZP.sheetStatus.listen("userDeletePad",(function(){e.isUserDeleting=!0})),b.ZP.sheetStatus.listen("userDeletePadFailed",(function(){e.isUserDeleting=!1}))},t.handleDelete=function(){var e,t;_.hasClickedRecover()||(this.isUserDeleting&&((null===(e=null===window||void 0===window?void 0:window.tdocs)||void 0===e?void 0:e.closeWindow)?null===(t=null===window||void 0===window?void 0:window.tdocs)||void 0===t||t.closeWindow():window.close()),window.location=window.location,window.location.reload(!0))},e}()),I=(n("../node_modules/core-js/modules/es.regexp.exec.js"),n("../node_modules/core-js/modules/es.string.split.js"),n("../node_modules/core-js/modules/es.string.search.js"),n("../node_modules/core-js/modules/es.object.assign.js"),n("../packages/common-utils/src/index.ts")),T=n("../packages/report/src/index.ts"),E=(n("../node_modules/core-js/modules/es.function.name.js"),n("../node_modules/core-js/modules/es.regexp.to-string.js"),function(){function e(){this.hasInit=!1,this.interfaceMap={},this.ExecuteJs=this.ExecuteJs.bind(this),this.registerInterface=this.registerInterface.bind(this),this.ExecuteClient=this.ExecuteClient.bind(this)}var t=e.prototype;return t.init=function(){this.registerInterface("setShareInfo","1.0.2","data","TIM",(function(){})),this.registerInterface("EditBarUndo","2.0.0","web","TIM",this.onEditBarUndo),this.registerInterface("EditBarRedo","2.0.0","web","TIM",this.onEditBarRedo),this.registerInterface("EditBarDone","2.0.0","web","TIM",this.onEditBarDone),this.registerInterface("setCellValue","1.0.2","web","TIM",this.onSetCellValue),this.registerInterface("ClientInputDone","2.0.0","web","TIM",this.onClientInputDone),this.registerInterface("ClientInputBegin","2.0.0","web","TIM",this.onClientInputBegin),this.registerInterface("sharedDocSheetCommitCellValue","1.0.2","ui","TIM",(function(){})),this.registerInterface("getKeyboardHeight","2.0.0","docx","TIM",(function(){})),this.registerInterface("setDismissWhenBack","2.0.0","docx","TIM",(function(){})),this.registerInterface("setCreateNewPadAndLoaded","2.0.0","docx","TIM",(function(){})),this.registerInterface("setSharedDocInputBarCellValue","1.0.2","ui","TIM",(function(){})),this.registerInterface("setEditToolBarDisplay","2.0.0","docx","TIM",(function(){})),this.registerInterface("setClipboardContent","2.0.0","docx","TIM",this.onSetClipboardContent),this.registerInterface("getClipboardContent","2.0.0","docx","TIM",this.onGetClipboardContent),this.registerInterface("setCellValue","6.7.0","web","QQ",this.onSetCellValue),this.registerInterface("sharedDocSheetCommitCellValue","6.7.0","ui","QQ",(function(){})),this.registerInterface("setSharedDocInputBarCellValue","6.7.0","ui","QQ",(function(){})),this.registerInterface("setKeyBoardStatus","2.0.0","docx","TIM",(function(){})),this.registerInterface("getKeyBoardStatus","2.0.0","docx","TIM",(function(){})),this.hasInit=!0},t.ExecuteJs=function(e){var t,n,o,i,r,a,c,d,u;this.hasInit||this.init();var l=arguments.length;if(s().isTim&&window.SpreadsheetApp.sheetStatus.workbookStatus.canEdit)for(var f in u="TIM",this.interfaceMap[u])this.interfaceMap[u][f].name&&this.interfaceMap[u][f].name==e&&this.interfaceMap[u][f].version&&s().isTimVersionAboveOrEqual(this.interfaceMap[u][f].version)&&(l>1?null===(n=(t=this.interfaceMap[u][f]).callback)||void 0===n||n.call(t,arguments[1]):null===(i=(o=this.interfaceMap[u][f]).callback)||void 0===i||i.call(o));if(s().getQQVersion()&&window.SpreadsheetApp.sheetStatus.workbookStatus.canEdit){u="QQ";var h=arguments.length;for(var p in this.interfaceMap[u])this.interfaceMap[u][p].name&&this.interfaceMap[u][p].name==e&&this.interfaceMap[u][p].version&&s().isQQVersionAboveOrEqual(this.interfaceMap[u][p].version)&&(h>1?null===(a=(r=this.interfaceMap[u][p]).callback)||void 0===a||a.call(r,arguments[1]):null===(d=(c=this.interfaceMap[u][p]).callback)||void 0===d||d.call(c))}},t.ExecuteClient=function(e,t){var n;if(this.hasInit||this.init(),t=t||{},s().isTim&&window.SpreadsheetApp.sheetStatus.workbookStatus.canEdit)for(var o in n="TIM",this.interfaceMap[n])if(this.interfaceMap[n][o].name&&this.interfaceMap[n][o].name==e&&this.interfaceMap[n][o].version&&s().isTimVersionAboveOrEqual(this.interfaceMap[n][o].version)){a&&(this.interfaceMap[i][o].callback=a);var i=this.interfaceMap[i][o].module,r=this.interfaceMap[i][o].name,a=this.interfaceMap[i][o].callback;window.mqq&&mqq.invoke(i,r,t,a)}if(s().getQQVersion()&&window.SpreadsheetApp.sheetStatus.workbookStatus.canEdit)for(var c in n="QQ",this.interfaceMap[n])if(this.interfaceMap[n][c].name&&this.interfaceMap[n][c].name==e&&this.interfaceMap[n][c].version&&s().isQQVersionAboveOrEqual(this.interfaceMap[n][c].version)){l&&(this.interfaceMap[d][c].callback=l);var d=this.interfaceMap[d][c].module,u=this.interfaceMap[d][c].name,l=this.interfaceMap[d][c].callback;window.mqq&&mqq.invoke(d,u,t,l)}},t.registerInterface=function(e,t,n,o,i){if(e&&t&&n&&o){var r={name:e,version:t,module:n,from:o,callback:i||null};this.interfaceMap[o]||(this.interfaceMap[o]=[]),this.interfaceMap[o].push(r)}},t.onEditBarUndo=function(){window.useMobileCanvas&&this.newOnEditBarUndo()},t.onEditBarRedo=function(){window.useMobileCanvas&&this.newOnEditBarRedo()},t.onEditBarDone=function(){if(window.useMobileCanvas)this.newOnEditBarDone();else{var e=window.sheetNode.getHotInstance();this.ExecuteClient("setEditToolBarDisplay",{display:!1}),e.runHooks("DisAppearFtoverlays"),e.runHooks("clearRangeCache"),e.deselectCell(),e.docxState.changeStateToBrowse()}},t.onSetCellValue=function(e){if(window.useMobileCanvas)this.newOnSetCellValue(e);else{console.error(e);try{window.isExistIOSWebview=!0,e.row&&e.col&&window.sheetNode.setDataAtCell(e.row,e.col,e.value)}catch(t){alert(t.toString())}}},t.onGetClipboardContent=function(e){if(!window.useMobileCanvas){var t=window.sheetNode.getHotInstance(),n=e;n&&"text"==n.type&&n.content&&(t.runHooks("afterFtOverlaysPasteSuccess",n.content),this.ExecuteClient("setEditToolBarDisplay",{display:!0}),t.docxState.changeStateToSelected())}},t.onClientInputDone=function(){},t.onClientInputBegin=function(){},t.onGetSharedDocSheetInputBarContent=function(){},t.newOnSetCellValue=function(){},t.newOnEditBarUndo=function(){},t.newOnEditBarRedo=function(){},t.onSetClipboardContent=function(){},t.onGetSharedDocNativeKeyboardEnable=function(){},t.newOnClientInputDone=function(){},e}()),k=new E,j=n("../spread-sheet/src/base/util/deviceEnv/index.ts");n("../node_modules/core-js/modules/es.number.constructor.js"),n("../node_modules/core-js/modules/es.array.find.js");var S=n("../spread-sheet/src/core/login/utils.ts"),M=m.Z.getConfig("runtime.domainName");function P(e,t){var n=t;if((0,I.HD)(e))try{n=JSON.parse(e)}catch(o){}else(0,I.Kn)(e)&&(n=e);return n}var D={aiAutoColumnEnable:!1},O={init:y},R={manualInitAjax:function(){$(document).ready((function(){jQuery.ajaxPrefilter((function(e){e.url.indexOf(M)>-1&&(e.url+=e.url.indexOf("?")>-1?"&tag="+window.spreadConfig.getConfig("padId"):"?tag="+window.spreadConfig.getConfig("padId"))})),$.ajaxPrefilter((function(e){if(e.contentType){var t,n=document.cookie.split(/;\s+/).find((function(e){return"TOK"===e.split("=")[0]}));n&&(t=n.split("=")[1]),-1!=e.contentType.indexOf("json")?(e.data=e.data||"{}",e.data=JSON.stringify(Object.assign({},JSON.parse(e.data),{xsrf:t}))):-1!=e.contentType.indexOf("application/x-www-form-urlencoded")&&(e.data=e.data||"",-1==e.data.indexOf("xsrf=")&&(e.data+=(e.data?"&":"")+"xsrf="+t))}})),function(){var e=$.ajax;$.ajax=function(t){var n=t.success;return t.success=function(e){if(-1==this.url.indexOf("setRedDot"))if(this.url.indexOf("user_info")&&this.url.indexOf("only_check"))n&&n.apply(this,arguments);else{var t=e&&e.retcode,o=e&&e.ret,i=t||o;if((0,S.Xj)(i)){var r=this.url.split("?")[0];console.error("core-sheet onPskeyError("+r+") = "+i),b.ZP.loginEvent.trigger("pskeyError",r,i)}else n&&n.apply(this,arguments)}else n&&n.apply(this,arguments)},e.apply(this,arguments)}}(),function(){var e=$.ajax,t=[11e3,11005,11004,11007,11008,1e5,100001,100003,100004,100100,100101,100012,111111,99999,99992,1007,1e4,10001,30001,30002,30003,40001,40002,40003,40004,40005,40006,40035,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115];$.ajax=function(n){var o=Number(new Date),i=n.success||function(){},r=n.complete||function(){};return n.complete=function(e,t){var i=Number(new Date);if(r.call(n,e,t),T.ZP){if(n.url.indexOf("cgi-bin/appstage/mstats_batch_report")>-1)return;try{200===e.status||T.ZP.retcode({url:n.url,type:2,code:0===e.status?-999:e.status,time:i-o})}catch(s){}}},n.success=function(e,r,s){var a=Number(new Date);if(i.call(n,e,r,s),T.ZP){if(n.url.indexOf("cgi-bin/appstage/mstats_batch_report")>-1)return;try{if(e&&0===e.retcode)T.ZP.retcode({url:n.url,type:1,code:0,time:a-o});else{var c=-998;e&&e.retcode&&(c=e.retcode);var d=2;t.indexOf(c)>-1&&(d=3),T.ZP.retcode({url:n.url,type:d,code:c,time:a-o})}}catch(u){}}},e(n)}}()}))}},A={initAfterCanvas:function(){$(document.body).addClass("is-sheet"),$("#mainEditor").addClass("loaded");var e=window.spreadConfig.getConfig("tid");if(null==e||0==e||10001==e||20001==e||!window.spreadConfig.getConfig("newPad")||s().isMobilePhone||s().isAndroidPad||s().isIPad||($("#padAloneTitle").focus(),(0,u.showToast)("已从模板创建了新表格, 立即编辑体验吧。",{top:"125px"},{toolToastCloseTime:2e3})),window.spreadConfig.getConfig("newPad")){if("clone"===window.spreadConfig.getConfig("newPadType")){$("#padAloneTitle").focus(),(0,u.showToast)("生成副本成功",{top:"125px"},{toolToastCloseTime:2e3});try{var t=document.location.href.split("?")[0]+(0,I.oW)(window.location.search,["newPad","newPadType"])+window.location.hash;history.replaceState(null,null,t)}catch(o){}}(s().isMobilePhone||s().isAndroidPad||s().isIPad)&&(k.ExecuteClient("setDismissWhenBack",{shouldDismiss:1}),k.ExecuteClient("setCreateNewPadAndLoaded",{createdAndLoaded:!0}))}if(s().isMobilePhone||s().isAndroidPad||s().isIPad||(0,I.IZ)("previewtip")&&(0,u.showToast)("已生成腾讯文档，任何修改在云端保存，不会改变原文件。",{top:"5px"},{isNeedClose:!0}),(s().isMobilePhone||s().isAndroidPad||s().isIPad)&&(s().isMiniProgram||window.mqq&&"0"!==mqq.QQVersion||s().isWxWork)){var n=document.location.href;n=(0,I.oW)(n,"disableReturnList"),history.replaceState(null,null,n)}b.ZP.notificationCenter.listen("localChangeContentExcelEdit",(function(){if(!window.___hasReportUserEdit){var e=localStorage.getItem("tdsourcetag"),t={};(0,j.XJ)()>=0&&(t.source3=(0,j.XJ)()),t.ver11=function(){var e=window.SpreadsheetApp.spreadsheet.workbookRangeManager.protectedRangeMap;return!!e&&e.size>0}()?"range":"non_range",T.ZP.tdwReport(Object.assign({opername:"doc_core",module:"edit",action:"edit_text",source3:e||""},t));try{T.ZP.monitor(33635052),T.ZP.monitor(33635110)}catch(o){}window.___hasReportUserEdit=!0}})),"1"===(0,I.IZ)("qrpr")&&T.ZP.tdwReport({opername:"doc_pcview"+(localStorage&&localStorage.previewOpenFrom||"fromunknown"),module:"oper",action:"pre_ptlog_suc"})}},B={configurations:D,manulInitConfigurations:function(){$.ajax({url:"//"+m.Z.getConfig("runtime.domainName")+"/cgi-bin/online_docs/common_config",type:"POST",xhrFields:{withCredentials:!0},data:{keys:JSON.stringify(["ai_auto_column"])},success:function(e){var t={},n={};t=P(e,t),n=P(t.ai_auto_column,n),0===t.cgicode&&0===t.retcode&&1===n.status&&(D.aiAutoColumnEnable=!0)}})}},q={showToast:u.showToast,hideToast:u.hideToast},Z={isPortrait:I.gr}},"../spread-sheet/src/base/storage/storage.ts":function(e,t,n){function o(e,t){t.createdDate=+new Date;var n="docs_actions",o=function(e){if("undefined"!==typeof window.Storage)return localStorage.getItem(e)}(n);o=o&&JSON.parse(o)||[];var i={};o.forEach((function(e,t){var n=e.data;i[n.localPadId+"$"+n.domainId]={index:t,type:e.type,value:n}}));var r=i[t.localPadId+"$"+t.domainId];if(r){for(var s=0,a=Object.keys(t);s<a.length;s++){var c=a[s];r.value[c]=t[c]}o[r.index]={type:"ADD"===r.type&&"MODIFY"===e?"ADD":e,data:r.value}}else o.push({type:e,data:t});!function(e,t){"undefined"!==typeof window.Storage&&localStorage.setItem(e,t)}(n,JSON.stringify(o))}n.d(t,{G:function(){return o}}),n("../node_modules/core-js/modules/web.dom-collections.for-each.js"),n("../node_modules/core-js/modules/es.object.keys.js")},"../spread-sheet/src/base/util/deviceEnv/index.ts":function(e,t,n){n.d(t,{XJ:function(){return a},Q:function(){return C}}),n("../node_modules/core-js/modules/es.regexp.constructor.js"),n("../node_modules/core-js/modules/es.regexp.exec.js"),n("../node_modules/core-js/modules/es.regexp.to-string.js"),n("../node_modules/core-js/modules/es.string.split.js");var o=n("../node_modules/@tencent/docs-user-agent/dist/index.js"),i=n.n(o),r=-2,s=function(e){return e.some((function(e){return e}))};function a(){if(-2!==r)return r;var e=u();return void 0!==e?e:r=-1}var c,d,u=function(){if([s([i().isMobilePhone,i().isAndroidPad]),i().isTencentDocApp].every((function(e){return e}))){var e=new RegExp("Channel/[0-9]+","i").exec(i().userAgent.toLowerCase())||[];if(s([!e,!e[0]]))return r=-1;var t=e[0];return r=parseInt(t.split("/")[1],10)}},l=n("../node_modules/i18next/dist/esm/i18next.js"),f=n("../spread-sheet/src/external/templateinfo/sync-template.ts"),h=n("../packages/report/src/index.ts"),p=n("../packages/common-utils/src/index.ts"),m=n("../spread-sheet/src/core/script-loader/index.ts");!function(e){e.cannotPreview="1"}(c||(c={})),function(e){e[e.Back=0]="Back",e[e.Complete=1]="Complete"}(d||(d={}));var g=function(){h.ZP.tdwReport({opername:"doc_excel_editor",module:"excel_topbar",action:"top-bar-back-list"})},w=function(e,t){e&&t&&t()},v=function(e,t,n){var o,i=e===d.Back,r=e===d.Complete,s=i?"back_dialog_showed_tag":"complete_dialog_showed_tag",a=function(e){return e?parseInt(e,10):0}(localStorage.getItem(s));(o=a)>=0&&o<=2?((0,m.$y)("UIComponent",(function(e){var o;w(r,n),document.getElementById("mobileDialogContainer")||$("body").append('<div id="mobileDialogContainer" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; z-index: 10004;"></div>');var s=document.getElementById("mobileDialogContainer");null===(o=null===e||void 0===e?void 0:e.showMobileDialog)||void 0===o||o.call(e,s,{dialogType:i?"BACK":"COMPLETE",cb:t})})),localStorage.setItem(s,String(a+1))):(w(r,n),t())},x=!0,C=function(){var e,t;if(String((0,p.IZ)("preview"))!==c.cannotPreview)try{var o=(0,p.IZ)("group_code"),i=(0,p.IZ)("is_create_doc"),r=y(o,i);null===(e=n.g.mqq)||void 0===e||e.ui.setTitleButtons(r)}catch(s){null===(t=n.g.log)||void 0===t||t.error(s)}},_=function(){var e,t;null===(t=null===(e=n.g.mqq)||void 0===e?void 0:e.ui)||void 0===t||t.closeWebViews({mode:0,exclude:!1})},b=function(){x=!0},y=function(e,t){var o={};return o=e&&t?{left:{title:l.ZP.t("返回"),callback:function(){var e;g(),v(d.Back,null===(e=n.g.mqq)||void 0===e?void 0:e.ui.popBack)}},right:{title:l.ZP.t("完成"),callback:function(){x&&(0,m.$y)("GroupCreator",(function(t){x=!1,null===t||void 0===t||t.createNewDoc4Group(n.g.clientVars,e,(function(){return function(e,t){v(d.Complete,_,(function(){null===e||void 0===e||e.sendDocToGroupAio(n.g.clientVars,t)})),x=!0}(t,e)}),b)}))}}}:{right:{iconID:4,callback:function(){var e;g(),(0,f.D)(),null===(e=n.g.mqq)||void 0===e||e.ui.showShareMenu()}}},o};n("../spread-sheet/src/base/util/mobile.ts"),n("../spread-sheet/src/base/util/deviceEnv/wx.ts")},"../spread-sheet/src/base/util/deviceEnv/wx.ts":function(e,t,n){n.d(t,{Di:function(){return g},JC:function(){return h}}),n("../node_modules/regenerator-runtime/runtime.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.promise.js");var o,i=n("../packages/report/src/index.ts"),r=n("../node_modules/@tencent/docs-user-agent/dist/index.js"),s=n.n(r),a=n("../packages/common-utils/src/index.ts"),c=n("../spread-sheet/src/external/templateinfo/sync-template.ts"),d=n("../spread-sheet/src/base/util/domain-config.ts"),u=n("../spread-sheet/src/base/util/appConfig.ts"),l=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function s(e){try{c(o.next(e))}catch(t){r(t)}}function a(e){try{c(o.throw(e))}catch(t){r(t)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((o=o.apply(e,t||[])).next())}))};!function(e){e[e.doc=0]="doc",e[e.sheet=1]="sheet"}(o||(o={}));var f=function(e){i.ZP.tdwReport({opername:"doc_share",module:"wecha_h5",action:e})};function h(e){return l(this,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if([s().isWeChat,s().isWxWork].some((function(e){return e}))||d.xc){t.next=2;break}return t.abrupt("return");case 2:if(!window.wx){t.next=5;break}return null===e||void 0===e||e(),t.abrupt("return");case 5:return t.next=7,(0,a.ve)(p());case 7:return t.next=9,(0,a.ve)(m());case 9:null===e||void 0===e||e();case 10:case"end":return t.stop()}}),t)})))}var p=function(){return[s().isWxWork,!s().isAndroid].every((function(e){return e}))?u.Z.getConfig("runtime.library.TENCENT_DOCS_LIBRARY__jweixin_1_2_0"):u.Z.getConfig("runtime.library.TENCENT_DOCS_LIBRARY__jweixin_1_6_0")},m=function(){return u.Z.getConfig("runtime.library.TENCENT_DOCS_LIBRARY__jwxwork_1_0_0")};function g(e){var t,n=e.title,o=e.desc,i=e.share_url,r=e.image_url;null===(t=null===window||void 0===window?void 0:window.wx)||void 0===t||t.onMenuShareAppMessage({title:n,desc:o,link:i,imgUrl:r,type:"",dataUrl:"",success:function(){(0,c.D)(),null===window||void 0===window||window.log.info("onMenuShareAppMessage:success"),f("wechat_suc")},cancel:function(){},trigger:function(){f("share_wechat")}}),null===window||void 0===window||window.wx.onMenuShareTimeline({title:n,link:i,imgUrl:r,success:function(){f("moment_suc")},cancel:function(){},trigger:function(){f("share_moment")}}),null===window||void 0===window||window.wx.onMenuShareQQ({title:n,desc:o,link:i,imgUrl:r,success:function(){},cancel:function(){}})}},"../spread-sheet/src/external/templateinfo/sync-template.ts":function(e,t,n){n.d(t,{D:function(){return c}}),n("../node_modules/regenerator-runtime/runtime.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.promise.js");var o=n("./node_modules/axios/index.js"),i=n.n(o),r=n("../spread-sheet/src/core/data/configService/spreadConfig.ts"),s=n("../packages/utils/src/safe.ts"),a=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function s(e){try{c(o.next(e))}catch(t){r(t)}}function a(e){try{c(o.throw(e))}catch(t){r(t)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((o=o.apply(e,t||[])).next())}))};function c(){var e;return a(this,void 0,void 0,regeneratorRuntime.mark((function t(){var o,a;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(12!==r.q.getConfig("docStatus")){t.next=17;break}return r.q.setConfig({docStatus:0}),t.prev=2,(a=new FormData).append("domain_id",r.q.getConfig("domainId")),a.append("pad_id",r.q.getConfig("padId")),a.append("xsrf",(0,s.f)()),t.next=9,i()({method:"post",url:"/cgi-bin/online_docs/doc_humtrans",data:a,headers:{"Content-Type":"multipart/form-data"}});case 9:o=t.sent,t.next=15;break;case 12:t.prev=12,t.t0=t.catch(2),console.error(t.t0);case 15:return 0===(null===o||void 0===o?void 0:o.data.retcode)&&(null===(e=n.g.SLR)||void 0===e||e.dispatch("DOC_HUMTRANS_DONE")),t.abrupt("return",0===(null===o||void 0===o?void 0:o.data.retcode));case 17:return t.abrupt("return",!0);case 18:case"end":return t.stop()}}),t,null,[[2,12]])})))}},"../spread-sheet/src/external/view/workbench/service/show-dialog.ts":function(e,t,n){n.d(t,{S:function(){return s}}),n("../node_modules/regenerator-runtime/runtime.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.promise.js"),n("../node_modules/core-js/modules/es.function.name.js");var o=n("../spread-sheet/src/core/ark-extensions/index.ts"),i=n("../spread-sheet/src/core/ark-extensions/extensions/size-limit-dialog.ts"),r=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function s(e){try{c(o.next(e))}catch(t){r(t)}}function a(e){try{c(o.throw(e))}catch(t){r(t)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((o=o.apply(e,t||[])).next())}))};function s(e,t,n){return void 0===n&&(n=!1),r(this,void 0,void 0,regeneratorRuntime.mark((function r(){var s,c;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,o.default.getExtension(i.XM.name);case 2:s=r.sent,c=a(i.XM.name),s.show({container:c,type:e,report:{ver9:t},needReturnToTrash:n});case 5:case"end":return r.stop()}}),r)})))}function a(e){var t=document.getElementById(e);if(t)return t;var n=document.createElement("div");return n.id=e,document.body.appendChild(n),n}}}]),window.jsExecEndTimeStamp=Date.now(),window.cachedPerformanceEntries||(window.cachedPerformanceEntries=[]),window.cachedPerformanceEntries.push({name:"jsExec: js/bundle_coresheet_lazy.46238d757bf198d1fecc.js",entryType:"jsExec",startTime:window.jsExecStartTimeStamp,endTime:window.jsExecEndTimeStamp});
//# sourceMappingURL=bundle_coresheet_lazy.46238d757bf198d1fecc.js.map