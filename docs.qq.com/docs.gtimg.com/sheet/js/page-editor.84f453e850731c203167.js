self.window=self,window.jsExecStartTimeStamp=Date.now(),function(){var e={"../spread-sheet/src/ServiceCollection/index.ts":function(e,t,n){"use strict";n.d(t,{kh:function(){return o.Z},oF:function(){return r.o},yk:function(){return s}}),n("../node_modules/core-js/modules/es.array.iterator.js"),n("../node_modules/core-js/modules/es.map.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.string.iterator.js"),n("../node_modules/core-js/modules/esnext.map.delete-all.js"),n("../node_modules/core-js/modules/esnext.map.every.js"),n("../node_modules/core-js/modules/esnext.map.filter.js"),n("../node_modules/core-js/modules/esnext.map.find.js"),n("../node_modules/core-js/modules/esnext.map.find-key.js"),n("../node_modules/core-js/modules/esnext.map.includes.js"),n("../node_modules/core-js/modules/esnext.map.key-of.js"),n("../node_modules/core-js/modules/esnext.map.map-keys.js"),n("../node_modules/core-js/modules/esnext.map.map-values.js"),n("../node_modules/core-js/modules/esnext.map.merge.js"),n("../node_modules/core-js/modules/esnext.map.reduce.js"),n("../node_modules/core-js/modules/esnext.map.some.js"),n("../node_modules/core-js/modules/esnext.map.update.js"),n("../node_modules/core-js/modules/web.dom-collections.iterator.js"),n("../node_modules/core-js/modules/web.dom-collections.for-each.js");var o=n("../spread-sheet/src/base/dynamicImport/config.ts"),r=n("../spread-sheet/src/ServiceCollection/Loader.ts"),s=function(){function e(){this.CONFIG=o.Z,this.services=new Map,this.stack=[]}var t=e.prototype;return t.getinitializedService=function(){var e=[];return this.services.forEach((function(t){!0===t.initialized&&e.push(t)})),e},t.eachItializedService=function(e){this.getinitializedService().forEach((function(t){e(t.instance)}))},t.destroyItializedService=function(){var e;null===(e=n.g.log)||void 0===e||e.debug("flow ServiceCollection destroyItializedService()"),this.eachItializedService((function(e){e&&"function"===typeof e.destroy&&e.destroy()}))},t.createLoader=function(e){var t=new r.o(e);return this.services.set(e,t),t},e}()},"../spread-sheet/src/core/app/SpreadsheetApp.interface.ts":function(e,t,n){"use strict";n.d(t,{m:function(){return o}});var o=(0,n("../node_modules/@tencent/containerized/build/main/index.js").yh)("ISpreadsheetApp")},"../spread-sheet/src/core/app/devtool/tools.ts":function(e,t,n){"use strict";n("../node_modules/regenerator-runtime/runtime.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.promise.js");var o=n("../packages/model/src/utils/serializeUtils.ts"),r=n("../packages/mutation/src/transform.ts"),s=n("../spread-sheet/src/core/app/utils.ts"),i=n("../spread-sheet/src/core/network/message-center/model/missChange-helper.ts"),a=n("../packages/model/src/utils/numberFormat/FormatParseEngine.ts"),d=n("../spread-sheet/src/base/dynamicImport/index.ts"),c=function(e,t,n,o){return new(n||(n=Promise))((function(r,s){function i(e){try{d(o.next(e))}catch(t){s(t)}}function a(e){try{d(o.throw(e))}catch(t){s(t)}}function d(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,a)}d((o=o.apply(e,t||[])).next())}))};t.Z=function(e){e.tools={transform:r.v,serializeMutation:e.mutationBehavior.serializeMutation.bind(e.mutationBehavior),deserializeMutation:e.mutationBehavior.deserializeMutation.bind(e.mutationBehavior),follow:e.mutationBehavior.followRequests.bind(e.mutationBehavior),serialize:o.serialize,getMisschange:i.Tn,searchInPreview:s.NU,parseValueWithStyle:a.parseValueWithStyle},function(e){c(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n,o,r,s;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,d.ZP.getSpreadSheetToolLazy();case 2:n=t.sent,o=n.createZipKeyframe,r=n.getKeyframe,s=n.createSheetWithKeyframe,e.tools.createZipKeyframe=o,e.tools.getKeyframe=r,e.tools.createSheetWithKeyframe=s;case 7:case"end":return t.stop()}}),t)})))}(e)}},"../spread-sheet/src/core/app/sheetStatus/private-range.ts":function(e,t,n){"use strict";n.d(t,{II:function(){return c},Up:function(){return d},_7:function(){return l},fe:function(){return f},uQ:function(){return u},xy:function(){return a}}),n("../node_modules/core-js/modules/es.array.from.js"),n("../node_modules/core-js/modules/es.string.iterator.js"),n("../node_modules/core-js/modules/es.array.iterator.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/web.dom-collections.iterator.js"),n("../node_modules/core-js/modules/web.dom-collections.for-each.js"),n("../node_modules/core-js/modules/es.array.find-index.js");var o=n("../packages/model/src/range/index.ts"),r=n("../spread-sheet/src/core/data/configService/spreadConfig.ts"),s=n("../spread-sheet/src/core/feature/formula/utils/parseUtil.ts"),i=n("../spread-sheet/src/core/view/level-2/formula-ui-center/utils.ts");function a(e,t,n,o,s){var i,a,d;if(void 0===o&&(o=e.activeSheet),null!==(i=null===s||void 0===s?void 0:s.isOwner)&&void 0!==i?i:r.q.getConfig("isOwner"))return!1;var c=o.getPrimaryCellDataAtPosition(t,n);if(!Boolean(null===c||void 0===c?void 0:c.getEditValue())||!l(e,t,n,o))return!1;var u=null!==(a=null===s||void 0===s?void 0:s.ownerId)&&void 0!==a?a:r.q.getConfig("ownerId"),f=null!==(d=null===s||void 0===s?void 0:s.tinyid)&&void 0!==d?d:r.q.getConfig("tinyid");return((null===c||void 0===c?void 0:c.getModifierId())||u)!==f}function d(e,t){return Array.from(e.privateRangeMap.values()).some((function(e){var n=e.range;return t.some((function(e){return n.isCross(e)}))}))}function c(e,t){var n=Array.from(e.privateRangeMap.values()),o=-1;return n.forEach((function(e){var n=e.range;return t.some((function(e){if(n.isCross(e))return(o<0||n.startRowIndex<o)&&(o=n.startRowIndex),!0}))})),o}function l(e,t,n,r){void 0===r&&(r=e.activeSheet);var s=e.workbookRangeManager.privateRangeMap;if(0===s.size)return!1;var i=new o.GridRange(r.getSheetId(),t,t,n,n);return Array.from(s).some((function(e){return e[1].range.contain(i)}))}function u(e,t,n,r){if(!e.workbookRangeManager.privateRangeMap.size)return!1;var a=e.activeSheet,c=e.workbookRangeManager,l=e.activeSheetId,u=a.getCellDataAtPosition(n,r);if(!(0,i.AO)(u,t).isFormula)return!1;var f=(0,s.EG)(t,0,0,l);return!f.hasReferenceError&&f.getAllCellRangeWithFixedInfo().findIndex((function(e){var t=e.startRowIndex,n=e.endRowIndex,r=e.startColIndex,s=e.endColIndex,i=e.startSheetId,a=e.isRowArray,u=e.isColArray,f=e.isSheetReferenceCorrect,m=e.isThreeDimensionalReference;if(!f||m)return!1;var _=new o.GridRange(i||l,u?o.DEFAULT_DIMENSION_INDEX:t,u?o.DEFAULT_DIMENSION_INDEX:n,a?o.DEFAULT_DIMENSION_INDEX:r,a?o.DEFAULT_DIMENSION_INDEX:s);return d(c,[_])}))>=0}function f(e,t){var n={isOwner:r.q.getConfig("isOwner"),ownerId:r.q.getConfig("ownerId"),tinyid:r.q.getConfig("tinyid")};return t.some((function(t){return t.some((function(t,o){return a(e,t,o,e.activeSheet,n)}))}))}},"../spread-sheet/src/core/app/tool.ts":function(e,t,n){"use strict";n("../node_modules/core-js/modules/es.regexp.exec.js"),n("../node_modules/core-js/modules/es.string.split.js"),n("../node_modules/core-js/modules/es.array.filter.js"),n("../node_modules/core-js/modules/es.array.join.js");var o=n("../packages/common-utils/src/index.ts"),r=n("../spread-sheet/src/base/event/event.ts"),s=n("../packages/utils/src/safe.ts"),i=window,a={replace:function(e){var t=i.location.href.split("?")[1],n="",o=i.location.hash;n=t&&(t=(t=t.split("&")).filter((function(e){return e.indexOf("tab=")<0&&e.indexOf("#")<0}))).length?"?"+t.join("&")+"&tab="+e:"?tab="+e,o&&(n+=o),i.history.replaceState(e,"",n)},pop:function(e){r.ZP.windowEvent.listen("popState",e)}},d={window:i,document:i.document,event:r.ZP,setHash:function(e){i.location.hash=e},getXsrf:s.f,getUrl:function(){return i.clientVars.shortLink},getQuery:o.IZ,resized:function(e){r.ZP.windowEvent.listen("resize",(function(){e()}))},sheetNode:i.sheetNode,clientVars:i.clientVars,windowEvent:r.ZP.windowEvent,bodyEvent:r.ZP.bodyEvent,pad:i.pad,History:a};t.Z=d},"../spread-sheet/src/core/app/utils.ts":function(e,t,n){"use strict";n.d(t,{NU:function(){return i},QU:function(){return d},bG:function(){return a},x5:function(){return c}}),n("../node_modules/core-js/modules/es.array.slice.js"),n("../node_modules/core-js/modules/es.array.iterator.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/web.dom-collections.iterator.js"),n("../node_modules/core-js/modules/es.regexp.exec.js"),n("../node_modules/core-js/modules/es.string.split.js"),n("../node_modules/core-js/modules/es.string.replace.js"),n("../packages/mutation/src/other/EmptyMutation.ts");var o,r=n("../spread-sheet/src/core/data/configService/spreadConfig.ts"),s=n("../packages/common-utils/src/index.ts");function i(e,t){for(var o=n.g.SpreadsheetApp.preview.previewsheet.sheets[e].data.rowData,r=0;r<o.length;r++)if(o[r])for(var s=0;s<o[r].values.length;s++){var i=o[r].values[s];if(i){var a=i.effectiveValue;(null===a||void 0===a?void 0:a.value)&&a.value}}}function a(e,t){var n=e.split("."),o=t.split(".");return n[0]===o[0]&&n[1]===o[1]}!function(e){e[e.resizeColumns=0]="resizeColumns",e[e.mergeCells=1]="mergeCells",e[e.unmergeCells=2]="unmergeCells",e[e.insertRows=3]="insertRows",e[e.insertColumns=4]="insertColumns",e[e.hideRows=5]="hideRows",e[e.hideColumns=6]="hideColumns",e[e.showRows=7]="showRows",e[e.showColumns=8]="showColumns",e[e.deleteRows=9]="deleteRows",e[e.deleteColumns=10]="deleteColumns",e[e.resizeRows=11]="resizeRows",e[e.resizeRowsColumns=12]="resizeRowsColumns",e[e.moveRows=13]="moveRows",e[e.moveColumns=14]="moveColumns",e[e.setRowFormData=15]="setRowFormData",e[e.setColFormData=16]="setColFormData",e[e.reorder=17]="reorder",e[e.freeze=18]="freeze",e[e.userEnter=19]="userEnter",e[e.userEnterToSheetId=20]="userEnterToSheetId",e[e.userRangeEnter=21]="userRangeEnter",e[e.addImage=22]="addImage",e[e.updateImage=23]="updateImage",e[e.deleteImage=24]="deleteImage",e[e.insertLink=25]="insertLink",e[e.fontBold=26]="fontBold",e[e.autoWrap=27]="autoWrap",e[e.numberFormat=28]="numberFormat",e[e.formatPainter=29]="formatPainter",e[e.decreaceDecimal=30]="decreaceDecimal",e[e.increaceDecimal=31]="increaceDecimal",e[e.clearLink=32]="clearLink",e[e.clearFormat=33]="clearFormat",e[e.setLink=34]="setLink",e[e.clearContent=35]="clearContent",e[e.replace=36]="replace",e[e.redo=37]="redo",e[e.undo=38]="undo",e[e.smartSelection=39]="smartSelection",e[e.setBasicFilter=40]="setBasicFilter",e[e.clearBasicFilter=41]="clearBasicFilter",e[e.updateFilterCriteria=42]="updateFilterCriteria",e[e.applyPasteData=43]="applyPasteData",e[e.reorderWithFilter=44]="reorderWithFilter",e[e.insideSheetCopyPaste=45]="insideSheetCopyPaste",e[e.defineFormRange=46]="defineFormRange",e[e.insertImage=47]="insertImage",e[e.defineCommentRange=48]="defineCommentRange",e[e.deleteCommentRange=49]="deleteCommentRange",e[e.dataValidation=50]="dataValidation",e[e.clearDataValidation=51]="clearDataValidation",e[e.doPaste=52]="doPaste",e[e.freezePreview=53]="freezePreview",e[e.cancelFreezePreview=54]="cancelFreezePreview",e[e.addConditionFormat=55]="addConditionFormat",e[e.deleteConditionFormat=56]="deleteConditionFormat",e[e.updateConditionFormat=57]="updateConditionFormat",e[e.setSheet=58]="setSheet",e[e.setHorizontalAlign=59]="setHorizontalAlign",e[e.setVerticalAlign=60]="setVerticalAlign",e[e.inserFunction=61]="inserFunction",e[e.setBackgroundColor=62]="setBackgroundColor",e[e.setHideGridlines=63]="setHideGridlines",e[e.setBorder=64]="setBorder",e[e.setFontColor=65]="setFontColor",e[e.fontStrike=66]="fontStrike",e[e.setFontFamliy=67]="setFontFamliy",e[e.setFontFamily=68]="setFontFamily",e[e.setFontSize=69]="setFontSize",e[e.fontItalics=70]="fontItalics",e[e.fontUnderLine=71]="fontUnderLine",e[e.formatPainterSetCache=72]="formatPainterSetCache",e[e.formatPainterApply=73]="formatPainterApply",e[e.formatPainterClear=74]="formatPainterClear",e[e.insertSheet=75]="insertSheet",e[e.delSheet=76]="delSheet",e[e.moveSheet=77]="moveSheet",e[e.hideSheet=78]="hideSheet",e[e.showSheet=79]="showSheet",e[e.renameSheet=80]="renameSheet",e[e.copySheet=81]="copySheet"}(o||(o={}));var d="rangeAuthError";function c(e){return"1"===(0,s.IZ)("newEmptyDoc")||r.q.getConfig("metaCreateTime")===r.q.getConfig("lastModifyTime")&&1===e.sheetManager.sheetCount&&!e.activeSheet.isExternalSheet()&&0===e.activeSheet.data.rowData.length}},"../spread-sheet/src/core/ark-extensions/extensions/collect.ts":function(e,t,n){"use strict";n.d(t,{T:function(){return o}});var o={name:"docs-component-collect",loadType:n("../node_modules/@tencent/ark-extensions/lib/index.js").LoadType.ON_DEMAND}},"../spread-sheet/src/core/ark-extensions/extensions/wedrive-file-selector.ts":function(e,t,n){"use strict";n.d(t,{_:function(){return o}});var o={name:"docs-component-wedrive-file-selector",loadType:n("../node_modules/@tencent/ark-extensions/lib/index.js").LoadType.EAGER}},"../spread-sheet/src/core/ark-extensions/index.ts":function(e,t,n){"use strict";n.r(t),n.d(t,{updateDomainClientVars:function(){return m}});var o=n("../node_modules/@babel/runtime/helpers/esm/toConsumableArray.js"),r=(n("../node_modules/core-js/modules/es.array.concat.js"),n("../node_modules/@tencent/ark-extensions/lib/index.js")),s=n("../spread-sheet/src/core/ark-extensions/extensions/size-limit-dialog.ts"),i=n("../spread-sheet/src/core/ark-extensions/extensions/mini-list.ts"),a=n("../spread-sheet/src/core/ark-extensions/extensions/at-message-toast.ts"),d=n("../spread-sheet/src/core/ark-extensions/extensions/attachment.ts"),c=(n("../spread-sheet/src/base/util/domain-config.ts"),n("../spread-sheet/src/core/ark-extensions/extensions/collaborator-detail-mobile.ts")),l=(n("../spread-sheet/src/core/ark-extensions/extensions/wedrive-file-selector.ts"),n("../spread-sheet/src/core/ark-extensions/extensions/subscription-notification.ts")),u=(n("../spread-sheet/src/core/ark-extensions/extensions/guide-interflow.ts"),n("../spread-sheet/src/core/ark-extensions/extensions/collect.ts"),n("../spread-sheet/src/base/util/appConfig.ts"),n("../spread-sheet/src/core/ark-extensions/extensions/collaboration.ts")),f=(0,r.createExtensionService)({metadataLoaderOptions:{componentCdnPrefix:void 0,specifiedVersion:1}});function m(){window.clientVars&&f.updateDomainWithClientVars(window.clientVars,!0)}m(),f.scanAndHandleExtensions([s.XM,i.h,l.a,d.m,a.O,c.x].concat((0,o.Z)([u.M]))),t.default=f},"../spread-sheet/src/core/behavior/multi-type-follow.ts":function(e,t,n){"use strict";n.d(t,{C6:function(){return m},Xe:function(){return f},Xz:function(){return c},d:function(){return p},fM:function(){return _},hh:function(){return l},t1:function(){return h}}),n("../node_modules/core-js/modules/es.array.map.js"),n("../node_modules/core-js/modules/web.dom-collections.for-each.js");var o,r=n("../packages/mutation/src/index.ts"),s=n("../spread-sheet/src/core/network/message-center/model/changeset-type.ts"),i=n("../packages/model/src/sheet/SheetType.ts"),a=n("../packages/mutation/src/MutationId.ts"),d=((o={})[r.xF.DELETE_SHEET_MUTATION]=function(e){var t=e.sheetId,o=e.sheetIndex,r=n.g.SpreadsheetApp.sheetAdapterManager.getAdapterBySheetType(i.ZP.SMART_SHEET);return new(r.getMutationClassByMutationId(3002))({tableId:t,delta:{index:o}})},o);function c(e,t,o){var r=e.changesetType,a=e.mutations,c=t.changesetType,l=t.mutations,u=n.g.SpreadsheetApp.sheetAdapterManager.getAdapterBySheetType(i.ZP.SMART_SHEET);if(r===c)return c===s.G.SMARTSHEET?{changesetType:c,mutations:u.followRequestMutations(a,l,o)}:{changesetType:c,mutations:n.g.SpreadsheetApp.mutationBehavior.followRequestMutations(a,l,o)};if(r===s.G.SMARTSHEET)return{changesetType:c,mutations:l};var f=function(e){var t=!1,n=e.changesetType,o=e.mutations;if(n===s.G.SMARTSHEET)return{isNeedConvert:t};var r=o.map((function(e){return e.map((function(e){var n=d[e.id];return n?(t=!0,n(e)):e}))}));return{isNeedConvert:t,transformedChangeMutations:{changesetType:s.G.SMARTSHEET,mutations:r}}}(e);if(!f.isNeedConvert)return{changesetType:c,mutations:l};var m=f.transformedChangeMutations.mutations;return{changesetType:c,mutations:u.followRequestMutations(m,l,o)}}function l(e,t,o){var r,a=e.changesetType,d=e.changeset,l=t.changesetType,f=t.changeset;null===(r=n.g.log)||void 0===r||r.info("multiTypeFollowChangeset A:",d," changesetB:",f);var m=c({changesetType:a,mutations:u(d,a)},{changesetType:l,mutations:u(f,l)},o),_=m.changesetType,p=function(e,t){var o;if(t===s.G.SMARTSHEET){var r=n.g.SpreadsheetApp.sheetAdapterManager.getAdapterBySheetType(i.ZP.SMART_SHEET);o=r}else o=n.g.SpreadsheetApp.mutationBehavior;var a=e.map((function(e){return e.map((function(e){return o.serializeMutation(e)}))}));return JSON.stringify(a)}(m.mutations,_);return{changesetType:_,changeset:p}}function u(e,t){var o;if(t===s.G.SMARTSHEET){var r=n.g.SpreadsheetApp.sheetAdapterManager.getAdapterBySheetType(i.ZP.SMART_SHEET);o=r}else o=n.g.SpreadsheetApp.mutationBehavior;return JSON.parse(e).map((function(e){return e.map((function(e){return o.deserializeMutation(e)}))}))}function f(e,t){return t===s.G.SMARTSHEET?n.g.SpreadsheetApp.sheetAdapterManager.getAdapterBySheetType(i.ZP.SMART_SHEET).deserializeMutation(e):n.g.SpreadsheetApp.mutationBehavior.deserializeMutation(e)}function m(e,t){return e===s.G.SMARTSHEET?n.g.SpreadsheetApp.sheetAdapterManager.getAdapterBySheetType(i.ZP.SMART_SHEET).deserializeRequests(t):n.g.SpreadsheetApp.mutationBehavior.deSerializeRequests(t)}function _(e,t){t!==s.G.SMARTSHEET?function(e){e.forEach((function(e){e.operationType=r.g8.COLLAB,n.g.SpreadsheetApp.mutationBehavior.applyMutation(e,{isLocal:!1,isCollab:!0})}))}(e):function(e){var t=e.map((function(e){return e.operationType=r.g8.COLLAB,e}));n.g.SpreadsheetApp.sheetAdapterManager.getAdapterBySheetType(i.ZP.SMART_SHEET).runMutations(t)}(e)}function p(e,t){t!==s.G.SMARTSHEET?function(e){e.forEach((function(e){if(e.operationType=r.g8.LOCAL,n.g.SpreadsheetApp.mutationBehavior.applyMutation(e,{isLocal:!0,isCollab:!1}),e.id===a.ZP.INSERT_SHEET_MUTATION){var t=n.g.SpreadsheetApp.spreadsheet.sheetManager.getSheetBySheetId(e.sheetId);null===t||void 0===t||t.stopLoading(!0)}}))}(e):function(e){var t=e.map((function(e){return e.operationType=r.g8.LOCAL,e}));n.g.SpreadsheetApp.sheetAdapterManager.getAdapterBySheetType(i.ZP.SMART_SHEET).runMutations(t)}(e)}function h(e,t){var o=function(e){return e===s.G.SMARTSHEET?n.g.SpreadsheetApp.sheetAdapterManager.getAdapterBySheetType(i.ZP.SMART_SHEET):n.g.SpreadsheetApp.mutationBehavior}(t);return o.serializeMutation(e)}},"../spread-sheet/src/core/behavior/request/range/common/index.ts":function(e,t,n){"use strict";n.d(t,{kY:function(){return u},wt:function(){return s.w},k1:function(){return i.k},N2:function(){return a.N2},I9:function(){return l},eZ:function(){return r.e},xc:function(){return d.x}}),n("../node_modules/core-js/modules/es.array.iterator.js"),n("../node_modules/core-js/modules/es.map.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.string.iterator.js"),n("../node_modules/core-js/modules/esnext.map.delete-all.js"),n("../node_modules/core-js/modules/esnext.map.every.js"),n("../node_modules/core-js/modules/esnext.map.filter.js"),n("../node_modules/core-js/modules/esnext.map.find.js"),n("../node_modules/core-js/modules/esnext.map.find-key.js"),n("../node_modules/core-js/modules/esnext.map.includes.js"),n("../node_modules/core-js/modules/esnext.map.key-of.js"),n("../node_modules/core-js/modules/esnext.map.map-keys.js"),n("../node_modules/core-js/modules/esnext.map.map-values.js"),n("../node_modules/core-js/modules/esnext.map.merge.js"),n("../node_modules/core-js/modules/esnext.map.reduce.js"),n("../node_modules/core-js/modules/esnext.map.some.js"),n("../node_modules/core-js/modules/esnext.map.update.js"),n("../node_modules/core-js/modules/web.dom-collections.iterator.js");var o=n("../node_modules/i18next/dist/esm/i18next.js"),r=n("../spread-sheet/src/core/behavior/request/range/common/getEffectRange.ts"),s=n("../spread-sheet/src/core/behavior/request/range/common/checkAuth.ts"),i=n("../spread-sheet/src/core/behavior/request/range/common/checkMergeCellConflict.ts"),a=n("../spread-sheet/src/core/behavior/request/range/common/check-range-auth.ts"),d=n("../spread-sheet/src/core/behavior/request/range/common/get-grid-data-size.ts"),c=n("../packages/model/src/range/GridRange.ts");function l(e){var t,n=(null===(t=e.view.canvas)||void 0===t?void 0:t.normalSelectData).select,o=n.xRange,r=n.yRange,s=e.spreadsheet.getActiveSheetId();return new c.Z({sheetId:s,startRowIndex:r[0],endRowIndex:r[1],startColIndex:o[0],endColIndex:o[1]})}var u=new Map;u.set(s.w,(function(){return{title:o.ZP.t("出现问题"),content:o.ZP.t("此范围已被保护。如需编辑，请联系创建者「{{value}}」授予权限。",{value:n.g.clientVars.ownerNick})}})),u.set(i.k,(function(){return{title:o.ZP.t("合并单元格问题"),content:o.ZP.t("遇到合并单元格，操作不成功，请取消合并之后重试。")}}))},"../spread-sheet/src/core/behavior/request/workbook/filterUtils/calcFilteredRows.ts":function(e,t,n){"use strict";n.d(t,{AA:function(){return m},og:function(){return _}}),n("../node_modules/core-js/modules/es.array.iterator.js"),n("../node_modules/core-js/modules/es.map.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.string.iterator.js"),n("../node_modules/core-js/modules/esnext.map.delete-all.js"),n("../node_modules/core-js/modules/esnext.map.every.js"),n("../node_modules/core-js/modules/esnext.map.filter.js"),n("../node_modules/core-js/modules/esnext.map.find.js"),n("../node_modules/core-js/modules/esnext.map.find-key.js"),n("../node_modules/core-js/modules/esnext.map.includes.js"),n("../node_modules/core-js/modules/esnext.map.key-of.js"),n("../node_modules/core-js/modules/esnext.map.map-keys.js"),n("../node_modules/core-js/modules/esnext.map.map-values.js"),n("../node_modules/core-js/modules/esnext.map.merge.js"),n("../node_modules/core-js/modules/esnext.map.reduce.js"),n("../node_modules/core-js/modules/esnext.map.some.js"),n("../node_modules/core-js/modules/esnext.map.update.js"),n("../node_modules/core-js/modules/web.dom-collections.iterator.js"),n("../node_modules/core-js/modules/es.set.js"),n("../node_modules/core-js/modules/esnext.set.add-all.js"),n("../node_modules/core-js/modules/esnext.set.delete-all.js"),n("../node_modules/core-js/modules/esnext.set.difference.js"),n("../node_modules/core-js/modules/esnext.set.every.js"),n("../node_modules/core-js/modules/esnext.set.filter.js"),n("../node_modules/core-js/modules/esnext.set.find.js"),n("../node_modules/core-js/modules/esnext.set.intersection.js"),n("../node_modules/core-js/modules/esnext.set.is-disjoint-from.js"),n("../node_modules/core-js/modules/esnext.set.is-subset-of.js"),n("../node_modules/core-js/modules/esnext.set.is-superset-of.js"),n("../node_modules/core-js/modules/esnext.set.join.js"),n("../node_modules/core-js/modules/esnext.set.map.js"),n("../node_modules/core-js/modules/esnext.set.reduce.js"),n("../node_modules/core-js/modules/esnext.set.some.js"),n("../node_modules/core-js/modules/esnext.set.symmetric-difference.js"),n("../node_modules/core-js/modules/esnext.set.union.js"),n("../node_modules/core-js/modules/web.dom-collections.for-each.js"),n("../node_modules/core-js/modules/es.array.from.js");var o,r=n("../spread-sheet/src/external/view/main/panel/FillterPanel/utils/filterUtil.ts"),s=n("../packages/model/src/filter/FilterCriteria.ts"),i=n("../packages/model/src/range/index.ts"),a=(n("../packages/mutation/src/filter/UpdateFilterMutation.ts"),n("../spread-sheet/src/base/util/type.ts")),d=n("../spread-sheet/src/core/view/level-2/condition-format-center/data/ConditionFormatRule.ts"),c=n("../spread-sheet/src/core/view/spreadsheet-view/transform-table/cell.ts"),l=n("../spread-sheet/src/core/view/spreadsheet-view/transform-table/utils.ts");function u(e){var t=e.range,n=e.col,o=e.sheet,r=e.results,s=e.filteredRows,i=void 0===s?new Set:s,a=t.startRowIndex,d=new Map;null===r||void 0===r||r.forEach((function(e){var t=e.value,n=e.row;d.set(n,t),!1===t&&i.add(n)}));var c=function(e,t,n){for(var o,r=e.startRowIndex,s=e.endRowIndex,i=new Map,a=r;a<=s;a++){var d=null===(o=n.getCellDataAtPosition(a,t))||void 0===o?void 0:o.getMergeReference();if(d){var c=d.startRowIndex;i.set(a,c)}}return i}(t,n,o);return c.forEach((function(e,t){!1===d.get(e)&&i.add(t)})),i.has(a)&&i.delete(a),i}function f(e,t,n){for(var o=t.startRowIndex,r=t.endRowIndex,s=o+1;s<=r;s++)e.has(s)||n(s)||e.add(s)}var m=((o={})[s.V.VALUE]=function(e){var t=e.criteria,n=e.col,o=e.range,s=e.filteredRows,i=void 0===s?new Set:s,d=e.sheet,c=t.visibleValues||[],l=(0,a.arrToObjectKey)(c);return f(i,o,(function(e){var t=(0,r.gm)(d,e,n);return l[t]})),i},o[s.V.COLOR]=function(e){var t=e.criteria,n=e.col,o=e.range,r=e.filteredRows,s=void 0===r?new Set:r,i=e.sheet,a=t.toSets(),d=a.textColorSet,u=a.bgColorSet;return f(s,o,(function(e){var t=i.getPrimaryCellDataAtPosition(e,n),o=(0,c.FG)(t,i.spreadsheetReference),r=o.textColor,s=o.bgColor;return(0,l.FE)(t)&&d.has(r)||u.has(s)})),s},o[s.V.CONDITION]=function(e){var t=e.criteria,n=e.col,o=e.range,r=e.filteredRows,s=void 0===r?new Set:r,a=e.sheet,c=e.conditonCalcDependency,l=t.condition,f=a.getSheetId(),m=o.startRowIndex,_=c.formulaCalculator,p=c.getSheetTitleBySheetId,h=function(e,t,n){for(var o,r=e.startRowIndex,s=e.endRowIndex,a=[],d=n.getSheetId(),c=-1,l=r;l<=s;l++){var u=null===(o=n.getCellDataAtPosition(l,t))||void 0===o?void 0:o.getMergeReference();if(u){var f=u.startRowIndex,m=u.startColIndex;-1!==c&&(a.push(new i.GridRange(d,c,l-1,t,t)),c=-1),l===f&&a.push(new i.GridRange(d,f,f,m,m))}else-1===c&&(c=l)}return-1!==c&&a.push(new i.GridRange(d,c,s,t,t)),a}(o,n,a),g=(0,d.O8)(l,{sheetId:f,userValueRelativeRow:m,userValueRelativeCol:n,sheet:a,gridRanges:h},{getSheetTitleBySheetId:p},a);if(!g)return s;var v=_(g,f),b=v.isError,w=v.result;return b?s:u({range:o,col:n,sheet:a,results:w,filteredRows:s})},o);function _(e,t,n){var o=new Set,r=e.criteriaMap,s=e.range;return r.forEach((function(e,r){var i=m[e.type];null===i||void 0===i||i({criteria:e,col:r,range:s,filteredRows:o,sheet:t,conditonCalcDependency:n})})),Array.from(o)}},"../spread-sheet/src/core/data/converter/tencentdoc/doMutation.ts":function(e,t,n){"use strict";n.d(t,{PF:function(){return C},eR:function(){return g},zf:function(){return m}});var o=n("../node_modules/@babel/runtime/helpers/esm/toConsumableArray.js"),r=(n("../node_modules/core-js/modules/es.number.constructor.js"),n("../node_modules/core-js/modules/es.array.includes.js"),n("../node_modules/core-js/modules/es.string.includes.js"),n("../node_modules/core-js/modules/es.array.concat.js"),n("../node_modules/core-js/modules/es.array.map.js"),n("../node_modules/core-js/modules/web.dom-collections.for-each.js"),n("../packages/mutation/src/Mutation.ts")),s=n("../packages/mutation/src/MutationOperationType.ts"),i=n("../packages/mutation/src/MutationId.ts"),a=n("../packages/report/src/index.ts"),d=n("../spread-sheet/src/base/config/report.ts"),c=n("../packages/model/src/sheet/BaseSheet.ts"),l=n("../packages/model/src/spreadsheet/index.ts"),u=n("../packages/model/src/dimension/index.ts"),f=n("../packages/model/src/sheet/sheetTransToMutationsUtils.ts");function m(e,t,o,r,s){var a;if(void 0===r&&(r=!1),void 0===s&&(s=!1),Array.isArray(t)){if(r&&e instanceof l.Spreadsheet){var d=function(e,t,o){var r,s=g(e);if(0===s.length)return[t,o];null===(r=n.g.log)||void 0===r||r.info("[分片加载] 存在离线数据的情况,走临时表方案",s);var a=b(e,o),d=a.activeSheet;o.rowCount&&o.colCount?(d.setColCount(o.colCount),d.setRowCount(o.rowCount)):function(e,t){for(var n=t.length-1;n>=0;n--)for(var o=t[n],r=o.length-1;r>=0;r--)for(var s=o[r],a=s.length-1;a>=0;a--){var d=s[a];if(d.c[2]===e.getSheetId()&&(d.t===i.ZP.INSERT_DIMENSION_MUTATION||d.t===i.ZP.DELETE_DIMENSION_MUTATION)){var c=d.c[3]===u.DIMENSION_TYPE.ROWS?e.getRowCount():e.getColCount(),l=d.t===i.ZP.INSERT_DIMENSION_MUTATION?-d.c[1]:d.c[1];(d.c[3]===u.DIMENSION_TYPE.ROWS?e.setRowCount.bind(e):e.setColCount.bind(e))(c+l)}}}(d,s);var c=v(d,s,o);return _(a,t,c,!0),_(a,s,{sheetId:d.getSheetId(),startRowIndex:null,endRowIndex:null},!0),[w(d,c),c]}(e,t,o);t=d[0],o=d[1]}var c=e instanceof l.Spreadsheet?e.sheetManager.getSheetBySheetId(o.sheetId):e;if(c&&null!==o.endRowIndex){var f=o.rowCount?Math.min(o.endRowIndex,Number(o.rowCount)-1):o.endRowIndex;c.highWaterMark.updateMark(f)}for(var m=0;m<t.length;m++)for(var p=I(t[m]),x=0;x<p.length;x++)h(e,p[x],!1,s)}else null===(a=n.g.log)||void 0===a||a.error("doThreeDimensionsMutation(): threeDimensionsAction is not array",t)}function _(e,t,o,r){var s;if(void 0===r&&(r=!1),Array.isArray(t)){var i=e.sheetManager.getSheetBySheetId(o.sheetId);i&&null!==o.endRowIndex&&i.highWaterMark.updateMark(o.endRowIndex);for(var a=0===o.startRowIndex,d=0;d<t.length;d++)for(var c=I(t[d]),l=0;l<c.length;l++)p(e,c[l],r,a)}else null===(s=n.g.log)||void 0===s||s.error("doThreeDimensionsMutation(): threeDimensionsAction is not array",t)}function p(e,t,o,a){void 0===o&&(o=!1);var d=n.g.SpreadsheetApp,c=t;t[0]instanceof r.Z||(c=d.mutationBehavior.getCollabMutations(t));for(var l=[],u=0,f=c.length;u<f;u++){var m=c[u];!a&&i.p0.includes(m.id)||(m.getAffectedSheetId()===e.getActiveSheetId()?(m.operationType=s.Z.HISTORY,d.mutationBehavior.applyMutation(m,{isLocal:!0,ignoreCheck:i.$z.includes(m.id),isReplay:!0,isIgnoreRender:o},e).isValid||l.push(m)):m.checkAndRunOnFormulaModel(e))}x(l)}function h(e,t,n,o){void 0===n&&(n=!1),void 0===o&&(o=!1);var a=e instanceof l.Spreadsheet?e.parent:e.spreadsheetReference.parent,d=t;t[0]instanceof r.Z||(d=a.mutationBehavior.getCollabMutations(t));for(var c=[],u=0,f=d.length;u<f;u++){var m=d[u];m.operationType=s.Z.HISTORY,a.mutationBehavior.applyMutation(m,{isLocal:!0,ignoreCheck:i.$z.includes(m.id),isReplay:!0,isIgnoreRender:n,isIgnoreDataCallView:o},e).isValid||c.push(m)}d=null,x(c)}function g(e){var t,n,r,s,i=(null===(n=null===(t=e.parent.messageCenter)||void 0===t?void 0:t.localUserChangeManager)||void 0===n?void 0:n.getCommitingQueue())||[],a=(null===(s=null===(r=e.parent.messageCenter)||void 0===r?void 0:r.localUserChangeManager)||void 0===s?void 0:s.getWaitingQueue())||[];return[].concat((0,o.Z)(i),(0,o.Z)(a)).map((function(e){return JSON.parse(e.getChangeset())}))}var v=function(e,t,o){var r=o;return t.forEach((function(t){t.forEach((function(t){t.forEach((function(t){var s,a;if((t.t===i.ZP.INSERT_DIMENSION_MUTATION||t.t===i.ZP.DELETE_DIMENSION_MUTATION)&&(null===(s=t.c)||void 0===s?void 0:s[3])===u.DIMENSION_TYPE.ROWS&&(null===(a=t.c)||void 0===a?void 0:a[2])===e.getSheetId()){var d=n.g.SpreadsheetApp.mutationBehavior.deserializeMutation(t),c=Number(d.amount),l=Number(d.index);if(d.id===i.ZP.INSERT_DIMENSION_MUTATION){var f=l>Number(o.startRowIndex)&&l<=Number(o.endRowIndex),m=l<=Number(o.startRowIndex);f&&(r.endRowIndex=c+Number(r.endRowIndex)),m&&(r.startRowIndex=c+Number(r.startRowIndex),r.endRowIndex=c+Number(r.endRowIndex)),r.rowCount=r.rowCount?Number(r.rowCount)+1:void 0}else{var _=l<=Number(o.endRowIndex)&&l+c>Number(o.startRowIndex),p=l+c<Number(o.startRowIndex);_&&(r.startRowIndex=l),p&&(r.startRowIndex=Number(r.startRowIndex)-c),r.rowCount=r.rowCount?Number(r.rowCount)-1:void 0}}}))}))})),r},b=function(e,t){var n=new l.Spreadsheet(e.parent,{spreadsheetId:e.getSpreadsheetId(),type:l.SPREADSHEET_TYPE.NORMAL,title:"temp",sheetList:[]});n.sheetManager.getSheetIdList=e.sheetManager.getSheetIdList.bind(e.sheetManager),n.sheetManager.isSheetAmongTwoSheets=e.sheetManager.isSheetAmongTwoSheets.bind(e.sheetManager),n.sheetManager.getSheetIdBySheetIndex=e.sheetManager.getSheetIdBySheetIndex.bind(e.sheetManager),n.sheetManager.getSheetIndexBySheetId=e.sheetManager.getSheetIndexBySheetId.bind(e.sheetManager),n.sheetManager.getSheetTitleBySheetId=e.sheetManager.getSheetTitleBySheetId.bind(e.sheetManager);var o=new c.Z({spreadsheetReference:n,properties:e.sheetManager.getSheetBySheetId(t.sheetId).properties.clone()});return n.sheetManager.insertSheet(o),n.setActiveSheetId(t.sheetId),n};function w(e,t){var n=[[]];return 0===t.startRowIndex&&(n[0].push((0,f.qY)(e)),n[0].push([].concat((0,o.Z)((0,f.M5)(e,u.DIMENSION_TYPE.ROWS,0,e.getRowCount()-1)),(0,o.Z)((0,f.M5)(e,u.DIMENSION_TYPE.COLUMNS,0,e.getColCount()-1)))),n[0].push((0,f.bz)(e)),n[0].push((0,f.QT)(e,!0)),n[0].push((0,f.nn)(e)),n[0].push((0,f.Lu)(e)),n[0].push((0,f.Is)(e))),n[0].push((0,f.wV)(e,t.startRowIndex||0,Math.min(Number(t.endRowIndex),Number(t.rowCount)-1),0,e.getColCount()-1)),n}function x(e){if(e.length)try{var t=e.map((function(e){return JSON.stringify(e).substring(0,100)}));a.ZP.run(d.CONFIG.DO_MUTATIONS,t)}catch(n){console.error(n)}}function I(e){return"string"===typeof e?I(JSON.parse(e)):e}function C(e){var t=!1;return g(e).forEach((function(e){e.forEach((function(e){e.forEach((function(e){e.t===i.ZP.REORDER_RANGE_MUTATION&&(t=!0),e.t>=i.ZP.ADD_FILTER_VIEW_MUTATION&&e.t<i.ZP.ACTIVE_FILTER_VIEW_MUTATION&&(t=!0)}))}))})),t}},"../spread-sheet/src/core/data/converter/tencentdoc/utils/files.ts":function(e,t,n){"use strict";n.d(t,{Ey:function(){return b},Iv:function(){return p},LB:function(){return g},Ll:function(){return _},Qe:function(){return x},XE:function(){return o},kZ:function(){return v},oo:function(){return h}});var o,r=n("../node_modules/@babel/runtime/helpers/esm/toConsumableArray.js"),s=(n("../node_modules/core-js/modules/es.array.sort.js"),n("../node_modules/core-js/modules/es.array.filter.js"),n("../node_modules/core-js/modules/es.array.from.js"),n("../node_modules/core-js/modules/es.string.iterator.js"),n("../node_modules/core-js/modules/es.array.map.js"),n("../node_modules/core-js/modules/es.array.find-index.js"),n("../node_modules/core-js/modules/web.dom-collections.for-each.js"),n("../node_modules/core-js/modules/es.array.concat.js"),n("../node_modules/core-js/modules/es.function.name.js"),n("../node_modules/core-js/modules/es.regexp.exec.js"),n("../node_modules/core-js/modules/es.string.replace.js"),n("../node_modules/core-js/modules/es.number.is-nan.js"),n("../node_modules/core-js/modules/es.number.constructor.js"),n("../node_modules/i18next/dist/esm/i18next.js")),i=n("../packages/model/src/cell/index.ts"),a=n("../packages/model/src/range/index.ts"),d=n("../node_modules/lodash/padStart.js"),c=n.n(d),l=n("../packages/report/src/index.ts"),u=n("../packages/model/src/embedded/index.ts"),f=n("../packages/model/src/sheet/sheetUtils.ts"),m=n("../spread-sheet/src/core/app/sheetStatus/private-range.ts");function _(e,t,n){var r=Array.from(e.imageManager.imageMap).filter((function(n){var o=n[1];if(o.type!==u.EMBEDDED_OBJECT_TYPE.IMAGE)return!1;var r=o.position.overlayPosition.anchorCell,s=r.rowIndex,i=r.colIndex,d=new a.GridRange(e.getSheetId(),s,s,i,i);return t.some((function(e){return e.contain(d)}))})).sort((function(e,t){var n=e[1].position.overlayPosition,o=n.anchorCell,r=o.rowIndex,s=o.colIndex,i=n.offsetXpixels,a=n.offsetYpixels,d=t[1].position.overlayPosition,c=d.anchorCell,l=c.rowIndex,u=c.colIndex,f=d.offsetXpixels,m=d.offsetYpixels;return r-l||s-u||a-m||i-f}));return{files:r.map((function(e){var t=e[1],n=w(t);return{name:s.ZP.t("图片"),id:t.id,url:t.url,type:o.ATTACHED_IMAGE,clipStyle:n}})),currentIndex:n?r.findIndex((function(e){return e[1].id===n})):-1}}function p(e,t){return Array.from(e.imageManager.imageMap).some((function(n){var o=n[1];if(o.type!==u.EMBEDDED_OBJECT_TYPE.IMAGE)return!1;var r=o.position.overlayPosition.anchorCell,s=r.rowIndex,i=r.colIndex,d=new a.GridRange(e.getSheetId(),s,s,i,i);return t.some((function(e){return e.contain(d)}))}))}function h(e,t){for(var n=0;n<t.length;n++)if(e.getCellDatasAtRange(t[n]).some((function(t){return t.some((function(t){return(0,f.getCellImageByCellData)(e,t)}))})))return!0;return!1}function g(e,t,n,r){void 0===r&&(r=!0);var d=e.getSheetId(),c=e.getCellDatasAtRange(new a.GridRange(d)),l=[],u=-1;return c.forEach((function(r,c){r.forEach((function(r,f){if(r){var _=new a.GridRange(d,c,c,f,f);if(!t.every((function(e){return!e.contain(_)}))){var p=e.getCellImage(c,f,!1),h=!(0,m.xy)(e.spreadsheetReference,c,f);if(p&&h){var g=w(p);l.push({name:s.ZP.t("图片"),url:p.url,type:o.CELL_IMAGE,cellPosition:{row:c,col:f},clipStyle:g})}r.getHyperlinkType()===i.HYPERLINK_TYPE.IMAGE&&l.push({name:r.getFormattedValue().value,url:r.getHyperlink(),type:o.HYPERLINK_IMAGE}),n&&n.row===c&&n.col===f&&(u=l.length-1)}}}))})),{files:l,currentIndex:u}}function v(e,t,n){void 0===n&&(n=!1);var o=[].concat((0,r.Z)(g(e,t,null,!1).files),(0,r.Z)(_(e,t).files)),s=String(o.length).length;return o.forEach((function(t,o){var r=((n?e.getTitle()+"-":"")+c()(String(o+1),s,"0")+"-"+t.name).replace(/[/|\\:*?"<>]/g,"_");t.name=r})),o}function b(e,t){var n=function(e,t){return Array.from(e.hyperlinkManager.hyperlinkMap).some((function(n){var o=n[1];if(o.cellData.getHyperlinkType()!==i.HYPERLINK_TYPE.IMAGE)return!1;var r=o.rowIndex,s=o.colIndex,d=new a.GridRange(e.getSheetId(),r,r,s,s);return t.some((function(e){return e.contain(d)}))}))}(e,t);return!!n||e.imageManager.imageMap.size>0&&(!!p(e,t)||h(e,t))}!function(e){e[e.ATTACHED_IMAGE=0]="ATTACHED_IMAGE",e[e.HYPERLINK_IMAGE=1]="HYPERLINK_IMAGE",e[e.CELL_IMAGE=2]="CELL_IMAGE"}(o||(o={}));var w=function(e){var t=e.position.overlayPosition,n=t.widthPixels,o=t.heightPixels,r=e.clipInfo,s=r.clipBottom,i=r.clipLeft,a=r.clipRight,d=r.clipTop,c=n+i+a,l=o+d+s;if(!Number.isNaN(n)&&!Number.isNaN(o)&&(n/c!==1||o/l!==1))return{marginLeft:i/c,marginTop:d/l,width:n/c,height:o/l}};function x(e,t,n){var o=t?"rightclick_"+function(e){var t=e.selectQueue;return 1!==t.length?"range":t[0].selectRow?"row":t[0].selectCol?"column":"range"}(t):"menu";l.ZP.tdwReport({module:"download_photo",opername:"doc_excel_editor",action:"download_photo_"+e,ver10:n||o})}t.ZP=v},"../spread-sheet/src/core/feature/cellImage/cellImage.interface.ts":function(e,t,n){"use strict";n.d(t,{k:function(){return o}});var o=(0,n("../node_modules/@tencent/containerized/build/main/index.js").yh)("ICellImage")},"../spread-sheet/src/core/feature/copyPaste/clipboardCopy.ui.ts":function(e,t,n){"use strict";n.d(t,{ES:function(){return w},Hu:function(){return h},_Y:function(){return j},c_:function(){return b},e7:function(){return g},j9:function(){return y},jZ:function(){return v},px:function(){return I},q2:function(){return p}}),n("../node_modules/regenerator-runtime/runtime.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.promise.js"),n("../node_modules/core-js/modules/es.regexp.exec.js"),n("../node_modules/core-js/modules/es.string.replace.js"),n("../node_modules/core-js/modules/es.array.iterator.js"),n("../node_modules/core-js/modules/es.string.iterator.js"),n("../node_modules/core-js/modules/web.dom-collections.iterator.js");var o,r,s=n("../spread-sheet/src/core/feature/copyPaste/lib/clipboard.min.js"),i=n("../spread-sheet/src/core/feature/copyPaste/interfaces.ts"),a=n("../spread-sheet/src/core/feature/copyPaste/wxCopyPaste.ui.ts"),d=n("../spread-sheet/src/base/util/timer.ts"),c=n("../node_modules/@tencent/docs-user-agent/dist/index.js"),l=n.n(c),u=n("../spread-sheet/src/core/feature/copyPaste/lib/textarea.ui.ts"),f=function(e,t,n,o){return new(n||(n=Promise))((function(r,s){function i(e){try{d(o.next(e))}catch(t){s(t)}}function a(e){try{d(o.throw(e))}catch(t){s(t)}}function d(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,a)}d((o=o.apply(e,t||[])).next())}))},m={html:null,plain:null,json:null,timeStamp:0},_=u.Z.getSingleton();function p(e){return f(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return l().isMac&&_.select(),t.next=3,T();case 3:return n=t.sent,t.abrupt("return",n.writeInClipBoard(e));case 5:case"end":return t.stop()}}),t)})))}var h=function(){m={html:null,plain:null,json:null,timeStamp:0}},g=function(){return m},v=function(){return r},b=function(e,t,n,o){(m={html:e,plain:t,json:n}).timeStamp=Date.now(),function(e){r=e}(o)},w=function(e){var t=e.copyContent,o=e.type,r=t.html,i=t.plain,c=t.json,l=void 0===c?"":c;if(a.Z.isCopyOutEnv())return a.Z.copyToSystem(i),void b(r,i,l,o);try{s.Z.copy({"text/plain":i,"text/html":r,"text/json":l}).catch((function(e){console.error(e)})).then((function(){var e,t;0!==(null===(t=null===(e=null===n.g||void 0===n.g?void 0:n.g.tdocs)||void 0===e?void 0:e.compare)||void 0===t?void 0:t.call(e,"0"))&&d.Z.wait(0).run((function(){var e,t;r&&r.length>492426&&console.warn("安卓手Q可能写入富文本剪贴板失败"),null===(t=null===(e=n.g.tdocs)||void 0===e?void 0:e.setClipboardData)||void 0===t||t.call(e,{plain:i,html:r})})),b(r,i,l,o)}))}catch(u){}},x={html:"",plain:"",timeStamp:0},I=function(){return f(void 0,void 0,void 0,regeneratorRuntime.mark((function e(){var t,o,r,s,i,a,d,c;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!l().isQQMiniProgram){e.next=2;break}return e.abrupt("return",x);case 2:return e.prev=2,e.next=5,T();case 5:return r=e.sent,e.next=8,r.readInClipBoard();case 8:return s=e.sent,i=s.html,a=void 0===i?"":i,d=s.plain,c=void 0===d?"":d,a===x.html&&c===x.plain||(x.html=a,x.plain=c,x.timeStamp=Date.now()),null===(t=n.g.log)||void 0===t||t.log("readInClipBoard",x),e.abrupt("return",x);case 15:return e.prev=15,e.t0=e.catch(2),null===(o=n.g.log)||void 0===o||o.error("syncMobileClipboard error",e.t0),e.abrupt("return",x);case 19:case"end":return e.stop()}}),e,null,[[2,15]])})))};try{null===(o=n.g.mqq)||void 0===o||o.addEventListener("qbrowserVisibilityChange",(function(e){e.hidden||I()}))}catch(E){}var C,y=function(){return!(!x.html&&!x.plain||!x.timeStamp)},j=function(e,t,n,o){return!((null===n||void 0===n?void 0:n.length)>0||(null===o||void 0===o?void 0:o.length)>0)&&(!e&&!t||!function(e,t,n){return!e&&!n&&t&&v()===i.GI.input&&t===g().plain}(e,t,n)&&function(e,t){return!!m.html&&!!e&&-1!==e.indexOf(m.html)&&void 0!==m.html&&void 0!==m.plain&&t.replace(/\r\n/g,"\n")===m.plain.replace(/\r\n/g,"\n")}(e,t))};function T(){return f(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!C){e.next=2;break}return e.abrupt("return",C);case 2:return e.next=4,n.e("bundle_clipboard_lib").then(n.t.bind(n,"../node_modules/@tencent/clipboard/dist/index.js",23));case 4:return C=e.sent,e.abrupt("return",C);case 6:case"end":return e.stop()}}),e)})))}},"../spread-sheet/src/core/feature/copyPaste/copyPasteCache.ts":function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return h}});var o=n("../node_modules/@babel/runtime/helpers/esm/inheritsLoose.js"),r=(n("../node_modules/core-js/modules/es.string.anchor.js"),n("../node_modules/core-js/modules/es.object.assign.js"),n("../node_modules/core-js/modules/es.array.iterator.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/web.dom-collections.iterator.js"),n("../packages/report/src/index.ts")),s=n("../spread-sheet/src/core/feature/copyPaste/lib/smartSplit/SmartSplit.ts"),i=n("../spread-sheet/src/core/feature/copyPaste/interfaces.ts"),a=n("../spread-sheet/src/core/feature/copyPaste/copyPasteCacheBase.ts"),d=n("../spread-sheet/src/core/feature/copyPaste/core/copy-flow.ts"),c=n("../spread-sheet/src/core/feature/copyPaste/core/paste-flow.ts"),l=n("../node_modules/lodash/cloneDeep.js"),u=n.n(l),f=n("../spread-sheet/src/core/feature/copyPaste/core/subscribe-mutation.ts"),m=n("../spread-sheet/src/core/view/spreadsheet-view/table-view/utils.ts"),_=n("../spread-sheet/src/core/feature/copyPaste/utils/paste-request.ts"),p=n("../spread-sheet/src/core/app/sheetStatus/auth-range.ts"),h=function(e){function t(t){var n,o=t.spreadsheetApp,r=t.config;return(n=e.call(this,{spreadsheetApp:o,config:r})||this).subscribe(),n}(0,o.Z)(t,e);var n=t.prototype;return n.setIsFromOuter=function(e){this.isFromOuter=e},n.setPasteAnchor=function(e){this.anchor=e},n.getPasteAnchor=function(){return this.anchor},n.onCopy=function(e){var t=e.from,n=e.copyType,o=e.hotInstance,r=e.previewActiveSheetId,s=e.isSelectAll,i=(0,d.S)({hotInstance:o,previewActiveSheetId:r,from:t,copyType:n}),a=(0,d.T)({from:t,copyType:n,isSelectAll:s,hotInstance:o,previewActiveSheetId:r});return this.cacheData=i,this.cacheState=a,a.clipboardCopyData},n.onPaste=function(e){var t,n=this,o=e.activeSheetId,a=e.to,d=e.hotInstance,l=e.pasteData,f=e.cb,m=e.envs,_=this.cacheState,p=d.spreadsheet.activeSheet;if(o=o||d.spreadsheet.getActiveSheetId(),l=l||(this.cacheState.valid?this.cacheData:void 0),!(null===(l=u()(l))||void 0===l?void 0:l.rowDataUpdate)||void 0===l.rowDataUpdate[0])return!1;var h=u()(l),g=p.getBasicFilter(),v=(0,c.LC)(d.spreadsheet.sheetManager,d.spreadsheet.activeSheet,_,o,a,l,this.config,m);if(!1===v)return!1;var b=v.option,w=v.rowDataUpdate,x=v.useXYLen,I=v.fromCache,C=v.isCut,y=v.selectAreaCellRange,j=v.isFomulaInCut,T=b.toGridRange,E=T.startRowIndex,S=T.startColIndex,R=x.useXLen,A={style:[]},k=!(1!==R||!(0,s.IK)(d)),D=!1;return k&&(D=(0,s.IK)(d,!0)),this.applyPasteBehavior({pasteData:l,activeSheetId:o,basicFilter:g,option:b,toYStart:E,toXStart:S,rowDataUpdate:w,isFomulaInCut:j}),I&&(this.cacheState.pasteType=i.lb.copy,this.cacheState.hasDonePaste=!0),null===(t=d.view.canvas)||void 0===t||t.selectApi.selectCells(d.view.canvas.normalSelectData,y,null),C&&I&&d.feature.copyPaste&&(d.feature.copyPaste.copyPasteCache.cacheState.valid=!1),f&&(setTimeout((function(){f.call({pasteData:h,stateBefore:u()(A)},{hotInstance:d,active:Object.assign({},a),fromCache:I,pasteType:C?i.lb.cut:i.lb.copy,toCheckSmartSplit:k,isNewSheet:D,envs:m})})),r.ZP.tdwReport({module:"cut_copy_paste",opername:"doc_excel_editor",action:n.isCut?"cut_copy_paste_cut_click":"cut_copy_paste_paste_sucess"})),!0},n.cancelCopy=function(){this.spreadsheetApp.spreadsheet.sheetManager.getSheetBySheetId(this.cacheState.sheetId)&&(this.cacheState.cutRange&&(this.cacheState.cutRange=null),this.cacheState.copyRange&&(this.cacheState.copyRange=null))},n.getCacheData=function(){return this.cacheData},n.getCacheState=function(){return this.cacheState},n.setStateCopyData=function(e){this.cacheState.clipboardCopyData=e},n.setCacheData=function(e){this.cacheData=e},n.setValid=function(e){this.cacheState.valid=e},n.applyPasteBehavior=function(e){var t,n=e.pasteData,o=e.activeSheetId,s=e.basicFilter,i=e.option,a=e.toYStart,d=e.toXStart,c=e.rowDataUpdate,l=e.isFomulaInCut,u=window.performance.now(),f=this.cacheState,h=i.copyRange;if((0,_.i)({pasteData:n,cacheState:f,basicFilter:s,activeSheetId:o,cellImage:null===(t=i.propsKeys)||void 0===t?void 0:t.cellImage,copyRange:i.copyRange,pasteRanges:i.pasteRanges,infoDimension:i.infoDimension,workbookRangeManager:this.spreadsheetApp.spreadsheet.workbookRangeManager,isFormatPainter:this.config.isFormatPainter,isFomulaInCut:l})&&!(0,p.Nb)(this.spreadsheetApp,h?[h]:[])){this.spreadsheetApp.requestApi.insideSheetCopyPaste(Object.assign({copyPasteMutationsOptions:{copyRange:i.copyRange}},i));var g=window.performance.now(),v=Math.round(g-u);r.ZP.tdwReport({module:"cut_copy_paste",opername:"doc_excel_editor",action:"inside_sheet_copy_paste",ver5:v})}else{this.spreadsheetApp.requestApi.applyPasteData(Object.assign({gridData:{startRow:a,startCol:d,rowData:c,rowMetadata:[],colMetadata:[]}},i));var b=window.performance.now(),w=Math.round(b-u);r.ZP.tdwReport({module:"cut_copy_paste",opername:"doc_excel_editor",action:"apply_paste_data",ver5:w})}if(h){for(var x=!1,I=this.spreadsheetApp.spreadsheet.sheetManager.getSheetBySheetId(h.sheetId),C=h.startColIndex;C<h.endColIndex;C++)for(var y=h.startRowIndex;y<h.endRowIndex;y++)if((0,m.Tk)(I,y,C)){x=!0;break}x&&r.ZP.kvrOss({itemname:"xls_dropdown_copypaste"})}var j=!1;null===c||void 0===c||c.some((function(e){var t;return null===(t=null===e||void 0===e?void 0:e.values)||void 0===t?void 0:t.some((function(e){var t;return!!(null===(t=null===e||void 0===e?void 0:e.getHyperlinkRuns())||void 0===t?void 0:t.length)&&(j=!0,!0)}))})),j&&r.ZP.kvrOss({itemname:"xls_rangelink_paste_samefile"})},n.subscribe=function(){var e=this;this.spreadsheetApp.mutationBehavior.emitter.addListener(this.spreadsheetApp.mutationBehavior.EVENT.AFTER_MUTATION_RUN,(function(t){e.cacheState=(0,f.a)(t,e.cacheState)}))},t}(a.Z)},"../spread-sheet/src/core/feature/copyPaste/interfaces.ts":function(e,t,n){"use strict";n.d(t,{GI:function(){return c},Gu:function(){return o},P0:function(){return l},XE:function(){return a},gN:function(){return i},lb:function(){return d},lr:function(){return r},o_:function(){return s},yM:function(){return f}});var o,r,s,i,a,d,c,l,u=n("../node_modules/@tencent/containerized/build/main/index.js");!function(e){e.TEXT="text/plain",e.HTML="text/html",e.IMAGE="image/png",e.JPEG="image/jpeg"}(o||(o={})),function(e){e.all="all",e.row="row",e.col="col",e.cells="cells"}(r||(r={})),function(e){e[e.tencent=0]="tencent",e[e.excel=1]="excel",e[e.unknown=2]="unknown"}(s||(s={})),function(e){e[e.COPY_CACHE=0]="COPY_CACHE",e[e.OUTER=1]="OUTER",e[e.TRANSPOSE=2]="TRANSPOSE",e[e.ONLYVALUE=3]="ONLYVALUE",e[e.CLEAR_AUTO_PARSE=4]="CLEAR_AUTO_PARSE",e[e.MERGE_STYLES=5]="MERGE_STYLES"}(i||(i={})),function(e){e[e.illegal=-1]="illegal",e[e.richText=3]="richText",e[e.text=4]="text"}(a||(a={})),function(e){e[e.copy=0]="copy",e[e.cut=1]="cut"}(d||(d={})),function(e){e[e.table=1]="table",e[e.shapes=2]="shapes",e[e.input=3]="input"}(c||(c={})),function(e){e[e.NONE=1]="NONE",e[e.CACHE=2]="CACHE",e[e.CLIPBOARD=3]="CLIPBOARD"}(l||(l={}));var f=(0,u.yh)("ICopyPaste")},"../spread-sheet/src/core/feature/copyPaste/lib/DimemsionMemu/DimensionMenu.ts":function(e,t,n){"use strict";n.d(t,{X4:function(){return s},c2:function(){return i}}),n("../node_modules/core-js/modules/es.object.assign.js");var o=n("../packages/model/src/range/DimensionRange.ts"),r=n("../packages/model/src/dimension/DimensionType.ts");function s(e){var t=e.currentSelect,n=e.pasteData,s=e.cutDataSheetId,i=e.activeSheetId,a=e.dimensionType,d=e.cacheState,c=e.isSingle,l=function(e){var t=e.currentSelect,n=e.cutDataSheetId,s=e.activeSheetId,i=e.dimensionType,a=e.cacheStateFrom,d=e.isSingle,c=(i==r.Z.ROWS?t.yRange:t.xRange)[0],l=[],u=i==r.Z.ROWS?a.yRange:a.xRange,f=u[0],m=u[1],_=m-f+1,p=m-f+c;d||(n==s&&c<f&&(f+=_,m+=_),l=[new o.Z(n,f,m,i)]);var h={deleteDimensionRanges:l,insertDimensionRanges:[new o.Z(s,c,p,i)]},g=i==r.Z.ROWS?a.xRange:a.yRange;return{infoDimension:h,range:{xRange:i==r.Z.ROWS?g:[c,p],yRange:i==r.Z.ROWS?[c,p]:g}}}({currentSelect:t,cutDataSheetId:s,activeSheetId:i,dimensionType:a,cacheStateFrom:d.from,isSingle:c}),u=l.infoDimension,f=l.range,m=Object.assign({},n);return m.infoDimension=u,{pasteData:m,range:f}}function i(e){var t=e.currentSelect,n=e.pasteData,s=function(e){var t=e.currentSelect,n=e.activeSheetId,s=e.dimensionType,i=e.cacheStateFrom,a=(s==r.Z.ROWS?t.yRange:t.xRange)[0],d=s==r.Z.ROWS?i.yRange:i.xRange,c=d[0],l=d[1]-c+a,u={insertDimensionRanges:[new o.Z(n,a,l,s)]},f=s==r.Z.ROWS?i.xRange:i.yRange;return{infoDimension:u,range:{xRange:s==r.Z.ROWS?f:[a,l],yRange:s==r.Z.ROWS?[a,l]:f}}}({currentSelect:t,activeSheetId:e.activeSheetId,dimensionType:e.dimensionType,cacheStateFrom:e.cacheState.from}),i=s.infoDimension,a=s.range,d=Object.assign({},n);return d.infoDimension=i,{pasteData:d,range:a}}},"../spread-sheet/src/core/feature/copyPaste/lib/smartSplit/transformDataSP.ts":function(e,t,n){"use strict";n.d(t,{U:function(){return l},pd:function(){return _}});var o=n("../node_modules/@babel/runtime/helpers/esm/toConsumableArray.js"),r=(n("../node_modules/core-js/modules/es.object.keys.js"),n("../node_modules/core-js/modules/es.array.concat.js"),n("../node_modules/core-js/modules/es.array.sort.js"),n("../node_modules/core-js/modules/es.string.trim.js"),n("../node_modules/core-js/modules/es.object.assign.js"),n("../node_modules/core-js/modules/es.array.splice.js"),n("../node_modules/core-js/modules/es.array.map.js"),n("../packages/model/src/cell/CellData.ts")),s=n("../packages/model/src/cell/ExtendedValueType.ts"),i=n("../spread-sheet/src/core/feature/copyPaste/interfaces.ts"),a=n("../packages/model/src/cell/format/WrapStrategy.ts"),d=n("../packages/model/src/cell/ExtendedValue.ts"),c=n("../packages/model/src/cell/CellFormat.ts");function l(e,t){void 0===t&&(t=[]);for(var n=[],r=[],s=[],i=0,a=e.length,d=0;d<a;d++){var c=e[d],l=Object.keys(c);m.apply(void 0,[l,"prefix","suffix","num"].concat((0,o.Z)(t))),l.sort((function(e,t){return e-t})),l.length<1||(r[d]=l,i=Math.max(c[l[0]].length,i))}if(i<1)return[n,n.length,i,s];for(var f=0;f<a;f++){var _=r[f],p=_.length;if(_||!(p<1)){var h=e[f],g=h.prefix,v=h.suffix;g&&""!==g.trim()&&(n.push([g].concat((0,o.Z)(u(i-1,"")))),s.push(n.length-1));for(var b=u(i-h[_[0]].length,""),w=0;w<p;w++)n.push([].concat((0,o.Z)(h[_[w]]),(0,o.Z)(b)));v&&""!==v.trim()&&(n.push([v].concat((0,o.Z)(u(i-1,"")))),s.push(n.length-1)),r[f+1]&&r[f+1].length>0&&(n.push((0,o.Z)(u(i,""))),n.push((0,o.Z)(u(i,""))))}}return[n,n.length,i,s]}function u(e,t){var n=[];t&&"object"===typeof t&&(t=Object.assign({},t));for(var o=0;o<e;o++)n.push(t);return n}function f(e,t,n){for(var o=[],r=0;r<e;r++)o.push(u(t,n));return o}function m(e){for(var t=0;t<(arguments.length<=1?0:arguments.length-1);t++){var n=e.indexOf(t+1<1||arguments.length<=t+1?void 0:arguments[t+1]);-1!==n&&e.splice(n,1)}}function _(e){var t=e[0],n=e[1],o=e[2],l=e[3],u=t.map((function(e,t){var n=-1!==l.indexOf(t);return{values:e.map((function(e){var t={wrapStrategy:n?a.Z.OVERFLOW_CELL:null},o=c.Z.createInstance(t),i=d.Z.createInstance({type:s.Z.STRING,value:e});return new r.Z({userEnteredFormat:o,effectiveValue:i})}))}}));return{isSingle:!1,isMerge:!1,merge:f(n,o,!1),formula:f(n,o,null),fromType:1,images:[],rowDataUpdate:u,fromApp:i.o_.tencent,select:{selectAll:!1,selectCol:!1,selectRow:!1},containTable:!0}}t.ZP=function(e){return _(l(e))}},"../spread-sheet/src/core/feature/copyPaste/utils/onPaste.ts":function(e,t,n){"use strict";n.d(t,{AZ:function(){return h},Ci:function(){return m},FU:function(){return d},RD:function(){return p},U4:function(){return g},_l:function(){return _},iI:function(){return u},kg:function(){return l},lY:function(){return c},tK:function(){return a}}),n("../node_modules/core-js/modules/es.array.map.js"),n("../node_modules/core-js/modules/es.array.concat.js"),n("../node_modules/core-js/modules/web.dom-collections.for-each.js"),n("../node_modules/core-js/modules/es.array.iterator.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/web.dom-collections.iterator.js"),n("../node_modules/core-js/modules/es.map.js"),n("../node_modules/core-js/modules/es.string.iterator.js"),n("../node_modules/core-js/modules/esnext.map.delete-all.js"),n("../node_modules/core-js/modules/esnext.map.every.js"),n("../node_modules/core-js/modules/esnext.map.filter.js"),n("../node_modules/core-js/modules/esnext.map.find.js"),n("../node_modules/core-js/modules/esnext.map.find-key.js"),n("../node_modules/core-js/modules/esnext.map.includes.js"),n("../node_modules/core-js/modules/esnext.map.key-of.js"),n("../node_modules/core-js/modules/esnext.map.map-keys.js"),n("../node_modules/core-js/modules/esnext.map.map-values.js"),n("../node_modules/core-js/modules/esnext.map.merge.js"),n("../node_modules/core-js/modules/esnext.map.reduce.js"),n("../node_modules/core-js/modules/esnext.map.some.js"),n("../node_modules/core-js/modules/esnext.map.update.js");var o=n("../packages/model/src/range/gridRangeUtils.ts"),r=n("../spread-sheet/src/core/feature/copyPaste/interfaces.ts"),s=n("../packages/model/src/range/GridRange.ts"),i=n("../spread-sheet/src/core/utils/selection.ts"),a=function(e,t){if(!e.fromOuterContentType){var n=t.from;return new s.Z(t.sheetId,n.yRange[0],n.yRange[1],n.xRange[0],n.xRange[1])}},d=function(e,t){return e&&t.pasteType===r.lb.cut},c=function(e){return!e||e.fromType===r.gN.COPY_CACHE||e.fromType===r.gN.TRANSPOSE},l=function(e,t){return e.map((function(e){var n=e.length;return e.concat(new Array(t-n))}))},u=function(e){var t=e.toGridRange,n=e.useXYLen,o=e.crossFilterRow,s=e.changeRowProps,i=e.changeColProps,a=e.pasteData,d=t.clone(),c=d=f(a,d),l=c.startRowIndex,u=c.startColIndex,m=n.useXLen,_=n.useYLen,p={};return a.fromApp!==r.o_.tencent?(p.xRange=[u,Math.max(u+m-1,u)],p.yRange=[l,Math.max(l+_-1+o,l)],p):(s||(p.xRange=[u,Math.max(u+m-1,u)]),i||(p.yRange=[l,Math.max(l+_-1+o,l)]),p)},f=function(e,t){var n=e.infoDimension;return(null===n||void 0===n?void 0:n.deleteDimensionRanges)&&n.deleteDimensionRanges.forEach((function(e){var n=e.startIndex,o=e.endIndex,r=e.dimension,s=e.sheetId;t.deleteDimension({sheetId:s,type:r,amount:o-n+1,index:n})})),t},m=function(e,t,n,o){var r=!1;return t.isSingle&&n.isSingle&&(r=!t.isMerge||n.isMerge),!1===e&&1===o.useXLen&&1===o.useYLen&&(r=!0),r},_=function(e,t,n,o,r,s){var i,a,d=t.startRowIndex,c=t.startColIndex,l=n.fromXLen,u=n.fromYLen,f=r.repeatX,m=r.repeatY,_=o.toXLen,p=o.toYLen;if((null===s||void 0===s?void 0:s.tile)||1===_&&1===p)i=f*l,a=m*u;else if(null===s||void 0===s?void 0:s.isFormatPainter){var h=e.getColCount();i=_,a=p,d+u-1>=e.getRowCount()&&(i=l),c+l-1>=h&&(a=u)}else i=_,a=p;return{useXLen:i,useYLen:a}},p=function(e,t,n){var o={isSingle:t.isSingle,isMerge:t.isMerge},r=e.getCellDataAtPosition(n.startRowIndex,n.startColIndex),s=(0,i.rangeIsMergeCell)(n,r),a={isSingle:!1,isMerge:!1};return(n.isSingle()||s)&&(a={isSingle:!0,isMerge:s}),{fromGridRangeType:o,toGridRangeType:a}},h=function(e,t,n){var o=1,r=1;return n&&(o=e.fromXLen<t.toXLen?t.toXLen/e.fromXLen>>0:1,r=e.fromYLen<t.toYLen?t.toYLen/e.fromYLen>>0:1),{repeatX:o,repeatY:r}},g=function(e,t,n,r,s,i){var a=t.from,d=(0,o.convertXYRangeToDimensionRanges)(a,n),c=(0,o.convertDimensionRangesToGridRange)(d),l=(0,o.convertXYRangeToDimensionRanges)(r,n),u=(0,o.convertDimensionRangesToGridRange)(l),f=u.startColIndex,m=u.endColIndex;return{fromGridRange:c,fromGridRangeLen:{fromXLen:s.rowDataUpdate[0].values.length,fromYLen:s.rowDataUpdate.length},toGridRange:u,toGridRangeLen:{toXLen:m-f+1,toYLen:v(e,u,i)}}},v=function(e,t,n){for(var o=1,r=t.startRowIndex,s=t.endRowIndex,i=e.getBasicFilter(),a=i?i.getHiddenRowMap():new Map,d=r;d<s;d++)n?o+=1:a.get(d)||(o+=1);return o}},"../spread-sheet/src/core/feature/dataValidation/DVInterface.ts":function(e,t,n){"use strict";n.d(t,{Bb:function(){return a},Ju:function(){return c},UD:function(){return d},c1:function(){return l},h6:function(){return s.h6},ob:function(){return s.ob},y3:function(){return i}}),n("../node_modules/core-js/modules/es.array.iterator.js"),n("../node_modules/core-js/modules/es.map.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.string.iterator.js"),n("../node_modules/core-js/modules/esnext.map.delete-all.js"),n("../node_modules/core-js/modules/esnext.map.every.js"),n("../node_modules/core-js/modules/esnext.map.filter.js"),n("../node_modules/core-js/modules/esnext.map.find.js"),n("../node_modules/core-js/modules/esnext.map.find-key.js"),n("../node_modules/core-js/modules/esnext.map.includes.js"),n("../node_modules/core-js/modules/esnext.map.key-of.js"),n("../node_modules/core-js/modules/esnext.map.map-keys.js"),n("../node_modules/core-js/modules/esnext.map.map-values.js"),n("../node_modules/core-js/modules/esnext.map.merge.js"),n("../node_modules/core-js/modules/esnext.map.reduce.js"),n("../node_modules/core-js/modules/esnext.map.some.js"),n("../node_modules/core-js/modules/esnext.map.update.js"),n("../node_modules/core-js/modules/web.dom-collections.iterator.js");var o=n("../node_modules/i18next/dist/esm/i18next.js"),r=n("../packages/model/src/index.ts"),s=n("../spread-sheet/src/core/feature/dataValidation/type.ts"),i=new Map([[r.Cell.DATA_VALIDATION_CONDITION_TYPE.BETWEEN,o.ZP.t("介于")],[r.Cell.DATA_VALIDATION_CONDITION_TYPE.NOT_BETWEEN,o.ZP.t("不介于")],[r.Cell.DATA_VALIDATION_CONDITION_TYPE.EQUAL,o.ZP.t("等于")],[r.Cell.DATA_VALIDATION_CONDITION_TYPE.NOT_EQUAL,o.ZP.t("不等于")],[r.Cell.DATA_VALIDATION_CONDITION_TYPE.LESS,o.ZP.t("早于")],[r.Cell.DATA_VALIDATION_CONDITION_TYPE.LESS_EQUAL,o.ZP.t("不晚于")],[r.Cell.DATA_VALIDATION_CONDITION_TYPE.GREAT,o.ZP.t("晚于")],[r.Cell.DATA_VALIDATION_CONDITION_TYPE.GREAT_EQUAL,o.ZP.t("不早于")]]),a=new Map([[r.Cell.DATA_VALIDATION_CONDITION_TYPE.BETWEEN,o.ZP.t("介于")],[r.Cell.DATA_VALIDATION_CONDITION_TYPE.NOT_BETWEEN,o.ZP.t("不介于")],[r.Cell.DATA_VALIDATION_CONDITION_TYPE.EQUAL,o.ZP.t("等于")],[r.Cell.DATA_VALIDATION_CONDITION_TYPE.NOT_EQUAL,o.ZP.t("不等于")],[r.Cell.DATA_VALIDATION_CONDITION_TYPE.LESS,o.ZP.t("小于")],[r.Cell.DATA_VALIDATION_CONDITION_TYPE.LESS_EQUAL,o.ZP.t("小于或等于")],[r.Cell.DATA_VALIDATION_CONDITION_TYPE.GREAT,o.ZP.t("大于")],[r.Cell.DATA_VALIDATION_CONDITION_TYPE.GREAT_EQUAL,o.ZP.t("大于或等于")],[r.Cell.DATA_VALIDATION_CONDITION_TYPE.INCLUDE,o.ZP.t("包括")],[r.Cell.DATA_VALIDATION_CONDITION_TYPE.NOT_INCLUDE,o.ZP.t("不包括")]]),d=new Map([[r.Cell.DATA_VALIDATION_CONDITION_TYPE.BETWEEN,o.ZP.t("介于")],[r.Cell.DATA_VALIDATION_CONDITION_TYPE.NOT_BETWEEN,o.ZP.t("不介于")],[r.Cell.DATA_VALIDATION_CONDITION_TYPE.EQUAL,o.ZP.t("等于")],[r.Cell.DATA_VALIDATION_CONDITION_TYPE.NOT_EQUAL,o.ZP.t("不等于")],[r.Cell.DATA_VALIDATION_CONDITION_TYPE.LESS,o.ZP.t("小于")],[r.Cell.DATA_VALIDATION_CONDITION_TYPE.LESS_EQUAL,o.ZP.t("小于或等于")],[r.Cell.DATA_VALIDATION_CONDITION_TYPE.GREAT,o.ZP.t("大于")],[r.Cell.DATA_VALIDATION_CONDITION_TYPE.GREAT_EQUAL,o.ZP.t("大于或等于")]]),c=new Map([[s.h6.NONE,o.ZP.t("数值")],[s.h6.INT,o.ZP.t("整数")],[s.h6.FLOAT,o.ZP.t("小数")]]),l=new Map([[s.h6.ID_CARD,o.ZP.t("身份证号")],[s.h6.MAIL,o.ZP.t("邮箱")],[s.h6.PHONE,o.ZP.t("手机号")],[s.h6.TELEPHONE,o.ZP.t("电话号码")]])},"../spread-sheet/src/core/feature/dataValidation/constant.ts":function(e,t,n){"use strict";n.d(t,{XY:function(){return x},cM:function(){return r},rX:function(){return w}}),n("../node_modules/core-js/modules/es.array.map.js"),n("../node_modules/core-js/modules/es.object.keys.js");var o,r,s=n("../node_modules/i18next/dist/esm/i18next.js"),i=n("../packages/model/src/cell/metadata/CustomDataType.ts"),a=n("../packages/model/src/cell/index.ts"),d=n("../node_modules/@tencent/docs-design-resources/pc/svg/data_temperature.svg"),c=n("../node_modules/@tencent/docs-design-resources/pc/svg/data_checkbox.svg"),l=n("../node_modules/@tencent/docs-design-resources/pc/svg/data_date31.svg"),u=n("../node_modules/@tencent/docs-design-resources/pc/svg/data_dropdown.svg"),f=n("../node_modules/@tencent/docs-design-resources/pc/svg/data_email.svg"),m=n("../node_modules/@tencent/docs-design-resources/pc/svg/data_idcard.svg"),_=n("../node_modules/@tencent/docs-design-resources/pc/svg/data_number.svg"),p=n("../node_modules/@tencent/docs-design-resources/pc/svg/data_phonenumber.svg"),h=n("../node_modules/@tencent/docs-design-resources/pc/svg/data_telephonenumber.svg"),g=n("../node_modules/@tencent/docs-design-resources/pc/svg/data_progress.svg"),v=n("../node_modules/@tencent/docs-design-resources/pc/svg/data_star.svg"),b=n("../node_modules/@tencent/docs-design-resources/pc/svg/data_text.svg");!function(e){e.SELECT="select",e.CHECKBOX="checkbox",e.STAR="star",e.PROGRESS="progress",e.ID_CARD="id-card",e.PHONE_NUMBER="phone-number",e.TELEPHONE_NUMBER="telephone-number",e.EMAIL="email",e.NUMBER="number",e.TEXT="text",e.DATE_TIME="date-time",e.TEMPERATURE="temperature"}(r||(r={}));var w=((o={})[r.SELECT]={icon:u,iconName:"data_validation_list",text:s.ZP.t("下拉选项"),customDataType:i.ZP.SELECT,ruleType:a.DATA_VALIDATION_RULE_TYPE.LIST},o[r.CHECKBOX]={icon:c,iconName:"data_validation_checkbox",text:s.ZP.t("复选框"),customDataType:i.ZP.CHECKBOX,ruleType:a.DATA_VALIDATION_RULE_TYPE.CUSTOM_CHECKBOX},o[r.STAR]={icon:v,iconName:"data_validation_star",text:s.ZP.t("评星"),customDataType:i.ZP.STAR,ruleType:a.DATA_VALIDATION_RULE_TYPE.CUSTOM_STAR},o[r.PROGRESS]={icon:g,iconName:"data_validation_progress",text:s.ZP.t("进度"),customDataType:i.ZP.PROGRESS,ruleType:a.DATA_VALIDATION_RULE_TYPE.CUSTOM_PROGRESS},o[r.ID_CARD]={icon:m,iconName:"data_validation_idcard",text:s.ZP.t("身份证"),customDataType:i.ZP.ID,ruleType:a.DATA_VALIDATION_RULE_TYPE.CUSTOM_ID_CARD},o[r.PHONE_NUMBER]={icon:p,iconName:"data_validation_phone",text:s.ZP.t("手机号"),customDataType:i.ZP.PHONE_NUM,ruleType:a.DATA_VALIDATION_RULE_TYPE.CUSTOM_NUM_PHONE},o[r.TELEPHONE_NUMBER]={icon:h,iconName:"data_validation_telephone",text:s.ZP.t("电话号码"),customDataType:i.ZP.TELEPHONE_NUM,ruleType:a.DATA_VALIDATION_RULE_TYPE.CUSTOM_NUM_TEL},o[r.EMAIL]={icon:f,iconName:"data_validation_mail",text:s.ZP.t("电子邮箱"),customDataType:i.ZP.EMAIL,ruleType:a.DATA_VALIDATION_RULE_TYPE.CUSTOM_TEXT_MAIL},o[r.NUMBER]={icon:_,iconName:"data_validation_number",text:s.ZP.t("数字"),customDataType:i.ZP.NUMBER,ruleType:a.DATA_VALIDATION_RULE_TYPE.NUMBER_FLOAT_AND_INT},o[r.TEXT]={icon:b,iconName:"data_validation_text",text:s.ZP.t("文本内容/长度"),customDataType:i.ZP.TEXT,ruleType:a.DATA_VALIDATION_RULE_TYPE.CUSTOM_TEXT_CONTAINS},o[r.DATE_TIME]={icon:l,iconName:"data_validation_date",text:s.ZP.t("时间日期"),customDataType:i.ZP.DATE_TIME,ruleType:a.DATA_VALIDATION_RULE_TYPE.DATE},o[r.TEMPERATURE]={icon:d,iconName:"data_validation_temperature",text:s.ZP.t("温度"),customDataType:i.ZP.TEMPERATURE,ruleType:a.DATA_VALIDATION_RULE_TYPE.CUSTOM_NUMBER_TEMPERATURE},o),x=Object.keys(w).map((function(e){return{id:e,text:w[e].text,icon:w[e].icon}}))},"../spread-sheet/src/core/feature/edit-feature.interface.ts":function(e,t,n){"use strict";n.d(t,{g:function(){return o}});var o=(0,n("../node_modules/@tencent/containerized/build/main/index.js").yh)("IEditFeature")},"../spread-sheet/src/core/feature/formula/UIUtils.ts":function(e,t,n){"use strict";function o(e){if("string"===typeof e&&r(e)){var t=e.replace(/(")[^"]*?\1/g,"");t=(t=t.replace(/'.*?'!/g,"")).replace(/\n$/g,"");for(var n=0,o=0,s=0;s<t.length;++s)"("===t[s]?n+=1:")"===t[s]&&(o+=1);n-o===1&&(e+=")")}return e}function r(e){return"string"===typeof e&&"="===e[0]&&e.length>1}n.d(t,{$:function(){return o},j:function(){return r}}),n("../node_modules/core-js/modules/es.regexp.exec.js"),n("../node_modules/core-js/modules/es.string.replace.js")},"../spread-sheet/src/core/feature/formula/autofix.ts":function(e,t,n){"use strict";n.d(t,{wh:function(){return c}}),n("../node_modules/core-js/modules/es.regexp.exec.js"),n("../node_modules/core-js/modules/es.string.replace.js"),n("../node_modules/core-js/modules/es.string.match.js"),n("../node_modules/core-js/modules/web.dom-collections.for-each.js"),n("../node_modules/core-js/modules/es.object.keys.js"),n("../node_modules/core-js/modules/es.string.split.js"),n("../node_modules/core-js/modules/es.string.trim.js"),n("../node_modules/core-js/modules/es.array.join.js"),n("../node_modules/core-js/modules/es.array.map.js"),n("../node_modules/core-js/modules/es.array.filter.js");var o=n("../packages/model/src/cell/formula/formulaUtils.ts"),r=n("../packages/model/src/sheet/sheetUtils.ts"),s=n("../spread-sheet/src/core/feature/formula/utils.ts"),i={"＝":{reg:/[＝]/g,target:"="},"（":{reg:/[（]/g,target:"("},"）":{reg:/[）]/g,target:")"},"，":{reg:/[，]/g,target:","},"：":{reg:/[：]/g,target:":"},"；":{reg:/[；]/g,target:";"},"！":{reg:/[！]/g,target:"!"},"／":{reg:/[／]/g,target:"/"},"　":{reg:/[　]/g,target:" "}};function a(e,t,n){return e=function(e){return~e.indexOf(" (")?e.replace(/[A-Z]+\s+\(/g,(function(e){return e.replace(/\s+/,"")})):e}(e=function(e,t){return Object.keys(i).forEach((function(n){t.indexOf(n)>=0||(e=e.replace(i[n].reg,i[n].target))})),e}(e,n)),e=function(e,t){return t.forEach((function(t){e=(e=e.split(t.toUpperCase()+"!").join(t+"!")).split(t.toUpperCase()+":").join(t+":")})),e}(e=function(e){var t=e;try{if(t.match(/ID/i)){var n=/ID\(\s*((\d{17}x)|(\d{18})|(\d{15})|([a-zA-Z]\d+))s*,\s*\)/gi,o=t.match(n);null===o||void 0===o||o.map((function(e){var n=(e.match(/(\d+x|\d+)\s*,/i)||[])[0];t=t.replace(n,n+"0")})),n=/ID\(\s*((\d{17}x)|(\d{18})|(\d{15}|([a-zA-Z]\d+)))\s*\)/gi,null===(o=t.match(n))||void 0===o||o.map((function(e){var n=(e.match(/(\d+x|\d+)\s*/i)||[])[0];t=t.replace(n,n+",0")}))}}catch(r){}return t}(e=function(e){var t=e;if(t.match(/STOCK/i)){var n=t.match(/STOCK\(\s*(\d+\.\w+)\s*(,\s*)?\)/gi);null===n||void 0===n||n.map((function(){t=t.replace(/(\d+\.\w+)\s*(,\s*)?\)/i,(function(e){return e.replace(/(,\s*)?\)/i,",0)")}))}))}return t}(e=function(e){if(!~e.indexOf(","))return e;var t=e.split(",");return t.forEach((function(e,n){(0===n||e.trim())&&(t[n]=e.replace(/(\s+$)/,""))})),t.join(",")}(e=(0,o.makeSelectionInOrder)(e)))),t),e}function d(e,t){e=function(e){return e.toUpperCase()}(e);var n=t.filter((function(e){return(0,r.isSheetTitleValidateForCrossSheet)(e)})),o=t.join(""),s=/('.*?'!)/;if(s.test(e)){var i=e.split(s)||[];i.forEach((function(e,r){s.test(e)?(t.forEach((function(t){var n=t.toUpperCase();e=(e=(e=e.replace("'"+n+":",(function(){return"'"+t+":"}))).replace(":"+n+"'!",(function(){return":"+t+"'!"}))).replace("'"+n+"'!",(function(){return"'"+t+"'!"}))})),i[r]=e):i[r]=a(e,n,o)})),e=i.join("")}else e=a(e,n,o);return e}function c(e,t){if(!(0,s.jr)(e))return e;var n=e;n=(0,s.$8)(n);var o=/(".*?")/;if(o.test(n)){var r=n.split(o)||[];r.forEach((function(e,n){var s=o.test(e);r[n]=s?e:d(e,t)})),n=r.join("")}else n=d(n,t);return n=function(e){var t=e;return e.indexOf("STOCK")>-1&&/(stock)(?=\()/gi.test(t)&&(t=t.replace(/STOCK\((\w+(\.\w+)+),([^)]+)\)/i,'STOCK("$1",$3)')),t}(n),n=function(e){if(-1===e.indexOf("ID("))return e;var t=e;try{var n=e.match(/ID\(\s*((\d{17}x)|(\d{18})|(\d{15}))\s*,/gi);null===n||void 0===n||n.forEach((function(n){var o=n.match(/(\d+x|\d+)/i)[0];t=e.replace(o,'"'+o+'"')}))}catch(o){console.error("退出身份证解析",o)}return t}(n),n}},"../spread-sheet/src/core/feature/formula/utils.ts":function(e,t,n){"use strict";n.d(t,{$8:function(){return d.$},AE:function(){return x},Ad:function(){return O},Ak:function(){return h},F7:function(){return y},Gs:function(){return k},H_:function(){return w},Jn:function(){return P},L:function(){return p},Nl:function(){return T},OA:function(){return _},Zb:function(){return A},cn:function(){return b},e_:function(){return S},fA:function(){return c.f},i1:function(){return D},i7:function(){return R},jr:function(){return d.j},k1:function(){return v},o8:function(){return E},ps:function(){return I},sy:function(){return j},tI:function(){return g}}),n("../node_modules/core-js/modules/es.regexp.exec.js"),n("../node_modules/core-js/modules/es.string.match.js"),n("../node_modules/core-js/modules/es.string.replace.js"),n("../node_modules/core-js/modules/web.dom-collections.for-each.js"),n("../node_modules/core-js/modules/es.object.keys.js"),n("../node_modules/core-js/modules/es.regexp.constructor.js"),n("../node_modules/core-js/modules/es.regexp.to-string.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.promise.js"),n("../node_modules/core-js/modules/es.string.split.js"),n("../node_modules/core-js/modules/es.array.join.js"),n("../node_modules/core-js/modules/es.array.map.js");var o,r=n("../node_modules/i18next/dist/esm/i18next.js"),s=n("../packages/model/src/cell/ExtendedValueType.ts"),i=n("../packages/model/src/utils/numberFormat/FormatParseEngine.ts"),a=n("../packages/model/src/range/hexRangeUtils.ts"),d=n("../spread-sheet/src/core/feature/formula/UIUtils.ts"),c=n("../spread-sheet/src/core/feature/formula/workUtils.ts"),l=(n("../packages/model/src/cell/ExtendedValue.ts"),n("../packages/model/src/cell/ErrorType.ts")),u=n("../packages/model/src/range/index.ts"),f=n("../node_modules/@tencent/sheet-formula-sdk/lib/index.js"),m=n("../packages/mutation/src/MutationId.ts"),_={"#NULL":r.ZP.t("空值错误。"),"#DIV/0!":r.ZP.t("除数为零。"),"#VALUE!":r.ZP.t("计算值错误"),"#REF!":r.ZP.t("不允许存在循环引用。"),"#NAME?":r.ZP.t("无效的范围名称。"),"#NUM!":r.ZP.t("数值错误。"),"#N/A":r.ZP.t("参数不可为空。"),"#ERROR!":r.ZP.t("公式解析错误。"),"#PARAMS!":r.ZP.t("参数输入错误。"),"#PARAMS_LACK":r.ZP.t("参数个数不足。"),"#PARAMS_OVER":r.ZP.t("参数个数太多。"),"#FUNC!":r.ZP.t("排序后, 在筛选范围内的跨行的函数无法生效")},p=function(e){return!!e&&!!e.match(/ID\(|STOCK\(/gi)},h=function(e){return!!e&&/\#error|\#PARAMS_LACK|\#PARAMS_OVER/gi.test(e)};function g(e){return!!e&&("object"===typeof e||"function"===typeof e)&&"function"===typeof e.then}function v(e,t,n){var o=f.Pz.toCellId(e,t);return o.indexOf("!")>-1?o:n+"!"+(o=o.toUpperCase())}function b(e){var t=e.replace(/\$/g,""),n=t.match(/^([A-Za-z]+)(\d+)$/);if(!n)throw new Error(t+" 并不是一个 cellId");var o=n[1],r=n[2];return{row:(0,f.Fz)(r),col:(0,f.VT)(o),isRowRelative:!/.+\$.+/.test(e),isColRelative:!/^\$/.test(e)}}function w(e){return void 0===e&&(e=0),new Promise((function(t){return setTimeout(t,e)}))}function x(e,t,n){var o=(void 0===n?{}:n).pollingInterval,r=void 0===o?1e3:o;if(e())return t();setTimeout((function(){return x(e,t,{pollingInterval:r})}),r)}var I={number:s.Z.NUMBER,string:s.Z.STRING,boolean:s.Z.BOOL,error:s.Z.ERROR},C=[r.ZP.t("零"),r.ZP.t("一"),r.ZP.t("二"),r.ZP.t("三"),r.ZP.t("四"),r.ZP.t("五"),r.ZP.t("六"),r.ZP.t("七"),r.ZP.t("八"),r.ZP.t("九")];function y(e){return e.toString().split("").map((function(e){return C[parseInt(e,10)]})).join("")}function j(e,t,n){return e+(n?t:0)}function T(){var e=function(){},t=function(){};return{promise:new Promise((function(n,o){e=n,t=o})),resolve:e,reject:t}}function E(e){return"[object Undefined]"===Object.prototype.toString.call(e)}function S(e){return/^=?(ASC|CLEAN|CONCAT|CONCATENATE|DBCS|DOLLAR|EXACT|FIXED|LEFT|LEFTB|LOWER|MID|MIDB|PROPER|REPLACE|REPLACEB|REPT|RIGHT|RIGHTB|SUBSTITUTE|TEXT|TEXTJOIN|TRIM|UPPER|USDOLLAR|REGEXMATCH|HYPERLINK|URL)\(.*\)$/i.test(e)}function R(){return/Chrome/.test(navigator.userAgent)}function A(e){var t=e.row,n=e.col;return String((0,a.colIndex2ColChar)(n))+(t+1)}function k(e){if("string"===typeof e){var t=(0,i.parseValueWithStyle)(e);if(t)return{oriValue:e,result:t.value,format:t.numberFormat}}return{result:e}}var D=((o={})[f.QS.NULL_VALUE]=l.Z.NULL_VALUE,o[f.QS.DIVIDE_BY_ZERO]=l.Z.DIVIDE_BY_ZERO,o[f.QS.VALUE]=l.Z.VALUE,o[f.QS.REF]=l.Z.REF,o[f.QS.NAME]=l.Z.NAME,o[f.QS.NUM]=l.Z.NUM,o[f.QS.N_A]=l.Z.N_A,o[f.QS.ERROR]=l.Z.ERROR,o[f.QS.LOADING]=l.Z.LOADING,o);function P(e){if(e.id===m.ZP.INSERT_DIMENSION_MUTATION){var t=e;return{id:f.zD.MUTATION_ID.INSERT_DIMENSION_MUTATION,type:t.type,index:t.index,sheetId:t.sheetId,amount:t.amount,getAffectedSheetId:function(){return t.sheetId}}}if(e.id===m.ZP.DELETE_DIMENSION_MUTATION){var n=e;return{id:f.zD.MUTATION_ID.DELETE_DIMENSION_MUTATION,type:n.type,index:n.index,sheetId:n.sheetId,amount:n.amount,getAffectedSheetId:function(){return n.sheetId}}}if(e.id===m.ZP.MAP_RANGE_MUTATION){var o=e;return{id:f.zD.MUTATION_ID.MAP_RANGE_MUTATION,sheetId:o.sourceSheetId,row:o.row,column:o.column,getAffectedSheetId:function(){return o.sourceSheetId}}}if(e.id===m.ZP.INSERT_SHEET_MUTATION){var r=e;return{id:f.zD.MUTATION_ID.INSERT_SHEET_MUTATION,sheetId:r.sheetId,sheetIndex:r.sheetIndex,getAffectedSheetId:function(){return r.sheetId}}}if(e.id===m.ZP.DELETE_SHEET_MUTATION){var s=e;return{id:f.zD.MUTATION_ID.DELETE_SHEET_MUTATION,sheetId:s.sheetId,sheetIndex:s.sheetIndex,getAffectedSheetId:function(){return s.sheetId}}}if(e.id===m.ZP.MOVE_SHEET_MUTATION){var i=e;return{id:f.zD.MUTATION_ID.MOVE_SHEET_MUTATION,toIndex:i.toIndex,getAffectedSheetId:function(){return""}}}}function O(e,t){var n=e.startRowIndex,o=e.endRowIndex,r=e.startColIndex,s=e.endColIndex;return n===u.DEFAULT_DIMENSION_INDEX&&(n=f.nx.DEFAULT_DIMENSION_START),o===u.DEFAULT_DIMENSION_INDEX&&(o=void 0!==(null===t||void 0===t?void 0:t.rowCount)?(null===t||void 0===t?void 0:t.rowCount)-1:f.nx.DEFAULT_DIMENSION_END),r===u.DEFAULT_DIMENSION_INDEX&&(r=f.nx.DEFAULT_DIMENSION_START),s===u.DEFAULT_DIMENSION_INDEX&&(s=void 0!==(null===t||void 0===t?void 0:t.colCount)?(null===t||void 0===t?void 0:t.colCount)-1:f.nx.DEFAULT_DIMENSION_END),new f.zD.FormulaGridRange(e.sheetId,n,o,r,s)}},"../spread-sheet/src/core/feature/relateForm/relate-form.interface.ts":function(e,t,n){"use strict";n.d(t,{c:function(){return o},e:function(){return r}});var o,r=(0,n("../node_modules/@tencent/containerized/build/main/index.js").yh)("IRelateForm");!function(e){e.SIMPLE="SIMPLE",e.RADIO="RADIO",e.CHECKBOX="CHECKBOX",e.SELECT="SELECT",e.DATE="DATE",e.TIME="TIME",e.TEMPERATURE="TEMPERATURE",e.LOCATION="LOCATION",e.IMAGE="IMAGE",e.CANVAS="CANVAS"}(o||(o={}))},"../spread-sheet/src/core/feature/relateFormEnt/api.tsx":function(e,t,n){"use strict";n.d(t,{Gq:function(){return I},IG:function(){return b},Mg:function(){return w},NM:function(){return x},T_:function(){return y},V3:function(){return v},VA:function(){return g},_8:function(){return h}}),n("../node_modules/regenerator-runtime/runtime.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.promise.js"),n("../node_modules/core-js/modules/es.array.slice.js"),n("../node_modules/core-js/modules/es.array.map.js"),n("../node_modules/core-js/modules/es.regexp.exec.js"),n("../node_modules/core-js/modules/es.string.match.js"),n("../node_modules/core-js/modules/es.string.search.js"),n("../node_modules/core-js/modules/es.regexp.constructor.js"),n("../node_modules/core-js/modules/es.regexp.to-string.js"),n("../node_modules/core-js/modules/es.array.join.js"),n("../node_modules/core-js/modules/es.string.starts-with.js");var o=n("../node_modules/i18next/dist/esm/i18next.js"),r=n("../spread-sheet/src/core/data/configService/spreadConfig.ts"),s=(n("../node_modules/@tencent/docs-user-agent/dist/index.js"),n("../packages/utils/src/safe.ts"),n("./node_modules/axios/index.js")),i=n.n(s),a=n("../spread-sheet/src/core/feature/relateFormEnt/helper.ts"),d=n("../spread-sheet/src/core/feature/relateFormEnt/index.tsx"),c=n("../spread-sheet/src/core/feature/relateFormEnt/enterpriseStatus.ts"),l=n("../node_modules/@tencent/dui/lib/components/Snackbar/index.js"),u=n("../spread-sheet/src/core/feature/copyPaste/clipboardCopy.ui.ts"),f=n("../spread-sheet/src/core/feature/copyPaste/interfaces.ts"),m=(n("../spread-sheet/src/base/util/appConfig.ts"),n("../node_modules/@tencent/docs-design-resources/history/png@2x/form_share_weixin.png")),_=function(e,t,n,o){return new(n||(n=Promise))((function(r,s){function i(e){try{d(o.next(e))}catch(t){s(t)}}function a(e){try{d(o.throw(e))}catch(t){s(t)}}function d(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,a)}d((o=o.apply(e,t||[])).next())}))},p=window;function h(e,t,n){var o;"link"===e&&(o="func=8"),"relink"===e&&(o="func=10&auto_sync_source=n_xls_form_link_old_done"),"unlink"===e&&(o="func=7");var r="/formcol/export_data?"+o+"&form_id="+t+"&"+(n&&"unlink"!==e?"docid="+n:"");return new Promise((function(e,t){(0,a.wq)().then((function(){return i().post(r).then((function(n){var o,r,s=n.data;return 0===(null===(o=null===s||void 0===s?void 0:s.head)||void 0===o?void 0:o.ret)?e(""):t(null===(r=null===s||void 0===s?void 0:s.head)||void 0===r?void 0:r.stack)})).catch((function(){return t()}))}))}))}function g(e){var t="/formcol/smartcollect_detail_list?type=3&sync_excel_id="+e;return new Promise((function(e,n){i().post(t).then((function(t){var o,r,s,i=t.data;0===(null===(o=null===i||void 0===i?void 0:i.head)||void 0===o?void 0:o.ret)?e((null===(r=null===i||void 0===i?void 0:i.body)||void 0===r?void 0:r.form_items)||[]):n(null===(s=null===i||void 0===i?void 0:i.head)||void 0===s?void 0:s.ret)})).catch((function(e){n(e)}))}))}function v(){var e=function(){var e=r.q.getConfig("padId"),t=function(e){var t=window.location.search.match(new RegExp("(\\?|&)"+e+"=([^&]*)(&|$)"));return t?decodeURIComponent(t[2]):""}("scode");return"/txdoc/getinfo?docid="+e+"&scode="+t+"&with_rev=true&nocache=true&ignorlocaldiff=true"}();return new Promise((function(t,n){i().post(e).then((function(e){var o,r,s,i,a=e.data;0===(null===(o=null===a||void 0===a?void 0:a.head)||void 0===o?void 0:o.ret)&&(null===(r=null===a||void 0===a?void 0:a.body)||void 0===r?void 0:r.fileInfo)?t(null===(s=null===a||void 0===a?void 0:a.body)||void 0===s?void 0:s.fileInfo):n(null===(i=null===a||void 0===a?void 0:a.head)||void 0===i?void 0:i.ret)})).catch((function(e){n(e)}))}))}function b(e){var t=new FormData;return t.append("func","13"),t.append("form",JSON.stringify(e)),t.append("f","json"),(0,a.wq)().then((function(){return new Promise((function(e,n){i().post("/formcol/mgr",t).then((function(t){var o,r,s,i,a=t.data;0===(null===(o=null===a||void 0===a?void 0:a.head)||void 0===o?void 0:o.ret)&&(null===(r=null===a||void 0===a?void 0:a.body)||void 0===r?void 0:r.form)?e(null===(s=null===a||void 0===a?void 0:a.body)||void 0===s?void 0:s.form):n(null===(i=null===a||void 0===a?void 0:a.head)||void 0===i?void 0:i.ret)})).catch((function(e){n(e)}))}))}))}function w(){return new Promise((function(e,t){i().post("/formcol/select_list?func=1").then((function(n){var o,r,s,i=n.data;if(0===(null===(o=null===i||void 0===i?void 0:i.head)||void 0===o?void 0:o.ret)){var a=(null===(s=null===(r=null===i||void 0===i?void 0:i.body)||void 0===r?void 0:r.sync_form_list)||void 0===s?void 0:s.items)||[];e(a)}else t()})).catch((function(){t()}))}))}function x(e){var t="/formcol/export_data?func=11&form_id="+e;return new Promise((function(e,n){i().post(t).then((function(t){var o,r,s,i,a=t.data;0===(null===(o=null===a||void 0===a?void 0:a.head)||void 0===o?void 0:o.ret)&&(null===(r=null===a||void 0===a?void 0:a.body)||void 0===r?void 0:r.doc_url)?e(null===(s=null===a||void 0===a?void 0:a.body)||void 0===s?void 0:s.doc_url):n(null===(i=null===a||void 0===a?void 0:a.head)||void 0===i?void 0:i.stack)})).catch((function(e){n(e)}))}))}function I(e){var t;return _(this,void 0,void 0,regeneratorRuntime.mark((function n(){var s,i,a,d,l,u,f,_,p,h,g,v;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(null===(t=null===window||void 0===window?void 0:window.tdocs)||void 0===t?void 0:t.forwardFormsToWXWork){n.next=2;break}return n.abrupt("return",-1);case 2:return s=e.form_id,i=e.fill_cnt,a=e.title,d=e.share_url,l=e.note,(u=l)||(f=r.q.getConfig("userName"),u=o.ZP.t('"{{nickName}}" 邀请大家参与收集表',{nickName:f})),n.next=7,C({doc_id:[s]});case 7:_=n.sent,p=null===_||void 0===_?void 0:_[0],h=p.str_vote_card,g=p.str_source_app,v=[{form_id:s,fill_cnt:i,title:a,link:d,desc:u,imgUrl:m,str_vote_card:h,str_source_app:g}];try{null===c.pq||void 0===c.pq||c.pq.forwardFormsToWXWork({forms:v})}catch(b){console.error(b)}case 11:case"end":return n.stop()}}),n)})))}function C(e){var t=e.doc_id.map((function(e){return e.startsWith("c2_")?"doc_id="+e:"doc_id=c2_"+e})).join("&");return i().get("/diskshare/get_form_forward_data?"+t).then((function(e){var t,n,o,r=e.data;return 0===(null===(t=null===r||void 0===r?void 0:r.head)||void 0===t?void 0:t.ret)&&(null===(n=null===r||void 0===r?void 0:r.body)||void 0===n?void 0:n.items)?null===(o=null===r||void 0===r?void 0:r.body)||void 0===o?void 0:o.items:[{}]})).catch((function(){return[{}]}))}function y(e){e?((0,u.ES)({copyContent:{html:e,plain:e},type:f.GI.input}),l.Snackbar.show({type:"success",message:o.ZP.t("已复制分享链接"),autoClose:!0,closable:!0})):p.T_SHEET.CoreUI.toast.showToast(o.ZP.t("获取分享链接失败"),void 0,{toolToastCloseTime:3e3}),(0,d.KVR_Report)("n_xls_form_share",{Channel1:"link",Channel2:""})}},"../spread-sheet/src/core/feature/relateFormEnt/helper.ts":function(e,t,n){"use strict";function o(){return Promise.resolve()}function r(e,t){return void 0===t&&(t=0),!!(e&t)}n.d(t,{l6:function(){return r},wq:function(){return o}}),n("../node_modules/core-js/modules/es.regexp.constructor.js"),n("../node_modules/core-js/modules/es.regexp.exec.js"),n("../node_modules/core-js/modules/es.regexp.to-string.js"),n("../node_modules/core-js/modules/es.string.match.js"),n("../node_modules/core-js/modules/web.dom-collections.for-each.js"),n("../node_modules/core-js/modules/es.number.constructor.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.promise.js")},"../spread-sheet/src/core/feature/relateFormEnt/index.tsx":function(e,t,n){"use strict";n.r(t),n.d(t,{KVR_Report:function(){return A}}),n("../node_modules/regenerator-runtime/runtime.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.promise.js"),n("../node_modules/core-js/modules/es.object.assign.js"),n("../node_modules/core-js/modules/es.object.keys.js"),n("../node_modules/core-js/modules/es.array.iterator.js"),n("../node_modules/core-js/modules/es.string.iterator.js"),n("../node_modules/core-js/modules/web.dom-collections.iterator.js"),n("../node_modules/core-js/modules/es.array.map.js"),n("../node_modules/core-js/modules/es.object.values.js"),n("../node_modules/core-js/modules/web.dom-collections.for-each.js");var o=n("../node_modules/i18next/dist/esm/i18next.js"),r=n("../packages/model/src/index.ts"),s=n("../spread-sheet/src/base/index.ts"),i=n("../spread-sheet/src/core/behavior/index.ts"),a=n("../node_modules/@tencent/docs-user-agent/dist/index.js"),d=n.n(a),c=n("../spread-sheet/src/base/util/appConfig.ts"),l=n("../node_modules/@tencent/dui/lib/components/Snackbar/index.js"),u=n("../spread-sheet/src/core/feature/relateFormEnt/api.tsx"),f=n("../spread-sheet/src/core/data/configService/spreadConfig.ts"),m=n("../spread-sheet/src/core/ui/toast/toast.tsx"),_=n("../spread-sheet/src/core/feature/relateFormEnt/helper.ts"),p=n("../spread-sheet/src/core/feature/relateFormEnt/seeker.ts"),h=n("../spread-sheet/src/core/feature/relateFormEnt/interface.ts"),g=n("../spread-sheet/src/core/app/tool.ts"),v=n("../node_modules/@tencent/dui/lib/components/Modal/index.js"),b=n("../node_modules/@tencent/dui-mobile/lib/components/Modal/index.js"),w=n("../spread-sheet/src/core/feature/relateFormEnt/enterpriseStatus.ts"),x=n("../spread-sheet/src/core/feature/relateFormEnt/formInterface.ts"),I=n("../packages/report/src/index.ts"),C=n("../spread-sheet/src/external/mention-ent/varsSettings.ts"),y=n("../packages/common-utils/src/index.ts"),j=n("../spread-sheet/src/base/event/event.ts"),T=n("../node_modules/@tencent/tencent_doc_open_url/dist/index.js"),E=function(e,t,n,o){return new(n||(n=Promise))((function(r,s){function i(e){try{d(o.next(e))}catch(t){s(t)}}function a(e){try{d(o.throw(e))}catch(t){s(t)}}function d(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,a)}d((o=o.apply(e,t||[])).next())}))},S=d().isMobile?b.default:v.Modal,R=n.g,A=function(e,t){I.ZP.kvrOss(Object.assign({itemname:e,CropID:f.q.getConfig("corpId"),DocID:f.q.getConfig("padId"),biz:"personal"},t))},k=function(){function e(e){this.initDialogPromise=null,e&&this.init(e)}var t=e.prototype;return t.init=function(e){this.app=e,this.initRelation(),this.initToolbarEntry(),this.afterHandleCallbacks=[],this.seeker=new p.Z(e),this.initUrlChange(),g.Z.event.formRelationEvent.listen("formRelationChange",this.updateRelation.bind(this))},t.handle=function(e,t,n,o,r){var s,i,a=(null===r||void 0===r?void 0:r.formId)||(null===(s=null===r||void 0===r?void 0:r.form)||void 0===s?void 0:s.sync_form_id)||(null===(i=this.getRelation(t||""))||void 0===i?void 0:i.form_id),d=null===r||void 0===r?void 0:r.activeArea;switch(e){case"new_to_form":this.handleNewToFormWedoc(null===r||void 0===r?void 0:r.questions,null===r||void 0===r?void 0:r.title);break;case"new_to_form_mobile":this.handleNewToFormWedocMobile(null===r||void 0===r?void 0:r.questions,null===r||void 0===r?void 0:r.title);break;case"convert_to_form":this.handleConvertToFormWedoc();break;case"check_form":this.handleCheckForm(a,d);break;case"cancel_form":case"cancel_form_sheetbar":this.handleCancelForm(a,n);break;case"change_header":this.updateToolbar();break;case"wedoc_cancelform_all":this.handleCancelAllForm();break;case"wedoc_get_form_by_user":this.handleCheckAllFormByUser(n);break;case"wedoc_link_form_by_user":this.linkOwnerForm(a||"",n,r.relink);break;case"wedoc_checkform_in_doc":this.handleCheckAllFormInDoc(n);break;case"wedoc_send_wxwork":this.handleShareWxwork(a);break;case"wedoc_copy_link":this.handleCopyLink(a);break;case"wedoc_qrcode":this.handleShowQRCode(a)}n&&this.afterHandleCallbacks.push(n)},t.initUrlChange=function(){var e;null===(e=null===C.DI||void 0===C.DI?void 0:C.DI.onUrlChange)||void 0===e||e.call(C.DI,(function(e){var t=e.url,n=(0,y.IZ)("tab",t),o=R.SpreadsheetApp.spreadsheet.getActiveSheetId();n!==o&&j.ZP.sheetsBar.trigger("switchSheet",n,o)}))},t.isRelated=function(e){return e in this.relateMap},t.getFormDetails=function(e){return e in this.formDetailsMap?this.formDetailsMap[e]:null},t.isLoading=function(){return this.needShowLoading},t.getRelatedSheetId=function(){return Object.keys(this.relateMap)[0]},t.getRelatedNumber=function(){return Object.keys(this.relateMap).length},t.updateFromSheetHeaderSync=function(e,t){var n=this.isRelated(e),o=t===r.Sheet.SHEET_TYPE.FORM;o&&!n?(this.updateRelateMap(e,{}),this.updateUI()):!o&&n&&(this.updateRelateMap(e,null),this.updateUI())},t.updateFromSyncMutations=function(e,t){for(var n=!1,o=0;o<e.length&&!n;o++){var r=e[o];if(!Array.isArray(r))break;for(var s=0;s<r.length;s++){var a=this.app.mutationBehavior.deserializeMutation(r[s]),d=i.Z.Mutation.MUTATION_ID.DELETE_SHEET_RANGE_MUTATION,c=["<author>","<time>"].indexOf(a.workbookRangeId)>-1;if((null===a||void 0===a?void 0:a.workbookRangeId)&&a.id===d&&c){n=!0;break}}}n&&(this.updateRelateMap(t,null),this.updateUI())},t.checkFormSyncExceptions=function(){return!1},t.continueCheck=function(){},t.stopCheckSync=function(){s.Z.util.timer.erase(this.checkTimeFlag)},t.isOpenDialog=function(){return!1},t.updateSelectedData=function(){},t.hideSelectQuestionDialog=function(){},t.getRelation=function(e){var t;return(null===(t=this.relateMap)||void 0===t?void 0:t[e])||null},t.isRelateFormPublished=function(){return E(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",!0);case 1:case"end":return e.stop()}}),e)})))},t.checkCollectSheetType=function(){return!0},t.getRelatedIn=function(){return null},t.getRelatedSheetIdByDocId=function(){return""},t.getRelatedInfos=function(){return[]},t.checkReleaseCell=function(e,t,n){var o=n||this.app.spreadsheet.activeSheet,r=o.data.colMetadata,s=o.data.rowMetadata,i=null===r||void 0===r?void 0:r[t],a=null===s||void 0===s?void 0:s[e],d=null===i||void 0===i?void 0:i.formData,c=null===a||void 0===a?void 0:a.formData;if(d&&c){if("question"===c.formDataId)return 1;if(c.formDataId.indexOf("record")>=0)return 2}return 0},t.checkReleaseRange=function(e,t,n,o){for(var r=e.startColIndex,s=e.startRowIndex,i=e.endColIndex,a=e.endRowIndex,d=0,c=s;c<a;c++)for(var l=r;l<i;l++){var u=null===n||void 0===n?void 0:n[l],f=null===t||void 0===t?void 0:t[c],m=null===u||void 0===u?void 0:u.formData,_=null===f||void 0===f?void 0:f.formData;if(m&&_&&0!==(d=this.getRelatedRangeType(_.formDataId,o)))return d}return d},t.getRelatedRangeType=function(e,t){var n=0;return"question"===e&&(n=1),e.indexOf("record")>=0&&(n=2),!n||3!==t&&4!==t&&t!==n?0:t},t.initRelation=function(){this.relateMap=Object.create(null),this.updateRelation()},t.initToolbarEntry=function(){var e=this;R.addEventListener("load",(function(){e.updateToolbar()}),!1),this.updateToolbar()},t.getToolbarEntryElement=function(){var e=this.toolbarEntryElement;return e||(e=document.querySelector("#toolbar-form-dropdown-group"),this.toolbarEntryElement=e),e},t.showToolbarEntry=function(){var e=this.getToolbarEntryElement();e&&(e.style.display="")},t.hideToolbarEntry=function(){var e=this.getToolbarEntryElement();e&&(e.style.display="none")},t.getSheetTitle=function(){return f.q.getConfig("isUserChangeTitle")?f.q.getConfig("title"):""},t.getTitle=function(){var e=this.getSheetTitle()||o.ZP.t("无标题收集表");return e.length>32?e.substr(0,32):e},t.createFail=function(e,t){var n=t&&(t.msg||t.errmsg);this.showToolToast(n?o.ZP.t("创建关联收集表失败：{{msg}}。",{msg:n}):o.ZP.t("网络异常，创建失败。")),s.Z.event.sheetsBar.trigger("deleteSheet",e)},t.handleDone=function(){for(;this.afterHandleCallbacks.length;){var e=this.afterHandleCallbacks.shift();e&&e()}},t.updateUI=function(){this.updateToolbar(),this.updateSheetbar()},t.updateSheetbar=function(){s.Z.event.sheetsBar.trigger("bindStatusChange")},t.updateToolbar=function(){var e=this.getRelatedNumber();f.q.getConfig("isCreator")&&e?this.showToolbarEntry():this.hideToolbarEntry()},t.updateRelateMap=function(e,t){t?this.relateMap[e]=t:delete this.relateMap[e]},t.initDialog=function(){return E(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.initDialogPromise){e.next=2;break}return e.abrupt("return",this.initDialogPromise);case 2:return this.initDialogPromise=E(t,void 0,void 0,regeneratorRuntime.mark((function e(){var t,o,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.e("bundle_relate_form_question_dialog_enterprise").then(n.bind(n,"../spread-sheet/src/core/feature/relateFormEnt/formListDialog/index.tsx"));case 2:return t=e.sent,this.formSelectDialog=new t.default({linkOwnerForm:this.linkOwnerForm.bind(this),openFormSheet:this.handleOpenFormSheet.bind(this)}),e.next=6,n.e("bundle_relate_form_question_dialog_enterprise").then(n.bind(n,"../spread-sheet/src/core/feature/relateFormEnt/questionListDialog/index.tsx"));case 6:return o=e.sent,this.questionListDialog=new o.default({app:this.app,creatDraft:this.handleNewToFormWedoc.bind(this)}),e.next=10,n.e("bundle_relate_form_question_dialog_enterprise").then(n.bind(n,"../spread-sheet/src/core/feature/relateFormEnt/qrDialog/index.tsx"));case 10:return r=e.sent,this.qrDialog=new r.default({app:this.app}),e.abrupt("return",!0);case 13:case"end":return e.stop()}}),e,this)}))),e.abrupt("return",this.initDialogPromise);case 4:case"end":return e.stop()}}),e,this)})))},t.handleNewToFormWedocMobile=function(e,t){void 0===e&&(e=[]),void 0===t&&(t="新建收集表");var n,o=this.app.spreadsheet.getSpreadsheetId();if(0===e.length){if(n="n_xls_form_link_new_done",A("n_xls_form_link_click",{Channel1:"new",Channel2:"mobile",Extra1:""}),w.VH){var r="https://"+c.Z.getConfig("runtime.domainName")+"/mall/m/index/form/collect";return void(0,_.wq)().then((function(){var e=r+"?excel_id="+o;(0,T.tencentDocOpenUrlForAll)({url:e})})).catch((function(e){console.error("addtolist check failed. details: "+e)}))}e=x.jX}else n="n_xls_form_link_sheet_done",A("n_xls_form_link_click",{Channel1:"sheet",Channel2:"mobile",Extra1:""});var s={sections:[{sid:"0",title:"",qlist:e.map((function(e,t){return""+(t+1)}))}],questions:e},i={title:t,note:"",cover_img:"",draft_ext:{from_excel:o,from_excel_n_xls_form_link:n},tx_question:JSON.stringify(s)};(0,u.IG)(i).then((function(e){var t="https://"+c.Z.getConfig("runtime.domainName")+"/forms/"+e.form_id+"?page=1";(0,w.BQ)(t)})).catch((function(t){console.error("new form from wedoc error: "+t+", question list: "+e+", form: "+i)}))},t.handleNewToFormWedoc=function(e,t){return void 0===e&&(e=[]),void 0===t&&(t="新建收集表"),E(this,void 0,void 0,regeneratorRuntime.mark((function n(){var o,r,s,i,a=this;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(o=this.app.spreadsheet.getSpreadsheetId(),0!==e.length){n.next=13;break}if(r="n_xls_form_link_new_done",A("n_xls_form_link_click",{Channel1:"new",Channel2:"pc",Extra1:""}),!w.VH){n.next=10;break}return s="https://"+c.Z.getConfig("runtime.domainName")+"/mall/index/form/collect",(0,_.wq)().then((function(){(0,w.BQ)(s+"?excel_id="+o)})),n.abrupt("return");case 10:e=x.jX;case 11:n.next=15;break;case 13:r="n_xls_form_link_sheet_done",A("n_xls_form_link_click",{Channel1:"sheet",Channel2:"pc",Extra1:""});case 15:i={title:t,note:"",cover_img:"",draft_ext:{from_excel:o,from_excel_n_xls_form_link:r},tx_question:JSON.stringify({sections:[{sid:"0",title:"",qlist:e.map((function(e,t){return""+(t+1)}))}],questions:e})},(0,u.IG)(i).then((function(e){var t;R.open("https://"+c.Z.getConfig("runtime.domainName")+"/forms/"+e.form_id+"?page=1"),null===(t=a.formSelectDialog)||void 0===t||t.close()})).catch((function(t){console.error("new form from wedoc error: "+t+", question list: "+e+", form: "+i)}));case 17:case"end":return n.stop()}}),n,this)})))},t.handleConvertToFormWedoc=function(){var e;return E(this,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.initDialog();case 2:null===(e=null===this||void 0===this?void 0:this.questionListDialog)||void 0===e||e.show();case 3:case"end":return t.stop()}}),t,this)})))},t.handleCheckForm=function(e,t){var n;return E(this,void 0,void 0,regeneratorRuntime.mark((function o(){var r,s,i,a,l,u,f,m,p,g;return regeneratorRuntime.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:if(null!=e){o.next=2;break}return o.abrupt("return");case 2:if(this.formDetailsMap){o.next=5;break}return o.next=5,this.updateDetails();case 5:if(null===(n=this.formDetailsMap)||void 0===n?void 0:n[e]){o.next=7;break}return o.abrupt("return");case 7:r=this.formDetailsMap[e],s=r.form_flag,i=void 0===s?0:s,a=r.form_id,l=(0,_.l6)(i,h.Wj.vote),u=(0,_.l6)(i,h.Wj.queue),f=t?"&active_area="+t:"",m="",m=l?"https://"+c.Z.getConfig("runtime.domainName")+"/forms/v/"+a+"?page=1"+f:u?"https://"+c.Z.getConfig("runtime.domainName")+"/forms/q/"+a+"?page=1"+f:"https://"+c.Z.getConfig("runtime.domainName")+"/forms/"+a+"?page=1"+f,p="menu","filled"===t&&(p="fill"),"detail"===t&&(p="result"),"unfilled"===t&&(p="unfill"),"shareSheet"===t&&(p="shareSheet"),(0,w.BQ)(m),g=d().isMobile?"mobile":"pc",A("n_xls_form_jump",{Channel1:p,Channel2:g,Extra1:""});case 21:case"end":return o.stop()}}),o,this)})))},t.handleCancelAllForm=function(){var e=this;s.Z.event.default.trigger("link_sheet_delete",(function(){e.relateMap=Object.create(null),e.updateUI()}))},t.handleCheckAllFormByUser=function(e){var t;return E(this,void 0,void 0,regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.updateOwnerFormList();case 2:if(!e){n.next=6;break}e(this.ownerFormList),n.next=9;break;case 6:return n.next=8,this.initDialog();case 8:null===(t=null===this||void 0===this?void 0:this.formSelectDialog)||void 0===t||t.show(this.ownerFormList);case 9:case"end":return n.stop()}}),n,this)})))},t.handleShowQRCode=function(e){var t;return E(this,void 0,void 0,regeneratorRuntime.mark((function n(){var o,r,s;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!e){n.next=6;break}if(o=null===(t=this.formDetailsMap)||void 0===t?void 0:t[e],r=o.title,s=o.share_url,!r||!s){n.next=6;break}return n.next=5,this.initDialog();case 5:this.qrDialog.show(r,s);case 6:case"end":return n.stop()}}),n,this)})))},t.handleOpenFormSheet=function(e){e&&(0,u.NM)(e).then((function(e){R.open(e)}),(function(){l.default.show({type:"error",message:o.ZP.t("获取链接失败"),autoClose:!0,duration:3e3,style:{zIndex:10004}})}))},t.handleWaitingForm=function(){var e=this;if(this.waitingFormId)for(var t in this.relateMap)this.relateMap[t].form_id===this.waitingFormId&&(e.app.spreadsheet.activeSheetId,setTimeout((function(){}),500),e.waitingFormId="")},t.linkOwnerForm=function(e,t,n){var r=this;void 0===n&&(n=!1);var s=this.app.spreadsheet.getSpreadsheetId(),i=n?"relink":"link",a=d().isMobile?"mobile":"pc";return A("n_xls_form_link_click",{Channel1:"old",Channel2:a,Extra1:""}),(0,u._8)(i,e,s).then((function(){var n;l.default.show({type:"success",message:o.ZP.t("已关联"),autoClose:!0,duration:3e3,style:{zIndex:10004}}),null===(n=null===r||void 0===r?void 0:r.formSelectDialog)||void 0===n||n.close(),r.waitingFormId=e,setTimeout((function(){r.waitingFormId=""}),1500),null===t||void 0===t||t(!0)})).catch((function(e){l.default.show({type:"error",message:o.ZP.t(e)||o.ZP.t("关联失败"),autoClose:!0,duration:3e3,style:{zIndex:10004}}),null===t||void 0===t||t(!1)}))},t.handleCheckAllFormInDoc=function(e){return E(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.updateDetails();case 2:n=Object.values(this.formDetailsMap),null===e||void 0===e||e(n);case 4:case"end":return t.stop()}}),t,this)})))},t.handleShareWxwork=function(e){return E(this,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e){t.next=4;break}return t.next=3,(0,u.Gq)(this.formDetailsMap[e]);case 3:A("n_xls_form_share",{Channel1:"forward",Channel2:"",Extra1:""});case 4:case"end":return t.stop()}}),t,this)})))},t.handleCopyLink=function(e){var t;e&&(0,u.T_)(null===(t=this.formDetailsMap[e])||void 0===t?void 0:t.share_url)},t.updateRelation=function(){var e=this;return(0,u.V3)().then((function(t){var n=t.sync_form_id,o=t.form_list;e.relateMap=Object.create(null),n&&(e.relateMap.BB08J2={form_id:n,form_status:1,subid:"BB08J2"}),o&&o.forEach((function(t){1===t.form_status&&(e.relateMap[t.subid]={form_id:t.form_id,form_status:t.form_status,subid:t.subid})})),e.handleWaitingForm(),e.updateSheetbar()}))},t.updateDetails=function(){var e=this,t=this.app.spreadsheet.getSpreadsheetId();return(0,u.VA)(t).then((function(t){for(var n in e.formDetailsMap=Object.create(null),t.length>0&&t.forEach((function(t){e.formDetailsMap[t.sync_id||t.form_id]=Object.assign({},t)})),e.relateMap){var o=e.relateMap[n].form_id;o in e.formDetailsMap&&(e.formDetailsMap[o].subid=n)}return t}))},t.updateOwnerFormList=function(){var e=this;return(0,u.Mg)().then((function(t){e.ownerFormList=[],t.forEach((function(t){e.ownerFormList.push(Object.assign({},t))}))}))},t.handleCancelForm=function(e,t){var n=this;if(e){var r=function(){(0,u._8)("unlink",e).then((function(){var e;l.default.show({type:"success",message:o.ZP.t("已取消关联"),autoClose:!0,duration:3e3,style:{zIndex:10004}}),null===(e=null===n||void 0===n?void 0:n.formSelectDialog)||void 0===e||e.close(),null===t||void 0===t||t()}),(function(){l.default.show({type:"error",message:o.ZP.t("取消关联失败"),autoClose:!0,duration:3e3,style:{zIndex:10004}}),null===t||void 0===t||t()}));var r=d().isMobile?"mobile":"pc";A("n_xls_form_unlink",{Channel1:"",Channel2:r,Extra1:""})};if(t)r();else{var s=o.ZP.t("确定取消关联收集表吗？取消关联后，收集的结果将不再自动更新到当前表格。");S.confirm({className:"unlink-confirm-dialog",title:o.ZP.t("取消关联收集表"),content:s,okText:o.ZP.t("取消关联"),cancelText:o.ZP.t("保留"),onOk:function(){r()}})}}},t.showToolToast=function(e){(0,m.showToast)(e,{},{toolToastCloseTime:3e3})},e}();t.default=k},"../spread-sheet/src/core/feature/smartSplit/smart-split-convert-utils.ts":function(e,t,n){"use strict";function o(e){var t=null;if("string"===typeof e)try{t=JSON.parse(e)}catch(o){n.g.log.warn("smart-split string convert failed",o)}else"object"===typeof e&&(t=e);return t}function r(e,t){for(var n=e.startRowIndex,o=e.endRowIndex,r=e.startColIndex,s=e.endColIndex,i=[],a=n;a<=o;a++){for(var d=[],c=r;c<=s;c++){var l=t(a,c),u=(null===l||void 0===l?void 0:l.getEditValue())||"";d.push(u)}i.push(d)}return i}n.d(t,{u:function(){return r},x:function(){return o}})},"../spread-sheet/src/core/login/index.ts":function(e,t,n){"use strict";n("../node_modules/core-js/modules/es.object.assign.js"),n("../node_modules/core-js/modules/es.regexp.exec.js"),n("../node_modules/core-js/modules/es.string.replace.js"),n("../node_modules/core-js/modules/es.string.split.js");var o,r=n("../node_modules/i18next/dist/esm/i18next.js"),s=n("./node_modules/axios/index.js"),i=n.n(s),a=n("../packages/common-utils/src/index.ts"),d=n("../packages/utils/src/safe.ts"),c=n("../node_modules/@tencent/docs-user-agent/dist/index.js"),l=n.n(c),u=n("../spread-sheet/src/base/event/event.ts"),f=n("../node_modules/@tencent/docs-scenario-components-message-center/dist/index.js"),m=n.n(f),_=n("../node_modules/@tencent/docs-multi-tools/dist/index.js"),p=n("../node_modules/@tencent/dui/lib/components/Snackbar/index.js"),h=n("../node_modules/@tencent/dui-mobile/lib/components/Snackbar/index.js"),g=n("../spread-sheet/src/core/data/configService/spreadConfig.ts"),v=n("../spread-sheet/src/core/login/utils.ts"),b=n("../spread-sheet/src/base/error/error-code-report.ts"),w=n("../spread-sheet/src/base/error/index.ts"),x=n("../node_modules/@tencent/docs-scenario-components-app-exception-handler/dist/index.js"),I=n("../node_modules/@tencent/tencent-doc-report/libs/tencent-doc-report.es.js"),C=(n("../spread-sheet/src/base/util/domain-config.ts"),n("../spread-sheet/src/base/util/appConfig.ts"));!function(e){e.loggedIn="loggedIn",e.loggedOut="loggedOut",e.switched="switched",e.error="error"}(o||(o={}));var y="//"+C.Z.getConfig("runtime.domainName")+"/cgi-bin/online_docs/user_info",j=function(){function e(){var e=this;this.logoutApp=function(){l().isTencentDocsApp&&((0,v.t4)(),setTimeout((function(){var e;null===(e=n.g.mqq)||void 0===e||e.invoke("docx","logoutAccount")}),100))},this.onPskeyError=function(t,n){(0,b.V)({errorCode:""+n,message:"onPskeyError "+t,padType:I.LogPadType.Backend,tipsCustom:{utype:(0,_.getLoginType)(),pttype:(0,v.F$)(),url:t}}),(0,v.J3)({errCode:n,cgi:t}),t.indexOf("user_info")<0?e.checkLoginState((function(){(0,b.V)({errorCode:w.B.PS_KEY_ERROR,message:"onPskeyErrorException",tipsCustom:{utype:(0,_.getLoginType)(),pttype:(0,v.F$)()}}),(0,v.J3)({errCode:n,cgi:t,loginType:"cgi_exp_err_report"})}),(function(){e.handlePskeyError()})):e.handlePskeyError()}}var t=e.prototype;return t.init=function(){this.tryAutoLogin()},t.postLogin=function(){this.registerLoginListeners(),this.registerMsgCenterListeners(),this.setLoginTime(),this.checkLoginIsExpired(),g.q.setConfig({uidKey:(0,a.ej)("uid_key")})},t.tryAutoLogin=function(){var e=this;(0,_.isLogin)()||(this.weChatH5Login(!0),this.wxWorkLogin("autologin")),this.qqClientLogin(),this.browserAutoLogin(),n.g.SpreadsheetApp.emitter.once(n.g.SpreadsheetApp.EVENT.SPREAD_SHEET_PLUGINS_END,(function(){e.showWeChatH5NaviPanel()}))},t.login=function(){l().isTencentDocsApp?(new x.AppExceptionHandler).tryLogin():l().isMiniProgram?this.miniprogramLogin():l().isWeChat?this.weChatH5Login():l().isWxWork?this.wxWorkLogin("detail"):l().isTimOrQQ?this.timOrQQH5Login():l().isPC?this.showLoginModal():location.href="https://"+C.Z.getConfig("runtime.domainName")+"/login.html?jump_url="+encodeURIComponent(location.href)},t.showLoginModal=function(e){var t=this;void 0===e&&(e={}),n.g.SLR.load("Login",(function(n){n.show(t.getLoginContainer(),Object.assign({isMaskClose:!1},e))}))},t.checkLoginState=function(e,t,n){(0,v.Bp)()||t(0),i()({method:"get",url:y+"?only_check=1&xsrf="+(0,d.f)(),timeout:n||1e3}).then((function(n){var o=n.data;if(0===(null===o||void 0===o?void 0:o.retcode))return e();var r=(null===o||void 0===o?void 0:o.retcode)||-306;console.warn("[login] checkLoginState fail: "+r),(0,b.V)({errorCode:r,message:"checkLoginState retcode not 0",padType:I.LogPadType.Backend,tipsCustom:{utype:(0,_.getLoginType)(),pttype:(0,v.F$)(),url:y}}),t(r)})).catch((function(e){var n,o,r,s,i=(null===(o=null===(n=null===e||void 0===e?void 0:e.response)||void 0===n?void 0:n.data)||void 0===o?void 0:o.retcode)||(null===(s=null===(r=null===e||void 0===e?void 0:e.response)||void 0===r?void 0:r.data)||void 0===s?void 0:s.errCode)||-306;console.warn("[login] checkLoginState error: "+i),(0,b.V)({errorCode:i,message:"checkLoginState response error",padType:I.LogPadType.Backend,tipsCustom:{utype:(0,_.getLoginType)(),pttype:(0,v.F$)(),url:y}}),t(i)}))},t.checkIfAccountSwitched=function(){if(!(0,_.isLogin)())return!1;if((0,_.isMultiLoginGray)())return!1;var e=g.q.getConfig("userType"),t=g.q.getConfig("tinyid")||g.q.getConfig("toid")||g.q.getConfig("uid"),n=g.q.getConfig("uin"),o=(0,a.ej)("utype"),r=(0,a.ej)("uid");return!![[!n,!t].every((function(e){return e})),[t,r,t!==r].every((function(e){return e})),[e,o,e!==o].every((function(e){return e}))].some((function(e){return e}))&&(console.info("[login] account switched"),!0)},t.showWeChatH5NaviPanel=function(){(0,v.Yv)()||l().isWeChat&&n.g.SLR.load("WxH5NaviPanel",(function(e){var t=e.WxH5NaviPanel;try{null===t||void 0===t||t.show({url:n.g.__originUrl})}catch(o){console.error("[WxH5NaviPanel err]",o)}}))},t.miniprogramLogin=function(){var e,t,o;if(l().isMiniProgram){(0,v.t4)();var r="/pages/detail/detail?reason=pskey_error&url="+encodeURIComponent(location.href);(0,a.IZ)("rtkey")&&(r+="&scene="+(0,a.IZ)("rtkey")),null===(o=null===(t=null===(e=n.g.wx)||void 0===e?void 0:e.miniProgram)||void 0===t?void 0:t.reLaunch)||void 0===o||o.call(t,{url:r})}},t.weChatH5Login=function(e){if(void 0===e&&(e=!1),l().isWeChat){var t=function(){var e="https://"+C.Z.getConfig("runtime.domainName")+"/scenario/wx-login.html?target="+encodeURIComponent(location.href),t="https://"+C.Z.getConfig("custom.standaloneDomains.open_weixin_qq_com")+"/connect/oauth2/authorize?appid=wx46dfe750eef96da7&redirect_uri="+encodeURIComponent(e)+"&response_type=code&scope=snsapi_userinfo&state=onweixinlogin";location.replace(t)};e?window.SLR.load("LoginButtonMobile",(function(e){(0,e.renderPopup)(t).showPopup(4e3)})):t()}},t.wxWorkLogin=function(e){if(void 0===e&&(e="autologin"),l().isWxWork&&this.canWxWorkLogin()){var t="https://"+C.Z.getConfig("runtime.domainName")+"/scenario/ww-login.html?from="+e+"&url="+encodeURIComponent(location.href),n="https://"+C.Z.getConfig("custom.standaloneDomains.open_weixin_qq_com")+"/connect/oauth2/authorize?appid=ww20388f7040b655b7&redirect_uri="+encodeURIComponent(t)+"&response_type=code&scope=snsapi_userinfo&state=weworklogin#wechat_redirect";location.replace(n)}},t.canWxWorkLogin=function(){return!0},t.timOrQQH5Login=function(){l().isTimOrQQ&&(n.g.mqq?n.g.mqq.invoke("data","updateLoginInfo",{key:"pskey"},(function(e){0!==e.code&&(0,b.V)({errorCode:""+e.code,message:"updateLoginInfo timOrQQH5Login",padType:I.LogPadType.Mqq,tipsCustom:{utype:(0,_.getLoginType)(),pttype:(0,v.F$)()}}),0!==e.result&&(0,b.V)({errorCode:""+e.result,message:"updateLoginInfo timOrQQH5Login",padType:I.LogPadType.Mqq,tipsCustom:{utype:(0,_.getLoginType)(),pttype:(0,v.F$)()}}),location.reload()})):n.g.location.reload())},t.qqClientLogin=function(){var e=this;(0,_.quickQQLogin)((function(t){t||e.showLoginModal()}))},t.browserAutoLogin=function(){(0,a.IZ)("autoshowlogin")&&this.showLoginModal()},t.getLoginContainer=function(){var e=document.getElementById("loginContainer");return e||((e=document.createElement("div")).id="loginContainer",document.body.appendChild(e)),e},t.registerMsgCenterListeners=function(){m().setCallback((function(e){var t;e&&1e4===e.code?(null===(t=n.g.log)||void 0===t||t.info("TX-LOGIN-ACCOUNT-SWITCHED dispatch MsgCenter Callback"),n.g.SLR.dispatch("TX-LOGIN-ACCOUNT-SWITCHED",{op:o.switched})):e&&10001===e.code&&n.g.SLR.dispatch("TX-LOGIN-LOGOUT-OTHER-TAB",{})}))},t.registerLoginListeners=function(){u.ZP.loginEvent.listen("logoutApp",this.logoutApp),u.ZP.loginEvent.listen("pskeyError",this.onPskeyError),this.registerLoginListener(),this.registerAccountSwitchedListener(),this.registerPskeyExpiredListener(),this.registerLoggedOutInOtherTabListener()},t.registerLoginListener=function(){var e=this;n.g.SLR.listen("TX-LOGIN-SHOW",(function(t){var n=t.detail,o=(null===n||void 0===n?void 0:n.data)||{},r={isQQonly:o.isQQonly,cb:o.cb,target:o.self||"top"};e.showLoginModal(r)}))},t.registerAccountSwitchedListener=function(){var e=this;l().isMobilePhone||l().isAndroidPad||n.g.SLR.listen("TX-LOGIN-ACCOUNT-SWITCHED",(function(t){var s,i=t.detail;null===(s=n.g.log)||void 0===s||s.info("TX-LOGIN-ACCOUNT-SWITCHED listen");var a=(i||{}).op;if(a===o.loggedIn||a===o.error)return(0,b.V)({errorCode:w.B.LOGIN_SWITCHED,message:"status: "+a,snackbarMsg:r.ZP.t("其他页面已登录，正在刷新"),type:"info",tipsCustom:{utype:(0,_.getLoginType)(),pttype:(0,v.F$)()}}),p.default.show({type:"info",autoClose:!0,duration:1500,message:r.ZP.t("其他页面已登录，正在刷新...")}),void setTimeout((function(){location.reload()}),1800);(0,b.V)({errorCode:w.B.LOGIN_SWITCHED,message:"status: "+a,snackbarMsg:r.ZP.t("帐号信息变化 刷新"),type:"info",tipsCustom:{utype:(0,_.getLoginType)(),pttype:(0,v.F$)()}}),e.showRefreshTips()}))},t.registerPskeyExpiredListener=function(){var e=this;n.g.SLR.listen("TX-LOGIN-PSKEY-EXPIRED",(function(t){var n="unknown url",o=t.detail||{},r=o.url,s=o.code,i=void 0===s?0:s;"string"===typeof r&&r&&(n=r.split("?")[0]),console.error("[login] listen onPskeyError("+n+") = "+i),e.onPskeyError(n,i)}))},t.registerLoggedOutInOtherTabListener=function(){var e=this;n.g.SLR.listen("TX-LOGIN-LOGOUT-OTHER-TAB",(function(){e.showLoginExpiredTips(o.loggedOut),(0,b.V)({errorCode:w.B.LOGGED_OUT,message:"listen TX-LOGIN-LOGOUT-OTHER-TAB",type:"info",tipsCustom:{utype:(0,_.getLoginType)(),pttype:(0,v.F$)()}})}))},t.showRefreshTips=function(){p.default.show({type:"info",autoClose:!1,message:r.ZP.t("帐号信息变化"),action:r.ZP.t("刷新"),onClickAction:function(){location.reload()},id:"accountSwitchTips"})},t.showLoginExpiredTips=function(e){var t=this;(0,b.V)({errorCode:w.B.SHOW_RELOGIN,message:"status: "+e+";",snackbarMsg:r.ZP.t("登录过期"),type:"info",tipsCustom:{utype:(0,_.getLoginType)(),pttype:(0,v.F$)()}}),l().isMobilePhone||l().isAndroidPad?h.default.show({type:"info",autoClose:!1,message:r.ZP.t("登录过期"),action:r.ZP.t("重新登录"),onClickAction:function(){t.login()}}):p.default.show({type:"info",autoClose:!1,message:r.ZP.t("登录过期"),action:r.ZP.t("重新登录"),onClickAction:function(){try{if(!(0,_.isLogin)())return void t.login();if(t.checkIfAccountSwitched())return void t.checkLoginState((function(){var t;null===(t=n.g.log)||void 0===t||t.info("TX-LOGIN-EXPIRED IS SWITCHED"),n.g.SLR.dispatch("TX-LOGIN-ACCOUNT-SWITCHED",{op:e})}),(function(){t.login()}));t.login()}catch(o){location.reload()}}})},t.handlePskeyError=function(){g.q.getConfig("isLogin")&&((0,b.V)({errorCode:w.B.LOGIN_ERROR,message:"handlePskeyError LOGIN_STATUS.error",tipsCustom:{utype:(0,_.getLoginType)(),pttype:(0,v.F$)()}}),this.showLoginExpiredTips(o.error))},t.setLoginTime=function(){if(g.q.getConfig("isLogin")&&!(0,a.ej)("loginTime")){var e=(new Date).getTime();(0,a.d8)("loginTime",String(e)),(0,v.J3)({errCode:0,cgi:"null",loginType:"loginSuc"})}},t.checkLoginIsExpired=function(){var e=this;document.addEventListener("visibilitychange",(function(){var t;if("hidden"!==document.visibilityState)return e.checkIfAccountSwitched()?(null===(t=n.g.log)||void 0===t||t.info("TX-LOGIN-ACCOUNT-SWITCHED In checkLoginIsExpired"),void n.g.SLR.dispatch("TX-LOGIN-ACCOUNT-SWITCHED",{op:"autoResetPskey"})):void 0}))},e}();t.Z=new j},"../spread-sheet/src/core/utils/cell.ts":function(e,t,n){"use strict";n.r(t),n.d(t,{cellIsBold:function(){return u},cellIsItalic:function(){return f},cellIsStrikethrough:function(){return _},cellIsUnderline:function(){return m},getCellDataDVAtPosition:function(){return v},getCellFormat:function(){return c},getMergedFormat:function(){return w},getMergedFormatValue:function(){return y},getMergedValue:function(){return b},getTextFormat:function(){return l},hasBasicFilter:function(){return d},isMergeCellBlank:function(){return g},isRangeCellBlank:function(){return h},isSingleCellBlank:function(){return p},unitTest:function(){return j}}),n("../node_modules/core-js/modules/es.string.bold.js"),n("../node_modules/core-js/modules/es.string.italics.js"),n("../node_modules/core-js/modules/es.regexp.exec.js"),n("../node_modules/core-js/modules/es.string.replace.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.regexp.to-string.js");var o=n("../packages/model/src/index.ts"),r=n("../spread-sheet/src/core/utils/selection.ts"),s=n("../packages/model/src/spreadsheet/SpreadsheetProperties.ts"),i=n("../node_modules/@tencent/tdocs-format-render/lib/index.js"),a=n("../packages/model/src/cell/format/index.ts");function d(e){var t=e.spreadsheet.activeSheet;return!!(null===t||void 0===t?void 0:t.getBasicFilter())}function c(e){var t,n=(0,r.getActiveCell)(e),i=s.Z.defaultDefaultFormat;return n?null==(t=o.Cell.cellDataUtils.getExportFormat(n))&&(t=this.defaultProperties.defaultFormat):t=i,t}function l(e){var t=c(e),n=s.Z.defaultDefaultFormat.getTextFormat();return t.getTextFormat()||n}function u(e){var t=l(e);return!!(null===t||void 0===t?void 0:t.bold)}function f(e){var t=l(e);return!!(null===t||void 0===t?void 0:t.italic)}function m(e){var t=l(e);return!!(null===t||void 0===t?void 0:t.underline)}function _(e){var t=l(e);return!!(null===t||void 0===t?void 0:t.strikethrough)}function p(e,t,n){var o=e.spreadsheet.activeSheet.getCellDataAtPosition(t,n),r=null===o||void 0===o?void 0:o.getEditValue();return!r||""===r.toString().replace(/[\u200B-\u200D\uFEFF]/g,"")}function h(e,t,n){return function(e,t,n){var o=e.spreadsheet.activeSheet.getCellDataAtPosition(t,n);return!!(null===o||void 0===o?void 0:o.getMergeReference())}(e,t,n)?g(e,t,n):p(e,t,n)}function g(e,t,n){var o=e.spreadsheet.activeSheet.getCellDataAtPosition(t,n),r=null===o||void 0===o?void 0:o.getMergeReference();return!!r&&p(e,r.startRowIndex,r.startColIndex)}function v(e,t,n){var o=e.spreadsheet.activeSheet.getCellDataAtPosition(t,n);return null===o||void 0===o?void 0:o.getDataValidation()}function b(e){var t,n=e.getEffectiveValue(),r=e.getFormattedValue();if(n&&n.type===o.Cell.EXTENDED_VALUE_TYPE.ERROR&&"object"===typeof n.value)return(null===(t=n.value)||void 0===t?void 0:t.displayText)||"";var s=null;return r&&(r.type===o.Cell.FORMATTED_VALUE_TYPE.NORMAL||r.type===o.Cell.FORMATTED_VALUE_TYPE.ERROR)&&(s=r.value),s||""}function w(e,t){var n;switch(t){case"textAlign":return x(e);case"verticalAlign":return null!=(n=y(e,"getVerticalAlign"))?n===o.Cell.Format.VERTICAL_ALIGN.TOP?"top":n===o.Cell.Format.VERTICAL_ALIGN.MIDDLE?"middle":"bottom":null;default:return""}}function x(e){var t=null,n=y(e,"getHorizontalAlign");return null!==n?t=I(n):!n&&e.getEffectiveValue()&&(t=C(e)),t}function I(e){var t="right";return e===a.HORIZONTAL_ALIGN.LEFT?t="left":e===a.HORIZONTAL_ALIGN.CENTER&&(t="center"),t}function C(e){var t=o.Cell.cellDataUtils.getExportFormat(e);return t&&(0,i.isTextCell)(t.getNumberFormat())?"left":e.getEffectiveValue().type===o.Cell.EXTENDED_VALUE_TYPE.BOOL||e.getEffectiveValue().type===o.Cell.EXTENDED_VALUE_TYPE.ERROR?"center":e.getEffectiveValue().type===o.Cell.EXTENDED_VALUE_TYPE.NUMBER?"right":"left"}function y(e,t,n){void 0===n&&(n=!1);var o=[e.getEffectiveFormat(),e.getUserEnteredFormat()];n||o.unshift(e.getConditionalFormatResult());for(var r=0;r<o.length;r++){var s=o[r];if(s){var i=s[t]();if(null!=i)return i}}return null}var j={getMergedFormatInTextAlign:x,getMergedFormatWhenValueNotNull:I,getMergedFormatWhenEffectValueNotNull:C}},"../spread-sheet/src/core/utils/config.ts":function(e,t,n){"use strict";n.d(t,{q:function(){return r}});var o=n("../spread-sheet/src/core/data/configService/spreadConfig.ts");function r(){return-1!==["local","new"].indexOf(o.q.getConfig("padStatus"))}},"../spread-sheet/src/core/utils/formula.ts":function(e,t,n){"use strict";n.r(t),n.d(t,{fixRightBracket:function(){return m},getFormulaWithRelativeFormula:function(){return f},getRelativeFormulaWithFormula:function(){return u},isFormula:function(){return r},isFormulaAndError:function(){return i},isFormulaError:function(){return d},isFormulaString:function(){return s},isLegalFormula:function(){return a},moveEqualChar:function(){return c}}),n("../node_modules/core-js/modules/es.array.slice.js"),n("../node_modules/core-js/modules/es.regexp.exec.js"),n("../node_modules/core-js/modules/es.string.replace.js"),n("../node_modules/core-js/modules/es.string.match.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.regexp.to-string.js");var o=n("../packages/model/src/range/hexRangeUtils.ts");function r(e){return"string"===typeof e&&"="===e[0]&&e.length>1}function s(e){return!!(e&&"="===e.slice(0,1)&&e.length>1)}function i(e){return!!s(e)&&!a(e)}var a=function(e){var t=n.g.SpreadsheetApp;if(t){var o=t.spreadsheet.activeSheet.getSheetId();return!t.calcController.getResultBySingleFormula(e,o).isError}return null},d=function(e){return e&&e.length>1?"#"===e[1]||"#"===e[0]:null},c=function(e){return e?e.length>=1&&"="===e[0]?e.substr(1,e.length):e:""},l=function(e){var t,n,o="ABCDEFGHIJKLMNOPQRSTUVWXYZ",r=0;for(t=0,n=(e=e.replace(/\$/g,"")).length-1;t<e.length;t+=1,n-=1)r+=Math.pow(o.length,n)*(o.indexOf(e[t])+1);return r&&(r-=1),r};function u(e,t,n){return"string"===typeof e&&"="===e[0]?e.replace(/(\$?[A-Za-z]+\$?[0-9]+)/g,(function(e){var o=function(e){var t=(e="string"===typeof e?e:String(e)).match(/\d+$/),n=e.replace(/\d+$/,"");return{row:parseInt((null===t||void 0===t?void 0:t[0])||"",10)-1,col:l(n)}}(e.toUpperCase());if(o.row<0||o.col<0)return e;var r=function(e){var t=e.match(/\d+$/);return{alpha:e.replace(/\d+$/,""),num:parseInt((null===t||void 0===t?void 0:t[0])||"",10)}}(e).alpha,s="$"===r[0]||!1;return("$"===r[r.length-1]?"R"+o.row.toString():"R["+(o.row-t).toString()+"]")+(s?"C"+o.col.toString():"C["+(o.col-n).toString()+"]")})):""}function f(e,t,n){return"string"===typeof e&&"="===e[0]?e.replace(/(R\[?-?[0-9]+\]?C\[?-?[0-9]+\]?)/g,(function(e){var r,s,i=e.indexOf("C"),a=!("["===e[1]&&"]"===e[i-1])||!1,d=!("["===e[i+1]&&"]"===e[e.length-1])||!1;if(a)r="$"+(parseInt(e.substring(1,i),10)+1).toString();else{if(r=e.substring(2,i-1),(r=parseInt(r,10)+t+1)<=0)return"#REF!";r=r.toString()}if(d)s=e.substring(i+1),s="$"+(0,o.colIndex2ColChar)(parseInt(s,10));else{if(s=e.substring(i+2,e.length-1),(s=parseInt(s,10)+n)<0)return"#REF!";s=(0,o.colIndex2ColChar)(s)}return r&&s?s+r:"#REF!"})):""}function m(e){if("string"===typeof e&&r(e)){var t=e.replace(/(")[^"]*?\1/g,"");t=(t=t.replace(/'.*?'!/g,"")).replace(/\n$/g,"");for(var n=0,o=0,s=0;s<t.length;s++)"("===t[s]?n+=1:")"===t[s]&&(o+=1);n-o===1&&(e+=")")}return e}},"../spread-sheet/src/core/utils/freeze.ts":function(e,t,n){"use strict";n.r(t),n.d(t,{calcFrozenRowColmn:function(){return d},cancelFreezePreview:function(){return u},checkFreezeAreaOutOfView:function(){return g},doFreeze:function(){return p},firstColumnFreezePreview:function(){return m},firstRowFreezePreview:function(){return f},freezePreview:function(){return _},generateFreezeBtnText:function(){return l},generateFreezeRequestOption:function(){return c},reportFreezeApplyStatus:function(){return h}});var o=n("../node_modules/i18next/dist/esm/i18next.js"),r=n("../packages/model/src/range/hexRangeUtils.ts"),s=n("../packages/report/src/index.ts"),i=n("../spread-sheet/src/external/view/common/constants/string.ts"),a=n("../spread-sheet/src/core/ui/dialog/index.ts"),d=function(e){var t=e.spreadsheet.activeSheet,n=t.getFrozenRowCount(),o=t.getFrozenColCount(),r=e.view.getSelectionWithGridRanges().rangeSelections,s=r[0];if(1!==r.length)return{isError:!0,row:0,column:0,isForzenRow:!1,isForzenColumn:!1};var i=-1,a=-1,d=!0,c=!0;s.isSheet?(i=0,a=0):s.isRow?(i=s.endRowIndex,o>0&&0===n?a=o-1:c=!1):s.isCol?(a=s.endColIndex,n>0&&0===o?i=n-1:d=!1):0===s.startRowIndex&&0===s.startColIndex?(i=s.endRowIndex,a=s.endColIndex):(i=Math.max(s.startRowIndex-1,0),a=Math.max(s.startColIndex-1,0));var l=function(e,t,n){var o=!1,r=e.view.canvas.clientRect.width-e.view.canvas.headSize.displayRowHeadWidth,s=e.view.canvas.clientRect.height-e.view.canvas.headSize.displayColHeadHeight;return t&&t>0&&e.view.canvas.areaData.getDisplayGlobalRightByCol(t)>r&&(o=!0),n&&n>0&&e.view.canvas.areaData.getDisplayGlobalBottomByRow(n)>s&&(o=!0),!o}(e,a,i);return{isError:!l,row:i,column:a,isForzenRow:d,isForzenColumn:c}},c=function(e){var t=d(e),n=t.row,o=t.column,r=t.isForzenRow;return{column:t.isForzenColumn?o+1:0,row:r?n+1:0}},l=function(e){var t=d(e),n=t.row,s=t.column,i=t.isForzenRow,a=t.isForzenColumn,c=(-1===n?0:n)+1,l=(0,r.colIndex2ColChar)(-1===s?0:s);return o.ZP.t("冻结至第{{value0}}{{value1}}",{value0:i?""+c+o.ZP.t("frozen row"):"",value1:a?""+l+o.ZP.t("frozen column"):""})};function u(e){e.requestApi.cancelFreezePreview()}function f(e){e.requestApi.freezePreview({row:1})}function m(e){e.requestApi.freezePreview({column:1})}function _(e){if(d(e).isError)return u(e);var t=c(e);e.requestApi.freezePreview(t)}function p(e,t){var n={};switch(t){case"firstRow":n={row:1,column:0};break;case"firstColumn":n={column:1,row:0};break;case"currentCell":n=c(e);break;case"cancelFreeze":n={row:-1,column:-1}}e.requestApi.freeze(n)}var h=function(e,t){var n=t.row,o=t.column;if(n&&n>0&&0===o)s.ZP.tdwReport({opername:"doc_excel_editor",module:"excel_freeze",action:"row_freeze"});else if(o&&o>0&&0===n)s.ZP.tdwReport({opername:"doc_excel_editor",module:"excel_freeze",action:"col_freeze"});else if(o&&o>0&&n&&n>0){var r=e.spreadsheet.activeSheet,i=r.getFrozenRowCount(),a=r.getFrozenColCount();0!==i&&0!==a?s.ZP.tdwReport({opername:"doc_excel_editor",module:"excel_freeze",action:"re-row+col_freeze"}):0!==i&&0!==a||s.ZP.tdwReport({opername:"doc_excel_editor",module:"excel_freeze",action:"row+col_freeze"})}};function g(e,t){var n=e.clientRect.width-e.headSize.displayRowHeadWidth,o=e.clientRect.height-e.headSize.displayColHeadHeight;return t.column&&t.column>0&&e.areaData.getDisplayGlobalRightByCol(t.column-1)>n?(a.dialog.info({title:i.V,content:i.e}),!1):!((null===t||void 0===t?void 0:t.row)&&(null===t||void 0===t?void 0:t.row)>0&&e.areaData.getDisplayGlobalBottomByRow(t.row-1)>o)||(a.dialog.info({title:i.V,content:i.e}),!1)}},"../spread-sheet/src/core/utils/index.ts":function(e,t,n){"use strict";var o,r=n("../spread-sheet/src/core/utils/cell.ts"),s=n("../spread-sheet/src/core/utils/freeze.ts"),i=n("../spread-sheet/src/core/utils/selection.ts"),a=n("../spread-sheet/src/core/utils/range.ts"),d=n("../spread-sheet/src/core/utils/numberFromat.ts"),c=n("../spread-sheet/src/core/utils/formula.ts"),l=n("../spread-sheet/src/core/utils/util.ts"),u=n("../spread-sheet/src/core/utils/sheet.ts"),f=n("../spread-sheet/src/core/utils/formulaInsert.ts");!function(e){e.cell=r,e.selection=i,e.range=a,e.freeze=s,e.util=l,e.numberFormat=d,e.sheet=u,function(e){e.FormulaInsert=f.M,e.util=c}(e.formula||(e.formula={}))}(o||(o={})),t.Z=o},"../spread-sheet/src/core/utils/offline-env.ts":function(e,t,n){"use strict";n.d(t,{j:function(){return o}});var o=function(){return!!window.__SUPPORT_FULL_OFFLINE_MODE}},"../spread-sheet/src/core/utils/range.ts":function(e,t,n){"use strict";n.r(t),n.d(t,{mergeMultiRanges:function(){return d},select2AbsoluteHex:function(){return a},select2RelativeHex:function(){return i}}),n("../node_modules/core-js/modules/es.array.map.js"),n("../node_modules/core-js/modules/es.array.sort.js");var o=n("../packages/model/src/index.ts"),r=n("../packages/model/src/range/hexRangeUtils.ts"),s=n("../packages/model/src/range/index.ts");function i(e,t){var n,o,i,a;if(t.selectCol){var d=t.xRange;o=d[0],a=d[1],n=s.DEFAULT_DIMENSION_INDEX,i=s.DEFAULT_DIMENSION_INDEX}else if(t.selectRow){var c=t.yRange;n=c[0],i=c[1],o=s.DEFAULT_DIMENSION_INDEX,a=s.DEFAULT_DIMENSION_INDEX}else if(t.selectAll)n=0,i=e.getRowCount()-1,o=0,a=e.getColCount()-1;else{var l=t.xRange;o=l[0],a=l[1];var u=t.yRange;n=u[0],i=u[1]}return(0,r.range2RelativeHex)(new s.GridRange(e.getSheetId(),n,i,o,a),e)}function a(e,t){var n;if(t.selectCol){var o=t.xRange,s=o[0],i=o[1];n="$"+(0,r.colIndex2ColChar)(s)+":$"+(0,r.colIndex2ColChar)(i)}else if(t.selectRow){var a=t.yRange;n="$"+(a[0]+1)+":$"+(a[1]+1)}else if(t.selectAll){var d=e.getRowCount()-1,c=e.getColCount()-1;n="$"+(0,r.colIndex2ColChar)(0)+"$1:$"+(0,r.colIndex2ColChar)(c)+"$"+(d+1)}else{var l=t.xRange,u=l[0],f=l[1],m=t.yRange,_=m[0],p=m[1];n="$"+(0,r.colIndex2ColChar)(u)+"$"+(_+1)+":$"+(0,r.colIndex2ColChar)(f)+"$"+(p+1)}return n}function d(e){var t=e.map((function(e){return e.clone()})),n=[];t.sort((function(e,t){return e.startColIndex-t.startColIndex}));for(var r=t.length,s=null,i=0;i<r;i++){var a=t[i],d=!1;s?(s.contain(a)||(a.contain(s)?s=a:a.startRowIndex===s.startRowIndex&&a.endRowIndex===s.endRowIndex?a.startColIndex>=s.startColIndex&&a.startColIndex<=s.endColIndex?(s=new o.Range.GridRange(s.sheetId,s.startRowIndex,s.endRowIndex,s.startColIndex,Math.max(s.endColIndex,a.endColIndex)),d=!0):s.startColIndex===a.endColIndex+1?(s=new o.Range.GridRange(s.sheetId,s.startRowIndex,s.endRowIndex,a.startColIndex,s.endColIndex),d=!0):s.endColIndex===a.startColIndex-1&&(s=new o.Range.GridRange(s.sheetId,s.startRowIndex,s.endRowIndex,s.startColIndex,a.endColIndex),d=!0):a.startColIndex===s.startColIndex&&a.endColIndex===s.endColIndex&&(a.startRowIndex>=s.startRowIndex&&a.startRowIndex<=s.endRowIndex?(s=new o.Range.GridRange(s.sheetId,s.startRowIndex,Math.max(s.endRowIndex,a.endRowIndex),s.startColIndex,s.endColIndex),d=!0):s.startRowIndex===a.endRowIndex+1?(s=new o.Range.GridRange(s.sheetId,a.startRowIndex,s.endRowIndex,s.startColIndex,s.endColIndex),d=!0):s.endRowIndex===a.startRowIndex-1&&(s=new o.Range.GridRange(s.sheetId,s.startRowIndex,a.endRowIndex,s.startColIndex,s.endColIndex),d=!0))),d?i===r-1&&n.push(s):(n.push(s,a),s=null)):(i===r-1&&n.push(a),s=a)}return n}},"../spread-sheet/src/core/utils/selection.ts":function(e,t,n){"use strict";n.r(t),n.d(t,{allBlank:function(){return T},getActiveCell:function(){return r},getFirstColInSelection:function(){return S},getFirstRowInSelection:function(){return E},getSelectCLs:function(){return h},getSelectRange:function(){return u},getSelectedColumns:function(){return p},hasMergeCell:function(){return a},hasSelect:function(){return w},isCellDataBlank:function(){return y},isLinkCell:function(){return f},isMergeCell:function(){return s},isMergeCellBlank:function(){return I},isPickShape:function(){return x},isRangeCellBlank:function(){return j},isRangeDataBlank:function(){return C},isSelectColoumn:function(){return _},isSelectRow:function(){return m},isSelectedAll:function(){return b},rangeHasMergeCell:function(){return d},rangeIsMergeCell:function(){return i},selectImage:function(){return g},selectionHasCrossMergeCell:function(){return c},singleColumn:function(){return v},singleRange:function(){return l}}),n("../node_modules/core-js/modules/es.regexp.exec.js"),n("../node_modules/core-js/modules/es.string.replace.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.regexp.to-string.js");var o=n("../packages/model/src/index.ts");function r(e){var t=e.view.getSelection().activeCell;return t.colIndex<0||t.colIndex<0?null:e.spreadsheet.activeSheet?e.spreadsheet.activeSheet.getCellDataAtPosition(t.rowIndex,t.colIndex):null}function s(e){var t=e.view.getSelection().rangeSelections;if(t.length<=0)return!1;var n=t[0],o=e.spreadsheet.activeSheet.getCellDataAtPosition(n.startRowIndex,n.startColIndex),r=null===o||void 0===o?void 0:o.getMergeReference();return!!r&&n.equal(r)}function i(e,t){if(!t)return!1;var n=t.getMergeReference();return!!n&&n.equal(e)}function a(e){var t=e.view.getSelection().rangeSelections;return!(t.length<=0)&&d(e,t[0])}function d(e,t){var n=e.spreadsheet.activeSheet.mergeManager.mergeList;if(!n)return!1;for(var r=0;r<n.length;r++){var s=new o.Range.GridRange(n[r].sheetId,n[r].startRowIndex,n[r].endRowIndex,n[r].startColIndex,n[r].endColIndex);if(t.contain(s))return!0}return!1}function c(e){var t=e.view.getSelection().rangeSelections;if(t.length<=0)return!1;var n=t[0],r=e.spreadsheet.activeSheet.mergeManager.mergeList;if(!r)return!1;for(var s=0;s<r.length;s++){var i=new o.Range.GridRange(r[s].sheetId,r[s].startRowIndex,r[s].endRowIndex,r[s].startColIndex,r[s].endColIndex);if(n.isCross(i)&&!n.contain(i))return!0}return!1}function l(e){var t=e.view.getSelection().rangeSelections;return!(t.length<=0)&&(!!t[0].isSingle()||!!s(e))}function u(e){var t=e.view.getSelection().rangeSelections;return t.length<=0?null:t[0]}function f(e){var t=e.view.getSelection().rangeSelections;if(t.length<=0)return!1;var n=t[0],o=e.spreadsheet.activeSheet.getCellDataAtPosition(n.startRowIndex,n.startColIndex);return!!o&&!(!o.getHyperlink()&&!o.getHyperlinkRuns())}function m(e){if(!e.view.canvas.normalSelectData)return!1;for(var t=e.view.canvas.normalSelectData.selectQueue,n=0;n<t.length;n++)if(t[n].selectRow)return!0;return!1}function _(e){if(!e.view.canvas.normalSelectData)return!1;for(var t=e.view.canvas.normalSelectData.selectQueue,n=0;n<t.length;n++)if(t[n].selectCol)return!0;return!1}function p(e){if(!e.view.canvas.normalSelectData)return[];for(var t=[],n=e.view.canvas.normalSelectData.selectQueue,o=0;o<n.length;o++){var r=n[o];r.selectCol&&t.push({start:r.xRange[0],end:r.xRange[1]})}return t}function h(e){var t=e.view.getSelection().rangeSelections;if(t.length<=0)return!1;var n=t[0];return{rows:n.endRowIndex-n.startRowIndex+1,cols:n.endColIndex-n.startColIndex+1}}function g(e){var t,n;try{var o=null===(n=null===(t=e.view.canvas)||void 0===t?void 0:t.shapeEditCenter)||void 0===n?void 0:n.shapeEdit;return!!o&&o.focusing}catch(r){return!1}}function v(e){var t=e.view.getSelection();if(null===t)return null;var n=t.rangeSelections[0];return n.startColIndex===n.endColIndex}function b(e){var t=e.view.getSelection().rangeSelections;if(t.length<=0)return!1;var n=t[0],o=e.spreadsheet.activeSheet.getRowCount(),r=e.spreadsheet.activeSheet.getColCount();return 0===n.startColIndex&&n.endColIndex===r-1&&0===n.startRowIndex&&n.endRowIndex===o-1}function w(e){return!!e.view.canvas.normalSelectData&&e.view.canvas.normalSelectData.selectQueue.length>0}function x(e){var t,n,o=null===(n=null===(t=e.view.canvas)||void 0===t?void 0:t.shapeEditCenter)||void 0===n?void 0:n.shapeEdit;return!!o&&o.focusing}function I(e,t,n){var o=e.spreadsheet.activeSheet.getCellDataAtPosition(t,n),r=null===o||void 0===o?void 0:o.getMergeReference();return!!r&&y(e,r.startRowIndex,r.startColIndex)}function C(e,t){for(var n=t.startRowIndex;n<=t.endRowIndex;n++)for(var o=t.startColIndex;o<=t.endColIndex;o++)if(!y(e,n,o))return!1;return!0}function y(e,t,n){var o=e.spreadsheet.activeSheet.getCellDataAtPosition(t,n),r=null===o||void 0===o?void 0:o.getEditValue();return!r||""===r.toString().replace(/[\u200B-\u200D\uFEFF]/g,"")}function j(e,t,n){return function(e,t,n){var o=e.spreadsheet.activeSheet.getCellDataAtPosition(t,n);return!!(null===o||void 0===o?void 0:o.getMergeReference())}(e,t,n)?I(e,t,n):y(e,t,n)}var T=function(e,t){for(var n=t,o=n.startRowIndex;o<=n.endRowIndex;o++)for(var r=n.startColIndex;r<=n.endColIndex;r++)if(!j(e,o,r))return!1;return!0};function E(e){var t=e.view.getSelection();if(0===t.rangeSelections.length)throw new Error("选区不存在");return t.rangeSelections[0].startRowIndex}function S(e){var t=e.view.getSelection();if(0===t.rangeSelections.length)throw new Error("选区不存在");return t.rangeSelections[0].startColIndex}},"../spread-sheet/src/core/utils/sheetClip/SheetClip.js":function(e,t,n){n("../node_modules/core-js/modules/es.regexp.exec.js"),n("../node_modules/core-js/modules/es.string.split.js"),n("../node_modules/core-js/modules/es.string.replace.js"),function(e){"use strict";function n(e){return e.split('"').length-1}var o=function(e){var t,o,r,s,i,a,d,c=[],l=0;for((r=(e=e.replace(/\r\n/g,"\n").replace(/\r/g,"\n")).split("\n")).length>1&&""===r[r.length-1]&&r.pop(),t=0,o=r.length;t<o;t+=1){for(r[t]=r[t].split("\t"),s=0,i=r[t].length;s<i;s+=1)c[l]||(c[l]=[]),a&&0===s?(d=c[l].length-1,c[l][d]=c[l][d]+"\n"+r[t][0],a&&1&n(r[t][0])&&(a=!1,c[l][d]=c[l][d].substring(0,c[l][d].length-1))):s===i-1&&0===r[t][s].indexOf('"')&&1&n(r[t][s])?(c[l].push(r[t][s].substring(1)),a=!0):a?(1&n(r[t][s])&&a&&0!=r[t][s].length&&r[t][s].lastIndexOf('"')===r[t][s].length-1&&(a=!1),d=c[l].length-1,c[l][d]=c[l][d]+"\n"+r[t][0]):(c[l].push(r[t][s]),a=!1);a||(l+=1)}return c},r=function(e){var t,n,o,r,s,i="";for(t=0,n=e.length;t<n;t+=1){for(r=e[t].length,o=0;o<r;o+=1)o>0&&(i+="\t"),"string"===typeof(s=e[t][o])?s.indexOf("\n")>-1||s.indexOf("\r")>-1||s.indexOf("\t")>-1?i+='"'+s.replace(/"/g,'""')+'"':i+=s:i+=null===s||void 0===s?"":s;n-1!=t&&(i+="\n")}return i};t.parse=o,t.stringify=r}(window)},"../spread-sheet/src/core/view/config/default.ts":function(e,t,n){"use strict";n.d(t,{C8:function(){return y},Co:function(){return N},GB:function(){return M},GD:function(){return U},I1:function(){return F},J9:function(){return A},MN:function(){return V},Mz:function(){return H},OB:function(){return $},OC:function(){return E},QX:function(){return p},Tx:function(){return T},U2:function(){return h},YH:function(){return S},_4:function(){return j},ai:function(){return g},bU:function(){return z},dT:function(){return B},e6:function(){return X},eP:function(){return P},et:function(){return L},ey:function(){return Y},gU:function(){return _},kD:function(){return D},kW:function(){return k},kp:function(){return Z},li:function(){return O},mK:function(){return R},mu:function(){return w},n5:function(){return C},oc:function(){return G},py:function(){return v},t1:function(){return W},u3:function(){return Q},vN:function(){return q},vf:function(){return m},ws:function(){return b},xw:function(){return x}});var o=n("../node_modules/i18next/dist/esm/i18next.js"),r=n("../spread-sheet/src/core/view/spreadsheet-view/model/VerticalAlign.ts"),s=n("../spread-sheet/src/core/view/spreadsheet-view/model/HorizontalAlign.ts"),i=(n("../packages/common-utils/src/index.ts"),n("../spread-sheet/src/core/view/spreadsheet-view/model/WrapStrategy.ts")),a=n("../spread-sheet/src/core/view/spreadsheet-view/model/Color.ts"),d=n("../spread-sheet/src/core/view/spreadsheet-view/model/CellPadding.ts"),c=n("../spread-sheet/src/core/view/spreadsheet-view/render-manager/alloy-excel/utils.ts"),l=n("../spread-sheet/src/external/view/mobile/header/native-header/utils.ts"),u=n("../spread-sheet/src/base/config/font.ts"),f=n("../packages/model/src/config/index.ts"),m=50,_=f.DEFAULT_ROW_HEIGHT_PC,p=1,h=.85,g=.65,v=c.v.THIN,b=a.Z.newInstanceByHex("#dcdcdc"),w=c.j.THIN,x=a.Z.newInstanceByHex("#000000"),I=u.em,C=10,y={color:x,fontFamily:I,fontSize:C},j=a.Z.newInstanceByHex("#ffffff"),T={width:v,style:w,color:a.Z.newInstanceByHex("#e2e4e8")},E=r.Z.newInstance(r.o.MIDDLE),S=s.Z.newInstance(s.O.LEFT),R=i.Z.newInstance(i.J.NOWRAP),A=(a.Z.newInstanceByHex("#d6d6d6"),d.Z.newInstance(d.i.EMPTY,d.i.TEXT,d.i.EMPTY,d.i.TEXT)),k=4,D=2,P="#ffb300",O={Height:22,Radius:11,OuterPadding:1,InnerLeftRightPadding:8,InnerLeftRightPaddingEnt:2,TriangleWidth:8,TriangleHeight:5,LabelAndTrianglePadding:4},N=[0,0,O.TriangleWidth,0,O.TriangleWidth/2,O.TriangleHeight],M={TextColor:"#0188fb",BorderWidth:1,StrokeColor:"#e0e0e0",NormalFillColor:"#ffffff",HoverFillColor:"#f4f4f4",HighlightFillColor:"#fff4c4",ShadowInfo:{shadowColor:"#B9B9B9",shadowOffsetX:0,shadowOffsetY:2,shadowBlur:10},TriangleColor:"#0188fb"},L={borderWidth:M.BorderWidth,fillColor:M.NormalFillColor,strokeColor:M.StrokeColor,shadowInfo:M.ShadowInfo},F={borderWidth:M.BorderWidth,fillColor:M.HoverFillColor,strokeColor:M.StrokeColor,shadowInfo:M.ShadowInfo},Z={borderWidth:M.BorderWidth,fillColor:M.HighlightFillColor,strokeColor:M.StrokeColor,shadowInfo:M.ShadowInfo},U=500,B=50,z=250,H=(0,l.W)()?0:44,V=H+0,G=44,q=290,W={width:v,style:w,color:a.Z.newInstanceByHex("#e2e4e8")},Y={width:v,style:w,color:a.Z.newInstanceByHex("#02bd88")},X={width:v,style:w,color:a.Z.newInstanceByHex("#1e6fff")},Q={width:v,style:w,color:a.Z.newInstanceByHex("#81868f")},$=[{color:"#FFFF66",realColor:"#FFFFC1",text:o.ZP.t("嫩黄")},{color:"#A9FF78",realColor:"#DCFFC9",text:o.ZP.t("嫩绿")},{color:"#78FFFF",realColor:"#C9FFFF",text:o.ZP.t("嫩青")},{color:"#6666FF",realColor:"#C1C1FF",text:o.ZP.t("嫩蓝紫")},{color:"#FF66FF",realColor:"#FFC1FF",text:o.ZP.t("嫩粉")},{color:"#FF6A66",realColor:"#FFC3C1",text:o.ZP.t("嫩红")},{color:"#90949C",realColor:"#D2D4D7",text:o.ZP.t("嫩灰")},{color:"#ffff00",realColor:"#FFFF99",text:o.ZP.t("亮黄")},{color:"#71ff1e",realColor:"#C6FFA5",text:o.ZP.t("亮绿")},{color:"#1fffff",realColor:"#A5FFFF",text:o.ZP.t("亮青")},{color:"#0000ff",realColor:"#9999FF",text:o.ZP.t("亮蓝紫")},{color:"#ff00ff",realColor:"#FF99FF",text:o.ZP.t("亮粉")},{color:"#ff0700",realColor:"#FF9B99",text:o.ZP.t("亮红")},{color:"#464D5A",realColor:"#B5B7BD",text:o.ZP.t("亮灰")}]},"../spread-sheet/src/entry/browser/pc.ts":function(e,t,n){"use strict";var o=n("../node_modules/@babel/runtime/helpers/esm/inheritsLoose.js"),r=(n("../node_modules/regenerator-runtime/runtime.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.promise.js"),n("../node_modules/@abraham/reflection/dist/index.js"),n("../spread-sheet/src/entry/base.ts")),s=n("../spread-sheet/src/base/util/handle-header-hidden-style.ts"),i=(n("../spread-sheet/src/flow/browser/registry/pc.ts"),n("../spread-sheet/src/flow/browser/index.ts")),a=n("../spread-sheet/src/flow/common/initialization.ts"),d=n("../spread-sheet/src/flow/browser/adaptor/pc/sheet-life-adaptor.ts"),c=function(e,t,n,o){return new(n||(n=Promise))((function(r,s){function i(e){try{d(o.next(e))}catch(t){s(t)}}function a(e){try{d(o.throw(e))}catch(t){s(t)}}function d(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,a)}d((o=o.apply(e,t||[])).next())}))};(new(function(e){function t(){return e.call(this)||this}(0,o.Z)(t,e);var n=t.prototype;return n.initFlow=function(){this.flow=new i.Z},n.start=function(){return c(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(0,s.C)(),this.initFlow(),t=a.V7.createInstance(d.u),e.next=5,this.flow.startSheetLife(t);case 5:this.flowEnd();case 6:case"end":return e.stop()}}),e,this)})))},t}(r.s))).run()},"../spread-sheet/src/external/app-guide/app-guide.ts":function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return y}});var o,r,s=n("../node_modules/@babel/runtime/helpers/esm/inheritsLoose.js"),i=(n("../node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),n("../node_modules/core-js/modules/esnext.reflect.metadata.js"),n("../node_modules/core-js/modules/es.regexp.exec.js"),n("../node_modules/core-js/modules/es.string.match.js"),n("../node_modules/core-js/modules/es.regexp.constructor.js"),n("../node_modules/core-js/modules/es.regexp.to-string.js"),n("../spread-sheet/src/core/script-loader/index.ts")),a=n("../spread-sheet/src/base/util/mobile.ts"),d=n("../spread-sheet/src/base/event/event.ts"),c=n("../node_modules/@tencent/docs-user-agent/dist/index.js"),l=n.n(c),u=n("../node_modules/@tencent/doc-contribute/dist/contributes.js"),f=n.n(u),m=JSON.parse('{"name":"AppGuideConfig","displayName":"腾讯文档移动端右下角引导保存到我的文档同步助手配置","description":"引导保存到我的文档","version":"1.0.0","publisher":"enoyao","license":"MIT","contributes":{"isShow":[{"description":"判断是否是移动端","when":"isMobilePhone || isAndroidPad || isIPad"},{"description":"判断是否是移动客户端","when":"!isTencentDocsApp"}]}}'),_=JSON.parse('{"name":"AppGuideConfig","displayName":"腾讯文档移动端右下角引导保存到我的文档默认配置","description":"引导保存到我的文档","version":"1.0.0","publisher":"enoyao","license":"MIT","contributes":{"isShow":[{"description":"判断是否是移动端","when":"false"},{"description":"判断是否是移动客户端","when":"false"}]}}'),p=n("../spread-sheet/src/core/data/configService/spreadConfig.ts"),h=n("../spread-sheet/src/core/app/SpreadsheetApp.interface.ts"),g=n("../spread-sheet/src/core/view/layout/interface/pc-view.ts"),v=n("../node_modules/@tencent/containerized/build/main/index.js"),b=function(e,t,n,o){var r,s=arguments.length,i=s<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)i=Reflect.decorate(e,t,n,o);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(i=(s<3?r(i):s>3?r(t,n,i):r(t,n))||i);return s>3&&i&&Object.defineProperty(t,n,i),i},w=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},x=function(e,t){return function(n,o){t(n,o,e)}},I=document.cookie.match(new RegExp("(^| )open_theme_id=([^;]*)(;|$)"));"EMBED.WE_SYNC"==="EMBED."+(null===I||void 0===I?void 0:I[2].toUpperCase())?f().setContribute({name:"app.guide",json:_}):f().setContribute({name:"app.guide",json:m});var C=function(e){function t(t,o){var r;return(r=e.call(this)||this).app=t,r.view=o,r.initGuideSaveToMydoc=function(){var e;null===(e=n.g.SLR)||void 0===e||e.listen("GET_DOCINFO_SUCCESS",(function(){if(!p.q.getConfig("isOwner")){var e=function(){(0,i.$y)("BuoyButtonMobile",(function(e){var t;r.buoyButtonModule=e,e.showBuoyButton({buttonType:"ADD_TO_MYDOC",clientVars:n.g.clientVars,preferredBottom:a.cY?85:null}),r.buoyButtonExpand=!0,(null===(t=r.view)||void 0===t?void 0:t.footer)?r.view.canvas.areaData.onUpdateOffset(r.saveMydocScrollHandler):d.ZP.sheetsBar.listen("footerloadEnd",(function(){r.view.canvas.areaData.onUpdateOffset(r.saveMydocScrollHandler)}))}))};n.g.SLR.assetLoaded?e():n.g.SLR.listen("SL-INIT",e)}}))},r.saveMydocScrollHandler=function(){var e,t,o=null===(e=r.view)||void 0===e?void 0:e.canvas,s=(null===o||void 0===o?void 0:o.areaData.row.flow.to)===(null===o||void 0===o?void 0:o.areaData.row.flow.renderTo);r.buoyButtonExpand!==s&&(null===(t=r.buoyButtonModule)||void 0===t||t.showBuoyButton({buttonType:"ADD_TO_MYDOC",noText:!s,clientVars:n.g.clientVars,preferredBottom:a.cY?85:null}),r.buoyButtonExpand=s)},r._register((0,v.OF)((function(){r.destroy()}),"destroyResetLocation")),r.buoyButtonModule=null,r.buoyButtonExpand=!1,r.initListener(),r}(0,s.Z)(t,e);var o=t.prototype;return o.init=function(){this.setContext(),f().getContribute("app.guide").isShow.every((function(e){return!0===e.when}))&&this.initGuideSaveToMydoc()},o.destroy=function(){var e;null===(e=this.buoyButtonModule)||void 0===e||e.destroy()},o.initListener=function(){var e;null===(e=this.app)||void 0===e||e.emitter.on(this.app.EVENT.DESTROY,this.destroy.bind(this))},o.setContext=function(){var e={isMobilePhone:function(){return l().isMobilePhone},isAndroidPad:function(){return l().isAndroidPad},isIPad:function(){return l().isIPad},isTencentDocsApp:function(){return l().isTencentDocsApp}};f().updateContribute({name:"app.guide",context:e})},t}(v.JT),y=C=b([x(0,h.m),x(1,g.w),w("design:paramtypes",["function"===typeof(o="undefined"!==typeof h.m&&h.m)?o:Object,"function"===typeof(r="undefined"!==typeof g.w&&g.w)?r:Object])],C)},"../spread-sheet/src/external/app-guide/index.ts":function(e,t,n){"use strict";n.d(t,{s:function(){return o}}),n("../spread-sheet/src/external/app-guide/app-guide.ts");var o=(0,n("../node_modules/@tencent/containerized/build/main/index.js").yh)("IAppGuide")},"../spread-sheet/src/external/auth/pc/AdvPermissions.ts":function(e,t,n){"use strict";n.r(t),n.d(t,{IAdvPermissionsPC:function(){return u}});var o=n("../node_modules/@babel/runtime/helpers/esm/inheritsLoose.js"),r=n("../node_modules/i18next/dist/esm/i18next.js"),s=n("../spread-sheet/src/external/auth/base/AdvPermissions.ts"),i=n("../node_modules/@tencent/containerized/build/main/index.js"),a=n("../packages/report/src/index.ts"),d=n("../spread-sheet/src/core/data/configService/spreadConfig.ts"),c=n("../node_modules/@tencent/dui/lib/components/Snackbar/index.js"),l=function(e){function t(t){var o;return(o=e.call(this,t)||this).showExptimeTipsForOwner=function(){var e;null===(e=n.g.SLR)||void 0===e||e.dispatch("ADVPER_AUTH_EXPIRED"),c.default.show({type:"info",message:r.ZP.t("访问链接已过期，对方无法访问。更改有效期"),action:r.ZP.t("更改有效期"),onClickAction:function(){o.showAuthMenu();try{a.ZP.tdwReport({opername:"doc_access",module:"page",action:"change"})}catch(e){}},duration:3e3,zIndex:99999})},o.showWillExptimeTipsForCollaborator=function(){c.default.show({type:"info",message:r.ZP.t("文档已到期，你将无法继续访问。请刷新"),action:r.ZP.t("请刷新"),onClickAction:function(){o.refreshPage();try{a.ZP.tdwReport({opername:"doc_access",module:"page",action:"refresh"})}catch(e){}},duration:1e4,zIndex:99999})},o.showAuthMenu=function(){n.g.SLR.load("MenuAdvPermission",(function(e){var t=d.q.getConfig("creatorDomain"),n=d.q.getConfig("domainId"),r=d.q.getConfig("padId"),s=d.q.getConfig("uin"),i=d.q.getConfig("docType");e.show(o.getTrasnferAuthDetailContainer(),{domainId:n,padId:r,creatorDomain:t,padType:i,relateForm:o.app.feature.relateForm,userId:s})}))},o.getTrasnferAuthDetailContainer=function(){var e="avd-container",t=document.getElementById(e);return t||((t=document.createElement("div")).id=e,document.body.appendChild(t)),t},o}return(0,o.Z)(t,e),t.prototype.showError=function(){c.default.show({type:"error",message:r.ZP.t("加载文档有效期出错。"),duration:3e3,zIndex:99999})},t}(s.Z),u=(0,i.yh)("AdvPermissionsPC");t.default=l},"../spread-sheet/src/external/badgeServiceExcelAdapter/badgeServiceExcelAdapter.interface.ts":function(e,t,n){"use strict";n.d(t,{P:function(){return o}});var o=(0,n("../node_modules/@tencent/containerized/build/main/index.js").yh)("BadgeServiceExcelAdapter")},"../spread-sheet/src/external/history/pc/History.interface.ts":function(e,t,n){"use strict";n.d(t,{z:function(){return o}});var o=(0,n("../node_modules/@tencent/containerized/build/main/index.js").yh)("IHistory")},"../spread-sheet/src/external/report/raven.ts":function(e,t,n){"use strict";n.d(t,{e:function(){return o}});var o=window.Raven},"../spread-sheet/src/external/resetLocation/resetLocation.interface.ts":function(e,t,n){"use strict";n.d(t,{h:function(){return o}});var o=(0,n("../node_modules/@tencent/containerized/build/main/index.js").yh)("IResetLocation")},"../spread-sheet/src/external/share/share-controller.interface.ts":function(e,t,n){"use strict";n.d(t,{N:function(){return o}});var o=(0,n("../node_modules/@tencent/containerized/build/main/index.js").yh)("IShareController")},"../spread-sheet/src/external/sheet-adapter/smart-sheet-adapter/constants.ts":function(e,t,n){"use strict";var o,r;n.d(t,{TF:function(){return o},dH:function(){return s},v7:function(){return r}}),function(e){e.HIDE_SHEET_LIST="hide_sheet_list",e.FIRST_EDIT="first_edit",e.RENDER_FINISH="render_finish"}(o||(o={})),function(e){e.MESSAGE_CENTER="message_center",e.DATA_CENTER="data_center",e.UNDO_REDO_STACK="undo_redo_stack",e.SPREAD_CONFIG="spread_config",e.USER_CENTER="user_center",e.SEARCH_CENTER="search_center",e.NATIVE_CENTER="native_center",e.PERMISSION="permission",e.UI_CENTER="ui_center",e.BROWSE_LOCATION="browse_location",e.MEETING_CENTER="meeting_center",e.ARK_CENTER="ark_center",e.COMMON_OPERATION="common_operation"}(r||(r={}));var s="xtable";new Date("2022-04-1")},"../spread-sheet/src/external/sync-guide/sync-guide.interface.ts":function(e,t,n){"use strict";n.d(t,{F:function(){return o}});var o=(0,n("../node_modules/@tencent/containerized/build/main/index.js").yh)("ISyncGuide")},"../spread-sheet/src/external/templateinfo/templateinfo.interface.ts":function(e,t,n){"use strict";n.d(t,{J:function(){return o}});var o=(0,n("../node_modules/@tencent/containerized/build/main/index.js").yh)("ITemplateInfoService")},"../spread-sheet/src/external/titleSync/titleSync.interface.ts":function(e,t,n){"use strict";n.d(t,{J:function(){return o}});var o=(0,n("../node_modules/@tencent/containerized/build/main/index.js").yh)("ITitleSync")},"../spread-sheet/src/external/view/main/panel/FillterPanel/utils/constant.ts":function(e,t,n){"use strict";n.d(t,{K5:function(){return l},MZ:function(){return o},Ty:function(){return _},Zm:function(){return m},hY:function(){return c},iF:function(){return h},oC:function(){return d},pr:function(){return g},rX:function(){return f},tv:function(){return a},uG:function(){return u},xJ:function(){return p}}),n("../node_modules/core-js/modules/es.number.constructor.js");var o,r=n("../node_modules/i18next/dist/esm/i18next.js"),s=n("../spread-sheet/src/core/data/configService/spreadConfig.ts"),i=n("../spread-sheet/src/core/view/level-2/collab-center-ent/utils.ts"),a=38,d=40,c=27,l=13;function u(){var e=!0;try{e=0===(s.q.getConfig("policyType")||0)}catch(t){e=!0}return e}function f(e,t){return{"0:0":r.ZP.t("当前筛选仅你可见，开启后所有人能看到你的筛选。"),"1:0":r.ZP.t("关闭后，筛选仅你可见，不影响他人查看。"),"0:1":r.ZP.t("打开后，分享文档给其他"+i.PJ+"，筛选结果所有人可见。"),"1:1":r.ZP.t("关闭后，分享文档给其他"+i.PJ+"，筛选结果仅你可见。")}[Number(e)+":"+Number("boolean"===typeof t?t:u())]}function m(e){var t;return((t={})[o.EXTEND_CONTENT]=r.ZP.t("对所有内容排序"),t[o.FILTER_CONTENT]=r.ZP.t("仅对筛选内容排序"),t)[e]}!function(e){e.EXTEND_CONTENT="extend-content",e.FILTER_CONTENT="filter-content"}(o||(o={}));var _="",p=/^\s+$/,h=320,g=820},"../spread-sheet/src/external/view/main/panel/FillterPanel/utils/filterUtil.ts":function(e,t,n){"use strict";n.d(t,{Ak:function(){return _},CU:function(){return l},K0:function(){return a},O2:function(){return i},Tw:function(){return u},WC:function(){return d},cZ:function(){return m},gm:function(){return c}}),n("../node_modules/core-js/modules/es.regexp.exec.js"),n("../node_modules/core-js/modules/es.string.replace.js"),n("../node_modules/core-js/modules/es.array.iterator.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.set.js"),n("../node_modules/core-js/modules/es.string.iterator.js"),n("../node_modules/core-js/modules/esnext.set.add-all.js"),n("../node_modules/core-js/modules/esnext.set.delete-all.js"),n("../node_modules/core-js/modules/esnext.set.difference.js"),n("../node_modules/core-js/modules/esnext.set.every.js"),n("../node_modules/core-js/modules/esnext.set.filter.js"),n("../node_modules/core-js/modules/esnext.set.find.js"),n("../node_modules/core-js/modules/esnext.set.intersection.js"),n("../node_modules/core-js/modules/esnext.set.is-disjoint-from.js"),n("../node_modules/core-js/modules/esnext.set.is-subset-of.js"),n("../node_modules/core-js/modules/esnext.set.is-superset-of.js"),n("../node_modules/core-js/modules/esnext.set.join.js"),n("../node_modules/core-js/modules/esnext.set.map.js"),n("../node_modules/core-js/modules/esnext.set.reduce.js"),n("../node_modules/core-js/modules/esnext.set.some.js"),n("../node_modules/core-js/modules/esnext.set.symmetric-difference.js"),n("../node_modules/core-js/modules/esnext.set.union.js"),n("../node_modules/core-js/modules/web.dom-collections.iterator.js"),n("../node_modules/core-js/modules/web.dom-collections.for-each.js"),n("../node_modules/core-js/modules/es.array.from.js");var o=n("../spread-sheet/src/core/utils/index.ts"),r=n("../spread-sheet/src/external/view/main/panel/FillterPanel/utils/constant.ts"),s=n("../packages/model/src/filter/index.ts");function i(e){return r.xJ.test(e)||""===e}function a(e,t){var n=[],o=[];for(e.replace(/(\d+)|(\D+)/g,(function(e,t,o){n.push([t||1/0,o||""])})),t.replace(/(\d+)|(\D+)/g,(function(e,t,n){o.push([t||1/0,n||""])}));n.length&&o.length;){var r=n.shift(),s=o.shift(),i=r[0]-s[0]||r[1].localeCompare(s[1]);if(i)return i}return n.length-o.length}function d(e){return(null===e||void 0===e||i(e))&&(e=r.Ty),e.replace&&(e=e.replace(/\ufeff/g,"")),e}function c(e,t,n){var r=e.getPrimaryCellDataAtPosition(t,n);return r&&o.Z.cell.getMergedValue(r)||""}function l(e,t){return(e.data.rowMetadata[t]||{hiddenByUser:!1}).hiddenByUser}function u(e){var t=new Set;return e.forEach((function(e){t.add(e)})),Array.from(t)}function f(e){var t={};return e.forEach((function(e){t[e.key]=e.visible})),t}function m(e,t){var n=f(e),o=f(t),r=t.every((function(e){return e.visible===n[e.key]})),s=e.every((function(e){return e.visible===o[e.key]}));return!(r&&s)}function _(e,t){var n,o=!1,r=!1;if(null===(n=e.sortSpecs)||void 0===n?void 0:n.length){var i=e.sortSpecs[0];t===i.dimensionIndex&&(i.sortOrder===s.SORT_ORDER.ASCENDING?o=!0:r=!0)}return{hasSetAscending:o,hasSetDescending:r}}},"../spread-sheet/src/external/view/workbench/workbench.interface.ts":function(e,t,n){"use strict";n.d(t,{E:function(){return o}});var o=(0,n("../node_modules/@tencent/containerized/build/main/index.js").yh)("IWorkBenchMain")},"../spread-sheet/src/external/waterMark/utils.ts":function(e,t,n){"use strict";n.d(t,{CC:function(){return l},eG:function(){return u},gN:function(){return c},iY:function(){return d},xk:function(){return a}}),n("../node_modules/regenerator-runtime/runtime.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.promise.js"),n("../node_modules/core-js/modules/es.array.iterator.js"),n("../node_modules/core-js/modules/es.string.iterator.js"),n("../node_modules/core-js/modules/web.dom-collections.iterator.js");var o,r=n("../packages/report/src/index.ts"),s=(n("../spread-sheet/src/core/data/configService/spreadConfig.ts"),n("../spread-sheet/src/external/waterMark/watermark-generate.ts")),i=function(e,t,n,o){return new(n||(n=Promise))((function(r,s){function i(e){try{d(o.next(e))}catch(t){s(t)}}function a(e){try{d(o.throw(e))}catch(t){s(t)}}function d(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,a)}d((o=o.apply(e,t||[])).next())}))};function a(e){r.ZP.tdwReport({module:"excel_watermark",opername:"doc_excel_editor",action:(null===e||void 0===e?void 0:e.action)||"",ver10:(null===e||void 0===e?void 0:e.ver10)||"",ver11:(null===e||void 0===e?void 0:e.ver11)||""})}function d(){return i(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!o){e.next=2;break}return e.abrupt("return",o);case 2:return e.next=4,n.e("bundle_watermark-generate").then(n.t.bind(n,"../node_modules/@tencent/docs-scenario-components-watermark-generate/dist/index.js",23));case 4:return o=e.sent,e.abrupt("return",o);case 6:case"end":return e.stop()}}),e)})))}function c(e){var t;if(e)try{return JSON.parse(e)}catch(o){null===(t=n.g.log)||void 0===t||t.error("watermark 解析失败",o)}}function l(e){return e.show===s.jS.SHOW}function u(e){return e.s.private===s.jS.SHOW}},jquery:function(e){"use strict";e.exports=jQuery},react:function(e){"use strict";e.exports=window.React},"react-dom":function(e){"use strict";e.exports=window.ReactDOM}},t={};function n(o){var r=t[o];if(void 0!==r)return r.exports;var s=t[o]={id:o,loaded:!1,exports:{}};return e[o].call(s.exports,s,s.exports,n),s.loaded=!0,s.exports}n.m=e,function(){var e=[];n.O=function(t,o,r,s){if(!o){var i=1/0;for(l=0;l<e.length;l++){o=e[l][0],r=e[l][1],s=e[l][2];for(var a=!0,d=0;d<o.length;d++)(!1&s||i>=s)&&Object.keys(n.O).every((function(e){return n.O[e](o[d])}))?o.splice(d--,1):(a=!1,s<i&&(i=s));if(a){e.splice(l--,1);var c=r();void 0!==c&&(t=c)}}return t}s=s||0;for(var l=e.length;l>0&&e[l-1][2]>s;l--)e[l]=e[l-1];e[l]=[o,r,s]}}(),n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,{a:t}),t},function(){var e,t=Object.getPrototypeOf?function(e){return Object.getPrototypeOf(e)}:function(e){return e.__proto__};n.t=function(o,r){if(1&r&&(o=this(o)),8&r)return o;if("object"===typeof o&&o){if(4&r&&o.__esModule)return o;if(16&r&&"function"===typeof o.then)return o}var s=Object.create(null);n.r(s);var i={};e=e||[null,t({}),t([]),t(t)];for(var a=2&r&&o;"object"==typeof a&&!~e.indexOf(a);a=t(a))Object.getOwnPropertyNames(a).forEach((function(e){i[e]=function(){return o[e]}}));return i.default=function(){return o},n.d(s,i),s}}(),n.d=function(e,t){for(var o in t)n.o(t,o)&&!n.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})},n.f={},n.e=function(e){return Promise.all(Object.keys(n.f).reduce((function(t,o){return n.f[o](e,t),t}),[]))},n.u=function(e){return"js/"+e+"."+{"spread-sheet_src_sdk_browser_tsheet_browser_sdk_ts":"c47179342f4f0f244996",bundle_pcReadonlyPluginService:"5b1acf5c081feb139b01",bundle_pcEditPluginService:"354eabc6c41f664d0949","vendors-node_modules_tencent_toggle-client-js_dist_toggle_es_js-node_modules_tencent_docs-des-f28a76":"703c7cbcdcadbdb3027a","spread-sheet_src_external_rangeAuth_loader_RangeAuthManager_ts-spread-sheet_src_external_view-9a5060":"54ca15ad1a9607ac5db3",bundle_plugin_pcFooter:"423c72261c69e09ae3e6",bundle_view_workbench:"10d18f3b4855ed3f0b8b",bundle_plugin_history:"e582e2ca4a10047c8f89",bundle_edit_feature:"c16fe919f257601b7be0","vendors-node_modules_tencent_docs-universal-config-sdk_build_index_js":"c4447cce75526a67eaef",bundle_plugin_init:"8937d1083e7e44001662","vendors-node_modules_tencent_toggle-client-js_dist_toggle_es_js-node_modules_tencent_wedocs-i-565a10":"1b2c785d6223fc5fa91c","spread-sheet_src_base_util_decorator_loading-decorator_ts-spread-sheet_src_core_feature_copyP-33f189":"2536b335f30cc773d617","spread-sheet_src_core_feature_bootstrap_ts":"36e0949b80c832384d68",bundle_feature:"b415cf02f626d25697fe",bundle_view_level2_edit_lazy_module0:"25058fd693de93a4d1a3","vendors-node_modules_tencent_docs-design-resources_mobile_png_2x_cdn_js-node_modules_tencent_-e09a13":"55470df4459136924387",bundle_shareconstrol:"8fafe27877a9e5ba65cd","vendors-node_modules_atob_browser-atob_js-node_modules_pako_index_js":"b5ef510b29b6eb7d5ad6",bundle_spreadsheet_tool_lazy:"f03c1b66ca562f052ea9","vendors-node_modules_tencent_docs-service-worker_lib_index_esm_js":"747f8faccf5671c54a4b","spread-sheet_src_core_workbench_common_base-drawer_tsx-spread-sheet_src_external_rangeAuth_ut-2939e0":"024d7708a39c54713bd7","spread-sheet_src_external_view_ui-layer_range-auth_components_range-auth-drawer_tsx":"ac2f21489b8d50698563","spread-sheet_src_core_view_level-2_mention_api_MentionApi_ts-spread-sheet_src_external_rangeA-10e443":"761010707311a14082cc",bundle_plugin_common_init:"76e927c3e836ef159cb9","vendors-node_modules_tencent_facade-config_dist_index_js":"cfd3c1109606133bf18c","vendors-node_modules_react-transition-group_index_js":"86294cbbb9acdd5d5433","vendors-node_modules_tencent_alloyreport-sdk_dist_alloyreport_inline_js-node_modules_tencent_-391aaf":"3c135e7552096e13a370","spread-sheet_src_core_view_level-2_condition-format-center_ui_utils_dataUtils_ts":"3ef59b1b555ca9d2b4ec","spread-sheet_src_external_check-slr_sc-lazy-loader_ts-spread-sheet_src_external_templateinfo_-54b3ca":"431228666a4a0d57624c","spread-sheet_src_core_utils_gray_ts-spread-sheet_src_core_view_level-2_condition-format-cente-74d507":"9169104b81f2c615a82c",bundle_view_header:"b6f0833c23a07f20cb44","spread-sheet_src_external_view_mobile_toolbar_quick-panel_quick-panel-component_index_less-sp-8a755a":"2b5ac66b21fbb0ea62ac",bundle_view_toolbar:"f65a7b265444b91377a3",bundle_plugin_m_init:"f56329f2aaa678819d09",bundle_plugin_resetlocation:"36f3d9bdd286e8f6c69b","spread-sheet_src_core_app_dataCallCore_ts-spread-sheet_src_external_view_workbench_service_cr-4ddb4c":"74993da1aa22f8f90c33",bundle_module_behavior_api:"a6ee58aba83a31481903",bundle_plugin_mention_enterprise:"5ba657b09998c7f096fc",bundle_plugin_mention:"0407d6c056cf883911c1",bundle_plugin_mention_enterprise_mobile:"5921daf2b76f3fc38fd6","spread-sheet_src_core_feature_dataValidation_api_DataValidationError_ts-spread-sheet_src_core-860e25":"ce0882ff0bdc005a8070",bundle_plugin_sheet_export_manager:"938549aeaaaca14fc963",bundle_plugin_auto_url:"074b202742e36c51cb39",bundle_plugin_inputautofill:"d632177c2da5a3afdaa0","bundle_word-helper":"6c42a5865b110d0c9752","bundle_excel-helper":"fa945491a7392ffdf400","bundle_slide-helper":"b59e3c7a90e6d306033a","vendors-node_modules_tencent_smartsheet-sdk_es_workbench_field_common_components_carousel_pla-87542f":"ce0664aabafb4e4818a8",bundle_clipboard_lib:"3cf03422bf6a4c4066c1","vendors-node_modules_tencent_smartsheet-sdk_es_workbench_search_search_service_jsx":"2344875baeea530f6c81","vendors-node_modules_tencent_smartsheet-sdk_es_workbench_table-description_common_alloy-edito-f82f37":"445d37b0021078193c22","bundle_watermark-generate":"9034f65439c545e35cc8","vendors-node_modules_tencent_smartsheet-sdk_es_workbench_record-detail_pc_index_jsx":"34b1f7d414d7e4c9073e","vendors-node_modules_tencent_smartsheet-sdk_es_workbench_common_service_notice-modal_interfac-b07f22":"a969966a655a68b05ff0","vendors-node_modules_tencent_smartsheet-sdk_es_workbench_canvas-tooltip_canvas-tooltip_featur-a0e345":"17af0edf9292c13b07b4","vendors-node_modules_tencent_smartsheet-sdk_es_workbench_table-description_pc_feature_pc_jsx--6273b7":"d67c802b00eab3d030bb","vendors-node_modules_tencent_smartsheet-sdk_es_feature-loader_level2-readonly_pc_jsx":"80b6949235a5704b9767","smartsheet-readonly-pc":"6a5304cd0026cff9f09d","vendors-node_modules_tencent_smartsheet-sdk_es_workbench_filter_filter_service_jsx":"643fbe8db4645d21d622","vendors-node_modules_tencent_smartsheet-sdk_es_feature-loader_level3-edit_pc_js":"06a0ed518605ecde4ccd","smartsheet-edit-pc":"9600806f9c1c3286c3b3","node_modules_tencent_smartsheet-sdk_es_workbench_search_components_mobile_button-group_module-9bfbe5":"684584457b757fba2a1d","node_modules_tencent_smartsheet-sdk_es_workbench_field-edit_field-edit_feature_jsx":"28c9ebd4634ed4af5114","node_modules_tencent_smartsheet-sdk_es_workbench_field-operation_field-operation_service_jsx":"93a74595d356badc0bf8","node_modules_tencent_smartsheet-sdk_es_workbench_gantt-record-operation_gantt-record-operatio-825294":"21e44712e6fd4ce65e84","node_modules_tencent_smartsheet-sdk_es_workbench_gantt-setting_gantt-setting_service_js":"5ec93def9b46178304d0","node_modules_tencent_smartsheet-sdk_es_workbench_field_common_components_carousel_pc_index_cs-f96436":"cc40a62a5d458d73f923","node_modules_tencent_smartsheet-sdk_es_workbench_group_group_service_jsx":"d0ef5cacf125b11cc085","node_modules_tencent_smartsheet-sdk_es_workbench_kanban-group-by_kanban-group-by_feature_jsx":"a5c6ddd91f23deda8f0b","node_modules_tencent_smartsheet-sdk_es_workbench_record-operation_record-operation_service_jsx":"95a92d94f379fd69929a","node_modules_tencent_smartsheet-sdk_es_workbench_row-height_row-height_service_jsx":"f522f57e73157a26b347","node_modules_tencent_smartsheet-sdk_es_workbench_sort_sort_service_jsx":"647ab107011200921590","node_modules_tencent_smartsheet-sdk_es_workbench_stat_stat-tools_service_jsx":"7d3779ab7911da170593","node_modules_tencent_smartsheet-sdk_es_workbench_common_service_notice-modal_interface_js-nod-69d73f":"50c814d6c05d12b94c47","node_modules_tencent_smartsheet-sdk_es_workbench_undo-redo_undo-redo_feature_js":"93d4f363f435287346b6","vendors-node_modules_tencent_smartsheet-sdk_es_workbench_record-detail_mobile_index_jsx":"b079c1e813f28b7dea27","smartsheet-readonly-mobile":"ab5160729f04c9b2242c","smartsheet-edit-mobile":"21b29220519ef324859b","node_modules_tencent_smartsheet-sdk_es_workbench_field_common_components_carousel_mobile_inde-d16be9":"37ad78871a6a55bc585c",bundle_copy_paste_api:"971166ff4e488cb4d1a0",bundle_workbench:"64e9adae3bb4985a6220","bundle_tencent-meeting-js-sdk":"8efe460963686a4dc573","vendors-node_modules_tencent_docs-design-resources_pc_png_2x_cdn-function-export_js":"c32c3a06604f91010c52","vendors-node_modules_tencent_docs-wechat-h5-to-mini-program_dist_index_js-node_modules_chroma-8c28eb":"15884d06e47b3f545da2","spread-sheet_src_external_view_ui-layer_filter_filter-controller_tsx-spread-sheet_src_externa-d82123":"73af9be9f534cfb13d0f","spread-sheet_src_core_workbench_common_commonService_ts-spread-sheet_src_core_workbench_middl-293cf0":"4a260fcf7c7ad09957d8","spread-sheet_src_core_workbench_initialization_workbenchServiceMobile_ts-spread-sheet_src_ext-40b61a":"dca90938e391442e1d7e","spread-sheet_src_external_view_ui-layer_comment-ent_comment-ent-controller_tsx-spread-sheet_s-7248e3":"652abbb248f669a02183",bundle_workbench_mobile:"32021e7a046179222615",bundle_workbench_pad:"4d23824f8e1629735881","vendors-node_modules_tencent_docs-design-resources_pc_png_2x_cdn_js-node_modules_tencent_docs-70ebca":"608938616620cca568e3","vendors-node_modules_tencent_docs-scenario-components-pc-header-badge_dist_index_js-node_modu-b423ba":"363db0b9eaff65b0355e","spread-sheet_src_external_view_main_toolbar_IconBox_tsx":"c2b85c2b6526b804e7e8","spread-sheet_src_core_network_message-center_adapter_MessageCenterAdapter_interface_ts-spread-e88071":"97214219c7cc00ab315e",bundle_workbench_pc:"a294197d9bb143eb15f0","spread-sheet_src_core_view_level-2_chart_charts_chart-data-api_ts-spread-sheet_src_core_view_-9220ef":"e8a5fd0a6c348a500882","spread-sheet_src_base_util_phone-number_ts-spread-sheet_src_core_feature_copyPaste_index_ts-s-89b53a":"f57d4b0af0644384e9da","spread-sheet_src_core_view_level-2_drag-control_BaseDragControl_ts-spread-sheet_src_core_view-0ffe8b":"8c6568b6f4465a740668",bundle_view_lazy_module0:"00f95c1b7373dc97dcbc","vendors-node_modules_react-redux_es_index_js":"9013bc66eea47f6dc236","vendors-node_modules_tencent_docs-addon-sdk_lib_index_esm_js":"37f870ec28743e36a4d9","spread-sheet_src_core_view_level-2_link-center_BaseLinkCenter_ts":"b651cc7c62936bf78716",bundle_view_level2_readyonly_lazy_module0:"b0081985e2464ad739cc",bundle_view_level2_edit_lazy_module1:"233bcd2c0c32f3701143",bundle_view_level2_readyonly_lazy_module1:"78c2109053999a48bbae",bundle_view_lazy_module1:"c906ac171b67057b65db","vendors-node_modules_react-window_dist_index_esm_js":"05e893491c52aa10c161",bundle_table_print_center:"01860f93b8e32575d661",bundle_pc_view_lazy_module_preview:"a7e63046408b4640ff47","vendors-node_modules_tencent_ark-offline-edit_lib_index_js":"1abb0df6970e526c199c",bundle_messageService:"7654ee7ea7bdbe697f72",bundle_workerService:"f528a230a3ed5cc9d048",bundle_editableService:"0ac6d674902fabf452a1",bundle_ui_dialog:"f8d2140eaf163eb78d09",bundle_ui_padmodal:"19ca7b43f3d6dad85751",bundle_ui_tooltip:"66e4b0144bb374516a8f",bundle_relate_form_question_dialog_enterprise:"8f9d92688b052dc7150f","bundle_docs-miniapp-sdk":"f2abd2e4b1a3dd8326bb",bundle_panel_CustomFormatPanel_pc:"a2437f5553c8f3432330","vendors-node_modules_react-beautiful-dnd_dist_react-beautiful-dnd_esm_js-node_modules_tencent-b53cee":"cc69d1d500484d20c328",bundle_panel_dataValidationPanel_pc:"c3b6d46eb3a285d4513f",bundle_panel_SortRangePanel_pc:"5f09bbf38018a9698dee",bundle_panel_init_pc:"d1f6f4e236b40f8f2fb6",bundle_panel_FilterPanel_pc:"6a532ddc36106bab04ea",bundle_panel_FormulaEditorPanel_pc:"43435a94261ecba1ff69",bundle_panel_ChartPanel_pc:"41acb983950bdde0a608",bundle_panel_RangeAuthPanel_pc:"b2673a0428f8aaf5adce",bundle_panel_ErrorTipPanel_pc:"244c13f37dd8f62ca268",bundle_panel_ListPopoverCenter_pc:"12a1f46812c281b4ad8d","spread-sheet_src_external_sheet-adapter_feature_ui-center_ts":"847fa281a5757aecc44c",bundle_pc_editableController:"cc6143d0d7d6aafe37ff",bundle_pc_previewController:"717806e67c51dfc4d105",bundle_feature_quick_fill:"42d7de949ae80867bf39","sc-mobile-input-dialog":"f06a8a1cc4050c581d5d","sc-mobile-file-selector":"f898810311a607b60be8","sc-pc-file-selector":"1787005be98bc9c8fd72","sc-palette-old":"3ea871c4674559aeb6a8","sc-palette-new":"3a30bda495314e8fce22","sc-mobile-menu":"3d5a844e65fbdb94d56f","sc-save-template":"d78e5a3d965e4e81761e","sc-mobile-menu-move-file":"24042e7f11d8f4fdf57e","sc-mobile-tip-button":"50346f7a4b331b280515","sc-pc-menu-file-info":"9bbebdb671f69cbf46c0",bundle_feature_copy_paste_base:"051f3fef0975f43c5578",bundle_exif:"5cdd9428e4295d4d110b",bundle_coresheet_lazy:"46238d757bf198d1fecc",bundle_appwebcomponents:"85b39545b7bebe45892e","smartsheet-report":"ace351b58ee36f45fdcf","vendors-node_modules_tencent_wedrive-component_dist_xdSaveDoc_css":"86eba25fb6d8e376f575",bundle_workbench_feature:"687098d8cbbc21103887","node_modules_tencent_docs-tmall-recommendation_dist_index_js":"3b7ae6d59289c299cf3f",bundle_echarts_lib:"d2dd621288ccc82905e3",bundle_offline_map:"ed73d7634cc1ff3e03e5",bundle_worker_services:"18d8c882ee81a8c725c7"}[e]+".js"},n.miniCssF=function(e){return"css/"+e+"."+{bundle_plugin_pcFooter:"03a52afa8d8f5bee9ec2",bundle_plugin_history:"575f7afb8a14c983a109",bundle_feature:"4256eec6fa057f11cadb",bundle_view_level2_edit_lazy_module0:"5c22d9949e4b4200cf38",bundle_plugin_common_init:"b0c0de62d679e2ae96bf",bundle_view_header:"1c80c972e77d60481aef","spread-sheet_src_external_view_mobile_toolbar_quick-panel_quick-panel-component_index_less-sp-8a755a":"b6a9f73eb6fd8f4089b4",bundle_view_toolbar:"c93ca8571a8d4c266332",bundle_plugin_m_init:"5a712984392142fe5b0c",bundle_plugin_mention_enterprise:"40c3ee960cabb16c98a8",bundle_plugin_mention_enterprise_mobile:"67947d63e595b20286d7",bundle_plugin_inputautofill:"7319e593165bba406e98","smartsheet-readonly-pc":"a63cd242d3dc0ddf86d9","smartsheet-edit-pc":"fcee75ae17ea31ce521a","node_modules_tencent_smartsheet-sdk_es_workbench_search_components_mobile_button-group_module-9bfbe5":"92a67f30c7f65b9eeb83","node_modules_tencent_smartsheet-sdk_es_workbench_field_common_components_carousel_pc_index_cs-f96436":"3eef2dd71d2db0c8d824","node_modules_tencent_smartsheet-sdk_es_workbench_kanban-group-by_kanban-group-by_feature_jsx":"7f75e852e94f27416888","node_modules_tencent_smartsheet-sdk_es_workbench_stat_stat-tools_service_jsx":"aab83b68744f623cc3d1","node_modules_tencent_smartsheet-sdk_es_workbench_common_service_notice-modal_interface_js-nod-69d73f":"adfb55b8b9d2e8491667","smartsheet-readonly-mobile":"78b5e8a6046509d343f5","node_modules_tencent_smartsheet-sdk_es_workbench_field_common_components_carousel_mobile_inde-d16be9":"980873e68606569a587e",bundle_workbench:"1273aa1bc7b161ae9b97","spread-sheet_src_core_workbench_common_commonService_ts-spread-sheet_src_core_workbench_middl-293cf0":"c783a952ac7d07fe0e0e","spread-sheet_src_core_workbench_initialization_workbenchServiceMobile_ts-spread-sheet_src_ext-40b61a":"a1dffca5f85b928c7216",bundle_workbench_mobile:"280ded16f3a45b3a41fe",bundle_workbench_pad:"7fb87cd9d04a8ce1ff1b","spread-sheet_src_core_network_message-center_adapter_MessageCenterAdapter_interface_ts-spread-e88071":"123ff9f1843643893540",bundle_workbench_pc:"8d10e0da406a1aabc038",bundle_view_lazy_module0:"939c678000c9939b4cff",bundle_view_level2_readyonly_lazy_module0:"bbc5059b076e514e97ef",bundle_view_level2_edit_lazy_module1:"eb71d624634cf9d7a0c9",bundle_view_level2_readyonly_lazy_module1:"d63d5cedc08dbe9c201c",bundle_view_lazy_module1:"eb2ddbb2533859c84d65",bundle_table_print_center:"eea8875d64add04d86d2",bundle_pc_view_lazy_module_preview:"5ee978d11aa4c0883311",bundle_ui_dialog:"8e42f3bd7b50bb5e24db",bundle_relate_form_question_dialog_enterprise:"638494c027793723997e",bundle_panel_dataValidationPanel_pc:"84f0a22593e601f041cb",bundle_panel_SortRangePanel_pc:"b3deec29c3ffaea24d23",bundle_panel_init_pc:"eca668af2d7f5484b043",bundle_panel_FilterPanel_pc:"96325f18684d81df47e3",bundle_panel_ChartPanel_pc:"e8280cc175556f3ad68d",bundle_panel_RangeAuthPanel_pc:"8119f715a87db50afc73",bundle_panel_ErrorTipPanel_pc:"dfc96e0288cc9f8c2036",bundle_panel_ListPopoverCenter_pc:"e069f0ba68152047e708",bundle_pc_editableController:"2e762bd6c78709fd1062",bundle_feature_quick_fill:"d895a92924cd70f1aa3a","vendors-node_modules_tencent_wedrive-component_dist_xdSaveDoc_css":"e64bc142ea59f8faaea8",bundle_workbench_feature:"24cf83e69d24ab073e1d"}[e]+".css"},n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}(),n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},function(){var e={},t="@tencent/alloy-builder:";n.l=function(o,r,s,i){if(e[o])e[o].push(r);else{var a;if(void 0!==s)for(var d=document.getElementsByTagName("script"),c=0;c<d.length;c++){var l=d[c];if(l.getAttribute("src")==o||l.getAttribute("data-webpack")==t+s){a=l;break}}if(!a){if(!window.DCR)throw new Error("Cannot find CdnRetryPlugin runtime");if(!window.DCR.loadScript)throw new Error("Cannot find the CdnRetryPlugin runtime function 'loadScript'");a=window.DCR.loadScript({retryCount:0,parent:document.head,removeElementAfterLoad:!0,timeout:12e4,nonce:n.nc,crossOrigin:"anonymous",type:void 0,dataWebpack:t+s,url:o},u)}e[o]=[r];var u=function(t){var n=e[o];delete e[o],n&&n.forEach((function(e){return e(t)}))}}}}(),n.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.nmd=function(e){return e.paths=[],e.children||(e.children=[]),e},n.j="page-editor",n.p="//docs.gtimg.com/sheet/",function(){var e=function(e){return new Promise((function(t,o){var r=n.miniCssF(e),s=n.p+r;if(function(e,t){for(var n=document.getElementsByTagName("link"),o=0;o<n.length;o++){var r=(i=n[o]).getAttribute("data-href")||i.getAttribute("href");if("stylesheet"===i.rel&&(r===e||r===t))return i}var s=document.getElementsByTagName("style");for(o=0;o<s.length;o++){var i;if((r=(i=s[o]).getAttribute("data-href"))===e||r===t)return i}}(r,s))return t();!function(e,t,n,o){var r=document.createElement("link");r.rel="stylesheet",r.type="text/css",r.onerror=r.onload=function(s){if(r.onerror=r.onload=null,"load"===s.type)n();else{var i=s&&("load"===s.type?"missing":s.type),a=s&&s.target&&s.target.href||t,d=new Error("Loading CSS chunk "+e+" failed.\n("+a+")");d.code="CSS_CHUNK_LOAD_FAILED",d.type=i,d.request=a,r.parentNode.removeChild(r),o(d)}},r.href=t,0!==r.href.indexOf(window.location.origin+"/")&&(r.crossOrigin="anonymous"),document.head.appendChild(r)}(e,s,t,o)}))},t={"page-editor":0};n.f.miniCss=function(n,o){t[n]?o.push(t[n]):0!==t[n]&&{bundle_plugin_pcFooter:1,bundle_plugin_history:1,bundle_feature:1,bundle_view_level2_edit_lazy_module0:1,bundle_plugin_common_init:1,bundle_view_header:1,"spread-sheet_src_external_view_mobile_toolbar_quick-panel_quick-panel-component_index_less-sp-8a755a":1,bundle_view_toolbar:1,bundle_plugin_m_init:1,bundle_plugin_mention_enterprise:1,bundle_plugin_mention_enterprise_mobile:1,bundle_plugin_inputautofill:1,"smartsheet-readonly-pc":1,"smartsheet-edit-pc":1,"node_modules_tencent_smartsheet-sdk_es_workbench_search_components_mobile_button-group_module-9bfbe5":1,"node_modules_tencent_smartsheet-sdk_es_workbench_field_common_components_carousel_pc_index_cs-f96436":1,"node_modules_tencent_smartsheet-sdk_es_workbench_kanban-group-by_kanban-group-by_feature_jsx":1,"node_modules_tencent_smartsheet-sdk_es_workbench_stat_stat-tools_service_jsx":1,"node_modules_tencent_smartsheet-sdk_es_workbench_common_service_notice-modal_interface_js-nod-69d73f":1,"smartsheet-readonly-mobile":1,"node_modules_tencent_smartsheet-sdk_es_workbench_field_common_components_carousel_mobile_inde-d16be9":1,bundle_workbench:1,"spread-sheet_src_core_workbench_common_commonService_ts-spread-sheet_src_core_workbench_middl-293cf0":1,"spread-sheet_src_core_workbench_initialization_workbenchServiceMobile_ts-spread-sheet_src_ext-40b61a":1,bundle_workbench_mobile:1,bundle_workbench_pad:1,"spread-sheet_src_core_network_message-center_adapter_MessageCenterAdapter_interface_ts-spread-e88071":1,bundle_workbench_pc:1,bundle_view_lazy_module0:1,bundle_view_level2_readyonly_lazy_module0:1,bundle_view_level2_edit_lazy_module1:1,bundle_view_level2_readyonly_lazy_module1:1,bundle_view_lazy_module1:1,bundle_table_print_center:1,bundle_pc_view_lazy_module_preview:1,bundle_ui_dialog:1,bundle_relate_form_question_dialog_enterprise:1,bundle_panel_dataValidationPanel_pc:1,bundle_panel_SortRangePanel_pc:1,bundle_panel_init_pc:1,bundle_panel_FilterPanel_pc:1,bundle_panel_ChartPanel_pc:1,bundle_panel_RangeAuthPanel_pc:1,bundle_panel_ErrorTipPanel_pc:1,bundle_panel_ListPopoverCenter_pc:1,bundle_pc_editableController:1,bundle_feature_quick_fill:1,"vendors-node_modules_tencent_wedrive-component_dist_xdSaveDoc_css":1,bundle_workbench_feature:1}[n]&&o.push(t[n]=e(n).then((function(){t[n]=0}),(function(e){throw delete t[n],e})))}}(),function(){var e={"page-editor":0};n.f.j=function(t,o){var r=n.o(e,t)?e[t]:void 0;if(0!==r)if(r)o.push(r[2]);else if(/^(node_modules_tencent_smartsheet\-sdk_es_workbench_(field_common_components_carousel_(mobile_inde\-d16be9|pc_index_cs\-f96436)|search_components_mobile_button\-group_module\-9bfbe5)|s(martsheet\-(edit|readonly)\-pc|c\-mobile\-menu|pread\-sheet_src_external_view_mobile_toolbar_quick\-panel_quick\-panel\-component_index_less\-sp\-8a755a)|vendors\-node_modules_tencent_wedrive\-component_dist_xdSaveDoc_css)$/.test(t))e[t]=0;else{var s=new Promise((function(n,o){r=e[t]=[n,o]}));o.push(r[2]=s);var i=n.p+n.u(t),a=new Error;n.l(i,(function(o){if(n.o(e,t)&&(0!==(r=e[t])&&(e[t]=void 0),r)){var s=o&&("load"===o.type?"missing":o.type),i=o&&o.target&&o.target.src;a.message="Loading chunk "+t+" failed.\n("+s+": "+i+")",a.name="ChunkLoadError",a.type=s,a.request=i,r[1](a)}}),"chunk-"+t,t)}},n.O.j=function(t){return 0===e[t]};var t=function(t,o){var r,s,i=o[0],a=o[1],d=o[2],c=0;if(i.some((function(t){return 0!==e[t]}))){for(r in a)n.o(a,r)&&(n.m[r]=a[r]);if(d)var l=d(n)}for(t&&t(o);c<i.length;c++)s=i[c],n.o(e,s)&&e[s]&&e[s][0](),e[s]=0;return n.O(l)},o=self.webpackChunk_tencent_alloy_builder=self.webpackChunk_tencent_alloy_builder||[];o.forEach(t.bind(null,0)),o.push=t.bind(null,o.push.bind(o))}();var o=n.O(void 0,["bundle_vendors_workbench","initial_vendors_tencent_1","initial_vendors_tencent_2","initial_vendors_tencent_dui","initial_vendors_tencent_ark","initial_vendors_tencent_formula","initial_vendors_tencent_4","initial_vendors_tencent_3","initial_vendors_public_1","initial_vendors_public_2","initial_vendors_public_3","initial_vendors_public_4","initial_chunk_part_1","initial_chunk_part_2","initial_chunk_part_3","initial_core_part_1","initial_core_part_2","initial_core_part_3","initial_core_part_4","core-sheet_js_report_raven-config_js-core-sheet_js_report_weblog-config_js-core-sheet_js_repo-b5e52e","spread-sheet_src_core_feature_formula_controller_ts-spread-sheet_src_core_worker_worker-threa-ff1554","spread-sheet_src_core_feature_relateForm_index_ts","spread-sheet_src_core_view_layout_pcView_ts"],(function(){return n("../spread-sheet/src/entry/browser/pc.ts")}));o=n.O(o)}(),window.jsExecEndTimeStamp=Date.now(),window.cachedPerformanceEntries||(window.cachedPerformanceEntries=[]),window.cachedPerformanceEntries.push({name:"jsExec: js/page-editor.84f453e850731c203167.js",entryType:"jsExec",startTime:window.jsExecStartTimeStamp,endTime:window.jsExecEndTimeStamp});
//# sourceMappingURL=page-editor.84f453e850731c203167.js.map