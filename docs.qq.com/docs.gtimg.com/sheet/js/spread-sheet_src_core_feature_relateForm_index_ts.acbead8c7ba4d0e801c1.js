self.window=self,window.jsExecStartTimeStamp=Date.now(),(self.webpackChunk_tencent_alloy_builder=self.webpackChunk_tencent_alloy_builder||[]).push([["spread-sheet_src_core_feature_relateForm_index_ts"],{"../spread-sheet/src/core/feature/relateForm/helper.ts":function(e,t,n){n.d(t,{A:function(){return s},M:function(){return r}}),n("../node_modules/core-js/modules/es.regexp.constructor.js"),n("../node_modules/core-js/modules/es.regexp.exec.js"),n("../node_modules/core-js/modules/es.regexp.to-string.js"),n("../node_modules/core-js/modules/es.string.match.js"),n("../node_modules/core-js/modules/web.dom-collections.for-each.js"),n("../node_modules/core-js/modules/es.number.constructor.js");var o=n("../spread-sheet/src/core/data/configService/spreadConfig.ts"),i=n("../spread-sheet/src/core/utils/gray.ts");function r(e,t){var n=new RegExp("(.*)\\((\\d*)\\)"),o="",i=0;if(n.test(t)){var r=t.match(n);r&&(o=r[1])}else o=t;return e.forEach((function(e){var t=e.match(n);if(t&&o===t[1]){var r=t[2];if(r){var s=Number(r);s>=i&&(i=s+1)}else i=i||1}})),i?o+"("+i+")":t}function s(){return!o.q.getConfig("creatorCorpId")&&(0,i.c)()}},"../spread-sheet/src/core/feature/relateForm/index.ts":function(e,t,n){n.r(t),n.d(t,{default:function(){return Pe}}),n("../node_modules/regenerator-runtime/runtime.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.promise.js"),n("../node_modules/core-js/modules/es.object.assign.js"),n("../node_modules/core-js/modules/es.array.from.js"),n("../node_modules/core-js/modules/es.string.iterator.js"),n("../node_modules/core-js/modules/es.array.iterator.js"),n("../node_modules/core-js/modules/web.dom-collections.iterator.js"),n("../node_modules/core-js/modules/es.map.js"),n("../node_modules/core-js/modules/esnext.map.delete-all.js"),n("../node_modules/core-js/modules/esnext.map.every.js"),n("../node_modules/core-js/modules/esnext.map.filter.js"),n("../node_modules/core-js/modules/esnext.map.find.js"),n("../node_modules/core-js/modules/esnext.map.find-key.js"),n("../node_modules/core-js/modules/esnext.map.includes.js"),n("../node_modules/core-js/modules/esnext.map.key-of.js"),n("../node_modules/core-js/modules/esnext.map.map-keys.js"),n("../node_modules/core-js/modules/esnext.map.map-values.js"),n("../node_modules/core-js/modules/esnext.map.merge.js"),n("../node_modules/core-js/modules/esnext.map.reduce.js"),n("../node_modules/core-js/modules/esnext.map.some.js"),n("../node_modules/core-js/modules/esnext.map.update.js"),n("../node_modules/core-js/modules/web.dom-collections.for-each.js"),n("../node_modules/core-js/modules/es.regexp.exec.js"),n("../node_modules/core-js/modules/es.string.split.js"),n("../node_modules/core-js/modules/es.array.includes.js"),n("../node_modules/core-js/modules/es.string.includes.js"),n("../node_modules/core-js/modules/es.array.map.js"),n("../node_modules/core-js/modules/es.array.slice.js"),n("../node_modules/core-js/modules/es.function.name.js"),n("../node_modules/core-js/modules/es.symbol.js"),n("../node_modules/core-js/modules/es.symbol.description.js"),n("../node_modules/core-js/modules/es.symbol.iterator.js");var o=n("../node_modules/i18next/dist/esm/i18next.js"),i=n("../packages/model/src/index.ts"),r=n("../spread-sheet/src/base/index.ts"),s=n("../spread-sheet/src/core/ui/index.ts"),a=n("../spread-sheet/src/core/utils/index.ts"),l=n("../spread-sheet/src/core/behavior/index.ts"),d=n("../node_modules/@tencent/tencent_doc_open_url/dist/index.js"),c=n("../node_modules/@babel/runtime/helpers/esm/toConsumableArray.js"),u=(n("../node_modules/core-js/modules/es.array.filter.js"),n("../node_modules/core-js/modules/es.array.find.js"),n("react")),h=n.n(u),m=n("../node_modules/@tencent/dui/lib/components/Modal/index.js"),p=n("../node_modules/@babel/runtime/helpers/esm/inheritsLoose.js"),f=function(e){function t(){return e.apply(this,arguments)||this}return(0,p.Z)(t,e),t.prototype.render=function(){return h().createElement("div",{className:"form-select-dialog-title"},h().createElement("div",{className:"text-wrapper"},o.ZP.t("选择收集表")))},t}(h().Component),v=n("../node_modules/@tencent/wedocs-icons/esm/components/filetype-tdoc-tform.js"),g=n("../spread-sheet/src/core/data/configService/spreadConfig.ts"),w=n("../node_modules/@tencent/wedocs-icons/esm/components/loading-spinner.js"),_=function(e){var t=e.isLoading,n=e.isComplete,o=e.onLoadMore,i=e.children,r=(0,u.useRef)();(0,u.useEffect)((function(){if(r&&null!==r.current){var e=function(){var e=r;!n&&e&&e.current&&e.current.scrollHeight-e.current.scrollTop<=e.current.clientHeight&&o()};return r.current.addEventListener("scroll",e),function(){r.current.removeEventListener("scroll",e)}}}),[r,n]);var s=t?h().createElement("div",{style:{position:"absolute",left:0,right:0,top:0,bottom:0,margin:"auto",fontSize:50,display:"flex",justifyContent:"center",alignItems:"center",background:"rgba(255,255,255,0.2)",pointerEvents:"none"}},h().createElement(w.Z,null)):void 0;return h().createElement("div",null,i({ref:r,spinner:s}))},I=function(e){function t(t){var n;return(n=e.call(this,t)||this).state={selectIndex:-1,list:t.list},n}(0,p.Z)(t,e);var n=t.prototype;return n.render=function(){var e=this,t=this.props,n=t.isLoading,i=t.isComplete,r=t.handleLoadMore,s=this.state,a=s.list,l=s.selectIndex;return h().createElement("div",null,h().createElement(_,{isLoading:n,isComplete:i,onLoadMore:r},(function(t){var n=t.ref,i=t.spinner;return h().createElement("div",{className:"form-select-dialog-content",ref:n},a.length>0?a.map((function(t,n){var i,r=g.q.getConfig("padId")===(null===(i=t.relativeDoc)||void 0===i?void 0:i.doc_id.pad_id),s=r?"unactive":n===l?"selected":"";return h().createElement("div",{className:"content-list-item "+s,onClick:function(){r||e.select(n)}},h().createElement("div",{className:"icon-wrapper"},h().createElement(v.Z,null)),h().createElement("div",{className:"text-wrapper"},h().createElement("p",null,t.title)),h().createElement("div",null,r?h().createElement("div",{className:"linked-tag"},o.ZP.t("已关联")):null))})):h().createElement("p",{className:"content-empty"},o.ZP.t("暂无收集表")),i)})))},n.select=function(e){var t=this.props,n=t.handleSelectChange,o=t.handleClickConfirm;e===this.state.selectIndex?o():(this.setState({selectIndex:e}),n(e))},t}(h().Component),C=function(e){function t(t){var n;return(n=e.call(this,t)||this).changeEnable=function(e){n.setState({enable:e})},n.state={enable:!1},n}return(0,p.Z)(t,e),t.prototype.render=function(){var e=this.props,t=e.handleClickConfirm,n=e.handleClickCancel;return h().createElement("div",{className:"form-select-dialog-footer"},h().createElement("button",{className:"desktop-cta-button size-m type-gray",onClick:function(){n()}},o.ZP.t("取消")),h().createElement("button",{className:"desktop-cta-button size-m type-primary",onClick:function(){t()}},o.ZP.t("确定")))},t}(h().Component),y=n("../spread-sheet/src/core/feature/relateForm/api.ts"),E=n("../node_modules/lodash/debounce.js"),b=n.n(E),R=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function s(e){try{l(o.next(e))}catch(t){r(t)}}function a(e){try{l(o.throw(e))}catch(t){r(t)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((o=o.apply(e,t||[])).next())}))},P=function(){function e(e){var t=this;this.handleLoadMore=b()((function(){return R(t,void 0,void 0,regeneratorRuntime.mark((function e(){var t,n,o,i,r,s=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this._isLoading=!0,this._dialogModal.update({content:this.renderFormDialogContent()}),e.next=4,(0,y.ZG)({index:this._currentPageIndex});case 4:n=e.sent,o=n.list,i=n.nextPageIndex,r=n.hasNextPage,this._isLoading=!1,this._isComplete=!r,this._currentPageIndex=i,(t=this._list).push.apply(t,(0,c.Z)(o.filter((function(e){return!s._list.find((function(t){return t.docId.pad_id===e.docId.pad_id}))})))),this._dialogModal.update({content:this.renderFormDialogContent()});case 13:case"end":return e.stop()}}),e,this)})))}),500),this.handleLinkOwnerForm=b()((function(e,n){t._linkOwnerForm({form:e,relink:n})}),500),this.show=function(e,n){t._show||(t._show=!0,t.resetListStatus(),t._list=e,t._currentPageIndex=n,t._dialogModal=m.default.confirm({title:t.renderFormDialogTitle(),className:"form-select-dialog",maskClassName:"blurmask",destroyOnClose:!0,style:{width:540,height:484,boxSizing:"border-box"},content:t.renderFormDialogContent(),footer:t.renderFormDialogFooter(),onCancel:function(){t._show=!1}}))},this._linkOwnerForm=e.linkOwnerForm,this._openFormSheet=e.openFormSheet,this._title=h().createRef(),this._content=h().createRef(),this._footer=h().createRef(),this.resetListStatus()}var t=e.prototype;return t.close=function(){var e;this._show=!1,null===(e=this._dialogModal)||void 0===e||e.close()},t.resetListStatus=function(){this._list=[],this._selected=-1,this._currentPageIndex=0,this._isLoading=!1,this._isComplete=!1},t.renderFormDialogTitle=function(){return h().createElement(f,{ref:this._title})},t.renderFormDialogContent=function(){return h().createElement(I,{ref:this._content,list:this._list,isLoading:this._isLoading,isComplete:this._isComplete,handleLoadMore:this.handleLoadMore.bind(this),handleSelectChange:this.handleSelectChange.bind(this),handleClickConfirm:this.handleClickConfirm.bind(this)})},t.renderFormDialogFooter=function(){return h().createElement(C,{ref:this._footer,handleClickConfirm:this.handleClickConfirm.bind(this),handleClickCancel:this.handleClickCancel.bind(this)})},t.handleSelectChange=function(e){var t;this._selected=e;var n=-1!==e;null===(t=this._footer.current)||void 0===t||t.changeEnable(n)},t.handleClickConfirm=function(){var e=this;if(-1!==this._selected){var t=this._list[this._selected],n=t.title,i=t.relativeDoc,r=t.docId;i?m.default.confirm({className:"form-select-dialog-alert",maskClassName:"blurmask",destroyOnClose:!0,style:{width:340,boxSizing:"border-box"},content:this.reConfirmContent(n,r),okText:o.ZP.t("解除并重新关联"),onOk:function(){e.handleLinkOwnerForm(e._list[e._selected],!0),e.close()},onCancel:function(){}}):(this.handleLinkOwnerForm(this._list[this._selected],!1),this.close())}},t.reConfirmContent=function(e,t){var n=this;return h().createElement("div",null,'"',e,'"',o.ZP.t("已关联至"),h().createElement("a",{onClick:function(){n._openFormSheet(t)},className:"form-select-dialog-alert-link",target:"_blank"},o.ZP.t("其他表格")),o.ZP.t("。 是否解除原来的关联关系，并重新关联到这个表格？"))},t.handleClickCancel=function(){this.close()},e}(),x=n("../node_modules/@tencent/dui/lib/components/Snackbar/index.js"),T=n("../spread-sheet/src/core/ui/toast/toast.tsx"),S=n("../node_modules/@tencent/docs-user-agent/dist/index.js"),Z=n.n(S),j=n("../packages/model/src/sheet/sheetUtils.ts"),D=n("../spread-sheet/src/core/feature/relateForm/helper.ts"),M=n("../packages/model/src/range/GridRange.ts"),k=n("../spread-sheet/src/base/dynamicImport/config.ts"),A=n("../spread-sheet/src/core/feature/relateForm/seeker-util.ts"),F=n("../packages/model/src/cell/metadata/CustomDataType.ts"),O=n("../spread-sheet/src/external/rangeAuth/constants/range-auth-event.ts"),N=n("../spread-sheet/src/core/app/sheetStatus/auth-range.ts"),L=function(e,t,n,o,i){for(var r,s=[],a=n[t],l=(null===a||void 0===a?void 0:a.values)||[],d=0;d<o;d++){var c=l[d],u=(null===c||void 0===c?void 0:c.getEditValue())||"",h=null===c||void 0===c?void 0:c.getFormula(),m=null===c||void 0===c?void 0:c.getMergeReference(),p=null===c||void 0===c?void 0:c.getDataValidation(),f=null===c||void 0===c?void 0:c.getMetadata();if(!u&&m){var v=m.startRowIndex,g=m.startColIndex,w=null===(r=n[v])||void 0===r?void 0:r.values[g];w&&(u=w.getEditValue()||"")}var _=V(e,t,d,m),I=!(0,N.Nb)(e,[m||new M.Z(e.spreadsheet.activeSheetId,t,t,d,d)]),C=q(e,t,d),y=(null===p||void 0===p?void 0:p.ruleType)||null,E=void 0,b=null;(null===f||void 0===f?void 0:f.customDataType)===F.ZP.IMAGE&&(b={url:e.spreadsheet.activeSheet.imageManager.getImage(c.getRefIds()[0]).url}),i&&(E=U(i,t,d)),s.push({col:d,row:t,value:u,isFormula:!!h,isMerge:!!m,dvRule:y,isRangeAuth:_,isRangeAuthRead:I,isInHighWater:C,cellImage:b,floatImage:E})}return s};function U(e,t,n){var o=e.getCellFloatImages(t,n);return o.length>0?o:void 0}function V(e,t,n,o){var i,r,s=e.spreadsheet.activeSheetId,a=null===(i=e.serviceCollection.services.get(k.Z.MOBILE_RANGE_AUTH))||void 0===i?void 0:i.instance,l=null===(r=null===a||void 0===a?void 0:a.rangeAuthUtil.getActiveSheetRangeIds())||void 0===r?void 0:r.rangeIds;if(!(null===l||void 0===l?void 0:l.length))return!0;var d=o||{startRowIndex:t,endRowIndex:t,startColIndex:n,endColIndex:n},c=d.startRowIndex,u=d.endRowIndex,h=d.startColIndex,m=d.endColIndex;return e.sheetStatus.getRangeCanEdit(new M.Z(s,c,u,h,m))}function q(e,t,n){var o=e.spreadsheet.activeSheetId;return e.sheetStatus.isRangeCanEditByHighWater(new M.Z(o,t,t,n,n))}var B,H,G,z,W=function(){function e(e){var t=this;this.onCooperationAddNewRangeDone=function(){t.onMutationChange()},this.onMutationChange=function(){t.panelUpdateFn&&t.panelUpdateFn()},this.app=e}var t=e.prototype;return t.getHeaderRange=function(){return(0,A.ns)(this.app.spreadsheet.activeSheet)},t.isFillAble=function(){return this.getHeader(),!(!this.isHit()||this.activeRow<0)},t.getHeader=function(e){this.activeCol=-1,this.activeRow=-1,this.hitLine=-1,this.merges=[],this.isQuickFill=!!e;try{return this.find()}catch(t){return console.error(t),this.getResult()}},t.addListener=function(e){this.panelUpdateFn=e,this.app.mutationBehavior.emitter.addListener(this.app.mutationBehavior.EVENT.AFTER_MUTATION_RUN,this.onMutationChange),this.app.event.rangeAuthEvent.listen(O.k.COOERATION_ADD_NEW_RANGE_DONE,this.onCooperationAddNewRangeDone)},t.removeListener=function(){this.panelUpdateFn=null,this.app.mutationBehavior.emitter.removeListener(this.app.mutationBehavior.EVENT.AFTER_MUTATION_RUN,this.onMutationChange),this.app.event.rangeAuthEvent.remove(O.k.COOERATION_ADD_NEW_RANGE_DONE,this.onCooperationAddNewRangeDone)},t.getQuickFillRange=function(){var e=this.getHeader(),t=e.activeCol,n=e.activeRow,o=this.app.spreadsheet.activeSheet.getRowCount();return{fillRowRange:[this.hitLine+1,o-1],activeCol:t,activeRow:n}},t.getQuickFillData=function(e,t){var n=this.getHeader(),o=n.headDatas,i=n.activeCol,r=n.activeRow,s=this.app.spreadsheet.activeSheet.data;return{headDatas:o,activeCol:i,activeRow:r,rowData:L(this.app,e,s.rowData,o.length,t)}},t.isHit=function(){return this.hitLine>=0},t.getResult=function(e){return void 0===e&&(e=[]),{headDatas:e,line:this.hitLine,merges:this.merges,activeCol:this.activeCol,activeRow:this.activeRow,activeRowDatas:this.activeRowDatas||[]}},t.find=function(){var e,t=this,n=this.app.spreadsheet.activeSheet.data;if(!n||!n.rowData||!n.rowMetadata)return this.getResult();var o=this.app.view.getSelection();this.activeRow=o.activeCell.rowIndex,this.activeCol=o.activeCell.colIndex;var i=n.rowData,r=n.rowMetadata,s=(0,A.o_)(i,r),a=(0,A.Fh)(i,s),l=(0,A.g8)(i,a,this.isQuickFill),d=l.headData,c=l.hitLine,u=l.merges;return this.hitLine=c,this.merges=u,this.activeRow<=this.hitLine&&(this.activeRow=this.hitLine+1),null===(e=this.merges)||void 0===e||e.forEach((function(e){t.activeRow=Math.max(t.activeRow,e[1]+1)})),(this.activeCol<0||this.activeCol>=d.length)&&(this.activeCol=0),this.isQuickFill&&-1!==this.activeRow?this.activeRowDatas=L(this.app,this.activeRow,i,d.length):this.activeRowDatas=[],this.isHit()?this.getResult((0,A.CV)(this.hitLine,d)):this.getResult()},e}(),Y=n("../packages/report/src/index.ts"),X=n("../spread-sheet/src/core/utils/relate/relate.ts"),Q=n("../spread-sheet/src/core/utils/relate/api.ts"),J=n("../spread-sheet/src/core/utils/relate/RelateType.ts"),K=n("../packages/mutation/src/MutationId.ts"),$=n("../spread-sheet/src/core/behavior/multi-type-follow.ts"),ee=n("../node_modules/@tencent/dui/lib/components/Checkbox/index.js"),te=n("../node_modules/@tencent/dui/lib/components/Select/index.js");!function(e){e.SIMPLE="SIMPLE",e.RADIO="RADIO",e.CHECKBOX="CHECKBOX",e.SELECT="SELECT",e.DATE="DATE",e.TIME="TIME",e.TEMPERATURE="TEMPERATURE",e.LOCATION="LOCATION",e.IMAGE="IMAGE",e.CANVAS="CANVAS"}(G||(G={})),function(e){e[e.SIMPLE=0]="SIMPLE",e[e.RADIO=1]="RADIO",e[e.CHECKBOX=2]="CHECKBOX",e[e.SELECT=3]="SELECT",e[e.DATE=4]="DATE",e[e.TIME=5]="TIME",e[e.TEMPERATURE=6]="TEMPERATURE",e[e.LOCATION=7]="LOCATION",e[e.IMAGE=8]="IMAGE",e[e.CANVAS=9]="CANVAS"}(z||(z={}));var ne=((B={})[z.SIMPLE]=["SIMPLE",o.ZP.t("问答题")],B[z.RADIO]=["RADIO",o.ZP.t("单选题")],B[z.CHECKBOX]=["CHECKBOX",o.ZP.t("多选题")],B[z.SELECT]=["SELECT",o.ZP.t("下拉选择题")],B[z.DATE]=["DATE",o.ZP.t("日期题")],B[z.TIME]=["TIME",o.ZP.t("时间题")],B[z.TEMPERATURE]=["TEMPERATURE",o.ZP.t("温度题")],B[z.LOCATION]=["LOCATION",o.ZP.t("地理位置题")],B[z.IMAGE]=["IMAGE",o.ZP.t("收集图片")],B[z.CANVAS]=["CANVAS",o.ZP.t("签名题")],B),oe=((H={})[z.SIMPLE]={section:0,subtitle:"",placeholder:o.ZP.t("输入问题，例如“你的姓名”"),isDirty:!1,type:"SIMPLE",qdata:{placeholder:o.ZP.t("请填写")},validate:[{type:12,rules:{max:100,open:!1},message:o.ZP.t("输入内容需不超过100个字符。")}],toggle:{required:!1,randomOption:!1,showValidate:!1,showSubtitle:!1},questionDescripe:{simpleFirstIndex:0,simpleSecondIndex:0,simpleUserInputContent:"",simpleUserInputContentSupply:"",simpleUserInputErrorMessage:""}},H[z.RADIO]={section:0,subtitle:"",placeholder:o.ZP.t("输入问题，例如“你的性别”"),isDirty:!1,type:"RADIO",qdata:{options:[{id:"111",title:o.ZP.t("选项 1")},{id:"222",title:o.ZP.t("选项 2")}]},validate:null,toggle:{required:!1,randomOption:!1,showValidate:!1,showSubtitle:!1}},H[z.CHECKBOX]={type:"CHECKBOX",subtitle:"",isDirty:!1,placeholder:o.ZP.t("请输入问题"),validate:[],dataType:1,toggle:{required:!0,showValidate:!1},qdata:{placeholder:o.ZP.t("添加选项"),options:[{id:"1",title:o.ZP.t("选项 1"),isExtend:!1},{id:"2",title:o.ZP.t("选项 2"),isExtend:!1}]},validateInput:{type:"MIN",number:1}},H[z.SELECT]={type:"SELECT",subtitle:"",isDirty:!1,placeholder:o.ZP.t("请输入问题"),validate:[],dataType:1,toggle:{required:!0,showValidate:!1},qdata:{placeholder:o.ZP.t("请选择"),options:[{id:"1",title:o.ZP.t("选项 1"),isExtend:!1},{id:"2",title:o.ZP.t("选项 2"),isExtend:!1}]}},H[z.DATE]={type:"DATE",subtitle:"",isDirty:!1,placeholder:o.ZP.t("请输入问题"),validate:[{type:13,rules:{},message:o.ZP.t("请输入有效的时间"),ruletype:70}],dataType:3,toggle:{required:!0,showValidate:!1},qdata:{subType:"datetime",format:o.ZP.t('yyyy"年"m"月"d"日" hh:mm')}},H[z.TIME]={type:"TIME",subtitle:"",isDirty:!1,placeholder:o.ZP.t("请输入问题"),validate:[{type:13,rules:{},message:o.ZP.t("请输入有效的时间"),ruletype:70}],dataType:3,toggle:{required:!0,showValidate:!1},qdata:{subType:"timetype",format:"hh:mm"}},H[z.TEMPERATURE]={type:"TEMPERATURE",subtitle:"",isDirty:!1,placeholder:o.ZP.t("请输入问题"),validate:[{type:13,rules:{},message:o.ZP.t("请输入小于 200 的正整数或携带一位小数的正值。"),ruletype:90}],dataType:1,toggle:{required:!0,showValidate:!1},qdata:{unit:"celsius"}},H[z.LOCATION]={type:"LOCATION",subtitle:"",isDirty:!1,placeholder:o.ZP.t("请输入问题"),validate:[],dataType:1,toggle:{required:!0,showValidate:!1},qdata:{}},H[z.IMAGE]={type:"IMAGE",subtitle:"",isDirty:!1,placeholder:o.ZP.t("请输入问题"),validate:[],dataType:1,toggle:{required:!0,showValidate:!1},qdata:{}},H[z.CANVAS]={type:"CANVAS",subtitle:"",isDirty:!0,placeholder:o.ZP.t("请输入问题"),validate:[],dataType:1,toggle:{required:!0,showValidate:!1},qdata:{}},H);function ie(e){var t=e.list,n=e.update;return h().createElement("div",{className:"question-list-container"},t.map((function(e,t){return h().createElement(se,{index:t,item:e,update:n})})))}Object.assign(Object.assign({},oe[z.SIMPLE]),{id:"1",title:o.ZP.t("未命名的问题")}),Object.assign(Object.assign({},oe[z.RADIO]),{id:"2",title:o.ZP.t("未命名的问题")});var re=[z.SIMPLE,z.RADIO,z.CHECKBOX,z.SELECT,z.DATE,z.TIME,z.TEMPERATURE,z.LOCATION,z.IMAGE,z.CANVAS],se=function(e){function t(t){var n;return(n=e.call(this,t)||this).state=Object.assign({},t.item),n}(0,p.Z)(t,e);var n=t.prototype;return n.handleSelectChange=function(e){this.setState({select:e});var t=this.props;(0,t.update)(t.index,{select:e})},n.handleTypeChange=function(e){var t=re[+e];this.setState({type:t});var n=this.props;(0,n.update)(n.index,{type:t})},n.render=function(){var e=this,t=this.state,n=t.select,o=t.title,i=t.type;return h().createElement(h().Fragment,null,h().createElement("div",{className:"question-list-item"},h().createElement(ee.default,{checked:n,onChange:function(t){return e.handleSelectChange(t)}},"                    ",h().createElement("div",{className:"question-title"},o)),h().createElement(te.default,{className:"question-list-select",arrowClassName:"question-list-select-arrow",listClassName:"question-list-select-list",value:""+re.indexOf(i),onChange:this.handleTypeChange.bind(this)},re.map((function(e,t){return h().createElement(te.default.Option,{className:"question-list-option",value:""+t},ne[e][1])})))),h().createElement("div",{className:"question-list-divider"}))},t}(h().Component),ae=function(e){function t(){return e.apply(this,arguments)||this}return(0,p.Z)(t,e),t.prototype.render=function(){var e=this.props,t=e.handleClickConfirm,n=e.handleClickCancel;return h().createElement("div",{className:"question-select-dialog-footer"},h().createElement("button",{className:"desktop-cta-button size-m type-gray",onClick:function(){n()}},o.ZP.t("取消")),h().createElement("button",{className:"desktop-cta-button size-m type-primary",onClick:function(){t()}},o.ZP.t("创建收集表")))},t}(h().Component),le=[[z.IMAGE,/(上传|图片|拍照|文件|照片)/i],[z.LOCATION,/(定位|位置|城市|地址)/i],[z.DATE,/(日期|时间)/i],[z.RADIO,/(是否|性别|选择)/i],[z.SIMPLE,/[\s\S]*/i]],de=function(){function e(e){var t=this;this.show=function(e){void 0===e&&(e=0),t._show||(t._show=!0,t.loadRowData(e),t._list.length>0?t._dialogModal=m.default.confirm({title:o.ZP.t("将以下内容设置为题目"),className:"question-select-dialog",maskClassName:"blurmask",destroyOnClose:!0,style:{width:480,height:408},content:h().createElement(ie,{list:t._list,update:t.update.bind(t)}),footer:h().createElement(ae,{handleClickCancel:t.handleClickCancel.bind(t),handleClickConfirm:t.handleClickConfirm.bind(t)}),onCancel:function(){t.close()}}):t._dialogModal=m.default.confirm({title:o.ZP.t("提示"),maskClassName:"blurmask",content:o.ZP.t("表头内容为空，是否新建空白收集表？"),okText:o.ZP.t("新建"),onOk:function(){var e=t._app.spreadsheet.activeSheet.getTitle();t._creatDraft([],e),t.close()},onCancel:function(){t.close()}}))},this._app=e.app,this._creatDraft=e.creatDraft,this._list=[],this._content=h().createRef(),this._footer=h().createRef()}var t=e.prototype;return t.close=function(){var e;this._show=!1,null===(e=this._dialogModal)||void 0===e||e.close()},t.isShow=function(){return this._show},t.update=function(e,t){var n=this._list[e],o=Object.assign(Object.assign({},n),t);this._list[e]=o},t.getCurrentSheetDataByRow=function(e){void 0===e&&(e=0);var t=this._app.spreadsheet.activeSheet,n=null===t||void 0===t?void 0:t.data;return(null===n||void 0===n?void 0:n.rowData)[e]},t.handleClickConfirm=function(){var e=[],t=1;this._list.forEach((function(n){n.select&&(e.push(Object.assign(Object.assign({},oe[n.type]),{id:""+t,title:n.title})),t+=1)}));var n=this._app.spreadsheet.activeSheet.getTitle();this._creatDraft(e,n),this.close()},t.handleClickCancel=function(){this.close()},t.loadRowData=function(e){var t=this;this._questionRow=e;var n=this.getCurrentSheetDataByRow(e),o=[];n&&n.values.forEach((function(e){if(null===e||void 0===e?void 0:e.getEditValue()){var n=e.getEditValue(),i=t.getTypeByTitle(n);o.push({select:!0,title:n,type:i})}})),this._list=o},t.getTypeByTitle=function(e){var t=null;return le.some((function(n){var o=n[0];if(n[1].test(e))return t=o,!0})),t||z.SIMPLE},e}(),ce=n("../node_modules/qrcode.react/lib/index.js"),ue=n.n(ce),he=function(){function e(e){var t=this;this.show=function(e,n){t._show||(t._show=!0,t._title=e,t._url=n,t._dialogModal=m.default.confirm({className:"qr-dialog",maskClassName:"blurmask",destroyOnClose:!0,style:{width:340,height:421},content:t.getQRContent(),footer:null,onCancel:function(){t._show=!1}}))},this.getQRContent=function(){return h().createElement("div",{className:"dialog-content"},h().createElement("div",{className:"qr-card"},h().createElement("div",{className:"qr-card-title"},h().createElement("div",{className:"qr-card-title-icon"},h().createElement(v.Z,null)),h().createElement("div",{className:"qr-card-title-text"},h().createElement("div",{className:"main-text"},t._title),h().createElement("div",{className:"sub-text"},o.ZP.t("扫一扫，填写收集表")))),h().createElement("div",{className:"qr-card-qr"},h().createElement(ue(),{value:t._url,includeMargin:!0,id:"qrCode",size:200,fgColor:"#000000"}))),h().createElement("a",{className:"desktop-cta-button size-m type-primary",ref:t._downAnchor,onClick:function(){t.saveQRcode()},style:{color:"#ffffff"}},o.ZP.t("保存二维码")))},this._app=e.app,this._downAnchor=h().createRef()}return e.prototype.saveQRcode=function(){var e,t=null===(e=this._downAnchor)||void 0===e?void 0:e.current;if(t){var n=document.getElementById("qrCode");if(n){var i=n.toDataURL("image/png");t.href=i,t.download=this._title||o.ZP.t("收集表")}}},e}(),me=n("../spread-sheet/src/core/feature/copyPaste/clipboardCopy.ui.ts"),pe=n("../spread-sheet/src/core/feature/copyPaste/interfaces.ts"),fe=n("../spread-sheet/src/core/feature/relateForm/constant.ts"),ve=n("../spread-sheet/src/external/export/ui/index.ts"),ge=n("../spread-sheet/src/external/export/download.ts");function we(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){if(e){if("string"===typeof e)return _e(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_e(e,t):void 0}}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var o=0;return function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _e(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=new Array(t);n<t;n++)o[n]=e[n];return o}var Ie=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function s(e){try{l(o.next(e))}catch(t){r(t)}}function a(e){try{l(o.throw(e))}catch(t){r(t)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((o=o.apply(e,t||[])).next())}))},Ce=n.g,ye=function(e,t){void 0===t&&(t={}),Y.ZP.tdwReport(Object.assign({opername:"doc_form",module:"excel",action:e},t))},Ee=function(e){var t,n=Ce.mqq;if(Z().isQQMiniProgram){var o=e;e.indexOf("//")>=0&&-1===e.indexOf("https")&&(o="https:"+e);var i="/pages/detail/detail?url="+encodeURIComponent(o);Ce.wx.miniProgram.navigateTo({url:"/pages/jump/jump?url="+encodeURIComponent(i)})}else if(Z().isWxMiniProgram)Ce.wx.miniProgram.navigateTo({url:"/pages/detail/detail?url="+encodeURIComponent(e)});else{if(!Z().isIPad||!Z().isTencentDocsApp)return(null===(t=null===n||void 0===n?void 0:n.ui)||void 0===t?void 0:t.openUrl)?(n.ui.openUrl({url:e,target:1,style:3}),!0):!!Ce.open(e);(0,d.tencentDocOpenUrlForAll)({url:e})}},be=[o.ZP.t("报名"),o.ZP.t("报备"),o.ZP.t("统计"),o.ZP.t("登记"),o.ZP.t("收集"),o.ZP.t("汇总"),o.ZP.t("计划"),o.ZP.t("明细"),o.ZP.t("月份"),o.ZP.t("信息表"),o.ZP.t("打卡"),o.ZP.t("周报"),o.ZP.t("排期"),o.ZP.t("绩效考核"),"okr",o.ZP.t("项目计划"),o.ZP.t("进度"),o.ZP.t("待办事项"),o.ZP.t("项目"),o.ZP.t("记录"),o.ZP.t("排班"),o.ZP.t("审核"),o.ZP.t("汇总"),o.ZP.t("每日反馈"),o.ZP.t("上报"),o.ZP.t("日报"),o.ZP.t("日程"),o.ZP.t("清单"),o.ZP.t("签到"),o.ZP.t("安排"),o.ZP.t("每日更新"),o.ZP.t("跟进"),o.ZP.t("资产盘点"),o.ZP.t("考勤"),o.ZP.t("更新"),o.ZP.t("签到"),o.ZP.t("管理"),o.ZP.t("课程"),o.ZP.t("共享"),o.ZP.t("明细"),o.ZP.t("报表"),o.ZP.t("通讯录"),o.ZP.t("看板"),o.ZP.t("进度"),o.ZP.t("值班"),o.ZP.t("排课"),o.ZP.t("进度"),o.ZP.t("展示"),o.ZP.t("纪要"),o.ZP.t("采集"),o.ZP.t("摸底"),o.ZP.t("接龙"),o.ZP.t("征集"),o.ZP.t("名单"),o.ZP.t("花名册"),o.ZP.t("订购"),o.ZP.t("信息"),o.ZP.t("调研"),o.ZP.t("反馈"),o.ZP.t("清单"),o.ZP.t("联系方式"),o.ZP.t("安排"),o.ZP.t("申请"),o.ZP.t("打卡"),o.ZP.t("排班")],Re=function(){function e(e){var t=this;this.onMutationChange=function(e,n){e.mutation.id===K.ZP.INSERT_SHEET_MUTATION&&n===e.sheetId&&r.Z.event.sheetsBar.trigger("switchSheet",n,t.getCurrentSheetId())},e&&(this.app=e,this.seeker=new W(e),this.afterHandleCallbacks=[],this.initRelation(),this.initFormSelectDialog(),this.initQuestionListDialog(),this.initQRCodeDialog())}var t=e.prototype;return t.init=function(e){this.app=e,this.initRelation(),this.afterHandleCallbacks=[],this.seeker=new W(e)},t.handle=function(e,t,n,o,i){var r=this,s=t||(null===i||void 0===i?void 0:i.sheetId),a={new_to_form:function(){return r.handleNewToForm()},new_to_form_mobile:function(){return r.handleNewToForm()},convert_to_form:function(){return r.handleConvertToForm()},new_to_form_with_questions:function(){return r.handleNewToFormWithQuestions(i)},bind_form_to_sheet:function(){return r.handleBindFormToSheet(i,n)},check_form:function(){return r.handleCheckForm(s)},cancel_form:function(){return r.handleCancelForm(s,!!n)},cancel_form_sheetbar:function(){return r.handleCancelForm(s,!!n,!0)},share_form:function(){return r.handleShareForm(s)},result_form:function(){return r.handleResultForm(s)},get_form_by_user:function(){return r.handleCheckAllFormByUser(n)},show_form_qrcode:function(){return r.handleShowQRCode(s)},get_form_details:function(){return r.handleGetFormDetails(n)},copy_form_link:function(){return r.handleCopyFormLink(s)},export_form:function(){return r.handleExportForm(i)}};e in a&&a[e](),n&&this.afterHandleCallbacks.push(n)},t.checkReleaseCell=function(e,t,n){var o=n||this.app.spreadsheet.activeSheet,i=o.data.colMetadata,r=o.data.rowMetadata,s=null===i||void 0===i?void 0:i[t],a=null===r||void 0===r?void 0:r[e],l=null===s||void 0===s?void 0:s.formData,d=null===a||void 0===a?void 0:a.formData;if(l&&d){if("question"===d.formDataId)return 1;if(d.formDataId.indexOf("record")>=0)return 2}return 0},t.checkReleaseRange=function(e,t,n,o){for(var i=e.startColIndex,r=e.startRowIndex,s=e.endColIndex,a=e.endRowIndex,l=0,d=r;d<=a;d++)for(var c=i;c<=s;c++){var u=null===n||void 0===n?void 0:n[c],h=null===t||void 0===t?void 0:t[d],m=null===u||void 0===u?void 0:u.formData,p=null===h||void 0===h?void 0:h.formData;if(m&&p&&0!==(l=this.getRelatedRangeType(p.formDataId,o)))return l}return l},t.isRelated=function(e){return this.relateMap.has(e)},t.isLoading=function(){return this.needShowLoading},t.getRelatedSheetId=function(){return Array.from(this.relateMap.keys())[0]},t.getRelatedNumber=function(){return this.relateMap?this.relateMap.size:0},t.getRelatedInfos=function(){return this.relatedFormInfos},t.updateFromSyncMutations=function(e,t,n){for(var o=!1,i=0;i<e.length&&!o;i++){var r=e[i];if(!Array.isArray(r))break;for(var s=0;s<r.length;s++){var a=(0,$.Xe)(r[s],n),d=l.Z.Mutation.MUTATION_ID.DELETE_SHEET_RANGE_MUTATION,c=["<author>","<time>"].indexOf(a.workbookRangeId)>-1;if((null===a||void 0===a?void 0:a.workbookRangeId)&&a.id===d&&c){o=!0;break}}}o&&this.unbindSubSheetRelatedForm(t)},t.stopCheckSync=function(){r.Z.util.timer.erase(this.checkTimeFlag)},t.isOpenDialog=function(){var e;return!0===(null===(e=this.questionListDialog)||void 0===e?void 0:e.isShow())},t.hideSelectQuestionDialog=function(){var e;null===(e=this.questionListDialog)||void 0===e||e.close()},t.checkCollectSheetType=function(){for(var e,t=!1,n=Ce.spreadConfig.getConfig("title")||"",o=we(be);!(e=o()).done;){var i=e.value;if(n.indexOf(i)>-1){t=!0;break}}return t},t.isRelateFormPublished=function(){return Ie(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t,n,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,y.HX)(this.globalId);case 2:if(t=e.sent,n=t.pub,o=t.rev,n&&o){e.next=6;break}return e.abrupt("return",!1);case 6:return e.abrupt("return",n===o);case 7:case"end":return e.stop()}}),e,this)})))},t.getRecordUserCount=function(){return Ie(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,y.RF)(this.globalId);case 2:if(t=e.sent,n=t.user_cnt){e.next=6;break}return e.abrupt("return",0);case 6:return e.abrupt("return",n);case 7:case"end":return e.stop()}}),e,this)})))},t.getRelatedSheetIdByDocId=function(e){for(var t,n=we(this.relateMap.entries());!(t=n()).done;){var o=t.value,i=o[0],r=o[1];if(r.docId.domain_id===e.domain_id&&r.docId.pad_id===e.pad_id)return i}return""},t.bindRelatedFormToSubSheet=function(e,t){this.relateMap.set(e,t),this.updateRelatedInfos(),(0,X.yg)()},t.unbindSubSheetRelatedForm=function(e){this.relateMap.delete(e),this.updateRelatedInfos(),(0,X.yg)()},t.handleCancelFormWithoutTips=function(e){return Ie(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise((function(t,i){var r=e||n.getCurrentSheetId(),s=n.getRelation(r);if(s){var a=s.subId,l=g.q.getConfig("globalPadId"),d=s.docId.domain_id+"$"+s.docId.pad_id;(0,y.rD)({sheetSubId:a,sheetGlobalId:l,formGlobalId:d}).then((function(){t()})).catch((function(){n.showToolToast(o.ZP.t("取消关联收集表失败，请稍后重试。")),i()}))}})));case 1:case"end":return t.stop()}}),t)})))},t.switchToRelatedSheet=function(e){var t=this;this.app.spreadsheet.sheetManager.hasSheetId(e)?r.Z.event.sheetsBar.trigger("switchSheet",e,this.getCurrentSheetId()):this.app.mutationBehavior.emitter.once(this.app.mutationBehavior.EVENT.AFTER_MUTATION_RUN,(function(n){return t.onMutationChange(n,e)}))},t.initFormSelectDialog=function(){var e=this;this.formSelectDialog=new P({linkOwnerForm:function(){return e.handleBindFormToSheet.apply(e,arguments)},openFormSheet:function(){return e.handleOpenFormRelatedSheet.apply(e,arguments)}})},t.handleOpenFormRelatedSheet=function(e){var t;return Ie(this,void 0,void 0,regeneratorRuntime.mark((function n(){var i,r,s;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,(0,y.JC)(e.domain_id,e.pad_id);case 2:if(i=n.sent,r=i.meta,s=null===(t=r.relative_doc)||void 0===t?void 0:t[0].doc_url){n.next=8;break}return x.default.show({type:"error",message:o.ZP.t("获取链接失败"),autoClose:!0,duration:3e3,style:{zIndex:10004}}),n.abrupt("return");case 8:Ee(s);case 9:case"end":return n.stop()}}),n)})))},t.initQuestionListDialog=function(){var e=this;this.questionListDialog=new de({app:this.app,creatDraft:function(t){0===t.length?e.handle("new_to_form"):e.handle("new_to_form_with_questions",void 0,void 0,void 0,t)}})},t.initQRCodeDialog=function(){this.qrCodeDialog=new he({app:this.app})},t.initRelation=function(){var e=this;this.relateMap=new Map,this.relatedFormInfos=[];var t=g.q.getConfig("relative")||[];this.globalId=t[0]?t[0].doc_id.domain_id+"$"+t[0].doc_id.pad_id:"",t.forEach((function(t){e.isRelatedForm(t)&&e.relateMap.set(t.sub_id,{docUrl:t.doc_url,docId:t.doc_id,subId:t.sub_id})})),this.updateRelatedInfos(),this.getRelatedNumber()&&Y.ZP.tdwReport({opername:"doc_core",module:"visit",action:"detail_page",ver6:1})},t.updateRelatedFormDetail=function(){return Ie(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t,n=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,y.Vv)();case 2:t=e.sent,this.relateFormDetailMap=new Map,t.forEach((function(e){e.relatedSheet&&e.relatedSheet&&n.relateFormDetailMap.set(e.relatedSheet.subId,e)}));case 5:case"end":return e.stop()}}),e,this)})))},t.isRelatedForm=function(e){return!!(e.doc_id&&e.sub_id&&e.doc_url)&&-1!==[J.Z.FORM,0,void 0].indexOf(e.doc_type)&&this.app.spreadsheet.sheetManager.hasSheetId(e.sub_id)},t.getRelation=function(e){return this.relateMap.get(e)||null},t.getSheetName=function(e){var t=e||this.getTitle();return(0,D.M)(this.app.spreadsheet.sheetManager.getSheetTitleList(),t)},t.getSheetTitle=function(){return g.q.getConfig("isUserChangeTitle")?g.q.getConfig("title"):""},t.getTitle=function(){var e=this.getSheetTitle()||o.ZP.t("无标题收集表");return e.length>32?e.substr(0,32):e},t.getCurrentSheet=function(){var e=this.app.spreadsheet.activeSheetId;return this.app.spreadsheet.sheetManager.getSheetBySheetId(e)},t.getCurrentSheetId=function(){var e=this.getCurrentSheet();return(null===e||void 0===e?void 0:e.getSheetId())||""},t.createSuccess=function(e,t,n){(null===t||void 0===t?void 0:t.url)?(this.bindRelatedFormToSubSheet(e,{subId:e,docUrl:t.url,docId:(0,X.QP)(t.global_padid)}),this.gotoFormEditPage(t.url,!0),this.handleDone(),ye("expo_formbar",{ver5:n?1:2}),Z().isMobilePhone||Z().isAndroidPad?Y.ZP.monitor(33647158):Y.ZP.monitor(33647157)):this.createFail(e,t)},t.createFail=function(e,t){var n=t&&(t.msg||t.errmsg);this.showToolToast(n?o.ZP.t("创建关联收集表失败：{{msg}}。",{msg:n}):o.ZP.t("网络异常，创建失败。"))},t.handleDone=function(){for(;this.afterHandleCallbacks.length;){var e=this.afterHandleCallbacks.shift();e&&e()}},t.resetSheetType=function(e){var t=this.app.spreadsheet.sheetManager.getSheetBySheetId(e);if(t){if(t.getSheetType()===i.Sheet.SHEET_TYPE.SMART_SHEET)return;t.setSheetType(i.Sheet.SHEET_TYPE.GRID);var n=this.app.spreadsheet.sheetManager.sheetList,o=a.Z.sheet.getAllSheets(n);this.app.requestApi.setSheet({opt:{sheetId:e,behaviors:o,oSubId:!1,withKeyData:!1}})}},t.getFormUrl=function(e,t){var n=this.getRelation(e);return(null===n||void 0===n?void 0:n.docUrl)+(t||"")},t.getRealUrl=function(e){var t=e.split("#");return e.includes("?")?"https:"+e:2===t.length?"https:"+t[0]+"?form=sheet#"+t[1]:"https:"+e+"?form=sheet#/edit"},t.gotoFormEditPage=function(e,t){var n=this,i=this.getRealUrl(e),r=Ee(i);if(t){var a=this.getRelatedSheetId();if(r)this.switchToRelatedSheet(a);else{var l=function(e){return u.createElement("span",null,o.ZP.t("收集表已创建。"),u.createElement("a",{id:"relate-form-url",href:e,style:{color:"#0086ff"},target:"_blank"},o.ZP.t("编辑收集表")))}(e);(0,T.showToast)(l,void 0,{showCloseBtn:!0});var d=document.querySelector("#relate-form-url");d&&d.addEventListener("click",(function(){n.switchToRelatedSheet(a),s.Z.toast.hideToast()}))}}},t.loadSheetSilent=function(e){var t=this.app.spreadsheet.sheetManager.getSheetBySheetId(e);t&&(t.isLoaded||this.app.dataCenter.loadSheetData({sheetId:e}))},t.handleGetFormDetails=function(e){return Ie(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.updateRelatedFormDetail();case 2:n=Array.from(this.relateFormDetailMap.values()),null===e||void 0===e||e(n);case 4:case"end":return t.stop()}}),t,this)})))},t.handleCopyFormLink=function(e){return Ie(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e){t.next=7;break}if(void 0!==(null===(n=this.relateFormDetailMap.get(e))||void 0===n?void 0:n.docUrl)){t.next=5;break}return(0,T.showToast)(o.ZP.t("获取分享链接失败")),t.abrupt("return");case 5:(0,me.ES)({copyContent:{html:"",plain:n.docUrl},type:pe.GI.input}),x.default.show({type:"success",message:o.ZP.t("已复制分享链接"),autoClose:!0,closable:!0});case 7:case"end":return t.stop()}}),t,this)})))},t.handleBindFormToSheet=function(e,t){var n=e.form,o=e.relink;return Ie(this,void 0,void 0,regeneratorRuntime.mark((function e(){var i,r,s,a,l,d;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=n.docId.domain_id+"$"+n.docId.pad_id,!o||!n.relativeDoc){e.next=5;break}return r=n.relativeDoc,s=r.sub_id,a=r.doc_id,l=a.domain_id,d=a.pad_id,e.next=5,(0,y.rD)({formGlobalId:i,sheetGlobalId:l+"$"+d,sheetSubId:s});case 5:return e.next=7,(0,y.mX)(i);case 7:null===t||void 0===t||t(),(0,X.yg)();case 9:case"end":return e.stop()}}),e)})))},t.handleNewToForm=function(){return Ie(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=g.q.getConfig("globalPadId"),n=fe.qF+"?sheet_id="+t,Ee(n);case 3:case"end":return e.stop()}}),e)})))},t.handleConvertToForm=function(){return Ie(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.questionListDialog.show(),ye("clk_sheetcon_create");case 2:case"end":return e.stop()}}),e,this)})))},t.handleNewToFormWithQuestions=function(e){return Ie(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n,o,i,r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=(0,j.generateSheetId)(),o=this.getSheetTitle(),i=this.getSheetName(o),t.prev=3,t.next=6,(0,y.Np)(n,i,e);case 6:r=t.sent,this.createSuccess(n,r,!1),t.next=13;break;case 10:t.prev=10,t.t0=t.catch(3),this.createFail(n,t.t0);case 13:ye("clk_sheet_create");case 14:case"end":return t.stop()}}),t,this,[[3,10]])})))},t.handleCheckForm=function(e){var t=e||this.getCurrentSheetId();if(this.isRelated(t)){var n=this.getFormUrl(t,"?openfrom=sheet_check");this.gotoFormEditPage(n),ye("clk_formbar_view")}},t.handleCancelForm=function(e,t,n){var i=this,r=e||this.getCurrentSheetId(),a=this.getRelation(r);if(a){var l=a.subId,d=g.q.getConfig("globalPadId"),c=a.docId.domain_id+"$"+a.docId.pad_id,u=function(){return(0,y.rD)({sheetSubId:l,sheetGlobalId:d,formGlobalId:c}).then((function(e){i.cancelSuccess(r,e,n)})).catch((function(){i.showToolToast(o.ZP.t("取消关联收集表失败，请稍后重试。"))}))};if(t)u();else{var h=o.ZP.t("取消关联后，收集结果将不再自动更新到表格。确定取消吗？");s.Z.dialog.dialog.confirm({title:o.ZP.t("取消关联收集表"),content:h,onOk:function(){u(),ye(n?"clk_sheet_cancel":"clk_formbar_cancel")}})}}},t.cancelSuccess=function(e,t,n){t&&0===t.retcode?(this.unbindSubSheetRelatedForm(e),this.resetSheetType(e),this.handleDone(),n||this.showToolToast(o.ZP.t("取消关联收集表成功。"))):this.showToolToast(o.ZP.t("取消关联收集表失败，请稍后重试。"))},t.showToolToast=function(e){(0,T.showToast)(e,{},{toolToastCloseTime:3e3})},t.handleShareForm=function(e){var t=e||this.getCurrentSheetId();if(this.isRelated(t)){var n=this.getFormUrl(t,"?openfrom=sheet_share");this.gotoFormEditPage(n),ye("clk_formbar_share")}},t.handleResultForm=function(e){var t=e||this.getCurrentSheetId();if(this.isRelated(t)){var n=this.getFormUrl(t,"#/result");this.gotoFormEditPage(n),ye("clk_formbar_result")}},t.handleCheckAllFormByUser=function(e){return Ie(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n,o,i;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,(0,y.ZG)({index:0});case 2:n=t.sent,o=n.list,i=n.nextPageIndex,e?e(o,i):this.formSelectDialog.show(o,i);case 6:case"end":return t.stop()}}),t,this)})))},t.handleShowQRCode=function(e){if(e){var t=this.relateFormDetailMap.get(e);(null===t||void 0===t?void 0:t.title)&&(null===t||void 0===t?void 0:t.docUrl)&&this.qrCodeDialog.show(t.title,t.docUrl)}},t.handleExportForm=function(e){var t=e.formGlobalPadId,i=function(e,t){void 0===t&&(t=!1),x.default.show({type:t?"error":"info",message:e,duration:5e3,autoClose:!0})},r=function(e,t){void 0===t&&(t=!1);var n=o.ZP.t("正在导出...{{rate}}%",{rate:e});!0===t?ve.Z.showToast(n,{"z-index":"10001"},{alwayOn:!0}):ve.Z.changeToastInnerText(n,e<100?"info":"success"),100===e&&setTimeout(ve.Z.hideToast,5e3)};Z().isPC||Z().isTencentDocsApp?!Z().isTencentDocsApp||Z().isTencentDocsAppVersionAboveOrEqual("2.5.0")?(r(0,!0),(0,y.PJ)(t,(function(e){var t,s=e.rate,a=e.fileUrl;if(e.isFailed)return i(o.ZP.t("RELATE_FORM_EXPORT_FAILED"),!0),void ve.Z.hideToast();r(s),s<100||!a||(Z().isTencentDocsApp?null===(t=null===n.g||void 0===n.g?void 0:n.g.mqq)||void 0===t||t.invoke("docx","fileDownload",a):(0,ge.ZP)(a))}))):i(o.ZP.t("RELATE_FORM_EXPORT_SHOULD_USE_NEW_VERSION_APP")):i(o.ZP.t("RELATE_FORM_EXPORT_PLATFORM_NOT_SUPPORTED"))},t.updateRelatedInfos=function(){var e=this;if(0===this.getRelatedNumber())return this.relatedFormInfos=[],void this.updateRelatedFormInfos();var t=Array.from(this.relateMap.values()).map((function(e){return e.docId}));(0,Q.eB)(t).then((function(t){e.relatedFormInfos=t,e.updateRelatedFormInfos()})).catch((function(i){for(var r=[],s=0;s<t.length;s++)r.push({doc_meta:{title:o.ZP.t("收集表{{value}}",{value:s+1}),doc_id:t[s]}});e.relatedFormInfos=r,e.updateRelatedFormInfos(),n.g.log.error("relateForm 获取关联收集表信息失败: "+i)}))},t.updateRelatedFormInfos=function(){r.Z.event.header.trigger("relatedFormInfosUpdate")},t.getRelatedRangeType=function(e,t){var n=0;return"question"===e&&(n=1),e.indexOf("record")>=0&&(n=2),!n||3!==t&&4!==t&&t!==n?0:t},e}(),Pe=Re},"../spread-sheet/src/core/ui/index.ts":function(e,t,n){n.d(t,{Z:function(){return R}});var o={};n.r(o),n.d(o,{hideModal:function(){return d},showModal:function(){return l}});var i={};n.r(i),n.d(i,{Progress:function(){return y},default:function(){return b}});var r=n("../spread-sheet/src/core/ui/dialog/index.ts"),s=n("../spread-sheet/src/core/ui/alert/index.ts"),a=n("../spread-sheet/src/core/ui/lazyLoad.ts"),l=function(e,t,n){(0,a.Fd)().then((function(o){o.default.showModal(e,t,n)}))},d=function(e,t){(0,a.Fd)().then((function(n){n.default.hideModal(e,t)}))},c=n("../spread-sheet/src/core/ui/toast/index.ts"),u=n("../spread-sheet/src/core/ui/tooltip/index.ts"),h=n("../node_modules/@babel/runtime/helpers/esm/createClass.js"),m=(n("../node_modules/regenerator-runtime/runtime.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.promise.js"),n("../node_modules/core-js/modules/es.object.assign.js"),n("../node_modules/core-js/modules/es.array.includes.js"),n("../node_modules/core-js/modules/es.string.includes.js"),n("../node_modules/core-js/modules/es.array.map.js"),n("../node_modules/core-js/modules/es.array.fill.js"),n("../node_modules/core-js/modules/web.dom-collections.for-each.js"),n("../node_modules/core-js/modules/es.object.keys.js"),n("../node_modules/core-js/modules/es.array.iterator.js"),n("../node_modules/core-js/modules/web.dom-collections.iterator.js"),n("../spread-sheet/src/core/view/spreadsheet-view/utils.ts")),p=n("../packages/model/src/dimension/index.ts"),f=n("react"),v=n.n(f),g=n("react-dom"),w=n.n(g),_=function(e){var t=e.progress;if(t<=.05)return v().createElement("img",{style:{width:"16px",height:"16px"},src:"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHN0eWxlPSJtYXJnaW46YXV0byIgd2lkdGg9IjQwIiBoZWlnaHQ9IjQwIiB2aWV3Qm94PSIwIDAgMTAwIDEwMCIgcHJlc2VydmVBc3BlY3RSYXRpbz0ieE1pZFlNaWQiIGRpc3BsYXk9ImJsb2NrIj48Y2lyY2xlIGN4PSI1MCIgY3k9IjUwIiByPSIzMCIgc3Ryb2tlPSIjZGFlOWZmODAiIHN0cm9rZS13aWR0aD0iMTAiIGZpbGw9Im5vbmUiLz48Y2lyY2xlIGN4PSI1MCIgY3k9IjUwIiByPSIzMCIgc3Ryb2tlPSIjNDg5MmZlIiBzdHJva2Utd2lkdGg9IjEwIiBzdHJva2UtbGluZWNhcD0icm91bmQiIGZpbGw9Im5vbmUiIHRyYW5zZm9ybT0icm90YXRlKDcwOC45NTIgNTAgNTApIj48YW5pbWF0ZVRyYW5zZm9ybSBhdHRyaWJ1dGVOYW1lPSJ0cmFuc2Zvcm0iIHR5cGU9InJvdGF0ZSIgcmVwZWF0Q291bnQ9ImluZGVmaW5pdGUiIGR1cj0iMS4yNXMiIHZhbHVlcz0iMCA1MCA1MDsxODAgNTAgNTA7NzIwIDUwIDUwIiBrZXlUaW1lcz0iMDswLjU7MSIvPjxhbmltYXRlIGF0dHJpYnV0ZU5hbWU9InN0cm9rZS1kYXNoYXJyYXkiIHJlcGVhdENvdW50PSJpbmRlZmluaXRlIiBkdXI9IjEuMjVzIiB2YWx1ZXM9IjE4Ljg0OTU1NTkyMTUzODc2IDE2OS42NDYwMDMyOTM4NDg4Mjs3NS4zOTgyMjM2ODYxNTUwMyAxMTMuMDk3MzM1NTI5MjMyNTQ7MTguODQ5NTU1OTIxNTM4NzYgMTY5LjY0NjAwMzI5Mzg0ODgyIiBrZXlUaW1lcz0iMDswLjU7MSIvPjwvY2lyY2xlPjwvc3ZnPg=="});var n=6.28*55*t;return v().createElement("svg",{width:"14px",height:"14px",version:"1.1",viewBox:"0 0 120 120",preserveAspectRatio:"none"},v().createElement("circle",{cx:"140",cy:"60",r:"52",fill:"none",stroke:"#D4D5D9",strokeWidth:"14",strokeDasharray:"360,20000",transform:"rotate(-90,100,100)"}),v().createElement("circle",{cx:"140",cy:"60",r:"52",fill:"none",stroke:"#0082EF",strokeWidth:"14",strokeDasharray:n+",20000",transform:"rotate(-90,100,100)",strokeLinecap:"round"}))},I=function(e,t){void 0===e&&(e=0),w().render(v().createElement(_,{progress:e}),t)},C=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function s(e){try{l(o.next(e))}catch(t){r(t)}}function a(e){try{l(o.throw(e))}catch(t){r(t)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((o=o.apply(e,t||[])).next())}))},y=function(){function e(e){var t=this;this.translateX=0,this.translateY=0,this._eventDisposes=[],this.show=function(){return C(t,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.initPosition(),Object.assign(this.progressView.style,{position:"absolute",backgroundColor:"white",zIndex:1,display:"flex",alignItems:"center",overflow:"hidden",fontSize:"13px",pointerEvents:"none",borderWidth:"0px",boxShadow:"0 0 0 1px #E2E4E8",boxSizing:"border-box"}),this.visibile=!0,this.valid=!0,this.container.appendChild(this.progressView);case 5:case"end":return e.stop()}}),e,this)})))},this.updateProgress=function(e){I(e,t.iconSpan)},this.hide=function(){t.visibile=!1,t.container.contains(t.progressView)&&t.container.removeChild(t.progressView),t.handleEvent(!1)},this.cancelUpload=function(){t.valid=!1,t.hide()},this.getPositionInfo=function(){return{sheetId:t.sheetId,row:t.row,col:t.col}},this.setVisible=function(){t.visibile=!0,t.progressView.style.display="flex"},this.setHidden=function(){t.visibile=!1,t.progressView.style.display="none"},this.handleUpdateCells=function(e){var n=e.startRow,o=e.endRow,i=e.startCol,r=e.endCol;t.row>=n&&t.row<=o&&t.col>=i&&t.col<=r&&t.onRemove(t.id)},this.handleChange=function(e){return function(n){var o=n.sheetId,i=n.index,r=n.amount,s=n.type;if(o===t.sheetId){var a=s===p.DIMENSION_TYPE.ROWS?"row":"col";e&&new Array(r).fill(i).map((function(e,t){return e+t})).includes(t[a])?t.onRemove(t.id):(e&&i+r-1>t[a]&&(t[a]=Math.max(0,t[a]-r)),!e&&i+r-1<=t[a]&&(t[a]=t[a]+r),t.initPosition())}}},this.toggleVisible=function(e){if(e===t.sheetId)return t.setVisible();t.setHidden()},this.handleEvent=function(e){var n=t._eventDisposes;if(!e)return n.forEach((function(e){e.dispose()})),t._eventDisposes=[],void t.app.event.sheetsBar.remove("switchSheet",t.toggleVisible);var o=t.app.view.canvas,i=o.areaData,r=o.resize,s=o.scale,a=o.dataCallView;n.push(i.onUpdateOffset(t.updatePosition)),n.push(r.onResize(t.initPosition)),n.push(s.onScale(t.initPosition)),n.push(a.onSetRowHeight(t.initPosition)),n.push(a.onSetRowVisible(t.initPosition)),n.push(a.onSetColWidth(t.initPosition)),n.push(a.onSetColVisible(t.initPosition)),n.push(a.onMergeUnmerge(t.initPosition)),n.push(a.onUpdateChart(t.initPosition)),n.push(a.onUpdateFreeze(t.initPosition)),n.push(a.onUpdateCells(t.handleUpdateCells)),n.push(a.onDeleteRow(t.handleChange(!0))),n.push(a.onDeleteCol(t.handleChange(!0))),n.push(a.onInsertRow(t.handleChange(!1))),n.push(a.onInsertCol(t.handleChange(!1))),t.app.event.sheetsBar.listen("switchSheet",t.toggleVisible)},this.initDOM=function(){t.iconSpan=document.createElement("span"),t.iconSpan.style.margin="0 4px",t.iconSpan.style.width="14px",t.iconSpan.style.height="14px",t.progressView.appendChild(t.iconSpan),I(0,t.iconSpan),t.textSpan=document.createElement("span"),t.textSpan.style.color="#3677FD",t.textSpan.style.textDecoration="underline",t.textSpan.style.textDecorationColor="#3677FD",t.textSpan.style.whiteSpace="nowrap",t.textSpan.style.textOverflow="ellipsis",t.textSpan.style.overflow="hidden",t.progressView.appendChild(t.textSpan),t.textSpan.textContent=t.text},this.initPosition=function(){var e=t.app.view.canvas,n=e.tableView,o=e.areaData,i=e.headSize,r=e.rowcolAccessor,s=e.clientRect,a=n.getCellViewAtPosition(t.row,t.col),l=t.col,d=t.row,c=(0,m.E)(r,a,t.row),u=(0,m.o)(r,a,t.col),h=o.getDisplayViewTopByRow(d);(null===a||void 0===a?void 0:a.mergeData)&&(d+=a.mergeData.rowCount-1);var p=o.getDisplayViewBottomByRow(d),f=s.height-i.displayColHeadHeight;t.progressView.style.bottom=f-h+"px",t.progressView.style.top=p-c+"px";var v=o.getDisplayViewLeftByCol(l);t.progressView.style.left=v+"px",t.progressView.style.width=u-1+"px",t.progressView.style.height=c-1+"px",t.progressView.style.backgroundSize=Math.min(u,40)+"px "+Math.min(c,40)+"px",t.translateX=o.getDisplayViewLeftByCol(l),t.translateY=o.getDisplayViewTopByRow(d)},this.updatePosition=function(){var e=t.app.view.canvas,n=e.tableView,o=e.areaData,i=n.getCellViewAtPosition(t.row,t.col),r=t.col,s=t.row;(null===i||void 0===i?void 0:i.mergeData)&&(s+=i.mergeData.rowCount-1);var a=o.getDisplayViewLeftByCol(r),l=o.getDisplayViewTopByRow(s);t.progressView.style.transform="translate("+(a-t.translateX)+"px, "+(l-t.translateY)+"px)"},this.id=e.id,this.app=e.app,this.container=e.app.view.canvas.mainBoard.element,this.row=e.row,this.col=e.col,this.sheetId=e.sheetId,this.visibile=!1,this.progressView=document.createElement("div"),this.text=e.text,this.onRemove=e.onRemove,this.initDOM(),this.handleEvent(!0)}return e.prototype.getProgressView=function(){return this.progressView},(0,h.Z)(e,[{key:"isVisible",get:function(){return this.visibile}},{key:"isValid",get:function(){return this.valid}}]),e}(),E=function(){function e(){}return e.createInstance=function(t,n,o,i,r,s,a){if(null===n.view.getSelection())return null;var l=new y({id:t,app:n,row:o,col:i,sheetId:r,text:s,onRemove:a});return e.value[t]=l},e.getInstance=function(t){return e.value[t]},e.removeInstance=function(t){var n;Object.keys(e.value).includes(t)&&(null===(n=e.value[t])||void 0===n||n.cancelUpload(),e.value[t]=void 0)},e.keys=function(){return Object.keys(e.value)},e}();E.value={};var b=E,R={dialog:r,alert:s,modal:o,toast:c,tooltip:u,progress:i}},"../spread-sheet/src/core/ui/tooltip/index.ts":function(e,t,n){n.r(t),n.d(t,{changeTooltipText:function(){return c},default:function(){return h},hideTooltip:function(){return d},horizontalTooltip:function(){return u},showTooltip:function(){return l},toolTip:function(){return a}});var o=n("../spread-sheet/src/core/ui/lazyLoad.ts"),i=n("../node_modules/@tencent/docs-user-agent/dist/index.js"),r=n.n(i),s=n("../spread-sheet/src/base/event/event.ts"),a=function(e,t){(0,o.gB)().then((function(n){n.tooltip(e,t)}))},l=function(e,t){(0,o.gB)().then((function(n){n.tooltip(e,t)}))},d=function(){(0,o.gB)().then((function(e){e.hideTooltip()}))},c=function(e){(0,o.gB)().then((function(t){t.changeTooltipText(e)}))},u=function(e,t,n){(0,o.gB)().then((function(o){o.horizontalTooltip(e,t,n)}))};function h(){s.ZP.windowEvent.listen("resize",(function(){$("#tooltip").remove()})),s.ZP.windowEvent.listen("keydown",(function(){$("#tooltip").remove()})),r().isMobilePhone||r().isAndroidPad||!window.SpreadsheetApp.sheetStatus.canEdit||a("#toolbar [data-tooltip]")}},"../spread-sheet/src/core/utils/gray.ts":function(e,t,n){n.d(t,{c:function(){return r},i:function(){return s}});var o=n("../node_modules/@tencent/docs-multi-tools/dist/index.js"),i=n("../spread-sheet/src/core/data/configService/spreadConfig.ts");function r(){var e=i.q.getConfig("isGrayed");return"ww"===(0,o.getLoginType)()&&e}function s(){return!1}n("../spread-sheet/src/base/util/domain-config.ts")},"../spread-sheet/src/core/utils/relate/RelateType.ts":function(e,t){var n;!function(e){e[e.FORM=2]="FORM",e[e.AIO=7]="AIO"}(n||(n={})),t.Z=n},"../spread-sheet/src/core/utils/relate/api.ts":function(e,t,n){n.d(t,{LO:function(){return a},eB:function(){return s}}),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.promise.js");var o=n("./node_modules/axios/index.js"),i=n.n(o),r=n("../packages/utils/src/safe.ts");function s(e){var t={doc_ids:JSON.stringify(e),xsrf:(0,r.f)()};return new Promise((function(e,n){i().get("/cgi-bin/online_docs/doc_infosguest",{params:t,withCredentials:!0}).then((function(t){var o=t.data;0===o.cgicode&&0===o.retcode||n(o.msg),e(o.doc_info)})).catch((function(e){n(e)}))}))}function a(e){var t={relation:e,xsrf:(0,r.f)()};return new Promise((function(e,n){i().post("/v2/file/relation/dissociate",t).then((function(t){var o=t.data;0===o.cgicode&&0===o.retcode||n(o.msg),e(o)})).catch((function(e){n(e)}))}))}},"../spread-sheet/src/core/utils/relate/relate.ts":function(e,t,n){n.d(t,{QP:function(){return a},tZ:function(){return l},yg:function(){return s}}),n("../node_modules/regenerator-runtime/runtime.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.promise.js"),n("../node_modules/core-js/modules/es.regexp.exec.js"),n("../node_modules/core-js/modules/es.string.split.js");var o=n("../spread-sheet/src/core/utils/relate/RelateType.ts"),i=n("../spread-sheet/src/base/event/event.ts"),r=(n("../spread-sheet/src/base/util/toggle.ts"),n("../spread-sheet/src/core/data/configService/spreadConfig.ts"),function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function s(e){try{l(o.next(e))}catch(t){r(t)}}function a(e){try{l(o.throw(e))}catch(t){r(t)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((o=o.apply(e,t||[])).next())}))});function s(){return r(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:i.ZP.header.trigger("relateBtnUpdate"),i.ZP.sheetsBar.trigger("bindStatusChange"),i.ZP.formRelationEvent.trigger("formRelationChange");case 3:case"end":return e.stop()}}),e)})))}function a(e){var t=e.split("$");return{domain_id:+t[0],pad_id:t[1]}}function l(e,t){if(e&&e.relateForm&&e.relateAio)return e.relateForm.isRelated(t)?o.Z.FORM:e.relateAio.isRelated(t)?o.Z.AIO:void 0}},"../spread-sheet/src/external/export/download.ts":function(e,t,n){n.d(t,{PZ:function(){return d},jh:function(){return l},jr:function(){return s},y5:function(){return r}});var o=n("../node_modules/@tencent/docs-user-agent/dist/index.js"),i=n.n(o);function r(e){!i().isChrome||!i().isWindows||i().isWxWork||i().isWeChat?i().isWxWork?function(e){var t=document.createElement("a");t.id="linkDwnldLink",t.href=e;var n=document.getElementById("linkDwnldLink");n&&document.body.removeChild(n),document.body.appendChild(t),null===t||void 0===t||t.setAttribute("download",""),null===t||void 0===t||t.click()}(e):s(e):n.g.open(e,"_blank")||s(e)}function s(e,t){var n="exportIframe-"+t,o=document.createElement("iframe");o.id=n,o.src="",o.style.display="none";var i=document.querySelector("#"+n);return i&&document.body.removeChild(i),document.body.appendChild(o),o.setAttribute("src",e),o}var a={};function l(e,t,n){clearInterval(a[e]);var o=0;a[e]=setInterval((function(){var e=Math.max(1,Math.round(100/(t/4)));o=Math.min(o+e,99),n(o)}),1e3)}function d(e){clearInterval(a[e])}t.ZP=r},"../spread-sheet/src/external/export/ui/index.ts":function(e,t,n){var o=n("../node_modules/@tencent/dui-mobile/lib/components/Toast/index.js"),i=n("../spread-sheet/src/core/ui/toast/toast.tsx"),r=new function e(){var t=this;this.showToast=function(e,n,o){return t.isMobile()?t.mobileShowToast(e,o):(0,i.showToast)(e,n,o)},this.hideToast=function(){return t.isMobile()?t.mobileHideToast():(0,i.hideToast)()},this.changeToastInnerText=function(e,n){return t.isMobile()?t.mobileChangeToastInnerText(e):(0,i.changeToastInnerText)(e,n)},this.isMobile=function(){return!1},this.mobileShowToast=function(t,n){e.toastInstance&&(e.toastInstance.close(),e.toastInstance=void 0),e.toastInstance=o.default.show({content:t,duration:n.toolToastCloseTime||5e3,autoClose:!n.alwayOn,position:"bottom"})},this.mobileHideToast=function(){e.toastInstance&&(e.toastInstance.close(),e.toastInstance=void 0)},this.mobileChangeToastInnerText=function(t){e.toastInstance&&e.toastInstance.update&&e.toastInstance.update({content:t})}};t.Z=r}}]),window.jsExecEndTimeStamp=Date.now(),window.cachedPerformanceEntries||(window.cachedPerformanceEntries=[]),window.cachedPerformanceEntries.push({name:"jsExec: js/spread-sheet_src_core_feature_relateForm_index_ts.acbead8c7ba4d0e801c1.js",entryType:"jsExec",startTime:window.jsExecStartTimeStamp,endTime:window.jsExecEndTimeStamp});
//# sourceMappingURL=spread-sheet_src_core_feature_relateForm_index_ts.acbead8c7ba4d0e801c1.js.map