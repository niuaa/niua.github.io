self.window=self,window.jsExecStartTimeStamp=Date.now(),(self.webpackChunk_tencent_alloy_builder=self.webpackChunk_tencent_alloy_builder||[]).push([["core-sheet_js_report_raven-config_js-core-sheet_js_report_weblog-config_js-core-sheet_js_repo-b5e52e"],{"../core-sheet/js/report/raven-config.js":function(e,t,n){"use strict";n("../node_modules/core-js/modules/es.object.entries.js"),n("../node_modules/core-js/modules/es.regexp.exec.js"),n("../node_modules/core-js/modules/es.string.match.js"),n("../node_modules/core-js/modules/es.array.includes.js"),n("../node_modules/core-js/modules/es.string.includes.js");var r=n("../packages/report/src/index.ts"),o=n("../node_modules/@tencent/docs-user-agent/dist/index.js"),s=n.n(o),i=n("../packages/common-utils/src/index.ts"),a=n("../node_modules/@tencent/docs-multi-tools/dist/index.js"),l=n("../spread-sheet/src/base/config/report.ts"),d=n("../node_modules/@tencent/weblog-super-logger/dist/raven-logger.js"),u=n("../spread-sheet/src/base/util/appConfig.ts").Z.getConfig("custom.standaloneLinks.sentry_report_3641"),c=(0,i.IZ)("currentEnv"),h=[{test:function(){return!0},dsn:u,project:"3641"}];try{c?window.Raven&&Raven.setTagsContext({plantform:s().isMobilePhone||s().isAndroidPad?"mobile":"pc",uid:(0,a.getUid)(),currentEnv:c}):window.Raven&&Raven.setTagsContext({plantform:s().isMobilePhone||s().isAndroidPad?"mobile":"pc",uid:(0,a.getUid)()})}catch(g){console.warn(g)}var f=s().isMobilePhone||s().isAndroidPad?33710522:33710521;c&&(f=s().isMobilePhone||s().isAndroidPad?33715453:33715452);var p={cefQuery:33715741,playBackgroundMusic:33715742,setKeyboardHeight:33715743,test:33715744,showTips:33938728,ExecuteJsInterface:34594185,x5onSkinSwitch:null,WeixinJSBridge:null};window.__jsErrorCount=0,window.addEventListener("error",(function(e){var t,o=(null===e||void 0===e?void 0:e.message)||"";if(r.ZP.monitor,r.ZP.monitor)if("ResizeObserver loop limit exceeded"!==o){for(var s=0,i=Object.entries(p);s<i.length;s++){var a=i[s],d=a[0],u=a[1];if(o.match(d))return void(u&&r.ZP.monitor(u))}if(r.ZP.monitor(f),window.__jsErrorCount=window.__jsErrorCount+1,1===window.__jsErrorCount){r.ZP.tdwSingleReport({opername:"quality_doc",module:"excel_detail",action:"js_error",ver8:encodeURIComponent(o)}),r.ZP.zzsStatus({attrid:l.ZZS_REPORT_ATTR.JS_ERROR,status:1});var c=Math.ceil(1e4*Math.random());o.includes("sendBeacon")&&c<=10&&(null===(t=n.g.log)||void 0===t||t.report(l.PROACTIVE_REPORT_ERROR))}}else console.warn("Ignored: ResizeObserver loop limit exceeded")})),window.Raven&&Raven.config(u,{release:window.__globalReleaseVersion,ignoreErrors:["cefQuery","playBackgroundMusic","setKeyboardHeight","Cannot read property 'test' of undefined","setKeyboardHeight","showTips","ExecuteJsInterface","Changeset","ResizeObserver loop limit exceeded"],shouldSendCallback:function(){return!(window.__jsErrorCount>9)},dataCallback:function(e){var t;if(h&&h.length>0)for(var n=0;n<h.length;n++){var r=h[n];if(null===(t=r.test)||void 0===t?void 0:t.call(r,e)){e.project!==r.project&&(window.Raven.setDSN(r.dsn),e.project=r.project);break}}return d.ZP.xlog(e)}}).install()},"../core-sheet/js/report/weblog-config.js":function(e,t,n){"use strict";var r;n("../spread-sheet/src/base/util/domain-config.ts"),null===(r=window.log)||void 0===r||r.init(2,{release:"sheet-release-20220425-cc26aba101"})},"../core-sheet/js/report/whitescreen.js":function(e,t,n){"use strict";n.d(t,{$F:function(){return c},IF:function(){return u}}),n("../node_modules/core-js/modules/es.function.name.js"),n("../node_modules/core-js/modules/es.number.constructor.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.regexp.to-string.js");var r=n("../packages/report/src/index.ts"),o=function(){},s={};["report","info","error"].forEach((function(e){s[e]||(s[e]=o)})),s=window.log?window.log:s;var i=r.ZP&&r.ZP.tdwReport||o,a=r.ZP&&r.ZP.monitor||o,l=function(){function e(e,t){this.isChecked=!1,this.name=e,this.options=t,this.hasFinished=!1,this.startTs=0,this.endTs=0,this.nextTickTs=0,this.isCheckedWithError=!1}var t=e.prototype;return t._check=function(){var e,t,r=this.name,o=this.options,i=void 0===o?{}:o,l=i.common,d=void 0===l?{}:l,u=i.nextTick,c=i.runNextTick,h=d.reportKeyPrefix,f=void 0===h?"":h,p=this.isChecked,g=u.monitorIds,m=void 0===g?{}:g,v=r+"_nextTick",I=u.reportKey||f+v,E=Number(new Date);if(this.nextTickTs=E,null===(e=n.g.__ws)||void 0===e||e.trigger("checkerData",{n:r,t:"nextTick",ts:E,flag:p}),!p&&m.error&&a(m.error),this.hasFinished=!0,s.info(v,{flag:p}),!p){var S=s.report(I);null===(t=n.g.__ws)||void 0===t||t.trigger("checkerError",{name:r,reportId:S})}null===c||void 0===c||c(p)},t.start=function(){var e,t=this,r=this.name,o=this.options,i=(void 0===o?{}:o).withCatchError,a=r+"_start";s.info(a);var l=Number(new Date);this.startTs=l,null===(e=n.g.__ws)||void 0===e||e.trigger("checkerData",{n:r,t:"start",ts:l}),i||setTimeout((function(){t._check()}),0)},t.end=function(){var e;if(!this.isCheckedWithError){this.isChecked=!0;var t=this.name,r=this.options.withCatchError,o=t+"_end",i=Number(new Date);this.endTickTs=i,null===(e=n.g.__ws)||void 0===e||e.trigger("checkerData",{n:t,t:"end",ts:i}),s.info(o),r&&this._check()}},t.endWithError=function(e){var t;if(!this.isChecked){this.isCheckedWithError=!0;var o=this.name,i=this.options.withCatchError,a=Number(new Date),l="";try{l=e.toString()}catch(d){}null===(t=n.g.__ws)||void 0===t||t.trigger("checkerData",{n:o,t:"endWithError",ts:a,msg:l}),s.error("[init error]",l,null===e||void 0===e?void 0:e.stack),s.report("EXCEL_CHECKER_INIT_CATCH"),r.ZP.monitor(34378724),i&&this._check()}},e}(),d=(window&&(window.performance||window.webkitPerformance||window.msPerformance)||{}).timing,u=new l("canvas",{nextTick:{monitorIds:{error:34948360}},common:{reportKeyPrefix:"EXCEL_CHECKER_"},runNextTick:function(e){var t;e&&(null===(t=n.g.__ws)||void 0===t||t.trigger("firstScreenFinish"))}}),c=new l("coresheet",{nextTick:{monitorIds:{right:33945534,error:33945535}},common:{reportKeyPrefix:"EXCEL_CHECKER_"}});window.addEventListener("beforeunload",(function(){var e;if(!window.__reloadAndRetry&&!u.isChecked){var t="whitescreen_beforeunload"+(window.quickLookRenderEnd?"_quickLook":""),r=d||{},o=r.fetchStart,s=void 0===o?0:o,a=r.responseStart,l=void 0===a?0:a,c=null===(e=n.g.performanceData)||void 0===e?void 0:e.jsStartRun,h=Date.now();i({opername:"excel_error",module:"error",action:t,ver5:s||h,ver6:l||0,ver7:c||0,ver8:h||0})}}))},"../spread-sheet/src/ServiceCollection/Loader.ts":function(e,t,n){"use strict";n.d(t,{o:function(){return l}});var r=n("../node_modules/@babel/runtime/helpers/esm/toConsumableArray.js"),o=n("../node_modules/@babel/runtime/helpers/esm/construct.js"),s=(n("../node_modules/regenerator-runtime/runtime.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.promise.js"),n("../spread-sheet/src/base/dynamicImport/index.ts")),i=n("../packages/lib/EventEmitter.ts"),a=function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function i(e){try{l(r.next(e))}catch(t){s(t)}}function a(e){try{l(r.throw(e))}catch(t){s(t)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,a)}l((r=r.apply(e,t||[])).next())}))},l=function(){function e(e){this.source=e,this.loaded=!1,this.initialized=!1,this.instance=null,this.emitter=new i.Z}var t=e.prototype;return t.saveParam=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.params=t},t.load=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return a(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s.ZP.getModule(this.source);case 2:return this.module=e.sent,this.loaded=!0,this.params=t,e.abrupt("return",this.module);case 6:case"end":return e.stop()}}),e,this)})))},t.createInstance=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var s;return a(this,void 0,void 0,regeneratorRuntime.mark((function e(){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=this.module.default;try{this.instance=(0,o.Z)(r,t)}catch(i){null===(s=n.g.log)||void 0===s||s.error("Loader.createInstance error",null===i||void 0===i?void 0:i.stack)}return this.initialized=!0,e.abrupt("return",this.instance);case 4:case"end":return e.stop()}}),e,this)})))},t.init=function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return a(this,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.isIniting=!0,t.next=3,this.load();case 3:return this.createInstance.apply(this,n),this.params=n,this.emitter.emit(e.EVENT_NAME.LOADED,this.instance),this.isIniting=!1,t.abrupt("return",this.instance);case 8:case"end":return t.stop()}}),t,this)})))},t.getInstance=function(){for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return a(this,void 0,void 0,regeneratorRuntime.mark((function t(){var o=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise((function(t){return a(o,void 0,void 0,regeneratorRuntime.mark((function o(){return regeneratorRuntime.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:if(!this.initialized){o.next=2;break}return o.abrupt("return",t(this.instance));case 2:if(!this.loaded){o.next=5;break}return this.createInstance.apply(this,(0,r.Z)(this.params||n)),o.abrupt("return",t(this.instance));case 5:this.emitter.on(e.EVENT_NAME.LOADED,(function(e){t(e)})),this.isIniting||this.init.apply(this,(0,r.Z)(this.params||n));case 7:case"end":return o.stop()}}),o,this)})))})));case 1:case"end":return t.stop()}}),t)})))},t.then=function(e){return a(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.getInstance();case 2:n=t.sent,e(n);case 4:case"end":return t.stop()}}),t,this)})))},e}();l.EVENT_NAME={LOADED:"LOADED"}},"../spread-sheet/src/adapter/SpreadSheetAppAdapter.ts":function(e,t,n){"use strict";n.d(t,{L:function(){return E},S:function(){return S}}),n("../node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),n("../node_modules/core-js/modules/esnext.reflect.metadata.js");var r,o,s,i=n("../node_modules/@tencent/workbench/lib/esm/decorators/class/adapter.js"),a=n("../spread-sheet/src/core/app/SpreadsheetApp.interface.ts"),l=n("../spread-sheet/src/core/app/sheetStatus/index.ts"),d=n("../spread-sheet/src/base/util/container.ts"),u=n("../spread-sheet/src/core/view/spreadsheet-view/SpreadsheetView.interface.ts"),c=n("../spread-sheet/src/base/event/event.ts"),h=n("../spread-sheet/src/base/event/eventName.ts"),f=n("../spread-sheet/src/core/view/config/default.ts"),p=n("../node_modules/lodash/throttle.js"),g=n.n(p),m=function(e,t,n,r){var o,s=arguments.length,i=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)i=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(i=(s<3?o(i):s>3?o(t,n,i):o(t,n))||i);return s>3&&i&&Object.defineProperty(t,n,i),i},v=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},I=function(e,t){return function(n,r){t(n,r,e)}},E="spreadSheetAdapter",S=function(){function e(e,t,n){var r=this;this.sheetStatus=e,this.app=t,this.spreadsheetView=n,this.app=window.SpreadsheetApp,this.app.view.canvas.spreadsheetView.resize.onResize((function(){r.resize()}))}var t=e.prototype;return t.attachEditor=function(e,t){this.bindCallBacks(t);var n=document.getElementById("mainContainer");if(n)return this.resize(),e.appendChild(n),this.app},t.setValue=function(){},t.requestFocus=function(){this.app.view.canvas.inputManager.focus()},t.requestBlur=function(){},t.isCaret=function(){return!1},t.destroy=function(){},t.resize=function(){var e=document.getElementById("workbenchContainer");e&&(e.style.height="calc(100% - "+(0,d.x)()+"px)")},t.bindCallBacks=function(e){var t;this.app.view.canvas.normalSelectData.onModifySelectData(g()((function(){e.onSelectionChange()}),f.bU)),this.sheetStatus.change((function(){e.onSelectionChange()})),null===(t=this.app.mutationBehavior)||void 0===t||t.emitter.addListener(this.app.mutationBehavior.EVENT.DATA_CHANGE,e.onDataChange),c.ZP.spreadsheetEvent.listen(h.W1.DATA_CHANGE,(function(t){"syncndoredoStack"===(null===t||void 0===t?void 0:t.type)&&e.onDataChange()}))},e}();S=m([(0,i.L)(E),I(0,l.T),I(1,a.m),I(2,u.Z),v("design:paramtypes",["function"===typeof(r="undefined"!==typeof l.T&&l.T)?r:Object,"function"===typeof(o="undefined"!==typeof a.m&&a.m)?o:Object,"function"===typeof(s="undefined"!==typeof u.Z&&u.Z)?s:Object])],S)},"../spread-sheet/src/core/app/BaseSpreadsheetApp.ts":function(e,t,n){"use strict";var r=n("../node_modules/@babel/runtime/helpers/esm/createClass.js"),o=function(){function e(){}return(0,r.Z)(e,[{key:"EVENT",get:function(){return e.EVENT}}]),e}();o.EVENT={},t.Z=o},"../spread-sheet/src/core/app/SpreadsheetApp.ts":function(e,t,n){"use strict";var r=n("../node_modules/@babel/runtime/helpers/esm/createClass.js"),o=n("../node_modules/@babel/runtime/helpers/esm/assertThisInitialized.js"),s=n("../node_modules/@babel/runtime/helpers/esm/inheritsLoose.js"),i=(n("../node_modules/regenerator-runtime/runtime.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.promise.js"),n("../spread-sheet/src/ServiceCollection/index.ts")),a=n("../spread-sheet/src/core/app/BaseSpreadsheetApp.ts"),l=n("../spread-sheet/src/base/event/event.ts"),d=n("../packages/common-utils/src/index.ts"),u=function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function i(e){try{l(r.next(e))}catch(t){s(t)}}function a(e){try{l(r.throw(e))}catch(t){s(t)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,a)}l((r=r.apply(e,t||[])).next())}))},c=function(e){function t(){var t;return(t=e.call(this)||this).didEditable=!1,t.historyInstance=null,t.setHistoryLoader=function(e){var n=(0,o.Z)(t);t.history={get showing(){var e;return Boolean(null===(e=n.historyInstance)||void 0===e?void 0:e.showing)},getInstance:function(){return u((0,o.Z)(t),void 0,void 0,regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(e instanceof i.oF)){t.next=6;break}return t.next=3,e.getInstance(this.permissions,this.spreadsheet,n);case 3:r=t.sent,t.next=9;break;case 6:return t.next=8,e.getInstance();case 8:r=t.sent;case 9:return this.historyInstance=r,t.abrupt("return",r);case 11:case"end":return t.stop()}}),t,this)})))}}},t.event=l.ZP,t.isInited=!1,t}(0,s.Z)(t,e);var a=t.prototype;return a.setDidEditable=function(e){this.didEditable=e},a.getDidEditable=function(){return this.didEditable},a.setInited=function(e){this.isInited=e},a.initDocumentManager=function(e){this.documentManager=e},a.initEmitter=function(e){this.emitter=e},a.setLifeCycle=function(e){var t;null===(t=n.g.log)||void 0===t||t.info("SpreadsheetApp.setLifeCycle=",e),this.lifeCycle=e,n.g.tDocsPerformance.markLifeCycle(e)},a.initSheetStatus=function(e){this.sheetStatus=e},a.initAdvPermissions=function(e){this.advPermissions=e},a.initPermissions=function(e){this.permissions=e,"reading"===(0,d.IZ)("mode")&&this.permissions.activeShutdownStatus(!1)},a.initNetworkStatus=function(e){this.networkStatus=e},a.initSpreadsheet=function(e){this.spreadsheet=e},a.initMutationBehavior=function(e){this.mutationBehavior=e},a.initMainThreadWorker=function(e){this.mainThreadWorker=e},a.initCalcController=function(e){this.calcController=e},a.initLogin=function(e){this.login=e},a.initDataCenter=function(e){this.dataCenter=e},a.initHistoryDataCenter=function(e){this.historyDataCenter=e},a.initMessageCenter=function(e,t){this.messageCenter=e,this.messageCenterAdapter=t},a.initOfflineEdit=function(e){this.offlineEdit=e},a.initOfflineOpen=function(e){this.offlineOpen=e},a.initUndoRedoStack=function(e){this.undoredoStack=e},a.initRequestApi=function(e){this.requestApi=e},a.initView=function(e){this.view=e},a.initServiceCollection=function(e){this.serviceCollection=e},a.initFeature=function(e){this.feature=e},a.initEditFeature=function(e){this.editFeature=e},a.setSheetExportManagerLoader=function(e){this.sheetExportManagerLoader=e},a.getSheetExportManager=function(){return u(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.sheetExportManagerLoader.getInstance(this));case 1:case"end":return e.stop()}}),e,this)})))},a.getCurrentMainThreadWorker=function(){return this.mainThreadWorker},a.initPlugins=function(e){this.plugins=e},a.initInstantiationService=function(e){this.instantiationService=e},a.initAppConfigInstance=function(e){this.appConfigInstance=e},a.initSheetAdapterManager=function(e){this.sheetAdapterManager=e},(0,r.Z)(t,[{key:"EVENT",get:function(){return t.EVENT}}]),t}(a.Z);c.EVENT={PAGE_LOAD_START:"PAGE_LOAD_START",SPREAD_SHEET_SDK_CORE_START:"SPREAD_SHEET_SDK_CORE_START",SPREAD_SHEET_SDK_CORE_END:"SPREAD_SHEET_SDK_CORE_END",SPREAD_SHEET_PART_INTERACTIVE_START:"SPREAD_SHEET_PART_INTERACTIVE_START",SPREAD_SHEET_PART_INTERACTIVE_END:"SPREAD_SHEET_PART_INTERACTIVE_END",SPREAD_SHEET_MESSAGE_START:"SPREAD_SHEET_MESSAGE_START",SPREAD_SHEET_MESSAGE_END:"SPREAD_SHEET_MESSAGE_END",SPREAD_SHEET_ALL_CHUNK_READY:"SPREAD_SHEET_ALL_CHUNK_READY",SPREAD_SHEET_REQUEST_API_READY:"SPREAD_SHEET_REQUEST_API_READY",SPREAD_SHEET_EDITABLE:"SPREAD_SHEET_EDITABLE",SPREAD_SHEET_PLUGINS_START:"SPREAD_SHEET_PLUGINS_START",SPREAD_SHEET_PLUGINS_END:"SPREAD_SHEET_PLUGINS_END",PAGE_LOAD_FINISHED:"PAGE_LOAD_FINISHED",NEW_DOC_SPREAD_SHEET_PART_INTERACTIVE:"NEW_DOC_SPREAD_SHEET_PART_INTERACTIVE",DESTROY:"DESTROY",RESTART:"RESTART",START_DESTROY:"START_DESTROY",RESTART_END:"RESTART_END"},t.Z=c},"../spread-sheet/src/core/app/contributes/index.ts":function(e,t,n){"use strict";n.d(t,{Z:function(){return s}}),n("../node_modules/core-js/modules/es.function.name.js");var r=n("../node_modules/@tencent/doc-contribute/dist/contributes.js"),o=n.n(r),s=function(){function e(){}var t=e.prototype;return t.getContribute=function(e){return o().getContribute(e)},t.setContribute=function(e){var t=e.name,n=e.json,r=e.context;return o().setContribute({name:t,json:n,context:r})},t.updateContribute=function(e){var t=e.name,n=e.context;return o().updateContribute({name:t,context:n})},e}()},"../spread-sheet/src/core/app/contributes/interface.ts":function(e,t,n){"use strict";n.d(t,{T:function(){return r}});var r=(0,n("../node_modules/@tencent/containerized/build/main/index.js").yh)("IContributesService")},"../spread-sheet/src/core/app/doc-performance.ts":function(e,t,n){"use strict";n.d(t,{Es:function(){return p},hX:function(){return a}}),n("../node_modules/core-js/modules/es.array.slice.js"),n("../node_modules/core-js/modules/es.array.from.js"),n("../node_modules/core-js/modules/es.symbol.description.js"),n("../node_modules/core-js/modules/es.symbol.iterator.js");var r=n("../node_modules/@babel/runtime/helpers/esm/createClass.js");function o(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){if(e){if("string"===typeof e)return s(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?s(e,t):void 0}}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0;return function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function s(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}n("../node_modules/core-js/modules/es.symbol.js"),n("../node_modules/core-js/modules/es.function.name.js"),n("../node_modules/core-js/modules/web.url.to-json.js"),n("../node_modules/core-js/modules/es.regexp.exec.js"),n("../node_modules/core-js/modules/es.string.split.js"),n("../node_modules/core-js/modules/es.array.filter.js"),n("../node_modules/core-js/modules/es.object.keys.js"),n("../node_modules/core-js/modules/es.object.get-prototype-of.js"),n("../node_modules/core-js/modules/es.array.sort.js"),n("../node_modules/core-js/modules/web.dom-collections.for-each.js"),n("../node_modules/core-js/modules/es.object.assign.js"),n("../node_modules/core-js/modules/es.array.map.js"),n("../node_modules/core-js/modules/es.array.iterator.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.string.iterator.js"),n("../node_modules/core-js/modules/web.dom-collections.iterator.js"),n("../node_modules/core-js/modules/web.url.js"),n("../node_modules/core-js/modules/web.url-search-params.js"),n("../node_modules/core-js/modules/es.array.includes.js"),n("../node_modules/core-js/modules/es.string.includes.js");var i,a,l=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(n[r[o]]=e[r[o]])}return n};!function(e){e.MARK="mark",e.LIFE_CYCLE="lifeCycle",e.RESOURCE="resource",e.CGI="cgi",e.IMG="img",e.MEASURE="measure"}(i||(i={})),function(e){e.LCP="LCP",e.TTI="TTI",e.TTE="TTE",e.HTML="html",e.OPEN_DOC="opendoc",e.PAGE_LOAD_FINISHED="PAGE_LOAD_FINISHED",e.ENTRY_START="entryStart"}(a||(a={}));var d,u={xmlhttprequest:i.CGI,img:i.IMG,script:i.RESOURCE},c=[window.location.host];!function(e){e[e.low=0]="low",e[e.high=1]="high"}(d||(d={}));var h=[{name:"https://"+window.location.host+"/dop-api/opendoc",alias:"opendoc",weight:d.high}],f=function(){function e(e,t,n,r,o){var s,i;this.name=e,this.entryType=t,this.startTime=n,this.duration=r,this.alias=null!==(s=null===o||void 0===o?void 0:o.alias)&&void 0!==s?s:this.autoGenerateAlias(e),this.weight=null!==(i=null===o||void 0===o?void 0:o.weight)&&void 0!==i?i:d.low,this.decodedBodySize=null===o||void 0===o?void 0:o.decodedBodySize,this.encodedBodySize=null===o||void 0===o?void 0:o.encodedBodySize,this.transferSize=null===o||void 0===o?void 0:o.transferSize}var t=e.prototype;return t.setEndTime=function(e){this.duration=e-this.startTime},t.toJSON=function(){var e,t,n,r,o;return{name:null!==(e=this.name)&&void 0!==e?e:this.alias,alias:null!==(t=this.alias)&&void 0!==t?t:this.name,entryType:this.entryType,startTime:this.startTime,endTime:this.startTime+this.duration,duration:this.duration,weight:this.weight,decodedBodySize:null!==(n=this.decodedBodySize)&&void 0!==n?n:0,encodedBodySize:null!==(r=this.encodedBodySize)&&void 0!==r?r:0,transferSize:null!==(o=this.transferSize)&&void 0!==o?o:0}},t.autoGenerateAlias=function(e){var t=e;switch(this.entryType){case i.RESOURCE:var n=e.lastIndexOf("/");n>0&&(t=e.substring(n+1)),t=this.generateMaxLengthAlias(t);break;case i.CGI:var r=e.lastIndexOf("?");r>0&&(t=e.substring(0,r));break;case i.IMG:var o=e.lastIndexOf("?");o>0&&(t=e.substring(0,o))}return t},t.generateMaxLengthAlias=function(e){var t=e.split("~");if(e.length>50&&t.length>0){for(var n=t[t.length-1],r=t.length-2;r>=0&&!(n.length+t[r].length>50);r--)n=t[r]+"~"+n;return n}return e},(0,r.Z)(e,[{key:"endTime",get:function(){return this.startTime+this.duration}}]),e}(),p=function(){function e(){this.customEntries=[],this.performanceTimingKeys=Object.keys(Object.getPrototypeOf(this.getPerformanceTiming())).filter((function(e){return"toJSON"!==e})),this.initPerformanceSettings()}var t=e.prototype;return t.getEntries=function(){return this.customEntries.sort((function(e,t){return e.startTime-t.startTime}))},t.getEntriesByName=function(e,t){return this.getEntries().filter((function(n){return(n.name===e||n.alias===e)&&(!t||n.entryType===t)}))},t.getEntryByName=function(e,t){var n;return null===(n=this.getEntriesByName(e,t))||void 0===n?void 0:n[0]},t.getEntriesByType=function(e,t){return void 0===t&&(t=d.low),this.getEntries().filter((function(n){return n.entryType===e&&n.weight>=t}))},t.getEntryByType=function(e){var t;return null===(t=this.getEntriesByType(e))||void 0===t?void 0:t[0]},t.mark=function(e,t){var n,r;if(!t||void 0!==t.startTime){var o=new f(e,null!==(n=null===t||void 0===t?void 0:t.entryType)&&void 0!==n?n:i.MARK,null!==(r=null===t||void 0===t?void 0:t.startTime)&&void 0!==r?r:this.now(),0);return this.customEntries.push(o),o}},t.markLifeCycle=function(e,t){var n;return this.mark(e,{startTime:null!==(n=null===t||void 0===t?void 0:t.startTime)&&void 0!==n?n:this.now(),entryType:i.LIFE_CYCLE})},t.clearMarks=function(){this.clearEntriesByType(i.MARK)},t.measure=function(e,t){if(!t||void 0!==t.startTime||void 0!==t.endTime){var n=this.getPerformanceTiming().navigationStart,r=this.now(),o=null!==t&&void 0!==t?t:{},s=o.startTime,a=o.endTime,d=o.entryType,u=l(o,["startTime","endTime","entryType"]),c=new f(e,null!==d&&void 0!==d?d:i.MEASURE,null!==s&&void 0!==s?s:n,(null!==a&&void 0!==a?a:r)-(null!==s&&void 0!==s?s:n),u);return this.customEntries.push(c),c}},t.measureStart=function(e,t){var n=new f(e,i.MEASURE,t,0);return this.customEntries.push(n),n},t.measureEnd=function(e,t){var n=this.getEntriesByName(e,i.MEASURE);if(0===n.length)throw new Error("不存在 name 为"+e+"的 entry，请确认是否有先调用 measureStart。");if(n.length>1)throw new Error("存在多个 name 为"+e+"的 entry，请确认是否对同个 name 多次调用 measureStart。");return n[0].setEndTime(t),n},t.measureResource=function(e){var t=this;e.forEach((function(e){var n=u[e.initiatorType];if(n&&!t.filterByWhiteList(e)){var r=t.getPerformanceTiming().navigationStart+e.fetchStart,o=t.getPerformanceTiming().navigationStart+e.responseEnd,s=t.getResourceExternalInfo(e),i=s.alias,a=s.weight,l=e.decodedBodySize,d=e.encodedBodySize,c=e.transferSize;t.measure(e.name,{startTime:r,endTime:o,entryType:n,alias:i,weight:a,decodedBodySize:l,encodedBodySize:d,transferSize:c})}}))},t.clearMeasures=function(e){this.clearEntriesByType(i.MEASURE,e)},t.now=function(){return Date.now()},t.toJSON=function(){return Object.assign(Object.assign({},this.timing),{customEntries:this.customEntries})},t.getBeginTimestamp=function(){var e;return null!==(e=this.timing.clickStart)&&void 0!==e?e:this.timing.navigationStart},t.getElapsedTimes=function(){var e=this.getBeginTimestamp();return{LCP:this.getEntryStartTimeByName(a.LCP,e)-e,TTI:this.getEntryStartTimeByName(a.TTI,e)-e,TTE:this.getEntryStartTimeByName(a.TTE,e)-e,HTML:this.getEntryStartTimeByName(a.HTML,e)-e,OPENDOC:this.getEntryStartTimeByName(a.OPEN_DOC,e)-e,PAGE_LOAD_FINISHED:this.getEntryStartTimeByName(a.PAGE_LOAD_FINISHED,e)-e,ENTRY_START:this.getEntryStartTimeByName(a.ENTRY_START,e)-e}},t.getAllLogicEntries=function(){var e=this.timing,t=e.entryStart,n=e.PAGE_LOAD_FINISHED;return this.getEntries().filter((function(e){return e.startTime>=t&&e.startTime<=n})).map((function(e){return e.toJSON()}))},t.getAllLogicEntriesBeforeTTE=function(){var e=this.timing,t=e.entryStart,n=e.TTE;return this.getEntries().filter((function(e){return e.startTime>=t&&e.startTime<=n})).map((function(e){return e.toJSON()}))},t.getAllLogicEntriesBeforeEditable=function(){var e=this.timing,t=e.entryStart,n=e.SPREAD_SHEET_EDITABLE;return this.getEntries().filter((function(e){return e.startTime>=t&&e.startTime<=n})).map((function(e){return e.toJSON()}))},t.getAllEntriesByMark=function(e,t){var n,r,o=null!==(n=e&&this.timing[e])&&void 0!==n?n:this.getBeginTimestamp(),s=null!==(r=t&&this.timing[t])&&void 0!==r?r:this.now();return this.getEntries().filter((function(e){return e.startTime>=o&&e.startTime<=s})).map((function(e){return e.toJSON()}))},t.getAllEntriesBeforeTTE=function(){var e=this.timing.TTE;return this.getEntries().filter((function(t){return t.startTime<=e})).map((function(e){return e.toJSON()}))},t.getAllEntriesValue=function(){return this.getEntries().map((function(e){return e.toJSON()}))},t.getAllEntriesWithoutLowWeightResource=function(){var e=this;return this.getEntries().filter((function(t){return!e.isLowWeightResourceEntry(t)})).map((function(e){return e.toJSON()}))},t.clearEntriesByType=function(e,t){this.customEntries=this.customEntries.filter((function(n){return n.entryType!==e||!(!t||n.name===t)}))},t.filterByWhiteList=function(e){var t=[i.CGI,i.IMG],n=u[e.initiatorType];if(-1===t.indexOf(n))return!1;var r=new URL(e.name);return-1===c.indexOf(r.host)},t.getResourceExternalInfo=function(e){for(var t,n,r=o(h);!(n=r()).done;){var s=n.value;if(0===e.name.indexOf(s.name))return{alias:null!==(t=s.alias)&&void 0!==t?t:s.name,weight:s.weight}}return{weight:d.low}},t.isLowWeightResourceEntry=function(e){return e.weight!==d.low&&e.entryType===i.RESOURCE},t.getPerformanceTiming=function(){var e;return(null===(e=window.performance)||void 0===e?void 0:e.timing)?window.performance.timing:{navigationStart:this.now()}},t.getEntryStartTimeByName=function(e,t){var n,r;return null!==(r=null===(n=this.getEntryByName(e))||void 0===n?void 0:n.startTime)&&void 0!==r?r:t},t.initPerformanceSettings=function(){var e,t;window.performance&&(null===(t=(e=window.performance).setResourceTimingBufferSize)||void 0===t||t.call(e,2e3),window.performance.onresourcetimingbufferfull=this.onResourceTimingBufferFull.bind(this))},t.onResourceTimingBufferFull=function(){if(window.performance){var e=window.performance.getEntriesByType("resource");this.measureResource(e)}},(0,r.Z)(e,[{key:"timing",get:function(){var e=this,t=[i.MARK,i.LIFE_CYCLE],n=this.getEntries().filter((function(e){return t.includes(e.entryType)})).reduce((function(e,t){var n;return Object.assign(Object.assign({},e),((n={})[t.name]=t.startTime,n))}),{}),r=this.performanceTimingKeys.reduce((function(t,n){var r,o=e.getPerformanceTiming()[n];return Object.assign(Object.assign({},t),((r={})[n]=o,r))}),{});return Object.assign(Object.assign({},r),n)}}]),e}()},"../spread-sheet/src/core/app/event-init.ts":function(e,t,n){"use strict";n("../node_modules/regenerator-runtime/runtime.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.promise.js"),n("../node_modules/core-js/modules/es.array.slice.js"),n("../node_modules/core-js/modules/es.function.name.js"),n("../node_modules/core-js/modules/es.array.from.js"),n("../node_modules/core-js/modules/es.string.iterator.js"),n("../node_modules/core-js/modules/es.symbol.js"),n("../node_modules/core-js/modules/es.symbol.description.js"),n("../node_modules/core-js/modules/es.symbol.iterator.js"),n("../node_modules/core-js/modules/es.array.iterator.js"),n("../node_modules/core-js/modules/web.dom-collections.iterator.js");var r=n("../packages/model/src/cell/CellDataDelta.ts"),o=n("../packages/model/src/cell/CellDataSlot.ts"),s=n("../packages/mutation/src/cell/SetCellPropertiesMutation.ts"),i=n("../packages/model/src/cell/CellFormatSlot.ts"),a=n("../packages/model/src/cell/CellData.ts"),l=n("../packages/mutation/src/MutationId.ts"),d=n("../spread-sheet/src/base/util/timer.ts"),u=n("../packages/report/src/index.ts"),c=n("../spread-sheet/src/base/event/eventName.ts"),h=n("../packages/model/src/workbookRange/WorkbookRangeType.ts"),f=n("../spread-sheet/src/core/feature/formula/utils/parseUtil.ts"),p=n("../spread-sheet/src/base/event/event.ts"),g=n("../packages/model/src/sheet/index.ts"),m=n("../spread-sheet/src/external/view/mobile/header/native-header/api.ts"),v=n("../spread-sheet/src/external/view/mobile/header/native-header/utils.ts"),I=n("../spread-sheet/src/base/error/index.ts"),E=n("../spread-sheet/src/core/app/utils.ts");function S(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){if(e){if("string"===typeof e)return R(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?R(e,t):void 0}}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0;return function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function R(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}n("../spread-sheet/src/base/util/domain-config.ts");var w=function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function i(e){try{l(r.next(e))}catch(t){s(t)}}function a(e){try{l(r.throw(e))}catch(t){s(t)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,a)}l((r=r.apply(e,t||[])).next())}))},A=function(){function e(e){this.parent=e,this.init()}var t=e.prototype;return t.init=function(){this.listenMutationRun(),this.listenUpdateCellDataDV(),this.listenUpdateCellDatFromFormula(),this.listenWorkrangeChange(),this.listenBeforeUnload(),this.listenUnload(),this.listenDataVersion(),this.listenDatabaseError()},t.initDataHandle=function(e,t){var n,r,o,s,i=e.mutation;for(n=0,o=i.lastCol;n<=o;n++)for(r=0,s=i.lastRow;r<=s;r++)t.autoUpdateCellData(i.sheetId,r,n)},t.setCellPropertiesHandle=function(e,t){var n,r,s,a,l=e.mutation,d=l.cellDataDelta,u=d.setSlots|d.clearSlots,c=d.delta.userEnteredFormatDelta?d.delta.userEnteredFormatDelta.setSlots|d.delta.userEnteredFormatDelta.clearSlots:0;if(0!==(u&1<<o.Z.SLOT_EFFIECTIVE_VALUE)||0!==(u&1<<o.Z.SLOT_FORMULA)||0!==(u&1<<o.Z.SLOT_DATA_VALIDATION_RULE)||0!==(c&1<<i.Z.NUMBER_FORMAT)){var h=l.gridRange;for(n=h.startRowIndex,s=h.endRowIndex;n<=s;n++)for(r=h.startColIndex,a=h.endColIndex;r<=a;r++)t.autoUpdateCellData(h.sheetId,n,r)}},t.setRangeHandle=function(e,t){for(var n,r,s=e.mutation,a=0,l=s.cellDataDeltaAtPositions.length;a<l;a++){var d=s.cellDataDeltaAtPositions[a].cellDataDelta;n=d.setSlots|d.clearSlots,(0,f.E)({cellDataDelta:d,spreadsheet:t,sheetId:s.gridRange.sheetId,rowIndex:s.cellDataDeltaAtPositions[a].rowIndex,colIndex:s.cellDataDeltaAtPositions[a].colIndex});var u=s.cellDataDeltaAtPositions[a].cellDataDelta.delta.userEnteredFormatDelta;r=u?u.setSlots|u.clearSlots:0,0===(n&1<<o.Z.SLOT_EFFIECTIVE_VALUE)&&0===(n&1<<o.Z.SLOT_FORMULA)&&0===(n&1<<o.Z.SLOT_DATA_VALIDATION_RULE)&&0===(r&1<<i.Z.NUMBER_FORMAT)||t.autoUpdateCellData(s.gridRange.sheetId,s.cellDataDeltaAtPositions[a].rowIndex,s.cellDataDeltaAtPositions[a].colIndex)}},t.setSheetPropertiesHandle=function(e){var t=e.mutation,n=e.isCollab,r=t.sheetDelta,o=t.sheetId;if(r)for(var s,i=S(r.deltas);!(s=i()).done;){var a=s.value;a.slotName===g.NEW_SHEET_PROPERTIES_SLOT.SLOT_HIDE&&a.value&&p.ZP.sheetsBar.trigger("listenHideSheetEvent",{sheetId:o,isCollab:n})}},t.deleteSheetHandle=function(e){var t=e.mutation;e.isCollab&&t.sheetId===this.parent.spreadsheet.activeSheetId&&p.ZP.sheetsBar.trigger("listenDelSheetEvent")},t.insertDimensionHandle=function(e){var t=e.mutation;p.ZP.rangeAuthEvent.trigger("dimensionChange",{sType:e.sType,sheetId:t.sheetId})},t.deleteDimensionHandle=function(e){var t=e.mutation;p.ZP.rangeAuthEvent.trigger("dimensionChange",{sType:e.sType,sheetId:t.sheetId})},t.defineWorkbookRangeHandle=function(e){var t=e.mutation;t.workbookRangeType===h.Z.PROTECTED_RANGE&&p.ZP.rangeAuthEvent.trigger("addNewRangeAuth",{sType:e.sType,sheetId:t.gridRange.sheetId,rangeId:t.workbookRangeId})},t.deleteWorkbookRangeHandle=function(e){var t=e.mutation;t.workbookRangeType===h.Z.PROTECTED_RANGE&&p.ZP.rangeAuthEvent.trigger("deleteRangeAuth",{sType:e.sType,rangeId:t.workbookRangeId})},t.updateWorkbookRangeHandle=function(e){var t=e.mutation;t.workbookRangeType===h.Z.PROTECTED_RANGE&&p.ZP.rangeAuthEvent.trigger("updateRangeAuth",{sType:e.sType,sheetId:t.gridRange.sheetId})},t.listenMutationRun=function(){var e,t=this,n=((e={})[l.ZP.INIT_DATA_MUTATION]=this.initDataHandle.bind(this),e[l.ZP.SET_CELL_PROPERTIES_MUTATION]=this.setCellPropertiesHandle.bind(this),e[l.ZP.SET_RANGE_MUTATION]=this.setRangeHandle.bind(this),e[l.ZP.SET_SHEET_PROPERTIES_MUTATION]=this.setSheetPropertiesHandle.bind(this),e[l.ZP.DELETE_SHEET_MUTATION]=this.deleteSheetHandle.bind(this),e[l.ZP.INSERT_DIMENSION_MUTATION]=this.insertDimensionHandle.bind(this),e[l.ZP.DELETE_DIMENSION_MUTATION]=this.deleteDimensionHandle.bind(this),e[l.ZP.DEFINE_WORKBOOK_RANGE_MUTATION]=this.defineWorkbookRangeHandle.bind(this),e[l.ZP.DELETE_WORKBOOK_RANGE_MUTATION]=this.deleteWorkbookRangeHandle.bind(this),e[l.ZP.UPDATE_WORKBOOK_RANGE_MUTATION]=this.updateWorkbookRangeHandle.bind(this),e);this.parent.mutationBehavior.emitter.addListener(this.parent.mutationBehavior.EVENT.AFTER_MUTATION_RUN,(function(e){var r,o=t.parent.spreadsheet,s=e.mutation,i=s.id;n[i]&&n[i](e,o),(null===(r=t.parent.view)||void 0===r?void 0:r.canvas)&&!e.isIgnoreDataCallView&&p.ZP.spreadsheetEvent.trigger("renderAfterMutationRun",e),t.parent.calcController||t.parent.data.initMutations.push(s)}))},t.listenUpdateCellDataDV=function(){var e=this;p.ZP.spreadsheetEvent.listen("updateCellDataDV",(function(t){var n=new r.Z;"undefined"!==typeof t.dataValidation?n.setSlot(o.Z.SLOT_DATA_VALIDATION_RULE,t.dataValidation):n.clearSlot(o.Z.SLOT_DATA_VALIDATION_RULE);var i=new s.Z({gridRange:t.gridRange,cellDataDelta:n});e.parent.mutationBehavior.applyMutation(i,{isLocal:!0})}))},t.listenUpdateCellDatFromFormula=function(){var e=this;p.ZP.spreadsheetEvent.listen("updateCellDataFromFormula",(function(t){e.parent.mutationBehavior.applyMutation(t,{isLocal:!0,isFromFormula:!0})}))},t.listenUnload=function(){var e=this;window.addEventListener("unload",(function(){(0,v.W)()&&m.n.hideButtonsBeforeJump(),e.OfflineEditShutDown()}))},t.OfflineEditShutDown=function(){var e;null===(e=this.parent.offlineEdit)||void 0===e||e.shutDown(!0)},t.listenBeforeUnload=function(){return w(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t,r=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=!1,d.Z.wait(15e3).run((function(){t&&u.ZP.monitor(33687112)})),window.addEventListener("beforeunload",(function(e){var o,s,i,a,l,d=r.parent;if(u.ZP.jank.log({moduleValue:"page",actionValue:"refresh"}),null===(i=null===(s=null===(o=d.view)||void 0===o?void 0:o.canvas)||void 0===s?void 0:s.inputManager)||void 0===i?void 0:i.isInputtingState())return t=!0,u.ZP.monitor(33687112),u.ZP.jank.log({}),e.returnValue="关闭表格将不会保存你所输入的内容，是否确认离开？";if(null===(l=null===(a=d.messageCenterAdapter)||void 0===a?void 0:a.sendMessageCenterAdapter)||void 0===l?void 0:l.hasUncommittedChanges()){if(u.ZP.monitor(35673239),u.ZP.jank.log({}),n.g.refreshReason===E.QU)return;return e.returnValue="文档存在未保存修改，如果关闭，修改将不会被保存。您是否确定关闭？"}}));case 3:case"end":return e.stop()}}),e)})))},t.listenWorkrangeChange=function(){var e=this;p.ZP.spreadsheetEvent.listen("afterKeyframeRun",(function(t){var n=t.sheetId,r=e.parent.spreadsheet.sheetManager.getSheetBySheetId(n);if(r){var o=r.sheetRangeManager;if(!o)return;o.each((function(e,t){for(var n=e.gridRange,o=n.startRowIndex,s=n.endRowIndex,i=n.startColIndex,l=n.endColIndex,d=o;d<=s;d++)for(var u=i;u<=l;u++){var c=r.getCellDataAtPosition(d,u);c||(c=new a.Z,r.setCellDataAtPosition(d,u,c)),c.addSheetRange(t,e.sheetRangeType)}}))}}))},t.listenDataVersion=function(){var e=this;this.parent.mutationBehavior.emitter.addListener(this.parent.mutationBehavior.EVENT.DATA_VERSION_TOO_LOW,(function(){u.ZP.monitor(33872862),e.parent.event.errorCode.trigger("errorCode",{type:"front",code:I.B.DATA_VERSION_TOO_LOW})}))},t.listenDatabaseError=function(){var e=this;p.ZP.spreadsheetEvent.listen(c.W1.DATABASE_ERROR,(function(){e.parent.messageCenter.shutDown(I.B.DATABASE_ERROR)}))},e}();t.Z=A},"../spread-sheet/src/core/app/permissions/index.ts":function(e,t,n){"use strict";n.d(t,{H:function(){return c},P:function(){return h}});var r,o=n("../node_modules/@babel/runtime/helpers/esm/createClass.js"),s=(n("../node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),n("../node_modules/core-js/modules/esnext.reflect.metadata.js"),n("../node_modules/core-js/modules/es.array.includes.js"),n("../node_modules/core-js/modules/es.string.includes.js"),n("../spread-sheet/src/core/app/sheetStatus/index.ts")),i=n("../node_modules/@tencent/containerized/build/main/index.js"),a=n("../spread-sheet/src/core/data/configService/spreadConfig.ts"),l=function(e,t,n,r){var o,s=arguments.length,i=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)i=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(i=(s<3?o(i):s>3?o(t,n,i):o(t,n))||i);return s>3&&i&&Object.defineProperty(t,n,i),i},d=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},u=function(e,t){return function(n,r){t(n,r,e)}},c=(0,i.yh)("IPermissions"),h=function(){function e(e){this.sheetStatus=e}var t=e.prototype;return t.update=function(e){var t=!(!e.getConfig("canEdit")||e.getConfig("isPreview")),n=!!e.getConfig("canCopy"),r=!!e.getConfig("canComment")&&!!e.getConfig("isLogin");this.sheetStatus.workbookStatus.status.setCanEdit(t),this.sheetStatus.workbookStatus.status.setCanCopy(n),this.sheetStatus.workbookStatus.status.setCanComment(r)},t.setWorkbookStatusCanEdit=function(e){this.sheetStatus.workbookStatus.status.setCanEdit(e);var t=a.q.getConfig("readerCanComment");this.setWorkbookStatusCanComment(1===t||e)},t.setWorkbookStatusCanCopy=function(e){this.sheetStatus.workbookStatus.status.setCanCopy(e)},t.setWorkbookStatusCanComment=function(e){this.sheetStatus.workbookStatus.status.setCanComment(e)},t.setWorkbookStatusFull=function(e){this.sheetStatus.workbookStatus.status.setFull(e)},t.setSheetsStatus=function(e,t,n){this.sheetStatus.sheetsStatus.setSheetsStatus(e,t),e===n&&this.sheetStatus.sheetsStatus.emitSheetsStatusChange(e)},t.resetSheetsStatus=function(e){this.sheetStatus.sheetsStatus.resetSheetStatus(e),this.sheetStatus.sheetsStatus.emitSheetsStatusChange(e)},t.activeTempStatus=function(e,t){var r;void 0===t&&(t={isHistory:!1}),null===(r=n.g.log)||void 0===r||r.warn("call activeTempStatus 激活临时权限",e),this.sheetStatus.tempStatus.status.setHistory(t.isHistory),this.sheetStatus.tempStatus.status.activated().setCanEdit(e);var o=a.q.getConfig("readerCanComment");this.sheetStatus.tempStatus.status.setCanComment(1===o||e)},t.activeShutdownStatus=function(e){var t;null===(t=n.g.log)||void 0===t||t.warn("call activeShutdownStatus 激活Shutdown状态",e),this.sheetStatus.shutDownStatus.status.activated().setCanEdit(e)},t.unactiveTempStatus=function(){var e;null===(e=n.g.log)||void 0===e||e.warn("call unactiveTempStatus 取消临时权限");var t=a.q.getConfig("canEdit");this.sheetStatus.tempStatus.status.setCanEdit(t),this.sheetStatus.tempStatus.status.setHistory(!1),this.sheetStatus.tempStatus.status.unactivated()},t.setWorkbookStatusOnline=function(e){this.sheetStatus.workbookStatus.status.setOnline(e)},t.setRangeStatusCanEdit=function(e){this.sheetStatus.rangesStatus.status.canEdit!==e&&this.sheetStatus.rangesStatus.status.setCanEdit(e)},t.setRangeStatusCanRead=function(e){this.sheetStatus.rangesStatus.status.canRead!==e&&this.sheetStatus.rangesStatus.status.setCanRead(e)},t.addRangeAuthAndCache=function(e,t,n){this.sheetStatus.rangesStatus.addRangeAuthAndCache(e,t,n)},t.updateRangeAuthCacheStatus=function(e,t,n){this.sheetStatus.rangesStatus.updateRangeAuthCacheStatus(e,t,n)},t.refreshRangeAuthCache=function(e,t){this.sheetStatus.rangesStatus.refreshRangeAuthCache(e,t)},t.resetRangeStatusBySheetId=function(e){this.sheetStatus.rangesStatus.resetRangeStatusBySheetId(e)},t.registerCaller=function(e){this.callers.includes(e)||this.callers.push(e)},t.activeFrozen=function(e){this.sheetStatus.frozenStatus.activeFrozen(e)},t.unActiveFrozen=function(){this.sheetStatus.frozenStatus.unActiveFrozen()},(0,o.Z)(e,[{key:"events",get:function(){return e.EVENT}}]),e}();h.EVENT={CAN_EDIT_CHANGE:"0",CAN_COPY_CHANGE:"1",CAN_COMMENT_CHANGE:"2"},h=l([u(0,s.T),d("design:paramtypes",["function"===typeof(r="undefined"!==typeof s.T&&s.T)?r:Object])],h)},"../spread-sheet/src/core/app/permissions/permissionManage.ts":function(e,t,n){"use strict";n.d(t,{N:function(){return c},a:function(){return u}});var r,o=n("../node_modules/@babel/runtime/helpers/esm/inheritsLoose.js"),s=(n("../node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),n("../node_modules/core-js/modules/esnext.reflect.metadata.js"),n("../node_modules/core-js/modules/web.dom-collections.for-each.js"),n("../node_modules/@tencent/containerized/build/main/index.js")),i=n("../spread-sheet/src/core/app/sheetStatus/index.ts"),a=function(e,t,n,r){var o,s=arguments.length,i=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)i=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(i=(s<3?o(i):s>3?o(t,n,i):o(t,n))||i);return s>3&&i&&Object.defineProperty(t,n,i),i},l=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},d=function(e,t){return function(n,r){t(n,r,e)}},u=(0,s.yh)("IPermissionManage"),c=function(e){function t(t){var n;return(n=e.call(this)||this).sheetStatus=t,n.handleSheetStatusChange=function(){var e=n.getFocusStatus();e!==n.initialWorkbookStatus&&(n.initialWorkbookStatus=e,n.sheetStatus.canEditExceptRangeStatus?n.editableFnArray.forEach((function(e){e()})):n.readonlyFnArray.forEach((function(e){e()})))},n.readonlyFnArray=[],n.editableFnArray=[],n.sheetStatusChange(),n.initialWorkbookStatus=n.getFocusStatus(),n}(0,o.Z)(t,e);var n=t.prototype;return n.add=function(e,t){this.readonlyFnArray.push(e),this.editableFnArray.push(t)},n.dispose=function(){e.prototype.dispose.call(this),this.readonlyFnArray=[],this.editableFnArray=[],this.sheetStatus.offChange(this.handleSheetStatusChange)},n.sheetStatusChange=function(){this.sheetStatus.change(this.handleSheetStatusChange)},n.getFocusStatus=function(){var e=this.sheetStatus,t=e.workbookStatus,n=e.tempStatus,r=e.shutDownStatus,o=!0,s=!0;return n.status.activate&&(o=n.status.canEdit),r.status.activate&&(s=r.status.canEdit),t.canEdit&&o&&s},t}(s.JT);c=a([d(0,i.T),l("design:paramtypes",["function"===typeof(r="undefined"!==typeof i.T&&i.T)?r:Object])],c)},"../spread-sheet/src/core/app/sheetSize.ts":function(e,t,n){"use strict";n.d(t,{F:function(){return o}}),n("../node_modules/core-js/modules/es.array.iterator.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/web.dom-collections.iterator.js");var r={};function o(e){return r[e]||function(e){var t=window.SpreadsheetApp.spreadsheet.sheetManager.getSheetBySheetId(e),n={allNum:0,dataNum:0,isLarge:0};if(t){var o,s=t.getRowCount(),i=t.getColCount();n.allNum=s*i;for(var a=0;a<s;a++)if(o=t.data.rowData[a])for(var l=0;l<i;l++)o.values[l]&&(n.dataNum+=1);n.isLarge=n.dataNum>=1e4?1:0}r[e]=n}(e),r[e]}},"../spread-sheet/src/core/app/sheetStatus/Status.ts":function(e,t,n){"use strict";n.d(t,{q:function(){return s}});var r=n("../node_modules/@babel/runtime/helpers/esm/createClass.js"),o=(n("../node_modules/core-js/modules/es.object.assign.js"),n("../packages/lib/EventEmitter.ts")),s=function(){function e(){this.init()}var t=e.prototype;return t.init=function(){this.emitter=new o.Z,this.update()},t.update=function(){this.canEdit=!1,this.canRead=!0,this.canCopy=!1,this.canComment=!1,this.canUndo=!1,this.canRedo=!1,this.isPreview=!1,this.isFormPreview=!1,this.tempDisableEdit=!1,this.full=!1,this.activate=!0,this.isHistory=!1,this.isOnline=navigator.onLine},t.change=function(e){this.emitter.on(this.event.CHANGE,e)},t.offChange=function(e){this.emitter.off(this.event.CHANGE,e)},t.undoChange=function(e){this.emitter.on(this.event.UNDO_CHANGE,e)},t.offUndoChange=function(e){this.emitter.off(this.event.UNDO_CHANGE,e)},t.redoChange=function(e){this.emitter.on(this.event.REDO_CHANGE,e)},t.offRedoChange=function(e){this.emitter.off(this.event.REDO_CHANGE,e)},t.commentChange=function(e){this.emitter.on(this.event.COMMENT_CHANGE,e)},t.offCommentChange=function(e){this.emitter.off(this.event.COMMENT_CHANGE,e)},t.destroy=function(){this.emitter.off()},t.updateFromSheetMeta=function(e){var t=Object.assign({},this);this.isPreview=e.preview,this.isFormPreview=!!e.isFormPreview,this.emitter.emit(this.event.CHANGE,t,Object.assign(Object.assign({},this),{type:"preview"}))},t.setCanEdit=function(e){var t=Object.assign({},this);this.canEdit=e,this.emitter.emit(this.event.CHANGE,t,this,Object.assign(Object.assign({},this),{type:"edit"}))},t.setCanRead=function(e){var t=Object.assign({},this);this.canRead=e,this.emitter.emit(this.event.CHANGE,t,this,Object.assign(Object.assign({},this),{type:"read"}))},t.setCanCopy=function(e){var t=Object.assign({},this);this.canCopy=e,this.emitter.emit(this.event.COPY_CHANGE,t,Object.assign(Object.assign({},this),{type:"copy"}))},t.setHistory=function(e){this.isHistory=e},t.setCanComment=function(e){var t=Object.assign({},this);this.canComment=e,this.emitter.emit(this.event.COMMENT_CHANGE,t,Object.assign(Object.assign({},this),{type:"comment"}))},t.setCanUndo=function(e){var t=Object.assign({},this);this.canUndo=e,this.emitter.emit(this.event.UNDO_CHANGE,t,this)},t.setCanRedo=function(e){var t=Object.assign({},this);this.canRedo=e,this.emitter.emit(this.event.REDO_CHANGE,t,this)},t.setFull=function(e){var t=Object.assign({},this);this.full=e,this.emitter.emit(this.event.CHANGE,t,Object.assign(Object.assign({},this),{type:"full"}))},t.setOnline=function(e){var t=Object.assign({},this);this.isOnline=e,this.emitter.emit(this.event.CHANGE,t,Object.assign(Object.assign({},this),{type:"online"}))},t.unactivated=function(){return this.activate=!1,this},t.activated=function(){return this.activate=!0,this},(0,r.Z)(e,[{key:"event",get:function(){return e.EVENT}}]),e}();s.EVENT={CHANGE:"change",COMMENT_CHANGE:"commentChange",COPY_CHANGE:"copyChange",UNDO_CHANGE:"undoChange",REDO_CHANGE:"redoChange"}},"../spread-sheet/src/core/app/sheetStatus/auth-range.ts":function(e,t,n){"use strict";n.d(t,{I1:function(){return d},Nb:function(){return u},PC:function(){return p},SO:function(){return m},ft:function(){return g},qo:function(){return f},tE:function(){return l}}),n("../node_modules/core-js/modules/es.array.from.js"),n("../node_modules/core-js/modules/es.string.iterator.js"),n("../node_modules/core-js/modules/es.array.iterator.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/web.dom-collections.iterator.js"),n("../node_modules/core-js/modules/es.array.map.js"),n("../node_modules/core-js/modules/es.array.filter.js"),n("../node_modules/core-js/modules/web.dom-collections.for-each.js");var r=n("../packages/model/src/range/index.ts"),o=n("../spread-sheet/src/core/data/configService/spreadConfig.ts"),s=n("../spread-sheet/src/core/feature/formula/utils/parseUtil.ts"),i=n("../spread-sheet/src/core/feature/formula/utils.ts"),a=n("../spread-sheet/src/core/app/sheetStatus/ranges.ts");function l(e,t,n,s){var i,l,d,u;if(void 0===s&&(s=e.spreadsheet.activeSheetId),o.q.getConfig("isOwner"))return!1;var f=null===(i=e.sheetStatus)||void 0===i?void 0:i.sheetsStatus.getSheetStatus(s);if(void 0===f?h(e,s):!f.canRead)return!0;var p=null===(l=e.sheetStatus)||void 0===l?void 0:l.rangesStatus.rangeAuthMatrix;return!((null===(u=null===(d=null===p||void 0===p?void 0:p[s])||void 0===d?void 0:d[t])||void 0===u?void 0:u[n])?p[s][t][n]!==a.BP.CAN_NOT_VIEW:f||!c(e,new r.GridRange(s,t,t,n,n)))}function d(e,t,n,s){var i,l,d,u;if(void 0===s&&(s=e.spreadsheet.activeSheetId),o.q.getConfig("isOwner"))return!1;if(!o.q.getConfig("canEdit"))return!0;var f=null===(i=e.sheetStatus)||void 0===i?void 0:i.sheetsStatus.getSheetStatus(s);if(void 0===f?h(e,s):!f.canEdit)return!0;var p=null===(l=e.sheetStatus)||void 0===l?void 0:l.rangesStatus.rangeAuthMatrix;return!((null===(u=null===(d=null===p||void 0===p?void 0:p[s])||void 0===d?void 0:d[t])||void 0===u?void 0:u[n])?p[s][t][n]===a.BP.EDITABLE:f||!c(e,new r.GridRange(s,t,t,n,n)))}function u(e,t){return Array.from(e.spreadsheet.workbookRangeManager.protectedRangeMap.values()).some((function(n){var r=n.range;return t.some((function(t){var n=r.getCross(t);return!!n&&l(e,n.startRowIndex,n.startColIndex,t.sheetId)}))}))}function c(e,t){var n=e.spreadsheet.workbookRangeManager;return Array.from(n.protectedRangeMap.values()).some((function(e){var n=e.range,r=e.properties;return n.contain(t)&&r.otherPrivilege===a.mA.CAN_NOT_VIEW}))}function h(e,t){void 0===t&&(t=e.spreadsheet.activeSheetId);var n=e.spreadsheet.workbookRangeManager;return Array.from(n.protectedRangeMap.values()).some((function(e){var n=e.range,r=e.properties;return n.isSheet&&n.sheetId===t&&r.otherPrivilege===a.mA.CAN_NOT_VIEW}))}function f(e,t){return void 0===t&&(t=e.spreadsheet.activeSheetId),h(e,t)&&l(e,0,0,t)}function p(e){var t=e.spreadsheetReference.workbookRangeManager;return Array.from(t.protectedRangeMap.values()).filter((function(t){var n=t.range;return n.sheetId===e.getSheetId()&&l(e.spreadsheetReference.parent,n.isCol?0:n.startRowIndex,n.isRow?0:n.startColIndex,n.sheetId)})).map((function(e){return e.range}))}function g(e){var t=e.spreadsheetReference.workbookRangeManager;return Array.from(t.protectedRangeMap.values()).some((function(t){var n=t.range,r=t.properties;return n.sheetId===e.getSheetId()&&r.otherPrivilege===a.mA.CAN_NOT_VIEW}))}function m(e,t){var n={currentUserCanNotRead:!1,otherUserMayCanNotRead:!1};if(!e.spreadsheet.workbookRangeManager.protectedRangeMap.size)return n;var o=e.spreadsheet.activeSheetId;if(!(0,i.jr)(t))return n;var a=(0,s.EG)(t,0,0,o);return a.hasReferenceError||a.getAllCellRangeWithFixedInfo().forEach((function(t){var s=t.startRowIndex,i=t.endRowIndex,a=t.startColIndex,l=t.endColIndex,d=t.startSheetId,h=t.isRowArray,f=t.isColArray,p=t.isSheetReferenceCorrect,g=t.isThreeDimensionalReference;if(!p||g)return!1;var m=new r.GridRange(d||o,f?r.DEFAULT_DIMENSION_INDEX:s,f?r.DEFAULT_DIMENSION_INDEX:i,h?r.DEFAULT_DIMENSION_INDEX:a,h?r.DEFAULT_DIMENSION_INDEX:l);n.currentUserCanNotRead=n.currentUserCanNotRead||u(e,[m]),n.otherUserMayCanNotRead=n.otherUserMayCanNotRead||c(e,m)})),n}},"../spread-sheet/src/core/app/sheetStatus/index.ts":function(e,t,n){"use strict";n.d(t,{T:function(){return A},Z:function(){return y}});var r=n("../node_modules/@babel/runtime/helpers/esm/createClass.js"),o=(n("../node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),n("../node_modules/core-js/modules/esnext.reflect.metadata.js"),n("../node_modules/@tencent/containerized/build/main/index.js")),s=n("../packages/model/src/range/index.ts"),i=n("../spread-sheet/src/core/app/SpreadsheetApp.interface.ts"),a=function(){function e(){this.isActive=!1}var t=e.prototype;return t.activeFrozen=function(e){this.isActive=!0,this.fronzenHandle=e},t.unActiveFrozen=function(){this.isActive=!1,this.fronzenHandle=null},t.checkFrozenStatus=function(){return!this.isActive||(this.triggerFrozenHandle(),!1)},t.triggerFrozenHandle=function(){var e,t;null===(e=this.fronzenHandle)||void 0===e||e.call(this),null===(t=n.g.log)||void 0===t||t.warn("用户操作被临时冻结拦截")},e}(),l=n("../spread-sheet/src/core/app/sheetStatus/Status.ts"),d=function(){function e(e){this.app=e,this.status=new l.q}var t=e.prototype;return t.isRangeCanEdit=function(e){var t=this.app.spreadsheet.activeSheet,n=t.getRowCount(),r=t.highWaterMark.getMark();return r===n-1||!(e.endRowIndex>r)&&!t.mergeManager.mergeList.some((function(t){return t.isCross(e)&&t.endRowIndex>r}))},t.update=function(){this.status.update()},t.destroy=function(){this.status.destroy()},t.change=function(e){this.status.change(e)},t.offChange=function(e){this.status.offChange(e)},(0,r.Z)(e,[{key:"isCurrSelectionCanEdit",get:function(){var e=this,t=this.app.view;if(this.app.spreadsheet.isExternalSheet())return!0;var n=null===t||void 0===t?void 0:t.getSelection(),r=!n||n.rangeSelections.every((function(t){return e.isRangeCanEdit(t)}));return r!==this.status.canEdit&&this.status.setCanEdit(r),r}}]),e}(),u=n("../spread-sheet/src/core/app/sheetStatus/private-range.ts"),c=n("../spread-sheet/src/core/app/sheetStatus/auth-range.ts"),h=n("../spread-sheet/src/core/app/sheetStatus/ranges.ts"),f=n("../packages/lib/EventEmitter.ts"),p=function(){function e(e){this.init(e)}var t=e.prototype;return t.init=function(e){this.canEdit=!1,this.canRead=!0,this.sheetId=e},t.setCanEdit=function(e){this.canEdit=e},t.setCanRead=function(e){this.canRead=e},e}(),g=function(){function e(){this.status={},this.emitter=new f.Z}var t=e.prototype;return t.update=function(){this.status={}},t.change=function(t){this.emitter.on(e.EVENT.CHANGE,t)},t.offChange=function(t){this.emitter.off(e.EVENT.CHANGE,t)},t.destroy=function(){this.status={},this.emitter.off()},t.setSheetsStatus=function(e,t){var n=void 0===this.status[e]?this.createSheetsStatus(e):this.status[e];n.setCanEdit(t===h.BP.EDITABLE),n.setCanRead(t!==h.BP.CAN_NOT_VIEW)},t.emitSheetsStatusChange=function(t){this.emitter.emit(e.EVENT.CHANGE,t)},t.getSheetStatus=function(e){return this.status[e]},t.getActiveSheetStatus=function(){var e=n.g.SpreadsheetApp.spreadsheet.activeSheetId;return this.getSheetStatus(e)},t.resetSheetStatus=function(e){delete this.status[e]},t.createSheetsStatus=function(e){return this.status[e]=this.status[e]||new p(e),this.status[e]},e}();g.EVENT={CHANGE:"change"};var m,v=function(){function e(){this.status=new l.q,this.init()}var t=e.prototype;return t.init=function(){this.status.unactivated()},t.update=function(){this.status.update(),this.status.unactivated()},e}(),I=function(){function e(){this.status=new l.q,this.init()}var t=e.prototype;return t.init=function(){this.status.unactivated()},t.update=function(){this.status.update(),this.status.unactivated()},e}(),E=function(){function e(){this.status=new l.q}return e.prototype.update=function(){this.status.update()},(0,r.Z)(e,[{key:"canEdit",get:function(){return this.status.canEdit}},{key:"canCopy",get:function(){return this.status.canCopy}},{key:"canComment",get:function(){return this.status.canComment}},{key:"isOnline",get:function(){return this.status.isOnline}}]),e}(),S=function(e,t,n,r){var o,s=arguments.length,i=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)i=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(i=(s<3?o(i):s>3?o(t,n,i):o(t,n))||i);return s>3&&i&&Object.defineProperty(t,n,i),i},R=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},w=function(e,t){return function(n,r){t(n,r,e)}},A=(0,o.yh)("ISheetStatus"),C=function(){function e(e){this.app=e,this.init()}var t=e.prototype;return t.init=function(){this.tempStatus=new I,this.sheetsStatus=new g,this.workbookStatus=new E,this.rangesStatus=new h.wL,this.shutDownStatus=new v,this.highWaterStatus=new d(this.app),this.frozenStatus=new a},t.update=function(){this.tempStatus.update(),this.sheetsStatus.update(),this.workbookStatus.update(),this.rangesStatus.update(),this.shutDownStatus.update(),this.highWaterStatus.update()},t.getStatusBySheetId=function(e){return this.sheetsStatus.status[e]},t.getActiveSheetStatus=function(){return this.sheetsStatus.getActiveSheetStatus()},t.change=function(e){var t;try{this.tempStatus.status.change(e),this.shutDownStatus.status.change(e),this.rangesStatus.status.change(e),this.sheetsStatus.change(e),this.workbookStatus.status.change(e),this.highWaterStatus.change(e)}catch(r){null===(t=n.g.log)||void 0===t||t.error("sheetStatus.change",null===r||void 0===r?void 0:r.stack)}},t.offChange=function(e){var t;try{this.tempStatus.status.offChange(e),this.shutDownStatus.status.offChange(e),this.rangesStatus.status.offChange(e),this.sheetsStatus.offChange(e),this.workbookStatus.status.offChange(e),this.highWaterStatus.offChange(e)}catch(r){null===(t=n.g.log)||void 0===t||t.error("sheetStatus.offChange",null===r||void 0===r?void 0:r.stack)}},t.undoChange=function(e){var t;try{this.tempStatus.status.undoChange(e),this.workbookStatus.status.undoChange(e)}catch(r){null===(t=n.g.log)||void 0===t||t.error("sheetStatus.undoChange",null===r||void 0===r?void 0:r.stack)}},t.offUndoChange=function(e){var t;try{this.tempStatus.status.offUndoChange(e),this.workbookStatus.status.offUndoChange(e)}catch(r){null===(t=n.g.log)||void 0===t||t.error("sheetStatus.offUndoChange",null===r||void 0===r?void 0:r.stack)}},t.redoChange=function(e){var t;try{this.tempStatus.status.redoChange(e),this.workbookStatus.status.redoChange(e)}catch(r){null===(t=n.g.log)||void 0===t||t.error("sheetStatus.redoChange",null===r||void 0===r?void 0:r.stack)}},t.offredoChange=function(e){var t;try{this.tempStatus.status.offRedoChange(e),this.workbookStatus.status.offRedoChange(e)}catch(r){null===(t=n.g.log)||void 0===t||t.error("sheetStatus.offredoChange",null===r||void 0===r?void 0:r.stack)}},t.commentChange=function(e){var t;try{this.workbookStatus.status.commentChange(e)}catch(r){null===(t=n.g.log)||void 0===t||t.error("sheetStatus.commentChange",null===r||void 0===r?void 0:r.stack)}},t.offCommentChange=function(e){var t;try{this.workbookStatus.status.offCommentChange(e)}catch(r){null===(t=n.g.log)||void 0===t||t.error("sheetStatus.offCommentChange",null===r||void 0===r?void 0:r.stack)}},t.destroy=function(){var e;try{this.tempStatus.status.destroy(),this.shutDownStatus.status.destroy(),this.sheetsStatus.destroy(),this.workbookStatus.status.destroy(),this.rangesStatus.destroy(),this.highWaterStatus.destroy()}catch(t){null===(e=n.g.log)||void 0===e||e.error("sheetStatus.destroy",null===t||void 0===t?void 0:t.stack)}},t.getRangeCanEdit=function(e){if(this.shutDownStatus.status.activate)return this.shutDownStatus.status.canEdit;if(this.tempStatus.status.activate)return this.tempStatus.status.canEdit;var t=!0,n=this.getStatusBySheetId(e.sheetId);return n&&(t=n.canEdit),this.rangesStatus.checkRangeStatus(e)===h.BP.EDITABLE&&this.workbookStatus.canEdit&&t},t.getRangeCanRead=function(e){var t=!0,n=this.getStatusBySheetId(e.sheetId);return n&&(t=n.canRead),this.rangesStatus.checkRangeStatus(e)!==h.BP.CAN_NOT_VIEW&&t},t.getRangeCanComment=function(e){return this.canComment},t.getRangeStatusBlockByBlock=function(e,t){return void 0===t&&(t=null),this.rangesStatus.getRangeStatusBlockByBlock(e,t)},t.isGridRangeSetRangeStatus=function(e,t){return this.rangesStatus.isGridRangeSetRangeStatus(e,t)},t.isCurrentRowCanEdit=function(e){var t=e.startRow,r=e.endRow,o=n.g.SpreadsheetApp.spreadsheet.getActiveSheetId(),i=new s.GridRange(o,t,r,s.DEFAULT_DIMENSION_INDEX,s.DEFAULT_DIMENSION_INDEX);return this.getRangeCanEdit(i)},t.isCurrentColCanEdit=function(e){var t=e.startCol,r=e.endCol,o=n.g.SpreadsheetApp.spreadsheet.getActiveSheetId(),i=new s.GridRange(o,s.DEFAULT_DIMENSION_INDEX,s.DEFAULT_DIMENSION_INDEX,t,r);return this.getRangeCanEdit(i)},t.isRangeCanEditByHighWater=function(e){return this.highWaterStatus.isRangeCanEdit(e)},t.isCellPrivate=function(e,t){return u.xy(this.app.spreadsheet,e,t)},t.containsPrivateRange=function(e){return void 0===e&&(e=this.app.view.getSelection().rangeSelections),u.Up(this.app.spreadsheet.workbookRangeManager,e)},t.containsPrivateCell=function(e){return void 0===e&&(e=this.app.view.getSelection().rangeSelections),u.fe(this.app.spreadsheet,e)},t.getPrivateRangeFirstLine=function(e){return void 0===e&&(e=this.app.view.getSelection().rangeSelections),u.II(this.app.spreadsheet.workbookRangeManager,e)},t.isInPrivateRange=function(e,t){return u._7(this.app.spreadsheet,e,t)},t.isCellCanNotRead=function(e,t){return c.tE(this.app,e,t)},t.containsCanNotReadRange=function(e){return void 0===e&&(e=this.app.view.getSelection().rangeSelections),c.Nb(this.app,e)},t.checkRangeStatus=function(e){var t=!0,n=this.getStatusBySheetId(e.sheetId);return n&&(t=n.canEdit),this.rangesStatus.checkRangeStatus(e)===h.BP.EDITABLE&&t},(0,r.Z)(e,[{key:"canEdit",get:function(){var e=!0,t=n.g.SpreadsheetApp.spreadsheet.activeSheetId,r=this.getStatusBySheetId(t);return r&&(e=r.canEdit),this.canEditExceptRangeStatus&&e&&this.rangesStatus.canEdit}},{key:"canEditExceptWorkbookStatus",get:function(){var e=!0;return this.shutDownStatus.status.activate?e=this.shutDownStatus.status.canEdit:this.tempStatus.status.activate&&(e=this.tempStatus.status.canEdit),e}},{key:"canEditExceptRangeStatus",get:function(){var e=!0;return this.shutDownStatus.status.activate?e=this.shutDownStatus.status.canEdit:this.tempStatus.status.activate&&(e=this.tempStatus.status.canEdit),e&&this.workbookStatus.canEdit&&this.highWaterStatus.isCurrSelectionCanEdit}},{key:"canComment",get:function(){return this.workbookStatus.status.canComment&&this.workbookStatus.status.isOnline}},{key:"canCopy",get:function(){return this.workbookStatus.status.canCopy}}]),e}(),y=C=S([w(0,i.m),R("design:paramtypes",["function"===typeof(m="undefined"!==typeof i.m&&i.m)?m:Object])],C)},"../spread-sheet/src/core/app/sheetStatus/ranges.ts":function(e,t,n){"use strict";n.d(t,{BP:function(){return r},mA:function(){return o},wL:function(){return d}});var r,o,s=n("../node_modules/@babel/runtime/helpers/esm/createClass.js"),i=(n("../node_modules/core-js/modules/web.dom-collections.for-each.js"),n("../node_modules/core-js/modules/es.object.entries.js"),n("../node_modules/core-js/modules/es.object.values.js"),n("../packages/model/src/range/GridRange.ts")),a=n("../spread-sheet/src/core/app/sheetStatus/Status.ts"),l=n("../spread-sheet/src/base/util/object.ts");n("../spread-sheet/src/base/util/domain-config.ts"),function(e){e[e.READ_ONLY=1]="READ_ONLY",e[e.EDITABLE=2]="EDITABLE",e[e.CAN_NOT_VIEW=3]="CAN_NOT_VIEW"}(r||(r={})),function(e){e[e.CAN_VIEW=1]="CAN_VIEW",e[e.CAN_NOT_VIEW=2]="CAN_NOT_VIEW"}(o||(o={}));var d=function(){function e(){this.rangeAuthMatrix={},this.rangeAuthCache={},this.status=new a.q,this.status.canEdit=!0,this.status.canRead=!0,this.computeBlockCacheInfo={}}var t=e.prototype;return t.update=function(){this.rangeAuthMatrix={},this.rangeAuthCache={},this.status.update(),this.status.canEdit=!0,this.status.canRead=!0,this.computeBlockCacheInfo={}},t.destroy=function(){this.update(),this.status.destroy()},t.resetRangeStatusBySheetId=function(e){this.rangeAuthMatrix[e]=[],this.rangeAuthCache[e]={},this.status.update(),this.status.canEdit=!0,this.status.canRead=!0,this.computeBlockCacheInfo[e]={valid:!1,info:[]}},t.getRangeAuthMatrixItem=function(e){return this.rangeAuthMatrix[e]||this.createRangeAuthMatrixItem(e)},t.getRangeAuthCacheItem=function(e){return this.rangeAuthCache[e]||this.createRangeAuthCacheItem(e)},t.refreshRangeAuthCache=function(e,t){var n=this;this.rangeAuthCache[e]={},Object.entries(t).forEach((function(t){var r=t[0],o=t[1],s=o.gridRange,i=o.rangeStatus;n.rangeAuthCache[e][r]={rangeStatus:i,gridRange:s.clone()}})),this.refreshRangeAuthMatrix(e)},t.getRangeStatusBlockByBlock=function(e,t){var n,r=[];return Array.isArray(this.rangeAuthMatrix[e])?null===t?(Object.values(this.rangeAuthCache[e]).forEach((function(e){r.push(e.gridRange.clone())})),r):(null===(n=this.computeBlockCacheInfo[e])||void 0===n?void 0:n.valid)?this.computeBlockCacheInfo[e].info:(r=this.getStatusByGreedMethod(this.rangeAuthMatrix[e],t,e),this.computeBlockCacheInfo[e]={valid:!0,info:r},r):r},t.addRangeAuthAndCache=function(e,t,n){t.isValid()&&(this.getRangeAuthCacheItem(t.sheetId)[e]={gridRange:t.clone(),rangeStatus:n},this.updateRangeAuthMatrix(t,n),this.addRangeAuthCacheItem(e,n,t))},t.checkRangeStatus=function(e){for(var t=this.convertGridRange(e),n=t.startRow,o=t.endRow,s=t.startCol,i=t.endCol,a=this.rangeAuthMatrix[e.sheetId],l=r.EDITABLE,d=n;d<=o;d++)if(a&&a[d]){if(l===r.CAN_NOT_VIEW)break;for(var u=s;u<=i;u++)if(a[d][u]){if(a[d][u]===r.CAN_NOT_VIEW){l=r.CAN_NOT_VIEW;break}a[d][u]===r.READ_ONLY&&(l=r.READ_ONLY)}}return l},t.isGridRangeSetRangeStatus=function(e,t){for(var n=this.convertGridRange(e),r=n.startRow,o=n.endRow,s=n.startCol,i=n.endCol,a=this.rangeAuthMatrix[e.sheetId],l=!1,d=r;d<=o;d++)if(a&&a[d]){if(l)break;for(var u=s;u<=i;u++)if(a[d][u]&&a[d][u]===t){l=!0;break}}return l},t.getCacheGridRangeByRangeId=function(e){for(var t=void 0,n=0,r=Object.entries(this.rangeAuthCache);n<r.length;n++){var o=r[n][1][e];if(void 0!==o){t=o.gridRange.clone();break}}return t},t.updateRangeAuthCacheStatus=function(e,t,n){var r=this.rangeAuthCache[t];(null===r||void 0===r?void 0:r[e])&&(r[e].rangeStatus=n)},t.convertGridRange=function(e){return{startRow:e.startRowIndex===i.v?0:e.startRowIndex,endRow:e.endRowIndex===i.v?this.getCurrentSheetRowCount():e.endRowIndex,startCol:e.startColIndex===i.v?0:e.startColIndex,endCol:e.endColIndex===i.v?this.getCurrentSheetColCount():e.endColIndex}},t.getCurrentSheetColCount=function(){return n.g.SpreadsheetApp.spreadsheet.activeSheet.getColCount()},t.getCurrentSheetRowCount=function(){return n.g.SpreadsheetApp.spreadsheet.activeSheet.getRowCount()},t.createRangeAuthCacheItem=function(e){return this.rangeAuthCache[e]=this.rangeAuthCache[e]||{},this.rangeAuthCache[e]},t.addRangeAuthCacheItem=function(e,t,n){var r=this.rangeAuthCache[n.sheetId];r||(r={},this.rangeAuthCache[n.sheetId]=r),r[e]={rangeStatus:t,gridRange:n.clone()}},t.createRangeAuthMatrixItem=function(e){return this.rangeAuthMatrix[e]=this.rangeAuthMatrix[e]||[],this.rangeAuthMatrix[e]},t.updateRangeAuthMatrix=function(e,t){if(!e.isSheet){for(var n=this.convertGridRange(e),r=n.startRow,o=n.endRow,s=n.startCol,i=n.endCol,a=r;a<=o;a++){var l=this.createRangeAuthMatrixItem(e.sheetId);l[a]||(l[a]=[]),this.updateRangeAuthMatrixInTencentDoc(l,s,i,a,t)}void 0!==this.computeBlockCacheInfo[e.sheetId]&&(this.computeBlockCacheInfo[e.sheetId].valid=!1)}},t.updateRangeAuthMatrixInTencentDoc=function(e,t,n,o,s){for(var i=t;i<=n;i++)e[o][i]&&e[o][i]===r.EDITABLE||(e[o][i]=s)},t.updateRangeAuthMatrixInWecom=function(e,t,n,o,s){for(var i=t;i<=n;i++)e[o][i]!==r.CAN_NOT_VIEW&&(e[o][i]===r.READ_ONLY&&s===r.EDITABLE||(e[o][i]=s))},t.refreshRangeAuthMatrix=function(e){var t=this;this.rangeAuthMatrix[e]=[];var n=this.rangeAuthCache[e];Object.values(n).forEach((function(e){t.updateRangeAuthMatrix(e.gridRange,e.rangeStatus)})),void 0!==this.computeBlockCacheInfo[e]&&(this.computeBlockCacheInfo[e].valid=!1)},t.getStatusByGreedMethod=function(e,t,n){var r=this,o=[],s=(0,l.deepClone)(e);return s.forEach((function(e,a){var l=-1,d=-1,u=-1,c=-1,h=e||[],f=h.length;h.forEach((function(e,h){var p=e===t,g=f===h+1;p&&(u=-1!==u?u:h,c=h,l=-1!==l?l:a,d=-1!==d?d:a);var m=function(e,t,n,r){return-1!==e&&-1!==t&&-1!==n&&-1!==r}(l,d,u,c);if((!p||g)&&m){for(var v=l;r.isRangeSameStatus(n,{startRow:v,endRow:v,startCol:u,endCol:c},t);)v+=1;d=Math.max(0,v-1),o.push(new i.Z(n,l,d,u,c)),function(e,t,n,r){for(var o=e;o<=t&&s[o];o++)for(var i=n;i<=r;i++)s[o][i]=null}(l,d,u,c),l=-1,d=-1,u=-1,c=-1}}))})),o},t.isRangeSameStatus=function(e,t,n){var r=!0,o=t.startRow,s=t.endRow,i=t.startCol,a=t.endCol,l=this.rangeAuthMatrix[e];if(!l)return r=!1;for(var d=o;d<=s&&(l[d]||(r=!1),r);d++)for(var u=i;u<=a;u++)if(!l[d][u]||l[d][u]!==n){r=!1;break}return r},(0,s.Z)(e,[{key:"canEdit",get:function(){return this.status.canEdit}},{key:"canRead",get:function(){return this.status.canRead}}]),e}();d.EVENT={CHANGE:"change",SET_OVERLAP_STATUS:"setOverlaptStatus"}},"../spread-sheet/src/core/ark-extensions/extensions/at-message-toast.ts":function(e,t,n){"use strict";n.d(t,{O:function(){return r}});var r={name:"docs-component-at-message-toast",loadType:n("../node_modules/@tencent/ark-extensions/lib/index.js").LoadType.IDLE,containerId:"docs-component-at-message-toast"}},"../spread-sheet/src/core/ark-extensions/extensions/attachment.ts":function(e,t,n){"use strict";n.d(t,{m:function(){return r}});var r={name:"docs-component-attachment",loadType:n("../node_modules/@tencent/ark-extensions/lib/index.js").LoadType.ON_DEMAND,containerId:"docs-component-attachment"}},"../spread-sheet/src/core/ark-extensions/extensions/collaboration.ts":function(e,t,n){"use strict";n.d(t,{M:function(){return r}});var r={name:"docs-component-collaboration",loadType:n("../node_modules/@tencent/ark-extensions/lib/index.js").LoadType.ON_DEMAND}},"../spread-sheet/src/core/ark-extensions/extensions/collaborator-detail-mobile.ts":function(e,t,n){"use strict";n.d(t,{x:function(){return r}});var r={name:"docs-component-collaborator-detail-mobile",loadType:n("../node_modules/@tencent/ark-extensions/lib/index.js").LoadType.ON_DEMAND}},"../spread-sheet/src/core/ark-extensions/extensions/mini-list.ts":function(e,t,n){"use strict";n.d(t,{h:function(){return r}});var r={name:"docs-component-mini-list",loadType:n("../node_modules/@tencent/ark-extensions/lib/index.js").LoadType.ON_DEMAND}},"../spread-sheet/src/core/ark-extensions/extensions/size-limit-dialog.ts":function(e,t,n){"use strict";n.d(t,{C2:function(){return i},XM:function(){return l},iR:function(){return r}});var r,o,s,i,a=n("../node_modules/@tencent/ark-extensions/lib/index.js");!function(e){e[e.MINIPROGRAM_CAN_NOT_PAY=-100]="MINIPROGRAM_CAN_NOT_PAY",e[e.SIZE_LIMIT_OWNER=100]="SIZE_LIMIT_OWNER",e[e.SIZE_LIMIT_COOPERATION_OWNER=101]="SIZE_LIMIT_COOPERATION_OWNER",e[e.SIZE_LIMIT_COOPERATION_COLLABOR=102]="SIZE_LIMIT_COOPERATION_COLLABOR",e[e.SIZE_LIMIT_TRANSFER=103]="SIZE_LIMIT_TRANSFER",e[e.SIZE_LIMIT_DUPLICATE_OWNER=104]="SIZE_LIMIT_DUPLICATE_OWNER",e[e.SIZE_LIMIT_DUPLICATE_COLLABOR=105]="SIZE_LIMIT_DUPLICATE_COLLABOR",e[e.SIZE_LIMIT_RECOVER_OWNER=106]="SIZE_LIMIT_RECOVER_OWNER",e[e.SIZE_LIMIT_RECOVER_COLLABOR=107]="SIZE_LIMIT_RECOVER_COLLABOR"}(r||(r={})),function(e){e[e.GO_TO_OPEN=1]="GO_TO_OPEN",e[e.KNOW_BUTTON=2]="KNOW_BUTTON"}(o||(o={})),function(e){e[e.BUTTON_CLOSE=3]="BUTTON_CLOSE",e[e.RIGHT_CLOSE=4]="RIGHT_CLOSE"}(s||(s={})),function(e){e[e.OWNER_CREATE_COPY=4]="OWNER_CREATE_COPY",e[e.OWNER_RECOVER=5]="OWNER_RECOVER",e[e.COLLABOR_RECOVER=6]="COLLABOR_RECOVER"}(i||(i={}));var l={name:"docs-component-size-limit-dialog",loadType:a.LoadType.ON_DEMAND}},"../spread-sheet/src/core/ark-extensions/extensions/subscription-notification.ts":function(e,t,n){"use strict";n.d(t,{a:function(){return r}});var r={name:"docs-component-subscription-notification",loadType:n("../node_modules/@tencent/ark-extensions/lib/index.js").LoadType.ON_DEMAND}},"../spread-sheet/src/core/behavior/api.interface.ts":function(e,t,n){"use strict";n.d(t,{V:function(){return r}});var r=(0,n("../node_modules/@tencent/containerized/build/main/index.js").yh)("IRequestApi")},"../spread-sheet/src/core/behavior/constants.ts":function(e,t,n){"use strict";n.d(t,{H:function(){return o},k:function(){return r}});var r=10485760,o=r+1},"../spread-sheet/src/core/behavior/index.ts":function(e,t,n){"use strict";var r,o=n("../packages/mutation/src/api.ts"),s=n("../packages/mutation/src/MutationId.ts"),i=n("../packages/mutation/src/MutationOperationType.ts"),a=n("../packages/mutation/src/dimension/SetDimensionPropertiesMutation.ts"),l=n("../packages/mutation/src/cell/SetRangeMutation.ts"),d=n("../packages/mutation/src/cell/SetCellPropertiesMutation.ts"),u=n("../spread-sheet/src/core/behavior/request/reorder/ReorderType.ts"),c=n("../spread-sheet/src/core/behavior/request/workbook/filterUtils/searchCloseDataArea.ts"),h=n("../spread-sheet/src/core/behavior/request/Type.ts");!function(e){e.MutationBehavior=o.Z,function(e){e.MUTATION_ID=s.ZP,e.MUTATION_OPERATION_TYPE=i.Z,e.SetRangeMutation=l.Z,e.SetCellPropertiesMutation=d.Z}(e.Mutation||(e.Mutation={})),function(e){e.REQUEST_ID=h.Z}(e.Request||(e.Request={})),function(e){e.ReorderType=u.Z,e.DIMENSION_PROPERTIES_SLOT=a.P8}(e.Interface||(e.Interface={})),function(e){e.searchCloseDataArea=c.ZP}(e.Utils||(e.Utils={}))}(r||(r={})),t.Z=r},"../spread-sheet/src/core/behavior/request/Request.ts":function(e,t,n){"use strict";n.d(t,{Z:function(){return k}}),n("../node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),n("../node_modules/core-js/modules/esnext.reflect.metadata.js"),n("../node_modules/core-js/modules/web.dom-collections.for-each.js"),n("../node_modules/core-js/modules/es.array.concat.js");var r=n("../packages/model/src/spreadsheet/Spreadsheet.interface.ts"),o=n("../node_modules/@tencent/jank-sdk/lib/index.js"),s=n("../node_modules/@babel/runtime/helpers/esm/toConsumableArray.js"),i=n("../node_modules/lodash/flattenDeep.js"),a=n.n(i),l=(n("../node_modules/core-js/modules/es.array.includes.js"),n("../node_modules/core-js/modules/es.string.includes.js"),n("../node_modules/core-js/modules/es.array.map.js"),n("../packages/model/src/cell/cellDataUtils.ts")),d=n("../packages/mutation/src/index.ts"),u=n("../packages/mutation/src/MutationId.ts"),c=n("../spread-sheet/src/core/behavior/request/Type.ts"),h=n("../packages/model/src/cell/metadata/CustomDataType.ts"),f=n("../spread-sheet/src/core/behavior/request/dimension/util.ts"),p=n("../spread-sheet/src/core/behavior/request/embedded/utils.ts"),g=n("../packages/model/src/dimension/index.ts"),m=n("../packages/model/src/range/index.ts"),v=n("../packages/model/src/sheet/sheetUtils.ts");function I(e){var t,n,r=e.delta;return(null===(t=r.metadata)||void 0===t?void 0:t.customDataType)===h.ZP.IMAGE?null===(n=r.refIds)||void 0===n?void 0:n[0]:null}function E(e,t){if(e.id===u.ZP.SET_RANGE_MUTATION&&e.cellDataDeltaAtPositions.forEach((function(e){var n=e.cellDataDelta,r=e.rowIndex,o=e.colIndex;(0,l.isCellContentModified)(n)&&t(r,o,n)})),e.id===u.ZP.SET_CELL_PROPERTIES_MUTATION){var n=e.cellDataDelta,r=e.gridRange;(0,l.isCellContentModified)(n)&&r.each((function(e,r){return t(e,r,n)}))}}function S(e,t){return[].concat((0,s.Z)(function(e,t){var n=e.activeSheet,r=n.getSheetId(),o=[],s=[c.Z.ADD_IMAGE_REQUEST,c.Z.UPDATE_IMAGE_REQUEST,c.Z.DELETE_IMAGE_REQUEST,c.Z.SET_SINGLE_VALUE_REQUEST,c.Z.CLEAR_RANGE_REQUEST,c.Z.MOVE_DIMENSION_REQUEST,c.Z.SET_LINK_REQUEST,c.Z.SET_HYPERLINK_RUNS_REQUEST,c.Z.MERGE_CELLS_REQUEST].includes(t.requestId);return t.getAffectedSheetId()!==r||!t.check(n).isValid||s||E(t,(function(e,t,s){var i=n.getCellImage(e,t,!1);i&&i.id!==I(s)&&o.push(new d.G1({key:i.id,sheetId:r}))})),o}(e,t)),(0,s.Z)(function(e,t){var n=e.activeSheet,r=n.getSheetId(),o=[],s=[c.Z.ADD_IMAGE_REQUEST].includes(t.requestId);return t.getAffectedSheetId()!==r||!t.check(n).isValid||s||E(t,(function(t,r,s){if(!n.getCellImage(t,r)&&I(s)){var i=(0,p.P)(n,t);if(!i)return;(0,f.t)(i,e,(function(e){return o.push(e)}))}})),o}(e,t)))}function R(e,t){var n=e.activeSheetId,r=e.activeSheet;if(t.getAffectedSheetId()!==n)return[];if(t.id===u.ZP.COPY_PASTE_MUTATION){var o=t.generateSetRangeMutations(r);return a()(o.map((function(t){return S(e,t)})))}return[u.ZP.SET_RANGE_MUTATION,u.ZP.SET_CELL_PROPERTIES_MUTATION].includes(t.id)?S(e,t):t.id===u.ZP.DELETE_DIMENSION_MUTATION?function(e,t){var n=[];if(t.requestId!==c.Z.DELETE_DIMENSION_REQUEST)return n;var r=e.activeSheetId,o=e.activeSheet,s=t.amount,i=t.index,l=i+s-1,u=t.type===g.DIMENSION_TYPE.ROWS?new m.GridRange({sheetId:r,startRowIndex:i,endRowIndex:l}):new m.GridRange({sheetId:r,startColIndex:i,endColIndex:l});return a()(o.getCellDatasAtRange(u)).forEach((function(e){var t=(0,v.getCellImageByCellData)(o,e,!1);t&&n.push(new d.G1({key:t.id,sheetId:r}))})),n}(e,t):[]}var w=n("../spread-sheet/src/core/behavior/request/workbook/filterUtils/getExtendFilterRangeMutation.ts"),A=n("../packages/model/src/range/GridRange.ts"),C=n("../spread-sheet/src/core/data/configService/spreadConfig.ts"),y=n("../packages/model/src/cell/index.ts"),_=n("../spread-sheet/src/core/app/sheetStatus/private-range.ts"),T=[c.Z.MOVE_DIMENSION_REQUEST,c.Z.MOVE_RANGE_REQUEST],x=n("../packages/model/src/cell/CellDataSlot.ts");function b(e,t){var n=a()([].concat((0,s.Z)(R(e,t)),(0,s.Z)(function(e,t){var n=e.activeSheetId;return t.getAffectedSheetId()!==n?[]:t.id===u.ZP.COPY_PASTE_MUTATION?t.pasteMappings.map((function(e){var t=e.destination,n=new y.CellDataDelta;return n.clearSlot(x.Z.SLOT_IGNORED_ERROR_FLAGS),new d.Y0({cellDataDelta:n,gridRange:t})})):[]}(e,t))));return n}function D(e,t){var n=function(e,t){var n=e.activeSheetId,r=e.activeSheet;if(t.getAffectedSheetId()!==n)return[];if(t.id===u.ZP.SET_CELL_PROPERTIES_MUTATION||t.id===u.ZP.SET_RANGE_MUTATION){var o=t.gridRange;return(0,w.Z)(r,[o])}if(t.id===u.ZP.MERGE_CELLS_MUTATION){var s=t.startRowIndex,i=t.endRowIndex,a=t.startColIndex,l=t.endColIndex,d=new A.Z(n,s,i,a,l);return(0,w.Z)(r,[d])}return[]}(e,t);return n}function O(e,t){!function(e,t){var n=e.activeSheetId,r=e.workbookRangeManager,o=T.includes(t.requestId);if(t.getAffectedSheetId()===n&&!o&&0!==r.privateRangeMap.size){var s=C.q.getConfig("tinyid");if(t.id===u.ZP.SET_RANGE_MUTATION&&t.cellDataDeltaAtPositions.forEach((function(t){var n=t.cellDataDelta,r=t.rowIndex,o=t.colIndex;(0,l.isCellContentModified)(n)&&(0,_._7)(e,r,o)&&n.setSlot(y.CELL_DATA_SLOT.SLOT_MODIFIER_ID,s)})),t.id===u.ZP.SET_CELL_PROPERTIES_MUTATION){var i=t.cellDataDelta,a=t.gridRange;(0,l.isCellContentModified)(i)&&(0,_.Up)(r,[a])&&i.setSlot(y.CELL_DATA_SLOT.SLOT_MODIFIER_ID,s)}}}(e,t),function(e,t){var n=e.activeSheetId;if(t.getAffectedSheetId()===n&&(t.id===u.ZP.SET_RANGE_MUTATION&&t.cellDataDeltaAtPositions.forEach((function(e){var t=e.cellDataDelta;(0,l.isCellContentModified)(t)&&t.clearSlot(x.Z.SLOT_IGNORED_ERROR_FLAGS)})),t.id===u.ZP.SET_CELL_PROPERTIES_MUTATION)){var r=t.cellDataDelta;(0,l.isCellContentModified)(r)&&r.clearSlot(x.Z.SLOT_IGNORED_ERROR_FLAGS)}}(e,t)}var M,j=function(e,t,n,r){var o,s=arguments.length,i=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)i=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(i=(s<3?o(i):s>3?o(t,n,i):o(t,n))||i);return s>3&&i&&Object.defineProperty(t,n,i),i},L=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},Z=function(){function e(e,t){this.behaviors=[],this.canUndoRedo=!0}var t=e.prototype;return t.isMultiSheetRequest=function(){return!1},t.predictRequestSize=function(e){return 0},t.requestSizeOverLimitTips=function(){},t.getRanges=function(e){return[]},t.check=function(e){return null},t.run=function(e,t){var n=this;this.behaviors&&this.behaviors.length&&this.behaviors.forEach((function(r){n.do(r,e,(function(r){n.id!==c.Z.MULTI_REQUEST&&(r.requestId=n.id),O(e,r);var o=b(e,r);t(r);var s=D(e,r);o.concat(s).forEach((function(e){n.id!==c.Z.MULTI_REQUEST&&(e.requestId=n.id),t(e)}))}))}))},t.do=function(e,t,n){},e}();j([(0,o.M4)(Z),L("design:type",Function),L("design:paramtypes",["function"===typeof(M="undefined"!==typeof r.V&&r.V)?M:Object,Function]),L("design:returntype",void 0)],Z.prototype,"run",null);var k=Z},"../spread-sheet/src/core/behavior/request/Type.ts":function(e,t){"use strict";var n;!function(e){e[e.INSERT_DIMENSION_REQUEST=0]="INSERT_DIMENSION_REQUEST",e[e.DELETE_DIMENSION_REQUEST=1]="DELETE_DIMENSION_REQUEST",e[e.MOVE_DIMENSION_REQUEST=2]="MOVE_DIMENSION_REQUEST",e[e.SET_DIMENSION_SIZE_REQUEST=3]="SET_DIMENSION_SIZE_REQUEST",e[e.SET_DIMENSION_HIDE_REQUEST=4]="SET_DIMENSION_HIDE_REQUEST",e[e.SET_DIMENSION_SHOW_REQUEST=5]="SET_DIMENSION_SHOW_REQUEST",e[e.ADD_IMAGE_REQUEST=6]="ADD_IMAGE_REQUEST",e[e.DELETE_IMAGE_REQUEST=7]="DELETE_IMAGE_REQUEST",e[e.UPDATE_IMAGE_REQUEST=8]="UPDATE_IMAGE_REQUEST",e[e.MERGE_CELLS_REQUEST=9]="MERGE_CELLS_REQUEST",e[e.UNMERGE_CELLS_REQUEST=10]="UNMERGE_CELLS_REQUEST",e[e.SET_SHEETS_REQUEST=11]="SET_SHEETS_REQUEST",e[e.SET_FORMAT_REQUEST=12]="SET_FORMAT_REQUEST",e[e.REORDER_RANGE_REQUEST=13]="REORDER_RANGE_REQUEST",e[e.FREEZE_REQUEST=14]="FREEZE_REQUEST",e[e.SET_SINGLE_VALUE_REQUEST=15]="SET_SINGLE_VALUE_REQUEST",e[e.SET_BORDERS_REQUEST=16]="SET_BORDERS_REQUEST",e[e.COPY_PASTE_REQUEST=17]="COPY_PASTE_REQUEST",e[e.CUT_PASTE_REQUEST=18]="CUT_PASTE_REQUEST",e[e.PASTE_DATA_REQUEST=19]="PASTE_DATA_REQUEST",e[e.CLEAR_FORMAT_REQUEST=20]="CLEAR_FORMAT_REQUEST",e[e.REPLACE_ALL_REQUEST=21]="REPLACE_ALL_REQUEST",e[e.SET_LINK_REQUEST=22]="SET_LINK_REQUEST",e[e.CLEAR_LINK_REQUEST=23]="CLEAR_LINK_REQUEST",e[e.CLEAR_RANGE_REQUEST=24]="CLEAR_RANGE_REQUEST",e[e.SET_NUMBER_FORMAT_REQUEST=25]="SET_NUMBER_FORMAT_REQUEST",e[e.ADJUST_DECIMALS_REQUEST=26]="ADJUST_DECIMALS_REQUEST",e[e.AUTO_FILL_REQUEST=27]="AUTO_FILL_REQUEST",e[e.SET_BASIC_FILTER_REQUEST=28]="SET_BASIC_FILTER_REQUEST",e[e.CLEAR_BASIC_FILTER_REQUEST=29]="CLEAR_BASIC_FILTER_REQUEST",e[e.EXPAND_DIMENSION_REQUEST=30]="EXPAND_DIMENSION_REQUEST",e[e.UPDATE_FILTER_CRITERIA_REQUEST=31]="UPDATE_FILTER_CRITERIA_REQUEST",e[e.SET_RANGE_VALUE_REQUEST=32]="SET_RANGE_VALUE_REQUEST",e[e.MULTI_REQUEST=33]="MULTI_REQUEST",e[e.CLEAR_COMMENT_REQUEST=34]="CLEAR_COMMENT_REQUEST",e[e.UPDATE_COMMENT_RANGE_REQUEST=35]="UPDATE_COMMENT_RANGE_REQUEST",e[e.DEFINE_COMMENT_RANGE_REQUEST=36]="DEFINE_COMMENT_RANGE_REQUEST",e[e.DELETE_COMMENT_RANGE_REQUEST=37]="DELETE_COMMENT_RANGE_REQUEST",e[e.SET_DIMENSION_FORMDATA_REQUEST=38]="SET_DIMENSION_FORMDATA_REQUEST",e[e.SET_DATA_VALIDATION_REQUEST=39]="SET_DATA_VALIDATION_REQUEST",e[e.REORDER_FILTER_REQUEST=40]="REORDER_FILTER_REQUEST",e[e.SET_HIDE_GRIDLINES_REQUEST=41]="SET_HIDE_GRIDLINES_REQUEST",e[e.ADD_CONDITIONAL_FORMAT_REQUEST=42]="ADD_CONDITIONAL_FORMAT_REQUEST",e[e.UPDATE_CONDITIONAL_FORMAT_REQUEST=43]="UPDATE_CONDITIONAL_FORMAT_REQUEST",e[e.DELETE_CONDITIONAL_FORMAT_REQUEST=44]="DELETE_CONDITIONAL_FORMAT_REQUEST",e[e.INSERT_SHEET_REQUEST=45]="INSERT_SHEET_REQUEST",e[e.DELETE_SHEET_REQUEST=46]="DELETE_SHEET_REQUEST",e[e.MOVE_SHEET_REQUEST=47]="MOVE_SHEET_REQUEST",e[e.HIDE_SHEET_REQUEST=48]="HIDE_SHEET_REQUEST",e[e.RENAME_SHEET_REQUEST=50]="RENAME_SHEET_REQUEST",e[e.COPY_SHEET_REQUEST=51]="COPY_SHEET_REQUEST",e[e.ADD_PROTECTED_RANGE_REQUEST=52]="ADD_PROTECTED_RANGE_REQUEST",e[e.UPDATE_PROTECTED_RANGE_REQUEST=53]="UPDATE_PROTECTED_RANGE_REQUEST",e[e.DELETE_PROTECTED_RANGE_REQUEST=54]="DELETE_PROTECTED_RANGE_REQUEST",e[e.ADD_EMBEDDED_OBJECT=55]="ADD_EMBEDDED_OBJECT",e[e.UPDATE_EMBEDDED_OBJECT=56]="UPDATE_EMBEDDED_OBJECT",e[e.DELETE_EMBEDDED_OBJECT=57]="DELETE_EMBEDDED_OBJECT",e[e.MOVE_EMBEDDED_OBJECT_TO_SHEET=58]="MOVE_EMBEDDED_OBJECT_TO_SHEET",e[e.SWITCH_FILTER_SYNC_REQUEST=59]="SWITCH_FILTER_SYNC_REQUEST",e[e.SET_IGNORED_ERROR_FLAGS=60]="SET_IGNORED_ERROR_FLAGS",e[e.ADD_LINKED_RANGE_REQUEST=61]="ADD_LINKED_RANGE_REQUEST",e[e.SET_HYPERLINK_RUNS_REQUEST=62]="SET_HYPERLINK_RUNS_REQUEST",e[e.SET_METADATA=63]="SET_METADATA",e[e.SET_REF_IDS=64]="SET_REF_IDS",e[e.INSERT_RANGE_REQUEST=65]="INSERT_RANGE_REQUEST",e[e.DELETE_RANGE_REQUEST=66]="DELETE_RANGE_REQUEST",e[e.MOVE_RANGE_REQUEST=67]="MOVE_RANGE_REQUEST",e[e.ADD_DATE_REMINDER_REQUEST=68]="ADD_DATE_REMINDER_REQUEST",e[e.DELETE_DATE_REMINDER_REQUEST=69]="DELETE_DATE_REMINDER_REQUEST",e[e.UPDATE_CONDITIONAL_FORMAT_REQUEST_INDEX=70]="UPDATE_CONDITIONAL_FORMAT_REQUEST_INDEX",e[e.SET_COLUMN_IGNORE_ERROR=71]="SET_COLUMN_IGNORE_ERROR",e[e.SET_PRIVATE_RANGE=72]="SET_PRIVATE_RANGE",e[e.ADD_WEWORK_COMPONENT_REQUEST=73]="ADD_WEWORK_COMPONENT_REQUEST",e[e.ADD_TODO_REQUEST=74]="ADD_TODO_REQUEST",e[e.DELETE_TODO_REQUEST=75]="DELETE_TODO_REQUEST",e[e.MODIFY_TODO_REQUEST=76]="MODIFY_TODO_REQUEST",e[e.ADD_NOTIFY_RANGE_REQUEST=77]="ADD_NOTIFY_RANGE_REQUEST",e[e.ADD_FILTER_VIEW=78]="ADD_FILTER_VIEW",e[e.DELETE_FILTER_VIEW=79]="DELETE_FILTER_VIEW",e[e.UPDATE_FILTER_VIEW=80]="UPDATE_FILTER_VIEW",e[e.ACTIVE_FILTER_VIEW=81]="ACTIVE_FILTER_VIEW",e[e.UPDATE_FILTER_RANGE_REQUEST=82]="UPDATE_FILTER_RANGE_REQUEST",e[e.COVER_SHEET_REQUEST=83]="COVER_SHEET_REQUEST"}(n||(n={})),t.Z=n},"../spread-sheet/src/core/behavior/request/cell/ClearFormatRequest.ts":function(e,t,n){"use strict";n.d(t,{FV:function(){return A},KE:function(){return w}});var r=n("../node_modules/@babel/runtime/helpers/esm/createClass.js"),o=n("../node_modules/@babel/runtime/helpers/esm/inheritsLoose.js"),s=(n("../node_modules/core-js/modules/es.array.map.js"),n("../node_modules/core-js/modules/web.dom-collections.for-each.js"),n("../packages/model/src/range/GridRange.ts")),i=n("../spread-sheet/src/core/behavior/request/Request.ts"),a=n("../packages/model/src/cell/CellDataDelta.ts"),l=n("../packages/mutation/src/cell/SetCellPropertiesMutation.ts"),d=n("../packages/model/src/cell/CellDataSlot.ts"),u=n("../packages/model/src/range/gridRangeUtils.ts"),c=n("../packages/model/src/cell/CellFormatDelta.ts"),h=n("../packages/model/src/cell/CellFormatSlot.ts"),f=n("../spread-sheet/src/core/behavior/request/Type.ts"),p=n("../spread-sheet/src/core/behavior/request/utils/index.ts"),g=n("../packages/mutation/src/merge/UnmergeCellsMutation.ts"),m=n("../packages/mutation/src/index.ts"),v=n("../packages/model/src/cell/metadata/CustomDataType.ts"),I=n("../spread-sheet/src/core/app/sheetStatus/private-range.ts"),E=n("../packages/model/src/filter-view/utils/grid-range-util.ts"),S=n("../spread-sheet/src/core/data/configService/spreadConfig.ts"),R=function(e){function t(t,n){var r;r=e.call(this,t,n)||this;var o=t.gridRanges||(null===n||void 0===n?void 0:n.rangeSelections)||[];return r.behaviors=o.map((function(e){return{gridRange:e}})),r}return(0,o.Z)(t,e),t.prototype.do=function(e,t,n){var r=A(),o=[e.gridRange],i=t.sheetManager.getSheetBySheetId(e.gridRange.sheetId);if(i){o=(0,u.divideGridRangesByFilter)(o,i.getBasicFilter()),o=(0,u.divideGridRangesByMerges)(o,i.mergeManager.mergeList,{needContainSubCells:!0});for(var a=0,d=(o=(0,E.e6)(o,i)).length;a<d;a++){var c=o[a],h=w(i,c);n(new l.Z({gridRange:o[a],cellDataDelta:r})),h&&n(h);for(var f=c.startRowIndex;f<=c.endRowIndex;f++)for(var m=c.startColIndex;m<=c.endColIndex;m++){var v=(0,p.mX)(i,f,m,r);v.isEmpty()||n(new l.Z({gridRange:new s.Z(e.gridRange.sheetId,f,f,m,m),cellDataDelta:v}))}(0,g.N)(c,i).forEach(n)}}},(0,r.Z)(t,[{key:"id",get:function(){return t.id}}]),t}(i.Z);function w(e,t){var n=[],r={isOwner:S.q.getConfig("isOwner"),ownerId:S.q.getConfig("ownerId"),tinyid:S.q.getConfig("tinyid")};return t.each((function(t,o){var s,i=e.getCellDataAtPosition(t,o),l=null===i||void 0===i?void 0:i.getMetadata();if((0,v.jb)(null===l||void 0===l?void 0:l.customDataType)||(0,I.xy)(e.spreadsheetReference,t,o,e,r)){var u=null===(s=null===i||void 0===i?void 0:i.getUserEnteredFormat())||void 0===s?void 0:s.getNumberFormat(),f=new c.Z;f.setSlot(h.Z.NUMBER_FORMAT,u);var p=new a.Z;p.setSlot(d.Z.SLOT_USER_ENTERED_FORMAT_DELTA,f),n.push({rowIndex:t,colIndex:o,cellDataDelta:p})}}),e),0===n.length?null:new m.qi({gridRange:t,cellDataDeltaAtPositions:n})}function A(e,t){void 0===e&&(e=new a.Z),void 0===t&&(t={});var n=new c.Z,r=t,o=r.skipBorder,s=void 0!==o&&o,i=r.skipBackground,l=void 0!==i&&i,u=r.skipHorizontalAlign,f=void 0!==u&&u,p=r.skipVerticalAlign,g=void 0!==p&&p;return n.clearSlot(h.Z.NUMBER_FORMAT),l||n.clearSlot(h.Z.BACKGROUND_COLOR),s||(n.clearSlot(h.Z.BORDER_TOP),n.clearSlot(h.Z.BORDER_RIGHT),n.clearSlot(h.Z.BORDER_BOTTOM),n.clearSlot(h.Z.BORDER_LEFT),n.clearSlot(h.Z.BORDER_DIAGUP),n.clearSlot(h.Z.BORDER_DIAGDOWN)),f||n.clearSlot(h.Z.HORIZONTAL_ALIGN),g||n.clearSlot(h.Z.VERTICAL_ALIGN),n.clearSlot(h.Z.WRAP_STRATEGY),n.clearSlot(h.Z.FOREGROUND_COLOR),n.clearSlot(h.Z.FONT_FAMINY),n.clearSlot(h.Z.FONT_SIZE),n.clearSlot(h.Z.BOLD),n.clearSlot(h.Z.ITALIC),n.clearSlot(h.Z.STRIKETHROUGH),n.clearSlot(h.Z.UNDERLINE),e.clearSlot(d.Z.SLOT_HYPERLINK),e.clearSlot(d.Z.SLOT_HYPERLINK_TYPE),e.clearSlot(d.Z.SLOT_HYPERLINK_RUN),e.setSlot(d.Z.SLOT_USER_ENTERED_FORMAT_DELTA,n),e}R.id=f.Z.CLEAR_FORMAT_REQUEST,t.ZP=R},"../spread-sheet/src/core/behavior/request/cell/ClearRangeRequest.ts":function(e,t,n){"use strict";n.d(t,{N:function(){return v}});var r=n("../node_modules/@babel/runtime/helpers/esm/createClass.js"),o=n("../node_modules/@babel/runtime/helpers/esm/inheritsLoose.js"),s=(n("../node_modules/core-js/modules/es.array.map.js"),n("../node_modules/core-js/modules/web.dom-collections.for-each.js"),n("../spread-sheet/src/core/behavior/request/Request.ts")),i=n("../packages/model/src/cell/CellDataDelta.ts"),a=n("../packages/mutation/src/cell/SetCellPropertiesMutation.ts"),l=n("../packages/model/src/cell/CellDataSlot.ts"),d=n("../packages/model/src/range/gridRangeUtils.ts"),u=n("../spread-sheet/src/core/behavior/request/Type.ts"),c=n("../packages/mutation/src/index.ts"),h=n("../packages/model/src/cell/metadata/CustomDataType.ts"),f=n("../packages/model/src/filter-view/utils/grid-range-util.ts"),p=n("../spread-sheet/src/core/view/level-2/link-center/logic/attachment/util.ts"),g=n("../spread-sheet/src/core/behavior/request/cell/SetMetadataRequest.ts"),m=function(e){function t(t,n){var r;r=e.call(this,t,n)||this;var o=t.gridRanges||(null===n||void 0===n?void 0:n.rangeSelections)||[];return r.behaviors=o.map((function(e){return{gridRange:e}})),r}return(0,o.Z)(t,e),t.prototype.do=function(e,t,n){var r=v(),o=[e.gridRange],s=t.sheetManager.getSheetBySheetId(e.gridRange.sheetId);s&&(o=(0,d.divideGridRangesByMerges)(o,s.mergeManager.mergeList),o=(0,d.divideGridRangesByFilter)(o,s.getBasicFilter()),(o=(0,f.e6)(o,s)).forEach((function(e){e.each((function(e,t){var r=s.getCellImage(e,t),o=s.getSheetId();r&&n(new c.G1({key:r.id,sheetId:o})),(0,p.m1)(e,t,o)})),n(new a.Z({gridRange:e,cellDataDelta:r}));var t=function(e,t){var n=[];return t.each((function(t,r){var o=e.getCellDataAtPosition(t,r),s=null===o||void 0===o?void 0:o.getMetadata();if(s&&(0,h.Wz)(s.customDataType)){var a=new i.Z;a.clearSlot(l.Z.SLOT_METADATA),(null===o||void 0===o?void 0:o.getDataValidation())&&a.clearSlot(l.Z.SLOT_DATA_VALIDATION_RULE),(null===o||void 0===o?void 0:o.isWeworkComponent())&&a.clearSlot(l.Z.SLOT_REF_DATA),n.push({rowIndex:t,colIndex:r,cellDataDelta:a})}})),0===n.length?null:new c.qi({gridRange:t,cellDataDeltaAtPositions:n})}(s,e);t&&n(t)})),(0,g._L)(o,s,n))},(0,r.Z)(t,[{key:"id",get:function(){return t.id}}]),t}(s.Z);function v(e){return void 0===e&&(e=new i.Z),e.clearSlot(l.Z.SLOT_EFFIECTIVE_VALUE),e.clearSlot(l.Z.SLOT_HYPERLINK),e.clearSlot(l.Z.SLOT_HYPERLINK_TYPE),e.clearSlot(l.Z.SLOT_LINK_ICON_TYPE),e.clearSlot(l.Z.SLOT_FORMULA),e.clearSlot(l.Z.SLOT_MENTION),e.clearSlot(l.Z.SLOT_REF_IDS),e.clearSlot(l.Z.SLOT_HYPERLINK_RUN),e}m.id=u.Z.CLEAR_RANGE_REQUEST,t.Z=m},"../spread-sheet/src/core/behavior/request/cell/SetMetadataRequest.ts":function(e,t,n){"use strict";n.d(t,{ZP:function(){return _},_L:function(){return b},yH:function(){return O}});var r=n("../node_modules/@babel/runtime/helpers/esm/createClass.js"),o=n("../node_modules/@babel/runtime/helpers/esm/inheritsLoose.js"),s=(n("../node_modules/core-js/modules/web.dom-collections.for-each.js"),n("../node_modules/core-js/modules/es.object.keys.js"),n("../node_modules/core-js/modules/es.regexp.exec.js"),n("../node_modules/core-js/modules/es.string.split.js"),n("../node_modules/core-js/modules/es.array.find.js"),n("../node_modules/core-js/modules/es.array.slice.js"),n("../node_modules/core-js/modules/es.array.map.js"),n("../node_modules/core-js/modules/es.array.filter.js"),n("../node_modules/core-js/modules/es.array.includes.js"),n("../node_modules/core-js/modules/es.string.includes.js"),n("../node_modules/core-js/modules/es.object.assign.js"),n("../node_modules/core-js/modules/es.array.sort.js"),n("../node_modules/core-js/modules/es.string.trim.js"),n("../spread-sheet/src/core/behavior/request/Request.ts")),i=n("../packages/model/src/cell/CellDataDelta.ts"),a=n("../packages/model/src/cell/CellDataSlot.ts"),l=n("../spread-sheet/src/core/behavior/request/Type.ts"),d=n("../packages/mutation/src/index.ts"),u=n("../packages/model/src/range/index.ts"),c=n("../packages/model/src/dimension/index.ts"),h=n("../packages/mutation/src/dimension/SetDimensionPropertiesMutation.ts"),f=n("../packages/model/src/sheet/index.ts"),p=n("../packages/model/src/cell/metadata/CustomDataType.ts"),g=n("../spread-sheet/src/core/behavior/request/cell/ClearRangeRequest.ts"),m=n("../packages/model/src/cell/index.ts"),v=n("../packages/model/src/cell/format/index.ts"),I=(n("../packages/model/src/cell/data-validation/data-validation-rule-type.ts"),n("../packages/model/src/cell/data-validation/data-validation-condition-type.ts"),n("../packages/model/src/rule/index.ts"),n("../packages/model/src/sheet/sheetUtils.ts")),E=n("../spread-sheet/src/core/behavior/request/cell/ClearFormatRequest.ts"),S=n("../node_modules/@tencent/tdocs-format-render/lib/index.js"),R=n("../packages/model/src/cell/metadata/date-time/DateTimeTemplateType.ts"),w=(n("../spread-sheet/src/core/view/level-2/data-context-menu/config.tsx"),n("../packages/model/src/utils/numberFormat/index.ts")),A=n("../packages/model/src/cell/ExtendedValue.ts"),C=n("../node_modules/@tencent/tdocs-format-render/lib/model/NumberFormatType.js"),y=n("../packages/model/src/filter-view/utils/grid-range-util.ts"),_=function(e){function t(t,n){var r;return(r=e.call(this,t,n)||this).behaviors=[t],r}(0,o.Z)(t,e);var n=t.prototype;return n.do=function(e,t,n){var r=this,o=e.metadata,s=e.ranges,i=e.colIndexes,a=e.ignoreValidateRows,l=e.dataValidation;if(s[0]){var p=s[0].sheetId,g=t.sheetManager.getSheetBySheetId(p);g&&(null===i||void 0===i||i.forEach((function(e){var t=e.start,r=e.end,s=[{slot:h.P8.SLOT_COLUMN_TYPE_METADATA,columnTypeMetadata:o},{slot:h.P8.SLOT_IGNORE_VALIDATE_ROWS,ignoreValidateRows:o?a:void 0},{slot:h.P8.SLOT_IGNORE_INVALID_ERROR,ignoreInvalidError:!o&&void 0},{slot:h.P8.SLOT_DATA_VALIDATION,dataValidation:l?m.DataValidationRuleFactory.createInstance(l):null}];n(new d.fN({sheetId:p,ranges:[new u.DimensionRange(p,t,r,c.DIMENSION_TYPE.COLUMNS)],operation:s,type:c.DIMENSION_TYPE.COLUMNS})),void 0!==a&&n(new d.dc({sheetId:p,sheetDelta:new f.SheetPropertiesDelta({operation:f.NEW_SHEET_PROPERTIES_SLOT_OPERATION.SET_PROPERTIES,delta:{columnDvIgnoreRows:a}})}))})),(null===i||void 0===i?void 0:i.length)||b(s,g,n),s=(0,y.e6)(s,g),(null===i||void 0===i?void 0:i.length)||b(s,g,n),s.forEach((function(e){n(new d.qi({gridRange:e,cellDataDeltaAtPositions:r.getCellDataDeltas(g,e,o)}))})))}},n.getCellDataDeltas=function(e,t,n){var r=this,o=[];return t.each((function(t,s){var i=e.getCellDataAtPosition(t,s),a=n?r.getSetSingleCellDataDelta(n,i,e):r.getClearSingleCellDataDelta(i);a&&o.push({rowIndex:t,colIndex:s,cellDataDelta:a})}),e),o},n.getSetSingleCellDataDelta=function(e,t,n){var r=new i.Z,o=null===t||void 0===t?void 0:t.getMetadata();if(e.customDataType===(null===o||void 0===o?void 0:o.customDataType)){if(!function(e,t,n,r){var o;if(e.customDataType===p.ZP.SELECT){var s=e.config,i=s.options.map((function(e){return e.id})),l=(null===(o=null===n||void 0===n?void 0:n.getRefIds())||void 0===o?void 0:o.filter((function(e){return i.includes(e)})))||[];s.isMultiSelect||(l=l.slice(0,1));var d=A.Z.createInstance({type:m.EXTENDED_VALUE_TYPE.STRING,value:s.getSelectedTextValue(l)});return r.setSlot(a.Z.SLOT_REF_IDS,l),s.getOptions().options.length&&r.setSlot(a.Z.SLOT_EFFIECTIVE_VALUE,d),!0}return e.customDataType===p.ZP.CONTACT?(function(e,t,n,r){var o,s,i=(null===n||void 0===n?void 0:n.getMentionDetails())||{},l=Object.keys(i);if(t&&!(null===(o=e.config)||void 0===o?void 0:o.isMultiSelect)&&(null===(s=t.config)||void 0===s?void 0:s.isMultiSelect)&&l.length>1){var d=Object.assign({},i),u="";l.sort((function(e,t){return i[e].pos[0]-i[t].pos[0]})).forEach((function(e,t){0===t?(u=i[e].text,i[e]=i[e].clone(),i[e].pos=[0,u.length]):delete d[e]}));var c=A.Z.createInstance({type:m.EXTENDED_VALUE_TYPE.STRING,value:u});r.setSlot(a.Z.SLOT_MENTION,d),r.setSlot(a.Z.SLOT_EFFIECTIVE_VALUE,c)}}(e,t,n,r),!0):e.customDataType===p.ZP.DATE_TIME&&(D(e,r),!0)}(e,o||null,t,r))return null}else{r.clearSlot(a.Z.SLOT_REF_IDS),function(e,t,n,r){var o,s;if((e.customDataType!==p.ZP.DATE_TIME||!w.formatParseEngine.parseDateTimeValue((null===(o=null===t||void 0===t?void 0:t.getFormattedValue())||void 0===o?void 0:o.value)||""))&&!function(e,t){var n,r;if(e.customDataType!==p.ZP.CONTACT)return!1;var o=(null===t||void 0===t?void 0:t.getMentionDetails())||{},s=Object.keys(o),i=(null===(n=null===t||void 0===t?void 0:t.getEditValue())||void 0===n?void 0:n.length)||0,a=s.reduce((function(e,t){return e+o[t].text.length}),0);return i&&a===i&&((null===(r=e.config)||void 0===r?void 0:r.isMultiSelect)||1===s.length)}(e,t)&&(e.customDataType!==p.ZP.ATTACHMENT||!(null===t||void 0===t?void 0:t.getHyperlinkType())))if(e.customDataType!==p.ZP.SELECT)(0,p.NI)(e.customDataType)&&!(0,I.getCellImageByCellData)(n,t)||(0,g.N)(r);else{if(!(null===(s=e.config.options)||void 0===s?void 0:s.length))return;!function(e,t,n){var r,o=[],s=(null===t||void 0===t?void 0:t.getEditValue())||"",i=!!s&&s.split(",").every((function(t){var n=e.config.options.find((function(e){return e.text===t}));return n&&o.push(n.id),!!n}));(0,g.N)(n),i&&o.length>0&&((null===(r=e.config)||void 0===r?void 0:r.isMultiSelect)||(o=o.slice(0,1)),n.setSlot(a.Z.SLOT_REF_IDS,o),n.setSlot(a.Z.SLOT_EFFIECTIVE_VALUE,A.Z.createInstance({type:m.EXTENDED_VALUE_TYPE.STRING,value:s})))}(e,t,r)}}(e,t,n,r);var s=(0,p.eG)(e.customDataType);s?r.setSlot(a.Z.SLOT_EFFIECTIVE_VALUE,s):(null===o||void 0===o?void 0:o.customDataType)&&(0,p.Ck)(o.customDataType)&&r.clearSlot(a.Z.SLOT_EFFIECTIVE_VALUE),function(e,t,n){var r,o;if([p.ZP.ID,p.ZP.PHONE_NUM,p.ZP.TELEPHONE_NUM,p.ZP.EMAIL].includes(e.customDataType)){var s=x("@");t.setSlot(a.Z.SLOT_USER_ENTERED_FORMAT_DELTA,s)}else{var i=Boolean(null===(r=null===n||void 0===n?void 0:n.getUserEnteredFormat())||void 0===r?void 0:r.getHorizontalAlign()),l=Boolean(null===(o=null===n||void 0===n?void 0:n.getUserEnteredFormat())||void 0===o?void 0:o.getVerticalAlign());(function(e,t,n){var r;if(e.customDataType===p.ZP.TEMPERATURE){var o="0\\℃",s=(null===(r=null===n||void 0===n?void 0:n.getEditValue())||void 0===r?void 0:r.trim())||"";/^\d+$/.test(s)?o="0\\℃":/^\d+\.\d+$/.test(s)&&(o="0.0\\℃");var i=x(o);t.setSlot(a.Z.SLOT_USER_ENTERED_FORMAT_DELTA,i)}})(e,t,n),function(e,t,n,r){var o;if(n.customDataType===p.ZP.SELECT&&((0,E.FV)(r,{skipBorder:!0,skipBackground:!0,skipHorizontalAlign:t,skipVerticalAlign:e}),null===(o=n.config)||void 0===o?void 0:o.withColor)){var s=r.delta.userEnteredFormatDelta;null===s||void 0===s||s.setSlot(m.CELL_FORMAT_SLOT.FONT_SIZE,9),null===s||void 0===s||s.setSlot(m.CELL_FORMAT_SLOT.BOLD,!0)}}(l,i,e,t),function(e,t,n,r,o){var s,i,l;if(n.customDataType===p.ZP.PROGRESS){var d="General",u=(null===(s=null===o||void 0===o?void 0:o.getEditValue())||void 0===s?void 0:s.trim())||"";(null===(l=null===(i=null===o||void 0===o?void 0:o.getUserEnteredFormat())||void 0===i?void 0:i.numberFormat)||void 0===l?void 0:l.type)===C.NUMBER_FORMAT_TYPE.PERCENT?d=null:/^\d+$/.test(u)?d="0%":/^\d+\.\d+$/.test(u)&&(d="0.00%");var c=x(d);t||c.setSlot(m.CELL_FORMAT_SLOT.HORIZONTAL_ALIGN,v.HORIZONTAL_ALIGN.RIGHT),e||c.setSlot(m.CELL_FORMAT_SLOT.VERTICAL_ALIGN,v.VERTICAL_ALIGN.MIDDLE),c.setSlot(m.CELL_FORMAT_SLOT.FONT_SIZE,p.pM.fontSize),c.setSlot(m.CELL_FORMAT_SLOT.FOREGROUND_COLOR,p.pM.foregroundColor),r.setSlot(a.Z.SLOT_USER_ENTERED_FORMAT_DELTA,c)}}(l,i,e,t,n),function(e,t,n,r){if([p.ZP.STAR,p.ZP.CHECKBOX].includes(n.customDataType)){var o=new m.CellFormatDelta;t||o.setSlot(m.CELL_FORMAT_SLOT.HORIZONTAL_ALIGN,v.HORIZONTAL_ALIGN.CENTER),e||o.setSlot(m.CELL_FORMAT_SLOT.VERTICAL_ALIGN,v.VERTICAL_ALIGN.MIDDLE),r.setSlot(a.Z.SLOT_USER_ENTERED_FORMAT_DELTA,o)}}(l,i,e,t),D(e,t,!i)}}(e,r,t),T(r,t)}return r.setSlot(a.Z.SLOT_METADATA,e),r},n.getClearSingleCellDataDelta=function(e){var t,n=null===(t=null===e||void 0===e?void 0:e.getMetadata())||void 0===t?void 0:t.customDataType;if(!n||n===p.ZP.IMAGE)return null;var r=new i.Z;return r.clearSlot(a.Z.SLOT_METADATA),r.clearSlot(a.Z.SLOT_REF_IDS),(0,p.Ck)(n)&&r.clearSlot(a.Z.SLOT_EFFIECTIVE_VALUE),T(r,e),r},(0,r.Z)(t,[{key:"id",get:function(){return l.Z.SET_METADATA}}]),t}(s.Z);function T(e,t){var n;if(!(null===(n=e.delta.userEnteredFormatDelta)||void 0===n?void 0:n.delta.numberFormat)&&(null===t||void 0===t?void 0:t.getCellType())===p.ZP.TEMPERATURE){var r=new m.CellFormatDelta;r.clearSlot(m.CELL_FORMAT_SLOT.NUMBER_FORMAT),e.setSlot(a.Z.SLOT_USER_ENTERED_FORMAT_DELTA,r)}}function x(e){var t=new m.CellFormatDelta;if(e){var n=(0,S.getNumberFormatByFormatCode)(e);t.setSlot(m.CELL_FORMAT_SLOT.NUMBER_FORMAT,n)}return t}function b(e,t,n){var r=[];e.forEach((function(e){for(var n,o=e.startColIndex;o<=e.endColIndex;o++)if(null===(n=t.getColProperties(o))||void 0===n?void 0:n.ignoreInvalidError){var s=r[r.length-1];s&&s.endIndex===o-1?s.endIndex+=1:r.push(new u.DimensionRange(e.sheetId,o,o,c.DIMENSION_TYPE.COLUMNS))}})),0!==r.length&&n(new d.fN({sheetId:t.getSheetId(),ranges:r,operation:[{slot:h.P8.SLOT_IGNORE_INVALID_ERROR,ignoreInvalidError:void 0}],type:c.DIMENSION_TYPE.COLUMNS}))}function D(e,t,n){if(void 0===n&&(n=!1),e.customDataType===p.ZP.DATE_TIME){var r=new m.CellFormatDelta,o=e.config,s=(0,S.getNumberFormatByFormatCode)(R.Hx[o.templateType]);r.setSlot(m.CELL_FORMAT_SLOT.NUMBER_FORMAT,s),n&&r.setSlot(m.CELL_FORMAT_SLOT.HORIZONTAL_ALIGN,v.HORIZONTAL_ALIGN.LEFT),t.setSlot(a.Z.SLOT_USER_ENTERED_FORMAT_DELTA,r)}}function O(e,t){var n=[];return t.forEach((function(t){for(var r=t.startColIndex;r<=t.endColIndex;r++)e.getColWidth(r)<p.l$&&n.push(r)})),n.length>0?n.map((function(t){return{dimensionRange:new u.DimensionRange(e.getSheetId(),t,t,c.DIMENSION_TYPE.COLUMNS),size:p.l$}})):null}_.id=l.Z.SET_METADATA},"../spread-sheet/src/core/behavior/request/cell/SetSingleValueRequest.ts":function(e,t,n){"use strict";n.d(t,{VL:function(){return V}}),n("../node_modules/core-js/modules/es.array.slice.js"),n("../node_modules/core-js/modules/es.function.name.js"),n("../node_modules/core-js/modules/es.array.from.js"),n("../node_modules/core-js/modules/es.string.iterator.js"),n("../node_modules/core-js/modules/es.symbol.js"),n("../node_modules/core-js/modules/es.symbol.description.js"),n("../node_modules/core-js/modules/es.symbol.iterator.js"),n("../node_modules/core-js/modules/es.array.iterator.js"),n("../node_modules/core-js/modules/web.dom-collections.iterator.js");var r=n("../node_modules/@babel/runtime/helpers/esm/createClass.js"),o=n("../node_modules/@babel/runtime/helpers/esm/inheritsLoose.js"),s=(n("../node_modules/core-js/modules/es.array.map.js"),n("../node_modules/core-js/modules/es.object.assign.js"),n("../node_modules/core-js/modules/web.dom-collections.for-each.js"),n("../node_modules/core-js/modules/es.number.constructor.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.regexp.to-string.js"),n("../node_modules/core-js/modules/es.array.splice.js"),n("../node_modules/i18next/dist/esm/i18next.js")),i=n("../spread-sheet/src/core/behavior/request/Request.ts"),a=n("../packages/model/src/range/GridRange.ts"),l=n("../packages/model/src/cell/format/Color.ts"),d=n("../packages/model/src/cell/metadata/CustomDataType.ts"),u=n("../packages/model/src/cell/CellDataDelta.ts"),c=n("../packages/model/src/cell/CellDataSlot.ts"),h=n("../packages/model/src/cell/CellFormatDelta.ts"),f=n("../packages/model/src/cell/CellFormatSlot.ts"),p=n("../packages/mutation/src/cell/SetCellPropertiesMutation.ts"),g=n("../packages/model/src/cell/ExtendedValueType.ts"),m=n("../packages/model/src/utils/numberFormat/ParsedValueType.ts"),v=n("../packages/model/src/cell/ExtendedValue.ts"),I=n("../packages/model/src/utils/numberFormat/FormatParseEngine.ts"),E=n("../spread-sheet/src/base/util/url.ts"),S=n("../packages/model/src/cell/format/WrapStrategy.ts"),R=n("../packages/model/src/config/index.ts"),w=n("../packages/model/src/cell/format/UnderlineType.ts"),A=n("../node_modules/@tencent/tdocs-format-render/lib/index.js"),C=n("../spread-sheet/src/core/behavior/request/Type.ts"),y=n("../packages/report/src/index.ts"),_=n("../packages/model/src/cell/HyperlinkType.ts"),T=n("../spread-sheet/src/core/feature/formula/utils/parseUtil.ts"),x=n("../packages/model/src/cell/TextFormatRun.ts"),b=n("../packages/model/src/cell/format/TextFormat.ts"),D=n("../spread-sheet/src/core/behavior/request/embedded/DeleteImageRequest.ts"),O=n("../packages/model/src/cell/LinkIconType.ts"),M=n("../spread-sheet/src/core/data/configService/spreadConfig.ts"),j=n("../spread-sheet/src/core/app/sheetStatus/private-range.ts"),L=n("../node_modules/@tencent/dui/lib/components/Snackbar/index.js"),Z=n("../packages/model/src/filter-view/utils/grid-range-util.ts"),k=n("../spread-sheet/src/core/app/sheetStatus/auth-range.ts"),N=n("../spread-sheet/src/core/view/level-2/collab-center-ent/utils.ts");function P(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){if(e){if("string"===typeof e)return U(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?U(e,t):void 0}}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0;return function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function U(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var F=function(e){function t(t,r){var o,s;(o=e.call(this,t,r)||this).isValid=!0,s=t.sheetId?t.sheetId:(null===r||void 0===r?void 0:r.activeCell.sheetId)||"";var i=n.g.SpreadsheetApp.spreadsheet.activeSheet.getCellDataAtPosition(t.rowIndex,t.colIndex),a=null===i||void 0===i?void 0:i.getHyperlink(),d=t.linkUrl||(0,E.nx)((0,E.Kc)(t.userEnterValue,!1));return d&&!a&&t.textFormatRuns&&(t.textFormatRuns=t.textFormatRuns.map((function(e){var t;return e?e=x.Z.createInstance(Object.assign(Object.assign({},e.getOptions()),{format:b.Z.createInstance(Object.assign(Object.assign({},null===(t=e.format)||void 0===t?void 0:t.getOptions()),{underline:w.Z.SINGLE_LINE,color:l.Z.createColor(R.HYPERLINK_COLOR)}))})):x.Z.createInstance({startIndex:0,format:b.Z.createInstance({underline:w.Z.SINGLE_LINE,color:l.Z.createColor(R.HYPERLINK_COLOR)})})}))),o.behaviors=[{sheetId:s,rowIndex:t.rowIndex,colIndex:t.colIndex,userEnterValue:t.userEnterValue,isChanged:t.isChanged,isTextFormatRunsChanged:t.isTextFormatRunsChanged,linkUrl:t.ignoreLinkUrl?null:d,textFormatRuns:t.textFormatRuns||null,mentionDetailsMap:t.mentionDetailsMap,hyperlinkType:t.hyperlinkType,formatItem:t.formatItem,formatValue:t.formatValue,linkIconStatus:t.linkIconStatus}],o}(0,o.Z)(t,e);var i=t.prototype;return i.checkOptions=function(e,t){if(!t)return!0;for(var n,r=P(t);!(n=r()).done;){var o=n.value,s=e.sheetManager.getSheetBySheetId(o.sheetId);if(!s)return!1;var i=s.getCellDataAtPosition(o.rowIndex,o.colIndex);if(!this.checkOptionsWithCurrentCellData(o,i))return!1}return!0},i.checkOptionsWithCurrentCellData=function(e,t){var n,r,o=null!==(n=null===t||void 0===t?void 0:t.getUserEnteredFormat())&&void 0!==n?n:null,s=null!==(r=null===o||void 0===o?void 0:o.getNumberFormat())&&void 0!==r?r:null,i=(0,A.isTextCell)(s),a=null===t||void 0===t?void 0:t.getFormula(),l=i&&a,d=null===t||void 0===t?void 0:t.getEffectiveValue();if(!e.isChanged&&!e.linkUrl&&!l&&!e.isTextFormatRunsChanged){if(i&&(null===d||void 0===d?void 0:d.type)===g.Z.NUMBER)return!0;if(i||!d||d.type!==g.Z.STRING)return!1;var u=(0,I.parseValueWithStyle)(e.userEnterValue,s,{parseMode:I.PARSE_MODE.PARSE_STYLE_FIRST});if(!d||d.type!==g.Z.STRING||u.valueType===m.Z.STRING)return!1}return!0},i.check=function(e){if(this.isValid=this.isValid&&this.checkOptions(e,this.behaviors),!this.isValid)return{ignore:!0,isWarningOnly:!1};var t=this.behaviors[0],n=t.userEnterValue,r=t.rowIndex,o=t.colIndex;if((0,j.uQ)(e,n,r,o))return M.q.getConfig("isOwner")?{isWarningOnly:!0,warning:{title:s.ZP.t("column-type|隐私提醒"),content:s.ZP.t("column-type|所选区域包含隐私内容，计算结果将对所有"+N.PJ+"可见，确认继续？"),cancelText:s.ZP.t("取消")}}:(L.default.show({message:s.ZP.t("无权限的隐私区域无法引用")}),y.ZP.tdwReport({opername:"doc_excel",module:"privacy_fill",action:"pop_up",ver6:"formula"}),{ignore:!0,isWarningOnly:!1});var i=(0,k.SO)(e.parent,n);return i.currentUserCanNotRead?(L.default.show({message:s.ZP.t("不可查看的保护区域无法引用"),type:"error"}),{ignore:!0,isWarningOnly:!1}):i.otherUserMayCanNotRead?{isWarningOnly:!0,warning:{title:s.ZP.t("保护区域提醒"),content:s.ZP.t("所选区域包含保护区域，计算结果将对所有成员可见，确认继续？")}}:null},i.do=function(e,t,n){var r=e.sheetId,o=e.rowIndex,s=e.colIndex,i=e.userEnterValue,l=e.linkUrl,d=e.hyperlinkRuns,u=t.sheetManager.getSheetBySheetId(r);if(u){var c=u.getCellImage(o,s);if(c){if(""===i)return;var h=c.id;("图片"!==i||!(l||d&&d.length>0))&&(0,D.p)({sheetId:r,id:h,row:o,col:s},t,n,!0)}var f=u.getCellDataAtPosition(e.rowIndex,e.colIndex),g=this.getCellDataDelta(f,r,e),m=new a.Z(e.sheetId,e.rowIndex,e.rowIndex,e.colIndex,e.colIndex);(0,Z.e6)([m],u).forEach((function(e){var t=new p.Z({gridRange:e,cellDataDelta:g});n(t)})),(null===f||void 0===f?void 0:f.getHyperlink())&&y.ZP.tdwReport({opername:"doc_excel_editor",module:"excel_link",action:"edit_url_cell"})}},i.getCellDataDelta=function(e,t,n){return V(Object.assign(Object.assign({},n),{cellData:e,isHyperlink:!!n.linkUrl}))},(0,r.Z)(t,[{key:"id",get:function(){return t.id}}]),t}(i.Z);function V(e){var t,n,r,o=e.cellData,s=void 0===o?null:o,i=e.sheetId,a=e.userEnterValue,l=e.rowIndex,p=e.colIndex,g=e.isChanged,E=e.mentionDetailsMap,R=e.skipTransformToText,w=void 0!==R&&R,C=e.isHyperlink,_=void 0!==C&&C,x=new u.Z,b=null!==(t=null===s||void 0===s?void 0:s.getUserEnteredFormat())&&void 0!==t?t:null,D=null!==(n=null===b||void 0===b?void 0:b.getNumberFormat())&&void 0!==n?n:null,O=(0,I.parseValueWithStyle)(a,D,{parseMode:I.PARSE_MODE.PARSE_STYLE_FIRST});w||(O=(0,I.twelveNumberToText)(O)),_&&O.valueType!==m.Z.STRING&&(O={originValue:a,value:a,valueType:m.Z.STRING,numberFormat:A.NumberFormatFactory.createInstance({pattern:"@"})});var M=new h.Z,j=(0,A.isTextCell)(D);return O.valueType!==m.Z.FORMULA||j?(x.clearSlot(c.Z.SLOT_FORMULA),x.setSlot(c.Z.SLOT_EFFIECTIVE_VALUE,v.Z.createInstance({type:Number(O.valueType),value:O.value})),M.setSlot(f.Z.NUMBER_FORMAT,O.numberFormat)):"string"===typeof O.value&&(x.clearSlot(c.Z.SLOT_EFFIECTIVE_VALUE),x.setSlot(c.Z.SLOT_FORMULA,(0,T.EG)(O.value,l,p,i))),function(e,t,n,r,o){var s=String.fromCharCode(10),i=t?t.getEffectiveValue():null,a=n.valueType===m.Z.STRING?n.value:null;a&&a.indexOf(s)>=0?(o.setSlot(f.Z.WRAP_STRATEGY,S.Z.WRAP),y.ZP.tdwReport({opername:"doc_excel_editor",module:"excel_wrap",action:"manual_wrap"})):r&&r.getWrapStrategy()===S.Z.WRAP&&i&&"string"===typeof i.value&&i.value.indexOf(s)>=0&&null===a&&o.setSlot(f.Z.WRAP_STRATEGY,S.Z.OVERFLOW_CELL)}(0,s,O,b,M),function(e,t,n,r,o){var s=e.textFormatRuns,i=void 0===s?null:s;if(n.valueType===m.Z.STRING)if(i){r.setSlot(c.Z.SLOT_RICH_TEXT_STYLE_RUN,i);var a,l,d=function(e){var t,n,r,o={},s=["fontFamily","fontSize","bold","italic","strikethrough","underline","color"];for(t=0;t<e.length;t++){if(null===(r=e[t].format))return{};for(n=0;n<s.length;n++)void 0!==o[s[n]]?o[s[n]]!==r[s[n]]&&(o[s[n]]=void 0,s.splice(n,1),n-=1):o[s[n]]=r[s[n]]}return o}(i);for(l in d)a=d[l],t&&t[l]===a||(o=H(o,l,a))}else r.clearSlot(c.Z.SLOT_RICH_TEXT_STYLE_RUN);else r.clearSlot(c.Z.SLOT_RICH_TEXT_STYLE_RUN)}(e,b,O,x,M),B(e,x,M,s),M.isEmpty()||x.setSlot(c.Z.SLOT_USER_ENTERED_FORMAT_DELTA,M),E?x.setSlot(c.Z.SLOT_MENTION,E):x.clearSlot(c.Z.SLOT_MENTION),g&&x.clearSlot(c.Z.SLOT_IS_DATA_VALID),g&&!a.length&&((null===(r=null===x||void 0===x?void 0:x.delta)||void 0===r?void 0:r.hyperlink)||(null===s||void 0===s?void 0:s.isWeworkComponent())||(null===s||void 0===s?void 0:s.getCellType())===d.d9.DATE_REMINDER)&&(x.clearSlot(c.Z.SLOT_REF_IDS),x.clearSlot(c.Z.SLOT_METADATA)),x}function B(e,t,n,r){var o,s=e.userEnterValue,i=e.linkUrl,a=void 0===i?null:i,l=e.hyperlinkRuns,d=e.linkIconStatus,u=(null===(o=null===r||void 0===r?void 0:r.getFormula())||void 0===o?void 0:o.toString(0,0,{getSheetTitleBySheetId:function(){return""}}))||"";if(""===s||/^=HYPERLINK/i.test(u))t.clearSlot(c.Z.SLOT_HYPERLINK),t.clearSlot(c.Z.SLOT_HYPERLINK_TYPE),t.clearSlot(c.Z.SLOT_LINK_ICON_TYPE),t.setSlot(c.Z.SLOT_USER_ENTERED_FORMAT_DELTA,n);else if(a){if(t.clearSlot(c.Z.SLOT_HYPERLINK_RUN),t.setSlot(c.Z.SLOT_HYPERLINK,a),"undefined"!==typeof e.hyperlinkType)t.setSlot(c.Z.SLOT_HYPERLINK_TYPE,e.hyperlinkType);else if("undefined"!==typeof e.hyperlinkType&&e.hyperlinkType!==_.ZP.SHEET_LINK)n.setSlot(f.Z.HORIZONTAL_ALIGN,e.formatValue);else{var h=(0,E.NK)(a);(null===r||void 0===r?void 0:r.getHyperlinkType)!==h&&t.setSlot(c.Z.SLOT_HYPERLINK_TYPE,h)}n.removeSlot(f.$.ALL),n.setSlot(f.Z.UNDERLINE,w.Z.SINGLE_LINE),n.setSlot(f.Z.FOREGROUND_COLOR,R.HYPERLINK_COLOR)}else l&&(t.clearSlot(c.Z.SLOT_HYPERLINK),t.clearSlot(c.Z.SLOT_HYPERLINK_TYPE),t.setSlot(c.Z.SLOT_HYPERLINK_RUN,l),n.setSlot(f.Z.UNDERLINE,w.Z.SINGLE_LINE),n.setSlot(f.Z.FOREGROUND_COLOR,R.HYPERLINK_COLOR));!function(e,t,n,r){void 0===r||""===e?n&&(0,E.KM)(n)?t.setSlot(c.Z.SLOT_LINK_ICON_TYPE,O.Z.WITH_IMAGE):t.clearSlot(c.Z.SLOT_LINK_ICON_TYPE):t.setSlot(c.Z.SLOT_LINK_ICON_TYPE,void 0!==r?r:O.Z.PLAIN_TEXT)}(s,t,a,d)}F.id=C.Z.SET_SINGLE_VALUE_REQUEST;var H=function(e,t,n){switch(t){case"fontFamily":e.setSlot(f.Z.FONT_FAMINY,n);break;case"fontSize":e.setSlot(f.Z.FONT_SIZE,n);break;case"bold":e.setSlot(f.Z.BOLD,n);break;case"italic":e.setSlot(f.Z.ITALIC,n);break;case"color":e.setSlot(f.Z.FOREGROUND_COLOR,(null===n||void 0===n?void 0:n.clone)?n.clone():n);break;case"strikethrough":e.setSlot(f.Z.STRIKETHROUGH,n);break;case"underline":e.setSlot(f.Z.UNDERLINE,n)}return e};t.ZP=F},"../spread-sheet/src/core/behavior/request/dimension/util.ts":function(e,t,n){"use strict";n.d(t,{g:function(){return d},t:function(){return l}}),n("../node_modules/core-js/modules/web.dom-collections.for-each.js");var r=n("../packages/model/src/dimension/index.ts"),o=n("../packages/model/src/range/dimensionRangeUtils.ts"),s=n("../packages/mutation/src/index.ts"),i=n("../packages/mutation/src/dimension/SetDimensionPropertiesMutation.ts"),a=n("../packages/model/src/workbookRange/index.ts");function l(e,t,n){var a=t.sheetManager.getSheetBySheetId(e.dimensionRange.sheetId);if(a){var l=(0,o.ic)([e.dimensionRange],a.getBasicFilter()),d=t.parent.sheetStatus;l.forEach((function(t){t.dimension===r.DIMENSION_TYPE.ROWS&&!d.isCurrentRowCanEdit({startRow:t.startIndex,endRow:t.endIndex})||t.dimension===r.DIMENSION_TYPE.COLUMNS&&!d.isCurrentColCanEdit({startCol:t.startIndex,endCol:t.endIndex})||n(new s.fN({ranges:[t],operation:[{slot:i.P8.SLOT_SIZE,size:e.size}],sheetId:a.getSheetId(),type:t.dimension,filterViewId:a.filterViewManager.getActiveFilterViewId()}))}))}}function d(e,t){e instanceof a.LinkedRange&&void 0!==e.properties&&t.setLinkedRangeProperties(e.properties),e instanceof a.ProtectedRange&&void 0!==e.properties&&t.setProtectionProperties(e.properties)}},"../spread-sheet/src/core/behavior/request/embedded/DeleteImageRequest.ts":function(e,t,n){"use strict";n.d(t,{p:function(){return p}});var r=n("../node_modules/@babel/runtime/helpers/esm/createClass.js"),o=n("../node_modules/@babel/runtime/helpers/esm/inheritsLoose.js"),s=n("../spread-sheet/src/core/behavior/request/Request.ts"),i=n("../packages/mutation/src/embedded/DeleteEmbeddedObjectMutation.ts"),a=n("../spread-sheet/src/core/behavior/request/Type.ts"),l=n("../packages/model/src/cell/index.ts"),d=n("../packages/mutation/src/cell/SetCellPropertiesMutation.ts"),u=n("../packages/model/src/range/GridRange.ts"),c=n("../packages/model/src/cell/ExtendedValue.ts"),h=function(e){function t(t,n){var r;return(r=e.call(this,t,n)||this).behaviors=t instanceof Array?t:[t],r}return(0,o.Z)(t,e),t.prototype.do=function(e,t,n){p(e,t,n,!0)},(0,r.Z)(t,[{key:"id",get:function(){return t.id}}]),t}(s.Z);function f(e,t){var n=new l.CellDataDelta,r=e.getHyperlink();return r&&t?n.setSlot(l.CELL_DATA_SLOT.SLOT_EFFIECTIVE_VALUE,c.Z.createInstance({value:r,type:l.EXTENDED_VALUE_TYPE.STRING})):n.clearSlot(l.CELL_DATA_SLOT.SLOT_EFFIECTIVE_VALUE),n.clearSlot(l.CELL_DATA_SLOT.SLOT_METADATA),n.clearSlot(l.CELL_DATA_SLOT.SLOT_REF_IDS),n}function p(e,t,n,r){var o;void 0===r&&(r=!1);var s=e.id,a=e.sheetId,l=e.row,c=e.col,h=t.sheetManager.getSheetBySheetId(a);if(h){if("number"===typeof l&&"number"===typeof c&&(null===(o=h.getCellImage(l,c))||void 0===o?void 0:o.id)===s){var p=h.getCellDataAtPosition(l,c),g=h.transformCoordFromFilterViewToSheet(l,c),m=g.row,v=g.col;n(new d.Z({gridRange:new u.Z(a,m,m,v,v),cellDataDelta:f(p,!r)}))}r&&h.imageManager.getImage(s)&&n(new i.Z({key:s,sheetId:a}))}}h.id=a.Z.DELETE_IMAGE_REQUEST,t.Z=h},"../spread-sheet/src/core/behavior/request/embedded/utils.ts":function(e,t,n){"use strict";n.d(t,{P:function(){return i}});var r=n("../packages/model/src/dimension/index.ts"),o=n("../packages/model/src/range/index.ts"),s=n("../spread-sheet/src/core/view/spreadsheet-view/row-col-accessor/RowcolAccessor.ts");function i(e,t){return 48>(0,s.O)(e,t)?{dimensionRange:new o.DimensionRange(e.getSheetId(),t,t,r.DIMENSION_TYPE.ROWS),size:48}:null}},"../spread-sheet/src/core/behavior/request/enum/FormatItem.ts":function(e,t,n){"use strict";var r;!function(e){e[e.FONT_FAMINY=0]="FONT_FAMINY",e[e.FONT_SIZE=1]="FONT_SIZE",e[e.BOLD=2]="BOLD",e[e.ITALIC=3]="ITALIC",e[e.WRAP_STRATEGY=4]="WRAP_STRATEGY",e[e.HORIZONTAL_ALIGN=5]="HORIZONTAL_ALIGN",e[e.VERTICAL_ALIGN=6]="VERTICAL_ALIGN",e[e.COLOR=7]="COLOR",e[e.BACKGROUND_COLOR=8]="BACKGROUND_COLOR",e[e.STRIKE_THROUGH=9]="STRIKE_THROUGH",e[e.UNDERLINE=10]="UNDERLINE"}(r||(r={})),Math.pow(2,r.UNDERLINE+1),t.Z=r},"../spread-sheet/src/core/behavior/request/other/formula-model-service/FormulaModelManager.ts":function(e,t,n){"use strict";n.d(t,{S:function(){return r},l:function(){return u}}),n("../node_modules/core-js/modules/es.object.assign.js"),n("../node_modules/core-js/modules/es.array.iterator.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.set.js"),n("../node_modules/core-js/modules/es.string.iterator.js"),n("../node_modules/core-js/modules/esnext.set.add-all.js"),n("../node_modules/core-js/modules/esnext.set.delete-all.js"),n("../node_modules/core-js/modules/esnext.set.difference.js"),n("../node_modules/core-js/modules/esnext.set.every.js"),n("../node_modules/core-js/modules/esnext.set.filter.js"),n("../node_modules/core-js/modules/esnext.set.find.js"),n("../node_modules/core-js/modules/esnext.set.intersection.js"),n("../node_modules/core-js/modules/esnext.set.is-disjoint-from.js"),n("../node_modules/core-js/modules/esnext.set.is-subset-of.js"),n("../node_modules/core-js/modules/esnext.set.is-superset-of.js"),n("../node_modules/core-js/modules/esnext.set.join.js"),n("../node_modules/core-js/modules/esnext.set.map.js"),n("../node_modules/core-js/modules/esnext.set.reduce.js"),n("../node_modules/core-js/modules/esnext.set.some.js"),n("../node_modules/core-js/modules/esnext.set.symmetric-difference.js"),n("../node_modules/core-js/modules/esnext.set.union.js"),n("../node_modules/core-js/modules/web.dom-collections.iterator.js"),n("../node_modules/core-js/modules/web.dom-collections.for-each.js"),n("../node_modules/core-js/modules/es.object.values.js"),n("../node_modules/core-js/modules/es.array.find.js"),n("../node_modules/core-js/modules/es.object.keys.js");var r,o=n("../packages/model/src/range/GridRange.ts"),s=n("../node_modules/@tencent/sheet-formula-sdk/lib/index.js"),i=n("../packages/model/src/rule/index.ts"),a=n("../spread-sheet/src/core/feature/formula/utils.ts"),l=n("../packages/model/src/cell/CellDataDelta.ts"),d=n("../packages/model/src/cell/CellDataSlot.ts");!function(e){e.DV="DV",e.FORMULA="FORMULA",e.CHART="CHART",e.CONDITION="CONDITION"}(r||(r={}));var u=function(){function e(e){var t,n;this.getFormulaModelByRowCol=function(e,t,n,r){return r.inDegreeSegmentNode.nodeInfo.formulaModel||null};var o=Object.assign(Object.assign({},e),{getFormulaModelByRowCol:this.getFormulaModelByRowCol}),i=new s.nx.MergeableGraphSegmentManager(r.FORMULA,o),a=new s.nx.MergeableGraphSegmentManager(r.DV,o),l=new s.nx.BaseGraphSegmentManager(r.CONDITION,o);this.graphUpdateService=new s.nx.GraphUpdateService(o),this.formulaModelMap=((t={})[r.DV]=a,t[r.FORMULA]=i,t[r.CONDITION]=l,t),this.tempFormulaDataListMap=((n={})[r.FORMULA]=[],n[r.DV]=[],n),this.externalMethods=e}var t=e.prototype;return t.each=function(e,t,n){var s=this.formulaModelMap[e];if(s){var i=s.getTreeBySheetId(t),a=i.inDegreeTree,l=i.outDegreeTree;if(a||l){var d=new Set(null===a||void 0===a?void 0:a.all());null===l||void 0===l||l.all().forEach((function(e){e.relationshipSegments.forEach((function(e){d.add(e.node)}))})),d.forEach((function(t){var s,i=new o.Z(t.gridRange),a=i.sheetId,l=null===(s=t.nodeInfo)||void 0===s?void 0:s.formulaModel;e!==r.CONDITION?i.each((function(o,s){if(e===r.DV){var i=t.nodeInfo;n(Object.assign({row:o,col:s,sheetId:a,formulaModel:l},i))}else n({row:o,col:s,sheetId:a,formulaModel:l,nodeInfo:void 0})})):n(t.nodeInfo)}))}}},t.clear=function(){Object.values(this.formulaModelMap).forEach((function(e){e.destroy()}))},t.keyframeHandler=function(e){var t=this,n=e.sheet,r=n.data.rowData,o=n.getSheetId();r.forEach((function(e,n){e&&e.values.forEach((function(e,r){if(e){var s=e.getDataValidation();if(s){var i=new l.Z;i.setSlot(d.Z.SLOT_DATA_VALIDATION_RULE,s),t.addDataValidationData({row:n,col:r,sheetId:o},i)}var a=e.getFormula();if(a){var u=new l.Z;u.setSlot(d.Z.SLOT_FORMULA,a),t.addFormulaData({row:n,col:r,sheetId:o},u)}}}))})),this.updateFormulaModelManagerDataFinish(),n.conditionalFormatRuleManager.rules.forEach((function(e){t.addConditionalFormatData(e.id,e)}))},t.mapRange=function(e){this.commitMutation(Object.assign(Object.assign({},e),{id:s.zD.MUTATION_ID.MAP_RANGE_MUTATION,getAffectedSheetId:function(){return e.sheetId}}))},t.insertDimension=function(e){this.commitMutation(Object.assign(Object.assign({},e),{id:s.zD.MUTATION_ID.INSERT_DIMENSION_MUTATION,getAffectedSheetId:function(){return e.sheetId}}))},t.deleteDimension=function(e){this.commitMutation(Object.assign(Object.assign({},e),{id:s.zD.MUTATION_ID.DELETE_DIMENSION_MUTATION,getAffectedSheetId:function(){return e.sheetId}}))},t.moveSheet=function(e,t){this.commitMutation({toIndex:e,getAffectedSheetId:function(){return t},id:s.zD.MUTATION_ID.MOVE_SHEET_MUTATION})},t.deleteSheet=function(e,t){this.commitMutation({sheetIndex:e,sheetId:t,getAffectedSheetId:function(){return t},id:s.zD.MUTATION_ID.DELETE_SHEET_MUTATION})},t.insertSheet=function(e,t){this.commitMutation({sheetIndex:e,sheetId:t,getAffectedSheetId:function(){return t},id:s.zD.MUTATION_ID.INSERT_SHEET_MUTATION})},t.updateFormulaModelManagerDataFinish=function(){var e=this.tempFormulaDataListMap[r.FORMULA]||[];this.formulaModelMap[r.FORMULA].addNodesFromChangedNodes(e);var t=this.tempFormulaDataListMap[r.DV]||[];this.formulaModelMap[r.DV].addNodesFromChangedNodes(t),this.tempFormulaDataListMap[r.FORMULA]=[],this.tempFormulaDataListMap[r.DV]=[]},t.addFormulaData=function(e,t){var n=e.row,o=e.col,s=e.sheetId,i=(t.clearSlots&1<<d.Z.SLOT_FORMULA)===1<<d.Z.SLOT_FORMULA,a=(t.setSlots&1<<d.Z.SLOT_FORMULA)===1<<d.Z.SLOT_FORMULA;if(i||a){var l=void 0;i&&(l=void 0),a&&0===(null===(l=t.delta.formula||void 0)||void 0===l?void 0:l.getAllCellRangeWithFixedInfo().length)&&(l=void 0),this.setMapItem({type:r.FORMULA,row:n,col:o,sheetId:s,formulaModel:l,nodeInfo:{formulaModel:l}})}},t.addDataValidationData=function(e,t){var n,o=e.row,s=e.col,i=e.sheetId,a=(t.clearSlots&1<<d.Z.SLOT_DATA_VALIDATION_RULE)===1<<d.Z.SLOT_DATA_VALIDATION_RULE,l=(t.setSlots&1<<d.Z.SLOT_DATA_VALIDATION_RULE)===1<<d.Z.SLOT_DATA_VALIDATION_RULE;if(a||l){var u=void 0,c=t.delta.dataValidation;if(a&&(u=void 0),l){var h=null===(n=null===c||void 0===c?void 0:c.argTokens)||void 0===n?void 0:n.find((function(e){return e.formula}));0===(null===(u=(null===h||void 0===h?void 0:h.formula)||void 0)||void 0===u?void 0:u.getAllCellRangeWithFixedInfo().length)&&(u=void 0)}var f={type:r.DV,row:o,col:s,sheetId:i,formulaModel:u,nodeInfo:{dataValidation:c||void 0,formulaModel:u}};this.setMapItem(f)}},t.addConditionalFormatData=function(e,t){var n,o=this;if(t&&(null===t||void 0===t?void 0:t.rule)){var l=t.rule;if((null===(n=l.booleanConditionalFormat)||void 0===n?void 0:n.condition.type)===i.CONDITION_TYPE.CUSTOM_FORMULA){var d=l.booleanConditionalFormat.condition.values[0];if(d){var u=d.formula;if(u&&0!==u.getAllCellRangeWithFixedInfo().length){var c=this.formulaModelMap[r.CONDITION],h={formulaModel:u,id:t.id,index:t.index,rule:t.rule};l.ruleRanges.forEach((function(e){var t=new s.nx.GraphSegmentNode((0,a.Ad)(e),h);(null===u||void 0===u?void 0:u.getAllCellRangeWithFixedInfo()).forEach((function(n){var r=s.nx.getDepOffsetRangeByRefOffsetRangeAndPart(n,e),i=r.startRow,a=r.endRow,l=r.startCol,d=r.endCol;s.nx.getSheetIdsFromPart(n,e.sheetId,o.externalMethods.getSheetIdsAmongTwoSheets).forEach((function(e){var n=new s.nx.GraphSegmentNode(new s.zD.FormulaGridRange(e,i,a,l,d));c.addDependency(t,n)}))}))}))}}}}},t.removeConditionalFormatData=function(e,t){var n=this.formulaModelMap[r.CONDITION];t.forEach((function(t){n.searchInTree(t,s.nx.DegreeTreeType.IN_DEGREE).forEach((function(t){var r;(null===(r=t.nodeInfo)||void 0===r?void 0:r.id)===e&&n.removeNodeAndRelatedNodesInTree(t,s.nx.DegreeTreeType.IN_DEGREE)}))}))},t.setMapItem=function(e){var t=e.type;this.tempFormulaDataListMap[t]||(this.tempFormulaDataListMap[t]=[]),this.tempFormulaDataListMap[t].push(e)},t.commitMutation=function(e){var t=this,n=this.formulaModelMap;Object.keys(n).forEach((function(r){var o=n[r],i=t.graphUpdateService.updateGraphAfterMutation(o,e);o instanceof s.nx.MergeableGraphSegmentManager?t.rebuildInDegreeNodesByMergeableSegments(o,i,r):o instanceof s.nx.BaseGraphSegmentManager&&t.rebuildInDegreeNodesByBaseSegments(o,i,r)}))},t.rebuildInDegreeNodesByMergeableSegments=function(e,t,n){var i=[];t.forEach((function(t){var a=t.gridRange,l=t.nodeInfo,d=a.sheetId;e.removeNodeAndRelatedNodesInTree(t,s.nx.DegreeTreeType.IN_DEGREE),new o.Z(t.gridRange).each((function(e,t){var o,s;if(n===r.FORMULA)s=l.formulaModel;else if(n===r.DV){var a=l.dataValidation,u=null===(o=null===a||void 0===a?void 0:a.argTokens)||void 0===o?void 0:o.find((function(e){return e.formula}));s=(null===u||void 0===u?void 0:u.formula)||void 0}s&&!s.hasReferenceError&&i.push({row:e,col:t,sheetId:d,formulaModel:s,nodeInfo:l})}))})),e.addNodesFromChangedNodes(i)},t.rebuildInDegreeNodesByBaseSegments=function(e,t,n){var o=this;t.forEach((function(t){if(e.removeNodeAndRelatedNodesInTree(t,s.nx.DegreeTreeType.IN_DEGREE),n===r.CONDITION){var i=t.nodeInfo;if(!i.id)return;var a=i||void 0;o.addConditionalFormatData(i.id,a)}}))},e}()},"../spread-sheet/src/core/behavior/request/other/formula-model-service/UpdateFormulaModelService.ts":function(e,t,n){"use strict";n.d(t,{Z:function(){return d}}),n("../node_modules/core-js/modules/es.array.map.js"),n("../node_modules/core-js/modules/es.object.assign.js"),n("../node_modules/core-js/modules/es.array.concat.js"),n("../node_modules/core-js/modules/web.dom-collections.for-each.js"),n("../node_modules/core-js/modules/es.object.values.js");var r=n("../packages/mutation/src/MutationId.ts"),o=n("../spread-sheet/src/core/feature/formula/utils.ts"),s=n("../packages/common-utils/src/index.ts"),i=n("../packages/model/src/cell/formula/FormulaModel.ts"),a=n("../packages/model/src/cell/formula/CellRangeWithFixedInfo.ts"),l=function(){function e(e){var t=this;this.updateFormulaModelAfterRowColCutMove=function(e,t){var n,r=t.migrationMap,s=t.sourceStartIndex,l=t.sourceEndIndex,d=t.destinationIndex,u=t.sourceSheetId,c=t.isRow,h=t.row,f=t.col,p=t.nodeSheetId,g=!1,m=p===u,v=c?h:f,I=m&&(null===(n=r[v])||void 0===n?void 0:n.num),E="number"===typeof I?I:v,S=e.getParts().map((function(e){if("string"===typeof e)return e;var t=e.isCrossSheetReference,n=e.isStartRowRelative,r=e.isStartColRelative,i=e.isEndRowRelative,h=e.isEndColRelative,f=e.isCellRangeReferenceCorrect,p=e.isThreeDimensionalReference,I=e.startSheetId;if(!f)return e;var S=c?"startRowIndex":"startColIndex",R=c?"endRowIndex":"endColIndex",w=c?n:r,A=c?i:h,C=e[S],y=e[R],_=(0,o.sy)(C,v,w),T=(0,o.sy)(y,v,A),x=s<=_&&l>=_,b=s<=T&&l>=T;if(p||t&&u!==I||!t&&!m);else if(s<=_&&l>=T){var D=d-s;_+=D,T+=D,g=!0}else if(x||b){var O=d-s;_+=x?O:0,T+=b?O:0,g=!0}E!==v&&(g=!0);var M=e.getOptions();if(M[S]=w?_-E:_,M[R]=A?T-E:T,M[S]>M[R]){var j=[M[R],M[S]];M[S]=j[0],M[R]=j[1]}return a.ZP.createInstance(M)}));return{isFormulaChanged:g,newFormulaModel:i.Z.createInstance({formulaPartList:S})}},this.updateFormulaModelAfterRowColAdd=function(e,n){var r=n.mutationSheetId,o=n.index,s=n.amount,l=n.isRow,d=n.row,u=n.col,c=n.nodeSheetId,h=!1,f=c===r,p=l?d:u,g=f&&p>=o,m=e.getParts().map((function(e){if("string"===typeof e)return e;var n=e.isCrossSheetReference,i=e.isRowArray,d=e.isColArray;if(!e.isCellRangeReferenceCorrect)return e;var u=!1,m=l?d:i;if(n){if(e.isThreeDimensionalReference){var v=t.externalMethods.isSheetAmongTwoSheets(r,e.startSheetId,e.endSheetId);if(!g&&!v)return e;u=!0}else if(f)u=e.startSheetId!==r;else if(e.startSheetId!==r)return e}else if(c!==r)return e;if(m)return e;var I=l?"startRowIndex":"startColIndex",E=l?"endRowIndex":"endColIndex",S=e[I],R=e[E];return function(e){var t=l?e.isStartRowRelative:e.isStartColRelative,n=l?e.isEndRowRelative:e.isEndColRelative,r=e.getOptions();return t?g!==(!u&&S+p>=o)&&(r[I]=S+(g?-s:s),h=!0):!u&&S>=o&&(r[I]=S+s,h=!0),n?g!==(!u&&R+p>=o)&&(r[E]=R+(g?-s:s),h=!0):!u&&R>=o&&(r[E]=R+s,h=!0),a.ZP.createInstance(r)}(e)}));return{isFormulaChanged:h,newFormulaModel:i.Z.createInstance({formulaPartList:m})}},this.updateFormulaModelAfterRowColDel=function(e,n){var r=n.mutationSheetId,o=n.index,s=n.amount,l=n.isRow,d=n.row,u=n.col,c=n.nodeSheetId,h=!1,f=c===r,p=l?d:u,g=f&&p>=o,m=e.getParts().reduce((function(e,n){if("string"===typeof n)return e.push(n),e;var i=n.isCrossSheetReference,d=n.isRowArray,u=n.isColArray;if(!n.isCellRangeReferenceCorrect)return e.push(n),e;var m=!1,v=l?u:d;if(i){if(n.isThreeDimensionalReference){var I=t.externalMethods.isSheetAmongTwoSheets(r,n.startSheetId,n.endSheetId);if(!g&&!I)return e.push(n),e;m=!0}else if(f)m=n.startSheetId!==r;else if(n.startSheetId!==r)return e.push(n),e}else if(c!==r)return e.push(n),e;if(v)return e.push(n),e;var E="startColIndex",S="endColIndex",R=n.isStartColRelative,w=n.isEndColRelative,A=n.getAbsoluteStartCol(p),C=n.getAbsoluteEndCol(p);l&&(E="startRowIndex",S="endRowIndex",R=n.isStartRowRelative,w=n.isEndRowRelative,A=n.getAbsoluteStartRow(p),C=n.getAbsoluteEndRow(p));var y=!m&&A>=o&&A<o+s,_=!m&&C>=o&&C<o+s;return(_||y)&&(h=!0),!m&&y&&_?function(t){var n=e.length-1;return h=!0,i?e.push(a.ZP.createInstance(Object.assign(Object.assign({},t.getOptions()),{isCellRangeReferenceCorrect:!1}))):"string"===typeof e[n]?e[n]=e[n].concat("#REF!"):e.push("#REF!"),e}(n):(e.push(function(e){var t=y?o+s:A,n=_?o-1:C,r=R?t-p:t,i=w?n-p:n,l=e.getOptions();return l[E]=r,l[S]=i,R?g!==(!m&&t>=o)&&(l[E]=r-(g?-s:s),h=!0):!m&&t>=o&&(l[E]=r-s,h=!0),w?g!==(!m&&n>=o)&&(l[S]=i-(g?-s:s),h=!0):!m&&n>=o&&(l[S]=i-s,h=!0),a.ZP.createInstance(l)}(n)),e)}),[]);return{isFormulaChanged:h,newFormulaModel:i.Z.createInstance({formulaPartList:m})}},this.externalMethods=e}var t=e.prototype;return t.getChangedNodesAfterRowColAddDelete=function(e,t,n){var o=this,s=void 0===n?{}:n,i=s.isMovedNewPosition,a=s.onlyRefRangeChange,l=[],d=e.amount,u=e.index,c=e.sheetId,h=e.type.toLowerCase().indexOf("row")>-1,f=e.id===r.ZP.INSERT_DIMENSION_MUTATION;return t.forEach((function(e){e.oldRow=e.row,e.oldCol=e.col;var t=e.formulaModel,n={index:u,isRow:h,amount:d,sheetId:c,row:e.row,col:e.col,nodeSheetId:e.sheetId};if(!a||(f?t.isAffectedByRowColAdd(n):t.isAffectedByRowColDel(n))){var r=o.getChangedNodeByInsertOrDeleteMutation(e,{isRow:h,isAdd:f,amount:d,index:u,mutationSheetId:c},i),s=r.isFormulaChanged,p=r.isPositionChanged;(s||p)&&l.push(e)}})),l},t.getChangedNodesAfterRowColCutMoveMutation=function(e,t){for(var n=this,r=e.row,o=e.column,i=-1!==r.to,a=i?r:o,l=a.from,d=l.startIndex,u=l.endIndex,c=a.destinationSheetId,h=a.sourceSheetId,f=a.to,p=[],g={},m=d,v=0;m<=u;m++,v++){var I=f+v;g[m]={num:I,destinationSheetId:c,sourceSheetId:h}}return t.forEach((function(e){var t=e.row,r=e.col,o=e.sheetId,a=e.formulaModel;e.oldRow=e.row,e.oldCol=e.col;var l=n.updateFormulaModelAfterRowColCutMove(a,{sourceStartIndex:d,sourceEndIndex:u,destinationIndex:f,migrationMap:g,isRow:i,row:t,col:r,nodeSheetId:o,sourceSheetId:h}),c=l.isFormulaChanged,m=l.newFormulaModel,v=i?"row":"col",I=g[e[v]],E=o===h&&!(0,s.o8)(I)&&e[v]!==I.num;E&&(e[v]=I.num),(c||E)&&(e.formulaModel=m,p.push(e))})),p},t.getChangedNodesAfterReorderRangeMutation=function(e,t,n){var r=this,o=(void 0===n?{}:n).isMovedNewPosition,i=e.operation.rules,a=e.sheetId,l=e.range,d=l.startColIndex,u=l.endColIndex,c=[],h=-1,f=-1,p=Object.values(i||{}).reduce((function(e,t){var n,r=t.from,s=t.to;return h=-1===h?r:Math.min(h,r),f=-1===f?r:Math.max(f,r),o&&(r=(n=[s,r])[0],s=n[1]),e[r]={num:s,destinationSheetId:a,sourceSheetId:a},e}),{});return t.forEach((function(e){var t=e.col,n=e.sheetId,i=e.formulaModel;if(e.oldRow=e.row,e.oldCol=e.col,n===a){var l=e.row,h=(p[l]||{}).num;if(o){var f=[h,l];l=f[0],h=f[1]}if(!((0,s.o8)(h)||t<d||t>u)){var g=r.updateFormulaModelAfterReorderRange(i,{row:l,newRow:h}),m=g.isFormulaChanged,v=g.newFormulaModel,I=!o&&e.row!==h;I&&(e.row=h),(m||I)&&(e.formulaModel=v,c.push(e))}}})),c},t.getChangedNodesAfterSheetDeletedMutation=function(e,t){var n=this,r=e.sheetId,o=e.sheetIndex,s=[];return t.forEach((function(e){var t=e.formulaModel;e.oldRow=e.row,e.oldCol=e.col;var i=n.updateFormulaModelAfterSheetDeleted(t,{sheetId:r,originSheetIndex:o}),a=i.isFormulaChanged,l=i.newFormulaModel;a&&(e.formulaModel=l,s.push(e))})),s},t.getChangedNodeByInsertOrDeleteMutation=function(e,t,n){var r=t.isAdd,o=t.isRow,s=t.mutationSheetId,i=t.index,a=t.amount;void 0===n&&(n=!1);var l=r?this.updateFormulaModelAfterRowColAdd:this.updateFormulaModelAfterRowColDel,d=e.row,u=e.col,c=e.sheetId,h=e.formulaModel,f=o?d:u,p=d,g=u,m=d,v=u,I=r?1:-1;if(c!==s&&(I=0),n){var E=f>=i?I:0;o?p=d-E*a:g=u-E*a}else{var S=f>=i?I:0;o?m=d+S*a:v=u+S*a}if(!r&&s===c&&(o?p>=i&&p<=i+a-1:g>=i&&g<=i+a-1))return{isFormulaChanged:!1,isPositionChanged:!1};var R=l(h,{mutationSheetId:s,index:i,amount:a,isRow:o,row:p,col:g,nodeSheetId:c}),w=R.isFormulaChanged,A=R.newFormulaModel,C=p!==m||g!==v;return C&&(e.row=m,e.col=v),(w||C)&&(e.formulaModel=A),{isFormulaChanged:w,isPositionChanged:C}},t.updateFormulaModelAfterSheetDeleted=function(e,t){var n=this,r=t.sheetId,o=t.originSheetIndex,s=!1,l=e.getParts().map((function(e){if("string"===typeof e)return e;if(!e.isCrossSheetReference)return e;var t=e.getOptions();if(e.isThreeDimensionalReference){var i=n.externalMethods.getSheetIndexBySheetId(e.startSheetId),l=n.externalMethods.getSheetIndexBySheetId(e.endSheetId);if(i<0&&(i=o),l<0&&(l=o),e.startSheetId===r){var d=i>l?-1:0;t.startSheetId=n.externalMethods.getSheetIdBySheetIndex(o+d),s=!0}else if(e.endSheetId===r){var u=i>=l?0:-1;t.endSheetId=n.externalMethods.getSheetIdBySheetIndex(o+u),s=!0}}else e.startSheetId===r&&(t.startSheetId="#REF!",t.endSheetId="#REF!",s=!0);return a.ZP.createInstance(t)}));return{isFormulaChanged:s,newFormulaModel:i.Z.createInstance({formulaPartList:l})}},t.updateFormulaModelAfterReorderRange=function(e,t){var n=t.row,r=t.newRow,o=!1,s=e.getParts().reduce((function(e,t){if("string"===typeof t)return e.push(t),e;var s=t.isCrossSheetReference,i=t.isColArray;if(!t.isCellRangeReferenceCorrect||i)return e.push(t),e;var l=s,d="startRowIndex",u="endRowIndex",c=t.isStartRowRelative,h=t.isEndRowRelative,f=t[d],p=t[u],g=n-r,m=t.getOptions();if(c&&(l?(m[d]+=g,o=!0):f+r<0&&(m[d]=-r,o=!0)),h)if(l)m[u]+=g,o=!0;else if(p+r<0){var v=e.length-1;return"string"===typeof e[v]?e[v]=e[v].concat("#REF!"):e.push("#REF!"),o=!0,e}return e.push(a.ZP.createInstance(m)),e}),[]);return{isFormulaChanged:o,newFormulaModel:i.Z.createInstance({formulaPartList:s})}},e}(),d=function(){function e(e){this.externalMethods=e,this.updateFormulaModelLogic=new l({isSheetAmongTwoSheets:this.externalMethods.isSheetAmongTwoSheets,getSheetIdBySheetIndex:this.externalMethods.getSheetIdBySheetIndex,getSheetIndexBySheetId:this.externalMethods.getSheetIndexBySheetId}),this.strategyList=[]}var t=e.prototype;return t.registerStrategy=function(e){this.strategyList.push(e)},t.getChangedFormulaNode=function(e,t,n){var o=[];return e.id===r.ZP.INSERT_DIMENSION_MUTATION||e.id===r.ZP.DELETE_DIMENSION_MUTATION?o=this.updateFormulaModelLogic.getChangedNodesAfterRowColAddDelete(e,t,n):e.id===r.ZP.MAP_RANGE_MUTATION?o=this.updateFormulaModelLogic.getChangedNodesAfterRowColCutMoveMutation(e,t):e.id===r.ZP.REORDER_RANGE_MUTATION?o=this.updateFormulaModelLogic.getChangedNodesAfterReorderRangeMutation(e,t,n):e.id===r.ZP.DELETE_SHEET_MUTATION&&(o=this.updateFormulaModelLogic.getChangedNodesAfterSheetDeletedMutation(e,t)),o},e}()},"../spread-sheet/src/core/behavior/request/other/formula-model-service/UpdateFormulaModelServiceForModel.ts":function(e,t,n){"use strict";n.d(t,{Z:function(){return m}});var r=n("../node_modules/@babel/runtime/helpers/esm/inheritsLoose.js"),o=(n("../node_modules/core-js/modules/web.dom-collections.for-each.js"),n("../spread-sheet/src/core/behavior/request/other/formula-model-service/UpdateFormulaModelService.ts")),s=(n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.regexp.to-string.js"),n("../spread-sheet/src/core/behavior/request/other/formula-model-service/strategy-base/FormulaNodeStrategyBase.ts")),i=n("../packages/model/src/cell/index.ts"),a=function(e){function t(t,n){return e.call(this,t,n)||this}(0,r.Z)(t,e);var n=t.prototype;return n.updateModel=function(e){var t=this;e.forEach((function(e){var n=e.row,r=e.col,o=e.formulaModel,s=e.sheetId,a=t.externalMethods.getSheetBySheetId(s),l=null===a||void 0===a?void 0:a.getCellDataAtPosition(n,r);null===l&&(l=new i.CellData,null===a||void 0===a||a.setCellDataAtPosition(n,r,l)),null===l||void 0===l||l.setFormula(o),null===l||void 0===l||l.setEditValue(o.toString(n,r,{getSheetTitleBySheetId:t.externalMethods.getSheetTitleBySheetId}));var d=new i.CellDataDelta;d.setSlot(i.CELL_DATA_SLOT.SLOT_FORMULA,o),t.formulaModelManager.addFormulaData({row:e.oldRow,col:e.oldCol,sheetId:s},d)})),this.formulaModelManager.updateFormulaModelManagerDataFinish()},n.getUpdateFormulaModelMutationsFromNodes=function(){return[]},t}(s.Z),l=(n("../node_modules/core-js/modules/es.object.assign.js"),n("../packages/model/src/rule/ArgTokenType.ts")),d=n("../packages/model/src/cell/data-validation/index.ts"),u=function(e){function t(t,n){return e.call(this,t,n)||this}(0,r.Z)(t,e);var n=t.prototype;return n.updateModel=function(e){var t=this;e.forEach((function(e){var n=e.row,r=e.col,o=e.formulaModel,s=e.sheetId,a=e.dataValidation,u=t.externalMethods.getSheetBySheetId(s),c=null===u||void 0===u?void 0:u.getCellDataAtPosition(n,r),h=[{type:l.Z.FORMULA_TOKEN,formula:o}],f=d.eJ.createInstance(Object.assign(Object.assign({},a.getOptions()),{argTokens:h}));null===c||void 0===c||c.setDataValidation(f);var p=new i.CellDataDelta;p.setSlot(i.CELL_DATA_SLOT.SLOT_DATA_VALIDATION_RULE,a),t.formulaModelManager.addDataValidationData({row:e.oldRow,col:e.oldCol,sheetId:s},p)})),this.formulaModelManager.updateFormulaModelManagerDataFinish()},n.getUpdateFormulaModelMutationsFromNodes=function(){return[]},t}(n("../spread-sheet/src/core/behavior/request/other/formula-model-service/strategy-base/DataValidationStrategyBase.ts").Z),c=n("../packages/model/src/workbookRange/index.ts"),h=n("../packages/model/src/range/hexRangeUtils.ts"),f=n("../spread-sheet/src/core/utils/formula.ts"),p=n("../packages/model/src/range/GridRange.ts"),g=function(e){function t(t,n){return e.call(this,n,t)||this}(0,r.Z)(t,e);var n=t.prototype;return n.updateModel=function(e){var t=this;e.forEach((function(e){var n=e.workbookRangeId,r=e.embeddedObjectId,o=e.sheetId,s=e.row,i=e.col,a=e.formulaModel.toString(s,i,{getSheetTitleBySheetId:t.externalMethods.getSheetTitleBySheetId}),l=(0,f.moveEqualChar)(a),d="#REF!"===l?new p.Z(o,-1,-1,-1,-1):(0,h.hex2Range)(l,o),u=new c.ChartWorkbookRange({embeddedObjectId:r,id:n,range:d,type:c.WORKBOOK_RANGE_TYPE.CHART});t.workbookRangeManager.updateWorkbookRange(n,u)}))},n.getUpdateFormulaModelMutationsFromNodes=function(){return[]},t}(n("../spread-sheet/src/core/behavior/request/other/formula-model-service/strategy-base/ChartStrategyBase.ts").Z),m=function(e){function t(t,n,r){var o;return(o=e.call(this,t)||this).formulaModelManager=r,o.registerStrategy(new a(r,{getSheetBySheetId:t.getSheetBySheetId,getSheetIdList:t.getSheetIdList,getSheetTitleBySheetId:t.getSheetTitleBySheetId})),o.registerStrategy(new u(r,{getSheetBySheetId:t.getSheetBySheetId,getSheetIdList:t.getSheetIdList})),o.registerStrategy(new g(n,{getSheetBySheetId:t.getSheetBySheetId,getSheetTitleBySheetId:t.getSheetTitleBySheetId})),o}(0,r.Z)(t,e);var n=t.prototype;return n.generateUpdateFormulaModelMutation=function(){return[]},n.updateFormulaModelFromMutation=function(e,t){var n=this,r=(void 0===t?{isMovedNewPosition:!1}:t).isMovedNewPosition;this.strategyList.forEach((function(t){var o=t.getFormulaModelNodes(e.sheetId),s=n.getChangedFormulaNode(e,o,{isMovedNewPosition:r});t.updateModel(s)}))},t}(o.Z)},"../spread-sheet/src/core/behavior/request/other/formula-model-service/UpdateFormulaModelServiceForMutation.ts":function(e,t,n){"use strict";n.d(t,{lO:function(){return b}});var r=n("../node_modules/@babel/runtime/helpers/esm/inheritsLoose.js"),o=(n("../node_modules/core-js/modules/web.dom-collections.for-each.js"),n("../node_modules/core-js/modules/es.array.filter.js"),n("../node_modules/core-js/modules/es.object.values.js"),n("../packages/model/src/cell/CellDataDelta.ts")),s=n("../packages/model/src/cell/CellDataSlot.ts"),i=(n("../node_modules/core-js/modules/es.object.keys.js"),n("../packages/mutation/src/cell/SetRangeMutation.ts")),a=n("../packages/model/src/range/GridRange.ts");function l(e,t){var n=[],r={};e.forEach((function(e){if(!(e.row<0||e.col<0)){var n=t(e);if(n){var o=e.sheetId,s=e.row,i=e.col,a={rowIndex:s,colIndex:i,cellDataDelta:n};if(r[o]){var l=r[o];l.cellDataDeltaAtPositions.push(a),l.minRow=Math.min(l.minRow,s),l.maxRow=Math.max(l.maxRow,s),l.minCol=Math.min(l.minCol,i),l.maxCol=Math.max(l.maxCol,i)}else r[o]={cellDataDeltaAtPositions:[a],minCol:i,minRow:s,maxRow:s,maxCol:i}}}}));for(var o=0,s=Object.keys(r);o<s.length;o++){var l=s[o],d=r[l],u=d.minRow,c=d.minCol,h=d.maxRow,f=d.maxCol,p=d.cellDataDeltaAtPositions,g=new i.Z({gridRange:new a.Z(l,u,h,c,f),cellDataDeltaAtPositions:p});n.push(g)}return n}var d,u=function(e){function t(t,n){return e.call(this,t,n)||this}(0,r.Z)(t,e);var n=t.prototype;return n.updateModel=function(){},n.getUpdateFormulaModelMutationsFromNodes=function(e){return l(e,this.getFormulaCellDataDeltaFromNode.bind(this))},n.getFormulaCellDataDeltaFromNode=function(e){var t=e.formulaModel,n=new o.Z;return n.setSlot(s.Z.SLOT_FORMULA,t),n},t}(n("../spread-sheet/src/core/behavior/request/other/formula-model-service/strategy-base/FormulaNodeStrategyBase.ts").Z),c=(n("../node_modules/core-js/modules/es.object.assign.js"),n("../packages/model/src/rule/index.ts")),h=n("../packages/model/src/cell/index.ts"),f=function(e){function t(t,n){return e.call(this,t,n)||this}(0,r.Z)(t,e);var n=t.prototype;return n.updateModel=function(){},n.getUpdateFormulaModelMutationsFromNodes=function(e){return l(e,this.getFormulaCellDataDeltaFromNode.bind(this))},n.getFormulaCellDataDeltaFromNode=function(e){var t=e.formulaModel,n=e.dataValidation,r=[{type:c.ARG_TOKEN_TYPE.FORMULA_TOKEN,formula:t}],i=h.DataValidationRuleFactory.createInstance(Object.assign(Object.assign({},n.getOptions()),{argTokens:r})),a=new o.Z;return a.setSlot(s.Z.SLOT_DATA_VALIDATION_RULE,i),a},t}(n("../spread-sheet/src/core/behavior/request/other/formula-model-service/strategy-base/DataValidationStrategyBase.ts").Z),p=(n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.regexp.to-string.js"),n("../packages/model/src/workbookRange/index.ts")),g=n("../packages/model/src/range/hexRangeUtils.ts"),m=n("../spread-sheet/src/core/utils/formula.ts"),v=n("../packages/mutation/src/workbook/workbookRange/UpdateWorkbookRangeMutation.ts"),I=function(e){function t(t,n,r){var o;return(o=e.call(this,r,t)||this).embeddedObjectManager=n,o}(0,r.Z)(t,e);var n=t.prototype;return n.updateModel=function(){},n.getUpdateFormulaModelMutationsFromNodes=function(e){var t=this,n=[];return e.forEach((function(e){var r=e.formulaModel,o=e.row,s=e.col,i=e.sheetId,l=e.workbookRangeId,d=r.toString(o,s,{getSheetTitleBySheetId:t.externalMethods.getSheetTitleBySheetId}),u=(0,m.moveEqualChar)(d),c="#REF!"===u?new a.Z(i,-1,-1,-1,-1):(0,g.hex2Range)(u,i),h=t.generateUpdateWorkbookRangeMutation(l,c);h&&n.push(h)})),n},n.generateUpdateWorkbookRangeMutation=function(e,t){var n=this.workbookRangeManager.getChartWorkbookRangeById(e);if(!n)return null;var r=n.embeddedObjectId,o=this.embeddedObjectManager.getEmbeddedObject(r);if(!o)return null;var s=new p.WorkbookRangeDelta;return s.setEmbeddedObjectId(o.objectId),new v.Z({gridRange:t,workbookRangeId:e,workbookRangeType:p.WORKBOOK_RANGE_TYPE.CHART,workbookRangePropertiesDelta:s})},t}(n("../spread-sheet/src/core/behavior/request/other/formula-model-service/strategy-base/ChartStrategyBase.ts").Z),E=n("../node_modules/@babel/runtime/helpers/esm/toConsumableArray.js"),S=(n("../node_modules/core-js/modules/es.array.iterator.js"),n("../node_modules/core-js/modules/es.map.js"),n("../node_modules/core-js/modules/es.string.iterator.js"),n("../node_modules/core-js/modules/esnext.map.delete-all.js"),n("../node_modules/core-js/modules/esnext.map.every.js"),n("../node_modules/core-js/modules/esnext.map.filter.js"),n("../node_modules/core-js/modules/esnext.map.find.js"),n("../node_modules/core-js/modules/esnext.map.find-key.js"),n("../node_modules/core-js/modules/esnext.map.includes.js"),n("../node_modules/core-js/modules/esnext.map.key-of.js"),n("../node_modules/core-js/modules/esnext.map.map-keys.js"),n("../node_modules/core-js/modules/esnext.map.map-values.js"),n("../node_modules/core-js/modules/esnext.map.merge.js"),n("../node_modules/core-js/modules/esnext.map.reduce.js"),n("../node_modules/core-js/modules/esnext.map.some.js"),n("../node_modules/core-js/modules/esnext.map.update.js"),n("../node_modules/core-js/modules/web.dom-collections.iterator.js"),n("../node_modules/core-js/modules/es.array.sort.js"),n("../node_modules/core-js/modules/es.array.concat.js"),n("../spread-sheet/src/core/behavior/request/other/formula-model-service/strategy-base/ConditionalFormatStrategyBase.ts")),R=n("../packages/mutation/src/conditionalFormat/DeleteConditionalFormatMutation.ts"),w=n("../packages/mutation/src/conditionalFormat/UpdateConditionalFormatMutation.ts"),A=n("../packages/model/src/range/index.ts"),C=n("../packages/model/src/range/gridRangeUtils.ts"),y=function(e){function t(t,n){var r;return(r=e.call(this,t,n)||this).changedRuleMap=new Map,r.updateRuleByChangedNode=function(e){var t,n=e.ruleIndex,o=e.isCustomFormulaNode,s=e.isRuleRangeNode,i=e.formulaModel,a=e.sheetId,l=r.getOrCreateNeedUpdateRule(n,a);if(l&&(s&&(l.newRule.ruleRanges=r.getGridRangesFromChangedNode(e)),o)){var d=((null===(t=l.newRule.booleanConditionalFormat)||void 0===t?void 0:t.condition.values)||[])[0];(null===d||void 0===d?void 0:d.formula)&&(d.formula=i)}},r}(0,r.Z)(t,e);var n=t.prototype;return n.updateModel=function(){},n.getUpdateFormulaModelMutationsFromNodes=function(e){return this.changedRuleMap.clear(),e.forEach(this.updateRuleByChangedNode),this.generateMutationsByNewRuleMap()},n.generateMutationsByNewRuleMap=function(){var e=this,t=[],n=[];this.changedRuleMap.forEach((function(r,o){if(0!==r.newRule.ruleRanges.length){var s=e.generateUpdateMutation(r,o);void 0!==s&&t.push(s)}else{var i=e.generateDeleteMutation(r,o);void 0!==i&&n.push(i)}}));var r=n.sort((function(e,t){return t.ruleIndex-e.ruleIndex}));return[].concat(t,(0,E.Z)(r))},n.getOrCreateNeedUpdateRule=function(e,t){var n;if(this.changedRuleMap.has(e))return this.changedRuleMap.get(e);var r=null===(n=this.getConditionalFormatRuleManager(t))||void 0===n?void 0:n.getRuleByRuleIndex(e);if(r){var o={oldRule:r.rule,newRule:r.rule.clone()};return this.changedRuleMap.set(e,o),o}},n.getGridRangesFromChangedNode=function(e){var t=this,n=e.row,r=e.col,o=e.sheetId,s=e.formulaModel,i=[];return s.getAllCellRangeWithFixedInfo().forEach((function(e){var s=e.toString(n,r,{getSheetTitleBySheetId:t.externalMethods.getSheetTitleBySheetId});"#REF"!==s?i.push((0,g.hex2Range)(s,o)):i.push(new A.GridRange(o,-1,-1,-1,-1))})),(0,C.mergeGridRanges)(i)},n.generateDeleteMutation=function(e,t){var n=e.oldRule,r=n.ruleRanges[0];if(r&&r.sheetId){var o=r.sheetId;if((n.ruleRanges||[])[0])return new R.Z({sheetId:o,ruleIndex:t,oldRuleRanges:n.ruleRanges})}},n.generateUpdateMutation=function(e,t){var n,r=e.newRule,o=(r.ruleRanges||[])[0];if(o){var s=o.sheetId,i=null===(n=this.getConditionalFormatRuleManager(s))||void 0===n?void 0:n.getRuleByRuleIndex(t);if(i)return new w.Z({sheetId:s,ruleIndex:i.index,oldRuleRanges:i.rule.ruleRanges,rule:new c.ConditionalFormatRule({uid:i.rule.uid,ruleRanges:r.ruleRanges,booleanConditionalFormat:r.booleanConditionalFormat,gradientConditionalFormat:r.gradientConditionalFormat,dataBarConditionalFormat:r.dataBarConditionalFormat})})}},t}(S.Z),_=n("../spread-sheet/src/core/behavior/request/other/formula-model-service/UpdateFormulaModelService.ts"),T=n("../packages/common-utils/src/index.ts"),x=function(e){function t(t,n,r,o){var s;return(s=e.call(this,t)||this).registerStrategy(new u(o,{getSheetBySheetId:t.getSheetBySheetId,getSheetIdList:t.getSheetIdList,getSheetTitleBySheetId:t.getSheetTitleBySheetId})),s.registerStrategy(new f(o,{getSheetBySheetId:t.getSheetBySheetId,getSheetIdList:t.getSheetIdList})),s.registerStrategy(new I(n,r,{getSheetBySheetId:t.getSheetBySheetId,getSheetTitleBySheetId:t.getSheetTitleBySheetId})),s.registerStrategy(new y({getSheetBySheetId:t.getSheetBySheetId,getSheetTitleBySheetId:t.getSheetTitleBySheetId},o)),s}(0,r.Z)(t,e);var n=t.prototype;return n.generateUpdateFormulaModelMutation=function(e,t){var n=this,r=(void 0===t?{isMovedNewPosition:!1}:t).isMovedNewPosition,o=[];return this.strategyList.forEach((function(t){var s=t.getFormulaModelNodes(e.sheetId),i=n.getChangedFormulaNode(e,s,{isMovedNewPosition:r,onlyRefRangeChange:t.onlyRefRangeChange}),a=t.getUpdateFormulaModelMutationsFromNodes(i);Array.prototype.push.apply(o,a)})),o},n.updateFormulaModelFromMutation=function(){},n.getInvertMutationsForRowReorderMutation=function(e){var t=e.operation.rules,n=e.sheetId,r=this.getMigrationMapForRowReorderFromRules({rules:t,sheetId:n}),o=[];return this.strategyList.forEach((function(t){var n=t.getFormulaModelNodes(e.sheetId).reduce((function(e,t){var n=t.row,o=r[n];return(0,T.o8)(o)||e.push(t),e}),[]),s=t.getUpdateFormulaModelMutationsFromNodes(n);Array.prototype.push.apply(o,s)})),o},n.getInvertMutationsForDeleteDimensionMutation=function(e){var t=e.amount,n=e.index,r=e.sheetId,o=e.type.toLowerCase().indexOf("row")>-1,s=[];return this.strategyList.forEach((function(e){var i=e.getFormulaModelNodes(r).filter((function(e){var s=e.formulaModel,i=e.sheetId,a=e.row,l=e.col;return s.isAffectedByRowColDel({index:n,amount:t,isRow:o,sheetId:r,nodeSheetId:i,row:a,col:l})})),a=e.getUpdateFormulaModelMutationsFromNodes(i);Array.prototype.push.apply(s,a)})),s},n.getMigrationMapForRowReorderFromRules=function(e){var t=e.rules,n=e.sheetId;return Object.values(t||{}).reduce((function(e,t){var r=t.from,o=t.to;return e[r]={num:o,destinationSheetId:n,sourceSheetId:n},e}),{})},t}(_.Z);function b(e,t,n,r){return d||(d=new x(e,t,n,r)),d}},"../spread-sheet/src/core/behavior/request/range/common/check-range-auth.ts":function(e,t,n){"use strict";n.d(t,{N2:function(){return i}}),n("../node_modules/core-js/modules/es.array.includes.js");var r=n("../packages/model/src/range/GridRange.ts"),o=n("../spread-sheet/src/core/behavior/request/range/common/getEffectRange.ts"),s=n("../spread-sheet/src/core/behavior/request/range/config.ts"),i=function(e,t,n,i,a){void 0===a&&(a=s.Us.INSERT);var l=t.select;if(!l||l.selectAll||l.selectCol||l.selectRow)return!1;var d=l.xRange,u=l.yRange,c=e.getSheetId(),h=new r.Z({sheetId:c,startRowIndex:u[0],endRowIndex:u[1],startColIndex:d[0],endColIndex:d[1]}),f=(0,o.e)(e,a,i,h);return n.getRangeCanEdit(f)}},"../spread-sheet/src/core/behavior/request/range/common/checkAuth.ts":function(e,t,n){"use strict";n.d(t,{w:function(){return r}});var r=function(e,t){return!(t.spreadsheetReference.parent.sheetStatus.getRangeCanEdit(e)&&t.spreadsheetReference.parent.sheetStatus.isRangeCanEditByHighWater(e))}},"../spread-sheet/src/core/behavior/request/range/common/checkMergeCellConflict.ts":function(e,t,n){"use strict";n.d(t,{k:function(){return r}});var r=function(e,t){return t.mergeManager.mergeList.some((function(t){var n=e.getCross(t);return!(!n||n.equal(t))}))}},"../spread-sheet/src/core/behavior/request/range/common/get-grid-data-size.ts":function(e,t,n){"use strict";n.d(t,{x:function(){return o}}),n("../node_modules/core-js/modules/es.array.iterator.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/web.dom-collections.iterator.js");var r=n("../spread-sheet/src/core/behavior/request/range/config.ts"),o=function(e){return e.rowData.reduce((function(e,t){return t?e+t.values.reduce(s,0):e}),0)},s=function(e,t){if(t){var n=t.getEffectiveValue();if(n&&"string"===typeof n.value)return e+r.SL+n.value.length}return e+r.SL}},"../spread-sheet/src/core/behavior/request/range/common/getEffectRange.ts":function(e,t,n){"use strict";n.d(t,{e:function(){return s}});var r=n("../spread-sheet/src/core/behavior/request/range/config.ts"),o=n("../packages/model/src/range/GridRange.ts"),s=function(e,t,n,s){var l=s.startRowIndex,d=s.startColIndex,u=function(e,t,n,o){var s=n.endRowIndex,l=n.endColIndex,d=0,u=0;return o===r.Us.INSERT?t===r.ai.RIGHT?(d=s,u=n.getColCount()+a(e,n)):(u=l,d=n.getRowCount()+i(e,n)):t===r._z.LEFT?(d=s,u=a(e,n)):(u=l,d=i(e,n)),{bottom:d,right:u}}(e,n,s,t),c=u.bottom,h=u.right;return new o.Z({sheetId:e.getSheetId(),startRowIndex:l,endRowIndex:c,startColIndex:d,endColIndex:h})};function i(e,t){for(var n=t.startColIndex,r=t.endColIndex,o=t.endRowIndex,s=e.getRowCount(),i=[],a=n;a<=r;a+=1)for(var d=s-1;d>=0;d-=1)if(!l(e.getCellDataAtPosition(d,a))){i.push(d);break}return Math.max(Math.max.apply(Math,i),o)}function a(e,t){for(var n=t.startRowIndex,r=t.endRowIndex,o=t.endColIndex,s=[],i=e.getColCount(),a=n;a<=r;a+=1)for(var d=i-1;d>=0;d-=1)if(!l(e.getCellDataAtPosition(a,d))){s.push(d);break}return Math.max(Math.max.apply(Math,s),o)}function l(e){return!e||e.isEmpty()&&!e.getMergeReference()&&!e.getSheetRangeReferences()}},"../spread-sheet/src/core/behavior/request/range/config.ts":function(e,t,n){"use strict";n.d(t,{SL:function(){return l},Us:function(){return s},VY:function(){return a},Zw:function(){return d},_z:function(){return o},ai:function(){return r}});var r,o,s,i=n("../packages/model/src/cell/CellDataSlot.ts");!function(e){e.RIGHT="right",e.DOWN="down"}(r||(r={})),function(e){e.LEFT="left",e.UP="up"}(o||(o={})),function(e){e.INSERT="insert",e.DELETE="delete"}(s||(s={}));var a=1e3,l=50,d=0|1<<i.Z.SLOT_EFFIECTIVE_VALUE|1<<i.Z.SLOT_HYPERLINK|1<<i.Z.SLOT_USER_ENTERED_FORMAT_DELTA|1<<i.Z.SLOT_FORMULA|1<<i.Z.SLOT_RICH_TEXT_STYLE_RUN},"../spread-sheet/src/core/behavior/request/reorder/ReorderType.ts":function(e,t){"use strict";var n;!function(e){e[e.ReverseOrder=0]="ReverseOrder",e[e.PositiveSequence=1]="PositiveSequence"}(n||(n={})),t.Z=n},"../spread-sheet/src/core/behavior/request/reorder/valueSort.ts":function(e,t,n){"use strict";n.d(t,{h4:function(){return _}}),n("../node_modules/core-js/modules/es.regexp.exec.js"),n("../node_modules/core-js/modules/es.string.replace.js"),n("../node_modules/core-js/modules/es.math.sign.js");var r,o=n("../node_modules/@tencent/sheet-formula-sdk/lib/index.js"),s=n("../packages/model/src/cell/metadata/CustomDataType.ts"),i=n("../node_modules/pinyin/lib/web-pinyin.js"),a=n.n(i);!function(e){e[e.KEEP=1]="KEEP",e[e.EXCHANGE=-1]="EXCHANGE",e[e.EQUAL=0]="EQUAL"}(r||(r={}));var l=function(e){return e?r.EXCHANGE:r.KEEP},d=function(e){return e?r.KEEP:r.EXCHANGE},u=function(e,t,n){return e<t?l(n):e>t?d(n):r.EQUAL},c=function(e,t,n,r,o){var s=function(e,t,n){return y(e,t,n,C)}(r,o,n);if(null!==s)return s;var i="number"===typeof e,a="number"===typeof t;if(i&&a){var c=parseFloat(e),h=parseFloat(t);return u(c,h,n)}return i?d(n):a?l(n):null},h=function(e){if("string"!==typeof e)return!1;var t=e.toUpperCase();return"TRUE"===t||"FALSE"===t},f=function(e,t,n,r,o){var s=function(e,t,n){return y(e,t,n,A)}(r,o,n);if(null!==s)return s;"string"===typeof e&&(e=e.toLowerCase()),"string"===typeof t&&(t=t.toLowerCase());var i=h(e),a=h(t);return i&&a?u(e,t,n):i?d(n):a?l(n):null},p=function(e){return"string"===typeof e?o.Pz.hasError(e):!("object"!==typeof e||!e.displayText)&&o.Pz.hasError(e.displayText)},g=function(e){return"string"===typeof e&&/^\s+/.test(e+="")},m=function(e){return"string"===typeof e&&(e=e[0],/[!"#\$%&()\*,\.\/:;\?@\[\\,\]\^_\\`{|}~+<=>]+/gi.test(e+="")||/[！。？、；：“”【】〔（）\[\]「」}〕．《》·—_*×□▲●～→]+/gi.test(e))},v=["!",'"',"#","$","%","&","(",")","*",",",".","/",":",";","?","@","[","\\","]","^","_","`","{","|","}","~","+","<",">"],I=function(e){return"string"===typeof e&&!g(e)&&!m(e)},E=function(e){return-1!==e.indexOf("-")?e.replace(/-/gi,""):e},S=function(e){return-1!==e.indexOf("'")?e.replace(/'/gi,""):e},R=function(e){return/[\u4e00-\u9fa5]+/g.test(e)},w=function(e,t,n){if("string"===typeof e&&(e=e.toLowerCase()),"string"===typeof t&&(t=t.toLowerCase()),"string"!==typeof e&&"string"!==typeof t)return null;var r=function(e,t,n){var r=I(t),o=I(e);return r&&(t=E(t),t=S(t)),o&&(e=E(e),e=S(e)),R(t)&&R(e)?n?a().compare(e,t):a().compare(t,e):o&&r?u(e,t,n):o?d(n):r?l(n):null}(e,t,n);if(null!=r)return r;var o=function(e,t,n){var r=m(e)&&!g(e),o=m(t)&&!g(t);if(r&&o){var s=v.indexOf(t),i=v.indexOf(e);return-1!=s&&-1!=i?u(i,s,n):u(e,t,n)}return r?d(n):o?l(n):null}(e,t,n);if(null!=o)return o;var s=function(e,t,n){var r=g(e[0]),o=g(t[0]);return r&&o?u(e,t,n):r?d(n):o?l(n):null}(e,t,n);return null!=s?s:null};function A(e){var t,n,r=null===(t=e.getEffectiveValue())||void 0===t?void 0:t.value;return(null===(n=e.getMetadata())||void 0===n?void 0:n.customDataType)===s.ZP.CHECKBOX&&"string"===typeof r?{weight:r===s.Nf?2:-1,isSpecialType:!0}:!0===r||"string"===typeof r&&/^true$/i.test(r)?{weight:1,isSpecialType:!1}:!1===r||"string"===typeof r&&/^false$/i.test(r)?{weight:-2,isSpecialType:!1}:{weight:0,isSpecialType:!1}}function C(e){var t,n,r=null===(t=e.getEffectiveValue())||void 0===t?void 0:t.value;return(null===(n=e.getMetadata())||void 0===n?void 0:n.customDataType)===s.ZP.STAR&&"string"===typeof r?{weight:2*(r.lastIndexOf(s.KH)+1+1),isSpecialType:!0}:"number"===typeof r&&r>=0&&r<=5?{weight:2*r+1,isSpecialType:!1}:{weight:0,isSpecialType:!1}}function y(e,t,n,r){var o=r(e),s=o.weight,i=o.isSpecialType,a=r(t),l=a.weight,d=a.isSpecialType;return(i||d)&&s&&l?Math.sign(s-l)*(n?1:-1):null}var _=function(e,t,n,o,i){var a=n.type,u=function(e,t){var n=null===e||""===e||void 0===e,o=null===t||""===t||void 0===t;return n&&o?r.EQUAL:n?r.KEEP:o?r.EXCHANGE:null}(e,t);if(null!==u)return u;var h=function(e,t){var n,o,i=(null===(n=e.getMetadata())||void 0===n?void 0:n.customDataType)===s.ZP.IMAGE,a=(null===(o=t.getMetadata())||void 0===o?void 0:o.customDataType)===s.ZP.IMAGE;return i&&a?r.EQUAL:i?r.KEEP:a?r.EXCHANGE:null}(o,i);if(null!==h)return h;var g=function(e,t,n){var o=p(e),s=p(t);return o&&s?r.EQUAL:o?d(n):s?l(n):null}(e,t,a);if(null!==g)return g;var m=f(e,t,a,o,i);if(null!==m)return m;var v=w(e,t,a);if(null!==v)return v;var I=c(e,t,a,o,i);return null!==I?I:r.EQUAL}},"../spread-sheet/src/core/behavior/request/utils/index.ts":function(e,t,n){"use strict";n.d(t,{wP:function(){return u},Xi:function(){return o},mX:function(){return I}}),n("../packages/model/src/cell/CellFormatDelta.ts");var r=n("../packages/model/src/range/DimensionRange.ts");function o(e,t,n){for(var o=[],s=1,i=e[0],a=e[0];s<e.length;s++)e[s]!==e[s-1]+1&&(a=e[s-1],o.push(new r.Z(t,i,a,n)),i=e[s]);return a=e[s-1],o.push(new r.Z(t,i,a,n)),o}var s,i=n("../packages/model/src/cell/format/BorderType.ts"),a=n("../packages/model/src/cell/format/BorderStyle.ts"),l=n("../packages/model/src/cell/format/colorUtils.ts");function d(e,t){var n,r=null;return e&&(r=null===(n=e.getUserEnteredFormat())||null===n.getBorders()||null===n.getBorders()[t]?null:n.getBorders()[t]),r}function u(e,t,n,r,o){var s=e.getCellDataAtPosition(t,n),a=null,u=null,h=null;if(!o&&null===s)return null;switch(r){case i.Z.TOP:o&&(a=e.getCellDataAtPosition(t-1,n)),u=d(s,r),h=d(a,i.Z.BOTTOM);break;case i.Z.RIGHT:o&&(a=e.getCellDataAtPosition(t,n+1)),u=d(s,r),h=d(a,i.Z.LEFT);break;case i.Z.BOTTOM:o&&(a=e.getCellDataAtPosition(t+1,n)),u=d(s,r),h=d(a,i.Z.TOP);break;case i.Z.LEFT:o&&(a=e.getCellDataAtPosition(t,n-1)),u=d(s,r),h=d(a,i.Z.RIGHT);break;case i.Z.DIAG_UP:case i.Z.DIAG_DOWN:u=d(s,r),h=void 0}return function(e,t,n){if(!t||null===t.style)return 1;if(!e||null===e.style)return-1;var r=function(e,t){return t.style?e.style?c[e.style]-c[t.style]:-1:1}(e,t);return 0===r?function(e,t,n){return t?e?(0,l.compareColorByBrightness)(e.color,t.color,n):-1:1}(e,t,n):r}(u,h,e.spreadsheetReference)>0?u:h}var c=((s={})[a.Z.NONE]=0,s[a.Z.HAIR]=1,s[a.Z.DASH_DOT]=2,s[a.Z.DASH_DOT_DOT]=3,s[a.Z.DOTTED]=4,s[a.Z.DASHED]=5,s[a.Z.THIN]=6,s[a.Z.MEDIUM_DASH_DOT_DOT]=7,s[a.Z.SLANTED_DASH_DOT]=8,s[a.Z.MEDIUM_DASH_DOT]=9,s[a.Z.MEDIUM_DASHED]=10,s[a.Z.MEDIUM]=11,s[a.Z.THICK]=12,s[a.Z.DOUBLE]=13,s);n("../node_modules/core-js/modules/es.array.slice.js"),n("../node_modules/core-js/modules/es.array.sort.js"),n("../node_modules/core-js/modules/es.array.map.js"),n("../node_modules/core-js/modules/es.object.keys.js"),n("../node_modules/core-js/modules/es.array.splice.js"),n("../node_modules/core-js/modules/es.object.assign.js"),n("../node_modules/core-js/modules/es.string.bold.js"),n("../node_modules/core-js/modules/es.string.italics.js"),n("../node_modules/core-js/modules/web.dom-collections.for-each.js"),n("../node_modules/core-js/modules/es.array.filter.js");var h=n("../packages/model/src/cell/CellFormatSlot.ts"),f=n("../packages/model/src/cell/CellDataDelta.ts"),p=n("../packages/model/src/cell/CellDataSlot.ts"),g=n("../spread-sheet/src/core/utils/cell.ts"),m=n("../packages/model/src/cell/TextFormatRun.ts"),v=n("../packages/model/src/cell/format/TextFormat.ts");function I(e,t,n,r){var o,s=r.delta.userEnteredFormatDelta,i=new f.Z,a=e.getCellDataAtPosition(t,n,{isIgnoreFilterView:!0}),l=!1;if(null===a||null===s||void 0===s)return i;if(null===(o=a.getTextFormatRuns())||0===o.length)return i;o=o.slice();var d=a.getMentionDetails(),u=[];return d&&(u=Object.keys(d).map((function(e){var t=d[e].pos;return[t[0],t[1]]})).sort((function(e,t){return e[0]-t[0]})),o=function(e,t,n){for(var r,o,s=[],i=t.length,a=0;a<i;a++)r=t[a],o=a+1<i?t[a+1]:null,R([r.startIndex,o?o.startIndex:e.length],n).forEach((function(e){s.push(m.Z.createInstance({startIndex:e.pos[0],format:r.format||null}))}));return s}((0,g.getMergedValue)(a),o,u)),l=l||function(e,t,n){var r,o=!1,s=n.clearSlots,i=!1;for(r=0;s>0;s>>=1,r++){if(1===(1&s))switch(r){case h.Z.FOREGROUND_COLOR:i=E(e,t,"color",null);break;case h.Z.FONT_FAMINY:i=E(e,t,"fontFamily",null);break;case h.Z.FONT_SIZE:i=E(e,t,"fontSize",null);break;case h.Z.BOLD:i=E(e,t,"bold",null);break;case h.Z.ITALIC:i=E(e,t,"italic",null);break;case h.Z.STRIKETHROUGH:i=E(e,t,"strikethrough",null);break;case h.Z.UNDERLINE:i=E(e,t,"underline",null)}o=o||i}return o}(o,u,s),l=l||function(e,t,n){var r,o=!1,s=n.setSlots,i=!1;for(r=0;s>0;s>>=1,r++){if(1===(1&s))switch(r){case h.Z.FOREGROUND_COLOR:i=E(e,t,"color",n.delta.getTextFormat().color);break;case h.Z.FONT_FAMINY:i=E(e,t,"fontFamily",n.delta.getTextFormat().fontFamily);break;case h.Z.FONT_SIZE:i=E(e,t,"fontSize",n.delta.getTextFormat().fontSize);break;case h.Z.BOLD:i=E(e,t,"bold",n.delta.getTextFormat().bold);break;case h.Z.ITALIC:i=E(e,t,"italic",n.delta.getTextFormat().italic);break;case h.Z.STRIKETHROUGH:i=E(e,t,"strikethrough",n.delta.getTextFormat().strikethrough);break;case h.Z.UNDERLINE:i=E(e,t,"underline",n.delta.getTextFormat().underline)}o=o||i}return o}(o,u,s),l&&i.setSlot(p.Z.SLOT_RICH_TEXT_STYLE_RUN,o),i}function E(e,t,n,r){var o,s,i,a=!1;for(s=0;s<e.length;s++){var l;S(t,(i=e[s]).startIndex)||(e.splice(s,1,m.Z.createInstance(Object.assign(Object.assign({},i.getOptions()),{format:v.Z.createInstance(Object.assign(Object.assign({},null===(o=i.format)||void 0===o?void 0:o.getOptions()),(l={},l[n]=r,l)))}))),a=!0)}return a}function S(e,t){if(!e.length)return!1;for(var n=0;n<e.length;n++)if(e[n][0]===t)return!0;return!1}function R(e,t){if(!t||!t.length)return[{pos:e,isMention:!1}];var n=[],r=t.filter((function(t){return e[0]<=t[0]&&t[1]<=e[1]}));if(r.length>0){for(var o,s=e[0],i=0;i<r.length;i++)s<(o=r[i])[0]&&n.push({pos:[s,o[0]],isMention:!1}),n.push({pos:o,isMention:!0}),s=o[1];return s<e[1]&&n.push({pos:[s,e[1]],isMention:!1}),n}return[{pos:e,isMention:!1}]}},"../spread-sheet/src/core/behavior/request/workbook/filterUtils/calc-hidden-rows.ts":function(e,t,n){"use strict";n.d(t,{W:function(){return s}}),n("../node_modules/core-js/modules/web.dom-collections.for-each.js");var r=n("../packages/mutation/src/filter/UpdateFilterMutation.ts"),o=n("../spread-sheet/src/core/behavior/request/workbook/filterUtils/calcFilteredRows.ts");function s(e,t,n,s){var i=t.updateColumnCriteriaDelta;if(!t.defaultFilterId)return[];var a=e.getBasicFilter(!1,n).clone();return n&&s&&(a.sortSpecs=s,e.filterViewManager.getFilterViewByViewId(n).reorderRows(a)),i.forEach((function(e){(0,r.Jl)(e,a)})),(0,o.og)(a,e,{formulaCalculator:e.spreadsheetReference.parent.calcController.getResultBySingleFormula,getSheetTitleBySheetId:function(t){return e.spreadsheetReference.sheetManager.getSheetTitleBySheetId(t)}})}},"../spread-sheet/src/core/behavior/request/workbook/filterUtils/getExtendFilterRangeMutation.ts":function(e,t,n){"use strict";n("../node_modules/core-js/modules/web.dom-collections.for-each.js");var r=n("../packages/mutation/src/filter/UpdateFilterMutation.ts"),o=n("../packages/model/src/range/GridRange.ts"),s=n("../spread-sheet/src/core/behavior/request/workbook/filterUtils/handleFilterRange.ts");t.Z=function(e,t){var n;if(!function(e,t){var n,r=!1,s=e.getBasicFilter();if(!s||!t)return!1;if(null===(n=s.filterViewReference)||void 0===n?void 0:n.filterViewId)return!1;var i=s.range,a=new o.Z(i.sheetId,i.endRowIndex+1,i.endRowIndex+1,i.startColIndex,i.endColIndex);return t.forEach((function(e){if(e.isCross(a))return r=!0,!1})),r}(e,t))return[];var i=e.getSheetId(),a=e.getBasicFilter();if(a){var l=null===(n=a.filterViewReference)||void 0===n?void 0:n.filterViewId,d=function(e,t,n){for(var r=t.startRowIndex,i=t.endRowIndex,a=t.startColIndex,l=t.endColIndex,d=e.getRowCount()-1,u=i,c=i+1;c<=d;c++){for(var h=!0,f=a;f<=l;f++)if(!(0,s.c8)(e,c,f,n)){h=!1;break}if(h)break;u=c}return new o.Z(t.sheetId,r,u,a,l)}(e,a.range);return[new r.ZP({updateType:r.Qn.UPDATE,sheetId:i,filterViewId:l,workbookRangeId:a.workbookRangeId,delta:{defaultFilterId:a.workbookRangeId,range:d}})]}return[]}},"../spread-sheet/src/core/behavior/request/workbook/filterUtils/handleFilterRange.ts":function(e,t,n){"use strict";n.d(t,{Og:function(){return a},bb:function(){return v},c8:function(){return h},st:function(){return l},uY:function(){return r}}),n("../node_modules/core-js/modules/es.regexp.exec.js"),n("../node_modules/core-js/modules/es.string.replace.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.regexp.to-string.js");var r,o=n("../packages/model/src/range/GridRange.ts"),s=n("../spread-sheet/src/core/behavior/request/workbook/filterUtils/searchCloseDataArea.ts"),i=n("../spread-sheet/src/core/feature/relateForm/seeker-util.ts");function a(e,t){return t.startRowIndex===t.endRowIndex?function(e,t){var n=t.startColIndex,a=t.endColIndex,l=(0,i.ns)(e),c=null===l||void 0===l?void 0:l.contain(t);return n!==a||c?function(e,t){var n,s=t.startColIndex,i=t.endColIndex,a=e.getColCount()-1,l=t,c=d(e,t),h=u(e,c),f=h[0],p=h[1],m=e.getCellDataAtPosition(c.startRowIndex,p),v=null===m||void 0===m?void 0:m.getMergeReference();return v&&v.endColIndex>p&&(p=v.endColIndex),l=new o.Z(t.sheetId,c.startRowIndex,c.endRowIndex,f,p),n=s===i?r.SINGLE_CELL:0===s&&i===a?r.ONE_ROW_WHOLE:r.ONE_ROW_PART,[l,n,g(e,t)]}(e,t):[(0,s.ZP)(e,t),r.SINGLE_CELL,g(e,t)]}(e,t):function(e,t){var n=t.startRowIndex,a=t.endRowIndex,l=t.startColIndex,c=t.endColIndex,f=e.getRowCount()-1,v=(0,i.ns)(e),I=null===v||void 0===v?void 0:v.contain(t);if(function(e,t,n){return 0===e&&t===n}(n,a,f)){var E=function(e,t){var n=t.startColIndex,r=t.endColIndex,s=function(e,t){for(var n,r,o=t.startRowIndex,s=t.endRowIndex,i=t.startColIndex,a=t.endColIndex,l=function(t){for(var n=i-1;n<=a+1;n++)if(!h(e,t,n))return!1;return!0},d=o;d<=s;d++)if(!l(d)){n=d;break}if(void 0===n)return[o,o];for(var u=s;u>n;u--)if(!l(u)){r=u;break}return void 0===r&&(r=n),[n,r]}(e,t),i=s[0],a=s[1],l=new o.Z(t.sheetId,i,a,n,r),d=u(e,l),c=d[0],f=d[1];return new o.Z(t.sheetId,i,a,c,f)}(e,t),S=function(e,t){return e===t?r.ONE_COL_WHOLE:r.MULTI_COL_WHOLE}(l,c);return[E,S,g(e,t)]}if(function(e,t,n){return p(e,t)&&!n}(e,t,I))return[(0,s.ZP)(e,t),r.SINGLE_MERGE_CELL,g(e,t)];if(function(e,t,n){return function(e,t){for(var n=t.startRowIndex,r=t.endRowIndex,o=t.startColIndex,s=t.endColIndex,i=o;i<=s;i++){var a=e.getCellDataAtPosition(n,i),l=null===a||void 0===a?void 0:a.getMergeReference();if(l&&l.endRowIndex===r)return!0}return!1}(e,t)||n}(e,t,I))return function(e,t){var n,s=e.startRowIndex,i=e.endRowIndex,a=e.startColIndex,l=e.endColIndex,c=e,h=new o.Z(e.sheetId,i,i,a,l);h=d(t,h),h=new o.Z(e.sheetId,s,h.endRowIndex,a,l);var f=u(t,h),v=f[0],I=f[1];return c=new o.Z(e.sheetId,s,h.endRowIndex,v,I),n=p(t,e)?r.SINGLE_MERGE_CELL:r.MULTI_ROW_COL,c.equal(e)||(c=function(e,t){for(var n=t.startRowIndex,r=t.sheetId,s=t.startRowIndex,i=t.endRowIndex,a=t.startColIndex,l=t.endColIndex,d=s===i?i:s+1,u=s;u<=d&&(m(e,new o.Z(r,u,u,a,l))&&u<=d);u+=1){if(u===d){n=s;break}n=u+1}return new o.Z(r,n,t.endRowIndex,t.startColIndex,t.endColIndex)}(t,c)),[c,n,g(t,e)]}(t,e);var R=u(e,t),w=R[0],A=R[1];return[new o.Z(t.sheetId,t.startRowIndex,t.endRowIndex,w,A),r.MULTI_ROW_COL,g(e,t)]}(e,t)}function l(e,t){return!function(e,t){for(var n=t.startRowIndex;n<=t.endRowIndex;n++)for(var r=t.startColIndex;r<=t.endColIndex;r++)if(!h(e,n,r))return!1;return!0}(e,t)||!!function(e,t){var n=t.startRowIndex,r=t.endRowIndex,o=t.startColIndex,s=t.endColIndex;return n===r&&o===s||!!p(e,t)}(e,t)&&!(0,s.ZP)(e,t).equal(t)}function d(e,t){for(var n=t.startRowIndex,r=t.endRowIndex,s=t.startColIndex,i=t.endColIndex,a=e.getRowCount()-1,l=r,d=n;d<=a;d++){for(var u=!0,c=s;c<=i;c++)if(!h(e,d,c)){u=!1;break}if(u)break;l=d}return new o.Z(t.sheetId,n,l,s,i)}function u(e,t){for(var n,r,o=t.startRowIndex,s=t.endRowIndex,i=t.startColIndex,a=t.endColIndex,l=function(t){for(var n=o;n<=s;n++)if(!h(e,n,t))return!1;return!0},d=i;d<=a;d++)if(!l(d)){n=d;break}if(void 0===n)return[i,i];for(var u=a;u>n;u--)if(!l(u)){r=u;break}return void 0===r&&(r=n),[n,r]}function c(e,t,n,r){var o=e.getCellDataAtPosition(t,n,{filterViewId:r,isIgnoreFilterView:!r}),s=null===o||void 0===o?void 0:o.getEditValue();return!s||""===s.toString().replace(/[\u200B-\u200D\uFEFF]/g,"")}function h(e,t,n,r){return f(e,t,n,r)?function(e,t,n,r){var o=e.getCellDataAtPosition(t,n,{filterViewId:r,isIgnoreFilterView:!r}),s=null===o||void 0===o?void 0:o.getMergeReference();return!!s&&c(e,s.startRowIndex,s.startColIndex)}(e,t,n,r):c(e,t,n,r)}function f(e,t,n,r){var o=e.getCellDataAtPosition(t,n,{filterViewId:r,isIgnoreFilterView:!r});return!!(null===o||void 0===o?void 0:o.getMergeReference())}function p(e,t){var n=t.startRowIndex,r=t.startColIndex,o=e.getCellDataAtPosition(n,r),s=null===o||void 0===o?void 0:o.getMergeReference();return!!s&&s.equal(t)}function g(e,t){for(var n=t.startRowIndex,r=t.endRowIndex,o=t.startColIndex,s=t.endColIndex,i=n;i<=r;i++)for(var a=o;a<=s;a++)if(f(e,i,a))return!0;return!1}function m(e,t){var n=t.startRowIndex,r=t.startColIndex,o=e.getCellDataAtPosition(n,r),s=null===o||void 0===o?void 0:o.getMergeReference();return!!s&&s.contain(t)}function v(e){var t,n,r;if(!(null===(t=e.parent)||void 0===t?void 0:t.sheetStatus.canEdit))return!1;var o=e.activeSheet.getBasicFilter(),s=null===o||void 0===o?void 0:o.range,i=null===(r=null===(n=e.parent)||void 0===n?void 0:n.permissions)||void 0===r?void 0:r.sheetStatus;return!(!i||!s)&&!i.checkRangeStatus(s)}!function(e){e[e.SINGLE_CELL=0]="SINGLE_CELL",e[e.SINGLE_MERGE_CELL=1]="SINGLE_MERGE_CELL",e[e.ONE_ROW_PART=2]="ONE_ROW_PART",e[e.ONE_ROW_WHOLE=3]="ONE_ROW_WHOLE",e[e.ONE_COL_WHOLE=4]="ONE_COL_WHOLE",e[e.MULTI_COL_WHOLE=5]="MULTI_COL_WHOLE",e[e.MULTI_ROW_COL=6]="MULTI_ROW_COL"}(r||(r={}))},"../spread-sheet/src/core/behavior/request/workbook/filterUtils/searchCloseDataArea.ts":function(e,t,n){"use strict";n.d(t,{Jz:function(){return p},ZP:function(){return i}}),n("../node_modules/core-js/modules/es.object.assign.js");var r=n("../packages/model/src/range/GridRange.ts"),o=n("../spread-sheet/src/core/behavior/request/workbook/filterUtils/handleFilterRange.ts");function s(e,t){for(var n=t.startRowIndex;n<=t.endRowIndex;n++)for(var r=t.startColIndex;r<=t.endColIndex;r++)if(!(0,o.c8)(e,n,r))return!1;return!0}function i(e,t,n){void 0===n&&(n=!0);var o=p(e,t);return n&&!o.equal(t)?function(e,t){var n=t.isCol||0===t.startRowIndex&&t.endRowIndex===e.getRowCount()-1,o=t.isRow||0===t.startColIndex&&t.endColIndex===e.getColCount()-1;if(!n){for(;t.endRowIndex>t.startRowIndex&&s(e,new r.Z(Object.assign(Object.assign({},t),{endRowIndex:t.startRowIndex})));)t=new r.Z(Object.assign(Object.assign({},t),{startRowIndex:t.startRowIndex+1}));for(;t.endRowIndex>t.startRowIndex&&s(e,new r.Z(Object.assign(Object.assign({},t),{startRowIndex:t.endRowIndex})));)t=new r.Z(Object.assign(Object.assign({},t),{endRowIndex:t.endRowIndex-1}))}if(!o){for(;t.endColIndex>t.startColIndex&&s(e,new r.Z(Object.assign(Object.assign({},t),{endColIndex:t.startColIndex})));)t=new r.Z(Object.assign(Object.assign({},t),{startColIndex:t.startColIndex+1}));for(;t.endColIndex>t.startColIndex&&s(e,new r.Z(Object.assign(Object.assign({},t),{startColIndex:t.endColIndex})));)t=new r.Z(Object.assign(Object.assign({},t),{endColIndex:t.endColIndex-1}))}return t}(e,o):o}function a(e,t,n,r,s){return!e||t>1||function(e,t,n){return(!(0,o.c8)(e,t-1,n)||!(0,o.c8)(e,t-1,n+1))&&(!(0,o.c8)(e,t-1,n-1)||!(0,o.c8)(e,t,n-1)||!(0,o.c8)(e,t+1,n-1))}(n,r,s)}function l(e,t,n,s,i,a,l){return function(e,t,n,r){return e&&t>=1&&n>=1&&!(0,o.c8)(r,t-1,n-1)}(e,t,n,a)?new r.Z(Object.assign(Object.assign({},l),{startRowIndex:t-1,startColIndex:n-1})):!!function(e,t,n,r,s){return e&&t>=1&&n<r-1&&!(0,o.c8)(s,t-1,n+1)}(e,t,s,i,a)&&new r.Z(Object.assign(Object.assign({},l),{startRowIndex:t-1,endColIndex:s+1}))}function d(e,t,n,s,i,a,l,d){return function(e,t,n,r,s){return e&&t<r-1&&n>=1&&!(0,o.c8)(s,t+1,n-1)}(e,t,n,i,l)?new r.Z(Object.assign(Object.assign({},d),{endRowIndex:t+1,startColIndex:n-1})):!!function(e,t,n,r,s){return e<n-1&&t<r-1&&!(0,o.c8)(s,e+1,t+1)}(t,s,i,a,l)&&new r.Z(Object.assign(Object.assign({},d),{endRowIndex:t+1,endColIndex:s+1}))}function u(e,t,n,r,o,s,i,a,u){return l(e,t,r,o,s,a,u)||d(e,n,r,o,i,s,a,u)}function c(e,t,n,o,i,a){return function(e,t,n,o){return e&&t>=1&&!s(o,new r.Z(Object.assign(Object.assign({},n),{startRowIndex:t-1,endRowIndex:t-1})))}(e,t,a,i)?new r.Z(Object.assign(Object.assign({},a),{startRowIndex:t-1})):!!function(e,t,n,o){return e<t-1&&!s(o,new r.Z(Object.assign(Object.assign({},n),{startRowIndex:e+1,endRowIndex:e+1})))}(n,o,a,i)&&new r.Z(Object.assign(Object.assign({},a),{endRowIndex:n+1}))}function h(e,t,n,o,i,a){return function(e,t,n,o){return e&&t>=1&&!s(o,new r.Z(Object.assign(Object.assign({},n),{startColIndex:t-1,endColIndex:t-1})))}(e,t,a,i)?new r.Z(Object.assign(Object.assign({},a),{startColIndex:t-1})):!!function(e,t,n,o){return e<t-1&&!s(o,new r.Z(Object.assign(Object.assign({},n),{startColIndex:e+1,endColIndex:e+1})))}(n,o,a,i)&&new r.Z(Object.assign(Object.assign({},a),{endColIndex:n+1}))}function f(e,t,n,r,o,s,i,a,l){return c(e,t,n,i,a,l)||h(e,r,o,s,a,l)}function p(e,t,n){void 0===n&&(n=!1);var o=e.getRowCount(),s=e.getColCount(),i=Date.now(),l=0,d=!1,c=new r.Z(Object.assign({},t));try{for(;l<o+s;){l+=1;var h=c,p=h.startRowIndex,g=h.startColIndex,m=h.endRowIndex,v=h.endColIndex,I=u(d=a(n,l,e,p,g),p,m,g,v,s,o,e,c),E=f(d,p,m,g,v,s,o,e,c);if(I)c=I;else{if(!E)return c;c=E}}return c}finally{var S=Date.now();window.log.info("startSearchArea used "+l+" iterations, took "+(S-i)+"ms")}}},"../spread-sheet/src/core/behavior/requests.ts":function(e,t,n){"use strict";n.d(t,{h:function(){return Mi}});var r=n("../spread-sheet/src/core/behavior/request/Type.ts"),o=n("../node_modules/@babel/runtime/helpers/esm/toConsumableArray.js"),s=n("../node_modules/@babel/runtime/helpers/esm/createClass.js"),i=n("../node_modules/@babel/runtime/helpers/esm/inheritsLoose.js"),a=(n("../node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),n("../node_modules/core-js/modules/esnext.reflect.metadata.js"),n("../node_modules/core-js/modules/web.dom-collections.for-each.js"),n("../node_modules/core-js/modules/es.object.assign.js"),n("../node_modules/core-js/modules/es.number.constructor.js"),n("../node_modules/i18next/dist/esm/i18next.js")),l=n("../spread-sheet/src/core/behavior/request/Request.ts"),d=n("../packages/mutation/src/dimension/InsertDimensionMutation.ts"),u=n("../packages/model/src/dimension/DimensionType.ts"),c=n("../packages/mutation/src/dimension/SetDimensionPropertiesMutation.ts"),h=n("../packages/model/src/range/DimensionRange.ts"),f=n("../packages/model/src/range/GridRange.ts"),p=n("../packages/mutation/src/cell/SetRangeMutation.ts"),g=n("../packages/mutation/src/merge/MergeCellsMutation.ts"),m=n("../packages/model/src/cell/CellDataSlot.ts"),v=n("../packages/model/src/cell/cellDataUtils.ts"),I=n("../packages/model/src/cell/metadata/CustomDataType.ts");function E(e){return!!e&&e!==I.ZP.IMAGE&&e!==I.ZP.DATE_REMINDER&&e!==I.ZP.STAFF_CARD&&e!==I.ZP.GROUP_CARD&&e!==I.ZP.SCHEDULE&&e!==I.ZP.TODO&&e!==I.ZP.MINI_APP&&e!==I.ZP.THIRD_PARTY_APP}function S(e,t){var n,r,o,s,i,a=[];for(o=t.startRowIndex;o<=t.endRowIndex;o++)for(r=t.startColIndex;r<=t.endColIndex;r++){s=e.getCellDataAtPosition(o,r);var l=(1<<m.Z.SLOT_USER_ENTERED_FORMAT_DELTA)+(1<<m.Z.SLOT_DATA_VALIDATION_RULE),d=null===(n=null===s||void 0===s?void 0:s.getMetadata())||void 0===n?void 0:n.customDataType,u=E(d||null);if(u&&(l+=1<<m.Z.SLOT_METADATA),i=(0,v.createCellDataDelta)(null,s,l),u){var c=(0,I.eG)(d);c&&i.setSlot(m.Z.SLOT_EFFIECTIVE_VALUE,c)}a.push({rowIndex:o,colIndex:r,cellDataDelta:i})}return new p.Z({gridRange:t,cellDataDeltaAtPositions:a})}var R,w=n("../node_modules/@tencent/jank-sdk/lib/index.js"),A=n("../packages/model/src/cell/index.ts"),C=n("../packages/model/src/spreadsheet/Spreadsheet.interface.ts"),y=n("../spread-sheet/src/core/behavior/request/other/formula-model-service/UpdateFormulaModelServiceForMutation.ts"),_=n("../packages/model/src/filter-view/utils/dimension-util.ts"),T=function(e,t,n,r){var o,s=arguments.length,i=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)i=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(i=(s<3?o(i):s>3?o(t,n,i):o(t,n))||i);return s>3&&i&&Object.defineProperty(t,n,i),i},x=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},b=function(e){function t(t,n){var r;return(r=e.call(this,t,n)||this).sheetId=t.sheet.getSheetId(),r.type=t.type,r.selection=n,r.filterViewId=t.filterViewId,t.insertInfo?(t.insertInfo.forEach((function(e){e.amount=Math.floor(e.amount)})),r.behaviors=t.insertInfo):n&&(r.type===u.Z.ROWS?r.behaviors=r.getInsertOption(t.sheet,n.getRows()):r.behaviors=r.getInsertOption(t.sheet,n.getCols())),r}(0,i.Z)(t,e);var n=t.prototype;return n.check=function(e){var t=e.sheetManager.getSheetBySheetId(this.sheetId),n=null===t||void 0===t?void 0:t.filterViewManager.getActiveFilterView();return this.behaviors.every((function(e){return e.index>=0&&e.amount>=0}))?(0,_.lz)(t,n,this.type,this.behaviors)?{isWarningOnly:!0,warning:{title:a.ZP.t("出现问题"),content:a.ZP.t("排序后, 插入行列的位置会按照原表操作, 是否继续操作?")}}:null:{isWarningOnly:!1,error:{title:a.ZP.t("出现问题"),content:a.ZP.t("插入的行列位置不正确，请重新操作。")}}},n.predictRequestSize=function(e){var t,n,r,o=e.sheetManager.getSheetBySheetId(this.sheetId),s=0,i=0,a=this.behaviors[0].index;if(0===a)return 0;if(!o)return 0;if(this.type===u.Z.ROWS)for(t=i=o.getColCount(),r=0;r<t;r++)(n=o.getCellDataAtPosition(a-1,r))&&0!==n.setSlots||(i-=1);else{if(this.type!==u.Z.COLUMNS)return 0;for(t=i=o.getRowCount(),r=0;r<t;r++)(n=o.getCellDataAtPosition(r-1,a))&&0!==n.setSlots||(i-=1)}return this.behaviors.forEach((function(e){s+=e.amount*i*40})),s},n.requestSizeOverLimitTips=function(){return a.ZP.t("数据量较大，操作不成功。建议分批插入{{value}}}。",{value:this.type===u.Z.ROWS?"行":"列"})},n.do=function(e,t,n){var r,o,s,i,a,l,g=0,m=0,v=t.sheetManager.getSheetBySheetId(this.sheetId),I=[];if(null!==v){this.selection||(this.selection=t.parent.view.getSelectionWithGridRanges());var E=this.selection.rangeSelections[0],R=E.startRowIndex,w=E.startColIndex,A=E.endRowIndex,C=E.endColIndex,y=!1,_=(y=this.type===u.Z.ROWS?e.index<=R:e.index<=w)?R:A,T=y?w:C,x=v.getRowCount(),b=v.getColCount(),D=e.index;D=this.type===u.Z.ROWS?D>x-1?x-1:_:D>b-1?b-1:T;var O=!1;for(g=0;g<this.behaviors.length;g++)if(O){var M=new h.Z(this.sheetId,this.behaviors[g].index,this.behaviors[g].amount,this.type);M.insertDimension({sheetId:this.sheetId,index:e.index,amount:e.amount,type:this.type}),this.behaviors[g].index=M.startIndex,this.behaviors[g].amount=M.endIndex-M.startIndex+1}else this.behaviors[g]===e&&(O=!0);var j=this.beforeInsertDimension(t,e,this.type),L=j.beforeMutations,Z=j.afterMutations;L.forEach((function(e){n(e)})),this.type===u.Z.ROWS&&(o=new f.Z(this.sheetId,D,D,0,v.getColCount()-1),s=S(v,o),this.checkBorders(s,v,e.index>D)),this.type===u.Z.COLUMNS&&(o=new f.Z(this.sheetId,0,v.getRowCount()-1,D,D),s=S(v,o),this.checkBorders(s,v,e.index>D));var k=new d.Z({index:e.index,amount:e.amount,type:this.type,sheetId:this.sheetId});n(k),(this.type===u.Z.ROWS||this.type===u.Z.COLUMNS)&&(D=e.index<=D?D+e.amount:D);var N=(0,c.OR)({sheet:v,type:this.type,ranges:[new h.Z(this.sheetId,D,D,this.type)]},Object.assign({needDefaultProperties:!0,pixelSize:!0,ignoreDefaultSize:!0},this.type===u.Z.COLUMNS?{columnTypeMetadata:!0,ignoreValidateRows:!0,dataValidation:!0}:{}));for(g=0;g<N.length;g++)(r=N[g]).operation.length>0&&(r.ranges.forEach((function(t){t.startIndex=e.index,t.endIndex=e.index+e.amount-1})),n(r));if(s&&s.cellDataDeltaAtPositions.length>0){for(g=0;g<s.cellDataDeltaAtPositions.length;g++)if(i=s.cellDataDeltaAtPositions[g].rowIndex,a=s.cellDataDeltaAtPositions[g].colIndex,0!==(l=s.cellDataDeltaAtPositions[g].cellDataDelta).setSlots)if(this.type===u.Z.ROWS)for(m=0;m<e.amount;m++)I.push({rowIndex:e.index+m,colIndex:a,cellDataDelta:l});else for(m=0;m<e.amount;m++)I.push({rowIndex:i,colIndex:e.index+m,cellDataDelta:l});o=this.type===u.Z.ROWS?new f.Z(this.sheetId,e.index,e.index+e.amount-1,0,v.getColCount()-1):new f.Z(this.sheetId,0,v.getRowCount()-1,e.index,e.index+e.amount-1),0!==I.length&&n(new p.Z({gridRange:o,cellDataDeltaAtPositions:I}))}Z.forEach((function(e){n(e)}))}},n.getInsertOption=function(e,t){for(var n,r=[],o=1,s=t[0],i=1;o<t.length;o++)t[o]===t[o-1]+1?i+=1:(n={index:s,amount:i},r.push(n),s=t[o],i=1);return n={index:s,amount:i},r.push(n),r},n.checkBorders=function(e,t,n){var r,o,s,i,a,l,d,c,h,f,p=e.cellDataDeltaAtPositions,g=e.gridRange,m=!1;for(this.type===u.Z.ROWS?(i=1,a=0,t.getRowCount()<=g.startRowIndex+i&&(m=!0)):(i=0,a=1,t.getColCount()<=g.startColIndex+a&&(m=!0)),l=0;l<p.length;l++)(null===(r=(d=p[l].cellDataDelta.delta).userEnteredFormatDelta)||void 0===r?void 0:r.delta)&&null!==(c=d.userEnteredFormatDelta.delta).getBorders()&&(m&&n?(d.userEnteredFormatDelta.clearSlot(A.CELL_FORMAT_SLOT.BORDER_TOP),d.userEnteredFormatDelta.clearSlot(A.CELL_FORMAT_SLOT.BORDER_BOTTOM),d.userEnteredFormatDelta.clearSlot(A.CELL_FORMAT_SLOT.BORDER_LEFT),d.userEnteredFormatDelta.clearSlot(A.CELL_FORMAT_SLOT.BORDER_RIGHT)):(o=p[l].rowIndex,s=p[l].colIndex,null!==(h=n?t.getCellDataAtPosition(o+i,s+a):t.getCellDataAtPosition(o-i,s-a))&&null!==(f=h.getUserEnteredFormat())&&null!==f.getBorders()?(c.getBorderTop()&&(f.getBorderTop()&&c.getBorderTop().equal(f.getBorderTop())||d.userEnteredFormatDelta.clearSlot(A.CELL_FORMAT_SLOT.BORDER_TOP)),c.getBorderRight()&&(f.getBorderRight()&&c.getBorderRight().equal(f.getBorderRight())||d.userEnteredFormatDelta.clearSlot(A.CELL_FORMAT_SLOT.BORDER_RIGHT)),c.getBorderBottom()&&(f.getBorderBottom()&&c.getBorderBottom().equal(f.getBorderBottom())||d.userEnteredFormatDelta.clearSlot(A.CELL_FORMAT_SLOT.BORDER_BOTTOM)),c.getBorderLeft()&&(f.getBorderLeft()&&c.getBorderLeft().equal(f.getBorderLeft())||d.userEnteredFormatDelta.clearSlot(A.CELL_FORMAT_SLOT.BORDER_LEFT))):(d.userEnteredFormatDelta.clearSlot(A.CELL_FORMAT_SLOT.BORDER_TOP),d.userEnteredFormatDelta.clearSlot(A.CELL_FORMAT_SLOT.BORDER_BOTTOM),d.userEnteredFormatDelta.clearSlot(A.CELL_FORMAT_SLOT.BORDER_LEFT),d.userEnteredFormatDelta.clearSlot(A.CELL_FORMAT_SLOT.BORDER_RIGHT))))},n.beforeInsertDimension=function(e,t,n){var r=[],s=[],i=this.conflictMerge(t,e);r.push.apply(r,(0,o.Z)(i.beforeMutations)),s.push.apply(s,(0,o.Z)(i.afterMutations));var a=this.conflictFilterViewReorder(t,e);r.push.apply(r,(0,o.Z)(a.beforeMutations)),s.push.apply(s,(0,o.Z)(a.afterMutations));var l=this.conflictWorkbookrange(t,e,n);s.push.apply(s,(0,o.Z)(l.afterMutations));var d=this.conflictFormulaModel(t,e);return r.push.apply(r,(0,o.Z)(d.beforeMutations)),s.push.apply(s,(0,o.Z)(d.afterMutations)),{beforeMutations:r,afterMutations:s}},n.conflictWorkbookrange=function(e,t,n){return{beforeMutations:[],afterMutations:[]}},n.conflictMerge=function(e,t){var n=this,r=e.index,o=e.amount,s=t.sheetManager.getSheetBySheetId(this.sheetId),i={beforeMutations:[],afterMutations:[]};return s.mergeManager.each((function(e){var t=e.startRowIndex,s=e.endRowIndex,a=e.startColIndex,l=e.endColIndex,d=e.sheetId;n.type===u.Z.ROWS?r>t&&r<=s&&i.afterMutations.push(new g.Z({sheetId:d,startRowIndex:t,endRowIndex:s+o,startColIndex:a,endColIndex:l})):n.type===u.Z.COLUMNS&&r>a&&r<=l&&i.afterMutations.push(new g.Z({sheetId:d,startRowIndex:t,endRowIndex:s,startColIndex:a,endColIndex:l+o}))})),i},n.conflictFormulaModel=function(e,t){var n=new d.Z({index:e.index,amount:e.amount,type:this.type,sheetId:this.sheetId});return{afterMutations:(0,y.lO)({getSheetBySheetId:t.sheetManager.getSheetBySheetId.bind(t.sheetManager),getSheetIdList:t.sheetManager.getSheetIdList.bind(t.sheetManager),isSheetAmongTwoSheets:t.sheetManager.isSheetAmongTwoSheets.bind(t.sheetManager),getSheetIdBySheetIndex:t.sheetManager.getSheetIdBySheetIndex.bind(t.sheetManager),getSheetIndexBySheetId:t.sheetManager.getSheetIndexBySheetId.bind(t.sheetManager),getSheetTitleBySheetId:t.sheetManager.getSheetTitleBySheetId.bind(t.sheetManager)},t.workbookRangeManager,t.embeddedObjectManager,t.formulaModelManager).generateUpdateFormulaModelMutation(n),beforeMutations:[]}},n.conflictFilterViewReorder=function(e,t){var n,r={beforeMutations:[],afterMutations:[]},s=t.sheetManager.getSheetBySheetId(this.sheetId);if(!this.filterViewId)return r;var i=s.filterViewManager.getFilterViewByViewId(this.filterViewId);if(!(0,_.lz)(s,i,this.type,[e]))return r;var a=(0,_.nH)(i);return(n=r.beforeMutations).push.apply(n,(0,o.Z)(a)),r},(0,s.Z)(t,[{key:"id",get:function(){return t.id}}]),t}(l.Z);b.id=r.Z.INSERT_DIMENSION_REQUEST,T([(0,w.M4)(b),x("design:type",Function),x("design:paramtypes",["function"===typeof(R="undefined"!==typeof C.V&&C.V)?R:Object]),x("design:returntype",Number)],b.prototype,"predictRequestSize",null);var D,O=b,M=(n("../node_modules/core-js/modules/es.array.filter.js"),n("../node_modules/core-js/modules/es.array.map.js"),n("../node_modules/core-js/modules/es.array.slice.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.function.name.js"),n("../node_modules/core-js/modules/es.array.from.js"),n("../node_modules/core-js/modules/es.string.iterator.js"),n("../node_modules/core-js/modules/es.symbol.js"),n("../node_modules/core-js/modules/es.symbol.description.js"),n("../node_modules/core-js/modules/es.symbol.iterator.js"),n("../node_modules/core-js/modules/es.array.iterator.js"),n("../node_modules/core-js/modules/web.dom-collections.iterator.js"),n("../packages/mutation/src/dimension/DeleteDimensionMutation.ts")),j=n("../packages/model/src/range/dimensionRangeUtils.ts"),L=n("../packages/mutation/src/cell/SetCellPropertiesMutation.ts"),Z=n("../packages/mutation/src/filter/DeleteFilterMutation.ts"),k=n("../packages/mutation/src/sheet/SetSheetPropertiesMutation.ts"),N=n("../packages/mutation/src/filter/UpdateFilterMutation.ts"),P=n("../packages/model/src/sheet/SheetPropertiesDelta.ts"),U=n("../packages/model/src/sheet/SheetPropertiesSlotOperation.ts"),F=n("../packages/mutation/src/workbook/workbookRange/DeleteWorkbookRangeMutation.ts"),V=n("../packages/mutation/src/workbook/workbookRange/UpdateWorkbookRangeMutation.ts"),B=n("../packages/model/src/workbookRange/WorkbookRangeType.ts"),H=n("../packages/model/src/workbookRange/index.ts"),G=n("../spread-sheet/src/core/behavior/request/dimension/util.ts");function W(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){if(e){if("string"===typeof e)return z(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?z(e,t):void 0}}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0;return function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function z(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}!function(e){e[e.add=0]="add",e[e.delete=1]="delete"}(D||(D={}));var Q=function(e){var t,n=e.type,r=e.index,o=e.amount,s=e.sheetId,i=e.workbookRangeId,a=e.criteriaMap,l=e.filter,d=[],u=[];return a.forEach((function(e,t){var a,c,h,f=t+o;if(t>=r){var p={columnIndex:t,clear:!0};if(d.push(new N.ZP({sheetId:s,workbookRangeId:i,filterViewId:null===(a=l.filterViewReference)||void 0===a?void 0:a.filterViewId,updateType:N.Qn.UPDATE,delta:{defaultFilterId:i,updateColumnCriteriaDelta:p}})),u.push(p),n===D.add){var g=t+(n===D.add?o:-o),m={columnIndex:g,criteria:e};d.push(new N.ZP({sheetId:s,workbookRangeId:i,filterViewId:null===(c=l.filterViewReference)||void 0===c?void 0:c.filterViewId,updateType:N.Qn.UPDATE,delta:{defaultFilterId:i,updateColumnCriteriaDelta:{columnIndex:g,criteria:e}}})),u.push(m)}}else if(t>=f){var v=t+(n===D.add?o:-o);d.push(new N.ZP({sheetId:s,workbookRangeId:i,filterViewId:null===(h=l.filterViewReference)||void 0===h?void 0:h.filterViewId,updateType:N.Qn.UPDATE,delta:{defaultFilterId:i,updateColumnCriteriaDelta:{columnIndex:v,criteria:e}}}))}})),d.length>0&&(u.reduce((function(e,t){return(0,N.Jl)(t,e)}),l.clone()),d.push(new N.ZP({sheetId:s,workbookRangeId:i,filterViewId:null===(t=l.filterViewReference)||void 0===t?void 0:t.filterViewId,updateType:N.Qn.RECAL,delta:{defaultFilterId:i}}))),d},Y=function(e){function t(t,n){var r;return(r=e.call(this,t,n)||this).behaviors=[],r.sheetId=t.sheet.getSheetId(),r.type=t.type,r.filterViewId=t.filterViewId,t.deleteInfo?r.behaviors=t.deleteInfo:n&&(r.type===u.Z.ROWS?r.behaviors=r.getDeleteOption(t.sheet,n.getRows()):r.behaviors=r.getDeleteOption(t.sheet,n.getCols())),r}(0,i.Z)(t,e);var r=t.prototype;return r.do=function(e,t,n){var r=t.sheetManager.getSheetBySheetId(this.sheetId),o=new h.Z(this.sheetId,e.index,e.index+e.amount-1,this.type),s=(0,j.ic)([o],r.getBasicFilter()).map((function(e){return{index:e.startIndex,amount:e.endIndex-e.startIndex+1}}));this.getMutationsBeforeExecuteAllDimensionChanges(t,s).forEach((function(e){n(e)}));for(var i=0;i<s.length;i++){for(var a=s[i],l=i+1;l<s.length;l++){var d=new h.Z(this.sheetId,s[l].index,s[l].index+s[l].amount-1,this.type);d.deleteDimension({sheetId:this.sheetId,index:a.index,amount:a.amount,type:this.type}),s[l].index=d.startIndex,s[l].amount=d.endIndex-d.startIndex+1}for(var u=!1,c=0;c<this.behaviors.length;c++)if(u){var f=new h.Z(this.sheetId,this.behaviors[c].index,this.behaviors[c].index+this.behaviors[c].amount-1,this.type);f.deleteDimension({sheetId:this.sheetId,index:a.index,amount:a.amount,type:this.type}),this.behaviors[c].index=f.startIndex,this.behaviors[c].amount=f.endIndex-f.startIndex+1}else this.behaviors[c]===e&&(u=!0);var p=this.beforeDeleteDimension(t,{index:a.index,amount:a.amount}),g=p.beforeMutations,m=p.afterMutations;g.forEach((function(e){n(e)}));var v=new M.Z({index:a.index,amount:a.amount,type:this.type,sheetId:this.sheetId});n(v),m.forEach((function(e){n(e)}))}},r.check=function(e){var t=e.sheetManager.getSheetBySheetId(this.sheetId),r={isWarningOnly:!1,error:{title:a.ZP.t("出现问题"),content:a.ZP.t("删除的行列位置不正确，请重新操作。")}};if(!t)return r;if(!this.behaviors.every((function(e){return e.index>=0&&e.amount>=0})))return r;var o=function(e,t,r,o){var s,i=r.sheetManager.getSheetBySheetId(e),a=0,l=n.g.SpreadsheetApp.feature.relateForm;if(null===i||!l||!l.isRelated(e))return 3;if(!(null===(s=i.data)||void 0===s?void 0:s.rowData))return 3;var d=i.data.colMetadata,c=i.data.rowMetadata;if(o===u.Z.COLUMNS)for(var h=0,f=t.length;h<f;h++){var p=t[h],g=p.index,m=p.amount,v={sheetId:e,startRowIndex:0,endRowIndex:c.length,startColIndex:g,endColIndex:g+m-1};if(3===(a=l.checkReleaseRange(v,c,d,3)))return 2}else for(var I=0,E=t.length;I<E;I++){var S=t[I],R=S.index,w={sheetId:e,startRowIndex:R,endRowIndex:R+S.amount-1,startColIndex:0,endColIndex:d.length};if(1===(a=l.checkReleaseRange(w,c,d,1)))return a}return 3}(this.sheetId,this.behaviors,e,this.type);switch(o){case 1:return{isWarningOnly:!1,error:{title:a.ZP.t("删除行列"),content:a.ZP.t("操作被禁止。无法删除包含收集表问题的行。"),btnTxt:a.ZP.t("我知道了")}};case 2:return{isWarningOnly:!1,error:{title:a.ZP.t("删除行列"),content:a.ZP.t("操作被禁止。无法删除包含收集表问题的列，会导致收集结果更新失败。可以隐藏列。"),btnTxt:a.ZP.t("我知道了")}}}var s=this.behaviors.reduce((function(e,t){var n=e;return n+=t.amount}),0);if((this.type===u.Z.ROWS?t.getRowCount():t.getColCount())<=s)return{isWarningOnly:!1,error:{title:a.ZP.t("删除行列"),content:this.type===u.Z.ROWS?a.ZP.t("抱歉, 无法删除工作表上的所有行。"):a.ZP.t("抱歉, 无法删除工作表上的所有列。")}};var i=null===t||void 0===t?void 0:t.filterViewManager.getActiveFilterView();return(0,_.lz)(t,i,this.type,this.behaviors)?{isWarningOnly:!0,warning:{title:a.ZP.t("出现问题"),content:a.ZP.t("排序后, 插入行列的位置会按照原表操作, 是否继续操作?")}}:null},r.getDeleteOption=function(e,t){for(var n,r=[],o=t[0],s=1,i=1;i<t.length;i++)t[i]===t[i-1]+1?s+=1:(n={index:o,amount:s},r.push(n),o=t[i],s=1);return n={index:o,amount:s},r.push(n),r},r.beforeDeleteDimension=function(e,t){var n=[],r=[],s=this.confictMerge(t,e);n.push.apply(n,(0,o.Z)(s.beforeMutations)),r.push.apply(r,(0,o.Z)(s.afterMutations));var i=this.confictFrozen(t,e);n.push.apply(n,(0,o.Z)(i.beforeMutations)),r.push.apply(r,(0,o.Z)(i.afterMutations));var a=this.confictFilter(t,e);n.push.apply(n,(0,o.Z)(a.beforeMutations)),r.push.apply(r,(0,o.Z)(a.afterMutations));var l=this.conflictFormulaModel(t,e);n.push.apply(n,(0,o.Z)(l.beforeMutations)),r.push.apply(r,(0,o.Z)(l.afterMutations));var d=this.conflictWorkbookRange(t,e);return n.push.apply(n,(0,o.Z)(d.beforeMutations)),r.push.apply(r,(0,o.Z)(d.afterMutations)),{beforeMutations:n,afterMutations:r}},r.confictMergeDimenstionIsRow=function(e,t,n,r,o){var s;if(e.startRowIndex>=t&&e.startRowIndex<=t+n-1){if((s=e.clone()).deleteDimension({sheetId:s.sheetId,type:u.Z.ROWS,index:t,amount:n}),s.endRowIndex>=s.startRowIndex){(s.getColCount(r)>1||s.getRowCount(r)>1)&&o.afterMutations.push(new g.Z(s));var i=(0,v.createCellDataDelta)(r.getCellDataAtPosition(t+n,e.startColIndex),r.getCellDataAtPosition(e.startRowIndex,e.startColIndex),1<<m.Z.SLOT_USER_ENTERED_FORMAT_DELTA);o.afterMutations.push(new L.Z({gridRange:new f.Z(e.sheetId,t,t,e.startColIndex,e.startColIndex),cellDataDelta:i}))}}else t>e.startRowIndex&&t<=e.endRowIndex&&((s=e.clone()).deleteDimension({sheetId:s.sheetId,type:u.Z.ROWS,index:t,amount:n}),(s.getRowCount(r)>1||s.getColCount(r)>1)&&o.afterMutations.push(new g.Z(s)));return o},r.confictMergeDimenstionIsColumns=function(e,t,n,r,o){var s;if(e.startColIndex>=t&&e.startColIndex<=t+n-1){if((s=e.clone()).deleteDimension({sheetId:s.sheetId,type:u.Z.COLUMNS,index:t,amount:n}),s.endColIndex>=s.startColIndex){(s.getColCount(r)>1||s.getRowCount(r)>1)&&o.afterMutations.push(new g.Z(s));var i=(0,v.createCellDataDelta)(r.getCellDataAtPosition(e.startRowIndex,t+n),r.getCellDataAtPosition(e.startRowIndex,e.startColIndex),1<<m.Z.SLOT_USER_ENTERED_FORMAT_DELTA);o.afterMutations.push(new L.Z({gridRange:new f.Z(e.sheetId,e.startRowIndex,e.startRowIndex,t,t),cellDataDelta:i}))}}else t>e.startColIndex&&t<=e.endColIndex&&((s=e.clone()).deleteDimension({sheetId:s.sheetId,type:u.Z.COLUMNS,index:t,amount:n}),(s.getColCount(r)>1||s.getRowCount(r)>1)&&o.afterMutations.push(new g.Z(s)))},r.confictMerge=function(e,t){var n=this,r=e.index,o=e.amount,s=t.sheetManager.getSheetBySheetId(this.sheetId),i={beforeMutations:[],afterMutations:[]};return s.mergeManager.each((function(e){n.type===u.Z.ROWS?n.confictMergeDimenstionIsRow(e,r,o,s,i):n.type===u.Z.COLUMNS&&n.confictMergeDimenstionIsColumns(e,r,o,s,i)})),i},r.confictFrozen=function(e,t){var n=e.index,r=e.amount,o=t.sheetManager.getSheetBySheetId(this.sheetId),s=o.getFrozenRowCount(),i=o.getFrozenColCount(),a={beforeMutations:[],afterMutations:[]};return s>0&&n<s&&this.type===u.Z.ROWS&&(s=Math.max(n-1,s-1-r),0===(s+=1)&&a.beforeMutations.push(new k.Z({sheetId:this.sheetId,sheetDelta:new P.Z({operation:U.C.SET_PROPERTIES,delta:{frozenRowCount:s}})}))),i>0&&n<i&&this.type===u.Z.COLUMNS&&(i=Math.max(n-1,i-1-r),0===(i+=1)&&a.beforeMutations.push(new k.Z({sheetId:this.sheetId,sheetDelta:new P.Z({operation:U.C.SET_PROPERTIES,delta:{frozenColCount:i}})}))),a},r.confictFilter=function(e,t){for(var n,r,o,s,i,a=e.index,l=e.amount,d={beforeMutations:[],afterMutations:[]},c=W(t.sheetManager.getSheetBySheetId(this.sheetId).getAllBasicFilter());!(i=c()).done;){var h=i.value,f=h.workbookRangeId,p=h.range,g=p.clone();this.type===u.Z.ROWS&&(p.startRowIndex>=a&&p.startRowIndex<=a+l-1?d.beforeMutations.push(new Z.Z({sheetId:this.sheetId,filterViewId:null===(n=h.filterViewReference)||void 0===n?void 0:n.filterViewId,delta:{defaultFilterId:h.workbookRangeId}})):(p.endRowIndex>=a||p.endRowIndex<=a+l-1)&&g.deleteDimension({sheetId:g.sheetId,type:u.Z.ROWS,index:a,amount:l})),this.type===u.Z.COLUMNS&&(p.startColIndex>=a&&p.endColIndex<=a+l-1?d.beforeMutations.push(new Z.Z({sheetId:this.sheetId,filterViewId:null===(r=h.filterViewReference)||void 0===r?void 0:r.filterViewId,delta:{defaultFilterId:h.workbookRangeId}})):(p.startColIndex<=a+l-1||p.endColIndex>=a)&&g.deleteDimension({sheetId:g.sheetId,type:u.Z.COLUMNS,index:a,amount:l})),(this.type===u.Z.ROWS&&(p.endRowIndex>=a||p.endRowIndex<=a+l-1)||this.type===u.Z.COLUMNS&&(p.startColIndex<=a+l-1||p.endColIndex>=a))&&(d.beforeMutations.push(new N.ZP({sheetId:this.sheetId,filterViewId:null===(o=h.filterViewReference)||void 0===o?void 0:o.filterViewId,workbookRangeId:f,updateType:N.Qn.UPDATE,delta:{range:p,defaultFilterId:f}})),d.afterMutations.push(new N.ZP({sheetId:this.sheetId,filterViewId:null===(s=h.filterViewReference)||void 0===s?void 0:s.filterViewId,workbookRangeId:f,updateType:N.Qn.UPDATE,delta:{range:g,defaultFilterId:f}}))),this.type===u.Z.COLUMNS&&Q({type:D.delete,index:a,amount:l,sheetId:this.sheetId,workbookRangeId:h.workbookRangeId,criteriaMap:h.criteriaMap,filter:h,spreadsheet:t}).forEach((function(e){d.afterMutations.push(e)}))}return d},r.conflictFormulaModel=function(e,t){var n=new M.Z({index:e.index,amount:e.amount,type:this.type,sheetId:this.sheetId});return{afterMutations:(0,y.lO)({getSheetBySheetId:t.sheetManager.getSheetBySheetId.bind(t.sheetManager),getSheetIdList:t.sheetManager.getSheetIdList.bind(t.sheetManager),isSheetAmongTwoSheets:t.sheetManager.isSheetAmongTwoSheets.bind(t.sheetManager),getSheetIdBySheetIndex:t.sheetManager.getSheetIdBySheetIndex.bind(t.sheetManager),getSheetIndexBySheetId:t.sheetManager.getSheetIndexBySheetId.bind(t.sheetManager),getSheetTitleBySheetId:t.sheetManager.getSheetTitleBySheetId.bind(t.sheetManager)},t.workbookRangeManager,t.embeddedObjectManager,t.formulaModelManager).generateUpdateFormulaModelMutation(n),beforeMutations:[]}},r.conflictWorkbookRange=function(e,t){var n=this,r={beforeMutations:[],afterMutations:[]},o=e.index,s=e.amount;return t.workbookRangeManager.each((function(e){if(n.sheetId===e.range.sheetId&&e.type!==B.Z.CHART)if(n.type!==u.Z.ROWS||e.range.isCol){if(n.type===u.Z.COLUMNS&&!e.range.isRow)if(e.range.startColIndex>=o&&e.range.endColIndex<=o+s-1)r.beforeMutations.push(new F.Z({workbookRangeId:e.id,workbookRangeType:e.type}));else if(e.range.startColIndex>=o&&e.range.startColIndex<=o+s-1||e.range.endColIndex>=o&&e.range.endColIndex<=o+s-1){var t=e.range.clone(),i=new H.WorkbookRangeDelta;(0,G.g)(e,i),r.beforeMutations.push(new V.Z({workbookRangeId:e.id,gridRange:t,workbookRangeType:e.type,workbookRangePropertiesDelta:i}))}}else if(e.range.startRowIndex>=o&&e.range.endRowIndex<=o+s-1)r.beforeMutations.push(new F.Z({workbookRangeId:e.id,workbookRangeType:e.type}));else if(e.range.startRowIndex>=o&&e.range.startRowIndex<=o+s-1||e.range.endRowIndex>=o&&e.range.endRowIndex<=o+s-1){var a=e.range.clone(),l=new H.WorkbookRangeDelta;(0,G.g)(e,l),r.beforeMutations.push(new V.Z({workbookRangeId:e.id,gridRange:a,workbookRangeType:e.type,workbookRangePropertiesDelta:l}))}})),r},r.getMutationsBeforeExecuteAllDimensionChanges=function(e,t){var n=this.conflictFilterViewReorder(t,e);return(0,o.Z)(n)},r.conflictFilterViewReorder=function(e,t){var n=[],r=t.sheetManager.getSheetBySheetId(this.sheetId);if(!this.filterViewId)return n;var s=r.filterViewManager.getFilterViewByViewId(this.filterViewId);if(!(0,_.lz)(r,s,this.type,e))return n;var i=(0,_.nH)(s);return n.push.apply(n,(0,o.Z)(i)),n},(0,s.Z)(t,[{key:"id",get:function(){return t.id}}]),t}(l.Z);Y.id=r.Z.DELETE_DIMENSION_REQUEST;var q=Y,J=n("../packages/model/src/dimension/index.ts"),K=function(e){function t(t,n){var r,s;return(r=e.call(this,t,n)||this).sheetId=t.sheetId,r.filterViewId=t.filterViewId,r.behaviors=[],t.dimensionModifiers&&(s=r.behaviors).push.apply(s,(0,o.Z)(t.dimensionModifiers)),r}(0,i.Z)(t,e);var n=t.prototype;return n.check=function(e){var t={isWarningOnly:!1,error:{title:a.ZP.t("出现问题"),content:a.ZP.t("设置行高/列宽出现问题，请重新操作。")}},n=e.sheetManager.getSheetBySheetId(this.sheetId);if(!n)return t;for(var r=0,o=this.behaviors.length;r<o;r++){var s=this.behaviors[r].dimensionRange;if(s.dimension!==J.DIMENSION_TYPE.ROWS&&s.dimension!==J.DIMENSION_TYPE.COLUMNS)return t;var i=s.dimension===J.DIMENSION_TYPE.ROWS?n.getRowCount():n.getColCount();if(!s.isValid(i))return t}return null},n.do=function(e,t,n){(0,G.t)(e,t,n)},(0,s.Z)(t,[{key:"id",get:function(){return t.id}}]),t}(l.Z);K.id=r.Z.SET_DIMENSION_SIZE_REQUEST;var X=n("../spread-sheet/src/core/behavior/request/utils/index.ts"),$=function(e){function t(t,n){var r;return(r=e.call(this,t,n)||this).sheetId=t.sheetId,r.filterViewId=t.filterViewId,r.type=t.type,t.dimensionRanges?(r.behaviors=[],t.dimensionRanges.forEach((function(e){e.dimension===r.type&&r.behaviors.push(e)}))):n&&(r.type===u.Z.ROWS?r.behaviors=(0,X.Xi)(n.getRows(),r.sheetId,r.type):r.behaviors=(0,X.Xi)(n.getCols(),r.sheetId,r.type)),r}(0,i.Z)(t,e);var n=t.prototype;return n.do=function(e,t,n){var r=t.sheetManager.getSheetBySheetId(e.sheetId);if(null!==r)for(var o=(0,j.ic)([e],r.getBasicFilter()),s=0;s<o.length;s++){var i=o[s];n(new c.ZP({ranges:[i],operation:[{slot:c.P8.SLOT_HIDDEN,hidden:1}],sheetId:this.sheetId,filterViewId:this.filterViewId,type:this.type}))}},n.check=function(e){var t=e.sheetManager.getSheetBySheetId(this.sheetId);return null===t||this.type!==u.Z.COLUMNS&&this.type!==u.Z.ROWS?{isWarningOnly:!1,error:{title:a.ZP.t("出现问题"),content:a.ZP.t("请刷新页面重试")}}:this.isAllDimensionWillHidden(t)?{isWarningOnly:!1,error:{title:a.ZP.t("隐藏行列"),content:a.ZP.t("操作被禁止。无法隐藏所有的{{value}}。",{value:this.type===u.Z.COLUMNS?"列":"行"})}}:null},n.isAllDimensionWillHidden=function(e){if(this.type===u.Z.ROWS){for(var t=0;t<e.getRowCount();t++)if(!ee(t,this.behaviors)&&!e.data.isRowHidden(t))return!1}else if(this.type===u.Z.COLUMNS)for(var n=0;n<e.getColCount();n++)if(!ee(n,this.behaviors)&&!e.data.isColHidden(n))return!1;return!0},(0,s.Z)(t,[{key:"id",get:function(){return t.id}}]),t}(l.Z);function ee(e,t){for(var n=0;n<t.length;n++){var r=t[n];if(r.startIndex<=e&&r.endIndex>=e)return!0}return!1}$.id=r.Z.SET_DIMENSION_HIDE_REQUEST;var te=$,ne=function(e){function t(t,n){var r;return(r=e.call(this,t,n)||this).sheetId=t.sheetId,r.filterViewId=t.filterViewId,r.type=t.type,t.dimensionRanges?(r.behaviors=[],t.dimensionRanges.forEach((function(e){e.dimension===r.type&&r.behaviors.push(e)}))):n&&(r.type===u.Z.ROWS?r.behaviors=(0,X.Xi)(n.getRows(),r.sheetId,r.type):r.behaviors=(0,X.Xi)(n.getCols(),r.sheetId,r.type)),r}return(0,i.Z)(t,e),t.prototype.do=function(e,t,n){if(null!==t.sheetManager.getSheetBySheetId(e.sheetId))for(var r=[e],o=0;o<r.length;o++){var s=r[o];n(new c.ZP({ranges:[s],operation:[{slot:c.P8.SLOT_HIDDEN,hidden:0}],sheetId:this.sheetId,type:this.type,filterViewId:this.filterViewId}))}},(0,s.Z)(t,[{key:"id",get:function(){return t.id}}]),t}(l.Z);ne.id=r.Z.SET_DIMENSION_SHOW_REQUEST;var re=ne,oe=function(e){function t(t,n){var r;return(r=e.call(this,t,n)||this).canUndoRedo=!1,r.behaviors=[{sheetId:t.sheetId,type:t.type,amount:t.amount}],r}return(0,i.Z)(t,e),t.prototype.do=function(e,t,n){var r=t.sheetManager.getSheetBySheetId(e.sheetId);if(null!==r){var o,s,i,a,l,c,h=[],g=r.getRowCount()-1,m=r.getColCount()-1;if(e.type===u.Z.ROWS)l=new f.Z(e.sheetId,g,g,0,m);else{if(e.type!==u.Z.COLUMNS)throw new Error("unknown dimension type");l=new f.Z(e.sheetId,0,g,m,m)}var v=S(r,l);if(n(new d.Z({index:e.type===u.Z.ROWS?g+1:m+1,amount:e.amount,type:e.type,sheetId:e.sheetId})),v&&v.cellDataDeltaAtPositions.length>0){for(o=0;o<v.cellDataDeltaAtPositions.length;o++)if(i=v.cellDataDeltaAtPositions[o].rowIndex,a=v.cellDataDeltaAtPositions[o].colIndex,0!==(c=v.cellDataDeltaAtPositions[o].cellDataDelta).setSlots)if(e.type===u.Z.ROWS)for(s=0;s<e.amount;s++)h.push({rowIndex:i+s+1,colIndex:a,cellDataDelta:c});else for(s=0;s<e.amount;s++)h.push({rowIndex:i,colIndex:a+s+1,cellDataDelta:c});l=e.type===u.Z.ROWS?new f.Z(e.sheetId,g+1,g+1+e.amount-1,0,m):new f.Z(e.sheetId,0,g,m+1,m+1+e.amount-1),h.length>0&&n(new p.Z({gridRange:l,cellDataDeltaAtPositions:h}))}}},(0,s.Z)(t,[{key:"id",get:function(){return r.Z.EXPAND_DIMENSION_REQUEST}}]),t}(l.Z);oe.id=r.Z.EXPAND_DIMENSION_REQUEST;var se=oe,ie=n("../packages/mutation/src/index.ts"),ae=n("../packages/model/src/range/index.ts"),le=function(e){function t(t,n){var r;return(r=e.call(this,t,n)||this).sheetId=t.sheetId,r.behaviors=[t],r}return(0,i.Z)(t,e),t.prototype.do=function(e,t,n){var r=e.ignoreInvalidError,o=e.colIndex,s=e.sheetId;n(new ie.fN({type:J.DIMENSION_TYPE.COLUMNS,sheetId:s,operation:[{slot:c.P8.SLOT_IGNORE_INVALID_ERROR,ignoreInvalidError:r}],ranges:[new ae.DimensionRange(s,o,o,J.DIMENSION_TYPE.COLUMNS)]}))},(0,s.Z)(t,[{key:"id",get:function(){return t.id}}]),t}(l.Z);le.id=r.Z.SET_COLUMN_IGNORE_ERROR;var de=n("../packages/mutation/src/embedded/AddEmbeddedObjectMutation.ts"),ue=n("../packages/model/src/cell/metadata/Metadata.ts"),ce=n("../spread-sheet/src/core/behavior/request/cell/ClearRangeRequest.ts"),he=n("../packages/mutation/src/embedded/DeleteEmbeddedObjectMutation.ts"),fe=n("../packages/model/src/embedded/index.ts"),pe=n("../packages/model/src/cell/ExtendedValue.ts"),ge=function(e){function t(t,n){var r;return(r=e.call(this,t,n)||this).behaviors=t instanceof Array?t:[t],r}return(0,i.Z)(t,e),t.prototype.do=function(e,t,n){var r=e.x,o=e.y,s=e.sheetId,i=e.type,a=t.sheetManager.getSheetBySheetId(s);!a||i===fe.EMBEDDED_OBJECT_TYPE.CELL_IMAGE&&(0,I.lv)(a,o,r)||(n(new de.Z({data:e})),ve(e,t,n))},(0,s.Z)(t,[{key:"id",get:function(){return t.id}}]),t}(l.Z);function me(e){var t=e.id,n=(0,ce.N)(),r=a.ZP.t("图片");return n.setSlot(A.CELL_DATA_SLOT.SLOT_EFFIECTIVE_VALUE,pe.Z.createInstance({type:A.EXTENDED_VALUE_TYPE.STRING,value:r})),n.setSlot(A.CELL_DATA_SLOT.SLOT_METADATA,ue.Z.createInstance({customDataType:I.ZP.IMAGE})),n.setSlot(A.CELL_DATA_SLOT.SLOT_REF_IDS,[t]),n}function ve(e,t,n){var r=e.sheetId;if(e.type===fe.EMBEDDED_OBJECT_TYPE.CELL_IMAGE){var o=t.sheetManager.getSheetBySheetId(r);if(o){var s=e.x,i=e.y,a=o.getCellDataAtPosition(i,s),l=null===a||void 0===a?void 0:a.getMergeReference();l&&(i=l.startRowIndex,s=l.startColIndex);var d=o.getCellImage(i,s);d&&n(new he.Z({key:d.id,sheetId:r}));var u=o.transformCoordFromFilterViewToSheet(i,s),c=u.row,h=u.col,f=new ae.GridRange(r,c,c,h,h);n(new L.Z({gridRange:f,cellDataDelta:me(e)}))}}}ge.id=r.Z.ADD_IMAGE_REQUEST;var Ie=ge,Ee=n("../spread-sheet/src/core/behavior/request/embedded/DeleteImageRequest.ts"),Se=n("../packages/mutation/src/embedded/UpdateEmbeddedObjectMutation.ts"),Re=n("../packages/model/src/embedded/EmbeddedObjectType.ts");function we(e,t){return e.checkRangeStatus(t)?null:{isWarningOnly:!1,error:{title:a.ZP.t("出现问题"),content:a.ZP.t("此范围已被保护。如需编辑，请联系创建者「{{ownerNick}}」授予权限。",{ownerNick:n.g.clientVars.ownerNick})}}}var Ae=function(e){function t(t,n){var r;return(r=e.call(this,t,n)||this).behaviors=t instanceof Array?t:[t],r}(0,i.Z)(t,e);var n=t.prototype;return n.check=function(e){for(var t=this.behaviors.length,n=0;n<t;n++){var r=this.behaviors[n],o=this.checkUpdateImageRangeAuth(e.parent.sheetStatus,r);if(null!==o)return o}return null},n.do=function(e,t,n){var r,o=e.x,s=e.y,i=e.id,a=e.sheetId;if(e.changeType){if((null===(r=t.activeSheet.imageManager.getImage(e.id))||void 0===r?void 0:r.type)===e.type)return void console.warn("图片类型转换参数异常，可能已经被协同转换");e.type===Re.Z.CELL_IMAGE&&ve(e,t,n),e.type===Re.Z.IMAGE&&(0,Ee.p)({row:s,col:o,id:i,sheetId:a},t,n)}n(new Se.Z({data:Object.assign(Object.assign({},e),{x:o,y:s})}))},n.checkUpdateImageRangeAuth=function(e,t){if(t.type===Re.Z.CELL_IMAGE){var n=t.sheetId,r=t.x,o=t.y;return we(e,new f.Z(n,o,o,r,r))}return null},(0,s.Z)(t,[{key:"id",get:function(){return t.id}}]),t}(l.Z);Ae.id=r.Z.UPDATE_IMAGE_REQUEST;var Ce=Ae,ye=n("../packages/mutation/src/other/MapRangeMutation.ts"),_e=(n("../node_modules/core-js/modules/es.set.js"),n("../node_modules/core-js/modules/esnext.set.add-all.js"),n("../node_modules/core-js/modules/esnext.set.delete-all.js"),n("../node_modules/core-js/modules/esnext.set.difference.js"),n("../node_modules/core-js/modules/esnext.set.every.js"),n("../node_modules/core-js/modules/esnext.set.filter.js"),n("../node_modules/core-js/modules/esnext.set.find.js"),n("../node_modules/core-js/modules/esnext.set.intersection.js"),n("../node_modules/core-js/modules/esnext.set.is-disjoint-from.js"),n("../node_modules/core-js/modules/esnext.set.is-subset-of.js"),n("../node_modules/core-js/modules/esnext.set.is-superset-of.js"),n("../node_modules/core-js/modules/esnext.set.join.js"),n("../node_modules/core-js/modules/esnext.set.map.js"),n("../node_modules/core-js/modules/esnext.set.reduce.js"),n("../node_modules/core-js/modules/esnext.set.some.js"),n("../node_modules/core-js/modules/esnext.set.symmetric-difference.js"),n("../node_modules/core-js/modules/esnext.set.union.js"),n("../packages/model/src/cell/CellDataDelta.ts")),Te=n("../packages/mutation/src/merge/UnmergeCellsMutation.ts"),xe=(n("../node_modules/core-js/modules/es.regexp.to-string.js"),n("../packages/model/src/cell/CellData.ts")),be=n("../packages/model/src/cell/CellFormatSlot.ts"),De=n("../spread-sheet/src/core/feature/formula/utils/parseUtil.ts");function Oe(e,t,n,r,o){if(void 0===n&&(n=m.i.ALL),void 0===r&&(r=be.$.ALL),!o.getSheetTitleBySheetId)throw new Error("createCellDataDelta need getSheetTitleBySheetId when formulaRelative is true");var s=new _e.Z;if(!function(e,t){return!(!e.cellData&&!t.cellData)&&(e.cellData||(e.cellData=new xe.Z),t.cellData||(t.cellData=new xe.Z),!0)}(e,t))return s;for(var i=0,a=n;a>0;a>>=1,i++)if(1===(1&a))if(t.cellData.hasSlot(i)&&v.createCellDataDeltaMap[i])if(i===m.Z.SLOT_FORMULA)if(t.cellData.getFormula()){if(void 0===e.rowIndex||void 0===e.colIndex||void 0===t.rowIndex||void 0===t.colIndex){console.error("错误，检测函数delta必须要传入rowIndex和colIndex");break}s.setSlot(i,(0,De.EG)(t.cellData.getFormula().toString(t.rowIndex,t.colIndex,o),e.rowIndex,e.colIndex,e.sheetId))}else s.setSlot(i,null);else v.createCellDataDeltaMap[i](s,e.cellData,t.cellData,r);else e.cellData.hasSlot(i)&&s.clearSlot(i);return s}var Me=n("../packages/model/src/cell/format/BorderType.ts"),je=n("../packages/model/src/cell/CellFormatDelta.ts"),Le=n("../packages/mutation/src/sheet/DeleteSheetRangeMutation.ts"),Ze=n("../packages/model/src/cell/CellFormat.ts"),ke=n("../packages/model/src/cell/format/Borders.ts"),Ne=n("../spread-sheet/src/core/behavior/utils.ts");function Pe(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){if(e){if("string"===typeof e)return Ue(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Ue(e,t):void 0}}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0;return function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Ue(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Fe=function(e){function t(t,n){var r;return(r=e.call(this,t,n)||this).sheetId=t.sheetId,t.gridRanges?r.behaviors=t.gridRanges:n&&(r.behaviors=n.rangeSelections),r}(0,i.Z)(t,e);var r=t.prototype;return r.check=function(e){var t=null;return(t=this.checkSheet(e))||(t=this._checkRangeValid())||(t=this._checkCrossFilterHeader(e))||(t=this.checkCrossFilterViewReorder(e))||(t=this._checkIntersectAndForm(e))?t:(t=this._checkMultiContent(e))||t},r.do=function(e,t,n){var r=this,o=e.startRowIndex,s=e.startColIndex,i=e,a=t.sheetManager.getSheetBySheetId(this.sheetId),l={row:0,column:0};if(a){var d=this._findMainCell(a,e),u=d.x,c=d.y;l.row=c,l.column=u;for(var h=(0,Te.N)(i,a),f=0;f<h.length;f+=2)n(h[f]);var p=this.checkMergeBorders(l,e,a);i.each((function(e,t){if(e!==c||t!==u){var o=a.getCellImage(e,t);o&&n(new ie.G1({key:o.id,sheetId:r.sheetId}))}}));var v=this._updateMainPosition(l,o,s,t);v&&n(v);for(var I=(0,g.g)(i),E=0;E<I.length;E++){var S=I[E];n(new L.Z({gridRange:S,cellDataDelta:new _e.Z({setSlots:0,clearSlots:m.i.ALL,delta:{}})})),S.each((function(e,t){var o=a.getCellDataAtPosition(e,t);o&&(o.getSheetRangeReferences()||[]).forEach((function(e){var t=e.id;n(new Le.Z({sheetId:r.sheetId,sheetRangeId:t,nonPersistingLocalChange:!1}))}))}))}p&&n(p),n(new g.Z({startRowIndex:e.startRowIndex,endRowIndex:e.endRowIndex,startColIndex:e.startColIndex,endColIndex:e.endColIndex,sheetId:this.sheetId}))}},r.checkMergeBorders=function(e,t,n){var r=t.startRowIndex,o=t.endRowIndex,s=t.startColIndex,i=t.endColIndex,a={top:void 0,right:void 0,bottom:void 0,left:void 0,diagUp:void 0,diagDown:void 0},l=!0;(e.row!=r||e.column!=s||(0,X.wP)(n,e.row,e.column,Me.Z.LEFT,!0)||(0,X.wP)(n,e.row,e.column,Me.Z.TOP,!0))&&(l=!1),a.top=this.getTopBorder(n,s,i,r),a.left=this.getLeftBorder(n,r,o,s),a.diagUp=this.getDiagUpBorder(n,r,o,s,i),a.diagDown=this.getDiagDownBorder(n,r,o,s,i);var d=this.getRightBorder(n,r,o,i,l,e),u=d.right,c=d.isAllRight;a.right=u;var h=this.getBottomBorder(n,s,i,o,l,e),f=h.bottom,p=h.isAllBottom;return a.bottom=f,this.getSetRangeMutation(n,r,o,s,i,a,c,p)},r.checkSheet=function(e){var t=this.behaviors,n={isWarningOnly:!1,error:{title:a.ZP.t("出现问题"),content:a.ZP.t("合并单元格操作错误, 请重试")}},r=Array.from(new Set(t.map((function(e){return e.sheetId}))));return 1===r.length&&e.sheetManager.getSheetBySheetId(r[0])?null:n},r._checkRangeValid=function(){for(var e=0;e<this.behaviors.length;e++){var t=this.behaviors[e];if(t.isSingle())return{isWarningOnly:!0,ignore:!0};for(var n=e+1;n<this.behaviors.length;n++)if(t.isCross(this.behaviors[n]))return{isWarningOnly:!0,ignore:!0}}return null},r.hasMergeCell=function(e,t){var n,r,o;for(n=0,r=t.length;n<r;n++)if(o=t[n],e.contain(o))return!0;return!1},r._checkCrossFilterHeader=function(e){var t=function(e,t){for(var n,r=Pe(e);!(n=r()).done;){var o=n.value,s=t.sheetManager.getSheetBySheetId(o.sheetId);if(null!==s){var i=s.getAllBasicFilter();if(!i.length)return!1;for(var a,l=Pe(i);!(a=l()).done;){var d=a.value;if(null!==d){var u=d.range,c=u.startRowIndex,h=u.startColIndex,p=u.endColIndex,g=u.sheetId,m=new f.Z(g,c,c,h,p);if(o.isCross(m))return!0}}}}return!1}(this.behaviors,e);return t?{isWarningOnly:!1,error:{title:a.ZP.t("出现问题"),content:a.ZP.t("合并单元格暂不能包含筛选按钮所在的位置，请解除表格或视图中的筛选之后重试。")}}:null},r.checkCrossFilterViewReorder=function(e){var t=this.behaviors,n=e.sheetManager.getSheetBySheetId(t[0].sheetId);if(!n.getFilterViewsInSheet().length)return null;var r=n.getAllBasicFilter();if(!r.length)return null;var o=r.filter((function(e){return Boolean(e.filterViewReference)}));if(!o.length)return null;var s=o.some((function(e){return e.sortSpecs.length}));if(!s)return null;for(var i,l=Pe(t);!(i=l()).done;)for(var d,u=i.value,c=Pe(r);!(d=c()).done;){var h=d.value;if(h.filterViewReference&&(!h.filterViewReference||h.sortSpecs.length)){var f=h.range;if(u.isCross(f)||u.contain(f)||f.contain(u))return{isWarningOnly:!1,error:{title:a.ZP.t("出现问题"),content:a.ZP.t("所选区域包含排序，请解除表格或视图中的筛选之后重试。")}}}}return null},r._checkIntersectAndForm=function(e){var t=function(e,t){for(var r=0,o=0;o<e.length;o++){var s=n.g.SpreadsheetApp.feature.relateForm,i=e[o],a=t.sheetManager.getSheetBySheetId(i.sheetId);if(null!==a&&s&&s.isRelated(i.sheetId)&&a.data.rowData){var l=a.data.rowMetadata,d=a.data.colMetadata;if(r=s.checkReleaseRange(i,l,d,4))return 4===r}}return!1}(this.behaviors,e);return t?{isWarningOnly:!1,error:{title:a.ZP.t("出现问题"),content:a.ZP.t("操作被禁止。无法合并包含收集表问题或数据的单元格。"),btnTxt:a.ZP.t("我知道了")}}:null},r._checkCrossMergeRange=function(e){for(var t=0;t<this.behaviors.length;t++)for(var n=this.behaviors[t],r=e.sheetManager.getSheetBySheetId(n.sheetId).mergeManager.mergeList,o=0;o<r.length;o++)if(r[o].isCross(n))return{isWarningOnly:!1,error:{title:a.ZP.t("出现问题"),content:a.ZP.t("您必须选择合并单元格范围内的所有单元格或取消合并单元格。")}};return null},r._checkMultiContent=function(e){for(var t=0;t<this.behaviors.length;t++){var n=this.behaviors[t],r=e.sheetManager.getSheetBySheetId(n.sheetId);if(null!==r)for(var o=0,s=n.startRowIndex;s<=n.endRowIndex;s++)for(var i=n.startColIndex;i<=n.endColIndex;i++){var l=r.getCellDataAtPosition(s,i);if(null!==l&&(null!==l.getEffectiveValue()&&""!==l.getEffectiveValue().value||null!==l.getFormula()||(0,Ne.m6)(l))&&(o+=1)>1)return{isWarningOnly:!0,warning:{title:a.ZP.t("合并单元格提示"),content:a.ZP.t("合并后将只保留左上角单元格中的内容，继续合并吗？")}}}}return null},r._findMainCell=function(e,t){var n,r=t.startRowIndex,o=t.endRowIndex,s=t.startColIndex,i=t.endColIndex,a=s;e:for(n=r;n<=o;n++)for(a=s;a<=i;a++){var l=e.getCellDataAtPosition(n,a);if(null!==l&&l.getEffectiveValue()&&""!==l.getEffectiveValue().value){if(n!==r||a!==s)break e;break e}}return n>o&&(n=r,a=s),{x:a,y:n}},r._updateMainPosition=function(e,t,n,r){var o=r.sheetManager.getSheetBySheetId(this.sheetId);if(e.row!==t||e.column!==n){var s=o.getCellDataAtPosition(t,n),i=o.getCellDataAtPosition(e.row,e.column),a=Oe({cellData:s,rowIndex:t,colIndex:n,sheetId:this.sheetId},{cellData:i,rowIndex:e.row,colIndex:e.column,sheetId:this.sheetId},m.i.ALL,be.$.ALL,{getSheetTitleBySheetId:function(e){return r.sheetManager.getSheetTitleBySheetId(e)}}),l=new p.Z({gridRange:new f.Z(this.sheetId,t,t,n,n),cellDataDeltaAtPositions:[{rowIndex:t,colIndex:n,cellDataDelta:a}]}),d=l.cellDataDeltaAtPositions[0].cellDataDelta.delta.userEnteredFormatDelta;return null!==d&&void 0!==d&&(d.clearSlot(be.Z.BORDER_TOP),d.clearSlot(be.Z.BORDER_BOTTOM),d.clearSlot(be.Z.BORDER_LEFT),d.clearSlot(be.Z.BORDER_RIGHT),d.clearSlot(be.Z.BORDER_DIAGUP),d.clearSlot(be.Z.BORDER_DIAGDOWN)),l}return null},r.getTopBorder=function(e,t,n,r){for(var o,s=t;s<=n;s++){var i=(0,X.wP)(e,r,s,Me.Z.TOP,!0);if(null===i||void 0===i)return null;if(void 0===o)o=i;else{if(null===o)return null;if(!o.equal(i))return null}}return o},r.getLeftBorder=function(e,t,n,r){for(var o,s=t;s<=n;s++){var i=(0,X.wP)(e,s,r,Me.Z.LEFT,!0);if(null===i||void 0===i)return null;if(void 0===o)o=i;else{if(null===o)return null;if(!o.equal(i))return null}}return o},r.getDiagUpBorder=function(e,t,n,r,o){for(var s,i=t;i<=n;i++)for(var a=r;a<=o;a++){var l=(0,X.wP)(e,i,a,Me.Z.DIAG_UP,!0);if(void 0!==s){if(null===l||void 0===l)break;if(null===s||void 0===s?void 0:s.equal(l))continue;break}s=l}return s},r.getDiagDownBorder=function(e,t,n,r,o){for(var s,i=t;i<=n;i++)for(var a=r;a<=o;a++){var l=(0,X.wP)(e,i,a,Me.Z.DIAG_DOWN,!0);if(void 0!==s){if(null===l||void 0===l)break;if(null===s||void 0===s?void 0:s.equal(l))continue;break}s=l}return s},r.getRightBorder=function(e,t,n,r,o,s){for(var i,a=!0,l=!1,d=t;d<=n;d++){var u=(0,X.wP)(e,d,r,Me.Z.RIGHT,!0);if(null!==u&&void 0!==u)if(a=!1,void 0===i)i=u;else{if(null===i){i=null;break}if(!i.equal(u)){i=null;break}}else i=null}return a&&o&&null!==(i=(0,X.wP)(e,s.row,s.column,Me.Z.RIGHT,!1))&&(l=!0),{right:i,isAllRight:l}},r.getBottomBorder=function(e,t,n,r,o,s){for(var i,a=!0,l=!1,d=t;d<=n;d++){var u=(0,X.wP)(e,r,d,Me.Z.BOTTOM,!0);if(null!==u&&void 0!==u)if(a=!1,void 0===i)i=u;else{if(null===i)break;if(!i.equal(u)){i=null;break}}else i=null}return a&&o&&null!==(i=(0,X.wP)(e,s.row,s.column,Me.Z.BOTTOM,!1))&&(l=!0),{bottom:i,isAllBottom:l}},r.getSetRangeMutation=function(e,t,n,r,o,s,i,a){for(var l=new f.Z(e.getSheetId(),t,n,r,o),d=[],u=[],c=t;c<=n;c++)for(var h=r;h<=o;h++)d.length=0,c===t?(d.push(Me.Z.TOP),h===r&&d.push(Me.Z.LEFT),h===o&&d.push(Me.Z.RIGHT),c===n&&d.push(Me.Z.BOTTOM)):c===n?(d.push(Me.Z.BOTTOM),h===r&&d.push(Me.Z.LEFT),h===o&&d.push(Me.Z.RIGHT)):h===r?(d.push(Me.Z.LEFT),h===o&&d.push(Me.Z.RIGHT)):h===o?d.push(Me.Z.RIGHT):d=[],a&&d.push(Me.Z.BOTTOM),i&&d.push(Me.Z.RIGHT),s.diagDown&&d.push(Me.Z.DIAG_DOWN),s.diagUp&&d.push(Me.Z.DIAG_UP),d=Array.from(new Set(d)),u.push({rowIndex:c,colIndex:h,cellDataDelta:new _e.Z({setSlots:1<<m.Z.SLOT_USER_ENTERED_FORMAT_DELTA,clearSlots:0,delta:{userEnteredFormatDelta:new je.Z({setSlots:this._getSetSlots(d),clearSlots:this._getClearSlots(d),delta:Ze.Z.createInstance({borders:this._getBorders(d,s)})})}})});return new p.Z({gridRange:l,cellDataDeltaAtPositions:u})},r._getBorders=function(e,t){var n,r={};for(n=0;n<e.length;n++)t[e[n]]&&(r[e[n]]={color:t[e[n]].color,style:t[e[n]].style});return ke.Z.createInstance(r)},r._getSetSlots=function(e){var t,n=0;for(t=0;t<e.length;t++)switch(e[t]){case Me.Z.TOP:n+=1<<be.Z.BORDER_TOP;break;case Me.Z.RIGHT:n+=1<<be.Z.BORDER_RIGHT;break;case Me.Z.BOTTOM:n+=1<<be.Z.BORDER_BOTTOM;break;case Me.Z.LEFT:n+=1<<be.Z.BORDER_LEFT;break;case Me.Z.DIAG_UP:n+=1<<be.Z.BORDER_DIAGUP;break;case Me.Z.DIAG_DOWN:n+=1<<be.Z.BORDER_DIAGDOWN}return n},r._getClearSlots=function(e){var t,n=0;for(n+=1<<be.Z.BORDER_TOP,n+=1<<be.Z.BORDER_RIGHT,n+=1<<be.Z.BORDER_BOTTOM,n+=1<<be.Z.BORDER_LEFT,n+=1<<be.Z.BORDER_DIAGUP,n+=1<<be.Z.BORDER_DIAGDOWN,t=0;t<e.length;t++)switch(e[t]){case Me.Z.TOP:n-=1<<be.Z.BORDER_TOP;break;case Me.Z.RIGHT:n-=1<<be.Z.BORDER_RIGHT;break;case Me.Z.BOTTOM:n-=1<<be.Z.BORDER_BOTTOM;break;case Me.Z.LEFT:n-=1<<be.Z.BORDER_LEFT;break;case Me.Z.DIAG_UP:n-=1<<be.Z.BORDER_DIAGUP;break;case Me.Z.DIAG_DOWN:n-=1<<be.Z.BORDER_DIAGDOWN}return n},(0,s.Z)(t,[{key:"id",get:function(){return t.id}}]),t}(l.Z);Fe.id=r.Z.MERGE_CELLS_REQUEST;var Ve=Fe,Be=function(e){function t(t,n){var r;return(r=e.call(this,t,n)||this).sheetId=t.sheetId,t.gridRanges?r.behaviors=t.gridRanges:n&&(r.behaviors=n.rangeSelections),r}return(0,i.Z)(t,e),t.prototype.do=function(e,t,n){var r=e.startRowIndex,o=e.endRowIndex,s=e.startColIndex,i=e.endColIndex,a=new f.Z(this.sheetId,r,o,s,i),l=t.sheetManager.getSheetBySheetId(this.sheetId);if(l)for(var d=(0,Te.N)(a,l),u=0;u<d.length;u++)n(d[u])},(0,s.Z)(t,[{key:"id",get:function(){return t.id}}]),t}(l.Z);Be.id=r.Z.UNMERGE_CELLS_REQUEST;var He=Be,Ge=n("../packages/mutation/src/filter/DefineFilterMutation.ts"),We=n("../packages/mutation/src/sheet/UpdateSheetRangeMutation.ts"),ze=n("../packages/report/src/index.ts"),Qe=n("../packages/model/src/workbookRange/WorkbookRangeDelta.ts"),Ye=n("../packages/model/src/range/sheet-range-delta.ts"),qe=n("../packages/common-utils/src/index.ts"),Je=n("../packages/model/src/filter-view/utils/merge-cell-util.ts");function Ke(e){return e.map((function(e){return new c.ZP({ranges:[e],operation:[{slot:c.P8.SLOT_SIZE,size:null},{slot:c.P8.SLOT_HIDDEN,hidden:0}].concat((0,o.Z)(e.dimension===J.DIMENSION_TYPE.COLUMNS?[{slot:c.P8.SLOT_COLUMN_TYPE_METADATA,columnTypeMetadata:null},{slot:c.P8.SLOT_IGNORE_VALIDATE_ROWS,ignoreValidateRows:void 0},{slot:c.P8.SLOT_IGNORE_INVALID_ERROR,ignoreInvalidError:void 0},{slot:c.P8.SLOT_DATA_VALIDATION,dataValidation:null}]:[])),type:e.dimension,sheetId:e.sheetId})}))}function Xe(e){return e.toDimensionData().amount}function $e(e,t,n,r){var o,s,i,a,l=t.endColIndex,d=t.endRowIndex,c=t.sheetId,h=n.reduce((function(e,t){return e+Xe(t)}),0),f=null===(o=n[0])||void 0===o?void 0:o.dimension,p=null===(s=n[0])||void 0===s?void 0:s.sheetId,g=r.reduce((function(e,t){return e+Xe(t)}),0),m=null===(i=r[0])||void 0===i?void 0:i.dimension,v=null===(a=r[0])||void 0===a?void 0:a.sheetId,I=tt(p,v,c),E=e.getColCount()-1,S=e.getRowCount()-1,R=E,w=S;p===c&&(f===u.Z.ROWS?w-=h:f===u.Z.COLUMNS&&(R-=h)),v===c&&(m===u.Z.ROWS?w+=g:m===u.Z.COLUMNS&&(R+=g));var A=et({isDimensionEffected:I,insertDimensionType:m,rowAfterDimensionCalc:w,endRowIndex:d,colAfterDimensionCalc:R,endColIndex:l}),C={endRowIndex:A.row,endColIndex:A.col,isNeedToExpand:!1};return C.isNeedToExpand=C.endRowIndex>S||C.endColIndex>E,C}n("../node_modules/core-js/modules/es.array.concat.js"),n("../node_modules/core-js/modules/es.map.js"),n("../node_modules/core-js/modules/esnext.map.delete-all.js"),n("../node_modules/core-js/modules/esnext.map.every.js"),n("../node_modules/core-js/modules/esnext.map.filter.js"),n("../node_modules/core-js/modules/esnext.map.find.js"),n("../node_modules/core-js/modules/esnext.map.find-key.js"),n("../node_modules/core-js/modules/esnext.map.includes.js"),n("../node_modules/core-js/modules/esnext.map.key-of.js"),n("../node_modules/core-js/modules/esnext.map.map-keys.js"),n("../node_modules/core-js/modules/esnext.map.map-values.js"),n("../node_modules/core-js/modules/esnext.map.merge.js"),n("../node_modules/core-js/modules/esnext.map.reduce.js"),n("../node_modules/core-js/modules/esnext.map.some.js"),n("../node_modules/core-js/modules/esnext.map.update.js");var et=function(e){var t=e.isDimensionEffected,n=e.insertDimensionType,r=e.rowAfterDimensionCalc,o=e.endRowIndex,s=e.colAfterDimensionCalc,i=e.endColIndex;return t?n===u.Z.ROWS?{row:r,col:i}:{row:o,col:s}:{row:o,col:i}},tt=function(e,t,n){return e===n||t===n};function nt(e){var t=[],n=e.pasteDimensionRanges,r=e.type,s=function(e,t){var n,r,s,i,a,l,d=[],u=e.values,f=e.type,p=e.ranges,g=0,m=0,v=0,I=null;function E(e,n){return e&&n?!e.equal(n,t):e!==n}function S(e,n){return e&&n?!e.equal(n,t):e!==n}function R(e,n){return e&&n?e.equal(n,t):e===n}var w=function(){n=p[g],r=n.startIndex;var e=(s=n.endIndex)-r+1,w=[];for(m=r;m<=s;m++)i=u[m-r],a=u[m-r+1],I=u[m-r-1],null!==i&&(E(I,i)&&(v=1),R(I,i)&&(v+=1),(S(i,a)||m===s)&&v&&0!==(l=i?(0,c.Dk)(i,t):[{slot:c.P8.SLOT_HIDDEN,hidden:0},{slot:c.P8.SLOT_SIZE,size:null}]).length&&w.push(new c.ZP({ranges:[new h.Z(n.sheetId,m-v+1,m,n.dimension)],operation:l,type:f,sheetId:n.sheetId})));for(var A=[],C=r;C<=s;C++){var y=C-r;y%e===0&&function(){var t=parseInt(""+y/e,10),n=w.map((function(n){return n.ranges.forEach((function(n){n.startIndex=n.startIndex+t*e,n.endIndex=n.endIndex+t*e})),n}));A=[].concat((0,o.Z)(A),(0,o.Z)(n))}()}d=[].concat((0,o.Z)(d),(0,o.Z)(A))};for(g=0;g<p.length;g++)w();return d}({values:e.values,type:r,ranges:n},{pixelSize:!0,hiddenByUser:!0,ignoreDefaultHidden:!0,clearDefaultSize:!0,columnTypeMetadata:!0});return t=[].concat((0,o.Z)(t),(0,o.Z)(s))}function rt(e){var t=e.pasteDimensionRanges,n=e.values,r=[],s=t.length;if(!n||0===t.length)return r;var i=t[0].dimension;if(t.filter((function(e){return e.dimension===t[0].dimension})).length!==s)return console.warn("pasteDimensionRanges ars not same dimension type"),r;var a=nt({pasteDimensionRanges:t,type:i,values:n});return r=[].concat((0,o.Z)(r),(0,o.Z)(a))}var ot=function(e){if(!e)return{};var t,n,r=[],s=[],i=e.sheet,a=e.pasteRange,l=e.pasteDimensionPropsRanges,c=e.insertDimensionRanges,h=e.deleteDimensionRanges,f=e.rowsDimensionProperties,p=e.columnsDimensionProperties,g=e.crossFilterRow;return h&&(r=h.map((function(e){return new M.Z({index:e.startIndex,amount:e.endIndex-e.startIndex+1,type:e.dimension,sheetId:e.sheetId})}))),c&&(s=c.map((function(e){return new d.Z({index:e.startIndex,amount:e.endIndex-e.startIndex+1,type:e.dimension,sheetId:e.sheetId})}))),t=function(e,t,n,r,o){var s=[],i=t.sheetId,a=e.getColCount(),l=e.getRowCount(),c=$e(e,t,n,r),h=c.endRowIndex,f=c.endColIndex;return f>=a&&s.push(new d.Z({type:u.Z.COLUMNS,index:a,amount:f-a+1,sheetId:i})),h+o>=l&&s.push(new d.Z({type:u.Z.ROWS,index:l,amount:h-l+o+1,sheetId:i})),s}(i,a,h||[],c||[],g),n=function(e){var t=e.pasteDimensionRanges,n=e.rowsDimensionProperties,r=e.columnsDimensionProperties,s=[];if(!t||0===t.length)return s;var i=t.filter((function(e){return e.dimension===u.Z.ROWS})),a=t.filter((function(e){return e.dimension===u.Z.COLUMNS}));if(n){var l=rt({pasteDimensionRanges:i,values:n});s=[].concat((0,o.Z)(s),(0,o.Z)(l))}if(r){var d=rt({pasteDimensionRanges:a,values:r});s=[].concat((0,o.Z)(s),(0,o.Z)(d))}return s}({pasteDimensionRanges:l,rowsDimensionProperties:f,columnsDimensionProperties:p}),{deleteDimensionMutations:r,insertDimensionsMutations:s,copyExpansionInsertDimensionMutations:t,copySetDimensionPropertiesMutations:n}},st=n("../packages/model/src/range/SheetRangeType.ts"),it=n("../packages/mutation/src/sheet/DefineSheetRangeMutation.ts"),at=n("../spread-sheet/src/core/data/configService/spreadConfig.ts");function lt(e,t){var n=e.rowIndex,r=e.colIndex;if(!t[n])return null;var o=t[n].values[r];if(!o)return null;var s=o.getSheetRangeReferences();if(!s)return null;for(var i=0;i<s.length;i++){var a=s[i],l=a.id,d=a.type;if(d===st.Z.COMMENT_RANGE)return{id:l,type:d}}return null}function dt(e,t,n){var r=t.startColIndex-n.startColIndex,o=t.startRowIndex-n.startRowIndex;return{colIndex:e.colIndex-r,rowIndex:e.rowIndex-o}}n("../node_modules/core-js/modules/es.regexp.exec.js"),n("../node_modules/core-js/modules/es.string.search.js"),n("../node_modules/core-js/modules/es.array.splice.js");var ut=n("../packages/model/src/range/gridRangeUtils.ts");function ct(e,t,n,r){return new ie.eU({sheetId:e,ruleIndex:t,rule:n,oldRuleRanges:r})}function ht(e,t,n,r){if(n.isValid()){var o=t.getSheetId(),s=o===e.range.sheetId,i=e.rule.index,a=e.rule.rule,l=a.clone();l.uid=null,s?(l.ruleRanges.push(n),l.ruleRanges=(0,ut.mergeGridRanges)((0,ut.getExceptGridRange)(l.ruleRanges,t)),r(ct(o,i,l,a.ruleRanges))):(l.ruleRanges=[n],r(function(e,t){var n={sheetId:e,ruleIndex:0,rule:t};return new ie.kP(n)}(o,l)))}}function ft(e,t,n,r){var s=t.getAbsolutePosition();e.conditionalFormatRuleManager.ruleTree.search({minX:s.startCol,maxX:s.endCol,minY:s.startRow,maxY:s.endRow}).forEach((function(s){var i=s.range,a=s.rule;if(!r||r.rule.id===a.id){var l=i.getCross(t);if(l){var d=[];if(i.isRow||i.isCol){if(!i.equal(t))return}else d.push.apply(d,(0,o.Z)(i.getExcept(l,e)));var u=a.rule.ruleRanges,c=a.rule.clone(),h=c.ruleRanges.filter((function(e){return!e.equal(i)}));h.push.apply(h,d),h.length>0?(c.ruleRanges=h,n(ct(t.sheetId,a.index,c,u))):n(function(e,t,n){return new ie.jZ({sheetId:e,ruleIndex:t,oldRuleRanges:n})}(t.sheetId,a.index,u))}}}))}function pt(e){var t=e.needDeleteConditionDataMap,n=e.targetRange,r=e.targetSheet,o=n.getAbsolutePosition();return r.conditionalFormatRuleManager.ruleTree.search({minX:o.startCol,maxX:o.endCol,minY:o.startRow,maxY:o.endRow}).forEach((function(e){var o=e.range,s=e.rule,i=o.getCross(n);if((o.isRow||o.isCol)&&(i=null,o.equal(n)&&(i=o)),i){var a=t.get(s.id);a?a.ranges.push(i):(a={ranges:[i],sheet:r,ruleNode:e},t.set(s.id,a))}})),t}function gt(e){return e.map((function(e){return new Te.Z(e)}))}var mt,vt,It=function(e){return(0,o.Z)(gt(e))},Et=n("../node_modules/lodash/uniqWith.js"),St=n.n(Et),Rt=n("../node_modules/lodash/isEqual.js"),wt=n.n(Rt),At=n("../packages/model/src/filter-view/utils/grid-range-util.ts"),Ct=n("../packages/mutation/src/other/CopyPasteMutation.ts");function yt(e,t){if(!e.isRow&&!e.isCol&&e.endRowIndex===e.startRowIndex&&e.endColIndex===e.startColIndex)return!0;if(t){var n=t.getMergeReference();if(null===n||void 0===n?void 0:n.equal(e))return!0}return!1}function _t(e,t){var n,r,o,s,i=e.sheetId,a=e.cellMask,l=e.formatMask,d=e.copyRange,u=e.pasteRange,c=t.data.rowData,h=d.startColIndex,p=d.startRowIndex,g=u.startColIndex,m=u.startRowIndex,v=d.getColCount(t),I=d.getRowCount(t),E=u.getColCount(t),S=u.getRowCount(t),R=c[p]&&c[p].values[h],w=c[m]&&c[m].values[g],A=yt(d,R),C=yt(u,w);A&&C?(o=1,s=1):(v<E?o=E/v>>0:v>E?(v=E,o=1):o=1,I<S?s=S/I>>0:I>S?(I=S,s=1):s=1);var y=[],_=new f.Z(d.sheetId,d.startRowIndex,d.startRowIndex+I-1,d.startColIndex,d.startColIndex+v-1),T=u,x=new f.Z(u.sheetId,u.startRowIndex,u.startRowIndex+I-1,u.startColIndex,u.startColIndex+v-1);for(n=0;n<s;n++)for(r=0;r<o;r++)(T=x.clone()).insertDimension({sheetId:T.sheetId,type:J.DIMENSION_TYPE.ROWS,index:-1,amount:n*I}),T.insertDimension({sheetId:T.sheetId,type:J.DIMENSION_TYPE.COLUMNS,index:-1,amount:r*v}),y.push(new Ct.S({source:_,destination:T}));return[new Ct.Z({sheetId:i,cellMask:a,formatMask:l,pasteMappings:y})]}!function(e){e[e.PASTE_NORMAL=0]="PASTE_NORMAL",e[e.PASTE_VALUES=1]="PASTE_VALUES",e[e.PASTE_FORMAT=2]="PASTE_FORMAT",e[e.PASTE_NO_BORDERS=3]="PASTE_NO_BORDERS",e[e.PASTE_FORMULA=4]="PASTE_FORMULA",e[e.PASTE_DATA_VALIDATION=5]="PASTE_DATA_VALIDATION",e[e.PASTE_CONDITIONAL_FORMATTING=6]="PASTE_CONDITIONAL_FORMATTING",e[e.PASTE_AS_TEXT=7]="PASTE_AS_TEXT",e[e.PASTE_COLUMN_WIDTHS=8]="PASTE_COLUMN_WIDTHS"}(mt||(mt={})),function(e){e[e.NORMAL=1]="NORMAL"}(vt||(vt={}));var Tt=function(e){function t(t,n){var r;r=e.call(this,t,n)||this;var o=t.sheetId,s=t.pasteType,i=t.pasteOrientation,a=t.copyRange;if(r.sheetId=o,r.copyRange=a,n){var l=n.rangeSelections;0===l.length||l.length>1?console.warn("invalid rangeSelections length"):(r.pasteRange=l[0],r.behaviors=l.map((function(e){return{sheetId:r.sheetId,pasteType:s,pasteOrientation:i,copyRange:a,pasteRange:e}})))}return r}(0,i.Z)(t,e);var n=t.prototype;return n.check=function(e){return null},n.do=function(e,t,n){t.parent&&n(_t(e,t.activeSheet))},(0,s.Z)(t,[{key:"id",get:function(){return t.id}}]),t}(l.Z);Tt.id=r.Z.COPY_PASTE_REQUEST;var xt=Tt,bt=n("../spread-sheet/src/core/feature/copyPaste/interfaces.ts");function Dt(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){if(e){if("string"===typeof e)return Ot(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Ot(e,t):void 0}}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0;return function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Ot(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Mt=function(e,t,n){for(var r,o=!1,s=Dt(e);!(r=s()).done;){var i=r.value;if(!(t<i.startRowIndex||t>i.endRowIndex)&&!(n<i.startColIndex||n>i.endColIndex)&&(t!==i.startRowIndex||n!==i.startColIndex)){o=!0;break}}return o},jt=function(e){var t=e.ranges,n=e.gridData,r=e.cellMask,o=e.formatMask,s=function(e,t,n,r,o,s){for(var i,a,l,d,u,c,h,f,g,E,S=[],R=e.ranges,w=e.gridData,A=e.isFormatPainter,C=0,y=w,_=r.data.rowData,T=[],x=0,b=0;C<R.length;C++){var D=(d=R[C]).sheetId;T=[],u=d.startRowIndex<0?y.startRow:d.startRowIndex,c=d.endRowIndex<0?r.getRowCount()-1:d.endRowIndex,h=d.startColIndex<0?y.startCol:d.startColIndex,f=d.endColIndex<0?r.getColCount()-1:d.endColIndex;for(var O=u;O<=c;O++){b=0;for(var M=h;M<=f;M++)if(g=y.rowData[O+x-u]?y.rowData[O+x-u].values[M+b-h]:null,E=_[u+O+x-u]?_[u+O+x-u].values[h+M+b-h]:null,g&&(!g||0!==g.setSlots)||E&&(!E||0!==E.setSlots)){var j=new xe.Z;j.setSlots=m.i.ALL,j.setUserEnteredFormat((null===E||void 0===E?void 0:E.getUserEnteredFormat())||null);var L={cellData:j,rowIndex:0,colIndex:0,sheetId:D};if(E&&o===bt.XE.text){var Z=null===(i=E.getUserEnteredFormat())||void 0===i?void 0:i.getOptions(),k=null===(a=null===g||void 0===g?void 0:g.getUserEnteredFormat())||void 0===a?void 0:a.getOptions(),N=Ze.Z.createInstance(Object.assign(Object.assign({},Z),k));null===g||void 0===g||g.setUserEnteredFormat(N)}var P={cellData:g,rowIndex:O-u,colIndex:M-h,sheetId:D},U=Mt(s,O,M),F=A?(0,v.createCellDataDeltaForFormatPainter)(L.cellData,P.cellData||null,U):(0,v.createCellDataDelta)(L.cellData,P.cellData||null,t,n),V=F.delta.effectiveFormatDelta;V&&(V.clearSlot(be.Z.BACKGROUND_COLOR),F.setSlot(m.Z.SLOT_EFFIECTIVE_FORMAT_DELTA,V)),F.delta.formula||A||F.clearSlot(m.Z.SLOT_FORMULA),(null===(l=F.delta.metadata)||void 0===l?void 0:l.customDataType)===I.ZP.TODO&&(F.clearSlot(m.Z.SLOT_METADATA),F.clearSlot(m.Z.SLOT_REF_IDS)),T.push({rowIndex:O,colIndex:M,cellDataDelta:F})}b+=f-h+1}x+=c-u+1,(0,At.N2)(T,d,r).forEach((function(e){var t=e.gridRange,n=e.deltas;S.push(new p.Z({gridRange:t,cellDataDeltaAtPositions:n}))}))}return S}({ranges:t,gridData:n,isFormatPainter:e.isFormatPainter},r,o,e.activeSheet,e.fromOuterContentType,e.mergeInfos);return s},Lt=function(e){var t=e.insertDimensionRanges,n=e.deleteDimensionRanges,r=e.sheet,s={beforeMutations:[],afterMutations:[]};return s=t.reduce((function(e,t){var s=function(e){var t,n=e.insertDimensionRange,r=e.deleteDimensionRanges,o=e.sheet,s=n.startIndex,i=n.endIndex,a=n.dimension,l=i-s+1,d=o.mergeManager.mergeList,c={beforeMutations:[],afterMutations:[]},h=function(){var e=d[t].clone();r.forEach((function(t){e.deleteDimension({sheetId:t.sheetId,type:t.dimension,index:t.startIndex,amount:t.endIndex-t.startIndex+1})})),a===u.Z.ROWS?s>e.startRowIndex&&s<=e.endRowIndex&&c.afterMutations.push(new g.Z({sheetId:e.sheetId,startRowIndex:e.startRowIndex,endRowIndex:e.endRowIndex+l,startColIndex:e.startColIndex,endColIndex:e.endColIndex})):a===u.Z.COLUMNS&&s>e.startColIndex&&s<=e.endColIndex&&c.afterMutations.push(new g.Z({sheetId:e.sheetId,startRowIndex:e.startRowIndex,endRowIndex:e.endRowIndex,startColIndex:e.startColIndex,endColIndex:e.endColIndex+l}))};for(t=0;t<d.length;t++)h();return c}({insertDimensionRange:t,deleteDimensionRanges:n,sheet:r}),i=s.beforeMutations,a=s.afterMutations;return e.beforeMutations=[].concat((0,o.Z)(e.beforeMutations),(0,o.Z)(i)),e.afterMutations=[].concat((0,o.Z)(e.afterMutations),(0,o.Z)(a)),e}),s),s};function Zt(e){return e.map((function(e){return new de.Z({data:e})}))}var kt=n("../spread-sheet/src/core/feature/copyPaste/lib/PasteSpecial/logics/pasteTypes.ts"),Nt=n("../spread-sheet/src/core/behavior/request/cell/SetMetadataRequest.ts"),Pt=n("../packages/utils/src/index.ts"),Ut=function(e){var t,n,r=e.infoDimension,s=e.cutData;return[].concat((0,o.Z)((null===(t=r.deleteDimensionRanges)||void 0===t?void 0:t.length)?[]:Ke(s.cutColumnsDimensionRanges)),(0,o.Z)((null===(n=r.deleteDimensionRanges)||void 0===n?void 0:n.length)?[]:Ke(s.cutRowsDimensionRanges)))},Ft=function(e,t){var n=e.copyRange,r=e.toGridRange,o=e.cutData.cutGridRanges.length>0,s=[];return n?(o&&(s=function(e){var t,n=e.fromRange,r=e.toRange,o=e.spreadsheetApp;if(!o||!n||!r)return[];var s=[],i=n.sheetId,a=o.spreadsheet.sheetManager.getSheetBySheetId(i);if(!a)return[];for(var l=a.data.rowData,d=r.sheetId,u=n.startRowIndex;u<=n.endRowIndex;u++)for(var c=n.startColIndex;c<=n.endColIndex;c++){var h={rowIndex:u,colIndex:c},p=dt(h,n,r);if(p){var g=lt(h,l);if(g){var m=null===(t=o.spreadsheet.sheetManager.getSheetBySheetId(i).sheetRangeManager.getSheetRange(g.id))||void 0===t?void 0:t.properties;if(d===i){var v=new f.Z(i,p.rowIndex,p.rowIndex,p.colIndex,p.colIndex),I=new We.Z({sheetRangeId:g.id,gridRange:v,sheetRangeType:g.type,sheetRangePropertiesDelta:{},nonPersistingLocalChange:!1,sheetId:i,padId:at.q.getConfig("padId"),sheetRangeDelta:new Ye.Z({commentSheetRangeProperties:m?m.clone():void 0})});s.push(I)}else{var E=new f.Z(d,p.rowIndex,p.rowIndex,p.colIndex,p.colIndex),S=new it.Z({sheetRangeId:g.id,gridRange:E,sheetRangeType:g.type,sheetRangePropertiesDelta:{},nonPersistingLocalChange:!1,sheetId:d,padId:at.q.getConfig("padId"),sheetRangeDelta:new Ye.Z({commentSheetRangeProperties:m?m.clone():void 0})});s.push(S);var R=new Le.Z({sheetId:i,sheetRangeId:g.id,nonPersistingLocalChange:!1});s.push(R)}}}}return s}({spreadsheetApp:t,fromRange:n,toRange:r})),s):s},Vt=function(e,t,n){var r=Bt(e,t);r&&(function(e,t){e.forEach((function(e){var n=e.ranges,r=e.sheet,o=e.ruleNode;n.forEach((function(e){ht(o,r,e,t)}))}))}(r.needAddConditionDataDeltaMap,n),function(e,t){e.forEach((function(e){var n=e.ranges,r=e.sheet,o=e.ruleNode;n.forEach((function(e){ft(r,e,t,o)}))}))}(r.needDeleteConditionDataDeltaMap,n))},Bt=function(e,t){var n=e.copyRange,r=e.toGridRange,s=e.isCut;if(e.pasteSpecialType!==kt.bX.ONLYVALUES&&n){var i=t.spreadsheet.sheetManager.getSheetBySheetId(n.sheetId),a=t.spreadsheet.sheetManager.getSheetBySheetId(r.sheetId);if(i&&a){var l=new Map;!function(e){var t=e.needAddConditionDataMap,n=e.copySheet,r=e.pasteSheet,o=e.copyRange,s=e.pasteRange,i=o.getAbsolutePosition();n.conditionalFormatRuleManager.ruleTree.search({minX:i.startCol,maxX:i.endCol,minY:i.startRow,maxY:i.endRow}).forEach((function(e){var n=e.range,i=e.rule,a=n.getCross(o),l=a.startRowIndex-o.startRowIndex,d=a.startColIndex-o.startColIndex,u=new ae.GridRange(s.sheetId,s.startRowIndex+l,s.startRowIndex+l+a.getRowCount(r)-1,s.startColIndex+d,s.startColIndex+d+a.getColCount(r)-1);if(u.isValid()){var c=t.get(i.id);c?c.ranges.push(u):(c={ranges:[u],sheet:r,ruleNode:e},t.set(i.id,c))}}))}({needAddConditionDataMap:l,copySheet:i,pasteSheet:a,copyRange:n,pasteRange:r});var d=new Map;s?(pt({needDeleteConditionDataMap:d,targetRange:r,targetSheet:a}),pt({needDeleteConditionDataMap:d,targetRange:n,targetSheet:i})):l.forEach((function(e){e.ranges.forEach((function(e){pt({needDeleteConditionDataMap:d,targetRange:e,targetSheet:a})}))})),d.forEach((function(e){e.ranges=(0,ut.getExceptGridRange)(e.ranges,e.sheet)})),l.forEach((function(e){e.ranges=(0,ut.getExceptGridRange)(e.ranges,e.sheet)}));var u=function(e,t){return e.forEach((function(e,n){var r=e.ranges,s=e.sheet;t.forEach((function(e,t){var i=e.ranges,a=e.sheet;if(n===t)for(var l=0;l<r.length;l++)for(var d=r[l],u=0;u<i.length;u++){var c=i[u],h=d.getCross(c);if(h){r.splice(l,1),i.splice(u,1),l-=1,u-=1;var f=d.getExcept(h,s);f.length>0&&r.push.apply(r,(0,o.Z)(f));var p=c.getExcept(h,a);p.length>0&&i.push.apply(i,(0,o.Z)(p))}}}))})),{needDeleteConditionDataDeltaMap:e,needAddConditionDataDeltaMap:t}}(d,l);return{needDeleteConditionDataDeltaMap:u.needDeleteConditionDataDeltaMap,needAddConditionDataDeltaMap:u.needAddConditionDataDeltaMap}}}},Ht=function(e){var t=e.infoDimension,n=ot(t).copySetDimensionPropertiesMutations;return n||[]},Gt=function(e,t){var n,r=e.infoDimension,s=e.cutData,i=e.pasteRanges,a=t.spreadsheet.activeSheet;return(0,o.Z)((null===(n=r.deleteDimensionRanges)||void 0===n?void 0:n.length)?[]:function(e,t,n,r){var s=[],i=r.insertDimensionRanges;return e.forEach((function(e){var r=[];null===i||void 0===i||i.forEach((function(t){var n=t.toDimensionData();e.insertDimension(n)})),t.forEach((function(t){var s,i=e.getExcept(t,n);(s=r).push.apply(s,(0,o.Z)(i))})),r=St()(r,wt()),(r=(0,At.e6)(r,n)).forEach((function(e){var t=new _e.Z({clearSlots:m.i.ALL});t.setSlot(m.Z.SLOT_USER_ENTERED_FORMAT_DELTA,new je.Z({clearSlots:be.$.ALL})),s.push(new L.Z({gridRange:e,cellDataDelta:t}))}))})),s}(s.cutGridRanges,i,a,r))},Wt=function(e,t){var r,s,i=e.copyPasteMutationsOptions,a=e.infoDimension,l=e.pasteRanges,d=e.sheetId,u=e.gridData,c=e.cellMask,h=e.formatMask,f=e.isFormatPainter,p=e.unmergeInfos,m=e.mergeInfos,v=e.cutData,E=e.params.fromOuterContentType,S=t.spreadsheet.activeSheet,R=zt(c),w=Qt(h),C=v.cutGridRanges.length>0,y=Yt(E),_=[],T=[];try{if(i){var x=a.insertDimensionRanges,b=i.copyRange;if(qt(x,b),T=_t({sheetId:d,copyRange:b,pasteRange:l[0],cellMask:R,formatMask:w},S),!C&&T.length){var D=T[0].pasteMappings;_.push.apply(_,(0,o.Z)(function(e,t){if(!(null===e||void 0===e?void 0:e.length))return[];for(var n=t.spreadsheetReference.getSpreadsheetId(!0),r=t.getSheetId(),o=[],s=[],i=0;i<e.length;i++)for(var a=e[i],l=a.source,d=a.destination,u=l.startColIndex,c=l.startRowIndex,h=d.startColIndex,f=d.endColIndex,p=d.startRowIndex,g=d.endRowIndex,m=h-u,v=p-c,E=p;E<=g;E++)for(var S=h;S<=f;S++){var R=t.getCellDataAtPosition(E-v,S-m),w=null===R||void 0===R?void 0:R.getCellType(),C=null===R||void 0===R?void 0:R.getDateReminderId();if(w===I.ZP.DATE_REMINDER&&C){var y=Pt.kk.getRandomId();o.push({srcDocId:n,srcReminderId:C,dstDocId:n,dstSheetId:r,dstReminderId:y});var _=new ae.GridRange(r,E,E,S,S),T=new A.CellDataDelta;T.setSlot(A.CELL_DATA_SLOT.SLOT_REF_IDS,[y]),s.push(new ie.Y0({gridRange:_,cellDataDelta:T}))}}return o.length&&t.spreadsheetReference.fireCopyDateReminder(o),s}(D,S)))}}else u&&(T=jt({fromOuterContentType:y,ranges:l,gridData:u,cellMask:R,formatMask:w,isFormatPainter:f,activeSheet:S,mergeInfos:m}),C||y===bt.XE.richText||function(e,t){var n=[],r=t.spreadsheetReference.getSpreadsheetId(!0);e.forEach((function(e){e.cellDataDeltaAtPositions.forEach((function(e){var o,s,i=e.cellDataDelta.delta,a=null===(o=i.metadata)||void 0===o?void 0:o.customDataType,l=null===(s=i.refIds)||void 0===s?void 0:s[0];if(a===I.ZP.DATE_REMINDER&&(null===l||void 0===l?void 0:l.length)){var d=Pt.kk.getRandomId();n.push({srcDocId:r,srcReminderId:l,dstDocId:r,dstSheetId:t.getSheetId(),dstReminderId:d}),i.refIds=[d]}}))})),n.length&&t.spreadsheetReference.fireCopyDateReminder(n)}(T,S))}catch(L){null===(r=n.g.log)||void 0===r||r.error("PasteDataRequest CellDataMutations",L)}T.length>0&&(0,Nt._L)([].concat((0,o.Z)(l),(0,o.Z)(v.cutGridRanges)),S,(function(e){return T.push(e)}));var O=gt(p),M=(null===(s=a.deleteDimensionRanges)||void 0===s?void 0:s.length)?[]:It(v.cutUnmergeOptions),j=function(e){return e.map((function(e){return new g.Z(e)}))}(m);return T.length>0&&(0,Nt._L)([].concat((0,o.Z)(l),(0,o.Z)(v.cutGridRanges)),S,(function(e){return T.push(e)})),[].concat((0,o.Z)(O),(0,o.Z)(M),(0,o.Z)(T),_,(0,o.Z)(j))},zt=function(e){return void 0!==e?e:m.i.ALL},Qt=function(e){return void 0!==e?e:be.$.ALL},Yt=function(e){return void 0!==e?e:bt.XE.illegal},qt=function(e,t){e&&e.forEach((function(e){var n=e.startIndex,r=e.endIndex,o=e.dimension,s=e.sheetId;t.insertDimension({sheetId:s,type:o,amount:r-n+1,index:n})}))},Jt=function(e){var t=e.pasteEmbeddedObjects,n=e.cutEmbeddedArray,r=[];return n.length>0&&r.push.apply(r,(0,o.Z)(n.map((function(e){var t=e.key,n=e.sheetId;return new he.Z({key:t,sheetId:n})})))),t&&r.push.apply(r,(0,o.Z)(Zt(t))),r},Kt=function(e){var t=(e.propsKeys||{}).cellImage;return t?Zt(t):[]};function Xt(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){if(e){if("string"===typeof e)return $t(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?$t(e,t):void 0}}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0;return function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function $t(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var en,tn=function(e,t,n,r){var o,s=arguments.length,i=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)i=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(i=(s<3?o(i):s>3?o(t,n,i):o(t,n))||i);return s>3&&i&&Object.defineProperty(t,n,i),i},nn=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)};function rn(e,t,n){for(var r={from:0,to:0},o=0;o<e.length;o++){var s=e[o],i=void 0;i=t.dimension===u.Z.ROWS?new h.Z(s.sheetId,s.startRowIndex,s.endRowIndex,u.Z.ROWS):new h.Z(s.sheetId,s.startColIndex,s.endColIndex,u.Z.COLUMNS),t.isCross(i)&&!t.isContain(i)&&(r.from+=1),n.isCross(i)&&(r.to+=1)}return ze.ZP.tdwReport({opername:"doc_excel_editor",module:"excel_mob_dimension",action:t.dimension===u.Z.ROWS?"drag_row":"drag_line",ver11:r.from,ver12:r.to}),r}var on=function(e){function t(t,n){var r;(r=e.call(this,t,n)||this).commonDimensionCheck=function(e){var t={isWarningOnly:!1,error:{title:a.ZP.t("出现问题"),content:a.ZP.t("移动行列出现问题，请重新操作。")}},n=r.behaviors[0],o=n.from,s=n.to,i=r.type!==u.Z.ROWS&&r.type!==u.Z.COLUMNS,l=e.sheetManager.getSheetBySheetId(r.sheetId);if(r.behaviors.length>1||i||!l)return t;var d=r.type===u.Z.ROWS?l.getRowCount():l.getColCount();return!o.isValid(d)||!(0,qe.hj)(s)||s<0||s>d?t:null},r.basicFilterCheck=function(e){var t=null,n=r.colBasicFilterCheck(e);if(null!==n)return t=n;var o=r.rowBasicFilterCheck(e);return null!==o?t=o:t},r.colBasicFilterCheck=function(e){for(var t,n,o=null,s=Xt(e.sheetManager.getSheetBySheetId(r.sheetId).getAllBasicFilter());!(n=s()).done;){var i=n.value;if(i&&r.type===u.Z.COLUMNS){var l=i.getHiddenRows();if((null===l||void 0===l?void 0:l.length)>0){var d=null===(t=i.filterViewReference)||void 0===t?void 0:t.getFilterViewName();return o={isWarningOnly:!1,error:{title:a.ZP.t("移动行列"),content:d?a.ZP.t("移动之前请先取消筛选视图: {{filterViewName}}中的筛选。",{filterViewName:d}):a.ZP.t("移动之前请先取消表格中的筛选。")}}}}}return o},r.rowBasicFilterCheck=function(e){for(var t,n,o=r.behaviors[0],s=o.from,i=o.to,l=null,d=Xt(e.sheetManager.getSheetBySheetId(r.sheetId).getAllBasicFilter());!(n=d()).done;){var c=n.value;if(c&&r.type===u.Z.ROWS&&s.startIndex!==i){var h=c.range,f=c.getHiddenRows();if(r.isNeedCancelFilter(h,s,f)){var p=null===(t=c.filterViewReference)||void 0===t?void 0:t.getFilterViewName();l={isWarningOnly:!1,error:{title:a.ZP.t("移动行列"),content:p?a.ZP.t("移动之前请先取消筛选视图: {{filterViewName}}中的筛选。",{filterViewName:p}):a.ZP.t("移动之前请先取消表格中的筛选。")}}}}}return l},r.mergeRangesCheck=function(e){for(var t=r.behaviors[0],n=t.from,o=t.to,s=e.sheetManager.getSheetBySheetId(r.sheetId).mergeManager.mergeList,i=0,a=s.length;i<a;i++){var l=s[i],d=r.type===u.Z.ROWS?r.mergeRangeRowCheck(o,n,l,s):r.mergeRangeColCheck(o,n,l,s);if(null!==d)return d}return null},r.checkConflictFilterType=function(e,t){var n=e.from;return{isMoveWholeFilterRow:r.type===u.Z.ROWS&&n.startIndex<=t.startRowIndex&&n.endIndex>=t.endRowIndex,isMoveWholeFilteCol:r.type===u.Z.COLUMNS&&n.startIndex<=t.startColIndex&&n.endIndex>=t.endColIndex,isMovePartFilterCol:r.type===u.Z.COLUMNS&&!(n.endIndex<t.startColIndex||n.startIndex>t.endColIndex),isMovePartFilterRow:r.type===u.Z.ROWS&&t.endRowIndex>=n.startIndex&&t.endRowIndex<=n.endIndex}},r.handleMovePartFilterCol=function(e,t,n){var o=t.filterViewReference,s=t.range,i=e.from,a=e.to,l=a.startIndex-i.startIndex,d=i.endIndex-i.startIndex+1,u=s.startColIndex,c=s.endColIndex;a.startIndex<=s.startColIndex?(u=s.startColIndex+d,c=s.endColIndex+d):a.startIndex<=s.endColIndex&&(c=s.endColIndex+d),s.endColIndex>=i.startIndex&&s.endColIndex<=i.endIndex&&l>0&&(u=s.startColIndex,c=s.endColIndex+l),s.startColIndex>=i.startIndex&&s.startColIndex<=i.endIndex&&l<0&&(u=s.startColIndex+l,c=s.endColIndex+d);var h=new f.Z(s.sheetId,s.startRowIndex,s.endRowIndex,u,c);return new N.ZP({sheetId:r.sheetId,filterViewId:null===o||void 0===o?void 0:o.filterViewId,workbookRangeId:n,updateType:N.Qn.UPDATE,delta:{range:h,defaultFilterId:n}})},r.updateRangeIfDeleteRowCol=function(e,t,n,r,o){var s=t.startIndex,i=t.endIndex,a=e.clone(),l=a.startRowIndex,d=a.endRowIndex,c=a.startColIndex,h=a.endColIndex,p=[],g=!1;if(n!==u.Z.ROWS||e.isCol?n!==u.Z.COLUMNS||e.isRow||(s<=c&&i>=h?g=!0:s<=h&&s>=c?(s>c&&p.push(new f.Z(r,l,d,c,s-1)),i<h&&p.push(new f.Z(r,l,d,i+1,h)),g=!0):i>=c&&i<=h?s<=c&&(p.push(new f.Z(r,l,d,i+1,h)),g=!0):p.push(a)):s<=l&&i>=d?g=!0:s<=d&&s>=l?(s>l&&p.push(new f.Z(r,l,s-1,c,h)),i<d&&p.push(new f.Z(r,i+1,d,c,h)),g=!0):i>=l&&i<=d?s<=l&&(p.push(new f.Z(r,i+1,d,c,h)),g=!0):p.push(a),g)if(n===u.Z.ROWS){var m=Math.max(s,e.startRowIndex),v=Math.min(i,e.endRowIndex);p.push(new f.Z(e.sheetId,m+o,v+o,e.startColIndex,e.endColIndex))}else{var I=Math.max(s,e.startColIndex),E=Math.min(i,e.endColIndex);p.push(new f.Z(e.sheetId,e.startRowIndex,e.endRowIndex,I+o,E+o))}return{result:p,needUpdate:g}},r.handleUpperCrossWhenRowConflictWithColRange=function(e,t){return e.to.startIndex<e.from.startIndex||e.to.startIndex<=t.range.endRowIndex&&e.from.startIndex<t.range.startRowIndex?new f.Z(t.range.sheetId,e.to.startIndex+t.range.startRowIndex-e.from.startIndex,t.range.endRowIndex,t.range.startColIndex,t.range.endColIndex):new f.Z(t.range.sheetId,e.from.endIndex+1,t.range.endRowIndex,t.range.startColIndex,t.range.endColIndex)},r.handleDownCrossWhenRowConflictWithColRange=function(e,t){return e.to.startIndex>e.from.startIndex||e.to.startIndex>t.range.startRowIndex&&e.from.endIndex>t.range.endRowIndex?new f.Z(t.range.sheetId,t.range.startRowIndex,e.to.endIndex+t.range.endRowIndex-e.from.endIndex,t.range.startColIndex,t.range.endColIndex):new f.Z(t.range.sheetId,t.range.startRowIndex,e.from.startIndex-1,t.range.startColIndex,t.range.endColIndex)},r.handleLeftCrossWhenColConflictWithRowRange=function(e,t){return e.to.startIndex<e.from.startIndex||e.to.startIndex<=t.range.endColIndex&&e.from.startIndex<t.range.startColIndex?new f.Z(t.range.sheetId,t.range.startRowIndex,t.range.endRowIndex,e.to.startIndex+t.range.startColIndex-e.from.startIndex,t.range.endColIndex):new f.Z(t.range.sheetId,t.range.startRowIndex,t.range.endRowIndex,e.from.endIndex+1,t.range.endColIndex)},r.handleRightCrossWhenColConflictWithRowRange=function(e,t){return e.to.startIndex>e.from.startIndex||e.to.startIndex>t.range.startColIndex&&e.from.endIndex>t.range.endColIndex?new f.Z(t.range.sheetId,t.range.startRowIndex,t.range.endRowIndex,t.range.startColIndex,e.to.endIndex+t.range.endColIndex-e.from.endIndex):new f.Z(t.range.sheetId,t.range.startRowIndex,t.range.endRowIndex,t.range.startColIndex,e.from.startIndex-1)},r.sheetId=t.sheetId,r.filterViewId=t.filterViewId,r.type=t.type;var o=0,s=0;t.from&&t.from.dimension===r.type&&(o=t.from.startIndex,s=t.from.endIndex);var i={from:new h.Z(r.sheetId,o,s,r.type),to:t.to};return r.behaviors=[i],r}(0,i.Z)(t,e);var n=t.prototype;return n.predictRequestSize=function(e){var t=e.sheetManager.getSheetBySheetId(this.sheetId),n=0,r=0;return t?(this.type===u.Z.ROWS?r=t.getColCount():this.type===u.Z.COLUMNS&&(r=t.getRowCount()),this.behaviors.forEach((function(e){n+=(e.from.endIndex-e.from.startIndex+1)*r*280})),n):0},n.requestSizeOverLimitTips=function(){return a.ZP.t("数据量较大，操作不成功。建议分批移动{{value}}。",{value:this.type===u.Z.ROWS?a.ZP.t("行"):a.ZP.t("列")})},n.check=function(e){var t=this.behaviors[0].to,n=this.commonDimensionCheck(e);if(null!==n)return n;var r=this.basicFilterCheck(e);if(null!==r)return r;var o=this.mergeRangesCheck(e);if(null!==o)return o;var s=this.highWaterCheck(e,t);if(null!==s)return s;var i=this.gridRangeCheck(e,t);if(null!==i)return i;var a=e.sheetManager.getSheetBySheetId(this.sheetId);if((0,Je.U)(a)){var l=this.mergeRangeFilterViewReorderCheck(e);if(l)return l}var d=this.filterViewReorderCheck(e);return d||null},n.isNeedCancelFilter=function(e,t,n){var r=this.isIncludeFilterHead(e,t),o=this.isIncludeAllFilterRange(e,t);return r&&(!o||o&&n&&n.length>0)},n.isIncludeFilterHead=function(e,t){return e.startRowIndex>=t.startIndex&&e.startRowIndex<=t.endIndex},n.isIncludeAllFilterRange=function(e,t){return e.startRowIndex>=t.startIndex&&e.endRowIndex<=t.endIndex},n.mergeRangeRowCheck=function(e,t,n,r){var o=null;if(e>n.startRowIndex&&e<=n.endRowIndex)return o={isWarningOnly:!1,error:{title:a.ZP.t("移动行列"),content:a.ZP.t("抱歉，无法将行移到穿越某个合并单元格的位置。请取消合并，然后重试。")}},rn(r,t,new h.Z(t.sheetId,e,e+t.endIndex-t.startIndex,t.dimension)),o;var s=new h.Z(n.sheetId,n.startRowIndex,n.endRowIndex,u.Z.ROWS);return t.isCross(s)&&!t.isContain(s)?(o={isWarningOnly:!1,error:{title:a.ZP.t("移动行列"),content:a.ZP.t("抱歉，无法移动只包含合并单元格的一部分的行。请取消合并，然后重试。")}},rn(r,t,new h.Z(t.sheetId,e,e+t.endIndex-t.startIndex,t.dimension)),o):o},n.mergeRangeColCheck=function(e,t,n,r){var o=null;if(e>n.startColIndex&&e<=n.endColIndex)return o={isWarningOnly:!1,error:{title:a.ZP.t("移动行列"),content:a.ZP.t("抱歉，无法将列移到穿越某个合并单元格的位置。请取消合并，然后重试。")}},rn(r,t,new h.Z(t.sheetId,e,e+t.endIndex-t.startIndex,t.dimension)),o;var s=new h.Z(n.sheetId,n.startColIndex,n.endColIndex,u.Z.COLUMNS);return t.isCross(s)&&!t.isContain(s)?(o={isWarningOnly:!1,error:{title:a.ZP.t("移动行列"),content:a.ZP.t("抱歉，无法移动只包含合并单元格的一部分的列。请取消合并，然后重试。")}},rn(r,t,new h.Z(t.sheetId,e,e+t.endIndex-t.startIndex,t.dimension)),o):o},n.gridRangeCheck=function(e,t){var n=null,r=this.type===u.Z.ROWS?t:f.v,o=this.type===u.Z.COLUMNS?t:f.v,s=this.type===u.Z.ROWS?t-1:f.v,i=this.type===u.Z.COLUMNS?t-1:f.v,l=new f.Z(this.sheetId,s,s,i,i),d=new f.Z(this.sheetId,r,r,o,o),c=e.parent.sheetStatus.getRangeCanEdit(l),h=e.parent.sheetStatus.getRangeCanEdit(d);return c||h||(n={isWarningOnly:!1,error:{title:a.ZP.t("移动行列"),content:a.ZP.t("创建人「{{value}}」设置了保护范围，你没有权限进行此操作。如需编辑，请联系创建者授予权限。",{value:window.clientVars.ownerNick})}},ze.ZP.kvrOss({itemname:"xls_rangeprotect_range_viewer_toast"})),n},n.do=function(e,t,n){var r,o,s,i=t.sheetManager.getSheetBySheetId(this.sheetId),a=(0,y.lO)({getSheetBySheetId:t.sheetManager.getSheetBySheetId.bind(t.sheetManager),getSheetIdList:t.sheetManager.getSheetIdList.bind(t.sheetManager),isSheetAmongTwoSheets:t.sheetManager.isSheetAmongTwoSheets.bind(t.sheetManager),getSheetIdBySheetIndex:t.sheetManager.getSheetIdBySheetIndex.bind(t.sheetManager),getSheetIndexBySheetId:t.sheetManager.getSheetIndexBySheetId.bind(t.sheetManager),getSheetTitleBySheetId:t.sheetManager.getSheetTitleBySheetId.bind(t.sheetManager)},t.workbookRangeManager,t.embeddedObjectManager,t.formulaModelManager),l=0,u=e.to;if(null!==i){var c=i.getBasicFilterInSheet(),f=e.from,p=(0,j.ic)([f],c),g=0,m=0;for(this.getMutationsBeforeExecuteAllDimensionChanges(t,p,u).forEach((function(e){n(e)})),o=0;o<p.length;o++){u<p[o].startIndex?u+=m:g+=m,p[o].startIndex-=g,p[o].endIndex-=g,m=(e={from:p[o],to:u}).from.endIndex-e.from.startIndex+1;var v=new d.Z({index:u,amount:m,type:this.type,sheetId:this.sheetId}),I=a.generateUpdateFormulaModelMutation(v);n(v),I.forEach((function(e){return n(e)})),this.generateAndDoConditionFormatMutations(e,t,n),(r=new h.Z(this.sheetId,e.from.startIndex,e.from.endIndex,this.type)).insertDimension({sheetId:this.sheetId,index:e.to,amount:m,type:this.type}),s={from:r,to:new h.Z(this.sheetId,u,u+m-1,this.type)};var E=this.doMapRange(s,e);l=s.to.startIndex-s.from.startIndex;var S=a.generateUpdateFormulaModelMutation(Object.assign(Object.assign({},E),{sheetId:this.sheetId}));n(E),S.forEach((function(e){return n(e)})),this.doSetDimensionProperties(s,l,i,n),this.doSetRange(s,i,l,n),this.doSetCellProperties(s,i,n),this.beforeMoveDimension(t,s,this.type).afterMutations.forEach((function(e){n(e)}));var R=new M.Z({index:s.from.startIndex,amount:m,type:this.type,sheetId:this.sheetId}),w=a.generateUpdateFormulaModelMutation(R);n(R),w.forEach((function(e){n(e)}))}}},n.doMapRange=function(e,t){var n,r={from:{startIndex:e.from.startIndex,endIndex:e.from.endIndex},to:t.to,sourceSheetId:this.sheetId,destinationSheetId:this.sheetId},o={from:{startIndex:-1,endIndex:-1},to:-1,sourceSheetId:this.sheetId,destinationSheetId:this.sheetId};return this.type===u.Z.ROWS?n=new ye.Z({row:r,column:o,sourceSheetId:this.sheetId,destinationSheetId:this.sheetId}):this.type===u.Z.COLUMNS&&(n=new ye.Z({row:o,column:r,sourceSheetId:this.sheetId,destinationSheetId:this.sheetId})),n},n.doSetDimensionProperties=function(e,t,n,r){var o,s=0,i=(0,c.OR)({sheet:n,type:this.type,ranges:[e.from],filterView:n.filterViewManager.getFilterViewByViewId(this.filterViewId)},Object.assign(Object.assign({},c.Sb),{needDefaultProperties:!0}));for(s=0;s<i.length;s++)(o=i[s]).operation.length>0&&(o.ranges.forEach((function(e){e.startIndex+=t,e.endIndex+=t})),r(o))},n.getGridRange=function(e,t){var n;return this.type===u.Z.ROWS?n=new f.Z(this.sheetId,e.from.startIndex,e.from.endIndex,0,t.getColCount()-1):this.type===u.Z.COLUMNS&&(n=new f.Z(this.sheetId,0,t.getRowCount()-1,e.from.startIndex,e.from.endIndex)),n},n.doSetRange=function(e,t,n,r){var o,s=this,i=this.getGridRange(e,t);i&&((o=this.getSetRangeMutation(t,i,n)).cellDataDeltaAtPositions.length>0&&(this.type===u.Z.ROWS?(o.gridRange.startRowIndex+=n,o.gridRange.endRowIndex+=n):this.type===u.Z.COLUMNS&&(o.gridRange.startColIndex+=n,o.gridRange.endColIndex+=n),o.cellDataDeltaAtPositions.forEach((function(e){s.type===u.Z.ROWS?e.rowIndex+=n:s.type===u.Z.COLUMNS&&(e.colIndex+=n)}))),r(o))},n.doSetCellProperties=function(e,t,n){var r=this.getGridRange(e,t);r&&n(new L.Z({gridRange:r,cellDataDelta:new _e.Z({setSlots:0,clearSlots:m.i.ALL,delta:{}})}))},n.getSetRangeMutation=function(e,t,n){var r,o,s,i,a=[];for(o=t.startRowIndex;o<=t.endRowIndex;o++)for(r=t.startColIndex;r<=t.endColIndex;r++){s=e.getCellDataAtPosition(o,r);var l=this.type===u.Z.ROWS?o+n:o,d=this.type===u.Z.ROWS?r:r+n;i=(0,v.createCellDataDelta)(null,s);var c=e.getCellDataAtPosition(l,d),h=null===c||void 0===c?void 0:c.getFormula();h&&i.setSlot(m.Z.SLOT_FORMULA,h),a.push({rowIndex:o,colIndex:r,cellDataDelta:i})}return new p.Z({gridRange:t,cellDataDeltaAtPositions:a})},n.beforeMoveDimension=function(e,t,n){var r=[],s=[],i=this.conflictMerge(t,e);r.push.apply(r,(0,o.Z)(i.beforeMutations)),s.push.apply(s,(0,o.Z)(i.afterMutations));var a=this.conflictFilter(t,e);r.push.apply(r,(0,o.Z)(a.beforeMutations)),s.push.apply(s,(0,o.Z)(a.afterMutations));var l=this.conflictWorkbooRange(t,n,e);s.push.apply(s,(0,o.Z)(l.afterMutations));var d=this.conflictWorkbookRange(t,n,e);return s.push.apply(s,(0,o.Z)(d.afterMutations)),{beforeMutations:r,afterMutations:s}},n.conflictWorkbooRange=function(e,t,n){var r=e.from,o=e.to.startIndex-r.startIndex,s={beforeMutations:[],afterMutations:[]},i=n.sheetManager.getSheetBySheetId(this.sheetId);return i.sheetRangeManager.each((function(e,n){var a=e.gridRange;t===u.Z.ROWS?a.startRowIndex>=r.startIndex&&a.endRowIndex<=r.endIndex&&s.afterMutations.push(new We.Z({sheetId:i.getSheetId(),sheetRangeId:n,gridRange:new f.Z(i.getSheetId(),a.startRowIndex+o,a.endRowIndex+o,a.startColIndex,a.endColIndex),sheetRangeType:e.sheetRangeType,nonPersistingLocalChange:!1,padId:e.padId,sheetRangeDelta:new Ye.Z({commentSheetRangeProperties:e.properties.clone()})})):a.startColIndex>=r.startIndex&&a.endColIndex<=r.endIndex&&s.afterMutations.push(new We.Z({sheetId:i.getSheetId(),sheetRangeId:n,gridRange:new f.Z(i.getSheetId(),a.startRowIndex,a.endRowIndex,a.startColIndex+o,a.endColIndex+o),sheetRangeType:e.sheetRangeType,nonPersistingLocalChange:!1,padId:e.padId,sheetRangeDelta:new Ye.Z({commentSheetRangeProperties:e.properties.clone()})}))})),s},n.conflictMerge=function(e,t){var n,r,o,s,i=e.from,a=e.to,l=t.sheetManager.getSheetBySheetId(this.sheetId),d=l.mergeManager.mergeList,c=a.startIndex-i.startIndex,h=[],p=[],g={beforeMutations:[],afterMutations:[]};if(0===d.length)return g;for(r=0;r<d.length;r++)n=d[r],this.type===u.Z.ROWS?n.startRowIndex>=i.startIndex&&n.endRowIndex<=i.endIndex&&(o=new f.Z(n.sheetId,n.startRowIndex+c,n.endRowIndex+c,n.startColIndex,n.endColIndex),(s=n.clone()).insertDimension({sheetId:s.sheetId,type:u.Z.ROWS,index:a.startIndex,amount:i.endIndex-i.startIndex+1}),h.push(o),p.push(n)):this.type===u.Z.COLUMNS&&n.startColIndex>=i.startIndex&&n.endColIndex<=i.endIndex&&(o=new f.Z(n.sheetId,n.startRowIndex,n.endRowIndex,n.startColIndex+c,n.endColIndex+c),(s=n.clone()).insertDimension({sheetId:s.sheetId,type:u.Z.COLUMNS,index:a.startIndex,amount:i.endIndex-i.startIndex+1}),h.push(o),p.push(n));return new Ve({sheetId:l.getSheetId(),gridRanges:h}).run(t,(function(e){g.afterMutations.push(e)})),new He({sheetId:l.getSheetId(),gridRanges:p}).run(t,(function(e){g.afterMutations.push(e)})),g},n.conflictFilter=function(e,t){for(var n,r,o,s,i,a=this,l=e.from,d=e.to,u=t.sheetManager.getSheetBySheetId(this.sheetId),c=d.startIndex-l.startIndex,h=u.getAllBasicFilter(),p={beforeMutations:[],afterMutations:[]},g=Xt(h);!(i=g()).done;){var m=i.value;if(null!==m){var v=m.workbookRangeId,I=m.range,E=m.criteriaMap,S=m.getHiddenRows(),R=void 0,w=this.checkConflictFilterType(e,I),A=w.isMoveWholeFilterRow,C=w.isMoveWholeFilteCol,y=w.isMovePartFilterCol,_=w.isMovePartFilterRow,T=I.sheetId,x=I.startRowIndex,b=I.endRowIndex,D=I.startColIndex,O=I.endColIndex;if(A)R=new f.Z(T,x+c,b+c,D,O),S=S.map((function(e){return e+c})),p.afterMutations.push(new N.ZP({sheetId:this.sheetId,workbookRangeId:v,filterViewId:null===(n=m.filterViewReference)||void 0===n?void 0:n.filterViewId,updateType:N.Qn.UPDATE,delta:{hiddenRows:S,range:R,defaultFilterId:v}}));else if(C)!function(){R=new f.Z(T,x,b,D+c,O+c);var e={};E.forEach((function(t,n){e[+n+c]=t})),p.afterMutations.push(new Z.Z({sheetId:a.sheetId,filterViewId:null===(r=m.filterViewReference)||void 0===r?void 0:r.filterViewId,delta:{defaultFilterId:v}})),p.afterMutations.push(new Ge.ZP({sheetId:a.sheetId,filterViewId:null===(o=m.filterViewReference)||void 0===o?void 0:o.filterViewId,gridRange:R,delta:{defaultFilterId:v,hiddenRows:S,criteriaDelta:e}}))}();else if(y){var M=this.handleMovePartFilterCol(e,m,v);p.afterMutations.push(M)}else if(_){var j=l.endIndex-l.startIndex+1,L=x,k=b;d.startIndex<=L&&(L+=j,k+=j),R=new f.Z(T,L,k,D,O),p.afterMutations.push(new N.ZP({sheetId:this.sheetId,filterViewId:null===(s=m.filterViewReference)||void 0===s?void 0:s.filterViewId,workbookRangeId:v,updateType:N.Qn.UPDATE,delta:{range:R,defaultFilterId:v}}))}}}return p},n.conflictWorkbookRange=function(e,t,n){var r,o=this,s={beforeMutations:[],afterMutations:[]};return n.workbookRangeManager.each((function(t){if(o.sheetId===t.range.sheetId&&t.type!==B.Z.CHART){var n=new Qe.Z;if(t.type===B.Z.PROTECTED_RANGE)n.setProtectionProperties(t.properties);else if(t.type===B.Z.LINKED_RANGE){var i=t.properties;i&&n.setLinkedRangeProperties(i)}r=null;var a=o.type===u.Z.ROWS&&!t.range.isCol,l=o.type===u.Z.COLUMNS&&!t.range.isRow;a?r=o.rowConflictWithColRange(e,t):l&&(r=o.colConflictWithRowRange(e,t)),r&&s.afterMutations.push(new V.Z({workbookRangeId:t.id,workbookRangeType:t.type,gridRange:r,workbookRangePropertiesDelta:n}))}})),s},n.rowConflictWithColRange=function(e,t){var n=null,r=e.from.startIndex<=t.range.startRowIndex&&e.from.endIndex>=t.range.endRowIndex,o=e.from.startIndex<=t.range.startRowIndex&&e.from.endIndex>=t.range.startRowIndex,s=e.from.startIndex<=t.range.endRowIndex&&e.from.endIndex>=t.range.endRowIndex;return r?n=new f.Z(t.range.sheetId,e.to.startIndex+t.range.startRowIndex-e.from.startIndex,e.to.endIndex+t.range.endRowIndex-e.from.endIndex,t.range.startColIndex,t.range.endColIndex):o?this.handleUpperCrossWhenRowConflictWithColRange(e,t):s?this.handleDownCrossWhenRowConflictWithColRange(e,t):n},n.colConflictWithRowRange=function(e,t){var n=null,r=e.from.startIndex<=t.range.startColIndex&&e.from.endIndex>=t.range.endColIndex,o=e.from.startIndex<=t.range.startColIndex&&e.from.endIndex>=t.range.startColIndex,s=e.from.startIndex<=t.range.endColIndex&&e.from.endIndex>=t.range.endColIndex;return r?n=new f.Z(t.range.sheetId,t.range.startRowIndex,t.range.endRowIndex,e.to.startIndex+t.range.startColIndex-e.from.startIndex,e.to.endIndex+t.range.endColIndex-e.from.endIndex):o?this.handleLeftCrossWhenColConflictWithRowRange(e,t):s?this.handleRightCrossWhenColConflictWithRowRange(e,t):n},n.generateAndDoConditionFormatMutations=function(e,t,n){var r=this.type===u.Z.ROWS?e.from.startIndex:void 0,o=this.type===u.Z.ROWS?e.from.endIndex:void 0,s=this.type===u.Z.ROWS?void 0:e.from.startIndex,i=this.type===u.Z.ROWS?void 0:e.from.endIndex,a=new f.Z(this.sheetId,r,o,s,i),l=e.from.endIndex-e.from.startIndex,d=this.type===u.Z.ROWS?e.to:void 0,c=this.type===u.Z.ROWS?e.to+l:void 0,h=this.type===u.Z.ROWS?void 0:e.to,p=this.type===u.Z.ROWS?void 0:e.to+l,g=new f.Z(this.sheetId,d,c,h,p);Vt({copyRange:a,toGridRange:g,isCut:!0,pasteSpecialType:kt.bX.KEEPDEFAULT},t.parent,n)},n.highWaterCheck=function(e,t){if(this.type===u.Z.ROWS){var n=f.v,r=new f.Z(this.sheetId,t-1,t-1,n,n);if(!e.parent.sheetStatus.isRangeCanEditByHighWater(r))return{ignore:!0}}return null},n.filterViewReorderCheck=function(e){var t=e.sheetManager.getSheetBySheetId(this.sheetId),n=t.filterViewManager.getFilterViewByViewId(this.filterViewId),r=t.getBasicFilter(),o=this.behaviors[0].from,s=(0,j.ic)([o],r);return(0,_.qz)(t,n,this.type,s,this.behaviors[0].to)?{isWarningOnly:!0,warning:{title:a.ZP.t("出现问题"),content:a.ZP.t("排序后, 移动行列的位置会按照原表操作, 是否继续操作?")}}:null},n.getMutationsBeforeExecuteAllDimensionChanges=function(e,t,n){var r=this.conflictFilterViewReorder(t,n,e);return(0,o.Z)(r)},n.conflictFilterViewReorder=function(e,t,n){var r=n.sheetManager.getSheetBySheetId(this.sheetId),o=r.filterViewManager.getFilterViewByViewId(this.filterViewId);return(0,_.qz)(r,o,this.type,e,this.behaviors[0].to)?(0,_.nH)(o):[]},n.mergeRangeFilterViewReorderCheck=function(e){var t=e.sheetManager.getSheetBySheetId(this.sheetId),n=this.behaviors[0],r=n.from,o=n.to;return(0,_.S2)(t,r,o,this.type)?{isWarningOnly:!1,error:{title:a.ZP.t("出现问题"),content:a.ZP.t("移动行列失败，合并单元格与现有筛选排序有交集")}}:null},(0,s.Z)(t,[{key:"id",get:function(){return t.id}}]),t}(l.Z);on.id=r.Z.MOVE_DIMENSION_REQUEST,tn([(0,w.M4)(on),nn("design:type",Function),nn("design:paramtypes",["function"===typeof(en="undefined"!==typeof C.V&&C.V)?en:Object]),nn("design:returntype",Number)],on.prototype,"predictRequestSize",null);var sn=on,an=n("../packages/mutation/src/sheet/UpdateAllSheetsMutation.ts"),ln=function(e){function t(t,n){var r;return(r=e.call(this,t,n)||this).canUndoRedo=!1,r.behaviors=t.behaviors,r.sheetId=t.sheetId,r}(0,i.Z)(t,e);var n=t.prototype;return n.getAffectedSheetId=function(){return this.sheetId},n.do=function(e,t,n){n(new an.Z({sheetId:this.sheetId,data:e}))},n.afterdo=function(){},(0,s.Z)(t,[{key:"id",get:function(){return t.id}}]),t}(l.Z);ln.id=r.Z.SET_SHEETS_REQUEST;var dn,un=ln,cn=n("../spread-sheet/src/core/behavior/request/enum/FormatItem.ts"),hn=n("../spread-sheet/src/base/util/timer.ts"),fn=((dn={})[cn.Z.FONT_FAMINY]=be.Z.FONT_FAMINY,dn[cn.Z.FONT_SIZE]=be.Z.FONT_SIZE,dn[cn.Z.BOLD]=be.Z.BOLD,dn[cn.Z.ITALIC]=be.Z.ITALIC,dn[cn.Z.WRAP_STRATEGY]=be.Z.WRAP_STRATEGY,dn[cn.Z.HORIZONTAL_ALIGN]=be.Z.HORIZONTAL_ALIGN,dn[cn.Z.VERTICAL_ALIGN]=be.Z.VERTICAL_ALIGN,dn[cn.Z.COLOR]=be.Z.FOREGROUND_COLOR,dn[cn.Z.BACKGROUND_COLOR]=be.Z.BACKGROUND_COLOR,dn[cn.Z.STRIKE_THROUGH]=be.Z.STRIKETHROUGH,dn[cn.Z.UNDERLINE]=be.Z.UNDERLINE,dn),pn=function(e){function t(t,n){var r;r=e.call(this,t,n)||this;var o=t.formatValue,s=t.formatItem,i=null==o,a=t.gridRange||(null===n||void 0===n?void 0:n.rangeSelections)||[],l=Array.isArray(a)?a:[a];return r.behaviors=l.map((function(e){return{gridRange:e,formatItem:s,formatValue:o,isClear:i}})),r}(0,i.Z)(t,e);var n=t.prototype;return n.do=function(e,t,n){var r=this.getCellDataDelta(e),o=t.sheetManager.getSheetBySheetId(e.gridRange.sheetId);if(!r.isEmpty()&&o){var s=[e.gridRange];s=(0,ut.divideGridRangesByFilter)(s,o.getBasicFilter()),s=(0,ut.divideGridRangesByMerges)(s,o.mergeManager.mergeList),(s=(0,At.e6)(s,o)).forEach((function(e){n(new L.Z({gridRange:e,cellDataDelta:r}));var t=[];e.each((function(e,n){var s=(0,X.mX)(o,e,n,r);s.isEmpty()||t.push({rowIndex:e,colIndex:n,cellDataDelta:s})}),o),t.length>0&&n(new ie.qi({gridRange:e,cellDataDeltaAtPositions:t}))})),hn.Z.wait(1e3).run((function(){e.gridRange.each((function(e,t){var n=null===o||void 0===o?void 0:o.getCellDataAtPosition(e,t);(null===n||void 0===n?void 0:n.getHyperlink())&&ze.ZP.tdwReport({opername:"doc_excel_editor",module:"excel_link",action:"edit_url_style"})}),o)}))}},n.getCellDataDelta=function(e){var t=e.isClear,n=e.formatItem,r=e.formatValue,o=new je.Z,s=fn[n];t?o.clearSlot(s):o.setSlot(s,r);var i=new _e.Z;return i.setSlot(m.Z.SLOT_USER_ENTERED_FORMAT_DELTA,o),i},(0,s.Z)(t,[{key:"id",get:function(){return t.id}}]),t}(l.Z);pn.id=r.Z.SET_FORMAT_REQUEST;var gn=pn,mn=n("../packages/mutation/src/new-embedded/NewUpdateEmbeddedObjectMutation.ts"),vn=function(e){function t(t,n){var r;return(r=e.call(this,t,n)||this).sheetId=t.sheetId,r.filterViewId=t.filterViewId,r.behaviors=[t],r}(0,i.Z)(t,e);var n=t.prototype;return n.do=function(e,t,n){void 0!==e.row&&n(new k.Z({sheetId:this.sheetId,filterViewId:this.filterViewId,sheetDelta:new P.Z({operation:U.C.SET_PROPERTIES,delta:{frozenRowCount:e.row}})})),void 0!==e.column&&n(new k.Z({sheetId:this.sheetId,filterViewId:this.filterViewId,sheetDelta:new P.Z({operation:U.C.SET_PROPERTIES,delta:{frozenColCount:e.column}})})),t.embeddedObjectManager.each((function(t){var r=t.location.position,o=r.rowIndex,s=r.colIndex;if(o<Number(e.row)||s<Number(e.column)){var i=t.clone();i.location.position={rowIndex:Math.max(o,Number(e.row)),colIndex:Math.max(s,Number(e.column))},n(new mn.Z({object:i}))}}))},n.check=function(e){var t=null,n=e.sheetManager.getSheetBySheetId(this.sheetId),r=this.behaviors[0].column,o=this.behaviors[0].row,s={isWarningOnly:!1,error:{title:a.ZP.t("出现问题"),content:a.ZP.t("请刷新页面重试")}};if(null===n)return s;if(this.filterViewId&&!n.filterViewManager.getFilterViewByViewId(this.filterViewId))return s;if(0===r&&0===o){this.behaviors[0].column=1,this.behaviors[0].row=1;var i=n.properties.gridProperties;if(1!==i.frozenColCount||1!==i.frozenRowCount)return t={isWarningOnly:!0,warning:{title:a.ZP.t("冻结窗格"),content:a.ZP.t("确定要冻结首行和首列吗？"),repeat:!0}}}return-1===r&&(this.behaviors[0].column=0),-1===o&&(this.behaviors[0].row=0),t},(0,s.Z)(t,[{key:"id",get:function(){return t.id}}]),t}(l.Z);vn.id=r.Z.FREEZE_REQUEST;var In=vn,En=n("../spread-sheet/src/core/behavior/request/cell/SetSingleValueRequest.ts"),Sn=n("../packages/model/src/filter-view/utils/create-reorder-operation-util.ts"),Rn=n("../packages/mutation/src/other/ReorderRangeMutation.ts");function wn(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){if(e){if("string"===typeof e)return An(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?An(e,t):void 0}}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0;return function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function An(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Cn(e,t){for(var n,r=wn(e);!(n=r()).done;){var o=n.value;if(t.isCross(o)){var s="";return o.startColIndex===o.endColIndex&&o.startRowIndex!==o.endRowIndex?s=a.ZP.t("纵向的"):o.startColIndex!==o.endColIndex&&o.startRowIndex===o.endRowIndex&&(s=a.ZP.t("横向的")),{isWarningOnly:!1,error:{title:a.ZP.t("排序提示"),content:a.ZP.t("你的排序区域中包含{{mergeType}}合并单元格 {{value1}}，请取消合并单元格后再进行排序。",{mergeType:s,value1:o.toString()})}}}}return null}function yn(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){if(e){if("string"===typeof e)return _n(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_n(e,t):void 0}}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0;return function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _n(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Tn=function(e){function t(t,n){var r;return(r=e.call(this,t,n)||this).sheetId=t.sheetId,r.gridRange=t.gridRange,r.behaviors=[{reorderInfos:t.reorderInfos,hasTitle:t.hasTitle}],r.sheetStatus=t.sheetStatus,r}(0,i.Z)(t,e);var n=t.prototype;return n.check=function(e){var t=e.sheetManager.getSheetBySheetId(this.sheetId);if(null===t)return{isWarningOnly:!1,error:{title:a.ZP.t("出现问题"),content:a.ZP.t("请刷新页面重试")}};var n=this.checkFilterViewResult(t);if(null!==n)return n;var r=we(e.parent.sheetStatus,this.gridRange);if(null!==r)return r;var o=Cn(t.mergeManager.mergeList,this.gridRange);return null!==o?o:null},n.do=function(e,t,n){for(var r,o=this.gridRange,s=t.sheetManager.getSheetBySheetId(this.sheetId),i=e.hasTitle,a=this.createUnmergeCellsMutations(t),l=yn(a);!(r=l()).done;){var d=r.value;n(d)}var u=(0,Sn.lU)({sheet:s,range:o,hasTitle:i,reorderInfos:e.reorderInfos}),c=this.createUpdateSheetRangeMutations(t,u,o);n(new Rn.Z({sheetId:this.sheetId,range:o,operation:u})),c.length>0&&c.forEach((function(e){n(e)}));for(var h,f=yn(a);!(h=f()).done;){var p=h.value;if(p instanceof Te.Z){var m=p.startRowIndex;u.rules[m]?n(new g.Z({sheetId:this.sheetId,startRowIndex:u.rules[m].to,endRowIndex:u.rules[m].to,startColIndex:p.startColIndex,endColIndex:p.endColIndex})):n(new g.Z({sheetId:this.sheetId,startRowIndex:p.startRowIndex,endRowIndex:p.endRowIndex,startColIndex:p.startColIndex,endColIndex:p.endColIndex}))}}},n.createUnmergeCellsMutations=function(e){var t=[],n=e.sheetManager.getSheetBySheetId(this.sheetId);return new He({sheetId:n.getSheetId(),gridRanges:[this.gridRange]}).run(e,(function(e){t.push(e)})),t},n.createUpdateSheetRangeMutations=function(e,t,n){var r,o,s,i,a,l=[],d=e.sheetManager.getSheetBySheetId(this.sheetId),u=this.sheetId;function c(t,n,r){var o,s=null===(o=e.sheetManager.getSheetBySheetId(u).sheetRangeManager.getSheetRange(t.id))||void 0===o?void 0:o.properties;l.push(new We.Z({sheetId:u,sheetRangeId:t.id,sheetRangeType:t.type,gridRange:new f.Z(u,n,n,r,r),padId:at.q.getConfig("padId"),sheetRangeDelta:new Ye.Z({commentSheetRangeProperties:s?s.clone():void 0})}))}for(r=0;r<t.queue.length;r++)for(s=t.queue[r],o=n.startColIndex;o<=n.endColIndex;o++)(i=d.getCellDataAtPosition(t.rules[s].from,o))&&(a=i.getSheetRangeReferences())&&a.forEach((function(e){c(e,t.rules[s].to,o)}));return l},n.checkFilterViewResult=function(e){var t=e.filterViewManager.getActiveFilterView();if(!t)return null;var n=t.getBasicFilter();return n&&n.range.isCross(this.gridRange)?{isWarningOnly:!1,error:{title:a.ZP.t("提示"),content:a.ZP.t("请从单元格旁的筛选按钮对整个区域进行排序。")}}:null},(0,s.Z)(t,[{key:"id",get:function(){return t.id}}]),t}(l.Z);Tn.id=r.Z.REORDER_RANGE_REQUEST;var xn=Tn,bn=n("../packages/model/src/cell/format/Border.ts"),Dn=function(e){function t(t,n){var r,o,s,i,a=[];if((r=e.call(this,t,n)||this).props=t.props,n)for(o=0,s=n.rangeSelections.length;o<s;o++)i={gridRange:n.rangeSelections[o],props:t.props,type:t.type},a.push(i);else t.gridRange&&(i={gridRange:t.gridRange,props:t.props,type:t.type},a.push(i));return r.behaviors=a,r}(0,i.Z)(t,e);var n=t.prototype;return n.do=function(e,t,n){var r,o=t.sheetManager.getSheetBySheetId(e.gridRange.sheetId),s=[e.gridRange],i=e.gridRange,a=[],l=e.type;if(null!==o)for(s=(0,ut.divideGridRangesByFilter)(s,o.getBasicFilter()),s=(0,At.e6)(s,o),r=0;r<s.length;r++)i=s[r],a=[],Array.prototype.push.apply(a,this.getSetCellsBorder(i,l)),Array.prototype.push.apply(a,this.getClearCellsBorder(i,l,t)),i.startRowIndex=Math.max(0,i.startRowIndex-1),i.endRowIndex=Math.min(o.getRowCount()-1,i.endRowIndex+1),i.startColIndex=Math.max(0,i.startColIndex-1),i.endColIndex=Math.min(o.getColCount()-1,i.endColIndex+1),n(new p.Z({gridRange:i,cellDataDeltaAtPositions:a}))},n.getSetCellsBorder=function(e,t){var n,r,o=[],s=e.startRowIndex,i=e.endRowIndex,a=e.startColIndex,l=e.endColIndex,d=[];for(r=s;r<=i;r++)for(n=a;n<=l;n++)o.length=0,o.push({from:Me.Z.DIAG_DOWN,to:Me.Z.DIAG_DOWN}),o.push({from:Me.Z.DIAG_UP,to:Me.Z.DIAG_UP}),r===s?(o.push({from:Me.Z.TOP,to:Me.Z.TOP}),r!==i?o.push({from:Me.Z.MIDDLE,to:Me.Z.BOTTOM}):o.push({from:Me.Z.BOTTOM,to:Me.Z.BOTTOM})):r===i?(o.push({from:Me.Z.BOTTOM,to:Me.Z.BOTTOM}),r!==s?o.push({from:Me.Z.MIDDLE,to:Me.Z.TOP}):o.push({from:Me.Z.TOP,to:Me.Z.TOP})):o.push({from:Me.Z.MIDDLE,to:Me.Z.TOP},{from:Me.Z.MIDDLE,to:Me.Z.BOTTOM}),n===a?(o.push({from:Me.Z.LEFT,to:Me.Z.LEFT}),n!==l?o.push({from:Me.Z.CENTER,to:Me.Z.RIGHT}):o.push({from:Me.Z.RIGHT,to:Me.Z.RIGHT})):n===l?(o.push({from:Me.Z.RIGHT,to:Me.Z.RIGHT}),n!==a?o.push({from:Me.Z.CENTER,to:Me.Z.LEFT}):o.push({from:Me.Z.LEFT,to:Me.Z.LEFT})):o.push(o.push({from:Me.Z.CENTER,to:Me.Z.LEFT},{from:Me.Z.CENTER,to:Me.Z.RIGHT})),d.push({rowIndex:r,colIndex:n,cellDataDelta:this.getCellDataDeltaSet(o,t)});return d},n.getClearCellsPrevRowBottomBorder=function(e,t,n){var r=n.sheetManager.getSheetBySheetId(e.sheetId),o=e.startRowIndex,s=e.startColIndex,i=e.endColIndex,a=bn.Z.createInstance(this.props),l=[],d=o-1;if(d>=0&&t[Me.Z.TOP])for(var u=s;u<=i;u++){var c=r.data.rowData[d]&&r.data.rowData[d].values[u];if(c){var h=c.getUserEnteredFormat();if(h&&h.getBorders()){var f=h.getBorderBottom();f&&(f.color||f.style)&&(s===i&&f.equal(a)||l.push({rowIndex:d,colIndex:u,cellDataDelta:this.getCellDataDeltaClear(Me.Z.BOTTOM)}))}}}return l},n.getClearCellsNextRowTopBorder=function(e,t,n){var r=n.sheetManager.getSheetBySheetId(e.sheetId),o=e.endRowIndex,s=e.startColIndex,i=e.endColIndex,a=bn.Z.createInstance(this.props),l=[],d=o+1;if(d<r.getRowCount()&&t[Me.Z.BOTTOM])for(var u=s;u<=i;u++){var c=r.data.rowData[d]&&r.data.rowData[d].values[u];if(c){var h=c.getUserEnteredFormat();if(h&&h.getBorders()){var f=h.getBorderTop();f&&(f.color||f.style)&&(s===i&&f.equal(a)||l.push({rowIndex:d,colIndex:u,cellDataDelta:this.getCellDataDeltaClear(Me.Z.TOP)}))}}}return l},n.getClearCellsPrevColRightBorder=function(e,t,n){var r=n.sheetManager.getSheetBySheetId(e.sheetId),o=e.startRowIndex,s=e.endRowIndex,i=e.startColIndex,a=e.endColIndex,l=bn.Z.createInstance(this.props),d=[],u=i-1;if(u>=0&&t[Me.Z.LEFT])for(var c=o;c<=s;c++){var h=r.data.rowData[c]&&r.data.rowData[c].values[u];if(h){var f=h.getUserEnteredFormat();if(f&&f.getBorders()){var p=f.getBorderRight();p&&(p.color||p.style)&&(i===a&&p.equal(l)||d.push({rowIndex:c,colIndex:u,cellDataDelta:this.getCellDataDeltaClear(Me.Z.RIGHT)}))}}}return d},n.getClearCellsNextColLeftBorder=function(e,t,n){var r=n.sheetManager.getSheetBySheetId(e.sheetId),o=e.startRowIndex,s=e.endRowIndex,i=e.startColIndex,a=e.endColIndex,l=bn.Z.createInstance(this.props),d=[],u=a+1;if(u<r.getColCount()&&t[Me.Z.RIGHT])for(var c=o;c<=s;c++){var h=r.data.rowData[c]&&r.data.rowData[c].values[u];if(h){var f=h.getUserEnteredFormat();if(f&&f.getBorders()){var p=f.getBorderLeft();p&&(p.color||p.style)&&(i===a&&p.equal(l)||d.push({rowIndex:c,colIndex:u,cellDataDelta:this.getCellDataDeltaClear(Me.Z.LEFT)}))}}}return d},n.getClearCellsBorder=function(e,t,n){return[].concat((0,o.Z)(this.getClearCellsPrevRowBottomBorder(e,t,n)),(0,o.Z)(this.getClearCellsNextRowTopBorder(e,t,n)),(0,o.Z)(this.getClearCellsPrevColRightBorder(e,t,n)),(0,o.Z)(this.getClearCellsNextColLeftBorder(e,t,n)))},n.getCellDataDeltaSet=function(e,t){var n,r=[];for(n=0;n<e.length;n++)t[e[n].from]?r.push(e[n].to):(e.splice(n,1),n-=1);var o=new je.Z({setSlots:this.getSetSlots(r),delta:Ze.Z.createInstance({borders:this.getBorders(r)})});return new _e.Z({setSlots:1<<m.Z.SLOT_USER_ENTERED_FORMAT_DELTA,delta:{userEnteredFormatDelta:o}})},n.getBorders=function(e){var t,n={};for(t=0;t<e.length;t++)n[e[t]]={color:this.props.color,style:this.props.style};return ke.Z.createInstance(n)},n.getSetSlots=function(e){var t,n=0;for(t=0;t<e.length;t++)switch(e[t]){case Me.Z.TOP:n+=1<<be.Z.BORDER_TOP;break;case Me.Z.RIGHT:n+=1<<be.Z.BORDER_RIGHT;break;case Me.Z.BOTTOM:n+=1<<be.Z.BORDER_BOTTOM;break;case Me.Z.LEFT:n+=1<<be.Z.BORDER_LEFT;break;case Me.Z.DIAG_UP:n+=1<<be.Z.BORDER_DIAGUP;break;case Me.Z.DIAG_DOWN:n+=1<<be.Z.BORDER_DIAGDOWN}return n},n.getCellDataDeltaClear=function(e){var t=0;switch(e){case Me.Z.TOP:t+=1<<be.Z.BORDER_TOP;break;case Me.Z.RIGHT:t+=1<<be.Z.BORDER_RIGHT;break;case Me.Z.BOTTOM:t+=1<<be.Z.BORDER_BOTTOM;break;case Me.Z.LEFT:t+=1<<be.Z.BORDER_LEFT;break;case Me.Z.DIAG_UP:t+=1<<be.Z.BORDER_DIAGUP;break;case Me.Z.DIAG_DOWN:t+=1<<be.Z.BORDER_DIAGDOWN}var n=new je.Z({clearSlots:t});return new _e.Z({setSlots:1<<m.Z.SLOT_USER_ENTERED_FORMAT_DELTA,delta:{userEnteredFormatDelta:n}})},(0,s.Z)(t,[{key:"id",get:function(){return t.id}}]),t}(l.Z);Dn.id=r.Z.SET_BORDERS_REQUEST;var On,Mn=Dn,jn=n("../packages/model/src/grid/Selection.ts"),Ln=n("../packages/model/src/grid/Cell.ts"),Zn=n("../packages/model/src/config/index.ts"),kn=n("../packages/mutation/src/MutationId.ts"),Nn=n("../spread-sheet/src/base/config/report.ts"),Pn=n("../spread-sheet/src/core/behavior/constants.ts"),Un=function(e,t,n,r){var o,s=arguments.length,i=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)i=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(i=(s<3?o(i):s>3?o(t,n,i):o(t,n))||i);return s>3&&i&&Object.defineProperty(t,n,i),i},Fn=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},Vn=function(e){function t(t,n){var r;return(r=e.call(this,t,n)||this).calcOverSizeByRowAndColIndex=function(e,t,n){var r=Math.max(t+1,e.getRowCount()),o=Math.max(n+1,e.getColCount()),s=r*o;return r>Zn.MAX_ROW_COUNT||o>Zn.MAX_COL_COUNT||s>Zn.MAX_CELL_COUNT},r.behaviors=[t],r.sheetId=t.sheetId,r}(0,i.Z)(t,e);var n=t.prototype;return n.isGridRangesCanPaste=function(e,t){var n=e.parent;return!!n&&!!n.sheetStatus.canEditExceptRangeStatus&&(!!t.every((function(e){return n.sheetStatus.isRangeCanEditByHighWater(e)}))||(this.pasteSizeOverLimitTips=a.ZP.t("单元格加载中，请在加载完成后重试。"),!1))},n.predictRequestSize=function(e){var t=this;if(this.calIsOverSheetSizeAfterPaste(e))return this.pasteSizeOverLimitTips=a.ZP.t("超出最大单元格数量，操作不成功。"),Pn.H;var n=0;return this.behaviors.forEach((function(r){var o=r.gridData,s=r.pasteEmbeddedObjects,i=r.pasteRanges;s&&s.length>1e3&&(n=Pn.H),o&&!n&&(n=o.rowData.reduce((function(e,t){return e+(t?t.values.reduce((function(e,t){if(t){var n=t.getEffectiveValue();if(n&&"string"===typeof n.value)return e+50+n.value.length}return e+50}),0):0)}),0));var a=t.isGridRangesCanPaste(e,i);n=a?n:Pn.H})),n||0},n.requestSizeOverLimitTips=function(){return this.pasteSizeOverLimitTips?this.pasteSizeOverLimitTips:a.ZP.t("数据量较大，操作不成功。建议导入原有文档或分批粘贴。")},n.check=function(e){var t=this.checkPasteDataRangeAuth(e.parent.sheetStatus);if(t)return t;var n=this.getFilterViewReorderCheckResult(e);return n||null},n.do=function(e,t,n){var r=t.parent;if(r){var s=e.pasteRanges,i=e.clearRangeContent,a=s.map((function(e){return e.clone()})),l=t.activeSheet;if(i){var d=new Ln.Z(i.sheetId,i.startRowIndex,i.startColIndex),u=new jn.Z(d,[i]);new ce.Z({},u).run(t,n)}Vt({copyRange:e.copyRange,toGridRange:e.toGridRange,isCut:e.cutData.cutGridRanges.length>0,pasteSpecialType:e.params.pasteSpecialType},r,n);var c=function(e){var t=e.infoDimension;return ot(t).insertDimensionsMutations||[]}(e),h=function(e){var t=e.infoDimension;return ot(t).copyExpansionInsertDimensionMutations||[]}(e),f=[].concat((0,o.Z)(Ut(e)),(0,o.Z)(c),(0,o.Z)(Ft(e,r)),(0,o.Z)(function(e,t){if(!t.length)return e;if(!e.length)return[];var n=t[0].type;return e.filter((function(e){return e.type!==n}))}(h,c)),(0,o.Z)(Ht(e)),(0,o.Z)(Wt(e,r)),(0,o.Z)(Gt(e,r)),(0,o.Z)(function(e,t){var n=e.infoDimension,r=t.spreadsheet.activeSheet,o=[];return n.insertDimensionRanges&&(o=Lt({insertDimensionRanges:n.insertDimensionRanges||[],deleteDimensionRanges:n.deleteDimensionRanges||[],sheet:r}).afterMutations),o}(e,r)),(0,o.Z)(Jt(e)),(0,o.Z)(Kt(e)),(0,o.Z)(function(e){var t=e.infoDimension;return ot(t).deleteDimensionMutations||[]}(e)));this.handleReport(e,f,l,a),f.forEach((function(e){return n(e)}))}},n.calIsOverSheetSizeAfterPaste=function(e){var t=this,n=!1;return this.behaviors.forEach((function(r){var o=r.infoDimension,s=r.sheetId,i=o.insertDimensionRanges,a=o.deleteDimensionRanges,l=o.pasteRange,d=e.sheetManager.getSheetBySheetId(s);if(d){var u=$e(d,l,a||[],i||[]),c=u.endRowIndex,h=u.endColIndex;u.isNeedToExpand&&(n=t.calcOverSizeByRowAndColIndex(d,c,h))}})),n},n.handleReport=function(e,t,n,r){var o=e.infoDimension,s=e.cutData,i=e.toGridRange,a=e.isFormatPainter;if(o){var l=function(e,t){var n=e.filter((function(e){return e.id===kn.ZP.MERGE_CELLS_MUTATION}))[0],r=e.filter((function(e){return e.id===kn.ZP.INSERT_DIMENSION_MUTATION}));if(n&&0===r.length){var o=n.endColIndex,s=n.endRowIndex,i=t.getColCount(),a=t.getRowCount();if(o>=i)return!1;if(s>=a)return!1}return!0}(t,n);if(!l){var d=o.pasteRange,u=o.deleteDimensionRanges,c=o.insertDimensionRanges;ze.ZP.run(Nn.CONFIG.PASTE_DATA_GENERATE_MUTATION_2,["formatPainter",a,n.getSheetId(),"row",n.getRowCount(),"col",n.getColCount(),d,u,c])}}else ze.ZP.run(Nn.CONFIG.PASTE_DATA_GENERATE_MUTATION_1);var h=function(e){var t=e.filter((function(e){return e.id===kn.ZP.SET_RANGE_MUTATION}))[0];if(t){var n=t.gridRange,r=n.endColIndex,o=n.endRowIndex;if(!r&&0!==r)return!1;if(!o&&0!==o)return!1}return!0}(t);h||ze.ZP.run(Nn.CONFIG.PASTE_DATA_GENERATE_MUTATION_3,["formatPainter",a,n.getSheetId(),o.pasteRange,r,s,i])},n.checkPasteDataRangeAuth=function(e){for(var t=this.behaviors.length,n=0;n<t;n++)for(var r=this.behaviors[n].pasteRanges,o=r.length,s=0;s<o;s++){var i=we(e,r[s]);if(null!==i)return i}return null},n.getFilterViewReorderCheckResult=function(e){var t=this.sheetId,n=this.behaviors[0].mergeInfos,r=e.sheetManager.getSheetBySheetId(t);return(0,Je.J)(r,n,this.id)},(0,s.Z)(t,[{key:"id",get:function(){return t.id}}]),t}(l.Z);Vn.id=r.Z.PASTE_DATA_REQUEST,Un([(0,w.M4)(Vn),Fn("design:type",Function),Fn("design:paramtypes",["function"===typeof(On="undefined"!==typeof C.V&&C.V)?On:Object]),Fn("design:returntype",Number)],Vn.prototype,"predictRequestSize",null);var Bn=Vn,Hn=n("../spread-sheet/src/core/behavior/request/cell/ClearFormatRequest.ts"),Gn=(n("../node_modules/core-js/modules/es.string.replace.js"),n("../node_modules/core-js/modules/es.array.find.js"),n("../packages/model/src/utils/numberFormat/FormatParseEngine.ts")),Wn=n("../spread-sheet/src/base/util/url.ts"),zn=n("../spread-sheet/src/core/app/sheetStatus/private-range.ts"),Qn=n("../spread-sheet/src/core/view/spreadsheet-view/model/line-engine/transform.ts"),Yn=n("../packages/model/src/cell/TextFormatRun.ts"),qn=n("../spread-sheet/src/core/view/level-2/search-replace2/controller/interface.ts"),Jn=n("../spread-sheet/src/core/utils/formula.ts"),Kn=function(e){function t(t,n){var r;(r=e.call(this,t,n)||this).transferTextRunsFromMatchValue=function(e,t,n,r){if(void 0===n&&(n=""),0===t.length||!r)return t;var o=t,s=[];return e.schema.reduce((function(e,t){return e+=t,s.push(e.length),e+=r}),""),o.forEach((function(e,i){var a=0;s.forEach((function(n){var r;n>=e.startIndex&&n<(null===(r=t[i+1])||void 0===r?void 0:r.startIndex)&&(a+=1)})),a>0&&(o=o.map((function(e,t){if(t>i){var o=a*(n.length-r.length);return Yn.Z.createInstance({startIndex:e.startIndex+o,format:e.format})}return e})))})),o},r.behaviors=t;for(var o=0;o<r.behaviors.length;o++)r.behaviors[o].celldata.map((function(e){return Object.assign(e,{linkUrl:(0,Wn.Kc)(e.value)})}));return r}(0,i.Z)(t,e);var n=t.prototype;return n.check=function(){return null},n.do=function(e,t,n){var r=this,o=e.sheetId,s=t.sheetManager.getSheetBySheetId(o);if(s){var i={isOwner:at.q.getConfig("isOwner"),ownerId:at.q.getConfig("ownerId"),tinyid:at.q.getConfig("tinyid")},a=[];e.celldata.forEach((function(e){var n=s.transformCoordFromFilterViewToSheet(e.y,e.x),l=n.row,d=n.col;if(!(0,I.wK)(s,l,d)&&!(0,zn.xy)(t,l,d,s,i)){var u=s.getCellDataAtPosition(l,d),c=r.getCellDataDelta(u,e,l,d,o);a.push({rowIndex:l,colIndex:d,cellDataDelta:c})}})),a.length<=0||(0,At.e6)([e.gridRange],s).forEach((function(e){var t=new p.Z({sheetId:o,gridRange:e,cellDataDeltaAtPositions:a});n(t)}))}},n.getCellDataDelta=function(e,t,n,r,o){var s,i,a,l=new _e.Z,d=t.value,u=t.linkUrl,c=t.matchValue,h=t.replace,f=t.search,p=null!==(s=null===e||void 0===e?void 0:e.getUserEnteredFormat())&&void 0!==s?s:null,g=null!==(i=null===p||void 0===p?void 0:p.getNumberFormat())&&void 0!==i?i:null,v=(0,Gn.parseValueWithStyle)(d,g),I=!0;(null===e||void 0===e?void 0:e.getFormula())&&((0,Jn.isFormula)(d)?(I=!1,l.clearSlot(m.Z.SLOT_EFFIECTIVE_VALUE),l.setSlot(m.Z.SLOT_FORMULA,(0,De.EG)(d,n,r,o))):l.clearSlot(m.Z.SLOT_FORMULA)),I&&(l.setSlot(m.Z.SLOT_EFFIECTIVE_VALUE,pe.Z.createInstance({type:Number(v.valueType),value:v.value})),(a=new je.Z).setSlot(be.Z.NUMBER_FORMAT,v.numberFormat),l.setSlot(m.Z.SLOT_USER_ENTERED_FORMAT_DELTA,a));var E=null===c||void 0===c?void 0:c.find((function(e){return e.key===qn.sM.EDIT_VALUE})),S=e?(0,Qn.iF)(e):[];return E&&S.length>1&&l.setSlot(m.Z.SLOT_RICH_TEXT_STYLE_RUN,this.transferTextRunsFromMatchValue(E,S,h,f)),u&&l.setSlot(m.Z.SLOT_HYPERLINK,u),l.clearSlot(m.Z.SLOT_MENTION),l},(0,s.Z)(t,[{key:"id",get:function(){return r.Z.REPLACE_ALL_REQUEST}}]),t}(l.Z);Kn.id=r.Z.REPLACE_ALL_REQUEST;var Xn=Kn,$n=n("../node_modules/@babel/runtime/helpers/esm/assertThisInitialized.js"),er=n("../packages/model/src/cell/HyperlinkType.ts"),tr=function(e){function t(t,r){var o;o=e.call(this,t,r)||this;var s=n.g.SpreadsheetApp,i=s.spreadsheet.activeSheet;t.sheetId&&(i=s.spreadsheet.sheetManager.getSheetBySheetId(t.sheetId));var a=i.getCellDataAtPosition(t.rowIndex,t.colIndex);if((0,I.lv)(i,t.rowIndex,t.colIndex))return o.behaviors=[],(0,$n.Z)(o);var l=null===a||void 0===a?void 0:a.getHyperlink(),d=null===a||void 0===a?void 0:a.getHyperlinkType();return o.behaviors.forEach((function(e){e.linkUrl=t.linkUrl||null,!e.userEnterValue&&e.linkUrl&&(e.userEnterValue=(0,Wn.Kc)(e.linkUrl)||""),d&&t.hyperlinkType===er.ZP.IMAGE&&l&&t.linkUrl!==l&&(e.hyperlinkType=null)})),o}return(0,i.Z)(t,e),(0,s.Z)(t,[{key:"id",get:function(){return t.id}}]),t}(En.ZP);tr.id=r.Z.SET_LINK_REQUEST;var nr=tr,rr=function(e){function t(t,n){var r;r=e.call(this,t,n)||this;var o=(null===n||void 0===n?void 0:n.activeCell.sheetId)||"";return r.behaviors=[{sheetId:o,rowIndex:t.rowIndex,colIndex:t.colIndex}],r}(0,i.Z)(t,e);var n=t.prototype;return n.do=function(e,t,n){var r=t.sheetManager.getSheetBySheetId(e.sheetId);if(r){var o=this.getCellDataDelta();(0,At.e6)([new f.Z(e.sheetId,e.rowIndex,e.rowIndex,e.colIndex,e.colIndex)],r).forEach((function(e){var t=new L.Z({gridRange:e,cellDataDelta:o});n(t)}))}},n.getCellDataDelta=function(){var e=new _e.Z;e.clearSlot(m.Z.SLOT_HYPERLINK),e.clearSlot(m.Z.SLOT_HYPERLINK_TYPE),e.clearSlot(m.Z.SLOT_HYPERLINK_RUN),e.clearSlot(m.Z.SLOT_LINK_ICON_TYPE);var t=e.delta.userEnteredFormatDelta||new je.Z;return t.clearSlot(be.Z.FOREGROUND_COLOR),t.clearSlot(be.Z.UNDERLINE),e.setSlot(m.Z.SLOT_USER_ENTERED_FORMAT_DELTA,t),e.clearSlot(m.Z.SLOT_RICH_TEXT_STYLE_RUN),e},(0,s.Z)(t,[{key:"id",get:function(){return t.id}}]),t}(l.Z);rr.id=r.Z.CLEAR_LINK_REQUEST;var or=rr,sr=n("../node_modules/@tencent/tdocs-format-render/lib/index.js"),ir=function(e){function t(t,n){var r;return(r=e.call(this,t,n)||this).options=t,t.gridRange?r.behaviors=[t]:n&&(r.behaviors=n.rangeSelections.map((function(e){return{gridRange:e,pattern:t.pattern}}))),r}(0,i.Z)(t,e);var n=t.prototype;return n.do=function(e,t,n){var r=this,o=this.getCellDataDelta(e),s=e.gridRange.sheetId,i=t.sheetManager.getSheetBySheetId(s);if(!o.isEmpty()&&i)if(e.cells){var a=e.cells.map((function(e){var t,n,a=e.row,l=e.col;return{cellDataDelta:r.options.shouldReparse?(0,En.VL)({cellData:null,rowIndex:a,colIndex:l,sheetId:s,userEnterValue:(null===(n=null===(t=i.getCellDataAtPosition(a,l))||void 0===t?void 0:t.getFormattedValue())||void 0===n?void 0:n.value)||"",linkUrl:null,skipTransformToText:!0}):o,rowIndex:a,colIndex:l}}));(0,At.N2)(a,e.gridRange,i).forEach((function(e){var t=e.deltas,r=e.gridRange;n(new ie.qi({gridRange:r,cellDataDeltaAtPositions:t}))}))}else{var l=[e.gridRange];l=(0,ut.divideGridRangesByFilter)(l,i.getBasicFilter()),l=(0,ut.divideGridRangesByMerges)(l,i.mergeManager.mergeList),(l=(0,At.e6)(l,i)).forEach((function(e){var t=(0,Hn.KE)(i,e);n(new L.Z({gridRange:e,cellDataDelta:o})),t&&n(t)}))}},n.getCellDataDelta=function(e){var t=e.pattern,n=new je.Z,r=(0,sr.getNumberFormatByFormatCode)(t);n.setSlot(be.Z.NUMBER_FORMAT,r);var o=new _e.Z;return o.setSlot(m.Z.SLOT_USER_ENTERED_FORMAT_DELTA,n),o},(0,s.Z)(t,[{key:"id",get:function(){return t.id}}]),t}(l.Z);ir.id=r.Z.SET_NUMBER_FORMAT_REQUEST;var ar=ir,lr=n("../packages/model/src/utils/numberFormat/FormatAction.ts"),dr=function(e){function t(t,n){var r,o,s,i;if(r=e.call(this,t,n)||this,n)for(r.activeCell=n.activeCell,r.decimalsDelta=t.decimalsDelta,s=0,i=n.rangeSelections.length;s<i;s++)o={gridRange:n.rangeSelections[s],decimalsDelta:t.decimalsDelta},r.behaviors.push(o);else t.gridRange&&(o={gridRange:t.gridRange,decimalsDelta:t.decimalsDelta},r.behaviors.push(o));return r}(0,i.Z)(t,e);var n=t.prototype;return n.check=function(e){for(var t=e.parent.view.getSelection().rangeSelections[0],n=t.startColIndex,r=t.startRowIndex,o=t.endColIndex,s=t.endRowIndex,i=e.activeSheet,a=r;a<=s;a++)for(var l=n;l<=o;l++){var d=i.getCellDataAtPosition(a,l);if(d){var u=d.getUserEnteredFormat(),c=(null===u||void 0===u?void 0:u.getNumberFormat())||(0,sr.getDefaultNumberFormat)(),h=d.getEffectiveValue(),f=(0,lr.D)(h,c,this.decimalsDelta);if(c.pattern!==f.pattern)return this.appliedCell=new Ln.Z(i.getSheetId(),a,l),null}}return{ignore:!0}},n.do=function(e,t,n){if(this.appliedCell){var r=t.sheetManager.getSheetBySheetId(this.appliedCell.sheetId);if(r){var o=r.getCellDataAtPosition(this.appliedCell.rowIndex,this.appliedCell.colIndex),s=this.getCellDataDelta(o,e.decimalsDelta),i=[e.gridRange];!s.isEmpty()&&r&&(i=(0,ut.divideGridRangesByFilter)(i,r.getBasicFilter()),i=(0,ut.divideGridRangesByMerges)(i,r.mergeManager.mergeList),(i=(0,At.e6)(i,r)).forEach((function(e){n(new L.Z({gridRange:e,cellDataDelta:s}))})))}}},n.getCellDataDelta=function(e,t){var n,r,o,s=null!==(n=null===e||void 0===e?void 0:e.getUserEnteredFormat())&&void 0!==n?n:null,i=null!==(r=null===s||void 0===s?void 0:s.getNumberFormat())&&void 0!==r?r:null,a=(0,lr.D)(null!==(o=null===e||void 0===e?void 0:e.getEffectiveValue())&&void 0!==o?o:null,i,t),l=new je.Z;l.setSlot(be.Z.NUMBER_FORMAT,a);var d=new _e.Z;return d.setSlot(m.Z.SLOT_USER_ENTERED_FORMAT_DELTA,l),d},(0,s.Z)(t,[{key:"id",get:function(){return t.id}}]),t}(l.Z);dr.id=r.Z.ADJUST_DECIMALS_REQUEST;var ur=dr,cr=n("../packages/model/src/cell/ExtendedValueType.ts"),hr=n("../packages/model/src/utils/numberFormat/ParsedValueType.ts"),fr=n("../packages/model/src/cell/cellFormatUtils.ts"),pr=n("../packages/model/src/cell/formula/FormulaModel.ts"),gr=n("../spread-sheet/src/core/view/level-2/shape-upload/utils.ts"),mr=n("../packages/model/src/cell/ref-data/ref-data.ts"),vr=n("../packages/model/src/sheet/sheetUtils.ts"),Ir=n("../packages/model/src/utils/numberFormat/index.ts"),Er=function(e){function t(t,n){var r;return(r=e.call(this,t,n)||this).shapeList=[],r.dateReminderItems=[],r.handleValue=function(e,t,n,r,o,s){if(pr.Z.isTargetType(e))t.clearSlot(m.Z.SLOT_EFFIECTIVE_VALUE),t.setSlot(m.Z.SLOT_FORMULA,e.clone());else{var i=(0,Gn.parseValueWithStyle)(e,n);i.valueType===hr.Z.FORMULA?(t.clearSlot(m.Z.SLOT_EFFIECTIVE_VALUE),t.setSlot(m.Z.SLOT_FORMULA,(0,De.EG)(i.value,r,o,s.getSheetId()))):(t.setSlot(m.Z.SLOT_EFFIECTIVE_VALUE,pe.Z.createInstance({type:Number(i.valueType),value:i.value})),t.clearSlot(m.Z.SLOT_FORMULA))}},r.options=t,r.sheetId=t.sheetId,r.behaviors=[t],r}(0,i.Z)(t,e);var n=t.prototype;return n.check=function(e){var t=we(e.parent.sheetStatus,this.behaviors[0].range);if(null!==t)return t;var n=this.getFilterViewReorderCheckResult(e);return n||null},n.do=function(e,t,n){var r=this,s=e.changes,i=e.mergeCells,a=e.range,l=e.unMergeCells,d=t.sheetManager.getSheetBySheetId(this.sheetId);if(d){var u=s.filter((function(e){var n=e[0],o=e[1];return t.parent.sheetStatus.getRangeCanEdit(new f.Z(r.sheetId,n,n,o,o))&&t.parent.sheetStatus.isRangeCanEditByHighWater(new f.Z(r.sheetId,n,n,o,o))}));[].concat((0,o.Z)(l),(0,o.Z)(i)).forEach((function(e){(0,Te.N)(e,d).forEach(n)}));var c=u.map((function(e){var t=r.getCellDataDelta(e,d);return{rowIndex:e[0],colIndex:e[1],cellDataDelta:t}}));(0,At.N2)(c,a,d).forEach((function(e){var t=e.deltas,r=e.gridRange,o=new p.Z({gridRange:r,cellDataDeltaAtPositions:t});n(o),(0,Nt._L)([r],d,n)})),(0,Nt._L)([a],d,n),this.shapeList.length&&(this.shapeList.forEach((function(e){n(new de.Z({data:e}))})),this.shapeList.length=0),i.forEach((function(e){n(new g.Z({startRowIndex:e.startRowIndex,endRowIndex:e.endRowIndex,startColIndex:e.startColIndex,endColIndex:e.endColIndex,sheetId:r.sheetId}))})),this.dateReminderItems.length&&t.fireAutofillDateReminder(this.dateReminderItems)}},n.collectShape=function(e,t,n,r){if(t){var o=t.position.overlayPosition,s=o.widthPixels,i=o.heightPixels;this.shapeList.push(Object.assign(Object.assign({},t),{id:e,x:r,y:n,offsetX:0,offsetY:0,width:s,height:i,zIndex:0}))}},n.getCellDataDelta=function(e,t){var n,r,o=e[0],s=e[1],i=e[2],a=e[3]||new xe.Z,l=null===a||void 0===a?void 0:a.getUserEnteredFormat(),d=t.getCellDataAtPosition(o,s),u=new _e.Z,c=(null===l||void 0===l?void 0:l.getNumberFormat())||null;this.handleValue(i,u,c,o,s,t);var h=a.getMetadata(),f=(0,vr.getCellImageByCellData)(t,a);if(f){var p=(0,gr.ki)();u.setSlot(m.Z.SLOT_METADATA,ue.Z.createInstance({customDataType:I.ZP.IMAGE})),u.setSlot(m.Z.SLOT_REF_IDS,[p]),this.collectShape(p,f,o,s)}else if((null===h||void 0===h?void 0:h.customDataType)!==I.ZP.SELECT||(0,I.J$)(h.customDataType,a.getDataValidation()))if((null===h||void 0===h?void 0:h.customDataType)===I.ZP.DATE_REMINDER)if(i){var g=Pt.kk.getRandomId();u.setSlot(m.Z.SLOT_METADATA,ue.Z.createInstance({customDataType:I.ZP.DATE_REMINDER})),u.setSlot(m.Z.SLOT_REF_IDS,[g]);var v=this.generateAutoFillDateReminder(a,g,u.delta.effectiveValue,c);v&&this.dateReminderItems.push(v)}else u.clearSlot(m.Z.SLOT_METADATA),u.clearSlot(m.Z.SLOT_REF_IDS);else u.setSlot(m.Z.SLOT_METADATA,h);else{var E=a.getRefIds();u.setSlot(m.Z.SLOT_METADATA,h),u.setSlot(m.Z.SLOT_REF_IDS,E),u.setSlot(m.Z.SLOT_EFFIECTIVE_VALUE,pe.Z.createInstance({type:cr.Z.STRING,value:null===(n=h.config)||void 0===n?void 0:n.getSelectedTextValue(E||[])}))}u.setSlot(m.Z.SLOT_DATA_VALIDATION_RULE,a.getDataValidation()),u.setSlot(m.Z.SLOT_LINK_ICON_TYPE,a.getLinkIconStatus());var S=a.isWeworkComponent(),R=a.getWeworkComponent();if(S&&R){var w=a.getCellType();u.setSlot(m.Z.SLOT_METADATA,ue.Z.createInstance({customDataType:w})),u.setSlot(m.Z.SLOT_REF_DATA,mr.Z.createInstance({customDataType:w,datas:[R]}))}r=null===d?null:d.getUserEnteredFormat();var A=(0,fr.createCellFormatDelta)(r,l);u.setSlot(m.Z.SLOT_USER_ENTERED_FORMAT_DELTA,A),u.setSlot(m.Z.SLOT_HYPERLINK_RUN,a.getHyperlinkRuns()),u.setSlot(m.Z.SLOT_HYPERLINK,a.getHyperlink()),u.setSlot(m.Z.SLOT_HYPERLINK_TYPE,a.getHyperlinkType());var C=a.getTextFormatRuns();return u.setSlot(m.Z.SLOT_RICH_TEXT_STYLE_RUN,C),u.clearSlot(m.Z.SLOT_MENTION),u},n.generateAutoFillDateReminder=function(e,t,n,r){var o=Ir.StandardFormatRenderEngine.instance().render(n||"",r?r.pattern:"General");if(o.error)return null;var s=new Date(o.data.value).getTime();if(isNaN(s))return null;var i=e.getDateReminderId();if(!i)return null;var a=window.SpreadsheetApp.view.canvas.dateReminderCenter.getDateReminderFromCache(this.sheetId,i);return a?Object.assign({},a,{timestamp:s,id:t}):null},n.getFilterViewReorderCheckResult=function(e){var t=this.sheetId,n=this.behaviors[0].mergeCells,r=e.sheetManager.getSheetBySheetId(t);return(0,Je.J)(r,n,this.id)},(0,s.Z)(t,[{key:"id",get:function(){return t.id}}]),t}(l.Z);Er.id=r.Z.AUTO_FILL_REQUEST;var Sr=Er,Rr=n("../spread-sheet/src/core/behavior/request/workbook/filterUtils/handleFilterRange.ts");function wr(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){if(e){if("string"===typeof e)return Ar(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Ar(e,t):void 0}}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0;return function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Ar(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Cr=function(e){function t(t,n){var r;r=e.call(this,t,n)||this;var o=t.sheetId,s=t.filterViewId;return n?n.rangeSelections.length>0?r.behaviors=[{sheetId:o,filterViewId:s,gridRange:n.rangeSelections[n.rangeSelections.length-1]}]:r.behaviors=[{sheetId:o,filterViewId:s,gridRange:new f.Z(o,0,0,0,0)}]:t.gridRange&&(r.behaviors=[{sheetId:o,filterViewId:s,gridRange:t.gridRange}]),r}(0,i.Z)(t,e);var n=t.prototype;return n.check=function(e){var t=e.sheetManager.getSheetBySheetId(this.behaviors[0].sheetId);if(!t)return null;for(var n,r=wr(this.behaviors);!(n=r()).done;){var o=n.value;if(!(null===o||void 0===o?void 0:o.gridRange)||!(0,Rr.st)(t,o.gridRange))return{isWarningOnly:!1,error:{title:a.ZP.t("无法筛选"),content:a.ZP.t("未找到可创建筛选的区域，请选择有数据的区域后重试。"),btnTxt:a.ZP.t("确定")}}}var s=this.checkSetBasicFilterRangeAuth(t,e.parent.sheetStatus);return null!==s?s:null},n.do=function(e,t,n){var r=Pt.kk.getRandomId(),o=e.gridRange,s=e.sheetId,i=e.filterViewId,a=t.sheetManager.getSheetBySheetId(s);if(a){var l,d=(0,Rr.Og)(a,o),u=d[0],c=d[1],h=d[2],f=t.parent.sheetStatus.workbookStatus;switch(n(new Ge.ZP({gridRange:u,sheetId:s,filterViewId:i,delta:{hiddenRows:[],defaultFilterId:r,criteriaDelta:{}},nonPersistingLocalChange:!f.canEdit||f.status.full})),c){case Rr.uY.SINGLE_CELL:l="single_cell_filter";break;case Rr.uY.ONE_ROW_PART:case Rr.uY.ONE_ROW_WHOLE:l=h?"single_merge_row_filter":"single_row_filter";break;case Rr.uY.SINGLE_MERGE_CELL:l="single_merge_cell_filter";break;default:l="multi_cell_filter"}ze.ZP.tdwReport({opername:"doc_excel_editor",module:"excel_filter",action:l})}},n.checkSetBasicFilterRangeAuth=function(e,t){return t.workbookStatus.canEdit?we(t,(0,Rr.Og)(e,this.behaviors[0].gridRange)[0]):null},(0,s.Z)(t,[{key:"id",get:function(){return r.Z.SET_BASIC_FILTER_REQUEST}}]),t}(l.Z);Cr.id=r.Z.SET_BASIC_FILTER_REQUEST;var yr=Cr,_r=function(e){function t(t,n){var r;return(r=e.call(this,t,n)||this).sheetId=t.sheetId,r.filterViewId=t.filterViewId,r.behaviors=[t],r}(0,i.Z)(t,e);var n=t.prototype;return n.check=function(e){return(0,Rr.bb)(e)?{isWarningOnly:!1,error:{title:a.ZP.t("取消筛选出现问题"),content:a.ZP.t("操作被禁止。筛选区域包含无权限操作的保护区域。"),btnTxt:a.ZP.t("我知道了")}}:null},n.do=function(e,t,n){var r=e.sheetId,o=e.filterViewId,s=t.sheetManager.getSheetBySheetId(r);if(s){var i=s.getBasicFilter(!1,o);if(i){var a=i.workbookRangeId;n(new Z.Z({sheetId:r,filterViewId:o,delta:{defaultFilterId:a},nonPersistingLocalChange:!t.parent.sheetStatus.workbookStatus.canEdit||t.parent.sheetStatus.workbookStatus.status.full}))}}},n.afterdo=function(){},(0,s.Z)(t,[{key:"id",get:function(){return t.id}}]),t}(l.Z);_r.id=r.Z.CLEAR_BASIC_FILTER_REQUEST;var Tr=_r,xr=n("../spread-sheet/src/core/behavior/request/workbook/filterUtils/calc-hidden-rows.ts"),br=function(e){function t(t,n){var r;(r=e.call(this,t,n)||this).sheetId=t.sheetId,r.delta=t.delta,r.rangeFilterId=t.rangeFilterId,r.filterViewId=t.filterViewId;var o=(0,$n.Z)(r),s=o.sheetId,i=o.rangeFilterId,a=o.filterViewId,l=o.delta;return r.isFilterSyncOn=t.isFilterSyncOn,r.behaviors=[{updateType:N.Qn.UPDATE,workbookRangeId:i,delta:l,sheetId:s,filterViewId:a}],r}(0,i.Z)(t,e);var n=t.prototype;return n.do=function(e,t,n){var r=e.sheetId,o=t.sheetManager.getSheetBySheetId(r);!o||this.filterViewId&&!o.filterViewManager.getFilterViewByViewId(this.filterViewId)||e.updateType===N.Qn.UPDATE&&this.doUpdate(e,n,o)},n.doUpdate=function(e,t,n){var r=this.getNonPersistingLocalChange(n),o=e.delta,s=e.updateType,i=e.workbookRangeId,a=e.sheetId,l=e.filterViewId;if(!n.getBasicFilter(!1,l)||!o.updateColumnCriteriaDelta)return null;o.hiddenRows=(0,xr.W)(n,o,l),t(new N.ZP({delta:o,updateType:s,workbookRangeId:i,sheetId:a,filterViewId:l,nonPersistingLocalChange:r}))},n.getNonPersistingLocalChange=function(e){return!!e.spreadsheetReference.parent.sheetStatus.workbookStatus.status.full||!e.spreadsheetReference.parent.sheetStatus.workbookStatus.canEdit||!e.filterViewManager.getFilterViewByViewId(this.filterViewId)&&!this.isFilterSyncOn},(0,s.Z)(t,[{key:"id",get:function(){return t.id}}]),t}(l.Z);br.id=r.Z.UPDATE_FILTER_CRITERIA_REQUEST;var Dr,Or=br;!function(e){e[e.SWITCH=0]="SWITCH",e[e.SYNC_FILTER=1]="SYNC_FILTER"}(Dr||(Dr={}));var Mr=function(e){function t(t){var n;return(n=e.call(this,t)||this).isOn=t.isOn,n.behaviors=[{type:Dr.SWITCH}],n}(0,i.Z)(t,e);var n=t.prototype;return n.check=function(e){var t=this;return this.isOn&&e.sheetManager.sheetList.forEach((function(e){if(e.isLoaded){var n=e.getBasicFilter();n&&t.behaviors.push({type:Dr.SYNC_FILTER,sheetId:e.getSheetId(),basicFilter:n})}})),null},n.do=function(e,t,n){e.type===Dr.SWITCH?n(new ie.ff({isOn:this.isOn})):e.type===Dr.SYNC_FILTER&&n(function(e,t){for(var n=t.getHiddenRows(),r=t.workbookRangeId,o=t.range,s=[],i=o.startColIndex,a=o.endColIndex;i<=a;i++){var l=t.getColFilterCriteria(i);l?s.push({columnIndex:i,criteria:l}):s.push({columnIndex:i,clear:!0})}return new ie.MC({updateType:N.Qn.UPDATE,sheetId:e,workbookRangeId:r,delta:{defaultFilterId:r,hiddenRows:n,updateColumnCriteriaDelta:s}})}(e.sheetId,e.basicFilter))},(0,s.Z)(t,[{key:"id",get:function(){return t.id}}]),t}(l.Z);Mr.id=r.Z.SWITCH_FILTER_SYNC_REQUEST;var jr=Mr,Lr=n("../packages/model/src/range/comment-sheet-range/comment-sheet-range-properties.ts"),Zr=function(e){function t(t,n){var r;(r=e.call(this,t,n)||this).behaviors=[],r.pushSelection=function(e,t,n){r.behaviors.push({sheetRangeId:e.sheetRangeId,gridRange:new f.Z(r.sheetId,n?n.row:t.activeCell.rowIndex,n?n.row:t.activeCell.rowIndex,n?n.col:t.activeCell.colIndex,n?n.col:t.activeCell.colIndex),sheetRangeType:e.sheetRangeType})},r.pushGridRange=function(e,t){r.behaviors.push({sheetRangeId:e.sheetRangeId,gridRange:new f.Z(e.gridRange.sheetId,t?t.row:e.gridRange.startRowIndex,t?t.row:e.gridRange.startRowIndex,t?t.col:e.gridRange.startColIndex,t?t.col:e.gridRange.startColIndex),sheetRangeType:e.sheetRangeType})},r.sheetId=t.sheetId,r.nonPersistingLocalChange=!1,r.isArchived=t.isArchived;var o=t.pos;return n?r.pushSelection(t,n,o):t.gridRange&&r.pushGridRange(t,o),r}(0,i.Z)(t,e);var n=t.prototype;return n.check=function(){var e;return e={isWarningOnly:!1,error:{title:a.ZP.t("出现问题"),content:a.ZP.t("只能给唯一单元格设置批注。")}},this.behaviors.length>1?e:this.behaviors[0].gridRange.isSingle()?null:e},n.do=function(e,t,n){if(t.sheetManager.getSheetBySheetId(this.sheetId)){var r=(0,At.e6)([e.gridRange],t.activeSheet);n(new it.Z({sheetId:this.sheetId,sheetRangeId:e.sheetRangeId,gridRange:r[0],sheetRangeType:e.sheetRangeType,nonPersistingLocalChange:this.nonPersistingLocalChange,padId:at.q.getConfig("padId"),sheetRangeDelta:new Ye.Z({commentSheetRangeProperties:new Lr.Z({isArchived:this.isArchived})})}))}},(0,s.Z)(t,[{key:"id",get:function(){return t.id}}]),t}(l.Z);Zr.id=r.Z.DEFINE_COMMENT_RANGE_REQUEST;var kr=Zr,Nr=function(e){function t(t,n){var r;(r=e.call(this,t,n)||this).behaviors=[],r.sheetId=t.sheetId;var o={sheetRangeId:t.sheetRangeId,sheetRangeType:st.Z.COMMENT_RANGE};return r.behaviors.push(o),r}return(0,i.Z)(t,e),t.prototype.do=function(e,t,n){var r=t.sheetManager.getSheetBySheetId(this.sheetId);r&&null!==r.sheetRangeManager.getSheetRange(e.sheetRangeId)&&n(new Le.Z({sheetId:this.sheetId,sheetRangeId:e.sheetRangeId,nonPersistingLocalChange:!1}))},(0,s.Z)(t,[{key:"id",get:function(){return t.id}}]),t}(l.Z);Nr.id=r.Z.DELETE_COMMENT_RANGE_REQUEST;var Pr=Nr,Ur=function(e){function t(t,n){var r,o,s,i,a,l;if(r=e.call(this,t,n)||this,s=t.sheetId?t.sheetId:(null===n||void 0===n?void 0:n.activeCell.sheetId)||"",null===(o=t.data)||void 0===o?void 0:o.length)for(i=0,a=t.data.length;i<a;i++){var d=t.data[i];l={gridRange:new f.Z(s,d.rowIndex,d.rowIndex,d.colIndex,d.colIndex),options:{sheetId:s,userEnterValue:d.userEnterValue,linkUrl:(0,Wn.Kc)(d.userEnterValue,!1)}},r.behaviors.push(l)}return r}(0,i.Z)(t,e);var n=t.prototype;return n.do=function(e,t,n){var r=e.gridRange.sheetId,o=t.sheetManager.getSheetBySheetId(r);if(o){var s=e.options,i=e.gridRange,a=o.getCellDataAtPosition(i.startRowIndex,i.startColIndex),l=this.getCellDataDelta(a,s.userEnterValue,s.linkUrl,i.startRowIndex,i.startColIndex,r);(0,At.e6)([i],o).forEach((function(e){var t=new L.Z({gridRange:e,cellDataDelta:l});n(t)}))}},n.getCellDataDelta=function(e,t,n,r,o,s){return(0,En.VL)({cellData:e,sheetId:s,rowIndex:r,colIndex:o,linkUrl:n,userEnterValue:t})},(0,s.Z)(t,[{key:"id",get:function(){return t.id}}]),t}(l.Z);Ur.id=r.Z.SET_RANGE_VALUE_REQUEST;var Fr=n("../packages/model/src/cell/data-validation/data-validation-rule.ts"),Vr=function(e){function t(t,n){var r;r=e.call(this,t,n)||this;var o=t.gridRanges||(null===n||void 0===n?void 0:n.rangeSelections)||[];return r.behaviors=o.map((function(e){return{gridRange:e,dataValidation:t.dataValidation}})),r}(0,i.Z)(t,e);var n=t.prototype;return n.do=function(e,t,n){var r=this.getCellDataDelta(e.dataValidation),o=[e.gridRange],s=t.sheetManager.getSheetBySheetId(e.gridRange.sheetId);if(!r.isEmpty()&&s){o=(0,ut.divideGridRangesByFilter)(o,s.getBasicFilter()),o=(0,ut.divideGridRangesByMerges)(o,s.mergeManager.mergeList);for(var i=0,a=(o=(0,At.e6)(o,s)).length;i<a;i++)n(new L.Z({gridRange:o[i],cellDataDelta:r}))}},n.getCellDataDelta=function(e){var t=new _e.Z;return t.clearSlot(m.Z.SLOT_IS_DATA_VALID),null==e?t.clearSlot(m.Z.SLOT_DATA_VALIDATION_RULE):t.setSlot(m.Z.SLOT_DATA_VALIDATION_RULE,Fr.Z.createInstance(e)),t},(0,s.Z)(t,[{key:"id",get:function(){return t.id}}]),t}(l.Z);Vr.id=r.Z.SET_DATA_VALIDATION_REQUEST;var Br=Vr,Hr=function(e){function t(t,n){var r;if((r=e.call(this,t,n)||this).sheetId=t.sheetId,r.type=t.type,t.dimensionRanges){r.behaviors=[];for(var o=Math.max(t.dimensionRanges.length,t.formDatas.length),s=0;s<o;s++)t.dimensionRanges[s].dimension===r.type&&r.behaviors.push({dimensionRange:t.dimensionRanges[s],formData:t.formDatas[s]})}return r}return(0,i.Z)(t,e),t.prototype.do=function(e,t,n){var r,o=t.sheetManager.getSheetBySheetId(e.dimensionRange.sheetId);if(o){var s=(0,j.ic)([e.dimensionRange],o.getBasicFilter());for(r=0;r<s.length;r++){var i=s[r],a=e.formData;n(new c.ZP({ranges:[i],operation:[{slot:c.P8.SLOT_FORMDATA,formData:a}],sheetId:this.sheetId,type:this.type}))}}},(0,s.Z)(t,[{key:"id",get:function(){return t.id}}]),t}(l.Z);Hr.id=r.Z.SET_DIMENSION_FORMDATA_REQUEST;var Gr=Hr,Wr=function(e){function t(t,n){var r;return(r=e.call(this,t,n)||this).behaviors=t.requests,r}(0,i.Z)(t,e);var n=t.prototype;return n.do=function(e,t,n){e.run(t,n)},n.predictRequestSize=function(e){var t,n,r=0;for(t=0,n=this.behaviors.length;t<n;t++)r+=this.behaviors[t].predictRequestSize(e);return r},n.getRanges=function(e){var t,n,r=[];for(t=0,n=this.behaviors.length;t<n;t++)r=[].concat((0,o.Z)(r),(0,o.Z)(this.behaviors[t].getRanges(e)));return r},n.check=function(e){var t,n,r;for(t=0,n=this.behaviors.length;t<n;t++)if(null!==(r=this.behaviors[t].check(e)))return r;return null},(0,s.Z)(t,[{key:"id",get:function(){return t.id}}]),t}(l.Z);Wr.id=r.Z.MULTI_REQUEST;var zr=Wr,Qr=(n("../node_modules/core-js/modules/es.string.bold.js"),n("../node_modules/core-js/modules/es.string.italics.js"),n("../packages/mutation/src/conditionalFormat/AddConditionalFormatMutation.ts")),Yr=n("../packages/model/src/rule/ConditionType.ts"),qr=n("../packages/model/src/rule/BooleanConditionalFormat.ts"),Jr=n("../packages/model/src/rule/BooleanCondition.ts"),Kr=n("../packages/model/src/rule/ConditionValue.ts"),Xr=n("../packages/model/src/rule/ArgTokenType.ts"),$r=n("../packages/model/src/rule/ConditionalFormatRule.ts"),eo=n("../packages/model/src/cell/format/index.ts"),to=n("../packages/model/src/cell/format/Color.ts");function no(e){var t=e.booleanConditionalFormat,n=e.gradientConditionalFormat,r=e.dataBarConditionalFormat,o=null;if(t){var s=t.condition,i=t.format,a=s.userInputOne,l=s.userInputTwo,d=[];if([a,l].forEach((function(e){if(e){var t=new Kr.Z({type:Xr.Z.VALUE_TOKEN,userEnteredValue:e});d.push(t)}})),s.conditionType===Yr.Z.CUSTOM_FORMULA&&a){var u=e.ruleRanges[0],c=u.startRowIndex,h=u.startColIndex,p=u.sheetId,g=c===f.v?0:c,m=h===f.v?0:h;d=[new Kr.Z({type:Xr.Z.FORMULA_TOKEN,formula:(0,De.EG)(a,g,m,p)})]}o=new qr.Z({condition:new Jr.Z({type:t.condition.conditionType,values:d}),format:Ze.Z.createInstance({backgroundColor:i.bgColor?to.Z.createColor(i.bgColor):void 0,textFormat:{color:i.color,bold:i.bold,italic:i.italic,strikethrough:i.strikethrough,underline:i.underline?eo.UNDERLINE_TYPE.SINGLE_LINE:void 0}}),stopIftrue:!1})}return new $r.Z({ruleRanges:e.ruleRanges,booleanConditionalFormat:o,gradientConditionalFormat:n,dataBarConditionalFormat:r,uid:e.userId})}var ro=function(e){function t(t,n){var r;return(r=e.call(this,t,n)||this).behaviors=[t],r}(0,i.Z)(t,e);var n=t.prototype;return n.check=function(e){return null},n.do=function(e,t,n){var r=e.rule,o=null===t||void 0===t?void 0:t.activeSheetId;if(null===t||void 0===t?void 0:t.sheetManager.getSheetBySheetId(o)){var s={sheetId:o,ruleIndex:0,rule:no(r)};n(new Qr.Z(s))}},(0,s.Z)(t,[{key:"id",get:function(){return t.id}}]),t}(l.Z);ro.id=r.Z.ADD_CONDITIONAL_FORMAT_REQUEST;var oo=ro,so=n("../packages/mutation/src/conditionalFormat/DeleteConditionalFormatMutation.ts"),io=function(e){function t(t,n){var r;return(r=e.call(this,t,n)||this).ruleIndex=t.ruleIndex,r.behaviors=[t],r}(0,i.Z)(t,e);var n=t.prototype;return n.check=function(e){return null},n.do=function(e,t,n){var r,o=e.ruleIndex,s=null===t||void 0===t?void 0:t.activeSheetId,i=null===t||void 0===t?void 0:t.sheetManager.getSheetBySheetId(s),a=null===(r=null===i||void 0===i?void 0:i.conditionalFormatRuleManager)||void 0===r?void 0:r.getConditionalFormatRuleByRuleIndex(o);a&&n(new so.Z({sheetId:s,ruleIndex:o,oldRuleRanges:a.ruleRanges}))},n.afterdo=function(){},(0,s.Z)(t,[{key:"id",get:function(){return t.id}}]),t}(l.Z);io.id=r.Z.DELETE_CONDITIONAL_FORMAT_REQUEST;var ao=io,lo=n("../packages/mutation/src/conditionalFormat/UpdateConditionalFormatMutation.ts"),uo=function(e){function t(t,n){var r;return(r=e.call(this,t,n)||this).ruleIndex=t.ruleIndex,r.behaviors=[t],r}(0,i.Z)(t,e);var n=t.prototype;return n.check=function(e){return null},n.do=function(e,t,n){var r,o=e.ruleIndex,s=e.rule,i=null===t||void 0===t?void 0:t.activeSheetId,a=null===t||void 0===t?void 0:t.sheetManager.getSheetBySheetId(i),l=null===(r=null===a||void 0===a?void 0:a.conditionalFormatRuleManager)||void 0===r?void 0:r.getConditionalFormatRuleByRuleIndex(o);if(l){var d=no(s);n(new lo.Z({sheetId:i,ruleIndex:o,rule:d,oldRuleRanges:l.ruleRanges}))}},n.afterdo=function(){},(0,s.Z)(t,[{key:"id",get:function(){return t.id}}]),t}(l.Z);uo.id=r.Z.UPDATE_CONDITIONAL_FORMAT_REQUEST;var co=uo,ho=function(e){function t(t,n){var r;return(r=e.call(this,t,n)||this).behaviors=[t],r}(0,i.Z)(t,e);var n=t.prototype;return n.check=function(){return null},n.do=function(e,t,n){var r=e.rule,o=e.from,s=e.to,i=t.getActiveSheetId();if(o!==s){var a={sheetId:i,ruleIndex:o,oldRuleRanges:r.ruleRanges},l={sheetId:i,ruleIndex:s,rule:r};n(new ie.jZ(a)),n(new Qr.Z(l))}},(0,s.Z)(t,[{key:"id",get:function(){return t.id}}]),t}(l.Z);ho.id=r.Z.UPDATE_CONDITIONAL_FORMAT_REQUEST_INDEX;var fo=ho,po=n("../packages/mutation/src/sheet/DeleteSheetMutation.ts"),go=n("../packages/mutation/src/new-embedded/NewDeleteEmbeddedObjectMutation.ts"),mo=n("../packages/mutation/src/filter-view/delete-filter-view-mutation.ts"),vo=n("../packages/model/src/new-embedded/EmbeddedObjectType.ts");function Io(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){if(e){if("string"===typeof e)return Eo(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Eo(e,t):void 0}}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0;return function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Eo(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var So=function(e){function t(t,n){var r;return(r=e.call(this,t,n)||this).behaviors=t,r}(0,i.Z)(t,e);var n=t.prototype;return n.isMultiSheetRequest=function(){return!0},n.check=function(e){var t=null;if(e.sheetManager.getDisplayedSheetList().length<=1)return t={isWarningOnly:!1,error:{title:a.ZP.t("出现问题"),content:a.ZP.t("请至少保留一个可查看的工作表。")}};for(var n,r=0;n=this.behaviors[r+=1];){if(!e.sheetManager.getSheetBySheetId(n.sheetId))return t={isWarningOnly:!1,error:{title:a.ZP.t("出现问题"),content:a.ZP.t("你所删除的工作表不存在。")}};if(e.sheetManager.getSheetBySheetId(n.sheetId).getIndex()!==n.sheetIndex)return t={isWarningOnly:!1,error:{title:a.ZP.t("出现问题"),content:a.ZP.t("\b参数不一致,请重试。")}}}return t},n.do=function(e,t,n){var r,o=e.sheetId,s=this.getWorkbookRangeIdList(t,o);s.length>0&&s.forEach((function(e){n(new F.Z({workbookRangeId:e,workbookRangeType:B.Z.PROTECTED_RANGE}))})),t.embeddedObjectManager.each((function(e){var t=e.location,r=e.objectId;o===t.sheetId&&(n(new go.Z({objectId:r,sheetId:o})),e.properties.type===vo.Z.CHART&&e.properties.chart.workbookRangeId.forEach((function(e){n(new F.Z({workbookRangeId:e,workbookRangeType:B.Z.CHART}))})))})),null===(r=t.sheetManager.getSheetBySheetId(o))||void 0===r||r.filterViewManager.each((function(e){n(new mo.Z({sheetId:o,filterViewId:e.filterViewId}))}));var i=new po.Z(e);if(n(i),t.isExternalSheet(o)){var a=t.parent.sheetAdapterManager.getAdapterBySheetId(o);null===a||void 0===a||a.deleteSheet(o)}else(0,y.lO)({getSheetBySheetId:t.sheetManager.getSheetBySheetId.bind(t.sheetManager),getSheetIdList:t.sheetManager.getSheetIdList.bind(t.sheetManager),isSheetAmongTwoSheets:t.sheetManager.isSheetAmongTwoSheets.bind(t.sheetManager),getSheetIdBySheetIndex:t.sheetManager.getSheetIdBySheetIndex.bind(t.sheetManager),getSheetIndexBySheetId:t.sheetManager.getSheetIndexBySheetId.bind(t.sheetManager),getSheetTitleBySheetId:t.sheetManager.getSheetTitleBySheetId.bind(t.sheetManager)},t.workbookRangeManager,t.embeddedObjectManager,t.formulaModelManager).generateUpdateFormulaModelMutation(i).forEach((function(e){return n(e)}))},n.getWorkbookRangeIdList=function(e,t){for(var n,r=[],o=Io(e.workbookRangeManager.protectedRangeMap.entries());!(n=o()).done;){var s=n.value,i=s[0];s[1].range.sheetId===t&&r.push(i)}return r},(0,s.Z)(t,[{key:"id",get:function(){return t.id}}]),t}(l.Z);So.id=r.Z.DELETE_SHEET_REQUEST;var Ro=So,wo=n("../packages/mutation/src/sheet/InsertSheetMutation.ts"),Ao=n("../spread-sheet/src/core/data/converter/tencentdoc/handleKeyframe/keyframeOne.ts"),Co=n("../spread-sheet/src/base/config/version.ts"),yo=n("../packages/model/src/utils/index.ts"),_o=function(e){function t(t){var n;return(n=e.call(this,t)||this).createTempSheet=function(e,t){var n=t.sheetId,r=t.sheetType,o=t.mutations,s=e.sheetManager.createSheet({id:n,type:r});return o.forEach((function(t){var r=e.parent.mutationBehavior.deserializeMutation(t);r.setAffectedSheetId(n),e.parent.mutationBehavior.applyMutation(r,{isLocal:!0,isIgnoreRender:!0},s)})),s},n.behaviors=[],t.forEach((function(e){var t=e.sheetId,r=e.sheetIndex,o=e.sheetName,s=e.sheetType,i=e.isHidden,a=e.tableJSON,l=e.mutations,d={sheetId:t,sheetIndex:r,sheetName:o,sheetType:s,rowCount:Zn.DEFAULT_ROW_COUNT,colCount:Zn.DEFAULT_COL_COUNT,delta:{name:o,rightToLeft:!1,hideGridline:!1,frozenRowCount:0,frozenColCount:0,hidden:i},tableJSON:a,mutations:l};n.behaviors.push(d)})),n}(0,i.Z)(t,e);var n=t.prototype;return n.isMultiSheetRequest=function(){return!0},n.check=function(e){var t=null,n=e.sheetManager.sheetCount;if(n>=Zn.MAX_SHEET_COUNT)return t={isWarningOnly:!1,error:{title:a.ZP.t("出现问题"),content:a.ZP.t("工作表创建不成功, 工作表数量已达最大限制。")}};for(var r,o=0;r=this.behaviors[o];){if(o+=1,r.sheetIndex>n)return t={isWarningOnly:!1,error:{title:a.ZP.t("出现问题"),content:a.ZP.t("新增工作表出现问题，索引超出范围。")}};if(e.sheetManager.hasSheetId(r.sheetId))return t={isWarningOnly:!1,error:{title:a.ZP.t("出现问题"),content:a.ZP.t("新增工作表出现问题，工作表ID重复。")}};e.sheetManager.hasSheetTitle(r.sheetName)&&(t={isWarningOnly:!1,error:{title:a.ZP.t("出现问题"),content:a.ZP.t("新增工作表出现问题，工作表名重复。")}})}return t},n.do=function(e,t,n){var r=e.sheetId,o=e.sheetIndex,s=e.sheetType,i=e.mutations,a=e.rowCount,l=e.colCount,d=e.delta,u=(0,yo.getIsExternalSheetBySheetType)(s),c=void 0,h={};if((null===i||void 0===i?void 0:i.length)&&!u&&(h={rightToLeft:(c=this.createTempSheet(t,{sheetId:r,sheetType:s,mutations:i})).getIsRtl(),hideGridline:c.getHideGridlines(),frozenRowCount:c.getFrozenRowCount(),frozenColCount:c.getFrozenColCount(),hidden:c.getDisplayHidden(),tabColor:to.Z.getColorHexCode(c.getTabColor(),c.spreadsheetReference)}),n(new wo.Z({sheetId:r,sheetIndex:o,sheetType:s,rowCount:(null===c||void 0===c?void 0:c.getRowCount())||a,colCount:(null===c||void 0===c?void 0:c.getColCount())||l,sheetDelta:new P.Z({operation:U.C.INSERT_SHEET,delta:Object.assign(Object.assign({},d),h)})})),u){var f=t.parent.sheetAdapterManager.getAdapterBySheetType(s),p=i?null===f||void 0===f?void 0:f.getTableJSONByTemplateMutations(r,i):e.tableJSON;null===f||void 0===f||f.createSheet(r,p)}else if(null===i||void 0===i?void 0:i.length){var g=t.sheetManager.getSheetBySheetId(r);g&&c&&((0,Ao.T)(g,JSON.stringify(c.serialize()),0,0,Co.Z.KEYFRAME_VER),g.isLoaded=!0,g.highWaterMark.updateMark(g.getRowCount()-1))}},(0,s.Z)(t,[{key:"id",get:function(){return t.id}}]),t}(l.Z);_o.id=r.Z.INSERT_SHEET_REQUEST;var To=_o,xo=n("../packages/mutation/src/sheet/MoveSheetMutation.ts"),bo=function(e){function t(t,n){var r;return(r=e.call(this,t,n)||this).behaviors=t,r}(0,i.Z)(t,e);var n=t.prototype;return n.isMultiSheetRequest=function(){return!0},n.check=function(e){for(var t=null,n=e.sheetManager.sheetCount,r=0,o=this.behaviors.length;r<o;r++){var s=this.behaviors[r];return(s.fromIndex<0||s.fromIndex>=n||s.toIndex<0||s.toIndex>=n)&&(t={isWarningOnly:!1,error:{title:a.ZP.t("出现问题"),content:a.ZP.t("移动工作表的索引出现问题")}}),t}return t},n.do=function(e,t,n){n(new xo.Z(e))},(0,s.Z)(t,[{key:"id",get:function(){return t.id}}]),t}(l.Z);bo.id=r.Z.MOVE_SHEET_REQUEST;var Do=bo,Oo=function(e){function t(t){var n;return(n=e.call(this,t)||this).behaviors=t,n}(0,i.Z)(t,e);var n=t.prototype;return n.isMultiSheetRequest=function(){return!0},n.check=function(e){for(var t,n=null,r=0;t=this.behaviors[r];)if(r+=1,t.hidden){for(var o=0,s=0,i=e.sheetManager.sheetList.length;s<i;s++){var l=e.sheetManager.sheetList[s];l.getDisplayHidden()||(o+=1)}if(o<=1)return n={isWarningOnly:!1,error:{title:a.ZP.t("出现问题"),content:a.ZP.t("必须保留一个工作表")}}}return n},n.do=function(e,t,n){n(new k.Z({sheetId:e.sheetId,sheetDelta:new P.Z({operation:U.C.SET_PROPERTIES,delta:{hidden:e.hidden}})}))},(0,s.Z)(t,[{key:"id",get:function(){return t.id}}]),t}(l.Z);Oo.id=r.Z.HIDE_SHEET_REQUEST;var Mo=Oo,jo=(n("../node_modules/core-js/modules/es.string.trim.js"),function(e){function t(t){var n;return(n=e.call(this,t)||this).behaviors=[],null===t||void 0===t||t.forEach((function(e){n.behaviors.push(e)})),n}(0,i.Z)(t,e);var n=t.prototype;return n.isMultiSheetRequest=function(){return!0},n.check=function(e){var t=null,n=e.sheetManager.sheetCount,r=null,o=e.sheetManager.sheetList;if(!n)return t={isWarningOnly:!1,error:{title:a.ZP.t("出现问题"),content:a.ZP.t("重命名不成功")}};for(var s,i=0;s=this.behaviors[i];i++){var l=s.sheetName.trim();e.sheetManager.hasSheetId(s.sheetId)||(r=a.ZP.t("工作表ID不存在。")),""===l&&(r=a.ZP.t("工作表名称不能为空。")),l.length>=32&&(r=a.ZP.t("工作表名称不可以超过31个字符。")),(0,vr.isIncludeIllegalChar)(l)&&(r=a.ZP.t("工作表名称不能包含以下字符： : \\ / ? * [ ] ，请尝试删除这些字符。")),(0,vr.isStartOrEndWithSingleQuotes)(l)&&(r=a.ZP.t("工作表名称的起止位置不能为单引号 ' ，请尝试修改单引号位置。")),(0,vr.isIncludeInvisibleChar)(l)&&(r=a.ZP.t("工作表名称可能包含某些不可见的特殊字符，请删除这些字符或空格。"));for(var d=0,u=o.length;d<u;d++)if(o[d].getTitle().toUpperCase()===l.toUpperCase()&&o[d].getSheetId()!==s.sheetId)return r=a.ZP.t("工作表名称可能重复，请修改。"),{isWarningOnly:!1,error:{title:a.ZP.t("出现问题"),content:r}}}return r&&(t={isWarningOnly:!1,error:{title:a.ZP.t("出现问题"),content:r}}),t},n.do=function(e,t,n){n(new k.Z({sheetId:e.sheetId,sheetDelta:new P.Z({operation:U.C.SET_PROPERTIES,delta:{name:e.sheetName}})}))},(0,s.Z)(t,[{key:"id",get:function(){return t.id}}]),t}(l.Z));jo.id=r.Z.RENAME_SHEET_REQUEST;var Lo=jo,Zo=n("../spread-sheet/src/core/app/sheetStatus/auth-range.ts"),ko=function(e){function t(t){var n;return(n=e.call(this,t)||this).behaviors=t,n}(0,i.Z)(t,e);var n=t.prototype;return n.isMultiSheetRequest=function(){return!0},n.check=function(e){var t=null,n=e.sheetManager.sheetCount;if(n>=Zn.MAX_SHEET_COUNT)return t={isWarningOnly:!1,error:{title:a.ZP.t("出现问题"),content:a.ZP.t("工作表创建不成功, 工作表数量已达最大限制。")}};for(var r,o=0;r=this.behaviors[o];){if(o+=1,r.sheetIndex>n)return t={isWarningOnly:!1,error:{title:a.ZP.t("出现问题"),content:a.ZP.t("新增工作表出现问题。")}};if(e.sheetManager.hasSheetId(r.newSheetId))return t={isWarningOnly:!1,error:{title:a.ZP.t("出现问题"),content:a.ZP.t("工作表ID已存在, 请重试。")}}}return t},n.do=function(e,t,n){var r=e.sheetId,o=e.newSheetId,s=e.newSheetName,i=t.sheetManager.getSheetBySheetId(r);if(i)if(t.copyWorkbookDataWhenCopySheet(i.getSheetId(),o),n(new wo.Z({sheetId:o,sheetIndex:i.getIndex()+1,sheetType:i.getSheetType(),rowCount:i.getRowCount(),colCount:i.getColCount(),sheetDelta:new P.Z({operation:U.C.COPY_SHEET,delta:{name:s,rowCount:i.getRowCount(),colCount:i.getColCount(),rightToLeft:i.getIsRtl(),hideGridline:i.getHideGridlines(),frozenRowCount:i.getFrozenRowCount(),frozenColCount:i.getFrozenColCount(),hidden:i.getDisplayHidden(),tabColor:to.Z.getColorHexCode(i.getTabColor(),t)}})})),t.isExternalSheet(o)){var a=t.parent.sheetAdapterManager.getAdapterBySheetId(o);null===a||void 0===a||a.copySheet(r,o)}else{var l=t.sheetManager.getSheetBySheetId(o);l&&(this.copySheetData(l,i),l.isLoaded=!0,t.formulaModelManager.keyframeHandler({sheet:l}))}},n.copySheetData=function(e,t){var n=JSON.stringify(t.serialize()),r=e.getSheetId(),o=e.getTitle();(0,Ao.T)(e,n,0,0,Co.Z.KEYFRAME_VER),e.sheetRangeManager.each((function(t,n){e.sheetRangeManager.deleteSheetRange(n)})),(0,Zo.PC)(t).forEach((function(n){n.each((function(t,n){e.setCellDataAtPosition(t,n,null)}),t)})),e.setSheetId(r),e.setTitle(o)},(0,s.Z)(t,[{key:"id",get:function(){return t.id}}]),t}(l.Z);ko.id=r.Z.COPY_SHEET_REQUEST;var No=ko,Po=function(e){this.soft=!1,this.holes=[],this.description="",this.range=e.range,void 0!==e.holes&&(this.holes=e.holes),void 0!==e.description&&(this.description=e.description),void 0!==e.soft&&(this.soft=e.soft),void 0!==e.otherPrivilege&&(this.otherPrivilege=e.otherPrivilege)},Uo=n("../packages/model/src/workbookRange/protectedRange/ProtectionProperties.ts"),Fo=n("../packages/mutation/src/workbook/workbookRange/DefineWorkbookRangeMutation.ts"),Vo=function(e){function t(t,n){var r;r=e.call(this,t,n)||this;var o=t.workbookRangeId,s=new Po(t);return r.behaviors=[{data:s,workbookRangeId:o}],r}(0,i.Z)(t,e);var n=t.prototype;return n.check=function(e){return null},n.do=function(e,t,n){var r=new Qe.Z,o=(new Date).valueOf(),s=new Uo.Z({hole:e.data.holes.length>0,softProtection:e.data.soft,description:e.data.description,otherPrivilege:e.data.otherPrivilege,modifyTime:o});r.setProtectionProperties(s),n(new Fo.Z({workbookRangeId:e.workbookRangeId,gridRange:e.data.range,workbookRangeType:B.Z.PROTECTED_RANGE,workbookRangePropertiesDelta:r}))},(0,s.Z)(t,[{key:"id",get:function(){return t.id}}]),t}(l.Z);Vo.id=r.Z.ADD_PROTECTED_RANGE_REQUEST;var Bo=Vo,Ho=function(e){function t(t,n){var r;r=e.call(this,t,n)||this;var o=t.workbookRangeId,s=new Po(t);return r.behaviors=[{data:s,workbookRangeId:o,ignoreHoles:t.ignoreHoles}],r}(0,i.Z)(t,e);var n=t.prototype;return n.check=function(e){return null},n.do=function(e,t,n){var r=t.workbookRangeManager.getProtectedRangeById(e.workbookRangeId);if(null!==r){var o=new Qe.Z,s=(new Date).valueOf(),i=new Uo.Z({hole:r.properties.hole,softProtection:r.properties.softProtection,description:r.properties.description,otherPrivilege:r.properties.otherPrivilege,modifyTime:s});void 0!==e.ignoreHoles?i.hole=e.ignoreHoles:void 0!==e.data.holes&&(i.hole=e.data.holes.length>0),void 0!==e.data.soft&&(i.softProtection=e.data.soft),void 0!==e.data.description&&(i.description=e.data.description),void 0!==e.data.otherPrivilege&&(i.otherPrivilege=e.data.otherPrivilege),o.setProtectionProperties(i),n(new V.Z({workbookRangeId:e.workbookRangeId,gridRange:e.data.range,workbookRangeType:B.Z.PROTECTED_RANGE,workbookRangePropertiesDelta:o}))}else console.error("updateProtectedRange fail, because workbookRangeId no match")},(0,s.Z)(t,[{key:"id",get:function(){return t.id}}]),t}(l.Z);Ho.id=r.Z.UPDATE_PROTECTED_RANGE_REQUEST;var Go=Ho,Wo=function(e){function t(t,n){var r;return(r=e.call(this,t,n)||this).behaviors=[],t.workbookRangeIds.forEach((function(e){r.behaviors.push({workbookRangeId:e})})),r}(0,i.Z)(t,e);var n=t.prototype;return n.check=function(e){return null},n.do=function(e,t,n){n(new F.Z({workbookRangeId:e.workbookRangeId,workbookRangeType:B.Z.PROTECTED_RANGE}))},(0,s.Z)(t,[{key:"id",get:function(){return t.id}}]),t}(l.Z);Wo.id=r.Z.DELETE_PROTECTED_RANGE_REQUEST;var zo=Wo,Qo=n("../node_modules/@tencent/dui/lib/components/Snackbar/index.js"),Yo=n("../spread-sheet/src/core/view/level-2/collab-center-ent/utils.ts"),qo=n("../packages/mutation/src/new-embedded/NewAddEmbeddedObjectMutation.ts"),Jo=function(e){function t(t,n){var r;return(r=e.call(this,t,n)||this).behaviors=t instanceof Array?t:[t],r}(0,i.Z)(t,e);var n=t.prototype;return n.check=function(e){return zn.Up(e.workbookRangeManager,[this.behaviors[0].range])?at.q.getConfig("isOwner")?{isWarningOnly:!0,warning:{title:a.ZP.t("column-type|隐私提醒"),content:a.ZP.t("column-type|所选区域包含隐私内容，图表将对所有"+Yo.PJ+"可见，确认继续？"),cancelText:a.ZP.t("取消")}}:(Qo.default.show({message:a.ZP.t("包含不可见的区域，无法插入图表。")}),ze.ZP.tdwReport({opername:"doc_excel",module:"privacy_fill",action:"pop_up",ver6:"chart"}),{ignore:!0,isWarningOnly:!1}):null},n.do=function(e,t,n){e.objects.forEach((function(t){var r=t.properties.type,o=Pt.kk.getRandomId();if(r===vo.Z.CHART&&t.properties.chart){var s=e.range||new f.Z(t.location.sheetId),i=new Qe.Z;i.setEmbeddedObjectId(t.objectId),n(new Fo.Z({gridRange:s,workbookRangeId:o,workbookRangeType:B.Z.CHART,workbookRangePropertiesDelta:i}));var a=t.properties.chart;a&&a.addWorkbookRangeId(o)}n(new qo.Z({object:t}))}))},(0,s.Z)(t,[{key:"id",get:function(){return t.id}}]),t}(l.Z);Jo.id=r.Z.ADD_EMBEDDED_OBJECT;var Ko=Jo,Xo=function(e){function t(t,n){var r;return(r=e.call(this,t,n)||this).behaviors=t instanceof Array?t:[t],r}return(0,i.Z)(t,e),t.prototype.do=function(e,t,n){e.objects.forEach((function(t){if(t.properties.type===vo.Z.CHART){var r=t.properties.chart;if(r){var o=e.range;if(o){var s=new Qe.Z;s.setEmbeddedObjectId(t.objectId),n(new V.Z({gridRange:o,workbookRangeId:r.workbookRangeId[0],workbookRangeType:B.Z.CHART,workbookRangePropertiesDelta:s}))}}}n(new mn.Z({object:t}))}))},(0,s.Z)(t,[{key:"id",get:function(){return t.id}}]),t}(l.Z);Xo.id=r.Z.UPDATE_EMBEDDED_OBJECT;var $o=Xo,es=function(e){function t(t,n){var r;return(r=e.call(this,t,n)||this).behaviors=t instanceof Array?t:[t],r}return(0,i.Z)(t,e),t.prototype.do=function(e,t,n){var r=t.embeddedObjectManager.getEmbeddedObject(e.objectId);if(r&&(n(new go.Z({objectId:e.objectId,sheetId:e.sheetId})),e.embeddedObjectType===vo.Z.CHART)){var o=r.properties.chart;o&&o.workbookRangeId.forEach((function(e){n(new F.Z({workbookRangeId:e,workbookRangeType:B.Z.CHART,nonPersistingLocalChange:!1}))}))}},(0,s.Z)(t,[{key:"id",get:function(){return t.id}}]),t}(l.Z);es.id=r.Z.DELETE_EMBEDDED_OBJECT;var ts,ns=es,rs=n("../node_modules/lodash/flatten.js"),os=n.n(rs),ss=n("../packages/model/src/filter/SortOrder.ts");!function(e){e[e.ReverseOrder=0]="ReverseOrder",e[e.PositiveSequence=1]="PositiveSequence"}(ts||(ts={}));var is=function(e){function t(t,n){var r;(r=e.call(this,t,n)||this).gridRange=t.gridRange,r.sheetId=t.sheetId,r.filterViewId=t.filterViewId;var o=t.filter,s=o.rangeFilterId,i=o.isFilterSyncOn,a=o.delta,l=t.reorder,d=l.reorderInfos,u=l.hasTitle,c=d.map((function(e){return{sortOrder:e.type===ts.PositiveSequence?ss.Z.ASCENDING:ss.Z.DESCENDING,dimensionIndex:e.column}}));return r.behaviors=[{type:"filter",updateType:N.Qn.UPDATE,workbookRangeId:s,delta:a,sheetId:r.sheetId,sortSpecs:c,nonPersistingLocalChange:!r.filterViewId&&!i,filterViewId:r.filterViewId},{type:"reorder",reorderInfos:d,hasTitle:u}],r.filterViewId||i||r.behaviors.unshift({type:"filter",updateType:N.Qn.UPDATE,workbookRangeId:s,delta:{defaultFilterId:a.defaultFilterId},sheetId:r.sheetId,sortSpecs:c,nonPersistingLocalChange:!1,filterViewId:r.filterViewId}),r}(0,i.Z)(t,e);var n=t.prototype;return n.check=function(e){var t=null,n=e.sheetManager.getSheetBySheetId(this.sheetId),r=this.gridRange;if(null===n)return t={isWarningOnly:!1,error:{title:a.ZP.t("出现问题"),content:a.ZP.t("请刷新页面重试")}};var o=Cn(n.mergeManager.mergeList,r);if(null!==o)return o;var s=we(e.parent.sheetStatus,this.gridRange);if(null!==s)return s;var i=this.checkConditionFormat(n);return null!==i?i:t},n.do=function(e,t,n){if(t.sheetManager.getSheetBySheetId(this.sheetId))switch(e.type){case"filter":e.updateType===N.Qn.UPDATE&&this.doUpdate(e,t,n);break;case"reorder":this.filterViewId||this.doReorder(e,t,n)}},n.doReorder=function(e,t,n){var r=this,o=t.sheetManager.getSheetBySheetId(this.sheetId),s=this.gridRange,i=this.createUnmergeCellsMutations(t);i.forEach(n);var a=(0,Sn.lU)({sheet:o,range:s,hasTitle:e.hasTitle,reorderInfos:e.reorderInfos,isWithFilter:!0}),l=this.createUpdateSheetRangeMutations(t,a,s);n(new Rn.Z({sheetId:this.sheetId,range:s,operation:a})),l.length>0&&l.forEach((function(e){n(e)})),i.forEach((function(e){if(e instanceof Te.Z){var t=e.startRowIndex;a.rules[t]?n(new g.Z({sheetId:r.sheetId,startRowIndex:a.rules[t].to,endRowIndex:a.rules[t].to,startColIndex:e.startColIndex,endColIndex:e.endColIndex})):n(new g.Z({sheetId:r.sheetId,startRowIndex:e.startRowIndex,endRowIndex:e.endRowIndex,startColIndex:e.startColIndex,endColIndex:e.endColIndex}))}}))},n.doUpdate=function(e,t,n){var r=e.delta,o=e.updateType,s=e.workbookRangeId,i=e.sheetId,a=e.sortSpecs,l=e.nonPersistingLocalChange,d=e.filterViewId,u=t.sheetManager.getSheetBySheetId(i);if(!u.getBasicFilter(!1,d)||!r.updateColumnCriteriaDelta)return null;r.hiddenRows=(0,xr.W)(u,r,d,a),n(new N.ZP({delta:r,updateType:o,workbookRangeId:s,sheetId:i,filterViewId:d,sortSpecs:a,nonPersistingLocalChange:l}))},n.createUnmergeCellsMutations=function(e){var t=[],n=e.sheetManager.getSheetBySheetId(this.sheetId);return new He({sheetId:n.getSheetId(),gridRanges:[this.gridRange]}).run(e,(function(e){t.push(e)})),t},n.createUpdateSheetRangeMutations=function(e,t,n){for(var r=[],o=e.sheetManager.getSheetBySheetId(this.sheetId),s=this.sheetId,i=function(i){for(var a=t.queue[i],l=function(n){var i=o.getCellDataAtPosition(t.rules[a].from,n);if(i){var l=i.getSheetRangeReferences();l&&l.forEach((function(o){!function(t,n,o){var i,a=null===(i=e.sheetManager.getSheetBySheetId(s).sheetRangeManager.getSheetRange(t.id))||void 0===i?void 0:i.properties;r.push(new We.Z({sheetId:s,sheetRangeId:t.id,sheetRangeType:t.type,gridRange:new f.Z(s,n,n,o,o),padId:at.q.getConfig("padId"),sheetRangeDelta:new Ye.Z({commentSheetRangeProperties:a?a.clone():void 0})}))}(o,t.rules[a].to,n)}))}},d=n.startColIndex;d<=n.endColIndex;d++)l(d)},a=0;a<t.queue.length;a++)i(a);return r},n.checkConditionFormat=function(e){var t=e.filterViewManager.getActiveFilterView();if(!t)return null;var n=t.getBasicFilter();if(!n)return null;var r=os()(e.conditionalFormatRuleManager.rules.map((function(e){return e.rule.ruleRanges}))).some((function(e){return n.range.isCross(e)}));return r?{isWarningOnly:!0,warning:{title:a.ZP.t("出现问题"),content:a.ZP.t("排序后，视图内条件格式高亮区域会按照原表操作")}}:null},(0,s.Z)(t,[{key:"id",get:function(){return r.Z.REORDER_FILTER_REQUEST}}]),t}(l.Z);is.id=r.Z.REORDER_FILTER_REQUEST;var as=is,ls=function(e){function t(t,n){var r;return(r=e.call(this,t,n)||this).behaviors=[t],r}return(0,i.Z)(t,e),t.prototype.do=function(e,t,n){n(new k.Z({sheetId:e.sheetId,sheetDelta:new P.Z({operation:U.C.SET_PROPERTIES,delta:{hideGridline:e.hideGridlines}})}))},(0,s.Z)(t,[{key:"id",get:function(){return t.id}}]),t}(l.Z);ls.id=r.Z.SET_HIDE_GRIDLINES_REQUEST;var ds=ls,us=function(e){function t(t,n){var r;return(r=e.call(this,t,n)||this).behaviors=[t],r}(0,i.Z)(t,e);var n=t.prototype;return n.do=function(e,t,n){var r=this,o=e.cellFlags,s=e.range,i=e.rangeFlags,a=(0,At.e6)([s],t.activeSheet);if(o){var l=o.map((function(e){var n=e.row,o=e.col,s=e.ignoreFlags,i=t.activeSheet.transformCoordFromFilterViewToSheet(n,o);return{rowIndex:i.row,colIndex:i.col,cellDataDelta:r.getCellDataDelta(s)}}));a.forEach((function(e){var t=e.startRowIndex,r=e.startColIndex,o=e.endRowIndex,i=e.endColIndex,a=l.filter((function(e){return e.rowIndex>=t&&e.rowIndex<=o&&e.colIndex>=r&&e.colIndex<=i}));n(new ie.qi({gridRange:s,cellDataDeltaAtPositions:a}))}))}else"number"===typeof i&&a.forEach((function(e){n(new ie.Y0({gridRange:e,cellDataDelta:r.getCellDataDelta(i)}))}))},n.getCellDataDelta=function(e){var t=new _e.Z;return e?t.setSlot(m.Z.SLOT_IGNORED_ERROR_FLAGS,e):t.clearSlot(m.Z.SLOT_IGNORED_ERROR_FLAGS),t},(0,s.Z)(t,[{key:"id",get:function(){return r.Z.SET_IGNORED_ERROR_FLAGS}}]),t}(l.Z);us.id=r.Z.SET_IGNORED_ERROR_FLAGS;var cs=function(e){function t(t,n){var r;return(r=e.call(this,t,n)||this).behaviors=[t],r}(0,i.Z)(t,e);var n=t.prototype;return n.do=function(e,t,n){var r=this,o=e.refIds,s=e.range,i=e.cellValue;(0,At.e6)([s],t.activeSheet).forEach((function(e){n(new ie.Y0({gridRange:e,cellDataDelta:r.getCellDataDelta(o,i)}))}))},n.getCellDataDelta=function(e,t){var n=new _e.Z;return e?n.setSlot(m.Z.SLOT_REF_IDS,e):n.clearSlot(m.Z.SLOT_REF_IDS),"string"===typeof t&&n.setSlot(m.Z.SLOT_EFFIECTIVE_VALUE,pe.Z.createInstance({type:A.EXTENDED_VALUE_TYPE.STRING,value:t})),n},(0,s.Z)(t,[{key:"id",get:function(){return r.Z.SET_REF_IDS}}]),t}(l.Z);cs.id=r.Z.SET_REF_IDS;var hs=n("../packages/model/src/workbookRange/linkedRange/LinkedRangeProperties.ts"),fs=function(e){this.namedRangeId=null,this.range=e.range},ps=function(e){function t(t,n){var r;r=e.call(this,t,n)||this;var o=t.workbookRangeId,s=new fs(t);return r.behaviors=[{data:s,workbookRangeId:o}],r}(0,i.Z)(t,e);var n=t.prototype;return n.check=function(e){return null},n.do=function(e,t,n){var r=new Qe.Z,o=new hs.Z({});r.setLinkedRangeProperties(o),n(new Fo.Z({workbookRangeId:e.workbookRangeId,gridRange:e.data.range,workbookRangeType:B.Z.LINKED_RANGE,workbookRangePropertiesDelta:r}))},(0,s.Z)(t,[{key:"id",get:function(){return t.id}}]),t}(l.Z);ps.id=r.Z.ADD_LINKED_RANGE_REQUEST;var gs=ps,ms=n("../packages/model/src/cell/HyperlinkRun.ts"),vs=function(e){function t(t,r){var o;o=e.call(this,t,r)||this;var s=n.g.SpreadsheetApp.spreadsheet.activeSheet.getCellDataAtPosition(t.rowIndex,t.colIndex),i=null===s||void 0===s?void 0:s.getHyperlink(),a=null===s||void 0===s?void 0:s.getHyperlinkType();return o.behaviors.forEach((function(e){e.hyperlinkRuns=t.hyperlinkRuns.map((function(e){return ms.Z.createInstance(e)})),a&&t.hyperlinkType===er.ZP.IMAGE&&i&&t.hyperlinkRuns&&(e.hyperlinkType=null),e.linkUrl=null})),o}return(0,i.Z)(t,e),(0,s.Z)(t,[{key:"id",get:function(){return t.id}}]),t}(En.ZP);vs.id=r.Z.SET_HYPERLINK_RUNS_REQUEST;var Is=vs,Es=n("../spread-sheet/src/core/behavior/request/range/common/index.ts"),Ss=n("../spread-sheet/src/core/behavior/request/range/config.ts"),Rs=n("../spread-sheet/src/core/feature/copyPaste/api/copyPasteAPI.common.ts");function ws(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){if(e){if("string"===typeof e)return As(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?As(e,t):void 0}}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0;return function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function As(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Cs=function(e,t,n,r){var o,s=arguments.length,i=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)i=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(i=(s<3?o(i):s>3?o(t,n,i):o(t,n))||i);return s>3&&i&&Object.defineProperty(t,n,i),i},ys=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},_s=function(e){function t(t){var n;return(n=e.call(this,t)||this).sizeOverLimitTip="",n.getExpandDimensionMutations=function(e){var t=(0,$n.Z)(n),r=t.direction,o=t.expandDimensionAmount,s=e.getRowCount(),i=e.getColCount(),a=r===Ss.ai.RIGHT?u.Z.COLUMNS:u.Z.ROWS,l=a===u.Z.ROWS?s:i;return new d.Z({index:l,amount:o,type:a,sheetId:e.getSheetId()})},n.getInheritDimensionStyleMutations=function(e){var t=(0,$n.Z)(n),r=t.direction,o=t.expandDimensionAmount,s=e.getRowCount(),i=e.getColCount(),a=e.getSheetId(),l=[],d=r===Ss.ai.RIGHT?new f.Z(a,0,s-1,i-1,i-1):new f.Z(a,s-1,s-1,0,i-1),u=S(e,d),c=[];if((null===u||void 0===u?void 0:u.cellDataDeltaAtPositions.length)>0){for(var h,g=ws(u.cellDataDeltaAtPositions);!(h=g()).done;){var m=h.value,v=m.rowIndex,I=m.colIndex,E=m.cellDataDelta;if(0!==E.setSlots)for(var R=0;R<o;R++)c.push({rowIndex:r===Ss.ai.DOWN?v+R+1:v,colIndex:r===Ss.ai.DOWN?I:I+R+1,cellDataDelta:E})}d=r===Ss.ai.DOWN?new f.Z(a,s,s+o-1,0,i-1):new f.Z(a,0,s-1,i,i+o-1),c.length>0&&l.push(new p.Z({gridRange:d,cellDataDeltaAtPositions:c}))}return l},n.getInheritStyleMutations=function(e){var t=(0,$n.Z)(n),r=t.direction,o=t.selectRange,s=o.startColIndex,i=o.startRowIndex,a=o.endColIndex,l=o.endRowIndex,d=e.getSheetId(),u=S(e,r===Ss.ai.RIGHT?new f.Z(d,i,l,s,s):new f.Z(d,i,i,s,a)),c=[],h=[];if((null===u||void 0===u?void 0:u.cellDataDeltaAtPositions.length)>0){for(var g,m=ws(u.cellDataDeltaAtPositions);!(g=m()).done;){var v=g.value,I=v.rowIndex,E=v.colIndex,R=v.cellDataDelta,w=R;if(0===R.setSlots){var A=e.getCellDataAtPosition(I,E),C=null===A||void 0===A?void 0:A.getMergeReference();if(!C)continue;w=S(e,C).cellDataDeltaAtPositions[0].cellDataDelta}for(var y=n.getSpanCount(r,o),_=0;_<y;_++)c.push({rowIndex:r===Ss.ai.RIGHT?I:I+_,colIndex:r===Ss.ai.RIGHT?E+_:E,cellDataDelta:w})}var T=o;c.length>0&&h.push(new p.Z({gridRange:T,cellDataDeltaAtPositions:c}))}return h},n.getInheritConditionFormatMutations=function(e){var t=(0,$n.Z)(n),r=t.direction,s=t.selectRange,i=s.startRowIndex,a=s.startColIndex,l=s.endRowIndex,d=s.endColIndex,u=e.getSheetId(),c=[],h=r===Ss.ai.RIGHT?new f.Z(u,i,l,d+1,d+1):new f.Z(u,l+1,l+1,a,d);return e.conditionalFormatRuleManager.each((function(e){var t=e.rule;t.ruleRanges.forEach((function(n){var s=n.getCross(h);if(s){var p=r===Ss.ai.RIGHT?new f.Z(u,s.startRowIndex,s.endRowIndex,a,d):new f.Z(u,i,l,s.startColIndex,s.endColIndex),g=t.clone(),m=g.ruleRanges;g.ruleRanges=[].concat((0,o.Z)(m),[p]),c.push(new ie.eU({sheetId:u,ruleIndex:e.index,rule:g,oldRuleRanges:m}))}}))})),c},n.getSpanCount=function(e,t){return e===Ss.ai.RIGHT?t.getColCount():t.getRowCount()},n.setPasteParams=function(e){var t=e.parent,r=e.activeSheet,o=e.sheetManager,s=n.getCutPasteFromAndToRange(),i=s.from,a=s.to;n.cutFrom=i,n.pasteTo=a;var l=(0,ut.convertGridRangeToXYRange)(i),d=(0,ut.convertGridRangeToXYRange)(a),u=(0,Rs.St)({hotInstance:t,previewActiveSheetId:"",from:l,copyType:bt.lb.cut}),c=(0,Rs.Tl)({from:l,hotInstance:t,previewActiveSheetId:"",isSelectAll:!1,copyType:bt.lb.cut}),h=(0,Rs.LC)(o,r,c,r.getSheetId(),d,u,{tile:!0,setSlots:Ss.Zw,isInsertOrDeleteRange:!0});if(Object.assign((0,$n.Z)(n),{pasteMutationOptions:h}),h){var f=h.option,p=h.rowDataUpdate,g=f.toGridRange,m={startRow:g.startRowIndex,startCol:g.startColIndex,rowData:p,rowMetadata:[],colMetadata:[]};f.gridData=m}},n.getCutPasteFromAndToRange=function(){var e=(0,$n.Z)(n),t=e.selectRange,r=e.effectRange,o=e.direction,s=t.sheetId,i=t.startRowIndex,a=t.startColIndex,l=t.endRowIndex,d=t.endColIndex,u=t.getColCount(),c=t.getRowCount();if(o===Ss.ai.RIGHT){var h=r.endColIndex-u;return{from:new f.Z(s,i,l,a,h),to:new f.Z(s,i,i,d+1,d+1)}}var p=r.endRowIndex-c;return{from:new f.Z(s,i,p,a,d),to:new f.Z(s,l+1,l+1,a,a)}},n.getExpandDimensionAmount=function(e){var t=(0,$n.Z)(n),r=t.direction,o=t.effectRange,s=o.endColIndex,i=o.endRowIndex,a=e.getColCount()-1,l=e.getRowCount()-1;return r===Ss.ai.RIGHT?s>a?s-a:0:i>l?i-l:0},n.behaviors=[t],n.selectRange=t.range,n.direction=t.direction,n}(0,i.Z)(t,e);var n=t.prototype;return n.check=function(e){var t=this,n=e.activeSheet;this.effectRange=(0,Es.eZ)(n,Ss.Us.INSERT,this.direction,this.selectRange),this.expandDimensionAmount=this.getExpandDimensionAmount(n);var r=[Es.wt,Es.k1],o=null;if(r.every((function(e){return e(t.effectRange,n)&&(o=e),!o})),o){var s=Es.kY.get(o)();return{isWarningOnly:!1,error:{title:s.title,content:s.content}}}if(this.setPasteParams(e),!this.pasteMutationOptions)return{isWarningOnly:!1,error:{title:a.ZP.t("合并单元格问题"),content:a.ZP.t("遇到合并单元格，操作不成功，请取消合并之后重试。")}};var i=this.getFilterViewReorderCheckResult(e);return i||null},n.predictRequestSize=function(e){var t=e.activeSheet;if(this.isOverSizeAfterExpandDimension(t))return this.sizeOverLimitTip=a.ZP.t("超出最大行列/单元格数量，操作不成功。"),Pn.H;var n=this.pasteMutationOptions.option,r=n.pasteEmbeddedObjects,o=n.gridData;return r&&r.length>Ss.VY?Pn.H:(0,Es.xc)(o)},n.requestSizeOverLimitTips=function(){return this.sizeOverLimitTip?this.sizeOverLimitTip:a.ZP.t("数据量较大，操作不成功。")},n.do=function(e,t,n){var r=this.expandDimensionAmount,s=this.pasteMutationOptions,i=t.activeSheet,a=t.parent,l=this.getInheritStyleMutations(i);if(r>0){var d=this.getInheritDimensionStyleMutations(i),u=this.getExpandDimensionMutations(i);n(u),d.forEach((function(e){return n(e)}))}var c=s.option;Vt({copyRange:c.copyRange,toGridRange:c.toGridRange,isCut:c.cutData.cutGridRanges.length>0,pasteSpecialType:c.params.pasteSpecialType},a,n);var h=[];h.push.apply(h,(0,o.Z)(Ft(c,a))),h.push.apply(h,(0,o.Z)(Ht(c))),h.push.apply(h,(0,o.Z)(Wt(c,a))),h.push.apply(h,(0,o.Z)(Gt(c,a))),h.push.apply(h,(0,o.Z)(Kt(c))),h.forEach((function(e){return n(e)})),l.forEach((function(e){return n(e)})),ze.ZP.tdwReport({opername:"doc_excel_editor",module:"cell_edit",action:"cell_set",ver11:"insert_cell"})},n.isOverSizeAfterExpandDimension=function(e){var t,n,r=this.expandDimensionAmount,o=this.direction,s=!1;if(r<=0)return s;o===Ss.ai.RIGHT?(t=e.getRowCount()+r,n=e.getColCount()):(t=e.getRowCount(),n=e.getColCount()+r);var i=t*n;return(t>Zn.MAX_ROW_COUNT||n>Zn.MAX_COL_COUNT||i>Zn.MAX_CELL_COUNT)&&(s=!0),s},n.getFilterViewReorderCheckResult=function(e){var t=e.activeSheet,n=this.pasteMutationOptions.option.mergeInfos;return(0,Je.J)(t,n,this.id)},(0,s.Z)(t,[{key:"id",get:function(){return t.id}}]),t}(l.Z);_s.id=r.Z.INSERT_RANGE_REQUEST,Cs([(0,w.M4)(_s),ys("design:type",Function),ys("design:paramtypes",[Object]),ys("design:returntype",Number)],_s.prototype,"predictRequestSize",null);var Ts=_s;function xs(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){if(e){if("string"===typeof e)return bs(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?bs(e,t):void 0}}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0;return function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function bs(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Ds=function(e,t,n,r){var o,s=arguments.length,i=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)i=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(i=(s<3?o(i):s>3?o(t,n,i):o(t,n))||i);return s>3&&i&&Object.defineProperty(t,n,i),i},Os=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},Ms=function(e){function t(t){var n;return(n=e.call(this,t)||this).setPasteParams=function(e){var t=e.parent,r=e.activeSheet,o=e.sheetManager,s=n.getCutPasteFromAndToRange(r),i=s.from,a=s.to,l=(0,ut.convertGridRangeToXYRange)(i),d=(0,ut.convertGridRangeToXYRange)(a),u=(0,Rs.St)({hotInstance:t,previewActiveSheetId:"",from:l,copyType:bt.lb.cut}),c=(0,Rs.Tl)({from:l,hotInstance:t,previewActiveSheetId:"",isSelectAll:!1,copyType:bt.lb.cut}),h=(0,Rs.LC)(o,r,c,r.getSheetId(),d,u,{tile:!0,setSlots:Ss.Zw,isInsertOrDeleteRange:!0});if(Object.assign((0,$n.Z)(n),{pasteMutationOptions:h}),h){var f=h.option,p=h.rowDataUpdate,g=f.toGridRange,m={startRow:g.startRowIndex,startCol:g.startColIndex,rowData:p,rowMetadata:[],colMetadata:[]};f.gridData=m}},n.excludeSelectionRangeMutations=function(e){var t=(0,$n.Z)(n).selectRange;if((null===e||void 0===e?void 0:e.id)===ie.xF.UNMERGE_CELLS_MUTATION){var r=e.sheetId,o=e.startColIndex,s=e.startRowIndex,i=e.endColIndex,a=e.endRowIndex,l=new f.Z(r,s,a,o,i);return!t.contain(l)}return!0},n.setIsNeedCutPaste=function(){var e=(0,$n.Z)(n),t=e.selectRange,r=e.effectRange;n.isNeedCutPaste=!t.equal(r)},n.getCutPasteFromAndToRange=function(e){var t=(0,$n.Z)(n),r=t.selectRange,o=t.effectRange.getExcept(r,e)[0],s=r.sheetId,i=r.startRowIndex,a=r.startColIndex;return{from:o,to:new f.Z(s,i,i,a,a)}},n.getDeleteWorkbookMutations=function(e,t){for(var n,r=e.data.rowData,o=[],s=xs(t);!(n=s()).done;)for(var i=n.value,a=i.startColIndex,l=i.startRowIndex,d=i.endColIndex,u=i.endRowIndex,c=l;c<=u;c++)for(var h=a;h<=d;h++){var f=lt({rowIndex:c,colIndex:h},r);if(f){var p=new Le.Z({sheetId:e.getSheetId(),sheetRangeId:f.id,nonPersistingLocalChange:!1});o.push(p)}}return o},n.reportSuccess=function(){ze.ZP.tdwReport({opername:"doc_excel_editor",module:"cell_edit",action:"cell_set",ver11:"delete_cell"})},n.behaviors=[t],n.selectRange=t.range,n.direction=t.direction,n}(0,i.Z)(t,e);var n=t.prototype;return n.check=function(e){var t=this,n=e.activeSheet;this.effectRange=(0,Es.eZ)(n,Ss.Us.DELETE,this.direction,this.selectRange);var r=[Es.wt,Es.k1],o=null;if(r.every((function(e){return e(t.effectRange,n)&&(o=e),!o})),o){var s=Es.kY.get(o)();return{isWarningOnly:!1,error:{title:s.title,content:s.content}}}if(this.setIsNeedCutPaste(),!this.isNeedCutPaste)return null;if(this.setPasteParams(e),!this.pasteMutationOptions)return{isWarningOnly:!1,error:{title:a.ZP.t("合并单元格问题"),content:a.ZP.t("遇到合并单元格，操作不成功，请取消合并之后重试。")}};var i=this.getFilterViewReorderCheckResult(e);return i||null},n.predictRequestSize=function(){if(!this.isNeedCutPaste)return 0;var e=this.pasteMutationOptions.option,t=e.pasteEmbeddedObjects,n=e.gridData;return t&&t.length>Ss.VY?Pn.H:(0,Es.xc)(n)},n.requestSizeOverLimitTips=function(){return a.ZP.t("数据量较大，操作不成功。")},n.do=function(e,t,n){var r,s,i,a,l,d,u,c=this.isNeedCutPaste,h=this.pasteMutationOptions,f=this.selectRange,p=t.activeSheet,g=t.parent,m=this.getCellDataDelta(),v=[];ft(p,f,n);var I=(0,At.e6)([f],p);if((r=v).push.apply(r,(0,o.Z)(this.getDeleteWorkbookMutations(p,I))),(s=v).push.apply(s,(0,o.Z)((0,Te.N)(f,p))),I.forEach((function(e){v.push(new L.Z({gridRange:e,cellDataDelta:m}))})),v.forEach((function(e){return n(e)})),c){v=[];var E=h.option;Vt({copyRange:E.copyRange,toGridRange:E.toGridRange,isCut:E.cutData.cutGridRanges.length>0,pasteSpecialType:E.params.pasteSpecialType},g,n),(i=v).push.apply(i,(0,o.Z)(Ft(E,g))),(a=v).push.apply(a,(0,o.Z)(Ht(E))),(l=v).push.apply(l,(0,o.Z)(Wt(E,g).filter(this.excludeSelectionRangeMutations))),(d=v).push.apply(d,(0,o.Z)(Gt(E,g))),(u=v).push.apply(u,(0,o.Z)(Kt(E))),v.forEach((function(e){return n(e)})),this.reportSuccess()}else this.reportSuccess()},n.getCellDataDelta=function(){var e=new _e.Z({clearSlots:m.i.ALL});return e.setSlot(m.Z.SLOT_USER_ENTERED_FORMAT_DELTA,new je.Z({clearSlots:be.$.ALL})),e},n.getFilterViewReorderCheckResult=function(e){var t=e.activeSheet,n=this.pasteMutationOptions.option.mergeInfos;return(0,Je.J)(t,n,this.id)},(0,s.Z)(t,[{key:"id",get:function(){return t.id}}]),t}(l.Z);Ms.id=r.Z.DELETE_RANGE_REQUEST,Ds([(0,w.M4)(Ms),Os("design:type",Function),Os("design:paramtypes",[]),Os("design:returntype",Number)],Ms.prototype,"predictRequestSize",null);var js=Ms,Ls=n("../spread-sheet/src/core/behavior/request/workbook/filterUtils/getExtendFilterRangeMutation.ts"),Zs=n("../spread-sheet/src/core/feature/copyPaste/utils/mergeRangeUtils.ts"),ks=function(e,t,n,r){var o,s=arguments.length,i=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)i=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(i=(s<3?o(i):s>3?o(t,n,i):o(t,n))||i);return s>3&&i&&Object.defineProperty(t,n,i),i},Ns=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},Ps=function(e){function t(t){var n;return(n=e.call(this,t)||this).behaviors=[t],Object.assign((0,$n.Z)(n),t),n}(0,i.Z)(t,e);var r=t.prototype;return r.check=function(e){var t=e.parent,r=e.activeSheet,o=e.sheetManager,s=this.fromRange,i=this.toRange,l={isWarningOnly:!1,error:{title:a.ZP.t("出现错误"),content:""}};if((0,Es.wt)(s,r)||(0,Es.wt)(i,r))return l.error.content=a.ZP.t("此范围已被保护。如需编辑，请联系创建者「{{value}}」授予权限。",{value:n.g.clientVars.ownerNick}),l;if(!this.isSelectCell&&!(0,Zs.zk)(this.fromRange,r))return l.error.title=a.ZP.t("合并单元格问题"),l.error.content=a.ZP.t("遇到合并单元格，操作不成功，请取消合并之后重试。"),l;var d=(0,ut.convertGridRangeToXYRange)(s),u=(0,ut.convertGridRangeToXYRange)(i);this.pasteData=(0,Rs.St)({hotInstance:t,previewActiveSheetId:"",from:d,copyType:bt.lb.cut}),this.pasteState=(0,Rs.Tl)({from:d,hotInstance:t,previewActiveSheetId:"",isSelectAll:!1,copyType:bt.lb.cut});var c=(0,Rs.LC)(o,r,this.pasteState,r.getSheetId(),u,this.pasteData,{tile:!0,setSlots:Ss.Zw});if(!c)return l.error.title=a.ZP.t("合并单元格问题"),l.error.content=a.ZP.t("遇到合并单元格，操作不成功，请取消合并之后重试。"),l;this.pasteMutationOptions=c;var h=this.getFilterViewReorderCheckResult(e);return h||null},r.predictRequestSize=function(){var e=0,t=this.pasteMutationOptions,n=t.option,r=t.rowDataUpdate,o=n.toGridRange,s=n.pasteEmbeddedObjects,i={startRow:o.startRowIndex,startCol:o.startColIndex,rowData:r,rowMetadata:[],colMetadata:[]};return n.gridData=i,s&&s.length>Ss.VY&&(e=Pn.H),e||(e=(0,Es.xc)(n.gridData)),e},r.requestSizeOverLimitTips=function(){return a.ZP.t("数据量较大，操作不成功。")},r.do=function(e,t,n){var r=this.pasteMutationOptions.option,s=r.pasteRanges,i=t.activeSheet,a=t.parent;Vt({copyRange:r.copyRange,toGridRange:r.toGridRange,isCut:r.cutData.cutGridRanges.length>0,pasteSpecialType:r.params.pasteSpecialType},a,n),[].concat((0,o.Z)(Ut(r)),(0,o.Z)(Ft(r,a)),(0,o.Z)(Ht(r)),(0,o.Z)(Wt(r,a)),(0,o.Z)(Gt(r,a)),(0,o.Z)(Jt(r)),(0,o.Z)(Kt(r))).forEach((function(e){return n(e)}));var l=(0,Ls.Z)(i,s);l.length>0&&n(l[0]),ze.ZP.tdwReport({opername:"doc_excel_editor",module:"cell_edit",action:"cell_set",ver11:"drag_cell"})},r.getFilterViewReorderCheckResult=function(e){var t=this.behaviors[0].sheetId,n=e.sheetManager.getSheetBySheetId(t),r=this.pasteMutationOptions.option.mergeInfos;return(0,Je.J)(n,r,this.id)},(0,s.Z)(t,[{key:"id",get:function(){return t.id}}]),t}(l.Z);Ps.id=r.Z.MOVE_RANGE_REQUEST,ks([(0,w.M4)(Ps),Ns("design:type",Function),Ns("design:paramtypes",[]),Ns("design:returntype",Number)],Ps.prototype,"predictRequestSize",null);var Us=Ps,Fs=function(e){function t(t,n){var r;return(r=e.call(this,t,n)||this).behaviors=[],r.sheetId=t.sheetId,r.nonPersistingLocalChange=!1,r.isArchived=t.isArchived,r.behaviors.push({sheetRangeId:t.sheetRangeId,gridRange:t.gridRange}),r}(0,i.Z)(t,e);var n=t.prototype;return n.check=function(){var e;return e={isWarningOnly:!1,error:{title:a.ZP.t("出现问题"),content:a.ZP.t("只能给唯一单元格设置批注。")}},this.behaviors[0].gridRange.isSingle()?null:e},n.do=function(e,t,n){if(t.sheetManager.getSheetBySheetId(this.sheetId)){var r=(0,At.e6)([e.gridRange],t.activeSheet);n(new We.Z({sheetId:this.sheetId,sheetRangeId:e.sheetRangeId,gridRange:r[0],sheetRangeType:st.Z.COMMENT_RANGE,nonPersistingLocalChange:this.nonPersistingLocalChange,padId:at.q.getConfig("padId"),sheetRangeDelta:new Ye.Z({commentSheetRangeProperties:new Lr.Z({isArchived:this.isArchived})})}))}},(0,s.Z)(t,[{key:"id",get:function(){return t.id}}]),t}(l.Z);Fs.id=r.Z.UPDATE_COMMENT_RANGE_REQUEST;var Vs=Fs,Bs=function(e){function t(t,n){var r;return(r=e.call(this,t,n)||this).behaviors=[],r.behaviors.push(t),r}(0,i.Z)(t,e);var n=t.prototype;return n.do=function(e,t,n){var r,o,s,i,a=t.sheetManager.getSheetBySheetId(e.sheetId);if(a){var l,d=e.sheetId,u=e.row,c=e.col,h=e.dateTime,p=a.getCellDataAtPosition(u,c),g=a.transformCoordFromFilterViewToSheet(u,c),m=(l="undefined"!==typeof h?(0,En.VL)({cellData:p,sheetId:d,rowIndex:g.row,colIndex:g.col,userEnterValue:h,linkUrl:null}):new A.CellDataDelta).delta.userEnteredFormatDelta||new A.CellFormatDelta;m.clearSlot(A.CELL_FORMAT_SLOT.FOREGROUND_COLOR);var v,E=(0,Gn.parseDateTimeValue)(null===p||void 0===p?void 0:p.getEditValue(),{});if("time"===(null===E||void 0===E?void 0:E.type)){var S=this.getCurrentDate()+" "+E.moment.format("h:mm:ss");v=sr.NumberFormatFactory.createInstance({pattern:"yyyy/m/d h:mm:ss;@"});var R=(0,Gn.parseValueWithStyle)(S,v,{parseMode:Gn.PARSE_MODE.PARSE_STYLE_FIRST});l.setSlot(A.CELL_DATA_SLOT.SLOT_EFFIECTIVE_VALUE,pe.Z.createInstance({type:Number(R.valueType),value:R.value})),m.setSlot(A.CELL_FORMAT_SLOT.NUMBER_FORMAT,R.numberFormat)}else"date"===(null===E||void 0===E?void 0:E.type)?(v=sr.NumberFormatFactory.createInstance({pattern:"yyyy/m/d"}),(null===(o=null===(r=null===p||void 0===p?void 0:p.getUserEnteredFormat())||void 0===r?void 0:r.getNumberFormat())||void 0===o?void 0:o.equals(v))||m.setSlot(A.CELL_FORMAT_SLOT.NUMBER_FORMAT,v)):"date-time"===(null===E||void 0===E?void 0:E.type)&&(v=sr.NumberFormatFactory.createInstance({pattern:"yyyy/m/d h:mm:ss;@"}),(null===(i=null===(s=null===p||void 0===p?void 0:p.getUserEnteredFormat())||void 0===s?void 0:s.getNumberFormat())||void 0===i?void 0:i.equals(v))||m.setSlot(A.CELL_FORMAT_SLOT.NUMBER_FORMAT,v));l.setSlot(A.CELL_DATA_SLOT.SLOT_USER_ENTERED_FORMAT_DELTA,m),l.setSlot(A.CELL_DATA_SLOT.SLOT_METADATA,ue.Z.createInstance({customDataType:I.ZP.DATE_REMINDER})),l.setSlot(A.CELL_DATA_SLOT.SLOT_REF_IDS,[e.dateReminderId]);var w=new f.Z(d,u,u,c,c),C=(0,At.e6)([w],t.activeSheet);n(new ie.Y0({gridRange:C[0],cellDataDelta:l}))}},n.getCurrentDate=function(){var e=new Date;return e.getFullYear()+"/"+(e.getMonth()+1)+"/"+e.getDate()},(0,s.Z)(t,[{key:"id",get:function(){return t.id}}]),t}(l.Z);Bs.id=r.Z.ADD_DATE_REMINDER_REQUEST;var Hs=Bs,Gs=function(e){function t(t,n){var r;return(r=e.call(this,t,n)||this).behaviors=[],r.behaviors.push(t),r}return(0,i.Z)(t,e),t.prototype.do=function(e,t,n){if(t.sheetManager.getSheetBySheetId(e.sheetId)){var r=e.sheetId,o=e.row,s=e.col,i=new A.CellDataDelta;i.clearSlot(A.CELL_DATA_SLOT.SLOT_METADATA),i.clearSlot(A.CELL_DATA_SLOT.SLOT_REF_IDS);var a=new f.Z(r,o,o,s,s);(0,At.e6)([a],t.activeSheet).forEach((function(e){n(new ie.Y0({gridRange:e,cellDataDelta:i}))}))}},(0,s.Z)(t,[{key:"id",get:function(){return t.id}}]),t}(l.Z);Gs.id=r.Z.DELETE_DATE_REMINDER_REQUEST;var Ws=Gs,zs=n("../packages/utils/src/random.ts"),Qs=function(e){function t(t,n){var r;r=e.call(this,t,n)||this;var o=t.ranges||(null===n||void 0===n?void 0:n.rangeSelections)||[];return r.behaviors=o.map((function(e){return{range:e}})),r.ignoreUnsetConfirm=t.ignoreUnsetConfirm,r.shouldRemoveSameColOnSet=t.shouldRemoveSameColOnSet,r.isUnset=t.isUnset,r}(0,i.Z)(t,e);var n=t.prototype;return n.do=function(e,t,n){var r=this;if(at.q.getConfig("isOwner")){var o=e.range;(0,At.e6)([o],t.activeSheet).forEach((function(e){r.isUnset?r.doUnsetPrivateRange(e,t,n):r.doSetPrivateRange(e,t,n)}))}},n.check=function(){return this.isUnset&&!this.ignoreUnsetConfirm?{isWarningOnly:!0,warning:{title:a.ZP.t("column-type|隐私提醒"),content:a.ZP.t("column-type|关闭后，内容将对所有"+Yo.PJ+"可见，填写人隐私可能受损。确定关闭吗？"),cancelText:a.ZP.t("取消")}}:null},n.doUnsetPrivateRange=function(e,t,n){var r=t.workbookRangeManager.privateRangeMap,o=t.activeSheet,s=[];r.forEach((function(t){var n=t.range,r=n.getCross(e);r&&(s.push(new ie.Xd({workbookRangeType:B.Z.PRIVATE_RANGE,workbookRangeId:t.id})),n.getExcept(r,o).forEach((function(e){s.push(new Fo.Z({gridRange:e,workbookRangeId:(0,zs.getRandomId)(),workbookRangeType:B.Z.PRIVATE_RANGE,workbookRangePropertiesDelta:new Qe.Z}))})))})),s.forEach(n)},n.doSetPrivateRange=function(e,t,n){var r=t.sheetManager.getSheetBySheetId(e.sheetId);if(r){var o=this.shouldRemoveSameColOnSet?new f.Z(e.sheetId,0,r.getRowCount()-1,e.startColIndex,e.endColIndex):e;this.doUnsetPrivateRange(o,t,n),n(new Fo.Z({gridRange:e,workbookRangeId:(0,zs.getRandomId)(),workbookRangeType:B.Z.PRIVATE_RANGE,workbookRangePropertiesDelta:new Qe.Z}))}},(0,s.Z)(t,[{key:"id",get:function(){return t.id}}]),t}(l.Z);Qs.id=r.Z.SET_PRIVATE_RANGE;var Ys=n("../packages/mutation/src/filter-view/active-filter-view-mutation.ts"),qs=n("../packages/mutation/src/filter-view/add-filter-view-mutation.ts"),Js=n("../packages/model/src/filter-view/filter-view-delta.ts"),Ks=function(e){function t(t){var n;return(n=e.call(this,t)||this).behaviors=[],n.behaviors=[t],n}(0,i.Z)(t,e);var n=t.prototype;return n.check=function(){return null},n.do=function(e,t,n){var r=e.sheetId,o=e.filterViewId,s=e.filterViewName,i=e.creatorId,a=new Js.Z({sheetId:r,filterViewId:o});a.setName(s),[new qs.Z({sheetId:r,filterViewId:o,filterViewDelta:a,creatorId:i}),new Ys.Z({sheetId:r,filterViewId:o})].forEach((function(e){n(e)}))},(0,s.Z)(t,[{key:"id",get:function(){return t.id}}]),t}(l.Z);Ks.id=r.Z.ADD_FILTER_VIEW;var Xs=Ks,$s=function(e){function t(t){var n;return(n=e.call(this,t)||this).behaviors=[],t.filterViewIds.forEach((function(e){n.behaviors.push({filterViewId:e,sheetId:t.sheetId})})),n}(0,i.Z)(t,e);var n=t.prototype;return n.check=function(){return null},n.do=function(e,t,n){var r=e.sheetId,o=e.filterViewId,s=new mo.Z({sheetId:r,filterViewId:o});[new Ys.Z({sheetId:r,filterViewId:""}),s].forEach((function(e){n(e)}))},(0,s.Z)(t,[{key:"id",get:function(){return t.id}}]),t}(l.Z);$s.id=r.Z.DELETE_FILTER_VIEW;var ei=$s,ti=n("../packages/mutation/src/filter-view/update-filter-view-mutation.ts"),ni=function(e){function t(t){var n;return(n=e.call(this,t)||this).behaviors=[],n.behaviors=[t],n}(0,i.Z)(t,e);var n=t.prototype;return n.check=function(e){var t=this.behaviors[0],n=t.filterViewName,r=t.sheetId,o=e.sheetManager.getSheetBySheetId(r);return n&&o&&o.getFilterViewsInSheet().find((function(e){return e.getFilterViewName()===n}))?{isWarningOnly:!1,error:{title:a.ZP.t("出现问题"),content:a.ZP.t("视图名称已存在, 请重新命名")}}:null},n.do=function(e,t,n){var r=e.sheetId,o=e.filterViewId,s=e.filterViewName,i=e.basicFilter,a=new Js.Z({sheetId:r,filterViewId:o,filterViewName:s,basicFilter:i});n(new ti.Z({sheetId:r,filterViewId:o,filterViewDelta:a}))},(0,s.Z)(t,[{key:"id",get:function(){return t.id}}]),t}(l.Z);ni.id=r.Z.UPDATE_FILTER_VIEW;var ri=ni,oi=function(e){function t(t){var n;return(n=e.call(this,t)||this).behaviors=[],n.behaviors=[t],n}(0,i.Z)(t,e);var n=t.prototype;return n.check=function(){return null},n.do=function(e,t,n){var r=e.sheetId,o=e.filterViewId;n(new Ys.Z({sheetId:r,filterViewId:o}))},(0,s.Z)(t,[{key:"id",get:function(){return t.id}}]),t}(l.Z);oi.id=r.Z.ACTIVE_FILTER_VIEW;var si=oi;function ii(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){if(e){if("string"===typeof e)return ai(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ai(e,t):void 0}}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0;return function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function ai(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var li=function(e){function t(t,n){var r;return(r=e.call(this,t,n)||this).checkSetBasicFilterRangeAuth=function(e){return e.workbookStatus.canEdit?we(e,r.behaviors[0].range):null},r.sheetId=t.sheetId,r.filterViewId=t.filterViewId,r.behaviors=[t],r}(0,i.Z)(t,e);var n=t.prototype;return n.check=function(e){var t=e.sheetManager.getSheetBySheetId(this.sheetId);if(!t)return{isWarningOnly:!1,error:{title:a.ZP.t("出现问题"),content:a.ZP.t("更新筛选区域出现问题，请重新操作。")}};for(var n,r=ii(this.behaviors);!(n=r()).done;){var o=n.value.range;if(!o||!(0,Rr.st)(t,o))return{isWarningOnly:!1,error:{title:a.ZP.t("无法筛选"),content:a.ZP.t("未找到可更新筛选的区域，请选择有数据的区域后重试。"),btnTxt:a.ZP.t("确定")}}}var s=this.checkSetBasicFilterRangeAuth(e.parent.sheetStatus);return null!==s?s:null},n.do=function(e,t,n){var r=e.sheetId,o=t.sheetManager.getSheetBySheetId(r);if(o&&(!this.filterViewId||o.filterViewManager.getFilterViewByViewId(this.filterViewId))){var s=o.getBasicFilter(!1,this.filterViewId),i=s.workbookRangeId,a=this.getUpdateDelta(e,s);n(new N.ZP({updateType:N.Qn.UPDATE,workbookRangeId:i,sheetId:this.sheetId,delta:a,sortSpecs:[],nonPersistingLocalChange:t.parent.sheetStatus.workbookStatus.status.full||!1,filterViewId:this.filterViewId}))}},n.getUpdateDelta=function(e,t){var n=t.workbookRangeId,r=e.range,o=t.criteriaMap;return{defaultFilterId:n,updateColumnCriteriaDelta:Array.from(o.entries()).map((function(e){return{columnIndex:e[0],clear:!0,criteria:e[1]}})),range:r,hiddenRows:[]}},(0,s.Z)(t,[{key:"id",get:function(){return t.id}}]),t}(l.Z);li.id=r.Z.UPDATE_FILTER_RANGE_REQUEST;var di=li,ui=function(e){function t(t){var n;return(n=e.call(this,t)||this).behaviors=[],n.behaviors.push(t),n}(0,i.Z)(t,e);var n=t.prototype;return n.do=function(e,t,n){var r=t.sheetManager.getSheetBySheetId(e.sheetId);if(r){var o=e.sheetId,s=e.rowIndex,i=e.colIndex,a=e.type,l=e.component,d=r.getCellDataAtPosition(s,i),u=this.weworkComponentLabel(a,l),c=(0,En.VL)({cellData:d,sheetId:o,rowIndex:s,colIndex:i,userEnterValue:u,isChanged:!0,linkUrl:null});c.setSlot(A.CELL_DATA_SLOT.SLOT_METADATA,ue.Z.createInstance({customDataType:a})),c.setSlot(A.CELL_DATA_SLOT.SLOT_REF_DATA,mr.Z.createInstance({customDataType:a,datas:[l]})),(null===d||void 0===d?void 0:d.isHyperlink())&&(c.clearSlot(A.CELL_DATA_SLOT.SLOT_HYPERLINK),c.clearSlot(A.CELL_DATA_SLOT.SLOT_LINK_ICON_TYPE),c.clearSlot(A.CELL_DATA_SLOT.SLOT_HYPERLINK_TYPE),c.clearSlot(A.CELL_DATA_SLOT.SLOT_HYPERLINK_RUN));var h=new ae.GridRange(o,s,s,i,i);n(new ie.Y0({gridRange:h,cellDataDelta:c}))}},n.weworkComponentLabel=function(e,t){var n;return((n={})[I.ZP.STAFF_CARD]=t.name,n[I.ZP.GROUP_CARD]=t.name,n[I.ZP.SCHEDULE]=t.subject,n[I.ZP.THIRD_PARTY_APP]=t.title,n[I.ZP.MINI_APP]=t.title,n)[e]},(0,s.Z)(t,[{key:"id",get:function(){return t.id}}]),t}(l.Z);ui.id=r.Z.ADD_WEWORK_COMPONENT_REQUEST;var ci=ui,hi=n("../packages/model/src/cell/metadata/todo/todo-config.ts"),fi=(n("../node_modules/core-js/modules/es.array.join.js"),n("../packages/model/src/mention/MentionDetail.ts"));function pi(e,t,n){var r=e.sheetId,o=e.rowIndex,s=e.colIndex,i=e.todoData.followers,a=s+1,l=new ae.GridRange(r,o,o,a,a);if(i.length){var d=t.getCellDataAtPosition(o,a),u=i.map((function(e){return"@"+e.name})).join(" "),c=(0,En.VL)({cellData:d,sheetId:r,rowIndex:o,colIndex:a,userEnterValue:u,isChanged:!0,linkUrl:null}),h=function(e,t,n){for(var r,o={},s=0,i=0;i<n.length;i++){var a=n[i],l=a.name,d=a.vid;o[r=(new Date).getTime().toString()+Math.random()]=new fi.Z({mentionId:r,type:0,pos:[s,s+l.length+1],text:l,userId:d,padId:e,sheetId:t}),s+=l.length+2}return o}(t.spreadsheetReference.getSpreadsheetId(),r,i);c.setSlot(A.CELL_DATA_SLOT.SLOT_MENTION,h),c.clearSlot(A.CELL_DATA_SLOT.SLOT_USER_ENTERED_FORMAT_DELTA),c.clearSlot(A.CELL_DATA_SLOT.SLOT_RICH_TEXT_STYLE_RUN),c.clearSlot(A.CELL_DATA_SLOT.SLOT_HYPERLINK),c.clearSlot(A.CELL_DATA_SLOT.SLOT_HYPERLINK_TYPE),c.clearSlot(A.CELL_DATA_SLOT.SLOT_LINK_ICON_TYPE),c.clearSlot(A.CELL_DATA_SLOT.SLOT_FORMULA),c.clearSlot(A.CELL_DATA_SLOT.SLOT_METADATA),c.clearSlot(A.CELL_DATA_SLOT.SLOT_REF_IDS),c.clearSlot(A.CELL_DATA_SLOT.SLOT_REF_DATA),c.clearSlot(A.CELL_DATA_SLOT.SLOT_DATA_VALIDATION_RULE),c.clearSlot(A.CELL_DATA_SLOT.SLOT_HYPERLINK_RUN),n(new ie.Y0({gridRange:l,cellDataDelta:c}))}else{var f=mi();n(new ie.Y0({gridRange:l,cellDataDelta:f}))}}function gi(e,t,n){var r,o,s=e.sheetId,i=e.rowIndex,a=e.colIndex,l=e.todoData.remindTime,d=a+2,u=new ae.GridRange(s,i,i,d,d);if(l.length){var c=t.getCellDataAtPosition(i,d),h=(0,En.VL)({cellData:c,sheetId:s,rowIndex:i,colIndex:d,userEnterValue:l,isChanged:!0,linkUrl:null}),f=h.delta.userEnteredFormatDelta||new A.CellFormatDelta,p=sr.NumberFormatFactory.createInstance({pattern:"yyyy/m/d h:mm"});(null===(o=null===(r=null===c||void 0===c?void 0:c.getUserEnteredFormat())||void 0===r?void 0:r.getNumberFormat())||void 0===o?void 0:o.equals(p))||f.setSlot(A.CELL_FORMAT_SLOT.NUMBER_FORMAT,p),h.setSlot(A.CELL_DATA_SLOT.SLOT_USER_ENTERED_FORMAT_DELTA,f),h.clearSlot(A.CELL_DATA_SLOT.SLOT_RICH_TEXT_STYLE_RUN),h.clearSlot(A.CELL_DATA_SLOT.SLOT_HYPERLINK),h.clearSlot(A.CELL_DATA_SLOT.SLOT_HYPERLINK_TYPE),h.clearSlot(A.CELL_DATA_SLOT.SLOT_LINK_ICON_TYPE),h.clearSlot(A.CELL_DATA_SLOT.SLOT_FORMULA),h.clearSlot(A.CELL_DATA_SLOT.SLOT_MENTION),h.clearSlot(A.CELL_DATA_SLOT.SLOT_METADATA),h.clearSlot(A.CELL_DATA_SLOT.SLOT_REF_IDS),h.clearSlot(A.CELL_DATA_SLOT.SLOT_REF_DATA),h.clearSlot(A.CELL_DATA_SLOT.SLOT_DATA_VALIDATION_RULE),h.clearSlot(A.CELL_DATA_SLOT.SLOT_HYPERLINK_RUN),n(new ie.Y0({gridRange:u,cellDataDelta:h}))}else{var g=mi();n(new ie.Y0({gridRange:u,cellDataDelta:g}))}}function mi(){var e=new A.CellDataDelta;return e.clearSlot(A.CELL_DATA_SLOT.SLOT_EFFIECTIVE_VALUE),e.clearSlot(A.CELL_DATA_SLOT.SLOT_USER_ENTERED_FORMAT_DELTA),e.clearSlot(A.CELL_DATA_SLOT.SLOT_RICH_TEXT_STYLE_RUN),e.clearSlot(A.CELL_DATA_SLOT.SLOT_HYPERLINK),e.clearSlot(A.CELL_DATA_SLOT.SLOT_HYPERLINK_TYPE),e.clearSlot(A.CELL_DATA_SLOT.SLOT_LINK_ICON_TYPE),e.clearSlot(A.CELL_DATA_SLOT.SLOT_FORMULA),e.clearSlot(A.CELL_DATA_SLOT.SLOT_MENTION),e.clearSlot(A.CELL_DATA_SLOT.SLOT_METADATA),e.clearSlot(A.CELL_DATA_SLOT.SLOT_REF_IDS),e.clearSlot(A.CELL_DATA_SLOT.SLOT_REF_DATA),e.clearSlot(A.CELL_DATA_SLOT.SLOT_DATA_VALIDATION_RULE),e.clearSlot(A.CELL_DATA_SLOT.SLOT_HYPERLINK_RUN),e}var vi=function(e){function t(t){var n;return(n=e.call(this,t)||this).behaviors=[],n.behaviors.push(t),n}(0,i.Z)(t,e);var n=t.prototype;return n.do=function(e,t,n){var r=t.sheetManager.getSheetBySheetId(e.sheetId);r&&(this.setTodoContentCell(e,r,n),e.autoBindCell&&(pi(e,r,n),gi(e,r,n)))},n.setTodoContentCell=function(e,t,n){var r=e.sheetId,o=e.rowIndex,s=e.colIndex,i=e.todoId,a=e.todoData,l=e.autoBindCell,d=a.content,u=t.getCellDataAtPosition(o,s),c=(0,En.VL)({cellData:u,sheetId:r,rowIndex:o,colIndex:s,userEnterValue:d,isChanged:!0,linkUrl:null});c.setSlot(A.CELL_DATA_SLOT.SLOT_METADATA,ue.Z.createInstance({customDataType:I.ZP.TODO,config:hi.Z.createInstance({autoBindCell:l})})),c.setSlot(A.CELL_DATA_SLOT.SLOT_REF_IDS,[i]),(null===u||void 0===u?void 0:u.isHyperlink())&&(c.clearSlot(A.CELL_DATA_SLOT.SLOT_HYPERLINK),c.clearSlot(A.CELL_DATA_SLOT.SLOT_LINK_ICON_TYPE),c.clearSlot(A.CELL_DATA_SLOT.SLOT_HYPERLINK_TYPE),c.clearSlot(A.CELL_DATA_SLOT.SLOT_HYPERLINK_RUN));var h=new ae.GridRange(r,o,o,s,s);n(new ie.Y0({gridRange:h,cellDataDelta:c}))},(0,s.Z)(t,[{key:"id",get:function(){return t.id}}]),t}(l.Z);vi.id=r.Z.ADD_TODO_REQUEST;var Ii=vi,Ei=function(e){function t(t){var n;return(n=e.call(this,t)||this).behaviors=[],n.behaviors.push(t),n}return(0,i.Z)(t,e),t.prototype.do=function(e,t,n){var r=t.sheetManager.getSheetBySheetId(e.sheetId);if(r){var o=e.sheetId,s=e.rowIndex,i=e.colIndex,a=r.getCellDataAtPosition(s,i),l=null===a||void 0===a?void 0:a.getRefIds();(null===l||void 0===l?void 0:l.length)&&l[0]||console.error("DeleteTodoRequest: Celldata todoId is empty ~");var d=new A.CellDataDelta;d.clearSlot(A.CELL_DATA_SLOT.SLOT_METADATA),d.clearSlot(A.CELL_DATA_SLOT.SLOT_REF_IDS);var u=new ae.GridRange(o,s,s,i,i);n(new ie.Y0({gridRange:u,cellDataDelta:d}))}},(0,s.Z)(t,[{key:"id",get:function(){return t.id}}]),t}(l.Z);Ei.id=r.Z.DELETE_TODO_REQUEST;var Si=Ei,Ri=function(e){function t(t){var n;return(n=e.call(this,t)||this).behaviors=[],n.behaviors.push(t),n}(0,i.Z)(t,e);var n=t.prototype;return n.do=function(e,t,n){var r=t.sheetManager.getSheetBySheetId(e.sheetId);if(r){var o=e.changes,s=o.isContentChanged,i=o.isFollowersChanged,a=o.isRemindTimeChanged;s&&this.setTodoContentCell(e,r,n),i&&pi(e,r,n),a&&gi(e,r,n)}},n.setTodoContentCell=function(e,t,n){var r=e.sheetId,o=e.rowIndex,s=e.colIndex,i=e.todoData.content,a=t.getCellDataAtPosition(o,s),l=(0,En.VL)({cellData:a,sheetId:r,rowIndex:o,colIndex:s,userEnterValue:i,isChanged:!0,linkUrl:null}),d=new ae.GridRange(r,o,o,s,s);n(new ie.Y0({gridRange:d,cellDataDelta:l}))},(0,s.Z)(t,[{key:"id",get:function(){return t.id}}]),t}(l.Z);Ri.id=r.Z.MODIFY_TODO_REQUEST;var wi=Ri,Ai=function(e){function t(t){var n;return(n=e.call(this,t)||this).behaviors=[t],n}return(0,i.Z)(t,e),t.prototype.do=function(e,t,n){var r=new H.WorkbookRangeDelta;n(new ie.OZ({workbookRangeId:e.workbookRangeId,gridRange:e.range,workbookRangeType:B.Z.NOTIFY_RANGE,workbookRangePropertiesDelta:r}))},(0,s.Z)(t,[{key:"id",get:function(){return t.id}}]),t}(l.Z);Ai.id=r.Z.ADD_NOTIFY_RANGE_REQUEST;var Ci=Ai,yi=n("../packages/model/src/sheet/index.ts");function _i(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){if(e){if("string"===typeof e)return Ti(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Ti(e,t):void 0}}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0;return function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Ti(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var xi=function(e){function t(t){var n;return(n=e.call(this,t)||this).createNewSetSheetPropertiesMutation=function(e){return new ie.dc({sheetId:n.sheetId,sheetDelta:new yi.SheetPropertiesDelta({operation:yi.NEW_SHEET_PROPERTIES_SLOT_OPERATION.SET_PROPERTIES,delta:e})})},n.behaviors=[t],n.sheetId=t.sheetId,n}(0,i.Z)(t,e);var n=t.prototype;return n.check=function(e){for(var t,n=null,r=_i(this.behaviors);!(t=r()).done;){var o=t.value.sheetId;if(!e.sheetManager.getSheetBySheetId(o))return n={isWarningOnly:!1,error:{title:a.ZP.t("出现问题"),content:a.ZP.t("工作表ID不存在")}}}return n},n.do=function(e,t,n){var r=this,o=e.sheetId;e.mutations.forEach((function(e){var s=t.parent.mutationBehavior.deserializeMutation(e);if(s){if(s.setAffectedSheetId(o),s.id===kn.ZP.SET_SHEET_PROPERTIES_MUTATION){var i=r.handleSetSheetPropertiesMutation(t,o,s);if(!i)return;s=i}n(s)}}))},n.handleSetSheetPropertiesMutation=function(e,t,n){var r=n.type,o=n.value;switch(r){case yi.OLD_SHEET_PROPERTIES_SLOT.SLOT_NUMBER_OF_ROWS:var s=o-e.activeSheet.getRowCount();return s>0?new ie.uU({sheetId:t,index:0,amount:s,type:J.DIMENSION_TYPE.ROWS}):s<0?new ie.XS({sheetId:t,index:0,amount:-s,type:J.DIMENSION_TYPE.ROWS}):void 0;case yi.OLD_SHEET_PROPERTIES_SLOT.SLOT_NUMBER_OF_COLUMNS:var i=o-e.activeSheet.getColCount();return i>0?new ie.uU({sheetId:t,index:0,amount:i,type:J.DIMENSION_TYPE.COLUMNS}):i<0?new ie.XS({sheetId:t,index:0,amount:-i,type:J.DIMENSION_TYPE.COLUMNS}):void 0;case yi.OLD_SHEET_PROPERTIES_SLOT.SLOT_FROZEN_ROWS:return this.createNewSetSheetPropertiesMutation({frozenRowCount:o});case yi.OLD_SHEET_PROPERTIES_SLOT.SLOT_FROZEN_COLUMNS:return this.createNewSetSheetPropertiesMutation({frozenColCount:o});case yi.OLD_SHEET_PROPERTIES_SLOT.SLOT_HIDE_GRIDLINES:return this.createNewSetSheetPropertiesMutation({hideGridline:o});default:return n}},(0,s.Z)(t,[{key:"id",get:function(){return t.id}}]),t}(l.Z);xi.id=r.Z.COVER_SHEET_REQUEST;var bi,Di=xi,Oi=((bi={})[O.id]=O,bi[q.id]=q,bi[sn.id]=sn,bi[K.id]=K,bi[te.id]=te,bi[re.id]=re,bi[le.id]=le,bi[Ie.id]=Ie,bi[Ee.Z.id]=Ee.Z,bi[Ce.id]=Ce,bi[xn.id]=xn,bi[un.id]=un,bi[gn.id]=gn,bi[Ve.id]=Ve,bi[He.id]=He,bi[In.id]=In,bi[En.ZP.id]=En.ZP,bi[Mn.id]=Mn,bi[Hn.ZP.id]=Hn.ZP,bi[Xn.id]=Xn,bi[Bn.id]=Bn,bi[nr.id]=nr,bi[or.id]=or,bi[ce.Z.id]=ce.Z,bi[ar.id]=ar,bi[ur.id]=ur,bi[Sr.id]=Sr,bi[yr.id]=yr,bi[Tr.id]=Tr,bi[Or.id]=Or,bi[jr.id]=jr,bi[se.id]=se,bi[xt.id]=xt,bi[Ur.id]=Ur,bi[Br.id]=Br,bi[kr.id]=kr,bi[Vs.id]=Vs,bi[Pr.id]=Pr,bi[Gr.id]=Gr,bi[as.id]=as,bi[ds.id]=ds,bi[oo.id]=oo,bi[ao.id]=ao,bi[co.id]=co,bi[fo.id]=fo,bi[Bo.id]=Bo,bi[Go.id]=Go,bi[zo.id]=zo,bi[To.id]=To,bi[Ro.id]=Ro,bi[Do.id]=Do,bi[Mo.id]=Mo,bi[Lo.id]=Lo,bi[No.id]=No,bi[Ko.id]=Ko,bi[$o.id]=$o,bi[ns.id]=ns,bi[zr.id]=zr,bi[us.id]=us,bi[Nt.ZP.id]=Nt.ZP,bi[cs.id]=cs,bi[gs.id]=gs,bi[Is.id]=Is,bi[Ts.id]=Ts,bi[js.id]=js,bi[Us.id]=Us,bi[Hs.id]=Hs,bi[Ws.id]=Ws,bi[Qs.id]=Qs,bi[Xs.id]=Xs,bi[ei.id]=ei,bi[ri.id]=ri,bi[si.id]=si,bi[di.id]=di,bi[ci.id]=ci,bi[Ii.id]=Ii,bi[Si.id]=Si,bi[wi.id]=wi,bi[Ci.id]=Ci,bi[Di.id]=Di,bi);function Mi(e,t,n){if(!Oi[e])throw new Error("unknown request id");if(e===r.Z.MULTI_REQUEST)for(var o=0,s=t.requests.length;o<s;o++)t.requests[o]=Mi(t.requests[o].requestId,t.requests[o].opt,n);return new(0,Oi[e])(t,n)}},"../spread-sheet/src/core/behavior/utils.ts":function(e,t,n){"use strict";n.d(t,{IA:function(){return o},MN:function(){return s},m6:function(){return a},y2:function(){return i}});var r=n("../packages/model/src/range/SheetRangeType.ts");function o(e,t,n){for(var r=0;r<n.length;r++)if(!n[r].every((function(n,r){var o=e.getCellDataAtPosition(n,r);if(!o)return!0;var s=o.getConditionalFormatResult();return!s||!s.hasSlot(t)})))return!0;return!1}function s(e){return"number"===typeof e&&!isNaN(e)&&!(e<0)}function i(e,t){return s(e)&&s(t)}function a(e){var t=null===e||void 0===e?void 0:e.getSheetRangeReferences();return!!t&&t.some((function(e){return e.type===r.Z.COMMENT_RANGE}))}},"../spread-sheet/src/core/data/configService/spreadConfig.ts":function(e,t,n){"use strict";n.d(t,{q:function(){return u}}),n("../node_modules/core-js/modules/web.dom-collections.for-each.js"),n("../node_modules/core-js/modules/es.object.keys.js"),n("../node_modules/core-js/modules/es.array.includes.js"),n("../node_modules/core-js/modules/es.string.includes.js");var r=n("../node_modules/i18next/dist/esm/i18next.js"),o=n("../node_modules/lodash/set.js"),s=n.n(o),i={accountPrivs:"accountPrivs",maxRevisions:"accountPrivs.maxRevisions",advPolicy:"advPolicy",viewForbidCopyPrint:"advPolicy.view_forbid_copy_print",readerCanComment:"advPolicy.reader_can_comment",writerCanComment:"advPolicy.writer_can_comment",appInfoConfig:"appInfoConfig",clientIp:"clientIp",collabClientVars:"collab_client_vars",sid:"collab_client_vars.client.sid",upid:"collab_client_vars.client.upid",sig:"collab_client_vars.client.sig",tid:"collab_client_vars.client.tid",clientAgent:"collab_client_vars.clientAgent",dirty:"collab_client_vars.dirty",gray:"collab_client_vars.gray",dver:"collab_client_vars.dver",apid:"collab_client_vars.apid",websocket:"collab_client_vars.websocket",websocketReopenCount:"collab_client_vars.websocketReopenCount",pollingAttemptNumber:"collab_client_vars.pollingAttemptNumber",wmode:"collab_client_vars.wmode",ver:"collab_client_vars.ver",rev:"collab_client_vars.rev",pver:"collab_client_vars.pver",defaultSheetId:"collab_client_vars.padSubId",defaultData:"collab_client_vars.initialAttributedText.text",sheetList:"collab_client_vars.header[0].d",docType:"padType",createdTime:"createdDate",title:"padTitle",guestPolicy:"initialOptions.guestPolicy",ip:"clientIp",expire:"privilegeExpire",policyType:"policy",canAddUser:"privilegeAttribute.can_add_user",canRead:"privilegeAttribute.can_read",canApplyEdit:"privilegeAttribute.can_apply_edit",isAuth:"privilegeAttribute.is_auth",canEdit:"privilegeAttribute.can_edit",canLinkExp:"privilegeAttribute.can_link_exp",canWaterMark:"privilegeAttribute.can_watermark",canHistory:"privilegeAttribute.can_history",canCopyDoc:"privilegeAttribute.can_copy_doc",canTranslate:"privilegeAttribute.can_translate",canAbout:"privilegeAttribute.can_about",canCopy:"privilegeAttribute.can_copy",canComment:"privilegeAttribute.can_comment",canSearch:"privilegeAttribute.can_search",canEditTitle:"privilegeAttribute.can_edit_title",canShare:"privilegeAttribute.can_share",canSpitSlot:"privilegeAttribute.can_spit_slot",canViewImage:"privilegeAttribute.can_view_image",canPrint:"privilegeAttribute.can_print",canModifyAuth:"wecomAllowOperations.canModifyAuth",canModifyAuthSelfInvited:"wecomAllowOperations.canModifyAuthSelfInvited",canModifyAuthAny:"wecomAllowOperations.canModifyAuthAny",canDelete:"wecomAllowOperations.canDelete",canClone:"wecomAllowOperations.canClone",canExport:"wecomAllowOperations.canExport",canForward:"wecomAllowOperations.canForward",canSaveAsLink:"wecomAllowOperations.canSaveAsLink",canMove:"wecomAllowOperations.canMove",canSaveAsTemplate:"wecomAllowOperations.canSaveAsTemplate",canShowInWedrive:"wecomAllowOperations.canShowInWedrive",appFlag:"userInfo.app_flag",avatar:"userInfo.avatar",corpId:"userInfo.corp_id",corpName:"userInfo.corp_name",email:"userInfo.db_email",domain:"userInfo.domain",expired:"userInfo.expired",login:"userInfo.login",isLogin:"isLogin",loginTime:"userInfo.login_time",loginType:"userInfo.login_type",nick:"userInfo.nick",qqAvatar:"userInfo.qq_avatar",qqNick:"userInfo.qq_nick",relative:"relative",thirdAppid:"userInfo.third_appid",thirdSource:"userInfo.third_source",thirdUid:"userInfo.third_uid",tinyid:"userInfo.tinyid",toid:"userInfo.toid",uid:"userInfo.uid",uidSource:"userInfo.uid_source",uin:"userInfo.uin",workId:"userInfo.work_id",wxAvatar:"userInfo.wx_avatar",wxNick:"userInfo.wx_nick",isGrayed:"userInfo.is_grayed",wxOpenid:"userInfp.wx_openid",userIsGuest:"userIdGuset",userLink:"userLink",userName:"userName",userPic:"userPic",userType:"userType",isVip:"vipInfo.isVip",oldVip:"vipInfo.oldVip",templateType:"templateInfo.templateType",templateId:"templateInfo.templateId",tenantId:"docInfo.tenantId",ownerIsMigrate:"docInfo.ownerIsMigrate",ownerCorpName:"docInfo.owner_corp_name",useByExternal:"use_by_external"},a={padType:"sheet",isProPad:!0,shortLink:"",docStatus:0,advPolicy:{},lastModifyUser:"",uin:"",isEmbed:!1,invitedGroupInfos:[],newOpenSvc:-1,nameGuess:null,colorPalette:[],userId:"",domainId:"",useFbChat:!1,localPadId:"",userName:"",disableFB:!1,relativeUrl:null,newPad:!1,collab_client_vars:{apid:{},apool:{},bad:-1,client:{upid:"",sid:"",sig:"",tid:0},dirty:-1,dver:"2.0.0",globalPadId:"",gray:-1,header:[{id:"BB08J2",name:r.ZP.t("工作表")}],initialAttributedText:{text:[],attribs:""},padId:"",padSubId:"",padType:"",pollingAttemptNumber:-1,pos:-1,pver:-1,rev:-1,ver:-1,websocket:!1,websocketReopenCount:-1,wmode:"",clientAgent:""},createdDate:15489504e5,padTitle:"",isUserChangeTitle:-1,initialOptions:{guestPolicy:""},globalPadId:"",titleIsReadOnly:!1,isSnapshot:!1,relative:null,envi:null,userColor:-1,isOwner:!1,policy:-1,friendUserIds:[],clientIp:"",appInfoConfig:null,userIsGuest:!1,ownerId:"",proTitle:"",userDomain:"",specialKey:null,isTimDomain:!1,isOverConNum:!1,shouldGetFbLoginStatus:!1,initialSpaces:null,ownerAppid:"",accountPrivs:{maxRevisions:1e8},isPublicPad:!1,userInfo:{},padId:"",rightFlag:-1,isPadAdmin:!1,siteName:"",isLogin:!1,initialRevisionList:[],specialKeyTranslation:null,userPic:"",privilegeExpire:-1,privilegeAttribute:{can_edit:0,can_read:1},creatorId:"",userLoginCorpId:"",userLoginCorpName:"",initialTitle:"",creatorDomain:"",isOpendocxfromTim:!1,isCreator:!1,encrypted:"",userLink:"",metaCreateTime:15489504e5,dropboxConnected:!1,invitedUserInfos:[],tinyid:"",lastModifyTime:15489504e5,isTimOnline:!1,preview:"",oPadSubId:"",userType:"",uidKey:"",vipInfo:{},enableToCVipFeature:!1,templateInfo:{},newPadType:""},l=n("../node_modules/lodash/get.js"),d=n.n(l),u=new(function(){function e(e){this.needCacheList=["isOwner","ownerId","tinyid"],this.cache={},this.clientVars=e}var t=e.prototype;return t.getConfig=function(e){var t=this.getConfigByCache(e);if(t)return t.value;var n=i[e]||e,r=d()(this.clientVars,n);return this.cacheConfig(e,r),r},t.setConfig=function(e){var t=this;Object.keys(e).forEach((function(n){var r=i[n]||n,o=e[n];s()(t.clientVars,r,o),t.cacheConfig(n,o)}))},t.reloadConfig=function(e){this.clientVars=e,this.clearCache()},t.cacheConfig=function(e,t){this.needCacheList.includes(e)&&(this.cache[e]=t)},t.getConfigByCache=function(e){if(this.needCacheList.includes(e)&&e in this.cache)return{value:this.cache[e]}},t.clearCache=function(){this.cache={}},e}())(a)},"../spread-sheet/src/core/data/configService/spreadConfigUtil.ts":function(e,t,n){"use strict";n.d(t,{c:function(){return o}});var r=n("../spread-sheet/src/core/data/configService/spreadConfig.ts");function o(){return r.q.getConfig("metaCreateTime")===r.q.getConfig("lastModifyTime")}},"../spread-sheet/src/core/data/converter/keyframe/keyframe.ts":function(e,t,n){"use strict";function r(e){var t={keyframe:[],actions:[],lastKeyFrameActions:[],hasKeyFrame:!1};if(Array.isArray(e))t.actions=e;else try{t.actions=[JSON.parse(unescape(e))]}catch(n){}return t}n.d(t,{C:function(){return r}})},"../spread-sheet/src/core/data/converter/tencentdoc/handleKeyframe/keyframeOne.ts":function(e,t,n){"use strict";n.d(t,{T:function(){return l}}),n("../node_modules/core-js/modules/web.dom-collections.for-each.js"),n("../node_modules/core-js/modules/es.object.assign.js");var r=n("../packages/model/src/config/index.ts"),o=n("../packages/model/src/sheet/BaseSheet.ts"),s=n("../packages/model/src/dimension/DimensionProperties.ts"),i=n("../packages/model/src/utils/serializeUtils.ts"),a=n("../spread-sheet/src/core/data/configService/spreadConfig.ts");function l(e,t,n,l,d){if(t){var u;if(console.warn("当前keyframe版本为： "+d),d>=5)u=o.Z.deserialize(JSON.parse(t),{spreadsheet:e.spreadsheetReference,sheetId:e.getSheetId()});else{u=(0,i.deserialize)(JSON.parse(t),o.Z,{keyframeVer:d,sheetId:e.getSheetId()});var c=+new Date(2019,4,24);a.q.getConfig("createdTime")>=c||function(e){var t,n,o;for(t=0,n=e.data.rowMetadata.length;t<n;t++)!(o=e.data.rowMetadata[t])||o.pixelSize>=r.DEFAULT_ROW_HEIGHT||e.setRowProperties(t,s.Z.createInstance(Object.assign(Object.assign({},o),{pixelSize:void 0})))}(e)}e.customNumberFormatMap=u.customNumberFormatMap;var h=e.properties,f=h.index,p=h.title,g=h.sheetId;e.properties=u.properties,e.properties.sheetId=g,e.properties.title=p,e.properties.index=f,e.data=u.data,e.data.sheetReference=e,e.filterViewManager=u.filterViewManager,e.filterViewManager.sheetReference=e,e.filterViewManager.each((function(t){t.sheetId=e.getSheetId(),t.sheetReference=e})),e.mergeManager=u.mergeManager,e.mergeManager.sheetReference=e,e.setBasicFilter(u.getBasicFilterInSheet());var m=e.getAllBasicFilter();m.length&&m.forEach((function(t){return t.sheetReference=e})),e.imageManager=u.imageManager,e.imageManager.sheetReference=e,e.sheetRangeManager=u.sheetRangeManager,e.sheetRangeManager.sheetReference=e,e.mentionManager=u.mentionManager,e.mentionManager.sheetReference=e,e.hyperlinkManager=u.hyperlinkManager,e.conditionalFormatRuleManager=u.conditionalFormatRuleManager,e.conditionalFormatRuleManager.sheetReference=e}}},"../spread-sheet/src/core/data/converter/tencentdoc/keyframeToSheetConverter.ts":function(e,t,n){"use strict";n.d(t,{Z:function(){return l}});var r=n("../packages/report/src/index.ts"),o=n("../spread-sheet/src/base/config/report.ts"),s=n("../spread-sheet/src/core/data/converter/keyframe/keyframe.ts"),i=n("../spread-sheet/src/core/data/converter/tencentdoc/doMutation.ts"),a=n("../packages/mutation/src/other/InitDataMutation.ts");function l(e,t,l,d,u,c){var h,f,p;void 0===c&&(c={});var g=e.sheetManager.getSheetBySheetId(t);if(null===(h=n.g.log)||void 0===h||h.debug("flow k2sConverter start"),g){var m=c,v=m.beforeConvert,I=m.afterConvert;p=+new Date;var E=(0,s.C)(l);n.g.needOpenSpeedReport&&r.ZP.speed.runReport(o.SPEED_REPORT_POINTS.KEYFRAME_TRANSFORM,p,+new Date);var S=E.keyframe;"function"===typeof v&&v(g,S),p=+new Date,(0,i.zf)(e,E.actions,{sheetId:t,startRowIndex:d,endRowIndex:u}),E.actions.length&&g.correct(),n.g.needOpenSpeedReport&&r.ZP.tdwReport({opername:"quality_doc",module:"excel_detail",action:"first_screen_mutation_count",ver5:E.actions.length}),"function"===typeof I&&I(E);var R=new a.Z({sheetId:g.getSheetId(),lastRow:g.getRowCount()-1,lastCol:g.getColCount()-1});e.parent.mutationBehavior.applyMutation(R,{isLocal:!0},g)}return null===(f=n.g.log)||void 0===f||f.debug("flow k2sConverter end"),g}},"../spread-sheet/src/core/doc-info/index.ts":function(e,t,n){"use strict";n.d(t,{J:function(){return c}}),n("../node_modules/regenerator-runtime/runtime.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.promise.js");var r=n("./node_modules/axios/index.js"),o=n.n(r),s=n("../packages/utils/src/safe.ts"),i=n("../spread-sheet/src/core/data/configService/spreadConfig.ts"),a=n("../node_modules/qs/lib/index.js"),l=n.n(a),d="//"+n("../spread-sheet/src/base/util/appConfig.ts").Z.getConfig("runtime.domainName")+"/cgi-bin/online_docs/doc_info",u=function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function i(e){try{l(r.next(e))}catch(t){s(t)}}function a(e){try{l(r.throw(e))}catch(t){s(t)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,a)}l((r=r.apply(e,t||[])).next())}))};function c(e){var t;return u(this,void 0,void 0,regeneratorRuntime.mark((function r(){var a,u;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,new Promise((function(e,t){o().post(d,l().stringify({domainId:i.q.getConfig("domainId"),localPadId:i.q.getConfig("padId"),getCollected:1,getIsAddedMy:1,xsrf:(0,s.f)()})).then((function(t){var n=t.data;if(0===n.retcode)return e(n)})).catch((function(e){return t(e)}))}));case 3:a=r.sent,u={docType:a.doc_meta.doc_type,docUrl:a.doc_url,createTime:1e3*a.doc_meta.create_ts,createNick:a.creator_nick,ownerName:a.owner_nick,ownerCorpId:a.owner_corp_id,ownerCorpName:a.owner_corp_name,ownerAvatar:a.owner_avatar,ownerUidSource:a.owner_uid_source,isCollected:a.is_collected,isAddedMy:a.is_added_my,tenantId:a.doc_meta.tenant_id,ownerIsMigrate:a.doc_meta.wedrive_info.owner_is_migrate,lastModifyNick:a.last_modify_nick},null===e||void 0===e||e(u),r.next=12;break;case 8:r.prev=8,r.t0=r.catch(0),console.error(r.t0),null===(t=n.g.log)||void 0===t||t.error("[DocInfo] 获取DocInfo失败",r.t0);case 12:case"end":return r.stop()}}),r,null,[[0,8]])})))}},"../spread-sheet/src/core/feature/Feature.interface.ts":function(e,t,n){"use strict";n.d(t,{_:function(){return r}});var r=(0,n("../node_modules/@tencent/containerized/build/main/index.js").yh)("IFeature")},"../spread-sheet/src/core/feature/copyPaste/api/copyPasteAPI.common.ts":function(e,t,n){"use strict";n.d(t,{Bk:function(){return i.default},Cj:function(){return g},GI:function(){return s.GI},LC:function(){return c.LC},RP:function(){return S},St:function(){return u.S},Tl:function(){return u.T},d6:function(){return m},f2:function(){return C},lb:function(){return s.lb},qM:function(){return A},s5:function(){return p},zU:function(){return f}}),n("../node_modules/regenerator-runtime/runtime.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.promise.js");var r=n("../spread-sheet/src/core/feature/copyPaste/lib/DimemsionMemu/DimensionMenu.ts"),o=n("../packages/model/src/dimension/DimensionType.ts"),s=n("../spread-sheet/src/core/feature/copyPaste/interfaces.ts"),i=n("../spread-sheet/src/core/feature/copyPaste/copyPasteCache.ts"),a=n("../spread-sheet/src/core/view/level-1/select-center/base/utils.ts"),l=n("../spread-sheet/src/core/utils/selection.ts"),d=n("../spread-sheet/src/core/feature/relateFormEnt/enterpriseStatus.ts"),u=n("../spread-sheet/src/core/feature/copyPaste/core/copy-flow.ts"),c=n("../spread-sheet/src/core/feature/copyPaste/core/paste-flow.ts"),h=function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function i(e){try{l(r.next(e))}catch(t){s(t)}}function a(e){try{l(r.throw(e))}catch(t){s(t)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,a)}l((r=r.apply(e,t||[])).next())}))};function f(e,t){var n=t.copyType,r=t.previewActiveSheetId;return h(this,void 0,void 0,regeneratorRuntime.mark((function t(){var o;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.feature.getCopyPaste();case 2:return o=t.sent,t.abrupt("return",o.doCopy({copyType:n,previewActiveSheetId:r}));case 4:case"end":return t.stop()}}),t)})))}function p(e,t){var n=t.copyPasteCache,r=e.view.canvas,o=!(0,l.isSelectColoumn)(e)&&!(0,l.isSelectRow)(e),i=n.getCacheData(),a=n.getCacheState(),d=a.valid,u=d&&a.pasteType==s.lb.cut,c=function(e,t,n){return!e&&!t&&!(n&&1==n.isSingle&&0==n.isMerge)}(i&&a.select&&a.select.selectRow,i&&a.select&&a.select.selectCol,i);return{canPaste:d,inValid:o,isCut:u,notSingle:c,cacheState:a,isSelectPic:!!r.shapeEditCenter.shapeEdit.shapeId}}function g(e){return h(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.feature.getCopyPaste();case 2:return n=t.sent,t.abrupt("return",n.doRangeToImgCopy());case 4:case"end":return t.stop()}}),t)})))}function m(e,t){var n=t.cbSucc,i=t.cbFail;return h(this,void 0,void 0,regeneratorRuntime.mark((function t(){var l,d,u,c,h,f,p,g,m,v,I,E,S,R,w;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.feature.getCopyPaste();case 2:if(l=t.sent,d=l.copyPasteCache,1===(u=e.view.canvas).normalSelectData.selectQueue.length){t.next=7;break}return t.abrupt("return");case 7:if(c=e.spreadsheet.activeSheet,h=c.getSheetId(),f=d.getCacheData(),p=d.getCacheState(),g=u.normalSelectData.selectQueue[0],m=p.select,!g.selectRow){t.next=22;break}if(!m.selectCol){t.next=17;break}return i(),t.abrupt("return");case 17:v=(0,r.c2)({cacheState:p,currentSelect:{yRange:(0,a.TS)(u.rowcolAccessor,u.normalSelectData.selectQueue)[0],xRange:[0,0]},pasteData:f,activeSheetId:h,dimensionType:o.Z.ROWS}),I=v.pasteData,E=v.range,l.doImageTextPaste({type:s.GI.table,pasteData:I,selectAreaCellRange:E,pasteHtmlString:d.getCacheState().clipboardCopyData.html}),n(o.Z.ROWS),t.next=29;break;case 22:if(!g.selectCol){t.next=29;break}if(!m.selectRow){t.next=26;break}return i(),t.abrupt("return");case 26:S=(0,r.c2)({cacheState:p,currentSelect:{xRange:(0,a.rz)(u.rowcolAccessor,u.normalSelectData.selectQueue)[0],yRange:[0,0]},pasteData:f,activeSheetId:h,dimensionType:o.Z.COLUMNS}),R=S.pasteData,w=S.range,l.doImageTextPaste({type:s.GI.table,pasteData:R,selectAreaCellRange:w,pasteHtmlString:d.getCacheState().clipboardCopyData.html}),n(o.Z.COLUMNS);case 29:case"end":return t.stop()}}),t)})))}var v=function(e,t,n,i,l,d,u,c,h,f){if(t.selectRow&&n&&i){var p=(0,r.X4)({cacheState:l,currentSelect:{yRange:(0,a.TS)(d.tableView,d.normalSelectData.selectQueue)[0],xRange:[0,0]},pasteData:e,cutDataSheetId:i,activeSheetId:u,dimensionType:o.Z.ROWS,isSingle:!0}),g=p.pasteData,m=p.range;c.doImageTextPaste({type:s.GI.table,pasteData:g,selectAreaCellRange:m,pasteHtmlString:h.getCacheState().clipboardCopyData.html}),f(o.Z.ROWS)}else if(t.selectCol&&n&&i){var v=(0,r.X4)({cacheState:l,currentSelect:{xRange:(0,a.rz)(d.tableView,d.normalSelectData.selectQueue)[0],yRange:[0,0]},pasteData:e,cutDataSheetId:i,activeSheetId:u,dimensionType:o.Z.COLUMNS,isSingle:!0}),I=v.pasteData,E=v.range;c.doImageTextPaste({type:s.GI.table,pasteData:I,selectAreaCellRange:E,pasteHtmlString:h.getCacheState().clipboardCopyData.html}),f(o.Z.COLUMNS)}},I=function(e,t,n,i,l,d,u,c,h,f,p){if(e.yRange[0]>t.from.yRange[0]&&e.yRange[0]<=t.from.yRange[1])return!1;if(e.selectCol)return!1;if(e.selectRow&&i&&l){var g=(0,r.X4)({cacheState:t,currentSelect:{yRange:(0,a.TS)(d.tableView,d.normalSelectData.selectQueue)[0],xRange:[0,0]},pasteData:u,cutDataSheetId:l,activeSheetId:c,dimensionType:o.Z.ROWS,isSingle:!1}),m=g.pasteData,v=g.range;p.doImageTextPaste({type:s.GI.table,pasteData:m,selectAreaCellRange:v,pasteHtmlString:f.getCacheState().clipboardCopyData.html}),h(o.Z.ROWS)}return!0},E=function(e,t,n,i,l,d,u,c,h,f,p){if(e.xRange[0]>t.from.xRange[0]&&e.xRange[0]<=t.from.xRange[1])return!1;if(e.selectRow)return!1;if(e.selectCol&&i&&l){var g=(0,r.X4)({cacheState:t,currentSelect:{xRange:(0,a.rz)(d.tableView,d.normalSelectData.selectQueue)[0],yRange:[0,0]},pasteData:u,cutDataSheetId:l,activeSheetId:c,dimensionType:o.Z.COLUMNS,isSingle:!1}),m=g.pasteData,v=g.range;p.doImageTextPaste({type:s.GI.table,pasteData:m,selectAreaCellRange:v,pasteHtmlString:f.getCacheState().clipboardCopyData.html}),h(o.Z.COLUMNS)}return!0};function S(e,t){var n=t.cbSucc,r=t.cbFail;return h(this,void 0,void 0,regeneratorRuntime.mark((function t(){var o,i,a,l,d,u,c,h,f,p,g;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.feature.getCopyPaste();case 2:if(o=t.sent,i=o.copyPasteCache,1===(a=e.view.canvas).normalSelectData.selectQueue.length){t.next=7;break}return t.abrupt("return");case 7:if(l=e.spreadsheet.activeSheet,d=l.getSheetId(),u=i.getCacheState(),c=u.valid,h=i.getCacheData(),f=c&&u.pasteType==s.lb.cut,p=u.sheetId,g=a.normalSelectData.selectQueue[0],!h||1!=h.isSingle||0!=h.isMerge){t.next=19;break}v(h,g,f,p,u,a,d,o,i,n),t.next=30;break;case 19:if(!w(h,u,g)){t.next=24;break}if(I(g,u,0,f,p,a,h,d,n,i,o)){t.next=22;break}return t.abrupt("return",r());case 22:case 27:t.next=30;break;case 24:if(!R(h,u,g)){t.next=29;break}if(E(g,u,0,f,p,a,h,d,n,i,o)){t.next=27;break}return t.abrupt("return",r());case 29:return t.abrupt("return",r());case 30:case"end":return t.stop()}}),t)})))}var R=function(e,t,n){return e&&t.select.selectCol&&n.selectCol},w=function(e,t,n){return e&&t.select.selectRow&&n.selectRow};function A(){return(0,d.n_)()}var C=new function(){var e=this;this.isPermission=!1,this.isCanPasteFromClipboard=function(){return h(e,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.isPermission){e.next=2;break}return e.abrupt("return",this.isPermission);case 2:return e.next=4,this.checkPermission();case 4:return e.abrupt("return",this.isPermission);case 5:case"end":return e.stop()}}),e,this)})))},this.getIsPermission=function(){return e.isPermission||e.checkPermission(),e.isPermission},this.checkPermission=function(){return h(e,void 0,void 0,regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,window.navigator.clipboard.read();case 3:t=e.sent,this.isPermission=!!t,e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),this.isPermission=!1;case 10:case"end":return e.stop()}}),e,this,[[0,7]])})))}}},"../spread-sheet/src/core/feature/copyPaste/convertor/convertShapeData2IAddImage.ts":function(e,t,n){"use strict";n.d(t,{Ir:function(){return i},iS:function(){return s},zn:function(){return o}}),n("../node_modules/core-js/modules/es.string.anchor.js");var r=n("../packages/model/src/embedded/index.ts");function o(e,t){var n=e.id,o=e.size,s=o.width,i=o.height,a=e.offset,l=a.x,d=a.y,u=e.url,c=e.clipInfo,h=0,f=0,p=e.anchor;return p?(h=p.col,f=p.row):(h=0,f=0),{type:r.EMBEDDED_OBJECT_TYPE.IMAGE,id:n,url:u,width:s,height:i,sheetId:t,x:h,y:f,offsetX:l,offsetY:d,zIndex:0,clipInfo:c}}function s(e,t){var n=e.id,r=e.size,o=r.width,s=r.height,i=e.url,a=e.clipInfo,l=0,d=0,u=e.anchor;return u?(l=u.col,d=u.row):(l=0,d=0),{id:n,sheetId:t,url:i,width:o,height:s,x:l,y:d,clipInfo:a}}function i(e){var t=e.id,n=e.position.overlayPosition,r=n.offsetXpixels,o=n.offsetYpixels,s=n.widthPixels,i=n.heightPixels,a=e.url,l=e.clipInfo;return{id:t,url:a,offset:{x:r,y:o},size:{width:s,height:i},clipInfo:{clipBottom:l.clipBottom,clipLeft:l.clipLeft,clipRight:l.clipRight,clipTop:l.clipTop}}}},"../spread-sheet/src/core/feature/copyPaste/copyPasteCacheBase.ts":function(e,t,n){"use strict";n.d(t,{Z:function(){return s}});var r=n("../node_modules/@babel/runtime/helpers/esm/createClass.js"),o=(n("../node_modules/core-js/modules/es.array.iterator.js"),n("../node_modules/core-js/modules/es.map.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.string.iterator.js"),n("../node_modules/core-js/modules/esnext.map.delete-all.js"),n("../node_modules/core-js/modules/esnext.map.every.js"),n("../node_modules/core-js/modules/esnext.map.filter.js"),n("../node_modules/core-js/modules/esnext.map.find.js"),n("../node_modules/core-js/modules/esnext.map.find-key.js"),n("../node_modules/core-js/modules/esnext.map.includes.js"),n("../node_modules/core-js/modules/esnext.map.key-of.js"),n("../node_modules/core-js/modules/esnext.map.map-keys.js"),n("../node_modules/core-js/modules/esnext.map.map-values.js"),n("../node_modules/core-js/modules/esnext.map.merge.js"),n("../node_modules/core-js/modules/esnext.map.reduce.js"),n("../node_modules/core-js/modules/esnext.map.some.js"),n("../node_modules/core-js/modules/esnext.map.update.js"),n("../node_modules/core-js/modules/web.dom-collections.iterator.js"),n("../spread-sheet/src/core/feature/copyPaste/interfaces.ts")),s=function(){function e(e){this.shapeData=[],this.mappingTypeWithOutMergeAndUnMerge=!1,this.isChangeRow=!1,this.isChangeCol=!1,this.spreadsheetApp=e.spreadsheetApp,this.config=e.config,this.cacheData={isSingle:!1,isMerge:!1,formula:[[]],merge:[[]],rowDataUpdate:[{values:[]}],fromType:o.gN.COPY_CACHE,fromApp:o.o_.tencent,select:{selectAll:!1,selectCol:!1,selectRow:!1},containTable:!0},this.cacheState={copyHTMLType:o.GI.table,sheetId:"string",pasteType:o.lb.copy,valid:!1,select:{selectAll:!1,selectRow:!1,selectCol:!1},copyRangeIsChange:!1,from:{xRange:[0,0],yRange:[0,0]},clipboardCopyData:{html:"",plain:"",timeStamp:""},cellImageCache:new Map}}return(0,r.Z)(e,[{key:"activeSheet",get:function(){return this.spreadsheetApp.spreadsheet.activeSheet}}]),e}()},"../spread-sheet/src/core/feature/copyPaste/core/getCopyTextHTML.ts":function(e,t,n){"use strict";n.d(t,{UF:function(){return b},YX:function(){return w}}),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.regexp.to-string.js"),n("../node_modules/core-js/modules/es.array.iterator.js"),n("../node_modules/core-js/modules/es.map.js"),n("../node_modules/core-js/modules/es.string.iterator.js"),n("../node_modules/core-js/modules/esnext.map.delete-all.js"),n("../node_modules/core-js/modules/esnext.map.every.js"),n("../node_modules/core-js/modules/esnext.map.filter.js"),n("../node_modules/core-js/modules/esnext.map.find.js"),n("../node_modules/core-js/modules/esnext.map.find-key.js"),n("../node_modules/core-js/modules/esnext.map.includes.js"),n("../node_modules/core-js/modules/esnext.map.key-of.js"),n("../node_modules/core-js/modules/esnext.map.map-keys.js"),n("../node_modules/core-js/modules/esnext.map.map-values.js"),n("../node_modules/core-js/modules/esnext.map.merge.js"),n("../node_modules/core-js/modules/esnext.map.reduce.js"),n("../node_modules/core-js/modules/esnext.map.some.js"),n("../node_modules/core-js/modules/esnext.map.update.js"),n("../node_modules/core-js/modules/web.dom-collections.iterator.js"),n("../node_modules/core-js/modules/es.array.join.js"),n("../node_modules/core-js/modules/es.regexp.exec.js"),n("../node_modules/core-js/modules/es.string.replace.js"),n("../node_modules/core-js/modules/web.dom-collections.for-each.js"),n("../node_modules/core-js/modules/es.object.keys.js"),n("../node_modules/core-js/modules/es.array.map.js"),n("../node_modules/core-js/modules/es.string.split.js"),n("../node_modules/core-js/modules/es.string.search.js");var r=n("../spread-sheet/src/core/feature/copyPaste/interfaces.ts"),o=n("../packages/model/src/range/gridRangeUtils.ts"),s=n("../node_modules/@tencent/docs-user-agent/dist/index.js"),i=n.n(s),a=n("../spread-sheet/src/base/util/url.ts"),l=n("../packages/common-utils/src/index.ts"),d=n("../spread-sheet/src/core/feature/copyPaste/util.ts"),u=n("../packages/model/src/config/index.ts"),c=n("../spread-sheet/src/core/feature/copyPaste/utils/cellFloatImage.ts"),h=n("../spread-sheet/src/core/feature/copyPaste/utils/cellMergeReference.ts"),f=n("../spread-sheet/src/core/feature/copyPaste/utils/mergeRangeUtils.ts"),p=n("../spread-sheet/src/core/feature/copyPaste/middleware/index.ts"),g=n("../spread-sheet/src/core/feature/copyPaste/middleware/interface.ts"),m=n("../node_modules/@tencent/tdocs-format-render/lib/index.js"),v=n("../packages/model/src/cell/metadata/CustomDataType.ts"),I=n("../spread-sheet/src/core/app/sheetStatus/private-range.ts"),E=(n("../spread-sheet/src/base/util/domain-config.ts"),n("../node_modules/qs/lib/index.js"),n("../spread-sheet/src/core/app/sheetStatus/auth-range.ts")),S=n("../spread-sheet/src/core/data/configService/spreadConfig.ts"),R=n("../packages/model/src/cell/index.ts");function w(e){var t=e.spreadsheetApp,n=e.copyType,s=e.range,a=e.select,l=t.spreadsheet.activeSheet,m=t.view,v=(new Date).getTime().toString();if(!l)return{timeStamp:v,html:"",plain:"",imageCache:new Map};var R=l.data.rowData,w=l.getBasicFilter(),y=w?w.getHiddenRowMap():new Map,b=(0,o.convertXYRangeToGridRange)(s,l.getSheetId()),D=function(e,t,n,s,a,l){var m=e.xRange,v=e.yRange,R=t.data,w=R.rowData,A=s.selectRow?t.data.rowMetadata:[],C=s.selectCol?t.data.colMetadata:[],y=(0,o.convertXYRangeToGridRange)(e,"sheetId"),b=function(e,t,n,r,o){var s=(0,d.r$)(e.rowData,t.xRange[0],t.yRange[0],t.xRange[1],t.yRange[1]),i=s.maxY,a=s.maxX,l=i,u=r[0],h=(0,c.Px)({range:t,sheet:n,rowCount:r.length,colCount:u?u.values.length:0,view:o});return Object.keys(h).forEach((function(e){var t=e.split("_").map((function(e){return parseInt(e,10)})),n=t[0],r=t[1];r>a&&(a=r),n>l&&(l=n)})),{xEnd:a,yEnd:l,selectedImages:h}}(R,e,t,w,l),D=b.xEnd,O=b.yEnd,M=b.selectedImages,j=m[0],L=v[0],Z={isOwner:S.q.getConfig("isOwner"),ownerId:S.q.getConfig("ownerId"),tinyid:S.q.getConfig("tinyid")},k="";k+=function(e,t,n,o){var s='<table style="border-collapse:collapse" selectType="'+function(e){return e.selectAll?r.lr.all:e.selectRow?r.lr.row:e.selectCol?r.lr.col:r.lr.cells}(e)+'">',i=function(e,t,n){for(var r,o="",s=e;s<=t;s++){var i=n[s],a=null!==(r=null===i||void 0===i?void 0:i.pixelSize)&&void 0!==r?r:u.DEFAULT_COL_WIDTH;o+="<col "+(i&&i.hiddenByUser?' hiddenCol="hiddenCol" ':"")+" "+((null===i||void 0===i?void 0:i.columnTypeMetadata)?"columnTypeMetadata="+JSON.stringify(i.columnTypeMetadata.serialize()):"")+' width="'+a+'" style="width: '+a+'px;">'}return o}(t,n,o.colMetadata);return s+i}(s,j,D,R);for(var N=L;N<=O;N++)if(!n.get(N)){var P=x(j,D,R.colMetadata.length,N,R.rowMetadata);k+="<tr "+T(N,R.rowMetadata)+P+">";for(var U=j;U<=D;U++){var F=t.getCellDataAtPosition(N,U);((0,I.xy)(t.spreadsheetReference,N,U,t,Z)||(0,E.tE)(t.spreadsheetReference.parent,N,U))&&(F=null);var V=(0,h.G)({cellData:F,hiddenRowMap:n,copyRange:y,x:U,y:N,rowData:w,copyType:a}),B=V.newX,H=V.newY,G=V.newCellData,W=V.mergeReference;if(F=G,!(0,f.Ft)(F,H,B)||W){var z={newY:H,newX:B,pasteType:a,mergeReference:W,hideRowMap:A,hideColMap:C,selectedImages:M,xStart:j,yStart:L};k+="<td "+p.Z.run(g.aC.COPY_ON_CELL_ATTR,"copyToHtml",{activeSheet:t,cellData:F,ext:z})+">",k+=p.Z.run(g.aC.COPY_ON_CELL_VALUE,"getCellValue",{activeSheet:t,cellData:F,ext:z}),k+="</td>"}}k+="</tr>"}var Q=p.Z.run(g.aC.COPY_ON_TABLE_END,"getTableEndStr",{selectedImages:M});return k+=Q,function(e){var t="";return t+='<html xmlns:x="tencent"><meta charset="utf-8"><style type=\'text/css\'>'+function(){if(i().isMobilePhone||i().isAndroidPad)return"";var e=_("td"),t=_("table"),n=_("font"),r="";return(e||t)&&(r="\x3c!-- td { "+e+" } table { "+t+" } font{ "+n+" }--\x3e"),r}()+"</style>",t+="<body>\x3c!--StartFragment--\x3e",t+=e,t+="\x3c!--EndFragment--\x3e</body></html>"}(k+="</table>")}(s,l,y,a,n,m);return{timeStamp:v,html:D,plain:C(t.spreadsheet,b,R,y),imageCache:A(b,l,R,y)}}function A(e,t,n,r){var o=new Map;return e.each((function(e,s){var i,a,l;if(!r.get(e)){var d=null===(i=n[e])||void 0===i?void 0:i.values[s];if((null===(a=null===d||void 0===d?void 0:d.getMetadata())||void 0===a?void 0:a.customDataType)===v.ZP.IMAGE){var u=null===(l=null===d||void 0===d?void 0:d.getRefIds())||void 0===l?void 0:l[0],c=u&&t.imageManager.getImage(u);o.set(u,c)}}})),o}function C(e,t,n,r){for(var o=t.startColIndex,s=t.endColIndex,a=t.startRowIndex,l=t.endRowIndex,d="",u=a;u<=l;u++)if(!r.get(u)){for(var c=[],h=o;h<=s;h++){var f=n[u]?n[u].values[h]:null;((0,I.xy)(e,u,h)||(0,E.tE)(e.parent,u,h))&&(f=null);var p=y(f);c.push(p)}d+=c.join("\t"),u!==l&&(i().isWindows?d+="\r\n":d+="\n")}return d}function y(e){var t,n,r=null===e||void 0===e?void 0:e.getCellType();return(n=r===v.ZP.STAFF_CARD||r===v.ZP.GROUP_CARD||r===v.ZP.SCHEDULE?"[不支持的媒体类型]":(null===(t=null===e||void 0===e?void 0:e.getFormattedValue())||void 0===t?void 0:t.value)||"")===m.INVALID_VALUE&&(n=(n=(null===e||void 0===e?void 0:e.getEditValue())||"").replace(/\ufeff/g,"").replace(/</g,"&lt;").replace(/>/g,"&gt;")),n}function _(e){switch(e){case"td":return"empty-cells:show;line-height:normal;color:#000;vertical-align:middle;outline-width:0;word-wrap:break-word;word-break:normal;white-space:nowrap; text-align:left;font-size:10pt;";case"table":return"border-collapse: collapse;";case"font":return"white-space: pre-wrap";default:return""}}function T(e,t){var n=t[e],r=n?n.pixelSize:null,o=!!r;return' height="'+(r=r||u.DEFAULT_ROW_HEIGHT)+'" style="mso-height-source:'+(o?"userset":"auto")+";height:"+r+'px;"'}function x(e,t,n,r,o){var s="";if(function(e,t,n){return 0===e&&t-e+1>=n}(e,t,n)&&o&&o[r]){var i=o[r];(null===i||void 0===i?void 0:i.hiddenByUser)&&(s=' hiddenRow="hiddenRow" ')}return s}function b(e){var t,n=null===e||void 0===e?void 0:e.getHyperlink(),r=null===e||void 0===e?void 0:e.getHyperlinkRuns(),o=null===e||void 0===e?void 0:e.getHyperlinkType(),s=null===e||void 0===e?void 0:e.getLinkIconStatus(),i=!(!n||!(0,a.lS)(n));if(!n&&(!r||0===r.length))return null;r?t=r[0].linkUrl:n&&(t=""+(i?n:(0,a.Kc)(n,!0)));var d=r?'data-sheets-hyperlinkruns="'+(0,l.r)(JSON.stringify(r))+'"':"",u={hyperlinkType:o,linkIconStatus:s,fullLinkUrl:void 0},c='data-sheets-hyperlink="'+(0,l.r)(JSON.stringify(u))+'"',h=function(e,t){var n=null===e||void 0===e?void 0:e.getHyperlinkRuns(),r=null===e||void 0===e?void 0:e.getHyperlinkType();return n||r===R.HYPERLINK_TYPE.SHEET_LINK?""+location.origin+location.pathname:t}(e,t);return"<a "+c+" "+d+' href="'+h+'" data-sheet-href="'+t+'" title="" style="cursor: default;color: blue; text-decoration: underline;pointer-events: auto" >'}},"../spread-sheet/src/core/feature/copyPaste/core/subscribe-mutation.ts":function(e,t,n){"use strict";n.d(t,{a:function(){return i}});var r=n("../packages/mutation/src/MutationId.ts"),o=n("../node_modules/lodash/cloneDeep.js"),s=n.n(o),i=function(e,t){var n,o=s()(t);switch(e.mutation.id){case r.ZP.INSERT_DIMENSION_MUTATION:return n=e.mutation,d(n,o);case r.ZP.DELETE_DIMENSION_MUTATION:return n=e.mutation,u(n,o);case r.ZP.SET_RANGE_MUTATION:return n=e.mutation,a(n,o);case r.ZP.SET_CELL_PROPERTIES_MUTATION:return n=e.mutation,l(n,o);default:return o}},a=function(e,t){var n=t.cutRange,r=t.copyRange;return f(n,e.gridRange)&&p(t,"setRangeMutation"),f(r,e.gridRange)&&g(t),t},l=function(e,t){var n=t.cutRange,r=t.copyRange;return f(n,e.gridRange)&&p(t,"setCellProperties"),f(r,e.gridRange)&&g(t),t},d=function(e,t){var n=t.cutRange,r=t.copyRange;return h(n,e)&&p(t,"insertDimension"),h(r,e)&&g(t),t},u=function(e,t){var n=t.cutRange,r=t.copyRange;return c(n,e)&&p(t,"deleteDimension"),c(r,e)&&g(t),t},c=function(e,t){return!!e&&e.clone().deleteDimension(t)},h=function(e,t){return!!e&&e.clone().insertDimension(t)},f=function(e,t){return!!e&&e.clone().isCross(t)},p=function(e,t){e.valid=!1,n.g.log.log("cut operation fail because of "+t)},g=function(e){e.copyRangeIsChange=!0}},"../spread-sheet/src/core/feature/copyPaste/iconSource.tsx":function(e,t,n){"use strict";n.d(t,{Z:function(){return r}}),n("../node_modules/core-js/modules/es.object.keys.js");var r=function(){function e(){this.iconSrc={spinner:"data:image/gif;base64,R0lGODlhEAAQAKUAAAQCBHR2dKyurERCRMzKzJSSlGRiZNza3CQmJLy+vKSipISGhFRSVNTS1HRydDQyNLS2tJyenGxqbOTi5MTGxKyqrIyOjDw6PAwKDISChLSytERGRMzOzJSWlGRmZNze3MTCxKSmpIyKjFRWVNTW1DQ2NOLi4gAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACH/C05FVFNDQVBFMi4wAwEAAAAh+QQJCgAmACwAAAAAEAAQAAAGpUCT0HQQjjbC4nAYeoRMF4QJBJAshYnH4FCSDgCL4SREMDkei6gCgPhM3ITBZkG5eCKdACA0OXw+JiEMGyMNgCYTBB9+bkkiGVcmfxNCGR4eEgKRfYsfAQagFZF/jEIfGhGHYo1CFAsOAQ2UpgelHw4OBQQWFRwgDQl+fpQQICYCIhoQIcAUE2+zJg0WBachBwQgJJEgIgkmy7UJHJEm21MClKwmQQAh+QQJCgAqACwAAAAAEAAQAIUEAgR0dnSsrqxEQkTMysyUkpRcWlwcHhyEhoTc2ty8vrxMTkykoqRkZmR8fnzU0tQ0NjQMDgy0trRkYmQkJiSMjozk4uTExsRUVlSsqqwEBgR8enxERkTMzsycmpxcXlwkIiSMiozc3tzEwsRUUlSkpqRsamyEgoTU1tS8urzi4uIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAGpECVUJUQTkhC1HAp4AhUHIjqQtkshSOOIRFVGQ6FoUVAUJ0GhWjmMBB1ECiC4VO4LAIlDwKU2UQAFSoCDQYmKCJCFh0cABomRUQFgVcbJCNCBQ6aKVcqIgmfIiEBGwESnRagoEIiChmISyIiFkMEHiEVKLSJoYiiIQwdGSkoD58WobQjFyojJcsjqsjIQyglrwQKsrKdHSVlFyOzq52QHRe0s0NBACH5BAkKACkALAAAAAAQABAAhQwKDHx6fLSytERGRMzOzJyanCQmJGRiZIyKjMTCxNza3BQWFKSmpDQyNFxaXHRydISChLy+vExOTNTW1KSipGxqbJSSlMzKzOTi5BweHDw6PAwODHx+fLS2tExKTNTS1JyenCwqLGRmZIyOjMTGxNze3BwaHKyurDQ2NOLi4gAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAajwJQwpRA+DsLicNhxdFKOQYqk4SyFF4eoFE2JGoUhpkNIjRwgh+fU8JQ+lgnh8aAQDpATZdQ4IUIZYR0BDxwTJUIYBA4ZBgFKCgwgVykIIhdCFBabCZQICyYLAyAjpRGUEACqKIkXEYhLJSUYQx8nDAwKtIklCrIpJbgdEwkXGLK+yLQXHykECQS9srPHu8AJCdPHupQTERPAuhi+lMCJ5BjWQQAh+QQJCgAtACwAAAAAEAAQAIUEAgR0dnSsrqxERkSUkpTMysxcXlwkIiSEhoS8vrykoqTc2txsamw0MjR8fny0trRUUlScmpzU0tRkZmSMjozExsSsqqzk4uR0cnQ8OjwUEhR8eny0srRMSkyUlpTMzsxkYmQsKiyMiozEwsSkpqTc3txsbmw0NjSEgoS8urxcWlycnpzU1tTi4uIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAGo8CWsFUSojDCxXCZwCRaDEOr0KEshQWMoxRtYQaK4SXBakUwluhjYLhIPAuWSCSQBDwcQWTwIGQaKy0JBCJwRUQSEw0nKIclHBZXLRQYFUIPFpkFkh4nDQ0qHCSjm1cUIQchEEIXLB8XVyYmZUkVCSMlsEIlBwAaIkQjCQULJbnGJRIGAAAkLSxKJcXSF9MpAYdE1NsLukvVRcYXyJItutTm2UEAIfkECQoAKwAsAAAAABAAEACFBAIEdHZ0tLK0PD48lJKUzM7MXFpchIaExMLEpKKkJCIk3NrcTEpMdHJ0fH58vLq8nJqcZGJkHB4cREZE1NbUjI6MzMrMrKqsPDo85OLkBAYEfHp8tLa0REJElJaU1NLUXF5cjIqMxMbEpKakLC4s3N7cTE5MhIKEvL68nJ6cZGZk4uLiAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABqPAlXBVEhIOwuJwKAqJVqfAqgCCLIWfEKHkkJ4Ml2HGQlldQpzow9AoURIUymiEolRGD07CwEmZJmEWFyMXC0oZFAETDBULSQgPVysQDhZCFgiZZVcpHZ4qIggoCJtLHhioBkIZJSUZV1GlrSULGa9CFAMKJB4rrIYZwFwaCQ0SCgJEr7O0EAAkJQgHjqsLtbQlGAAhkrNErhwaEZK+SbVTSitBACH5BAkKACkALAAAAAAQABAAhQQCBHR2dKyurDw+PJSSlFxaXMzOzKSipGxqbISGhNza3CQiJLy+vExOTJyanGRiZISChNTW1KyqrHRydIyOjOTi5DQyNMTGxFRWVBweHHx6fLS2tERGRJSWlFxeXNTS1KSmpGxubIyKjNze3MTCxFRSVJyenGRmZDw6POLi4gAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAaiwJQwNRIeHMLicGgAGVIdSuoTAC2FEZCkQpASJpthJaJIMQ6kKGmSGEUkihGDZFCANheSJEQCPQoCKREkcyMVQmMJBR4OSiMfT1cHIpEjIwpxVykgGJ0Bl5ZKSwcNpQiIlodLIhBlSaAVqoINFgMmKRWwcSYIIgsgGhYWYYZEcSgAFBkcIyQUrrhxFRYABiUZSFegKcgGDAsTmrhCJwtlBqJBACH5BAkKACsALAAAAAAQABAAhQQCBHR2dKyurDw+PJSSlMzKzFxeXISGhLy+vKSipNza3BweHExOTGxqbHx+fLS2tJyanNTS1GRmZIyOjMTGxKyqrOTi5DQyNFRWVBQWFHx6fLSytERGRJSWlMzOzGRiZIyKjMTCxKSmpNze3FRSVHRydISChLy6vJyenNTW1DQ2NOLi4gAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAalwJVwZRE+NsLRcJkKpVYV0SoyQS5XCgTFEl0lQIihZVT0ICICUQHUsaQeirFiNAoV7g9QQaApPVZ0c2RJCh0lASJKRINXFRARhCNzVysCEg0SJpKblBUfBh8OQmOMQwQTCkN0kpNCCgYcJFJyIxEZDCIaBBcCBxwcJ4BFBgASJAsdFxgWFBCKKycAGSnHEQYXEJQEACArDAseIReilAVCGgOpEc9BACH5BAkKAC0ALAAAAAAQABAAhQQCBHR2dKyurERCRJSSlMzKzFxeXISGhLy+vKSipNza3BweHFRWVGxubHx+fLS2tExKTJyanNTS1DQyNGRmZIyOjMTGxKyqrOTi5CQmJAQGBHx6fLSytERGRJSWlMzOzGRiZIyKjMTCxKSmpNze3CQiJFxaXHRydISChLy6vExOTJyenNTW1OLi4gAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAamwJawhREWLELScEkiFUWiFuuCWAoxiqYl+hgVhhhni5TdfkYcMsJJZpNYEstIkqqEos0spkhUJEIVaVdNVi0pIyxJWVmFDygODgRtjFYcARsBFUkoDApWKxGeQhcZABoWSkIKDSYUAi0KAAADAhMgFwcREBwEBiZRISstJwsbJhMrHRQkBQmpLSIlEywGEx8NHReFKwseLdUfFhAHhS0fQigQShLPQQAh+QQJCgAqACwAAAAAEAAQAIUMCgx8eny0srREQkTMzsyUlpRcXlwkIiTEwsSMiozc2tykpqQUFhRsbmy8urxUVlSEgoTU1tScnpw0MjTMysyUkpTk4uSsrqwcHhx0dnQMDgx8fny0trRERkTU0tRsamwkJiTExsSMjozc3tysqqwcGhx0cnS8vrxcWlykoqTi4uIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAGpECVUGURjkbC4nB4LCqQCgRhmXwekZRTZGgZFUdWheIU6lK8YDTac1KEFguK6vjsJkecBQmBJB6pKhQOWyoDDAwlIoAIFY0LEwAAGgmADiKXKUYiHwpUJAudQgIDGCBnQwoQJgEcKgoYGCgcAx8CIgsGDhIZJiEqBRcqARMbDR0kKBkjBBd9KggTAxENAx4BKMFUjxIqHx0eIQYFgCpTKgkGUM5BACH5BAkKACsALAAAAAAQABAAhQQCBHR2dKyurERGRMzKzJSSlGRiZLy+vNza3KSipCwqLISGhFRSVLS2tNTS1JyanGxubBQSFHx+fExOTMTGxOTi5KyqrDQyNIyOjFxaXHx6fLSytExKTMzOzJSWlGRmZMTCxNze3KSmpIyKjFRWVLy6vNTW1JyenHRydBwaHDQ2NOLi4gAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAaiwJVwVRGGQsLicHgsIpCV5zL5PCJD0uTosMIeEdFQJWSqHACAjKNpDTlAB9NqEQGkxMkK4QBaC00fJFMrDh1IKyQXig+DBBaPDRwKkx6DFCIiFg1GHgEIUw0NhysNExcqBKMhDyMFXAiKBiUMGg0PAgEgAiMjHSsnAnMDGBIZGygLFR0loxQcDAgaGSYYKJtTFgMiK9ImHSgJg4RCHhBIWStBACH5BAkKACsALAAAAAAQABAAhQQCBHx6fLSytERCRMzOzJSWlFxeXCQiJMTCxKSmpNza3IyKjFRWVGxqbBwaHLy6vJyenDQ2NExKTNTW1GRmZMzKzKyurOTi5JSSlAwODISChLS2tERGRNTS1JyanGRiZCwuLMTGxKyqrNze3IyOjFxaXHRydBweHLy+vKSipDw6POLi4gAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAahwJVwNRGORsLLcOkBFFYjxepyXAo3AMekGkUmC4gVA9A4XhSjC/WCOB1MqAyHGqWjVwXQKUKQTqloaUITAQ1WUIIrHwOMKYcdCJEVDCoRKh6PKAgoFUYQGl5DIQihDx8cEgShIxYJIp0KHBxwFAsoCQ8kFbcJHSsJGysYJR4kJg8LHhcTIUpCFQYUCsYTKbaHAiUWK9QdJNuHRb+gKwrOK0EAIfkECQoAKgAsAAAAABAAEACFBAYEfHp8tLK0PD48zM7MlJaUXFpcJCIkxMLEpKak3NrcjIqMbGpsLC4svLq8TE5MnJ6cHB4chIKE1NbUZGZkzMrMrK6s5OLkNDY0DAoMfH58tLa0REJE1NLUnJqcXF5cLCosxMbErKqs3N7cjI6MdHJ0NDI0vL68VFZUpKKk4uLiAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABp5AlVClEA4awstwmYqkVBGA6jIaLYWng0kRVY0U1iQEoaJENJHMBXyhXkImUyAEMhQWX+rX6jlyOkVeVGAjSioTEiVXXoVCJSiQIotVhBQPl09Xa3tJIiRhQx0Ehionjx8doBcIrBNeBgYSCBoFIQIhCaInCK4WDioQJQkpC7gCa6lDBCUaChALCgIpFYumGyrEExMJZIuuKgIFSgqkQQA7"},this.iconsList={},this.init(this.iconSrc,this.iconsList)}return e.prototype.init=function(e,t){for(var n=Object.keys(e),r=0;r<n.length;r++){var o=n[r],s=e[o];t[o]=s}},e}()},"../spread-sheet/src/core/feature/copyPaste/lib/PasteSpecial/logics/pasteTypes.ts":function(e,t,n){"use strict";n.d(t,{Is:function(){return i},RY:function(){return s},UU:function(){return l},bX:function(){return r},jK:function(){return o},qn:function(){return d},yc:function(){return a}});var r,o="keepDefault",s="mergeStyles",i="onlyValues",a="clearAutoParse",l="transpose",d="smartSplit";!function(e){e.KEEPDEFAULT="keepDefault",e.MERGESTYLES="mergeStyles",e.ONLYVALUES="onlyValues",e.CLEARAUTOPARSE="clearAutoParse",e.TRANSPOSE="transpose",e.SMARTSPLIT="smartSplit",e.TRANS_TO_CELL_PIC="transToCellPic",e.TRANS_TO_FLOAT_PIC="transToFloatPic"}(r||(r={}))},"../spread-sheet/src/core/feature/copyPaste/lib/clipboard.min.js":function(e,t,n){"use strict";n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.promise.js");var r={};if("undefined"!==typeof document&&document.addEventListener){r={copy:function(){throw Error("Unable to copy. Perhaps it's not available in your browser?")},paste:function(){throw Error("Unable to paste. Perhaps it's not available in your browser?")}};try{r.copy=function(){function e(){t=!1,n=null,r&&window.getSelection().removeAllRanges(),r=!1}var t=!1,n=null,r=!1,o=!1;return function(s){return o||(document.addEventListener("copy",(function(e){if(t){for(var r in n)try{e.clipboardData.setData(r,n[r])}catch(r){console.error(r)}e.preventDefault()}})),o=!0),new Promise((function(o,i){t=!0,n="string"===typeof s?{"text/plain":s}:s instanceof Node?{"text/html":(new XMLSerializer).serializeToString(s)}:s;try{var a=document.getSelection();if(!document.queryCommandEnabled("copy")&&a.isCollapsed){var l=document.createRange();l.selectNodeContents(document.body),a.addRange(l),r=!0}if(!document.execCommand("copy"))throw Error("Unable to copy. Perhaps it's not available in your browser?");e(),o()}catch(d){e(),i(d)}}))}}(),r.paste=function(){var e,t,n=!1,r=!1;return function(o){return r||(document.addEventListener("paste",(function(r){if(n){n=!1,r.preventDefault();var o=e;e=null,o(r.clipboardData.getData(t))}})),r=!0),new Promise((function(r,s){n=!0,e=r,t=o||"text/plain";try{document.execCommand("paste")||(n=!1,s(Error("Unable to paste. Pasting only works in Internet Explorer at the moment.")))}catch(i){n=!1,s(Error(i))}}))}}(),"undefined"===typeof ClipboardEvent&&"undefined"!==typeof window.clipboardData&&"undefined"!==typeof window.clipboardData.setData&&(r.copy=function(e){return new Promise((function(t,n){if("string"!==typeof e&&!("text/plain"in e))throw Error("You must provide a text/plain type.");window.clipboardData.setData("Text","string"===typeof e?e:e["text/plain"])?t():n(Error("Copying was rejected."))}))},r.paste=function(){return new Promise((function(e,t){var n=window.clipboardData.getData("Text");n?e(n):t(Error("Pasting was rejected."))}))})}catch(o){console.error(o)}}else r={copy:function(){throw Error("Unable to copy. Perhaps it's not available in your browser?")},paste:function(){throw Error("Unable to paste. Perhaps it's not available in your browser?")}};t.Z=r},"../spread-sheet/src/core/feature/copyPaste/lib/parsers/automaticIdentifyLink.ts":function(e,t,n){"use strict";n.d(t,{FJ:function(){return L},a6:function(){return Z},en:function(){return x},fN:function(){return D},yi:function(){return O}}),n("../node_modules/regenerator-runtime/runtime.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.promise.js"),n("../node_modules/core-js/modules/es.regexp.constructor.js"),n("../node_modules/core-js/modules/es.regexp.exec.js"),n("../node_modules/core-js/modules/es.regexp.to-string.js"),n("../node_modules/core-js/modules/es.array.iterator.js"),n("../node_modules/core-js/modules/es.string.iterator.js"),n("../node_modules/core-js/modules/web.dom-collections.iterator.js"),n("../node_modules/core-js/modules/es.array.map.js"),n("../node_modules/core-js/modules/es.string.match.js"),n("../node_modules/core-js/modules/es.string.split.js"),n("../node_modules/core-js/modules/es.string.replace.js"),n("../node_modules/core-js/modules/es.array.find.js"),n("../node_modules/core-js/modules/es.function.name.js"),n("../node_modules/core-js/modules/es.string.trim.js"),n("../node_modules/core-js/modules/es.number.constructor.js"),n("../node_modules/core-js/modules/web.dom-collections.for-each.js"),n("../node_modules/core-js/modules/es.array.includes.js"),n("../node_modules/core-js/modules/es.string.includes.js"),n("../node_modules/core-js/modules/es.object.values.js");var r=n("../spread-sheet/src/core/utils/sheetClip/SheetClip.js"),o=n("../spread-sheet/src/core/feature/copyPaste/interfaces.ts"),s=n("../packages/model/src/cell/CellData.ts"),i=n("../packages/model/src/cell/ExtendedValue.ts"),a=n("../packages/model/src/cell/ExtendedValueType.ts"),l=n("../spread-sheet/src/core/feature/copyPaste/lib/parsers/validUrl.ts"),d=n("../packages/model/src/utils/numberFormat/FormatParseEngine.ts"),u=n("../packages/model/src/utils/numberFormat/ParsedValueType.ts"),c=n("../spread-sheet/src/base/util/url.ts"),h=n("../packages/model/src/cell/HyperlinkRun.ts"),f=n("../packages/model/src/range/hexRangeUtils.ts"),p=n("../packages/report/src/index.ts"),g=n("../node_modules/@tencent/tdocs-format-render/lib/index.js"),m=n("../spread-sheet/src/core/feature/formula/autofix.ts"),v=n("../packages/model/src/cell/CellFormat.ts"),I=n("../packages/model/src/cell/HyperlinkType.ts"),E=n("../packages/model/src/cell/LinkIconType.ts"),S=n("../spread-sheet/src/core/feature/copyPaste/utils/onPaste.ts"),R=n("../node_modules/querystring/index.js"),w=n("../spread-sheet/src/base/util/appConfig.ts"),A=function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function i(e){try{l(r.next(e))}catch(t){s(t)}}function a(e){try{l(r.throw(e))}catch(t){s(t)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,a)}l((r=r.apply(e,t||[])).next())}))},C=w.Z.getConfig("runtime.domainName"),y=new RegExp("^http(s)://"+C+"/sheet","i"),_=new RegExp("^http(s)://"+C+"/txdoc/excel","i"),T=function(e){return[y,_].some((function(t){return t.test(e)}))},x=function(e){var t=e.url,n=e.sheetList,r=e.getLinkedWorkbookRangeById;return A(void 0,void 0,void 0,regeneratorRuntime.mark((function e(){var o,s,i,a,l,d,u,c;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=D(t),s=o.hyperlink,i=o.hyperlinkType,e.next=3,O({hyperlink:s,hyperlinkType:i,sheetList:n,getLinkedWorkbookRangeById:r});case 3:return a=e.sent,l=a.hyperlinkRuns,d=a.value,u=a.newHyperlink,c=a.newHyperlinkType,e.abrupt("return",{hyperlinkRuns:l,value:d,hyperlink:u,hyperlinkType:c});case 9:case"end":return e.stop()}}),e)})))},b=function(e){var t=this,n=e.editValues,r=e.formulas,o=e.sheetList,i=e.getLinkedWorkbookRangeById;return Promise.all(n.map((function(e,n){return A(t,void 0,void 0,regeneratorRuntime.mark((function t(){var a,l=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Promise.all(e.map((function(e,t){return A(l,void 0,void 0,regeneratorRuntime.mark((function a(){var l,d,c,h,f,p,g,v,I;return regeneratorRuntime.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return l=j(e),d=l.userEnteredFormat,c=l.parseResult,a.next=3,x({url:e,sheetList:o,getLinkedWorkbookRangeById:i});case 3:return h=a.sent,f=h.hyperlinkRuns,p=h.value,g=h.hyperlink,v=h.hyperlinkType,p||(p=c.value),c.valueType===u.Z.FORMULA&&"string"===typeof c.value&&(r[n]=r[n]||[],r[n][t]=(0,m.wh)(c.value,[])),I=M(c,p),a.abrupt("return",new s.Z({effectiveValue:I,editValue:e,hyperlink:f?null:g,hyperlinkType:v,userEnteredFormat:d,hyperlinkRuns:f}));case 12:case"end":return a.stop()}}),a)})))})));case 2:return a=t.sent,t.abrupt("return",{values:a});case 4:case"end":return t.stop()}}),t)})))})))},D=function(e,t){var n,r=null,o=null,s=new RegExp("^http(s)://"+C+"/sheet/[^s]?[^s]*rangeid=d*[^s]*","i"),i=null===(n=null===e||void 0===e?void 0:e.match(s))||void 0===n?void 0:n[0];return(r=e&&""!==e&&(0,l.D)(e)?e:i&&""!==i&&(0,l.D)(i)&&!t?i:null)&&(0,c.KM)(r)&&(o=(0,c.KM)(r)),{hyperlink:r,hyperlinkType:o}};function O(e){var t,r=e.hyperlink,o=e.hyperlinkType,s=e.skipRangeShare,i=e.sheetList,a=e.getLinkedWorkbookRangeById;return A(this,void 0,void 0,regeneratorRuntime.mark((function e(){var l,d,u,g,m,v,E,S,w,A,C,y;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(l=r,d=o,u=null,g="",!r||!o){e.next=28;break}return e.prev=5,e.next=8,(0,c.wI)(r);case 8:if(!(m=e.sent)){e.next=16;break}o=m.hyperlinkType,g=m.fileName||r,d=o,l=r,e.next=21;break;case 16:return e.next=18,(0,c.sx)(r);case 18:v=e.sent,g=v.title,d=8===o&&1===v.docPolicy?11:o;case 21:p.ZP.monitor(35271164),p.ZP.tdwReport({opername:"link",module:"link_set",action:"link_tdocname_autoset"}),e.next=28;break;case 25:e.prev=25,e.t0=e.catch(5),n.g.log.error("parseHyperLink error",e.t0);case 28:return r&&T(r)&&2===r.split("?").length&&!s&&(E=location.pathname.replace("/sheet/",""),S=R.parse(r.split("?")[1]),w=S.tab,A=S.rangeid,(_=r,_.trim().replace(/[\?|#].*$/,"").replace(/^(?:https\:)\/\//,"").replace(/^.*?(\/.*)/,"$1").replace(/\/$/,"")).replace("/sheet/","")===E&&w&&(C=null===(t=null===i||void 0===i?void 0:i.find((function(e){return e.id===w})))||void 0===t?void 0:t.name,y=null===a||void 0===a?void 0:a(A),A&&C&&y?(d=null,l="'"+C+"'!"+(0,f.range2AbsoluteHex)(y.range).replace(/\$/g,""),g=l,u=[h.Z.createInstance({startIndex:0,linkUrl:"#rangeid="+A})]):(g=C||g,d=I.ZP.SHEET_LINK,l="#tab="+w))),e.abrupt("return",{value:g,newHyperlink:l,newHyperlinkType:d,hyperlinkRuns:u});case 30:case"end":return e.stop()}var _}),e,null,[[5,25]])})))}function M(e,t){var n=Number(e.valueType);return""===e.value&&n==a.Z.STRING?null:i.Z.createInstance({type:n,value:t,originValue:void 0===e.originValue||null===e.originValue?"":String(e.originValue)})}function j(e){var t=null,n=(0,d.parseValueWithStyle)(e,null,{parseMode:d.PARSE_MODE.CURRENT_STYLE_FIRST});return(n=(0,d.twelveNumberToText)(n)).numberFormat.pattern!==g.DEFAULT_FORMAT_PATTERN&&(t=v.Z.createInstance({numberFormat:n.numberFormat})),{userEnteredFormat:t,parseResult:n}}var L=function(e,t,n){return A(void 0,void 0,void 0,regeneratorRuntime.mark((function s(){var i,a,l,d;return regeneratorRuntime.wrap((function(s){for(;;)switch(s.prev=s.next){case 0:if((i=r.parse(e))instanceof Array){s.next=3;break}return s.abrupt("return",null);case 3:return a=0,i.forEach((function(e){a=Math.max(e.length,a)})),i=(0,S.kg)(i,a),l=[],s.next=9,b({editValues:i,formulas:l,sheetList:t,getLinkedWorkbookRangeById:n});case 9:return s.t0=s.sent,s.t1=i.map((function(e){return e.map((function(){return!1}))})),s.t2=o.gN.OUTER,s.t3=o.o_.unknown,s.t4={selectAll:!1,selectCol:!1,selectRow:!1},(d={rowDataUpdate:s.t0,merge:s.t1,isSingle:!1,isMerge:!1,fromType:s.t2,fromApp:s.t3,select:s.t4,containTable:!1}).formula=l,s.abrupt("return",d);case 17:case"end":return s.stop()}}),s)})))};function Z(e){return e&&(e.hyperlinkType&&Object.values(I.ZP).includes(e.hyperlinkType)||e.linkIconStatus&&Object.values(E.Z).includes(e.linkIconStatus))}},"../spread-sheet/src/core/feature/copyPaste/lib/parsers/validUrl.ts":function(e,t,n){"use strict";n.d(t,{D:function(){return r}});var r=function(e){return/^(?:(?:(?:https?|ftp):)?\/\/)(?:\S+(?::\S*)?@)?(?:(?!(?:10|127)(?:\.\d{1,3}){3})(?!(?:169\.254|192\.168)(?:\.\d{1,3}){2})(?!172\.(?:1[6-9]|2\d|3[0-1])(?:\.\d{1,3}){2})(?:[1-9]\d?|1\d\d|2[01]\d|22[0-3])(?:\.(?:1?\d{1,2}|2[0-4]\d|25[0-5])){2}(?:\.(?:[1-9]\d?|1\d\d|2[0-4]\d|25[0-4]))|(?:(?:[a-z\u00a1-\uffff0-9]-*)*[a-z\u00a1-\uffff0-9]+)(?:\.(?:[a-z\u00a1-\uffff0-9]-*)*[a-z\u00a1-\uffff0-9]+)*(?:\.(?:[a-z\u00a1-\uffff]{2,})).?)(?::\d{2,5})?(?:[/?#]\S*)?$/i.test(e)}},"../spread-sheet/src/core/feature/copyPaste/lib/smartSplit/SmartSplit.ts":function(e,t,n){"use strict";n.d(t,{BF:function(){return A},IK:function(){return T},PQ:function(){return I},aY:function(){return E},ep:function(){return w},fG:function(){return R},jq:function(){return x},lT:function(){return C},yC:function(){return S}});var r=n("../node_modules/@babel/runtime/helpers/esm/toConsumableArray.js"),o=(n("../node_modules/core-js/modules/es.regexp.exec.js"),n("../node_modules/core-js/modules/es.string.replace.js"),n("../node_modules/core-js/modules/es.string.trim.js"),n("../node_modules/core-js/modules/es.array.iterator.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/web.dom-collections.iterator.js"),n("../node_modules/core-js/modules/es.regexp.to-string.js"),n("../node_modules/core-js/modules/es.object.keys.js"),n("../node_modules/core-js/modules/es.array.concat.js"),n("../node_modules/i18next/dist/esm/i18next.js")),s=n("../spread-sheet/src/core/feature/copyPaste/lib/smartSplit/transformDataSP.ts"),i=n("../spread-sheet/src/base/util/timer.ts"),a=n("../spread-sheet/src/core/ui/toast/index.ts"),l=n("../packages/report/src/index.ts"),d=n("../node_modules/@tencent/docs-user-agent/dist/index.js"),u=n.n(d),c=n("../spread-sheet/src/core/feature/smartSplit/smart-split-convert-utils.ts"),h=n("../spread-sheet/src/base/util/appConfig.ts"),f=n("../node_modules/lodash/isEmpty.js"),p=n.n(f),g=null;function m(e,t,r,o){e.addEventListener?e.addEventListener(t,r,o):e.attachEvent&&e.attachEvent("on"+t,(function(){r(n.g.event)}))}function v(e,t,r,o){e.removeEventListener?e.removeEventListener(t,r,o):e.detachEvent&&e.detachEvent("on"+t,(function(){r(n.g.event)}))}function I(e,t,n){void 0===t&&(t=function(){}),i();var r={isNeedBtn:!0,toolToastCloseTime:5e3,btnText:o.ZP.t("试试智能分列"),btnCallBack:function(){i(),t(),e.view.canvas.inputManager.focus(),l.ZP.tdwReport({opername:"doc_excel_editor",module:"excel_paste_split",action:"clk_toast"})}},s=null;function i(){S(),s&&(s.dispose(),s=null)}(0,a.showToast)("你可能希望对数据进行自动整理。    ".replace(/ /g," "),{top:"182px"},r),s||(s=e.view.canvas.normalSelectData.onModifySelectData(i))}function E(e,t){void 0===t&&(t=function(){});var r=null;function s(){S(),r&&(r.dispose(),r=null),v(document,"tap",d,!1),v(document,"click",d,!1),v(document,"input",s,!1)}function d(e){e.target.classList.contains("table-input-content")||s()}i.Z.wait(0).run((function(){n.g.scrollTo(0,0)})),S(),(0,a.showToast)(o.ZP.t("你可能希望对数据进行自动整理。"),void 0,{isNeedBtn:!0,btnText:o.ZP.t("试试智能分列"),supportMobile:!0,autoClose:!0,toolToastCloseTime:3e3,btnCallBack:function(){s(),t(),l.ZP.tdwReport({opername:"doc_excel_editor",module:"excel_paste_split",action:"clk_toast"})}}),r||(r=e.view.canvas.normalSelectData.onModifySelectData(s)),m(document,"tap",d,!1),m(document,"click",d,!1),i.Z.wait(0).run((function(){m(document,"input",s,!1)})),l.ZP.tdwReport({opername:"doc_excel_editor",module:"excel_paste_split",action:"trigger_toast"})}function S(){"试试智能分列"===$("#toolToastBtn").text().trim()&&(0,a.hideToast)()}function R(e,t){void 0===t&&(t=function(){}),g=null,function(e,t){void 0===t&&(t=function(){}),$.ajax({url:"//"+h.Z.getConfig("runtime.domainName")+"/cgi-bin/online_docs/ai_autocolumn",type:"POST",xhrFields:{withCredentials:!0},data:{type:"textanalysis.autocolumn",data:JSON.stringify({text:e,docID:n.g.location.pathname.replace(/^.*\/([^\/]+)$/,"$1")}),xsrf:n.g.CoreSheet.util.getXsrf()},success:function(e){var n=(0,c.x)(e.ssodata),r=(0,c.x)(null===n||void 0===n?void 0:n.result);0===e.cgicode&&0===e.retcode&&n&&0===n.code&&Array.isArray(r)&&r.length>0&&!p()(r[0])&&t(r)}}),l.ZP.tdwReport({opername:"doc_excel_editor",module:"excel_paste_split",action:"total_trigger"})}(e,(function(e){g=e,t(e)}))}function w(){return g}function A(e){g=e}function C(e,t){e=e||g;var r=(0,s.ZP)(e);t.feature.copyPaste&&t.feature.copyPaste.doPaste({pasteData:r,cb:function(){}}),(u().isMobilePhone||u().isAndroidPad)&&i.Z.wait(0).run((function(){n.g.scrollTo(0,0)}))}function y(e,t,n){for(var r=e[0],o=e[1],s=e[2],i=e[3],a=r;a<=o;a++)if(t[a])for(var l=t[a].values,d=s;d<=i;d++){var u=l[d];if(n){if(u)return!1}else if(u&&u.effectiveValue&&u.effectiveValue.value&&""!==u.effectiveValue.value.toString())return!1}return!0}function _(e,t,n){return void 0===t?[0,e-1]:void 0===n?[t,t>e-1?-1:e-1]:t>e-1?[t,-1]:[t,n>e-1?e-1:n]}function T(e,t){var o=e.spreadsheet.activeSheet,s=o.data.rowData,i=o.getRowCount()||0,a=o.getColCount()||0;if(!function(e,t,r){var o,s;if(!(null===(s=null===(o=n.g.CoreSheet)||void 0===o?void 0:o.configurations)||void 0===s?void 0:s.aiAutoColumnEnable))return!1;if(!e)return!1;if("number"!==typeof t||"number"!==typeof r||t<1||r<1)return!1;if(t>500)return!1;var i=e.spreadsheet.activeSheet.images;return!(i&&Object.keys(i).length>0)}(e,i,a))return!1;var l=[].concat((0,r.Z)(_(i,0,25)),(0,r.Z)(_(a,0,8))),d=[].concat((0,r.Z)(_(i,0,25)),(0,r.Z)(_(a,9,16))),u=[].concat((0,r.Z)(_(i,26,50)),(0,r.Z)(_(a,0,16))),c=[].concat((0,r.Z)(_(i,0,50)),(0,r.Z)(_(a,17))),h=[].concat((0,r.Z)(_(i,51)),(0,r.Z)(_(a,0)));return!!(y(l,s,t)&&y(d,s,t)&&y(u,s,t)&&y(c,s,t)&&y(h,s,t))}function x(e,t,n){R(e,(function(e){E(t,(function(){t.requestApi.undo().then((function(){C(e,t)}))})),l.ZP.tdwReport({opername:"doc_excel_editor",module:"excel_paste_split",action:"active_trigger"}),n&&l.ZP.tdwReport({opername:"doc_excel_editor",module:"excel_paste_split",action:"new_sheet_trigger"})}))}},"../spread-sheet/src/core/feature/copyPaste/lib/textarea.ui.ts":function(e,t){"use strict";var n=function(){function e(){this.isAppended=!1,this.refCounter=0}e.getSingleton=function(){return r.append(),r};var t=e.prototype;return t.append=function(){this.hasBeenDestroyed()&&this.create(),this.refCounter++,!this.isAppended&&document.body&&(this.isAppended=!0,document.body.appendChild(this.element))},t.changeParentNode=function(e){this.element&&(this.element.remove(),e.appendChild(this.element))},t.create=function(){var e;this.element=document.createElement("textarea"),this.element.id="CopyPasteDiv",(e=this.element.style).position="fixed",e.top="-10000px",e.left="-10000px",this.element.className="copyPaste",this.element.tabIndex=-1,this.element.autocomplete="off",this.element.wrap="hard",this.element.value=" "},t.deselect=function(){this.element===document.activeElement&&document.activeElement.blur()},t.destroy=function(){this.refCounter--,this.refCounter=this.refCounter<0?0:this.refCounter,this.hasBeenDestroyed()&&this.element&&this.element.parentNode&&(this.element.parentNode.removeChild(this.element),this.element=void 0,this.isAppended=!1)},t.getValue=function(){return this.element.value},t.hasBeenDestroyed=function(){return this.refCounter<1},t.isActive=function(){return this.element===document.activeElement},t.select=function(){this.element.focus(),this.element.select()},t.setValue=function(e){this.element.value=e},e}(),r=new n;t.Z=n},"../spread-sheet/src/core/feature/copyPaste/lib/unescapeCssSequences.ts":function(e,t,n){"use strict";n.d(t,{G:function(){return o},H:function(){return s}}),n("../node_modules/core-js/modules/es.regexp.exec.js"),n("../node_modules/core-js/modules/es.string.replace.js"),n("../node_modules/core-js/modules/es.array.slice.js"),n("../node_modules/core-js/modules/es.array.join.js"),n("../node_modules/core-js/modules/es.array.map.js"),n("../node_modules/core-js/modules/es.string.split.js");var r={CSS:{Sequence:function(){var e=/\\((([\dA-F]{2}|[\dA-F]{1,5})\s)|([\dA-F]{6}|[\dA-F]{4}))/gim;return e.unescape=function(e){var t=window,n=t.String.fromCharCode,r=t.parseInt;return e.replace(this,(function(e){return n(r(e.slice(2),16))}))},e}()}},o=function(e){return function(e){return e.replace(/(\\.)/g,(function(e){return e.slice(1)})).replace(/(\\[\$\-+/\(\):!\^&'~{}<>= ])/g,(function(e){return e.slice(1)}))}(r.CSS.Sequence.unescape(e))},s=function(e){return"'"+i(e)+"'"},i=function(e){var t=0;return e=e.split('"').map((function(e){return++t%2===0?e:e.replace(/([\\\)\|\(#;,\.\[\]\$¥])/g,"\\$1")})).join("\\0022")}},"../spread-sheet/src/core/feature/copyPaste/middleware/cell/cellFloatImage.ts":function(e,t,n){"use strict";n.d(t,{C:function(){return s}}),n("../node_modules/core-js/modules/es.object.keys.js"),n("../node_modules/core-js/modules/web.dom-collections.for-each.js");var r=n("../spread-sheet/src/core/feature/copyPaste/middleware/interface.ts"),o=n("../spread-sheet/src/core/feature/copyPaste/utils/cellFloatImage.ts"),s="tencent-sheet-float-img",i=new(function(){function e(){var e=this;this.desc={name:r.r.cellFloatImage},this.shapeIdsCommentStr="\x3c!--cutShapeIDs",this.getCellValue=function(t,n){return(0,o.Fb)(t.ext.selectedImages)?t.ext.mergeReference?e.handleFloatImgWithMerge(t,n):e.handleFloatImg(t,n):n()},this.getTableEndStr=function(t,n){if(t.selectedImages&&Object.keys(t.selectedImages).length>0){e.shapeIdsCommentStr=e.shapeIdsCommentStr.substring(0,e.shapeIdsCommentStr.length-1);var r=e.shapeIdsCommentStr+"cutShapeIDs--\x3e";return e.shapeIdsCommentStr="\x3c!--cutShapeIDs",r+n()}return n()}}var t=e.prototype;return t.handleFloatImg=function(e,t){var n=this,r=e.ext.newY+"_"+e.ext.newX,o=e.ext.selectedImages[r],i="";return(null===o||void 0===o?void 0:o.length)>0&&o.forEach((function(t){i+='<img src="'+t.url+'" type="'+s+'" width='+t.size.width+" height="+t.size.height+' style="width: '+t.size.width+"px; height: "+t.size.height+"px; margin-left: "+t.offset.x+"px; margin-top: "+t.offset.y+'px" data-clip="'+t.clipInfo.clipTop+"px "+t.clipInfo.clipRight+"px "+t.clipInfo.clipBottom+"px "+t.clipInfo.clipLeft+'px" data-anchor="'+(e.ext.newY-e.ext.yStart)+" "+(e.ext.newX-e.ext.xStart)+'"/>',n.shapeIdsCommentStr+=t.id+"|"})),i+t()},t.handleFloatImgWithMerge=function(e,t){for(var n=this,r=e.ext.mergeReference.startRowIndex,o=e.ext.mergeReference.endRowIndex,i=e.ext.mergeReference.startColIndex,a=e.ext.mergeReference.endColIndex,l="",d=r;d<=o;d++)for(var u=i;u<=a;u++){var c=d+"_"+u,h=e.ext.selectedImages[c];(null===h||void 0===h?void 0:h.length)>0&&function(){for(var t=0,o=u;o>i;o--)t+=e.activeSheet.getColWidth(o-1);for(var a=0,c=d;c>r;c--)a+=e.activeSheet.getRowHeight(c-1);var f="",p="";h.forEach((function(n){f+='<img src="'+n.url+'" type="'+s+'" width='+n.size.width+" height="+n.size.height+' style="width: '+n.size.width+"px; height: "+n.size.height+"px; margin-left: "+(n.offset.x+t)+"px; margin-top: "+(n.offset.y+a)+'px" data-clip="'+n.clipInfo.clipTop+"px "+n.clipInfo.clipRight+"px "+n.clipInfo.clipBottom+"px "+n.clipInfo.clipLeft+'px" data-anchor="'+(e.ext.newY-e.ext.yStart)+" "+(e.ext.newX-e.ext.xStart)+'"/>',p+=n.id+"|"})),l+=f,n.shapeIdsCommentStr+=p}()}return l+t()},e}());t.Z=i},"../spread-sheet/src/core/feature/copyPaste/middleware/cell/cellImage.ts":function(e,t,n){"use strict";n("../node_modules/regenerator-runtime/runtime.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.promise.js"),n("../node_modules/core-js/modules/es.object.assign.js"),n("../node_modules/core-js/modules/es.array.iterator.js"),n("../node_modules/core-js/modules/web.dom-collections.iterator.js");var r=n("../node_modules/i18next/dist/esm/i18next.js"),o=n("../spread-sheet/src/core/view/level-2/shape-upload/utils.ts"),s=n("../packages/model/src/cell/metadata/CustomDataType.ts"),i=n("../packages/model/src/cell/ExtendedValueType.ts"),a=n("../packages/model/src/cell/metadata/Metadata.ts"),l=n("../packages/model/src/embedded/index.ts"),d=n("../spread-sheet/src/core/feature/copyPaste/middleware/interface.ts"),u=n("../spread-sheet/src/core/feature/copyPaste/utils/url.ts"),c=n("../packages/model/src/cell/ExtendedValue.ts"),h=n("../node_modules/lodash/merge.js"),f=n.n(h),p=n("../spread-sheet/src/core/feature/copyPaste/middleware/cell/cellFloatImage.ts"),g=n("../spread-sheet/src/core/feature/copyPaste/utils/cellFloatImage.ts"),m=function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function i(e){try{l(r.next(e))}catch(t){s(t)}}function a(e){try{l(r.throw(e))}catch(t){s(t)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,a)}l((r=r.apply(e,t||[])).next())}))},v=new(function(){function e(){var e=this;this.desc={name:d.r.cellImage,tableProps:d.X_.cellImage},this.tdToCellData={isActive:function(t,n,r){var o,s=n.x,i=n.y;return(null===(o=t[e.desc.tableProps][i])||void 0===o?void 0:o[s])&&!r.effectiveValue},fn:function(e){return Object.assign(e,{metadata:a.Z.createInstance({customDataType:s.ZP.IMAGE})})}},this.copyToHtml=function(e,t){var n,r,o=null===(n=e.cellData)||void 0===n?void 0:n.getMetadata(),i=null===o||void 0===o?void 0:o.customDataType;if(!i)return t();if(i!==s.ZP.IMAGE)return t();var a=null===(r=e.cellData.getRefIds())||void 0===r?void 0:r[0],l=a&&e.activeSheet.imageManager.getImage(a);return l?"data-online-sheet-type='"+l.type+"' data-online-sheet-url='"+l.url+"' data-online-sheet-width='"+Math.floor(l.position.overlayPosition.widthPixels)+"' data-online-sheet-height='"+Math.floor(l.position.overlayPosition.heightPixels)+"' "+t():t()},this.processPasteData=function(t){var n=t.cellData,l=t.pasteData,d=t.offset,u=d.row,h=d.col,f=d.fromRow,p=d.fromCol,g=t.activeSheet,m=t.sheetManager,v=t.activeSheetId,I=t.cacheState,E=t.ext.propsKeys;if(n){var S=(0,o.ki)(),R=n.getMetadata(),w=n;if(w&&(null===R||void 0===R?void 0:R.customDataType)===s.ZP.IMAGE&&(w=n.clone()),(null===R||void 0===R?void 0:R.customDataType)===s.ZP.IMAGE){var A=e.setCellImage(l,u,h,f,p,S,g,m,E[e.desc.tableProps],v,I);if(!(null===A||void 0===A?void 0:A.url))return;var C=r.ZP.t("图片");w.setEffectiveValue(c.Z.createInstance({type:i.Z.STRING,value:C})),w.setMetadata(a.Z.createInstance({customDataType:s.ZP.IMAGE})),w.setRefIds([S])}return{newCellData:w}}},this.parseHTML=function(e,t){var n={cellImage:null};if(f()(e.info,n),e.element){if(e.element.getAttribute("data-online-sheet-type")===l.EMBEDDED_OBJECT_TYPE.CELL_IMAGE)return n.cellImage={url:e.element.getAttribute("data-online-sheet-url"),width:e.element.getAttribute("data-online-sheet-width"),height:e.element.getAttribute("data-online-sheet-height")},f()(e.info,n),void t();var r=e.element.querySelector("img"),o=null===r||void 0===r?void 0:r.getAttribute("src");(null===r||void 0===r?void 0:r.getAttribute("type"))!==p.C&&o&&!(0,u.e3)(o)?(n.cellImage={url:o},f()(e.info,n),t()):t()}else t()}}var t=e.prototype;return t.beforePaste=function(e,t){return m(this,void 0,void 0,regeneratorRuntime.mark((function n(){var r,o,s,i,a,l,d;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:r=e.cellImage,o=void 0===r?[]:r,s=null,i=0;case 3:if(!(i<o.length)){n.next=28;break}a=0;case 5:if(!(a<o[i].length)){n.next=25;break}if(!o[i][a]){n.next=22;break}if(l=o[i][a].url,!(0,g.$X)(o[i][a])){n.next=22;break}return d=void 0,n.prev=10,n.next=13,t(l);case 13:d=n.sent,n.next=21;break;case 16:return n.prev=16,n.t0=n.catch(10),o[i][a].url="",s=n.t0,n.abrupt("continue",22);case 21:o[i][a]={width:d.size.width,height:d.size.height,url:d.url};case 22:a++,n.next=5;break;case 25:i++,n.next=3;break;case 28:return n.abrupt("return",s);case 29:case"end":return n.stop()}}),n,null,[[10,16]])})))},t.getCellValue=function(e,t){var n,r,o=null===(n=e.cellData)||void 0===n?void 0:n.getMetadata();if((null===o||void 0===o?void 0:o.customDataType)===s.ZP.IMAGE){var i=null===(r=e.cellData.getRefIds())||void 0===r?void 0:r[0],a=i&&e.activeSheet.imageManager.getImage(i);if(a)return"<img src="+a.url+"/ tencent-sheet-cell-img='true'>"}return t()},t.setCellImage=function(e,t,n,r,o,s,i,a,d,u,c){var h,f=e.cellImage,p=void 0===f?[]:f,g=0,m=0;if(p.length){var v=h=p[r][o];g=v.width,m=v.height}else{if(!(null===(h=this.setCellImageInner(e,r,o,i,a,c,u))||void 0===h?void 0:h.url))return{url:""};var I=h.position.overlayPosition;g=I.widthPixels,m=I.heightPixels}return h.url&&d.push(Object.assign(Object.assign({},h),{type:l.EMBEDDED_OBJECT_TYPE.CELL_IMAGE,sheetId:u,x:n,y:t,width:g,height:m,id:s,offsetX:0,offsetY:0,zIndex:0})),h},t.setCellImageInner=function(e,t,n,r,o,s,i){var a,l;try{a=e.rowDataUpdate[t].values[n].getRefIds()[0]}catch(u){return{url:""}}if(i===s.sheetId)l=r.imageManager.getImage(a)||s.cellImageCache.get(a);else{var d=o.getSheetBySheetId(s.sheetId);l=null===d||void 0===d?void 0:d.imageManager.getImage(a)}return l},e}());t.Z=v},"../spread-sheet/src/core/feature/copyPaste/middleware/index.ts":function(e,t,n){"use strict";n.d(t,{Z:function(){return ve}});var r,o,s,i=n("../spread-sheet/src/core/feature/copyPaste/middleware/interface.ts"),a=n("../node_modules/@babel/runtime/helpers/esm/toConsumableArray.js"),l=(n("../node_modules/core-js/modules/es.array.iterator.js"),n("../node_modules/core-js/modules/es.map.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.string.iterator.js"),n("../node_modules/core-js/modules/esnext.map.delete-all.js"),n("../node_modules/core-js/modules/esnext.map.every.js"),n("../node_modules/core-js/modules/esnext.map.filter.js"),n("../node_modules/core-js/modules/esnext.map.find.js"),n("../node_modules/core-js/modules/esnext.map.find-key.js"),n("../node_modules/core-js/modules/esnext.map.includes.js"),n("../node_modules/core-js/modules/esnext.map.key-of.js"),n("../node_modules/core-js/modules/esnext.map.map-keys.js"),n("../node_modules/core-js/modules/esnext.map.map-values.js"),n("../node_modules/core-js/modules/esnext.map.merge.js"),n("../node_modules/core-js/modules/esnext.map.reduce.js"),n("../node_modules/core-js/modules/esnext.map.some.js"),n("../node_modules/core-js/modules/esnext.map.update.js"),n("../node_modules/core-js/modules/web.dom-collections.iterator.js"),n("../node_modules/core-js/modules/es.array.from.js"),n("../node_modules/core-js/modules/es.array.filter.js"),n("../node_modules/core-js/modules/es.array.map.js"),(r={})[i.aC.COPY_ON_CELL_VALUE]=new Map,r[i.aC.CELL_PROPS]=new Map,r[i.aC.COPY_ON_CELL_ATTR]=new Map,r[i.aC.COPY_ON_TABLE_END]=new Map,r[i.aC.PASTE_ON_PARSE_HTML]=new Map,r),d=function(){function e(){this.phase=i.nz.IDLE,this.middleWares=l}var t=e.prototype;return t.getMiddleWaresByLevel=function(e){var t=this.middleWares[e];return Array.from(t.values())},t.getAllMiddleWares=function(e){var t=e.level,n=e.tableProps;if(!t)return[];var r=(0,a.Z)(this.getMiddleWaresByLevel(t));return n&&(r=this.getMiddleWaresByTableProps(r)),r},t.run=function(e,t,n){var r=this.getMiddleWareCallBacks(e,t);return this.compose(r,n)},t.register=function(e,t,n){this.middleWares[e].set(t,n)},t.getMiddleWaresByTableProps=function(e){return e?e.filter((function(e){return e.desc.tableProps})):[]},t.getMiddleWareCallBacks=function(e,t){return this.getMiddleWaresByLevel(e).filter((function(e){return"function"===typeof e[t]})).map((function(e){return e[t]}))},t.compose=function(e,t){var n=-1;return function r(o){if(o<=n)throw new Error("next only called once");if(n=o,o===e.length)return"";var s=e[o];return null===s||void 0===s?void 0:s(t,r.bind(null,o+1))}(0)},e}(),u=new d,c=n("../spread-sheet/src/core/feature/copyPaste/middleware/cell/cellImage.ts"),h=(n("../node_modules/core-js/modules/es.regexp.exec.js"),n("../node_modules/core-js/modules/es.string.replace.js"),n("../node_modules/core-js/modules/es.object.assign.js"),n("../node_modules/core-js/modules/web.dom-collections.for-each.js"),n("../node_modules/core-js/modules/es.string.split.js"),n("../packages/model/src/cell/CellFormat.ts")),f=n("../spread-sheet/src/core/feature/copyPaste/lib/parsers/automaticIdentifyLink.ts"),p=n("../spread-sheet/src/core/feature/copyPaste/utils/parser.ts"),g=n("../packages/model/src/cell/HyperlinkRun.ts"),m=n("../packages/model/src/config/index.ts"),v=n("../packages/model/src/cell/format/UnderlineType.ts"),I=n("../spread-sheet/src/core/feature/copyPaste/core/getCopyTextHTML.ts"),E=n("../node_modules/lodash/merge.js"),S=n.n(E),R=new function(){this.desc={name:i.r.cellLink},this.getCellValue=function(e,t){if(!e.cellData)return t();var n=(0,I.UF)(e.cellData),r=t();return r=(null===r||void 0===r?void 0:r.replace(/\r?\n/g,'<br style="mso-data-placement:same-cell;">'))||"",n?""+n+r+"</a>":r},this.processPasteData=function(e){var t,n=e.cellData;if(!n)return{newCellData:n};var r=n.getHyperlink()||n.getHyperlinkRuns(),o=n.getUserEnteredFormat();if(r){var s=null===o||void 0===o?void 0:o.getColor(),i=null===o||void 0===o?void 0:o.getUnderline(),a={};s||(a.color=m.HYPERLINK_COLOR),i||(a.underline=v.Z.SINGLE_LINE),n.setUserEnteredFormat(h.Z.createInstance(Object.assign(Object.assign({},null===o||void 0===o?void 0:o.getOptions()),{textFormat:Object.assign(Object.assign({},null===(t=null===o||void 0===o?void 0:o.textFormat)||void 0===t?void 0:t.getOptions()),a)})))}return{newCellData:n}},this.parseHTML=function(e,t){var n={template:null};if(S()(e.info,n),e.element){var r,o,s,i=e.element.getElementsByTagName("a");i.length&&function(){for(var t=void 0,a=[],l=0,d=i.length;l<d;l++){r=i[l].getAttribute("data-sheet-href")||i[l].getAttribute("href"),s=i[l].dataset.tencent_doc_hyperlink_type||"";var u=i[l].getAttribute("data-sheets-hyperlink"),c=i[l].getAttribute("data-sheets-hyperlinkruns");try{var h=u?JSON.parse(u):void 0;(0,f.a6)(h)&&(t=h)}catch(I){}try{var m=c?JSON.parse(c):void 0;Array.isArray(m)&&m.forEach((function(e){"object"===typeof e&&a.push(g.Z.createInstance(e))}))}catch(I){}if(r)break}o=e.element.innerText;var v=!1;(null===t||void 0===t?void 0:t.fullLinkUrl)&&(null===t||void 0===t?void 0:t.fullLinkUrl.split("?"))[0]!==""+location.origin+location.pathname&&(v=!0),n.template=(0,p.eO)(v?null===t||void 0===t?void 0:t.fullLinkUrl:r||o,o,s&&parseInt(s,10)||(null===t||void 0===t?void 0:t.hyperlinkType),null===t||void 0===t?void 0:t.linkIconStatus,a.length>0&&!v?a:void 0),S()(e.info,n)}(),t()}else t()}},w=(n("../node_modules/core-js/modules/es.string.fontsize.js"),n("../node_modules/core-js/modules/es.string.fontcolor.js"),n("../node_modules/core-js/modules/es.string.bold.js"),n("../node_modules/core-js/modules/es.string.italics.js"),n("../packages/model/src/cell/cellFormatUtils.ts")),A=n("../packages/model/src/cell/format/TextFormat.ts"),C=(n("../node_modules/core-js/modules/es.object.keys.js"),n("../node_modules/core-js/modules/es.array.join.js"),n("../node_modules/core-js/modules/es.array.slice.js"),n("../node_modules/core-js/modules/es.array.concat.js"),n("../node_modules/core-js/modules/es.string.match.js"),n("../node_modules/core-js/modules/es.regexp.to-string.js"),n("../node_modules/core-js/modules/es.number.constructor.js"),n("../node_modules/core-js/modules/es.array.includes.js"),n("../node_modules/core-js/modules/es.string.includes.js"),{white:"#FFFFFF",silver:"#C0C0C0",gray:"#808080",black:"#000000",red:"#FF0000",maroon:"#800000",yellow:"#FFFF00",olive:"#808000",lime:"#00FF00",green:"#008000",aqua:"#00FFFF",teal:"#008080",blue:"#0000FF",navy:"#000080",fuchsia:"#FF00FF",purple:"#800080"}),y={windowtext:"",windowframe:"",window:"",threedshadow:"",threedlightshadow:"",threedhighlight:"",threedface:"",threeddarkshadow:"",scrollbar:"",menutext:"",menu:"",infotext:"",infobackground:"",inactivecaptiontext:"",inactivecaption:"",inactiveborder:"",highlighttext:"",highlight:"",grayText:"",captiontext:"",buttontext:"",buttonshadow:"",buttonhighlight:"",buttonface:"",background:"",appworkspace:"",activecaption:"",activeborder:""},_=n("../spread-sheet/src/core/feature/copyPaste/utils/getDocsType.ts"),T=n("../packages/model/src/cell/format/BorderStyle.ts"),x=n("../node_modules/@tencent/tdocs-format-render/lib/index.js"),b=((o={})[T.Z.NONE]="none",o[T.Z.HAIR]=".5pt hairline",o[T.Z.DASH_DOT]=".5pt dot-dash",o[T.Z.DASH_DOT_DOT]=".5pt dot-dot-dash",o[T.Z.DOTTED]=".5pt dotted",o[T.Z.DASHED]=".5pt dashed",o[T.Z.THIN]=".5pt solid",o[T.Z.MEDIUM_DASH_DOT_DOT]="1.0pt dot-dot-dash",o[T.Z.SLANTED_DASH_DOT]="1.0pt dot-dash-slanted",o[T.Z.MEDIUM_DASH_DOT]="1.0pt dot-dash",o[T.Z.MEDIUM_DASHED]="1.0pt dashed",o[T.Z.MEDIUM]="1.0pt solid",o[T.Z.DOUBLE]="2.0pt double",o[T.Z.THICK]="1.5pt solid",o),D=n("../spread-sheet/src/core/utils/cell.ts"),O=n("../spread-sheet/src/core/feature/copyPaste/lib/unescapeCssSequences.ts"),M=n("../node_modules/@tencent/docs-user-agent/dist/index.js"),j=n.n(M),L=n("../packages/model/src/cell/metadata/CustomDataType.ts"),Z=n("../packages/model/src/cell/format/Color.ts"),k=Object.keys(y);function N(e,t,n,r,o,i){var a=[];return function(e,t,n){var r=e.getBackgroundColor();if(r){var o=Z.Z.getColorHexCode(r,n);o!==m.DEFAULT_CELL_FORMAT_LITERAL.backgroundColor&&t.push("background-color:"+o)}}(o,a,i),P(r,a,i,e),function(e,t,n,r){var o=t.getMergeReference();F(e,n,s.left,r),F(e,n,s.top,r),F(e,n,s.diagUp,r),F(e,n,s.diagDown,r),o||(F(e,n,s.right,r),F(e,n,s.bottom,r))}(o,e,a,i),function(e,t,n,r){(function(e,t,n,r){var o=e.getMergeReference();if(o){var s=o.startRowIndex,i=o.endColIndex;if((null===t||void 0===t?void 0:t[s])&&t[s].values&&t[s].values[i]){var a=t[s].values[i];if(a){var l=a.getUserEnteredFormat();if(l){var d=l.getBorderRight();d&&(d.color||d.style)&&n.push("border-right: "+U(d,r))}}}}})(e,t,n,r),function(e,t,n,r){var o=e.getMergeReference();if(o){var s=o.endRowIndex,i=o.startColIndex;if((null===t||void 0===t?void 0:t[s])&&t[s].values&&t[s].values[i]){var a=t[s].values[i];if(a){var l=a.getUserEnteredFormat();if(l){var d=l.getBorderBottom();d&&(d.color||d.style)&&n.push("border-bottom: "+U(d,r))}}}}}(e,t,n,r)}(e,n,a,i),function(e,t){var n=(0,D.getMergedFormat)(e,"verticalAlign");n&&t.push("vertical-align:"+n)}(e,a),function(e,t){var n=(0,D.getMergedFormat)(e,"textAlign");n&&t.push("text-align:"+n)}(e,a),function(e,t){var n=e.getWrapStrategy();n&&t.push("white-space:"+n)}(o,a),function(e,t){if(e){var n=(0,O.H)((0,x.getFormatCodeByNumberFormat)(e));t.push("mso-number-format: "+n)}}(t,a),a.join(";")+";"}function P(e,t,n,r){var o;t.push("font-size:"+(e.fontSize?e.fontSize:m.DEFAULT_CELL_FORMAT_LITERAL.fontSize)+"pt"),e.italic&&t.push("font-style:italic"),e.bold&&t.push("font-weight:bold"),e.underline&&t.push("text-decoration:underline");var s=e.fontFamily?e.fontFamily.replace(/"/g,"'"):m.DEFAULT_CELL_FORMAT_LITERAL.fontFamily;s&&t.push("font-family:"+s);var i=e.color;(i||(null===(o=null===r||void 0===r?void 0:r.getMetadata())||void 0===o?void 0:o.customDataType)===L.ZP.DATE_REMINDER)&&t.push("color:"+Z.Z.getColorHexCode(i,n))}function U(e,t){var n=e.color?Z.Z.getColorHexCode(e.color,t):"#000000";return("number"===typeof e.style?b[e.style]:b[T.Z.THIN])+" "+n}function F(e,t,n,r){var o,i=((o={})[s.left]=e.getBorderLeft,o[s.right]=e.getBorderRight,o[s.top]=e.getBorderTop,o[s.bottom]=e.getBorderBottom,o[s.diagUp]=e.getBorderDiagUp,o[s.diagDown]=e.getBorderDiagDown,o)[n].bind(e)();i&&(i.color||i.style)&&t.push(n+": "+U(i,r))}function V(e){var t=e.split(" "),n=null;return t&&t.length>2&&(n=t.slice(0,2).join(" ")),n?function(e){var t={none:T.Z.NONE,".5pt hairline":T.Z.HAIR,".5pt dot-dash":T.Z.DASH_DOT,".5pt dot-dot-dash":T.Z.DASH_DOT_DOT,".5pt dotted":T.Z.DOTTED,".5pt dashed":T.Z.DASHED,".5pt solid":T.Z.THIN,"1.0pt dot-dot-dash":T.Z.MEDIUM_DASH_DOT_DOT,"1.0pt dot-dash-slanted":T.Z.SLANTED_DASH_DOT,"1.0pt dot-dash":T.Z.MEDIUM_DASH_DOT,"1.0pt dashed":T.Z.MEDIUM_DASHED,"1.0pt solid":T.Z.MEDIUM,"2.0pt double":T.Z.DOUBLE,"1.5pt solid":T.Z.THICK},n={".5pt dotted":T.Z.DOTTED,".5pt dashed":T.Z.DASHED,".5pt solid":T.Z.THIN,"1.2pt solid":T.Z.MEDIUM,"1.2pt dashed":T.Z.MEDIUM_DASHED,"2.0pt solid":T.Z.THICK,"2.0pt double":T.Z.DOUBLE},r={"0.5pt dotted":T.Z.DOTTED,"0.5pt dashed":T.Z.DASHED,"0.5pt solid":T.Z.THIN,"1pt dashed":T.Z.MEDIUM_DASHED,"1pt solid":T.Z.MEDIUM,"1.5pt solid":T.Z.THICK,"2pt double":T.Z.DOUBLE};return t[e]||n[e]||r[e]||null}(n):null}!function(e){e.left="border-left",e.right="border-right",e.top="border-top",e.bottom="border-bottom",e.diagUp="border-diagup",e.diagDown="border-diagdown"}(s||(s={}));var B,H=function(e,t,n,r,o,s){if(j().isSafari){var i=t[o];return e&&i?i:n}var a=t[r]||t[s];return e&&a?G(a.split(/\s+/)[2]):n},G=function(e){if("string"===typeof e)return Y(e)},W=function(e){if(e.border)return{borderTopWidth:e.border,borderRightWidth:e.border,borderBottomWidth:e.border,borderLeftWidth:e.border,borderDiagUpWidth:"0px",borderDiagDownWidth:"0px"};var t=z(e);return{borderTopWidth:(null===e||void 0===e?void 0:e["border-top-width"])?Q(e["border-top-width"],t[0],e["border-top-color"]):"0px",borderRightWidth:(null===e||void 0===e?void 0:e["border-right-width"])?Q(e["border-right-width"],t[1],e["border-right-color"]):"0px",borderBottomWidth:(null===e||void 0===e?void 0:e["border-bottom-width"])?Q(e["border-bottom-width"],t[2],e["border-bottom-color"]):"0px",borderLeftWidth:(null===e||void 0===e?void 0:e["border-left-width"])?Q(e["border-left-width"],t[3],e["border-left-color"]):"0px",borderDiagUpWidth:"0px",borderDiagDownWidth:"0px"}},z=function(e){var t=[];if(e["border-style"]&&(t=e["border-style"].split(" ")),2===t.length&&(t=t.concat(t)),3===t.length){var n=t[1];t.push(n)}return t},Q=function(e,t,n){return e+" "+t+" "+n},Y=function(e){if("string"===typeof e){var t=J(e),n={};return"#"===t[0]?t:"rgb"===t.substring(0,3).toLowerCase()?(n[t]||(n[t]=q(t)),n[t]):C[t]?C[t]:void 0}},q=function(e){var t=e.toString().match(/\d+(\.\d+)?/g);if(null===t||void 0===t?void 0:t.length){var n=1;if(t[3]&&"undefined"!==typeof t[3]&&(n=Number(t[3])),0===n)return"";var r="#";if(1===n)for(var o=0;o<3;o++)r+=("{0"+Number(t[o]).toString(16)).slice(-2);else{for(var s=0;s<3;s++)r+=("{0"+Number(t[s]).toString(16)).slice(-2);r+=(255*n).toString(16).substring(0,2)}return r}},J=function(){var e=document.createElement("div");return document.body.appendChild(e),function(t){if("excel"===_.Z.getApp()){var n=t.toLocaleLowerCase();if(k.includes(n))return y[n]?y[n]:(e.style.borderColor=t,getComputedStyle(e).borderColor)}return t}}(),K=function(e,t){var n=[];e.strikethrough&&n.push("s");var r=n.reverse();return function(e,t,n){return""+e.map((function(e){return"<"+e+">"})).concat([n]).concat(t.map((function(e){return"</"+e+">"}))).join("")}(n,r,t)},X=new(function(){function e(){var e=this;this.desc={name:i.r.cellStyle},this.style={},this.getCellValue=function(e,t){var n=function(e){var t=[];if(e){var n=[e.getConditionalFormatResult(),e.getEffectiveFormat(),e.getUserEnteredFormat()].filter((function(e){return null!==e}));t.push.apply(t,(0,a.Z)(n))}if(0!==t.length)return(0,w.mergeCellFormats)(t)}(e.cellData),r=(null===n||void 0===n?void 0:n.getTextFormat())||A.Z.createInstance(),o=t();return""+(o=K(r,o))},this.copyToHtml=function(e,t){var n=e.activeSheet.data.rowData,r=[];if(e.cellData){var o=[e.cellData.getConditionalFormatResult(),e.cellData.getEffectiveFormat(),e.cellData.getUserEnteredFormat()].filter((function(e){return null!==e}));r.push.apply(r,(0,a.Z)(o))}var s=r.length>0&&(0,w.mergeCellFormats)(r),i="",l=!1!==s&&(null===s||void 0===s?void 0:s.getTextFormat())||A.Z.createInstance();if(e.cellData&&s){var d=s.getNumberFormat();i+=N(e.cellData,d,n,l,s,e.activeSheet.spreadsheetReference)}else i+=function(){var e="";return e+"font-size: "+m.DEFAULT_CELL_FORMAT_LITERAL.fontSize+"pt;"}();return'style="'+i+'" '+t()},this.parseHTML=function(t,n){e.parseFontFamily(t.element,t.style).parseFontSize(t.element,t.style).parseFontColor(t.element,t.style).parseFontWeight(t.element,t.style).parseFontStyle(t.element,t.style).parseFontDecoration(t.element,t.style).parseBorder(t.element,t.style).parseBackgroundColor(t.element,t.style).parseTextAlign(t.element,t.style).parseVerticalAlign(t.element,t.style).parseWhiteSpace(t.element,t.style).parseFormat(t.element,t.style,t.ext);var r={style:e.style};S()(t.info,r),e.style={},n()}}var t=e.prototype;return t.parseFontFamily=function(e,t){var n=null===t||void 0===t?void 0:t["font-family"];return n&&(this.style.fontfamily=(0,p.L1)(n)),this},t.parseFontSize=function(e,t){var n=null===t||void 0===t?void 0:t["font-size"];return n&&(this.style.fontsize=(0,p.bU)(n)),this},t.parseFontColor=function(e,t){var n=null===t||void 0===t?void 0:t.color;if(n){var r=Y(n);r&&(this.style.fontcolor=r)}return this},t.parseFontWeight=function(e,t){var n=null===t||void 0===t?void 0:t["font-weight"];return!n||"bold"!==n&&700!==parseInt(n,10)||(this.style.bold="bold"),this},t.parseFontStyle=function(e,t){return"italic"===(null===t||void 0===t?void 0:t["font-style"])&&(this.style.italic="italic"),this},t.parseFontDecoration=function(e,t){var n=null===t||void 0===t?void 0:t["text-decoration"];if(n&&(-1!==n.indexOf("underline")&&(this.style.underline="underline"),-1!==n.indexOf("line-through")&&(this.style.strikeline="strikeline")),e)for(var r=e.firstElementChild,o=10;r&&o;)"u"===r.tagName.toLowerCase()?this.style.underline="underline":"s"===r.tagName.toLowerCase()&&(this.style.strikeline="strikeline"),r=r.firstElementChild,o-=1;return this},t.parseBorder=function(e,t){if(t){var n=function(e){return j().isSafari?W(e):{borderTopWidth:e?e["border-top"]||e.border:"0px",borderRightWidth:e?e["border-right"]||e.border:"0px",borderBottomWidth:e?e["border-bottom"]||e.border:"0px",borderLeftWidth:e?e["border-left"]||e.border:"0px",borderDiagUpWidth:e?e["border-diagup"]||e["mso-diagonal-up"]:"0px",borderDiagDownWidth:e?e["border-diagdown"]||e["mso-diagonal-down"]:"0px"}}(t),r=n.borderTopWidth,o=n.borderRightWidth,s=n.borderBottomWidth,i=n.borderLeftWidth,a=n.borderDiagUpWidth,l=n.borderDiagDownWidth,d=function(e,t,n,r,o,s){return[parseInt(e,10)>0||parseFloat(e)>0,parseInt(t,10)>0||parseFloat(t)>0,parseInt(n,10)>0||parseFloat(n)>0,parseInt(r,10)>0||parseFloat(r)>0,parseInt(o,10)>0||parseFloat(o)>0,parseInt(s,10)>0||parseFloat(s)>0]}(r,o,s,i,a,l),u=function(e,t){var n=e.border&&G(e.border.split(/\s+/)[2]);return[H(t[0],e,n,"border-top","border-top-color","border-top"),H(t[1],e,n,"border-right","border-right-color","border-right"),H(t[2],e,n,"border-bottom","border-bottom-color","border-bottom"),H(t[3],e,n,"border-left","border-left-color","border-left"),H(t[4],e,n,"border-diagup","border-diagup-color","mso-diagonal-up"),H(t[5],e,n,"border-diagdown","border-diagdown-color","mso-diagonal-down")]}(t,d),c=function(e,t,n,r,o,s,i){return[e[0]&&t?V(t):null,e[1]&&n?V(n):null,e[2]&&r?V(r):null,e[3]&&o?V(o):null,e[4]&&s?V(s):null,e[5]&&i?V(i):null]}(d,r,o,s,i,a,l);this.style.border={colors:u,styles:c}}return this},t.parseBackgroundColor=function(e,t){var n=(null===t||void 0===t?void 0:t["background-color"])||(null===t||void 0===t?void 0:t.background);if(n){var r=Y(n);r&&(this.style.cellcolor=r)}return this},t.parseTextAlign=function(e,t){var n,r;return(r="excel"===_.Z.getApp()&&(null===(n=null===e||void 0===e?void 0:e.style)||void 0===n?void 0:n.textAlign)||(null===t||void 0===t?void 0:t["text-align"]))&&("start"===(r=(r=(null===r||void 0===r?void 0:r.toLowerCase())||"").replace(/^-(webkit|moz)-(.*)/,"$2"))||"justify"===r?r="left":"end"===r&&(r="right"),"121"===r&&(r="center"),-1!==["right","left","center"].indexOf(r)&&(this.style.h_align=r)),this},t.parseVerticalAlign=function(e,t){var n=null===t||void 0===t?void 0:t["vertical-align"];return t&&(this.style.v_align=n),this},t.parseWhiteSpace=function(e,t){if(t){var n=e.style.whiteSpace,r=null===t||void 0===t?void 0:t["white-space"];r&&(n=r),this.style.textwrap="normal"===n?n:"nowrap"}return this},t.parseFormat=function(e,t,n){if(!e||!n.mSOStyle)return this;var r=null===t||void 0===t?void 0:t["mso-number-format"];if(void 0===r)return this;r=r.replace(/^['|"]/,"").replace(/['|"]$/,"");var o=x.MSO_FORMAT_MAP[r];return o&&(r=o),this.style.format_data=r,this},e}()),$=n("../spread-sheet/src/core/feature/copyPaste/interfaces.ts"),ee=n("../spread-sheet/src/core/utils/index.ts"),te=new(function(){function e(){var e=this;this.desc={name:i.r.cellFormula},this.parseHTML=function(e,t){var n={formula:null};if(!e.ext.noFormula&&e.element){var r=e.element.getAttribute("data-online-sheet-formula");r&&"string"===typeof r&&(n.formula=r,S()(e.info,n))}t()},this.copyToHtml=function(t,n){var r=e.getRelativeFormula(t);return r&&"string"===typeof r?function(e){var t="";return e&&(t=' data-online-sheet-formula="'+e.replace(/"/g,"&#34;")+'" '),t}(r)+n():n()}}return e.prototype.getRelativeFormula=function(e){var t;if(e.cellData){var n,r=null===(t=e.cellData)||void 0===t?void 0:t.getFormula();if(r){var o=r.toString(e.ext.newY,e.ext.newX,e.activeSheet.spreadsheetReference.sheetManager);return e.ext.pasteType===$.lb.copy&&(n=ee.Z.formula.util.getRelativeFormulaWithFormula(o,e.ext.newY,e.ext.newX)),n}}},e}());function ne(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){if(e){if("string"===typeof e)return re(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?re(e,t):void 0}}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0;return function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function re(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}n("../node_modules/core-js/modules/es.function.name.js"),n("../node_modules/core-js/modules/es.symbol.js"),n("../node_modules/core-js/modules/es.symbol.description.js"),n("../node_modules/core-js/modules/es.symbol.iterator.js"),function(e){e[e.TEXT=0]="TEXT",e[e.BR=1]="BR"}(B||(B={}));var oe=function e(t,n,r,o){if(!t)return[];if(3===t.nodeType)return function(e){var t,n=e.textContent;return t=n.replace(/^[\r\n]\s+/,""),(n=t.replace(/[\r\n]\s/g,""))?[{len:n.length,format:null,text:n,type:B.TEXT}]:[]}(t);if(t.nodeType!==Node.ELEMENT_NODE)return[];if("br"==t.tagName.toLowerCase())return[{len:1,format:null,text:"\n",type:B.BR}];var s=function(e,t,n){var r=n(e),o={style:{}};if("a"==e.tagName.toLowerCase()&&(o.style.fontcolor=t("#018ffb"),o.style.underline="underline"),r){var s=r["font-family"];if(s){var i=s.indexOf(",");-1!=i&&(s=s.slice(0,i)),'"'==s[0]&&(s=s.slice(1,s.length-1)),o.style.fontfamily=s}var a=r["font-size"];if(a)if(-1!==a.toString().toLowerCase().indexOf("pt"))o.style.fontsize=a;else{var l=parseFloat(a);l=3*l/4,(l=Math.round(10*l)/10)&&(o.style.fontsize=l+"pt")}var d=t(r.color);d&&(o.style.fontcolor=d);var u=r["font-weight"];"bold"!=u&&700!=u||(o.style.bold="bold"),"italic"==r["font-style"]&&(o.style.italic="italic");var c=r["text-decoration"];c&&(-1!=c.indexOf("underline")&&(o.style.underline="underline"),-1!=c.indexOf("line-through")&&(o.style.strikeline="strikeline"))}return function(e,t){switch(e.tagName.toLowerCase()){case"b":case"strong":t.style.bold="bold";break;case"i":case"em":t.style.italic="italic";break;case"u":case"ins":t.style.underline="underline";break;case"s":case"strike":case"del":t.style.strikeline="strikeline"}return t}(e,o)}(t,n,r),i=t.childNodes;if(i&&i.length){var a=[];if(i.forEach((function(t,o){a=a.concat(e(t,n,r,{isRootNode:!1}))})),!o.isRootNode)for(var l,d=ne(a);!(l=d()).done;){var u=l.value;u&&(u.format?u.format=Object.assign({},s.style,u.format):u.format=Object.assign({},s.style))}return a}return[]},se=function(e,t){return/^[^\S\r\n]+$/.test(e)&&/^[\r\n]$/.test(t)},ie=function(e,t,n){if(!n)return{effectTextFormatRuns:[],allTextFormatRuns:[]};var r=[];return function(e,t){var n=0,r=e.length-1;e.forEach((function(o,s){if(o){if((0===n||s===r)&&o.type===B.TEXT&&/^\s+$/.test(o.text))return;if(se(o.text,e[Math.max(s-1,0)].text))return;t.push({startIndex:n,format:o.format,text:o.text}),n+=o.len}}))}(oe(e,t,n,{isRootNode:!0}),r),r.filter((function(e){return!e.format||!Object.keys(e.format).length})).length===r.length?{effectTextFormatRuns:[],allTextFormatRuns:r}:{effectTextFormatRuns:r,allTextFormatRuns:r}},ae=function(e){return e.replace(/&/g,"&amp;").replace(/\ufeff/g,"").replace(/</g,"&lt;").replace(/>/g,"&gt;")},le=new function(){var e=this;this.desc={name:i.r.cellTextFormat},this.style={},this.getCellValue=function(e,t){var n=e.cellData,r=e.activeSheet,o=null===n||void 0===n?void 0:n.getEffectiveValue(),s=null===n||void 0===n?void 0:n.getTextFormatRuns();if("string"===typeof(null===o||void 0===o?void 0:o.value)&&s){var i=o.value;return""+s.map((function(e,t){var n=s[t+1]?s[t+1].startIndex:i.length,o=i.slice(e.startIndex,n);if(o=ae(o),!e.format)return o;var a=function(e,t){var n=[];return P(e.format,n,t),n.join(";")+";"}(e,r.spreadsheetReference);return'<font style="'+a+'">'+K(e.format,o)+"</font>"})).join("")}return t()},this.copyToHtml=function(){return""},this.parseHTML=function(t,r){if(S()(t.info,{style:e.style}),t.element){try{var o=ie(t.element,Y,t.ext.mSOStyle?t.ext.mSOStyle.getComputedStyle:void 0),s=o.effectTextFormatRuns,i=o.allTextFormatRuns;e.style.textFormatRuns=s,e.style.allTextFormatRuns=i}catch(l){n.g.log.error("cellTextFormatMiddleware parseHTML",l)}var a={style:e.style};S()(t.info,a),e.style={},r()}else r()}},de=new function(){var e=this;this.desc={name:i.r.cellTextPlain},this.getCellValue=function(e,t){var n=e.cellData,r=function(e){return e?(0,D.getMergedValue)(e):""}(n),o=null===n||void 0===n?void 0:n.getCellType();return""+(r=o===L.ZP.STAFF_CARD||o===L.ZP.GROUP_CARD||o===L.ZP.SCHEDULE?"[不支持的媒体类型]":r===x.INVALID_VALUE?(r=((null===n||void 0===n?void 0:n.getEditValue())||"").replace(/\ufeff/g,"")).replace(/</g,"&lt;").replace(/>/g,"&gt;"):ae(r))+t()},this.parseHTML=function(t,n){var r="";S()(t.info,{data:r}),t.element?(r=(r=e.setTextPlainFromTextFormat(t))||t.element.textContent,r=e.formatData(r),S()(t.info,{data:r}),n()):n()},this.formatData=function(e){var t=e;return t=t&&"　"!==t&&" "!==t?t.replace(/([\r\n])([^\S\r\n]+)/g,"$1"):""},this.setTextPlainFromTextFormat=function(e){var t,n,r="";return null===(n=null===(t=e.info.style)||void 0===t?void 0:t.allTextFormatRuns)||void 0===n||n.forEach((function(e){r+=e.text})),r}},ue=n("../spread-sheet/src/core/feature/copyPaste/utils/cellMergeReference.ts"),ce=new function(){this.desc={name:i.r.cellMergeReference},this.copyToHtml=function(e,t){var n=e.ext,r=n.mergeReference,o=n.newX,s=n.newY,i=n.hideRowMap,a=n.hideColMap;return r?(0,ue.J)(r,o,s,i,a)+t():t()}},he=n("../packages/model/src/embedded/index.ts"),fe=n("../packages/model/src/cell/data-validation/data-validation-rule.ts"),pe=n("../packages/model/src/cell/metadata/Metadata.ts"),ge=new(function(){function e(){var e=this;this.desc={name:i.r.cellCustomData},this.info={},this.copyToHtml=function(e,t){var n=e.activeSheet.spreadsheetReference.getSpreadsheetId();return function(e,t){void 0===t&&(t="");var n=null===e||void 0===e?void 0:e.getMetadata(),r=null===n||void 0===n?void 0:n.customDataType;if(!r)return"";if(r===L.ZP.IMAGE||r===L.ZP.STAFF_CARD||r===L.ZP.GROUP_CARD||r===L.ZP.SCHEDULE||r===L.ZP.TODO)return"";var o="data-online-sheet-type='"+r+"' data-online-sheet-value='"+JSON.stringify(null===n||void 0===n?void 0:n.serialize())+"'",s=e.getRefIds();o+=" data-online-sheet-refId='"+(null!==s&&void 0!==s?s:"")+"'";var i=null===e||void 0===e?void 0:e.getRefData();return!i||r!==L.ZP.THIRD_PARTY_APP&&r!==L.ZP.MINI_APP||(o+=" data-online-sheet-refData='"+JSON.stringify(i.serialize())+"'"),r===L.ZP.DATE_REMINDER&&(o+=" data-online-sheet-docId="+t),o}(e.cellData,n)+function(e){var t=null===e||void 0===e?void 0:e.getDataValidation();return t?"data-online-sheet-validation='"+JSON.stringify(t.serialize())+"'":""}(e.cellData)+t()},this.parseHTML=function(t,n){e.parseSelect(t.element).parseDataValidation(t.element);var r=Object.assign({},e.info);S()(t.info,r),e.info={},n()},this.setSelect=function(t,n,r){try{e.info.cellSelect={value:(0,pe.F)(JSON.parse(n)),refId:r.getAttribute("data-online-sheet-refId"),refData:r.getAttribute("data-online-sheet-refData"),type:Number(t),docId:r.getAttribute("data-online-sheet-docId")||void 0}}catch(o){e.info.cellSelect=null}}}var t=e.prototype;return t.parseSelect=function(e){if(e){var t=e.getAttribute("data-online-sheet-type"),n=e.getAttribute("data-online-sheet-value");!function(e,t){return e!==he.EMBEDDED_OBJECT_TYPE.CELL_IMAGE&&t}(t,n)?this.info.cellSelect=null:this.setSelect(t,n,e)}return this},t.parseDataValidation=function(e){if(e){var t=e.getAttribute("data-online-sheet-validation");this.info.dataValidation=t?(0,fe.D)(JSON.parse(t)):null}return this},e}()),me=n("../spread-sheet/src/core/feature/copyPaste/middleware/cell/cellFloatImage.ts");u.register(i.aC.COPY_ON_CELL_VALUE,i.r.cellLink,R),u.register(i.aC.COPY_ON_CELL_VALUE,i.r.cellImage,c.Z),u.register(i.aC.COPY_ON_CELL_VALUE,i.r.cellFloatImage,me.Z),u.register(i.aC.COPY_ON_CELL_VALUE,i.r.cellStyle,X),u.register(i.aC.COPY_ON_CELL_VALUE,i.r.cellTextFormat,le),u.register(i.aC.COPY_ON_CELL_VALUE,i.r.cellTextPlain,de),u.register(i.aC.COPY_ON_CELL_ATTR,i.r.cellMergeReference,ce),u.register(i.aC.COPY_ON_CELL_ATTR,i.r.cellImage,c.Z),u.register(i.aC.COPY_ON_CELL_ATTR,i.r.cellFormula,te),u.register(i.aC.COPY_ON_CELL_ATTR,i.r.cellLink,R),u.register(i.aC.COPY_ON_CELL_ATTR,i.r.cellStyle,X),u.register(i.aC.COPY_ON_CELL_ATTR,i.r.cellCustomData,ge),u.register(i.aC.COPY_ON_CELL_ATTR,i.r.cellTextFormat,le),u.register(i.aC.COPY_ON_CELL_ATTR,i.r.cellTextPlain,de),u.register(i.aC.COPY_ON_TABLE_END,i.r.cellFloatImage,me.Z),u.register(i.aC.CELL_PROPS,i.r.cellImage,c.Z),u.register(i.aC.CELL_PROPS,i.r.cellLink,R),u.register(i.aC.PASTE_ON_PARSE_HTML,i.r.cellMergeReference,ce),u.register(i.aC.PASTE_ON_PARSE_HTML,i.r.cellImage,c.Z),u.register(i.aC.PASTE_ON_PARSE_HTML,i.r.cellFormula,te),u.register(i.aC.PASTE_ON_PARSE_HTML,i.r.cellLink,R),u.register(i.aC.PASTE_ON_PARSE_HTML,i.r.cellStyle,X),u.register(i.aC.PASTE_ON_PARSE_HTML,i.r.cellCustomData,ge),u.register(i.aC.PASTE_ON_PARSE_HTML,i.r.cellTextFormat,le),u.register(i.aC.PASTE_ON_PARSE_HTML,i.r.cellTextPlain,de);var ve=u},"../spread-sheet/src/core/feature/copyPaste/middleware/interface.ts":function(e,t,n){"use strict";var r,o,s,i;n.d(t,{X_:function(){return o},aC:function(){return s},nz:function(){return i},r:function(){return r}}),function(e){e.cellImage="cellImage",e.cellLink="cellLink",e.cellStyle="cellStyle",e.cellFormula="cellFormula",e.cellTextFormat="cellTextFormat",e.cellTextPlain="cellTextPlain",e.cellMergeReference="cellMergeReference",e.cellCustomData="cellCustomData",e.cellFloatImage="cellFloatImage"}(r||(r={})),function(e){e.cellImage="cellImage"}(o||(o={})),function(e){e[e.COPY_ON_CELL_ATTR=0]="COPY_ON_CELL_ATTR",e[e.COPY_ON_CELL_VALUE=1]="COPY_ON_CELL_VALUE",e[e.COPY_ON_TABLE_END=2]="COPY_ON_TABLE_END",e[e.PASTE_ON_PARSE_HTML=3]="PASTE_ON_PARSE_HTML",e[e.CELL_PROPS=4]="CELL_PROPS"}(s||(s={})),function(e){e[e.IDLE=1]="IDLE",e[e.BEFORE_COPY=2]="BEFORE_COPY",e[e.COPY=3]="COPY",e[e.SET_CACHE=4]="SET_CACHE",e[e.COPY_TO_HTML=5]="COPY_TO_HTML",e[e.BEFORE_PARSE=6]="BEFORE_PARSE",e[e.PARSE=7]="PARSE",e[e.PARSE_HTML=8]="PARSE_HTML",e[e.HTML_TABLE=9]="HTML_TABLE",e[e.PROCESS_CELL_DATA=10]="PROCESS_CELL_DATA",e[e.RUN_REQUEST=11]="RUN_REQUEST"}(i||(i={}))},"../spread-sheet/src/core/feature/copyPaste/preVerify/showTips.ui.ts":function(e,t,n){"use strict";n.d(t,{nS:function(){return a},oc:function(){return i}});var r=n("../node_modules/i18next/dist/esm/i18next.js"),o=n("../spread-sheet/src/core/ui/dialog/index.ts"),s=n.g,i=function(){o.dialog.confirm({title:r.ZP.t("提示"),content:r.ZP.t("不能执行与合并单元格相交的粘贴，建议取消合并单元格。"),onOk:function(e){return e.preventDefault(),e.stopPropagation(),s.focus(),!0},onCancel:function(e){e.preventDefault(),e.stopPropagation(),s.focus()}})},a=function(){o.dialog.alert(r.ZP.t("提示"),r.ZP.t("无法对合并单元格执行此操作。"),(function(){}))}},"../spread-sheet/src/core/feature/copyPaste/util.ts":function(e,t,n){"use strict";n.d(t,{$8:function(){return a.$8},Bs:function(){return c},bF:function(){return d},r$:function(){return u}}),n("../node_modules/core-js/modules/es.array.iterator.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/web.dom-collections.iterator.js"),n("../node_modules/core-js/modules/es.array.map.js");var r=n("../spread-sheet/src/core/feature/copyPaste/iconSource.tsx"),o=n("../spread-sheet/src/core/feature/copyPaste/interfaces.ts"),s=n("../packages/model/src/cell/formula/index.ts"),i=n("../packages/model/src/cell/formula/CellRangeWithFixedInfo.ts"),a=n("../spread-sheet/src/core/feature/formula/utils.ts"),l=(new r.Z).iconsList.spinner,d=function(e){for(var t=e.mergeReference,n=e.hiddenRowMap,r=e.copyRange,s=e.copyType,i=e.isCopyForOuter,a=r.endRowIndex,l=r.endColIndex,d=!1,u=t.endColIndex-t.startColIndex+1,c=t.startColIndex,h=c+u-1,f=c,p=c;p<=h;p++){if(p>l)return{xUnit:-1,yUnit:-1,x:-1,y:-1};d||(f=p,d=!0)}for(var g=!1,m=t.endRowIndex-t.startRowIndex+1,v=t.startRowIndex,I=v+m-1,E=v,S=v;S<=I;S++){if(S>a)return{xUnit:-1,yUnit:-1,x:-1,y:-1};!i&&s!==o.lb.copy||!(null===n||void 0===n?void 0:n.get(S))?g||(E=S,g=!0):m-=1}return{xUnit:u,yUnit:m,x:f,y:E}},u=function(e,t,n,r,o){for(var s=n,i=t,a=n;a<=o&&a<e.length;a++)for(var l=t;l<=r&&e[a]&&e[a].values;l++)e[a].values[l]&&(s<a&&(s=a),i<l&&(i=l));return{maxY:s,maxX:i}};function c(e,t){var n=t.cutRanges,r=t.oldRow,o=t.oldCol,a=t.newRow,l=t.newCol,d=e.getParts().map((function(e){if("string"===typeof e)return e;for(var t=e,s=n.length-1;s>-1;s--){var d=n[s],u=e.isContainedByRange({row:r,col:o,range:d});t=(0,i.dt)(t,{oldRow:r,oldCol:o,newRow:a,newCol:l,keepRelativeRelationship:u})}return t}));return s.FormulaModelFactory.createInstance({formulaPartList:d})}var h={loadingView:document.createElement("loadingView"),showLoading:function(e){var t=h.loadingView;return t.setAttribute("width",e.style.width),t.setAttribute("height",e.style.height),t.style.backgroundColor="#E2E2E2",t.style.width=e.style.width,t.style.height=e.style.height,t.style.borderColor="#E2E2E2",t.id="copyLoadingView",t.style.background='url("'+l+'") center left no-repeat',t.style.display="flex",t.style.marginLeft="5px",t.style.content="",e.appendChild(t),t},closeLoading:function(e){e.removeChild(h.loadingView)}}},"../spread-sheet/src/core/feature/copyPaste/utils/cellFloatImage.ts":function(e,t,n){"use strict";n.d(t,{$X:function(){return d},Fb:function(){return h},Px:function(){return c},gh:function(){return u},nC:function(){return g}}),n("../node_modules/core-js/modules/es.number.constructor.js"),n("../node_modules/core-js/modules/es.regexp.exec.js"),n("../node_modules/core-js/modules/es.string.match.js"),n("../node_modules/core-js/modules/es.string.replace.js"),n("../node_modules/core-js/modules/es.string.split.js"),n("../node_modules/core-js/modules/es.object.keys.js"),n("../node_modules/core-js/modules/es.object.assign.js"),n("../node_modules/core-js/modules/es.array.concat.js");var r=n("../packages/model/src/embedded/index.ts"),o=n("../spread-sheet/src/core/feature/copyPaste/convertor/convertShapeData2IAddImage.ts"),s=n("../node_modules/lodash/isArray.js"),i=n.n(s),a=n("../node_modules/lodash/mergeWith.js"),l=n.n(a),d=function(e){return!!e.url&&!(Number(e.width)>0&&Number(e.height)>0)},u=function(e){var t=e.match(/cutShapeIDs[\S]+cutShapeIDs/);if(!t)return[];var n=t[0];return(n=n.replace(/cutShapeIDs/g,"")).split("|")};function c(e){var t=e.rowCount,n=e.colCount,s=e.range,i=e.sheet,a=e.view,d={};return i.imageManager.each((function(e){if(e.type!==r.EMBEDDED_OBJECT_TYPE.CELL_IMAGE){for(var u=e.position.overlayPosition.anchorCell.colIndex,c=e.position.overlayPosition.anchorCell.rowIndex,h=e.position.overlayPosition.offsetXpixels;h>=i.getColWidth(u)&&u<=n-1;)h-=i.getColWidth(u),u+=1;for(var g=e.position.overlayPosition.offsetYpixels,m=a.canvas.rowcolAccessor.getRowDisplayHeight(c);g>=m&&c<=t-1;)g-=m,c+=1;var v=function(e,t,n,r,s,i,a){var l=p(n),d=l.xStart,u=l.xEnd,c=l.yStart,h=l.yEnd;if(e>=c&&e<=h&&t>=d&&t<=u&&function(e,t,n,r,o,s,i){for(var a=p(e),l=a.xEnd,d=a.yEnd,u=!1,c=0,h=0,f=r;f<=d;f++)h+=i.canvas.rowcolAccessor.getRowDisplayHeight(f);for(var g=n;g<=l;g++)c+=i.canvas.rowcolAccessor.getColSetWidth(g);return h-=s,c-=o,t.position.overlayPosition.widthPixels<=c&&t.position.overlayPosition.heightPixels<=h&&(u=!0),u}(n,i,t,e,r,s,a)){var f={},g=e+"_"+t,m=Object.assign({},(0,o.Ir)(i));m.offset.x=r,m.offset.y=s;var v=[];return v.push(m),f[g]=v,f}}(c,u,s,h,g,e,a);l()(d,v,f)}})),d}function h(e){return e&&Object.keys(e).length>0}function f(e,t){if(i()(e))return e.concat(t)}function p(e){var t=e.xRange,n=e.yRange;return{xStart:t[0],xEnd:t[1],yStart:n[0],yEnd:n[1]}}function g(e,t){return!((e<=2||t<=2)&&e*t<=4)}},"../spread-sheet/src/core/feature/copyPaste/utils/cellMergeReference.ts":function(e,t,n){"use strict";n.d(t,{G:function(){return a},J:function(){return s}}),n("../node_modules/core-js/modules/es.array.iterator.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/web.dom-collections.iterator.js");var r=n("../spread-sheet/src/core/feature/copyPaste/util.ts"),o=n("../packages/model/src/range/GridRange.ts");function s(e,t,n,r,o){if(!e)return"";var s=e.getColCount();s=i(s,t,o);var a=e.getRowCount();return' colspan="'+s+'" rowspan="'+(a=i(a,n,r))+'" '}var i=function(e,t,n){for(var r=e,o=t+r-1,s=t;s<=o;s++)(null===n||void 0===n?void 0:n[s])&&n[s].hiddenByUser&&(r-=1);return r},a=function(e){var t,n,s,i=e.cellData,a=e.hiddenRowMap,l=e.copyRange,d=e.x,u=e.y,c=e.rowData,h=e.copyType,f=null===i||void 0===i?void 0:i.getMergeReference();if(!f)return{newX:d,newY:u,newCellData:i,mergeReference:f};var p=(f=f.clone()).startColIndex,g=f.startRowIndex,m=(0,r.bF)({mergeReference:f,hiddenRowMap:a,copyRange:l,isCopyForOuter:!0,copyType:h}),v=m.xUnit,I=m.yUnit,E=m.x,S=m.y;return E===d&&S===u?(f=v>1||I>1?new o.Z("sheetid",S,S+I-1,E,E+v-1):null,t=p,s=c[n=g]?c[n].values[t]:null):f=null,{newX:t||d,newY:n||u,newCellData:s||i,mergeReference:f}}},"../spread-sheet/src/core/feature/copyPaste/utils/getDocsType.ts":function(e,t){"use strict";var n=new(function(){function e(){this.type=null}var t=e.prototype;return t.getApp=function(e){return this.parseFromApp(e)},t.parseFromApp=function(e){e||(this.type=null);var t=null===e||void 0===e?void 0:e.getElementsByTagName("html")[0],n=null===t||void 0===t?void 0:t.getAttribute("xmlns:x");return this.type="excel","urn:schemas-microsoft-com:office:excel"===n?this.type="excel":"tencent"===n&&(this.type="tencent"),this.type},e}());t.Z=n},"../spread-sheet/src/core/feature/copyPaste/utils/mergeRangeUtils.ts":function(e,t,n){"use strict";n.d(t,{Ft:function(){return o},aB:function(){return r},zk:function(){return s}});var r=function(e,t,n){if(!e)return!1;var r=e.getMergeReference();return!!r&&r.startRowIndex===t&&r.startColIndex===n},o=function(e,t,n){if(!e)return!1;var r=e.getMergeReference();return!!r&&(r.startRowIndex!==t||r.startColIndex!==n)},s=function(e,t){for(var n=e.startRowIndex,r=e.startColIndex,o=e.endRowIndex,s=e.endColIndex,i=n;i<=o;i++)for(var a=r;a<=s;a++){var l=t.getCellDataAtPosition(i,a);if(l){var d=l.getMergeReference();if(d&&!e.contain(d))return!1}}return!0}},"../spread-sheet/src/core/feature/copyPaste/utils/parser.ts":function(e,t,n){"use strict";n.d(t,{L1:function(){return a},bU:function(){return s},eO:function(){return i}}),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.regexp.to-string.js"),n("../node_modules/core-js/modules/es.regexp.exec.js"),n("../node_modules/core-js/modules/es.string.replace.js"),n("../node_modules/core-js/modules/es.array.slice.js");var r=n("../spread-sheet/src/base/util/url.ts"),o=n("../packages/report/src/index.ts");function s(e){var t=e.toString();if(-1!==t.toLowerCase().indexOf("pt"))return t;var n=parseFloat(t);return n=3*n/4,n=Math.round(10*n)/10,e?n+"pt":""}function i(e,t,n,s,i){var a=null===t||void 0===t?void 0:t.replace(/^\s+|\s+$/g,""),l=!(!e||!(0,r.lS)(e));if(e&&""!==e&&((0,r.Kc)(e)||l)||i&&i.length>0){var d="web";return l?d="sheet":i&&i.length>0&&(d="cell"),o.ZP.tdwReport({opername:"doc_excel_editor",module:"excel_link",action:"excel_link_set",ver11:"copy",ver10:d,ver12:-1===s?"word_type":"icon_type"}),{link:{url:e,value:a,type:n,linkIconStatus:s,hyperlinkRuns:i}}}return{}}var a=function(e){var t=e,n=t.indexOf(",");return-1!==n&&(t=t.slice(0,n)),'"'===t[0]&&(t=t.slice(1,t.length-1)),t.replace(/-webkit-standard|-webkit-body|-webkit-pictograph/g,"")}},"../spread-sheet/src/core/feature/copyPaste/utils/paste-request.ts":function(e,t,n){"use strict";n.d(t,{i:function(){return s}});var r=n("../spread-sheet/src/core/app/sheetStatus/private-range.ts"),o=n("../spread-sheet/src/core/feature/copyPaste/interfaces.ts"),s=function(e){var t=e.pasteData,n=e.cacheState,r=e.basicFilter,o=e.activeSheetId,s=e.cellImage,h=e.copyRange,f=e.pasteRanges,p=e.infoDimension,g=e.workbookRangeManager,m=e.isFormatPainter,v=e.isFomulaInCut;return!i(t)&&!a(o,n)&&!l(n)&&!r&&!d(s)&&!u(f,h,p)&&!c(g,h)&&!m&&!v},i=function(e){return e.fromType!==o.gN.COPY_CACHE},a=function(e,t){return e!==t.sheetId},l=function(e){return e.copyRangeIsChange},d=function(e){return e&&e.length>0},u=function(e,t,n){return!t||!!n&&!(!t.isCross(e[0])||!n.insertDimensionRanges)},c=function(e,t){return!t||(0,r.Up)(e,[t])}},"../spread-sheet/src/core/feature/copyPaste/utils/url.ts":function(e,t,n){"use strict";n.d(t,{Zp:function(){return s},e3:function(){return a},kb:function(){return i}}),n("../node_modules/core-js/modules/es.array.concat.js"),n("../node_modules/core-js/modules/es.regexp.exec.js"),n("../node_modules/core-js/modules/es.string.match.js");var r=n("../spread-sheet/src/base/util/url.ts"),o=[n("../spread-sheet/src/base/util/appConfig.ts").Z.getConfig("custom.standaloneDomains.qpic_cn")].concat((0,r.kq)());function s(e){return/^data:image\/(png|gif|jpeg|x-icon|jpg|tiff);base64,.+/i.test(e)}function i(e){var t,n=e.match('<img[^<>]*? src="([^<>]*?)"');return!(!(null===n||void 0===n?void 0:n[1])||a(n[1]))&&(t=n[1],!(-1!==o.indexOf(function(e){var t,n;return(n=e.match(/^(?:https?:\/\/)?(?:[^@\n]+@)?(?:www\.)?([^:/\n?=]+)/im))&&(n=(t=n[1]).match(/^[^.]+\.(.+\..+)$/))&&(t=n[1]),t||""}(t)))||s(n[1]))}function a(e){return e.match(/^file:\/\/[/].+(gif|jpg|jpeg|tiff|png)$/i)}},"../spread-sheet/src/core/feature/copyPaste/wxCopyPaste.ui.ts":function(e,t,n){"use strict";n("../node_modules/regenerator-runtime/runtime.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.promise.js"),n("../node_modules/core-js/modules/es.array.iterator.js"),n("../node_modules/core-js/modules/es.string.iterator.js"),n("../node_modules/core-js/modules/web.dom-collections.iterator.js");var r=n("../node_modules/@tencent/docs-user-agent/dist/index.js"),o=n.n(r),s=function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function i(e){try{l(r.next(e))}catch(t){s(t)}}function a(e){try{l(r.throw(e))}catch(t){s(t)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,a)}l((r=r.apply(e,t||[])).next())}))},i=new(function(){function e(){this.serverCopyData={plain:"",html:"",timeStamp:0},this.visibilityState=document.visibilityState||"visible"}var t=e.prototype;return t.init=function(){this.initCopyData(),document.addEventListener("visibilitychange",this.onVisibilitychange.bind(this))},t.copyToSystem=function(e){var t=document.createElement("textarea");t.readOnly=!0,t.style.zIndex="0",t.style.opacity="0",t.style.top="-9999px",t.style.left="-9999px",t.style.position="fixed",document.body.appendChild(t),t.value=e;var n=document.createRange();n.selectNode(t),window.getSelection().addRange(n),t.select(),document.execCommand("SelectAll"),document.execCommand("copy"),document.body.removeChild(t)},t.isCopyOutEnv=function(){return(o().isMobilePhone||o().isAndroidPad||o().isIPad)&&this.isSupportExecCommand()&&(o().isWeChat||o().isMiniProgram)},t.isCopyInEnv=function(){return o().isQQMiniProgram},t.isCopyDataAvailable=function(){return!!this.serverCopyData.plain},t.getServerCopyData=function(e){return void 0===e&&(e=0),s(this,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(""!==this.serverCopyData.plain||e>this.serverCopyData.timeStamp)){t.next=2;break}return t.abrupt("return",this.serverCopyData);case 2:return t.prev=2,t.next=5,this.getDataFromSdk();case 5:t.next=9;break;case 7:t.prev=7,t.t0=t.catch(2);case 9:return t.abrupt("return",this.serverCopyData);case 10:case"end":return t.stop()}}),t,this,[[2,7]])})))},t.isSupportExecCommand=function(){var e,t;return(null===(e=document.queryCommandSupported)||void 0===e?void 0:e.call(document,"copy"))&&(null===(t=document.queryCommandSupported)||void 0===t?void 0:t.call(document,"SelectAll"))},t.getDataFromSdk=function(){return s(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t,r=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.e("bundle_docs-miniapp-sdk").then(n.t.bind(n,"../node_modules/@tencent/docs-miniapp-sdk/dist/index.js",23));case 2:return t=e.sent,e.next=5,t.default.invoke("readSystemClipboard",{}).then((function(e){var t={plain:e}.plain,n=void 0===t?"":t;r.serverCopyData.plain=n})).catch((function(e){console.error(e),r.serverCopyData.plain=""}));case 5:case"end":return e.stop()}}),e)})))},t.onVisibilitychange=function(){var e=document.visibilityState;"hidden"===this.visibilityState&&"visible"===e&&this.initCopyData(),this.visibilityState=e},t.initCopyData=function(){var e=Date.now();this.serverCopyData={plain:"",html:"",timeStamp:e}},e}());t.Z=i},"../spread-sheet/src/core/feature/dataValidation/api/DataValidationUIUtils.ts":function(e,t,n){"use strict";n.d(t,{Ii:function(){return a},Sc:function(){return s},aW:function(){return i}}),n("../node_modules/core-js/modules/es.array.find.js"),n("../node_modules/core-js/modules/es.array.map.js"),n("../node_modules/core-js/modules/es.object.keys.js");var r=n("../packages/model/src/cell/data-validation/data-validation-rule-type.ts"),o=n("../spread-sheet/src/core/feature/dataValidation/type.ts");function s(e,t,n){return function(e){if(null==e)return null;var t=i(e.ruleType),n=null;return null!=t&&null!=e&&(n={validType:t.validType,dataType:t.dataType,inputMessage:e.inputMessage,isStrict:e.isStrict,showDropDown:e.showDropDown,operator:e.operator,argTokens:e.argTokens}),n}(a(e,t,n))}function i(e){switch(e){case r.Z.LIST:return{validType:o.ob.LIST,dataType:o.h6.NONE};case r.Z.NUMBER_INT:return{validType:o.ob.NUMBER,dataType:o.h6.INT};case r.Z.NUMBER_FLOAT_AND_INT:return{validType:o.ob.NUMBER,dataType:o.h6.NONE};case r.Z.CUSTOM_MUST_FLOAT:return{validType:o.ob.NUMBER,dataType:o.h6.FLOAT};case r.Z.TEXT_LENGTH:return{validType:o.ob.TEXT,dataType:o.h6.LENGTH};case r.Z.DATE:return{validType:o.ob.DATE,dataType:o.h6.NONE};case r.Z.CUSTOM_NUM_PHONE:return{validType:o.ob.AVAILABLE,dataType:o.h6.PHONE};case r.Z.CUSTOM_ID_CARD:return{validType:o.ob.AVAILABLE,dataType:o.h6.ID_CARD};case r.Z.CUSTOM_TEXT_CONTAINS:return{validType:o.ob.TEXT,dataType:o.h6.CONTENT};case r.Z.CUSTOM_TEXT_MAIL:return{validType:o.ob.AVAILABLE,dataType:o.h6.MAIL};case r.Z.CUSTOM_TEXT_URL:return{validType:o.ob.AVAILABLE,dataType:o.h6.URL};case r.Z.CUSTOM_TEXT_GENDER:return{validType:o.ob.AVAILABLE,dataType:o.h6.GENDER};case r.Z.CUSTOM_NUMBER_TEMPERATURE:return{validType:o.ob.NUMBER,dataType:o.h6.TEMPERATURE};case r.Z.CUSTOM_NUM_TEL:return{validType:o.ob.AVAILABLE,dataType:o.h6.TELEPHONE};case r.Z.CUSTOM_CHECKBOX:return{validType:o.ob.CHECKBOX,dataType:o.h6.NONE};case r.Z.CUSTOM_STAR:return{validType:o.ob.STAR,dataType:o.h6.NONE};case r.Z.CUSTOM_PROGRESS:return{validType:o.ob.NUMBER,dataType:o.h6.PROGRESS};case r.Z.CUSTOM_ATTACHMENT:return{validType:o.ob.ATTACHMENT,dataType:o.h6.NONE};case r.Z.CUSTOM_CONTACT:return{validType:o.ob.CONTACT,dataType:o.h6.NONE}}return null}function a(e,t,n){var r=e.getCellDataAtPosition(t,n);return r?r.getDataValidation():null}n("../packages/model/src/cell/metadata/CustomDataType.ts"),n("../packages/model/src/cell/index.ts"),n("../spread-sheet/src/core/feature/dataValidation/constant.ts")},"../spread-sheet/src/core/feature/dataValidation/type.ts":function(e,t,n){"use strict";var r,o,s;n.d(t,{h6:function(){return r},ob:function(){return o},sS:function(){return s}}),function(e){e.CONTENT="content",e.LENGTH="length",e.INT="int",e.FLOAT="float",e.ID_CARD="id-card",e.PHONE="phone",e.MAIL="mail",e.URL="url",e.GENDER="gender",e.NONE="none",e.TEMPERATURE="temperature",e.PROGRESS="progress",e.TELEPHONE="telephone"}(r||(r={})),function(e){e.LIST="list",e.NUMBER="number",e.TEXT="text",e.DATE="date",e.AVAILABLE="available",e.CHECKBOX="checkbox",e.STAR="star",e.ATTACHMENT="attachment",e.CONTACT="contact"}(o||(o={})),function(e){e[e.NONE=0]="NONE",e[e.INT=1]="INT",e[e.FLOAT=2]="FLOAT",e[e.LENGTH=3]="LENGTH",e[e.DATE=4]="DATE"}(s||(s={}))},"../spread-sheet/src/core/feature/formula/calcControllerTaskQueue.ts":function(e,t,n){"use strict";n.d(t,{gI:function(){return o},x2:function(){return s}});var r=[];function o(e){r.push(e)}function s(){for(;r.length>0;){var e=r.pop();e&&e()}}},"../spread-sheet/src/core/feature/formula/utils/parseUtil.ts":function(e,t,n){"use strict";n.d(t,{E:function(){return h},EG:function(){return c},nn:function(){return u}}),n("../node_modules/core-js/modules/web.dom-collections.for-each.js"),n("../node_modules/core-js/modules/es.string.trim.js"),n("../node_modules/core-js/modules/es.regexp.exec.js"),n("../node_modules/core-js/modules/es.string.replace.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.regexp.to-string.js");var r,o=n("../packages/model/src/cell/formula/CellRangeWithFixedInfo.ts"),s=n("../packages/model/src/cell/formula/FormulaModel.ts"),i=n("../packages/model/src/cell/index.ts"),a=n("../node_modules/@tencent/sheet-formula-sdk/lib/index.js"),l=n("../spread-sheet/src/core/feature/formula/utils.ts"),d=[];function u(e){r=e,d.forEach((function(e){f(e)})),d=[]}function c(e,t,n,i,d){void 0===d&&(d={});var u=d,c=u.filterViewRelativeRow,h=u.filterViewRelativeCol,f=r.parse,p=e.replace(/^=/,"").trim(),g=(0,l.k1)(t,n,i),m=f(p,{row:t,col:n,sheetId:i,id:g}),v=function(e,t,n,r){return void 0!==n&&(e=n),void 0!==r&&(t=r),{formulaRowIndex:e,formulaColIndex:t}}(t,n,c,h);if(t=v.formulaRowIndex,n=v.formulaColIndex,a.AD.isCellNode(m)){var I,E=((I={})[a.AD.AST_TYPE.CELL]=function(e,r,s){var i=r.cellId,d="",u="";a.AD.isCellNodeCrossTable(r)&&(d=r.sheetId,u=r.sheetId);var c=a.AD.isCurrentNodeInPositionRelyFunction(r,s),h=(0,l.cn)(i),f=h.row,p=h.col,g=h.isRowRelative,m=h.isColRelative,v=g?f-t:f,I=m?p-n:p;e.push(o.ZP.createInstance({startColIndex:I,endColIndex:I,startRowIndex:v,endRowIndex:v,isStartColRelative:m,isEndColRelative:m,isStartRowRelative:g,isEndRowRelative:g,isPositionRely:c,startSheetId:d,endSheetId:u}))},I[a.AD.AST_TYPE.CELL_RANGE]=function(e,r,s){var i=r.originValue,d=r.cellRangeType,u=r.start,c=r.end,h="",f="",p=a.AD.isCurrentNodeInPositionRelyFunction(r,s);if(a.AD.isCellRangeNodeCrossTable(r)&&(h=r.startSheetId,f=r.endSheetId),"COL"===d){var g=!/\$/.test(u),m=!/\$/.test(c),v=(0,a.VT)(u)-(g?n:0),I=(0,a.VT)(c)-(m?n:0);e.push(o.ZP.createInstance({startColIndex:v,endColIndex:I,startRowIndex:0,endRowIndex:0,isStartColRelative:g,isEndColRelative:m,isStartRowRelative:!0,isEndRowRelative:!0,isColArray:!0,isPositionRely:p,startSheetId:h,endSheetId:f}))}else if("ROW"===d){var E=!/\$/.test(u),S=!/\$/.test(c),R=(0,a.Fz)(u)-(E?t:0),w=(0,a.Fz)(c)-(S?t:0);e.push(o.ZP.createInstance({startColIndex:0,endColIndex:0,startRowIndex:R,endRowIndex:w,isStartColRelative:!0,isEndColRelative:!0,isStartRowRelative:E,isEndRowRelative:S,isRowArray:!0,isPositionRely:p,startSheetId:h,endSheetId:f}))}else if("NORMAL"===d){var A=(0,l.cn)(u),C=A.row,y=A.col,_=A.isRowRelative,T=A.isColRelative,x=(0,l.cn)(c),b=x.row,D=x.col,O=x.isRowRelative,M=x.isColRelative,j=Math.min(y,D),L=Math.max(y,D),Z=Math.min(b,C),k=Math.max(C,b),N=_?Z-t:Z,P=T?j-n:j,U=O?k-t:k,F=M?L-n:L;e.push(o.ZP.createInstance({startColIndex:P,endColIndex:F,startRowIndex:N,endRowIndex:U,isStartColRelative:T,isEndColRelative:M,isStartRowRelative:_,isEndRowRelative:O,isPositionRely:p,startSheetId:h,endSheetId:f}))}else e.push(i)},I),S=[];m.body&&(S=m.body.toFormulaModel(E));for(var R=[],w="=",A=0;A<S.length;A++){var C=S[A];o.ZP.isTargetType(C)?(""!==w&&(R.push(w),w=""),R.push(C)):w+=C,A===S.length-1&&""!==w&&R.push(w)}return s.Z.createInstance({formulaPartList:R})}return s.Z.createInstance({formulaPartList:[e]})}function h(e){var t=e.cellDataDelta;0!==(t.setSlots&1<<i.CELL_DATA_SLOT.SLOT_FORMULA)&&t.delta.formula&&(r?f(e):d.push(e))}function f(e){var t,n=e.cellDataDelta,r=e.spreadsheet,o=e.sheetId,s=e.rowIndex,i=e.colIndex,a=n.delta.formula,l=!1,d=!1,u=5e3;if(a.getParts().forEach((function(e){if("string"===typeof e){var t=e.toLowerCase();(t.indexOf("row")>-1||t.indexOf("offset")>-1)&&(l=!0)}else Array.isArray(e)&&e.isPositionRely&&(d=!0)})),l&&!d){var h=c(a.toString(u,u,r.sheetManager),u,u,"NOEXIST"),f=null===(t=r.sheetManager.getSheetBySheetId(o))||void 0===t?void 0:t.getCellDataAtPosition(s,i,{isIgnoreFilterView:!0});f&&f.setFormula(h)}}},"../spread-sheet/src/core/feature/formula/workUtils.ts":function(e,t,n){"use strict";n.d(t,{f:function(){return s}}),n("../node_modules/core-js/modules/web.dom-collections.for-each.js"),n("../node_modules/core-js/modules/es.array.iterator.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/web.dom-collections.iterator.js");var r=n("../spread-sheet/src/core/feature/formula/UIUtils.ts"),o=n("../packages/model/src/cell/metadata/CustomDataType.ts");function s(e,t){var n=e.sheetManager.getSheetBySheetId(t),o=function(e){var t=!1,n=!1;if(e)for(var o=e.getRowCount(),s=e.getColCount(),a=0;a<o&&(!t||!n);a++){var l=e.data.rowData[a];if(l)for(var d=0;d<s&&(!t||!n);d++){var u=l.values[d];u&&(t=t||(0,r.j)(u.getEditValue()),n=n||i(u))}}return{hasFormula:t,hasDataValidation:n}}(n),s=o.hasFormula,a=o.hasDataValidation,l=!!n&&n.conditionalFormatRuleManager.rules.length>0,d=function(e,t){var n=!1;return e.size>0&&e.forEach((function(e){n||e.range&&e.range.sheetId===t&&(n=!0)})),n}(e.workbookRangeManager.chartWorkbookRangeMap,t);return{hasFormula:s,hasDataValidation:a,hasChart:d,hasConditionalFormat:l,needLoadInWorker:s||a||d||l}}function i(e){var t=e.getDataValidation();if(!t)return!1;var n=e.getCellType();if(!n)return!0;var r=!(n!==o.d9.DATE_TIME||!t.operator);return(0,o.NI)(n)||(0,o.J$)(n,t)||r}},"../spread-sheet/src/core/feature/relateForm/api.ts":function(e,t,n){"use strict";n.d(t,{mX:function(){return E},rD:function(){return m},Np:function(){return g},Vv:function(){return T},JC:function(){return C},ZG:function(){return _},RF:function(){return I},HX:function(){return v},PJ:function(){return w}}),n("../node_modules/regenerator-runtime/runtime.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.promise.js"),n("../node_modules/core-js/modules/es.array.slice.js"),n("../node_modules/core-js/modules/es.array.map.js"),n("../node_modules/core-js/modules/es.array.iterator.js"),n("../node_modules/core-js/modules/es.string.iterator.js"),n("../node_modules/core-js/modules/web.dom-collections.iterator.js"),n("../node_modules/core-js/modules/es.object.assign.js"),n("../node_modules/core-js/modules/es.array.filter.js");var r,o,s=n("./node_modules/axios/index.js"),i=n.n(s),a=n("../packages/utils/src/safe.ts"),l=n("../spread-sheet/src/core/data/configService/spreadConfig.ts"),d=n("../spread-sheet/src/core/feature/relateForm/constant.ts"),u=n("../node_modules/i18next/dist/esm/i18next.js");!function(e){e[e.Doc=0]="Doc",e[e.Sheet=1]="Sheet",e[e.Form=2]="Form"}(r||(r={})),function(e){e[e.NORMAL=0]="NORMAL",e[e.REMOVED=1]="REMOVED",e[e.IN_TRASHCAN=2]="IN_TRASHCAN"}(o||(o={}));var c=n("../spread-sheet/src/core/feature/relateForm/relate-form.interface.ts"),h=n("../spread-sheet/src/base/util/appConfig.ts"),f=function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function i(e){try{l(r.next(e))}catch(t){s(t)}}function a(e){try{l(r.throw(e))}catch(t){s(t)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,a)}l((r=r.apply(e,t||[])).next())}))},p=function(e,t){e.length>d.$l&&(e=e.slice(0,d.$l));var n,r=Date.now(),o=!e.length,s=l.q.getConfig("isUserChangeTitle")?l.q.getConfig("title"):"",i={formName:u.ZP.t("无标题收集表"),updateTime:r,title:s,subtitle:"",author:l.q.getConfig("userName"),themeClass:"default",padId:l.q.getConfig("padId"),isDirty:!0,rightBarClicked:!1,globalPadId:l.q.getConfig("globalPadId")};return n=o?function(e){return[{id:"blank-1",section:0,title:u.ZP.t("未命名的问题"),subtitle:"",placeholder:u.ZP.t("输入问题，例如“你的姓名”"),isDirty:!1,createTime:e,updateTime:e,type:"SIMPLE",qdata:{placeholder:u.ZP.t("请填写")},validate:[{type:12,rules:{max:100,open:!1},message:u.ZP.t("输入内容需不超过100个字符。")}],toggle:{required:!1,randomOption:!1,showValidate:!1,showSubtitle:!1},questionDescripe:{simpleFirstIndex:0,simpleSecondIndex:0,simpleUserInputContent:"",simpleUserInputContentSupply:"",simpleUserInputErrorMessage:""}},{id:"blank-2",section:0,title:u.ZP.t("未命名的问题"),subtitle:"",placeholder:u.ZP.t("输入问题，例如“你的性别”"),isDirty:!1,createTime:e,updateTime:e,type:"RADIO",qdata:{options:[{id:111,title:u.ZP.t("选项 1")},{id:222,title:u.ZP.t("选项 2")}]},validate:null,toggle:{required:!1,randomOption:!1,showValidate:!1,showSubtitle:!1}}]}(r):e.map((function(e,t){return function(e,t,n){var r=n.title,o=n.type,s=void 0===o?c.c.SIMPLE:o;return{id:"blank-"+e,section:0,title:r.substr(0,d.er),subtitle:"",placeholder:u.ZP.t("输入问题，例如“你的姓名”"),isDirty:!0,createTime:t,updateTime:t,type:s,qdata:{placeholder:u.ZP.t("请填写")},validate:[{type:12,rules:{max:100,open:!1},message:u.ZP.t("输入内容不超过100个字符。")}],toggle:{required:!1,randomOption:!1,showValidate:!1,showSubtitle:!1},questionDescripe:{simpleFirstIndex:0,simpleSecondIndex:0,simpleUserInputContent:"",simpleUserInputContentSupply:"",simpleUserInputErrorMessage:""}}}(t,r,e)})),o&&!t||(i.questions=n,i.sections=[{sid:0,title:"",qlist:n.map((function(e){return null===e||void 0===e?void 0:e.id}))}]),i};function g(e,t,n,r,o){var s={sheet_id:{doc_id:l.q.getConfig("globalPadId"),sub_id:e},form_text:"",form_title:t||"",need_create_sub_sheet:!0,sub_sheet_name:t,isFromLeadBanner:o},i=p(n||[],r);return i.title=s.form_title,s.form_text=JSON.stringify(i),new Promise((function(e,t){$.ajax({url:"//"+h.Z.getConfig("runtime.domainName")+"/form/collect/from_sheet",type:"POST",xhrFields:{withCredentials:!0},data:{data:JSON.stringify(s),xsrf:(0,a.f)()},success:function(t){e(t)},error:function(e){t(e)}})}))}function m(e){var t={bind:!1,sheet_id:{doc_id:e.sheetGlobalId,sub_id:e.sheetSubId},form_id:e.formGlobalId};return new Promise((function(e,n){$.ajax({url:"//"+h.Z.getConfig("runtime.domainName")+"/form/collect/bind_sheet",type:"POST",xhrFields:{withCredentials:!0},data:{data:JSON.stringify(t),xsrf:(0,a.f)()},success:function(t){e(t)},error:function(e){n(e)}})}))}function v(e){var t="//"+h.Z.getConfig("runtime.domainName")+"/form/data/getpubrev";return i().get(t,{params:{padId:e,xsrf:(0,a.f)()},withCredentials:!0}).then((function(e){var t=e.data;return 0===t.retcode?t.data:t})).catch((function(e){var t;null===(t=n.g.log)||void 0===t||t.error("getStateOfRelateForm",null===e||void 0===e?void 0:e.stack)}))}function I(e){var t="//"+h.Z.getConfig("runtime.domainName")+"/form/collect/recordcnt",r=JSON.stringify({global_padid:e,need_self_sid:!0,need_uid_sid:0}),o=new FormData;return o.append("data",r),i().post(t,o,{headers:{"Content-Type":"multipart/form-data"}}).then((function(e){return e.data})).catch((function(e){var t;null===(t=n.g.log)||void 0===t||t.error("getRecordCount",null===e||void 0===e?void 0:e.stack)}))}function E(e,t){return f(this,void 0,void 0,regeneratorRuntime.mark((function n(){var r,o,s,a,d,u,c,h;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r="/form/collect/to_sheet",o=l.q.getConfig("domainId"),s=l.q.getConfig("localPadId"),n.next=5,C(o,s);case 5:return a=n.sent,d={form_id:{doc_id:e},sheet_id:o+"$"+s,sheet_url:a.docUrl,export_to_local:!1},t&&(d.sheet_type=t),(u=new FormData).append("data",JSON.stringify(d)),n.next=13,i()({url:r,data:u,method:"POST",withCredentials:!0});case 13:return c=n.sent,h=c.data,n.abrupt("return",h);case 16:case"end":return n.stop()}}),n)})))}function S(e){return f(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n,r,o,s;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n={form_id:{doc_id:e},export_to_local:!0},(r=new FormData).append("data",JSON.stringify(n)),t.next=6,i()({url:"/form/collect/to_sheet",data:r,method:"POST",withCredentials:!0});case 6:return o=t.sent,s=o.data,t.abrupt("return",s);case 9:case"end":return t.stop()}}),t)})))}function R(e){return f(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n,r,o,s;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n={global_padid:e},(r=new FormData).append("data",JSON.stringify(n)),t.next=6,i()({url:"/form/collect/export_process",data:r,method:"POST",withCredentials:!0});case 6:return o=t.sent,s=o.data,t.abrupt("return",s);case 9:case"end":return t.stop()}}),t)})))}function w(e,t){return f(this,void 0,void 0,regeneratorRuntime.mark((function n(){var r,o,s,i,a,l,d=this;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r=1e4,o=1e3,s=36e5,i=Date.now(),n.next=6,S(e);case 6:if(0===n.sent.retcode){n.next=11;break}return t({isFailed:!0,rate:0}),n.abrupt("return");case 11:a=!1,l=function n(){return f(d,void 0,void 0,regeneratorRuntime.mark((function l(){var d,u,c,h,f,p,g;return regeneratorRuntime.wrap((function(l){for(;;)switch(l.prev=l.next){case 0:if(!(Date.now()-i>=s)){l.next=3;break}return t({isFailed:!0,rate:0}),l.abrupt("return");case 3:return d=setTimeout((function(){a=!0,t({isFailed:!0,rate:0})}),r),l.next=6,R(e);case 6:if(u=l.sent,c=u.rate,h=void 0===c?0:c,f=u.url,p=u.retcode,clearTimeout(d),!a){l.next=14;break}return l.abrupt("return");case 14:if(0===p){l.next=17;break}return t({isFailed:!0,rate:0}),l.abrupt("return");case 17:g=Math.min(100,h),t({fileUrl:f,rate:g=f?100:g,isFailed:!1}),g<100&&setTimeout(n,o);case 21:case"end":return l.stop()}}),l)})))},l();case 14:case"end":return n.stop()}}),n)})))}function A(e){return f(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n,r,o,s;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n={global_id:e},(r=new FormData).append("data",JSON.stringify(n)),t.next=6,i()({url:"/form/collect/get_conf",data:r,method:"POST",withCredentials:!0});case 6:return o=t.sent,s=o.data,t.abrupt("return",s.syn_limit_cnt||d.Vh);case 9:case"end":return t.stop()}}),t)})))}function C(e,t){return f(this,void 0,void 0,regeneratorRuntime.mark((function n(){var r,o,s;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r={domainId:e,localPadId:t,xsrf:(0,a.f)()},n.next=4,i()({url:"/cgi-bin/online_docs/doc_info",params:r,method:"POST",withCredentials:!0});case 4:return o=n.sent,s=o.data,n.abrupt("return",{meta:s.doc_meta,docUrl:""+location.protocol+s.doc_url,creatorNick:s.creator_nick});case 7:case"end":return n.stop()}}),n)})))}function y(e){return f(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n,r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=3,i()({url:"/form/collect/get_unsubmit_users",method:"POST",data:{global_padid:e}});case 3:return n=t.sent,r=n.data,t.abrupt("return",r.users||[]);case 6:case"end":return t.stop()}}),t)})))}function _(e){var t=e.index,n=void 0===t?0:t,r=e.limit,o=void 0===r?15:r;return f(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t,r,s,l,d=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(t=new FormData).append("xsrf",(0,a.f)()),t.append("list_type","6"),t.append("owner_filter","true"),t.append("is_owner","1"),t.append("type_filter","true"),t.append("doc_type","2"),t.append("sort_type","2"),t.append("start",""+n),t.append("limit",""+o),e.next=13,i()({url:"/cgi-bin/online_docs/doclist",method:"POST",data:t});case 13:if(r=e.sent,0!==(s=r.data).list_info.length){e.next=17;break}return e.abrupt("return",{list:[],hasNextPage:!1,nextPageIndex:s.next});case 17:return e.next=19,Promise.all(s.list_info.map((function(e){return f(d,void 0,void 0,regeneratorRuntime.mark((function t(){var n,r,o;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,C(e.domain_id,e.pad_id);case 2:return r=t.sent,o={title:e.title,docId:{pad_id:e.pad_id,domain_id:e.domain_id},relativeDoc:null===(n=r.meta.relative_doc)||void 0===n?void 0:n[0]},t.abrupt("return",o);case 5:case"end":return t.stop()}}),t)})))})));case 19:return l=e.sent,e.abrupt("return",{list:l||[],nextPageIndex:s.next,hasNextPage:0!==s.next});case 21:case"end":return e.stop()}}),e)})))}function T(){return f(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t,n,s;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=function(e){return f(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n,s,i,a,l,d,u,c,h,f,p,g,m;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,C(e.domain_id,e.pad_id);case 2:if((n=t.sent).meta.doc_type===r.Form){t.next=5;break}return t.abrupt("return",void 0);case 5:if(n.meta.doc_status===o.NORMAL){t.next=7;break}return t.abrupt("return",void 0);case 7:return s=n.meta,i=n.creatorNick,a=n.docUrl,l=s.doc_id,d=l.domain_id+"$"+l.pad_id,t.next=12,Promise.all([y(d),I(d),A(d)]);case 12:return u=t.sent,c=u[0],h=u[1],f=u[2],p=h.user_cnt||h.total_cnt-h.del_cnt||0,g=h.total_cnt-h.del_cnt||0,m=c.length,t.abrupt("return",Object.assign(Object.assign({},x(s)),{docUrl:a,fillUserCount:p,fillAnswerCount:g,unFillUserCount:m,isClosed:h.is_closed,creatorNickName:i,syncLimit:f}));case 20:case"end":return t.stop()}}),t)})))},e.next=3,C(l.q.getConfig("domainId"),l.q.getConfig("padId"));case 3:if(t=e.sent,0!==(n=(t.meta.relative_doc||[]).map((function(e){return e.doc_id}))).length){e.next=7;break}return e.abrupt("return",[]);case 7:return e.next=9,Promise.all(n.map((function(e){return s(e)})));case 9:return e.abrupt("return",e.sent.filter((function(e){return void 0!==e})));case 10:case"end":return e.stop()}}),e)})))}function x(e){var t=e.title,n=e.relative_doc;return{title:t,docId:e.doc_id,relatedSheet:n&&{subId:n[0].sub_id,docId:{padId:n[0].doc_id.pad_id,domainId:n[0].doc_id.domain_id},docUrl:n[0].doc_url}}}},"../spread-sheet/src/core/feature/relateForm/constant.ts":function(e,t,n){"use strict";n.d(t,{$l:function(){return o},Vh:function(){return a},er:function(){return s},qF:function(){return i}});var r=n("../spread-sheet/src/base/util/appConfig.ts"),o=100,s=100,i="https://"+r.Z.getConfig("runtime.domainName")+"/mall/index/form/collect",a=7e3},"../spread-sheet/src/core/feature/relateForm/seeker-util.ts":function(e,t,n){"use strict";n.d(t,{CV:function(){return f},Fh:function(){return p},GY:function(){return E},LH:function(){return I},g8:function(){return m},ns:function(){return v},o_:function(){return g}});var r=n("../node_modules/@babel/runtime/helpers/esm/toConsumableArray.js"),o=(n("../node_modules/core-js/modules/es.regexp.constructor.js"),n("../node_modules/core-js/modules/es.regexp.exec.js"),n("../node_modules/core-js/modules/es.regexp.to-string.js"),n("../node_modules/core-js/modules/es.array.map.js"),n("../node_modules/core-js/modules/es.array.iterator.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/web.dom-collections.iterator.js"),n("../node_modules/core-js/modules/web.dom-collections.for-each.js"),n("../node_modules/core-js/modules/es.map.js"),n("../node_modules/core-js/modules/es.string.iterator.js"),n("../node_modules/core-js/modules/esnext.map.delete-all.js"),n("../node_modules/core-js/modules/esnext.map.every.js"),n("../node_modules/core-js/modules/esnext.map.filter.js"),n("../node_modules/core-js/modules/esnext.map.find.js"),n("../node_modules/core-js/modules/esnext.map.find-key.js"),n("../node_modules/core-js/modules/esnext.map.includes.js"),n("../node_modules/core-js/modules/esnext.map.key-of.js"),n("../node_modules/core-js/modules/esnext.map.map-keys.js"),n("../node_modules/core-js/modules/esnext.map.map-values.js"),n("../node_modules/core-js/modules/esnext.map.merge.js"),n("../node_modules/core-js/modules/esnext.map.reduce.js"),n("../node_modules/core-js/modules/esnext.map.some.js"),n("../node_modules/core-js/modules/esnext.map.update.js"),n("../node_modules/core-js/modules/es.array.splice.js"),n("../node_modules/core-js/modules/es.array.slice.js"),n("../node_modules/core-js/modules/es.array.includes.js"),n("../node_modules/core-js/modules/es.string.includes.js"),n("../node_modules/core-js/modules/es.array.concat.js"),n("../node_modules/core-js/modules/es.string.split.js"),n("../node_modules/core-js/modules/es.number.constructor.js"),n("../node_modules/core-js/modules/es.array.from.js"),n("../node_modules/core-js/modules/es.array.filter.js"),n("../packages/model/src/range/GridRange.ts")),s=n("../node_modules/lodash/throttle.js"),i=n.n(s),a=n("../spread-sheet/src/core/feature/relateForm/constant.ts"),l=n("../node_modules/i18next/dist/esm/i18next.js"),d=new RegExp(l.ZP.t("(序号|编号|姓名|名字|名称|人员|成员|商品名称|负责人|岗位|职位|性别|电话|联系方式|号码|手机号|民族|籍贯|毕业院校|专业|学位|学历|身份证|身份证号码|户口所在地|金额|类型|工作单位|年龄|项目|类别|分类|事项|产品|日期|时间|日期时间|星期|生日|出生月日|进展|阶段进展|阶段成果|项目进展|项目成果|状态|下周计划|目标|任务|KPI|OKR|备注|说明|价格|售价|单价|部门|语文|数学|英语|政治|历史|地理|物理|化学|生物)",{nsSeparator:"#"}),"i");function u(e){return e.values.map((function(e){var t;if(!e||(null===(t=e.getMetadata())||void 0===t?void 0:t.customDataType))return null;var n=null===e||void 0===e?void 0:e.getEditValue(),r=null===e||void 0===e?void 0:e.getFormattedValue();return(null===r||void 0===r?void 0:r.value)||n}))}var c=function(e,t){for(var n=t;n>=0;n--)if(e[n])return e[n];return null},h=function(e){for(var t=e[e.length-1];!t;)e.pop(),t=e[e.length-1]},f=function(e,t){for(var n=[],r=0;r<t.length;r++){var o=t[r];n.push({col:r,row:e,value:(o||"-").substr(0,a.er)})}return n};function p(e,t){var n=t.slice(0);n=function(e,t){var n=[],r=function(e){return null===e||void 0===e?void 0:e.getMergeReference()};return t.forEach((function(t){var o=e[t],s=u(o),i=o.values.some(r),a="",l=new Map;s.forEach((function(e){var t=e||"";l.set(t,1),a+=t}));for(var d=0,c=a.length,h=0;h<c;h++)a.charCodeAt(h)>128&&(d+=1);(!i&&d/c<.2||l.size<2)&&n.push(t)})),n.forEach((function(e){var n=t.indexOf(e);t.splice(n,1)})),t}(e,n);var o=new Map,s=[],i=[],a=0;return n.forEach((function(t,n){var l=u(e[t]),d=[].concat(i),f=a;a=l.length,h(l),i.length=0,e[t].values.forEach((function(e){return function(e,t){var n=null===t||void 0===t?void 0:t.getMergeReference();if(n&&!(n.endRowIndex>10)){var r=n.startRowIndex+","+n.endRowIndex;e.includes(r)||e.push(r)}}(i,e)})),i.forEach((function(e){return s.includes(e)?null:s.push(e)}));var p=!!s.length,g=!!d.length,m=o.get(n-1);if(p&&g&&s.some((function(e){return d.includes(e)}))&&m){var v=function(e,t,n){for(var o=(0,r.Z)(e),s=0;s<n;s++){var i=t[s],a=e[s]?e[s]:c(e,s);i&&a&&(o[s]=a+" - "+i)}return o}(m,l,f);o.set(n-1,v)}else o.set(n,l)})),{cellIndexMap:o,indexs:n,mergeRanges:s}}function g(e,t){for(var n=[],r=0;r<10;r++){var o=t[r];!e[r]||o&&o.hiddenByUser||n.push(r)}for(var s=[],i=0;i<n.length;i++)for(var a=n[i],l=e[a].values,d=0,u=0;u<l.length;u++){var c=l[u];if(null===c||void 0===c?void 0:c.getEditValue()){if((d+=1)>=2){s.push(a);break}}else d=0}return s}function m(e,t,n){var r=t.cellIndexMap,o=t.indexs,s=t.mergeRanges.map((function(e){return e.split(",").map((function(e){return Number(e)}))})),i=new Map;r.forEach((function(e,t){var n={emptys:0,solids:0,keywords:0,total:0},r=e.slice(0);h(r);for(var o=0;o<r.length;o++){var s=r[o];s||0===o?n.solids+=1:n.emptys-=1,d.test(s)&&(n.keywords+=2)}n.total=n.emptys+n.solids+n.keywords,i.set(t,n)}));var a=[];i.forEach((function(e){a.push(e.total)}));var l=a.indexOf(Math.max.apply(null,a)),u=Array.from(i.keys())[l],f=o[u];s=s.filter((function(e){var t=e[0],n=e[1];return f>=t&&f<=n}));var p=r.get(u)||[];return s.length&&s.some((function(e){return e[0]===e[1]&&e[0]===f}))&&e[f].values.forEach((function(e,t){if((null===e||void 0===e?void 0:e.getMergeReference())&&t<p.length&&null===p[t]){var r=c(p,t);r&&n?p.splice(t,1,r):p.splice(t,1)}})),{headData:p,hitLine:f,merges:s}}function v(e){try{var t=function(e,t){void 0===t&&(t=!1);var n=e.data;if(!n||!n.rowData||!n.rowMetadata)return null;var r=n.rowData,o=m(r,p(r,g(r,n.rowMetadata)),t),s=o.headData,i=o.hitLine,a=o.merges;return i>=0?{headDatas:f(i,s),merges:a}:null}(e,!0);if(!t||0===t.headDatas.length)return null;var n=t.headDatas,s=t.merges,i=n[0],a=i.row,l=i.col,d=n[n.length-1].col,u=0===s.length?a:Math.max.apply(Math,(0,r.Z)(s.map((function(e){return e[e.length-1]}))));return new o.Z(e.getSheetId(),a,u,l,d)}catch(c){return console.error(c),null}}function I(e){var t=v(e);return t&&new o.Z(e.getSheetId(),0,t.endRowIndex,t.startColIndex,t.endColIndex)}var E=i()(v,15)},"../spread-sheet/src/core/feature/relateFormEnt/enterpriseStatus.ts":function(e,t,n){"use strict";n.d(t,{BQ:function(){return p},JY:function(){return g},VH:function(){return u},n_:function(){return h},pq:function(){return c}}),n("../node_modules/regenerator-runtime/runtime.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.promise.js"),n("../node_modules/core-js/modules/es.regexp.exec.js"),n("../node_modules/core-js/modules/es.string.split.js"),n("../node_modules/core-js/modules/es.string.match.js"),n("../node_modules/core-js/modules/es.regexp.constructor.js"),n("../node_modules/core-js/modules/es.regexp.to-string.js");var r=n("../node_modules/i18next/dist/esm/i18next.js"),o=n("../node_modules/@tencent/docs-user-agent/dist/index.js"),s=n.n(o),i=n("../node_modules/@tencent/dui/lib/components/Modal/index.js"),a=n("../node_modules/@tencent/dui-mobile/lib/components/Modal/index.js"),l=n("../spread-sheet/src/core/feature/relateFormEnt/api.tsx"),d=(n("./node_modules/axios/index.js"),n("../spread-sheet/src/base/util/domain-config.ts"),function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function i(e){try{l(r.next(e))}catch(t){s(t)}}function a(e){try{l(r.throw(e))}catch(t){s(t)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,a)}l((r=r.apply(e,t||[])).next())}))}),u=(s().isWeChat,!0),c=(!s().isWeChat&&s().isMiniProgram,(null===window||void 0===window?void 0:window.tdocs)||{}),h=function(){return/mobile/.test(navigator.userAgent.toLowerCase())?f("wdocs","1.0.0")>=0:!function(){var e=navigator.userAgent.toLowerCase();return/wxdrive/.test(e)}()&&!(f("wxwork","3.1.18")<0)};function f(e,t){var n=function(e){var t=navigator.userAgent.toLowerCase(),n=t.match(new RegExp(e+"\\/(\\d+\\.\\d+\\.\\d+)"))||t.match(new RegExp(e+"\\/(\\d+\\.\\d+)"));return n?n[1]:""}(e);if(n==t)return 0;for(var r=n.split("."),o=t.split("."),s=0;r[s]&&o[s];){if(+r[s]!=+o[s])return+r[s]>+o[s]?1:-1;s+=1}return r[s]?1:o[s]?-1:0}function p(e){var t,n;if(h()&&(null===window||void 0===window?void 0:window.tdocs))s().isMobile?null===(t=window.tdocs)||void 0===t||t.openUrl({url:e,target:1}):null===(n=window.tdocs)||void 0===n||n.openInTab({url:e});else{if(s().isWeChat&&!s().isWxWork)return;s().isMiniProgram?(s().isMobile?a.default:i.Modal).confirm({title:r.ZP.t("提示"),content:r.ZP.t("因小程序限制无法直接打开链接，请将链接粘贴至浏览器查看"),onOk:function(){(0,l.T_)(e)}}):window.open(e)}}var g=function(){var e={relateform:!0,wedrive:!0,wedoc:!0,txdocGray:!1},t=function(){return d(void 0,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:t.next=2;break;case 2:return t.abrupt("return",Promise.resolve(e));case 3:case"end":return t.stop()}}),t)})))};return t(),{fetch:t,get:function(){return e}}}()},"../spread-sheet/src/core/feature/relateFormEnt/formInterface.ts":function(e,t,n){"use strict";n.d(t,{ce:function(){return i},jX:function(){return u},rN:function(){return l},uv:function(){return d}}),n("../node_modules/core-js/modules/es.object.assign.js");var r,o,s,i,a=n("../node_modules/i18next/dist/esm/i18next.js");!function(e){e.SIMPLE="SIMPLE",e.RADIO="RADIO",e.CHECKBOX="CHECKBOX",e.SELECT="SELECT",e.DATE="DATE",e.TIME="TIME",e.TEMPERATURE="TEMPERATURE",e.LOCATION="LOCATION",e.IMAGE="IMAGE",e.CANVAS="CANVAS"}(s||(s={})),function(e){e[e.SIMPLE=0]="SIMPLE",e[e.RADIO=1]="RADIO",e[e.CHECKBOX=2]="CHECKBOX",e[e.SELECT=3]="SELECT",e[e.DATE=4]="DATE",e[e.TIME=5]="TIME",e[e.TEMPERATURE=6]="TEMPERATURE",e[e.LOCATION=7]="LOCATION",e[e.IMAGE=8]="IMAGE",e[e.CANVAS=9]="CANVAS"}(i||(i={}));var l=((r={})[i.SIMPLE]=["SIMPLE",a.ZP.t("问答题")],r[i.RADIO]=["RADIO",a.ZP.t("单选题")],r[i.CHECKBOX]=["CHECKBOX",a.ZP.t("多选题")],r[i.SELECT]=["SELECT",a.ZP.t("下拉选择题")],r[i.DATE]=["DATE",a.ZP.t("日期题")],r[i.TIME]=["TIME",a.ZP.t("时间题")],r[i.TEMPERATURE]=["TEMPERATURE",a.ZP.t("温度题")],r[i.LOCATION]=["LOCATION",a.ZP.t("地理位置题")],r[i.IMAGE]=["IMAGE",a.ZP.t("收集图片")],r[i.CANVAS]=["CANVAS",a.ZP.t("签名题")],r),d=((o={})[i.SIMPLE]={section:0,subtitle:"",placeholder:a.ZP.t("输入问题，例如“你的姓名”"),isDirty:!1,type:"SIMPLE",qdata:{placeholder:a.ZP.t("请填写")},validate:[{type:12,rules:{max:100,open:!1},message:a.ZP.t("输入内容需不超过100个字符。")}],toggle:{required:!1,randomOption:!1,showValidate:!1,showSubtitle:!1},questionDescripe:{simpleFirstIndex:0,simpleSecondIndex:0,simpleUserInputContent:"",simpleUserInputContentSupply:"",simpleUserInputErrorMessage:""}},o[i.RADIO]={section:0,subtitle:"",placeholder:a.ZP.t("输入问题，例如“你的性别”"),isDirty:!1,type:"RADIO",qdata:{options:[{id:"111",title:a.ZP.t("选项 1")},{id:"222",title:a.ZP.t("选项 2")}]},validate:null,toggle:{required:!1,randomOption:!1,showValidate:!1,showSubtitle:!1}},o[i.CHECKBOX]={type:"CHECKBOX",subtitle:"",isDirty:!1,placeholder:a.ZP.t("请输入问题"),validate:[],dataType:1,toggle:{required:!0,showValidate:!1},qdata:{placeholder:a.ZP.t("添加选项"),options:[{id:"1",title:a.ZP.t("选项 1"),isExtend:!1},{id:"2",title:a.ZP.t("选项 2"),isExtend:!1}]},validateInput:{type:"MIN",number:1}},o[i.SELECT]={type:"SELECT",subtitle:"",isDirty:!1,placeholder:a.ZP.t("请输入问题"),validate:[],dataType:1,toggle:{required:!0,showValidate:!1},qdata:{placeholder:a.ZP.t("请选择"),options:[{id:"1",title:a.ZP.t("选项 1"),isExtend:!1},{id:"2",title:a.ZP.t("选项 2"),isExtend:!1}]}},o[i.DATE]={type:"DATE",subtitle:"",isDirty:!1,placeholder:a.ZP.t("请输入问题"),validate:[{type:13,rules:{},message:a.ZP.t("请输入有效的时间"),ruletype:70}],dataType:3,toggle:{required:!0,showValidate:!1},qdata:{subType:"datetime",format:a.ZP.t('yyyy"年"m"月"d"日" hh:mm')}},o[i.TIME]={type:"TIME",subtitle:"",isDirty:!1,placeholder:a.ZP.t("请输入问题"),validate:[{type:13,rules:{},message:a.ZP.t("请输入有效的时间"),ruletype:70}],dataType:3,toggle:{required:!0,showValidate:!1},qdata:{subType:"timetype",format:"hh:mm"}},o[i.TEMPERATURE]={type:"TEMPERATURE",subtitle:"",isDirty:!1,placeholder:a.ZP.t("请输入问题"),validate:[{type:13,rules:{},message:a.ZP.t("请输入小于 200 的正整数或携带一位小数的正值。"),ruletype:90}],dataType:1,toggle:{required:!0,showValidate:!1},qdata:{unit:"celsius"}},o[i.LOCATION]={type:"LOCATION",subtitle:"",isDirty:!1,placeholder:a.ZP.t("请输入问题"),validate:[],dataType:1,toggle:{required:!0,showValidate:!1},qdata:{}},o[i.IMAGE]={type:"IMAGE",subtitle:"",isDirty:!1,placeholder:a.ZP.t("请输入问题"),validate:[],dataType:1,toggle:{required:!0,showValidate:!1},qdata:{}},o[i.CANVAS]={type:"CANVAS",subtitle:"",isDirty:!0,placeholder:a.ZP.t("请输入问题"),validate:[],dataType:1,toggle:{required:!0,showValidate:!1},qdata:{}},o),u=[Object.assign(Object.assign({},d[i.SIMPLE]),{id:"1",title:a.ZP.t("未命名的问题")}),Object.assign(Object.assign({},d[i.RADIO]),{id:"2",title:a.ZP.t("未命名的问题")})]},"../spread-sheet/src/core/feature/relateFormEnt/interface.ts":function(e,t,n){"use strict";var r,o;n.d(t,{Wj:function(){return o}}),function(e){e[e.Unknow=0]="Unknow",e[e.Text=1]="Text",e[e.Radio=2]="Radio",e[e.Checkbox=3]="Checkbox",e[e.StudentKey=4]="StudentKey",e[e.Location=5]="Location",e[e.NameAutoFill=6]="NameAutoFill",e[e.DepartmentAutoFill=7]="DepartmentAutoFill",e[e.Exception=8]="Exception",e[e.Image=9]="Image",e[e.File=10]="File",e[e.Date=11]="Date"}(r||(r={})),function(e){e[e.draft=1]="draft",e[e.vote=4]="vote",e[e.queue=8]="queue",e[e.customDocTpl=128]="customDocTpl"}(o||(o={}))},"../spread-sheet/src/core/feature/relateFormEnt/seeker.ts":function(e,t,n){"use strict";n.d(t,{Z:function(){return x}}),n("../node_modules/core-js/modules/es.array.iterator.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/web.dom-collections.iterator.js"),n("../node_modules/core-js/modules/es.array.find.js"),n("../node_modules/core-js/modules/es.array.slice.js"),n("../node_modules/core-js/modules/es.map.js"),n("../node_modules/core-js/modules/es.string.iterator.js"),n("../node_modules/core-js/modules/esnext.map.delete-all.js"),n("../node_modules/core-js/modules/esnext.map.every.js"),n("../node_modules/core-js/modules/esnext.map.filter.js"),n("../node_modules/core-js/modules/esnext.map.find.js"),n("../node_modules/core-js/modules/esnext.map.find-key.js"),n("../node_modules/core-js/modules/esnext.map.includes.js"),n("../node_modules/core-js/modules/esnext.map.key-of.js"),n("../node_modules/core-js/modules/esnext.map.map-keys.js"),n("../node_modules/core-js/modules/esnext.map.map-values.js"),n("../node_modules/core-js/modules/esnext.map.merge.js"),n("../node_modules/core-js/modules/esnext.map.reduce.js"),n("../node_modules/core-js/modules/esnext.map.some.js"),n("../node_modules/core-js/modules/esnext.map.update.js"),n("../node_modules/core-js/modules/web.dom-collections.for-each.js"),n("../node_modules/core-js/modules/es.array.includes.js"),n("../node_modules/core-js/modules/es.string.includes.js"),n("../node_modules/core-js/modules/es.array.map.js"),n("../node_modules/core-js/modules/es.regexp.exec.js"),n("../node_modules/core-js/modules/es.string.split.js"),n("../node_modules/core-js/modules/es.number.constructor.js"),n("../node_modules/core-js/modules/es.array.from.js"),n("../node_modules/core-js/modules/es.array.filter.js"),n("../node_modules/core-js/modules/es.array.splice.js"),n("../node_modules/core-js/modules/es.function.name.js"),n("../node_modules/core-js/modules/es.symbol.js"),n("../node_modules/core-js/modules/es.symbol.description.js"),n("../node_modules/core-js/modules/es.symbol.iterator.js");var r=n("../packages/model/src/range/GridRange.ts"),o=n("../spread-sheet/src/base/dynamicImport/config.ts"),s=n("../packages/model/src/cell/metadata/CustomDataType.ts"),i=n("../node_modules/@babel/runtime/helpers/esm/toConsumableArray.js"),a=(n("../node_modules/core-js/modules/es.array.concat.js"),n("../node_modules/lodash/throttle.js"));function l(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){if(e){if("string"===typeof e)return d(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?d(e,t):void 0}}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0;return function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function d(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var u=/(序号|编号|姓名|名字|名称|人员|成员|商品名称|负责人|岗位|职位|性别|电话|联系方式|号码|手机号|民族|籍贯|毕业院校|专业|学位|学历|身份证|身份证号码|户口所在地|金额|类型|工作单位|年龄|项目|类别|分类|事项|产品|日期|时间|日期时间|星期|生日|出生月日|进展|阶段进展|阶段成果|项目进展|项目成果|状态|下周计划|目标|任务|KPI|OKR|备注|说明|价格|售价|单价|部门|语文|数学|英语|政治|历史|地理|物理|化学|生物)/i;function c(e){return e.values.map((function(e){var t;if(!e||(null===(t=e.getMetadata())||void 0===t?void 0:t.customDataType))return null;var n=null===e||void 0===e?void 0:e.getEditValue(),r=null===e||void 0===e?void 0:e.getFormattedValue();return(null===r||void 0===r?void 0:r.value)||n}))}var h=function(e,t){for(var n=t;n>=0;n--)if(e[n])return e[n];return null},f=function(e){for(var t=e[e.length-1];!t;)e.pop(),t=e[e.length-1]},p=function(e,t){for(var n=[],r=0;r<t.length;r++){var o=t[r];n.push({col:r,row:e,value:(o||"-").substr(0,100)})}return n};function g(e,t){var n=t.slice(0);n=function(e,t){var n=[],r=function(e){return null===e||void 0===e?void 0:e.getMergeReference()};return t.forEach((function(t){var o=e[t],s=c(o),i=o.values.some(r),a="",l=new Map;s.forEach((function(e){var t=e||"";l.set(t,1),a+=t}));for(var d=0,u=a.length,h=0;h<u;h++)a.charCodeAt(h)>128&&(d+=1);(!i&&d/u<.2||l.size<2)&&n.push(t)})),n.forEach((function(e){var n=t.indexOf(e);t.splice(n,1)})),t}(e,n);var r=new Map,o=[],s=[],a=0;return n.forEach((function(t,n){var l=c(e[t]),d=[].concat(s),u=a;a=l.length,f(l),s.length=0,e[t].values.forEach((function(e){return function(e,t){var n=null===t||void 0===t?void 0:t.getMergeReference();if(n&&!(n.endRowIndex>10)){var r=n.startRowIndex+","+n.endRowIndex;e.includes(r)||e.push(r)}}(s,e)})),s.forEach((function(e){return o.includes(e)?null:o.push(e)}));var p=!!o.length,g=!!d.length,m=r.get(n-1);if(p&&g&&o.some((function(e){return d.includes(e)}))&&m){var v=function(e,t,n){for(var r=(0,i.Z)(e),o=0;o<n;o++){var s=t[o],a=e[o]?e[o]:h(e,o);s&&a&&(r[o]=a+" - "+s)}return r}(m,l,u);r.set(n-1,v)}else r.set(n,l)})),{cellIndexMap:r,indexs:n,mergeRanges:o}}function m(e,t){for(var n=[],r=0;r<10;r++){var o=t[r];!e[r]||o&&o.hiddenByUser||n.push(r)}for(var s=[],i=0;i<n.length;i++)for(var a=n[i],l=e[a].values,d=0,u=0;u<l.length;u++){var c=l[u];if(null===c||void 0===c?void 0:c.getEditValue()){if((d+=1)>=2){s.push(a);break}}else d=0}return s}function v(e,t,n){for(var r,o=t.cellIndexMap,s=t.indexs,i=t.mergeRanges.map((function(e){return e.split(",").map((function(e){return Number(e)}))})),a=new Map,d=l(o);!(r=d()).done;){var c=r.value,p=c[0],g={emptys:0,solids:0,keywords:0,total:0},m=c[1].slice(0);f(m);for(var v=0;v<m.length;v++){var I=m[v];I||0===v?g.solids+=1:g.emptys-=1,u.test(I)&&(g.keywords+=2)}g.total=g.emptys+g.solids+g.keywords,a.set(p,g)}for(var E,S=[],R=l(a.values());!(E=R()).done;){var w=E.value;S.push(w.total)}var A=S.indexOf(Math.max.apply(null,S)),C=Array.from(a.keys())[A],y=s[C];i=i.filter((function(e){var t=e[0],n=e[1];return y>=t&&y<=n}));var _=o.get(C)||[];return i.length&&i.some((function(e){return e[0]===e[1]&&e[0]===y}))&&e[y].values.forEach((function(e,t){if((null===e||void 0===e?void 0:e.getMergeReference())&&t<_.length&&null===_[t]){var r=h(_,t);r&&n?_.splice(t,1,r):_.splice(t,1)}})),{headData:_,hitLine:y,merges:i}}n.n(a)()((function(e){try{var t=function(e,t){void 0===t&&(t=!1);var n=e.data;if(!n||!n.rowData||!n.rowMetadata)return null;var r=n.rowData,o=v(r,g(r,m(r,n.rowMetadata)),t),s=o.headData,i=o.hitLine,a=o.merges;return i>=0?{headDatas:p(i,s),merges:a}:null}(e,!0);if(!t||0===t.headDatas.length)return null;var n=t.headDatas,o=t.merges,s=n[0],a=s.row,l=s.col,d=n[n.length-1].col,u=0===o.length?a:Math.max.apply(Math,(0,i.Z)(o.map((function(e){return e[e.length-1]}))));return new r.Z(e.getSheetId(),a,u,l,d)}catch(c){return console.error(c),null}}),15);var I=n("../spread-sheet/src/external/rangeAuth/constants/range-auth-event.ts"),E=n("../spread-sheet/src/core/app/sheetStatus/auth-range.ts");function S(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){if(e){if("string"===typeof e)return R(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?R(e,t):void 0}}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0;return function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function R(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var w=function(e,t){for(var n=t;n>=0;n--)if(e[n])return e[n];return null},A=function(e){for(var t=e[e.length-1];!t;)e.pop(),t=e[e.length-1]},C=function(e,t,n,o,i){for(var a,l=[],d=n[t],u=(null===d||void 0===d?void 0:d.values)||[],c=0;c<o;c++){var h=u[c],f=(null===h||void 0===h?void 0:h.getEditValue())||"",p=null===h||void 0===h?void 0:h.getFormula(),g=null===h||void 0===h?void 0:h.getMergeReference(),m=null===h||void 0===h?void 0:h.getDataValidation(),v=null===h||void 0===h?void 0:h.getMetadata();if(!f&&g){var I=g.startRowIndex,S=g.startColIndex,R=null===(a=n[I])||void 0===a?void 0:a.values[S];R&&(f=R.getEditValue()||"")}var w=T(e,t,c,g),A=!(0,E.Nb)(e,[g||new r.Z(e.spreadsheet.activeSheetId,t,t,c,c)]),C=y(e,t,c),x=(null===m||void 0===m?void 0:m.ruleType)||null,b=void 0,D=null;(null===v||void 0===v?void 0:v.customDataType)===s.ZP.IMAGE&&(D={url:e.spreadsheet.activeSheet.imageManager.getImage(h.getRefIds()[0]).url}),i&&(b=_(i,t,c)),l.push({col:c,row:t,value:f,isFormula:!!p,isMerge:!!g,dvRule:x,isRangeAuth:w,isRangeAuthRead:A,isInHighWater:C,cellImage:D,floatImage:b})}return l};function y(e,t,n){var o=e.spreadsheet.activeSheetId;return e.sheetStatus.isRangeCanEditByHighWater(new r.Z(o,t,t,n,n))}function _(e,t,n){var r=e.getCellFloatImages(t,n);return r.length>0?r:void 0}function T(e,t,n,s){var i,a,l=e.spreadsheet.activeSheetId,d=null===(i=e.serviceCollection.services.get(o.Z.MOBILE_RANGE_AUTH))||void 0===i?void 0:i.instance,u=null===(a=null===d||void 0===d?void 0:d.rangeAuthUtil.getActiveSheetRangeIds())||void 0===a?void 0:a.rangeIds;if(!(null===u||void 0===u?void 0:u.length))return!0;var c=s||{startRowIndex:t,endRowIndex:t,startColIndex:n,endColIndex:n},h=c.startRowIndex,f=c.endRowIndex,p=c.startColIndex,g=c.endColIndex;return e.sheetStatus.getRangeCanEdit(new r.Z(l,h,f,p,g))}var x=function(){function e(e){var t=this;this.onMutationChange=function(){t.panelUpdateFn&&t.panelUpdateFn()},this.onCooperationAddNewRangeDone=function(){t.onMutationChange()},this.app=e,this.initConfig()}var t=e.prototype;return t.isFillAble=function(){var e=this;if(this.getHeader(),!this.isHit()||this.activeRow<0)return!1;if(this.merges[0]){if(!this.merges.every((function(t){var n=t[1];return e.activeRow>n})))return!1}else if(this.activeRow<=this.hitLine)return!1;return!0},t.isQuicklookAble=function(){return this.getHeader(),this.isHit()},t.getHeader=function(e){this.activeCol=-1,this.activeRow=-1,this.hitLine=-1,this.merges=[],this.isQuickFill=!!e;try{return this.find()}catch(t){return console.error(t),this.getResult()}},t.getRowData=function(e){var t=this.getData().rowData||[];return e<t.length&&e>=0?t[e]:[]},t.addListener=function(e){this.panelUpdateFn=e,this.app.mutationBehavior.emitter.addListener(this.app.mutationBehavior.EVENT.AFTER_MUTATION_RUN,this.onMutationChange),this.app.event.rangeAuthEvent.listen(I.k.COOERATION_ADD_NEW_RANGE_DONE,this.onCooperationAddNewRangeDone)},t.removeListener=function(){this.panelUpdateFn=null,this.app.mutationBehavior.emitter.removeListener(this.app.mutationBehavior.EVENT.AFTER_MUTATION_RUN,this.onMutationChange),this.app.event.rangeAuthEvent.remove(I.k.COOERATION_ADD_NEW_RANGE_DONE,this.onCooperationAddNewRangeDone)},t.getQuickFillRange=function(){var e=this.getHeader(),t=e.activeCol,n=e.activeRow,r=this.app.spreadsheet.activeSheet.getRowCount();return{fillRowRange:[this.hitLine+1,r-1],activeCol:t,activeRow:n}},t.getQuickFillData=function(e,t){var n=this.getHeader(),r=n.headDatas,o=n.activeCol,s=n.activeRow,i=this.app.spreadsheet.activeSheet.data;return{headDatas:r,activeCol:o,activeRow:s,rowData:C(this.app,e,i.rowData,r.length,t)}},t.isHit=function(){return this.hitLine>=0},t.initConfig=function(){this.MAX_FIND_ROWS=10,this.VALID_CONTINUES=2,this.KEYWORD_REG=/(序号|编号|姓名|名字|名称|人员|成员|商品名称|负责人|岗位|职位|性别|电话|联系方式|号码|手机号|民族|籍贯|毕业院校|专业|学位|学历|身份证|身份证号码|户口所在地|金额|类型|工作单位|城市|地点|年龄|项目|类别|分类|事项|产品|日期|时间|日期时间|星期|生日|出生月日|进展|阶段进展|阶段成果|项目进展|项目成果|状态|下周计划|目标|任务|KPI|OKR|备注|说明|价格|售价|单价|部门|语文|数学|英语|政治|历史|地理|物理|化学|生物)/i},t.getResult=function(e){return void 0===e&&(e=[]),{headDatas:e,line:this.hitLine,merges:this.merges,activeCol:this.activeCol,activeRow:this.activeRow,activeRowDatas:this.activeRowDatas||[]}},t.find=function(){var e=this.getData();if(!e||!e.rowData||!e.rowMetadata)return this.getResult();var t=this.app.view.getSelection();this.activeRow=t.activeCell.rowIndex,this.activeCol=t.activeCell.colIndex;var n=e.rowData,r=v(n,g(n,m(n,e.rowMetadata)),this.isQuickFill),o=r.headData,s=r.hitLine,i=r.merges;return this.hitLine=s,this.merges=i,this.isQuickFill&&-1!==this.activeRow?this.activeRowDatas=C(this.app,this.activeRow,n,o.length):this.activeRowDatas=[],this.isHit()?this.getResult(function(e,t){for(var n=[],r=0;r<t.length;r++){var o=t[r];n.push({col:r,row:e,value:o||"-"})}return n}(this.hitLine,o)):this.getResult()},t.getData=function(){return this.app.spreadsheet.sheetManager.getSheetBySheetId(this.app.spreadsheet.getActiveSheetId()).data},t.getValidRowIndexs=function(e,t){for(var n=[],r=0;r<this.MAX_FIND_ROWS;r++)if(e[r]){var o=t[r];o&&o.hiddenByUser||n.push(r)}for(var s=[],i=0;i<n.length;i++){for(var a=n[i],l=e[a].values,d=0,u=0,c=0;c<l.length;c++){var h=l[c];(null===h||void 0===h?void 0:h.getEditValue())?(u+=1)>=this.VALID_CONTINUES&&(d+=1):u=0}d&&s.push(a)}return s},t.getHeadFromValidRows=function(e,t){var n=this,r=t.slice(0);r=this.filterInvalidContents(e,r);for(var o=this.getLineValues(e,r),s=this.getMergeValues(e,r),i=new Map,a=function(e){var t=o[e],r=s[e],a=s[e-1],l=[],d=[];r.forEach((function(e){if(e){var t=e.startRowIndex+","+e.endRowIndex;l.push(t),n.merges.includes(t)||n.merges.push(t)}})),a&&a.forEach((function(e){e&&d.push(e.startRowIndex+","+e.endRowIndex)}));var u=!!l.length,c=!!d.length,h=i.get(e-1);u&&c&&l.some((function(e){return d.includes(e)}))&&h?(h.push(t),i.set(e-1,h)):i.set(e,[t])},l=0;l<o.length;l++)a(l);for(var d,u=new Map,c=S(i);!(d=c()).done;){var h=d.value,f=h[0],p=h[1],g=p[0].slice(0),m=this.getMergeCombines(g,p);A(m),u.set(f,m)}return{cellIndexMap:u,indexs:r}},t.getMergeCombines=function(e,t){var n=e.slice(0);if(t.length>1)for(var r=1;r<t.length;r++)for(var o=t[r],s=0;s<e.length;s++){var i=o[s],a=e[s]?e[s]:w(e,s);i&&a&&(n[s]=a+" - "+i)}return n},t.getMatching=function(e,t){var n=this,r=t.cellIndexMap,o=t.indexs;this.merges=this.merges.map((function(e){return e.split(",").map((function(e){return Number(e)}))}));for(var s,i=new Map,a=S(r);!(s=a()).done;){var l=s.value,d=l[0],u={emptys:0,solids:0,keywords:0,total:0},c=l[1].slice(0);A(c);for(var h=0;h<c.length;h++){var f=c[h];f?u.solids+=1:u.emptys-=1,this.KEYWORD_REG.test(f)&&(u.keywords+=2)}u.total=u.emptys+u.solids+u.keywords,i.set(d,u)}for(var p,g=[],m=S(i.values());!(p=m()).done;){var v=p.value;g.push(v.total)}var I=g.indexOf(Math.max.apply(null,g)),E=Array.from(i.keys())[I];this.hitLine=o[E],this.merges=this.merges.filter((function(e){var t=e[0],r=e[1];return n.hitLine>=t&&n.hitLine<=r}));var R=r.get(E)||[];return this.merges.length&&this.merges.some((function(e){return e[0]===e[1]&&e[0]===n.hitLine}))&&this.getMergeValues(e,[this.hitLine])[0].forEach((function(e,t){if(e&&t<R.length&&null===R[t]){var r=w(R,t);r&&n.isQuickFill?R.splice(t,1,r):R.splice(t,1)}})),R},t.filterInvalidContents=function(e,t){var n=this.getLineValues(e,t),r=this.getMergeValues(e,t),o=[];return n.forEach((function(e,n){var s=!r[n].every((function(e){return null===e})),i="",a=new Map;e.forEach((function(e){var t=e||"";a.set(t,1),i+=t}));for(var l=0,d=i.length,u=0;u<d;u++)i.charCodeAt(u)>128&&(l+=1);if(!s&&l/d<.2||a.size<2){var c=t[n];o.push(c)}})),o.forEach((function(e){var n=t.indexOf(e);t.splice(n,1)})),t},t.getLineValues=function(e,t){return t.map((function(t){return e[t].values.map((function(e){var t=null===e||void 0===e?void 0:e.getEditValue(),n=null===e||void 0===e?void 0:e.getFormattedValue();return(null===n||void 0===n?void 0:n.value)||t}))}))},t.getMergeValues=function(e,t){return t.map((function(t){return e[t].values.map((function(e){return null===e||void 0===e?void 0:e.getMergeReference()}))}))},e}()},"../spread-sheet/src/core/login/utils.ts":function(e,t,n){"use strict";n.d(t,{Bp:function(){return d},F$:function(){return u},J3:function(){return a},Xj:function(){return c},Yv:function(){return f},t4:function(){return l}}),n("../node_modules/core-js/modules/es.regexp.exec.js"),n("../node_modules/core-js/modules/es.string.replace.js"),n("../node_modules/core-js/modules/es.string.split.js"),n("../node_modules/core-js/modules/es.number.constructor.js"),n("../node_modules/core-js/modules/es.array.join.js"),n("../node_modules/core-js/modules/es.function.name.js");var r=n("../packages/common-utils/src/index.ts"),o=n("../packages/report/src/index.ts"),s=(n("../node_modules/@tencent/docs-user-agent/dist/index.js"),n("../spread-sheet/src/core/data/configService/spreadConfig.ts"),n("../node_modules/@tencent/docs-multi-tools/dist/index.js")),i=n("../spread-sheet/src/base/util/appConfig.ts");function a(e){var t=e.errCode,n=e.cgi,s=e.loginType,i=void 0===s?"pskey_expired":s,a=n.split("?")[0].replace(/.*?(?=\/ep\/api)/g,""),l=Number((0,r.ej)("loginTime")||0),d=Number(localStorage.getItem("renewalTime")||0),u=l?new Date(l).toLocaleString():"null",c=d?new Date(d).toLocaleString():"null",h=new Date,f={opername:"tech_doc",module:"b_login_project",action:"doc_login",table:"dc03111",ver6:[u,l,c,d,h.toLocaleString(),h,"web",t,a,i,"core-sheet"].join(";")};o.ZP.tdwReport(f)}function l(e){return"skey"===e?((0,r.A0)("p_uin"),(0,r.A0)("p_skey"),(0,r.A0)("p_luin"),(0,r.A0)("p_lskey"),(0,r.A0)("loginTime"),void localStorage.removeItem("renewalTime")):"uid"===e?((0,r.A0)("uid"),(0,r.A0)("uid",i.Z.getConfig("custom.standaloneDomains.qq_com"),"/"),(0,r.A0)("uid_key"),(0,r.A0)("loginTime"),void localStorage.removeItem("renewalTime")):((0,r.A0)("utype"),(0,r.A0)("is_bind"),(0,r.A0)("p_uin"),(0,r.A0)("p_skey"),(0,r.A0)("p_luin"),(0,r.A0)("p_lskey"),(0,r.A0)("uid"),(0,r.A0)("uid",i.Z.getConfig("custom.standaloneDomains.qq_com"),"/"),(0,r.A0)("uid_key"),(0,r.A0)("TOK"),(0,r.A0)("ES2"),(0,r.A0)("loginTime"),void localStorage.removeItem("renewalTime"))}function d(){return[(0,s.isLogin)(),(0,r.ej)("p_uin")&&(0,r.ej)("p_skey"),(0,r.ej)("p_luin")&&(0,r.ej)("p_lskey")].some((function(e){return e}))}function u(){return(0,r.ej)("p_uin")&&(0,r.ej)("p_skey")?0:(0,r.ej)("p_luin")&&(0,r.ej)("p_lskey")?1:-1}function c(e){return 11e3===e||11005===e||11006===e||1e5===e}var h=["BLgBlcbwatiW"];function f(){var e=n.g.spreadConfig.getConfig("padId");return-1!==h.indexOf(e)}},"../spread-sheet/src/core/script-loader/index.ts":function(e,t,n){"use strict";n.d(t,{$y:function(){return a},CN:function(){return i}});var r=n("../packages/report/src/index.ts"),o=n("../spread-sheet/src/core/script-loader/script-loader.ts"),s={};function i(){o.W.init("/components/feature/assets.v1.json")}function a(e,t){r.ZP.jank.stopReport(),s[e]?(t(s[e],!1),r.ZP.jank.restartReport()):o.W.load(e,(function(n){s[e]=n,t(n,!0),r.ZP.jank.restartReport()}))}},"../spread-sheet/src/core/script-loader/script-loader.ts":function(e,t,n){"use strict";n.d(t,{W:function(){return c}}),n("../node_modules/core-js/modules/es.array.join.js"),n("../node_modules/core-js/modules/web.dom-collections.for-each.js"),n("../node_modules/core-js/modules/es.object.keys.js"),n("../node_modules/core-js/modules/es.array.splice.js");var r=n("../packages/common-utils/src/index.ts"),o=n("../node_modules/@tencent/alloy-cdn-retry-plugin/lib/adapter.js"),s=n("../spread-sheet/src/base/util/appConfig.ts");function i(){}function a(e,t){return e+=e.indexOf("?")>=0?"&":"?"+t}!function(){if("function"===typeof window.CustomEvent)return!1;function e(e,t){var n=t||{bubbles:!1,cancelable:!1,detail:void 0},r=document.createEvent("CustomEvent");return r.initCustomEvent(e,n.bubbles,n.cancelable,n.detail),r}e.prototype=window.Event.prototype,n.g.CustomEvent=e}();var l=-1,d=(0,o.A)(),u=d.getRetryCountLimit(),c={metadata:null,firstLoaded:{},asset:{React:{url:s.Z.getConfig("runtime.library.TENCENT_DOCS_LIBRARY__react"),state:l}},assetLoaded:!1,events:{},cache:{},evtArr:[],init:function(e,t,n,r){var o=this;void 0===t&&(t=i),void 0===n&&(n=i),void 0===r&&(r=0),this.assetLoaded||(r||(this.asset=this.asset||{},this.asset.QReport={url:s.Z.getConfig("runtime.library.TENCENT_DOCS_LIBRARY__alloyreport_latest"),state:l},this.loadReport()),r<=2?this.ajax({url:a(e,"_t="+Date.now()),success:function(e){o.metadata=e.data.metadata,delete e.data.metadata,delete e.data.ScriptLoader,Object.keys(e.data).forEach((function(t){if(o.asset[t]={url:e.data[t].js||null,state:l},e.data[t].dependency){var n=e.data[t].dependency;o.asset[t].dep=n,Object.keys(n).forEach((function(e){o.asset[e]={url:n[e],state:l}}))}})),o.assetLoaded=!0,o.dispatch("SL-INIT"),null===t||void 0===t||t(),o.evtArr.forEach((function(e){o.dispatch(e.eventName,e.detail)})),o.monitor(3078347)},fail:function(e){o.monitor(3078348)}}):null===n||void 0===n||n({code:1,msg:"load error"}))},loadReport:function(){n.g.QReport||this.loadScriptProcess({asset:this.asset,cache:this.cache,mod:"QReport",parentModule:"QReport"},i,i,0)},monitor:function(e){var t;null===(t=n.g.QReport)||void 0===t||t.monitor(e)},load:function(e,t,n,r){var o=this;void 0===t&&(t=i),void 0===n&&(n=i),void 0===r&&(r=0);var s=this.asset,a=this.cache;this.assetLoaded||"React"===e?this.tryload(s,a,e,t,n,r):this.listen("SL-INIT",(function(){o.load(e,t,n,r)}))},tryload:function(e,t,r,o,s,a){var d=this;void 0===o&&(o=i),void 0===s&&(s=i),void 0===a&&(a=0);try{"undefined"!==typeof e[r]?"undefined"===typeof t[r]&&a<u?(e[r].dep&&Object.keys(e[r].dep).forEach((function(i){n.g[i]?(t[i]=n.g[i],e[i].state=0):"undefined"===typeof t[i]&&e[i].state===l&&d.loadScriptProcess({asset:e,cache:t,mod:i,parentModule:r},o,s,a)})),e[r].state===l?this.loadScriptProcess({asset:e,cache:t,mod:r,parentModule:r},o,s,a):this.listenModuleLoad(r,(function(){o(d.cache[r],d.cache)}))):t[r]&&this.firstLoaded[r]&&this.checkAllLoaded(e,r)&&(o(t[r],t),this.firstLoaded[r]=!0):(console.error(r+" is not found."),null===s||void 0===s||s({code:1,msg:r+" is not found."}))}catch(c){this.monitor(3078382),null===s||void 0===s||s({code:2,msg:c})}},loadScriptProcess:function(e,t,o,s){var i=this,a=e.asset,c=e.cache,h=e.mod,f=e.parentModule,p=(0,r.ej)("env_id")?a[h].url:d.findRequestUrl(a[h].url,s),g=null;g=this.createScript(p),a[h].state=1,null===g||void 0===g||g.addEventListener("load",(function(){n.g[h]&&(d.emitLoadSuccessEvent(p,{resourceType:"JS",retryCount:s}),c[h]=n.g[h],a[h].state=0,!i.firstLoaded[f]&&i.checkAllLoaded(a,f)&&t(c[f],c),i.dispatch("SL_MODULE_LOAD_"+h),i.monitor(3078345))})),null===g||void 0===g||g.addEventListener("error",(function(){d.emitLoadFailedEvent(p,{resourceType:"JS",retryCount:s}),a[h].state=s+1>=u?2:l,a[h].url=p,i.load(h,t,o,s+1),g&&i.removeScript(g),null===o||void 0===o||o({code:3,msg:"load error"}),i.monitor(3078346)}))},checkAllLoaded:function(e,t){var r=e[t];if(0!==e[t].state)return!1;if("undefined"!==typeof r.dep)for(var o=Object.keys(r.dep),s=0,i=o.length;s<i;s++)if(!n.g[o[s]])return!1;return this.firstLoaded[t]=!0,!0},createScript:function(e){var t=document.createElement("script");return t.src=e,t.async=!1,t.type="text/javascript",document.body.appendChild(t),t},removeScript:function(e){(null===e||void 0===e?void 0:e.parentNode)&&e.parentNode.removeChild(e)},ajax:function(e){var t=this,n=function(e){var t={};return t.url=e.url,t.paramObj=e.param||{},t.success=e.success||i,t.fail=e.fail||i,t.method=String.prototype.toUpperCase.apply(e.ajaxType||"GET"),t}(e),r=function(e){var t=[];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.push(n+"="+encodeURIComponent(e[n]));return t.join("&")}(n.paramObj),o=a(n.url,r),s=function(){for(var e=null,t=[function(){return new XMLHttpRequest},function(){return new(0,window.XDomainRequest)},function(){return new window.ActiveXObject("Msxml2.XMLHTTP")},function(){return new window.ActiveXObject("Msxml3.xmlhttp")},function(){return new window.ActiveXObject("Microsoft.XMLHTTP")}],n=0,r=t.length;n<r;n++){try{e=t[n]()}catch(o){continue}break}return e}();if(!s)throw new Error("XMLHttp is not defined");s.open("GET",o,!0),s.onreadystatechange=function(){if(4===s.readyState)if(200===s.status){var e=JSON.parse(s.responseText);n.success({data:e,code:0}),t.monitor(3078349)}else n.fail({code:s.status}),s.status>=400&&s.status<500?t.monitor(3078350):s.status>=500&&s.status<600&&t.monitor(3078351)},s.onerror=function(){n.fail({code:-1})},s.send()},dispatch:function(e,t){if(this.assetLoaded){var r=new window.CustomEvent(e,{detail:t});n.g.dispatchEvent(r)}else this.evtArr.push({eventName:e,detail:t})},listen:function(e,t){void 0===t&&(t=i),this.events[e]||(this.events[e]=[]),this.events[e].push(t),window.addEventListener(e,t)},remove:function(e,t){if(this.events[e]){var n=this.events[e].indexOf(t);-1!==n&&(this.events[e].splice(n,1),window.removeEventListener(e,t))}},removeAllEvent:function(){var e=this;Object.keys(this.events).forEach((function(t){e.events[t].forEach((function(n){e.remove(t,n)}))}))},listenModuleLoad:function(e,t){void 0===t&&(t=i),this.listen("SL_MODULE_LOAD_"+e,t)}};n.g.ScriptLoader||(n.g.ScriptLoader=c),n.g.SLR=n.g.ScriptLoader},"../spread-sheet/src/core/ui/alert/index.ts":function(e,t,n){"use strict";n.r(t),n.d(t,{showAlert:function(){return o}});var r=n("../spread-sheet/src/core/ui/lazyLoad.ts"),o=function(e){(0,r.uH)().then((function(t){new t.default(e).show()}))}},"../spread-sheet/src/core/ui/dialog/index.ts":function(e,t,n){"use strict";n.r(t),n.d(t,{Custom_Dialog:function(){return g},DIALOG_TYPE:function(){return h},DefaultButtons:function(){return f},dialog:function(){return D},inputDialog:function(){return O},showDialog:function(){return m},showDialog1:function(){return v},showDialog2:function(){return I},showDialog3:function(){return E},showDialog4:function(){return S},showDialog5:function(){return R},showDialog6:function(){return w},showMobileDialog1:function(){return A},showMobileDialog2:function(){return C},showMobileDialog3:function(){return y},showMobileDialog4:function(){return _},showMobileDialog5:function(){return T},showMobileDialog6:function(){return x},standardInformationDialogM:function(){return b}}),n("../node_modules/regenerator-runtime/runtime.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.promise.js");var r=n("../node_modules/i18next/dist/esm/i18next.js"),o=n("../spread-sheet/src/core/ui/alert/index.ts"),s=n("../spread-sheet/src/core/ui/lazyLoad.ts"),i=n("../packages/common-utils/src/index.ts"),a=n("../spread-sheet/src/base/event/event.ts"),l=n("../spread-sheet/src/base/event/eventName.ts"),d=n("../node_modules/@tencent/docs-user-agent/dist/index.js"),u=n.n(d),c=function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function i(e){try{l(r.next(e))}catch(t){s(t)}}function a(e){try{l(r.throw(e))}catch(t){s(t)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,a)}l((r=r.apply(e,t||[])).next())}))},h={Confirmation:"confirmation",Error:"error",Question:"question",Information:"information",StandardConfirm:"standardConfirm",Warning:"warning",Waiting:"waiting"},f={OK:r.ZP.t("确定"),Cancel:r.ZP.t("取消")},p=function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];(0,s.Yq)().then((function(t){t[e].apply(t,n)}))};function g(e,t){p("Custom_Dialog",e,t)}var m=function(e){p("showDialog",e)},v=function(e,t,n){p("showDialog1",e,t,n)};function I(e,t,n,r){p("showDialog2",e,t,n,r)}function E(e,t,n,r,o,s){p("showDialog3",e,t,n,r,o,s)}function S(e,t,n,r){p("showDialog4",e,t,n,r)}function R(e,t,n,r,o,s){p("showDialog5",e,t,n,r,o,s)}function w(e,t,n,r,o,s){p("showDialog6",e,t,n,r,o,s)}function A(e,t,n){p("showMobileDialog1",e,t,n)}function C(e,t,n,r){p("showMobileDialog2",e,t,n,r)}function y(e,t,n,r,o){p("showMobileDialog3",e,t,n,r,o)}function _(e,t,n,r){p("showMobileDialog4",e,t,n,r)}function T(e,t,n,r,o){p("showMobileDialog5",e,t,n,r,o)}function x(e,t,n,r,o){p("showMobileDialog6",e,t,n,r,o)}function b(e){p("standardInformationDialogM",e)}var D={delSheet:function(e,t){var n=t.title,s=t.message,i=t.isAria,a=s||r.ZP.t("确定要删除该工作表吗？删除后将无法恢复。"),l=n||r.ZP.t("删除工作表");u().isMobilePhone||u().isAndroidPad||u().isIPad?(0,o.showAlert)({type:"MessageBox",title:l,content:a,isAria:i,buttons:[{type:"default",label:r.ZP.t("取消"),onclick:function(e){null===e||void 0===e||e.close()}},{type:"primary",label:r.ZP.t("确定"),onclick:function(t){e(),null===t||void 0===t||t.close()}}]}):m({title:l,content:a,cancelText:r.ZP.t("取消"),maskClosable:!1,onOk:function(){e()}})},info:function(e){u().isMobilePhone||u().isAndroidPad||u().isIPad?(0,o.showAlert)({type:"MessageBox",title:e.title,content:e.content?e.content:"",onClose:function(){var t;a.ZP.default.trigger(l.W1.UI_HIDE,l.Xs.DIALOG),null===(t=e.onClose)||void 0===t||t.call(e)},buttons:[{type:"primary",label:r.ZP.t("确定"),onclick:function(t,n){var r;null===(r=e.onOk)||void 0===r||r.call(e,n),t.close()}}]}):m(e),a.ZP.default.trigger(l.W1.UI_SHOW,l.Xs.DIALOG)},alert:function(e,t,n){u().isMobilePhone||u().isAndroidPad||u().isIPad?(0,o.showAlert)({type:"MessageBox",title:e,content:t,buttons:[{type:"primary",label:r.ZP.t("确定"),onclick:function(e,t){null===n||void 0===n||n(t),e.close()}}]}):I(e,t,"confirmation",n),a.ZP.default.trigger(l.W1.UI_SHOW,l.Xs.DIALOG)},confirm:function(e){u().isMobilePhone||u().isAndroidPad||u().isIPad?(0,o.showAlert)({type:"MessageBox",title:e.title,content:e.content?e.content:"",onClose:function(){var t;a.ZP.default.trigger(l.W1.UI_HIDE,l.Xs.DIALOG),null===(t=e.onClose)||void 0===t||t.call(e)},buttons:[{type:"default",label:r.ZP.t("取消"),onclick:function(t,n){var r;null===(r=e.onCancel)||void 0===r||r.call(e,n),null===t||void 0===t||t.close()}},{type:"primary",label:r.ZP.t("确定"),onclick:function(t,n){return c(void 0,void 0,void 0,regeneratorRuntime.mark((function r(){var o;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,null===(o=e.onOk)||void 0===o?void 0:o.call(e,n);case 2:null===t||void 0===t||t.close();case 3:case"end":return r.stop()}}),r)})))}}]}):m(e),a.ZP.default.trigger(l.W1.UI_SHOW,l.Xs.DIALOG)},waiting:function(e,t){return u().isMobilePhone||u().isAndroidPad?g(e,{show_close_button:!1,overlay_close:!1,border_top:!1,buttons:!1,type:"waiting",overlay_class:"CustomDialogOverlay-Waiting",custom_class:"operate-waiting",only_mobile:!0,onClose:t}):g(e,{show_close_button:!1,overlay_close:!1,border_top:!1,buttons:!1,type:"waiting",overlay_class:"CustomDialogOverlay-Waiting",custom_class:"operate-waiting",onClose:t})},report:function(e,t,n,r,o){u().isMobilePhone||u().isAndroidPad?T((0,i.r)(e),(0,i.r)(t),"confirmation",n,r):R((0,i.r)(e),(0,i.r)(t),"confirmation",n,r,o)},tucao:function(e,t,n,r,o){u().isMobilePhone||u().isAndroidPad?x((0,i.r)(e),(0,i.r)(t),"confirmation",n,r):w((0,i.r)(e),(0,i.r)(t),"confirmation",n,r,o)}};function O(e){(0,s.Yq)().then((function(t){t.InputDialog.create(e)}))}},"../spread-sheet/src/core/ui/lazyLoad.ts":function(e,t,n){"use strict";n.d(t,{uH:function(){return l},Yq:function(){return d},Fd:function(){return u},Bk:function(){return c},gB:function(){return h}}),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.promise.js"),n("../node_modules/core-js/modules/es.array.iterator.js"),n("../node_modules/core-js/modules/es.string.iterator.js"),n("../node_modules/core-js/modules/web.dom-collections.iterator.js"),n("../node_modules/core-js/modules/es.array.find.js");var r=n("../node_modules/i18next/dist/esm/i18next.js"),o=n("../packages/common-utils/src/index.ts"),s=n("../node_modules/@tencent/docs-user-agent/dist/index.js"),i=n.n(s),a=function(){function e(e){this.buttonMenuDom=$(".hp-ui-button-menu"),this.menuDom=$(".hp-ui-button-menu-wrapper a"),this.type=e.type,this.title=e.title,this.content=e.content,this.inputMaxLength=e.inputMaxLength,this.inputOverflowTips=e.inputOverflowTips,this.buttons=e.buttons,this.onClose=e.onClose,this.dialogDom=null,this.dialogInputDom=null,this.dialogInputErrorDom=null,this.init()}var t=e.prototype;return t.createDom=function(e,t,n){var r=$(document.createElement(t));return r.addClass(n),e.append(r),r},t.show=function(){var e=this;this.dialogDom=this.createDom($(document.body),"div","m-component-dialog"),this.dialogDom.on("touchmove",(function(e){e.preventDefault()})),this.createDom(this.dialogDom,"div","m-component-dialog-mask").on("touchstart touchend",(function(e){e.preventDefault()}));var t=this.createDom(this.dialogDom,"div","m-component-dialog-body"),n=this.createDom(t,"div","m-component-dialog-title");this.title&&this.title.length>0&&n.text(this.title),n.on("touchstart touchend",(function(e){e.preventDefault()}));var r=this.createDom(t,"div","m-component-dialog-content");if("InputBox"===this.type){t.addClass("m-component-dialog-body-input"),document.body.clientHeight<500&&((0,o.gr)()?t.css("top",96):t.css("top",72));var s=this.createDom(r,"div","m-component-dialog-input-box"),i=s[0].clientWidth-28;this.dialogInputDom=this.createDom(s,"input","m-component-dialog-input"),this.dialogInputDom.css("width",i),this.dialogInputDom.attr("spellcheck","false"),this.dialogInputDom.attr("required","required"),this.content&&this.content.length>0&&this.dialogInputDom.val(this.content),this.bindInputListener(this.dialogInputDom);var a=this.createDom(s,"div","m-component-dialog-input-clear");this.addTap(a,(function(){e.dialogInputDom.val(""),e.inputBoxValChange()})),this.dialogInputErrorDom=this.createDom(r,"div","m-component-dialog-input-error-hidden");var l=document.createElement("p");this.dialogInputErrorDom.append(l),r.append(this.dialogInputErrorDom)}else this.content&&this.content.length>0&&this.createDom(r,"div","m-component-dialog-message").text(this.content);for(var d=this.createDom(t,"div","m-component-dialog-footer"),u=0;u<this.buttons.length;u++){var c=this.buttons[u];if(c.label&&c.label.length>0){var h=$(document.createElement("a"));h.addClass("m-component-dialog-button");var f="m-component-dialog-btn-default";"primary"===c.type?f="m-component-dialog-btn-primary":"danger"===c.type&&(f="m-component-dialog-btn-danger"),h.addClass(f),h.text(c.label),d.append(h),this.bindButtonListener(h,c)}}"InputBox"===this.type&&this.focusInputBox()},t.close=function(){var e;null===(e=this.onClose)||void 0===e||e.call(this),this.dialogDom.remove()},t.getInputText=function(){return this.dialogInputDom.val()},t.showInputErrorTips=function(e){this.dialogInputErrorDom.addClass("m-component-dialog-input-error"),this.dialogInputErrorDom.children("p").text(e),this.focusInputBox()},t.checkInputError=function(){var e=!1;if(this.inputMaxLength&&this.inputMaxLength>0&&this.dialogInputDom.val().length>this.inputMaxLength){var t=r.ZP.t("输入内容过长。");this.inputOverflowTips&&this.inputOverflowTips.length>0&&(t=this.inputOverflowTips),this.showInputErrorTips(t),e=!0}return e},t.focusInputBox=function(){var e=this;i().isIOS?this.dialogInputDom.focus():setTimeout((function(){e.dialogInputDom.focus().click()}),100)},t.inputBoxValChange=function(){this.checkInputError()&&this.dialogInputErrorDom.removeClass("m-component-dialog-input-error")},t.bindInputListener=function(e){var t=this;e.on("input propertychange change",(function(){t.inputBoxValChange()})),e.blur((function(){if(i().isIOS)for(var e=0;e<t.buttons.length;e++){var n=t.buttons[e];if("primary"===n.type){n.onclick&&"function"===typeof n.onclick&&n.onclick(t);break}}}))},t.bindButtonListener=function(e,t){var n=this,r=!1,o=function(e){r||(r=!0,t.onclick&&"function"===typeof t.onclick?t.onclick(n,e):n.close())};e.on("touchend",o),e.on("click",o)},t.addTap=function(e,t){e.on("touchstart",(function(e){var t=e.originalEvent.touches[0];this.touchX=t.clientX,this.touchY=t.clientY,this.touchT=Date.now()})),e.on("touchend",(function(e){e.preventDefault();var n=e.originalEvent.changedTouches[0],r=n.clientX,o=n.clientY;void 0===this.touchT||Date.now()>this.touchT+400||Math.abs(o-this.touchY)>30||Math.abs(r-this.touchX)>30||t()}))},t.init=function(){var e=this;this.buttonMenuDom.on("click",(function(){var t=e.buttonMenuDom;if(!t.attr("disabled")){$("#tooltip").remove();var n=t.hasClass("hp-ui-button-menu-reverse"),r=t.find(".hp-ui-button-menu-wrapper"),o=t.find(".hp-ui-button-list-ul"),s=t.find(".hp-ui-button-list-ul li"),i=-1;if(t.data("close",e.buttonCloseMenu),r.is(":visible"))e.buttonCloseMenu(t);else{o.css("min-width",t.outerWidth()+"px"),r.show(),t.addClass("hp-ui-button-active");var a=Math.max(200,Math.min($("body").height()-o.offset().top-50,435));o.css("max-height",a+"px"),n&&o.css("top","-"+(o.outerHeight()+t.outerHeight()+10)+"px"),window.setTimeout((function(){$("body").on("keydown.hp-ui-button-menu",(function(n){if(r.is(":hidden"))return!0;var a=i;switch(n.keyCode){case 13:return o.find("li.hp-ui-button-menuitem-selected > a").trigger("click"),!1;case 27:return e.buttonCloseMenu(t),!1;case 38:i=i-1<0?s.length-1:i-1;break;case 40:i=(i+1)%s.length;break;default:return!0}return o.find("li:nth-child("+(a+1)+")").removeClass("hp-ui-button-menuitem-selected"),o.find("li:nth-child("+(i+1)+")").addClass("hp-ui-button-menuitem-selected"),!1})).on("click.hp-ui-button-menu",(function(){e.buttonCloseMenu(t)}))}),0)}}})),this.menuDom.on("click",(function(){if(!e.menuDom.hasClass("hp-ui-button-menu-disabled")){var t=e.menuDom.closest(".hp-ui-button");t.find(".hp-ui-button-menuitem-selected").removeClass("hp-ui-button-menuitem-selected"),e.buttonCloseMenu(t)}}))},t.buttonCloseMenu=function(e){$("body").off(".hp-ui-button-menu"),e.find(".hp-ui-button-menu-wrapper").hide(),e.removeClass("hp-ui-button-active"),e.find(".hp-ui-button-menuitem-selected").removeClass("hp-ui-button-menuitem-selected"),e.trigger("menu-closed")},e}(),l=function(){return Promise.resolve().then((function(){return{default:a}}))},d=function(){return n.e("bundle_ui_dialog").then(n.bind(n,"../spread-sheet/src/core/ui/dialog/dialog.ts"))},u=function(){return n.e("bundle_ui_padmodal").then(n.bind(n,"../spread-sheet/src/core/ui/modal/pad-modals.ts"))},c=function(){return Promise.resolve().then(n.bind(n,"../spread-sheet/src/core/ui/toast/toast.tsx"))},h=function(){return n.e("bundle_ui_tooltip").then(n.bind(n,"../spread-sheet/src/core/ui/tooltip/tooltip.js"))}},"../spread-sheet/src/core/ui/loading/index.ts":function(e,t,n){"use strict";n.d(t,{ZP:function(){return p},zH:function(){return r}});var r,o=n("../node_modules/@babel/runtime/helpers/esm/createClass.js"),s=(n("../node_modules/regenerator-runtime/runtime.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.promise.js"),n("../node_modules/core-js/modules/es.object.assign.js"),n("../node_modules/core-js/modules/es.array.iterator.js"),n("../node_modules/core-js/modules/es.map.js"),n("../node_modules/core-js/modules/es.string.iterator.js"),n("../node_modules/core-js/modules/esnext.map.delete-all.js"),n("../node_modules/core-js/modules/esnext.map.every.js"),n("../node_modules/core-js/modules/esnext.map.filter.js"),n("../node_modules/core-js/modules/esnext.map.find.js"),n("../node_modules/core-js/modules/esnext.map.find-key.js"),n("../node_modules/core-js/modules/esnext.map.includes.js"),n("../node_modules/core-js/modules/esnext.map.key-of.js"),n("../node_modules/core-js/modules/esnext.map.map-keys.js"),n("../node_modules/core-js/modules/esnext.map.map-values.js"),n("../node_modules/core-js/modules/esnext.map.merge.js"),n("../node_modules/core-js/modules/esnext.map.reduce.js"),n("../node_modules/core-js/modules/esnext.map.some.js"),n("../node_modules/core-js/modules/esnext.map.update.js"),n("../node_modules/core-js/modules/web.dom-collections.iterator.js"),n("../spread-sheet/src/core/view/spreadsheet-view/utils.ts")),i=n("../spread-sheet/src/core/feature/copyPaste/iconSource.tsx"),a=n("../node_modules/@tencent/docs-user-agent/dist/index.js"),l=n.n(a),d=n("../spread-sheet/src/core/view/level-2/link-center/logic/attachment/index.ts"),u=function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function i(e){try{l(r.next(e))}catch(t){s(t)}}function a(e){try{l(r.throw(e))}catch(t){s(t)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,a)}l((r=r.apply(e,t||[])).next())}))};!function(e){e.CENTER="CENTER",e.LEFT="LEFT"}(r||(r={}));var c={LEFT:8},h=function(){function e(e){var t=this;this.translateX=0,this.translateY=0,this.areaDataListener=null,this.show=function(){return u(t,void 0,void 0,regeneratorRuntime.mark((function e(){var t,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=(new i.Z).iconsList.spinner,this.initPosition(),n=this.loadingAlign===r.LEFT?c[this.loadingAlign]+"px center":"center center",Object.assign(this.loadingView.style,{position:"absolute",backgroundColor:"E2E2E2",borderColor:"#E2E2E2",zIndex:1,background:'url("'+t+'") no-repeat',backgroundPosition:n,display:"flex",alignItems:"center",justifyContent:"center"}),this.visible=!0,this.valid=!0,this.loadingView.onclick=this.setInputEdit,this.mainBoardContainer.appendChild(this.loadingView);case 8:case"end":return e.stop()}}),e,this)})))},this.hide=function(){t.visible=!1,t.mainBoardContainer.contains(t.loadingView)&&t.mainBoardContainer.removeChild(t.loadingView),t.handleEvent(!1)},this.cancelUpload=function(){t.valid=!1,t.hide()},this.getPositionInfo=function(){return{row:t.row,col:t.col}},this.setVisible=function(){t.visible=!0,t.loadingView.style.display="flex"},this.setHidden=function(){t.visible=!1,t.loadingView.style.display="none"},this.toggleVisible=function(e){if(e===t.sheetId)return t.setVisible();t.setHidden()},this.handleEvent=function(e){var n,r=e?"on":"off",o=e?"listen":"remove",s=t.canvas,i=s.inputManager,a=s.areaData;i.emitter[r](i.EVENT.VALUE_CHANGE,t.cancelUpload),e?t.areaDataListener=a.onUpdateOffset(t.updatePosition):(null===(n=t.areaDataListener)||void 0===n||n.dispose(),t.areaDataListener=null),t.event.sheetsBar[o](d.K.SWITCHSHEET,t.toggleVisible),t.event.sheetsBar[o](d.K.ADDSHEET,t.toggleVisible)},this.setInputEdit=function(){var e=t.canvas.inputManager;e.handleEnterInput(t.row,t.col),e.focus()},this.initPosition=function(){var e=t.canvas,n=e.tableView,r=e.areaData,o=e.headSize,i=e.rowcolAccessor,a=e.clientRect,l=n.getCellViewAtPosition(t.row,t.col),d=t.col,u=t.row,c=(0,s.E)(i,l,u),h=(0,s.o)(i,l,d),f=r.getDisplayViewTopByRow(u);(null===l||void 0===l?void 0:l.mergeData)&&(u+=l.mergeData.rowCount-1);var p=r.getDisplayViewBottomByRow(u),g=a.height-o.displayColHeadHeight;t.loadingView.style.bottom=g-f+"px",t.loadingView.style.top=p-c+"px";var m=r.getDisplayViewLeftByCol(d);t.loadingView.style.left=m+"px",t.loadingView.style.width=h+"px",t.loadingView.style.height=c+"px",t.translateX=r.getDisplayViewLeftByCol(d),t.translateY=r.getDisplayViewTopByRow(u)},this.updatePosition=function(){var e=t.canvas,n=e.tableView,r=e.areaData,o=n.getCellViewAtPosition(t.row,t.col),s=t.col,i=t.row;(null===o||void 0===o?void 0:o.mergeData)&&(i+=o.mergeData.rowCount-1);var a=r.getDisplayViewLeftByCol(s),l=r.getDisplayViewTopByRow(i);t.loadingView.style.transform="translate("+(a-t.translateX)+"px, "+(l-t.translateY)+"px)"},this.canvas=e.canvas,this.event=e.event,this.mainBoardContainer=e.canvas.mainBoard.element,this.operateBoardContainer=e.canvas.operateBoard.board,this.row=e.row,this.col=e.col,this.sheetId=e.sheetId,this.visible=!1,this.loadingView=document.createElement("div"),this.loadingView.id="loading-"+this.sheetId+"-"+this.row+"-"+this.col,this.loadingView.classList.add("copy-paste-loading"),this.loadingAlign=e.loadingAlign,this.handleEvent(!0)}var t=e.prototype;return t.showAttachmentLoading=function(){this.removeValueChangeEvent(),this.initOperateBoardPosition();var e=this.loadingAlign===r.LEFT?c[this.loadingAlign]+"px center":"center center";Object.assign(this.loadingView.style,{position:"absolute",borderColor:"#E2E2E2",zIndex:1,backgroundPosition:e,display:"flex",alignItems:"center"}),this.visible=!0,this.valid=!0,this.operateBoardContainer.appendChild(this.loadingView)},t.removeValueChangeEvent=function(){var e=this.canvas.inputManager;e.emitter.off(e.EVENT.VALUE_CHANGE,this.cancelUpload)},t.hideAttachmentLoading=function(){this.visible=!1,this.operateBoardContainer.contains(this.loadingView)&&this.operateBoardContainer.removeChild(this.loadingView),this.handleEvent(!1)},t.getLoadingView=function(){return this.loadingView},t.initOperateBoardPosition=function(){var e=this.canvas,t=e.tableView,n=e.areaData,r=e.headSize,o=e.rowcolAccessor,i=e.clientRect,a=t.getCellViewAtPosition(this.row,this.col),d=this.col,u=this.row,c=(0,s.E)(o,a,this.row),h=(0,s.o)(o,a,this.col),f=n.getDisplayViewTopByRow(u);(null===a||void 0===a?void 0:a.mergeData)&&(u+=a.mergeData.rowCount-1);var p=n.getDisplayViewBottomByRow(u),g=i.height-r.displayColHeadHeight,m=l().isMobile?2:0;this.loadingView.style.bottom=g-f+"px",this.loadingView.style.top=p-c+r.displayColHeadHeight+m+"px";var v=n.getDisplayViewLeftByCol(d);this.loadingView.style.left=v+r.displayRowHeadWidth+"px",this.loadingView.style.width=h-m+"px",this.loadingView.style.height=c-m+"px",this.translateX=n.getDisplayViewLeftByCol(d),this.translateY=n.getDisplayViewTopByRow(u)},(0,o.Z)(e,[{key:"isVisible",get:function(){return this.visible}},{key:"isValid",get:function(){return this.valid}}]),e}(),f=function(e,t,n){return n+"-"+e+"-"+t},p=function(){function e(){}return e.createInstance=function(t,n,o,s,i,a){void 0===a&&(a=r.CENTER);var l=new h({event:t,canvas:n,row:o,col:s,sheetId:i,loadingAlign:a});return e.value.set(f(o,s,i),l),l},e.getInstance=function(t,n,r){return e.value.get(f(t,n,r))},e.removeInstance=function(t,n,r){var o=f(t,n,r),s=e.value.get(o);s&&(e.value.delete(o),s.hide())},e}();p.value=new Map},"../spread-sheet/src/core/ui/toast/index.ts":function(e,t,n){"use strict";n.r(t),n.d(t,{hideToast:function(){return c},initToast:function(){return d},showToast:function(){return u},showVipToast:function(){return a}}),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.promise.js");var r=n("../node_modules/@tencent/docs-user-agent/dist/index.js"),o=n.n(r),s=n("../spread-sheet/src/core/ui/lazyLoad.ts"),i=null;function a(e){return new Promise((function(t){var r,o;(null===(r=n.g.SLR)||void 0===r?void 0:r.assetLoaded)?l(e,t):null===(o=n.g.SLR)||void 0===o||o.listen("SL-INIT",(function(){l(e,t)}))}))}function l(e,t){if(i){var r=i.showToast(e);t(r)}else o().isMobilePhone||o().isAndroidPad||o().isIPad?n.g.SLR.load("VipToastMobile",(function(n){n.init();var r=(i=n.MobileVipToast).showToast(e);t(r)})):n.g.SLR.load("VipToast",(function(n){n.init();var r=(i=n.PcVipToast).showToast(e);t(r)}))}n.g.showVipToast=a;var d=s.Bk,u=function(e,t,n,r){(0,s.Bk)().then((function(o){o.showToast(e,t,n,r)}))},c=function(){(0,s.Bk)().then((function(e){e.hideToast()}))}},"../spread-sheet/src/core/ui/toast/toast.tsx":function(e,t,n){"use strict";n.r(t),n.d(t,{changeToastInnerText:function(){return d},hideToast:function(){return a},showToast:function(){return l}}),n("../node_modules/core-js/modules/es.regexp.exec.js"),n("../node_modules/core-js/modules/es.string.replace.js");var r=n("../node_modules/@tencent/docs-user-agent/dist/index.js"),o=n.n(r),s=n("../node_modules/@tencent/dui/lib/components/Snackbar/index.js"),i=null;function a(e){if(i)return i.close(),i=null,void setTimeout((function(){null===e||void 0===e||e()}),300);null===e||void 0===e||e()}function l(e,t,n,r){var d=n||{},u=d.toastType,c=void 0===u?"typeNotice":u,h=d.isWarnning,f=d.toolToastCloseTime,p=d.btnText,g=d.btnCallBack,m=d.btnCallback,v=d.toolToastRemoveCallBack,I=d.showCloseBtn,E=Boolean(f)||(o().isMobilePhone||o().isAndroidPad)&&!p,S="boolean"===typeof I?I:!E,R="object"===typeof t&&null!==t?t.zIndex:10100,w=h?"error":{typeSuccess:"success",typeWarning:"error",typeNotice:"info",typeNoticeWhite:"info",typeLoading:"loading"}[c],A="function"===typeof e?e():e;"string"===typeof A&&(A=A.replace(/[,，]$/,"")),i?a((function(){l(e,t,n,r)})):(i=s.default.show({style:{zIndex:R},message:A,closable:S,type:w,action:p,onClickAction:g||m,onClose:function(){i&&(i=null,null===v||void 0===v||v())},containerDom:r,duration:f,autoClose:E}),E&&setTimeout((function(){null===v||void 0===v||v()}),f))}function d(e,t){if(i){var n={message:e};t&&(n.type=t),i.update(n)}}},"../spread-sheet/src/core/user-info/index.ts":function(e,t,n){"use strict";n.d(t,{b:function(){return c}}),n("../node_modules/regenerator-runtime/runtime.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.promise.js");var r=n("../spread-sheet/src/base/util/appConfig.ts"),o=n("./node_modules/axios/index.js"),s=n.n(o),i=n("../packages/utils/src/safe.ts"),a=n("../node_modules/qs/lib/index.js"),l=n.n(a),d="//"+r.Z.getConfig("runtime.domainName")+"/cgi-bin/online_docs/user_info",u=function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function i(e){try{l(r.next(e))}catch(t){s(t)}}function a(e){try{l(r.throw(e))}catch(t){s(t)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,a)}l((r=r.apply(e,t||[])).next())}))};function c(e){var t;return u(this,void 0,void 0,regeneratorRuntime.mark((function r(){var o;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,new Promise((function(e,t){s().post(d,l().stringify({xsrf:(0,i.f)()})).then((function(t){var n=t.data;if(0===n.retcode)return e(n)})).catch((function(e){return t(e)}))}));case 3:o=r.sent,null===e||void 0===e||e(o),r.next=11;break;case 7:r.prev=7,r.t0=r.catch(0),console.error(r.t0),null===(t=n.g.log)||void 0===t||t.error("[UserInfo] 获取UserInfo失败",r.t0);case 11:case"end":return r.stop()}}),r,null,[[0,7]])})))}},"../spread-sheet/src/core/utils/ImageLoader.ts":function(e,t,n){"use strict";n.d(t,{M$:function(){return g},ZP:function(){return C},yc:function(){return I},L1:function(){return w},AJ:function(){return E}}),n("../node_modules/regenerator-runtime/runtime.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.promise.js"),n("../node_modules/core-js/modules/es.array.iterator.js"),n("../node_modules/core-js/modules/es.set.js"),n("../node_modules/core-js/modules/es.string.iterator.js"),n("../node_modules/core-js/modules/esnext.set.add-all.js"),n("../node_modules/core-js/modules/esnext.set.delete-all.js"),n("../node_modules/core-js/modules/esnext.set.difference.js"),n("../node_modules/core-js/modules/esnext.set.every.js"),n("../node_modules/core-js/modules/esnext.set.filter.js"),n("../node_modules/core-js/modules/esnext.set.find.js"),n("../node_modules/core-js/modules/esnext.set.intersection.js"),n("../node_modules/core-js/modules/esnext.set.is-disjoint-from.js"),n("../node_modules/core-js/modules/esnext.set.is-subset-of.js"),n("../node_modules/core-js/modules/esnext.set.is-superset-of.js"),n("../node_modules/core-js/modules/esnext.set.join.js"),n("../node_modules/core-js/modules/esnext.set.map.js"),n("../node_modules/core-js/modules/esnext.set.reduce.js"),n("../node_modules/core-js/modules/esnext.set.some.js"),n("../node_modules/core-js/modules/esnext.set.symmetric-difference.js"),n("../node_modules/core-js/modules/esnext.set.union.js"),n("../node_modules/core-js/modules/web.dom-collections.iterator.js"),n("../node_modules/core-js/modules/web.url.js"),n("../node_modules/core-js/modules/web.url-search-params.js"),n("../node_modules/core-js/modules/es.number.constructor.js"),n("../node_modules/core-js/modules/es.regexp.exec.js"),n("../node_modules/core-js/modules/es.string.search.js");var r,o,s=n("../node_modules/@tencent/docs-user-agent/dist/index.js"),i=n.n(s),a=n("../node_modules/@babel/runtime/helpers/esm/toConsumableArray.js"),l=(n("../node_modules/core-js/modules/es.map.js"),n("../node_modules/core-js/modules/esnext.map.delete-all.js"),n("../node_modules/core-js/modules/esnext.map.every.js"),n("../node_modules/core-js/modules/esnext.map.filter.js"),n("../node_modules/core-js/modules/esnext.map.find.js"),n("../node_modules/core-js/modules/esnext.map.find-key.js"),n("../node_modules/core-js/modules/esnext.map.includes.js"),n("../node_modules/core-js/modules/esnext.map.key-of.js"),n("../node_modules/core-js/modules/esnext.map.map-keys.js"),n("../node_modules/core-js/modules/esnext.map.map-values.js"),n("../node_modules/core-js/modules/esnext.map.merge.js"),n("../node_modules/core-js/modules/esnext.map.reduce.js"),n("../node_modules/core-js/modules/esnext.map.some.js"),n("../node_modules/core-js/modules/esnext.map.update.js"),function(){function e(e,t){void 0===e&&(e=0),void 0===t&&(t=0),this.max=e,this.ttl=t,this.first=null,this.last=null,this.items=new Map,this.size=0}var t=e.prototype;return t.has=function(e){return this.items.has(e)},t.clear=function(){return this.first=null,this.items=new Map,this.last=null,this.size=0,this},t.delete=function(e){if(this.has(e)){var t=this.items.get(e);this.items.delete(e),this.size-=1,null!==t.prev&&(t.prev.next=t.next),null!==t.next&&(t.next.prev=t.prev),this.first===t&&(this.first=t.next),this.last===t&&(this.last=t.prev)}return this},t.evict=function(){var e=this.first;return e?(this.items.delete(e.key),this.first=e.next,this.first&&(this.first.prev=null),this.size-=1,this):this},t.get=function(e){var t;if(this.has(e)){var n=this.items.get(e);this.ttl>0&&n.expiry<=(new Date).getTime()?this.delete(e):(t=n.value,this.set(e,t,!0))}return t},t.keys=function(){return(0,a.Z)(this.items.keys())},t.set=function(e,t,n){var r;if(void 0===n&&(n=!1),n||this.has(e)){if((r=this.items.get(e)).value=t,!1===n&&(r.expiry=this.ttl>0?(new Date).getTime()+this.ttl:this.ttl),this.last!==r){var o=this.last,s=r,i=s.next,a=s.prev;this.first===r&&(this.first=r.next),r.next=null,r.prev=this.last,o&&(o.next=r),null!==a&&(a.next=i),null!==i&&(i.prev=a)}}else this.max>0&&this.size===this.max&&this.evict(),r={expiry:this.ttl>0?(new Date).getTime()+this.ttl:this.ttl,key:e,prev:this.last,next:null,value:t},this.items.set(e,r),this.size+=1,1===this.size?this.first=r:this.last&&(this.last.next=r);return this.last=r,this},e}()),d=n("../spread-sheet/src/base/util/appConfig.ts"),u=function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function i(e){try{l(r.next(e))}catch(t){s(t)}}function a(e){try{l(r.throw(e))}catch(t){s(t)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,a)}l((r=r.apply(e,t||[])).next())}))};if("undefined"!==typeof window){var c=navigator.userAgent,h=/android|adr/i.test(c),f=/(mobile)/i.test(c)&&h,p=/(ipad)/i.test(c);/(mobile)/i.test(c)&&!p&&(r=200),(p||f)&&(o=600)}var g,m=r||o||1500;!function(e){e[e.CONTAIN=0]="CONTAIN",e[e.COVER=1]="COVER"}(g||(g={}));var v=function(){function e(){var e=this;this.maxCount=16,this.loadingCount=0,this.tasks=[],this.imageCache=new l(m),this.loadedCount=0,this.errorCount=0,this.alreadyFailedImages=new Set,this.preLoadImageToBrowserCache=function(t){return u(e,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.triggerNewTask(t,{shouldSkipCache:!0,shouldConsiderCORS:!1});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})))},this.preLoadImageToAppCache=function(t,n){return u(e,void 0,void 0,regeneratorRuntime.mark((function e(){var r,o,s,i,a,l;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=this.getCachedImage(t)){e.next=5;break}return e.next=4,this.triggerNewTask(t,{compressOptions:n,shouldSkipCache:!1,shouldConsiderCORS:!0});case 4:return e.abrupt("return",e.sent);case 5:if(n&&R(t)){e.next=7;break}return e.abrupt("return");case 7:if(o=w(r),s=o.naturalWidth,i=o.naturalHeight,a=n.width,!(n.height<=i&&a<=s)){e.next=11;break}return e.abrupt("return");case 11:return e.next=13,this.triggerNewTask(t,{compressOptions:n,shouldSkipCache:!1,shouldConsiderCORS:!0});case 13:if(!((l=e.sent).naturalWidth>s||l.naturalHeight>i)){e.next=16;break}return e.abrupt("return",l);case 16:case"end":return e.stop()}}),e,this)})))},this.triggerNewTask=function(t,n){return u(e,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(this.loadingCount<this.maxCount)){e.next=4;break}return e.next=3,this.request(t,n);case 3:case 6:return e.abrupt("return",e.sent);case 4:return e.next=6,this.waitingTask(t,n);case 7:case"end":return e.stop()}}),e,this)})))}}var t=e.prototype;return t.loadImage=function(e,t){return u(this,void 0,void 0,regeneratorRuntime.mark((function n(){var r,o;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(void 0!==(r=(t||{}).shouldSkipCache)&&r||!(o=this.getCachedImage(e))){n.next=3;break}return n.abrupt("return",o);case 3:return n.next=5,this.triggerNewTask(e,t);case 5:return n.abrupt("return",n.sent);case 6:case"end":return n.stop()}}),n,this)})))},t.getCachedImage=function(e){return this.imageCache.get(e)},t.clearCache=function(){this.imageCache.clear(),this.alreadyFailedImages.clear()},t.hasPicFailed=function(e){return this.alreadyFailedImages.has(e)},t.addToCache=function(e,t){return u(this,void 0,void 0,regeneratorRuntime.mark((function n(){var r;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(r=t,"function"!==typeof window.createImageBitmap){n.next=5;break}return n.next=4,createImageBitmap(t);case 4:r=n.sent;case 5:this.imageCache.set(e,r);case 6:case"end":return n.stop()}}),n,this)})))},t.waitingTask=function(e,t){return u(this,void 0,void 0,regeneratorRuntime.mark((function n(){var r=this;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",new Promise((function(n){r.tasks.push({url:e,callback:function(e){n(e)},requestOptions:t})})));case 1:case"end":return n.stop()}}),n)})))},t.runTask=function(){return u(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.tasks.pop()){e.next=3;break}return e.abrupt("return");case 3:return e.next=5,this.request(t.url,t.requestOptions);case 5:n=e.sent,t.callback(n);case 7:case"end":return e.stop()}}),e,this)})))},t.idle=function(){this.loadingCount-=1,this.tasks.length>0&&this.runTask()},t.request=function(e,t){return void 0===t&&(t={}),u(this,void 0,void 0,regeneratorRuntime.mark((function n(){var r,o,s,i,a,l,d=this;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return o=(r=t).shouldSkipCache,s=void 0!==o&&o,i=r.shouldConsiderCORS,a=void 0===i||i,l=r.compressOptions,n.abrupt("return",new Promise((function(t,n){var r=new Image;a&&r.setAttribute("crossorigin","anonymous"),r.onload=function(){return u(d,void 0,void 0,regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(this.loadedCount+=1,this.idle(),s){n.next=5;break}return n.next=5,this.addToCache(e,r);case 5:t(r);case 6:case"end":return n.stop()}}),n,this)})))},r.onerror=function(){d.errorCount+=1,r.onload=null,r.onerror=null,d.idle(),d.alreadyFailedImages.add(e),n("Get Image Error: "+e)},r.src=l?E(e,l):e,d.loadingCount+=1})));case 2:case"end":return n.stop()}}),n)})))},e}(),I=function(e,t,r){var o=e.position.overlayPosition,s=o.widthPixels,i=o.heightPixels,a=e.clipInfo,l=a.clipBottom,d=s/i,u=(s+a.clipLeft+a.clipRight)/s,c=(i+a.clipTop+l)/i;return d>t/r?{width:t*u*n.g.devicePixelRatio,height:t/d*c*n.g.devicePixelRatio,strategy:g.COVER}:{width:r*d*u*n.g.devicePixelRatio,height:r*c*n.g.devicePixelRatio,strategy:g.COVER}},E=function(e,t){if(!R(e))return e;if(A(e))return e.substring(0,e.length-1)+(i().isMobile?"1123":"1600");var n=t.width,r=t.height,o=t.strategy;return S(new URL(e),50*Math.ceil(n/50),50*Math.ceil(r/50),o)},S=function(e,t,n,r){if((!t||Number(e.searchParams.get("w"))<=t)&&(!n||Number(e.searchParams.get("h"))<=n))return e.href;var o=""+e.origin+e.pathname+"?imageMogr2/thumbnail/";return r===g.COVER?o+"!"+(0===t?"":t)+"x"+(0===n?"":n)+"r/ignore-error/1":""+o+(0===t?"":t)+"x"+(0===n?"":n)+"/ignore-error/1"},R=function(e){return A(e)||function(e){return!(!e||e.length<1)&&e.search(/docimg([0-9]|10)\.docs\.qq\.com/)>=0}(e)};function w(e){return e instanceof HTMLImageElement?e:{naturalWidth:e.width,naturalHeight:e.height}}var A=function(e){return!(!e||e.length<1)&&e.indexOf(d.Z.getConfig("custom.standaloneDomains.qqadapt_qpic_cn"))>0},C=new v},"../spread-sheet/src/core/utils/formulaInsert.ts":function(e,t,n){"use strict";n.d(t,{M:function(){return d}}),n("../node_modules/core-js/modules/es.regexp.exec.js"),n("../node_modules/core-js/modules/es.string.replace.js"),n("../node_modules/core-js/modules/es.string.match.js"),n("../node_modules/core-js/modules/web.dom-collections.for-each.js"),n("../node_modules/core-js/modules/es.array.concat.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.regexp.to-string.js");var r,o,s,i,a,l=n("../packages/model/src/range/hexRangeUtils.ts");!function(e){e[e.SINGLE_ROW=1]="SINGLE_ROW",e[e.SINGLE_COL=2]="SINGLE_COL",e[e.MULTI_ROW_COL=3]="MULTI_ROW_COL"}(s||(s={})),function(e){e[e.LAST_CELL=1]="LAST_CELL",e[e.NEXT_COL_CELL=2]="NEXT_COL_CELL",e[e.NEXT_ROW_CELL=3]="NEXT_ROW_CELL",e[e.LAST_WHOLE_COL_AND_ROW_CELL=4]="LAST_WHOLE_COL_AND_ROW_CELL",e[e.LAST_WHOLE_COL_CELL=5]="LAST_WHOLE_COL_CELL",e[e.LAST_WHOLE_ROW_CELL=6]="LAST_WHOLE_ROW_CELL",e[e.NEXT_WHOLE_ROW_CELL=7]="NEXT_WHOLE_ROW_CELL",e[e.SELECTED_CELL=8]="SELECTED_CELL"}(i||(i={}));var d={init:function(e){r=(a=e).spreadsheet.activeSheet.getRowCount(),o=a.spreadsheet.activeSheet.getColCount()},selHandler:function(e,t){if(a){var n=function(e,t){var n=[];return e.forEach((function(e){var r=function(e){var t=e.startRowIndex,n=e.startColIndex,r=e.endRowIndex,o=e.endColIndex;return t===r?s.SINGLE_ROW:n===o?s.SINGLE_COL:s.MULTI_ROW_COL}(e),o=function(e,t,n,r){switch(e){case i.SELECTED_CELL:return function(e){var t=a.view.getSelection().activeCell;null===t||void 0===t||t.rowIndex,null===t||void 0===t||t.colIndex,function(e,t,n){n.replace(/sheet-formula-/,"").toUpperCase()}(0,0,e)}(r);case i.LAST_CELL:return function(e,t,n){var r,o;return r={col:0,row:0},o={col:0,row:0},e===s.SINGLE_ROW?(r={row:t.startRowIndex,col:t.startColIndex},o={row:t.endRowIndex,col:t.endColIndex-1}):e===s.SINGLE_COL&&(r={row:t.startRowIndex,col:t.startColIndex},o={row:t.endRowIndex-1,col:t.endColIndex}),v(t.endRowIndex,t.endColIndex,r,o,n)}(t,n,r);case i.NEXT_ROW_CELL:return g(n,r);case i.NEXT_COL_CELL:return m(n,r);case i.NEXT_WHOLE_ROW_CELL:return function(e,t){for(var n,r={col:e.startColIndex,row:e.startRowIndex},o={col:e.endColIndex,row:e.endRowIndex},s=[],i=E(o.row+1),l=r.col;l<=o.col;l++){var d=I(i,l,{row:r.row,col:l},{row:o.row,col:l},t);d&&(n={rowIndex:d.row,colIndex:d.col,userEnterValue:d.value},s.push(n))}return a.view.canvas.selectApi.selectCells(a.view.canvas.normalSelectData,{xRange:[r.col,o.col],yRange:[r.row,i]},null),s}(n,r);case i.LAST_WHOLE_COL_CELL:return function(e,t){for(var n,r={col:e.startColIndex,row:e.startRowIndex},o={col:e.endColIndex,row:e.endRowIndex},s=[],i=r.row;i<=o.row;i++){var a={row:i,col:r.col},l={row:i,col:o.col-1},d=I(i,o.col,a,l,t);d&&(n={rowIndex:d.row,colIndex:d.col,userEnterValue:d.value},s.push(n))}return s}(n,r);case i.LAST_WHOLE_ROW_CELL:return function(e,t){for(var n,r={col:e.startColIndex,row:e.startRowIndex},o={col:e.endColIndex,row:e.endRowIndex},s=[],i=r.col;i<=o.col;i++){var a={row:r.row,col:i},l={row:o.row-1,col:i},d=I(o.row,i,a,l,t);d&&(n={rowIndex:d.row,colIndex:d.col,userEnterValue:d.value},s.push(n))}return s}(n,r);case i.LAST_WHOLE_COL_AND_ROW_CELL:return function(e,t){for(var n,r={col:e.startColIndex,row:e.startRowIndex},o={col:e.endColIndex,row:e.endRowIndex},s=[],i=r.row;i<=o.row;i++){var a={row:i,col:r.col},l={row:i,col:o.col-1},d=I(i,o.col,a,l,t);d&&(n={rowIndex:d.row,colIndex:d.col,userEnterValue:d.value},s.push(n))}for(var u=r.col;u<=o.col;u++){var c={row:r.row,col:u},h={row:o.row-1,col:u},f=I(o.row,u,c,h,t);f&&(n={rowIndex:f.row,colIndex:f.col,userEnterValue:f.value},s.push(n))}return s}(n,r)}}(u(r,e,t.toLocaleLowerCase()),r,e,t);o&&(Array.isArray(o)?n=n.concat(o):n.push(o))})),n}(e,t);n.length&&a.requestApi.userRangeEnter(n)}else console.warn("未初始化spreatsheet")}};function u(e,t,n){var l=t.endRowIndex,d=t.endColIndex,u=a.spreadsheet.activeSheet.getCellDataAtPosition(l,d),h=u;if(u){var f=u.getMergeReference();f&&(h=a.spreadsheet.activeSheet.getCellDataAtPosition(f.startRowIndex,f.startColIndex))}var p="";h&&(p=h.getEditValue());var g=n.replace(/sheet-formula-/,"");switch(e){case s.SINGLE_ROW:return function(e,t,n){var r=t.endColIndex;if(""===e||null===e)return i.LAST_CELL;if(e&&"="===e[0]){var s=/=([a-zA-Z]+)\(/,a=e.match(s),l=null===a||void 0===a?void 0:a[1];return(null===l||void 0===l?void 0:l.toLowerCase)&&l.toLowerCase()===n?i.LAST_CELL:r+1>=o?i.SELECTED_CELL:i.NEXT_COL_CELL}return r+1>=o?i.SELECTED_CELL:i.NEXT_COL_CELL}(p,t,g);case s.SINGLE_COL:return function(e,t,n){var o=t.endRowIndex;if(""===e||null===e)return i.LAST_CELL;if(e&&"="===e[0]){var s=/=([a-zA-Z]+)\(/,a=e.match(s),l=null===a||void 0===a?void 0:a[1];return(null===l||void 0===l?void 0:l.toLowerCase)&&l.toLowerCase()===n?i.LAST_CELL:o+1>=r?i.SELECTED_CELL:i.NEXT_ROW_CELL}return o+1>=r?i.SELECTED_CELL:i.NEXT_ROW_CELL}(p,t,g);case s.MULTI_ROW_COL:return c(t,g)}}function c(e,t){var n=e.endRowIndex,s=e.endColIndex;return function(e){var t=e.startRowIndex,n=e.startColIndex,s=e.endRowIndex,i=e.endColIndex;return 0===n&&0===t&&i===o-1&&s===r-1}(e)?i.SELECTED_CELL:h(e,t)===n+1?f(e,t)===s+1?i.LAST_WHOLE_COL_AND_ROW_CELL:i.LAST_WHOLE_COL_CELL:f(e,t)===s+1?i.LAST_WHOLE_ROW_CELL:n+1===r?i.SELECTED_CELL:i.NEXT_WHOLE_ROW_CELL}function h(e,t){var n,r=e.startRowIndex,o=e.endRowIndex,s=e.endColIndex;for(n=r;n<=o;n++){var i=a.spreadsheet.activeSheet.getCellDataAtPosition(n,s),l=i?i.getEditValue():"";if(p(l)){if(!l||"="!==l[0])break;var d=l.match(/=([a-zA-Z]+)\(/);if((null===d||void 0===d?void 0:d[1])!==t)break}}return n}function f(e,t){var n,r=e.startColIndex,o=e.endRowIndex,s=e.endColIndex;for(n=r;n<=s;n++){var i=a.spreadsheet.activeSheet.getCellDataAtPosition(o,n),l=i?i.getEditValue():"";if(p(l)){if(!l||"="!==l[0])break;var d=l.match(/=([a-zA-Z]+)\(/);if((null===d||void 0===d?void 0:d[1])!==t)break}}return n}function p(e){return""!==e&&null!==e}function g(e,t){var n={row:e.startRowIndex,col:e.startColIndex},r={row:e.endRowIndex,col:e.startColIndex},o=E(r.row+1);return a.view.canvas.selectApi.selectCells(a.view.canvas.normalSelectData,{xRange:[n.col,r.col],yRange:[n.row,o]},null),v(o,r.col,n,r,t)}function m(e,t){var n={col:e.startColIndex,row:e.startRowIndex},r={col:e.endColIndex,row:e.endRowIndex};return a.view.canvas.selectApi.selectCells(a.view.canvas.normalSelectData,{xRange:[n.col,r.col+1],yRange:[n.row,r.row]},null),v(r.row,r.col+1,n,r,t)}function v(e,t,n,r,o){var s=(0,l.cellCoords2CellChar)([n.row,n.col]),i=(0,l.cellCoords2CellChar)([r.row,r.col]),d=o.replace(/sheet-formula-/,"").toUpperCase();d="="+d+"("+s+":"+i+")";var u=a.spreadsheet.activeSheet.getCellDataAtPosition(e,t);if(u){var c=u.getFormula();if(c&&d===c.toString(e,t,a.spreadsheet.sheetManager))return}return{rowIndex:e,colIndex:t,userEnterValue:d}}function I(e,t,n,r,o){var s=(0,l.cellCoords2CellChar)([n.row,n.col]),i=(0,l.cellCoords2CellChar)([r.row,r.col]),d=o.replace(/sheet-formula-/,"").toUpperCase();d="="+d+"("+s+":"+i+")";var u=a.spreadsheet.activeSheet.getCellDataAtPosition(e,t);if(u){var c=u.getFormula();if(c&&d===c.toString(e,t,a.spreadsheet.sheetManager))return}return{row:e,col:t,value:d}}function E(e){var t=a.spreadsheet.activeSheet.getBasicFilter();if(!t)return e;for(var n=t.getHiddenRows();-1!==n.indexOf(e);)e+=1;return e}},"../spread-sheet/src/core/utils/numberFromat.ts":function(e,t,n){"use strict";n.r(t),n.d(t,{isLeagalNumber:function(){return c},stringToNumber:function(){return h}});var r=n("../packages/model/src/index.ts").Utils.numberFormatUtils.formatParseEngine,o=r.parseNumber,s=r.parsePercentage,i=r.parseCurrency,a=r.parseExponential,l=r.parseThousandNumber,d=r.parseFractionValue,u=r.parseDateTimeValue;function c(e,t){var n=h(e,t);return!(!n||"date"===n.type)}function h(e,t){var n=(void 0===t?{}:t).fractionFirst,r=void 0!==n&&n;return o(e,{})||s(e,{})||i(e,{})||a(e,{})||l(e,{})||d(e,r?{numberFormat:"fraction"}:{})||u(e,{})}},"../spread-sheet/src/core/utils/sheet.ts":function(e,t,n){"use strict";function r(e){for(var t=[],n=0;n<e.length;n++){var r=e[n];r&&t.push({id:r.getSheetId(),name:r.getTitle(),type:r.getSheetType(),hidden:r.getDisplayHidden()})}return[t]}function o(e){return!e.spreadsheet||e.spreadsheet.isFilterSync}n.r(t),n.d(t,{getAllSheets:function(){return r},getFilterSyncStatus:function(){return o}})},"../spread-sheet/src/core/utils/util.ts":function(e,t,n){"use strict";n.r(t),n.d(t,{API_CONFIG:function(){return a},CalcInputWidth:function(){return l},arrToObjectKey:function(){return p},checkEnumValue:function(){return u},checkExecuteForMultiSelection:function(){return v},clone:function(){return c},getOutScopeControlledPromise:function(){return I},getValueWithDefault:function(){return d},inArray:function(){return s},isBoolean:function(){return g},isSame:function(){return h},isUndefined:function(){return m},setHash:function(){return i},throttle:function(){return o}}),n("../node_modules/core-js/modules/es.object.keys.js"),n("../node_modules/core-js/modules/es.regexp.exec.js"),n("../node_modules/core-js/modules/es.string.replace.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.promise.js");var r=n("../packages/common-utils/src/index.ts");function o(e,t,n,r){var o;return r="undefined"===typeof r||r,function(){for(var s=arguments.length,i=new Array(s),a=0;a<s;a++)i[a]=arguments[a];var l=this;return"undefined"!==typeof n&&(l=n),r?(e.apply(l,i),r=!1):!o&&void(o=setTimeout((function(){clearTimeout(o),o=null,e.apply(l,i)}),t))}}function s(e,t){for(var n=0,r=e.length;n<r;n++)if(e[n]===t)return!0;return!1}function i(e){location.hash=e}var a,l=function(){function e(e){this.font=e,this.init()}var t=e.prototype;return t.init=function(){var e=document.createElement("pre");e.style.fontSize=this.font+"px",e.style.position="absolute",e.style.top="9999px",e.style.left="9999px",e.style.zIndex="-1",e.style.backgroundColor="transparent",e.style.fontFamily="Microsoft YaHei, Verdana, sans-serif",e.style.whiteSpace="pre",document.body.appendChild(e),this.dom=e},t.calc=function(e,t){if(this.dom.style.display="block",t)for(var n=Object.keys(t),o=0;o<n.length;o++)this.dom.style[n[o]]=t[n[o]];this.dom.innerHTML=(0,r.r)(e),this.dom.style.display="";var s=this.dom.offsetWidth;return this.dom.style.display="none",s},t.destroy=function(){var e;null===(e=this.dom)||void 0===e||e.remove()},e}();function d(e,t){return null!=e?e:t}function u(e,t){for(var n=Object.keys(t),r=0;r<n.length;r++)if(t[n[r]]===e)return e;return null}function c(e){return JSON.parse(JSON.stringify(e))}function h(e,t){return f(e)===f(t)}function f(e){return null==e?null:e}function p(e){return e.reduce((function(e,t){return e[t]=1,e}),{})}function g(e){return"boolean"===typeof e}function m(e){return"undefined"===typeof e}function v(e){if(n.g.SpreadsheetApp.view.getSelection().rangeSelections.length<=1)return!0;switch(e){case a.reorder:case a.setBasicFilter:case a.insideSheetCopyPaste:case a.applyPasteData:case a.moveRows:case a.moveColumns:return!1}return!0}function I(){var e=function(){},t=function(){};return{promise:new Promise((function(n,r){e=n,t=r})),resolve:e,reject:t}}!function(e){e[e.resizeColumns=0]="resizeColumns",e[e.mergeCells=1]="mergeCells",e[e.unmergeCells=2]="unmergeCells",e[e.insertRows=3]="insertRows",e[e.insertColumns=4]="insertColumns",e[e.hideRows=5]="hideRows",e[e.hideColumns=6]="hideColumns",e[e.showRows=7]="showRows",e[e.showColumns=8]="showColumns",e[e.deleteRows=9]="deleteRows",e[e.deleteColumns=10]="deleteColumns",e[e.resizeRows=11]="resizeRows",e[e.resizeRowsColumns=12]="resizeRowsColumns",e[e.moveRows=13]="moveRows",e[e.moveColumns=14]="moveColumns",e[e.setRowFormData=15]="setRowFormData",e[e.setColFormData=16]="setColFormData",e[e.reorder=17]="reorder",e[e.freeze=18]="freeze",e[e.userEnter=19]="userEnter",e[e.userEnterToSheetId=20]="userEnterToSheetId",e[e.userRangeEnter=21]="userRangeEnter",e[e.addImage=22]="addImage",e[e.updateImage=23]="updateImage",e[e.deleteImage=24]="deleteImage",e[e.insertLink=25]="insertLink",e[e.fontBold=26]="fontBold",e[e.autoWrap=27]="autoWrap",e[e.numberFormat=28]="numberFormat",e[e.formatPainter=29]="formatPainter",e[e.decreaceDecimal=30]="decreaceDecimal",e[e.increaceDecimal=31]="increaceDecimal",e[e.clearLink=32]="clearLink",e[e.clearFormat=33]="clearFormat",e[e.setLink=34]="setLink",e[e.clearContent=35]="clearContent",e[e.replace=36]="replace",e[e.redo=37]="redo",e[e.undo=38]="undo",e[e.smartSelection=39]="smartSelection",e[e.setBasicFilter=40]="setBasicFilter",e[e.clearBasicFilter=41]="clearBasicFilter",e[e.updateFilterCriteria=42]="updateFilterCriteria",e[e.applyPasteData=43]="applyPasteData",e[e.reorderWithFilter=44]="reorderWithFilter",e[e.insideSheetCopyPaste=45]="insideSheetCopyPaste",e[e.defineFormRange=46]="defineFormRange",e[e.insertImage=47]="insertImage",e[e.defineCommentRange=48]="defineCommentRange",e[e.deleteCommentRange=49]="deleteCommentRange",e[e.dataValidation=50]="dataValidation",e[e.clearDataValidation=51]="clearDataValidation",e[e.doPaste=52]="doPaste",e[e.freezePreview=53]="freezePreview",e[e.cancelFreezePreview=54]="cancelFreezePreview",e[e.addConditionFormat=55]="addConditionFormat",e[e.deleteConditionFormat=56]="deleteConditionFormat",e[e.updateConditionFormat=57]="updateConditionFormat",e[e.setSheet=58]="setSheet",e[e.setHorizontalAlign=59]="setHorizontalAlign",e[e.setVerticalAlign=60]="setVerticalAlign",e[e.inserFunction=61]="inserFunction",e[e.setBackgroundColor=62]="setBackgroundColor",e[e.setHideGridlines=63]="setHideGridlines",e[e.setBorder=64]="setBorder",e[e.setFontColor=65]="setFontColor",e[e.fontStrike=66]="fontStrike",e[e.setFontFamily=67]="setFontFamily",e[e.setFontSize=68]="setFontSize",e[e.fontItalics=69]="fontItalics",e[e.fontUnderLine=70]="fontUnderLine",e[e.formatPainterSetCache=71]="formatPainterSetCache",e[e.formatPainterApply=72]="formatPainterApply",e[e.formatPainterClear=73]="formatPainterClear",e[e.insertSheet=74]="insertSheet",e[e.delSheet=75]="delSheet",e[e.moveSheet=76]="moveSheet",e[e.hideSheet=77]="hideSheet",e[e.showSheet=78]="showSheet",e[e.renameSheet=79]="renameSheet",e[e.copySheet=80]="copySheet"}(a||(a={}))},"../spread-sheet/src/core/view-manager/index.ts":function(e,t,n){"use strict";n.d(t,{v:function(){return S}}),n("../node_modules/regenerator-runtime/runtime.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.promise.js"),n("../node_modules/core-js/modules/es.array.iterator.js"),n("../node_modules/core-js/modules/es.map.js"),n("../node_modules/core-js/modules/es.string.iterator.js"),n("../node_modules/core-js/modules/esnext.map.delete-all.js"),n("../node_modules/core-js/modules/esnext.map.every.js"),n("../node_modules/core-js/modules/esnext.map.filter.js"),n("../node_modules/core-js/modules/esnext.map.find.js"),n("../node_modules/core-js/modules/esnext.map.find-key.js"),n("../node_modules/core-js/modules/esnext.map.includes.js"),n("../node_modules/core-js/modules/esnext.map.key-of.js"),n("../node_modules/core-js/modules/esnext.map.map-keys.js"),n("../node_modules/core-js/modules/esnext.map.map-values.js"),n("../node_modules/core-js/modules/esnext.map.merge.js"),n("../node_modules/core-js/modules/esnext.map.reduce.js"),n("../node_modules/core-js/modules/esnext.map.some.js"),n("../node_modules/core-js/modules/esnext.map.update.js"),n("../node_modules/core-js/modules/web.dom-collections.iterator.js"),n("../node_modules/core-js/modules/web.dom-collections.for-each.js");var r=n("../packages/model/src/sheet/SheetType.ts"),o=n("../node_modules/@babel/runtime/helpers/esm/inheritsLoose.js"),s=(n("../node_modules/core-js/modules/es.object.keys.js"),n("../node_modules/core-js/modules/es.object.assign.js"),function(){function e(e){this.app=e,this.domBound=!1,this.node={}}var t=e.prototype;return t.onSwitchSheet=function(e){this!==e?this.hideViewContainer():this.showViewContainer()},t.getNode=function(){return this.node},e}()),i=n("../spread-sheet/src/core/view/layout/common/ocr-util.ts"),a=n("../spread-sheet/src/core/view/config/default.ts"),l=n("../spread-sheet/src/base/event/event.ts"),d=n("../spread-sheet/src/core/data/configService/spreadConfig.ts"),u=n("../spread-sheet/src/base/util/ui.tsx"),c=n("../spread-sheet/src/base/index.ts"),h=n("../spread-sheet/src/external/interaction/base/interaction-base.interface.ts"),f=function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function i(e){try{l(r.next(e))}catch(t){s(t)}}function a(e){try{l(r.throw(e))}catch(t){s(t)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,a)}l((r=r.apply(e,t||[])).next())}))},p=function(e){function t(){return e.apply(this,arguments)||this}(0,o.Z)(t,e);var s=t.prototype;return s.init=function(){this.createViewContainer(),this.initEvent(),this.hideViewContainer(),this.resizeEventList=[]},s.bindMountContainer=function(){},s.hideViewContainer=function(){var e=this;Object.keys(this.node).forEach((function(t){var n;null===(n=e.node[t])||void 0===n||n.classList.add("block-hidden")}))},s.showViewContainer=function(){var e,t,n=this;Object.keys(this.node).forEach((function(e){var t;null===(t=n.node[e])||void 0===t||t.classList.remove("block-hidden")})),this.updateContainerSize(),this.updateMobileContainerSize(null===(t=null===(e=this.app.view)||void 0===e?void 0:e.interaction)||void 0===t?void 0:t.getStatus())},s.render=function(e){return f(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=this.app.sheetAdapterManager.getAdapterBySheetType(r.ZP.SMART_SHEET),t.next=3,null===n||void 0===n?void 0:n.render(e);case 3:this.app.view.canvas.dataCallView.stop(),this.app.view.canvas.dataCallView.start(),this.updateContainerSize();case 6:case"end":return t.stop()}}),t,this)})))},s.resize=function(){this.updateContainerSize(),this.resizeEventList.forEach((function(e){null===e||void 0===e||e()}))},s.onResize=function(e){e&&this.resizeEventList.push(e)},s.setTopPosition=function(e){var t=this.node.container;t.style.transform="translateY("+e+"px)",setTimeout((function(){t.style.height="calc(100vh - "+e+"px)"}),600)},s.createViewContainer=function(){var e;e=this.insertContainerInPc(),this.node.container=e;var t=document.getElementById("mainContainer");null===t||void 0===t||t.appendChild(e)},s.insertContainerInPc=function(){var e=document.getElementById("mainEditor"),t=e?e.getBoundingClientRect().top:0,n=document.createElement("div");return n.id="external-sheet-container",n.innerHTML="",n.style.width="100%",n.style.zIndex="500",n.style.display="block",n.style.height=window.innerHeight-t+"px",n},s.insertContainerInMobile=function(){document.querySelector("html").style.width="100%",document.body.style.height="100vh",document.body.style.width="100vw",document.body.style.overflow="hidden";var e=document.createElement("div");return Object.assign(e.style,{position:"absolute",top:"0",zIndex:"1001",width:"100vw",height:"calc(100vh - "+a.MN+"px)",overflow:"hidden",transform:"translateY("+(i.VQ?0:a.MN)+"px)",transition:"transform .3s ease",backgroundColor:"#f4f5f9",transformOrigin:"left top"}),e.setAttribute("id","external-sheet-container"),(0,u.vb)(e),e},s.insertContainerInPad=function(){document.querySelector("html").style.width="100%",document.body.style.height="100%",document.body.style.width="100%",document.body.style.overflow="hidden";var e=document.createElement("div");e.id="external-sheet-container";var t=i.VQ?0:a.Mz;return d.q.getConfig("isHistory"),Object.assign(e.style,{position:"absolute",top:"0",marginTop:"0",zIndex:"501",width:"100%",height:window.innerHeight-t+"px",overflow:"hidden",transform:"translateY("+t+"px)",transition:"transform .5s ease",backgroundColor:"#f4f5f9",transformOrigin:"left top",padding:"0",borderTop:"1px solid #e2e4e8"}),e},s.updateContainerSize=function(){var e,t,r=this.node.container,o=document.querySelector("#footerContainer"),s=(null===o||void 0===o?void 0:o.clientHeight)||0,i=null!==(t=null===(e=null===r||void 0===r?void 0:r.getBoundingClientRect())||void 0===e?void 0:e.top)&&void 0!==t?t:100;d.q.getConfig("isHistory")&&(i=0),r.style.height=n.g.innerHeight-i-s+"px"},s.updateMobileContainerSize=function(e){this.app.spreadsheet.isExternalSheet()&&e&&this.node.container},s.initEvent=function(){var e=this;l.ZP.windowEvent.listen("resize",(function(){e.updateContainerSize()})),this.app.event.view.listen(c.Z.EVENT_NAME.ENTER_SCAN_STATUS,(function(){e.updateMobileContainerSize(h.$.SCAN)})),this.app.event.view.listen(c.Z.EVENT_NAME.ENTER_NORMAL_STATUS,(function(){e.updateMobileContainerSize(h.$.NORMAL)}))},t}(s),g=n("../node_modules/@tencent/ioc/lib/esm/index.js"),m=n("../spread-sheet/src/core/workbench/common/openEditorService.ts"),v=function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function i(e){try{l(r.next(e))}catch(t){s(t)}}function a(e){try{l(r.throw(e))}catch(t){s(t)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,a)}l((r=r.apply(e,t||[])).next())}))},I=function(e){function t(){return e.apply(this,arguments)||this}(0,o.Z)(t,e);var n=t.prototype;return n.init=function(){},n.bindMountContainer=function(){var e=document.getElementById("mainContainer");this.formulaBar=e.getElementsByClassName("formula-bar")[0],this.mainEditor=document.getElementById("mainEditor"),this.toolbarWrapper=document.getElementsByClassName("pc-toolbar")[0],this.node={formulaBar:this.formulaBar,mainEditor:this.mainEditor,toolbarWrapper:this.toolbarWrapper},this.domBound=!0},n.hideViewContainer=function(){var e=this;this.domBound||this.bindMountContainer(),Object.keys(this.node).forEach((function(t){var n,r;null===(r=null===(n=e.node[t])||void 0===n?void 0:n.classList)||void 0===r||r.add("block-hidden")})),document.body.classList.add("sheet-self-child-hidden")},n.showViewContainer=function(){var e=this;Object.keys(this.node).forEach((function(t){var n,r;null===(r=null===(n=e.node[t])||void 0===n?void 0:n.classList)||void 0===r||r.remove("block-hidden")})),document.body.classList.remove("sheet-self-child-hidden")},n.render=function(e,t){var n;return v(this,void 0,void 0,regeneratorRuntime.mark((function r(){var o;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return o=g.Am.get(m.Z),r.next=3,o.switchToSheet();case 3:this.app.view.render(e,null===t||void 0===t?void 0:t.source),null===(n=this.app.view)||void 0===n||n.canvas.resize.resize();case 5:case"end":return r.stop()}}),r,this)})))},n.resize=function(){this.app.view.canvas.resize.resize()},n.onResize=function(){},n.setTopPosition=function(){},t}(s),E=function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function i(e){try{l(r.next(e))}catch(t){s(t)}}function a(e){try{l(r.throw(e))}catch(t){s(t)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,a)}l((r=r.apply(e,t||[])).next())}))},S=function(){function e(e){this.app=e,this.typeMap=new Map,this.viewMap=new Map,this.init(),this.typeMap.set(r.ZP.FORM,r.ZP.GRID),this.typeMap.set(r.ZP.OBJECT,r.ZP.GRID),this.typeMap.set(r.ZP.GRID,r.ZP.GRID)}var t=e.prototype;return t.renderView=function(e,t,r){return E(this,void 0,void 0,regeneratorRuntime.mark((function o(){var s,i;return regeneratorRuntime.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:if(s=this.typeMap.get(e),i=this.getView(s)){o.next=5;break}return n.g.log.error(e+"对应视图还未注册，无法渲染子表"+t+"！"),o.abrupt("return");case 5:return i!==this.activeView&&(this.activeView=i,this.notifySwitchSheet()),o.next=8,i.render(t,r);case 8:case"end":return o.stop()}}),o,this)})))},t.hiddenOtherContainer=function(e){var t=this,n=this.typeMap.get(e);this.viewMap.forEach((function(e){t.viewMap.get(n)===e?(t.activeView=e,e.showViewContainer()):e.hideViewContainer()}))},t.registerView=function(e,t){var n=t||new p(this.app);return this.viewMap.set(e,n),this.typeMap.set(e,e),n.init(),n},t.getView=function(e){var t=this.typeMap.get(e);if(!this.viewMap.has(t))throw new Error("不存在对应的 sheetType = "+e+"的 view。");return this.viewMap.get(t)},t.getActiveView=function(){return this.activeView},t.resize=function(){this.activeView.resize()},t.isNormalSheet=function(){return this.activeView instanceof I},t.init=function(){this.initDefaultViews()},t.initDefaultViews=function(){this.viewMap.set(r.ZP.GRID,new I(this.app)),this.viewMap.forEach((function(e){e.init()}))},t.notifySwitchSheet=function(){var e=this;this.viewMap.forEach((function(t){t.onSwitchSheet(e.activeView)}))},e}()},"../spread-sheet/src/core/view/View.level1.pc.ts":function(e,t,n){"use strict";n.d(t,{Z:function(){return ne}});var r,o,s,i,a,l,d=n("../node_modules/@babel/runtime/helpers/esm/inheritsLoose.js"),u=(n("../node_modules/regenerator-runtime/runtime.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.promise.js"),n("../node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),n("../node_modules/core-js/modules/esnext.reflect.metadata.js"),n("../spread-sheet/src/core/app/SpreadsheetApp.interface.ts")),c=n("../node_modules/@tencent/containerized/build/main/index.js"),h=n("../packages/model/src/spreadsheet/Spreadsheet.interface.ts"),f=n("../spread-sheet/src/core/view/spreadsheet-view/SpreadsheetView.interface.ts"),p=n("../spread-sheet/src/core/view/lib/mutex-management/MutexManagement.interface.ts"),g=n("../spread-sheet/src/core/view/level-1/auto-scroll/AutoScroll.ts"),m=n("../spread-sheet/src/core/view/level-1/error-tip-accessor/ErrorTipAccessor.ts"),v=n("../spread-sheet/src/core/view/level-1/default-scale/DefaultScale.ts"),I=n("../spread-sheet/src/core/view/data-call-view/DataCallView.interface.ts"),E=n("../spread-sheet/src/core/view/level-1/modify-broker/cell/modify-cell-broker.ts"),S=n("../spread-sheet/src/core/view/level-1/modify-broker/chart/modify-chart-broker.ts"),R=n("../spread-sheet/src/core/view/level-1/modify-broker/dimension/modify-dimension-broker.ts"),w=n("../spread-sheet/src/core/view/level-1/modify-broker/link/modify-link-broker.ts"),A=n("../spread-sheet/src/core/view/level-1/modify-broker/selection/modify-selection-broker.ts"),C=n("../spread-sheet/src/core/view/level-1/modify-broker/shape/modify-shape-broker.ts"),y=n("../spread-sheet/src/core/view/level-1/modify-broker/smart-selection/modify-smart-selection-broker.ts"),_=n("../spread-sheet/src/core/view/level-1/select-center/normal-select-data/NormalSelectData.ts"),T=n("../spread-sheet/src/core/view/level-1/formula-select-data/FormulaSelectData.ts"),x=n("../spread-sheet/src/core/view/level-1/scroll-api/ScrollApi.ts"),b=n("../spread-sheet/src/core/view/level-1/select-api/SelectApi.ts"),D=n("../spread-sheet/src/core/view/level-1/shape-stage/stage/DomShapeStage.ts"),O=n("../spread-sheet/src/core/view/level-1/scale-operate/ScaleOperate.ts"),M=n("../spread-sheet/src/core/data/configService/spreadConfig.ts"),j=n("../spread-sheet/src/core/view/level-1/drag-operate/DragOperate.ts"),L=n("../spread-sheet/src/core/view/level-1/modify-broker/mention-notify-ent/modify-mention-notify-broker.ts"),Z=n("../node_modules/lodash/throttle.js"),k=n.n(Z),N=n("../spread-sheet/src/core/view/config/default.ts"),P=function(e,t,n,r){var o,s=arguments.length,i=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)i=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(i=(s<3?o(i):s>3?o(t,n,i):o(t,n))||i);return s>3&&i&&Object.defineProperty(t,n,i),i},U=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},F=function(e,t){return function(n,r){t(n,r,e)}},V=function(){function e(e,t,n,r,o,s){var i=this;this.instantiationService=e,this.spreadsheetApp=t,this.spreadsheet=n,this.spreadsheetView=r,this.mutexManagement=o,this.dataCallView=s,this._level0Inited=!1,this.container=r.container,this.paragraphAccessor=r.paragraphAccessor,this.tableView=r.tableView,this.resize=r.resize,this.clientRect=r.clientRect,this.scale=r.scale,this.headSize=r.headSize,this.transformTable=r.transformTable,this.alloyExcel=r.renderManager.alloyExcel,this.rowcolAccessor=r.rowcolAccessor,this.rowCoverAccessor=r.rowCoverAccessor,this.borderAccessor=r.borderAccessor,this.areaData=r.areaData,this.renderApi=r.renderManager.renderApi,this.mainBoard=r.mainBoard,this.spreadConfig=M.q,this.errorTipAccessor=new m.Z(this.dataCallView,this.spreadsheet),this.autoScroll=new g.ZP(this.spreadsheetView),this.defaultScale=new v.Z(this.spreadsheetView),this.operateData=this.spreadsheetView.operateContext.operateData,this.operateBoard=this.spreadsheetView.operateContext.operateBoard,this.mouseOperate=this.spreadsheetView.operateContext.mouseOperate,this.touchOperate=this.spreadsheetView.operateContext.touchOperate,this.dragOperate=new j.Z(this.container),this.normalSelectData=new _.Z(this.dataCallView,this.spreadsheetView),this.formulaSelectData=new T.Z(this.dataCallView,this.spreadsheetView),this.normalSelectData.onModifySelectData(k()((function(){i.renderApi.renderColHead(),i.renderApi.renderRowHead()}),N.dT)),this.modifyCellBroker=new E.Z(this.spreadsheetApp,this.spreadsheet),this.modifyChartBroker=new S.Z(this.spreadsheetApp,this.spreadsheet),this.modifyDimensionBroker=new R.Z(this.spreadsheetApp,this.spreadsheet,this.spreadsheetView,this.normalSelectData),this.modifyLinkBroker=new w.Z(this.spreadsheetApp),this.modifySelectionBroker=new A.Z(this.normalSelectData),this.modifyShapeBroker=new C.Z(this.spreadsheetApp,this.spreadsheet),this.modifySmartSelectionBroker=new y.Z(this.spreadsheetApp),this.modifyMentionNotifyBroker=new L.Z({spreadsheet:this.spreadsheet,normalSelectData:this.normalSelectData}),this.scrollApi=new x.Z(this.spreadsheetView),this.selectApi=new b.Z(this.spreadsheetView),this.shapeStage=new D.Z(this.spreadsheet,this.dataCallView,this.spreadsheetView),this.scaleOperate=new O.Z(this.spreadsheetView,this.scrollApi,this.spreadsheetApp)}var t=e.prototype;return t.initLevel0=function(){this._level0Inited?console.info("view.level0已经初始化"):(console.info("view.level0初始化"),this._level0Inited=!0)},t.init=function(e){this.dataCallView.refresh(e),this.paragraphAccessor.init(e),this.rowCoverAccessor.init(e),this.rowcolAccessor.init(e),this.tableView.init(e),this.borderAccessor.init(e),this.areaData.refresh(),this.mainBoard.refresh(),this.borderAccessor.init(e),this.errorTipAccessor.refresh(e),this.shapeStage.refresh()},t.refresh=function(e){this.dataCallView.refresh(e),this.paragraphAccessor.refresh(e),this.rowCoverAccessor.refresh(e),this.rowcolAccessor.refresh(e),this.tableView.refresh(e),this.borderAccessor.refresh(e),this.areaData.refresh(),this.mainBoard.refresh(),this.borderAccessor.refresh(e),this.errorTipAccessor.refresh(e),this.shapeStage.refresh()},e}(),B=V=P([F(0,c.TG),F(1,u.m),F(2,h.V),F(3,f.Z),F(4,p.Z),F(5,I.Z),U("design:paramtypes",["function"===typeof(r="undefined"!==typeof c.TG&&c.TG)?r:Object,"function"===typeof(o="undefined"!==typeof u.m&&u.m)?o:Object,"function"===typeof(s="undefined"!==typeof h.V&&h.V)?s:Object,"function"===typeof(i="undefined"!==typeof f.Z&&f.Z)?i:Object,"function"===typeof(a="undefined"!==typeof p.Z&&p.Z)?a:Object,"function"===typeof(l="undefined"!==typeof I.Z&&I.Z)?l:Object])],V),H=n("../spread-sheet/src/core/view/level-1/wheel-operate/WheelOperate.ts"),G=n("../spread-sheet/src/core/view/level-1/slide-operate/SlideOperate.ts"),W=n("../spread-sheet/src/core/view/level-1/input-manager/InputManager.pc.ts"),z=n("../spread-sheet/src/core/view/level-1/wheel-operate/WheelEffect.ts"),Q=n("../spread-sheet/src/core/view/level-1/slide-operate/SlideEffect.pc.ts"),Y=n("../spread-sheet/src/core/view/level-1/formula-select-stage/stage/FormulaSelectionStage.pc.ts"),q=n("../spread-sheet/src/core/view/level-1/select-center/normal-select-stage/stage/DomSelectionStage.pc.ts"),J=n("../spread-sheet/src/core/view/level-1/cell-image-manager/index.ts"),K=n("../spread-sheet/src/core/view/level-2/select-cells-center/SelectCellsCenter.pc.ts"),X=n("../spread-sheet/src/core/view/level-1/link-identify-center/link-identify-center.ts"),$=n("../spread-sheet/src/core/view/level-1/scroll-bar/ScrollBar.pc.ts"),ee=function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function i(e){try{l(r.next(e))}catch(t){s(t)}}function a(e){try{l(r.throw(e))}catch(t){s(t)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,a)}l((r=r.apply(e,t||[])).next())}))},te=function(e){function t(){var t;return(t=e.apply(this,arguments)||this)._level1Inited=!1,t}(0,d.Z)(t,e);var n=t.prototype;return n.initLevel1=function(t){e.prototype._level0Inited||e.prototype.initLevel0.call(this),this._level1Inited?console.info("view.level1已经初始化"):(this.initLevel1Readonly(),this.spreadsheetApp.sheetStatus.workbookStatus.canEdit&&this.initLevel1Edit(),!(null===t||void 0===t?void 0:t.preview)&&this._initInputManager(),console.info("view.level1初始化"),this._level1Inited=!0)},n.init=function(t){e.prototype.init.call(this,t)},n.refresh=function(t){e.prototype.refresh.call(this,t)},n.initLevel1Readonly=function(){this._initNormalSelectionStage(),this._initFormulaSelectionStage(),this._initWheelOperate(),this._initSlideOperate(),this._initCellImageManager(),this._initSelectCells(),this.initScrollBar()},n.initLevel1Edit=function(){this._initLinkIdentifyCenter()},n._initSelectCells=function(){this.selectCellsCenter=new K.Z({spreadsheet:this.spreadsheet,tableView:this.tableView,rowcolAccessor:this.rowcolAccessor,areaData:this.areaData,touchOperate:this.touchOperate,mouseOperate:this.mouseOperate,selectData:this.normalSelectData,operateData:this.operateData,container:this.container,scrollApi:this.scrollApi,keyboardMount:this.container,normalSelectData:this.normalSelectData,formulaSelectData:this.formulaSelectData,normalSelectionStage:this.normalSelectionStage,formulaSelectionStage:this.formulaSelectionStage,autoScroll:this.autoScroll,clientRect:this.clientRect,mutexManagement:this.mutexManagement})},n._initWheelOperate=function(){this.wheelOperate=new H.Z(this.spreadsheetView,[this.mainBoard.element,this.operateBoard.board]),new z.Z(this.wheelOperate,this.spreadsheetView)},n._initSlideOperate=function(){this.slideOperate=new G.Z(this.spreadsheetView),new Q.Z(this.slideOperate,this.spreadsheetView)},n._initNormalSelectionStage=function(){this.normalSelectionStage=new q.Z(this.normalSelectData,this.spreadsheetView,this.spreadsheetApp.sheetStatus,this.mutexManagement)},n._initFormulaSelectionStage=function(){this.formulaSelectionStage=new Y.Z(this.formulaSelectData,this.spreadsheetView,this.mutexManagement)},n._initInputManager=function(){this.inputManager=new W.ZP(this.container,this.spreadsheet,this.spreadsheetApp.view,this.spreadsheetApp.mutationBehavior,this.spreadsheetApp.sheetStatus,this.spreadsheetView,this.dataCallView,this.modifyCellBroker,this.normalSelectData,this.formulaSelectData,this.normalSelectionStage,this.mutexManagement,this.linkIdentifyCenter,this.defaultScale,this.scrollApi,this.slideOperate)},n._initCellImageManager=function(){this.cellImageManager=new J.Z({event:this.spreadsheetApp.event,mutationBehavior:this.spreadsheetApp.mutationBehavior,spreadsheet:this.spreadsheet,renderApi:this.renderApi})},n._initLinkIdentifyCenter=function(){this.linkIdentifyCenter=new X.N(this.spreadsheet,this.modifyCellBroker)},n.initScrollBar=function(){return ee(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.scrollBar=new $.Z({mainBoard:this.spreadsheetView.mainBoard,areaData:this.spreadsheetView.areaData,scale:this.spreadsheetView.scale});case 1:case"end":return e.stop()}}),e,this)})))},t}(B),ne=te},"../spread-sheet/src/core/view/data-call-view/DataCallView.interface.ts":function(e,t,n){"use strict";var r=(0,n("../node_modules/@tencent/containerized/build/main/index.js").yh)("IDataCallView");t.Z=r},"../spread-sheet/src/core/view/data-call-view/DataCallView.ts":function(e,t,n){"use strict";var r,o=n("../node_modules/@babel/runtime/helpers/esm/inheritsLoose.js"),s=(n("../node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),n("../node_modules/core-js/modules/esnext.reflect.metadata.js"),n("../node_modules/core-js/modules/es.array.iterator.js"),n("../node_modules/core-js/modules/es.map.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.string.iterator.js"),n("../node_modules/core-js/modules/esnext.map.delete-all.js"),n("../node_modules/core-js/modules/esnext.map.every.js"),n("../node_modules/core-js/modules/esnext.map.filter.js"),n("../node_modules/core-js/modules/esnext.map.find.js"),n("../node_modules/core-js/modules/esnext.map.find-key.js"),n("../node_modules/core-js/modules/esnext.map.includes.js"),n("../node_modules/core-js/modules/esnext.map.key-of.js"),n("../node_modules/core-js/modules/esnext.map.map-keys.js"),n("../node_modules/core-js/modules/esnext.map.map-values.js"),n("../node_modules/core-js/modules/esnext.map.merge.js"),n("../node_modules/core-js/modules/esnext.map.reduce.js"),n("../node_modules/core-js/modules/esnext.map.some.js"),n("../node_modules/core-js/modules/esnext.map.update.js"),n("../node_modules/core-js/modules/web.dom-collections.iterator.js"),n("../node_modules/core-js/modules/web.dom-collections.for-each.js"),n("../node_modules/core-js/modules/es.string.starts-with.js"),n("../node_modules/core-js/modules/es.array.sort.js"),n("../node_modules/lodash/cloneDeep.js")),i=n.n(s),a=n("../packages/model/src/spreadsheet/Spreadsheet.interface.ts"),l=n("../spread-sheet/src/base/event/event.ts"),d=n("../packages/mutation/src/MutationId.ts"),u=n("../packages/mutation/src/api.ts"),c=n("../packages/model/src/dimension/DimensionType.ts"),h=n("../packages/mutation/src/dimension/SetDimensionPropertiesMutation.ts"),f=n("../packages/model/src/sheet/SheetPropertiesSlot.ts"),p=n("../packages/lib/index.ts"),g=n("../node_modules/@tencent/containerized/build/main/index.js"),m=n("../packages/model/src/workbookRange/index.ts"),v=n("../spread-sheet/src/base/config/report.ts"),I=n("../packages/report/src/index.ts"),E=n("../packages/model/src/new-embedded/index.ts"),S=n("../packages/model/src/filter-view/filter-view-util.ts"),R=n("../spread-sheet/src/core/view/level-2/addon/const.ts"),w=function(e,t,n,r){var o,s=arguments.length,i=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)i=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(i=(s<3?o(i):s>3?o(t,n,i):o(t,n))||i);return s>3&&i&&Object.defineProperty(t,n,i),i},A=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},C=function(e,t){return function(n,r){t(n,r,e)}},y=function(e){function t(t){var n;return(n=e.call(this)||this).spreadsheet=t,n.formulaDisplay=!1,n.cacheFilterRangeInSheet={},n.cacheFilterRangeInFilterView={},n.cacheMapRuleInActiveFilterView=new Map,n.onInsertRowEmitter=new p.Q5,n.onInsertColEmitter=new p.Q5,n.onDeleteRowEmitter=new p.Q5,n.onDeleteColEmitter=new p.Q5,n.onSetRowHeightEmitter=new p.Q5,n.onSetColWidthEmitter=new p.Q5,n.onSetRowVisibleEmitter=new p.Q5,n.onSetColVisibleEmitter=new p.Q5,n.onUpdateCellsEmitter=new p.Q5,n.onMergeUnmergeEmitter=new p.Q5,n.onAddEmbeddedObjectEmitter=new p.Q5,n.onUpdateEmbeddedObjectEmitter=new p.Q5,n.onDeleteEmbeddedObjectEmitter=new p.Q5,n.onUpdateHideGridLinesEmitter=new p.Q5,n.onUpdateFreezeEmitter=new p.Q5,n.onAddChartEmitter=new p.Q5,n.onDeleteChartEmitter=new p.Q5,n.onUpdateChartEmitter=new p.Q5,n.onAddAddonEmitter=new p.Q5,n.onDeleteAddonEmitter=new p.Q5,n.onUpdateAddonEmitter=new p.Q5,n.allSheetHandleMutations=[d.ZP.INSERT_DIMENSION_MUTATION,d.ZP.DELETE_DIMENSION_MUTATION,d.ZP.SET_DIMENSION_PROPERTIES_MUTATION,d.ZP.SET_RANGE_MUTATION,d.ZP.SET_CELL_PROPERTIES_MUTATION,d.ZP.REORDER_RANGE_MUTATION,d.ZP.COPY_PASTE_MUTATION,d.ZP.DEFINE_FILTER_MUTATION,d.ZP.UPDATE_FILTER_MUTATION,d.ZP.DELETE_FILTER_MUTATION,d.ZP.MERGE_CELLS_MUTATION,d.ZP.UNMERGE_CELLS_MUTATION],n._handleAfterMutationRun=function(e){try{if(n.spreadsheet.activeSheetId!==e.sheetId&&-1===n.allSheetHandleMutations.indexOf(e.mutation.id)&&"WORKBOOK"!==e.sheetId)return;var t=e.mutation;switch(t.id){case d.ZP.INSERT_DIMENSION_MUTATION:n._insertDimension(t);break;case d.ZP.DELETE_DIMENSION_MUTATION:n._deleteDimension(t);break;case d.ZP.SET_DIMENSION_PROPERTIES_MUTATION:n._setDimensionProperties(t);break;case d.ZP.SET_RANGE_MUTATION:n._setRange(t,e.sheetId);break;case d.ZP.SET_CELL_PROPERTIES_MUTATION:n._setCellProperties(t,e.sheetId);break;case d.ZP.REORDER_RANGE_MUTATION:n._reorderRange(t,e.sheetId);break;case d.ZP.COPY_PASTE_MUTATION:n._copyPaste(t);break;case d.ZP.MERGE_CELLS_MUTATION:case d.ZP.UNMERGE_CELLS_MUTATION:n._mergeOrUnmerge(t);break;case d.ZP.ADD_EMBEDDED_OBJECT_MUTATION:n._addEmbedded(t);break;case d.ZP.UPDATE_EMBEDDED_OBJECT_MUTATION:n._updateEmbedded(t);break;case d.ZP.DELETE_EMBEDDED_OBJECT_MUTATION:n._deleteEmbedded(t);break;case d.ZP.SET_SHEET_PROPERTIES_MUTATION:n._setSheetProperties(t);break;case d.ZP.DEFINE_FILTER_MUTATION:n._defineFilter(t);break;case d.ZP.UPDATE_FILTER_MUTATION:n._updateFilter(t);break;case d.ZP.DELETE_FILTER_MUTATION:n._deleteFilter(t);break;case d.ZP.NEW_ADD_EMBEDDED_OBJECT_MUTATION:n._newAddEmbeddedObject(t);break;case d.ZP.NEW_UPDATE_EMBEDDED_OBJECT_MUTATION:n._newUpdateEmbeddedObject(t);break;case d.ZP.NEW_DELETE_EMBEDDED_OBJECT_MUTATION:n._newDeleteEmbeddedObject(t);break;case d.ZP.UPDATE_WORKBOOK_RANGE_MUTATION:t.workbookRangeType===m.WORKBOOK_RANGE_TYPE.CHART&&n.reRenderChart({workbookRangeId:t.workbookRangeId});break;case d.ZP.ACTIVE_FILTER_VIEW_MUTATION:n.activeFilterView(t)}}catch(r){I.ZP.zzsStatus({attrid:v.ZZS_REPORT_ATTR.MUTATION_APPLY_TO_VIEW_ERROR,status:1})}},n.handleBeforeMutationRun=function(){var e=n.spreadsheet.activeSheet.filterViewManager.getActiveFilterView();e?n.cacheMapRuleInActiveFilterView=i()(e.getSheet2FilterViewMap()):n.cacheMapRuleInActiveFilterView.clear()},n.updateFilterViewRange=function(e){var t,r=n.spreadsheet.activeSheet.filterViewManager.getActiveFilterView();if(r){var o=null===(t=r.getBasicFilter())||void 0===t?void 0:t.range;(null===o||void 0===o?void 0:o.isCross(e))&&n.onUpdateCellsEmitter.fire({sheetId:e.sheetId,startRow:o.startRowIndex,endRow:o.endRowIndex,startCol:o.startColIndex,endCol:o.endColIndex})}},n.onInsertRow=n.onInsertRowEmitter.event,n.onInsertCol=n.onInsertColEmitter.event,n.onDeleteRow=n.onDeleteRowEmitter.event,n.onDeleteCol=n.onDeleteColEmitter.event,n.onSetRowHeight=n.onSetRowHeightEmitter.event,n.onSetColWidth=n.onSetColWidthEmitter.event,n.onSetRowVisible=n.onSetRowVisibleEmitter.event,n.onSetColVisible=n.onSetColVisibleEmitter.event,n.onUpdateCells=n.onUpdateCellsEmitter.event,n.onMergeUnmerge=n.onMergeUnmergeEmitter.event,n.onAddEmbeddedObject=n.onAddEmbeddedObjectEmitter.event,n.onUpdateEmbeddedObject=n.onUpdateEmbeddedObjectEmitter.event,n.onDeleteEmbeddedObject=n.onDeleteEmbeddedObjectEmitter.event,n.onUpdateHideGridLines=n.onUpdateHideGridLinesEmitter.event,n.onUpdateFreeze=n.onUpdateFreezeEmitter.event,n.onAddChart=n.onAddChartEmitter.event,n.onDeleteChart=n.onDeleteChartEmitter.event,n.onUpdateChart=n.onUpdateChartEmitter.event,n.onAddAddon=n.onAddAddonEmitter.event,n.onDeleteAddon=n.onDeleteAddonEmitter.event,n.onUpdateAddon=n.onUpdateAddonEmitter.event,n.updateCacheFilterRange(t.activeSheetId),n.start(),n}(0,o.Z)(t,e);var r=t.prototype;return r.stop=function(){var e;null===(e=n.g.log)||void 0===e||e.debug("flow DataCallView stop()"),l.ZP.spreadsheetEvent.remove("renderAfterMutationRun",this._handleAfterMutationRun),this.spreadsheet.parent.mutationBehavior.emitter.off(u.Z.EVENT.BEFORE_MUTATION_RUN,this.handleBeforeMutationRun)},r.start=function(){l.ZP.spreadsheetEvent.listen("renderAfterMutationRun",this._handleAfterMutationRun),this.spreadsheet.parent.mutationBehavior.emitter.on(u.Z.EVENT.BEFORE_MUTATION_RUN,this.handleBeforeMutationRun)},r.refresh=function(e){this.updateCacheFilterRange(e),this.stop(),this.start()},r.openFormulaDisplay=function(){this.formulaDisplay=!0},r.closeFormulaDisplay=function(){this.formulaDisplay=!1},r.reRenderChart=function(e){var t=this;this.spreadsheet.embeddedObjectManager.each((function(n){var r=n.properties.chart;r&&r.workbookRangeId.indexOf(e.workbookRangeId)>-1&&n.location.sheetId===t.spreadsheet.activeSheetId&&t.onUpdateChartEmitter.fire({object:n})}))},r.setRowHeight=function(e,t,n){this.onSetRowHeightEmitter.fire({ranges:[{startIndex:e,endIndex:e,dimension:c.Z.ROWS}],size:t,sheetId:n})},r.updateCacheFilterRange=function(e){var t,n=this.spreadsheet.sheetManager.getSheetBySheetId(e);this.cacheFilterRangeInSheet[e]=null===(t=null===n||void 0===n?void 0:n.getBasicFilter())||void 0===t?void 0:t.range},r.updateCacheFilterRangeInFilterView=function(e,t){var n,r=this.spreadsheet.sheetManager.getSheetBySheetId(e),o=null===(n=null===r||void 0===r?void 0:r.getBasicFilter())||void 0===n?void 0:n.range;this.cacheFilterRangeInFilterView[t]=o},r._insertDimension=function(e){e.type===c.Z.ROWS?(e.index=(0,S.Wo)(e.index,this.cacheMapRuleInActiveFilterView),this.onInsertRowEmitter.fire(e)):this.onInsertColEmitter.fire(e)},r._deleteDimension=function(e){e.type===c.Z.ROWS?(e.index=(0,S.Wo)(e.index,this.cacheMapRuleInActiveFilterView),this.onDeleteRowEmitter.fire(e)):this.onDeleteColEmitter.fire(e)},r._setDimensionProperties=function(e){for(var t=0;t<e.operation.length;t++){var n=e.operation[t];if(n.slot===h.P8.SLOT_SIZE){var r={ranges:e.ranges,size:n.size,sheetId:e.sheetId};e.type===c.Z.ROWS?this.onSetRowHeightEmitter.fire(r):this.onSetColWidthEmitter.fire(r)}else if(n.slot===h.P8.SLOT_HIDDEN){var o={ranges:e.ranges,hidden:!!n.hidden,sheetId:e.sheetId};e.type===c.Z.ROWS?this.onSetRowVisibleEmitter.fire(o):this.onSetColVisibleEmitter.fire(o)}}},r._setRange=function(e,t){var n=this;this.setRangeMutationToUpdateRanges(e,t).forEach((function(e){n.onUpdateCellsEmitter.fire(e)})),this.updateFilterViewRange(e.gridRange)},r._setCellProperties=function(e,t){this.onUpdateCellsEmitter.fire(this.rangeToUpdateCellData(e.gridRange,t)),this.updateFilterViewRange(e.gridRange)},r._reorderRange=function(e,t){this.onUpdateCellsEmitter.fire(this.rangeToUpdateCellData(e.range,t))},r._copyPaste=function(e){var t=this;e.pasteMappings.forEach((function(n){t.onUpdateCellsEmitter.fire(t.rangeToUpdateCellData(n.destination,e.sheetId))}))},r._mergeOrUnmerge=function(e){var t=this.rangeToUpdateCellData(e,e.sheetId);this.onUpdateCellsEmitter.fire(t),this.onMergeUnmergeEmitter.fire(t)},r._addEmbedded=function(e){this.onAddEmbeddedObjectEmitter.fire(e.data.id)},r._updateEmbedded=function(e){this.onUpdateEmbeddedObjectEmitter.fire(e.data.id)},r._deleteEmbedded=function(e){this.onDeleteEmbeddedObjectEmitter.fire(e.key)},r._setSheetProperties=function(e){if(e.sheetDelta)for(var t=e.sheetDelta.deltas,n=0;n<t.length;n++)switch(t[n].slotName){case f.b.SLOT_FROZEN_COL_COUNT:case f.b.SLOT_FROZEN_ROW_COUNT:this.onUpdateFreezeEmitter.fire(e.sheetId);break;case f.b.SLOT_HIDE_GRID_LINE:this.onUpdateHideGridLinesEmitter.fire(e.sheetId)}},r._defineFilter=function(e){var t=e.sheetId,n=e.gridRange,r=e.filterViewId;r?this.cacheFilterRangeInFilterView[r]=n:this.cacheFilterRangeInSheet[t]=n,this.onUpdateCellsEmitter.fire(this.rangeToUpdateCellData(e.gridRange,e.sheetId))},r._updateFilter=function(e){var t=e.filterViewId,n=e.sheetId;t&&t===this.spreadsheet.activeSheet.filterViewManager.getActiveFilterViewId()?this.updateFilterView(n,t):this.updateFilter(n)},r.updateFilter=function(e){var t,n=this.spreadsheet.sheetManager.getSheetBySheetId(e);if(n){var r=null===(t=n.getBasicFilter())||void 0===t?void 0:t.range,o=this.cacheFilterRangeInSheet[e],s=(null===o||void 0===o?void 0:o.endRowIndex)||0;this.updateCacheFilterRange(e),r&&this.onSetRowVisibleEmitter.fire({ranges:[{startIndex:r.startRowIndex,endIndex:Math.max(r.endRowIndex,s),dimension:c.Z.ROWS}],sheetId:e})}},r.updateFilterView=function(e,t){var n,r=this,o=this.spreadsheet.sheetManager.getSheetBySheetId(e);if(o){var s=this.cacheFilterRangeInFilterView[t];s&&this.onUpdateCellsEmitter.fire({sheetId:e,startRow:s.startRowIndex,endRow:s.endRowIndex,startCol:s.startColIndex,endCol:s.endColIndex}),this.updateCacheFilterRangeInFilterView(e,t);var i=null===(n=o.getBasicFilter())||void 0===n?void 0:n.range;if(i){var a=[i];s&&(a=i.getExcept(s,this.spreadsheet.activeSheet)),a.length&&a.forEach((function(t){r.onUpdateCellsEmitter.fire({sheetId:e,startRow:t.startRowIndex,endRow:t.endRowIndex,startCol:t.startColIndex,endCol:t.endColIndex})})),this.onSetRowVisibleEmitter.fire({ranges:[{startIndex:i.startRowIndex,endIndex:i.endRowIndex,dimension:c.Z.ROWS}],sheetId:e})}}},r._deleteFilter=function(e){var t=e.sheetId,n=e.filterViewId,r=this.cacheFilterRangeInSheet[t];n&&(r=this.cacheFilterRangeInFilterView[n]),r&&(this.onSetRowVisibleEmitter.fire({ranges:[{startIndex:r.startRowIndex,endIndex:r.endRowIndex,dimension:c.Z.ROWS}],sheetId:t}),this.onUpdateCellsEmitter.fire(this.rangeToUpdateCellData(r,t)),n?this.cacheFilterRangeInFilterView[n]=void 0:this.cacheFilterRangeInSheet[t]=void 0)},r._newAddEmbeddedObject=function(e){var t=e.object;t.location.sheetId===this.spreadsheet.getActiveSheetId()&&(t.properties.type===E.NEW_EMBEDDED_OBJECT_TYPE.CHART&&this.onAddChartEmitter.fire(e),t.properties.type===E.NEW_EMBEDDED_OBJECT_TYPE.ADDON&&this.onAddAddonEmitter.fire(e))},r._newUpdateEmbeddedObject=function(e){var t=e.object;t.location.sheetId===this.spreadsheet.getActiveSheetId()&&(t.properties.type===E.NEW_EMBEDDED_OBJECT_TYPE.CHART&&this.onUpdateChartEmitter.fire(e),t.properties.type===E.NEW_EMBEDDED_OBJECT_TYPE.ADDON&&this.onUpdateAddonEmitter.fire(e))},r._newDeleteEmbeddedObject=function(e){e.objectId.startsWith(R._)?this.onDeleteAddonEmitter.fire(e):this.onDeleteChartEmitter.fire(e)},r.rangeToUpdateCellData=function(e,t){var n=this.spreadsheet.sheetManager.getSheetBySheetId(t).highWaterMark.getMark();return{sheetId:t,startRow:e.startRowIndex,endRow:Math.min(e.endRowIndex,n),startCol:e.startColIndex,endCol:e.endColIndex,showCellFormual:this.formulaDisplay}},r.setRangeMutationToUpdateRanges=function(e,t){for(var n,r,o,s=[],i=this.spreadsheet.sheetManager.getSheetBySheetId(t).highWaterMark.getMark(),a=e.cellDataDeltaAtPositions.sort((function(e,t){return e.rowIndex-t.rowIndex})),l=0;l<a.length;l++){var d=e.cellDataDeltaAtPositions[l],u=e.cellDataDeltaAtPositions[l+1],c=d.rowIndex,h=d.colIndex;if(c>i)break;n=null!==n&&void 0!==n?n:c,r=void 0===r?h:Math.min(r,h),o=void 0===o?h:Math.max(o,h),(!u||u.rowIndex>c+1)&&(s.push({sheetId:t,startRow:n,endRow:c,startCol:r,endCol:o,showCellFormual:this.formulaDisplay}),n=void 0,r=void 0,o=void 0)}return s},r.activeFilterView=function(e){var t=this.spreadsheet.activeSheet,n=this.spreadsheet.getActiveSheetId();this.onUpdateCellsEmitter.fire({sheetId:n,startRow:0,endRow:t.getRowCount(),startCol:0,endCol:t.getColCount()}),this.onUpdateFreezeEmitter.fire(e.sheetId);var r=e.originFilterViewId?t.filterViewManager.getFilterViewByViewId(e.originFilterViewId):null,o=t.filterViewManager.getActiveFilterView(),s=r||t,i=o||t,a=[],l=[],d=[],u=[];null===s||void 0===s||s.getHiddenRowsByUser().forEach((function(e){a.push({startIndex:e,endIndex:e,dimension:c.Z.ROWS})})),null===s||void 0===s||s.getHiddenColumnsByUser().forEach((function(e){l.push({startIndex:e,endIndex:e,dimension:c.Z.COLUMNS})})),i.getHiddenRowsByUser().forEach((function(e){d.push({startIndex:e,endIndex:e,dimension:c.Z.ROWS})})),i.getHiddenColumnsByUser().forEach((function(e){u.push({startIndex:e,endIndex:e,dimension:c.Z.COLUMNS})})),a.length&&this.onSetRowVisibleEmitter.fire({ranges:a,sheetId:n}),l.length&&this.onSetColVisibleEmitter.fire({ranges:l,sheetId:n});var h={ranges:d,hidden:!0,sheetId:n};d.length&&this.onSetRowVisibleEmitter.fire(h);var f={ranges:u,hidden:!0,sheetId:n};u.length&&this.onSetColVisibleEmitter.fire(f)},t}(g.JT);y=w([C(0,a.V),A("design:paramtypes",["function"===typeof(r="undefined"!==typeof a.V&&a.V)?r:Object])],y),t.Z=y},"../spread-sheet/src/core/view/layout/common/ocr-util.ts":function(e,t,n){"use strict";n.d(t,{VQ:function(){return o}}),n("../node_modules/regenerator-runtime/runtime.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.promise.js"),n("../node_modules/core-js/modules/es.array.iterator.js"),n("../node_modules/core-js/modules/es.string.iterator.js"),n("../node_modules/core-js/modules/web.dom-collections.iterator.js");var r=n("../packages/common-utils/src/index.ts"),o="1"===(0,r.IZ)("m_preview")},"../spread-sheet/src/core/view/layout/interface/pc-view.ts":function(e,t,n){"use strict";n.d(t,{w:function(){return r}});var r=(0,n("../node_modules/@tencent/containerized/build/main/index.js").yh)("IView")},"../spread-sheet/src/core/view/layout/view.ts":function(e,t,n){"use strict";var r=n("../node_modules/@babel/runtime/helpers/esm/construct.js"),o=n("../node_modules/@babel/runtime/helpers/esm/toConsumableArray.js"),s=n("../node_modules/@babel/runtime/helpers/esm/inheritsLoose.js"),i=(n("../node_modules/regenerator-runtime/runtime.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.promise.js"),n("../node_modules/core-js/modules/es.number.constructor.js"),n("../node_modules/core-js/modules/es.array.iterator.js"),n("../node_modules/core-js/modules/es.string.iterator.js"),n("../node_modules/core-js/modules/web.dom-collections.iterator.js"),n("../packages/report/src/index.ts")),a=n("../spread-sheet/src/base/event/event.ts"),l=n("../packages/model/src/grid/Selection.ts"),d=n("../packages/model/src/grid/Cell.ts"),u=n("../packages/model/src/range/GridRange.ts"),c=n("../node_modules/@tencent/docs-user-agent/dist/index.js"),h=n.n(c),f=n("../spread-sheet/src/core/view/level-2/dimension-edit/hide-show-head/utils.ts"),p=n("../spread-sheet/src/core/view/layout/common/ocr-util.ts"),g=n("../node_modules/@tencent/containerized/build/main/index.js"),m=n("../spread-sheet/src/core/view/level-1/select-center/base/utils.ts"),v=n("../spread-sheet/src/core/view/level-1/select-center/base/selection/AllSelection.ts"),I=n("../packages/model/src/grid/index.ts"),E=n("../packages/lib/index.ts"),S=n("../spread-sheet/src/core/view/level-1/scroll-api/ScrollApi.interface.ts"),R=n("../spread-sheet/src/core/view/spreadsheet-view/area-data/AreaData.interface.ts"),w=function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function i(e){try{l(r.next(e))}catch(t){s(t)}}function a(e){try{l(r.throw(e))}catch(t){s(t)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,a)}l((r=r.apply(e,t||[])).next())}))},A=function(e){function t(t,n,r){var o;return(o=e.call(this)||this).app=t,o.spreadsheet=n,o.pluginImporter=r,o.onSelectionChangeEmitter=new E.Q5,o.selectionCache={},o.onSelectionChange=o.onSelectionChangeEmitter.event,o.renderedSheets=[],o.renderedSheets.push(null===n||void 0===n?void 0:n.activeSheetId),o.initViewEvent(),o}(0,s.Z)(t,e);var c=t.prototype;return c.resetAndRefreshExcelView=function(e){this.selectionCache={}},c.initI18n=function(){},c.reportLocation=function(){var e;if(this.canvas){var t=this.canvas.normalSelectData.activeCol,n=this.canvas.normalSelectData.activeRow;if(!(t<0||n<0)){var r={coords:[n,t,n,t],isEditing:!!(null===(e=this.canvas.inputManager)||void 0===e?void 0:e.isInputtingState())};a.ZP.network.trigger("userCaretChange",r)}}},c.initViewEvent=function(){var e,t=this;null===(e=this.app.emitter)||void 0===e||e.on(this.app.EVENT.NEW_DOC_SPREAD_SHEET_PART_INTERACTIVE,(function(e){t.refreshExcelView(e)}))},c.getSelection=function(e){var t,n,r,o,s=this.spreadsheet.activeSheetId,i=this.spreadsheet.activeSheet.getColCount()-1,a=this.spreadsheet.activeSheet.getRowCount()-1;if(e){var c=new d.Z(s,0,0),h=new u.Z(s,0,a,0,i);return new l.Z(c,[h],I.SelectionType.NORMAL,[v.Z.newInstance()])}if(!(null===(t=this.canvas)||void 0===t?void 0:t.normalSelectData))throw new Error("调用getSelection太早，模块未加载");var f=this.canvas.normalSelectData,p=f.selectQueue,g=f.activeRow,E=f.activeCol,S=new d.Z(s,g,E),R=(0,m.UN)(s,this.canvas.rowcolAccessor,p),w=I.SelectionType.NORMAL;return(null===(n=this.canvas.chartCenter)||void 0===n?void 0:n.chartStage.activeChartBoxId)&&(w=I.SelectionType.CHART),(null===(o=null===(r=this.canvas.shapeEditCenter)||void 0===r?void 0:r.shapeEdit)||void 0===o?void 0:o.focusing)&&(w=I.SelectionType.SHAPE),new l.Z(S,R,w,p)},c.getSelectionWithGridRanges=function(e){var t,n,r,o,s=this.spreadsheet.activeSheetId;if(e){var i=new d.Z(s,0,0),a=new u.Z(s);return new l.Z(i,[a],I.SelectionType.NORMAL,[v.Z.newInstance()])}if(!(null===(t=this.canvas)||void 0===t?void 0:t.normalSelectData))throw new Error("调用getSelection太早，模块未加载");var c=this.canvas.normalSelectData,h=c.selectQueue,f=c.activeRow,p=c.activeCol,g=new d.Z(s,f,p),E=(0,m.fq)(s,this.canvas.rowcolAccessor,this.canvas.normalSelectData),S=I.SelectionType.NORMAL;return(null===(n=this.canvas.chartCenter)||void 0===n?void 0:n.chartStage.activeChartBoxId)&&(S=I.SelectionType.CHART),(null===(o=null===(r=this.canvas.shapeEditCenter)||void 0===r?void 0:r.shapeEdit)||void 0===o?void 0:o.focusing)&&(S=I.SelectionType.SHAPE),new l.Z(g,E,S,h)},c.saveSelectionCache=function(e,t){this.selectionCache[e]=t||this.getSheetLocation()},c.deleteSelectionCache=function(e){this.selectionCache[e]=void 0},c.getSelectionCache=function(e){return this.selectionCache[e]},c.setSelection=function(e){var t=this.getSelectionCache(e);void 0!==t?this.setCurrentSelection(t):this.setFirstCellFocus()},c.setCurrentSelection=function(e){this.canvas.selectApi.selectCells(this.canvas.normalSelectData,{xRange:e.xRange&&(0,o.Z)(e.xRange),yRange:e.yRange&&(0,o.Z)(e.yRange)},null)},c.getSheetLocation=function(){var e,t=this.canvas,n={xRange:[],yRange:[],row:{frozen:0,flow:0},col:{frozen:0,flow:0}};if(null===(e=null===t||void 0===t?void 0:t.normalSelectData)||void 0===e?void 0:e.selectQueue[0]){var r=(0,m.TS)(t.rowcolAccessor,[t.normalSelectData.selectQueue[0]]),o=(0,m.rz)(t.rowcolAccessor,[t.normalSelectData.selectQueue[0]]);n={xRange:[C(o[0][0]),C(o[0][1])],yRange:[C(r[0][0]),C(r[0][1])]}}return n.row={frozen:t.areaData.row.frozen.offsetSize,flow:t.areaData.row.flow.offsetSize},n.col={frozen:t.areaData.col.frozen.offsetSize,flow:t.areaData.col.flow.offsetSize},n},c.getCurrentPosition=function(){return this.canvas?{rowIndex:this.canvas.areaData.row.flow.renderFrom,colIndex:this.canvas.areaData.col.flow.renderFrom}:{rowIndex:0,colIndex:0}},c.setFirstCellFocus=function(){var e=(0,f.mt)(this.spreadsheet.activeSheet,-1,1),t=(0,f.kI)(this.spreadsheet.activeSheet,-1,1);this.canvas.selectApi.selectCells(this.canvas.normalSelectData,{xRange:[e,e],yRange:[t,t]},null)},c.setTopScroll=function(){this.canvas.scrollApi.scrollByPixel({areaX:"flow",diffX:0,areaY:"flow",diffY:0})},c.setSheetScroll=function(e){var t,r,o=this.getSelectionCache(e);if(null===(t=n.g.log)||void 0===t||t.info("[locate] setSheetScroll",{sheetId:e,curSelection:o}),void 0!==o){var s=o.col.flow,i=o.row.flow,a=this.canvas.spreadsheetView.clientRect,l=a.width,d=a.height,u=this.app.spreadsheet.sheetManager.getSheetBySheetId(e);if(Number(null===(r=null===u||void 0===u?void 0:u.highWaterMark)||void 0===r?void 0:r.getMark())<o.yRange[0])return!1;if(o.needCheckScrollBySize&&s<l&&i<d)return!1;this.canvas.scrollApi.scrollByPixel({areaX:"flow",diffX:s,areaY:"flow",diffY:i},!1,{type:S.ru.EASE_OUT})}else h().isMobilePhone||h().isAndroidPad||this.setTopScroll();return!0},c.render=function(e,t){if(void 0===t&&(t=R.oz.SLIENT),!this.canvas)throw new Error("视图尚未初始化");this.refreshExcelView(e,t)},c.startLazy=function(){return Promise.all([this.initPlugins()])},c.refreshExcelView=function(e,t){var r;void 0===t&&(t=R.oz.SLIENT),i.ZP.jank.log({moduleValue:"SHEETS_BAR_JANK",actionValue:"SWITCH_SHEET"}),null===(r=n.g.log)||void 0===r||r.info("sheets_bar::switch_sheet_full_refresh_canvas"),this.refreshExcelViewData(e),this.onRefreshExcelView(e,t),this.canvas.renderApi.renderNextTick()},c.refreshExcelViewData=function(e,t){if(e!==this.getActiveSheet().getSheetId())throw new Error("更新 sheet 异常");-1===this.renderedSheets.indexOf(e)||t?(this.renderedSheets.push(e),this.canvas.init(e)):this.canvas.refresh(e)},c.refreshExcelViewSync=function(e){var t;null===(t=n.g.log)||void 0===t||t.info("flow refreshExcelViewSync"),this.refreshExcelViewData(e),this.onRefreshExcelView(e),this.canvas.renderApi.renderTable()},c.onRefreshExcelView=function(e,t){void 0===t&&(t=R.oz.SLIENT)},c.getPluginInstance=function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),o=1;o<t;o++)n[o-1]=arguments[o];return w(this,void 0,void 0,regeneratorRuntime.mark((function t(){var o;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.plugins[e]){t.next=2;break}return t.abrupt("return",this.plugins[e]);case 2:return t.next=4,this.pluginImporter[e]();case 4:if(o=t.sent,!this.plugins[e]){t.next=7;break}return t.abrupt("return",this.plugins[e]);case 7:return t.abrupt("return",this.plugins[e]=(0,r.Z)(o.default,n));case 8:case"end":return t.stop()}}),t,this)})))},c._afterCanvasLoaded=function(){window.performanceData&&(window.performanceData.initAfterCanvasLoaded=+new Date)},c.initPlugins=function(){return Promise.resolve()},c.hideLoadingAndWebviewBarIfPreview=function(){var e,t;if(p.VQ){var r=document.createElement("style");r.setAttribute("type","text/css"),r.innerText=".snack-loading-container { display: none !important }",document.head.appendChild(r),h().isTencentDocsApp&&(null===(t=null===(e=n.g.mqq)||void 0===e?void 0:e.ui)||void 0===t||t.setWebViewBehavior({titleBarHide:!0}))}},c.getActiveSheet=function(){return this.spreadsheet.activeSheet},c._setSelectionInSheet=function(e,t){var n,r,o=(null===(n=e.xRange)||void 0===n?void 0:n[0])||0,s=(null===(r=e.yRange)||void 0===r?void 0:r[0])||0;return(o>=t.getColCount()||t.data.isColHidden(o))&&(o=(0,f.mt)(t,0,1)),(s>=t.getRowCount()||t.data.isRowHidden(s))&&(s=(0,f.kI)(t,0,1)),e.xRange=[o,o],e.yRange=[s,s],{x:o,y:s}},t}(g.JT);function C(e){return e<0?0:e}t.ZP=A},"../spread-sheet/src/core/view/lib/matrix/Matrix.ts":function(e,t,n){"use strict";var r=n("../node_modules/@babel/runtime/helpers/esm/createClass.js"),o=function(){function e(e){this._a=1,this._b=0,this._c=0,this._d=1,this._e=0,this._f=0,e&&(this._a=e.a,this._b=e.b,this._c=e.c,this._d=e.d,this._e=e.e,this._f=e.f)}var t=e.prototype;return t.transform=function(e,t,n,r,o,s){var i=this._a,a=this._b,l=this._c,d=this._d,u=this._e,c=this._f;return this._a=i*e+l*t,this._b=a*e+d*t,this._c=i*n+l*r,this._d=a*n+d*r,this._e=i*o+l*s+u,this._f=a*o+d*s+c,this},t.scale=function(e,t){return this.transform(e,0,0,t,0,0),this},t.translate=function(e,t){return this.transform(1,0,0,1,e,t),this},t.rotate=function(e){var t=Math.cos(e),n=Math.sin(e);return this.transform(t,n,-n,t,0,0),this},t.applyToPoint=function(e,t){return{x:e*this._a+t*this._c+this._e,y:e*this._b+t*this._d+this._f}},t.reset=function(){return this._a=this._d=1,this._b=this._c=this._e=this._f=0,this},(0,r.Z)(e,[{key:"a",get:function(){return this._a}},{key:"b",get:function(){return this._b}},{key:"c",get:function(){return this._c}},{key:"d",get:function(){return this._d}},{key:"e",get:function(){return this._e}},{key:"f",get:function(){return this._f}}]),e}();t.Z=o},"../spread-sheet/src/core/view/lib/mutex-management/MutexManagement.interface.ts":function(e,t,n){"use strict";var r=(0,n("../node_modules/@tencent/containerized/build/main/index.js").yh)("IMutexManagement");t.Z=r},"../spread-sheet/src/core/view/lib/mutex-management/MutexManagement.ts":function(e,t,n){"use strict";n.d(t,{d:function(){return o}}),n("../node_modules/core-js/modules/es.array.find-index.js"),n("../node_modules/core-js/modules/es.array.splice.js"),n("../node_modules/core-js/modules/web.dom-collections.for-each.js");var r,o,s=n("../node_modules/@tencent/docs-user-agent/dist/index.js"),i=n.n(s);!function(e){e.SELECTION="selection",e.FORMULA_SELECTION="formulaSelection",e.SHAPE="shape",e.CHART="chart",e.CARD_CENTER="cardCenter",e.CONTEXT_MENU="contextMenu",e.INPUT="input",e.VALIDATION_LIST="validationList",e.ERROR_TIP_PANEL="errorTipPanel",e.CELL_EDITOR_DROPDOWN="cellEditorDropdown",e.CUSTOM_CELL_EDITOR="customCellEditor",e.VALIDATION_LIST_HEADER="validationListHeader",e.ADDON="addon"}(o||(o={}));var a=o,l=((r={})[a.CHART]=[a.SELECTION,a.SHAPE,a.CUSTOM_CELL_EDITOR,a.ADDON],r[a.SELECTION]=[a.SHAPE,a.CHART,a.ADDON],r[a.FORMULA_SELECTION]=[a.SHAPE,a.CHART,a.ADDON],r[a.INPUT]=[a.CARD_CENTER],r[a.CELL_EDITOR_DROPDOWN]=[a.CARD_CENTER,a.CONTEXT_MENU,a.VALIDATION_LIST],r[a.CONTEXT_MENU]=i().isPC?[a.CARD_CENTER,a.CELL_EDITOR_DROPDOWN,a.VALIDATION_LIST]:[a.CARD_CENTER],r[a.VALIDATION_LIST]=[a.CARD_CENTER],r[a.SHAPE]=i().isPC?[a.SELECTION,a.CHART,a.INPUT,a.CUSTOM_CELL_EDITOR,a.ADDON]:[a.SELECTION,a.CHART,a.CUSTOM_CELL_EDITOR,a.ADDON],r[a.ERROR_TIP_PANEL]=[a.CARD_CENTER,a.CONTEXT_MENU,a.VALIDATION_LIST],r[a.CUSTOM_CELL_EDITOR]=[a.VALIDATION_LIST_HEADER],r[a.ADDON]=[a.SELECTION,a.SHAPE,a.CUSTOM_CELL_EDITOR,a.CHART],r),d=function(){function e(){this._mutexRelations=l,this._mutexComponents={}}var t=e.prototype;return t.addMutexComponent=function(e,t){void 0===this._mutexComponents[e]&&(this._mutexComponents[e]=[]),this._mutexComponents[e].push(t)},t.removeMutexComponent=function(e,t){var n=this._mutexComponents[e];if(n){var r=n.findIndex((function(e){return e===t}));r<0||n.splice(r,1)}},t.mutexShow=function(e){var t,n=this;null===(t=this._mutexRelations[e])||void 0===t||t.forEach((function(e){var t;null===(t=n._mutexComponents[e])||void 0===t||t.forEach((function(e){e.mutexHide()}))}))},e}();t.Z=d},"../spread-sheet/src/core/view/lib/pointer-support.ts":function(e,t,n){"use strict";var r;function o(e,t){return{isMouse:!!n.g.MouseEvent&&e instanceof MouseEvent&&(t===r.MOUSE||!t),isTouch:!!n.g.TouchEvent&&e instanceof TouchEvent&&(t===r.TOUCH||!t)}}function s(e,t,n,r,o){var s=document.createEvent("HTMLEvents");s.initEvent(n,!1,!0),s.x=r,s.y=o,s.originEvent=e,null===t||void 0===t||t.dispatchEvent(s)}function i(e){var t=this,n=o(e,this.handlingType),i=n.isMouse,a=n.isTouch;switch(this.downTime=Date.now(),!0){case i:this.handlingType=r.MOUSE,this.clientX=e.clientX,this.clientY=e.clientY,s(e,t,"pointerDown",this.clientX,this.clientY),this.longPointerTick=setTimeout(s.bind(this,e,t,"longPointer"),500);break;case a:this.handlingType=r.TOUCH;var l=e.touches[0];this.clientX=l.clientX,this.clientY=l.clientY,s(e,t,"pointerDown",this.clientX,this.clientY),this.longPointerTick=setTimeout(s.bind(this,e,t,"longPointer"),500)}}function a(e){var t,r,o;if(n.g.TouchEvent&&e instanceof n.g.TouchEvent){var s=e.touches[0];o=5,t=s.clientX,r=s.clientY}else o=2,t=e.clientX,r=e.clientY;return Math.abs(r-this.clientY)<o&&Math.abs(t-this.clientX)<o}function l(e){var t=o(e,this.handlingType),r=t.isMouse,s=t.isTouch;switch(!0){case r:case s:this.preventDefault&&e.preventDefault(),this.longPointerTick&&!a.call(this,e)&&n.g.clearTimeout(this.longPointerTick)}}function d(e){var t=o(e,this.handlingType),r=t.isMouse,i=t.isTouch,a=-31,l=-31;switch(!0){case r:if(0!==e.button)return;a=e.clientX,l=e.clientY;break;case i:var d=e.changedTouches[0];a=d.clientX,l=d.clientY}this.handlingType=void 0,n.g.clearTimeout(this.longPointerTick),this.longPointerTick=null,Math.abs(a-this.clientX)>30||Math.abs(l-this.clientY)>30||void 0===this.downTime||Date.now()>this.downTime+250&&i||(this.downTime=void 0,s(e,this,"pointer",a,l))}function u(e,t){void 0===t&&(t=!0),e.preventDefault=t,e.addEventListener("mousedown",i),e.addEventListener("touchstart",i),e.addEventListener("mousemove",l),e.addEventListener("touchmove",l),e.addEventListener("mouseup",d),e.addEventListener("touchend",d)}n.d(t,{D2:function(){return u}}),function(e){e.TOUCH="TOUCH",e.MOUSE="MOUSE"}(r||(r={}))},"../spread-sheet/src/core/view/lib/tap-support.ts":function(e,t,n){"use strict";function r(e){e.addEventListener("touchstart",(function(t){var n=t.touches[0];this.touchX=n.clientX,this.touchY=n.clientY,this.touchT=Date.now(),this.longTapTick=window.setTimeout((function(){if(e.onLongTap)e.onLongTap();else{var t=document.createEvent("HTMLEvents");t.initEvent("longTap",!1,!0),e.dispatchEvent(t)}}),500)})),e.addEventListener("touchmove",(function(e){e.preventDefault();var t=e.touches[0],n=t.clientX,r=t.clientY;(Math.abs(r-this.touchY)>5||Math.abs(n-this.touchX)>5)&&window.clearTimeout(this.longTapTick)})),e.addEventListener("touchend",(function(t){var n=t.changedTouches[0],r=n.clientX,o=n.clientY;if(window.clearTimeout(this.longTapTick),!(void 0===this.touchT||Math.abs(o-this.touchY)>30||Math.abs(r-this.touchX)>30)&&!(t.touches.length>0)&&Date.now()<=this.touchT+250)if(e.ontap)e.ontap();else{var s=document.createEvent("HTMLEvents");s.initEvent("tap",!1,!0),s.x=r,s.y=o,s.originEvent=t,e.dispatchEvent(s)}}))}n.d(t,{C:function(){return r}})},"../spread-sheet/src/core/view/utils/lambda.ts":function(e,t,n){"use strict";function r(e,t,n){var r=e.getCellViewAtPosition(n,t);if(null===r)throw new Error("getCellViewAtPosition error!");return!r.mergeParent}function o(e,t,n){var r=e.getCellViewAtPosition(n,t);if(null===r)throw new Error("getCellViewAtPosition error!");if(r.mergeParent){var o=e.getCellViewAtPosition(n+r.mergeParent.y,t+r.mergeParent.x);if(o&&o.mergeData.colCount>1)return!1}return!(r.mergeData&&r.mergeData.colCount>1)}function s(e,t,n){var r=e.getCellViewAtPosition(n,t);if(null===r)throw new Error("getCellViewAtPosition error!");if(r.mergeParent){var o=e.getCellViewAtPosition(n+r.mergeParent.y,t+r.mergeParent.x);if(o&&o.mergeData.rowCount>1)return!1}return!(r.mergeData&&r.mergeData.rowCount>1)}function i(e,t,n){return!e.isColHidden(t)&&!e.isRowHidden(n)}function a(e,t,n){return!e.isRowHidden(n)}function l(e,t){return!e.isColHidden(t)}function d(e,t,n){var r=e.getCellViewAtPosition(n,t);return null!==r&&!!r.content}function u(e,t,n){var r=e.getCellViewAtPosition(n,t);return null!==r&&!r.content}n.d(t,{AS:function(){return u},D0:function(){return s},PA:function(){return d},Sl:function(){return l},So:function(){return a},dK:function(){return o},eN:function(){return r},hZ:function(){return i}})},"../spread-sheet/src/core/view/utils/ua.ts":function(e,t,n){"use strict";n.d(t,{V5:function(){return o},tH:function(){return r}}),n("../node_modules/core-js/modules/es.regexp.exec.js"),n("../node_modules/core-js/modules/es.string.match.js");var r=navigator.userAgent.indexOf("Firefox")>-1,o=(-1!==navigator.userAgent.indexOf("Mac")&&-1!==navigator.userAgent.indexOf("Safari")&&navigator.userAgent.indexOf("Chrome"),navigator.userAgent.match(/Mac\sOS\sX/i));-1!==navigator.userAgent.indexOf("msie")||-1!==navigator.userAgent.indexOf("rv:11")||window.ActiveXObject||window},"../spread-sheet/src/core/view/utils/view-utils.ts":function(e,t,n){"use strict";function r(e){return 2*e.headSize.rowHeadWidth}function o(e){return 2*e.headSize.colHeadHeight}n.d(t,{n_:function(){return o},pJ:function(){return r}}),n("../packages/common-utils/src/index.ts")},"../spread-sheet/src/core/workbench/common/openEditorService.ts":function(e,t,n){"use strict";n("../node_modules/regenerator-runtime/runtime.js"),n("../node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),n("../node_modules/core-js/modules/esnext.reflect.metadata.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.promise.js");var r,o,s,i,a=n("../node_modules/@tencent/workbench/lib/esm/decorators/class/service.js"),l=n("../node_modules/@tencent/ioc/lib/esm/index.js"),d=n("../node_modules/@tencent/workbench/lib/esm/services/workbench/workbench.interface.js"),u=n("../node_modules/@tencent/workbench/lib/esm/services/surface/surface-service.js"),c=n("../node_modules/@tencent/workbench/lib/esm/services/settings/setting-service.js"),h=n("../spread-sheet/src/adapter/SpreadSheetAppAdapter.ts"),f=n("../spread-sheet/src/core/app/SpreadsheetApp.interface.ts"),p=function(e,t,n,r){var o,s=arguments.length,i=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)i=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(i=(s<3?o(i):s>3?o(t,n,i):o(t,n))||i);return s>3&&i&&Object.defineProperty(t,n,i),i},g=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},m=function(e,t){return function(n,r){t(n,r,e)}},v=function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function i(e){try{l(r.next(e))}catch(t){s(t)}}function a(e){try{l(r.throw(e))}catch(t){s(t)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,a)}l((r=r.apply(e,t||[])).next())}))},I=function(){function e(e,t,n,r){this.workbench=e,this.surfaceService=t,this.workbenchSettingService=n,this.app=r}var t=e.prototype;return t.open=function(){return v(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.workbenchSettingService.set("contextMenu.hasOverlay",!1),this.app.spreadsheet.isExternalSheet()){e.next=6;break}return e.next=4,this.renderSheet();case 4:e.next=8;break;case 6:return e.next=8,this.app.sheetAdapterManager.getCurrentAdapter().renderWithWorkbench();case 8:case"end":return e.stop()}}),e,this)})))},t.switchToSheet=function(){return v(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.workbenchSettingService.set("contextMenu.hasOverlay",!1),!this.surfaceId){e.next=6;break}return e.next=4,this.surfaceService.setCurrent(this.surfaceId);case 4:e.next=8;break;case 6:return e.next=8,this.renderSheet();case 8:case"end":return e.stop()}}),e,this)})))},t.renderSheet=function(){return v(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.workbench.open(h.S,{mode:"stack",attachBeforeRender:!0});case 2:t=e.sent,n=t.id,this.surfaceId=n;case 5:case"end":return e.stop()}}),e,this)})))},e}();I=p([(0,a.t)(),m(0,(0,l.tB)(d.K)),m(3,f.m),g("design:paramtypes",["function"===typeof(r="undefined"!==typeof d.K&&d.K)?r:Object,"function"===typeof(o="undefined"!==typeof u.W&&u.W)?o:Object,"function"===typeof(s="undefined"!==typeof c.I&&c.I)?s:Object,"function"===typeof(i="undefined"!==typeof f.m&&f.m)?i:Object])],I),t.Z=I},"../spread-sheet/src/entry/requestidlecallback-polyfill.ts":function(){window.requestIdleCallback||(window.requestIdleCallback=function(e,t){var n=(null===t||void 0===t?void 0:t.timeout)||1,r=performance.now();return window.setTimeout((function(){e({get didTimeout(){return!(null===t||void 0===t?void 0:t.timeout)&&performance.now()-r-1>n},timeRemaining:function(){return Math.max(0,performance.now()-r+1)}})}),1)})},"../spread-sheet/src/external/collaboration/caret-manager.interface.ts":function(e,t,n){"use strict";n.d(t,{C:function(){return r}});var r="#1e6fff"},"../spread-sheet/src/external/collaboration/caret-manager.ts":function(e,t,n){"use strict";n("../node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),n("../node_modules/core-js/modules/esnext.reflect.metadata.js"),n("../node_modules/core-js/modules/es.array.iterator.js"),n("../node_modules/core-js/modules/es.map.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.string.iterator.js"),n("../node_modules/core-js/modules/esnext.map.delete-all.js"),n("../node_modules/core-js/modules/esnext.map.every.js"),n("../node_modules/core-js/modules/esnext.map.filter.js"),n("../node_modules/core-js/modules/esnext.map.find.js"),n("../node_modules/core-js/modules/esnext.map.find-key.js"),n("../node_modules/core-js/modules/esnext.map.includes.js"),n("../node_modules/core-js/modules/esnext.map.key-of.js"),n("../node_modules/core-js/modules/esnext.map.map-keys.js"),n("../node_modules/core-js/modules/esnext.map.map-values.js"),n("../node_modules/core-js/modules/esnext.map.merge.js"),n("../node_modules/core-js/modules/esnext.map.reduce.js"),n("../node_modules/core-js/modules/esnext.map.some.js"),n("../node_modules/core-js/modules/esnext.map.update.js"),n("../node_modules/core-js/modules/web.dom-collections.iterator.js"),n("../node_modules/core-js/modules/web.dom-collections.for-each.js"),n("../node_modules/core-js/modules/es.function.name.js");var r,o,s,i,a,l,d,u=n("../spread-sheet/src/core/data/configService/spreadConfig.ts"),c=n("../spread-sheet/src/core/view/layout/interface/pc-view.ts"),h=n("../spread-sheet/src/core/app/sheetStatus/index.ts"),f=n("../packages/model/src/spreadsheet/Spreadsheet.interface.ts"),p=n("../spread-sheet/src/external/collaboration/caret-manager.interface.ts"),g=n("../spread-sheet/src/external/collaboration/collaboration-manager.interface.ts"),m=n("../packages/common-utils/src/time/timer.ts"),v=function(e,t,n,r){var o,s=arguments.length,i=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)i=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(i=(s<3?o(i):s>3?o(t,n,i):o(t,n))||i);return s>3&&i&&Object.defineProperty(t,n,i),i},I=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},E=function(e,t){return function(n,r){t(n,r,e)}};!function(e){e.GUIDE="g.",e.PASS="p."}(l||(l={})),function(e){e.CHANGE_COLLABORATOR="changeCollaborator",e.ADD_COLLABORATOR="addCollaborator"}(d||(d={}));var S=new Map,R=function(){function e(e,t,n,r,o){var s=this;this.collaborationManager=e,this.spreadsheet=t,this.sheetStatus=n,this.view=r,this.refreshCarets=function(){var e=s.spreadsheet.getActiveSheetId();S.forEach((function(t){t&&e===t.tabId&&s.applyCaret(!1,t.userId,t.name||"",t.corpName||"",t.bgColor||p.C,t.isEditing,t.coords,t.shapeId,t.role)}))},this.userCollection=o}var t=e.prototype;return t.isValidUser=function(e){var t=u.q.getConfig("userId");return 0===(null===e||void 0===e?void 0:e.indexOf(l.PASS))&&e!==t&&this.userCollection.has(e)},t.isGuest=function(e){return 0===e.indexOf(l.GUIDE)},t.updateCaret=function(e){var t,n,r,o,s=this,i=e.changedBy,a=this.userCollection.get(i);if(this.isValidUser(i)){var l=this.spreadsheet.getActiveSheetId(),d=null===(t=e.sheet)||void 0===t?void 0:t.tabId,u=S.has(i),c=(null===a||void 0===a?void 0:a.name)||"",h=(null===a||void 0===a?void 0:a.corpName)||"",f=(null===a||void 0===a?void 0:a.bgColor)||p.C,g=!!(null===(n=e.sheet)||void 0===n?void 0:n.isEditing),v=null===(r=e.sheet)||void 0===r?void 0:r.coords,I=null===(o=e.sheet)||void 0===o?void 0:o.shapeId,E=null===e||void 0===e?void 0:e.sourceRole;l!==d?u?this.removeCaret(i,!0):m.Z.wait(0).run((function(){s.notifyUserPosition({userId:i})})):this.applyCaret(u,i,c,h,f,g,v,I,E),S.set(i,{userId:i,name:c,bgColor:f,avatar:null===a||void 0===a?void 0:a.avatar,coords:v,shapeId:I,tabId:d,isEditing:g,role:E})}},t.removeCaret=function(e,t){if(this.isValidUser(e)){t||S.delete(e);var n=this.view.canvas.collabCursor;n&&n.removeCollaborator(e)}},t.clearCaret=function(){var e=this.view.canvas.collabCursor;S.forEach((function(t){e&&t&&e.removeCollaborator(t.userId)})),S.clear()},t.reportPosition=function(){this.view.reportLocation()},t.applyCaret=function(e,t,n,r,o,s,i,a,l){var u,c,h=e?d.CHANGE_COLLABORATOR:d.ADD_COLLABORATOR,f={id:t,name:n,corpName:r,color:o,input:s};i?(f.y=i[0],f.x=i[1]):f.shapeId=a,l&&(f.role=l),null===(c=null===(u=this.view.canvas.collabCursor)||void 0===u?void 0:u[h])||void 0===c||c.call(u,f)},t.notifyUserPosition=function(e,t){if(!this.isGuest(u.q.getConfig("userId")))try{var n=this.getSheetInfo(e,t);this.sheetStatus.canEdit&&n&&this.collaborationManager.reportUserCaretAfterSelectedChange(n)}catch(r){console.error(r)}},t.getSheetInfo=function(e,t){var n,r,o,s=null===(r=null===(n=this.view.canvas)||void 0===n?void 0:n.shapeEdit)||void 0===r?void 0:r.shapeId,i=!1;if(!s){var a=this.view.canvas.normalSelectData,l=a.activeCol,d=a.activeRow;-1!==l&&-1!==d&&(o=[d,l,d,l]),i=this.view.canvas.inputManager.isInputtingState()}if(s||o&&!(o.length<=0)){var u={coords:o,shapeId:s,isEditing:i,targetUserId:(e||{}).userId};return t&&(u.isNew=!0),u}},t.isMyMessage=function(e){return e===u.q.getConfig("userId")},e}();R=v([E(0,g.pI),E(1,f.V),E(2,h.T),E(3,c.w),I("design:paramtypes",["function"===typeof(r="undefined"!==typeof g.pI&&g.pI)?r:Object,"function"===typeof(o="undefined"!==typeof f.V&&f.V)?o:Object,"function"===typeof(s="undefined"!==typeof h.T&&h.T)?s:Object,"function"===typeof(i="undefined"!==typeof c.w&&c.w)?i:Object,"function"===typeof(a="undefined"!==typeof Map&&Map)?a:Object])],R),t.Z=R},"../spread-sheet/src/external/collaboration/collaboration-manager.interface.ts":function(e,t,n){"use strict";n.d(t,{Du:function(){return o},pI:function(){return s},yv:function(){return r}});var r,o,s=(0,n("../node_modules/@tencent/containerized/build/main/index.js").yh)("ICollaborationManager");!function(e){e.CURSOR="cursor",e.USERINFO="userinfo",e.NEW="new"}(r||(r={})),function(e){e.CONNECTED="connected",e.NEW="new",e.LEAVE="leave"}(o||(o={}))},"../spread-sheet/src/external/collaboration/collaboration-manager.ts":function(e,t,n){"use strict";n.r(t);var r,o,s,i,a=n("../node_modules/@babel/runtime/helpers/esm/assertThisInitialized.js"),l=n("../node_modules/@babel/runtime/helpers/esm/inheritsLoose.js"),d=(n("../node_modules/regenerator-runtime/runtime.js"),n("../node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),n("../node_modules/core-js/modules/esnext.reflect.metadata.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.promise.js"),n("../node_modules/core-js/modules/es.symbol.js"),n("../node_modules/core-js/modules/web.dom-collections.for-each.js"),n("../node_modules/core-js/modules/es.array.iterator.js"),n("../node_modules/core-js/modules/es.map.js"),n("../node_modules/core-js/modules/es.string.iterator.js"),n("../node_modules/core-js/modules/esnext.map.delete-all.js"),n("../node_modules/core-js/modules/esnext.map.every.js"),n("../node_modules/core-js/modules/esnext.map.filter.js"),n("../node_modules/core-js/modules/esnext.map.find.js"),n("../node_modules/core-js/modules/esnext.map.find-key.js"),n("../node_modules/core-js/modules/esnext.map.includes.js"),n("../node_modules/core-js/modules/esnext.map.key-of.js"),n("../node_modules/core-js/modules/esnext.map.map-keys.js"),n("../node_modules/core-js/modules/esnext.map.map-values.js"),n("../node_modules/core-js/modules/esnext.map.merge.js"),n("../node_modules/core-js/modules/esnext.map.reduce.js"),n("../node_modules/core-js/modules/esnext.map.some.js"),n("../node_modules/core-js/modules/esnext.map.update.js"),n("../node_modules/core-js/modules/web.dom-collections.iterator.js"),n("../node_modules/core-js/modules/es.array.filter.js"),n("../node_modules/core-js/modules/es.array.from.js"),n("../node_modules/core-js/modules/es.object.assign.js"),n("../node_modules/core-js/modules/es.function.name.js"),n("../node_modules/core-js/modules/es.array.map.js"),n("../node_modules/core-js/modules/es.array.find-index.js"),n("../node_modules/core-js/modules/es.array.splice.js"),n("../node_modules/lodash/sample.js")),u=n.n(d),c=n("../spread-sheet/src/external/collaboration/caret-manager.ts"),h=n("../spread-sheet/src/core/app/SpreadsheetApp.interface.ts"),f=n("../spread-sheet/src/external/collaboration/caret-manager.interface.ts"),p=n("../spread-sheet/src/external/collaboration/collaboration-manager.interface.ts"),g=n("../spread-sheet/src/core/view/layout/interface/pc-view.ts"),m=n("../spread-sheet/src/core/app/sheetStatus/index.ts"),v=n("../packages/model/src/spreadsheet/Spreadsheet.interface.ts"),I=n("../spread-sheet/src/core/data/configService/spreadConfig.ts"),E=n("../spread-sheet/src/base/event/event.ts"),S=n("../packages/common-utils/src/index.ts"),R=n("../node_modules/@tencent/docs-collab/lib/src/messageCenter/index.js"),w=n("../node_modules/@tencent/containerized/build/main/index.js"),A=n("../spread-sheet/src/external/collaboration/utils.ts"),C=n("../packages/lib/event/index.ts"),y=n("../packages/model/src/cell/format/RgbaColor.ts"),_=n("../packages/model/src/cell/format/index.ts"),T=n("../spread-sheet/src/external/tencentMeeting/utils.ts"),x=n("../spread-sheet/src/external/tencentMeeting/operation/operation.interface.ts"),b=n("../spread-sheet/src/core/view/level-2/collab-cursor/constant.ts"),D=n("../spread-sheet/src/external/tencentMeeting/controller/tencent-meeting-controller.ts"),O=n("../spread-sheet/src/base/util/domain-config.ts"),M=function(e,t,n,r){var o,s=arguments.length,i=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)i=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(i=(s<3?o(i):s>3?o(t,n,i):o(t,n))||i);return s>3&&i&&Object.defineProperty(t,n,i),i},j=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},L=function(e,t){return function(n,r){t(n,r,e)}},Z=function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function i(e){try{l(r.next(e))}catch(t){s(t)}}function a(e){try{l(r.throw(e))}catch(t){s(t)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,a)}l((r=r.apply(e,t||[])).next())}))},k=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(n[r[o]]=e[r[o]])}return n},N=[],P=function(e){function t(t,n,r,o){var s;return(s=e.call(this)||this).app=t,s.spreadsheet=n,s.sheetStatus=r,s.view=o,s._onUpdateCollabInfo=new C.Q,s.onUpdateCollabInfo=s._onUpdateCollabInfo.event,s.getCollaboratorInfo=function(e){var t;return null===(t=s.userCollection)||void 0===t?void 0:t.get(e)},s.reportUserCaretAfterSelectedChange=function(e){if(!e||s.sheetStatus.workbookStatus.canEdit){var t=s.getCursorMessage(e);if((0,T.isFromTencentMeetingSharing)()){var n=D.p.getInstance(s.app).getRole();t.sourceRole=n}s.sendCursorMessage(t)}},s.onUserJoin=function(e,t){var n;null===e||void 0===e||e.forEach((function(e){s.userCollection.has(e.userId)||s.updateUserInfo(e.userId,{type:p.yv.NEW,userId:e.userId,colorId:e.colorId,session_type:e.session_type,uuId:e.uuId,status:p.Du.NEW,bgColor:s.getBgColor(e.colorId)})})),null===(n=s.throttleHandleUserJoin)||void 0===n||n.call((0,a.Z)(s)),E.ZP.view.trigger("userJoin",e,t)},s.onUserLeave=function(e,t){null===e||void 0===e||e.forEach((function(e){var t;null===(t=s.throttleHandleUserLeave)||void 0===t||t.call((0,a.Z)(s),e)})),E.ZP.view.trigger("userLeave",e,t)},s.onCursorChange=function(e){return Z((0,a.Z)(s),void 0,void 0,regeneratorRuntime.mark((function t(){var n=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.forEach((function(e){var t,r=e.changedBy,o=null===(t=n.getUserInfo(r))||void 0===t?void 0:t.bgColor,s=e.sourceRole;(0,T.isFromTencentMeetingSharing)()&&(o=n.getMeetingColor(o,s)),n.updateUserInfo(r,{type:p.yv.CURSOR,userId:r,cursor:e,bgColor:o})})),E.ZP.view.trigger("handleCursorEnd",e);case 2:case"end":return t.stop()}}),t)})))},s._register((0,w.OF)((function(){s.destroy()}),"destroyCollaborationManager")),s}(0,l.Z)(t,e);var n=t.prototype;return n.init=function(){this.invitedUserInfos=I.q.getConfig("invitedUserInfos"),this.userCollection=new Map,this.throttleHandleUserJoin=(0,S.P2)(this.handleUserJoin.bind(this),5e3),this.throttleHandleUserLeave=(0,S.P2)(this.handleUserLeave.bind(this),5e3),this.throttleHandleCursorMessage=(0,S.P2)(this.handleCursorMessage.bind(this),3e3),this.throttleReportUserCaretAfterSelectedChange=(0,S.P2)(this.reportUserCaretAfterSelectedChange.bind(this),2e3),this.caretManager=new c.Z(this,this.spreadsheet,this.sheetStatus,this.view,this.userCollection),this.register()},n.setCollaboratorInfo=function(e,t){this.userCollection.set(e,t)},n.delCollaboratorInfo=function(e){this.userCollection.has(e)&&this.userCollection.delete(e)},n.destroy=function(){var e;E.ZP.network.remove("userNewInfo",this.onUserJoin),E.ZP.network.remove("userLeave",this.onUserLeave),E.ZP.network.remove("userCaretChange",this.throttleReportUserCaretAfterSelectedChange),E.ZP.network.remove("cursor",this.onCursorChange),E.ZP.sheetsBar.remove("refreshCursor",null===(e=this.caretManager)||void 0===e?void 0:e.refreshCarets),this.userCollection.clear(),this.throttleHandleUserJoin=null,this.throttleHandleUserLeave=null,this.throttleHandleCursorMessage=null,this.throttleReportUserCaretAfterSelectedChange=null,this.caretManager=null,this.invitedUserInfos.length=0,N.length=0},n.register=function(){var e;E.ZP.network.listen("userNewInfo",this.onUserJoin),E.ZP.network.listen("userLeave",this.onUserLeave),E.ZP.network.listen("userCaretChange",this.throttleReportUserCaretAfterSelectedChange),E.ZP.network.listen("cursor",this.onCursorChange),E.ZP.sheetsBar.listen("refreshCursor",null===(e=this.caretManager)||void 0===e?void 0:e.refreshCarets)},n.handleUserJoin=function(){var e;return Z(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n,r,o=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=[],this.userCollection.forEach((function(e){"new"===e.status&&n.push(e)})),t.next=4,(0,A.i)(n,O.xc);case 4:null===(r=t.sent)||void 0===r||r.forEach((function(e){if(void 0!==e.markName){var t=e.reqUid||e.uid,n="p."+t;o.updateUserInfo(n,{type:p.yv.USERINFO,userId:n,uid:t,avatar:e.userPic||"",userPic:e.userPic||"",name:e.markName||"",markName:e.markName||"",corpName:e.corpName||"",status:p.Du.CONNECTED,englishName:e.englishName,xid:e.xid})}})),null===(e=this.caretManager)||void 0===e||e.reportPosition(),E.ZP.view.trigger("userJoinAfterFetch",Array.from(this.userCollection.values()).filter((function(e){return e.status===p.Du.CONNECTED})));case 8:case"end":return t.stop()}}),t,this)})))},n.updateUserInfo=function(e,t){var n;this.getUserInfo(e)?this.setUserInfo(e,t):this.setNewUserInfo(e,t);var r=this.getCollaboratorInfo(e);(null===r||void 0===r?void 0:r.cursor)&&(null===(n=this.throttleHandleCursorMessage)||void 0===n||n.call(this,r.cursor))},n.setUserInfo=function(e,t){var n=this,r=this.getCollaboratorInfo(e),o=(t.type,k(t,["type"]));if(this.setCollaboratorInfo(e,Object.assign({},r,o)),t.type===p.yv.USERINFO){var s=t;this.invitedUserInfos.forEach((function(e,r){if(e.userId===t.userId){var o={name:s.name,userPic:s.avatar,uin:s.uid,corpName:s.corpName,status:s.status,bgcolor:t.bgColor,englishName:s.englishName,xid:s.xid};n.invitedUserInfos[r]=Object.assign({},n.invitedUserInfos[r],o)}}))}this._onUpdateCollabInfo.fire(Array.from(this.userCollection).filter((function(e){return e[1].status===p.Du.CONNECTED})).map((function(e){return{uid:e[1].uid||"",markName:e[1].name||"",userPic:e[1].avatar||"",corpName:e[1].corpName||"",userId:e[1].userId||""}})))},n.setNewUserInfo=function(e,t){if(t.type!==p.yv.CURSOR){t.type;var n=k(t,["type"]);this.setCollaboratorInfo(e,n);var r=t;this.invitedUserInfos.push({colorId:r.colorId,userId:r.userId,session_type:r.session_type,uuId:r.uuId,status:r.status})}},n.handleUserLeave=function(e){var t,n=this.invitedUserInfos.findIndex((function(t){return t.userId===e.userId}));this.invitedUserInfos.splice(n,1),this.invitedUserInfos.length<=1&&(this.invitedUserInfos.length=0),null===(t=this.caretManager)||void 0===t||t.removeCaret(e.userId),this.delCollaboratorInfo(e.userId),this._onUpdateCollabInfo.fire(Array.from(this.userCollection).filter((function(e){return e[1].status===p.Du.CONNECTED})).map((function(e){return{uid:e[1].uid||"",markName:e[1].name||"",userPic:e[1].avatar||"",corpName:e[1].corpName||"",userId:e[1].userId||""}})))},n.getUserInfo=function(e){var t=this.getCollaboratorInfo(e);if(!t){var n=this.invitedUserInfos.findIndex((function(t){return t.userId===e}));if(!(t=this.invitedUserInfos[n]))return null;this.setCollaboratorInfo(e,t)}return t},n.handleCursorMessage=function(e){var t;this.sheetStatus.workbookStatus.canEdit&&!this.app.spreadsheet.isExternalSheet()&&(null===(t=this.caretManager)||void 0===t||t.updateCaret(e))},n.getBgColor=function(e){var t=f.C,n=I.q.getConfig("colorPalette")||[];if(e||"number"===typeof e){var r=+e;n[r%n.length]&&(t=n[r%n.length])}return t},n.getMeetingColor=function(e,t){var n=this,r=I.q.getConfig("colorPalette")||[];if(t===x.uU.HOST)return b.de;if(e&&!this.isColorEqual(e,b.de))return e;var o=r.filter((function(e){return!n.isColorEqual(e,b.de)}));return u()(o)},n.isColorEqual=function(e,t){return y.Z.createInstance(t).equal(_.Color.createColor(e))},n.getCursorMessage=function(e){var t=I.q.getConfig("userId");return{type:"caret",sheet:Object.assign({},e,{tabId:this.spreadsheet.getActiveSheetId(),openTime:Date.now()}),changedBy:t}},n.sendCursorMessage=function(e){this.app.messageCenter.sendMessage({cmd:R.Command.CURSOR_MESSAGE,taskId:void 0,data:JSON.stringify(e),onError:function(){}})},t}(w.JT);P=M([L(0,h.m),L(1,v.V),L(2,m.T),L(3,g.w),j("design:paramtypes",["function"===typeof(r="undefined"!==typeof h.m&&h.m)?r:Object,"function"===typeof(o="undefined"!==typeof v.V&&v.V)?o:Object,"function"===typeof(s="undefined"!==typeof m.T&&m.T)?s:Object,"function"===typeof(i="undefined"!==typeof g.w&&g.w)?i:Object])],P),t.default=P},"../spread-sheet/src/external/collaboration/index.ts":function(e,t,n){"use strict";n.d(t,{pI:function(){return r.pI}});var r=n("../spread-sheet/src/external/collaboration/collaboration-manager.interface.ts");n("../spread-sheet/src/external/collaboration/caret-manager.ts"),n("../spread-sheet/src/external/collaboration/collaboration-manager.ts")},"../spread-sheet/src/external/collaboration/utils.ts":function(e,t,n){"use strict";n.d(t,{L:function(){return E},i:function(){return I}}),n("../node_modules/regenerator-runtime/runtime.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.promise.js"),n("../node_modules/core-js/modules/es.array.map.js"),n("../node_modules/core-js/modules/es.object.keys.js"),n("../node_modules/core-js/modules/web.dom-collections.for-each.js"),n("../node_modules/core-js/modules/es.array.join.js"),n("../node_modules/core-js/modules/es.string.starts-with.js"),n("../node_modules/core-js/modules/es.array.filter.js"),n("../node_modules/core-js/modules/es.array.find-index.js"),n("../node_modules/core-js/modules/es.regexp.to-string.js"),n("../node_modules/core-js/modules/es.function.name.js"),n("../node_modules/core-js/modules/es.regexp.exec.js"),n("../node_modules/core-js/modules/es.string.replace.js");var r=n("./node_modules/axios/index.js"),o=n.n(r),s=n("../node_modules/qs/lib/index.js"),i=n.n(s),a=n("../spread-sheet/src/core/data/configService/spreadConfig.ts"),l=n("../packages/utils/src/safe.ts"),d=n("../packages/common-utils/src/index.ts"),u=n("../spread-sheet/src/base/util/domain-config.ts"),c=n("../spread-sheet/src/base/util/appConfig.ts"),h=function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function i(e){try{l(r.next(e))}catch(t){s(t)}}function a(e){try{l(r.throw(e))}catch(t){s(t)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,a)}l((r=r.apply(e,t||[])).next())}))};function f(e){var t=[];return Object.keys(e).map((function(n){var r=e[n];Array.isArray(r)?r.forEach((function(e){t.push(encodeURIComponent(n)+"="+encodeURIComponent(e))})):void 0!==r&&t.push(encodeURIComponent(n)+"="+encodeURIComponent(r))})),t.join("&")}function p(e){var t,n,r,s;return h(this,void 0,void 0,regeneratorRuntime.mark((function d(){var u,h,f;return regeneratorRuntime.wrap((function(d){for(;;)switch(d.prev=d.next){case 0:if("[]"!==(u="["+e.join(",")+"]")){d.next=3;break}return d.abrupt("return",Promise.resolve([]));case 3:return h=i().stringify({bkn:(0,l.G)(),domainId:a.q.getConfig("domainId"),localPadId:a.q.getConfig("padId"),uids:u,xsrf:(0,l.f)()}),d.prev=4,d.next=7,o().post("//"+c.Z.getConfig("runtime.domainName")+"/sdc/getusermarkname",h,{withCredentials:!0});case 7:f=d.sent,d.next=13;break;case 10:d.prev=10,d.t0=d.catch(4),console.error(d.t0);case 13:if(0!==(null===(t=null===f||void 0===f?void 0:f.data)||void 0===t?void 0:t.retcode)){d.next=17;break}if(!(null===(n=f.data)||void 0===n?void 0:n.result.rsp)){d.next=16;break}return d.abrupt("return",null===(r=f.data)||void 0===r?void 0:r.result.rsp);case 16:console.error(null===(s=f.data)||void 0===s?void 0:s.result);case 17:return d.abrupt("return",Promise.resolve([]));case 19:case"end":return d.stop()}}),d,null,[[4,10]])})))}function g(e){return h(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n,r,o,s;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=function(e){return e.startsWith("14")},(r=e.filter((function(e){return n(e)}))).length&&!u.xc){t.next=5;break}return t.abrupt("return",{tinyIdToWedriveUin:{},wedriveUinToTinyId:{}});case 5:return o={},s={},t.next=9,p(r);case 9:return t.sent.forEach((function(e){e.wedriveUin&&(o[e.uid]=e.wedriveUin,s[e.wedriveUin]=e.uid)})),t.abrupt("return",{tinyIdToWedriveUin:o,wedriveUinToTinyId:s});case 12:case"end":return t.stop()}}),t)})))}function m(e){var t,n;return h(this,void 0,void 0,regeneratorRuntime.mark((function r(){var s,i,l,c;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(s=e.filter((function(e){return e.wedriveUin})),(i=s.map((function(e){return e.wedriveUin}))).length&&!u.xc){r.next=4;break}return r.abrupt("return",e);case 4:return r.prev=4,r.next=7,o().post("/wedoc/doc_member_mgr",f({docid:a.q.getConfig("padId"),scode:(0,d.IZ)("scode"),func:8,wx_uin:i}));case 7:l=r.sent,c=l.data,0===(null===(t=c.head)||void 0===t?void 0:t.ret)&&(null===(n=c.body)||void 0===n?void 0:n.uin2xid)&&c.body.uin2xid.forEach((function(e){var t=s.findIndex((function(t){return t.wedriveUin===e.uin}));t>=0&&(s[t].xid=e.xid.toString())})),r.next=15;break;case 12:r.prev=12,r.t0=r.catch(4),console.error(r.t0);case 15:return r.abrupt("return",e);case 16:case"end":return r.stop()}}),r,null,[[4,12]])})))}function v(e){var t,n;return h(this,void 0,void 0,regeneratorRuntime.mark((function r(){var s,a,l,d,u;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(e.length){r.next=2;break}return r.abrupt("return",Promise.resolve([]));case 2:return r.next=4,g(e);case 4:return s=r.sent,a=s.tinyIdToWedriveUin,l=s.wedriveUinToTinyId,d=i().stringify({func:1,f:"json",auth_list:JSON.stringify({info:e.map((function(e){return{id:a[e]||e}}))})}),r.prev=8,r.next=11,o().post("/webdisk/member_info",d,{withCredentials:!0});case 11:u=r.sent,r.next=17;break;case 14:r.prev=14,r.t0=r.catch(8),console.error(r.t0);case 17:if(0!==(null===(t=null===u||void 0===u?void 0:u.data.head)||void 0===t?void 0:t.ret)||!(null===(n=null===u||void 0===u?void 0:u.data.body)||void 0===n?void 0:n.member)){r.next=21;break}return r.next=20,m(u.data.body.member.map((function(e){return{markName:e.name,userId:l[e.id]||e.id||e.vid.toString(),uid:l[e.id]||e.id||e.vid.toString(),userPic:e.avatar,corpName:e.corp_name||"",wedriveUin:l[e.id]?a[l[e.id]]:void 0}})));case 20:return r.abrupt("return",r.sent);case 21:return r.abrupt("return",Promise.resolve([]));case 23:case"end":return r.stop()}}),r,null,[[8,14]])})))}function I(e,t){return h(this,void 0,void 0,regeneratorRuntime.mark((function n(){var r,o;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r=e.filter((function(e){var t;return(null===(t=e.userId)||void 0===t?void 0:t.indexOf("p"))>-1})).map((function(e){var t;return null===(t=e.userId)||void 0===t?void 0:t.replace(/^(.*)\./,"")})),n.next=3,E(r,t);case 3:return o=n.sent,n.abrupt("return",o);case 5:case"end":return n.stop()}}),n)})))}function E(e,t){return void 0===t&&(t=!1),h(this,void 0,void 0,regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",t?v(e):p(e));case 1:case"end":return n.stop()}}),n)})))}},"../spread-sheet/src/external/gray-service/gray-service.ts":function(e,t,n){"use strict";n.d(t,{D:function(){return r}}),n("../node_modules/regenerator-runtime/runtime.js"),n("../node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.promise.js"),n("../node_modules/core-js/modules/es.array.iterator.js"),n("../node_modules/core-js/modules/es.map.js"),n("../node_modules/core-js/modules/es.string.iterator.js"),n("../node_modules/core-js/modules/esnext.map.delete-all.js"),n("../node_modules/core-js/modules/esnext.map.every.js"),n("../node_modules/core-js/modules/esnext.map.filter.js"),n("../node_modules/core-js/modules/esnext.map.find.js"),n("../node_modules/core-js/modules/esnext.map.find-key.js"),n("../node_modules/core-js/modules/esnext.map.includes.js"),n("../node_modules/core-js/modules/esnext.map.key-of.js"),n("../node_modules/core-js/modules/esnext.map.map-keys.js"),n("../node_modules/core-js/modules/esnext.map.map-values.js"),n("../node_modules/core-js/modules/esnext.map.merge.js"),n("../node_modules/core-js/modules/esnext.map.reduce.js"),n("../node_modules/core-js/modules/esnext.map.some.js"),n("../node_modules/core-js/modules/esnext.map.update.js"),n("../node_modules/core-js/modules/web.dom-collections.iterator.js");var r,o=n("../node_modules/@tencent/workbench/lib/esm/decorators/class/service.js"),s=n("./node_modules/axios/index.js"),i=n.n(s),a=n("../packages/utils/src/safe.ts"),l=n("../spread-sheet/src/base/util/domain-config.ts"),d=function(e,t,n,r){var o,s=arguments.length,i=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)i=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(i=(s<3?o(i):s>3?o(t,n,i):o(t,n))||i);return s>3&&i&&Object.defineProperty(t,n,i),i},u=function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function i(e){try{l(r.next(e))}catch(t){s(t)}}function a(e){try{l(r.throw(e))}catch(t){s(t)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,a)}l((r=r.apply(e,t||[])).next())}))};!function(e){e.SMART_SHEET="smartsheet"}(r||(r={}));var c=function(){var e=this;this.grayStateMap=new Map,this.isInGray=function(t){return u(e,void 0,void 0,regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t!==r.SMART_SHEET||!l.xc){e.next=2;break}return e.abrupt("return",!0);case 2:if(!this.grayStateMap.has(t)){e.next=4;break}return e.abrupt("return",this.grayStateMap.get(t)||!1);case 4:return e.next=6,this.getIsInGray(t);case 6:if(e.t0=e.sent,e.t0){e.next=9;break}e.t0=!1;case 9:return n=e.t0,this.grayStateMap.set(t,n),e.abrupt("return",n);case 12:case"end":return e.stop()}}),e,this)})))},this.addGray=function(t){return u(e,void 0,void 0,regeneratorRuntime.mark((function e(){var r,o,s;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,i()({method:"POST",url:"/v2/extra/gray/add",data:{type:t,xsrf:(0,a.f)()}});case 3:if(r=e.sent,0===(o=r.data).retcode&&0===o.cgicode){e.next=8;break}return n.g.log.error("GrayService","addGray 新增"+t+"灰度用户失败: "+o),e.abrupt("return");case 8:return e.next=10,this.getIsInGray(t);case 10:if(e.t0=e.sent,e.t0){e.next=13;break}e.t0=!1;case 13:s=e.t0,this.grayStateMap.set(t,s),e.next=20;break;case 17:e.prev=17,e.t1=e.catch(0),n.g.log.error("GrayService","addGray 新增"+t+"灰度用户失败: "+e.t1);case 20:case"end":return e.stop()}}),e,this,[[0,17]])})))},this.getIsInGray=function(t){return u(e,void 0,void 0,regeneratorRuntime.mark((function e(){var r,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,i()({method:"POST",url:"/v2/extra/gray/query",data:{type:t,xsrf:(0,a.f)()}});case 3:if(r=e.sent,0===(o=r.data).retcode&&0===o.cgicode){e.next=8;break}return n.g.log.error("GrayService","getIsInGray 获取"+t+"灰度配置失败: "+o),e.abrupt("return");case 8:return e.abrupt("return",o.result.exist);case 11:e.prev=11,e.t0=e.catch(0),n.g.log.error("GrayService","getIsInGray 获取"+t+"灰度配置失败: "+e.t0);case 14:case"end":return e.stop()}}),e,null,[[0,11]])})))}};c=d([(0,o.t)()],c),t.Z=c},"../spread-sheet/src/external/mention-ent/varsSettings.ts":function(e,t,n){"use strict";n.d(t,{DI:function(){return s},FD:function(){return u},Ht:function(){return o},NA:function(){return a},Ou:function(){return l},bM:function(){return d},sn:function(){return i}}),n("../node_modules/core-js/modules/es.array.iterator.js"),n("../node_modules/core-js/modules/es.map.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.string.iterator.js"),n("../node_modules/core-js/modules/esnext.map.delete-all.js"),n("../node_modules/core-js/modules/esnext.map.every.js"),n("../node_modules/core-js/modules/esnext.map.filter.js"),n("../node_modules/core-js/modules/esnext.map.find.js"),n("../node_modules/core-js/modules/esnext.map.find-key.js"),n("../node_modules/core-js/modules/esnext.map.includes.js"),n("../node_modules/core-js/modules/esnext.map.key-of.js"),n("../node_modules/core-js/modules/esnext.map.map-keys.js"),n("../node_modules/core-js/modules/esnext.map.map-values.js"),n("../node_modules/core-js/modules/esnext.map.merge.js"),n("../node_modules/core-js/modules/esnext.map.reduce.js"),n("../node_modules/core-js/modules/esnext.map.some.js"),n("../node_modules/core-js/modules/esnext.map.update.js"),n("../node_modules/core-js/modules/web.dom-collections.iterator.js"),n("../node_modules/core-js/modules/es.array.map.js"),n("../node_modules/core-js/modules/es.array.filter.js"),n("../node_modules/core-js/modules/es.function.name.js");var r=n("../spread-sheet/src/core/data/configService/spreadConfig.ts"),o=function(){return r.q.getConfig("corpId")||""},s=(null===n.g||void 0===n.g?void 0:n.g.tdocs)||{},i=function(){var e=[];return{set:function(t){e=t},get:function(){return e}}}(),a=function(){return r.q.getConfig("padId")},l=function(){return r.q.getConfig("title")},d=function(){var e=r.q.getConfig("invitedUserInfos")||[],t=new Map;return e.filter((function(e){return!t.has(e.uin)&&t.set(e.uin,1)})).map((function(e){return{englishName:"",name:(null===e||void 0===e?void 0:e.name)||"",vid:(null===e||void 0===e?void 0:e.vid)||(null===e||void 0===e?void 0:e.uin)||"",iconurl:(null===e||void 0===e?void 0:e.iconurl)||(null===e||void 0===e?void 0:e.userPic)||""}}))},u=function(){return!1}},"../spread-sheet/src/external/rangeAuth/constants/range-auth-event.ts":function(e,t,n){"use strict";n.d(t,{J:function(){return o},k:function(){return r}});var r={PROTECT_RANGE:"protectRange",PROTECT_SHEET:"protectSheet",CHECK_ALL_RANGE_AUTH:"checkAllRangeAuth",SHOW_EXIT_RANGE_SELECTOR:"showExitRangeSelector",SHOW_RANGE_AUTH:"showRangeAuth",HIDE_RANGE_AUTH:"hideRangeAuth",SWITCH_SHEET_AND_CHANGE_RANGED_ID:"switchSheetAndChangeRangedId",ADD_NEW_RANGE_AUTH:"addNewRangeAuth",DIMENSION_CHANGE:"dimensionChange",DELETE_RANGE_AUTH:"deleteRangeAuth",UPDATE_RANGE_AUTH:"updateRangeAuth",COOERATION_ADD_NEW_RANGE_DONE:"cooperationAddNewRangeDone",RANGE_AUTH_CHANGE:"rangeAuthChange",COOPERATION_INITED:"cooperation_inited",OWNER_INITED:"ownerInited",AUTH_INITED:"authInited",SHOW_RANGE_AUTH_SELECT_AREA:"showRangeAuthSelectArea"},o={SHOW_RANGE_AUTH_ICO:"showRangeAuthIco",HIDE_RANGE_AUTH_ICO:"hideRangeAuthIco"}},"../spread-sheet/src/external/report/alloyreport.ts":function(e,t,n){"use strict";n.d(t,{az:function(){return T},fV:function(){return R},iV:function(){return o.iV},ji:function(){return _},mC:function(){return v},y8:function(){return g}}),n("../node_modules/core-js/modules/es.function.name.js"),n("../node_modules/core-js/modules/web.dom-collections.for-each.js"),n("../node_modules/core-js/modules/es.object.keys.js");var r,o=n("../packages/report/src/index.ts"),s=n("../spread-sheet/src/core/app/sheetSize.ts"),i=n("../spread-sheet/src/external/report/raven.ts"),a=n("../node_modules/@tencent/docs-user-agent/dist/index.js"),l=n.n(a),d=n("../packages/common-utils/src/index.ts"),u=n("../node_modules/@tencent/doc-visibilitychange/dist/tabkit.js"),c=n.n(u),h=n("../spread-sheet/src/base/util/timer.ts"),f=n("../spread-sheet/src/base/config/version.ts"),p=o.ZP.tdwSingleReport;!function(e){e.PC="PC",e.ANDROID="Android",e.IOS="IOS"}(r||(r={}));var g,m={CheckMutationError:6,RunMutationError:6,afterMutationRunError:6};function v(e){var t=e.message,n=e.error,r=e.errorType;if(void 0!==m[r]){if(m[r]<=0)return;m[r]=m[r]-1}if(o.iV){t||(t="no_message");try{n||((n={}).name="dataLost",n.message="{"+JSON.stringify(t)+"\n}")}catch(s){}null===i.e||void 0===i.e||i.e.captureException(n,{level:"error",logger:"info-report",tags:{ErrorType:r,networkVersion:"new"},sampleReport:!1})}}!function(e){e[e.IMPORTANT=0]="IMPORTANT",e[e.DEBUG=1]="DEBUG",e[e.INFO=2]="INFO"}(g||(g={}));var I={level:"l",moduleValue:"m",actionValue:"a",ver5Value:"v5",obj3Value:"o3",detail:"d",baseVersion:"bv",activeSheetId:"asi",memory:"mem"},E=[{moduleValue:"messageCenter",actionValue:"applyNewChangesVError",ver5Value:"1",count:10},{moduleValue:"messageCenter",actionValue:"applyNewChangesVError",ver5Value:"2",count:10},{moduleValue:"messageCenter",actionValue:"applyNewChangesVError",ver5Value:"4",count:10},{moduleValue:"messageCenter",actionValue:"applyNewChangesVError",ver5Value:"5",count:5},{moduleValue:"messageCenter",actionValue:"applyNewChangesVError",ver5Value:"6",count:5},{moduleValue:"messageCenter",actionValue:"commitingQueueBlock",count:5},{moduleValue:"mutation",actionValue:"runMutation_1",ver5Value:"-1",count:5},{moduleValue:"mutation",actionValue:"runMutation_1",ver5Value:"0",count:5},{moduleValue:"mutation",actionValue:"runMutation_1",ver5Value:"1",count:5},{moduleValue:"mutation",actionValue:"runMutation_1",ver5Value:"2",count:5},{moduleValue:"mutation",actionValue:"runMutation_1",ver5Value:"3",count:5},{moduleValue:"mutation",actionValue:"afterMutationRunDataChange",ver5Value:"1",count:5},{moduleValue:"mutation",actionValue:"afterMutationRun",ver5Value:"1",count:5},{moduleValue:"indexeddb",actionValue:"getDataCatchError",count:2},{moduleValue:"indexeddb",actionValue:"clearDataCatchError",count:2},{moduleValue:"indexeddb",actionValue:"deleteDataCatchError",count:2},{moduleValue:"indexeddb",actionValue:"updateDataCatchError",count:2},{moduleValue:"indexeddb",actionValue:"setDataCatchError",count:2},{moduleValue:"indexeddb",actionValue:"changeDataKeyCatchError",count:2},{moduleValue:"indexeddb",actionValue:"setValue",ver5Value:"0",count:0},{moduleValue:"indexeddb",actionValue:"updateValue",ver5Value:"0",count:0},{moduleValue:"indexeddb",actionValue:"deleteValue",ver5Value:"0",count:0},{moduleValue:"mutationQueue",actionValue:"maxSize",count:5},{moduleValue:"mutationQueue",actionValue:"completeTimeout",count:5}],S={applyBehaviorAmount:0,commitMutationAmount:0,sendUserChangeAmount:0,acceptCommitAmount:0};function R(e){var t,n,r,o,s,i,a=e.moduleValue,l=e.actionValue;"applyBehavior"!==a||"local"!==l&&"undo"!==l&&"redo"!==l?"mutation"===a&&"commitMutation"===l?S.commitMutationAmount+=1:"messageCenter"!==a||"sendOfflineUserChange"!==l&&"sendUserChange"!==l?"messageCenter"!==a||"acceptCommit"!==l&&"acceptOfflineCommit"!==l||(S.acceptCommitAmount+=1):S.sendUserChangeAmount+=1:S.applyBehaviorAmount+=1;var d=(null===(n=null===(t=window.SpreadsheetApp)||void 0===t?void 0:t.messageCenter)||void 0===n?void 0:n.versionManager.getCurrentVersion())||-1,u=(null===(o=null===(r=window.SpreadsheetApp)||void 0===r?void 0:r.spreadsheet)||void 0===o?void 0:o.activeSheetId)||"unknown";e.baseVersion=d,e.activeSheetId=u,null===(i=null===(s=window.log)||void 0===s?void 0:s.info)||void 0===i||i.call(s,T(e))}var w=null;function A(){w=h.Z.wait(1e4).run((function(){var e=S,t=e.applyBehaviorAmount,n=e.commitMutationAmount,r=e.sendUserChangeAmount,o=e.acceptCommitAmount;if(0!==t||0!==n||0!==r||0!==o){var i=(0,s.F)(window.SpreadsheetApp.spreadsheet.activeSheetId),a={opername:"excel_dataflow",module:"datalost",action:"datalost",ver3:JSON.stringify(i),ver5:t,ver6:n,ver7:r,ver8:o};null===p||void 0===p||p(a,["user_mac","id"]),S={applyBehaviorAmount:0,commitMutationAmount:0,sendUserChangeAmount:0,acceptCommitAmount:0}}A()}))}function C(e,t){void 0===t&&(t=!1);var n=e.moduleValue,r=e.actionValue,o=e.ver5Value,s=n+"_"+r;return void 0===o||t||(s+="_"+o),s}o.iV&&A(),c().visibilitychange.registerOnVisible(A),c().visibilitychange.registerOnHidden((function(){h.Z.erase(w),w=null}));var y=function(){var e={};return E.forEach((function(t){var n=t.moduleValue,r=t.actionValue,o=t.ver5Value,s=t.count,i=C({level:-1,moduleValue:n,actionValue:r,ver5Value:o});e[i]=s})),e}();function _(e){var t,s,i,a,d,u,c,h;try{var m=e.level,v=e.moduleValue,I=e.actionValue,E=e.ver5Value,S=e.obj3Value,R=C(e);if(function(e,t){if(void 0!==y[e]){if(y[e]<=0)return!0;y[e]=y[e]-1}else{var n=C(t,!0);if(void 0!==y[n]){if(y[n]<=0)return!0;y[n]=y[n]-1}}return!1}(R,e))return;var w=null===(s=null===(t=window.SpreadsheetApp)||void 0===t?void 0:t.messageCenter)||void 0===s?void 0:s.versionManager.getCurrentVersion(),A=void 0===w?-1:w,_=(null===(a=null===(i=window.SpreadsheetApp)||void 0===i?void 0:i.spreadsheet)||void 0===a?void 0:a.activeSheetId)||"unknown",x=window.__globalReleaseVersion||"unknown";if(e.baseVersion=A,e.activeSheetId=_,null===(u=null===(d=window.log)||void 0===d?void 0:d.info)||void 0===u||u.call(d,T(e)),!o.iV)return;if(m===g.IMPORTANT||m===g.DEBUG&&(l().isMobilePhone||l().isAndroidPad?l().isAndroid?r.ANDROID:r.IOS:r.PC)===r.PC){var b={opername:"excel_dataflow",module:v||"unknown_dataflow_module",action:I||"unknown_action",obj3:S,ver3:_,ver5:E,ver6:A,ver7:f.Z.CODE_VER,ver8:x,ver9:JSON.stringify({container:n.g.isContainer?1:0,offline_package:n.g.__isOfflinePkg?1:0})};null===p||void 0===p||p(b,["user_mac","id"])}(m===g.DEBUG||m===g.IMPORTANT&&"0"!==E)&&(null===(c=window.log)||void 0===c||c.report(R))}catch(D){console.warn(D),null===(h=window.log)||void 0===h||h.warn("dataFlowReport",D.message)}}function T(e){var t="";if(e)if(Array.isArray(e))e.forEach((function(e){if(t+="#",e)try{t+=JSON.stringify(e)}catch(n){t+="JSON.stringify error."}}));else try{var n={};Object.keys(e).forEach((function(t){n[I[t]||t]=e[t]})),t+=JSON.stringify(n)}catch(r){t+="JSON.stringify error."}return t}"1"===(0,d.IZ)("alloy_report_close")&&(window.isCloseAlloyReport=!0)},"../spread-sheet/src/external/resetLocation/utils.ts":function(e,t,n){"use strict";n.d(t,{fe:function(){return i},gl:function(){return s}}),n("../node_modules/core-js/modules/es.regexp.exec.js"),n("../node_modules/core-js/modules/es.string.split.js"),n("../node_modules/core-js/modules/es.number.constructor.js"),n("../node_modules/core-js/modules/es.string.match.js"),n("../node_modules/core-js/modules/es.array.filter.js"),n("../node_modules/core-js/modules/es.array.join.js");var r=n("../packages/model/src/range/hexRangeUtils.ts"),o=n("../packages/common-utils/src/index.ts");function s(e,t,n,o){var s=t.xRange,i=t.yRange,a=t.col,l=t.row,d="";return d+=(0,r.colIndex2ColChar)(s[0]||0)+((i[0]||0)+1),d+=e?(0,r.colIndex2ColChar)(a.flow):(0,r.colIndex2ColChar)(o),d+=a.frozen||0,d+=e?(0,r.colIndex2ColChar)(l.flow):(0,r.colIndex2ColChar)(n),d+=l.frozen||0,d=encodeURIComponent(d)}function i(e,t){var n={selectRange:{xRange:[0,0],yRange:[0,0],row:{frozen:0,flow:0},col:{frozen:0,flow:0}},rowIndex:0,colIndex:0};return t?(n=decodeURIComponent((0,o.r)(t)).indexOf("$")>-1?function(e,t){var n={xRange:[0,0],yRange:[0,0],row:{frozen:0,flow:0},col:{frozen:0,flow:0}},o=0,s=0,i=t.split("$"),a=(0,r.cellChar2CellCoords)(i[0]),l=(0,r.cellChar2CellCoords)(i[1]);return i&&i.length>=6&&a&&l&&(n.xRange=[a[1],l[1]],n.yRange=[a[0],l[0]],n.col.flow=e?Number(i[2]):0,n.col.frozen=Number(i[3]),n.row.flow=e?Number(i[4]):0,n.row.frozen=Number(i[5]),e||(s=Number(i[2]),o=Number(i[4]))),{selectRange:n,rowIndex:o,colIndex:s}}(e,t):function(e,t){var n={xRange:[0,0],yRange:[0,0],row:{frozen:0,flow:0},col:{frozen:0,flow:0}},o=0,s=0,i=t.match(/([A-Z]+[0-9]+)/gi);if(i&&3===i.length){var l=(0,r.cellChar2CellCoords)(i[0]),d=(0,r.cellChar2CellCoords)(i[0]),u=(0,r.cellChar2CellCoords)(i[1]),c=(0,r.cellChar2CellCoords)(i[2]);l&&d&&u&&c&&(n.xRange=[l[1],d[1]],n.yRange=[l[0],d[0]],n.col.flow=e?u[1]:a(c[1],u[1]).colFlow,n.col.frozen=u[0]+1,n.row.flow=e?c[1]:a(c[1],u[1]).rowFlow,n.row.frozen=c[0]+1,e||(s=u[1],o=c[1]))}return{selectRange:n,rowIndex:o,colIndex:s}}(e,t),n):n}function a(e,t){var r=n.g.SpreadsheetApp.view.canvas.areaData;return{colFlow:r.getDisplayViewLeftByCol(t),rowFlow:r.getDisplayViewTopByRow(e)}}},"../spread-sheet/src/external/sheet-adapter/sheet-adapter-manager.interface.ts":function(e,t,n){"use strict";n.d(t,{c:function(){return r}});var r=(0,n("../node_modules/@tencent/containerized/build/main/index.js").yh)("ISheetAdapterManager")},"../spread-sheet/src/external/sheet-adapter/sheet-adapter-manager.ts":function(e,t,n){"use strict";n.d(t,{Z:function(){return tt}}),n("../node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),n("../node_modules/core-js/modules/esnext.reflect.metadata.js"),n("../node_modules/core-js/modules/es.array.iterator.js"),n("../node_modules/core-js/modules/es.map.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.string.iterator.js"),n("../node_modules/core-js/modules/esnext.map.delete-all.js"),n("../node_modules/core-js/modules/esnext.map.every.js"),n("../node_modules/core-js/modules/esnext.map.filter.js"),n("../node_modules/core-js/modules/esnext.map.find.js"),n("../node_modules/core-js/modules/esnext.map.find-key.js"),n("../node_modules/core-js/modules/esnext.map.includes.js"),n("../node_modules/core-js/modules/esnext.map.key-of.js"),n("../node_modules/core-js/modules/esnext.map.map-keys.js"),n("../node_modules/core-js/modules/esnext.map.map-values.js"),n("../node_modules/core-js/modules/esnext.map.merge.js"),n("../node_modules/core-js/modules/esnext.map.reduce.js"),n("../node_modules/core-js/modules/esnext.map.some.js"),n("../node_modules/core-js/modules/esnext.map.update.js"),n("../node_modules/core-js/modules/web.dom-collections.iterator.js");var r,o,s,i=n("../packages/model/src/sheet/SheetType.ts"),a=n("../spread-sheet/src/core/app/SpreadsheetApp.interface.ts"),l=n("../spread-sheet/src/external/collaboration/index.ts"),d=n("../node_modules/@tencent/containerized/build/main/index.js"),u=n("../spread-sheet/src/base/event/event.ts"),c=n("../node_modules/@babel/runtime/helpers/esm/assertThisInitialized.js"),h=n("../node_modules/@babel/runtime/helpers/esm/inheritsLoose.js"),f=(n("../node_modules/regenerator-runtime/runtime.js"),n("../node_modules/core-js/modules/es.promise.js"),n("../node_modules/core-js/modules/web.dom-collections.for-each.js"),n("../packages/mutation/src/MutationId.ts")),p=n("../packages/lib/event/index.ts"),g=function(e,t,n,r){var o,s=arguments.length,i=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)i=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(i=(s<3?o(i):s>3?o(t,n,i):o(t,n))||i);return s>3&&i&&Object.defineProperty(t,n,i),i},m=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},v=function(e,t){return function(n,r){t(n,r,e)}},I=function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function i(e){try{l(r.next(e))}catch(t){s(t)}}function a(e){try{l(r.throw(e))}catch(t){s(t)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,a)}l((r=r.apply(e,t||[])).next())}))};!function(e){e[e.UNINIT=0]="UNINIT",e[e.INITING=1]="INITING",e[e.SUCCESS=2]="SUCCESS",e[e.FAIL=3]="FAIL"}(s||(s={}));var E,S,R=function(e,t){var r=this;this.app=e,this.onInitSuccEmitter=new p.Q,this.onInitSucc=this.onInitSuccEmitter.event,this.initStatus=s.UNINIT,this.init=function(){return new Promise((function(e){return I(r,void 0,void 0,regeneratorRuntime.mark((function t(){var r=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.initStatus!==s.SUCCESS){t.next=3;break}return e(!0),t.abrupt("return");case 3:if(this.initStatus!==s.INITING){t.next=6;break}return this.onInitSucc((function(){e(!0)})),t.abrupt("return");case 6:if(t.prev=6,this.initStatus=s.INITING,this.externalSheetSDK){t.next=12;break}return t.next=11,this.bootstrap();case 11:this.externalSheetSDK=t.sent;case 12:if(!this.app.sheetAdapterManager.isWorkbenchReady){t.next=17;break}return t.next=15,this.loadWorkbench();case 15:t.next=18;break;case 17:u.ZP.default.one("sheet_workbench_ready",(function(){return I(r,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.workbenchAdapter){e.next=3;break}return e.next=3,this.loadWorkbench();case 3:case"end":return e.stop()}}),e,this)})))}));case 18:this.registerEvents(),this.injectModules(),this.initStatus=s.SUCCESS,this.onInitSuccEmitter.fire(),e(!0),t.next=30;break;case 25:t.prev=25,t.t0=t.catch(6),n.g.log.error("sheetAdapter: 初始化 sdk 失败: ",t.t0),this.initStatus=s.FAIL,e(!1);case 30:case"end":return t.stop()}}),t,this,[[6,25]])})))}))},this.isInitialized=function(){return r.initStatus===s.SUCCESS},this.registerEvents=function(){r.events||r.initEvents(),r.events.forEach((function(e){var t=e.eventName,n=e.event;r.registerEvent(t,n)}))},this.listen=function(){r.app.emitter.once(r.app.EVENT.SPREAD_SHEET_SDK_CORE_END,(function(){r.app.mutationBehavior.emitter.addListener(r.app.mutationBehavior.EVENT.AFTER_MUTATION_RUN,r.onMutationChange)})),r.onInitSucc((function(){r.afterInit()}))},this.onMutationChange=function(e){e.mutation.id===f.ZP.INSERT_SHEET_MUTATION&&r.app.spreadsheet.sheetManager.getSheetBySheetId(e.sheetId).getSheetType()===r.sheetType&&r.init()},this.sheetType=t,this.app.viewManager.registerView(this.sheetType);var o=this.app.viewManager.getView(this.sheetType);this.viewDom=o.getNode().container,this.listen()},w=R=g([v(0,a.m),m("design:paramtypes",["function"===typeof(r="undefined"!==typeof a.m&&a.m)?r:Object,"function"===typeof(o="undefined"!==typeof i.ZP&&i.ZP)?o:Object])],R),A=n("../spread-sheet/src/external/sheet-adapter/smart-sheet-adapter/constants.ts"),C=n("../spread-sheet/src/external/waterMark/watermark-generate.ts"),y=n("../spread-sheet/src/core/data/configService/spreadConfig.ts"),_=n("../spread-sheet/src/external/collaboration/utils.ts"),T=n("../node_modules/@babel/runtime/helpers/esm/createClass.js"),x=function(e,t,n,r){var o,s=arguments.length,i=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)i=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(i=(s<3?o(i):s>3?o(t,n,i):o(t,n))||i);return s>3&&i&&Object.defineProperty(t,n,i),i},b=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},D=function(e,t){return function(n,r){t(n,r,e)}},O=function(){function e(e){this.app=e;var t=this.app.sheetStatus;this.shutDownStatus=t.shutDownStatus,this.tempStatus=t.tempStatus,this.workbookStatus=t.workbookStatus,this.sheetsStatus=t.sheetsStatus}var t=e.prototype;return t.change=function(e){this.shutDownStatus.status.change(e),this.tempStatus.status.change(e),this.workbookStatus.status.change(e),this.sheetsStatus.change(e)},t.offChange=function(e){this.shutDownStatus.status.offChange(e),this.tempStatus.status.offChange(e),this.workbookStatus.status.offChange(e),this.sheetsStatus.offChange(e)},t.getSubStatusBySheetId=function(e){return this.sheetsStatus.status[e]},(0,T.Z)(e,[{key:"canEdit",get:function(){var e=!0;this.shutDownStatus.status.activate?e=this.shutDownStatus.status.canEdit:this.tempStatus.status.activate&&(e=this.tempStatus.status.canEdit);var t=!0,n=this.app.spreadsheet.activeSheetId,r=this.getSubStatusBySheetId(n);return r&&(t=r.canEdit),e&&this.workbookStatus.canEdit&&t}},{key:"canComment",get:function(){return this.workbookStatus.canComment&&this.workbookStatus.isOnline}},{key:"canCopy",get:function(){return this.workbookStatus.canCopy}}]),e}(),M=O=x([D(0,a.m),b("design:paramtypes",["function"===typeof(E="undefined"!==typeof a.m&&a.m)?E:Object])],O),j=(n("../node_modules/core-js/modules/es.function.name.js"),n("../spread-sheet/src/core/ark-extensions/extensions/attachment.ts")),L=function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function i(e){try{l(r.next(e))}catch(t){s(t)}}function a(e){try{l(r.throw(e))}catch(t){s(t)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,a)}l((r=r.apply(e,t||[])).next())}))},Z=function(){function e(){}return e.prototype.getAttachment=function(){return L(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.resolve().then(n.bind(n,"../spread-sheet/src/core/ark-extensions/index.ts"));case 2:return t=e.sent.default,e.next=5,t.getExtension(j.m.name);case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e)})))},e}(),k=n("../node_modules/@tencent/smartsheet-sdk/es/index.js"),N=n("./node_modules/axios/index.js"),P=n.n(N),U=n("../packages/utils/src/safe.ts"),F=function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function i(e){try{l(r.next(e))}catch(t){s(t)}}function a(e){try{l(r.throw(e))}catch(t){s(t)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,a)}l((r=r.apply(e,t||[])).next())}))},V=function(){function e(){}var t=e.prototype;return t.getBrowseLocation=function(e){return F(this,void 0,void 0,regeneratorRuntime.mark((function t(){var r,o;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,P()({method:"GET",url:"/sdc/getbrowselocation",params:{sheetid:e,type:"view",padid:y.q.getConfig("globalPadId"),xsrf:(0,U.f)()}});case 3:if(r=t.sent,0===(null===(o=r.data)||void 0===o?void 0:o.retcode)){t.next=8;break}return n.g.log.error("getBrowseLocation 获取浏览位置失败",o),t.abrupt("return");case 8:return t.abrupt("return",null===o||void 0===o?void 0:o.result);case 11:return t.prev=11,t.t0=t.catch(0),n.g.log.error("getBrowseLocation 获取浏览位置失败",t.t0),t.abrupt("return");case 15:case"end":return t.stop()}}),t,null,[[0,11]])})))},t.updateBrowseLocation=function(e){return F(this,void 0,void 0,regeneratorRuntime.mark((function t(){var r,o,s,i;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,r=e.sheetId,o=e.location,t.next=4,P()({method:"POST",url:"/sdc/updatebrowselocation",params:{sheetid:r,location:o,type:"view",padid:y.q.getConfig("globalPadId"),xsrf:(0,U.f)()}});case 4:s=t.sent,0!==(null===(i=s.data)||void 0===i?void 0:i.retcode)&&n.g.log.error("updateBrowseLocation 更新浏览位置失败",i),t.next=12;break;case 9:t.prev=9,t.t0=t.catch(0),n.g.log.error("updateBrowseLocation 更新浏览位置失败",t.t0);case 12:case"end":return t.stop()}}),t,null,[[0,9]])})))},e}(),B=(n("../node_modules/core-js/modules/es.object.assign.js"),n("../spread-sheet/src/external/tencentMeeting/utils.ts")),H=n("../spread-sheet/src/external/tencentMeeting/api.ts"),G=n("../spread-sheet/src/external/tencentMeeting/view/followPresenter.tsx"),W=function(){this.meetingApi=H,this.meetingUtil=Object.assign(Object.assign({},B),{hideFollowButton:G.V});var e=u.ZP.network;this.networkEvent=e},z=n("../node_modules/@tencent/ioc/lib/esm/index.js"),Q=n("../spread-sheet/src/external/gray-service/gray-service.ts"),Y=n("../packages/report/src/index.ts"),q=n("../spread-sheet/src/base/util/domain-config.ts"),J=function(){function e(e){this.app=e}var t=e.prototype;return t.setTitle=function(e){var t;if(0===y.q.getConfig("isUserChangeTitle"))try{this.app.spreadsheet.setTitle(e)}catch(r){null===(t=n.g.log)||void 0===t||t.error("smartsheet","应用 title 失败:",r)}},t.isWeCom=function(){return q.xc},t.isToc=function(){return q.oT},e}(),K=(n("../node_modules/core-js/modules/es.regexp.exec.js"),n("../node_modules/core-js/modules/es.string.split.js"),n("../packages/common-utils/src/client/url.ts")),X=n("../spread-sheet/src/core/ui/toast/index.ts"),$=n("../spread-sheet/src/core/feature/relateForm/api.ts"),ee=n("../node_modules/i18next/dist/esm/i18next.js"),te=function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function i(e){try{l(r.next(e))}catch(t){s(t)}}function a(e){try{l(r.throw(e))}catch(t){s(t)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,a)}l((r=r.apply(e,t||[])).next())}))};!function(e){e[e.SUCCESS=0]="SUCCESS",e[e.UNINIT=1]="UNINIT",e[e.FAIL=2]="FAIL"}(S||(S={}));var ne,re,oe,se,ie,ae,le,de=function(){function e(e,t,n){var r=this;void 0===n&&(n=S.UNINIT),this.app=e,this.sheetId=t,this.status=n,this.handleSmartSheetForm=function(){var e="form"===(0,K.IZ)("from");e&&r.removeUrl();var t=r.checkIsSmartSheetForm();e&&t&&((0,X.showToast)(ee.ZP.t("如需重新关联传统工作表，可点击切换"),void 0,{isNeedBtn:!0,btnText:ee.ZP.t("切换"),btnTextAfter:"",btnCallBack:function(){r.switchToSheet(),(0,X.hideToast)()}}),Y.ZP.tdwReport({opername:"doc_sheet",module:"form_to_ssheet",action:"switch_view"}))},this.initEvent()}var t=e.prototype;return t.checkIsSmartSheetForm=function(){var e,t;return!!this.app.spreadsheet.isExternalSheet()&&!!(null===(t=(e=this.app.feature.relateForm).isRelated)||void 0===t?void 0:t.call(e,this.sheetId))},t.switchToSheet=function(){var e;return te(this,void 0,void 0,regeneratorRuntime.mark((function t(){var r,o,s,i,a;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=null===(e=this.app.feature.relateForm)||void 0===e?void 0:e.getRelatedInfos(),o=r[0].doc_meta.doc_id,s=o.domain_id,i=o.pad_id,a=s+"$"+i,t.prev=3,t.next=6,this.unbind();case 6:return t.next=8,this.bindToSheet(a);case 8:this.status=S.SUCCESS,t.next=15;break;case 11:t.prev=11,t.t0=t.catch(3),n.g.log.error("smartsheet","smartsheet收集表切换错误",t.t0),this.status=S.FAIL;case 15:Y.ZP.tdwReport({opername:"doc_sheet",module:"form_to_ssheet",action:"switch_click"});case 16:case"end":return t.stop()}}),t,this,[[3,11]])})))},t.unbind=function(){var e;return te(this,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,null===(e=this.app.feature.relateForm)||void 0===e?void 0:e.handleCancelFormWithoutTips(this.sheetId);case 2:case"end":return t.stop()}}),t,this)})))},t.bindToSheet=function(e){return te(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n,r,o;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,(0,$.mX)(e,"grid");case 2:n=t.sent,r=n.url,(o=(void 0===r?"":r).split("tab=")[1])&&this.app.feature.relateForm.switchToRelatedSheet(o);case 6:case"end":return t.stop()}}),t,this)})))},t.removeUrl=function(){var e=document.location.href;e=(0,K.oW)(e,"from"),history.replaceState(null,"",e)},t.initEvent=function(){var e=this;this.app.event.sheetsBar.one("switchActiveSheetEnd",(function(){e.status===S.UNINIT&&(0,X.hideToast)()}))},e}(),ue=n("../spread-sheet/src/base/index.ts"),ce=function(e,t,n,r){var o,s=arguments.length,i=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)i=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(i=(s<3?o(i):s>3?o(t,n,i):o(t,n))||i);return s>3&&i&&Object.defineProperty(t,n,i),i},he=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},fe=function(e,t){return function(n,r){t(n,r,e)}},pe=function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function i(e){try{l(r.next(e))}catch(t){s(t)}}function a(e){try{l(r.throw(e))}catch(t){s(t)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,a)}l((r=r.apply(e,t||[])).next())}))},ge=function(e){function t(t,r){var o;return(o=e.call(this,t,i.ZP.SMART_SHEET)||this).app=t,o.collaborationManager=r,o.applySheetData=function(e,t){return pe((0,c.Z)(o),void 0,void 0,regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(this.isInitialized()){n.next=3;break}return n.next=3,this.init();case 3:this.externalSheetSDK.applySheetData(e,t);case 4:case"end":return n.stop()}}),n,this)})))},o.render=function(e){return pe((0,c.Z)(o),void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.isInitialized()){t.next=3;break}return t.next=3,this.init();case 3:if(!this.workbenchAdapter){t.next=9;break}if(!1===this.prevSheetIsSmart){t.next=7;break}return t.next=7,this.switchSmartWorkbench();case 7:t.next=10;break;case 9:this.externalSheetSDK.attachEditor(this.viewDom);case 10:this.externalSheetSDK.render(e),this.addGrayToSmartSheet();case 12:case"end":return t.stop()}}),t,this)})))},o.renderWithWorkbench=function(){return pe((0,c.Z)(o),void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.isInitialized()){e.next=3;break}return e.next=3,this.init();case 3:if(this.workbenchAdapter){e.next=6;break}return e.next=6,this.loadWorkbench();case 6:if(!1===this.prevSheetIsSmart){e.next=9;break}return e.next=9,this.switchSmartWorkbench();case 9:this.externalSheetSDK.render(this.app.spreadsheet.activeSheetId);case 10:case"end":return e.stop()}}),e,this)})))},o.dispose=function(){o.externalSheetSDK.dispose()},o.createSheet=function(e,t){o.externalSheetSDK.createSheet(e,t)},o.copySheet=function(e,t){o.externalSheetSDK.copySheet(e,t)},o.deleteSheet=function(e){o.externalSheetSDK.deleteSheet(e)},o.getKeyframeBySheetId=function(e,t){return o.externalSheetSDK.getKeyframeBySheetId(e,t)},o.getTableJSONByViewType=function(e){return o.externalSheetSDK.getTableJSONByViewType(e)},o.getTableJSONBySheetCellData=function(e,t){return o.externalSheetSDK.getTableJSONBySheetCellData(e,t)},o.getTableJSONByTemplateMutations=function(e,t){return o.externalSheetSDK.getTableJSONByTemplateMutations(e,t)},o.renderHistory=function(e,t){return pe((0,c.Z)(o),void 0,void 0,regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(this.isInitialized()){n.next=3;break}return n.next=3,this.init();case 3:this.historyAttached||(this.externalSheetSDK.attachEditor(this.viewDom),this.historyAttached=!0),this.externalSheetSDK.renderHistory(e,t||{});case 5:case"end":return n.stop()}}),n,this)})))},o.handleCreateSheetAcceptCommit=function(e,t){var n,r;null===(r=(n=o.externalSheetSDK).handleCreateSheetAcceptCommit)||void 0===r||r.call(n,e,t)},o.getKeybindings=function(){return o.externalSheetSDK.getShortcutKeybindings()},o.getWorkbenchConfig=function(){return pe((0,c.Z)(o),void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.externalSheetSDK.getWorkbenchSettings());case 1:case"end":return e.stop()}}),e,this)})))},o.getWorkBenchAdapter=function(){return o.externalSheetSDK.getAdapter()},o.coverTableByTemplateMutations=function(e,t){o.externalSheetSDK.coverTableByTemplateMutations(e,t)},o.loadWorkbench=function(){return pe((0,c.Z)(o),void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})))},o.switchFirstScreenReport=function(){o.externalSheetSDK.switchFirstScreenReport()},o.bootstrap=function(){return Promise.resolve()},o.registerEvent=function(e,t){o.externalSheetSDK.registerEvent(e,t)},o.injectModule=function(e,t){o.externalSheetSDK.injectModule(e,t)},o.useWorkbenchRender=function(){return pe((0,c.Z)(o),void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.app.spreadsheet.activeSheet.getSheetType()!==i.ZP.SMART_SHEET){e.next=3;break}return e.next=3,this.render(this.app.spreadsheet.activeSheetId);case 3:case"end":return e.stop()}}),e,this)})))},o.initSmartsheetSdkI18=function(){try{(0,k.q6)()}catch(e){return}},o.handleWatermark=function(){var e,t=y.q.getConfig("watermark");if(t)try{var r=JSON.parse(t);((null===r||void 0===r?void 0:r.show)||(null===(e=null===r||void 0===r?void 0:r.s)||void 0===e?void 0:e.private))&&o.renderWatermark(t)}catch(s){n.g.log.error("smartSheetAdapter: 解析水印数据出错",s)}},o.renderWatermark=function(e){var t={isAuthor:y.q.getConfig("isCreator"),userName:y.q.getConfig("userName"),userDomain:y.q.getConfig("userDomain")};o.externalSheetSDK.renderWatermark({watermarkDocs:e,watermarkUsersDocs:t,watermarkOptions:C.jM})},o.getUserInfosFromServer=function(e){return pe((0,c.Z)(o),void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,_.L)(JSON.parse(e),q.xc));case 1:case"end":return t.stop()}}),t)})))},o.getCollaboratorInfo=function(e){return pe((0,c.Z)(o),void 0,void 0,regeneratorRuntime.mark((function t(){var n,r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=0===(null===e||void 0===e?void 0:e.indexOf("p."))?e:"p."+e,t.next=3,this.collaborationManager.getInstance();case 3:return r=t.sent,t.abrupt("return",r.getCollaboratorInfo(n));case 5:case"end":return t.stop()}}),t,this)})))},o.switchSmartWorkbench=function(){return pe((0,c.Z)(o),void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.workbenchAdapter.enter(this.viewDom);case 2:case"end":return e.stop()}}),e,this)})))},o.addGrayToSmartSheet=function(){return pe((0,c.Z)(o),void 0,void 0,regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=z.Am.get(Q.Z),e.next=3,t.isInGray(Q.D.SMART_SHEET);case 3:if(e.sent){e.next=6;break}t.addGray(Q.D.SMART_SHEET),Y.ZP.tdwReport({opername:"doc_smartsheet_editor",module:"bete",action:"add"});case 6:case"end":return e.stop()}}),e)})))},o.permission=new M(t),o.userCenter={getUserInfos:o.getUserInfosFromServer,getCollaboratorInfo:o.getCollaboratorInfo},o.browseLocation=new V,o.arkCenter=new Z,o}(0,h.Z)(t,e);var r=t.prototype;return r.followRequestMutations=function(e,t,n){return this.externalSheetSDK.followRequestMutations(e,t,n)},r.deserializeMutation=function(e){return this.externalSheetSDK.deserializeMutation(e)},r.deserializeRequests=function(e){return this.externalSheetSDK.deserializeRequests(e)},r.serializeMutation=function(e){return this.externalSheetSDK.serializeMutation(e)},r.getMutationClassByMutationId=function(e){return this.externalSheetSDK.getMutationClassByMutationId(e)},r.runMutations=function(e){return this.externalSheetSDK.runMutations(e)},r.initEvents=function(){this.events=[{eventName:A.TF.HIDE_SHEET_LIST,event:function(){u.ZP.toolBar.trigger("afterToolPanelShow")}},{eventName:A.TF.FIRST_EDIT,event:function(e){u.ZP.default.trigger("smartSheetFirstEdit",e)}},{eventName:A.TF.RENDER_FINISH,event:function(){var e;null===(e=n.g.__ws)||void 0===e||e.trigger("smartSheetWhiteFinish")}}]},r.injectModules=function(){var e=this,t=this.app;this.injectModule(A.v7.DATA_CENTER,t.dataCenter),this.injectModule(A.v7.SPREAD_CONFIG,y.q),this.injectModule(A.v7.PERMISSION,this.permission),this.injectModule(A.v7.USER_CENTER,this.userCenter),this.injectModule(A.v7.BROWSE_LOCATION,this.browseLocation),this.injectModule(A.v7.ARK_CENTER,this.arkCenter),this.meetingCenter=new W,this.injectModule(A.v7.MEETING_CENTER,this.meetingCenter),this.commonOperation=new J(t),this.injectModule(A.v7.COMMON_OPERATION,this.commonOperation),t.messageCenter?this.injectModule(A.v7.MESSAGE_CENTER,t.messageCenter):t.emitter.once(t.EVENT.SPREAD_SHEET_MESSAGE_END,(function(){e.injectModule(A.v7.MESSAGE_CENTER,t.messageCenter)})),t.undoredoStack?this.injectModule(A.v7.UNDO_REDO_STACK,t.undoredoStack):t.emitter.once(t.EVENT.SPREAD_SHEET_REQUEST_API_READY,(function(){e.injectModule(A.v7.UNDO_REDO_STACK,t.undoredoStack)}))},r.afterInit=function(){this.handleWatermark(),this.listenAfterInit()},r.listenAfterInit=function(){var e,t=this;u.ZP.network.listen("newWatermark",(function(e){(null===e||void 0===e?void 0:e.watermark)&&t.renderWatermark(e.watermark)})),u.ZP.sheetsBar.listen("switchActiveSheetEnd",(function(e){var n,r;t.prevSheetIsSmart=!t.app.spreadsheet.isExternalSheet();var o=t.app.spreadsheet.sheetManager.getSheetBySheetId(e);null===(r=(n=t.externalSheetSDK).handleSwitchSheet)||void 0===r||r.call(n,{sheetId:e,sheetType:o.getSheetType()})})),u.ZP.view.listen("handleCursorEnd",(function(e){return pe(t,void 0,void 0,regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:null===(n=this.externalSheetSDK)||void 0===n||n.handleCursorMessages(e);case 1:case"end":return t.stop()}}),t,this)})))})),u.ZP.default.listen("refreshUrlAfterSwitchSheet",(function(){var e,n;null===(n=(e=t.externalSheetSDK).refreshURL)||void 0===n||n.call(e)})),(null===(e=this.app.feature)||void 0===e?void 0:e.relateForm)?new de(this.app,this.app.spreadsheet.activeSheetId).handleSmartSheetForm():ue.Z.event.sheetsBar.one("RelateFormFinished",(function(){new de(t.app,t.app.spreadsheet.activeSheetId).handleSmartSheetForm()}))},t}(w),me=ge=ce([fe(0,a.m),fe(1,l.pI),he("design:paramtypes",["function"===typeof(ne="undefined"!==typeof a.m&&a.m)?ne:Object,"function"===typeof(re="undefined"!==typeof d.RU&&d.RU)?re:Object])],ge),ve=n("../spread-sheet/src/external/sheet-adapter/workbench/smart-workbench-adapter.base.ts"),Ie=n("../node_modules/@tencent/workbench/lib/esm/services/surface/surface-service.js"),Ee=n("../node_modules/@tencent/workbench/lib/esm/decorators/class/service.js"),Se=n("../node_modules/@tencent/workbench/lib/esm/services/workbench/workbench.interface.js"),Re=function(e,t,n,r){var o,s=arguments.length,i=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)i=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(i=(s<3?o(i):s>3?o(t,n,i):o(t,n))||i);return s>3&&i&&Object.defineProperty(t,n,i),i},we=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},Ae=function(e,t){return function(n,r){t(n,r,e)}},Ce=function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function i(e){try{l(r.next(e))}catch(t){s(t)}}function a(e){try{l(r.throw(e))}catch(t){s(t)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,a)}l((r=r.apply(e,t||[])).next())}))},ye=function(e){var t=this;this.workbench=e,this.openAdapter=function(e,n){return Ce(t,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.workbench.open(e,{mode:"stack",attachBeforeRender:!0,content:{container:n}});case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t,this)})))},this.workbench=e},_e=ye=Re([(0,Ee.t)(),Ae(0,(0,z.tB)(Se.K)),we("design:paramtypes",["function"===typeof(oe="undefined"!==typeof Se.K&&Se.K)?oe:Object])],ye),Te=function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function i(e){try{l(r.next(e))}catch(t){s(t)}}function a(e){try{l(r.throw(e))}catch(t){s(t)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,a)}l((r=r.apply(e,t||[])).next())}))},xe=function(e){function t(){var t;return(t=e.apply(this,arguments)||this).getWorkbenchSettings=function(){return Te((0,c.Z)(t),void 0,void 0,regeneratorRuntime.mark((function e(){var t,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.resolve().then(n.bind(n,"../node_modules/@tencent/smartsheet-sdk/es/pc.js"));case 2:return t=e.sent,r=t.pcWorkbenchOptions,e.abrupt("return",r.mount);case 5:case"end":return e.stop()}}),e)})))},t.openSmartSheet=function(e){return Te((0,c.Z)(t),void 0,void 0,regeneratorRuntime.mark((function t(){var r,o,s,i,a;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.surfaceService=z.Am.get(Ie.W),this.openService=z.Am.get(_e),r=this.app.sheetAdapterManager.getCurrentAdapter().getWorkBenchAdapter(),t.next=5,Promise.resolve().then(n.bind(n,"../node_modules/@tencent/smartsheet-sdk/es/pc.js"));case 5:if(o=t.sent,s=o.pcWorkbenchOptions,this.changeInitialConfigSettings(s),this.surfaceId){t.next=17;break}return t.next=11,this.openService.openAdapter(r,e);case 11:i=t.sent,a=i.id,this.surfaceId=a,this.resize(),t.next=18;break;case 17:this.surfaceService.setCurrent(this.surfaceId);case 18:case"end":return t.stop()}}),t,this)})))},t}return(0,h.Z)(t,e),t}(ve.Z),be=xe,De=function(e,t,n,r){var o,s=arguments.length,i=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)i=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(i=(s<3?o(i):s>3?o(t,n,i):o(t,n))||i);return s>3&&i&&Object.defineProperty(t,n,i),i},Oe=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},Me=function(e,t){return function(n,r){t(n,r,e)}},je=function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function i(e){try{l(r.next(e))}catch(t){s(t)}}function a(e){try{l(r.throw(e))}catch(t){s(t)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,a)}l((r=r.apply(e,t||[])).next())}))},Le=function(e){function t(t,r){var o;return(o=e.call(this,t,r)||this).app=t,o.collaborationManager=r,o.loadWorkbench=function(){return je((0,c.Z)(o),void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.workbenchAdapter=new be(this.app),e.next=3,this.workbenchAdapter.updateWorkbenchSetting();case 3:case"end":return e.stop()}}),e,this)})))},o.bootstrap=function(){return je((0,c.Z)(o),void 0,void 0,regeneratorRuntime.mark((function e(){var t,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.initSmartsheetSdkI18(),e.prev=1,e.next=4,Promise.resolve().then(n.bind(n,"../node_modules/@tencent/smartsheet-sdk/es/sheet-adapter/entry/pc.js"));case 4:return t=e.sent,r=t.PcSmartSheetSdkSheetAdapter,e.abrupt("return",new r);case 9:return e.prev=9,e.t0=e.catch(1),e.abrupt("return",Promise.reject());case 12:case"end":return e.stop()}}),e,this,[[1,9]])})))},o}return(0,h.Z)(t,e),t}(me),Ze=Le=De([Me(0,a.m),Me(1,l.pI),Oe("design:paramtypes",["function"===typeof(se="undefined"!==typeof a.m&&a.m)?se:Object,"function"===typeof(ie="undefined"!==typeof d.RU&&d.RU)?ie:Object])],Le),ke=n("../spread-sheet/src/core/view/config/default.ts"),Ne=function(e){var t=this;this.show=function(e){t.container.style.display="block",t.app.viewManager.getActiveView().setTopPosition(null!==e&&void 0!==e?e:97),t.app.event.default.trigger(ue.Z.EVENT_NAME.UI_SHOW,"search-panel-pc")},this.close=function(){t.container.innerHTML="",t.container.style.display="none",t.app.viewManager.getActiveView().setTopPosition(ke.Mz)},this.render=function(){return t.container=document.createElement("div"),t.container.classList.add("external-search-replace-center"),t.container.style.position="fixed",t.container.style.top="0",t.container.style.width="100%",t.container.style.height="97px",t.container.style.zIndex="10010",t.container.style.backgroundColor="#fff",document.body.appendChild(t.container),t.container.style.display="none",t.container},this.app=e,this.render()},Pe=n("../spread-sheet/src/external/view/mobile/header/native-header/index.ts"),Ue=n("../spread-sheet/src/external/view/mobile/header/native-header/api.ts"),Fe=function(){function e(e){this.app=e}return e.prototype.reInit=function(){Pe.Z.reInit(this.app)},(0,T.Z)(e,[{key:"socketNetworkStatus",get:function(){return this.app.networkStatus.socketNetworkStatus}},{key:"nativeHeaderAPI",get:function(){return Ue.n}}]),e}(),Ve=function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function i(e){try{l(r.next(e))}catch(t){s(t)}}function a(e){try{l(r.throw(e))}catch(t){s(t)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,a)}l((r=r.apply(e,t||[])).next())}))},Be=function(e){function t(){var t;return(t=e.apply(this,arguments)||this).getWorkbenchSettings=function(){return Ve((0,c.Z)(t),void 0,void 0,regeneratorRuntime.mark((function e(){var t,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.resolve().then(n.bind(n,"../node_modules/@tencent/smartsheet-sdk/es/mobile.js"));case 2:return t=e.sent,r=t.mobileWorkbenchOptions,e.abrupt("return",r.mount);case 5:case"end":return e.stop()}}),e)})))},t.openSmartSheet=function(e){return Ve((0,c.Z)(t),void 0,void 0,regeneratorRuntime.mark((function t(){var r,o,s,i,a;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.openService=z.Am.get(_e),this.surfaceService=z.Am.get(Ie.W),r=this.app.sheetAdapterManager.getCurrentAdapter().getWorkBenchAdapter(),t.next=5,Promise.resolve().then(n.bind(n,"../node_modules/@tencent/smartsheet-sdk/es/mobile.js"));case 5:if(o=t.sent,s=o.mobileWorkbenchOptions,this.changeInitialConfigSettings(s),this.surfaceId){t.next=17;break}return t.next=11,this.openService.openAdapter(r,e);case 11:i=t.sent,a=i.id,this.surfaceId=a,this.resize(),t.next=18;break;case 17:this.surfaceService.setCurrent(this.surfaceId);case 18:case"end":return t.stop()}}),t,this)})))},t}return(0,h.Z)(t,e),t}(ve.Z),He=Be,Ge=function(e,t,n,r){var o,s=arguments.length,i=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)i=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(i=(s<3?o(i):s>3?o(t,n,i):o(t,n))||i);return s>3&&i&&Object.defineProperty(t,n,i),i},We=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},ze=function(e,t){return function(n,r){t(n,r,e)}},Qe=function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function i(e){try{l(r.next(e))}catch(t){s(t)}}function a(e){try{l(r.throw(e))}catch(t){s(t)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,a)}l((r=r.apply(e,t||[])).next())}))},Ye=function(e){function t(t,r){var o;return(o=e.call(this,t,r)||this).app=t,o.collaborationManager=r,o.loadWorkbench=function(){return Qe((0,c.Z)(o),void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.workbenchAdapter=new He(this.app),e.next=3,this.workbenchAdapter.updateWorkbenchSetting();case 3:case"end":return e.stop()}}),e,this)})))},o.bootstrap=function(){return Qe((0,c.Z)(o),void 0,void 0,regeneratorRuntime.mark((function e(){var t,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.initSmartsheetSdkI18();case 2:return e.prev=2,e.next=5,Promise.resolve().then(n.bind(n,"../node_modules/@tencent/smartsheet-sdk/es/sheet-adapter/entry/mobile.js"));case 5:return t=e.sent,r=t.MobileSmartSheetSdkSheetAdapter,e.abrupt("return",new r);case 10:return e.prev=10,e.t0=e.catch(2),e.abrupt("return",Promise.reject());case 13:case"end":return e.stop()}}),e,this,[[2,10]])})))},o.injectUICenter=function(){return Qe((0,c.Z)(o),void 0,void 0,regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.e("spread-sheet_src_external_sheet-adapter_feature_ui-center_ts").then(n.bind(n,"../spread-sheet/src/external/sheet-adapter/feature/ui-center.ts"));case 2:t=e.sent.default,this.uiCenter=new t(this.app),this.injectModule(A.v7.UI_CENTER,this.uiCenter);case 5:case"end":return e.stop()}}),e,this)})))},o.searchCenter=new Ne(t),o.nativeCenter=new Fe(t),o}(0,h.Z)(t,e);var r=t.prototype;return r.injectModules=function(){var t=this;e.prototype.injectModules.call(this),this.injectModule(A.v7.SEARCH_CENTER,this.searchCenter),this.injectModule(A.v7.NATIVE_CENTER,this.nativeCenter),this.app.sheetAdapterManager.isWorkbenchReady?this.injectUICenter():u.ZP.default.one("sheet_workbench_ready",(function(){t.injectUICenter()}))},r.listenAfterInit=function(){var t,n,r=this;e.prototype.listenAfterInit.call(this);var o=null===(n=null===(t=this.app.view)||void 0===t?void 0:t.canvas)||void 0===n?void 0:n.orientationOperate;o?o.onScreenRotate(this.externalSheetSDK.handleScreenRotate):u.ZP.init.one("initOrientationOperateEnd",(function(){r.app.view.canvas.orientationOperate.onScreenRotate(r.externalSheetSDK.handleScreenRotate)}))},t}(me);Ye=Ge([ze(0,a.m),ze(1,l.pI),We("design:paramtypes",["function"===typeof(ae="undefined"!==typeof a.m&&a.m)?ae:Object,"function"===typeof(le="undefined"!==typeof d.RU&&d.RU)?le:Object])],Ye);var qe,Je,Ke=function(e,t,n,r){var o,s=arguments.length,i=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)i=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(i=(s<3?o(i):s>3?o(t,n,i):o(t,n))||i);return s>3&&i&&Object.defineProperty(t,n,i),i},Xe=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},$e=function(e,t){return function(n,r){t(n,r,e)}},et=function(e,t){var n=this;this.app=e,this.collaborationManager=t,this.adapterMap=new Map,this.init=function(){var e=new Ze(n.app,n.collaborationManager);n.adapterMap.set(i.ZP.SMART_SHEET,e),u.ZP.default.listen("sheet_workbench_ready",(function(){n.isWorkbenchReady=!0}))},this.getAdapterBySheetType=function(e){return n.adapterMap.get(e)},this.getAdapterBySheetId=function(e){var t=n.app.spreadsheet.sheetManager.getSheetBySheetId(e);if(t)return n.adapterMap.get(t.getSheetType())},this.getCurrentAdapter=function(){return n.adapterMap.get(n.app.spreadsheet.activeSheet.getSheetType())}},tt=et=Ke([$e(0,a.m),$e(1,l.pI),Xe("design:paramtypes",["function"===typeof(qe="undefined"!==typeof a.m&&a.m)?qe:Object,"function"===typeof(Je="undefined"!==typeof d.RU&&d.RU)?Je:Object])],et)},"../spread-sheet/src/external/tencentMeeting/api.ts":function(e,t,n){"use strict";n.r(t),n.d(t,{getPresentHost:function(){return c},sendPresentData:function(){return f},setPresentHost:function(){return h}}),n("../node_modules/regenerator-runtime/runtime.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.promise.js");var r,o=n("./node_modules/axios/index.js"),s=n.n(o),i=n("../spread-sheet/src/base/error/errorCodeModalProxy.ts"),a=n("../spread-sheet/src/external/tencentMeeting/utils.ts"),l=n("../spread-sheet/src/base/util/appConfig.ts"),d=function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function i(e){try{l(r.next(e))}catch(t){s(t)}}function a(e){try{l(r.throw(e))}catch(t){s(t)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,a)}l((r=r.apply(e,t||[])).next())}))};!function(e){e[e.PRESENTER_IS_EMPTY=64004]="PRESENTER_IS_EMPTY",e[e.DOS_HAS_USED=64e3]="DOS_HAS_USED",e[e.SUCCESS=0]="SUCCESS"}(r||(r={}));var u="https://"+l.Z.getConfig("runtime.domainName")+"/room-api/presentinfo";function c(e,t){return d(this,void 0,void 0,regeneratorRuntime.mark((function o(){var i,a,l,d,c,h,f;return regeneratorRuntime.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return o.prev=0,o.next=3,s().get(""+u,{params:{docid:e,presentid:t},headers:{"content-type":"application/json"}});case 3:if(i=o.sent,(a=i.data).retcode!==r.SUCCESS){o.next=11;break}return l=JSON.parse(a.result||"{}"),d=l.hostInfo,c=l.editPos,h=JSON.parse(c||"{}"),f={hostInfo:d,latestSyncData:h.syncData},o.abrupt("return",f);case 11:return g(a.retcode),n.g.log.error("服务端错误：",a),o.abrupt("return",{});case 16:o.prev=16,o.t0=o.catch(0),n.g.log.error("获取主讲人请求报错：",o.t0);case 19:case"end":return o.stop()}}),o,null,[[0,16]])})))}function h(e,t,o){return d(this,void 0,void 0,regeneratorRuntime.mark((function i(){var a,l;return regeneratorRuntime.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return i.prev=0,i.next=3,s().post(""+u,{docid:e,presentid:t,uid:o},{headers:{"content-type":"application/json"}});case 3:a=i.sent,(l=a.data).retcode!==r.SUCCESS&&(g(l.retcode),n.g.log.error("设置主讲人信息失败，错误码：",l.retcode,"错误信息：",l.retmsg)),i.next=11;break;case 8:i.prev=8,i.t0=i.catch(0),n.g.log.error("设置主讲人请求报错：",i.t0);case 11:case"end":return i.stop()}}),i,null,[[0,8]])})))}function f(e,t,r){var o={docid:(0,a.getDocId)(),bizid:e,biz_type:"meeting",syncData:t};n.g.log.info("主讲人同步信息sendData：",o),r.sendMessage({cmd:"PRESENT_INFO",taskId:0,data:JSON.stringify(o),onError:p})}function p(e,t,r,o){n.g.log.error("onSendPresentHostDataError",o)}function g(e){e!==r.PRESENTER_IS_EMPTY&&(e!==r.DOS_HAS_USED?i.Z.server.meetingErrorTips(e):i.Z.server.docOccupiedTips(e))}},"../spread-sheet/src/external/tencentMeeting/audience-state/following-state.ts":function(e,t,n){"use strict";n.d(t,{E:function(){return f}}),n("../node_modules/regenerator-runtime/runtime.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.promise.js");var r=n("../node_modules/lodash/once.js"),o=n.n(r),s=n("../spread-sheet/src/external/tencentMeeting/api.ts"),i=n("../spread-sheet/src/external/tencentMeeting/operation/operation-manager.ts"),a=n("../spread-sheet/src/external/tencentMeeting/utils.ts"),l=n("../spread-sheet/src/external/tencentMeeting/view/followPresenter.tsx"),d=n("../spread-sheet/src/external/tencentMeeting/audience-state/state-manager.ts"),u=n("../spread-sheet/src/external/tencentMeeting/audience-state/unfollowing-state.ts"),c=function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function i(e){try{l(r.next(e))}catch(t){s(t)}}function a(e){try{l(r.throw(e))}catch(t){s(t)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,a)}l((r=r.apply(e,t||[])).next())}))},h=o()(a.showTip),f=new(function(){function e(){var e=this;this.backToFollow=function(t,r){return c(e,void 0,void 0,regeneratorRuntime.mark((function e(){var o,i,u;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=(0,a.getDocId)(),e.next=3,(0,s.getPresentHost)(o,r);case 3:if(i=e.sent){e.next=6;break}return e.abrupt("return");case 6:if(u=i.latestSyncData){e.next=10;break}return n.g.log.error("角色是参会者，但是获得到的主讲人位置信息却为空，得到的 presentHostData 为：",i),e.abrupt("return");case 10:d.d.setState(f),d.d.getState().handleWithMesssage(t,u,r),(0,l.V)();case 14:case"end":return e.stop()}}),e)})))}}var t=e.prototype;return t.handleWithMesssage=function(e,t){i.$.getInstance(e).syncHostOperation(t)},t.handleWithAudienceOperation=function(e,t,n){var r=this;d.d.setState(u.Z),h(),(0,l.w)({presenterAvatarUrl:this.getHostPic(t),onClick:function(){return r.backToFollow(e,n)},hideDirection:!0,directionDegree:0})},t.getHostPic=function(e){return e.userInfo.userPic},e}())},"../spread-sheet/src/external/tencentMeeting/audience-state/state-manager.ts":function(e,t,n){"use strict";n.d(t,{d:function(){return o}});var r=n("../spread-sheet/src/external/tencentMeeting/audience-state/following-state.ts"),o=new(function(){function e(){this.currentState=r.E}var t=e.prototype;return t.setState=function(e){this.currentState=e},t.getState=function(){return this.currentState},e}())},"../spread-sheet/src/external/tencentMeeting/audience-state/unfollowing-state.ts":function(e,t,n){"use strict";n.d(t,{Z:function(){return c}}),n("../node_modules/core-js/modules/es.array.slice.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.function.name.js"),n("../node_modules/core-js/modules/es.array.from.js"),n("../node_modules/core-js/modules/es.string.iterator.js"),n("../node_modules/core-js/modules/es.symbol.js"),n("../node_modules/core-js/modules/es.symbol.description.js"),n("../node_modules/core-js/modules/es.symbol.iterator.js"),n("../node_modules/core-js/modules/es.array.iterator.js"),n("../node_modules/core-js/modules/web.dom-collections.iterator.js");var r=n("../spread-sheet/src/base/event/event.ts"),o=n("../spread-sheet/src/core/view/level-1/scroll-api/utils.ts"),s=n("../spread-sheet/src/external/tencentMeeting/operation/operation.interface.ts"),i=n("../spread-sheet/src/external/tencentMeeting/operation/operation-utils.ts"),a=n("../spread-sheet/src/external/tencentMeeting/operation/operation-manager.ts"),l=n("../spread-sheet/src/external/tencentMeeting/event/eventName.ts");function d(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){if(e){if("string"===typeof e)return u(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?u(e,t):void 0}}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0;return function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function u(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var c=new(function(){function e(){this.updateFollowButton=function(e,t){var n=e.spreadsheet.activeSheetId,a=t.operationType,d=t.sheetId,u=t.sheetType,c=t.selectionInfo,h=t.scrollOption;if(d&&n!==d||!c)r.ZP.tencentMeetingEvent.trigger(l.z.UPDATE_FOLLOW_BUTTON,{hideDirection:!0});else{var f=c.selection,p=e.view.canvas.areaData,g={row:p.row.flow.renderFrom,col:p.col.flow.renderFrom};if(a===s.C8.UPDATE_CURSOR)if(f&&(0,i.hG)(e,a,c,u)){var m=(0,o.Hg)({row:f.endRowIndex,col:f.endColIndex,padding:(0,i.tQ)(e,f)},p),v=(0,o.yE)({row:f.endRowIndex,col:f.endColIndex,padding:(0,i.tQ)(e,f)},p),I=(0,i.Pv)({diffPlace:{diffX:m,diffY:v}}),E={directionDegree:I,hideDirection:-1===I};r.ZP.tencentMeetingEvent.trigger(l.z.UPDATE_FOLLOW_BUTTON,E)}else r.ZP.tencentMeetingEvent.trigger(l.z.UPDATE_FOLLOW_BUTTON,{hideDirection:!0});else{var S=(0,i.Pv)({audiencePlace:g,hostPlace:h}),R={directionDegree:S,hideDirection:-1===S};r.ZP.tencentMeetingEvent.trigger(l.z.UPDATE_FOLLOW_BUTTON,R)}}}}var t=e.prototype;return t.handleWithMesssage=function(e,t){for(var n,r,o=d(a.$.getInstance(e).getOperationsInUnfollowing());!(r=o()).done;){var s=r.value;null===(n=s.syncHostOperation)||void 0===n||n.call(s,t)}this.updateFollowButton(e,t)},t.handleWithAudienceOperation=function(e,t){this.updateFollowButton(e,t)},e}())},"../spread-sheet/src/external/tencentMeeting/controller/tencent-meeting-controller.ts":function(e,t,n){"use strict";n.d(t,{p:function(){return O}}),n("../node_modules/regenerator-runtime/runtime.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.promise.js");var r,o,s,i=n("../node_modules/@tencent/docs-multi-tools/dist/user.js"),a=n("../spread-sheet/src/external/tencentMeeting/api.ts"),l=n("../spread-sheet/src/external/tencentMeeting/operation/operation.interface.ts"),d=(n("../node_modules/core-js/modules/es.object.assign.js"),n("./node_modules/axios/index.js")),u=n.n(d),c=n("../spread-sheet/src/external/tencentMeeting/utils.ts"),h=n("../packages/common-utils/src/index.ts");n("../spread-sheet/src/base/util/domain-config.ts"),function(e){e.PRODUCTION="production",e.PRERELEASE="prerelease",e.TEST="test"}(s||(s={}));var f,p=((r={})[s.PRODUCTION]="16272901304",r[s.PRERELEASE]="16310196082",r[s.TEST]="16282553643",r),g=((o={})[s.PRODUCTION]="1400115281",o[s.PRERELEASE]="1400212767",o[s.TEST]="200008554",o),m=(f=(0,h.ej)("env_name")||"",/testWemeet/.test(f)?s.TEST:/prereleaseWemeet/.test(f)?s.PRERELEASE:s.PRODUCTION),v=p[m],I=g[m],E=function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function i(e){try{l(r.next(e))}catch(t){s(t)}}function a(e){try{l(r.throw(e))}catch(t){s(t)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,a)}l((r=r.apply(e,t||[])).next())}))},S=!1,R=function(e){return E(void 0,void 0,void 0,regeneratorRuntime.mark((function t(){var n,r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,u().get("/cooperation/v1/meeting/jssdk-sign",{params:e});case 2:if(n=t.sent,0===(r=n.data).ret){t.next=6;break}throw new Error(r.msg);case 6:return t.abrupt("return",r);case 7:case"end":return t.stop()}}),t)})))},w=n("../spread-sheet/src/base/event/event.ts"),A=n("../spread-sheet/src/core/view/spreadsheet-view/area-data/AreaData.interface.ts"),C=n("../spread-sheet/src/external/tencentMeeting/audience-state/state-manager.ts"),y=n("../spread-sheet/src/external/tencentMeeting/operation/operation-manager.ts"),_=function(){function e(e,t){var n=this;this.app=e,this.presentId=t,this.handleWithAudienceOperation=function(e){e!==A.oz.API&&(0,c.isPageFished)(n.app)&&C.d.getState().handleWithAudienceOperation(n.app,n.hostOperationInfo,n.presentId)},this.operationManager=y.$.getInstance(this.app)}var t=e.prototype;return t.init=function(e){this.operationManager.initAudienceOperationListener(this.handleWithAudienceOperation),this.initMessageListener(),e&&(this.hostOperationInfo=e,this.followHostOperationAfterPageFinished(e))},t.followHostOperationAfterPageFinished=function(e){var t=this,n=C.d.getState();(0,c.isPageFished)(this.app)?n.handleWithMesssage(this.app,e,this.presentId):this.app.emitter.once(this.app.EVENT.PAGE_LOAD_FINISHED,(function(){return t.followHostOperationAfterPageFinished(e)}))},t.initMessageListener=function(){var e=this;w.ZP.network.listen("presentData",(function(t,n){e.presentId===n&&(e.hostOperationInfo=t,C.d.getState().handleWithMesssage(e.app,t,e.presentId))}))},e}(),T=n("../node_modules/lodash/debounce.js"),x=n.n(T),b=function(){function e(e,t){var n=this;this.app=e,this.presentId=t,this.debouncedSendPresentData=x()(a.sendPresentData,300),this.getAndSendHostOperation=function(e){var t=n.operationManager.getHostOperationsInfo(e);n.debouncedSendPresentData(n.presentId,t,n.app.messageCenter)},this.operationManager=y.$.getInstance(this.app)}return e.prototype.init=function(){this.operationManager.initHostOperationListener(this.getAndSendHostOperation),this.getAndSendHostOperation()},e}(),D=function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function i(e){try{l(r.next(e))}catch(t){s(t)}}function a(e){try{l(r.throw(e))}catch(t){s(t)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,a)}l((r=r.apply(e,t||[])).next())}))},O=function(){function e(e){this.app=e,this.initConfig(),this.role=(0,c.getRoleFromUrl)(),this.uid=(0,i.getUid)(),this.docId=(0,c.getDocId)()}e.getInstance=function(t){return this.instance||(this.instance=new e(t)),this.instance};var t=e.prototype;return t.init=function(){return D(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.initPresentHostData();case 2:this.initController(),(0,c.checkAndShowPrivateFilterTip)(this.app.spreadsheet);case 4:case"end":return e.stop()}}),e,this)})))},t.isHost=function(){return this.role===l.uU.HOST},t.isAudience=function(){return this.role===l.uU.AUDIENCE},t.getRole=function(){return this.role},t.getPresentId=function(){return this.presentId},t.initPresentHostData=function(){return D(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t,n,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,c.getPresentId)();case 2:return this.presentId=e.sent,e.next=5,(0,a.getPresentHost)(this.docId,this.presentId);case 5:if(t=e.sent){e.next=8;break}return e.abrupt("return");case 8:n=t.hostInfo,r=t.latestSyncData,this.role!==l.uU.HOST||n?this.role=(null===n||void 0===n?void 0:n.uid)===this.uid?l.uU.HOST:l.uU.AUDIENCE:(0,a.setPresentHost)(this.docId,this.presentId,this.uid),this.latestSyncData=r;case 11:case"end":return e.stop()}}),e,this)})))},t.initController=function(){this.role===l.uU.HOST?(this.hostController=new b(this.app,this.presentId),this.hostController.init()):(this.audienceController=new _(this.app,this.presentId),this.audienceController.init(this.latestSyncData))},t.initConfig=function(){return D(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(0,c.stopTencentMeetingLoading)(),e.next=3,E(void 0,void 0,void 0,regeneratorRuntime.mark((function e(){var t,r,o,s,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!S){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,(0,c.getTencentMeetingSDK)();case 4:return t=e.sent,e.next=7,t.permission.checkJsApiConfig().catch((function(e){var t;throw null===(t=n.g.log)||void 0===t||t.error("检查授权状态失败："+(null===e||void 0===e?void 0:e.message)),new Error("检查授权状态失败："+(null===e||void 0===e?void 0:e.message))}));case 7:if(e.sent.configState!==t.JsApiConfigState.DONE){e.next=12;break}return S=!0,e.abrupt("return");case 12:return e.next=14,t.permission.requestAgentAuthCode({sdkId:v}).catch((function(e){var t;throw null===(t=n.g.log)||void 0===t||t.error("获取授权码失败："+(null===e||void 0===e?void 0:e.message)),new Error("获取授权码失败："+(null===e||void 0===e?void 0:e.message))}));case 14:return r=e.sent,o=r.authCode,e.next=18,R({code:o,url:n.g.location.href}).catch((function(e){var t;throw null===(t=n.g.log)||void 0===t||t.error("获取 sdk 初始化参数失败："+e.message),new Error("获取 sdk 初始化参数失败："+e.message)}));case 18:return s=e.sent,i=s.data,e.next=22,t.permission.agentConfig(Object.assign({corpId:I,sdkId:v},i)).catch((function(e){var t;throw null===(t=n.g.log)||void 0===t||t.error("agentConfig 失败："+e.message),new Error("agentConfig 失败："+e.message)}));case 22:S=!0;case 23:case"end":return e.stop()}}),e)})));case 3:(0,c.setDocCanEditInTencentMeeting)(this.app.sheetStatus.canEdit),(0,c.setDocViewDirectionInTencentMeeting)();case 5:case"end":return e.stop()}}),e,this)})))},e}()},"../spread-sheet/src/external/tencentMeeting/event/eventName.ts":function(e,t,n){"use strict";var r;n.d(t,{z:function(){return r}}),function(e){e.UPDATE_FOLLOW_BUTTON="update_follow_button",e.SHAPE_PREVIEW_SHOW="shape_preview_show",e.SHAPE_PREVIEW_HIDE="shape_preview_hide",e.SHAPE_PREVIEW_UPDATE="shape_preview_update",e.CARD_SHOW="card_show",e.CARD_HIDE="card_hide",e.FOLLOW_HOST_OPERATION_END="follow_host_operation_end"}(r||(r={}))},"../spread-sheet/src/external/tencentMeeting/operation/operation-manager.ts":function(e,t,n){"use strict";n.d(t,{$:function(){return L}});var r=n("../node_modules/@babel/runtime/helpers/esm/toConsumableArray.js"),o=(n("../node_modules/core-js/modules/es.array.concat.js"),n("../node_modules/core-js/modules/es.object.assign.js"),n("../node_modules/core-js/modules/es.array.slice.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.function.name.js"),n("../node_modules/core-js/modules/es.array.from.js"),n("../node_modules/core-js/modules/es.string.iterator.js"),n("../node_modules/core-js/modules/es.symbol.js"),n("../node_modules/core-js/modules/es.symbol.description.js"),n("../node_modules/core-js/modules/es.symbol.iterator.js"),n("../node_modules/core-js/modules/es.array.iterator.js"),n("../node_modules/core-js/modules/web.dom-collections.iterator.js"),n("../node_modules/@tencent/docs-user-agent/dist/index.js")),s=n.n(o),i=n("../spread-sheet/src/base/index.ts"),a=n("../spread-sheet/src/core/data/configService/spreadConfig.ts"),l=n("../spread-sheet/src/external/tencentMeeting/event/eventName.ts"),d=n("../spread-sheet/src/base/event/event.ts"),u=n("../spread-sheet/src/core/view/level-2/comment-center/mobile/utils.ts"),c=n("../spread-sheet/src/core/view/spreadsheet-view/area-data/AreaData.interface.ts"),h=n("../spread-sheet/src/external/tencentMeeting/operation/operation.interface.ts");function f(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){if(e){if("string"===typeof e)return p(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?p(e,t):void 0}}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0;return function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function p(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var g=[l.z.CARD_SHOW,l.z.CARD_HIDE],m=function(){function e(e){var t=this;this.app=e,this.operationType=h.C8.CARD,this.onCardFinish=function(){L.getInstance(t.app).syncNextOperation()},this.updateCardInfo=function(e,n){var r=e.cardType,o=e.cardOperationType,s=e.cardPosition;t.cardInfo={cardType:r,cardOperationType:o,cardPosition:s},n(t.operationType)}}var t=e.prototype;return t.initHostOperationListener=function(e){for(var t,n=this,r=f(g);!(t=r()).done;){var o=t.value;d.ZP.tencentMeetingEvent.listen(o,(function(t){return n.updateCardInfo(t,e)}))}},t.getHostOperationInfo=function(){return{cardInfo:Object.assign({},this.cardInfo)}},t.initAudienceOperationListener=function(e){for(var t,n=f(g);!(t=n()).done;){var r=t.value;d.ZP.tencentMeetingEvent.listen(r,(function(t){var n=t.source,r=void 0===n?c.oz.API:n;e(r)}))}},t.syncHostOperation=function(e){var t=this,r=e.cardInfo,o=this.app.view.canvas.commentCenter;if(!r||!r.cardOperationType||r.cardOperationType===h.UQ.COMMENT_CARD_HIDE)return o.hideComment(c.oz.API),void this.onCardFinish();this.updateSelection(e),(0,u.vV)(n.g.SpreadsheetApp)?this.openComment(r):this.app.mutationBehavior.emitter.addListener(this.app.mutationBehavior.EVENT.AFTER_MUTATION_RUN,(function(){return t.openComment(r)})),this.onCardFinish()},t.openComment=function(e){var t=e.cardType,n=e.cardOperationType,r=e.cardPosition,o=this.app.view.canvas.commentCenter;t===h.eT.COMMENT&&n===h.UQ.COMMENT_CARD_SHOW&&(s().isMobile?o.openCommentPanel(c.oz.API):r&&o.openComment(r.row,r.col,c.oz.API))},t.updateSelection=function(e){var t=e.selectRange,n=e.sheetId,r=this.app.view.getSheetLocation();r.xRange=t.xRange,r.yRange=t.yRange,this.app.view.saveSelectionCache(n,r),this.app.view.setSelection(n),this.app.view.reportLocation()},e}(),v=n("../node_modules/@babel/runtime/helpers/esm/inheritsLoose.js"),I=n("../packages/model/src/range/index.ts"),E=n("../spread-sheet/src/external/tencentMeeting/operation/operation-utils.ts"),S=n("../spread-sheet/src/external/tencentMeeting/operation/cursor-operation/cursor-operation-base.ts"),R=function(e){function t(){var t;return(t=e.apply(this,arguments)||this).setCurInfo=function(e,n){var r=t.app.view.canvas.collabAreaCursorRenderPlugin;null===r||void 0===r||r.setRange(e),null===r||void 0===r||r.setUserInfo(n)},t}return(0,v.Z)(t,e),t.prototype.syncHostOperation=function(e){var t=e.sheetType,n=e.selectionInfo,r=e.userInfo;if(!(0,E.Lp)(this.app,t)&&n){var o=n.selection;if(o){var s=new I.GridRange(Object.assign({},o));this.setCurInfo(s,r)}else this.setCurInfo(void 0,r)}},t}(S.Z),w=n("../spread-sheet/src/core/view/level-1/scroll-api/ScrollApi.interface.ts"),A=function(e){function t(){var t;return(t=e.apply(this,arguments)||this).setCurInfo=function(e,n){var r=t.app.view.canvas.collabAreaCursorRenderPlugin;null===r||void 0===r||r.setRange(e),null===r||void 0===r||r.setUserInfo(n),L.getInstance(t.app).syncNextOperation()},t.scrollToCursor=function(e,n){var r=e.sheetId,o=e.endRowIndex,s=e.endColIndex,i=t.app.spreadsheet.activeSheetId;if(r&&i===r){var a=t.app.view.canvas.scrollApi,l=(0,E.tQ)(t.app,e);a.scrollToVisible({row:o,col:s,padding:l},!1,{type:w.ru.LINE,onAnimationEnd:n},c.oz.API)}},t}return(0,v.Z)(t,e),t.prototype.syncHostOperation=function(e){var t=this,n=e.operationType,r=e.sheetType,o=e.selectionInfo,s=e.userInfo;if(o){var i=o.selection;if(i){var a=new I.GridRange(Object.assign({},i));(0,E.hG)(this.app,n,o,r)?this.scrollToCursor(a,(function(){return t.setCurInfo(a,s)})):this.setCurInfo(a,s)}else this.setCurInfo(void 0,s)}else this.setCurInfo(void 0,s)},t}(S.Z),C=n("../spread-sheet/src/external/tencentMeeting/utils.ts"),y=function(){function e(e){var t=this;this.app=e,this.handleMutationBehavior=function(e,n){e.isLocal&&!e.isReplay&&!e.isCollab&&!e.isFromFormula&&(0,C.isPageFished)(t.app)&&n()}}return e.prototype.initAudienceOperationListener=function(e){var t=this;this.app.mutationBehavior.emitter.addListener(this.app.mutationBehavior.EVENT.AFTER_MUTATION_RUN,(function(n){return t.handleMutationBehavior(n,e)}))},e}(),_=(n("../node_modules/core-js/modules/es.number.constructor.js"),n("../node_modules/core-js/modules/es.number.to-fixed.js"),function(){function e(e){var t=this;this.app=e,this.operationType=h.C8.UPDATE_SCALE,this.onScaleFinish=function(){L.getInstance(t.app).syncNextOperation()},this.getScaleInfo=function(e){return{scale:t.app.view.canvas.scale.scale,addMethod:e}}}var t=e.prototype;return t.initHostOperationListener=function(e){var t=this;i.Z.event.sheetsBar.listen("scaleSelect",(function(){t.addMethod=h.M2.CHECK_ITEM,e(t.operationType)})),i.Z.event.sheetsBar.listen("scaleButtonClick",(function(){t.addMethod=h.M2.PROGREDDIVELY,e(t.operationType)}))},t.getHostOperationInfo=function(){return{scaleInfo:this.getScaleInfo(this.addMethod)}},t.initAudienceOperationListener=function(e){i.Z.event.sheetsBar.listen("scaleSelect",(function(t,n){return e(n)})),i.Z.event.sheetsBar.listen("scaleButtonClick",(function(t,n){return e(n)}))},t.syncHostOperation=function(e){var t=e.scaleInfo,n=e.platform,r=e.sheetType;if(!(0,E.Lp)(this.app,r)&&t){var o=t.scale,a=t.addMethod,l=this.app.view.canvas.scale.scale;if(s().isPC&&n===h.uF.PC&&o&&o!==l){var d=Number((100*(o-l)).toFixed(2));i.Z.event.sheetsBar.trigger("changeScale",d,c.oz.API,a)}this.onScaleFinish()}else this.onScaleFinish()},e}()),T=n("../spread-sheet/src/core/data/converter/tencentdoc/utils/files.ts");function x(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){if(e){if("string"===typeof e)return b(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?b(e,t):void 0}}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0;return function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function b(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var D=function(){function e(e){var t=this;this.app=e,this.operationType=h.C8.SHAPE_PREVIEW,this.onPreviewFinish=function(){L.getInstance(t.app).syncNextOperation()},this.updateShapeInfo=function(e,n,r){var o=e.type,s=e.shapeId,i=e.shapePosition;t.shapeInfo={shapeOperationType:r,shapeType:o,shapeId:s,shapePosition:i},n(t.operationType)},this.eventInfos=[{operationType:h.DU.SHAPE_SHOW,eventName:l.z.SHAPE_PREVIEW_SHOW},{operationType:h.DU.SHAPE_UPDATE,eventName:l.z.SHAPE_PREVIEW_UPDATE},{operationType:h.DU.SHAPE_HIDE,eventName:l.z.SHAPE_PREVIEW_HIDE}]}var t=e.prototype;return t.initHostOperationListener=function(e){for(var t,n=this,r=function(){var r=t.value;d.ZP.tencentMeetingEvent.listen(r.eventName,(function(t){return n.updateShapeInfo(t,e,r.operationType)}))},o=x(this.eventInfos);!(t=o()).done;)r()},t.getHostOperationInfo=function(){return{shapePreviewInfo:Object.assign({},this.shapeInfo)}},t.initAudienceOperationListener=function(e){for(var t,n=x(this.eventInfos);!(t=n()).done;){var r=t.value;d.ZP.tencentMeetingEvent.listen(r.eventName,(function(t){var n=t.source,r=void 0===n?c.oz.API:n;e(r)}))}},t.syncHostOperation=function(e){var t=e.shapePreviewInfo,n=this.app.view.canvas.shapeEdit;if(!t||!t.shapeOperationType||t.shapeOperationType===h.DU.SHAPE_HIDE)return null===n||void 0===n||n.shapeZoom.hide(),void this.onPreviewFinish();var r=t.shapeType,o=t.shapeId,s=t.shapePosition,i=t.shapeOperationType,a=r===T.XE.ATTACHED_IMAGE?o:s,l=i===h.DU.SHAPE_UPDATE||i===h.DU.SHAPE_SHOW;a&&l&&(this.onPreviewFinish(),null===n||void 0===n||n.shapeZoom.update(a))},e}(),O=(n("../node_modules/core-js/modules/es.array.includes.js"),n("../node_modules/core-js/modules/es.string.includes.js"),function(){function e(e){var t=this;this.app=e,this.getScrollOption=function(){var e=t.app.view.canvas.areaData;return{row:e.row.flow.renderFrom,col:e.col.flow.renderFrom}},this.doSetOffsetSize=function(e){var n=e.sheetId,r=e.selectRange,o=e.platform,i=e.scrollOption;if((0,E.fj)(t.app,e)){t.app.view.saveSelectionCache(n,r);var a=t.app.view.getSheetLocation();[h.uF.PC,h.uF.IPAD].includes(o)&&(s().isPC||s().isIPad)||!i?r&&t.doScrollFlow(r.row.flow,r.col.flow,a):t.doScrollFlowRenderFrom(i.row,i.col)}else t.onScrollFinish()},this.doScrollFlow=function(e,n,r){var o=t.app.view.canvas.scrollApi,s=n-r.col.flow,i=e-r.row.flow;o.scrollByPixel({areaX:"flow",diffX:s,areaY:"flow",diffY:i},!1,{type:w.ru.LINE,onAnimationEnd:t.onScrollFinish},c.oz.API)},this.doScrollFlowRenderFrom=function(e,n){t.app.view.canvas.scrollApi.scrollToRenderFrom({row:e,col:n},!1,{type:w.ru.LINE,onAnimationEnd:t.onScrollFinish},c.oz.API)},this.onScrollFinish=function(){t.app.view.canvas.renderApi.renderNextTick(),L.getInstance(t.app).syncNextOperation()}}var t=e.prototype;return t.initHostOperationListener=function(e){i.Z.event.sheetsBar.listen("switchSheet",(function(){return e(h.C8.SWITCH_SHEET)})),i.Z.event.sheetsBar.listen("switchActiveSheetEnd",(function(){return e(h.C8.SWITCH_SHEET)})),this.app.view.canvas.areaData.onUpdateOffset((function(){return e(h.C8.UPDATE_OFFSET)}))},t.getHostOperationInfo=function(){return{scrollOption:this.getScrollOption()}},t.initAudienceOperationListener=function(e){i.Z.event.sheetsBar.listen("switchSheet",(function(t,n,r){var o=(r||{source:c.oz.API}).source;e(o)})),this.app.view.canvas.areaData.onUpdateOffset((function(t){var n=(t||{source:c.oz.API}).source;e(n)}))},t.syncHostOperation=function(e){var t=this,n=this.app.spreadsheet.activeSheetId,r=e.sheetId;r&&n!==r?(i.Z.event.sheetsBar.one("switchSheetEnd",(function(){return t.doSetOffsetSize(e)})),i.Z.event.sheetsBar.trigger("switchSheet",r,n,{source:c.oz.API})):this.doSetOffsetSize(e)},e}());function M(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){if(e){if("string"===typeof e)return j(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?j(e,t):void 0}}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0;return function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function j(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var L=function(){function e(e){var t=this;this.getPlatform=function(){var e=h.uF.MOBILE;return s().isPC?e=h.uF.PC:s().isIPad&&(e=h.uF.IPAD),e},this.getUserInfo=function(){var e,n=t.app.view,r=a.q.getConfig("userName"),o=!!(null===(e=n.canvas.inputManager)||void 0===e?void 0:e.isInputtingState()),s=a.q.getConfig("userPic");return{userName:String(r),userPic:s,isEditing:o}},this.app=e,this.operationsInFollowing=[new O(this.app),new _(this.app),new A(this.app),new D(this.app),new m(this.app)],this.operationsToMonitored=[].concat((0,r.Z)(this.operationsInFollowing),[new y(this.app)]),this.operationsInUnfollowing=[new R(this.app)]}e.getInstance=function(t){return this.instance||(this.instance=new e(t)),this.instance};var t=e.prototype;return t.getOperationsInUnfollowing=function(){return this.operationsInUnfollowing},t.getHostOperationsInfo=function(e){var t=Object.assign(Object.assign({},this.getDefaultOperationInfo()),{operationType:e});return this.operationsInFollowing.reduce((function(e,t){var n,r=null===(n=t.getHostOperationInfo)||void 0===n?void 0:n.call(t);return Object.assign(Object.assign({},e),r)}),t)},t.syncHostOperation=function(e){var t;if(this.hostOperationInfo=e,this.hostOperationInfo){this.currentOperationIndex=0;var n=this.operationsInFollowing[0];null===(t=n.syncHostOperation)||void 0===t||t.call(n,this.hostOperationInfo)}},t.syncNextOperation=function(){var e;this.currentOperationIndex+=1;var t=this.operationsInFollowing.length;if(this.currentOperationIndex<t&&this.hostOperationInfo){var n=this.operationsInFollowing[this.currentOperationIndex];null===(e=n.syncHostOperation)||void 0===e||e.call(n,this.hostOperationInfo)}else this.currentOperationIndex>=t&&i.Z.event.tencentMeetingEvent.trigger(l.z.FOLLOW_HOST_OPERATION_END)},t.initAudienceOperationListener=function(e){for(var t,n,r=M(this.operationsToMonitored);!(n=r()).done;){var o=n.value;null===(t=o.initAudienceOperationListener)||void 0===t||t.call(o,e)}},t.initHostOperationListener=function(e){for(var t,n,r=M(this.operationsToMonitored);!(n=r()).done;){var o=n.value;null===(t=o.initHostOperationListener)||void 0===t||t.call(o,e)}},t.getDefaultOperationInfo=function(){var e=this.app.spreadsheet.activeSheetId,t=this.app.spreadsheet.sheetManager.getSheetBySheetId(e),n=null===t||void 0===t?void 0:t.getSheetType();return{platform:this.getPlatform(),sheetId:e,sheetType:n,userInfo:this.getUserInfo(),selectRange:this.app.view.getSheetLocation()}},e}()},"../spread-sheet/src/external/tencentMeeting/operation/operation-utils.ts":function(e,t,n){"use strict";n.d(t,{Lp:function(){return h},Pv:function(){return f},fj:function(){return u},hG:function(){return d},tQ:function(){return c}});var r=n("../node_modules/@tencent/docs-user-agent/dist/index.js"),o=n.n(r),s=n("../spread-sheet/src/core/view/spreadsheet-view/utils.ts"),i=n("../spread-sheet/src/core/view/level-2/collab-cursor/cell/CollabCell.ts"),a=n("../spread-sheet/src/external/tencentMeeting/operation/operation.interface.ts"),l="smartsheet";function d(e,t,n,r){if(!n||t!==a.C8.UPDATE_CURSOR)return!1;var o=n.selection,s=n.baseSelection;if(!o)return!1;var i=!0;if(s){var l=s.isSelectAll,d=s.isSelectCol,u=s.isSelectRow;i=Boolean(l||d||u)}return!function(e,t){if(!t)return!0;var n=e.view.canvas.areaData,r=t.startColIndex,o=t.endColIndex,s=t.startRowIndex,i=t.endRowIndex,a=n.row.flow.viewSize-150,l=n.col.flow.viewSize,d=n.row.frozen.viewSize,u=n.col.frozen.viewSize,c=n.getViewLeftByCol(r)-u,h=n.getViewTopByRow(s)-d;if(c<0||h<0)return!1;var f=n.getViewRightByCol(o),p=n.getViewBottomByRow(i);return!(l<f||a<p)}(e,o)&&!i&&!h(e,r)}function u(e,t){var n=t.operationType,r=t.selectionInfo,s=t.sheetType;if(!r)return!1;var i=r.baseSelection,l=!0;if(i){var d=i.isSelectAll,u=i.isSelectCol,c=i.isSelectRow;l=Boolean(d||u||c)}return(n!==a.C8.UPDATE_CURSOR||l)&&!function(e){var t=e.cardInfo;return t&&t.cardType===a.eT.COMMENT&&t.cardOperationType===a.UQ.COMMENT_CARD_SHOW&&o().isMobile}(t)&&!h(e,s)}function c(e,t){var n=e.view.canvas,r=n.tableView,o=n.areaData,a=n.rowcolAccessor,l=t.endRowIndex,d=t.endColIndex,u=r.getCellViewAtPosition(l,d),c=(0,s.E)(a,u,l),h=(0,s.o)(a,u,d),f=o.row.flow.viewSize,p=o.col.flow.viewSize,g=o.row.frozen.viewSize,m=o.col.frozen.viewSize,v=function(e,t){var n=e.view.canvas,r=n.areaData,o=n.tableView,i=n.rowcolAccessor,a=t.startColIndex,l=t.endColIndex,d=t.startRowIndex,u=t.endRowIndex,c=o.getCellViewAtPosition(u,l),h=(0,s.E)(i,c,u),f=(0,s.o)(i,c,l),p=r.getAreaLeftByCol(l)-r.getAreaLeftByCol(a)+f;return{height:r.getAreaTopByRow(u)-r.getAreaTopByRow(d)+h,width:p}}(e,t),I=v.height,E=v.width;return{top:Math.min(f-c-g-150,I)+i.Z.cardHeight,left:Math.min(p-h-m-25,E),bottom:150,right:25}}function h(e,t){var n=e.spreadsheet.activeSheetId,r=e.spreadsheet.sheetManager.getSheetBySheetId(n),o=null===r||void 0===r?void 0:r.getSheetType();return String(o)===l||t===l}function f(e){var t,n=e.audiencePlace,r=e.hostPlace,o=e.diffPlace,s=0,i=0;if(o)i=o.diffY,s=o.diffX;else if(n&&r){var a=n.row,l=n.col;i=r.row-a,s=r.col-l}return t=0===s&&0===i?-1:0===s?i>0?180:0:0===i?s>0?90:270:function(e){var t=e.diffCol,n=e.diffRow,r=180*Math.atan(Math.abs(t/n))/Math.PI;return r=n>0?180+r*(t<0?1:-1):360+r*(t>0?1:-1),r%=360}({diffRow:i,diffCol:s}),t}},"../spread-sheet/src/external/tencentMeeting/operation/operation.interface.ts":function(e,t,n){"use strict";var r,o,s,i,a,l,d;n.d(t,{C8:function(){return o},DU:function(){return i},M2:function(){return s},UQ:function(){return l},eT:function(){return a},uF:function(){return d},uU:function(){return r}}),function(e){e.HOST="HOST",e.AUDIENCE="AUDIENCE"}(r||(r={})),function(e){e.UPDATE_OFFSET="update_offset",e.SWITCH_SHEET="switch_sheet",e.UPDATE_SCALE="update_scale",e.SHAPE_PREVIEW="shape_preview",e.UPDATE_CURSOR="update_cursor",e.CARD="card"}(o||(o={})),function(e){e.CHECK_ITEM="checkItem",e.PROGREDDIVELY="progressively"}(s||(s={})),function(e){e.SHAPE_HIDE="shape_hide",e.SHAPE_SHOW="shape_show",e.SHAPE_UPDATE="shape_update"}(i||(i={})),function(e){e.COMMENT="comment"}(a||(a={})),function(e){e.COMMENT_CARD_HIDE="comment_card_hide",e.COMMENT_CARD_SHOW="comment_card_show"}(l||(l={})),function(e){e.PC="pc",e.MOBILE="mobile",e.IPAD="iPad"}(d||(d={}))},"../spread-sheet/src/external/tencentMeeting/report.ts":function(e,t,n){"use strict";n.d(t,{G:function(){return a}});var r=n("../node_modules/@tencent/docs-user-agent/dist/index.js"),o=n.n(r),s=n("../packages/report/src/index.ts"),i=n("../packages/common-utils/src/index.ts");function a(){if(o().isTencentMeeting){var e=(0,i.IZ)("meet_from");e&&s.ZP.tdwReport({opername:"doc_meet_web",module:"share_in_meet",action:"begin_presentation",file_type:2,ver10:e})}}},"../spread-sheet/src/external/tencentMeeting/utils.ts":function(e,t,n){"use strict";n.r(t),n.d(t,{checkAndShowPrivateFilterTip:function(){return E},getDocId:function(){return f},getPresentId:function(){return p},getRoleFromUrl:function(){return h},getTencentMeetingSDK:function(){return A},isFromTencentMeetingSharing:function(){return v},isPageFished:function(){return m},setDocCanEditInTencentMeeting:function(){return S},setDocViewDirectionInTencentMeeting:function(){return R},showTip:function(){return I},stopTencentMeetingLoading:function(){return g}}),n("../node_modules/regenerator-runtime/runtime.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.promise.js"),n("../node_modules/core-js/modules/es.regexp.exec.js"),n("../node_modules/core-js/modules/es.string.search.js"),n("../node_modules/core-js/modules/es.array.iterator.js"),n("../node_modules/core-js/modules/es.string.iterator.js"),n("../node_modules/core-js/modules/web.dom-collections.iterator.js"),n("../node_modules/core-js/modules/web.url-search-params.js");var r=n("../node_modules/i18next/dist/esm/i18next.js"),o=n("../node_modules/lodash/once.js"),s=n.n(o),i=n("../node_modules/@tencent/dui/lib/components/Snackbar/index.js"),a=(n("../node_modules/@tencent/dui-mobile/lib/components/Snackbar/index.js"),n("../packages/utils/src/client.ts")),l=n("../spread-sheet/src/core/data/configService/spreadConfig.ts"),d=n("../spread-sheet/src/external/tencentMeeting/operation/operation.interface.ts"),u=function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function i(e){try{l(r.next(e))}catch(t){s(t)}}function a(e){try{l(r.throw(e))}catch(t){s(t)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,a)}l((r=r.apply(e,t||[])).next())}))},c=i.default;function h(){var e=n.g.location.search.substring(1);return"speaker"===new URLSearchParams(e).get("login")?d.uU.HOST:d.uU.AUDIENCE}function f(){return l.q.getConfig("globalPadId")}function p(){var e;return u(this,void 0,void 0,regeneratorRuntime.mark((function t(){var r,o,s;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,A();case 2:return r=t.sent,o=r.data,t.prev=4,t.next=7,o.getCurrMeetingInfo();case 7:return s=t.sent,t.abrupt("return",null!==(e=s.meetingId)&&void 0!==e?e:C());case 11:return t.prev=11,t.t0=t.catch(4),n.g.log.error("获取会议信息失败:",t.t0),n.g.log.info("使用路由的方式获取会议 id"),t.abrupt("return",C());case 16:case"end":return t.stop()}}),t,null,[[4,11]])})))}function g(){return u(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,A();case 2:return t=e.sent,r=t.ui,e.prev=4,e.next=7,r.closeLoading();case 7:e.next=12;break;case 9:e.prev=9,e.t0=e.catch(4),n.g.log.error("关闭会议客户端 Loading 失败:",e.t0);case 12:case"end":return e.stop()}}),e,null,[[4,9]])})))}function m(e){return e.lifeCycle===e.EVENT.PAGE_LOAD_FINISHED}function v(){var e="tencent_meeting"===(0,a.i)(),t="true"===localStorage.getItem("meetingDev");return e||t}function I(){c.show({message:r.ZP.t("你可以自由浏览此文档。"),type:"success",duration:3e3})}function E(e){if(v()){var t=e.activeSheet.getBasicFilter();if(t){var n=t.getIsLocalView();(n||!n&&!e.isFilterSync)&&w()}}}function S(e){return u(this,void 0,void 0,regeneratorRuntime.mark((function t(){var r,o;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,A();case 2:return r=t.sent,o=r.appShare,t.prev=4,t.next=7,o.setDocEditState({state:e});case 7:t.next=12;break;case 9:t.prev=9,t.t0=t.catch(4),n.g.log.error("通知会议文档编辑权限失败:",t.t0);case 12:case"end":return t.stop()}}),t,null,[[4,9]])})))}function R(){return u(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t,r,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,A();case 2:return t=e.sent,r=t.appShare,o=t.DocViewDirectionType,e.prev=4,e.next=7,r.setDocViewDirection({direction:o.LANDSCAPE});case 7:e.next=12;break;case 9:e.prev=9,e.t0=e.catch(4),n.g.log.error("通知会议文档最佳展示方向失败:",e.t0);case 12:case"end":return e.stop()}}),e,null,[[4,9]])})))}var w=s()((function(){c.show({message:r.ZP.t("CURRENT_FILTER_VIEW_NOT_SUPPORT_FOLLOWING"),id:"filter-sync-close-tip",type:"info",autoClose:!1,action:r.ZP.t("关闭")})}));function A(){return u(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.e("bundle_tencent-meeting-js-sdk").then(n.t.bind(n,"../node_modules/@tencent/wemeet-js-sdk/build/index.js",23));case 2:return t=e.sent,e.abrupt("return",t);case 4:case"end":return e.stop()}}),e)})))}function C(){var e,t=n.g.location.search.substring(1);return null!==(e=new URLSearchParams(t).get("editingPresentId"))&&void 0!==e?e:""}},"../spread-sheet/src/external/tencentMeeting/view/followPresenter.tsx":function(e,t,n){"use strict";n.d(t,{V:function(){return R},w:function(){return S}});var r=n("../node_modules/@babel/runtime/helpers/esm/inheritsLoose.js"),o=(n("../node_modules/core-js/modules/es.symbol.js"),n("../node_modules/core-js/modules/es.object.assign.js"),n("react")),s=n.n(o),i=n("react-dom"),a=n.n(i),l=n("../node_modules/i18next/dist/esm/i18next.js"),d=n("../node_modules/@tencent/docs-user-agent/dist/index.js"),u=n.n(d),c=n("../node_modules/@tencent/docs-scenario-components-suspend-button/dist/index.js"),h=n("../spread-sheet/src/external/tencentMeeting/event/eventName.ts"),f=n("../spread-sheet/src/base/event/event.ts"),p=n("../spread-sheet/src/external/tencentMeeting/audience-state/following-state.ts"),g=n("../spread-sheet/src/external/tencentMeeting/controller/tencent-meeting-controller.ts"),m=n("../spread-sheet/src/external/tencentMeeting/audience-state/state-manager.ts"),v=n("../spread-sheet/src/external/tencentMeeting/audience-state/unfollowing-state.ts"),I=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(n[r[o]]=e[r[o]])}return n},E="follow-button-container";function S(e){var t=document.getElementById(E);t||(t=document.createElement("div"),document.body.appendChild(t),t.id=E,m.d.setState(v.Z),a().render(s().createElement(w,Object.assign({},e,{onClick:function(){e.onClick();var t=n.g.SpreadsheetApp,r=g.p.getInstance(t).getPresentId();p.E.backToFollow(t,r),m.d.setState(p.E)}})),t)),t.style.display="block"}function R(){var e=document.getElementById(E);e&&(e.style.display="none")}var w=function(e){function t(){var t;return(t=e.apply(this,arguments)||this).state={directionDegree:0,hideDirection:!1},t.updateFollowButton=function(e){var n=e.directionDegree,r=e.hideDirection;t.setState({hideDirection:r,directionDegree:n})},t}(0,r.Z)(t,e);var n=t.prototype;return n.componentDidMount=function(){f.ZP.tencentMeetingEvent.listen(h.z.UPDATE_FOLLOW_BUTTON,this.updateFollowButton)},n.componentWillUnmount=function(){f.ZP.tencentMeetingEvent.remove(h.z.UPDATE_FOLLOW_BUTTON,this.updateFollowButton)},n.render=function(){var e=this.props,t=e.presenterAvatarUrl,n=I(e,["presenterAvatarUrl"]),r=this.state,o=r.hideDirection,i=r.directionDegree;return u().isMobile?s().createElement(c.SuspendButtonMobile,Object.assign({imgUrl:t,shouldShowGuideAnimation:!0,guideText:l.ZP.t("跟随共享人"),style:{zIndex:9995}},n,{directionDegree:i,hideDirection:o,minBottomOffsetOnResize:60})):s().createElement(c.SuspendButtonPc,Object.assign({imgUrl:t,shouldShowGuideAnimation:!0,guideText:l.ZP.t("跟随共享人"),tipText:l.ZP.t("跟随共享人"),style:{zIndex:1}},n,{directionDegree:i,hideDirection:o}))},t}(s().Component)},"../spread-sheet/src/external/view/common/constants/string.ts":function(e,t,n){"use strict";n.d(t,{V:function(){return o},e:function(){return s}});var r=n("../node_modules/i18next/dist/esm/i18next.js"),o=r.ZP.t("冻结窗格问题"),s=r.ZP.t("冻结窗格超过可见范围，会导致无法正常操作，请重新设置冻结区域。")},"../spread-sheet/src/external/view/main/footer/footer-ssr/generate-footer-str-browser.ts":function(e,t,n){"use strict";n.d(t,{v:function(){return Y}});var r,o=n("../node_modules/@babel/runtime/helpers/esm/inheritsLoose.js"),s=n("react"),i=n.n(s),a=n("react-dom"),l=n.n(a),d=(n("../node_modules/react-dom/server.browser.js"),n("../node_modules/core-js/modules/es.array.find-index.js"),n("../node_modules/core-js/modules/es.array.map.js"),n("../node_modules/core-js/modules/es.object.assign.js"),function(e){function t(){return e.apply(this,arguments)||this}return(0,o.Z)(t,e),t.prototype.render=function(){return i().createElement("div",null,i().createElement("div",{className:"sheetListBoxIcon borderRightNone"}))},t}(i().Component)),u=d,c=(n("../node_modules/core-js/modules/es.function.name.js"),n("../packages/model/src/sheet/SheetType.ts")),h=n("../node_modules/@tencent/docs-design-resources/pc/svg/file_form_36.svg"),f=((r={})[c.ZP.FORM]=h,r[c.ZP.SMART_SHEET]="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMjRweCIgaGVpZ2h0PSIyNHB4IiB2aWV3Qm94PSIwIDAgMjQgMjQiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8dGl0bGU+ZmlsZV9tZW51X3hfMjQ8L3RpdGxlPgogICAgPGRlZnM+CiAgICAgICAgPGxpbmVhckdyYWRpZW50IHgxPSI3Mi43MDE1ODAzJSIgeTE9Ii0xMC45MzQ3ODczJSIgeDI9IjEyLjE4NDI4NjElIiB5Mj0iMTAwJSIgaWQ9ImxpbmVhckdyYWRpZW50LTEiPgogICAgICAgICAgICA8c3RvcCBzdG9wLWNvbG9yPSIjMTJEREYyIiBvZmZzZXQ9IjAlIj48L3N0b3A+CiAgICAgICAgICAgIDxzdG9wIHN0b3AtY29sb3I9IiMwQ0MxRTIiIG9mZnNldD0iMTAwJSI+PC9zdG9wPgogICAgICAgIDwvbGluZWFyR3JhZGllbnQ+CiAgICAgICAgPHBhdGggZD0iTTUuMzU2MDI2NzksMyBMMTkuNjQzOTczMiwzIEMyMC4zOTI4ODYxLDMgMjEsMy42MDcxMTM4NyAyMSw0LjM1NjAyNjc5IEwyMSwxOS42NDM5NzMyIEMyMSwyMC4zOTI4ODYxIDIwLjM5Mjg4NjEsMjEgMTkuNjQzOTczMiwyMSBMNS4zNTYwMjY3OSwyMSBDNC42MDcxMTM4NywyMSA0LDIwLjM5Mjg4NjEgNCwxOS42NDM5NzMyIEw0LDQuMzU2MDI2NzkgQzQsMy42MDcxMTM4NyA0LjYwNzExMzg3LDMgNS4zNTYwMjY3OSwzIFoiIGlkPSJwYXRoLTIiPjwvcGF0aD4KICAgICAgICA8ZmlsdGVyIHg9Ii01LjklIiB5PSItNS42JSIgd2lkdGg9IjExMS44JSIgaGVpZ2h0PSIxMTEuMSUiIGZpbHRlclVuaXRzPSJvYmplY3RCb3VuZGluZ0JveCIgaWQ9ImZpbHRlci0zIj4KICAgICAgICAgICAgPGZlR2F1c3NpYW5CbHVyIHN0ZERldmlhdGlvbj0iMC41IiBpbj0iU291cmNlQWxwaGEiIHJlc3VsdD0ic2hhZG93Qmx1cklubmVyMSI+PC9mZUdhdXNzaWFuQmx1cj4KICAgICAgICAgICAgPGZlT2Zmc2V0IGR4PSIxIiBkeT0iMCIgaW49InNoYWRvd0JsdXJJbm5lcjEiIHJlc3VsdD0ic2hhZG93T2Zmc2V0SW5uZXIxIj48L2ZlT2Zmc2V0PgogICAgICAgICAgICA8ZmVDb21wb3NpdGUgaW49InNoYWRvd09mZnNldElubmVyMSIgaW4yPSJTb3VyY2VBbHBoYSIgb3BlcmF0b3I9ImFyaXRobWV0aWMiIGsyPSItMSIgazM9IjEiIHJlc3VsdD0ic2hhZG93SW5uZXJJbm5lcjEiPjwvZmVDb21wb3NpdGU+CiAgICAgICAgICAgIDxmZUNvbG9yTWF0cml4IHZhbHVlcz0iMCAwIDAgMCAxICAgMCAwIDAgMCAxICAgMCAwIDAgMCAxICAwIDAgMCAwLjI0IDAiIHR5cGU9Im1hdHJpeCIgaW49InNoYWRvd0lubmVySW5uZXIxIj48L2ZlQ29sb3JNYXRyaXg+CiAgICAgICAgPC9maWx0ZXI+CiAgICAgICAgPHBvbHlnb24gaWQ9InBhdGgtNCIgcG9pbnRzPSIxLjQxOTQ4Mzc2IDAgMy45MzI1Nzk1NyAyLjYyOTcyMDQ5IDIuNTEzMDk1ODEgNC4wMTQ4OTc3MSAxLjI1MDU1NTIxZS0xMiAxLjM4NTE3NzIxIj48L3BvbHlnb24+CiAgICAgICAgPGZpbHRlciB4PSItMjUuNCUiIHk9Ii0yNC45JSIgd2lkdGg9IjIwMS43JSIgaGVpZ2h0PSIxOTkuNiUiIGZpbHRlclVuaXRzPSJvYmplY3RCb3VuZGluZ0JveCIgaWQ9ImZpbHRlci01Ij4KICAgICAgICAgICAgPGZlT2Zmc2V0IGR4PSIxIiBkeT0iMSIgaW49IlNvdXJjZUFscGhhIiByZXN1bHQ9InNoYWRvd09mZnNldE91dGVyMSI+PC9mZU9mZnNldD4KICAgICAgICAgICAgPGZlR2F1c3NpYW5CbHVyIHN0ZERldmlhdGlvbj0iMC41IiBpbj0ic2hhZG93T2Zmc2V0T3V0ZXIxIiByZXN1bHQ9InNoYWRvd0JsdXJPdXRlcjEiPjwvZmVHYXVzc2lhbkJsdXI+CiAgICAgICAgICAgIDxmZUNvbG9yTWF0cml4IHZhbHVlcz0iMCAwIDAgMCAwICAgMCAwIDAgMCAwLjU1NjE3Njk2MyAgIDAgMCAwIDAgMC42NjE1NzE1NTggIDAgMCAwIDAuNzg5NzQ1NDExIDAiIHR5cGU9Im1hdHJpeCIgaW49InNoYWRvd0JsdXJPdXRlcjEiPjwvZmVDb2xvck1hdHJpeD4KICAgICAgICA8L2ZpbHRlcj4KICAgICAgICA8cG9seWdvbiBpZD0icGF0aC02IiBwb2ludHM9IjUuMDY3NDIwNDMgMi42Mjk3MjA0OSA3LjU4MDUxNjI0IDEuMTkzNzExOGUtMTIgOSAxLjM4NTE3NzIxIDYuNDg2OTA0MTkgNC4wMTQ4OTc3MSI+PC9wb2x5Z29uPgogICAgICAgIDxmaWx0ZXIgeD0iLTI1LjQlIiB5PSItMjQuOSUiIHdpZHRoPSIyMDEuNyUiIGhlaWdodD0iMTk5LjYlIiBmaWx0ZXJVbml0cz0ib2JqZWN0Qm91bmRpbmdCb3giIGlkPSJmaWx0ZXItNyI+CiAgICAgICAgICAgIDxmZU9mZnNldCBkeD0iMSIgZHk9IjEiIGluPSJTb3VyY2VBbHBoYSIgcmVzdWx0PSJzaGFkb3dPZmZzZXRPdXRlcjEiPjwvZmVPZmZzZXQ+CiAgICAgICAgICAgIDxmZUdhdXNzaWFuQmx1ciBzdGREZXZpYXRpb249IjAuNSIgaW49InNoYWRvd09mZnNldE91dGVyMSIgcmVzdWx0PSJzaGFkb3dCbHVyT3V0ZXIxIj48L2ZlR2F1c3NpYW5CbHVyPgogICAgICAgICAgICA8ZmVDb2xvck1hdHJpeCB2YWx1ZXM9IjAgMCAwIDAgMCAgIDAgMCAwIDAgMC41NTYxNzY5NjMgICAwIDAgMCAwIDAuNjYxNTcxNTU4ICAwIDAgMCAwLjc4OTc0NTQxMSAwIiB0eXBlPSJtYXRyaXgiIGluPSJzaGFkb3dCbHVyT3V0ZXIxIj48L2ZlQ29sb3JNYXRyaXg+CiAgICAgICAgPC9maWx0ZXI+CiAgICAgICAgPHBvbHlnb24gaWQ9InBhdGgtOCIgcG9pbnRzPSIxLjQxOTQ4Mzc2IDkgMy45MzI1Nzk1NyA2LjM3MDI3OTUxIDIuNTEzMDk1ODEgNC45ODUxMDIyOSAwIDcuNjE0ODIyNzkiPjwvcG9seWdvbj4KICAgICAgICA8ZmlsdGVyIHg9Ii0yNS40JSIgeT0iLTI0LjklIiB3aWR0aD0iMjAxLjclIiBoZWlnaHQ9IjE5OS42JSIgZmlsdGVyVW5pdHM9Im9iamVjdEJvdW5kaW5nQm94IiBpZD0iZmlsdGVyLTkiPgogICAgICAgICAgICA8ZmVPZmZzZXQgZHg9IjEiIGR5PSIxIiBpbj0iU291cmNlQWxwaGEiIHJlc3VsdD0ic2hhZG93T2Zmc2V0T3V0ZXIxIj48L2ZlT2Zmc2V0PgogICAgICAgICAgICA8ZmVHYXVzc2lhbkJsdXIgc3RkRGV2aWF0aW9uPSIwLjUiIGluPSJzaGFkb3dPZmZzZXRPdXRlcjEiIHJlc3VsdD0ic2hhZG93Qmx1ck91dGVyMSI+PC9mZUdhdXNzaWFuQmx1cj4KICAgICAgICAgICAgPGZlQ29sb3JNYXRyaXggdmFsdWVzPSIwIDAgMCAwIDAgICAwIDAgMCAwIDAuNTU2MTc2OTYzICAgMCAwIDAgMCAwLjY2MTU3MTU1OCAgMCAwIDAgMC43ODk3NDU0MTEgMCIgdHlwZT0ibWF0cml4IiBpbj0ic2hhZG93Qmx1ck91dGVyMSI+PC9mZUNvbG9yTWF0cml4PgogICAgICAgIDwvZmlsdGVyPgogICAgICAgIDxwb2x5Z29uIGlkPSJwYXRoLTEwIiBwb2ludHM9IjYuNDg2OTA0MTkgNC45ODUxMDIyOSA5IDcuNjE0ODIyNzkgNy41ODA1MTYyNCA5IDUuMDY3NDIwNDMgNi4zNzAyNzk1MSI+PC9wb2x5Z29uPgogICAgICAgIDxmaWx0ZXIgeD0iLTI1LjQlIiB5PSItMjQuOSUiIHdpZHRoPSIyMDEuNyUiIGhlaWdodD0iMTk5LjYlIiBmaWx0ZXJVbml0cz0ib2JqZWN0Qm91bmRpbmdCb3giIGlkPSJmaWx0ZXItMTEiPgogICAgICAgICAgICA8ZmVPZmZzZXQgZHg9IjEiIGR5PSIxIiBpbj0iU291cmNlQWxwaGEiIHJlc3VsdD0ic2hhZG93T2Zmc2V0T3V0ZXIxIj48L2ZlT2Zmc2V0PgogICAgICAgICAgICA8ZmVHYXVzc2lhbkJsdXIgc3RkRGV2aWF0aW9uPSIwLjUiIGluPSJzaGFkb3dPZmZzZXRPdXRlcjEiIHJlc3VsdD0ic2hhZG93Qmx1ck91dGVyMSI+PC9mZUdhdXNzaWFuQmx1cj4KICAgICAgICAgICAgPGZlQ29sb3JNYXRyaXggdmFsdWVzPSIwIDAgMCAwIDAgICAwIDAgMCAwIDAuNTU2MTc2OTYzICAgMCAwIDAgMCAwLjY2MTU3MTU1OCAgMCAwIDAgMC43ODk3NDU0MTEgMCIgdHlwZT0ibWF0cml4IiBpbj0ic2hhZG93Qmx1ck91dGVyMSI+PC9mZUNvbG9yTWF0cml4PgogICAgICAgIDwvZmlsdGVyPgogICAgPC9kZWZzPgogICAgPGcgaWQ9IumAmueUqCIgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+CiAgICAgICAgPGcgaWQ9Iue8lue7hC02Ij4KICAgICAgICAgICAgPGcgaWQ9IlJlY3RhbmdsZS0yNCI+CiAgICAgICAgICAgICAgICA8dXNlIGZpbGw9InVybCgjbGluZWFyR3JhZGllbnQtMSkiIGZpbGwtcnVsZT0iZXZlbm9kZCIgeGxpbms6aHJlZj0iI3BhdGgtMiI+PC91c2U+CiAgICAgICAgICAgICAgICA8dXNlIGZpbGw9ImJsYWNrIiBmaWxsLW9wYWNpdHk9IjEiIGZpbHRlcj0idXJsKCNmaWx0ZXItMykiIHhsaW5rOmhyZWY9IiNwYXRoLTIiPjwvdXNlPgogICAgICAgICAgICA8L2c+CiAgICAgICAgICAgIDxnIGlkPSLnvJbnu4QtMTEiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDguMDAwMDAwLCA5LjAwMDAwMCkiPgogICAgICAgICAgICAgICAgPGcgaWQ9Iui3r+W+hCI+CiAgICAgICAgICAgICAgICAgICAgPHVzZSBmaWxsPSJibGFjayIgZmlsbC1vcGFjaXR5PSIxIiBmaWx0ZXI9InVybCgjZmlsdGVyLTUpIiB4bGluazpocmVmPSIjcGF0aC00Ij48L3VzZT4KICAgICAgICAgICAgICAgICAgICA8dXNlIGZpbGw9IiNFMkZERkUiIGZpbGwtcnVsZT0iZXZlbm9kZCIgeGxpbms6aHJlZj0iI3BhdGgtNCI+PC91c2U+CiAgICAgICAgICAgICAgICA8L2c+CiAgICAgICAgICAgICAgICA8ZyBpZD0i6Lev5b6EIj4KICAgICAgICAgICAgICAgICAgICA8dXNlIGZpbGw9ImJsYWNrIiBmaWxsLW9wYWNpdHk9IjEiIGZpbHRlcj0idXJsKCNmaWx0ZXItNykiIHhsaW5rOmhyZWY9IiNwYXRoLTYiPjwvdXNlPgogICAgICAgICAgICAgICAgICAgIDx1c2UgZmlsbD0iI0UyRkRGRSIgZmlsbC1ydWxlPSJldmVub2RkIiB4bGluazpocmVmPSIjcGF0aC02Ij48L3VzZT4KICAgICAgICAgICAgICAgIDwvZz4KICAgICAgICAgICAgICAgIDxnIGlkPSLot6/lvoQiPgogICAgICAgICAgICAgICAgICAgIDx1c2UgZmlsbD0iYmxhY2siIGZpbGwtb3BhY2l0eT0iMSIgZmlsdGVyPSJ1cmwoI2ZpbHRlci05KSIgeGxpbms6aHJlZj0iI3BhdGgtOCI+PC91c2U+CiAgICAgICAgICAgICAgICAgICAgPHVzZSBmaWxsPSIjQUFGN0ZDIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiIHhsaW5rOmhyZWY9IiNwYXRoLTgiPjwvdXNlPgogICAgICAgICAgICAgICAgPC9nPgogICAgICAgICAgICAgICAgPGcgaWQ9Iui3r+W+hCI+CiAgICAgICAgICAgICAgICAgICAgPHVzZSBmaWxsPSJibGFjayIgZmlsbC1vcGFjaXR5PSIxIiBmaWx0ZXI9InVybCgjZmlsdGVyLTExKSIgeGxpbms6aHJlZj0iI3BhdGgtMTAiPjwvdXNlPgogICAgICAgICAgICAgICAgICAgIDx1c2UgZmlsbD0iI0FBRjdGQyIgZmlsbC1ydWxlPSJldmVub2RkIiB4bGluazpocmVmPSIjcGF0aC0xMCI+PC91c2U+CiAgICAgICAgICAgICAgICA8L2c+CiAgICAgICAgICAgIDwvZz4KICAgICAgICA8L2c+CiAgICA8L2c+Cjwvc3ZnPg==",r[c.ZP.GRID]="",r[c.ZP.OBJECT]="",r);function p(e){return e&&f[e]?i().createElement("div",{className:"sheet-tab-icon",style:{backgroundImage:"url("+f[e]+")"}}):null}var g=function(e){function t(){return e.apply(this,arguments)||this}return(0,o.Z)(t,e),t.prototype.render=function(){var e=this.props.isShowIconBox?"1px 18px 0px 18px":"1px 25px 0px 24px";return i().createElement("div",{className:"sheet-box sheet sheet-tab-"+(this.props.isFocus?"focus-ssr":"blur-ssr")},i().createElement("div",{style:{zIndex:0,display:this.props.hidden?"none":"flex",padding:e,height:"100%",alignItems:"center",justifyContent:"center"}},p(this.props.type),i().createElement("span",{className:"sheet-tab-name-ssr"},this.props.name),this.props.isShowIconBox&&i().createElement("div",{className:"menu-iconbox-ssr"},i().createElement("div",{className:"menu-icon-ssr"}))))},t}(i().Component),m=g,v=function(e){function t(t){var n;return(n=e.call(this,t)||this).getSheetList=function(){var e=n.props,t=e.sheetId,r=e.sheetList,o=r.findIndex((function(e){return t===e.id}));return r.map((function(e,t){var r=Object.assign(Object.assign({},e),{index:t});return i().createElement(m,Object.assign({},r,{key:t,isShowIconBox:n.props.isShowIconBox,isFocus:o===t}))}))},n.sheetList=t.sheetList,n}return(0,o.Z)(t,e),t.prototype.render=function(){return i().createElement("div",{className:"tsSheetbox-ssr"},i().createElement(u,null),i().createElement("div",{className:"scrollWrap-ssr"},i().createElement("div",{className:"sheet-content-ssr"},this.getSheetList())))},t}(i().Component),I=function(e){function t(){return e.apply(this,arguments)||this}return(0,o.Z)(t,e),t.prototype.render=function(){return i().createElement("div",{className:"full-and-scale-wrap-ssr"},i().createElement("div",{className:"fullscreenbar-ssr"},i().createElement("div",{className:"fullscreenbar__button-ssr"},i().createElement("svg",{width:"24",height:"24",xmlns:"http://www.w3.org/2000/svg"},i().createElement("g",{fill:"none",fillRule:"evenodd"},i().createElement("path",{d:"M0 0h24v24H0z"}),i().createElement("path",{d:"M9.809 13.309l.883.883-3.558 3.56h2.858V19H5v-4.995h1.248l-.001 2.868 3.562-3.564zm4.382 0l3.562 3.564v-2.868H19V19h-4.992v-1.249l2.858.001-3.558-3.56.883-.883zM9.991 5v1.249l-2.858-.001 3.559 3.56-.883.883-3.562-3.564v2.868H5V5h4.992zM19 5v4.995h-1.248l.001-2.868-3.562 3.564-.883-.883 3.559-3.56h-2.859V5H19z",fill:"#464D5A"}))))),i().createElement("div",{className:"scalebar-ssr"},i().createElement("div",{className:"scalebar__zoom scalebar__zoomout"},i().createElement("div",{className:"scalebar__zoom-btn"})),i().createElement("span",{className:"scalebar__progress"},i().createElement("span",{className:"content"},"100%")),i().createElement("div",{className:"scalebar__zoom scalebar__zoomin"},i().createElement("div",{className:"scalebar__zoom-btn"}),i().createElement("div",{className:"scalebar__zoom-btn--vertical"}))),i().createElement("div",{className:"arrow-wrapper-ssr"}))},t}(i().Component),E=I,S=function(e){function t(){return e.apply(this,arguments)||this}return(0,o.Z)(t,e),t.prototype.render=function(){return i().createElement("div",{className:"highlight-ssr"},i().createElement("div",{className:"light-switch-ssr"}),i().createElement("div",{className:"color-switch-ssr"},i().createElement("div",{className:"arrow-wrapper-ssr"})))},t}(i().Component),R=S,w=n("../packages/model/src/sheet/PrivilegeType.ts");function A(e){return e===w.Y.EDITABLE||e===w.Y.OWNER||e===w.Y.ADMINISTRATOR}var C=function(e){function t(){return e.apply(this,arguments)||this}return(0,o.Z)(t,e),t.prototype.render=function(){return s.createElement("div",{className:"addbutton-pc-ssr addbutton-bg-ssr"})},t}(s.Component),y=function(e){function t(t){return e.call(this,t)||this}return(0,o.Z)(t,e),t.prototype.render=function(){var e=this.props,t=e.sheetId,n=e.sheetList,r=e.isShowAdd,o=e.isShowIconBox;return i().createElement("footer",{id:"pcFooterSSRContainer"},i().createElement("div",{className:"sheet-bar-container-pc"},r&&i().createElement(C,null),i().createElement(v,{sheetId:t,sheetList:n,isShowIconBox:o}),i().createElement("div",{className:"hight-light-and-scale-wrapper"},i().createElement(R,null),i().createElement(E,null))))},t}(i().Component);function _(e,t,n){var r=A(n),o=A(n),s=document.createElement("div");return l().render(i().createElement(y,{sheetList:t,sheetId:e,isShowAdd:r,isShowIconBox:o}),s),s.innerHTML}var T=function(e){function t(){return e.apply(this,arguments)||this}return(0,o.Z)(t,e),t.prototype.render=function(){return i().createElement("div",{className:"sheetbar-add-btn-mobile"})},t}(i().Component),x=T,b=function(e){function t(){return e.apply(this,arguments)||this}return(0,o.Z)(t,e),t.prototype.render=function(){return i().createElement("div",{className:"sheetbar-head-icon-mobile"})},t}(i().Component),D=b,O=function(e){function t(){return e.apply(this,arguments)||this}return(0,o.Z)(t,e),t.prototype.render=function(){var e=this.props.sheetListItem.type;return i().createElement("div",{className:"sheet-tab-mobile "+(this.props.isFocus?"sheet-tab-focus-mobile":""),style:{display:this.props.sheetListItem.hidden?"none":"flex"}},p(e),i().createElement("span",{className:"sheet-tab-name-mobile"},this.props.sheetListItem.name))},t}(i().Component),M=O,j=function(e){function t(t){var n;return(n=e.call(this,t)||this).getSheetList=function(){var e=n.props,t=e.sheetList,r=e.sheetId,o=t.findIndex((function(e){return r===e.id}));return i().createElement("div",{className:"sheetbar-list-mobile"},t.map((function(e,t){return i().createElement(M,{sheetListItem:e,isFocus:o===t,key:t})})))},n}return(0,o.Z)(t,e),t.prototype.render=function(){return i().createElement("div",{className:"sheetbar-list-wrapper-mobile"},this.getSheetList())},t}(i().Component),L=j,Z=function(e){function t(t){return e.call(this,t)||this}return(0,o.Z)(t,e),t.prototype.render=function(){var e=this.props,t=e.sheetId,n=e.sheetList,r=e.isShowAdd;return i().createElement("footer",{id:"mobileFooterSSRContainer"},i().createElement("div",{className:"sheet-bar-container-mobile"},i().createElement(D,null),i().createElement(L,{sheetId:t,sheetList:n}),r&&i().createElement(x,null)))},t}(i().Component);function k(e,t,n){var r=A(n),o=document.createElement("div");return l().render(i().createElement(Z,{sheetId:e,sheetList:t,isShowAdd:r}),o),o.innerHTML}var N=function(e){function t(){return e.apply(this,arguments)||this}return(0,o.Z)(t,e),t.prototype.render=function(){return i().createElement("div",{className:"sheetbar-add-btn-pad"})},t}(i().Component),P=N,U=function(e){function t(){return e.apply(this,arguments)||this}return(0,o.Z)(t,e),t.prototype.render=function(){var e=this.props.sheetListItem.type;return i().createElement("div",{className:"sheet-tab-pad "+(this.props.isFocus?"sheet-tab-focus-pad":""),style:{display:this.props.sheetListItem.hidden?"none":"flex"}},p(e),i().createElement("span",{className:"sheet-tab-name-pad"},this.props.sheetListItem.name))},t}(i().Component),F=U,V=function(e){function t(t){var n;return(n=e.call(this,t)||this).getSheetList=function(){var e=n.props,t=e.sheetList,r=e.sheetId,o=t.findIndex((function(e){return r===e.id}));return i().createElement("div",{className:"sheet-tab-list-pad"},t.map((function(e,t){return i().createElement(F,{sheetListItem:e,isFocus:o===t,key:t})})))},n}return(0,o.Z)(t,e),t.prototype.render=function(){return i().createElement("div",{className:"sheet-tab-list-wrapper-pad"},this.getSheetList())},t}(i().Component),B=V,H=function(e){function t(){return e.apply(this,arguments)||this}return(0,o.Z)(t,e),t.prototype.render=function(){return i().createElement("div",{className:"sheetbar-head-icon-pad"})},t}(i().Component),G=H,W=function(e){function t(t){return e.call(this,t)||this}return(0,o.Z)(t,e),t.prototype.render=function(){var e=this.props,t=e.sheetId,n=e.sheetList,r=e.isShowAdd;return i().createElement("footer",{id:"padFooterSSRContainer"},i().createElement("div",{className:"sheet-bar-container-pad"},r&&i().createElement(P,null),i().createElement(G,null),i().createElement(B,{sheetId:t,sheetList:n})))},t}(i().Component);function z(e,t,n){var r=A(n),o=document.createElement("div");return l().render(i().createElement(W,{sheetId:e,sheetList:t,isShowAdd:r}),o),o.innerHTML}var Q=n("../spread-sheet/src/base/ssr/ssr-dom-attr.ts");function Y(e,t){return'\n    <div id="'+Q.vs+'">\n        <style>'+n("../node_modules/raw-loader/dist/cjs.js!../spread-sheet/src/external/view/main/footer/footer-ssr/common/footer-common-style.css").Z+"</style>\n        "+function(e,t){return"\n        <style>"+[n("../node_modules/raw-loader/dist/cjs.js!../spread-sheet/src/external/view/main/footer/footer-ssr/pc-footer-ssr/index.css").Z,n("../node_modules/raw-loader/dist/cjs.js!../spread-sheet/src/external/view/main/footer/footer-ssr/pc-footer-ssr/components/full-and-scale/index.css").Z,n("../node_modules/raw-loader/dist/cjs.js!../spread-sheet/src/external/view/main/footer/footer-ssr/pc-footer-ssr/components/highlight/index.css").Z,n("../node_modules/raw-loader/dist/cjs.js!../spread-sheet/src/external/view/main/footer/footer-ssr/pc-footer-ssr/components/scroll/index.css").Z,n("../node_modules/raw-loader/dist/cjs.js!../spread-sheet/src/external/view/main/footer/footer-ssr/pc-footer-ssr/components/add/index.css").Z].join("")+'</style>\n        <div class="footer-can-read-ssr-pc">\n            '+_(t,e,w.Y.READABLE)+'\n        </div>\n        <div class="footer-can-edit-ssr-pc">\n            '+_(t,e,w.Y.EDITABLE)+"\n        </div>\n    "}(t,e)+"\n        "+function(e,t){return"\n        <style>"+[n("../node_modules/raw-loader/dist/cjs.js!../spread-sheet/src/external/view/main/footer/footer-ssr/mobile-footer-ssr/index.css").Z,n("../node_modules/raw-loader/dist/cjs.js!../spread-sheet/src/external/view/main/footer/footer-ssr/mobile-footer-ssr/components/sheetbar-head/index.css").Z,n("../node_modules/raw-loader/dist/cjs.js!../spread-sheet/src/external/view/main/footer/footer-ssr/mobile-footer-ssr/components/sheet-tab/index.css").Z,n("../node_modules/raw-loader/dist/cjs.js!../spread-sheet/src/external/view/main/footer/footer-ssr/mobile-footer-ssr/components/add-button/index.css").Z].join("")+'</style>\n        <div class="footer-can-read-ssr-mobile">\n            '+k(t,e,w.Y.READABLE)+'\n        </div>\n        <div class="footer-can-edit-ssr-mobile">\n            '+k(t,e,w.Y.EDITABLE)+"\n        </div>\n    "}(t,e)+"\n        "+function(e,t){return"\n        <style>"+[n("../node_modules/raw-loader/dist/cjs.js!../spread-sheet/src/external/view/main/footer/footer-ssr/pad-footer-ssr/index.css").Z,n("../node_modules/raw-loader/dist/cjs.js!../spread-sheet/src/external/view/main/footer/footer-ssr/pad-footer-ssr/components/sheetbar-head/index.css").Z,n("../node_modules/raw-loader/dist/cjs.js!../spread-sheet/src/external/view/main/footer/footer-ssr/pad-footer-ssr/components/sheet-tab/index.css").Z,n("../node_modules/raw-loader/dist/cjs.js!../spread-sheet/src/external/view/main/footer/footer-ssr/pad-footer-ssr/components/add-button/index.css").Z].join("")+'</style>\n        <div class="footer-can-read-ssr-pad">\n            '+z(t,e,w.Y.READABLE)+'\n        </div>\n        <div class="footer-can-edit-ssr-pad">\n            '+z(t,e,w.Y.EDITABLE)+"\n        </div>\n    "}(t,e)+"\n    </div>"}n("../node_modules/core-js/modules/es.array.join.js")},"../spread-sheet/src/external/view/main/footer/footer.interface.ts":function(e,t,n){"use strict";n.d(t,{F:function(){return r}});var r=(0,n("../node_modules/@tencent/containerized/build/main/index.js").yh)("IFooter")},"../spread-sheet/src/external/view/mobile/header/menu/feature/collaborator-record.ts":function(e,t,n){"use strict";n.d(t,{f:function(){return i}}),n("../node_modules/regenerator-runtime/runtime.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.promise.js"),n("../node_modules/core-js/modules/es.function.name.js");var r=n("../spread-sheet/src/core/ark-extensions/index.ts"),o=n("../spread-sheet/src/core/ark-extensions/extensions/collaborator-detail-mobile.ts"),s=function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function i(e){try{l(r.next(e))}catch(t){s(t)}}function a(e){try{l(r.throw(e))}catch(t){s(t)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,a)}l((r=r.apply(e,t||[])).next())}))};function i(e){return s(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n,s;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,r.default.getExtension(o.x.name);case 2:n=t.sent,(s=document.getElementById("collbaborator-panel"))||((s=document.createElement("div")).id="collbaborator-panel",document.body.appendChild(s)),n.show({container:s,collaboratorNum:e.length,collaboratorList:e});case 6:case"end":return t.stop()}}),t)})))}},"../spread-sheet/src/external/view/mobile/header/native-header/api.ts":function(e,t,n){"use strict";n.d(t,{n:function(){return a}}),n("../node_modules/core-js/modules/es.array.map.js"),n("../node_modules/core-js/modules/es.object.assign.js"),n("../node_modules/core-js/modules/es.array.iterator.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.set.js"),n("../node_modules/core-js/modules/es.string.iterator.js"),n("../node_modules/core-js/modules/esnext.set.add-all.js"),n("../node_modules/core-js/modules/esnext.set.delete-all.js"),n("../node_modules/core-js/modules/esnext.set.difference.js"),n("../node_modules/core-js/modules/esnext.set.every.js"),n("../node_modules/core-js/modules/esnext.set.filter.js"),n("../node_modules/core-js/modules/esnext.set.find.js"),n("../node_modules/core-js/modules/esnext.set.intersection.js"),n("../node_modules/core-js/modules/esnext.set.is-disjoint-from.js"),n("../node_modules/core-js/modules/esnext.set.is-subset-of.js"),n("../node_modules/core-js/modules/esnext.set.is-superset-of.js"),n("../node_modules/core-js/modules/esnext.set.join.js"),n("../node_modules/core-js/modules/esnext.set.map.js"),n("../node_modules/core-js/modules/esnext.set.reduce.js"),n("../node_modules/core-js/modules/esnext.set.some.js"),n("../node_modules/core-js/modules/esnext.set.symmetric-difference.js"),n("../node_modules/core-js/modules/esnext.set.union.js"),n("../node_modules/core-js/modules/web.dom-collections.iterator.js");var r=n("../node_modules/lodash/clone.js"),o=n.n(r),s=n("../spread-sheet/src/external/view/mobile/header/native-header/const.ts");function i(e){var t=o()(e),r=t.position,i=t.state,a=t.onClick;return void 0!==i&&(t.state=s.W4[i]),void 0!==r&&(t.position=s.LG[r]),void 0!==a&&(t.onclick=n.g.mqq.callback(e.onClick)),t}n("../spread-sheet/src/base/util/domain-config.ts");var a=function(){function e(){}return e.show=function(){var e;null===(e=n.g.mqq)||void 0===e||e.invoke("titlebar","setState",{state:1})},e.hide=function(){var e;null===(e=n.g.mqq)||void 0===e||e.invoke("titlebar","setState",{state:0})},e.setActionButtons=function(e){var t;null===(t=n.g.mqq)||void 0===t||t.invoke("titlebar","setActionButtons",{buttons:e.map(i)})},e.updateActionButton=function(t,n){e.updateActionButtons([i(Object.assign({id:t},n))])},e.updateActionButtons=function(e){var t;null===(t=n.g.mqq)||void 0===t||t.invoke("titlebar","updateActionButtonsById",{buttons:e.map(i)})},e.showDialog=function(t,r){void 0===r&&(r=!1);var o=t.id,s=t.content,i=t.button,a=t.onClick;e.dialogExisting.has(o)||(!0===r&&e.dialogExisting.add(o),n.g.mqq.invoke("titlebar","showDialogById",{id:o,event:event,msg:s,btnText:i,onclick:n.g.mqq.callback((function(t){a(t),e.dialogExisting.delete(o)}))}))},e.hideButtonsBeforeJump=function(){e.setActionButtons([{id:"back",state:"show",type:"image",position:"left",url:s.Te.BACK}])},e}();a.dialogExisting=new Set},"../spread-sheet/src/external/view/mobile/header/native-header/const.ts":function(e,t,n){"use strict";n.d(t,{GV:function(){return i},Je:function(){return a},LG:function(){return s},Te:function(){return r},W4:function(){return o}});var r={SHARE:"0",MENU:"1",STAR_OFF:"2",STAR_ON:"3",BACK:"4",UNDO:"5",REDO:"6",EXPAND:"7",DONE:"10",EYE:"11",ADD_COLLABORATOR:"12",COLLABORATOR:"13"},o={show:0,hide:1,disable:2},s={left:0,right:1,middle:2},i="nv_types",a="sheet"},"../spread-sheet/src/external/view/mobile/header/native-header/index.ts":function(e,t,n){"use strict";n.d(t,{Z:function(){return O}}),n("../node_modules/regenerator-runtime/runtime.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.promise.js"),n("../node_modules/core-js/modules/web.dom-collections.for-each.js"),n("../node_modules/core-js/modules/es.array.iterator.js"),n("../node_modules/core-js/modules/es.set.js"),n("../node_modules/core-js/modules/es.string.iterator.js"),n("../node_modules/core-js/modules/esnext.set.add-all.js"),n("../node_modules/core-js/modules/esnext.set.delete-all.js"),n("../node_modules/core-js/modules/esnext.set.difference.js"),n("../node_modules/core-js/modules/esnext.set.every.js"),n("../node_modules/core-js/modules/esnext.set.filter.js"),n("../node_modules/core-js/modules/esnext.set.find.js"),n("../node_modules/core-js/modules/esnext.set.intersection.js"),n("../node_modules/core-js/modules/esnext.set.is-disjoint-from.js"),n("../node_modules/core-js/modules/esnext.set.is-subset-of.js"),n("../node_modules/core-js/modules/esnext.set.is-superset-of.js"),n("../node_modules/core-js/modules/esnext.set.join.js"),n("../node_modules/core-js/modules/esnext.set.map.js"),n("../node_modules/core-js/modules/esnext.set.reduce.js"),n("../node_modules/core-js/modules/esnext.set.some.js"),n("../node_modules/core-js/modules/esnext.set.symmetric-difference.js"),n("../node_modules/core-js/modules/esnext.set.union.js"),n("../node_modules/core-js/modules/web.dom-collections.iterator.js"),n("../node_modules/core-js/modules/es.object.assign.js"),n("../node_modules/core-js/modules/es.array.filter.js");var r=n("../spread-sheet/src/base/event/event.ts"),o=(n("../node_modules/core-js/modules/es.array.find.js"),n("../node_modules/lodash/clone.js")),s=n.n(o),i=n("../node_modules/@tencent/docs-user-agent/dist/index.js"),a=n.n(i),l=(n("../node_modules/core-js/modules/es.array.from.js"),n("../node_modules/core-js/modules/es.array.map.js"),n("../spread-sheet/src/external/view/mobile/header/native-header/const.ts")),d=n("../spread-sheet/src/base/util/appConfig.ts"),u=n("../spread-sheet/src/core/view/level-2/discussion-ent/utils.ts"),c=n("../spread-sheet/src/base/storage/collaborator.ts"),h=n("../node_modules/i18next/dist/esm/i18next.js"),f=n.g.tdocs,p=function(e){var t=O.getApp();if(void 0===t)return null;var n=(0,c.j)(),r=(e.collabCount?e.collabCount:localStorage.getItem(n))||0,o=t.view.canvas.inputManager;return{back:{position:"left",id:"back",type:"image",url:l.Te.BACK,state:e.editMode?"hide":"show",onClick:function(){var e;console.error("点击了返回"),null===(e=f.popBack)||void 0===e||e.call(f,{})}},done:{position:"left",url:l.Te.DONE,type:"text",text:h.ZP.t("完成"),id:"done",state:e.editMode?"show":"hide",onClick:function(){var e;console.error("点击了完成"),null===(e=t.view.mobileTopBar)||void 0===e||e.doneOnClick()}},add_collaborator:{id:"add_collaborator",type:"image",position:"right",url:l.Te.ADD_COLLABORATOR,state:r<=1?"show":"hide",onClick:function(){console.error("点击add_collaborator了"),t.view.canvas.collabCenter.addCollab((function(){O.updateIsShowCollaborator()}))}},collaborator2:{id:"collaborator",type:"collaborator",position:"right",url:l.Te.COLLABORATOR,state:r>1?"show":"hide",collaborators:new Array(e.collabCount||+(r||0)||0),onClick:function(e){t.view.canvas.collabCenter.showCollaboratorPanel(null===e||void 0===e?void 0:e.timestamp)}},collaborator:{id:"collaborator",type:"collaborator",position:"right",url:l.Te.EYE,state:e.isShowVisitor?"show":"hide",collaborators:e.isOnline?1===e.users.size?[]:Array.from(e.users):[],onClick:function(){var t,n=[];e.userInfos.forEach((function(e){n.push({show_name:e.markName||"",corp_name:e.corpName||"",vid:e.uid,corpid_num:"",iconurl:e.userPic||"",type:"VID_TYPE_WEWORK",xid:""})})),null===(t=f.showOnlineUserList)||void 0===t||t.call(f,{users:n})}},share:{position:"right",id:"share",type:"image",url:l.Te.SHARE,state:"show",onClick:function(){var e;console.error("点击了分享"),null===(e=f.forwardToConversion)||void 0===e||e.call(f,{})}},menu:{position:"right",id:"menu",type:"image",url:l.Te.MENU,state:"show",onClick:function(e){console.error("点击了更多"),o.hide(),O.toggleMenu(null===e||void 0===e?void 0:e.timestamp)}}}},g=n("../spread-sheet/src/external/view/mobile/header/menu/feature/collaborator-record.ts"),m=function(e){return void 0===O.getApp()?null:{separator:{position:"right",id:"separator",type:"separator",state:!e.editMode&&e.users.size>1?"show":"hide"},collaborator:{position:"right",id:"collaborator",type:"collaborator",state:!e.editMode&&e.users.size>1?"show":"hide",collaborators:e.isOnline?1===e.users.size?[]:Array.from(e.users):[],onClick:function(){var t=e.userInfos.map((function(e){return{uid:e.uid,nick:e.markName||"",avatar:e.userPic||"",corpName:e.corpName||"",lastOperateTs:e.lastOperateTs}}));(0,g.f)(t)}}}},v=function(e){var t=O.getApp();if(void 0===t)return null;var r=t.requestApi,o=t.view.canvas.inputManager,s=a().isIPad||a().isAndroidPad;return{expand:{position:"left",id:"expand",type:"image",url:l.Te.EXPAND,state:e.editMode||"in"!==e.splitType?"hide":"show"},back:{position:"left",id:"back",type:"image",url:l.Te.BACK,state:e.back.show&&"in"!==e.splitType?"show":"hide",onClick:function(){var e,r;s?t.emitter.emit("switchSplitType"):null===(r=null===(e=n.g.mqq)||void 0===e?void 0:e.ui)||void 0===r||r.popBack()}},done:{position:"left",id:"done",type:"image",url:l.Te.DONE,state:e.editMode&&e.done.show?"show":"hide",onClick:function(){var e;null===(e=t.view.mobileTopBar)||void 0===e||e.doneOnClick()}},title:{position:"left",id:"title",type:"text",state:s?"show":"hide"},collaborator:{position:"middle",id:"collaborator",type:"collaborator",state:e.editMode?"hide":"show",collaborators:e.isOnline?1===e.users.size?[]:Array.from(e.users):[]},offline:{id:"offline",type:"offline",position:"middle",state:e.isOnline?"hide":"show"},undo:{position:"right",id:"undo",type:"image",url:l.Te.UNDO,state:!1===e.editMode?"hide":e.undo.enable?"show":"disable",onClick:function(){o.hasFocus()?o.undo():r.undo()}},redo:{position:"right",id:"redo",type:"image",url:l.Te.REDO,state:!1===e.editMode?"hide":e.redo.enable?"show":"disable",onClick:function(){o.hasFocus()?o.redo():r.redo()}},star:{position:"right",id:"star",type:"image",url:l.Te.STAR_OFF,state:e.editMode?"hide":!e.isOnline||e.isDelete?"disable":"show"},share:{position:"right",id:"share",type:"image",url:l.Te.SHARE,state:e.editMode?"hide":!e.isOnline||e.isDelete?"disable":"show"},menu:{position:"right",id:"menu",type:"image",url:l.Te.MENU,state:e.editMode?"hide":e.isDelete?"disable":"show",onClick:function(){O.toggleMenu()}}}};function I(e){var t=function(e,t){var n={list:["expand","back","done","title","collaborator","offline","undo","redo","star","separator","share","menu"],config:Object.assign({},v(t),m(t))},r={default:[{list:["expand","back","done","title","collaborator","offline","undo","redo","star","share","menu"],config:function(e){return v(e)},version:function(){return!0},container:!0}],toc:[{list:["expand","back","done","title","offline","collaborator","undo","redo","star","share","menu"],config:function(e){return v(e)},version:function(){return!0},container:a().isTencentDocsApp}],wecom:[{list:["expand","back","title","collaborator","offline","undo","redo","star","share","menu"],config:function(e){return v(e)},version:function(){return!1},container:a().isTencentDocsApp},{list:["done","expand","back","title","offline","collaborator","undo","redo","separator","star","share","menu"],config:function(e){return Object.assign({},v(e),m(e))},version:function(){return!0},container:a().isTencentDocsApp},{list:(0,u.e)()?(0,u.s)()?["back","done","menu"]:["back","done","add_collaborator","collaborator2","menu"]:["back","done","collaborator","share","menu"],config:function(e){return Object.assign({},v(e),p(e))},version:function(){return!0},container:a().isWxWork}]},o=(r[e]||r.default).filter((function(e){return e.version()&&e.container})).map((function(e){return{list:e.list,config:e.config(t)}}));return o.length?o[0]:n}(d.Z.getConfig("domain")||"toc",e);return console.error("menu",JSON.stringify(t)),t.list.map((function(e){return t.config[e]})).filter((function(e){return null!==e}))}var E,S=n("../spread-sheet/src/external/view/mobile/header/native-header/api.ts"),R=n("../spread-sheet/src/core/data/configService/spreadConfig.ts");!function(e){e[e.QQ=0]="QQ",e[e.UID=1]="UID",e[e.QQ_GROUP=2]="QQ_GROUP",e[e.CONF=3]="CONF",e[e.GROUP=4]="GROUP",e[e.WORK_DPT=5]="WORK_DPT"}(E||(E={}));var w,A,C,y=n("./node_modules/axios/index.js"),_=n.n(y),T=n("../packages/common-utils/src/index.ts");!function(e){e[e.RESET_STATE=0]="RESET_STATE",e[e.UPDATE_STATE=1]="UPDATE_STATE",e[e.ADD_CANEDIT_CONTACT=2]="ADD_CANEDIT_CONTACT",e[e.DELETE_CANDELETE_CONTACT=3]="DELETE_CANDELETE_CONTACT",e[e.CHANGE_CONTACT_PRIVILEGE=4]="CHANGE_CONTACT_PRIVILEGE"}(w||(w={})),function(e){e[e.Person=1]="Person",e[e.Department=2]="Department"}(A||(A={})),function(e){e[e.Creator=1]="Creator",e[e.Self=2]="Self",e[e.Other=3]="Other"}(C||(C={}));var x=function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function i(e){try{l(r.next(e))}catch(t){s(t)}}function a(e){try{l(r.throw(e))}catch(t){s(t)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,a)}l((r=r.apply(e,t||[])).next())}))},b=n("../spread-sheet/src/base/util/domain-config.ts"),D=(n("../spread-sheet/src/external/view/mobile/header/native-header/utils.ts"),function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function i(e){try{l(r.next(e))}catch(t){s(t)}}function a(e){try{l(r.throw(e))}catch(t){s(t)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,a)}l((r=r.apply(e,t||[])).next())}))}),O=new(function(){function e(){var t=this;this.prevConfigs=new Array,this.isInitialized=!1,this.isFullScreenMode=!1,this.state=e.getInitState(),this.browserList=[],this.updateIsShowCollaborator=function(){var e,n,r=null===(n=null===(e=t.app)||void 0===e?void 0:e.view.canvas.collabCenter)||void 0===n?void 0:n.getCollabCount();"number"===typeof r&&(t.state.collabCount=r,t.updateHeader())},this.handleEnterFullScreenMode=function(){var e,n;S.n.hide(),null===(n=null===(e=document.getElementsByClassName("excel-container"))||void 0===e?void 0:e[0])||void 0===n||n.classList.add("full-screen"),setTimeout((function(){return t.isFullScreenMode=!0}))},this.handleExitFullScreenMode=function(){var e,n;S.n.show(),null===(n=null===(e=document.getElementsByClassName("excel-container"))||void 0===e?void 0:e[0])||void 0===n||n.classList.remove("full-screen"),setTimeout((function(){return t.isFullScreenMode=!1}))},this.handleGetDocInfo=function(){var e=R.q.getConfig("docInfo");void 0!==e&&S.n.updateActionButton("star",{type:"image",url:e.isCollected?l.Te.STAR_ON:l.Te.STAR_OFF})},this.handleSheetStatusChange=function(){if(void 0!==t.app){var e=t.app.sheetStatus.workbookStatus.isOnline;t.setState({isOnline:e})}},this.updateUserlist=function(e){e.forEach((function(e){e.userId&&!t.state.users.has(e.userId)&&(t.state.users.add(e.userId),t.state.userInfos.push(e))})),t.updateIsShowVisitor(),t.updateHeader()},this.handleUserLeave=function(e){null===e||void 0===e||e.forEach((function(e){var n=null===e||void 0===e?void 0:e.userId;void 0!==n&&(t.state.users.delete(n),t.updateHeader())}))}}e.getInitState=function(){return{isOnline:!0,isDelete:!1,editMode:!1,splitType:"normal",back:{show:!0},redo:{enable:!1},undo:{enable:!1},done:{show:!1},users:new Set,isShowVisitor:!1,userInfos:[],collabCount:0,isConsumerVisitBusinessClient:!1,isWeCom:b.xc}};var t=e.prototype;return t.getApp=function(){return this.app},t.getIsFullScreenMode=function(){return this.isFullScreenMode},t.init=function(t){return D(this,void 0,void 0,regeneratorRuntime.mark((function n(){var r,o;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(void 0!==t&&null!==t){n.next=2;break}return n.abrupt("return");case 2:return this.app=t,this.prevConfigs=[],this.isInitialized=!1,this.isFullScreenMode=!1,this.state=e.getInitState(),this.initCollaboratorData(),this.app.sheetStatus&&(r=this.app.sheetStatus.workbookStatus.isOnline,o=void 0===r||r,this.state.isOnline=o),2===R.q.getConfig("docStatus")&&(this.state.isDelete=!0),this.injectStyle(),n.next=13,this.initBrowserList();case 13:this.bindEvents(),this.initHeader();case 15:case"end":return n.stop()}}),n,this)})))},t.reInit=function(e){return D(this,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.unbindEvents(),t.next=3,this.init(e);case 3:case"end":return t.stop()}}),t,this)})))},t.setState=function(e){this.state=Object.assign(Object.assign({},this.state),e),this.updateHeader()},t.getState=function(){return this.state},t.toggleMenu=function(e){var t,n,r=document.getElementById("mobile-design-menu-mountpoint");r&&0!==r.children.length?null===(t=this.app)||void 0===t||t.emitter.emit("hideMobileMoreMenu"):null===(n=this.app)||void 0===n||n.emitter.emit("showMobileMoreMenu",void 0,e)},t.getChangedConfigs=function(){var e,t=function(e){var t=s()(e);return(a().isIPad||a().isAndroidPad)&&t.editMode&&(t.editMode=!1),I(t)}(this.state),n=(e=this.prevConfigs,t.filter((function(t){var n=e.find((function(e){return e.id===t.id}));return void 0===n||t.state!==n.state||"collaborator"===t.type||("text"===t.type?n.text!==t.text:"image"===t.type&&n.url!==t.url)})));return this.prevConfigs=t,n},t.getIsShowVisitor=function(){return this.state.isShowVisitor},t.initCollaboratorData=function(){r.ZP.view.listen("collabInited",this.updateIsShowCollaborator)},t.deleteUserInfos=function(e){this.state.userInfos=this.state.userInfos.filter((function(t){return-1===e.userId.indexOf(t.uid)}))},t.updateIsShowVisitor=function(){var e=R.q.getConfig("canEdit"),t=this.state.users.size>1,n=this.browserList.length>1,r=!1;(e&&n||t)&&(r=!0),this.state.isShowVisitor=r,localStorage.setItem((0,c.o)(),String(this.browserList.length))},t.initBrowserList=function(){return D(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,x(void 0,void 0,void 0,regeneratorRuntime.mark((function e(){var t,n,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={pad_id:R.q.getConfig("padId"),domain_id:R.q.getConfig("domainId"),xsrf:(0,T.ej)("TOK"),t:(new Date).getTime()},e.prev=2,e.next=5,_().get("/cgi-bin/online_docs/browser_list",{params:t});case 5:if(n=e.sent,0!==(r=n.data).retcode){e.next=9;break}return e.abrupt("return",{total:r.total,operaters:r.operaters});case 9:e.next=14;break;case 11:e.prev=11,e.t0=e.catch(2),console.error(e.t0);case 14:case"end":return e.stop()}}),e,null,[[2,11]])})));case 2:if(t=e.sent){e.next=5;break}return e.abrupt("return");case 5:this.browserList=t.operaters,this.updateIsShowVisitor();case 7:case"end":return e.stop()}}),e,this)})))},t.injectStyle=function(){var e=document.createElement("style");e.setAttribute("type","text/css"),e.innerText="\n            #headerContainer { \n                display: none !important; \n            }\n            \n            @media (min-width: 640px) {\n                .mobile-pull-panel-v2 {\n                    top: 8px !important;\n                }\n            }\n        ",document.head.appendChild(e)},t.initHeader=function(){var e,t=this,r=function(){S.n.setActionButtons(t.getChangedConfigs()),t.isInitialized=!0};(null===(e=n.g.mqq)||void 0===e?void 0:e.invoke)?n.g.tdocs.getZoomState({success:function(e){t.state.splitType=e,r()}}):r()},t.updateHeader=function(){this.isFullScreenMode||this.isInitialized&&S.n.updateActionButtons(this.getChangedConfigs())},t.bindEvents=function(){var e,t,o;null===(t=null===(e=n.g.SLR)||void 0===e?void 0:e.listen)||void 0===t||t.call(e,"GET_DOCINFO_SUCCESS",this.handleGetDocInfo),null===(o=this.app)||void 0===o||o.sheetStatus.change(this.handleSheetStatusChange),r.ZP.view.listen("userJoinAfterFetch",this.updateUserlist),r.ZP.view.listen("userLeave",this.handleUserLeave),r.ZP.collabEvent.listen("updateCollab",this.updateIsShowCollaborator)},t.unbindEvents=function(){var e,t,o;null===(t=null===(e=n.g.SLR)||void 0===e?void 0:e.remove)||void 0===t||t.call(e,"GET_DOCINFO_SUCCESS",this.handleGetDocInfo),null===(o=this.app)||void 0===o||o.sheetStatus.offChange(this.handleSheetStatusChange),r.ZP.view.remove("userJoinAfterFetch",this.updateUserlist),r.ZP.view.remove("userLeave",this.handleUserLeave),r.ZP.collabEvent.remove("updateCollab",this.updateIsShowCollaborator)},e}())},"../spread-sheet/src/external/view/mobile/header/native-header/utils.ts":function(e,t,n){"use strict";n.d(t,{W:function(){return d},y:function(){return u}}),n("../node_modules/core-js/modules/es.regexp.exec.js"),n("../node_modules/core-js/modules/es.string.match.js");var r=n("../node_modules/@tencent/docs-user-agent/dist/index.js"),o=n.n(r),s=n("../packages/common-utils/src/index.ts"),i=n("../spread-sheet/src/external/view/mobile/header/native-header/const.ts"),a=n("../spread-sheet/src/base/util/domain-config.ts"),l=void 0;function d(){return void 0!==l?l:l=function(){var e,t;return((null===(t=null===(e=n.g.tdocs)||void 0===e?void 0:e.isWedocWebview)||void 0===t?void 0:t.call(e))||o().isTencentDocsApp)&&a.xc,!(!o().isTencentDocsApp||null===(0,s.ej)(i.GV).match(i.Je))}()}function u(){return!(!o().isTencentDocsApp||null===(0,s.ej)(i.GV).match(i.Je))}},"../spread-sheet/src/external/waterMark/watermark-generate.ts":function(e,t,n){"use strict";n.d(t,{jM:function(){return h},jS:function(){return i},sI:function(){return f}}),n("../node_modules/regenerator-runtime/runtime.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.promise.js");var r,o,s,i,a=n("../node_modules/i18next/dist/esm/i18next.js"),l=n("../spread-sheet/src/core/data/configService/spreadConfig.ts"),d=n("../spread-sheet/src/base/util/domain-config.ts"),u=n("../spread-sheet/src/external/waterMark/utils.ts"),c=function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function i(e){try{l(r.next(e))}catch(t){s(t)}}function a(e){try{l(r.throw(e))}catch(t){s(t)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,a)}l((r=r.apply(e,t||[])).next())}))};!function(e){e[e.DENSE=24]="DENSE",e[e.LOOSE=20]="LOOSE"}(r||(r={})),function(e){e[e.LOOSE=1]="LOOSE",e[e.DENSE=2]="DENSE"}(o||(o={})),function(e){e.COOP_ACTION="excel_watermark_cooperation",e.SUCESS_ACTION="excel_watermark_sucess",e.PEOPLE_MARK="people_mark",e.TEXT_MARK="text_mark",e.TEXT_PEOPLE="text&people_mark",e.TYPE_ACTION="excel_watermark_type",e.SELF_ACTION="excel_watermark_self",e.TYPE_LOOSE="loose",e.TYPE_TIGHT="tight"}(s||(s={})),function(e){e[e.SHOW=1]="SHOW",e[e.HIDE=0]="HIDE"}(i||(i={}));var h={watermarkFontColor:"#999999",watermarkFontFamily:a.ZP.t("微软雅黑"),watermarkFontSize:r.DENSE,isForceSetFontSize:!0,denseLineHeightRatio:7,looseLineHeightRatio:5,isShowVisitorToast:!d.xc},f=function(){function e(){this.pageSize={width:2e3,height:793},this.watermarkOptions=h}var t=e.prototype;return t.generate=function(e){return void 0===e&&(e=!0),c(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n,s,i,a,d,c,h,f,p,g;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if((n=l.q.getConfig("watermark"))||(n='{"type":"text","text":"","marginType":0,"selfHide":0,"show":0,"s":{"private":0}}'),s=(0,u.gN)(n)){t.next=5;break}return t.abrupt("return");case 5:return i={isAuthor:l.q.getConfig("isCreator"),userName:l.q.getConfig("userName"),userDomain:l.q.getConfig("userDomain")},this.updatePagesDocs(),this.reportDataWM(s),s.marginType===o.LOOSE&&(this.watermarkOptions.watermarkFontSize=r.LOOSE),this.watermarkOptions.isShowVisitorToast=e,t.next=12,(0,u.iY)();case 12:return a=t.sent,d=a.GenerateSVG,c=d.watermarkGetSVG(n,this.pageSize,i,this.watermarkOptions),h=c.base64Data,f=c.base64NickData,p=c.canvasHeight,g=c.lineHeight,t.abrupt("return",{base64Data:h,base64NickData:f,canvasHeight:p,lineHeight:g});case 16:case"end":return t.stop()}}),t,this)})))},t.reportDataWM=function(e){l.q.getConfig("isCreator")||(0,u.xk)({action:s.COOP_ACTION}),(0,u.xk)({action:s.SUCESS_ACTION});var t="";(0,u.CC)(e)?t=(0,u.eG)(e)?s.TEXT_PEOPLE:s.TEXT_MARK:(0,u.eG)(e)&&(t=s.PEOPLE_MARK);var n=e.marginType===o.LOOSE?s.TYPE_LOOSE:s.TYPE_TIGHT;(0,u.xk)({action:s.TYPE_ACTION,ver10:t,ver11:n}),e.selfHide===i.SHOW&&(0,u.xk)({action:s.SELF_ACTION})},t.updatePagesDocs=function(){var e=document.getElementById("canvasContainer"),t=screen.width,n=screen.height;if(null!==e){var r=e.getBoundingClientRect();r.width>0&&(this.pageSize.width=Math.max(r.width,t)),r.height>0&&(this.pageSize.height=Math.max(r.height,n))}},e}()},"../node_modules/raw-loader/dist/cjs.js!../spread-sheet/src/external/view/main/footer/footer-ssr/common/footer-common-style.css":function(e,t){"use strict";t.Z=".mobile #pcFooterSSRContainer,\n.mobile #padFooterSSRContainer,\n.pad #mobileFooterSSRContainer,\n.pad #pcFooterSSRContainer,\n.pc #padFooterSSRContainer,\n.pc #mobileFooterSSRContainer\n{\n    display: none;\n}\n\n.addbutton-bg-ssr {\n    background-image: url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjQiIGhlaWdodD0iMjQiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiPjxkZWZzPjxwYXRoIGQ9Ik0xMyA1djZoNnYyaC02djZoLTJ2LTZINXYtMmg2VjVoMnoiIGlkPSJhIi8+PC9kZWZzPjx1c2UgZmlsbD0iIzQ2NEQ1QSIgeGxpbms6aHJlZj0iI2EiIGZpbGwtcnVsZT0iZXZlbm9kZCIvPjwvc3ZnPg==);\n}\n\n/* PrivilegeType.NO_PRIVILEGE */\ndiv[privilegetype='0'] .footer-can-edit-ssr-pc, \ndiv[privilegetype='0'] .footer-can-edit-ssr-pad,\ndiv[privilegetype='0'] .footer-can-edit-ssr-mobile\n{\n    display: none;\n}\n\n/* PrivilegeType.READABLE */\ndiv[privilegetype='1'] .footer-can-edit-ssr-pc,\ndiv[privilegetype='1'] .footer-can-edit-ssr-pad,\ndiv[privilegetype='1'] .footer-can-edit-ssr-mobile\n{\n    display: none;\n}\n\n/* PrivilegeType.EDITABLE */\ndiv[privilegetype='2'] .footer-can-read-ssr-pc,\ndiv[privilegetype='2'] .footer-can-read-ssr-pad,\ndiv[privilegetype='2'] .footer-can-read-ssr-mobile\n{\n    display: none;\n}\n\n/* PrivilegeType.ADMINISTRATOR */\ndiv[privilegetype='1024'] .footer-can-read-ssr-pc,\ndiv[privilegetype='1024'] .footer-can-read-ssr-pad,\ndiv[privilegetype='1024'] .footer-can-read-ssr-mobile\n{\n    display: none;\n}\n\n/* PrivilegeType.OWNER */\ndiv[privilegetype='2048'] .footer-can-read-ssr-pc,\ndiv[privilegetype='2048'] .footer-can-read-ssr-pad,\ndiv[privilegetype='2048'] .footer-can-read-ssr-mobile\n{\n    display: none;\n}\n"},"../node_modules/raw-loader/dist/cjs.js!../spread-sheet/src/external/view/main/footer/footer-ssr/mobile-footer-ssr/components/add-button/index.css":function(e,t){"use strict";t.Z=".sheetbar-add-btn-mobile {\n    flex-shrink: 0;\n    position: absolute;\n    right: 0;\n    height: 34px;\n    width: 39px;\n    background-position: 50%;\n    background-repeat: no-repeat;\n    background-image: url(\"data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjQiIGhlaWdodD0iMjQiIHZpZXdCb3g9IjAgMCAyNCAyNCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPGcgaWQ9IiYjMjI5OyYjMTg2OyYjMTQ5OyYjMjMzOyYjMTMxOyYjMTY4OyYjMjMwOyYjMTYwOyYjMTQzOy9Nb2JpbGVfJiMyMzA7JiMxNTA7JiMxNzY7JiMyMjk7JiMxNjI7JiMxNTg7JiMyMjk7JiMxODM7JiMxNjU7JiMyMjg7JiMxODk7JiMxNTY7JiMyMzI7JiMxNjE7JiMxNjg7Ij4KPHBhdGggaWQ9IiYjMjI5OyYjMTg5OyYjMTYyOyYjMjMxOyYjMTM4OyYjMTgyOyYjMjMxOyYjMTg3OyYjMTQ3OyYjMjI5OyYjMTQ0OyYjMTM2OyIgZmlsbC1ydWxlPSJldmVub2RkIiBjbGlwLXJ1bGU9ImV2ZW5vZGQiIGQ9Ik0xMi43NSA1SDExLjI1VjExLjI1SDVWMTIuNzVIMTEuMjVWMTlIMTIuNzVWMTIuNzVIMTlWMTEuMjVIMTIuNzVWNVoiIGZpbGw9IiM0NTRENUEiLz4KPC9nPgo8L3N2Zz4K\");\n    background-color: rgb(244, 245, 249);\n    background-size: 28px 28px;\n}\n\n.sheetbar-add-btn-mobile::after {\n    content: '';\n    position: absolute;\n    left: 0;\n    top: 0;\n    bottom: 0;\n    width: 1px;\n    transform: scaleX(0.5);\n    transform-origin: right;\n    background: #e2e4e5;\n}\n"},"../node_modules/raw-loader/dist/cjs.js!../spread-sheet/src/external/view/main/footer/footer-ssr/mobile-footer-ssr/components/sheet-tab/index.css":function(e,t){"use strict";t.Z=".sheet-tab-mobile {\n    position: relative;\n    align-items: center;\n    box-sizing: border-box;\n    padding: 8px 10px;\n    cursor: pointer;\n    -webkit-tap-highlight-color: transparent;\n}\n\n.sheet-tab-mobile::after {\n    content: '';\n    position: absolute;\n    right: 0;\n    top: 0;\n    bottom: 0;\n    width: 1px;\n    transform: scaleX(0.5);\n    transform-origin: right;\n    background: #e1e3e4;\n}\n\n.sheet-tab-mobile .sheet-tab-icon {\n    min-width: 23px;\n    height: 23px;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    background-repeat: no-repeat;\n    background-position: center;\n    background-size: 100%;\n}\n\n.sheet-tab-focus-mobile {\n    max-width: 170px;\n    background-color: #fff;\n    font-weight: 500;\n    cursor: default;\n}\n\n.sheet-tab-name-mobile {\n    position: relative;\n    top: .5px;\n    display: block;\n    box-sizing: border-box;\n    overflow: hidden;\n    height: 19px;\n    max-width: 147px;\n    padding: 0;\n    font-size: 14px;\n    color: #777;\n    text-overflow: ellipsis;\n    white-space: nowrap;\n    font-family: Microsoft YaHei, Verdana, sans-serif;\n}\n\n.sheet-tab-focus-mobile .sheet-tab-name-mobile {\n    color: rgba(0, 0, 0, 0.88);\n    top: .5px;\n}\n"},"../node_modules/raw-loader/dist/cjs.js!../spread-sheet/src/external/view/main/footer/footer-ssr/mobile-footer-ssr/components/sheetbar-head/index.css":function(e,t){"use strict";t.Z=".sheetbar-head-icon-mobile {\n    flex-shrink: 0;\n    background-image: url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjQiIGhlaWdodD0iMjQiIHZpZXdCb3g9IjAgMCAyNCAyNCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPGcgaWQ9IiYjMjI5OyYjMTg2OyYjMTQ5OyYjMjMzOyYjMTMxOyYjMTY4OyYjMjMwOyYjMTYwOyYjMTQzOy9Nb2JpbGVfJiMyMzA7JiMxMzc7JiMxMjg7JiMyMzA7JiMxNTY7JiMxMzc7JiMyMjk7JiMxODM7JiMxNjU7JiMyMjg7JiMxODk7JiMxNTY7JiMyMzI7JiMxNjE7JiMxNjg7Ij4KPHBhdGggaWQ9IlVuaW9uIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiIGNsaXAtcnVsZT0iZXZlbm9kZCIgZD0iTTIwLjQwNzUgOS43NDEyN0MyMC42NjA5IDkuNjEzOTkgMjAuODIwOSA5LjM1NDY0IDIwLjgyMDkgOS4wNzEwNEMyMC44MjA5IDguNzg3NDQgMjAuNjYwOSA4LjUyODEgMjAuNDA3NSA4LjQwMDgyTDEyLjM3MTkgNC4zNjUyN0MxMi4xNjAyIDQuMjU4OTEgMTEuOTEwNSA0LjI1ODkxIDExLjY5ODggNC4zNjUyN0wzLjY2MzIxIDguNDAwODJDMy40MDk3NyA4LjUyODEgMy4yNDk4MSA4Ljc4NzQ0IDMuMjQ5ODEgOS4wNzEwNEMzLjI0OTgxIDkuMzU0NjQgMy40MDk3NyA5LjYxMzk5IDMuNjYzMjEgOS43NDEyN0wxMS42OTg4IDEzLjc3NjhDMTEuOTEwNSAxMy44ODMyIDEyLjE2MDIgMTMuODgzMiAxMi4zNzE5IDEzLjc3NjhMMjAuNDA3NSA5Ljc0MTI3Wk01LjY3MDk1IDkuMDcxMDRMMTIuMDM1NCA1Ljg3NDc3TDE4LjM5OTggOS4wNzEwNEwxMi4wMzU0IDEyLjI2NzNMNS42NzA5NSA5LjA3MTA0Wk0yMC40MDc1IDE0LjcwNTdDMjAuNzc3NiAxNC41MTk5IDIwLjkyNyAxNC4wNjkxIDIwLjc0MTEgMTMuNjk4OUMyMC41NTUyIDEzLjMyODggMjAuMTA0NSAxMy4xNzk0IDE5LjczNDMgMTMuMzY1M0wxMi4wMzU0IDE3LjIzMThMNC4zMzY0IDEzLjM2NTNDMy45NjYyNSAxMy4xNzk0IDMuNTE1NDggMTMuMzI4OCAzLjMyOTU4IDEzLjY5ODlDMy4xNDM2OCAxNC4wNjkxIDMuMjkzMDUgMTQuNTE5OSAzLjY2MzIxIDE0LjcwNTdMMTEuNjk4OCAxOC43NDEzQzExLjkxMDUgMTguODQ3NyAxMi4xNjAyIDE4Ljg0NzcgMTIuMzcxOSAxOC43NDEzTDIwLjQwNzUgMTQuNzA1N1oiIGZpbGw9IiM0NTRENUEiLz4KPC9nPgo8L3N2Zz4K);\n    background-size: 28px 28px;\n    background-position: 50%;\n    background-repeat: no-repeat;\n    box-sizing: border-box;\n    user-select: none;\n    height: 35px;\n    width: 49px;\n    display: block;\n    background-color: rgb(244, 245, 249);\n    border-right: 1px solid #e1e3e4;\n    position: relative;\n}\n"},"../node_modules/raw-loader/dist/cjs.js!../spread-sheet/src/external/view/main/footer/footer-ssr/mobile-footer-ssr/index.css":function(e,t){"use strict";t.Z="#mobileFooterSSRContainer {\n    position: absolute;\n    top: 0;\n}\n\n#ssrContainerWrapper.mobile .DTable {\n    top: 36px;\n}\n\n.sheet-bar-container-mobile {\n    padding: 0px;\n    margin: 0px;\n    display: flex;\n    align-items: center;\n    position: absolute;\n    z-index: 1202;\n    width: 100vw;\n    background-color: rgb(244, 245, 249);\n    border-top: 1px solid #e1e3e4;\n    border-bottom: 1px solid #e1e3e4;\n}\n\n.sheetbar-list-wrapper-mobile {\n    overflow: hidden;\n}\n\n.sheetbar-list-mobile {\n    display: flex;\n}\n"},"../node_modules/raw-loader/dist/cjs.js!../spread-sheet/src/external/view/main/footer/footer-ssr/pad-footer-ssr/components/add-button/index.css":function(e,t){"use strict";t.Z=".sheetbar-add-btn-pad {\n    flex-shrink: 0;\n    position: relative;\n    top: -1.5px;\n    width: 44px;\n    height: 43px;\n    background-position: 50%;\n    background-repeat: no-repeat;\n    background-image: url(\"data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjQiIGhlaWdodD0iMjQiIHZpZXdCb3g9IjAgMCAyNCAyNCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPGcgaWQ9IiYjMjI5OyYjMTg2OyYjMTQ5OyYjMjMzOyYjMTMxOyYjMTY4OyYjMjMwOyYjMTYwOyYjMTQzOy9Nb2JpbGVfJiMyMzA7JiMxNTA7JiMxNzY7JiMyMjk7JiMxNjI7JiMxNTg7JiMyMjk7JiMxODM7JiMxNjU7JiMyMjg7JiMxODk7JiMxNTY7JiMyMzI7JiMxNjE7JiMxNjg7Ij4KPHBhdGggaWQ9IiYjMjI5OyYjMTg5OyYjMTYyOyYjMjMxOyYjMTM4OyYjMTgyOyYjMjMxOyYjMTg3OyYjMTQ3OyYjMjI5OyYjMTQ0OyYjMTM2OyIgZmlsbC1ydWxlPSJldmVub2RkIiBjbGlwLXJ1bGU9ImV2ZW5vZGQiIGQ9Ik0xMi43NSA1SDExLjI1VjExLjI1SDVWMTIuNzVIMTEuMjVWMTlIMTIuNzVWMTIuNzVIMTlWMTEuMjVIMTIuNzVWNVoiIGZpbGw9IiM0NTRENUEiLz4KPC9nPgo8L3N2Zz4K\");\n    background-size: 28px 28px;\n}\n\n.sheetbar-add-btn-pad::after {\n    content: '';\n    position: absolute;\n    left: 0;\n    top: 0;\n    bottom: 0;\n    width: 1px;\n    transform: scaleX(0.5);\n    transform-origin: right;\n    background: #e2e4e5;\n}\n"},"../node_modules/raw-loader/dist/cjs.js!../spread-sheet/src/external/view/main/footer/footer-ssr/pad-footer-ssr/components/sheet-tab/index.css":function(e,t){"use strict";t.Z=".sheet-tab-pad {\n    display: flex;\n    align-items: center;\n    z-index: 0;\n    top: -1px;\n    max-width: 170px;\n    color: rgba(0, 0, 0, 0.48);\n    background-color: #f0f0f0;\n    height: 43px;\n    border-bottom: 0;\n    position: relative;\n    border-left: none;\n    border-top: 1px solid #e0e0e0;\n}\n\n.sheet-tab-pad::after {\n    content: '';\n    position: absolute;\n    right: 0;\n    top: 0;\n    bottom: 0;\n    width: 1px;\n    transform: scaleX(0.5);\n    transform-origin: right;\n    background: #e2e4e5;\n}\n\n.sheet-tab-pad .sheet-tab-icon {\n    min-width: 23px;\n    height: 23px;\n    margin-left: 6px;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    background-repeat: no-repeat;\n    background-position: center;\n    background-size: 100%;\n}\n\n.sheet-tab-name-pad {\n    display: block;\n    float: left;\n    border: 0;\n    font-family: Microsoft YaHei, Verdana, sans-serif;\n    cursor: inherit;\n    max-width: 147px;\n    padding: 0 10px;\n    margin: 11px 0;\n    box-sizing: border-box;\n    height: 21px;\n    font-size: 16px;\n    line-height: 21px;\n    text-overflow: ellipsis;\n    overflow: hidden;\n    color: #777;\n    white-space: nowrap;\n}\n\n.sheet-tab-focus-pad {\n    background-color: rgba(255, 255, 255, 1);\n    cursor: default;\n}\n\n.sheet-tab-focus-pad .sheet-tab-name-pad {\n    color: rgba(0, 0, 0, 0.88);\n}\n\n@media (min-width: 640px) {\n    .sheet-tab-name-pad {\n        padding: 0 15px;\n    }\n}\n"},"../node_modules/raw-loader/dist/cjs.js!../spread-sheet/src/external/view/main/footer/footer-ssr/pad-footer-ssr/components/sheetbar-head/index.css":function(e,t){"use strict";t.Z=".sheetbar-head-icon-pad {\n    position: relative;\n    top: .5px;\n    flex-shrink: 0;\n    width: 44px;\n    height: 43px;\n    background-image: url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjQiIGhlaWdodD0iMjQiIHZpZXdCb3g9IjAgMCAyNCAyNCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPGcgaWQ9IiYjMjI5OyYjMTg2OyYjMTQ5OyYjMjMzOyYjMTMxOyYjMTY4OyYjMjMwOyYjMTYwOyYjMTQzOy9Nb2JpbGVfJiMyMzA7JiMxMzc7JiMxMjg7JiMyMzA7JiMxNTY7JiMxMzc7JiMyMjk7JiMxODM7JiMxNjU7JiMyMjg7JiMxODk7JiMxNTY7JiMyMzI7JiMxNjE7JiMxNjg7Ij4KPHBhdGggaWQ9IlVuaW9uIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiIGNsaXAtcnVsZT0iZXZlbm9kZCIgZD0iTTIwLjQwNzUgOS43NDEyN0MyMC42NjA5IDkuNjEzOTkgMjAuODIwOSA5LjM1NDY0IDIwLjgyMDkgOS4wNzEwNEMyMC44MjA5IDguNzg3NDQgMjAuNjYwOSA4LjUyODEgMjAuNDA3NSA4LjQwMDgyTDEyLjM3MTkgNC4zNjUyN0MxMi4xNjAyIDQuMjU4OTEgMTEuOTEwNSA0LjI1ODkxIDExLjY5ODggNC4zNjUyN0wzLjY2MzIxIDguNDAwODJDMy40MDk3NyA4LjUyODEgMy4yNDk4MSA4Ljc4NzQ0IDMuMjQ5ODEgOS4wNzEwNEMzLjI0OTgxIDkuMzU0NjQgMy40MDk3NyA5LjYxMzk5IDMuNjYzMjEgOS43NDEyN0wxMS42OTg4IDEzLjc3NjhDMTEuOTEwNSAxMy44ODMyIDEyLjE2MDIgMTMuODgzMiAxMi4zNzE5IDEzLjc3NjhMMjAuNDA3NSA5Ljc0MTI3Wk01LjY3MDk1IDkuMDcxMDRMMTIuMDM1NCA1Ljg3NDc3TDE4LjM5OTggOS4wNzEwNEwxMi4wMzU0IDEyLjI2NzNMNS42NzA5NSA5LjA3MTA0Wk0yMC40MDc1IDE0LjcwNTdDMjAuNzc3NiAxNC41MTk5IDIwLjkyNyAxNC4wNjkxIDIwLjc0MTEgMTMuNjk4OUMyMC41NTUyIDEzLjMyODggMjAuMTA0NSAxMy4xNzk0IDE5LjczNDMgMTMuMzY1M0wxMi4wMzU0IDE3LjIzMThMNC4zMzY0IDEzLjM2NTNDMy45NjYyNSAxMy4xNzk0IDMuNTE1NDggMTMuMzI4OCAzLjMyOTU4IDEzLjY5ODlDMy4xNDM2OCAxNC4wNjkxIDMuMjkzMDUgMTQuNTE5OSAzLjY2MzIxIDE0LjcwNTdMMTEuNjk4OCAxOC43NDEzQzExLjkxMDUgMTguODQ3NyAxMi4xNjAyIDE4Ljg0NzcgMTIuMzcxOSAxOC43NDEzTDIwLjQwNzUgMTQuNzA1N1oiIGZpbGw9IiM0NTRENUEiLz4KPC9nPgo8L3N2Zz4K);\n    background-position: 50% 50%;\n    background-repeat: no-repeat;\n    background-size: 28px 28px;\n    block-size: 43px;\n    box-sizing: border-box;\n    font-size: 13px;\n    perspective-origin: 22px 21.5px;\n    transform-origin: 22px 21.5px;\n    user-select: none;\n}\n"},"../node_modules/raw-loader/dist/cjs.js!../spread-sheet/src/external/view/main/footer/footer-ssr/pad-footer-ssr/index.css":function(e,t){"use strict";t.Z="#padFooterSSRContainer {\n    position: fixed;\n    bottom: 0;\n    display: block;\n    height: 45px;\n    width: 100%;\n    border-top: 0;\n    z-index: 1;\n    background-color: rgb(240, 240, 240);\n    padding-bottom: env(safe-area-inset-bottom);\n}\n\n.sheet-bar-container-pad {\n    padding: 0px;\n    margin: 0px;\n    display: flex;\n    align-items: center;\n    position: absolute;\n    z-index: 1202;\n    width: 100vw;\n    background-color: #f0f0f0;\n    border-top: 1px solid #e1e3e4;\n    border-bottom: 1px solid #e1e3e4;\n}\n\n.sheet-tab-list-wrapper-pad {\n    overflow: hidden;\n    border-left: 1px solid rgb(218, 219, 218);\n}\n\n.sheet-tab-list-pad {\n    display: flex;\n}\n"},"../node_modules/raw-loader/dist/cjs.js!../spread-sheet/src/external/view/main/footer/footer-ssr/pc-footer-ssr/components/add/index.css":function(e,t){"use strict";t.Z=".addbutton-pc-ssr {\n    border-right: none !important;\n    z-index: 10002;\n    height: 32px;\n    width: 32px;\n    user-select: none;\n    position: relative;\n    box-sizing: border-box;\n    font-size: 0;\n    background-size: 24px 24px;\n    background-repeat: no-repeat;\n    background-position: center;\n    position: absolute;\n    left: 16px;\n}\n"},"../node_modules/raw-loader/dist/cjs.js!../spread-sheet/src/external/view/main/footer/footer-ssr/pc-footer-ssr/components/full-and-scale/index.css":function(e,t){"use strict";t.Z=".full-and-scale-wrap-ssr {\n    position: absolute;\n    top: 1px;\n    bottom: 2px;\n    right: 17px;\n    font-size: 12px;\n}\n.fullscreenbar-ssr {\n    margin-left: 0;\n    display: inline-block;\n    vertical-align: middle;\n}\n.fullscreenbar-disabled {\n    opacity: 0.2;\n}\n.fullscreenbar__button-ssr {\n    padding: 3px;\n    width: 24px;\n    height: 24px;\n    background-size: 18px 18px;\n    background-position: 3px 3px;\n    background-repeat: no-repeat;\n    border-radius: 1px;\n}\n.fullscreenbar__button-ssr svg {\n    width: 100%;\n    height: 100%;\n    fill: #5c5c5c;\n}\n.scalebar-ssr {\n    display: inline-block;\n    vertical-align: middle;\n    height: 30px;\n    line-height: 30px;\n    margin-left: 13px;\n    font-weight: 700;\n    user-select: none;\n    color: rgba(0, 0, 0, 0.64);\n}\n.scalebar__zoom {\n    width: 14px;\n    height: 100%;\n    padding: 0 3px;\n}\n.scalebar-ssr > * {\n    position: relative;\n    display: inline-block;\n    vertical-align: top;\n}\n.scalebar__zoom-btn,\n.scalebar__zoom-btn--vertical {\n    position: absolute;\n    background-color: #464d5a;\n    background-clip: padding-box;\n}\n.scalebar__zoom-btn {\n    top: 6px;\n    left: 6px;\n    width: 10px;\n    height: 2px;\n    border-top: 5px solid transparent;\n    border-bottom: 5px solid transparent;\n}\n.scalebar__progress {\n    width: 38px;\n    margin-left: 2px;\n    cursor: pointer;\n    text-align: center;\n    padding: 0 6px;\n}\n.scalebar__progress .content {\n    height: 100%;\n    margin-left: -2px;\n    display: inline-block;\n    font-family: Helvetica Neue,Helvetica,PingFang SC,Microsoft YaHei,Source Han Sans SC,Noto Sans CJK SC,WenQuanYi Micro Hei,sans-serif;\n}\n.scalebar__zoom {\n    width: 14px;\n    height: 100%;\n    padding: 0 3px;\n}\n.scalebar__zoom-btn,\n.scalebar__zoom-btn--vertical {\n    position: absolute;\n    background-color: #464d5a;\n    background-clip: padding-box;\n}\n.scalebar__zoom-btn--vertical {\n    top: 7px;\n    left: 7px;\n    width: 2px;\n    height: 10px;\n    border-left: 3px solid transparent;\n    border-right: 5px solid transparent;\n}\n.scalebar__zoom-btn,\n.scalebar__zoom-btn--vertical {\n    position: absolute;\n    background-color: #464d5a;\n    background-clip: padding-box;\n}\n\n.scalebar-ssr .scalebar__zoom {\n    left: 1px;\n    top: 3px;\n}\n\n.scalebar-ssr .scalebar__progress {\n    left: 2px;\n}\n\n.arrow-wrapper-ssr {\n    display: none;\n    width: 6px;\n    height: 6px;\n    background-image: url(data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMjRweCIgaGVpZ2h0PSIyNHB4IiB2aWV3Qm94PSIwIDAgMjQgMjQiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDYzLjEgKDkyNDUyKSAtIGh0dHBzOi8vc2tldGNoLmNvbSAtLT4KICAgIDx0aXRsZT5ib3R0b21iYXJfc2hlZXRfcGFnZV9kb3duPC90aXRsZT4KICAgIDxkZXNjPkNyZWF0ZWQgd2l0aCBTa2V0Y2guPC9kZXNjPgogICAgPGcgaWQ9ImJvdHRvbWJhcl9zaGVldF9wYWdlX2Rvd24iIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxyZWN0IGlkPSLnn6nlvaIiIGZpbGw9IiNEOUQ5RDkiIG9wYWNpdHk9IjAiIHg9IjAiIHk9IjAiIHdpZHRoPSIyNCIgaGVpZ2h0PSIyNCI+PC9yZWN0PgogICAgICAgIDxwb2x5Z29uIGlkPSLkuInop5LlvaIiIGZpbGw9IiM0NjRENUEiIHBvaW50cz0iMTYgMTIgMTAgMTYgMTAgOCI+PC9wb2x5Z29uPgogICAgPC9nPgo8L3N2Zz4=);\n    fill: #81868f;\n    background-size: 18px 18px;\n    background-position: center;\n    background-repeat: no-repeat;\n    transition: all 0.3s;\n    transform: rotate(90deg);\n    overflow: hidden;\n    vertical-align: middle;\n}\n\n@media screen and (max-width: 800px) {\n    .scalebar-ssr {\n        display: none;\n    }\n    .highlight-ssr {\n        right: 50px !important;\n    }\n    .highlight-ssr:after {\n        display: none !important;\n    }\n    .arrow-wrapper-ssr {\n        display: inline-block;\n    }\n    .full-and-scale-wrap-ssr {\n        right: 17px;\n    }\n}\n"},"../node_modules/raw-loader/dist/cjs.js!../spread-sheet/src/external/view/main/footer/footer-ssr/pc-footer-ssr/components/highlight/index.css":function(e,t){"use strict";t.Z=".highlight-ssr {\n    position: absolute;\n    bottom: 4px;\n    display: inline-block;\n    vertical-align: middle;\n    height: 24px;\n    cursor: pointer;\n    box-sizing: border-box;\n    font-size: 0;\n    border-radius: 2px;\n    right: 172px;\n}\n.highlight-ssr .light-switch-ssr {\n    display: inline-block;\n    width: 24px;\n    height: 100%;\n    background-image: url(data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMjRweCIgaGVpZ2h0PSIyNHB4IiB2aWV3Qm94PSIwIDAgMjQgMjQiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8dGl0bGU+Ym90dG9tYmFyX2V4Y2VsX2hpZ2hsaWdodDwvdGl0bGU+CiAgICA8ZyBpZD0iUEMiIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxnIGlkPSJQQy/lupXpg6jmoI8v6auY5Lqu5b2T5YmN6KGM5YiXIiBmaWxsLXJ1bGU9Im5vbnplcm8iPgogICAgICAgICAgICA8ZyBpZD0i57yW57uEIj4KICAgICAgICAgICAgICAgIDxwb2x5Z29uIGlkPSLot6/lvoQiIGZpbGw9IiNDQkNERDEiIHBvaW50cz0iMTQgNCAxNCAxMCAxOSAxMCAxOSAxMyAxNCAxMyAxNCAxOCAxMSAxOCAxMSAxMi45OTkwNzE0IDUgMTMgNSAxMCAxMSA5Ljk5OTA3MTQzIDExIDQiPjwvcG9seWdvbj4KICAgICAgICAgICAgICAgIDxwYXRoIGQ9Ik0xOS4wNjI1LDQgQzE5LjU4MDI2Nyw0IDIwLDQuNDE5NzMzMDUgMjAsNC45Mzc1IEwyMCwxOC4wNjI1IEMyMCwxOC41ODAyNjcgMTkuNTgwMjY3LDE5IDE5LjA2MjUsMTkgTDUuOTM3NSwxOSBDNS40MTk3MzMwNSwxOSA1LDE4LjU4MDI2NyA1LDE4LjA2MjUgTDUsNC45Mzc1IEM1LDQuNDE5NzMzMDUgNS40MTk3MzMwNSw0IDUuOTM3NSw0IEwxOS4wNjI1LDQgWiBNNi4yLDE3LjggTDEwLDE3LjggTDEwLDE0IEw2LjIsMTQgTDYuMiwxNy44IFogTTE0LDUuMiBMMTEsNS4yIEwxMSwxMCBMNi4yLDEwIEw2LjIsMTMgTDExLDEzIEwxMSwxNy44IEwxNCwxNy44IEwxNCwxMyBMMTguOCwxMyBMMTguOCwxMCBMMTQsMTAgTDE0LDUuMiBaIE0xOC44LDE0IEwxNSwxNCBMMTUsMTcuOCBMMTguOCwxNy44IEwxOC44LDE0IFogTTE4LjgsOSBMMTguOCw1LjIgTDE1LDUuMiBMMTUsOSBMMTguOCw5IFogTTEwLDUuMiBMNi4yLDUuMiBMNi4yLDkgTDEwLDkgTDEwLDUuMiBaIiBpZD0i5b2i54q257uT5ZCIIiBmaWxsPSIjNDY0RDVBIj48L3BhdGg+CiAgICAgICAgICAgIDwvZz4KICAgICAgICA8L2c+CiAgICA8L2c+Cjwvc3ZnPg==);\n    background-size: 24px 24px;\n    background-position: center;\n    background-repeat: no-repeat;\n    line-height: 24px;\n    vertical-align: middle;\n}\n.highlight-ssr .color-switch-ssr {\n    display: inline-block;\n    width: 16px;\n    height: 100%;\n    text-align: center;\n    line-height: 24px;\n    overflow: hidden;\n    padding: 0px 4px 0px 0px;\n    box-sizing: border-box;\n    vertical-align: middle;\n}\n.color-switch-ssr .arrow-wrapper-ssr {\n    display: inline-block;\n    width: 6px;\n    height: 6px;\n    background-image: url(data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMjRweCIgaGVpZ2h0PSIyNHB4IiB2aWV3Qm94PSIwIDAgMjQgMjQiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDYzLjEgKDkyNDUyKSAtIGh0dHBzOi8vc2tldGNoLmNvbSAtLT4KICAgIDx0aXRsZT5ib3R0b21iYXJfc2hlZXRfcGFnZV9kb3duPC90aXRsZT4KICAgIDxkZXNjPkNyZWF0ZWQgd2l0aCBTa2V0Y2guPC9kZXNjPgogICAgPGcgaWQ9ImJvdHRvbWJhcl9zaGVldF9wYWdlX2Rvd24iIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxyZWN0IGlkPSLnn6nlvaIiIGZpbGw9IiNEOUQ5RDkiIG9wYWNpdHk9IjAiIHg9IjAiIHk9IjAiIHdpZHRoPSIyNCIgaGVpZ2h0PSIyNCI+PC9yZWN0PgogICAgICAgIDxwb2x5Z29uIGlkPSLkuInop5LlvaIiIGZpbGw9IiM0NjRENUEiIHBvaW50cz0iMTYgMTIgMTAgMTYgMTAgOCI+PC9wb2x5Z29uPgogICAgPC9nPgo8L3N2Zz4=);\n    fill: #81868f;\n    background-size: 18px 18px;\n    background-position: center;\n    background-repeat: no-repeat;\n    transition: all 0.3s;\n    transform: rotate(90deg);\n    overflow: hidden;\n    vertical-align: middle;\n}\n.highlight-ssr:after {\n    position: absolute;\n    content: '';\n    margin-left: 8px;\n    height: 16px;\n    display: inline-block;\n    width: 1px;\n    background-color: rgba(0, 0, 0, 0.12);\n    vertical-align: middle;\n    margin-top: 4px;\n}\n"},"../node_modules/raw-loader/dist/cjs.js!../spread-sheet/src/external/view/main/footer/footer-ssr/pc-footer-ssr/components/scroll/index.css":function(e,t){"use strict";t.Z=".sheetscroll-ssr {\n    position: absolute;\n    right: 277px;\n    bottom: 0;\n    width: 72px;\n    height: 100%;\n    box-sizing: border-box;\n    box-shadow: -7px 3px 12px 0 rgb(0 0 0 / 8%);\n}\n.sheetscroll-ssr .sheetscrollleft {\n    height: 32px;\n    width: 32px;\n    margin-left: 8px;\n    margin-top: 1px;\n    display: inline-block;\n    cursor: pointer;\n    position: relative;\n}\n.sheetscroll-ssr .sheetscrollleft .sheetscrollleft-icon {\n    width: 32px;\n    height: 32px;\n    background-size: 24px 24px;\n    background-image: url('data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjRweCIgaGVpZ2h0PSIyNHB4IiB2aWV3Qm94PSIwIDAgMjQgMjQiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+PGcgaWQ9ImJvdHRvbWJhcl9zaGVldF9wYWdlX3VwIiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj48cmVjdCBpZD0i55+p5b2i5aSH5Lu9IiBmaWxsPSIjRDlEOUQ5IiBvcGFjaXR5PSIwIiB4PSIwIiB5PSIwIiB3aWR0aD0iMjQiIGhlaWdodD0iMjQiPjwvcmVjdD48cG9seWdvbiBpZD0i5LiJ6KeS5b2i5aSH5Lu9IiBmaWxsPSIjNDY0RDVBIiBwb2ludHM9IjkgMTIgMTUgMTYgMTUgOCI+PC9wb2x5Z29uPjwvZz48L3N2Zz4=');\n    background-repeat: no-repeat;\n    background-position: 50%;\n}\n.sheetscroll-ssr .sheetscrollright {\n    height: 32px;\n    width: 32px;\n    margin-top: 1px;\n    display: inline-block;\n    cursor: pointer;\n    position: relative;\n}\n.sheetscroll-ssr .sheetscrollright .sheetscrollright-icon {\n    width: 32px;\n    height: 32px;\n    background-image: url('data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjRweCIgaGVpZ2h0PSIyNHB4IiB2aWV3Qm94PSIwIDAgMjQgMjQiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+PGcgaWQ9ImJvdHRvbWJhcl9zaGVldF9wYWdlX2Rvd24iIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPjxyZWN0IGlkPSLnn6nlvaIiIGZpbGw9IiNEOUQ5RDkiIG9wYWNpdHk9IjAiIHg9IjAiIHk9IjAiIHdpZHRoPSIyNCIgaGVpZ2h0PSIyNCI+PC9yZWN0Pjxwb2x5Z29uIGlkPSLkuInop5LlvaIiIGZpbGw9IiM0NjRENUEiIHBvaW50cz0iMTYgMTIgMTAgMTYgMTAgOCI+PC9wb2x5Z29uPjwvZz48L3N2Zz4=');\n    background-size: 24px 24px;\n    background-repeat: no-repeat;\n    background-position: 50%;\n}\n"},"../node_modules/raw-loader/dist/cjs.js!../spread-sheet/src/external/view/main/footer/footer-ssr/pc-footer-ssr/index.css":function(e,t){"use strict";t.Z="#pcFooterSSRContainer {\n    width: 100%;\n    user-select: none;\n    z-index: 9995;\n    transition: 0.3s ease all;\n    position: fixed;\n    bottom: 0;\n    min-width: 512px;\n    left: 0;\n}\n.sheet-bar-container-pc {\n    width: 100%;\n    position: relative;\n    bottom: 0;\n    z-index: 9997;\n    background-color: #fff;\n    border-top: 1px solid #e0e0e0;\n    box-sizing: border-box;\n}\n.sheet-bar-container-pc .tsSheetbox-ssr {\n    position: relative;\n    width: 100%;\n    max-width: 100%;\n    z-index: 100;\n    height: 32px;\n    user-select: none;\n}\n.sheet-bar-container-pc .tsSheetbox-ssr .borderRightNone {\n    border-right: none !important;\n}\n.sheet-bar-container-pc .tsSheetbox-ssr .sheetListBoxIcon {\n    position: absolute;\n    left: 48px;\n    height: 32px;\n    width: 32px;\n    user-select: none;\n    z-index: 10002;\n}\n\n[privilegetype='1'] .sheet-bar-container-pc .tsSheetbox-ssr .sheetListBoxIcon {\n    left: 44px;\n}\n\n.sheet-bar-container-pc .sheetListBoxIcon {\n    background-image: url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='24' height='24' fill='none' fillRule='evenodd'%3E%3Cg stroke='%23464d5a' stroke-width='1.8' stroke-linejoin='round'%3E%3Cpath d='M12 5.778l7.556 4-7.556 4-7.556-4z'/%3E%3Cpath stroke-linecap='round' d='M19.556 14.667l-7.556 4-7.556-4'/%3E%3C/g%3E%3C/svg%3E\");\n    background-size: 24px 24px;\n    background-repeat: no-repeat;\n    background-position: 50%;\n    opacity: 1;\n}\n.sheet-bar-container-pc .tsSheetbox-ssr .scrollWrap-ssr {\n    position: absolute;\n    overflow: hidden;\n    left: 84px;\n    top: -1px;\n    height: 32px;\n    scroll-behavior: smooth;\n}\n.sheet-bar-container-pc .sheet-content-ssr {\n    display: flex;\n    width: 100%;\n    height: 100%;\n}\n.sheet-bar-container-pc .tsSheetbox-ssr .scrollWrap-ssr .sheet-content-ssr .sheet-box {\n    justify-content: center;\n    align-items: center;\n    height: 100%;\n}\n.sheet-bar-container-pc .tsSheetbox-ssr .scrollWrap-ssr .sheet-content-ssr .sheet {\n    position: relative;\n    margin-left: -1px;\n    display: flex;\n    box-sizing: border-box;\n    color: #e9e9e9;\n    user-select: none;\n    border-left: 1px solid #e0e0e0;\n    border-bottom: 1px solid #e0e0e0;\n    cursor: pointer;\n}\n\n.sheet-bar-container-pc .tsSheetbox-ssr .scrollWrap-ssr .sheet-content-ssr .sheet:last-child {\n    border-right: 1px solid #e0e0e0;\n}\n\n.sheet-bar-container-pc .tsSheetbox-ssr .scrollWrap-ssr .sheet-content-ssr .sheet:first-child {\n    margin-left: 0;\n}\n\n.sheet-bar-container-pc .sheet-tab-focus-ssr {\n    position: relative;\n    background-color: #fff;\n}\n\n.sheet-bar-container-pc .sheet-tab-focus-ssr .sheet-tab-name-ssr {\n    color: rgba(0, 0, 0, 0.88);\n}\n.sheet-bar-container-pc .sheet-tab-name-ssr {\n    display: block;\n    float: left;\n    font-size: 14px;\n    line-height: 14px;\n    padding: 4px 1px 5px;\n    border: 0;\n    height: 15px;\n    font-family: Microsoft YaHei, Verdana, sans-serif;\n    cursor: inherit;\n    text-overflow: ellipsis;\n    overflow: hidden;\n    white-space: nowrap;\n}\n.sheet-bar-container-pc .sheet-tab-focus-ssr:after {\n    content: '';\n    position: absolute;\n    width: 100%;\n    height: 2px;\n    background-color: #1e6fff;\n    left: 0;\n    bottom: 0;\n}\n\n.sheet-bar-container-pc .sheet-tab-blur-ssr {\n    border-top: 1px solid #e0e0e0;\n    background-color: #f9fafb;\n}\n\n.sheet-bar-container-pc .sheet-tab-blur-ssr .sheet-tab-name-ssr {\n    color: #777;\n}\n.sheet-bar-container-pc .hight-light-and-scale-wrapper {\n    background-color: #fff;\n    z-index: 101;\n    position: absolute;\n    right: 0;\n    width: 228px;\n    height: 32px;\n    bottom: 0;\n    box-sizing: border-box;\n}\n.sheet-bar-container-pc .sheet-tab-icon {\n    min-width: 23px;\n    height: 23px;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    background-repeat: no-repeat;\n    background-position: 50%;\n    background-size: 100%;\n    margin-right: 4px;\n}\n.menu-iconbox-ssr {\n    padding-left: 4px;\n}\n.menu-icon-ssr {\n    position: relative;\n    width: 10px;\n    height: 32px;\n    left: 1px;\n    background: url(data:image/svg+xml;base64,PHN2ZyBkYXRhLW5hbWU9IuWbvuWxgiAxIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAxMCAxMCI+PGcgZGF0YS1uYW1lPSLlt6XlhbfmoI8vRXhjZWwiPjxwYXRoIGZpbGw9Im5vbmUiIGQ9Ik0tMzE0LTE3aDE0NDB2NDRILTMxNHoiLz48cGF0aCBmaWxsPSIjODE4NjhmIiBkPSJNMiAzaDZMNS4wMSA3IDIgM3oiIGRhdGEtbmFtZT0iX+Wbvuaghy9JY29uL+W3peWFt+agj+S4i+aLieeureWktCIvPjwvZz48L3N2Zz4=);\n    background-repeat: no-repeat;\n    background-position: 50%;\n}\n"},"?d91c":function(){}}]),window.jsExecEndTimeStamp=Date.now(),window.cachedPerformanceEntries||(window.cachedPerformanceEntries=[]),window.cachedPerformanceEntries.push({name:"jsExec: js/core-sheet_js_report_raven-config_js-core-sheet_js_report_weblog-config_js-core-sheet_js_repo-b5e52e.1056493a0ce38a300ffa.js",entryType:"jsExec",startTime:window.jsExecStartTimeStamp,endTime:window.jsExecEndTimeStamp});
//# sourceMappingURL=core-sheet_js_report_raven-config_js-core-sheet_js_report_weblog-config_js-core-sheet_js_repo-b5e52e.1056493a0ce38a300ffa.js.map