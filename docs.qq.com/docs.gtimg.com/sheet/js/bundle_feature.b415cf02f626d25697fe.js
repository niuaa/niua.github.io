self.window=self,window.jsExecStartTimeStamp=Date.now(),(self.webpackChunk_tencent_alloy_builder=self.webpackChunk_tencent_alloy_builder||[]).push([["bundle_feature","bundle_copy_paste_api","bundle_feature_copy_paste_base"],{"../spread-sheet/src/base/util/html.ts":function(e,t,r){function n(e,t,r,n){return e.addEventListener?e.addEventListener(t,r,n):e.attachEvent&&e.attachEvent("on"+t,(function(){r(window.event)})),e}function o(e,t,r,n){e.removeEventListener?e.removeEventListener(t,r,n):e.detachEvent&&e.detachEvent("on"+t,(function(){r(window.event)}))}function s(e,t){e&&e.classList.add(t)}function a(e,t){e&&e.classList.remove(t)}r.d(t,{GM:function(){return u},IV:function(){return a},cn:function(){return s},vP:function(){return n},xC:function(){return o}}),r("../node_modules/core-js/modules/es.regexp.exec.js"),r("../node_modules/core-js/modules/es.string.replace.js"),r("../node_modules/core-js/modules/es.array.concat.js"),r("../node_modules/core-js/modules/web.dom-collections.for-each.js"),r("../node_modules/core-js/modules/es.object.keys.js"),r("../node_modules/core-js/modules/es.object.to-string.js"),r("../node_modules/core-js/modules/es.array.slice.js"),r("../packages/common-utils/src/index.ts");var i={CSS:{Sequence:function(){var e=/\\((([\dA-F]{2}|[\dA-F]{1,5})\s)|([\dA-F]{6}|[\dA-F]{4}))/gim;return e.unescape=function(e){var t=window,r=t.String.fromCharCode,n=t.parseInt;return e.replace(this,(function(e){return r(n(e.slice(2),16))}))},e}()}},u=function(e){return function(e){return e.replace(/(\\.)/g,(function(e){return e.slice(1)})).replace(/(\\[$\-+/():!^&'~{}<>= ])/g,(function(e){return e.slice(1)}))}(i.CSS.Sequence.unescape(e))}},"../spread-sheet/src/base/util/phone-number.ts":function(e,t,r){r.d(t,{AI:function(){return u},E$:function(){return f},Iq:function(){return s},YH:function(){return p},un:function(){return l}}),r("../node_modules/core-js/modules/es.regexp.exec.js"),r("../node_modules/core-js/modules/es.string.split.js"),r("../node_modules/core-js/modules/es.string.replace.js"),r("../node_modules/core-js/modules/es.object.values.js"),r("../node_modules/core-js/modules/es.regexp.constructor.js"),r("../node_modules/core-js/modules/es.regexp.to-string.js"),r("../node_modules/core-js/modules/esnext.global-this.js"),r("../node_modules/core-js/modules/es.number.constructor.js");var n=r("../node_modules/@tencent/docs-user-agent/dist/index.js"),o=r.n(n),s={"ar-DZ":"^(\\+?213|0)(5|6|7)\\d{8}$","ar-SY":"^(!?(\\+?963)|0)9\\d{8}$","ar-SA":"^(!?(\\+?966)|0)5\\d{8}$","en-US":"^(\\+?1)[2-9]\\d{2}[2-9](?!11)\\d{6}$","cs-CZ":"^(\\+?420)[1-9][0-9]{2} ?[0-9]{3} ?[0-9]{3}$","de-DE":"^(\\+?0{0,2}49[\\-]?)([0-9]{10,11})$","da-DK":"^(\\+?45)(\\d{8})$","el-GR":"^(\\+?30)(69\\d{8})$","en-AU":"^(\\+?61|0)4\\d{8}$","en-GB":"^(\\+?44|0)7\\d{9}$","en-HK":"^(\\+?852\\-?)[569]\\d{3}\\-?\\d{4}$","en-IN":"^(\\+?91|0)[789]\\d{9}$","en-NZ":"^(\\+?64|0)2\\d{7,9}$","en-ZA":"^(\\+?27|0)\\d{9}$","en-ZM":"^(\\+?26)09[567]\\d{7}$","es-ES":"^(\\+?34)(6\\d{1}|7[1234])\\d{7}$","fi-FI":"^(\\+?358|0)\\s(4(0|1|2|4|5)?|50)\\s?(\\d\\s?){4,8}\\d$","fr-FR":"^(\\+?33|0)[67]\\d{8}$","he-IL":"^(\\+972|0)([23489]|5[0248]|77)[1-9]\\d{6}","hu-HU":"^(\\+?36)(20|30|70)\\d{7}$","it-IT":"^(\\+?39)\\s?3\\d{2} ?\\d{6,7}$","ja-JP":"^(\\+?81|0)\\d{1,4}[ \\-]?\\d{1,4}[ \\-]?\\d{4}$","ms-MY":"^(\\+?6?01){1}(([145]{1}(\\-|\\s)?\\d{7,8})|([236789]{1}(\\s|\\-)?\\d{7}))$","nb-NO":"^(\\+?47)[49]\\d{7}$","nl-BE":"^(\\+?32|0)4\\d{8}$","nn-NO":"^(\\+?47)[49]\\d{7}$","pl-PL":"^(\\+?48)[5-8]\\d ?\\d{3} ?\\d{2} ?\\d{2}$","pt-BR":"^(\\+?55|0)\\-?[1-9]{2}\\-?[2-9]{1}\\d{3,4}\\-?\\d{4}$","pt-PT":"^(\\+?351)9[1236]\\d{7}$","ru-RU":"^(\\+?7|8)9\\d{9}$","sr-RS":"^(\\+3816|06)[- \\d]{5,9}$","tr-TR":"^(\\+?90|0)5\\d{9}$","vi-VN":"^(\\+?84|0)((1(2([0-9])|6([2-9])|88|99))|(9((?!5)[0-9])))([0-9]{7})$","zh-CN":"^(\\+?0?86\\-?)?((13[0-9])|(14[5-9])|(15([0-3]|[5-9]))|(16[6-7])|(17[1-8])|(18[0-9])|(19[1|3])|(19[5|6])|(19[8|9]))\\d{8}$","zh-TW":"^(\\+?886\\-?|0)9\\d{8}$"},a={"zh-CN":{regExp:"^([\\(（]?\\+?0?0?\\d{2,3}[\\)）]?[- ]?)?([\\(（]?0?\\d{2,3}[\\)）]?[- ]?)?([2-8]\\d{2,3}[- ]?\\d{4})((-|转|,| )(\\d+))?$",getExtIndex:function(e){var t=e.split("-");if(2===t.length&&7===t[0].length&&4===t[1].length)return e.lastIndexOf("-");var r=e.replace(this.regExp,"$4");return r?e.lastIndexOf(r):void 0}}},i=[110,119,120,122,999,112,114,1e4,10010,10011,10060,10086,11185,12300,12310,12315,12319,12333,12345,12348,12358,12365,12365,12366,12369,12395,12395,12591,16300,17900,17901,17908,17909,17910,17911,17920,17921,17931,17950,17951,17970,17971,17979,17987,17990,17991,17999,95033,95105,95116,95118,95119,95120,95160,95168,95169,95188,95384,95500,95501,95511,95512,95516,95518,95519,95522,95533,95555,95558,95559,95561,95566,95567,95568,95577,95588,95595,95598,95599,95766,95777,95803,95805,95806,95808,95809,95810,95811,95812,95813,95815,95816,95828,95829,95838,95839,95858,95859,95877,95880,5888,95900,95901,95911,95936,95937,95938,95939,95950,95951,95958,95963,95968,95993,96e3,96001,96002,96003,96005,96008,96010,96011,96014,96015,96096,96100,96101,96105,96110,96111,96112,96113,96118,96119,96120,96121,96126,96128,96129,96157,96158,96166,96168,96169,96177,96178,96179,96181,96188,96190,96191,96196,96197,96199,96300];function u(e,t){for(var r={isValid:!1,regExp:null,getExtIndex:null},n=String(e).replace(/((\s)|(-))/g,""),o=[d,c,m],s=0,a=o.length;s<a;s++){var i=0===s?n:e,u=o[s](String(i),t);if(u.isValid){r=u;break}}return r}function d(e,t){for(var r=t?[s[t]]:Object.values(s),n=0;n<r.length;n++){var o=new RegExp(r[n]);if(o.test(String(e)))return{isValid:!0,regExp:o,getExtIndex:null}}return{isValid:!1,getExtIndex:null,regExp:null}}function c(e,t){for(var r=t?[a[t]]:Object.values(a),n=0;n<r.length;n++){var o=new RegExp(r[n].regExp);if(o.test(String(e)))return{isValid:!0,getExtIndex:r[n].getExtIndex,regExp:o}}return{isValid:!1,getExtIndex:null,regExp:null}}function l(e){var t,n=String(e),o=u(n);if(!o.isValid)return null===r.g||void 0===r.g||r.g.log.error("不合法的号码: "+n),n;var s=null===(t=o.getExtIndex)||void 0===t?void 0:t.call(o,n);return void 0!==s&&o.regExp?String(e).substring(0,s)+","+String(e).substring(s+1):e}function p(e){var t;if(!e)return null;if(o().isTencentDocsApp)return null===(t=null===globalThis||void 0===globalThis?void 0:globalThis.mqq)||void 0===t?void 0:t.invoke("nav","openSchema",{uri:"tel:"+e});var r=document.getElementById("dial-phone");r&&document.body.removeChild(r);var n=document.createElement("a");n.id="dial-phone",n.href="tel:"+e,document.body.appendChild(n),null===n||void 0===n||n.click()}function m(e,t){var r=!1,n=Number(e);return i.forEach((function(e){e===n&&(r=!0)})),{isValid:r,getExtIndex:null,regExp:null}}function f(e){var t;if(!e)return null;if(o().isTencentDocsApp)return null===(t=null===globalThis||void 0===globalThis?void 0:globalThis.mqq)||void 0===t?void 0:t.invoke("nav","openSchema",{uri:e});var r=document.getElementById("email-string");r&&document.body.removeChild(r);var n=document.createElement("a");n.id="email-string",n.href=e,document.body.appendChild(n),null===n||void 0===n||n.click()}},"../spread-sheet/src/base/util/toggle.ts":function(e,t,r){r("../node_modules/core-js/modules/es.object.to-string.js"),r("../node_modules/core-js/modules/es.promise.js"),r("../node_modules/@tencent/toggle-client-js/dist/toggle.es.js")},"../spread-sheet/src/core/feature/Feature.preview.ts":function(e,t,r){r.r(t);var n,o,s=r("../node_modules/@babel/runtime/helpers/esm/createClass.js"),a=r("../node_modules/@babel/runtime/helpers/esm/inheritsLoose.js"),i=(r("../node_modules/regenerator-runtime/runtime.js"),r("../node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),r("../node_modules/core-js/modules/esnext.reflect.metadata.js"),r("../node_modules/core-js/modules/es.object.to-string.js"),r("../node_modules/core-js/modules/es.promise.js"),r("../node_modules/core-js/modules/es.array.iterator.js"),r("../node_modules/core-js/modules/es.string.iterator.js"),r("../node_modules/core-js/modules/web.dom-collections.iterator.js"),r("../spread-sheet/src/core/feature/bootstrap.ts"),r("../spread-sheet/src/core/feature/copyPaste/copyPaste2.ui.ts")),u=r("../spread-sheet/src/core/app/SpreadsheetApp.interface.ts"),d=r("../node_modules/@tencent/containerized/build/main/index.js"),c=(r("../spread-sheet/src/base/util/domain-config.ts"),r("../spread-sheet/src/base/index.ts")),l=function(e,t,r,n){var o,s=arguments.length,a=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var i=e.length-1;i>=0;i--)(o=e[i])&&(a=(s<3?o(a):s>3?o(t,r,a):o(t,r))||a);return s>3&&a&&Object.defineProperty(t,r,a),a},p=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},m=function(e,t){return function(r,n){t(r,n,e)}},f=function(e,t,r,n){return new(r||(r=Promise))((function(o,s){function a(e){try{u(n.next(e))}catch(t){s(t)}}function i(e){try{u(n.throw(e))}catch(t){s(t)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,i)}u((n=n.apply(e,t||[])).next())}))},_=function(e){function t(t,r){var n;return(n=e.call(this)||this).app=t,n.copyPasteLoader=r,n.isRelateFormLoading=!1,n}(0,a.Z)(t,e);var n=t.prototype;return n.init=function(){return f(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Promise.all([this.getCopyPaste(),this.getCopyPasteCache(),this.getCopyPasteBase(),this.getRelateForm(),this.getRelateAio()]));case 1:case"end":return e.stop()}}),e,this)})))},n.getCopyPaste=function(){var e;return f(this,void 0,void 0,regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this._copyPaste){t.next=2;break}return t.abrupt("return",this._copyPaste);case 2:return r=(null===(e=this.app.view.canvas.inputManager)||void 0===e?void 0:e.alloyRTE.input)||document.createElement("input"),t.next=5,this.copyPasteLoader.getInstance([r]);case 5:return this._copyPaste=t.sent,t.abrupt("return",this._copyPaste);case 7:case"end":return t.stop()}}),t,this)})))},n.getCopyPasteCache=function(){return f(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._CopyPasteCache){e.next=2;break}return e.abrupt("return",this._CopyPasteCache);case 2:return e.next=4,Promise.resolve().then(r.bind(r,"../spread-sheet/src/core/feature/copyPaste/copyPasteCache.ts"));case 4:return t=e.sent,this._CopyPasteCache=t.default,e.abrupt("return",this._CopyPasteCache);case 7:case"end":return e.stop()}}),e,this)})))},n.getCopyPasteBase=function(){return f(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._copyPasteBase){e.next=2;break}return e.abrupt("return",this._copyPasteBase);case 2:return e.next=4,r.e("bundle_feature_copy_paste_base").then(r.bind(r,"../spread-sheet/src/core/feature/copyPaste/index.ts"));case 4:return t=e.sent,this._copyPasteBase=t.default,e.abrupt("return",this._copyPasteBase);case 7:case"end":return e.stop()}}),e,this)})))},n.getRelateForm=function(){return f(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._relateForm){e.next=2;break}return e.abrupt("return",this._relateForm);case 2:this.isRelateFormLoading=!0,e.next=9;break;case 6:t=e.sent,e.next=12;break;case 9:return e.next=11,Promise.all([r.e("vendors-node_modules_tencent_toggle-client-js_dist_toggle_es_js-node_modules_tencent_wedocs-i-565a10"),r.e("spread-sheet_src_base_util_decorator_loading-decorator_ts-spread-sheet_src_core_feature_copyP-33f189"),r.e("spread-sheet_src_core_feature_relateForm_index_ts"),r.e("spread-sheet_src_core_feature_bootstrap_ts"),r.e("bundle_feature")]).then(r.bind(r,"../spread-sheet/src/core/feature/relateForm/index.ts"));case 11:t=e.sent;case 12:return this._relateForm=new t.default(this.app),this.isRelateFormLoading=!1,c.Z.event.sheetsBar.trigger("RelateFormFinished"),e.abrupt("return",this._relateForm);case 16:case"end":return e.stop()}}),e,this)})))},n.getRelateAio=function(){return f(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._relateAio){e.next=2;break}return e.abrupt("return",this._relateAio);case 2:return e.next=4,Promise.all([r.e("vendors-node_modules_tencent_toggle-client-js_dist_toggle_es_js-node_modules_tencent_wedocs-i-565a10"),r.e("spread-sheet_src_base_util_decorator_loading-decorator_ts-spread-sheet_src_core_feature_copyP-33f189"),r.e("spread-sheet_src_core_feature_relateForm_index_ts"),r.e("spread-sheet_src_core_feature_bootstrap_ts"),r.e("bundle_feature")]).then(r.bind(r,"../spread-sheet/src/core/feature/relateAio/index.ts"));case 4:return t=e.sent,this._relateAio=new t.default(this.app),e.abrupt("return",this._relateAio);case 7:case"end":return e.stop()}}),e,this)})))},(0,s.Z)(t,[{key:"copyPaste",get:function(){return this._copyPaste?this._copyPaste:(this.getCopyPaste(),null)}},{key:"CopyPasteCache",get:function(){return this._CopyPasteCache?this._CopyPasteCache:(this.getCopyPasteCache(),null)}},{key:"relateForm",get:function(){return this._relateForm?this._relateForm:(this.isRelateFormLoading||this.getRelateForm(),null)}},{key:"copyPasteBase",get:function(){return this._copyPasteBase?this._copyPasteBase:(this.getCopyPasteBase(),null)}},{key:"relateAio",get:function(){return this._relateAio?this._relateAio:(this.getRelateAio(),null)}}]),t}(d.JT);_=l([m(0,u.m),m(1,i.ICopyPaste),p("design:paramtypes",["function"===typeof(n="undefined"!==typeof u.m&&u.m)?n:Object,"function"===typeof(o="undefined"!==typeof d.RU&&d.RU)?o:Object])],_),t.default=_},"../spread-sheet/src/core/feature/Feature.ts":function(e,t,r){r.r(t);var n,o,s=r("../node_modules/@babel/runtime/helpers/esm/createClass.js"),a=r("../node_modules/@babel/runtime/helpers/esm/inheritsLoose.js"),i=(r("../node_modules/regenerator-runtime/runtime.js"),r("../node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),r("../node_modules/core-js/modules/esnext.reflect.metadata.js"),r("../node_modules/core-js/modules/es.object.to-string.js"),r("../node_modules/core-js/modules/es.promise.js"),r("../node_modules/core-js/modules/es.array.iterator.js"),r("../node_modules/core-js/modules/es.string.iterator.js"),r("../node_modules/core-js/modules/web.dom-collections.iterator.js"),r("../spread-sheet/src/core/feature/bootstrap.ts"),r("../spread-sheet/src/core/feature/copyPaste/copyPaste2.ui.ts")),u=r("../spread-sheet/src/core/app/SpreadsheetApp.interface.ts"),d=r("../node_modules/@tencent/containerized/build/main/index.js"),c=r("../spread-sheet/src/core/feature/Feature.preview.ts"),l=function(e,t,r,n){var o,s=arguments.length,a=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var i=e.length-1;i>=0;i--)(o=e[i])&&(a=(s<3?o(a):s>3?o(t,r,a):o(t,r))||a);return s>3&&a&&Object.defineProperty(t,r,a),a},p=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},m=function(e,t){return function(r,n){t(r,n,e)}},f=function(e,t,r,n){return new(r||(r=Promise))((function(o,s){function a(e){try{u(n.next(e))}catch(t){s(t)}}function i(e){try{u(n.throw(e))}catch(t){s(t)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,i)}u((n=n.apply(e,t||[])).next())}))},_=function(e){function t(t,r){var n;return(n=e.call(this,t,r)||this).app=t,n.copyPasteLoader=r,n._register((0,d.OF)((function(){n.destroy()}),"destroyAllFeature")),n}(0,a.Z)(t,e);var n=t.prototype;return n.destroy=function(){var e;this._relateForm=null,this._relateAio=null,this._copyPaste=null,this._CopyPasteCache=null,this._copyPasteBase=null,this._dataValidation=null,this._jankToast=null,null===(e=this.quickFill)||void 0===e||e.destroy(),this.quickFill=null},n.init=function(){return f(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Promise.all([this.getRelateForm(),this.getRelateAio(),this.getCopyPaste(),this.getCopyPasteCache(),this.getCopyPasteBase(),this.getDataValidation(),this.getJankToast()]).catch((function(e){console.error(e.message)})));case 2:case"end":return e.stop()}}),e,this)})))},n.getQuickFill=function(){return f(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([r.e("initial_vendors_public_1"),r.e("spread-sheet_src_core_feature_dataValidation_api_DataValidationError_ts-spread-sheet_src_core-860e25"),r.e("bundle_feature_quick_fill")]).then(r.bind(r,"../spread-sheet/src/core/feature/quickFill/index.ts"));case 2:if(t=e.sent,!this.quickFill){e.next=5;break}return e.abrupt("return",this.quickFill);case 5:return this.quickFill=new t.default(this.app),e.abrupt("return",this.quickFill);case 7:case"end":return e.stop()}}),e,this)})))},n.getCopyPaste=function(){return f(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._copyPaste){e.next=2;break}return e.abrupt("return",this._copyPaste);case 2:return t=this.app.view.canvas.inputManager.alloyRTE.input,e.next=5,this.copyPasteLoader.getInstance([t]);case 5:return this._copyPaste=e.sent,e.abrupt("return",this._copyPaste);case 7:case"end":return e.stop()}}),e,this)})))},n.getCopyPasteCache=function(){return f(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._CopyPasteCache){e.next=2;break}return e.abrupt("return",this._CopyPasteCache);case 2:return e.next=4,Promise.all([r.e("vendors-node_modules_tencent_toggle-client-js_dist_toggle_es_js-node_modules_tencent_wedocs-i-565a10"),r.e("spread-sheet_src_base_util_decorator_loading-decorator_ts-spread-sheet_src_core_feature_copyP-33f189"),r.e("spread-sheet_src_core_feature_relateForm_index_ts"),r.e("spread-sheet_src_core_feature_bootstrap_ts"),r.e("bundle_feature")]).then(r.bind(r,"../spread-sheet/src/core/feature/copyPaste/copyPasteCache.ts"));case 4:return t=e.sent,this._CopyPasteCache=t.default,e.abrupt("return",this._CopyPasteCache);case 7:case"end":return e.stop()}}),e,this)})))},n.getCopyPasteBase=function(){return f(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._copyPasteBase){e.next=2;break}return e.abrupt("return",this._copyPasteBase);case 2:return e.next=4,Promise.all([r.e("vendors-node_modules_tencent_toggle-client-js_dist_toggle_es_js-node_modules_tencent_wedocs-i-565a10"),r.e("spread-sheet_src_base_util_decorator_loading-decorator_ts-spread-sheet_src_core_feature_copyP-33f189"),r.e("spread-sheet_src_core_feature_relateForm_index_ts"),r.e("spread-sheet_src_core_feature_bootstrap_ts"),r.e("bundle_feature")]).then(r.bind(r,"../spread-sheet/src/core/feature/copyPaste/index.ts"));case 4:return t=e.sent,this._copyPasteBase=t.default,e.abrupt("return",this._copyPasteBase);case 7:case"end":return e.stop()}}),e,this)})))},n.getDataValidation=function(){return f(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._dataValidation){e.next=2;break}return e.abrupt("return",this._dataValidation);case 2:return e.next=4,Promise.all([r.e("vendors-node_modules_tencent_toggle-client-js_dist_toggle_es_js-node_modules_tencent_wedocs-i-565a10"),r.e("spread-sheet_src_base_util_decorator_loading-decorator_ts-spread-sheet_src_core_feature_copyP-33f189"),r.e("spread-sheet_src_core_feature_relateForm_index_ts"),r.e("spread-sheet_src_core_feature_bootstrap_ts"),r.e("bundle_feature")]).then(r.bind(r,"../spread-sheet/src/core/feature/dataValidation/Index.ts"));case 4:return t=e.sent,this._dataValidation=t.default,e.abrupt("return",this._dataValidation);case 7:case"end":return e.stop()}}),e,this)})))},n.getJankToast=function(){return f(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._jankToast){e.next=2;break}return e.abrupt("return",this._jankToast);case 2:return e.next=4,Promise.all([r.e("vendors-node_modules_tencent_toggle-client-js_dist_toggle_es_js-node_modules_tencent_wedocs-i-565a10"),r.e("spread-sheet_src_base_util_decorator_loading-decorator_ts-spread-sheet_src_core_feature_copyP-33f189"),r.e("spread-sheet_src_core_feature_relateForm_index_ts"),r.e("spread-sheet_src_core_feature_bootstrap_ts"),r.e("bundle_feature")]).then(r.bind(r,"../spread-sheet/src/core/feature/jankToast/check.ts"));case 4:return t=e.sent,this._jankToast=t.default,e.abrupt("return",this._jankToast);case 7:case"end":return e.stop()}}),e,this)})))},(0,s.Z)(t,[{key:"relateForm",get:function(){return this._relateForm?this._relateForm:(this.getRelateForm(),null)}},{key:"relateAio",get:function(){return this._relateAio?this._relateAio:(this.getRelateAio(),null)}},{key:"copyPaste",get:function(){return this._copyPaste?this._copyPaste:(this.getCopyPaste(),null)}},{key:"CopyPasteCache",get:function(){return this._CopyPasteCache?this._CopyPasteCache:(this.getCopyPasteCache(),null)}},{key:"copyPasteBase",get:function(){return this._copyPasteBase?this._copyPasteBase:(this.getCopyPasteBase(),null)}},{key:"dataValidation",get:function(){return this._dataValidation?this._dataValidation:(this.getDataValidation(),null)}},{key:"jankToast",get:function(){return this._jankToast?this._jankToast:(this.getJankToast(),null)}}]),t}(c.default);_=l([m(0,u.m),m(1,i.ICopyPaste),p("design:paramtypes",["function"===typeof(n="undefined"!==typeof u.m&&u.m)?n:Object,"function"===typeof(o="undefined"!==typeof d.RU&&d.RU)?o:Object])],_),t.default="page-editor"==r.j?_:null},"../spread-sheet/src/core/feature/copyPaste/api/copyPasteAPI.m.ts":function(e,t,r){r.r(t),r.d(t,{CopyType:function(){return o.lb},apiDoCopyM:function(){return c},apiDoPasteM:function(){return d},apiJudgeForPasteM:function(){return u}}),r("../node_modules/regenerator-runtime/runtime.js"),r("../node_modules/core-js/modules/es.object.to-string.js"),r("../node_modules/core-js/modules/es.promise.js"),r("../node_modules/core-js/modules/es.number.constructor.js"),r("../node_modules/core-js/modules/es.regexp.to-string.js");var n=r("../spread-sheet/src/core/feature/copyPaste/clipboardCopy.ui.ts"),o=r("../spread-sheet/src/core/feature/copyPaste/interfaces.ts"),s=r("../spread-sheet/src/core/feature/copyPaste/wxCopyPaste.ui.ts"),a=r("../packages/report/src/index.ts"),i=function(e,t,r,n){return new(r||(r=Promise))((function(o,s){function a(e){try{u(n.next(e))}catch(t){s(t)}}function i(e){try{u(n.throw(e))}catch(t){s(t)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,i)}u((n=n.apply(e,t||[])).next())}))};function u(e){return i(this,void 0,void 0,regeneratorRuntime.mark((function t(){var r,a,i,u,d,c,l;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.feature.getCopyPaste();case 2:return r=t.sent,a=r.copyPasteCache.getCacheState(),i=a.valid,u=a.hasDonePaste,d=r.getPasteType()!==o.P0.NONE,c=(0,n.j9)(),l=s.Z.isCopyInEnv()&&s.Z.isCopyDataAvailable(),t.abrupt("return",i&&!u||d||c||l);case 10:case"end":return t.stop()}}),t)})))}function d(e,t){var o,u,d=t.callback;return i(this,void 0,void 0,regeneratorRuntime.mark((function t(){var i,c,l,p,m,f,_,h,g,v,T,j,y;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.feature.getCopyPaste();case 2:return i=t.sent,t.next=5,i.syncMobileClipboard();case 5:if(c=t.sent,l={plain:"",html:""},p=0,null===(o=r.g.log)||void 0===o||o.log("mobileClipboard",c),m=i.copyPasteCache.getCacheState().clipboardCopyData,Number(m.timeStamp)>p&&(p=Number(m.timeStamp),l=m),f=(0,n.e7)(),parseInt(f.timeStamp,10)>p&&(p=parseInt(f.timeStamp,10),l=f,a.ZP.tdwReport({module:"excel_picture",opername:"doc_excel_editor",action:"mob_picture_menu_paste"})),_=c.plain||c.html,l.plain!==c.plain&&_&&(p=Number(c.timeStamp),l=c),!s.Z.isCopyInEnv()){t.next=22;break}return t.next=19,s.Z.getServerCopyData(p);case 19:h=t.sent,null===(u=r.g.log)||void 0===u||u.log("wxServerCopyData:",h),h.timeStamp>p&&h.plain!==l.plain&&""!==h.plain&&(g=h.plain,v=h.html,T=h.timeStamp,l={plain:g,html:v,timeStamp:T.toString()});case 22:j=e.view.getSelection(),y={xRange:[j.rangeSelections[0].startColIndex,j.rangeSelections[0].endColIndex],yRange:[j.rangeSelections[0].startRowIndex,j.rangeSelections[0].endRowIndex]},i.doClipboardPaste({html:l.html||"",plain:l.plain||""},y),l.plain&&d(l.plain);case 26:case"end":return t.stop()}}),t)})))}function c(e,t){return i(this,void 0,void 0,regeneratorRuntime.mark((function r(){var n;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,e.feature.getCopyPaste();case 2:n=r.sent,window.self,window.top,n.doCopy(t);case 4:case"end":return r.stop()}}),r)})))}},"../spread-sheet/src/core/feature/copyPaste/api/copyPasteAPI.pc.ts":function(e,t,r){r.d(t,{QN:function(){return h},S2:function(){return g},tZ:function(){return v}}),r("../node_modules/regenerator-runtime/runtime.js"),r("../node_modules/core-js/modules/es.object.to-string.js"),r("../node_modules/core-js/modules/es.promise.js"),r("../node_modules/core-js/modules/es.number.constructor.js"),r("../node_modules/core-js/modules/es.array.iterator.js"),r("../node_modules/core-js/modules/es.string.iterator.js"),r("../node_modules/core-js/modules/web.dom-collections.iterator.js"),r("../node_modules/core-js/modules/es.array.slice.js"),r("../node_modules/core-js/modules/es.function.name.js"),r("../node_modules/core-js/modules/es.array.from.js"),r("../node_modules/core-js/modules/es.symbol.js"),r("../node_modules/core-js/modules/es.symbol.description.js"),r("../node_modules/core-js/modules/es.symbol.iterator.js");var n=r("../node_modules/i18next/dist/esm/i18next.js"),o=r("../packages/report/src/index.ts"),s=r("../spread-sheet/src/core/feature/copyPaste/clipboardCopy.ui.ts"),a=r("../spread-sheet/src/core/feature/copyPaste/interfaces.ts"),i=r("../spread-sheet/src/core/feature/copyPaste/wxCopyPaste.ui.ts"),u=r("../spread-sheet/src/core/ui/toast/index.ts"),d=r("../node_modules/@tencent/docs-user-agent/dist/index.js"),c=r.n(d),l=(r("../spread-sheet/src/core/feature/copyPaste/utils/handle-clipboard-string.ts"),r("../spread-sheet/src/core/feature/copyPaste/utils/select-range.ts"),r("../spread-sheet/src/core/feature/copyPaste/api/copyPasteAPI.common.ts")),p=(r("../spread-sheet/src/base/util/domain-config.ts"),r("../spread-sheet/src/core/feature/copyPaste/utils/loading.ts")),m=function(e,t,r,n){return new(r||(r=Promise))((function(o,s){function a(e){try{u(n.next(e))}catch(t){s(t)}}function i(e){try{u(n.throw(e))}catch(t){s(t)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,i)}u((n=n.apply(e,t||[])).next())}))},f=function(){c().isPCTencentDocsClient&&((0,u.hideToast)(),(0,u.showToast)(n.ZP.t("剪切板里的内容可能被外部程序清除了，当前没有可以粘贴的内容"),void 0,{isNeedBtn:!0,btnText:n.ZP.t("我知道了"),btnTextAfter:"",btnCallBack:function(){(0,u.hideToast)()}}))},_=function(e,t){try{e===t&&o.ZP.tdwReport({module:"excel_picture",opername:"doc_excel_editor",action:"picture_menu_ctrl_paste"})}catch(r){}};function h(e,t,r){var n,o;void 0===r&&(r=!1);var s=t.getPasteType()!==a.P0.NONE,u=i.Z.isCopyInEnv()&&i.Z.isCopyDataAvailable(),d=(0,l.qM)(),c=!0;return(null===(o=null===(n=e.view.canvas.shapeEditCenter)||void 0===n?void 0:n.shapeEdit)||void 0===o?void 0:o.focusing)&&(c=!1),{canPaste:s||u||r||d||!1,visable:c}}function g(e){return m(this,void 0,void 0,regeneratorRuntime.mark((function t(){var r,n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:case 10:return t.abrupt("return",!1);case 2:if(e){t.next=4;break}return t.abrupt("return",!1);case 4:return t.next=6,e.getPasteTypeFromBrowser();case 6:if(r=t.sent,n=e.copyPasteCache.getCacheState().clipboardCopyData,(null===r||void 0===r?void 0:r[0].plain)===n.plain){t.next=10;break}return t.abrupt("return",!0);case 11:case"end":return t.stop()}}),t)})))}function v(e){return m(this,void 0,void 0,regeneratorRuntime.mark((function t(){var r,n,o,u,d,c,p,m,h,v;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.feature.getCopyPaste();case 2:if(r=t.sent,n=r.getPasteType(),t.t0=(0,l.qM)(),t.t0){t.next=14;break}return t.next=8,l.f2.isCanPasteFromClipboard();case 8:if(t.t1=t.sent,!t.t1){t.next=13;break}return t.next=12,g(r);case 12:t.t1=t.sent;case 13:t.t0=t.t1;case 14:if(!t.t0){t.next=20;break}return o=e.view.getSelection(),u={xRange:[o.rangeSelections[0].startColIndex,o.rangeSelections[0].endColIndex],yRange:[o.rangeSelections[0].startRowIndex,o.rangeSelections[0].endRowIndex]},t.next=19,T(e,r,u);case 19:return t.abrupt("return");case 20:if(n!==a.P0.NONE){t.next=23;break}return f(),t.abrupt("return");case 23:if(n!==a.P0.CLIPBOARD){t.next=27;break}r.onPastePCClient(),t.next=46;break;case 27:if((d=r.getPasteType())!==a.P0.NONE){t.next=31;break}return f(),t.abrupt("return");case 31:if(d!==a.P0.CLIPBOARD){t.next=35;break}r.onPastePCClient(),t.next=46;break;case 35:if(c=r.copyPasteCache.getCacheState().clipboardCopyData,p=(0,s.e7)(),m=Number(c.timeStamp)>p.timeStamp?c:p,h={html:m.html,plain:m.plain},!i.Z.isCopyInEnv()){t.next=44;break}return t.next=42,i.Z.getServerCopyData(m.timeStamp);case 42:(v=t.sent).timeStamp>Number(c.timeStamp)&&v.plain!==h.plain&&""!==v.plain&&(h.html=v.html||"",h.plain=v.plain);case 44:r.doClipboardPaste(h),_(m,p);case 46:case"end":return t.stop()}}),t)})))}var T=function(e,t,n){return m(void 0,void 0,void 0,regeneratorRuntime.mark((function o(){return regeneratorRuntime.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:Promise.all([t.getPasteTypeFromBrowser(),t.getPasteTypeFromWxwork()]).then((function(r){var o=r[0],s=r[1];return m(void 0,void 0,void 0,regeneratorRuntime.mark((function r(){var a,i,u,d,c;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(!(s&&s.length>0)){r.next=5;break}u={clipboardData:{items:s,getData:function(){return null}}},t.doClipboardPaste(s[0],n,u),r.next=14;break;case 5:if(!(o&&o.length>0)){r.next=14;break}if(d={clipboardData:{items:o,getData:function(){return null}}},!(null===(a=o[0])||void 0===a?void 0:a.blob)||o[0].html){r.next=13;break}return c=(0,p.EB)(e),t.copyPasteCache.setPasteAnchor(c),r.next=12,t.copyPasteShape.onParse([null===(i=o[0])||void 0===i?void 0:i.blob],"files");case 12:return r.abrupt("return");case 13:t.doClipboardPaste(o[0],n,d);case 14:case"end":return r.stop()}}),r)})))})).catch((function(e){r.g.log.log(e)}));case 1:case"end":return o.stop()}}),o)})))}},"../spread-sheet/src/core/feature/copyPaste/api/smartSplitAPI.ts":function(e,t,r){r.d(t,{IK:function(){return n.IK},PQ:function(){return n.PQ},aY:function(){return n.aY},fG:function(){return n.fG},lT:function(){return n.lT},yC:function(){return n.yC}});var n=r("../spread-sheet/src/core/feature/copyPaste/lib/smartSplit/SmartSplit.ts")},"../spread-sheet/src/core/feature/copyPaste/index.ts":function(e,t,r){r.r(t);var n,o=r("../spread-sheet/src/core/feature/copyPaste/api/copyPasteAPI.common.ts"),s=r("../spread-sheet/src/core/feature/copyPaste/api/copyPasteAPI.pc.ts"),a=r("../spread-sheet/src/core/feature/copyPaste/api/copyPasteAPI.m.ts"),i=r("../spread-sheet/src/core/feature/copyPaste/api/smartSplitAPI.ts"),u=r("../spread-sheet/src/core/feature/copyPaste/iconSource.tsx");!function(e){e.apiDoCopy=o.zU,e.apiDoRangeToImgCopy=o.Cj,e.apiInsertCopy=o.d6,e.apiInsertCut=o.RP,e.apiJudgeForInsertCopy=o.s5,e.CopyIconSource=u.Z,e.CopyPasteCache=o.Bk,e.apiDoPaste=s.tZ,e.apiJudgeForPaste=s.QN,e.apiDoPasteM=a.apiDoPasteM,e.apiJudgeForPasteM=a.apiJudgeForPasteM,e.CopyType=o.lb,e.CopyHTMLType=o.GI,e.needCheckSmartSplit=i.IK,e.getResultSP=i.fG,e.showToastSPMobile=i.aY,e.doSmartSplit=i.lT,e.hideToastSP=i.yC,e.showToastSP=i.PQ}(n||(n={})),t.default=n},"../spread-sheet/src/core/feature/dataValidation/DVInterface.ts":function(e,t,r){r.d(t,{Bb:function(){return i},Ju:function(){return d},UD:function(){return u},c1:function(){return c},h6:function(){return s.h6},ob:function(){return s.ob},y3:function(){return a}}),r("../node_modules/core-js/modules/es.array.iterator.js"),r("../node_modules/core-js/modules/es.map.js"),r("../node_modules/core-js/modules/es.object.to-string.js"),r("../node_modules/core-js/modules/es.string.iterator.js"),r("../node_modules/core-js/modules/esnext.map.delete-all.js"),r("../node_modules/core-js/modules/esnext.map.every.js"),r("../node_modules/core-js/modules/esnext.map.filter.js"),r("../node_modules/core-js/modules/esnext.map.find.js"),r("../node_modules/core-js/modules/esnext.map.find-key.js"),r("../node_modules/core-js/modules/esnext.map.includes.js"),r("../node_modules/core-js/modules/esnext.map.key-of.js"),r("../node_modules/core-js/modules/esnext.map.map-keys.js"),r("../node_modules/core-js/modules/esnext.map.map-values.js"),r("../node_modules/core-js/modules/esnext.map.merge.js"),r("../node_modules/core-js/modules/esnext.map.reduce.js"),r("../node_modules/core-js/modules/esnext.map.some.js"),r("../node_modules/core-js/modules/esnext.map.update.js"),r("../node_modules/core-js/modules/web.dom-collections.iterator.js");var n=r("../node_modules/i18next/dist/esm/i18next.js"),o=r("../packages/model/src/index.ts"),s=r("../spread-sheet/src/core/feature/dataValidation/type.ts"),a=new Map([[o.Cell.DATA_VALIDATION_CONDITION_TYPE.BETWEEN,n.ZP.t("介于")],[o.Cell.DATA_VALIDATION_CONDITION_TYPE.NOT_BETWEEN,n.ZP.t("不介于")],[o.Cell.DATA_VALIDATION_CONDITION_TYPE.EQUAL,n.ZP.t("等于")],[o.Cell.DATA_VALIDATION_CONDITION_TYPE.NOT_EQUAL,n.ZP.t("不等于")],[o.Cell.DATA_VALIDATION_CONDITION_TYPE.LESS,n.ZP.t("早于")],[o.Cell.DATA_VALIDATION_CONDITION_TYPE.LESS_EQUAL,n.ZP.t("不晚于")],[o.Cell.DATA_VALIDATION_CONDITION_TYPE.GREAT,n.ZP.t("晚于")],[o.Cell.DATA_VALIDATION_CONDITION_TYPE.GREAT_EQUAL,n.ZP.t("不早于")]]),i=new Map([[o.Cell.DATA_VALIDATION_CONDITION_TYPE.BETWEEN,n.ZP.t("介于")],[o.Cell.DATA_VALIDATION_CONDITION_TYPE.NOT_BETWEEN,n.ZP.t("不介于")],[o.Cell.DATA_VALIDATION_CONDITION_TYPE.EQUAL,n.ZP.t("等于")],[o.Cell.DATA_VALIDATION_CONDITION_TYPE.NOT_EQUAL,n.ZP.t("不等于")],[o.Cell.DATA_VALIDATION_CONDITION_TYPE.LESS,n.ZP.t("小于")],[o.Cell.DATA_VALIDATION_CONDITION_TYPE.LESS_EQUAL,n.ZP.t("小于或等于")],[o.Cell.DATA_VALIDATION_CONDITION_TYPE.GREAT,n.ZP.t("大于")],[o.Cell.DATA_VALIDATION_CONDITION_TYPE.GREAT_EQUAL,n.ZP.t("大于或等于")],[o.Cell.DATA_VALIDATION_CONDITION_TYPE.INCLUDE,n.ZP.t("包括")],[o.Cell.DATA_VALIDATION_CONDITION_TYPE.NOT_INCLUDE,n.ZP.t("不包括")]]),u=new Map([[o.Cell.DATA_VALIDATION_CONDITION_TYPE.BETWEEN,n.ZP.t("介于")],[o.Cell.DATA_VALIDATION_CONDITION_TYPE.NOT_BETWEEN,n.ZP.t("不介于")],[o.Cell.DATA_VALIDATION_CONDITION_TYPE.EQUAL,n.ZP.t("等于")],[o.Cell.DATA_VALIDATION_CONDITION_TYPE.NOT_EQUAL,n.ZP.t("不等于")],[o.Cell.DATA_VALIDATION_CONDITION_TYPE.LESS,n.ZP.t("小于")],[o.Cell.DATA_VALIDATION_CONDITION_TYPE.LESS_EQUAL,n.ZP.t("小于或等于")],[o.Cell.DATA_VALIDATION_CONDITION_TYPE.GREAT,n.ZP.t("大于")],[o.Cell.DATA_VALIDATION_CONDITION_TYPE.GREAT_EQUAL,n.ZP.t("大于或等于")]]),d=new Map([[s.h6.NONE,n.ZP.t("数值")],[s.h6.INT,n.ZP.t("整数")],[s.h6.FLOAT,n.ZP.t("小数")]]),c=new Map([[s.h6.ID_CARD,n.ZP.t("身份证号")],[s.h6.MAIL,n.ZP.t("邮箱")],[s.h6.PHONE,n.ZP.t("手机号")],[s.h6.TELEPHONE,n.ZP.t("电话号码")]])},"../spread-sheet/src/core/feature/dataValidation/Index.ts":function(e,t,r){r.r(t);var n,o=r("../spread-sheet/src/core/feature/dataValidation/api/DataValidationRule.ts"),s=r("../spread-sheet/src/core/feature/dataValidation/api/DataValidationConfig.ts"),a=r("../spread-sheet/src/core/feature/dataValidation/api/DataValidationUtils.ts");!function(e){e.getDataValidationConfig=s.N,e.isActiveCellContainDV=a.v1,e.transformDV2Formula=o.Jh}(n||(n={})),t.default="page-editor"==r.j?n:null},"../spread-sheet/src/core/feature/dataValidation/api/DataValidationConfig.ts":function(e,t,r){r.d(t,{N:function(){return u}}),r("../node_modules/core-js/modules/es.array.map.js"),r("../node_modules/core-js/modules/es.array.filter.js");var n=r("../packages/model/src/cell/data-validation/data-validation-utils.ts"),o=r("../packages/model/src/cell/data-validation/data-validation-rule-type.ts"),s=r("../spread-sheet/src/core/feature/formula/utils.ts"),a=r("../packages/model/src/range/hexRangeUtils.ts"),i=r("../spread-sheet/src/core/feature/dataValidation/DVInterface.ts");function u(e,t){var r,u=function(e){var t=e.validType,r=e.dataType;switch(t){case i.ob.LIST:return o.Z.LIST;case i.ob.NUMBER:switch(r){case i.h6.FLOAT:return o.Z.CUSTOM_MUST_FLOAT;case i.h6.INT:return o.Z.NUMBER_INT;case i.h6.NONE:return o.Z.NUMBER_FLOAT_AND_INT;case i.h6.TEMPERATURE:return o.Z.CUSTOM_NUMBER_TEMPERATURE;case i.h6.PROGRESS:return o.Z.CUSTOM_PROGRESS}break;case i.ob.TEXT:switch(r){case i.h6.CONTENT:return o.Z.CUSTOM_TEXT_CONTAINS;case i.h6.LENGTH:default:return o.Z.TEXT_LENGTH}case i.ob.DATE:return o.Z.DATE;case i.ob.AVAILABLE:switch(r){case i.h6.ID_CARD:return o.Z.CUSTOM_ID_CARD;case i.h6.PHONE:return o.Z.CUSTOM_NUM_PHONE;case i.h6.TELEPHONE:return o.Z.CUSTOM_NUM_TEL;case i.h6.MAIL:return o.Z.CUSTOM_TEXT_MAIL}break;case i.ob.CHECKBOX:return o.Z.CUSTOM_CHECKBOX;case i.ob.STAR:return o.Z.CUSTOM_STAR;case i.ob.ATTACHMENT:return o.Z.CUSTOM_ATTACHMENT;case i.ob.CONTACT:return o.Z.CUSTOM_CONTACT}return console.warn("数据验证：传入数据不符合规则"),o.Z.CUSTOM}({validType:e.validType,dataType:e.dataType}),d=(null===(r=e.argTokens)||void 0===r?void 0:r.filter((function(e){return Boolean(e.userEnteredValue)})).map((function(r){var i=r.userEnteredValue,d=e.selection;if(d&&u===o.Z.LIST&&(0,s.jr)(i)){var c=(0,a.getRangeInfoFormHexRange)(t,i),l=c.rangeString,p={sheetId:c.sheetId,rowIndex:d.startRowIndex,colIndex:d.startColIndex};return(0,n.G8)("="+l,{ruleType:u,positionInfo:p})}return(0,n.G8)(i)})))||null;return{ruleType:u,inputMessage:e.inputMessage||null,isStrict:e.isStrict||!1,showDropDown:e.showDropDown||!1,operator:e.operator,argTokens:d}}},"../spread-sheet/src/core/feature/dataValidation/api/DataValidationRule.ts":function(e,t,r){r.d(t,{Jh:function(){return d},ZU:function(){return f},n3:function(){return _}}),r("../node_modules/core-js/modules/es.array.join.js"),r("../node_modules/core-js/modules/es.object.values.js"),r("../node_modules/core-js/modules/web.dom-collections.for-each.js");var n=r("../packages/model/src/cell/data-validation/data-validation-utils.ts"),o=r("../packages/model/src/cell/data-validation/data-validation-rule-type.ts"),s=r("../spread-sheet/src/core/utils/formula.ts"),a=r("../spread-sheet/src/core/feature/dataValidation/api/DataValidationUtils.ts"),i=r("../spread-sheet/src/core/feature/dataValidation/type.ts"),u=r("../spread-sheet/src/base/util/phone-number.ts"),d=function(e,t){var r=c(e);if(r)return r;switch(e.ruleType){case o.Z.NUMBER_FLOAT_AND_INT:return p(e,i.sS.NONE);case o.Z.CUSTOM_MUST_FLOAT:return p(e,i.sS.FLOAT);case o.Z.NUMBER_INT:return p(e,i.sS.INT);case o.Z.DATE:return p(e,i.sS.NONE);case o.Z.TEXT_LENGTH:return p(e,i.sS.LENGTH);case o.Z.LIST:return m(e,t);default:return null}},c=function(e){switch(e.ruleType){case o.Z.CUSTOM_TEXT_CONTAINS:return l(e);case o.Z.CUSTOM_ID_CARD:return f();case o.Z.CUSTOM_TEXT_MAIL:case o.Z.CUSTOM_NUM_PHONE:case o.Z.CUSTOM_NUM_TEL:return _(e);case o.Z.CUSTOM_NUMBER_TEMPERATURE:case o.Z.CUSTOM_PROGRESS:return p(e,i.sS.NONE);default:return null}},l=function(e){var t=e.operator,r=e.argTokens;return(0,a.Wj)(t)||!(null===r||void 0===r?void 0:r.length)?null:'=DATA_VALID_TEXT("'+t+'", '+(0,a.Np)(r[0].userEnteredValue)+", $SLOT)"},p=function(e,t,r){var n,o,s=e.operator,i=e.argTokens;if(s&&(0,a.Sv)(s))return null;var u=r||"$SLOT";return'=DATA_VALID_NUMBER("'+(s||"")+'", '+t+", "+(0,a.Np)((0,a.KN)((null===(n=null===i||void 0===i?void 0:i[0])||void 0===n?void 0:n.userEnteredValue)||null))+", "+(0,a.Np)((0,a.KN)((null===(o=null===i||void 0===i?void 0:i[1])||void 0===o?void 0:o.userEnteredValue)||null))+", "+u+")"},m=function(e,t){var r=e.argTokens;if(!r||!r[0]||!(null===r||void 0===r?void 0:r.length))return null;var o=r[0];if((0,n.$U)(o)){var i=(0,n.o5)(o,t);return"DATA_VALID_LIST("+(0,s.moveEqualChar)(i)+", $SLOT)"}var u=o.userEnteredValue;return'DATA_VALID_LIST("'+(0,a.zk)(u).join(",")+'", $SLOT)'},f=function(){return"OR(ISNUMBER(ID($SLOT,0)),ID_FOR_HK($SLOT,0))"},_=function(e){var t=[];return e.ruleType===o.Z.CUSTOM_TEXT_MAIL&&t.push('REGEXMATCH($SLOT,"'+h+'",FALSE)'),e.ruleType===o.Z.CUSTOM_NUM_PHONE&&Object.values(u.Iq).forEach((function(e){t.push('REGEXMATCH($SLOT,"'+e+'",FALSE)')})),e.ruleType===o.Z.CUSTOM_NUM_TEL&&t.push('REGEXMATCH($SLOT,"'+g+'",FALSE)'),"OR("+t.join(",")+")"},h="^[a-zA-Z0-9_-]+@[a-zA-Z0-9_-]+(\\.[a-zA-Z0-9_-]+)+$",g="^(0\\d{2,3}-)?\\d{7,8}(-\\d{1,6})?$"},"../spread-sheet/src/core/feature/dataValidation/api/DataValidationUtils.ts":function(e,t,r){r.d(t,{AJ:function(){return D},Dq:function(){return B},Ex:function(){return C},JU:function(){return F},KN:function(){return k},Np:function(){return L},Sc:function(){return v.Sc},Sv:function(){return O},Wj:function(){return w},ZK:function(){return A},aW:function(){return v.aW},gZ:function(){return M},jY:function(){return I},ko:function(){return y},uU:function(){return V},v1:function(){return Z},zk:function(){return b}}),r("../node_modules/regenerator-runtime/runtime.js"),r("../node_modules/core-js/modules/es.object.to-string.js"),r("../node_modules/core-js/modules/es.promise.js"),r("../node_modules/core-js/modules/es.array.join.js"),r("../node_modules/core-js/modules/es.regexp.exec.js"),r("../node_modules/core-js/modules/es.string.split.js"),r("../node_modules/core-js/modules/es.array.map.js"),r("../node_modules/core-js/modules/es.string.trim.js"),r("../node_modules/core-js/modules/es.array.filter.js"),r("../node_modules/core-js/modules/es.array.from.js"),r("../node_modules/core-js/modules/es.string.iterator.js"),r("../node_modules/core-js/modules/es.array.iterator.js"),r("../node_modules/core-js/modules/es.set.js"),r("../node_modules/core-js/modules/esnext.set.add-all.js"),r("../node_modules/core-js/modules/esnext.set.delete-all.js"),r("../node_modules/core-js/modules/esnext.set.difference.js"),r("../node_modules/core-js/modules/esnext.set.every.js"),r("../node_modules/core-js/modules/esnext.set.filter.js"),r("../node_modules/core-js/modules/esnext.set.find.js"),r("../node_modules/core-js/modules/esnext.set.intersection.js"),r("../node_modules/core-js/modules/esnext.set.is-disjoint-from.js"),r("../node_modules/core-js/modules/esnext.set.is-subset-of.js"),r("../node_modules/core-js/modules/esnext.set.is-superset-of.js"),r("../node_modules/core-js/modules/esnext.set.join.js"),r("../node_modules/core-js/modules/esnext.set.map.js"),r("../node_modules/core-js/modules/esnext.set.reduce.js"),r("../node_modules/core-js/modules/esnext.set.some.js"),r("../node_modules/core-js/modules/esnext.set.symmetric-difference.js"),r("../node_modules/core-js/modules/esnext.set.union.js"),r("../node_modules/core-js/modules/web.dom-collections.iterator.js"),r("../node_modules/core-js/modules/web.dom-collections.for-each.js"),r("../node_modules/core-js/modules/es.string.match.js"),r("../node_modules/core-js/modules/es.string.ends-with.js");var n,o=r("../node_modules/i18next/dist/esm/i18next.js"),s=r("../packages/model/src/index.ts"),a=r("../node_modules/@tencent/txdoc_dayjs/dayjs.min.js"),i=r.n(a),u=r("../spread-sheet/src/core/utils/cell.ts"),d=r("../spread-sheet/src/core/utils/formula.ts"),c=r("../spread-sheet/src/core/utils/numberFromat.ts"),l=r("../packages/model/src/range/hexRangeUtils.ts"),p=r("../packages/model/src/cell/data-validation/data-validation-rule-type.ts"),m=r("../packages/model/src/rule/index.ts"),f=r("../packages/model/src/cell/data-validation/data-validation-utils.ts"),_=r("../spread-sheet/src/core/feature/formula/utils.ts"),h=r("../node_modules/@tencent/sheet-formula-sdk/lib/index.js"),g=r("../packages/model/src/cell/metadata/CustomDataType.ts"),v=r("../spread-sheet/src/core/feature/dataValidation/api/DataValidationUIUtils.ts"),T=r("../packages/model/src/cell/format/NumberFormatType.ts"),j=(r("../spread-sheet/src/core/feature/dataValidation/api/DataValidationConfig.ts"),function(e,t,r,n){return new(r||(r=Promise))((function(o,s){function a(e){try{u(n.next(e))}catch(t){s(t)}}function i(e){try{u(n.throw(e))}catch(t){s(t)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,i)}u((n=n.apply(e,t||[])).next())}))}),y=function(e,t,r){return e?e.split(t).join(r):""},I=function(e){switch(e.ruleType){case p.Z.LIST:case p.Z.NUMBER_INT:case p.Z.NUMBER_FLOAT_AND_INT:case p.Z.CUSTOM_MUST_FLOAT:case p.Z.CUSTOM_NUMBER_TEMPERATURE:case p.Z.TEXT_LENGTH:case p.Z.DATE:return!0}return!1},C=function(e,t,r){return y(e,"$SLOT",h.Pz.toCellId(t,r))},b=function(e){var t;return t=(t=(t=e.split(",")).map((function(e){return e.trim()}))).filter((function(e){return e})),Array.from(new Set(t))};function P(e){var t,r=null===(t=null===e||void 0===e?void 0:e.argTokens)||void 0===t?void 0:t[0];if(!r)return!0;var n=r.type,o=r.formula,s=r.userEnteredValue;if(n===m.ARG_TOKEN_TYPE.VALUE_TOKEN&&null===s)return!0;if(n===m.ARG_TOKEN_TYPE.FORMULA_TOKEN){if(null===o)return!0;if(!0===(null===o||void 0===o?void 0:o.hasReferenceError))return!0}return!1}function x(e){return null!=e&&null!=e.argTokens&&e.ruleType===p.Z.LIST||(console.warn("数据验证：类型不为list或者用户输入为空，不能获取下拉列表信息"),!1)}function E(e,t,o,s){var a,i,u;return j(this,void 0,void 0,regeneratorRuntime.mark((function d(){var c,p,m,_,h,g,v,T,j,y;return regeneratorRuntime.wrap((function(d){for(;;)switch(d.prev=d.next){case 0:if(c=S(t),p=t.argTokens[0],c!==n.RANGE_LIST){d.next=16;break}if(m=(0,f.o5)(p,{rowIndex:o,colIndex:s,options:e.spreadsheet.sheetManager}),_=(0,l.getRangeInfoFormHexRange)(e.spreadsheet,m),h=_.sheetId,g=_.rangeString,v=h||e.spreadsheet.getActiveSheetId(),null===(u=null===(i=null===(a=e.spreadsheet)||void 0===a?void 0:a.sheetManager)||void 0===i?void 0:i.getSheetBySheetId(v))||void 0===u?void 0:u.isLoaded){d.next=10;break}return d.next=10,new Promise((function(t){e.dataCenter.loadSheetData({sheetId:h,ignoreChunk:!0,onFinished:function(){t(!0)},onFail:function(e){var n;t(!1),null===(n=r.g.log)||void 0===n||n.error("获取数据验证引用子表("+h+")失败",e)}})}));case 10:if(T=N(e,g,h),null!==(j=R(e,T))){d.next=14;break}return d.abrupt("return",[]);case 14:return j=j.filter((function(e){return e})),d.abrupt("return",Array.from(new Set(j)));case 16:if(y=p.userEnteredValue,c!==n.ITEM_LIST||null===y){d.next=19;break}return d.abrupt("return",b(y));case 19:return d.abrupt("return",null);case 20:case"end":return d.stop()}}),d)})))}function A(e,t,r){return j(this,void 0,void 0,regeneratorRuntime.mark((function n(){var o,s;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(n.prev=0,x(o=(0,v.Ii)(e.spreadsheet.activeSheet,t,r))&&!P(o)){n.next=5;break}return n.abrupt("return",null);case 5:return n.next=7,E(e,o,t,r);case 7:return s=n.sent,n.abrupt("return",s);case 11:return n.prev=11,n.t0=n.catch(0),console.warn("数据验证获取下拉列表错误",n.t0),n.abrupt("return",null);case 15:case"end":return n.stop()}}),n,null,[[0,11]])})))}function S(e){var t,r;if(e.ruleType!==p.Z.LIST)return"";var o=null===(t=null===e||void 0===e?void 0:e.argTokens)||void 0===t?void 0:t[0].type;if(o===m.ARG_TOKEN_TYPE.FORMULA_TOKEN)return n.RANGE_LIST;var s=null===(r=null===e||void 0===e?void 0:e.argTokens)||void 0===r?void 0:r[0].userEnteredValue;return s&&o===m.ARG_TOKEN_TYPE.VALUE_TOKEN&&0!==s.length?n.ITEM_LIST:""}function R(e,t){if(null==t)return null;var r=t.sheetId,n=e.spreadsheet.sheetManager.getSheetBySheetId(r),o=[];if(n){var s=n.data.getCellDatasAtRange(t);null===s||void 0===s||s.forEach((function(e){return e.forEach((function(e){null!=e&&o.push((0,u.getMergedValue)(e))}))}))}return o}!function(e){e.RANGE_LIST="range-list",e.ITEM_LIST="item-list"}(n||(n={}));var N=function(e,t,r){if(!t)return null;if(!r&&e){r=e.spreadsheet.activeSheetId;var n=(0,d.moveEqualChar)(t).split("!")[0];'"'===n[0]&&'"'===n[n.length-1]&&(n=n.substring(1,n.length-1));var o=e.spreadsheet.sheetManager.getSheetBySheetTitle(n);o&&o.getSheetId()!==r&&(r=o.getSheetId())}return r?(0,l.hex2Range)(t,r):null},O=function(e){return-1===["between","notBetween","equal","notEqual","lessThan","lessThanOrEqual","greaterThan","greaterThanOrEqual"].indexOf(e)},w=function(e){return-1===["contains","notContains","equal"].indexOf(e)};function D(e,t,r){void 0===t&&(t="YYYY-MM-DD"),void 0===r&&(r="date");var n=i()(e).format(t);return"date"==r&&(n+="T00:00:00"),s.Utils.numberFormatUtils.formatParseEngine.datetime2Numeric(n)}var k=function(e){if(e){var t=s.Utils.numberFormatUtils.formatParseEngine.parseValueWithStyle(e);return null==t?e:t.value}return e},L=function(e){var t,r=(0,_.jr)(e);if("string"===typeof e)if('""'===e)t=e;else{if(r)return(0,d.moveEqualChar)(e);t='"'+e+'"'}else{if("number"===typeof e||"boolean"===typeof e)return t=""+e;t='""'}return t},M=function(e,t,r){for(var n=t,o=t.sheetId,s=e.sheetManager.getSheetBySheetId(t.sheetId),a=n.isCol?0:n.startRowIndex,i=n.isCol?s.getRowCount()-1:n.endRowIndex,u=n.isRow?0:n.startColIndex,d=n.isRow?s.getColCount()-1:n.endColIndex,c=a;c<=i;c++)for(var l=u;l<=d;l++)r(c,l,o)},Z=function(e){var t=e.view.getSelection();if(!t)return!1;var r=t.activeCell,n=r.rowIndex,o=r.colIndex;return!!(0,v.Sc)(e.spreadsheet.activeSheet,n,o)};function F(e,t,r,n){var a=(void 0===n?{}:n).fractionFirst,i=void 0!==a&&a,u=e.inputOne,l=e.inputTwo,p=e.operate;if(!e.inputTwoShow)return null;if(p!==s.Cell.DATA_VALIDATION_CONDITION_TYPE.BETWEEN&&p!==s.Cell.DATA_VALIDATION_CONDITION_TYPE.NOT_BETWEEN)return null;if(""===u.trim()||""===l.trim())return null;if((0,d.isFormulaString)(u)||(0,d.isFormulaString)(l))return null;var m=(0,c.stringToNumber)(u,{fractionFirst:i}),f=(0,c.stringToNumber)(l,{fractionFirst:i});if(!m||!f)return null;var _=m.numericValue,h=f.numericValue;return"number"!==typeof _||"number"!==typeof h?null:h-_<0?1===t?{inputOneIsError:!0,inputOneErrorTip:o.ZP.t("请输入小于最大值的{{inputType}}",{inputType:r}),inputTwoIsError:!1}:{inputOneIsError:!1,inputTwoIsError:!0,inputTwoErrorTip:o.ZP.t("请输入大于最小值的{{inputType}}",{inputType:r})}:null}var U=function(e){var t=s.Utils.numberFormatUtils.formatParseEngine.parseValue(e,"");return(null===t||void 0===t?void 0:t.type)===T.Z.DATE_TIME||(null===t||void 0===t?void 0:t.type)===T.Z.DATE||(null===t||void 0===t?void 0:t.type)===T.Z.TIME},V=function(e,t){switch(t.ruleType){case p.Z.DATE:return U(e);case p.Z.NUMBER_INT:case p.Z.CUSTOM_MUST_FLOAT:case p.Z.NUMBER_FLOAT_AND_INT:return!U(e)}return!0};function B(e,t,r){var n;return r&&!r.endsWith("%")||(null===(n=null===t||void 0===t?void 0:t.getMetadata())||void 0===n?void 0:n.customDataType)!==g.ZP.PROGRESS?e:"("+e+" * 100)"}},"../spread-sheet/src/core/feature/jankToast/check.ts":function(e,t,r){r.r(t);var n=r("../node_modules/i18next/dist/esm/i18next.js"),o=r("../node_modules/@tencent/docs-user-agent/dist/index.js"),s=r.n(o),a=r("../node_modules/@tencent/dui/lib/components/Snackbar/index.js");t.default="page-editor"==r.j?function(){var e;!s().isIE&&!s().isFirefox||s().isWxWork||null===(e=a.default.show)||void 0===e||e.call(a.default,{message:n.ZP.t("为了有更好的体验，推荐使用最新版Chrome浏览器。"),style:{zIndex:10003},autoClose:!0,closable:!1,duration:3e3})}:null},"../spread-sheet/src/core/feature/relateAio/index.ts":function(e,t,r){r.r(t),r("../node_modules/core-js/modules/es.array.iterator.js"),r("../node_modules/core-js/modules/es.object.to-string.js"),r("../node_modules/core-js/modules/web.dom-collections.iterator.js"),r("../node_modules/core-js/modules/es.map.js"),r("../node_modules/core-js/modules/es.string.iterator.js"),r("../node_modules/core-js/modules/esnext.map.delete-all.js"),r("../node_modules/core-js/modules/esnext.map.every.js"),r("../node_modules/core-js/modules/esnext.map.filter.js"),r("../node_modules/core-js/modules/esnext.map.find.js"),r("../node_modules/core-js/modules/esnext.map.find-key.js"),r("../node_modules/core-js/modules/esnext.map.includes.js"),r("../node_modules/core-js/modules/esnext.map.key-of.js"),r("../node_modules/core-js/modules/esnext.map.map-keys.js"),r("../node_modules/core-js/modules/esnext.map.map-values.js"),r("../node_modules/core-js/modules/esnext.map.merge.js"),r("../node_modules/core-js/modules/esnext.map.reduce.js"),r("../node_modules/core-js/modules/esnext.map.some.js"),r("../node_modules/core-js/modules/esnext.map.update.js"),r("../node_modules/core-js/modules/web.dom-collections.for-each.js"),r("../node_modules/core-js/modules/es.array.map.js"),r("../node_modules/core-js/modules/es.array.from.js"),r("../node_modules/core-js/modules/es.regexp.exec.js"),r("../node_modules/core-js/modules/es.string.split.js"),r("../node_modules/core-js/modules/es.array.slice.js"),r("../node_modules/core-js/modules/es.function.name.js"),r("../node_modules/core-js/modules/es.symbol.js"),r("../node_modules/core-js/modules/es.symbol.description.js"),r("../node_modules/core-js/modules/es.symbol.iterator.js");var n=r("../node_modules/i18next/dist/esm/i18next.js"),o=r("../node_modules/@tencent/tencent_doc_open_url/dist/index.js"),s=r("../spread-sheet/src/base/event/event.ts"),a=r("../spread-sheet/src/core/ui/dialog/index.ts"),i=r("../spread-sheet/src/core/utils/relate/relate.ts"),u=r("../spread-sheet/src/core/utils/relate/api.ts"),d=r("../spread-sheet/src/core/data/configService/spreadConfig.ts"),c=r("../spread-sheet/src/core/ui/toast/toast.tsx"),l=r("../spread-sheet/src/core/utils/relate/RelateType.ts"),p=r("../spread-sheet/src/base/util/appConfig.ts");function m(e,t){var r="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(r)return(r=r.call(e)).next.bind(r);if(Array.isArray(e)||(r=function(e,t){if(e){if("string"===typeof e)return f(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?f(e,t):void 0}}(e))||t&&e&&"number"===typeof e.length){r&&(e=r);var n=0;return function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function f(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}t.default=function(e){var t=this;this.handleRelateAio=function(){var e,r,s=d.q.getConfig("upid"),a=t.app.spreadsheet.activeSheetId;t.isRelated(a)?t.showToolToast(n.ZP.t("该表已经关联过文档小程序，请勿重复关联。")):(null===(r=null===(e=t.app.feature)||void 0===e?void 0:e.relateForm)||void 0===r?void 0:r.isRelated(a))?t.showToolToast(n.ZP.t("该表已经关联过收集表，请勿重复关联。")):t.isContentEmpty()?t.showToolToast(n.ZP.t("关联文档小程序的表格数据不能为空。")):(0,o.tencentDocOpenUrlForAll)({url:"https://"+p.Z.getConfig("runtime.domainName")+"/mall/topic/1001?sheetId="+a+"&padId="+s})},this.handleCheckAio=function(e){var r=t.getRelation(e),n=null===r||void 0===r?void 0:r.docUrl;n&&(0,o.tencentDocOpenUrlForAll)({url:n,wxUrl:"/pages/iViewer/iViewer?url="+encodeURIComponent(n)})},this.handleCancelAio=function(e,r,o){void 0===r&&(r=!0),r?a.dialog.confirm({title:n.ZP.t("取消关联小应用"),content:n.ZP.t("取消关联后，数据的更新将不再同步至小应用。确定取消吗？"),onOk:function(){t.doneCancelAio(e,r,o)}}):t.doneCancelAio(e,r,o)},this.update=function(e,r,n){t.updateRelateMap(e,r),t.updateRelatedInfos(),(0,i.yg)(),r&&n&&t.switchToRelatedSheet(e)},this.isRelated=function(e){return t.relateMap.has(e)},this.getRelatedNumber=function(){return t.relateMap?t.relateMap.size:0},this.getRelatedInfos=function(){return t.relatedInfos},this.getRelation=function(e){return t.relateMap.get(e)||null},this.getRelatedSheetIdByDocId=function(e){for(var r,n=m(t.relateMap.entries());!(r=n()).done;){var o=r.value,s=o[0],a=o[1];if(a.docId.domain_id===e.domain_id&&a.docId.pad_id===e.pad_id)return s}return""},this.initRelation=function(){t.relateMap=new Map,t.relatedInfos=[],(d.q.getConfig("relative")||[]).forEach((function(e){var r=t.getSheetIdBySubId(e.sub_id);r&&t.isRelatedAio(e,r)&&t.relateMap.set(r,{docUrl:e.doc_url,docId:e.doc_id,subId:e.sub_id})})),t.updateRelatedInfos()},this.updateRelatedInfos=function(){if(0===t.getRelatedNumber())return t.relatedInfos=[],void t.updateRelatedAioInfos();var e=Array.from(t.relateMap.values()).map((function(e){return e.docId}));(0,u.eB)(e).then((function(e){t.relatedInfos=e,t.updateRelatedAioInfos()})).catch((function(o){for(var s,a=[],i=0;i<e.length;i++)a.push({doc_meta:{title:n.ZP.t("X小应用{{value}}",{value:i+1}),doc_id:e[i]}});t.relatedInfos=a,t.updateRelatedAioInfos(),null===(s=r.g.log)||void 0===s||s.error("relateAio 获取关联文档X信息失败: "+o)}))},this.isRelatedAio=function(e,r){return!(!e.doc_id||!e.doc_url)&&e.doc_type===l.Z.AIO&&t.app.spreadsheet.sheetManager.hasSheetId(r)},this.doneCancelAio=function(e,o,s){var a=t.getRelation(e);if(a){var i={file:{fileId:d.q.getConfig("padId"),subId:e},relativeFile:{fileId:a.docId.pad_id,subId:a.subId||""}};(0,u.LO)(i).then((function(){t.update(e),null===s||void 0===s||s(),o&&t.showToolToast("取消关联文档小程序成功。")})).catch((function(e){var s;o&&t.showToolToast(n.ZP.t("取消关联文档小应用失败，请稍后重试。")),null===(s=r.g.log)||void 0===s||s.error("relateAio 取消关联文档X失败: "+e)}))}},this.getSheetIdBySubId=function(e){return e?e.split(":")[1]:""},this.updateRelateMap=function(e,r){r?t.relateMap.set(e,{docUrl:r.docUrl,docId:r.docId,subId:r.subId}):t.relateMap.delete(e)},this.updateRelatedAioInfos=function(){s.ZP.header.trigger("relatedAioInfosUpdate")},this.showToolToast=function(e){(0,c.showToast)(e,{},{toolToastCloseTime:3e3})},this.isContentEmpty=function(){for(var e,r=m(t.app.spreadsheet.activeSheet.data.rowData);!(e=r()).done;){var n=e.value,o=null===n||void 0===n?void 0:n.values;if(o)for(var s,a=m(o);!(s=a()).done;){var i=s.value,u=null===i||void 0===i?void 0:i.getEffectiveValue(),d=null===i||void 0===i?void 0:i.getFormula();if((null===u||void 0===u?void 0:u.value)||d)return!1}}return!0},this.switchToRelatedSheet=function(e){t.app.spreadsheet.sheetManager.hasSheetId(e)?s.ZP.sheetsBar.trigger("switchSheet",e):r.g.log.error("switchToRelatedSheet 要切换的子表不存在")},this.app=e,this.initRelation()}},"../spread-sheet/src/core/view/level-2/todo-ent/utils.ts":function(e,t,r){r.d(t,{AE:function(){return i},HE:function(){return p},Lj:function(){return c},TQ:function(){return d},cV:function(){return u},xZ:function(){return l}}),r("../node_modules/core-js/modules/es.array.find.js"),r("../node_modules/dayjs/dayjs.min.js"),r("../packages/model/src/cell/metadata/CustomDataType.ts"),r("../packages/model/src/cell/metadata/date-time/DateTimeTemplateType.ts");var n,o=r("../packages/model/src/range/index.ts"),s=r("../spread-sheet/src/core/behavior/request/range/config.ts"),a=r("../spread-sheet/src/core/view/level-2/wework-component-ent/utils.ts");function i(e){var t=e.view.getSelection().activeCell,r=t.rowIndex,n=t.colIndex,o=e.spreadsheet.activeSheet.getCellDataAtPosition(r,n);return(null===o||void 0===o?void 0:o.isWeworkComponent())||!1}function u(e,t,r){var n=e.spreadsheet.activeSheet.todoManager.crossTodoCell(r,t);return n&&(0,a.CF)("该操作涉及待办单元格，请取消待办后重试"),n}function d(e,t){void 0===t&&(t=!0);var r=!!(e.view.getSelection().rangeSelections||[]).find((function(t){return e.spreadsheet.activeSheet.todoManager.containTodoCell(t)}));return r&&t&&(0,a.CF)("该操作涉及待办单元格，请取消待办后重试"),r}function c(e,t){void 0===t&&(t=!0);var r=function(e){var t=e.view.getSelection().rangeSelections;if(1!==t.length)return null;var r=t[0],n=r.startRowIndex,o=r.startColIndex,s=r.endRowIndex,a=r.endColIndex,i=e.spreadsheet.activeSheet.todoManager.getTodoRange(n,o);return n===s&&o===a&&(null===i||void 0===i?void 0:i.rowIndex)===n&&(null===i||void 0===i?void 0:i.colIndex)===o?i:null}(e);if(null===r||void 0===r?void 0:r.todoId){var n=r.todoId,o=r.rowIndex,s=r.colIndex;return e.view.canvas.todoCenter.deleteTodo(n,o,s),{isTodoMasterCell:!0,isRelatedTodoBindCell:!1}}return{isTodoMasterCell:!1,isRelatedTodoBindCell:d(e,t)}}function l(e,t){var r=t.direction,n=t.range,i=n.sheetId,u=n.startRowIndex,d=n.startColIndex,c=n.endRowIndex,l=n.endColIndex,p=e.spreadsheet.activeSheet.getColCount(),m=e.spreadsheet.activeSheet.getRowCount(),f=r===s.ai.RIGHT||r===s._z.LEFT?new o.GridRange(i,u,c,d,p-1):new o.GridRange(i,u,m-1,d,l),_=e.spreadsheet.activeSheet.todoManager.containTodoCell(f);return _&&(0,a.CF)("该操作涉及待办单元格，请取消待办后重试"),_}function p(e,t){var r=t.toRange,n=t.fromRange,o=e.spreadsheet.activeSheet.todoManager;return!(!o.containTodoCell(r)&&!o.containTodoCell(n))&&((0,a.CF)("该操作涉及待办单元格，请取消待办后重试"),!0)}!function(e){e[e.ALLOW=0]="ALLOW",e[e.CANNOT_EDIT=1]="CANNOT_EDIT",e[e.NON_SINGLE_CELL=2]="NON_SINGLE_CELL",e[e.RIGHT_SIDE_NOT_ENOUGH_CELL=3]="RIGHT_SIDE_NOT_ENOUGH_CELL",e[e.RIGHT_SIDE_CONTAIN_TODO=4]="RIGHT_SIDE_CONTAIN_TODO",e[e.RIGHT_SIDE_CONTAIN_STAFF_CARD=5]="RIGHT_SIDE_CONTAIN_STAFF_CARD",e[e.RIGHT_SIDE_CONTAIN_GROUP_CARD=6]="RIGHT_SIDE_CONTAIN_GROUP_CARD",e[e.RIGHT_SIDE_CONTAIN_SCHEDULE=7]="RIGHT_SIDE_CONTAIN_SCHEDULE",e[e.RIGHT_SIDE_CONTAIN_COLUMN_VALIDATION=8]="RIGHT_SIDE_CONTAIN_COLUMN_VALIDATION",e[e.INSERT_IN_FILTER_AREA=9]="INSERT_IN_FILTER_AREA"}(n||(n={}))},"../spread-sheet/src/external/check-slr/sc-lazy-loader.ts":function(e,t,r){r.d(t,{FU:function(){return h},Hz:function(){return m},LL:function(){return j},Tf:function(){return y},XT:function(){return c},_3:function(){return f},e_:function(){return g},f_:function(){return p},h2:function(){return l},iK:function(){return v},rq:function(){return _},uo:function(){return I},wQ:function(){return T}}),r("../node_modules/regenerator-runtime/runtime.js"),r("../node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),r("../node_modules/core-js/modules/esnext.reflect.metadata.js"),r("../node_modules/core-js/modules/es.object.to-string.js"),r("../node_modules/core-js/modules/es.promise.js"),r("../node_modules/core-js/modules/es.array.iterator.js"),r("../node_modules/core-js/modules/es.string.iterator.js"),r("../node_modules/core-js/modules/web.dom-collections.iterator.js");var n=r("react"),o=r("../spread-sheet/src/base/util/decorator/loading-decorator.ts"),s=function(e,t,r,n){var o,s=arguments.length,a=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var i=e.length-1;i>=0;i--)(o=e[i])&&(a=(s<3?o(a):s>3?o(t,r,a):o(t,r))||a);return s>3&&a&&Object.defineProperty(t,r,a),a},a=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},i=function(e,t,r,n){return new(r||(r=Promise))((function(o,s){function a(e){try{u(n.next(e))}catch(t){s(t)}}function i(e){try{u(n.throw(e))}catch(t){s(t)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,i)}u((n=n.apply(e,t||[])).next())}))},u=function(){function e(){}var t=e.prototype;return t.getSCMobileInput=function(){return i(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([r.e("initial_vendors_tencent_dui"),r.e("sc-mobile-input-dialog")]).then(r.t.bind(r,"../node_modules/@tencent/docs-scenario-components-mobile-input-dialog/dist/index.js",23));case 2:return t=e.sent,e.abrupt("return",t);case 4:case"end":return e.stop()}}),e)})))},t.getSCMobileFileSelector=function(){return i(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.e("sc-mobile-file-selector").then(r.t.bind(r,"../node_modules/@tencent/docs-scenario-components-mobile-file-selector/dist/index.js",23));case 2:return t=e.sent,e.abrupt("return",t);case 4:case"end":return e.stop()}}),e)})))},t.getSCPcFileSelector=function(){return i(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.e("sc-pc-file-selector").then(r.t.bind(r,"../node_modules/@tencent/docs-scenario-components-pc-file-selector/dist/index.js",23));case 2:return t=e.sent,e.abrupt("return",t);case 4:case"end":return e.stop()}}),e)})))},t.getSCPaletteOld=function(){return i(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.e("sc-palette-old").then(r.t.bind(r,"../node_modules/@tencent/docs-scenario-components-palette-old/dist/index.js",23));case 2:return t=e.sent,e.abrupt("return",t);case 4:case"end":return e.stop()}}),e)})))},t.getSCPaletteNew=function(){return i(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.e("sc-palette-new").then(r.t.bind(r,"../node_modules/@tencent/docs-scenario-components-pc-palette/dist/index.js",23));case 2:return t=e.sent,e.abrupt("return",t);case 4:case"end":return e.stop()}}),e)})))},t.getSCMobileMenu=function(){return i(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([r.e("initial_vendors_tencent_4"),r.e("sc-mobile-menu")]).then(r.t.bind(r,"../node_modules/@tencent/docs-scenario-components-mobile-menu/dist/index.js",23));case 2:return t=e.sent,e.abrupt("return",t);case 4:case"end":return e.stop()}}),e)})))},t.getSCMobileCamera=function(){return i(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.resolve().then(r.t.bind(r,"../node_modules/@tencent/docs-scenario-components-mobile-camera/dist/index.js",23));case 2:return t=e.sent,e.abrupt("return",t);case 4:case"end":return e.stop()}}),e)})))},t.getSCSaveTemplate=function(){return i(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([r.e("initial_vendors_tencent_dui"),r.e("sc-save-template")]).then(r.t.bind(r,"../node_modules/@tencent/docs-scenario-components-save-template/dist/index.js",23));case 2:return t=e.sent,e.abrupt("return",t);case 4:case"end":return e.stop()}}),e)})))},t.getScMobileMenuMoveFile=function(){return i(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([r.e("initial_vendors_tencent_4"),r.e("sc-mobile-menu-move-file")]).then(r.t.bind(r,"../node_modules/@tencent/docs-scenario-components-mobile-menu-move-file/dist/index.js",23));case 2:return t=e.sent,e.abrupt("return",t);case 4:case"end":return e.stop()}}),e)})))},t.getScMobileTipButton=function(){return i(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.e("sc-mobile-tip-button").then(r.t.bind(r,"../node_modules/@tencent/docs-scenario-components-mobile-tip-button/dist/index.js",23));case 2:return t=e.sent,e.abrupt("return",t);case 4:case"end":return e.stop()}}),e)})))},e}();s([(0,o.n)(),a("design:type",Function),a("design:paramtypes",[]),a("design:returntype",Promise)],u.prototype,"getSCMobileInput",null),s([(0,o.n)(),a("design:type",Function),a("design:paramtypes",[]),a("design:returntype",Promise)],u.prototype,"getSCMobileFileSelector",null),s([(0,o.n)(),a("design:type",Function),a("design:paramtypes",[]),a("design:returntype",Promise)],u.prototype,"getSCPcFileSelector",null),s([(0,o.n)(),a("design:type",Function),a("design:paramtypes",[]),a("design:returntype",Promise)],u.prototype,"getSCPaletteOld",null),s([(0,o.n)(),a("design:type",Function),a("design:paramtypes",[]),a("design:returntype",Promise)],u.prototype,"getSCPaletteNew",null),s([(0,o.n)(),a("design:type",Function),a("design:paramtypes",[]),a("design:returntype",Promise)],u.prototype,"getSCMobileMenu",null),s([(0,o.n)(),a("design:type",Function),a("design:paramtypes",[]),a("design:returntype",Promise)],u.prototype,"getSCMobileCamera",null),s([(0,o.n)(),a("design:type",Function),a("design:paramtypes",[]),a("design:returntype",Promise)],u.prototype,"getSCSaveTemplate",null),s([(0,o.n)(),a("design:type",Function),a("design:paramtypes",[]),a("design:returntype",Promise)],u.prototype,"getScMobileMenuMoveFile",null),s([(0,o.n)(),a("design:type",Function),a("design:paramtypes",[]),a("design:returntype",Promise)],u.prototype,"getScMobileTipButton",null);var d=new u,c="page-editor"==r.j?(0,n.lazy)((function(){return r.e("sc-palette-old").then(r.t.bind(r,"../node_modules/@tencent/docs-scenario-components-palette-old/dist/index.js",23))})):null,l="page-editor"==r.j?(0,n.lazy)((function(){return r.e("sc-palette-new").then(r.t.bind(r,"../node_modules/@tencent/docs-scenario-components-pc-palette/dist/index.js",23))})):null,p="page-editor"==r.j?(0,n.lazy)((function(){return r.e("sc-pc-menu-file-info").then(r.t.bind(r,"../node_modules/@tencent/docs-scenario-components-pc-menu-file-info/dist/index.js",23))})):null,m=d.getSCMobileInput,f=d.getSCMobileFileSelector,_=d.getSCPcFileSelector,h=d.getSCMobileMenu,g=d.getSCMobileCamera,v=d.getSCSaveTemplate,T=d.getScMobileMenuMoveFile,j=d.getSCPaletteOld,y=d.getSCPaletteNew,I=d.getScMobileTipButton}}]),window.jsExecEndTimeStamp=Date.now(),window.cachedPerformanceEntries||(window.cachedPerformanceEntries=[]),window.cachedPerformanceEntries.push({name:"jsExec: js/bundle_feature.b415cf02f626d25697fe.js",entryType:"jsExec",startTime:window.jsExecStartTimeStamp,endTime:window.jsExecEndTimeStamp});
//# sourceMappingURL=bundle_feature.b415cf02f626d25697fe.js.map