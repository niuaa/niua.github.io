self.window=self,window.jsExecStartTimeStamp=Date.now(),(self.webpackChunk_tencent_alloy_builder=self.webpackChunk_tencent_alloy_builder||[]).push([["bundle_pcReadonlyPluginService"],{"../spread-sheet/src/external/waterMark/config.ts":function(e,t,n){n.d(t,{a:function(){return r}});var r=!0},"../spread-sheet/src/flow/browser/phase/services/plugins/level1/readonly-plugins-service-pc.ts":function(e,t,n){n.r(t),n.d(t,{default:function(){return O}});var r,i,o,a,s,c,u,d,l=n("../node_modules/@babel/runtime/helpers/esm/createClass.js"),f=(n("../node_modules/regenerator-runtime/runtime.js"),n("../node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),n("../node_modules/core-js/modules/esnext.reflect.metadata.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.promise.js"),n("../node_modules/core-js/modules/es.array.iterator.js"),n("../node_modules/core-js/modules/es.string.iterator.js"),n("../node_modules/core-js/modules/web.dom-collections.iterator.js"),n("../node_modules/core-js/modules/es.array.map.js"),n("../node_modules/core-js/modules/web.dom-collections.for-each.js"),n("../node_modules/@tencent/containerized/build/main/index.js")),p=n("../spread-sheet/src/ServiceCollection/index.ts"),h=n("../spread-sheet/src/core/app/SpreadsheetApp.interface.ts"),v=n("../packages/common-utils/src/index.ts"),m=n("../spread-sheet/src/base/error/errorCodeModalProxy.ts"),g=n("../packages/report/src/index.ts"),w=n("../spread-sheet/src/external/titleSync/titleSync.interface.ts"),R=n("../spread-sheet/src/external/badgeServiceExcelAdapter/badgeServiceExcelAdapter.interface.ts"),x=n("../spread-sheet/src/external/resetLocation/resetLocation.interface.ts"),S=n("../spread-sheet/src/external/waterMark/config.ts"),y=n("../spread-sheet/src/external/auth/pc/AdvPermissions.ts"),P=n("../spread-sheet/src/external/collaboration/collaboration-manager.interface.ts"),k=n("../node_modules/@tencent/docs-user-agent/dist/index.js"),E=n.n(k),b=n("../spread-sheet/src/flow/common/utils.ts"),j=n("../spread-sheet/src/core/data/configService/spreadConfig.ts"),L=(n("../spread-sheet/src/base/util/domain-config.ts"),n("../spread-sheet/src/external/sync-guide/sync-guide.interface.ts")),_=n("../spread-sheet/src/flow/browser/phase/services/sheetLifecyle.interface.ts"),C=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},A=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},I=function(e,t){return function(n,r){t(n,r,e)}},T=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{c(r.next(e))}catch(t){o(t)}}function s(e){try{c(r.throw(e))}catch(t){o(t)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},M=function(){function e(e,t,n,r,i,o,a,s){this.app=e,this.titleSync=t,this.badgeServiceExcelAdapter=n,this.resetLocation=r,this.advPermissionsPC=i,this.collaborationManager=o,this.sheetLifeService=a,this.syncGuide=s}var t=e.prototype;return t.init=function(){var e;return T(this,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return null===(e=n.g.log)||void 0===e||e.info("flow PcPluginService init()",!!this.app.view.plugins),this.app.emitter.emit(this.app.EVENT.SPREAD_SHEET_PLUGINS_START),this.sheetLifeService.phase=_.P.SPREAD_SHEET_PLUGINS_START,t.next=5,this.initPlugins();case 5:case"end":return t.stop()}}),t,this)})))},t.getCollaborationManager=function(){return T(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.collaborationManager.getInstance();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})))},t.initAdvPermissions=function(){var e;return T(this,void 0,void 0,regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.advPermissionsPC.getInstance();case 2:return r=t.sent,this.app.initAdvPermissions(r),t.next=6,r.init();case 6:null===(e=n.g.log)||void 0===e||e.debug("flow AdvPermissions init() end");case 7:case"end":return t.stop()}}),t,this)})))},t.initPlugins=function(){return T(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=[this.initGuideBackToWecomToolTips(),this.initWatermark(),this.initErrorCode(),this.initUIManager(),this.initTitleSync(),this.initBadgeService(),this.initFullMember(),this.initUserGuide(),this.initReport(),this.initErrorCodeModal(),this.initRangeAuth(),this.initSheetExportManager(),this.initResetLocation(),this.initMention(),this.initAriaHelp(),this.initAdvPermissions(),this.initCollaboration()],e.next=3,Promise.all(t.map((function(e){return e.catch((function(e){return e}))}))).then((function(e){e.forEach((function(e,t){var r;"error"===(null===e||void 0===e?void 0:e.type)&&(null===(r=n.g.log)||void 0===r||r.error("flow","plugin load error",e.message,t),console.error(e.message))}))})).catch((function(e){var t;console.error(e),null===(t=n.g.log)||void 0===t||t.error("flow","PcPluginService initPlugins error()",null===e||void 0===e?void 0:e.stack)}));case 3:return e.next=5,this.initAutoUrl();case 5:case"end":return e.stop()}}),e,this)})))},t.initAutoUrl=function(){var e;return T(this,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:t.next=5;break;case 4:null===(e=n.g.log)||void 0===e||e.info("flow","PcPluginService initAutoUrl() end");case 5:case"end":return t.stop()}}),t,this)})))},t.initWatermark=function(){return T(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!S.a){e.next=8;break}return t=this.serviceCollection.createLoader(p.kh.WATERMARK),e.next=4,t.load();case 4:n=e.sent,(new(0,n.WatermarkController)).loadWatermark();case 8:case"end":return e.stop()}}),e,this)})))},t.initTitleSync=function(){var e;return T(this,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.titleSync.getInstance();case 2:t.sent.init(),null===(e=n.g.log)||void 0===e||e.info("flow","PcPluginService initTitleSync() end");case 5:case"end":return t.stop()}}),t,this)})))},t.initBadgeService=function(){return T(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.badgeServiceExcelAdapter.getInstance();case 2:e.sent.init();case 4:case"end":return e.stop()}}),e,this)})))},t.initMention=function(){var e;return T(this,void 0,void 0,regeneratorRuntime.mark((function t(){var r,i;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=p.kh.MENTION,i=this.serviceCollection.createLoader(r),t.next=4,i.init(this.app);case 4:t.sent,null===(e=n.g.log)||void 0===e||e.info("flow","PcPluginService initMention() end");case 7:case"end":return t.stop()}}),t,this)})))},t.initResetLocation=function(){var e;return T(this,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if("1"!==(0,v.IZ)("selection_cancel")){t.next=3;break}return t.abrupt("return");case 3:return t.next=5,this.resetLocation.getInstance();case 5:t.sent.init((0,v.IZ)("tab",n.g.__originUrl)),null===(e=n.g.log)||void 0===e||e.info("flow","PcPluginService initResetLocation() end");case 8:case"end":return t.stop()}}),t,this)})))},t.initUIManager=function(){var e;return T(this,void 0,void 0,regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=this.serviceCollection.createLoader(p.kh.UI_MANAGER),t.next=3,r.init(this.app);case 3:null===(e=n.g.log)||void 0===e||e.info("flow","PcPluginService initUIManager() end");case 4:case"end":return t.stop()}}),t,this)})))},t.initFullMember=function(){var e;return T(this,void 0,void 0,regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=this.serviceCollection.createLoader(p.kh.FULL_MEMBER),t.next=3,r.init(this.app);case 3:null===(e=n.g.log)||void 0===e||e.info("flow","PcPluginService initFullMember() end");case 4:case"end":return t.stop()}}),t,this)})))},t.initUserGuide=function(){var e;return T(this,void 0,void 0,regeneratorRuntime.mark((function t(){var r,i;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=this.serviceCollection.createLoader(p.kh.USER_GUIDE),t.next=3,r.init(this.app);case 3:i=t.sent,this.app.view.userGuide=i,null===(e=n.g.log)||void 0===e||e.info("flow","PcPluginService initUserGuide() end");case 6:case"end":return t.stop()}}),t,this)})))},t.initRangeAuth=function(){var e;return T(this,void 0,void 0,regeneratorRuntime.mark((function t(){var r,i;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=this.serviceCollection.createLoader(p.kh.PC_RANGE_AUTH),t.next=3,r.init(this.app);case 3:(i=t.sent).initDefault(),this.app.view.rangeAuth=i,null===(e=n.g.log)||void 0===e||e.info("flow","PcPluginService initRangeAuth() end");case 7:case"end":return t.stop()}}),t,this)})))},t.initSheetExportManager=function(){var e;return T(this,void 0,void 0,regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:r=this.serviceCollection.createLoader(p.kh.SHEET_EXPORT_MANAGER),this.app.setSheetExportManagerLoader(r),null===(e=n.g.log)||void 0===e||e.info("flow","PcPluginService initSheetExportManager() end");case 3:case"end":return t.stop()}}),t,this)})))},t.initErrorCode=function(){var e;return T(this,void 0,void 0,regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=this.serviceCollection.createLoader(p.kh.ERROR_CODE),t.next=3,r.init(this.app);case 3:null===(e=n.g.log)||void 0===e||e.info("flow","PcPluginService initErrorCode() end");case 4:case"end":return t.stop()}}),t,this)})))},t.initErrorCodeModal=function(){var e;return T(this,void 0,void 0,regeneratorRuntime.mark((function t(){var r,i;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=this.serviceCollection.createLoader(p.kh.ERROR_CODE_MODAL),t.next=3,r.load();case 3:i=t.sent,m.f.eachLoad(i.default),null===(e=n.g.log)||void 0===e||e.info("flow","PcPluginService initErrorCodeModal() end");case 6:case"end":return t.stop()}}),t,this)})))},t.initReport=function(){var e;return T(this,void 0,void 0,regeneratorRuntime.mark((function t(){var r,i,o;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=this.serviceCollection.createLoader(p.kh.REPORT),t.next=3,r.load();case 3:return i=t.sent,t.next=6,i.setCorpInfoToClientVars();case 6:null===g.O8||void 0===g.O8||g.O8.eachLoad(i.default),o=function(){var e,t;try{i.default.jank.startMonitor()}catch(a){console.error("卡顿监控开启失败",a)}var n=null;(null===(e=window.performance)||void 0===e?void 0:e.memory)&&(n=null===(t=window.performance)||void 0===t?void 0:t.memory);var r={};n&&(r={jsHeapSizeLimit:n.jsHeapSizeLimit||0,totalJSHeapSize:n.totalJSHeapSize||0,usedJSHeapSize:n.usedJSHeapSize||0});try{var o={opername:"excel_jank",module:"memory",action:"opened_memory",obj3:JSON.stringify(r)};g.ZP.tdwSingleReport(o)}catch(s){}},window.SpreadsheetAppInitComplete?o():this.app.emitter.once(this.app.EVENT.SPREAD_SHEET_ALL_CHUNK_READY,(function(){o()})),null===(e=n.g.log)||void 0===e||e.info("flow","PcPluginService initReport() end");case 10:case"end":return t.stop()}}),t,this)})))},t.initAriaHelp=function(){var e;return T(this,void 0,void 0,regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=this.serviceCollection.createLoader(p.kh.ARIA_HELP),t.next=3,r.load();case 3:t.sent.default.init(),null===(e=n.g.log)||void 0===e||e.info("flow","PcPluginService initAriaHelp() end");case 6:case"end":return t.stop()}}),t,this)})))},t.initCollaboration=function(){var e;return T(this,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.collaborationManager.getInstance();case 2:t.sent.init(),null===(e=n.g.log)||void 0===e||e.info("flow","PcPluginService collaborationManager() end");case 5:case"end":return t.stop()}}),t,this)})))},t.initGuideBackToWecomToolTips=function(){var e;return T(this,void 0,void 0,regeneratorRuntime.mark((function t(){var r=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(E().isWeChat&&(0,b.AU)("wx")){t.next=3;break}return this.initSyncGuide(),t.abrupt("return");case 3:console.error("GuideBackToWecomToolTips 开始调用load"),null===(e=n.g.SLR)||void 0===e||e.load("GuideBackToWecomToolTips",(function(e){e.show({fileId:j.q.getConfig("padId"),openId:j.q.getConfig("wxOpenId"),docUrl:j.q.getConfig("shortLink"),onCancel:function(){},onDone:function(){},canOpenOtherPopup:function(e){e&&r.initSyncGuide()}})}),(function(){n.g.log.error("组件加载失败")}));case 5:case"end":return t.stop()}}),t,this)})))},t.initSyncGuide=function(){return T(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.syncGuide.getInstance();case 2:e.sent.init();case 4:case"end":return e.stop()}}),e,this)})))},(0,l.Z)(e,[{key:"serviceCollection",get:function(){return this.app.serviceCollection}}]),e}(),O=M=C([I(0,h.m),I(1,w.J),I(2,R.P),I(3,x.h),I(4,y.IAdvPermissionsPC),I(5,P.pI),I(6,_.n),I(7,L.F),A("design:paramtypes",["function"===typeof(r="undefined"!==typeof h.m&&h.m)?r:Object,"function"===typeof(i="undefined"!==typeof f.IDynamicLoader&&f.IDynamicLoader)?i:Object,"function"===typeof(o="undefined"!==typeof f.IDynamicLoader&&f.IDynamicLoader)?o:Object,"function"===typeof(a="undefined"!==typeof f.IDynamicLoader&&f.IDynamicLoader)?a:Object,"function"===typeof(s="undefined"!==typeof f.IDynamicLoader&&f.IDynamicLoader)?s:Object,"function"===typeof(c="undefined"!==typeof f.IDynamicLoader&&f.IDynamicLoader)?c:Object,"function"===typeof(u="undefined"!==typeof _.n&&_.n)?u:Object,"function"===typeof(d="undefined"!==typeof f.IDynamicLoader&&f.IDynamicLoader)?d:Object])],M)}}]),window.jsExecEndTimeStamp=Date.now(),window.cachedPerformanceEntries||(window.cachedPerformanceEntries=[]),window.cachedPerformanceEntries.push({name:"jsExec: js/bundle_pcReadonlyPluginService.5b1acf5c081feb139b01.js",entryType:"jsExec",startTime:window.jsExecStartTimeStamp,endTime:window.jsExecEndTimeStamp});
//# sourceMappingURL=bundle_pcReadonlyPluginService.5b1acf5c081feb139b01.js.map