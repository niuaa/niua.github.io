self.window=self,window.jsExecStartTimeStamp=Date.now(),(self.webpackChunk_tencent_alloy_builder=self.webpackChunk_tencent_alloy_builder||[]).push([["spread-sheet_src_core_utils_gray_ts-spread-sheet_src_core_view_level-2_condition-format-cente-74d507"],{"../spread-sheet/src/base/storage/storage.ts":function(e,t,n){function o(e,t){t.createdDate=+new Date;var n="docs_actions",o=function(e){if("undefined"!==typeof window.Storage)return localStorage.getItem(e)}(n);o=o&&JSON.parse(o)||[];var i={};o.forEach((function(e,t){var n=e.data;i[n.localPadId+"$"+n.domainId]={index:t,type:e.type,value:n}}));var s=i[t.localPadId+"$"+t.domainId];if(s){for(var r=0,a=Object.keys(t);r<a.length;r++){var c=a[r];s.value[c]=t[c]}o[s.index]={type:"ADD"===s.type&&"MODIFY"===e?"ADD":e,data:s.value}}else o.push({type:e,data:t});!function(e,t){"undefined"!==typeof window.Storage&&localStorage.setItem(e,t)}(n,JSON.stringify(o))}n.d(t,{G:function(){return o}}),n("../node_modules/core-js/modules/web.dom-collections.for-each.js"),n("../node_modules/core-js/modules/es.object.keys.js")},"../spread-sheet/src/base/util/deviceEnv/index.ts":function(e,t,n){n.d(t,{XJ:function(){return a},Q:function(){return C}}),n("../node_modules/core-js/modules/es.regexp.constructor.js"),n("../node_modules/core-js/modules/es.regexp.exec.js"),n("../node_modules/core-js/modules/es.regexp.to-string.js"),n("../node_modules/core-js/modules/es.string.split.js");var o=n("../node_modules/@tencent/docs-user-agent/dist/index.js"),i=n.n(o),s=-2,r=function(e){return e.some((function(e){return e}))};function a(){if(-2!==s)return s;var e=d();return void 0!==e?e:s=-1}var c,l,d=function(){if([r([i().isMobilePhone,i().isAndroidPad]),i().isTencentDocApp].every((function(e){return e}))){var e=new RegExp("Channel/[0-9]+","i").exec(i().userAgent.toLowerCase())||[];if(r([!e,!e[0]]))return s=-1;var t=e[0];return s=parseInt(t.split("/")[1],10)}},u=n("../node_modules/i18next/dist/esm/i18next.js"),p=n("../spread-sheet/src/external/templateinfo/sync-template.ts"),h=n("../packages/report/src/index.ts"),m=n("../packages/common-utils/src/index.ts"),f=n("../spread-sheet/src/core/script-loader/index.ts");!function(e){e.cannotPreview="1"}(c||(c={})),function(e){e[e.Back=0]="Back",e[e.Complete=1]="Complete"}(l||(l={}));var g=function(){h.ZP.tdwReport({opername:"doc_excel_editor",module:"excel_topbar",action:"top-bar-back-list"})},v=function(e,t){e&&t&&t()},w=function(e,t,n){var o,i=e===l.Back,s=e===l.Complete,r=i?"back_dialog_showed_tag":"complete_dialog_showed_tag",a=function(e){return e?parseInt(e,10):0}(localStorage.getItem(r));(o=a)>=0&&o<=2?((0,f.$y)("UIComponent",(function(e){var o;v(s,n),document.getElementById("mobileDialogContainer")||$("body").append('<div id="mobileDialogContainer" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; z-index: 10004;"></div>');var r=document.getElementById("mobileDialogContainer");null===(o=null===e||void 0===e?void 0:e.showMobileDialog)||void 0===o||o.call(e,r,{dialogType:i?"BACK":"COMPLETE",cb:t})})),localStorage.setItem(r,String(a+1))):(v(s,n),t())},y=!0,C=function(){var e,t;if(String((0,m.IZ)("preview"))!==c.cannotPreview)try{var o=(0,m.IZ)("group_code"),i=(0,m.IZ)("is_create_doc"),s=_(o,i);null===(e=n.g.mqq)||void 0===e||e.ui.setTitleButtons(s)}catch(r){null===(t=n.g.log)||void 0===t||t.error(r)}},b=function(){var e,t;null===(t=null===(e=n.g.mqq)||void 0===e?void 0:e.ui)||void 0===t||t.closeWebViews({mode:0,exclude:!1})},x=function(){y=!0},_=function(e,t){var o={};return o=e&&t?{left:{title:u.ZP.t("返回"),callback:function(){var e;g(),w(l.Back,null===(e=n.g.mqq)||void 0===e?void 0:e.ui.popBack)}},right:{title:u.ZP.t("完成"),callback:function(){y&&(0,f.$y)("GroupCreator",(function(t){y=!1,null===t||void 0===t||t.createNewDoc4Group(n.g.clientVars,e,(function(){return function(e,t){w(l.Complete,b,(function(){null===e||void 0===e||e.sendDocToGroupAio(n.g.clientVars,t)})),y=!0}(t,e)}),x)}))}}}:{right:{iconID:4,callback:function(){var e;g(),(0,p.D)(),null===(e=n.g.mqq)||void 0===e||e.ui.showShareMenu()}}},o};n("../spread-sheet/src/base/util/mobile.ts"),n("../spread-sheet/src/base/util/deviceEnv/wx.ts")},"../spread-sheet/src/base/util/deviceEnv/wx.ts":function(e,t,n){n.d(t,{Di:function(){return g},JC:function(){return h}}),n("../node_modules/regenerator-runtime/runtime.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.promise.js");var o,i=n("../packages/report/src/index.ts"),s=n("../node_modules/@tencent/docs-user-agent/dist/index.js"),r=n.n(s),a=n("../packages/common-utils/src/index.ts"),c=n("../spread-sheet/src/external/templateinfo/sync-template.ts"),l=n("../spread-sheet/src/base/util/domain-config.ts"),d=n("../spread-sheet/src/base/util/appConfig.ts"),u=function(e,t,n,o){return new(n||(n=Promise))((function(i,s){function r(e){try{c(o.next(e))}catch(t){s(t)}}function a(e){try{c(o.throw(e))}catch(t){s(t)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(r,a)}c((o=o.apply(e,t||[])).next())}))};!function(e){e[e.doc=0]="doc",e[e.sheet=1]="sheet"}(o||(o={}));var p=function(e){i.ZP.tdwReport({opername:"doc_share",module:"wecha_h5",action:e})};function h(e){return u(this,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if([r().isWeChat,r().isWxWork].some((function(e){return e}))||l.xc){t.next=2;break}return t.abrupt("return");case 2:if(!window.wx){t.next=5;break}return null===e||void 0===e||e(),t.abrupt("return");case 5:return t.next=7,(0,a.ve)(m());case 7:return t.next=9,(0,a.ve)(f());case 9:null===e||void 0===e||e();case 10:case"end":return t.stop()}}),t)})))}var m=function(){return[r().isWxWork,!r().isAndroid].every((function(e){return e}))?d.Z.getConfig("runtime.library.TENCENT_DOCS_LIBRARY__jweixin_1_2_0"):d.Z.getConfig("runtime.library.TENCENT_DOCS_LIBRARY__jweixin_1_6_0")},f=function(){return d.Z.getConfig("runtime.library.TENCENT_DOCS_LIBRARY__jwxwork_1_0_0")};function g(e){var t,n=e.title,o=e.desc,i=e.share_url,s=e.image_url;null===(t=null===window||void 0===window?void 0:window.wx)||void 0===t||t.onMenuShareAppMessage({title:n,desc:o,link:i,imgUrl:s,type:"",dataUrl:"",success:function(){(0,c.D)(),null===window||void 0===window||window.log.info("onMenuShareAppMessage:success"),p("wechat_suc")},cancel:function(){},trigger:function(){p("share_wechat")}}),null===window||void 0===window||window.wx.onMenuShareTimeline({title:n,link:i,imgUrl:s,success:function(){p("moment_suc")},cancel:function(){},trigger:function(){p("share_moment")}}),null===window||void 0===window||window.wx.onMenuShareQQ({title:n,desc:o,link:i,imgUrl:s,success:function(){},cancel:function(){}})}},"../spread-sheet/src/base/util/html.ts":function(e,t,n){function o(e,t,n,o){return e.addEventListener?e.addEventListener(t,n,o):e.attachEvent&&e.attachEvent("on"+t,(function(){n(window.event)})),e}function i(e,t,n,o){e.removeEventListener?e.removeEventListener(t,n,o):e.detachEvent&&e.detachEvent("on"+t,(function(){n(window.event)}))}function s(e,t){e&&e.classList.add(t)}function r(e,t){e&&e.classList.remove(t)}n.d(t,{GM:function(){return c},IV:function(){return r},cn:function(){return s},vP:function(){return o},xC:function(){return i}}),n("../node_modules/core-js/modules/es.regexp.exec.js"),n("../node_modules/core-js/modules/es.string.replace.js"),n("../node_modules/core-js/modules/es.array.concat.js"),n("../node_modules/core-js/modules/web.dom-collections.for-each.js"),n("../node_modules/core-js/modules/es.object.keys.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.array.slice.js"),n("../packages/common-utils/src/index.ts");var a={CSS:{Sequence:function(){var e=/\\((([\dA-F]{2}|[\dA-F]{1,5})\s)|([\dA-F]{6}|[\dA-F]{4}))/gim;return e.unescape=function(e){var t=window,n=t.String.fromCharCode,o=t.parseInt;return e.replace(this,(function(e){return n(o(e.slice(2),16))}))},e}()}},c=function(e){return function(e){return e.replace(/(\\.)/g,(function(e){return e.slice(1)})).replace(/(\\[$\-+/():!^&'~{}<>= ])/g,(function(e){return e.slice(1)}))}(a.CSS.Sequence.unescape(e))}},"../spread-sheet/src/core/ui/index.ts":function(e,t,n){n.d(t,{Z:function(){return E}});var o={};n.r(o),n.d(o,{hideModal:function(){return l},showModal:function(){return c}});var i={};n.r(i),n.d(i,{Progress:function(){return x},default:function(){return S}});var s=n("../spread-sheet/src/core/ui/dialog/index.ts"),r=n("../spread-sheet/src/core/ui/alert/index.ts"),a=n("../spread-sheet/src/core/ui/lazyLoad.ts"),c=function(e,t,n){(0,a.Fd)().then((function(o){o.default.showModal(e,t,n)}))},l=function(e,t){(0,a.Fd)().then((function(n){n.default.hideModal(e,t)}))},d=n("../spread-sheet/src/core/ui/toast/index.ts"),u=n("../spread-sheet/src/core/ui/tooltip/index.ts"),p=n("../node_modules/@babel/runtime/helpers/esm/createClass.js"),h=(n("../node_modules/regenerator-runtime/runtime.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.promise.js"),n("../node_modules/core-js/modules/es.object.assign.js"),n("../node_modules/core-js/modules/es.array.includes.js"),n("../node_modules/core-js/modules/es.string.includes.js"),n("../node_modules/core-js/modules/es.array.map.js"),n("../node_modules/core-js/modules/es.array.fill.js"),n("../node_modules/core-js/modules/web.dom-collections.for-each.js"),n("../node_modules/core-js/modules/es.object.keys.js"),n("../node_modules/core-js/modules/es.array.iterator.js"),n("../node_modules/core-js/modules/web.dom-collections.iterator.js"),n("../spread-sheet/src/core/view/spreadsheet-view/utils.ts")),m=n("../packages/model/src/dimension/index.ts"),f=n("react"),g=n.n(f),v=n("react-dom"),w=n.n(v),y=function(e){var t=e.progress;if(t<=.05)return g().createElement("img",{style:{width:"16px",height:"16px"},src:"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHN0eWxlPSJtYXJnaW46YXV0byIgd2lkdGg9IjQwIiBoZWlnaHQ9IjQwIiB2aWV3Qm94PSIwIDAgMTAwIDEwMCIgcHJlc2VydmVBc3BlY3RSYXRpbz0ieE1pZFlNaWQiIGRpc3BsYXk9ImJsb2NrIj48Y2lyY2xlIGN4PSI1MCIgY3k9IjUwIiByPSIzMCIgc3Ryb2tlPSIjZGFlOWZmODAiIHN0cm9rZS13aWR0aD0iMTAiIGZpbGw9Im5vbmUiLz48Y2lyY2xlIGN4PSI1MCIgY3k9IjUwIiByPSIzMCIgc3Ryb2tlPSIjNDg5MmZlIiBzdHJva2Utd2lkdGg9IjEwIiBzdHJva2UtbGluZWNhcD0icm91bmQiIGZpbGw9Im5vbmUiIHRyYW5zZm9ybT0icm90YXRlKDcwOC45NTIgNTAgNTApIj48YW5pbWF0ZVRyYW5zZm9ybSBhdHRyaWJ1dGVOYW1lPSJ0cmFuc2Zvcm0iIHR5cGU9InJvdGF0ZSIgcmVwZWF0Q291bnQ9ImluZGVmaW5pdGUiIGR1cj0iMS4yNXMiIHZhbHVlcz0iMCA1MCA1MDsxODAgNTAgNTA7NzIwIDUwIDUwIiBrZXlUaW1lcz0iMDswLjU7MSIvPjxhbmltYXRlIGF0dHJpYnV0ZU5hbWU9InN0cm9rZS1kYXNoYXJyYXkiIHJlcGVhdENvdW50PSJpbmRlZmluaXRlIiBkdXI9IjEuMjVzIiB2YWx1ZXM9IjE4Ljg0OTU1NTkyMTUzODc2IDE2OS42NDYwMDMyOTM4NDg4Mjs3NS4zOTgyMjM2ODYxNTUwMyAxMTMuMDk3MzM1NTI5MjMyNTQ7MTguODQ5NTU1OTIxNTM4NzYgMTY5LjY0NjAwMzI5Mzg0ODgyIiBrZXlUaW1lcz0iMDswLjU7MSIvPjwvY2lyY2xlPjwvc3ZnPg=="});var n=6.28*55*t;return g().createElement("svg",{width:"14px",height:"14px",version:"1.1",viewBox:"0 0 120 120",preserveAspectRatio:"none"},g().createElement("circle",{cx:"140",cy:"60",r:"52",fill:"none",stroke:"#D4D5D9",strokeWidth:"14",strokeDasharray:"360,20000",transform:"rotate(-90,100,100)"}),g().createElement("circle",{cx:"140",cy:"60",r:"52",fill:"none",stroke:"#0082EF",strokeWidth:"14",strokeDasharray:n+",20000",transform:"rotate(-90,100,100)",strokeLinecap:"round"}))},C=function(e,t){void 0===e&&(e=0),w().render(g().createElement(y,{progress:e}),t)},b=function(e,t,n,o){return new(n||(n=Promise))((function(i,s){function r(e){try{c(o.next(e))}catch(t){s(t)}}function a(e){try{c(o.throw(e))}catch(t){s(t)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(r,a)}c((o=o.apply(e,t||[])).next())}))},x=function(){function e(e){var t=this;this.translateX=0,this.translateY=0,this._eventDisposes=[],this.show=function(){return b(t,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.initPosition(),Object.assign(this.progressView.style,{position:"absolute",backgroundColor:"white",zIndex:1,display:"flex",alignItems:"center",overflow:"hidden",fontSize:"13px",pointerEvents:"none",borderWidth:"0px",boxShadow:"0 0 0 1px #E2E4E8",boxSizing:"border-box"}),this.visibile=!0,this.valid=!0,this.container.appendChild(this.progressView);case 5:case"end":return e.stop()}}),e,this)})))},this.updateProgress=function(e){C(e,t.iconSpan)},this.hide=function(){t.visibile=!1,t.container.contains(t.progressView)&&t.container.removeChild(t.progressView),t.handleEvent(!1)},this.cancelUpload=function(){t.valid=!1,t.hide()},this.getPositionInfo=function(){return{sheetId:t.sheetId,row:t.row,col:t.col}},this.setVisible=function(){t.visibile=!0,t.progressView.style.display="flex"},this.setHidden=function(){t.visibile=!1,t.progressView.style.display="none"},this.handleUpdateCells=function(e){var n=e.startRow,o=e.endRow,i=e.startCol,s=e.endCol;t.row>=n&&t.row<=o&&t.col>=i&&t.col<=s&&t.onRemove(t.id)},this.handleChange=function(e){return function(n){var o=n.sheetId,i=n.index,s=n.amount,r=n.type;if(o===t.sheetId){var a=r===m.DIMENSION_TYPE.ROWS?"row":"col";e&&new Array(s).fill(i).map((function(e,t){return e+t})).includes(t[a])?t.onRemove(t.id):(e&&i+s-1>t[a]&&(t[a]=Math.max(0,t[a]-s)),!e&&i+s-1<=t[a]&&(t[a]=t[a]+s),t.initPosition())}}},this.toggleVisible=function(e){if(e===t.sheetId)return t.setVisible();t.setHidden()},this.handleEvent=function(e){var n=t._eventDisposes;if(!e)return n.forEach((function(e){e.dispose()})),t._eventDisposes=[],void t.app.event.sheetsBar.remove("switchSheet",t.toggleVisible);var o=t.app.view.canvas,i=o.areaData,s=o.resize,r=o.scale,a=o.dataCallView;n.push(i.onUpdateOffset(t.updatePosition)),n.push(s.onResize(t.initPosition)),n.push(r.onScale(t.initPosition)),n.push(a.onSetRowHeight(t.initPosition)),n.push(a.onSetRowVisible(t.initPosition)),n.push(a.onSetColWidth(t.initPosition)),n.push(a.onSetColVisible(t.initPosition)),n.push(a.onMergeUnmerge(t.initPosition)),n.push(a.onUpdateChart(t.initPosition)),n.push(a.onUpdateFreeze(t.initPosition)),n.push(a.onUpdateCells(t.handleUpdateCells)),n.push(a.onDeleteRow(t.handleChange(!0))),n.push(a.onDeleteCol(t.handleChange(!0))),n.push(a.onInsertRow(t.handleChange(!1))),n.push(a.onInsertCol(t.handleChange(!1))),t.app.event.sheetsBar.listen("switchSheet",t.toggleVisible)},this.initDOM=function(){t.iconSpan=document.createElement("span"),t.iconSpan.style.margin="0 4px",t.iconSpan.style.width="14px",t.iconSpan.style.height="14px",t.progressView.appendChild(t.iconSpan),C(0,t.iconSpan),t.textSpan=document.createElement("span"),t.textSpan.style.color="#3677FD",t.textSpan.style.textDecoration="underline",t.textSpan.style.textDecorationColor="#3677FD",t.textSpan.style.whiteSpace="nowrap",t.textSpan.style.textOverflow="ellipsis",t.textSpan.style.overflow="hidden",t.progressView.appendChild(t.textSpan),t.textSpan.textContent=t.text},this.initPosition=function(){var e=t.app.view.canvas,n=e.tableView,o=e.areaData,i=e.headSize,s=e.rowcolAccessor,r=e.clientRect,a=n.getCellViewAtPosition(t.row,t.col),c=t.col,l=t.row,d=(0,h.E)(s,a,t.row),u=(0,h.o)(s,a,t.col),p=o.getDisplayViewTopByRow(l);(null===a||void 0===a?void 0:a.mergeData)&&(l+=a.mergeData.rowCount-1);var m=o.getDisplayViewBottomByRow(l),f=r.height-i.displayColHeadHeight;t.progressView.style.bottom=f-p+"px",t.progressView.style.top=m-d+"px";var g=o.getDisplayViewLeftByCol(c);t.progressView.style.left=g+"px",t.progressView.style.width=u-1+"px",t.progressView.style.height=d-1+"px",t.progressView.style.backgroundSize=Math.min(u,40)+"px "+Math.min(d,40)+"px",t.translateX=o.getDisplayViewLeftByCol(c),t.translateY=o.getDisplayViewTopByRow(l)},this.updatePosition=function(){var e=t.app.view.canvas,n=e.tableView,o=e.areaData,i=n.getCellViewAtPosition(t.row,t.col),s=t.col,r=t.row;(null===i||void 0===i?void 0:i.mergeData)&&(r+=i.mergeData.rowCount-1);var a=o.getDisplayViewLeftByCol(s),c=o.getDisplayViewTopByRow(r);t.progressView.style.transform="translate("+(a-t.translateX)+"px, "+(c-t.translateY)+"px)"},this.id=e.id,this.app=e.app,this.container=e.app.view.canvas.mainBoard.element,this.row=e.row,this.col=e.col,this.sheetId=e.sheetId,this.visibile=!1,this.progressView=document.createElement("div"),this.text=e.text,this.onRemove=e.onRemove,this.initDOM(),this.handleEvent(!0)}return e.prototype.getProgressView=function(){return this.progressView},(0,p.Z)(e,[{key:"isVisible",get:function(){return this.visibile}},{key:"isValid",get:function(){return this.valid}}]),e}(),_=function(){function e(){}return e.createInstance=function(t,n,o,i,s,r,a){if(null===n.view.getSelection())return null;var c=new x({id:t,app:n,row:o,col:i,sheetId:s,text:r,onRemove:a});return e.value[t]=c},e.getInstance=function(t){return e.value[t]},e.removeInstance=function(t){var n;Object.keys(e.value).includes(t)&&(null===(n=e.value[t])||void 0===n||n.cancelUpload(),e.value[t]=void 0)},e.keys=function(){return Object.keys(e.value)},e}();_.value={};var S=_,E={dialog:s,alert:r,modal:o,toast:d,tooltip:u,progress:i}},"../spread-sheet/src/core/ui/tooltip/index.ts":function(e,t,n){n.r(t),n.d(t,{changeTooltipText:function(){return d},default:function(){return p},hideTooltip:function(){return l},horizontalTooltip:function(){return u},showTooltip:function(){return c},toolTip:function(){return a}});var o=n("../spread-sheet/src/core/ui/lazyLoad.ts"),i=n("../node_modules/@tencent/docs-user-agent/dist/index.js"),s=n.n(i),r=n("../spread-sheet/src/base/event/event.ts"),a=function(e,t){(0,o.gB)().then((function(n){n.tooltip(e,t)}))},c=function(e,t){(0,o.gB)().then((function(n){n.tooltip(e,t)}))},l=function(){(0,o.gB)().then((function(e){e.hideTooltip()}))},d=function(e){(0,o.gB)().then((function(t){t.changeTooltipText(e)}))},u=function(e,t,n){(0,o.gB)().then((function(o){o.horizontalTooltip(e,t,n)}))};function p(){r.ZP.windowEvent.listen("resize",(function(){$("#tooltip").remove()})),r.ZP.windowEvent.listen("keydown",(function(){$("#tooltip").remove()})),s().isMobilePhone||s().isAndroidPad||!window.SpreadsheetApp.sheetStatus.canEdit||a("#toolbar [data-tooltip]")}},"../spread-sheet/src/core/utils/config.ts":function(e,t,n){n.d(t,{q:function(){return i}});var o=n("../spread-sheet/src/core/data/configService/spreadConfig.ts");function i(){return-1!==["local","new"].indexOf(o.q.getConfig("padStatus"))}},"../spread-sheet/src/core/utils/gray.ts":function(e,t,n){n.d(t,{c:function(){return s},i:function(){return r}});var o=n("../node_modules/@tencent/docs-multi-tools/dist/index.js"),i=n("../spread-sheet/src/core/data/configService/spreadConfig.ts");function s(){var e=i.q.getConfig("isGrayed");return"ww"===(0,o.getLoginType)()&&e}function r(){return!1}n("../spread-sheet/src/base/util/domain-config.ts")},"../spread-sheet/src/core/utils/url.ts":function(e,t,n){function o(e,t){return t?(e.indexOf("?")>=0?e+="&"+t:e+="?"+t,e):e}n.d(t,{_:function(){return o}})},"../spread-sheet/src/core/view/level-2/condition-format-center/data/custom-formula/condition-number-rules.ts":function(e,t,n){n.d(t,{Ab:function(){return a},nW:function(){return r},p3:function(){return l}}),n("../node_modules/core-js/modules/web.dom-collections.for-each.js"),n("../node_modules/core-js/modules/es.array.map.js");var o=n("../packages/model/src/index.ts"),i=n("../packages/model/src/utils/numberFormat/FormatParseEngine.ts"),s=o.Rule.CONDITION_TYPE,r={acceptRef:!0,min:4};function a(e,t,n){for(var o=[],i=arguments.length,s=new Array(i>3?i-3:0),r=3;r<i;r++)s[r-3]=arguments[r];s.forEach((function(e){o.push(e.toArray())}));var a=l(t),d=l(n),u=o.map((function(t){return t.map((function(t){return c(e,t,a,d)}))}));return u}function c(e,t,n,o){if(null===t)return e===s.NUMBER_NOT_EQ||e===s.NUMBER_NOT_BETWEEN;var i=l(t);switch(e){case s.NUMBER_GREATER:return i>n;case s.NUMBER_GREATER_THAN_EQ:return i>=n;case s.NUMBER_LESS:return i<n;case s.NUMBER_LESS_THAN_EQ:return i<=n;case s.NUMBER_EQ:return i===n;case s.NUMBER_NOT_EQ:return i!==n;case s.NUMBER_BETWEEN:return i>=n&&i<=o;case s.NUMBER_NOT_BETWEEN:return i<n||i>o}return!1}function l(e){var t;if("number"===typeof e)return e;var n=(null===(t=(0,i.parseValue)(e,null))||void 0===t?void 0:t.numericValue)||e;return"string"!==typeof n||isNaN(parseFloat(n))?n:parseFloat(n)}},"../spread-sheet/src/core/view/level-2/search-replace2/interface.ts":function(e,t,n){var o,i;n.d(t,{H:function(){return i},S:function(){return o}}),function(e){e[e.CASE_DIFF=0]="CASE_DIFF",e[e.ONLY_FORMULA=1]="ONLY_FORMULA",e[e.SEARCH_IN_COL=2]="SEARCH_IN_COL",e[e.ALL_MATCH=3]="ALL_MATCH"}(o||(o={})),function(e){e.InSheet="insheet",e.AllSheet="allsheet",e.Range="range"}(i||(i={}))},"../spread-sheet/src/core/view/level-2/search-replace2/panel/pc/search-replace-modal.tsx":function(e,t,n){n.d(t,{N:function(){return o},Z:function(){return _}}),n("../node_modules/core-js/modules/es.object.assign.js");var o,i=n("../node_modules/i18next/dist/esm/i18next.js"),s=n("react"),r=n.n(s),a=n("../node_modules/@babel/runtime/helpers/esm/inheritsLoose.js"),c=n("../node_modules/@tencent/dui/lib/components/Input/index.js"),l=n("../node_modules/@tencent/docs-user-agent/dist/index.js"),d=n.n(l),u=n("../node_modules/lodash/debounce.js"),p=n.n(u),h=function(e){function t(t){var n;return(n=e.call(this,t)||this).clickPrev=function(){n.props.handlePrev()},n.clickNext=function(){if(n.props.handleNext(),d().isSafari){var e=document.querySelector(".search-button-wrap .next-button");e&&document.activeElement!==e&&e.focus()}},n.onChange=function(e,t){n.isInputUpdate=!0,n.setState({searchText:e});var o=null===t||void 0===t?void 0:t.nativeEvent;p()((function(t){(null===t||void 0===t?void 0:t.isComposing)||n.props.handleChangeSearch(e)}),200)(o)},n.onCompositionEnd=function(e){var t,o;if(d().isFirefox){var i=null===(o=null===(t=null===e||void 0===e?void 0:e.nativeEvent)||void 0===t?void 0:t.target)||void 0===o?void 0:o.value;i=i||n.state.searchText,n.onChange(i,e)}else n.onChange(n.state.searchText,e)},n.onInputKeyDown=function(e){if(13===(null===e||void 0===e?void 0:e.keyCode)){if(null===e||void 0===e?void 0:e.shiftKey)return void n.props.handlePrev();n.props.handleNext()}},n.state={searchText:n.props.searchCache},n.searchInputRef=r().createRef(),n}(0,a.Z)(t,e);var n=t.prototype;return n.componentDidMount=function(){var e;null===(e=this.searchInputRef.current)||void 0===e||e.focus()},n.componentDidUpdate=function(e){var t;e.keyboardOpen&&!this.isInputUpdate&&(null===(t=this.searchInputRef.current)||void 0===t||t.focus()),this.isInputUpdate=!1},n.render=function(){var e="";0!==this.props.total?e=this.props.current+1+"/"+this.props.total:""!==this.props.searchCache&&(e=i.ZP.t("无结果"));var t=this.props.total?{}:{display:"none"},n=this.props.isLoading?r().createElement("div",{className:"search-count-info"},r().createElement("div",{className:"search-icon loading"})):r().createElement("div",{className:"search-count-info"},r().createElement("div",{className:"search-icon prevbtn",onClick:this.clickPrev,style:t}),r().createElement("div",{className:"search-count-info-content"},e),r().createElement("div",{className:"search-icon nextbtn",onClick:this.clickNext,style:t})),o=this.props.isRegionSearch?i.ZP.t("在范围 {{value}} 中查找",{value:this.props.region}):i.ZP.t("输入查找内容");return r().createElement("div",{className:"search-replace-content-wrap"},r().createElement(c.default,{inputRef:this.searchInputRef,placeholder:o,id:"search-input",className:"search-input",value:this.state.searchText,onChange:this.onChange,onCompositionEnd:this.onCompositionEnd,onMouseDown:function(e){return e.stopPropagation()},icon:n,autoComplete:"off",onKeyDown:this.onInputKeyDown}),r().createElement("div",{className:"search-message-wrap",style:this.props.message?{}:{display:"none"}},r().createElement("div",{className:"search-replace-message"},this.props.message)),r().createElement("div",{className:"search-advance-switch-wrap"},r().createElement("div",{className:"expand-info",onClick:this.props.handleChooseAdvancedContent},i.ZP.t("替换 / 高级查找"),r().createElement("span",{className:"expand-icon"}))))},t}(r().Component),m=(n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.regexp.to-string.js"),n("../node_modules/@tencent/dui/lib/components/Button/index.js")),f=n("../spread-sheet/src/core/view/level-2/search-replace2/interface.ts"),g=n("../node_modules/@tencent/dui/lib/components/Checkbox/index.js"),v=n("../node_modules/@tencent/dui/lib/components/Select/index.js"),w=n("../spread-sheet/src/core/view/level-2/condition-format-center/ui/utils/dataUtils.ts"),y=n("../spread-sheet/src/external/view/main/panel/dataValidationPanel/style/assets.ts"),C=function(e){function t(t){var n,o;return(n=e.call(this,t)||this).clickPrev=function(){n.props.handlePrev()},n.clickNext=function(){if(n.props.handleNext(),d().isSafari){var e=document.querySelector(".search-button-wrap .next-button");e&&document.activeElement!==e&&e.focus()}},n.onSearchChange=function(e){n.isInputUpdate=!0,n.setState({searchText:e,keyboardOpen:!1}),n.props.handleChangeSearch(e,!1)},n.onReplaceChange=function(e){n.isInputUpdate=!0,n.setState({replaceText:e,keyboardOpen:!1})},n.handleSearch=function(){n.props.handleChangeSearch(n.state.searchText)},n.handleReplaceSingle=function(){n.props.handleReplace(n.state.searchText,n.state.replaceText)},n.handleReplaceAll=function(){n.props.handleReplaceAll(n.state.searchText,n.state.replaceText)},n.onCheckBoxClick=function(e,t){var o,i,s,r,a,c,l,d;if(t.target){var u=t.target["attr-type"];switch(u){case f.S.ALL_MATCH:n.setState({isMatchAll:e}),null===(i=(o=n.props).handleCheckBoxChange)||void 0===i||i.call(o,{caseIgnore:n.state.isCaseIgnore,onlyFormula:n.state.onlyFormula,searchInCol:n.state.searchInCol,allMatch:e},u);break;case f.S.CASE_DIFF:n.setState({isCaseIgnore:e}),null===(r=(s=n.props).handleCheckBoxChange)||void 0===r||r.call(s,{caseIgnore:e,onlyFormula:n.state.onlyFormula,searchInCol:n.state.searchInCol,allMatch:n.state.isMatchAll},u);break;case f.S.ONLY_FORMULA:n.setState({onlyFormula:e}),null===(c=(a=n.props).handleCheckBoxChange)||void 0===c||c.call(a,{caseIgnore:n.state.isCaseIgnore,onlyFormula:e,searchInCol:n.state.searchInCol,allMatch:n.state.isMatchAll},u);break;case f.S.SEARCH_IN_COL:n.setState({searchInCol:e}),null===(d=(l=n.props).handleCheckBoxChange)||void 0===d||d.call(l,{caseIgnore:n.state.isCaseIgnore,onlyFormula:n.state.onlyFormula,searchInCol:e,allMatch:n.state.isMatchAll},u)}}},n.handleChangeSearchRegion=function(e){e!==n.state.rtype&&(n.setState({rtype:e,ranges:""}),n.props.handleRegionTypeChange(e))},n.rangeInputChange=function(e){(0,w.V4)("rule_panel_type_area"),-1!==e.indexOf(",")&&(0,w.V4)("rule_panel_type_nonadjacent_area")},n.handleEnterSelectionPanel=function(){n.props.handleRangeSelect((function(e){n.setState({ranges:e})}))},n.onInputKeyDown=function(e){if(13===(null===e||void 0===e?void 0:e.keyCode)){if(null===e||void 0===e?void 0:e.shiftKey)return void n.props.handlePrev();n.props.handleNext()}},n.state={searchText:n.props.searchCache,replaceText:"",rtype:n.props.isRegionSearch?f.H.Range:f.H.InSheet,ranges:(null===(o=n.props.region)||void 0===o?void 0:o.toString())||"",isCaseIgnore:!1,onlyFormula:!1,isMatchAll:!1,searchInCol:!1},n.searchInputRef=r().createRef(),n.replaceInputRef=r().createRef(),n}(0,a.Z)(t,e);var n=t.prototype;return n.componentDidMount=function(){var e;null===(e=this.searchInputRef.current)||void 0===e||e.focus()},n.componentDidUpdate=function(e){var t;e.keyboardOpen&&!this.isInputUpdate&&(null===(t=this.searchInputRef.current)||void 0===t||t.focus()),this.isInputUpdate=!1},n.render=function(){var e="";0!==this.props.total?e=this.props.current+1+"/"+this.props.total:""!==this.props.searchCache&&(e=i.ZP.t("无结果"));var t=this.props.total?{}:{display:"none"},n=this.props.isLoading?r().createElement("div",{className:"search-count-info"},r().createElement("div",{className:"search-icon loading"})):r().createElement("div",{className:"search-count-info"},r().createElement("div",{className:"search-icon prevbtn",onClick:this.clickPrev,style:t}),r().createElement("div",{className:"search-count-info-content"},e),r().createElement("div",{className:"search-icon nextbtn",onClick:this.clickNext,style:t})),o=this.state.rtype===f.H.Range?i.ZP.t("在范围 {{value}} 中查找",{value:this.state.ranges}):i.ZP.t("输入查找内容"),s=0===this.props.total||!this.props.canSearch;return r().createElement("div",{className:"search-replace-content-wrap"},r().createElement(c.default,{inputRef:this.searchInputRef,placeholder:o,id:"search-input",className:"search-input",value:this.state.searchText,onChange:this.onSearchChange,onMouseDown:function(e){return e.stopPropagation()},icon:n,autoComplete:"off",onKeyDown:this.onInputKeyDown}),!this.props.hideReplace&&r().createElement(r().Fragment,null,r().createElement("div",{className:"text-wrap"},i.ZP.t("替换为")),r().createElement(c.default,{onMouseUp:function(e){return e.stopPropagation()},inputRef:this.replaceInputRef,placeholder:i.ZP.t("输入替换内容"),id:"replace-input",className:"replace-input",onChange:this.onReplaceChange,value:this.state.replaceText,autoComplete:"off"})),this.props.showRegionTypeSelect&&this.renderReginSelect(),this.renderCheckboxGroup(),r().createElement("div",{className:"search-button-wrap"},r().createElement(m.default,{type:"primary",onClick:this.handleSearch,disabled:!this.props.canSearch},i.ZP.t("查找")),!this.props.hideReplace&&r().createElement("div",null,r().createElement(m.default,{onClick:this.handleReplaceSingle,disabled:!this.props.canSingleReplace||s},i.ZP.t("替换")),r().createElement(m.default,{style:{marginLeft:16,padding:"0 15px"},onClick:this.handleReplaceAll,disabled:!this.props.canReplaceAll||s},i.ZP.t("全部替换")))),r().createElement("div",{className:"search-message-wrap",style:this.props.message?{}:{display:"none"}},r().createElement("div",{className:"search-replace-message"},this.props.message)))},n.renderCheckboxGroup=function(){var e=Object.assign({showCaseIgnore:!1,showSearchInCol:!1,showOnlyFormula:!1,showMatchAll:!1},this.props.showCheckBoxType),t=e.showCaseIgnore,n=e.showSearchInCol,o=e.showOnlyFormula,s=e.showMatchAll;return r().createElement("div",{className:"search-checkbox-group-wrap"},t&&r().createElement(g.default,{className:"search-condition","attr-type":f.S.CASE_DIFF,onChange:this.onCheckBoxClick,disabled:this.props.isLoading,checked:this.state.isCaseIgnore},i.ZP.t("区分大小写")),n&&r().createElement(g.default,{className:"search-condition","attr-type":f.S.SEARCH_IN_COL,onChange:this.onCheckBoxClick,disabled:this.props.isLoading,checked:this.state.searchInCol},i.ZP.t("按列查找")),o&&r().createElement(g.default,{className:"search-condition","attr-type":f.S.ONLY_FORMULA,onChange:this.onCheckBoxClick,disabled:this.props.isLoading,checked:this.state.onlyFormula},i.ZP.t("仅在公式中查找")),s&&r().createElement(g.default,{className:"search-condition","attr-type":f.S.ALL_MATCH,onChange:this.onCheckBoxClick,disabled:this.props.isLoading,checked:this.state.isMatchAll},i.ZP.t("完全匹配单元格内容")))},n.renderReginSelect=function(){var e=this.state.rtype===f.H.Range,t=e?{width:"168px"}:{width:"352px"};return r().createElement("div",{className:"search-region-wrapper"},r().createElement(v.default,{className:"search-region-select",style:t,value:this.state.rtype,onChange:this.handleChangeSearchRegion,disabled:this.props.isLoading},r().createElement(v.default.Option,{value:f.H.InSheet},i.ZP.t("查找当前工作表")),r().createElement(v.default.Option,{value:f.H.AllSheet},i.ZP.t("查找全部工作表")),r().createElement(v.default.Option,{value:f.H.Range},i.ZP.t("查找指定范围"))),e&&r().createElement(c.default,{style:{width:"168px",marginLeft:"16px",display:"inline-block"},placeholder:i.ZP.t("在工作表中框选范围"),value:this.state.ranges,inputMode:"none",inputRef:this.inputRangeRef,inputStyle:{height:"36px"},icon:y.Z,onClickIcon:this.handleEnterSelectionPanel}))},t}(r().Component),b=n("../node_modules/@tencent/dui/lib/components/Modal/index.js"),x=n("../spread-sheet/src/base/util/html.ts");!function(e){e[e.BASIC_SEARCH=0]="BASIC_SEARCH",e[e.ADVANCED_SEARCH=1]="ADVANCED_SEARCH"}(o||(o={}));var _=function(){function e(e){var t=this;this.close=function(){t.dialog&&(t.removeListener(),t.dialog.close(),t.dialog=null)},this.handleIpadKeyboardHide=function(){d().isIPad&&d().isTencentDocsApp&&window.scrollTo(0,0)},this.updateDependency=function(e){Object.assign(t.initDependency,e),t.initDependency.isKeyboardOpen=!!e.isKeyboardOpen},this.initDependency=e,this.searchContentRef=r().createRef()}var t=e.prototype;return t.renderTitle=function(){return r().createElement("div",{className:"search-replace-head-warp"},r().createElement("li",{className:"replace active"},this.initDependency.mode===o.BASIC_SEARCH?i.ZP.t("查找"):i.ZP.t("查找替换")))},t.renderContent=function(){return this.initDependency.mode===o.BASIC_SEARCH?(this.searchContentRef=r().createRef(),r().createElement(h,{ref:this.searchContentRef,handleNext:this.initDependency.handleNext,handleChangeSearch:this.initDependency.handleChangeSearch,handlePrev:this.initDependency.handlePrev,handleClose:this.initDependency.handleClose,handleChooseAdvancedContent:this.initDependency.handleChooseAdvancedContent,current:this.initDependency.current,total:this.initDependency.total,keyboardOpen:!!this.initDependency.isKeyboardOpen,searchCache:this.initDependency.searchCache||"",message:this.initDependency.message||"",isRegionSearch:this.initDependency.regionType===f.H.Range,region:this.initDependency.region,isLoading:this.initDependency.isLoading})):this.initDependency.mode===o.ADVANCED_SEARCH?(this.searchContentRef=r().createRef(),r().createElement(C,{ref:this.searchContentRef,handleNext:this.initDependency.handleNext,handleChangeSearch:this.initDependency.handleChangeSearch,handlePrev:this.initDependency.handlePrev,handleClose:this.initDependency.handleClose,handleReplace:this.initDependency.handleReplace,handleReplaceAll:this.initDependency.handleReplaceAll,handleRangeSelect:this.initDependency.handleRangeSelect,handleRegionTypeChange:this.initDependency.handleRegionTypeChange,handleCheckBoxChange:this.initDependency.handleCheckBoxChange,current:this.initDependency.current,total:this.initDependency.total,keyboardOpen:!!this.initDependency.isKeyboardOpen,searchCache:this.initDependency.searchCache||"",message:this.initDependency.message||"",isRegionSearch:this.initDependency.regionType===f.H.Range,region:this.initDependency.region,canReplaceAll:!!this.initDependency.canReplace,canSingleReplace:!!this.initDependency.canSingleReplace,canSearch:void 0===this.initDependency.canSearch||this.initDependency.canSearch,isLoading:this.initDependency.isLoading,showCheckBoxType:this.initDependency.showCheckBoxType,showRegionTypeSelect:this.initDependency.showRegionTypeSelect,hideReplace:this.initDependency.hideReplace})):void 0},t.show=function(t){if(this.updateDependency(t),!this.dialog)return this.createDialog(),void this.addListener();t.regionType&&this.initDependency.handleRegionTypeChange(t.regionType),this.dialog.update({title:this.renderTitle(),content:this.renderContent(),style:Object.assign(Object.assign({},this.initDependency.mode===o.BASIC_SEARCH?e.basicStyle:e.advancedStyle),{position:"absolute",paddingLeft:"0px",paddingRight:"0px"})})},t.update=function(t){this.updateDependency(t),t.regionType&&this.initDependency.handleRegionTypeChange(t.regionType),this.dialog&&this.dialog.update({title:this.renderTitle(),content:this.renderContent(),style:Object.assign(Object.assign({},this.initDependency.mode===o.BASIC_SEARCH?e.basicStyle:e.advancedStyle),{position:"absolute",paddingLeft:"0px",paddingRight:"0px",transition:"all 100ms ease-in-out",visibility:!1===this.initDependency.visible?"hidden":"visible"})})},t.createDialog=function(){this.dialog=b.default.confirm({className:"search-replace-dialog",destroyOnClose:!0,mask:!1,draggable:!0,style:Object.assign(Object.assign({},this.initDependency.mode===o.BASIC_SEARCH?e.basicStyle:e.advancedStyle),{position:"absolute",paddingLeft:"0px",paddingRight:"0px"}),title:this.renderTitle(),content:this.renderContent(),footer:null,onCancel:this.initDependency.handleClose,onClose:this.initDependency.handleClose})},t.addListener=function(){(0,x.vP)(document,"focusout",this.handleIpadKeyboardHide,!0)},t.removeListener=function(){(0,x.xC)(document,"focusout",this.handleIpadKeyboardHide,!0)},e}();_.basicStyle={minHeight:180,width:400,top:103,right:10},_.advancedStyle={minHeight:276,width:400,top:103,right:10}},"../spread-sheet/src/external/export/interface.ts":function(e,t,n){var o,i;n.d(t,{I:function(){return o},j:function(){return i}}),function(e){e.xlsx="xlsx",e.xlsxServer="xlsxServer",e.xlsxWithFiles="xlsxWithFiles",e.csv="csv"}(o||(o={})),function(e){e[e.LOOP_TIME_OUT=0]="LOOP_TIME_OUT",e[e.QUERY_ERROR_CATCH=1]="QUERY_ERROR_CATCH",e[e.QUERY_ERROR_UNEXPECT=2]="QUERY_ERROR_UNEXPECT",e[e.EXPORT_ERROR_CATCH=3]="EXPORT_ERROR_CATCH",e[e.EXPORT_ERROR_UNEXPECT=4]="EXPORT_ERROR_UNEXPECT"}(i||(i={}))},"../spread-sheet/src/external/feedback/supportpage.ts":function(e,t,n){n.d(t,{nz:function(){return v},vt:function(){return w}}),n("../node_modules/regenerator-runtime/runtime.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.promise.js"),n("../node_modules/core-js/modules/es.function.name.js"),n("../node_modules/core-js/modules/es.number.constructor.js"),n("../node_modules/core-js/modules/es.regexp.exec.js"),n("../node_modules/core-js/modules/es.string.replace.js");var o=n("../spread-sheet/src/core/data/configService/spreadConfig.ts"),i=n("../node_modules/@tencent/docs-multi-tools/dist/index.js"),s=n("../node_modules/@tencent/docs-user-agent/dist/index.js"),r=n.n(s),a=n("../spread-sheet/src/core/utils/url.ts"),c=n("../node_modules/@tencent/tencent_doc_open_url/dist/index.js"),l=n("../node_modules/qs/lib/index.js"),d=n.n(l),u=n("../spread-sheet/src/core/feature/relateFormEnt/enterpriseStatus.ts"),p=n("../packages/common-utils/src/index.ts"),h=n("./node_modules/axios/index.js"),m=n.n(h),f=(n("../spread-sheet/src/base/util/domain-config.ts"),n("../spread-sheet/src/base/util/appConfig.ts")),g=function(e,t,n,o){return new(n||(n=Promise))((function(i,s){function r(e){try{c(o.next(e))}catch(t){s(t)}}function a(e){try{c(o.throw(e))}catch(t){s(t)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(r,a)}c((o=o.apply(e,t||[])).next())}))};function v(){var e,t,s=Number(new Date),l=s-18e5,u=null===(t=null===(e=n.g.log)||void 0===e?void 0:e.report)||void 0===t?void 0:t.call(e,"TUCAO_EXCEL",{query:{startTs:l,endTs:s}}),p=o.q.getConfig("userName"),h=o.q.getConfig("userPic"),m=o.q.getConfig("uid")||"";m?"p"===m.charAt(0)&&(m=m.replace(/p./,"")):m=o.q.getConfig("uin");var g=n.g.location.href;try{g=encodeURIComponent(JSON.stringify({type:"excel",url:n.g.location.href,uid:(0,i.getUid)(),rid:u}))}catch(v){console.warn(v)}!function(e){var t=f.Z.getConfig("links.feedback");if(o.q.getConfig("isLogin"))if(r().isMiniProgram&&!r().isPC){var i=d().stringify({openid:e.openid,nickname:e.nickname,avatar:e.avatar,customInfo:e.customInfo,clientInfo:e.clientInfo}),s=(0,a._)(t,i);n.g.location.href=s}else{var l=document.createElement("form");for(var u in l.id="form",l.name="form",l.style.display="none",r().isMiniProgram&&r().isPC?l.setAttribute("target","_self"):l.setAttribute("target","_blank"),document.body.appendChild(l),e)if(Object.hasOwnProperty.call(e,u)){var p=document.createElement("input");p.type="text",p.name=u,p.value=e[u],l.appendChild(p)}l.method="POST",l.action=t,l.submit(),document.body.removeChild(l)}else{var h=d().stringify({customInfo:encodeURIComponent(n.g.location.href),clientInfo:n.g.navigator.userAgent}),m=(0,a._)(t,h);(0,c.tencentDocOpenUrlForAll)({url:m})}}({openid:m,nickname:p,avatar:h,customInfo:g,clientInfo:n.g.navigator.userAgent})}function w(){var e,t,i,s,a;return g(this,void 0,void 0,regeneratorRuntime.mark((function l(){var d,h,f,g,v,w;return regeneratorRuntime.wrap((function(l){for(;;)switch(l.prev=l.next){case 0:return d=o.q.getConfig("padId"),h=(0,p.IZ)("scode"),(f=new FormData).append("docid",d),f.append("share_code",h),f.append("scence","wedoc"),f.append("svr_type","report"),l.prev=7,l.next=10,m().post("/doc/feedback_to_ww",f);case 10:if(g=l.sent,v=g.data,0===(null===(e=v.head)||void 0===e?void 0:e.ret)){l.next=14;break}throw new Error("request /doc/feedback_to_ww fail, params: docid:"+d+", share_code:"+h);case 14:if(w=null===v||void 0===v?void 0:v.body.return_url){l.next=18;break}throw null===(t=window.tdocs)||void 0===t||t.log({message:"[CGI FAILED]: no url provided, params: docid:"+d+", share_code:"+h,level:"error"}),new Error("request /doc/feedback_to_ww fail, no url provided");case 18:(0,u.n_)()?r().isMobile?null===(s=null===(i=n.g.tdocs)||void 0===i?void 0:i.openUrl)||void 0===s||s.call(i,{url:w,target:3}):null===(a=n.g.tdocs)||void 0===a||a.openInBrowser({url:w}):(0,c.tencentDocOpenUrlForAll)({url:w}),l.next=24;break;case 21:l.prev=21,l.t0=l.catch(7),console.error(l.t0);case 24:case"end":return l.stop()}}),l,null,[[7,21]])})))}},"../spread-sheet/src/external/view/mobile/header/auth.ts":function(e,t,n){n.d(t,{Z:function(){return D}}),n("../node_modules/regenerator-runtime/runtime.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.promise.js"),n("../node_modules/core-js/modules/es.object.assign.js"),n("../node_modules/core-js/modules/es.regexp.exec.js"),n("../node_modules/core-js/modules/es.string.split.js");var o,i,s=n("../node_modules/i18next/dist/esm/i18next.js"),r=n("../spread-sheet/src/base/index.ts"),a=n("../spread-sheet/src/core/data/configService/spreadConfig.ts"),c=n("../node_modules/@tencent/docs-user-agent/dist/index.js"),l=n.n(c),d=n("../packages/utils/src/safe.ts"),u=n("../packages/common-utils/src/index.ts"),p=n("../packages/report/src/index.ts"),h=n("../spread-sheet/src/external/view/common/rangeAuthApiForFeatureComponent/index.ts"),m=(n("../node_modules/core-js/modules/es.number.constructor.js"),n("../spread-sheet/src/base/event/event.ts")),f=n("../node_modules/@babel/runtime/helpers/esm/assertThisInitialized.js"),g=n("../node_modules/@babel/runtime/helpers/esm/inheritsLoose.js"),v=n("react"),w=n.n(v),y=function(e){function t(){return e.apply(this,arguments)||this}return(0,g.Z)(t,e),t}(w().Component),C=y,b=n("react-dom"),x=n.n(b),_=n("../node_modules/classnames/index.js"),S=n.n(_);!function(e){e.NORMAL="normal",e.HOVER="hover",e.CLICK="click"}(o||(o={})),function(e){e.LEFT="left",e.RIGHT="right"}(i||(i={}));var E=function(e){function t(t){var n;return(n=e.call(this,t)||this).getCorner=function(e){var t;return w().createElement("div",{className:S()((t={"docx-icon-common":!0},t["banner-"+e+"-corner"]=!0,t["banner-mo-"+e+"-corner-pos"]=!0,t))})},n.getCommonBannerThirdChild=function(e){var t=e.clickCb,i=n.state.closeBtnState;return w().createElement("div",{className:S()({"docx-icon-common":!0,"banner-mo-close-btn":!0,"close-normal_20dp":i===o.NORMAL,"close-hover_20dp":i===o.HOVER,"close-click_20dp":i===o.CLICK}),onClick:function(){return n.handleBannerClick(!1,t)},onMouseDown:function(){return n.dealWithStatusClass("closeBtnState",o.CLICK)},onMouseUp:function(){return n.dealWithStatusClass("closeBtnState",o.HOVER)},onMouseEnter:function(){return n.dealWithStatusClass("closeBtnState",o.HOVER)},onMouseLeave:function(){return n.dealWithStatusClass("closeBtnState",o.NORMAL)}})},n.getCommonBannerFourthChild=function(e){var t=e.clickCb,i=e.btnTitle,s=n.state.bannerBtnState;return w().createElement("div",{className:S()({"banner-mo-btn":!0,"header-function-btn-blue-normal":s===o.NORMAL,"header-function-btn-blue-hover":s===o.HOVER,"header-function-btn-blue-selected":s===o.CLICK}),onClick:function(){return n.handleBannerClick(!0,t)},onMouseDown:function(){return n.dealWithStatusClass("bannerBtnState",o.CLICK)},onMouseUp:function(){return n.dealWithStatusClass("bannerBtnState",o.HOVER)},onMouseEnter:function(){return n.dealWithStatusClass("bannerBtnState",o.HOVER)},onMouseLeave:function(){return n.dealWithStatusClass("bannerBtnState",o.NORMAL)}}," ",i," ")},n.state={isShow:t.visible,showProps:t,closeBtnState:o.NORMAL,bannerBtnState:o.NORMAL},n.handleBannerClick=n.handleBannerClick.bind((0,f.Z)(n)),n.dealWithStatusClass=n.dealWithStatusClass.bind((0,f.Z)(n)),n}(0,g.Z)(t,e);var n=t.prototype;return n.hide=function(){this.setState({isShow:!1})},n.showBottom=function(e){this.state.isShow||this.setState({isShow:!0,showProps:e})},n.render=function(){if(!this.state.isShow)return null;var e=this.getBanner(Object.assign({},this.state.showProps));return x().createPortal(e,document.body)},n.getBanner=function(e){var t=e.btnTitle,n=e.clickCb;return w().createElement("div",{id:"common-banner-mo",className:"common-banner-mo user-select-none"},this.getCorner(i.LEFT),this.getCorner(i.RIGHT),this.getCommonBannerThirdChild({clickCb:n}),t&&this.getCommonBannerFourthChild({clickCb:n,btnTitle:t}),this.getCenter(e))},n.dealWithStatusClass=function(e,t){var n;this.setState(((n={})[e]=t,n))},n.handleBannerClick=function(e,t){this.hide(),t&&t(e)},n.getCenter=function(e){var t=e.title,n=e.subTitle;return w().createElement("div",{className:"banner-mo-center"},this.getCenterChild1(),this.getCenterChild2({title:t,subTitle:n}))},n.getCenterChild1=function(){return w().createElement("div",{className:S()({"docx-icon-common":!0,"txdoc-logo_42dp":!0,"banner-mo-logo-pos":!0})})},n.getCenterChild2=function(e){var t=e.title,n=e.subTitle;return w().createElement("div",{className:"banner-mo-tip-container"},w().createElement("div",{className:"banner-mo-tip"},t),w().createElement("div",{className:"banner-mo-subtip"},n))},t}(C);E.showBottom=function(e){return function(e){var t=e.Component,n=e.props,o=document.createElement("div");document.body.appendChild(o);var i=function(e){var n=w().createElement(t,Object.assign({},e));x().render(n,o)},s=Object.assign(Object.assign({},n),{visible:!0});return i(s),{update:function(e){s=Object.assign(Object.assign(Object.assign({},s),e),{visible:!0}),i(s)},hide:function(){s=Object.assign(Object.assign({},s),{visible:!1}),i(s),x().unmountComponentAtNode(o)}}}({Component:E,props:e})};var I=E,R=n("../spread-sheet/src/base/util/appConfig.ts"),j=new(function(){function e(){this.times=0,this.timesNode=5,this.showTimesLimit=3,this.showTimes=0,this.lastShowTime=0,this.editKey="THE_FLAG_OF_MARKING_PCEDIT",this.lastTimeKey="THE_FLAG_OF_LAST_GUIDE_TIME",this.showTimesKey="THE_FLAG_OF_SHOW_GUIDE_TIMES",this.newlyCreatedKey="THE_FLAG_OF_NEWLY_CREATED"}var t=e.prototype;return t.init=function(){this.getLocalEdit()||this.getRemoteFlag()},t.getLocalEdit=function(){return!!localStorage.getItem(this.editKey)},t.markLocalEdited=function(){return localStorage.setItem(this.editKey,this.editKey),this},t.getLastShowTime=function(){return Number(localStorage.getItem(this.lastTimeKey))},t.markLastShowTime=function(e){localStorage.setItem(this.lastTimeKey,String(e)),this.lastShowTime=e},t.guideShowToday=function(){var e=864e5;return Math.floor(Date.now()/e)-Math.floor(this.lastShowTime/e)<=0},t.getShowTimes=function(){return localStorage.getItem(this.showTimesKey)},t.incShowTimes=function(e){return localStorage.setItem(this.showTimesKey,String(e+1)),this.showTimes+1},t.markNewlyCreated=function(e){localStorage.setItem(this.newlyCreatedKey,e)},t.getRemoteFlag=function(){var e=this;$.ajax({type:"post",url:"/cgi-bin/online_docs/user_flag",data:{type:32},success:function(t){var n=!t.retcode&&1===t.typeFlag;n?e.markLocalEdited():e.bindEvent()}})},t.setRemoteFlag=function(e){$.ajax({type:"post",url:"/cgi-bin/online_docs/user_flag/save",data:{type:32,flag:e}})},t.bindEvent=function(){var e=this;m.ZP.notificationCenter.listen("localChangeContent",(function(){l().isMobilePhone||l().isAndroidPad?e.times+=1:e.markLocalEdited().setRemoteFlag(1)})),(l().isMobilePhone||l().isAndroidPad)&&(m.ZP.notificationCenter.listen("enterNormalStatus",(function(){e.showGuide()})),m.ZP.notificationCenter.listen("enterInputStatus",(function(){e.showGuide()})),this.showTimes=Number(this.getShowTimes()),this.lastShowTime=this.getLastShowTime(),this.markNewlyCreated(""))},t.showGuide=function(){if(!(this.times<this.timesNode||this.showTimes>=this.showTimesLimit||this.guideShowToday())){var e=s.ZP.t("体验更多文档功能，编辑更方便。"),t=s.ZP.t('使用电脑访问 <span style="color:#0188FD;">{{value}}</span>',{value:R.Z.getConfig("runtime.domainName")});I.showBottom({title:t,subTitle:e}),this.markLastShowTime(Date.now()),(this.showTimes=this.incShowTimes(this.showTimes))>=this.showTimesLimit&&this.markLocalEdited()}},e}()),T=n("../spread-sheet/src/base/event/eventName.ts"),P=!1,N=function(e,t,n,o){return new(n||(n=Promise))((function(i,s){function r(e){try{c(o.next(e))}catch(t){s(t)}}function a(e){try{c(o.throw(e))}catch(t){s(t)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(r,a)}c((o=o.apply(e,t||[])).next())}))},k=n.g.$,A=n.g,D=new(function(){function e(){this.applicationUnreadNumberH5=0,this.applyAuthStatus={apply:!1},this.updatePermissionInfo=function(){A.SLR.load("CooperationMobileV2",(function(e){e.getPermissionInfo({creatorDomain:a.q.getConfig("creatorDomain"),padId:a.q.getConfig("padId"),success:function(e){var t=e.res.policy;a.q.setConfig({policy:t})},error:function(){}})}))}}var t=e.prototype;return t.init=function(){var e=this;A.padmobilecooperation=this,A.openCooperationMobile=function(){e.loadCooperationMobile(!0,!1)},A.openAdvPermissionsMobile=function(){e.loadCooperationMobile(!0,!0)},P||(P=!0,p.ZP.tdwReport({opername:"doc_open",module:"page",ver10:"detail",ver11:""})),this.cooperationContainer=document.createElement("div"),Object.assign(this.cooperationContainer.style,{position:"absolute",top:0,left:0,zIndex:10003}),document.body.appendChild(this.cooperationContainer),A.SpreadsheetApp&&!A.SpreadsheetApp.sheetStatus.canEdit&&this.checkIsApplyIn24H(),a.q.getConfig("isOwner")&&A.SLR.listen("TX-AUTH-UPDATED",this.updatePermissionInfo),k(A).on("notification_message",(function(t,n){1==(n=JSON.parse(n)).msgType&&(n.clearRedDot&&0!==n.clearRedDot?e.delUnreadNotificationNumber(n.clearRedDot):n.redDot&&e.addUnreadNotificationNumber(n.redDot)),A.SpreadsheetApp&&!A.SpreadsheetApp.sheetStatus.canEdit&&e.checkIsApplyIn24H()})),j.init()},t.checkHasRedpoint=function(){var e=this;k.ajax({url:"//"+R.Z.getConfig("runtime.domainName")+"/cgi-bin/online_docs/notify_getnum",xhrFields:{withCredentials:!0},data:{bkn:(0,d.G)()},success:function(t){t&&0===t.retcode&&(void 0!==t.unread_sum_count?e.setUnreadNotificationNumber(t.unread_sum_count):e.clearUnreadNotificationNumber())},error:function(){}})},t.checkIsApplyIn24H=function(){var e=this;k.ajax({url:"//"+R.Z.getConfig("runtime.domainName")+"/cgi-bin/online_docs/auth_apply/check",xhrFields:{withCredentials:!0},data:{bkn:(0,d.G)(),domainId:a.q.getConfig("domainId"),localPadId:a.q.getConfig("padId"),xsrf:(0,d.f)()},success:function(t){!t||10003!==t.retcode&&10004!==t.retcode?e.applyAuthStatus={apply:!1}:"0"==t.pass?e.applyAuthStatus={apply:!0,noPass:!0}:"1"==t.pass?e.applyAuthStatus={apply:!0,pass:!0}:e.applyAuthStatus={apply:10003!==t.retcode},e.applyAuthStatus},error:function(){this.applyAuthStatus={apply:!1}}})},t.getReadOnlyTip=function(){var e="",t="",n=this.applyAuthStatus,o=!1;return a.q.getConfig("isLogin")?!(null===n||void 0===n?void 0:n.apply)||n.noPass||n.pass?(null===n||void 0===n?void 0:n.apply)&&n.noPass?(e=s.ZP.t("权限申请未通过，“只能查看”文档。"),t=s.ZP.t("未通过")):(e=s.ZP.t("你只能查看此文档。要更改权限，\n请向文档创建者发起申请。"),t="",o=!0):(e=s.ZP.t("权限申请已提交，请等待创建者审核。"),t=s.ZP.t("已申请，审核中")):e=s.ZP.t("登录后获得更多操作权限"),{tip:e,shortTip:t,isNeedApplyAuth:o}},t.applyPermission=function(e){var t=this;void 0===e&&(e=!1),A.SLR.load("PermitApply",(function(n){n.permitApply(a.q.getConfig("docType"),null,(function(){t.applyAuthStatus={apply:!0}}),e)}))},t.getTitle=function(){return A.SpreadsheetApp?A.SpreadsheetApp.spreadsheet.getTitle():(console.warn("no spreadsheetapp instance!"),"")},t.openPermissionsInMiniProgram=function(){if(l().isMiniProgram){var e=a.q.getConfig("padId"),t=a.q.getConfig("docType"),n=a.q.getConfig("creatorDomain"),o=a.q.getConfig("domainId"),i=location.href.split(/[?#]/)[0];A.wx.miniProgram.navigateTo({url:(0,u.XK)("/pages/changedAuth/changed_auth",{padId:e,domainId:o,padType:t,creatorDomain:n,url:i,title:this.getTitle(),uid:a.q.getConfig("uin")})})}else console.error("call openAdvPermissionsInMiniProgram no miniprogram")},t.openAdvPermissionsInMiniProgram=function(){if(l().isMiniProgram){var e=a.q.getConfig("padId"),t=a.q.getConfig("docType"),n=a.q.getConfig("creatorDomain"),o=a.q.getConfig("domainId");A.wx.miniProgram.navigateTo({url:(0,u.XK)("/pages/changedAdvAuth/changed_adv_auth",{padId:e,domainId:o,padType:t,creatorDomain:n,uid:a.q.getConfig("uin")})})}else console.error("call openAdvPermissionsInMiniProgram no miniprogram")},t.editForTemplate=function(){12==a.q.getConfig("docStatus")&&(a.q.setConfig({docStatus:0}),k.ajax({type:"post",url:"/cgi-bin/online_docs/doc_humtrans",data:{domain_id:a.q.getConfig("domainId"),pad_id:a.q.getConfig("padId")},success:function(){var e;null===(e=A.SLR)||void 0===e||e.dispatch("DOC_HUMTRANS_DONE")},error:function(){}}))},t.loadCooperationMobile=function(e,t){var o=this;void 0===e&&(e=!1),void 0===t&&(t=!1),l().isMiniProgram?(this.editForTemplate(),this.openPermissionsInMiniProgram()):(p.ZP.tdwReport({opername:"doc_access",module:"page",action:"clk_btn"}),(0,u.R5)(),A.SLR.load("CooperationMobileV2",(function(i){var s=a.q.getConfig("padId"),c=a.q.getConfig("docType"),l=a.q.getConfig("domainId"),d=a.q.getConfig("creatorDomain"),u=location.href.split(/[?#]/)[0];i.show(o.cooperationContainer,{padId:s,domainId:l,creatorDomain:d,shareLink:u,shareTitle:o.getTitle(),shareDocType:c,title:o.getTitle(),padType:c,owner:{avatar:a.q.getConfig("userPic"),name:a.q.getConfig("userName"),uid:a.q.getConfig("uin")},isCalledByMobileNativeSharePanel:e,onClose:function(e){return N(o,void 0,void 0,regeneratorRuntime.mark((function t(){var o,i;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e){t.next=6;break}return t.next=3,n.g.SpreadsheetApp.plugins.getShareController();case 3:null===(i=t.sent)||void 0===i||i.setShareInfo(),null===(o=A.mqq)||void 0===o||o.ui.showShareMenu();case 6:case"end":return t.stop()}}),t)})))},showAdvPermissionsCmp:t,onAuthExpTimeUpdated:function(e){var t;null===(t=n.g.SpreadsheetApp.advPermissions)||void 0===t||t.onUpdateAuthExpInfo(e)},onAuthUpdated:function(e){return N(o,void 0,void 0,regeneratorRuntime.mark((function t(){var o;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e){t.next=5;break}return t.next=3,n.g.SpreadsheetApp.plugins.getShareController();case 3:null===(o=t.sent)||void 0===o||o.setShareInfo();case 5:case"end":return t.stop()}}),t)})))},rangeAuthApi:h.Z}),r.Z.event.default.trigger(r.Z.EVENT_NAME.UI_SHOW,T.Xs.AUTH_M)})))},t.getUnreadNumber=function(){return this.applicationUnreadNumberH5},t.setHasGuideApply=function(){n.g.localStorage.setItem(this.getStorageKey(),"1")},t.getHasGuideApply=function(){return"1"===String(n.g.localStorage.getItem(this.getStorageKey()))},t.getStorageKey=function(){return"m-guide-apply-"+a.q.getConfig("uid")},t.clearUnreadNotificationNumber=function(){this.applicationUnreadNumberH5=0,this.setMoreRedPoint()},t.delUnreadNotificationNumber=function(e){void 0===e&&(e=0),this.applicationUnreadNumberH5-=e,this.applicationUnreadNumberH5=Math.max(0,this.applicationUnreadNumberH5),this.setMoreRedPoint()},t.addUnreadNotificationNumber=function(e){void 0===e&&(e=0),this.applicationUnreadNumberH5+=e,this.setMoreRedPoint()},t.setUnreadNotificationNumber=function(e){this.applicationUnreadNumberH5=0,this.addUnreadNotificationNumber(e),this.setMoreRedPoint()},t.setMoreRedPoint=function(){var e,t,n,o,i;null===(i=null===(o=null===(n=null===(t=null===(e=A.SpreadsheetApp)||void 0===e?void 0:e.view)||void 0===t?void 0:t.header)||void 0===n?void 0:n.component)||void 0===o?void 0:o.updateRedpoint)||void 0===i||i.call(o)},e}())},"../spread-sheet/src/external/view/mobile/header/helper.ts":function(e,t,n){n.d(t,{X:function(){return u}}),n("../node_modules/core-js/modules/es.regexp.exec.js"),n("../node_modules/core-js/modules/es.string.split.js");var o=n("../node_modules/i18next/dist/esm/i18next.js"),i=n("../spread-sheet/src/external/view/mobile/header/auth.ts"),s=n("../spread-sheet/src/core/ui/index.ts"),r=n("../packages/report/src/index.ts"),a=n("../node_modules/@tencent/docs-user-agent/dist/index.js"),c=n.n(a),l=n("../node_modules/@tencent/tencent_doc_open_url/dist/index.js"),d=n("../spread-sheet/src/base/util/appConfig.ts");function u(e,t,n){if(e)i.Z.loadCooperationMobile();else{var a=i.Z.applyAuthStatus,u=a.apply,p=a.pass,h=a.noPass;u?h?s.Z.toast.showToast(o.ZP.t("申请暂未通过，请在24小时后重试。"),{},{standardToastType:"default"}):p?i.Z.applyPermission(!1):function(e,t){var n=encodeURIComponent(window.location.href.split("#")[0]);if(c().isMiniProgram){var o="/pages/followEditGuide/followEditGuide?ownerNick="+e+"&requestPermitType="+t+"&url="+n;window.wx.miniProgram.navigateTo({url:o})}else{var i="https://"+d.Z.getConfig("runtime.domainName")+"/scenario/followGuide.html?nick="+e+"&requestPermitType="+t+"&url="+n;(0,l.tencentDocOpenUrlForAll)({replace:!0,url:i})}}(t,"edit"):i.Z.applyPermission(!1),r.ZP.tdwReport({opername:n.opername,module:n.module,action:n.action})}}},"../spread-sheet/src/external/view/mobile/header/menu/feature/help.ts":function(e,t,n){n.d(t,{Eu:function(){return m},Yo:function(){return h}});var o=n("../node_modules/i18next/dist/esm/i18next.js"),i=n("../node_modules/@tencent/tencent_doc_open_url/dist/index.js"),s=n("../packages/utils/src/safe.ts"),r=n("../node_modules/@tencent/docs-user-agent/dist/index.js"),a=n.n(r),c=n("../spread-sheet/src/core/ui/toast/index.ts"),l=n("../spread-sheet/src/base/util/url.ts"),d=n("../spread-sheet/src/base/util/appConfig.ts"),u=n.g,p=a().isIPad&&a().isTencentDocsApp;function h(e){var t,o;if(a().isMiniProgram){var s=(0,l.wE)(e)?"/pages/detail/detail":"/pages/webview/webview";null===(t=n.g.wx)||void 0===t||t.miniProgram.navigateTo({url:s+"?url="+encodeURIComponent(e)})}else!p&&u.mqq&&0!==u.mqq.QQVersion&&"0"!==u.mqq.QQVersion?null===(o=n.g.mqq)||void 0===o||o.ui.openUrl({url:e,target:1,style:1}):(0,i.tencentDocOpenUrlForAll)({url:e,replace:!1})}function m(e){$.ajax({url:"https://"+d.Z.getConfig("runtime.domainName")+"/cgi-bin/online_docs/support_gettoken",type:"POST",data:{xsrf:(0,s.f)(),domain_id:u.clientVars.domainId,pad_id:u.clientVars.padId,dataType:"form"===u.clientVars.padType?1:0},success:function(t){0===t.retcode&&t.token.length>0?"function"===typeof e&&e(t.token):(0,c.showToast)(o.ZP.t("请求失败，请稍后尝试。"),{zIndex:999999})},error:function(e){(0,c.showToast)(o.ZP.t("请求失败，请稍后尝试。"),{zIndex:999999})}})}},"../spread-sheet/src/external/view/mobile/header/menu/feature/renameDocument.tsx":function(e,t,n){n.d(t,{m:function(){return d}}),n("../node_modules/regenerator-runtime/runtime.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.promise.js");var o=n("../node_modules/i18next/dist/esm/i18next.js"),i=n("../spread-sheet/src/core/data/configService/spreadConfig.ts"),s=n("../spread-sheet/src/base/event/event.ts"),r=n("../spread-sheet/src/base/event/eventName.ts"),a=n("../spread-sheet/src/external/view/mobile/header/utils.ts"),c=(n("../spread-sheet/src/base/util/domain-config.ts"),n("../spread-sheet/src/external/check-slr/sc-lazy-loader.ts")),l=function(e,t,n,o){return new(n||(n=Promise))((function(i,s){function r(e){try{c(o.next(e))}catch(t){s(t)}}function a(e){try{c(o.throw(e))}catch(t){s(t)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(r,a)}c((o=o.apply(e,t||[])).next())}))};function d(e,t){return l(this,void 0,void 0,regeneratorRuntime.mark((function n(){var i,d,p=this;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(window.SpreadsheetApp.sheetStatus.canEdit){n.next=2;break}return n.abrupt("return");case 2:return i="",d=function n(){return l(p,void 0,void 0,regeneratorRuntime.mark((function l(){return regeneratorRuntime.wrap((function(l){for(;;)switch(l.prev=l.next){case 0:return l.next=2,(0,c.FU)();case 2:return l.sent.hideMenu(),s.ZP.default.trigger(r.W1.UI_SHOW,r.Xs.RENAME_DOCUMENT_M),l.next=7,(0,c.Hz)();case 7:(0,l.sent.showInputDialog)({title:o.ZP.t("重命名"),tipText:i,isErrorTip:!0,placeholder:o.ZP.t("请输入文档名"),value:u(e),shouldAutoFocus:!0,onChange:function(t){e=t.target.value,i="";var o=(0,a.eS)(e),s=o.newTips,r=o.newTitle;e=r,i=s,n()},onConfirm:function(){window.SpreadsheetApp.spreadsheet.setTitle(e),"function"===typeof t&&t()},onCancel:function(){"function"===typeof t&&t()}});case 10:case"end":return l.stop()}}),l)})))},n.next=6,d();case 6:case"end":return n.stop()}}),n)})))}function u(e){return 0===i.q.getConfig("isUserChangeTitle")?"":e}},"../spread-sheet/src/external/view/mobile/header/menu/mobileMoreMenu.ts":function(e,t,n){n.d(t,{ZP:function(){return g},k6:function(){return m},Uc:function(){return p}}),n("../node_modules/regenerator-runtime/runtime.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.promise.js"),n("../node_modules/core-js/modules/es.object.assign.js");var o=n("../spread-sheet/src/external/check-slr/sc-lazy-loader.ts"),i=n("../spread-sheet/src/base/index.ts"),s=n("../node_modules/@tencent/ioc/lib/esm/index.js"),r=n("../node_modules/@tencent/workbench/lib/esm/services/mobile-menu/mobile-menu-service.js"),a=n("../spread-sheet/src/base/util/deviceEnv/index.ts"),c=(n("../node_modules/core-js/modules/web.dom-collections.for-each.js"),n("../node_modules/core-js/modules/es.function.name.js"),n("../node_modules/core-js/modules/es.array.map.js"),n("../node_modules/core-js/modules/es.array.filter.js"),n("../node_modules/i18next/dist/esm/i18next.js")),l=(n("../spread-sheet/src/core/data/configService/spreadConfig.ts"),n("../spread-sheet/src/external/export/interface.ts"),n("../node_modules/core-js/modules/es.regexp.exec.js"),n("../node_modules/core-js/modules/es.string.replace.js"),n("../spread-sheet/src/core/ui/index.ts"),n("../node_modules/@tencent/docs-user-agent/dist/index.js"),n("../packages/common-utils/src/index.ts"),n("../packages/report/src/index.ts"),n("../spread-sheet/src/base/storage/storage.ts"),n("../spread-sheet/src/external/view/workbench/service/show-dialog.ts"),n("../spread-sheet/src/core/ark-extensions/extensions/size-limit-dialog.ts"),n("../node_modules/@tencent/tencent_doc_open_url/dist/index.js"),n("../spread-sheet/src/base/util/domain-config.ts"));n("../packages/utils/src/safe.ts"),n("../node_modules/qs/lib/index.js"),n("../spread-sheet/src/base/util/appConfig.ts"),n("../spread-sheet/src/external/view/mobile/header/native-header/index.ts"),n("../node_modules/@babel/runtime/helpers/esm/assertThisInitialized.js"),n("../node_modules/@babel/runtime/helpers/esm/inheritsLoose.js"),n("../spread-sheet/src/core/utils/config.ts"),n("../node_modules/core-js/modules/es.array.slice.js"),n("../spread-sheet/src/core/view/level-2/search-replace2/panel/pc/search-replace-modal.tsx"),n("../spread-sheet/src/external/feedback/supportpage.ts"),n("../spread-sheet/src/core/feature/relateFormEnt/enterpriseStatus.ts"),n.g.tdocs,c.ZP.t("查找"),c.ZP.t("查找和替换"),c.ZP.t("归档评论"),c.ZP.t("查看浏览记录"),c.ZP.t("导出为"),c.ZP.t("打印"),c.ZP.t("生成副本"),c.ZP.t("保存为模板"),c.ZP.t("文档信息"),c.ZP.t("日志上报（临时入口）"),c.ZP.t("投诉");var d=function(e,t,n,o){return new(n||(n=Promise))((function(i,s){function r(e){try{c(o.next(e))}catch(t){s(t)}}function a(e){try{c(o.throw(e))}catch(t){s(t)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(r,a)}c((o=o.apply(e,t||[])).next())}))};function u(){var e=document.querySelector(".mobile-pull-panel-mask");e&&"none"!==getComputedStyle(e).display&&g()}window.SpreadsheetApp.sheetStatus.change((function(){if(!window.SpreadsheetApp.sheetStatus.canEdit)return function(){var e=document.getElementById("mobile-design-input-dialog-mountpoint");e&&(e.style.display="none")}()}));var p={initialed:!1,isDisabled:!1,isShowMove:!1},h=!1;function m(){return d(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t,i,s=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,o.wQ)();case 2:if(t=e.sent,i=t.MobileMenuMoveFile,!h){e.next=6;break}return e.abrupt("return",i);case 6:return h=!0,e.next=10,i.init({initCb:function(e){p.initialed=!0,p.isDisabled=e.isDisabled,p.isShowMove=e.isShowMove,u()},addSuccessCb:function(){return d(s,void 0,void 0,regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return p.isShowMove=!0,u(),e.next=4,n.g.SpreadsheetApp.plugins.getAppGuide();case 4:null===(t=e.sent)||void 0===t||t.thideSaveToMydoc();case 6:case"end":return e.stop()}}),e)})))},hideCb:function(){(0,a.Q)()}});case 10:return e.abrupt("return",i);case 11:case"end":return e.stop()}}),e)})))}function f(e,t){return void 0===e&&(e={}),d(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:i.Z.event.toolBar.trigger("headerMoreMenuShow"),s.Am.get(r.B).showMenu();case 3:case"end":return e.stop()}}),e)})))}function g(e,t){var o,i;return void 0===e&&(e={}),d(this,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:(null===(i=null===(o=n.g.tdocs)||void 0===o?void 0:o.isWedocWebview)||void 0===i?void 0:i.call(o))&&l.xc||f(e);case 1:case"end":return t.stop()}}),t)})))}},"../spread-sheet/src/external/view/mobile/header/utils.ts":function(e,t,n){n.d(t,{SL:function(){return c},bs:function(){return a},eS:function(){return d},ip:function(){return l}}),n("../node_modules/core-js/modules/es.regexp.exec.js"),n("../node_modules/core-js/modules/es.string.replace.js"),n("../node_modules/core-js/modules/es.array.slice.js");var o=n("../node_modules/i18next/dist/esm/i18next.js"),i=n("../spread-sheet/src/core/data/configService/spreadConfig.ts"),s=/[\\\/:*?"<>|]/g;function r(e){return e+"-"+i.q.getConfig("uid")}function a(e){return""+n.g.localStorage.getItem(r(e))==="1"}function c(e){n.g.localStorage.setItem(r(e),"1")}function l(e){n.g.localStorage.removeItem(r(e))}function d(e){var t=function(e){return s.test(e)?{legalityTips:o.ZP.t("文档名不能包含下列任何字符：")+'\\ / : * ? " < > |',legalityTitle:e.replace(s,"")}:{legalityTips:"",legalityTitle:e}}(e),n=t.legalityTips,i=t.legalityTitle;if(n)return{newTips:n,newTitle:i};var r=function(e){if(!e||!e.length)return{lengthTips:"",lengthTitle:e};var t,n,i=0,s=0;for(s=0,n=e.length;s<n;s++)if((i+=(t=e.charCodeAt(s))<=127?1:t<=2047?2:t<=65535?3:4)>128)return{lengthTips:o.ZP.t("文档名不能超过128个字符。"),lengthTitle:e.slice(0,s)};return{lengthTips:"",lengthTitle:e}}(e);return{newTips:r.lengthTips,newTitle:r.lengthTitle}}},"../spread-sheet/src/external/view/workbench/service/show-dialog.ts":function(e,t,n){n.d(t,{S:function(){return r}}),n("../node_modules/regenerator-runtime/runtime.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.promise.js"),n("../node_modules/core-js/modules/es.function.name.js");var o=n("../spread-sheet/src/core/ark-extensions/index.ts"),i=n("../spread-sheet/src/core/ark-extensions/extensions/size-limit-dialog.ts"),s=function(e,t,n,o){return new(n||(n=Promise))((function(i,s){function r(e){try{c(o.next(e))}catch(t){s(t)}}function a(e){try{c(o.throw(e))}catch(t){s(t)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(r,a)}c((o=o.apply(e,t||[])).next())}))};function r(e,t,n){return void 0===n&&(n=!1),s(this,void 0,void 0,regeneratorRuntime.mark((function s(){var r,c;return regeneratorRuntime.wrap((function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,o.default.getExtension(i.XM.name);case 2:r=s.sent,c=a(i.XM.name),r.show({container:c,type:e,report:{ver9:t},needReturnToTrash:n});case 5:case"end":return s.stop()}}),s)})))}function a(e){var t=document.getElementById(e);if(t)return t;var n=document.createElement("div");return n.id=e,document.body.appendChild(n),n}}}]),window.jsExecEndTimeStamp=Date.now(),window.cachedPerformanceEntries||(window.cachedPerformanceEntries=[]),window.cachedPerformanceEntries.push({name:"jsExec: js/spread-sheet_src_core_utils_gray_ts-spread-sheet_src_core_view_level-2_condition-format-cente-74d507.9169104b81f2c615a82c.js",entryType:"jsExec",startTime:window.jsExecStartTimeStamp,endTime:window.jsExecEndTimeStamp});
//# sourceMappingURL=spread-sheet_src_core_utils_gray_ts-spread-sheet_src_core_view_level-2_condition-format-cente-74d507.9169104b81f2c615a82c.js.map