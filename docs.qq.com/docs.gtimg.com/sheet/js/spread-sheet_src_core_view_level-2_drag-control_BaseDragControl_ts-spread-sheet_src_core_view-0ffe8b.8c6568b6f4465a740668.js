self.window=self,window.jsExecStartTimeStamp=Date.now(),(self.webpackChunk_tencent_alloy_builder=self.webpackChunk_tencent_alloy_builder||[]).push([["spread-sheet_src_core_view_level-2_drag-control_BaseDragControl_ts-spread-sheet_src_core_view-0ffe8b"],{"../spread-sheet/src/core/view/level-2/drag-control/BaseDragControl.ts":function(e,t,n){n.d(t,{Z:function(){return r}});var o=n("../node_modules/@babel/runtime/helpers/esm/inheritsLoose.js"),i=(n("../node_modules/core-js/modules/es.function.name.js"),n("../node_modules/core-js/modules/es.object.assign.js"),n("../node_modules/@babel/runtime/helpers/esm/toConsumableArray.js")),a=function(e){function t(t,n,o,i){var a;return(a=e.call(this,t,n,o)||this)._handleMousedown=function(e){e.stopPropagation(),a._startCallback(),document.addEventListener("mousemove",a._handleMousemove,!0),document.addEventListener("mouseup",a._handleMouseup),document.addEventListener("touchmove",a._handleMousemove,{capture:!0,passive:!1}),document.addEventListener("touchend",a._handleMouseup)},a._handleMousemove=function(e){e.stopPropagation(),e.preventDefault(),a._moveCallback(a._name,{diffX:a._operateData.diffX,diffY:a._operateData.diffY})},a._handleMouseup=function(e){e.stopPropagation(),document.removeEventListener("mousemove",a._handleMousemove,!0),document.removeEventListener("mouseup",a._handleMouseup),document.removeEventListener("touchmove",a._handleMousemove,{capture:!0}),document.removeEventListener("touchend",a._handleMouseup),a._endCallback()},a._name=i.name,a._operateData=i.operateData,a._startCallback=i.startCallback,a._moveCallback=i.moveCallback,a._endCallback=i.endCallback,a._element.addEventListener("mousedown",a._handleMousedown),a._element.addEventListener("touchstart",a._handleMousedown),a}return(0,o.Z)(t,e),t.prototype.update=function(e){Object.assign(this._element.style,{display:e.display?"block":"none"})},t}((function(e,t,n){var o;this._element=document.createElement("div"),Object.assign(this._element.style,n),this._element.classList.add("drag-icon"),(o=this._element.classList).add.apply(o,(0,i.Z)(t)),e.appendChild(this._element)})),r=function(){function e(e){var t=e.container,n=e.startCallback,o=e.moveCallback,i=e.endCallback,r=e.operateData,s=e.complete,l=void 0===s||s;this.topLeft=new a(t,["drag-top","drag-left"],{},{name:"top-left",startCallback:n,moveCallback:o,endCallback:i,operateData:r}),this.topCenter=new a(t,["drag-top","drag-center"],{display:l?"block":"none"},{name:"top-center",startCallback:n,moveCallback:o,endCallback:i,operateData:r}),this.topRight=new a(t,["drag-top","drag-right"],{},{name:"top-right",startCallback:n,moveCallback:o,endCallback:i,operateData:r}),this.middleLeft=new a(t,["drag-middle","drag-left"],{display:l?"block":"none"},{name:"middle-left",startCallback:n,moveCallback:o,endCallback:i,operateData:r}),this.middleRight=new a(t,["drag-middle","drag-right"],{display:l?"block":"none"},{name:"middle-right",startCallback:n,moveCallback:o,endCallback:i,operateData:r}),this.bottomLeft=new a(t,["drag-bottom","drag-left"],{},{name:"bottom-left",startCallback:n,moveCallback:o,endCallback:i,operateData:r}),this.bottomCenter=new a(t,["drag-bottom","drag-center"],{display:l?"block":"none"},{name:"bottom-center",startCallback:n,moveCallback:o,endCallback:i,operateData:r}),this.bottomRight=new a(t,["drag-bottom","drag-right"],{},{name:"bottom-right",startCallback:n,moveCallback:o,endCallback:i,operateData:r})}var t=e.prototype;return t.showMiddleCenter=function(){var e={display:!0};this.topCenter.update(e),this.bottomCenter.update(e),this.middleLeft.update(e),this.middleRight.update(e)},t.hideMiddleCenter=function(){var e={display:!1};this.topCenter.update(e),this.bottomCenter.update(e),this.middleLeft.update(e),this.middleRight.update(e)},e}()},"../spread-sheet/src/core/view/level-2/mention/api/MentionApi.ts":function(e,t,n){n.d(t,{Z:function(){return h}});var o,i,a,r=n("../node_modules/@babel/runtime/helpers/esm/createClass.js"),s=(n("../node_modules/core-js/modules/es.regexp.exec.js"),n("../node_modules/core-js/modules/es.string.search.js"),n("../spread-sheet/src/base/event/event.ts")),l=n("../spread-sheet/src/external/mention/enum.ts"),c=n("../spread-sheet/src/external/view/mobile/toolbar/native-toolbar/index.ts"),u=n("../spread-sheet/src/base/index.ts");!function(e){e.MENTION_LIST="MENTION_LIST",e.QUICK_REMIND_MENU="QUICK_REMIND_MENU"}(o||(o={})),function(e){e.TOP="top"}(a||(a={}));var d=function(){function e(){}return e.popMentionList=function(t,i,a,r){var c;n.g.log.info("MentionApi","popMentionList - position: "+JSON.stringify(t)+", rowHeight: "+i+", sheetId: "+a),null===(c=s.ZP.mentionEvent)||void 0===c||c.trigger(l.yS.ADD_MENTION_ACTION,t,i,a,r),e.modifyMentionUIComponentDisplayStatus(o.MENTION_LIST,!0)},e.setMentionMenu=function(t,i,a){var r;if(n.g.log.debug("MentionApi","setMentionMenu - visible: "+t+", pos: "+JSON.stringify(i)+", rowHeight: "+a),i.x<0||i.y<0)return n.g.log.warn("MentionApi","setMentionMenu position is invalid, force hide mention list!"),e.hideMentionList(),void e.modifyMentionUIComponentDisplayStatus(o.MENTION_LIST,!1);null===(r=s.ZP.mentionEvent)||void 0===r||r.trigger(l.yS.SET_MENTION_MENU,t,i,a),e.modifyMentionUIComponentDisplayStatus(o.MENTION_LIST,!1)},e.search=function(t){var i;n.g.log.debug("MentionApi","search - "+t),null===(i=s.ZP.mentionEvent)||void 0===i||i.trigger(l.yS.SEARCH_MENTION,t),e.modifyMentionUIComponentDisplayStatus(o.MENTION_LIST,!0)},e.control=function(t){var i;n.g.log.debug("MentionApi","control - "+t),null===(i=s.ZP.mentionEvent)||void 0===i||i.trigger(l.yS.KEYBOARD_DOWN,t),e.modifyMentionUIComponentDisplayStatus(o.MENTION_LIST,!0)},e.hideMentionList=function(){var t;n.g.log.info("MentionApi","hideMentionList"),null===(t=s.ZP.mentionEvent)||void 0===t||t.trigger(l.yS.CANCEL_MENTION_ACTION),e.modifyMentionUIComponentDisplayStatus(o.MENTION_LIST,!1)},e.showRemindBoard=function(t,i,a,r,c){var u;n.g.log.info("MentionApi","showRemindBoard - mentionId: "+t+", position: "+JSON.stringify(i)+", visible: "+a+", rowHeight: "+r),null===(u=s.ZP.mentionEvent)||void 0===u||u.trigger(l.yS.SET_QUICKREMIND_MENU,{mentionId:t,pos:i,visible:a,rowHeight:r,userId:c}),e.modifyMentionUIComponentDisplayStatus(o.QUICK_REMIND_MENU,!0)},e.closeRemindBoard=function(){var t;n.g.log.info("MentionApi","closeRemindBoard"),null===(t=s.ZP.mentionEvent)||void 0===t||t.trigger(l.yS.HIDE_QUICKREMIND_MENU),e.modifyMentionUIComponentDisplayStatus(o.QUICK_REMIND_MENU,!1)},e.enterFullScreenMode=function(){return(0,c.KK)()?(n.g.log.info("MentionApi","enterFullScreenMode - Hide native toolbar start"),u.Z.util.timer.wait(500).run((function(){c.ZP.hideNativeToolbar(),n.g.log.info("MentionApi","enterFullScreenMode - Hide native toolbar end")})),!0):(n.g.log.debug("MentionApi","enterFullScreenMode - Does not support native toolbar"),!1)},e.modifyMentionUIComponentDisplayStatus=function(t,n){e.mentionDisplayStatus[t]=n},(0,r.Z)(e,null,[{key:"isMentionListVisible",get:function(){return e.mentionDisplayStatus[o.MENTION_LIST]}},{key:"isQuickRemindMenuVisible",get:function(){return e.mentionDisplayStatus[o.QUICK_REMIND_MENU]}}]),e}();d.mentionDisplayStatus=((i={})[o.MENTION_LIST]=!1,i[o.QUICK_REMIND_MENU]=!1,i);var h=d},"../spread-sheet/src/core/view/level-2/mention/enum.ts":function(e,t,n){var o;n.d(t,{B:function(){return o},T:function(){return i}}),function(e){e.SHOW_FRIEND_SELECTOR="SHOW_FRIEND_SELECTOR",e.HIDE_FRIEND_SELECTOR="HIDE_FRIEND_SELECTOR"}(o||(o={}));var i={commercialAt:"@",fullwidthCommercialAt:"＠",smallCommercialAt:"﹫"}},"../spread-sheet/src/core/view/level-2/mention/utils.ts":function(e,t,n){n.d(t,{$k:function(){return b},Mn:function(){return g},PR:function(){return v},Pk:function(){return d},Si:function(){return p},Ue:function(){return f},Ys:function(){return w},ir:function(){return _},p1:function(){return h}}),n("../node_modules/core-js/modules/es.array.find.js"),n("../node_modules/core-js/modules/es.string.trim.js"),n("../node_modules/core-js/modules/es.object.values.js");var o=n("../spread-sheet/src/core/view/spreadsheet-view/model/line/RichParagraph.ts"),i=n("../spread-sheet/src/core/view/spreadsheet-view/model/line/segment/MentionSegment.ts"),a=n("../spread-sheet/src/core/view/spreadsheet-view/model/line/SimpleParagraph.ts"),r=n("../spread-sheet/src/core/view/level-2/mention/api/MentionApi.ts"),s=n("../spread-sheet/src/core/data/configService/spreadConfig.ts"),l=n("../spread-sheet/src/core/view/level-2/mention/enum.ts"),c=(n("../spread-sheet/src/base/util/domain-config.ts"),"alloy-mention-block"),u=String.fromCharCode(8203);function d(e){return a.Z.isTargetType(e)?i.Z.isTargetType(e.segment):e instanceof o.Z&&!!e.lines.find((function(e){return e.segments.find((function(e){return i.Z.isTargetType(e)}))}))}function h(){var e=document.getSelection();return(null===e||void 0===e?void 0:e.rangeCount)&&e.getRangeAt(0)||null}function f(e){var t=m("start"),n=function(e){var t=e.text||"",n=null;return(n=function(e){var t=document.createElement("div");return t.innerHTML=e.trim(),t.firstChild}("\n        <span class="+c+'>\n            <div class="mention-block-content" contenteditable="false">\n                <span>'+t+"</span>\n            </div>\n        </span>")).setAttribute("data-mention-detail",JSON.stringify(e)),n}(e);return[t,n,m("end")]}function m(e){var t=document.createElement("span");t.setAttribute("fake-text",e);var n=document.createTextNode(u);return t.appendChild(n),t}function p(e){return{type:e.mentionType||0,sheetId:e.targetId,mentionId:e.mentionId,text:"@"+(e.mark||e.markname||e.nick||""),userId:e.uid,padId:s.q.getConfig("padId")||""}}var g=function(e){return-1!==Object.values(l.T).indexOf(e)};function v(){return r.Z.control("UP"),!1}function b(){return r.Z.control("DOWN"),!1}function w(){return r.Z.control("SELECT"),!1}var _=function(e,t,o){r.Z.isQuickRemindMenuVisible&&(e&&n.g.log.debug(e,t+" - "+o),r.Z.closeRemindBoard())}},"../spread-sheet/src/core/view/level-2/render-plugin/BaseRenderPlugin.ts":function(e,t,n){var o=n("../packages/lib/EventEmitter.ts");t.Z=function(e){this.emitter=new o.Z,this._alloyExcel=e.alloyExcel}},"../spread-sheet/src/core/view/level-2/render-plugin/utils.ts":function(e,t,n){n.d(t,{VD:function(){return s},Xf:function(){return a},jG:function(){return l},qp:function(){return c},t9:function(){return r}}),n("../node_modules/core-js/modules/es.regexp.exec.js"),n("../node_modules/core-js/modules/es.string.replace.js");var o=n("../spread-sheet/src/core/view/spreadsheet-view/model/VerticalAlign.ts"),i=n("../spread-sheet/src/core/view/config/default.ts"),a=2;function r(e,t,n,i,r){var s=e.getCellViewAtPosition(t,n);if(null===s)throw new Error("获取单元格异常");var l=0;switch(s.style.verticalAlign.value){case o.o.MIDDLE:l=(i-r)/2;break;case o.o.TOP:l=a;break;case o.o.BOTTOM:l=i-a-r}return l}function s(e,t){return t[0]<=e[0]&&e[0]<=t[0]+t[2]&&t[1]<=e[1]&&e[1]<=t[1]+t[3]}function l(e,t){return void 0===t&&(t=.8),t*((e||i.n5)/i.n5)}function c(e,t,n,i,a){if(!e)throw new Error("获取单元格异常");var r=a.width,s=a.height,l=(e.paddingLeft-r)/2,c=0;switch(e.style.verticalAlign.value){case o.o.MIDDLE:c=(t-s)/2;break;case o.o.TOP:c+s>t&&(c=1);break;case o.o.BOTTOM:c=t-s-1;break;default:console.error("Error")}return[n+l,i+c]}},"../spread-sheet/src/core/view/level-2/shape-edit-center/utils.ts":function(e,t,n){n.d(t,{CC:function(){return c},Il:function(){return i},p5:function(){return s},p7:function(){return r},rv:function(){return l},vM:function(){return a}}),n("../node_modules/regenerator-runtime/runtime.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.promise.js");var o=function(e,t,n,o){return new(n||(n=Promise))((function(i,a){function r(e){try{l(o.next(e))}catch(t){a(t)}}function s(e){try{l(o.throw(e))}catch(t){a(t)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(r,s)}l((o=o.apply(e,t||[])).next())}))};function i(e){return o(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=new Promise((function(t){var n=new Image;n.src=e,n.onload=function(){t({width:n.width,height:n.height})},n.onerror=function(){t({width:0,height:0})}})),t.abrupt("return",n);case 2:case"end":return t.stop()}}),t)})))}function a(e){var t=e.getDisplayViewLeftByCol(e.col.frozen.from),n=e.getDisplayViewLeftByCol(e.col.flow.from),o=Math.min(t,n),i=e.getDisplayViewRightByCol(e.col.frozen.to),a=e.getDisplayViewRightByCol(e.col.flow.to),r=Math.max(i,a)-1,s=e.getDisplayViewTopByRow(e.row.frozen.from),l=e.getDisplayViewTopByRow(e.row.flow.from),c=Math.min(s,l),u=e.getDisplayViewBottomByRow(e.row.frozen.to),d=e.getDisplayViewBottomByRow(e.row.flow.to);return{left:o,top:c,right:r,bottom:Math.max(u,d)-1}}function r(e,t,n,o,i){/left/.test(n)?function(e,t,n){var o=a(t).left;n<0&&-n>e.clipLeft&&(n=-e.clipLeft),n<0&&n<o-e.left&&(n=o-e.left),n>0&&n>e.width-1&&(n=e.width-1),e.clipLeft+=n,e.left+=n,e.width-=n}(e,t,o):/right/.test(n)&&function(e,t,n){n>0&&n>e.clipRight&&(n=e.clipRight),n<0&&-n>e.width-1&&(n=-(e.width-1)),e.clipRight-=n,e.width+=n}(e,0,o),/top/.test(n)?function(e,t,n){var o=a(t).top;n<0&&-n>e.clipTop&&(n=-e.clipTop),n<0&&n<o-e.top&&(n=o-e.top),n>0&&n>e.height-1&&(n=e.height-1),e.clipTop+=n,e.top+=n,e.height-=n}(e,t,i):/bottom/.test(n)&&function(e,t,n){n>0&&n>e.clipBottom&&(n=e.clipBottom),n<0&&-n>e.height-1&&(n=-(e.height-1)),e.clipBottom-=n,e.height+=n}(e,0,i)}function s(e,t,n,o,i){var a=e.width,r=e.height;l(e,t,n,o,i),e.clipTop*=e.height/r,e.clipBottom*=e.height/r,e.clipLeft*=e.width/a,e.clipRight*=e.width/a}function l(e,t,n,o,i){var r=/left/.test(n),s=/top/.test(n);"core"===n?function(e,t,n,o){var i=a(t),r=i.left,s=i.top;e.left=Math.max(r,e.left+n),e.top=Math.max(s,e.top+o),e.width+=2*n,e.height+=2*o}(e,t,o,i):/center|middle/.test(n)?function(e,t,n,o){/top/.test(t)?(o<0&&-o>e.top&&(o=-e.top),e.top+=o,e.height-=o):/left/.test(t)?(n<0&&-n>e.left&&(n=-e.left),e.left+=n,e.width-=n):/right/.test(t)?e.width+=n:/bottom/.test(t)&&(e.height+=o)}(e,n,o,i):function(e,t,n,o,i){var r=/left/.test(n),s=/top/.test(n),l=e.top,c=e.left,u=e.width,d=e.height,h=function(e,t,n,o){var i=/left/.test(t),a=/top/.test(t),r=Math.sqrt(e.width*e.width+e.height*e.height)||1,s=e.width/r*(i?-1:1),l=e.height/r*(a?-1:1),c=n*s+o*l;return[c*s,c*l]}(e,n,o,i);o=h[0],i=h[1];var f=function(e,t,n,o,i){var r=/left/.test(n),s=/top/.test(n),l=a(t),c=l.left,u=l.top,d=l.right,h=l.bottom,f=c-e.left,m=d-e.left,p=u-e.top,g=h-e.top,v=r&&o<0?Math.max(0,Math.min(f/o,1)):1,b=s&&i<0?Math.max(0,Math.min(p/i,1)):1,w=r&&o>0?Math.max(0,Math.min(m/o,1)):1,_=s&&i>0?Math.max(0,Math.min(g/i,1)):1,M=Math.min(v,b,w,_);return[o*=M,i*=M]}(e,t,n,o,i);o=f[0],i=f[1],s?(e.top+=i,e.height-=i):e.height+=i,r?(e.left+=o,e.width-=o):e.width+=o,["top left","top right","bottom right","bottom left"].indexOf(n)>-1&&(e.height<=1||e.width<=1)&&(d>=e.height||u>=e.width)&&(e.top=l,e.left=c,e.height=d,e.width=u)}(e,t,n,o,i);var l=1-e.width;l>0&&(r&&(e.left-=l),e.width+=l);var c=1-e.height;c>0&&(s&&(e.top-=c),e.height+=c)}function c(e,t,n,o){var i=a(t),r=i.left,s=i.top,l=i.right,c=i.bottom;e.left=Math.max(r,Math.min(e.left+n,l)),e.top=Math.max(s,Math.min(e.top+o,c))}},"../spread-sheet/src/core/view/lib/find-position.ts":function(e,t,n){function o(e,t,n,o){void 0===o&&(o={});var s=0,l=0,c=0,u=0;void 0===o.sourceXPoint&&(o.sourceXPoint=[0,.2,.3,.4,.5,.6,.7,.8,.9,1]),void 0===o.targetXPoint&&(o.targetXPoint=[0,.5,1]);var d=!1,h=0,f=0;e:for(var m=0;m<o.targetXPoint.length;m++)for(var p=o.targetXPoint[m],g=t.left+t.width*p,v=0;v<o.sourceXPoint.length;v++){var b=o.sourceXPoint[v];if(d=i(g,e,b,n)){h=v,u=b,f=m;break e}}return d?s=t.left+t.width*o.targetXPoint[f]-o.sourceXPoint[h]*e.width:t.left-n.minX>n.maxX-(t.left+t.width)?(s=t.left+t.width-e.width,u=1):(s=t.left,u=0),void 0===o.sourceYDir&&(o.sourceYDir=-1),d=!1,o.sourceYDir<0?(d=a(t.top,e.height,n.minY))?(l=t.top-e.height,c=-1):(d=r(t.top+t.height,e.height,n.maxY))&&(l=t.top+t.height,c=1):(d=r(t.top+t.height,e.height,n.maxY))?(l=t.top+t.height,c=1):(d=a(t.top,e.height,n.minY))&&(l=t.top-e.height,c=-1),d||(t.top-n.minY>n.maxY-(t.top+t.height)?(l=t.top-e.height,c=-1):(l=t.top+t.height,c=1),o.showAsMoreAsPossible&&(t.top-n.minY>n.maxY-(t.top+t.height)?(l=n.maxY-e.height<0?n.maxY-e.height:0,c=-1):(l=n.maxY-e.height,c=1))),{left:s,top:l,yDir:c,xPoint:u}}function i(e,t,n,o){var i=t.width*n,a=t.width*(1-n);return!(e-i<o.minX)&&!(e+a>o.maxX)}function a(e,t,n){return e-t>=n}function r(e,t,n){return e+t<=n}n.d(t,{s:function(){return o}})},"../spread-sheet/src/external/mention/enum.ts":function(e,t,n){var o,i;n.d(t,{aV:function(){return a},yS:function(){return o}}),function(e){e.ADD_MENTION_ACTION="addMentionAction",e.SET_MENTION_MENU="setMentionMenu",e.SEND_MENTION_ACTION="sendMentionAction",e.CANCEL_MENTION_ACTION="cancelMentionAction",e.DELETE_MENTION_ACTION="deleteMentionAction",e.SEARCH_MENTION="searchMention",e.SET_QUICKREMIND_MENU="setQuickRemindMenu",e.HIDE_QUICKREMIND_MENU="hideQuickRemindMenu",e.KEYBOARD_DOWN="keyboardDown",e.AUTO_CREATE_MENTION="autoCreateMention"}(o||(o={})),function(e){e.MENTION_START="mention_start",e.MENTION_END="mention_end"}(i||(i={}));var a=function(e){return e+"Success"}},"../spread-sheet/src/external/view/mobile/toolbar/native-toolbar/index.ts":function(e,t,n){n.d(t,{ZP:function(){return s},fG:function(){return r},KK:function(){return a}});var o=n("../node_modules/@babel/runtime/helpers/esm/createClass.js"),i=(n("../node_modules/core-js/modules/es.object.assign.js"),n("../node_modules/core-js/modules/es.regexp.exec.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/web.dom-collections.for-each.js"),n("../node_modules/core-js/modules/es.object.keys.js"),n("../node_modules/core-js/modules/es.function.name.js"),n("../node_modules/core-js/modules/es.string.match.js"),n("../spread-sheet/src/external/view/native/native-toolbar/utils.ts")),a=function(){return(0,i.KK)()};function r(){return(0,i.fG)()}var s=new(function(){function e(){var e=this;this.callbackMap={},this.toolbarHeight=0,this.panelHeight=0,this.keyboardHeight=0,this.taskStack=[],this.initNativeToolbar=function(t){e.toolbarConfig=t,e.allPanelConfig&&e.initClientConfig()},this.updateNativeToolbar=function(t){e.appendToTaskStack("updateNativeToolbar",(function(){n.g.mqq.invoke("docx","updateToolbarConfig",{toolbar:e.convertConfigAndExtractCallback(t),key:e.uniqueKey},null)}))},this.initNativePanel=function(t){e.allPanelConfig=t,e.toolbarConfig&&e.initClientConfig()},this.updateNativePanel=function(t){e.appendToTaskStack("updateNativePanel",(function(){n.g.mqq.invoke("docx","updateStylePanelConfig",Object.assign(Object.assign({},e.convertConfigAndExtractCallback(t)),{key:e.uniqueKey}),null)}))},this.showNativeToolbar=function(){e.setNativeToolbarVisible(!0)},this.hideNativeToolbar=function(){e.setNativeToolbarVisible(!1)},this.showNativePanel=function(t){e.setNativePanelVisible(!0,t)},this.hideNativePanel=function(t){e.setNativePanelVisible(!1,t)},this.getHeightInfo=function(){return{toolbar:e.toolbarHeight,panel:e.panelHeight,keyboard:e.keyboardHeight}},this.initClientConfig=function(){e.appendToTaskStack("initClientConfig",(function(){n.g.mqq.invoke("docx","initToolbarConfig",{toolbar:e.convertConfigAndExtractCallback(e.toolbarConfig),stylepanel:e.convertConfigAndExtractCallback(e.allPanelConfig),key:e.uniqueKey},null)}))},this.setNativeToolbarVisible=function(t){e.appendToTaskStack("setNativeToolbarVisible",(function(){n.g.mqq.invoke("docx","setNativeToolbarShow",{show:t,key:e.uniqueKey},null)}))},this.setNativePanelVisible=function(t,o){e.appendToTaskStack("setNativePanelVisible",(function(){n.g.mqq.invoke("docx","setNativePanelShow",{show:t,name:o,key:e.uniqueKey},null)}))},this.bindEvents()}var t=e.prototype;return t.bindEvents=function(){var e=this;(0,i.M4)()||(window.toolbarClick=function(t,n){var o,i,a=t+"-onClick";null===(i=(o=e.callbackMap)[a])||void 0===i||i.call(o,new Event("click"),n)},window.toolbarHeightChange=function(t){e.toolbarHeight=t.toolbar,e.panelHeight=t.stylepanel,e.keyboardHeight=t.keyboard})},t.appendToTaskStack=function(e,t){var n=this;this.taskStack.length||setTimeout((function(){n.runTaskStack()}),0),this.taskStack.push({type:e,exec:t})},t.runTaskStack=function(){if(this.taskStack.length){for(var e={},t=[],n=this.taskStack.length-1;n>=0;n--){var o=this.taskStack[n];e[o.type]||(t.unshift(o.exec),e[o.type]=!0)}t.forEach((function(e){e()})),this.taskStack=[]}},t.convertConfigAndExtractCallback=function(e){var t=this;return function e(n){if("object"===typeof n){if(!n)return n;var o="[object Array]"===Object.prototype.toString.call(n)?[]:{};return Object.keys(n).forEach((function(i){"function"===typeof n[i]?t.callbackMap[n.name+"-"+i]=n[i]:o[i]=e(n[i])})),o}return n}(e)},(0,o.Z)(e,[{key:"uniqueKey",get:function(){return function(){var e=window.location.href.match("/sheet/([a-zA-Z0-9]*).*"),t="sheet";return e&&(t=e[1]),t}()}}]),e}())}}]),window.jsExecEndTimeStamp=Date.now(),window.cachedPerformanceEntries||(window.cachedPerformanceEntries=[]),window.cachedPerformanceEntries.push({name:"jsExec: js/spread-sheet_src_core_view_level-2_drag-control_BaseDragControl_ts-spread-sheet_src_core_view-0ffe8b.8c6568b6f4465a740668.js",entryType:"jsExec",startTime:window.jsExecStartTimeStamp,endTime:window.jsExecEndTimeStamp});
//# sourceMappingURL=spread-sheet_src_core_view_level-2_drag-control_BaseDragControl_ts-spread-sheet_src_core_view-0ffe8b.8c6568b6f4465a740668.js.map