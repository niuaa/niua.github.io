self.window=self,window.jsExecStartTimeStamp=Date.now(),(self.webpackChunk_tencent_alloy_builder=self.webpackChunk_tencent_alloy_builder||[]).push([["bundle_view_lazy_module1"],{"../spread-sheet/src/core/utils/url.ts":function(e,t,n){"use strict";function r(e,t){return t?(e.indexOf("?")>=0?e+="&"+t:e+="?"+t,e):e}n.d(t,{_:function(){return r}})},"../spread-sheet/src/core/view/level-2/canvas-provider/index.tsx":function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return c}}),n("../node_modules/regenerator-runtime/runtime.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.promise.js");var r=n("../spread-sheet/src/core/utils/ImageLoader.ts"),i=n("../spread-sheet/src/core/view/spreadsheet-view/render-manager/alloy-excel/table/body/cell-renders/impl/image-cell-render.ts"),o=n("../spread-sheet/src/core/view/spreadsheet-view/model/HorizontalAlign.ts"),s=n("../spread-sheet/src/core/view/spreadsheet-view/model/VerticalAlign.ts"),a=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{c(r.next(e))}catch(t){o(t)}}function a(e){try{c(r.throw(e))}catch(t){o(t)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))},c=function(){function e(e){this._app=e.app,this._chartCenter=e.chartCenter,this._renderApi=e.renderApi,this._alloyExcel=e.alloyExcel,this._shapeStage=e.shapeStage,this._canvas=document.createElement("canvas"),this._ctx=this._canvas.getContext("2d")}var t=e.prototype;return t.getExcelCanvas=function(e,t,n,r,i){var o=0===e,s=0===n;e=o?0:e-1,n=s?0:n-1;var a=o?0:this._app.view.canvas.areaData.getDisplayGlobalRightByCol(e)-this._app.view.canvas.areaData.getDisplayGlobalLeftByCol(e),c=s?0:this._app.view.canvas.areaData.getDisplayGlobalBottomByRow(n)-this._app.view.canvas.areaData.getDisplayGlobalTopByRow(n),l=this._app.view.canvas.areaData.getDisplayGlobalLeftByCol(t+1)-this._app.view.canvas.areaData.getDisplayGlobalLeftByCol(e)+1,u=this._app.view.canvas.areaData.getDisplayGlobalTopByRow(r+1)-this._app.view.canvas.areaData.getDisplayGlobalTopByRow(n)+1,d=window.devicePixelRatio||1;this.setCanvasWidthHeight(this._canvas,l*d,u*d),this._renderApi.renderCellsOuter(n,r,e,t,0,0,this._ctx,i);var h=l-a+1,f=u-c+1,m=document.createElement("canvas");return this.transformCanvas({from:this._canvas,to:m,fromx:(a-1)*d,fromy:(c-1)*d,fromWidth:h*d,fromHeight:f*d,toWidth:h*d,toHeight:f*d}),m},t.getCellImageCanvas=function(e,t){var n=this._app.view.canvas.transformTable.getCellDataAtPosition(e,t).image;if(n){var i=n.url,o=n.clipInfo,s=o.clipBottom,a=o.clipLeft,c=o.clipRight,l=o.clipTop,u=n.position.overlayPosition,d=u.widthPixels,h=u.heightPixels,f=d+a+c,m=h+l+s,p=0,g=0,v=0,w=0,x=r.ZP.getCachedImage(i);if(x){var C=(0,r.L1)(x),E=C.naturalWidth,b=C.naturalHeight;return p=E*d/f,g=b*h/m,v=E*a/f,w=b*l/m,this.setCanvasWidthHeight(this._canvas,d,h),this._ctx.drawImage(x,v,w,p,g,0,0,d,h),this._canvas}return null}return null},t.getShapeCanvas=function(e){var t=this._app.spreadsheet.activeSheet.imageManager.getImage(e);return t?new Promise((function(e){var n=t.url,r=t.position.overlayPosition,a=new Image;a.setAttribute("crossOrigin","anonymous");var c=document.createElement("canvas");a.onload=function(){var n=(0,i.xl)({image:t,cellWidth:r.widthPixels,cellHeight:r.heightPixels,horizontalAlign:o.Z.newInstance(o.O.CENTER),verticalAlign:s.Z.newInstance(s.o.MIDDLE),imageElement:a}),l=n.sx,u=n.sy,d=n.dWidth,h=n.dHeight,f=n.sWidth,m=n.sHeight;c.width=d,c.height=h;var p=c.getContext("2d");if(p)return p.drawImage(a,l,u,f,m,0,0,d,h),e(c);e(null)},a.src=n})):Promise.resolve(null)},t.getChartCanvas=function(e){var t;return a(this,void 0,void 0,regeneratorRuntime.mark((function n(){var r,i,o,s;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,null===(t=this._chartCenter.chartStage.getChartBox(e))||void 0===t?void 0:t.chart.getEchart();case 2:if(r=n.sent,n.prev=3,!(i=null===r||void 0===r?void 0:r.getRenderedCanvas())){n.next=10;break}return o=i.width,s=i.height,this.transformCanvas({from:i,to:this._canvas,fromx:0,fromy:0,fromWidth:o,fromHeight:s,toWidth:o,toHeight:s,opt:{background:"white"}}),n.abrupt("return",this._canvas);case 10:return console.error("Echarts GetRenderedCanvas API Failed!"),n.abrupt("return",null);case 14:return n.prev=14,n.t0=n.catch(3),console.error(n.t0),n.abrupt("return",null);case 18:case"end":return n.stop()}}),n,this,[[3,14]])})))},t.transformCanvas=function(e){var t=e.from,n=e.to,r=e.fromx,i=e.fromy,o=e.fromWidth,s=e.fromHeight,a=e.toWidth,c=e.toHeight,l=e.opt;this.setCanvasWidthHeight(n,a,c);var u=n.getContext("2d");u.clearRect(0,0,a,c),(null===l||void 0===l?void 0:l.background)&&(u.fillStyle=null===l||void 0===l?void 0:l.background,u.fillRect(0,0,a,c)),u.drawImage(t,r,i,o,s,0,0,a,c)},t.setCanvasWidthHeight=function(e,t,n){e.setAttribute("width",String(Math.round(t))),e.setAttribute("height",String(Math.round(n)))},e}()},"../spread-sheet/src/core/view/level-2/collab-filter-toast/CollabFilterToast.ts":function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return h}});var r=n("../node_modules/@babel/runtime/helpers/esm/inheritsLoose.js"),i=(n("../node_modules/regenerator-runtime/runtime.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.promise.js"),n("../node_modules/core-js/modules/es.array.includes.js"),n("../node_modules/core-js/modules/es.string.includes.js"),n("../packages/mutation/src/index.ts")),o=n("../spread-sheet/src/external/errorUI/client.ts"),s=n("../node_modules/lodash/isEqual.js"),a=n.n(s),c=n("../node_modules/@tencent/containerized/build/main/index.js"),l=n("../spread-sheet/src/core/behavior/request/Type.ts"),u=n("../spread-sheet/src/external/view/main/panel/FillterPanel/utils/event.ts"),d=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{c(r.next(e))}catch(t){o(t)}}function a(e){try{c(r.throw(e))}catch(t){o(t)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))},h=function(e){function t(t){var n;return(n=e.call(this)||this).initState=function(){n.sheetFilterToastInfo={},n.currentToast=null},n.mutationBehavior=t.mutationBehavior,n.messageCenterAdapter=t.messageCenterAdapter,n.getActiveSheetId=t.getActiveSheetId,n.isFilterSync=t.isFilterSync,n.app=t.spreadsheetApp,n.initState(),n.initEvent(),n}(0,r.Z)(t,e);var n=t.prototype;return n.checkToastWhenSwitchSheet=function(e){return d(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.closeCurrentToast();case 2:(n=this.getSheetFilterToastInfo(e)).pendingAction&&(this.showSetFilterToast(n.pendingAction),n.lastAction=n.pendingAction,n.pendingAction=null);case 4:case"end":return t.stop()}}),t,this)})))},n.initEvent=function(){var e=this;this._register(this.messageCenterAdapter.receiveMessageCenterAdapter.onAfterApplyCollabMutations((function(t){for(var n=t.changeInfo,r=t.mutations,s=n.collabUserId,a=0;a<r.length;a++){var c=r[a];if(c.id===i.xF.SWITCH_FILTER_SYNC_MUTATION){var u=c.isOn;(0,o.iZ)(u,s);break}if(c.id===i.xF.UPDATE_FILTER_MUTATION){var d=c.sheetId,h=c.requestId,f=c.filterViewId;if([l.Z.REORDER_FILTER_REQUEST,l.Z.UPDATE_FILTER_CRITERIA_REQUEST].includes(h)&&!f){var m=h===l.Z.REORDER_FILTER_REQUEST;e.handleToast(!m,d,s);break}}}}))),this.mutationBehavior.emitter.addListener(this.mutationBehavior.EVENT.AFTER_MUTATION_RUN,(function(e){var t=e.mutation,n=e.isCollab,r=e.isReplay;if(t.id===i.xF.SWITCH_FILTER_SYNC_MUTATION&&!n&&!r){var s=t.isOn;(0,o.iZ)(s,"")}})),this.mutationBehavior.emitter.addListener(this.mutationBehavior.EVENT.BEFORE_MUTATION_RUN,(function(t){var n=t.mutation,r=t.isCollab,i=t.isLocal;(0,u.U5)(n,r,e.app)&&(0,o.Y6)(),(0,u.Tw)(i,n)&&(0,o.Bx)()})),this.app.emitter.on(this.app.EVENT.START_DESTROY,this.initState)},n.getSheetFilterToastInfo=function(e){return this.sheetFilterToastInfo[e]||(this.sheetFilterToastInfo[e]={lastAction:null,pendingAction:null}),this.sheetFilterToastInfo[e]},n.closeCurrentToast=function(){return d(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.currentToast){e.next=5;break}return this.currentToast.close(),this.currentToast=null,e.next=5,new Promise((function(e){return setTimeout(e,300)}));case 5:case"end":return e.stop()}}),e,this)})))},n.showSetFilterToast=function(e){var t=e.isFilter,n=e.userId;return d(this,void 0,void 0,regeneratorRuntime.mark((function e(){var r=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.closeCurrentToast();case 2:this.currentToast=(0,o.sQ)(t,n,(function(){r.currentToast=null}));case 3:case"end":return e.stop()}}),e,this)})))},n.handleToast=function(e,t,n){var r=this.getActiveSheetId(),i=this.getSheetFilterToastInfo(t),o={userId:n,isFilter:e};if(t===r){if(a()(o,i.lastAction))return;i.lastAction=o,this.showSetFilterToast(o)}else i.pendingAction=o},t}(c.JT)},"../spread-sheet/src/core/view/level-2/filter-view-center/filter-view-center.pc.ts":function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return Q}});var r,i=n("../node_modules/@babel/runtime/helpers/esm/inheritsLoose.js"),o=n("../spread-sheet/src/core/view/level-2/render-plugin/BaseRenderPlugin.ts"),s=n("../spread-sheet/src/core/view/spreadsheet-view/render-manager/alloy-excel/table/corner/utils/render-path.ts"),a=n("../spread-sheet/src/core/view/config/default.ts"),c=n("../spread-sheet/src/core/view/spreadsheet-view/transform-table/head.ts"),l=n("../spread-sheet/src/core/view/spreadsheet-view/transform-table/DimensionMeta.ts"),u=n("../packages/model/src/filter-view/filter-view-util.ts"),d=function(e){function t(t){var n;return(n=e.call(this,t)||this).temp=[0,0,0,0],n.renderCorner=function(){if((0,u.xJ)(n.spreadsheet)){var e=n._alloyExcel.api,t=e.rowHeadWidth,r=e.colHeadHeight;n._alloyExcel.collectEngine.graphicsCollector.collect({color:c.BG[l.i.FILTER_VIEW_DEFAULT].hex,graphicsInfo:{path:(0,s.au)(t,r)}}),n.setTemp(t,0,t,r),n._alloyExcel.collectEngine.lineCollector.collect({lineProp:a.u3,line:n.temp}),n.setTemp(t,r,0,r),n._alloyExcel.collectEngine.lineCollector.collect({lineProp:a.u3,line:n.temp}),n._alloyExcel.collectEngine.graphicsCollector.collect({color:a.u3.color.hex,graphicsInfo:{path:(0,s.ns)(t,r)}})}},n.spreadsheet=t.spreadsheet,n.init(),n}(0,i.Z)(t,e);var n=t.prototype;return n.setTemp=function(e,t,n,r){this.temp[0]=e,this.temp[1]=t,this.temp[2]=n,this.temp[3]=r},n.init=function(){this._alloyExcel.onAfterCornerRender(this.renderCorner)},t}(o.Z),h=function(e){var t=this;this.showFilterView=function(e){t.viewManager.showFilterView(e)},this.hideFilterView=function(){t.viewManager.hideFilterView()},this.addFilterView=function(){t.viewManager.addFilterView()},this.exitFilterView=function(){t.viewManager.onExitFilterView()},this.showForScroll=function(){t.viewManager.showForScroll()},this.hideForScroll=function(){t.viewManager.hideForScroll()},this.getFilterViewBarHeight=function(){return t.viewManager.getFilterViewBarHeight()},this.spreadsheet=e.spreadsheet,this.requestApi=e.requestApi,this.resize=e.resize,this.event=e.event,this.sheetStatus=e.sheetStatus,this.filterViewPlugin=new d({alloyExcel:e.alloyExcel,spreadsheet:e.spreadsheet})},f=(n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.promise.js"),n("react")),m=n.n(f),p=n("react-dom"),g=n.n(p),v=n("../node_modules/i18next/dist/esm/i18next.js"),w=(n("../node_modules/core-js/modules/es.function.name.js"),n("../node_modules/classnames/index.js")),x=n.n(w),C=n("../node_modules/@tencent/dui/lib/components/Modal/index.js"),E=n("../node_modules/@tencent/dui/lib/components/Tooltip/index.js"),b=n("../spread-sheet/src/external/view/main/toolbar/IconBox.tsx"),_=n("../spread-sheet/src/core/ui/dialog/index.ts"),y=n("../packages/model/src/range/hexRangeUtils.ts"),S=(n("../node_modules/core-js/modules/es.object.assign.js"),n("../node_modules/core-js/modules/es.array.map.js"),n("../node_modules/@tencent/dui/lib/components/Input/index.js")),I=n("../node_modules/@tencent/dui/lib/components/Dropdown/index.js"),R=n("../node_modules/@tencent/dui/lib/components/Menu/index.js"),F=n("../node_modules/@tencent/dui/lib/components/Divider/index.js");!function(e){e.SHEET_DROPDOWN="sheet_dropdown",e.SHEET_DROPDOWN_WHITE="sheet_dropdown_white"}(r||(r={}));var T,P=m().forwardRef((function(e,t){var n=e.isFocusName,i=e.name,o=n?r.SHEET_DROPDOWN:r.SHEET_DROPDOWN_WHITE,s=x()("filter-view-name",{active:n,disabled:!e.canEdit});return m().createElement("div",{className:s},m().createElement(S.default,{inputRef:t,value:i,disabled:!e.canEdit,onChange:e.onChangeName,onFocus:e.onFocusName,onBlur:e.onBlurName,maxLength:30,inputClassName:"filter-view-input"}),m().createElement(I.default,{dropContent:m().createElement(A,Object.assign({},e)),className:"dropdown-input-name",animated:!1,alignment:"right"},m().createElement(b.Z,{symbol:o,showAnimate:!0,enable:!0,className:"filter-view-dropdown-icon"})))})),A=function(e){var t=e.onCreateFilterView,n=e.onActiveFilterView,r=e.activeFilterView,i=e.filterViews,o=e.canEdit;return m().createElement(R.default,{className:"view-bar-menu",itemStyle:{width:"166px"}},i.map((function(e){return m().createElement(R.default.Item,{selected:r.filterViewId===e.filterViewId,onClick:function(){return n(e.filterViewId)}},m().createElement("span",{className:"view-name"},e.getFilterViewName()))})),m().createElement(F.default,null),m().createElement(R.default.Item,{disabled:!o,onClick:t},v.ZP.t("新建筛选视图")))},V=P;!function(e){e.TOOLBAR_CELL_BORDER_ALL="toolbar_cell_border_all",e.TOOLBAR_CELL_BORDER_ALL_WHITE="toolbar_cell_border_all_white"}(T||(T={}));var Z,j=m().forwardRef((function(e,t){var n=e.isFocusRange,r=e.rangeStr,i=e.canEdit,o=n?T.TOOLBAR_CELL_BORDER_ALL:T.TOOLBAR_CELL_BORDER_ALL_WHITE,s=x()("filter-view-range",{active:n,disabled:!e.canEdit}),a=i?m().createElement(b.Z,{symbol:o,showAnimate:!0,enable:!0,className:"filter-view-icon-wrapper"}):"";return m().createElement("div",{className:s},m().createElement(S.default,{inputRef:t,className:"filter-range-input-container",inputClassName:"filter-range-input",disabled:!i,value:r,onChange:e.onChangeRange,onBlur:function(){return e.onBlurRange(r)},onFocus:e.onFocusRange,icon:a,onClickIcon:e.enterRangePanel}))})),k=function(e){return m().createElement(R.default,{className:"view-bar-menu",selectable:!1},m().createElement(R.default.Item,{onClick:e.deleteFilterView},v.ZP.t("DELETE_THIS_FILTER_VIEW")))},N=function(e){return m().createElement("div",{className:x()("filter-view-setting-wrapper",{disabled:!e.canEdit})},m().createElement(I.default,{dropContent:m().createElement(k,Object.assign({},e)),animated:!1,disabled:!e.canEdit,alignment:"right",className:"filter-view-setting-drop-down-wrapper"},m().createElement(b.Z,{showAnimate:!0,enable:!0,symbol:"toolbar_setting",className:"filter-view-icon-wrapper"})))},M=n("../spread-sheet/src/core/view/level-2/filter-view-center/report.ts");!function(e){e[e.ENTER=13]="ENTER"}(Z||(Z={}));var O=function(e){function t(t){var n,r;(n=e.call(this,t)||this).inputNameRef=m().createRef(),n.inputRangeRef=m().createRef(),n.isRangePanelShowing=!1,n.updateFilterViewState=function(e,t){var r;n.setState({activeFilterView:e,name:e.getFilterViewName(),filterViews:t,rangeStr:(null===(r=e.getBasicFilter())||void 0===r?void 0:r.getRangeStr())||""})},n.bindEvent=function(){var e,t;null===(e=n.inputNameRef.current)||void 0===e||e.addEventListener("keydown",n.onInputNameKeyDown),null===(t=n.inputRangeRef.current)||void 0===t||t.addEventListener("keydown",n.onInputRangeKeyDown)},n.unbindEvent=function(){var e,t;null===(e=n.inputNameRef.current)||void 0===e||e.removeEventListener("keydown",n.onInputNameKeyDown),null===(t=n.inputRangeRef.current)||void 0===t||t.removeEventListener("keydown",n.onInputRangeKeyDown)},n.deleteFilterView=function(){(0,M.mz)(),n.state.sheetStatus.canEdit&&C.default.confirm({content:v.ZP.t("确定删除该视图吗？"),onOk:function(){return n.props.onDeleteFilterView(n.state.activeFilterView.filterViewId)}})},n.renderFilterViewSetting=function(){var e=n.state.sheetStatus.canEdit;return m().createElement(N,{canEdit:e,deleteFilterView:n.deleteFilterView})},n.renderFilterRange=function(){var e=n.state,t=e.isFocusRange,r=e.rangeStr,i=e.sheetStatus;return m().createElement(j,{ref:n.inputRangeRef,isFocusRange:t,canEdit:i.canEdit,rangeStr:r,onChangeRange:n.onChangeRange,onBlurRange:n.onBlurRange,onFocusRange:n.onFocusRange,enterRangePanel:n.enterRangePanel})},n.onInputRangeKeyDown=function(e){var t;e.keyCode===Z.ENTER&&(null===(t=n.inputRangeRef.current)||void 0===t||t.blur()),e.stopPropagation()},n.enterRangePanel=function(){var e,t=n.state,r=t.rangeStr;t.sheetStatus.canEdit&&(n.isRangePanelShowing||(n.isRangePanelShowing=!0,null===(e=n.props.app.view.plugins.rangeSelectionPanel)||void 0===e||e.show((function(e){n.onBlurRange(e),n.isRangePanelShowing=!1}),(function(){var e;null===(e=n.inputRangeRef.current)||void 0===e||e.focus(),n.isRangePanelShowing=!1}),{defaultValue:r})))},n.onBlurRange=function(e){var t;e?(0,y.isValidHexRange)(e)?n.props.onUpdateRange(e).then((function(){n.setState({isFocusRange:!1,rangeStr:e}),(0,M.RR)()})):_.dialog.info({title:v.ZP.t("无法筛选"),content:v.ZP.t("请输入正确的单元格范围，比如A1:C8"),onOk:function(){var e;n.setState({isFocusRange:!1,rangeStr:(null===(e=n.state.activeFilterView.getBasicFilter())||void 0===e?void 0:e.getRangeStr())||""})}}):n.setState({isFocusRange:!1,rangeStr:(null===(t=n.state.activeFilterView.getBasicFilter())||void 0===t?void 0:t.getRangeStr())||""})},n.onChangeRange=function(e){n.setState({rangeStr:e})},n.onFocusRange=function(){n.setState({isFocusRange:!0,isFocusName:!1})},n.renderFilterViewName=function(){var e=n.state,t=e.isFocusName,r=e.activeFilterView,i=e.name,o=e.filterViews,s=e.sheetStatus;return m().createElement(V,{ref:n.inputNameRef,canEdit:s.canEdit,isFocusName:t,name:i,filterViews:o,activeFilterView:r,onChangeName:n.onChangeName,onFocusName:n.onFocusName,onBlurName:n.onBlurName,onActiveFilterView:n.props.onActiveFilterView,onCreateFilterView:n.props.onCreateFilterView})},n.onInputNameKeyDown=function(e){var t;e.keyCode===Z.ENTER&&(null===(t=n.inputNameRef.current)||void 0===t||t.blur()),e.stopPropagation()},n.onChangeName=function(e){n.setState({name:e})},n.onFocusName=function(){n.setState({isFocusName:!0,isFocusRange:!1})},n.onBlurName=function(){var e=n.state.name;n.setState({isFocusName:!1}),n.props.onUpdateFilterView(e).then((function(){n.setState({name:n.state.activeFilterView.getFilterViewName()}),(0,M.qA)()})).catch((function(){n.setState({name:n.state.activeFilterView.getFilterViewName()})}))};var i=t.activeFilterView;return n.state={isFocusName:!1,name:i.getFilterViewName(),isFocusRange:!1,rangeStr:(null===(r=i.getBasicFilter())||void 0===r?void 0:r.getRangeStr())||"",activeFilterView:i,filterViews:t.filterViews,sheetStatus:t.sheetStatus},n}(0,i.Z)(t,e);var n=t.prototype;return n.render=function(){var e=!this.state.sheetStatus.canEdit;return m().createElement("div",{className:"pc-filter-view-top-bar"},m().createElement("div",{className:"left"},m().createElement("p",{className:x()("filter-view-name-desc",{disabled:e})},v.ZP.t("视图名称：")),this.renderFilterViewName(),m().createElement("p",{className:x()("filter-view-range-desc",{disabled:e})},v.ZP.t("筛选范围：")),this.renderFilterRange()),m().createElement("div",{className:"right"},this.renderFilterViewSetting(),m().createElement("div",{className:"exit",onClick:this.props.onExitFilterView},m().createElement(E.default,{title:v.ZP.t("退出"),placement:"bottom"},m().createElement(b.Z,{className:"filter-view-icon-wrapper",symbol:"toolbar_close",enable:!0})))))},n.componentDidMount=function(){this.bindEvent()},n.componentWillUnmount=function(){this.unbindEvent()},t}(m().Component),L=n("../node_modules/@tencent/ioc/lib/esm/index.js"),D=n("../packages/mutation/src/MutationId.ts"),U=n("../packages/mutation/src/filter-view/active-filter-view-mutation.ts"),B=n("../spread-sheet/src/core/behavior/request/workbook/filterUtils/handleFilterRange.ts"),z=n("../spread-sheet/src/core/app/tool.ts"),H=n("../spread-sheet/src/external/view/ui-layer/filter/filter-feature.tsx"),Y=n("../spread-sheet/src/core/view/level-2/filter-view-center/manager/url-util.ts"),q=function(){function e(e){var t=this;this.showFilterView=function(e){var n=t.spreadsheet.activeSheet.filterViewManager.getFilterViewByViewId(e);n&&((0,M.fT)(),t.requestApi.activeFilterView({filterViewId:e,sheetId:n.sheetId}).then(t.updateWorkbenchFilterViewMenuItem).then((function(){return(0,Y.w)(n.sheetId,e)})))},this.hideFilterView=function(){t.onHideFilterView()},this.addFilterView=function(){if(t.sheetStatus.canEdit){var e=(0,u.Ay)();(0,M.TV)();var r=t.spreadsheet.activeSheet.getSheetId();t.requestApi.addFilterView({sheetId:r,filterViewName:(0,u.i2)(t.spreadsheet),filterViewId:e,creatorId:(0,u.WN)()}).then((function(){t.updateWorkbenchFilterViewMenuItem(),t.spreadsheet.activeSheet.isLoaded||t.spreadsheet.parent.sheetStatus.frozenStatus.isActive||t.spreadsheet.parent.permissions.activeFrozen((function(){var e;null===(e=n.g.log)||void 0===e||e.log("表未加载完进入筛选视图不可编辑")}))})).then((function(){return(0,Y.w)(r,e)})).catch((function(e){return n.g.log.error("筛选视图 - 新建筛选视图失败",e)})),t.checkRangeCanFilter()&&t.requestApi.setBasicFilter()}},this.onExitFilterView=function(){(0,M.Oh)();var e=t.spreadsheet.activeSheetId;t.requestApi.activeFilterView({sheetId:e,filterViewId:""}).then(t.updateWorkbenchFilterViewMenuItem).then((function(){return(0,Y.w)(e,"")})).catch((function(e){return n.g.log.error("onExitFilterView error",e)}))},this.getFilterViewBarHeight=function(){if((0,u.xJ)(t.spreadsheet)){var e=document.getElementById("filter-view-center");return null===e||void 0===e?void 0:e.getBoundingClientRect().height}return 0},this.onDeleteFilterView=function(e){var r=t.spreadsheet.activeSheetId;t.requestApi.deleteFilterView({sheetId:r,filterViewIds:[e]}).then(t.updateWorkbenchFilterViewMenuItem).then((function(){return(0,Y.w)(r,"")})).catch((function(e){return n.g.log.error("onDeleteFilterView error",e)}))},this.updateWorkbenchFilterViewMenuItem=function(){L.Am.get(H.FilterFeature).updatePcFilterViewMenu()},this.checkRangeCanFilter=function(){var e=t.spreadsheet.parent.view.getSelection(),n=e.rangeSelections[e.rangeSelections.length-1],r=t.spreadsheet.activeSheet;return!(!n||!(0,B.st)(r,n))},this.subscribeSwitchSheet=function(){z.Z.event.sheetsBar.listen("switchSheetEnd",t.handleSwitchSheet),z.Z.event.sheetsBar.listen("deleteSheetEnd",t.handleSwitchSheet)},this.handleSwitchSheet=function(){var e=t.spreadsheet.activeSheet.filterViewManager.getActiveFilterView(),n=t.spreadsheet.activeSheet.getSheetId();e?(t.onShowFilterView(),(0,Y.w)(n,e.filterViewId)):(t.onHideFilterView(),(0,Y.w)(n,"")),t.updateWorkbenchFilterViewMenuItem()},this.onActiveFilterViewMutation=function(e){e.filterViewId?t.onShowFilterView():t.hideFilterView()},this.onUpdateViewTopBar=function(e){(t.spreadsheet.activeSheet.filterViewManager.getActiveFilterView()||(null===e||void 0===e?void 0:e.filterViewId))&&t.onUpdateFilterViewBar()},this.onDeleteFilterViewMutation=function(e){var n=e.filterViewId;if(t.spreadsheet.activeSheet.filterViewManager.getActiveFilterViewId()===n){t.hideFilterView();var r=new U.Z({sheetId:t.spreadsheet.activeSheetId,filterViewId:""});t.spreadsheet.parent.mutationBehavior.applyMutation(r,{isLocal:!0})}else t.onUpdateFilterViewBar()},this.spreadsheet=e.spreadsheet,this.requestApi=e.requestApi,this.resize=e.resize,this.sheetStatus=e.sheetStatus,this.subscribeMutationRun(),this.subscribeSwitchSheet()}var t=e.prototype;return t.hideForScroll=function(){},t.showForScroll=function(){},t.onShowFilterView=function(){},t.onHideFilterView=function(){},t.onUpdateFilterViewBar=function(){},t.subscribeMutationRun=function(){var e=this,t=this.spreadsheet.parent.mutationBehavior;t.emitter.addListener(t.EVENT.AFTER_MUTATION_RUN,(function(t){var n=t.mutation;switch(n.id){case D.ZP.ADD_FILTER_VIEW_MUTATION:e.updateWorkbenchFilterViewMenuItem();break;case D.ZP.ACTIVE_FILTER_VIEW_MUTATION:e.onActiveFilterViewMutation(n),e.updateWorkbenchFilterViewMenuItem();break;case D.ZP.DEFINE_FILTER_MUTATION:case D.ZP.DELETE_FILTER_MUTATION:case D.ZP.UPDATE_FILTER_MUTATION:case D.ZP.INSERT_DIMENSION_MUTATION:case D.ZP.DELETE_DIMENSION_MUTATION:case D.ZP.UPDATE_FILTER_VIEW_MUTATION:e.onUpdateViewTopBar(n),e.updateWorkbenchFilterViewMenuItem();break;case D.ZP.DELETE_FILTER_VIEW_MUTATION:e.onDeleteFilterViewMutation(n),e.updateWorkbenchFilterViewMenuItem()}}))},e}(),W=n("../packages/common-utils/src/index.ts"),X=function(e){function t(t){var n;return(n=e.call(this,t)||this).isInit=!1,n.pcFilterViewBar=m().createRef(),n.onShowFilterView=function(){n.isInit||n.initComponent(),n.container.style.display="block",n.onUpdateFilterViewBar(),n.resize.resize()},n.onHideFilterView=function(){n.container&&(n.container.style.display="none",n.resize.resize())},n.onUpdateFilterViewBar=function(){var e,t=n.spreadsheet.activeSheet.filterViewManager.getActiveFilterView();t&&(null===(e=n.pcFilterViewBar.current)||void 0===e||e.updateFilterViewState(t,n.spreadsheet.activeSheet.getFilterViewsInSheet()))},n.initComponent=function(){n.container=document.createElement("div");var e=document.querySelector("#mainContainer");n.container.setAttribute("id","filter-view-center");var t=n.spreadsheet.activeSheet.filterViewManager.getActiveFilterView();g().render(m().createElement(O,{ref:n.pcFilterViewBar,sheetStatus:n.sheetStatus,activeFilterView:t,filterViews:n.spreadsheet.activeSheet.getFilterViewsInSheet(),app:n.spreadsheet.parent,onDeleteFilterView:n.onDeleteFilterView,onExitFilterView:n.onExitFilterView,onCreateFilterView:n.addFilterView,onActiveFilterView:n.showFilterView,onUpdateFilterView:n.onUpdateFilterView,onUpdateRange:n.onUpdateRange}),n.container),null===e||void 0===e||e.insertBefore(n.container,document.getElementById("mainEditor")),n.isInit=!0},n.onUpdateFilterView=function(e){var t=n.spreadsheet.activeSheet.filterViewManager.getActiveFilterView();return t.getFilterViewName()===e?Promise.resolve():n.spreadsheet.activeSheet.getFilterViewsInSheet().some((function(t){return t.getFilterViewName()===e}))?(C.Modal.confirm({content:v.ZP.t("已存在相同视图名称, 修改名称失败"),okText:v.ZP.t("确定"),cancelText:v.ZP.t("取消")}),Promise.reject()):n.requestApi.updateFilterView({sheetId:n.spreadsheet.activeSheetId,filterViewId:t.filterViewId,filterViewName:e}).then(n.updateWorkbenchFilterViewMenuItem)},n.onUpdateRange=function(e){var t=n.spreadsheet.activeSheet.filterViewManager.getActiveFilterView().getBasicFilter();if(t){var r=t.sheetReference.getSheetId(),i=t.filterViewReference.filterViewId,o=t.range,s=(0,y.hex2Range)(e,r);return s.equal(o)?Promise.resolve():n.requestApi.updateFilterRange({sheetId:r,filterViewId:i,range:s})}return n.requestApi.setBasicFilter()},n.subscribeOpenPage(),t.spreadsheet.parent.event.network.listen("changeFullMemberStatus",n.onUpdateFilterViewBar),n}return(0,i.Z)(t,e),t.prototype.subscribeOpenPage=function(){var e=(0,W.IZ)("fv"),t=this.sheetStatus.canEdit;e&&t&&this.showFilterView(e)},t}(q),Q=function(e){function t(t){var n;return(n=e.call(this,t)||this).viewManager=new X({spreadsheet:n.spreadsheet,requestApi:n.requestApi,resize:n.resize,sheetStatus:n.sheetStatus}),n}return(0,i.Z)(t,e),t}(h)},"../spread-sheet/src/core/view/level-2/history-review/HistoryReviewCenter.pc.tsx":function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return x}});var r=n("../node_modules/@babel/runtime/helpers/esm/inheritsLoose.js"),i=n("react"),o=n.n(i),s=n("react-dom"),a=n.n(s),c=n("../node_modules/i18next/dist/esm/i18next.js"),l=n("../node_modules/@tencent/dui/lib/components/Snackbar/index.js"),u=function(e){function t(){return e.apply(this,arguments)||this}return(0,r.Z)(t,e),t}(o().PureComponent),d=n("../packages/report/src/index.ts"),h=function(e){function t(t){var n;return(n=e.call(this,t)||this).notCloseHandler=!1,n.onFinishLoading=function(e,t){0===t&&(e=0),n.setState({isLoading:!1,totalCount:t,currentIndex:e})},n.handleClickNext=function(){n.resetNotCloseHandler();var e=n.state,t=e.currentIndex,r=e.totalCount,i=n.props,o=i.onNextSheet,s=i.onChangeIndex;if(0===r)return o();t+1<r?(n.setState({currentIndex:t+1}),s(t+1)):o(),d.ZP.kvrOss({itemname:"xls_seechange_next"})},n.handleClickLast=function(){n.resetNotCloseHandler();var e=n.state,t=e.currentIndex,r=e.totalCount,i=n.props,o=i.onLastSheet,s=i.onChangeIndex;if(0===r)return o();t-1>=0?(n.setState({currentIndex:t-1}),s(t-1)):o(),d.ZP.kvrOss({itemname:"xls_seechange_last"})},n.resetNotCloseHandler=function(){n.notCloseHandler=!0,setTimeout((function(){n.notCloseHandler=!1}),0)},n.handleClose=function(){n.notCloseHandler||(n.setState({isClose:!0}),n.props.onClose())},n.state={currentIndex:0,totalCount:0,isClose:!1,isLoading:!0},n}return(0,r.Z)(t,e),t.prototype.render=function(){var e=this.props.container,t=this.state,n=t.currentIndex,r=t.totalCount,i=t.isLoading;if(t.isClose)return null;if(i)return o().createElement(l.default,{containerDom:e,type:"loading",visible:i},c.ZP.t("正在加载历史内容...")," ");var s=[{text:0===r||n<=0?c.ZP.t("上张表"):c.ZP.t("上一处"),onClick:this.handleClickLast},{text:0===r||n>=r-1?c.ZP.t("下张表"):c.ZP.t(" 下一处"),onClick:this.handleClickNext}];return 0===r?o().createElement(l.default,{containerDom:e,action:s,onClose:this.handleClose,closable:!0,visible:!0},c.ZP.t("当前工作表没有修改内容")):o().createElement(l.default,{containerDom:e,action:s,onClose:this.handleClose,closable:!0,visible:!0},c.ZP.t("正在查看当前工作表修改内容 ("),n+1,"/",r,")")},t}(u),f=(n("../node_modules/regenerator-runtime/runtime.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.promise.js"),n("../packages/common-utils/src/index.ts")),m=n("../spread-sheet/src/external/editNotify/VisitedVersionStore.ts"),p=n("../node_modules/@tencent/docs-user-agent/dist/index.js"),g=n.n(p),v=n("../spread-sheet/src/base/index.ts"),w=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{c(r.next(e))}catch(t){o(t)}}function a(e){try{c(r.throw(e))}catch(t){o(t)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))},x=function(e){function t(t){return e.call(this,t)||this}(0,r.Z)(t,e);var n=t.prototype;return n.showHistoryToast=function(){this.toastRef=o().createRef(),a().render(o().createElement(h,{ref:this.toastRef,container:this.toastContainer,onChangeIndex:this.handleChangeIndex,onLastSheet:this.handleLastSheet,onNextSheet:this.handleNextSheet,onClose:this.handleClose}),this.toastContainer)},n.showEntryToast=function(){},t}(function(){function e(e){var t=this;this.CONTAINER_NAME="history-review-container",this.enterDiffView=function(e,n){return w(t,void 0,void 0,regeneratorRuntime.mark((function t(){var r,i=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return v.Z.event.view.trigger("toggleDiffView",!0),t.next=3,this.historyWrapper.getInstance();case 3:r=t.sent,this.viewRange={from:e,to:n},this.toastContainer=document.createElement("div"),this.toastContainer.id=this.CONTAINER_NAME,this.toastContainer.className=this.CONTAINER_NAME,document.body.append(this.toastContainer),r.showVersionDiffPage(this.viewRange.from,this.viewRange.to),r.onLoadSheetHistory((function(e){var t,n,o=e.highlightAreaCount;"last"===i.direction?(null===(t=i.toastRef.current)||void 0===t||t.onFinishLoading(o-1,o),r.focusOn(o-1)):(null===(n=i.toastRef.current)||void 0===n||n.onFinishLoading(0,o),r.focusOn(0))})),this.store.setVersion(this.viewRange.to),setTimeout((function(){i.showHistoryToast()}),0);case 13:case"end":return t.stop()}}),t,this)})))},this.handleChangeIndex=function(e){return w(t,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.historyWrapper.getInstance();case 2:t.sent.focusOn(e);case 3:case"end":return t.stop()}}),t,this)})))},this.handleLastSheet=function(){return w(t,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.direction="last",e.next=3,this.historyWrapper.getInstance();case 3:e.sent.lastSheet();case 4:case"end":return e.stop()}}),e,this)})))},this.handleNextSheet=function(){return w(t,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.direction="next",e.next=3,this.historyWrapper.getInstance();case 3:e.sent.nextSheet();case 4:case"end":return e.stop()}}),e,this)})))},this.handleClose=function(){return w(t,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a().unmountComponentAtNode(this.toastContainer),e.next=3,this.historyWrapper.getInstance();case 3:e.sent.hideVersionDiffPage(),v.Z.event.view.trigger("toggleDiffView",!1);case 5:case"end":return e.stop()}}),e,this)})))},this.spreadsheet=e.spreadsheet,this.historyWrapper=e.history,this.messageCenter=e.messageCenter,this.store=new m.g(this.spreadsheet.getSpreadsheetId()),this.initHistory()}var t=e.prototype;return t.initHistory=function(){return w(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.parseHistoryRange()){e.next=3;break}return e.abrupt("return");case 3:return e.next=5,this.enterDiffView(t.from,t.to);case 5:g().isPC?d.ZP.kvrOss({itemname:"xls_open_editcard_pc "}):d.ZP.kvrOss({itemname:"xls_open_editcard_m "});case 6:case"end":return e.stop()}}),e,this)})))},t.parseHistoryRange=function(){var e=this.store.getVersion(),t=this.messageCenter.messageCenter.versionManager.getCurrentVersion(),n=(0,f.IZ)("begin_rev"),r=(0,f.IZ)("end_rev");if(!n||!r)return null;var i=parseInt(r,10),o=parseInt(n,10),s="1"===(0,f.IZ)("edit_open"),a=s?i:t,c=Math.max(0,o,a-100);return s||e<a?{from:c,to:a}:null},e}())},"../spread-sheet/src/core/view/level-2/render-plugin/BaseRenderPlugin.ts":function(e,t,n){"use strict";var r=n("../packages/lib/EventEmitter.ts");t.Z=function(e){this.emitter=new r.Z,this._alloyExcel=e.alloyExcel}},"../spread-sheet/src/core/view/level-2/select-highlight/select-rowcol-highlight-render-plugin.ts":function(e,t,n){"use strict";n.r(t);var r=n("../node_modules/@babel/runtime/helpers/esm/inheritsLoose.js"),i=(n("../node_modules/core-js/modules/es.array.from.js"),n("../node_modules/core-js/modules/es.string.iterator.js"),n("../node_modules/core-js/modules/web.dom-collections.for-each.js"),n("../node_modules/core-js/modules/es.array.filter.js"),n("../spread-sheet/src/core/view/level-1/select-center/base/selection/CellSelection.ts")),o=n("../spread-sheet/src/core/view/utils/base-func.ts"),s=n("../spread-sheet/src/core/view/level-2/render-plugin/BaseRenderPlugin.ts"),a=n("../packages/model/src/cell/format/colorUtils.ts"),c=n("../spread-sheet/src/base/index.ts"),l=n("../packages/report/src/index.ts"),u=function(e){function t(t){var n;return(n=e.call(this,t)||this).renderAfterArea=function(e){if(n.selectedGridRange&&n.highlight)for(var t=e.fromCol,r=e.fromRow,i=e.toCol,o=e.toRow,s=n.calcHighlightCells(t,r,i,o),a=0;a<s.length;a++)for(var c=0;c<s[a].length;c++)1===s[a][c]&&n.renderRect(a+r,c+t)},n.handleSelectionChange=function(){n.highlight&&(n.selectedGridRange=n.normalSelectData.selectQueue,n.renderApi.renderNextTick())},n.changeStatus=function(e){n.highlight=e.status,n.background=n.colorTransform(e.color),e.status&&(n.selectedGridRange=n.normalSelectData.selectQueue),n.renderApi.renderNextTick(),l.ZP.kvrOss({itemname:"xls_highlight_"+(n.highlight?"on":"off")})},n.colorTransform=function(e){var t=(0,a.hex2rgba)(e);return"rgba("+t.red+", "+t.green+", "+t.blue+", "+n.alpha+")"},n.selectRowColHighlightCollector=t.selectRowColHighlightCollector,n.renderApi=t.renderApi,n.areaData=t.areaData,n.headSize=t.headSize,n.rowcolAccessor=t.rowcolAccessor,n.selectedGridRange=t.normalSelectData.selectQueue,n.highlight=!1,n.background="rgba(62, 200, 125, 0.17)",n.normalSelectData=t.normalSelectData,n.alpha=.4,n._alloyExcel.onAfterAreaRender(n.renderAfterArea),n.normalSelectData.onModifySelectData(n.handleSelectionChange),c.Z.event.sheetsBar.listen("updateHighlightMode",n.changeStatus),n}(0,r.Z)(t,e);var n=t.prototype;return n.calcHighlightCells=function(e,t,n,r){var o,s=this,a=Array.from({length:r-t+1},(function(){return Array.from({length:n-e+1},(function(){return 0}))}));return null===(o=this.selectedGridRange)||void 0===o||o.filter((function(e){return e instanceof i.Z})).forEach((function(i){var o=i.selectAll,c=i.selectCol,l=i.selectRow;if(!(o||c||l)){var u=i.yRange,d=u[0],h=u[1],f=i.xRange,m=f[0],p=f[1];s.rowScan({startRowIndex:d,fromRow:t,endRowIndex:h,toRow:r,fromCol:e,toCol:n,startColIndex:m,endColIndex:p,cellsArray:a}),s.colScan({startColIndex:m,fromCol:e,endColIndex:p,toCol:n,fromRow:t,toRow:r,startRowIndex:d,endRowIndex:h,cellsArray:a})}})),a},n.colScan=function(e){for(var t=e.startColIndex,n=e.fromCol,r=e.endColIndex,i=e.toCol,o=e.fromRow,s=e.toRow,a=e.startRowIndex,c=e.endRowIndex,l=e.cellsArray,u=Math.max(t,n),d=Math.min(r,i);u<=d;u++)for(var h=o;h<=s;h++)if(!(h>=a&&h<=c)){var f=h-o,m=u-n;f>=0&&f<l.length&&m>=0&&m<l[f].length&&(l[f][m]=1)}},n.rowScan=function(e){for(var t=e.startRowIndex,n=e.fromRow,r=e.endRowIndex,i=e.toRow,o=e.fromCol,s=e.toCol,a=e.startColIndex,c=e.endColIndex,l=e.cellsArray,u=Math.max(t,n),d=Math.min(r,i);u<=d;u++)for(var h=o;h<=s;h++)if(!(h>=a&&h<=c)){var f=u-n,m=h-o;f>=0&&f<l.length&&m>=0&&m<l[f].length&&(l[f][m]=1)}},n.renderRect=function(e,t){if(!this.rowcolAccessor.isRowHidden(e)&&!this.rowcolAccessor.isColHidden(t)){var n=this.areaData.getViewLeftByCol(t),r=this.rowcolAccessor.getColSetWidth(t),i=this.areaData.getViewTopByRow(e),s=this.rowcolAccessor.getRowDisplayHeight(e),a=n+this.headSize.rowHeadWidth,c=i+this.headSize.colHeadHeight;r<=0||s<=0||this.selectRowColHighlightCollector.collect({color:this.background,graphicsInfo:{path:(0,o.j9)(a,c,r,s)}})}},t}(s.Z);t.default=u},"../spread-sheet/src/external/editNotify/VisitedVersionStore.ts":function(e,t,n){"use strict";n.d(t,{g:function(){return r}}),n("../node_modules/core-js/modules/es.array.slice.js"),n("../node_modules/core-js/modules/es.array.find-index.js"),n("../node_modules/core-js/modules/es.array.splice.js");var r=function(){function e(e){this.STORE_KEY_PREFIX="SHEET_READED_VERSION",this.MAX_STORE_ITEM=20,this.docId=e}var t=e.prototype;return t.setVersion=function(e){var t=this.getVersionItems();t[0][1]=e,n.g.localStorage.setItem(this.STORE_KEY_PREFIX,JSON.stringify(t.slice(0,this.MAX_STORE_ITEM)))},t.getVersion=function(){return this.getVersionItems()[0][1]},t.getVersionItems=function(){var e=this,t=n.g.localStorage.getItem(this.STORE_KEY_PREFIX);try{if(t){var r,i=JSON.parse(t),o=i.findIndex((function(t){return t[0]===e.docId}));return r=o>=0?i.splice(o,1)[0]:[this.docId,0],i.unshift(r),i}}catch(s){}return[[this.docId,0]]},e}()},"../spread-sheet/src/external/errorUI/client.ts":function(e,t,n){"use strict";n.d(t,{$N:function(){return X},Bx:function(){return L},Hd:function(){return ee},I5:function(){return J},ID:function(){return K},OH:function(){return k},Pr:function(){return q},Q9:function(){return A},St:function(){return H},WT:function(){return P},Y6:function(){return D},YZ:function(){return T},Y_:function(){return V},g$:function(){return $},hn:function(){return G},i9:function(){return N},iZ:function(){return z},jr:function(){return W},qe:function(){return j},sQ:function(){return U},uZ:function(){return Q},wM:function(){return Y},wc:function(){return M},x4:function(){return Z}}),n("../node_modules/regenerator-runtime/runtime.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.promise.js"),n("../node_modules/core-js/modules/es.array.join.js"),n("../node_modules/core-js/modules/es.array.find.js"),n("../node_modules/core-js/modules/es.function.name.js"),n("../node_modules/core-js/modules/es.array.slice.js"),n("../node_modules/core-js/modules/es.object.assign.js");var r=n("../node_modules/i18next/dist/esm/i18next.js"),i=n("../node_modules/lodash/once.js"),o=n.n(i),s=n("../node_modules/@tencent/dui/lib/components/Modal/index.js"),a=n("../node_modules/@tencent/dui/lib/components/Snackbar/index.js"),c=n("../spread-sheet/src/external/errorUI/utils.ts"),l=n("../spread-sheet/src/base/event/event.ts"),u=n("../spread-sheet/src/external/offline-edit/clear-type.ts"),d=n("../packages/report/src/index.ts"),h=n("../spread-sheet/src/external/errorUI/collector.ts"),f=n("../node_modules/@tencent/docs-user-agent/dist/index.js"),m=n.n(f),p=n("../packages/common-utils/src/index.ts"),g=n("../spread-sheet/src/core/login/index.ts"),v=n("../spread-sheet/src/external/feedback/supportpage.ts"),w=n("../node_modules/@tencent/dui-mobile/lib/components/Toast/index.js"),x=n("../spread-sheet/src/core/data/configService/spreadConfig.ts"),C=n("../spread-sheet/src/core/app/utils.ts"),E=n("../spread-sheet/src/base/error/error-code-report.ts"),b=n("../spread-sheet/src/core/view/level-2/collab-center-ent/utils.ts"),_=(n("../spread-sheet/src/base/util/domain-config.ts"),n("../spread-sheet/src/base/index.ts")),y=n("../spread-sheet/src/core/view/spreadsheet-view/model/line-engine/split.ts"),S=n("../spread-sheet/src/base/util/appConfig.ts"),I=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{c(r.next(e))}catch(t){o(t)}}function a(e){try{c(r.throw(e))}catch(t){o(t)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))},R=m().isMobilePhone?10:20,F={offline:{mobile:r.ZP.t("网络异常，编辑内容会在网络恢复后同步。"),pc:[r.ZP.t("网络异常，离线"),r.ZP.t("中，文档最新内容会在网络恢复后同步。")]},editCannotSave:[r.ZP.t("编辑内容暂无法保存"),r.ZP.t("。")],fileNotExist:{mobile:r.ZP.t("文件已被创建者删除，内容无法上传。为防止内容丢失，请将刚刚编辑的内容复制粘贴到本地进行备份，再点击刷新。"),pc:r.ZP.t("文件已被创建者删除，内容无法上传。为防止内容丢失，请将刚刚编辑的内容复制粘贴到本地或导出文件进行备份，再点击刷新。")},loginExpired:[r.ZP.t("登录过期，请重新登录"),r.ZP.t("。")],unAuth:{rangeAuth:r.ZP.t("所在行列包含保护范围，暂不支持此操作。"),mobileAuth:r.ZP.t("权限变化，编辑内容暂无法保存。"),commonAuth:[r.ZP.t("你在当前文档的权限已变更"),r.ZP.t("。")]},bigData:r.ZP.t("数据量较大，操作不成功"),security:[r.ZP.t("此内容因违规无法编辑"),r.ZP.t("。")],duplicateSheet:{actions:{insertNewSheet:r.ZP.t("新建工作表"),moveSheet:r.ZP.t("移动工作表"),copySheetById:r.ZP.t("创建副本"),deleteSheet:r.ZP.t("删除工作表"),renameSheet:r.ZP.t("重命名工作表")},message:r.ZP.t("失败，我们对此表示抱歉。可尝试刷新页面或联系我们反馈问题，我们将尽快为你修复。")},permissionChange:r.ZP.t("你在此文档的权限已发生变化。"),privateFilter:r.ZP.t("查看权限下筛选仅自己可见。"),collaborateFilter:r.ZP.t("有"+b.PJ+"覆盖了你的筛选"),filterChange:{actions:[r.ZP.t("筛选"),r.ZP.t("排序")],message:[r.ZP.t("有"+b.PJ),r.ZP.t("了内容。")]},shutDown:[r.ZP.t("表格遇到错误，请刷新页面后重试"),r.ZP.t("。")],offlineData:[r.ZP.t("离线数据同步失败，请连接网络后刷新"),r.ZP.t("。")],crashFeedBack:[r.ZP.t("加载表格时遇到未知错误，我们对此表示抱歉，可尝试刷新页面或联系我们反馈问题，我们将尽快为你修复"),r.ZP.t("。")],databaseError:r.ZP.t("表格离线数据处理遇到错误，请刷新页面后重试。"),serverConnect:[r.ZP.t("暂无法连接到服务器"),r.ZP.t("。")],netOfflineError:[r.ZP.t("暂无法连接到服务器，且离线编辑不可用，请检查网络后重试"),r.ZP.t("。")]};function T(e,t,n){if(void 0===e&&(e=!0),!m().isTencentDocsApp||!m().isTencentDocsAppVersionAboveOrEqual("2.2.0")||!m().isAndroidPad&&!m().isIPad){var i,o=e?r.ZP.t("编辑"):r.ZP.t("查看"),s=F.offline.pc.join(o);return i=a.default.show({id:n,message:s,style:{zIndex:10003},autoClose:!1,closable:!0}),t&&t(i),h.e.doms.push(i),(0,E.V)({errorCode:n,message:"errorUI-client-showNetworkOfflineTip()",snackbarMsg:s,tipsCustom:{upid:x.q.getConfig("upid")}}),i}}function P(e){var t=F.editCannotSave.join("("+e+")"),n=a.default.show({id:e,message:t,type:"error",style:{zIndex:10003},autoClose:!1,onClose:function(){return!0},action:[{text:r.ZP.t("如何处理"),onClick:function(){return(0,c.vT)(e),!1}}]});(0,E.V)({errorCode:e,message:"errorUI-client-showSaveFrontEndErrorTip()",snackbarMsg:t,tipsCustom:{upid:x.q.getConfig("upid")}}),h.e.doms.push(n)}function A(e){var t=F.fileNotExist.pc,n=F.editCannotSave.join("("+e+")"),i=a.default.show({id:e,message:n,type:"error",style:{zIndex:10003},autoClose:!1,onClose:function(){return!0},action:[{text:r.ZP.t("如何处理"),onClick:function(){return(0,c.vT)(e,!1,!1,t),!1}}]});(0,E.V)({errorCode:e,message:"errorUI-client-showFileNotExsitErrorTip()",snackbarMsg:n,tipsCustom:{upid:x.q.getConfig("upid")}}),h.e.doms.push(i)}function V(e){var t,n=F.loginExpired.join("("+e+")"),i=m().isWxWork,o=a.default.show({id:e,message:n,style:{zIndex:10003},autoClose:!1,onClose:function(){return!0},action:[{text:i?r.ZP.t("刷新"):r.ZP.t("登录"),onClick:function(){i?location.reload():null===g.Z||void 0===g.Z||g.Z.login()}}]});null===(t=window.tdocs)||void 0===t||t.log({message:"[NETWORK WS ERROR TIPS]: 登录态过期(errorCode:"+e+")",level:"error"}),(0,E.V)({errorCode:e,message:"errorUI-client-showLoginExpiredTip()",snackbarMsg:n,tipsCustom:{upid:x.q.getConfig("upid")}}),h.e.doms.push(o)}function Z(e){var t,i;l.ZP.spreadsheetEvent.trigger("clearOfflineStore",{type:u.N.ALL}),null===(i=null===(t=n.g.SpreadsheetApp.messageCenter)||void 0===t?void 0:t.localUserChangeManager)||void 0===i||i.clearAllUserChangeQueue();var o="40203"===e,s=F.unAuth.rangeAuth+"("+e+")",c=(F.unAuth.mobileAuth,F.unAuth.commonAuth.join("("+e+")")),d=o?s:c,f=a.default.show({id:e,message:d,type:o?"info":"error",style:{zIndex:10003},autoClose:!1,closable:o,onClose:o?function(){return!0}:function(){return!1},action:[{text:r.ZP.t("刷新"),onClick:function(){return o&&(n.g.refreshReason=C.QU),location.reload(),!1}}]});(0,E.V)({errorCode:e,message:"errorUI-client-showUnAuthTip()",snackbarMsg:d,tipsCustom:{upid:x.q.getConfig("upid")}}),h.e.doms.push(f)}function j(e,t){void 0===t&&(t=F.bigData);var n=a.default.show({id:e,message:t,type:"info",style:{zIndex:10003,height:"auto",minHeight:"52px"},autoClose:!1,closable:!0,onClose:function(){return d.ZP.tdwReport({module:"excel_tips",opername:"doc_excel_editor",action:"excel_tips_copypaste_click"}),!0},action:[{text:r.ZP.t("如何处理"),onClick:function(){return(0,c.vT)(e),!1}}]});h.e.doms.push(n),d.ZP.tdwReport({module:"excel_tips",opername:"doc_excel_editor",action:"excel_tips_copypaste_view"}),(0,E.V)({errorCode:e,message:"errorUI-client-showBigDataFromFrontTip()",snackbarMsg:t,tipsCustom:{upid:x.q.getConfig("upid")}})}function k(e){var t=F.security.join("("+e+")"),n=a.default.show({id:e,message:t,type:"error",style:{zIndex:10003},autoClose:!1,onClose:function(){return!0},action:[{text:r.ZP.t("了解详情"),onClick:function(){window.open("https://"+S.Z.getConfig("runtime.domainName")+"/doc/DWE9lbGhWTU9OV2VF","_blank")}}]});h.e.doms.push(n),(0,E.V)({errorCode:e,message:"errorUI-client-showSecurityTip()",snackbarMsg:t,tipsCustom:{upid:x.q.getConfig("upid")}})}function N(e,t){var n,i=F.duplicateSheet.actions[t]+F.duplicateSheet.message;n=s.default.confirm({title:r.ZP.t("系统消息"),content:i,okText:r.ZP.t("联系我们"),onOk:function(){window.open(S.Z.getConfig("links.feedback")+"?customInfo="+e,"_blank")},cancelText:r.ZP.t("刷新"),onCancel:function(){window.location.reload()},onClose:function(){window.location.reload()}}),h.e.doms.push(n),(0,E.V)({errorCode:e,message:"errorUI-client-showSheetBarDuplicateSheetId()",snackbarMsg:i,tipsCustom:{upid:x.q.getConfig("upid")}})}function M(e){var t,i;if(l.ZP.spreadsheetEvent.trigger("clearOfflineStore",{type:u.N.ALL}),null===(i=null===(t=n.g.SpreadsheetApp.messageCenter)||void 0===t?void 0:t.localUserChangeManager)||void 0===i||i.clearAllUserChangeQueue(),!n.g.__alreadyShowPermissionChangesTip){n.g.__alreadyShowPermissionChangesTip=!0;var o=F.permissionChange,s=a.default.show({id:e,message:o,style:{zIndex:10003},autoClose:!1,onClose:function(){return!0},action:[{text:r.ZP.t("刷新"),onClick:function(){window.location.reload()}}]});h.e.doms.push(s),(0,E.V)({errorCode:e,message:"errorUI-client-showPermissionChangesTip()",snackbarMsg:o,tipsCustom:{upid:x.q.getConfig("upid")}})}}function O(e){var t=x.q.getConfig("userId"),n=x.q.getConfig("userName");if(e===t)return n;var r=(x.q.getConfig("invitedUserInfos")||[]).find((function(t){return t.userId===e}));return null===r||void 0===r?void 0:r.name}var L=o()((function(){var e=F.privateFilter;a.default.show({message:e,zIndex:10003,autoClose:!0,id:"local_filter"})}));function D(){var e=F.collaborateFilter;a.default.show({message:e,zIndex:10003,action:r.ZP.t("好的"),autoClose:!1})}function U(e,t,n){var i=O(t),o=e?F.filterChange.actions[0]:F.filterChange.actions[1],s=F.filterChange.message.join(o),c="";i&&(c=i.length>R?"「"+function(e,t){if(_.Z.util.string.hasEmojiCharacter(e)){var n=new y.eE(e)._emojiString._match;return n.length>t?n.slice(0,t).join("")+"...":n.join("")}return e.substr(0,t)+"..."}(i,R)+"」":"「"+i+"」"),c&&(s=c+o+F.filterChange.message[1]);var l=a.default.show({message:s,zIndex:10003,autoClose:!1,action:r.ZP.t("好的"),onClickAction:function(){n(),d.ZP.tdwReport({opername:"doc_filter",module:"doc_filter_guest",action:"doc_"+(e?"filter":"rank")+"_guest_confirm",ver11:"pc"})},id:"collab_filter_reorder_tip"});return h.e.doms.push(l),l}var B=null;function z(e,t){return I(this,void 0,void 0,regeneratorRuntime.mark((function n(){var i,o,s;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!B){n.next=5;break}return B.close(),B=null,n.next=5,new Promise((function(e){return setTimeout(e,300)}));case 5:if(t||e){n.next=9;break}return i=r.ZP.t("已取消“筛选对所有人可见”。"),a.default.show({id:"filter-sync-close-tip",className:"filter-sync-close-tip",message:i,zIndex:10003,type:"success"}),n.abrupt("return");case 9:t&&(o=O(t),s=r.ZP.t("{{value0}} {{value1}}“筛选对所有人可见”。",{value0:o?"「"+(o.length>R?o.substr(0,R)+"...":o)+"」":"有"+b.PJ,value1:e?"开启":"关闭"}),B=a.default.show(Object.assign({message:s,zIndex:10003},e?{autoClose:!1,action:r.ZP.t("好的"),onClickAction:function(){B=null,d.ZP.tdwReport({opername:"doc_filter",module:"doc_filter_guest",action:"doc_filter_guest_click",ver11:"pc"})}}:{})),!e&&setTimeout((function(){B=null}),2e3));case 10:case"end":return n.stop()}}),n)})))}function H(){w.default.show({duration:3e3,content:r.ZP.t("已自动保存"),style:{zIndex:2e4},autoClose:!0})}function Y(){w.default.show({duration:3e3,content:r.ZP.t("保存失败"),style:{zIndex:2e4},autoClose:!0})}function q(e){var t=F.netOfflineError.join("("+e+")"),n=a.default.show({id:e,message:t,style:{zIndex:10003},autoClose:!1,action:[{text:r.ZP.t("刷新"),onClick:function(){window.location.reload()}}]});h.e.doms.push(n),(0,E.V)({errorCode:e,message:"errorUI-client-showNetOfflineErrorTip()",snackbarMsg:t,tipsCustom:{upid:x.q.getConfig("upid")}})}function W(){var e,t;null===(t=null===(e=n.g.CoreSheet)||void 0===e?void 0:e.saveStatus)||void 0===t||t.showSaveTips("offline",null,r.ZP.t("正在离线编辑"),r.ZP.t("正在离线编辑")),(0,p.Ds)((function(){var e,t;null===(t=null===(e=n.g.CoreSheet)||void 0===e?void 0:e.saveStatus)||void 0===t||t.showSaveTips("offline",3e3,r.ZP.t("离线编辑保存成功"),r.ZP.t("离线编辑保存成功"))}),1e3)()}function X(){}function Q(e){var t=F.serverConnect.join("("+e+")"),n=a.default.show({id:e,message:t,style:{zIndex:10003},autoClose:!1,onClose:function(){return!0},action:[{text:r.ZP.t("刷新"),onClick:function(){window.location.reload()}},{text:r.ZP.t("联系我们"),onClick:function(){(0,c.cx)(e)}}]});h.e.doms.push(n),(0,E.V)({errorCode:e,message:"errorUI-client-showServerConnectFailTip()",snackbarMsg:t,tipsCustom:{upid:x.q.getConfig("upid")}})}function G(e){var t=F.shutDown.join(""),n=s.default.confirm({title:r.ZP.t("系统消息"),content:t,okText:r.ZP.t("刷新"),onOk:function(){window.location.reload()},cancelText:r.ZP.t("联系我们"),onCancel:function(){return(0,c.cx)(e),!1}});h.e.doms.push(n),(0,E.V)({errorCode:e,message:"errorUI-client-showCommonErrorModal1()",snackbarMsg:t,tipsCustom:{upid:x.q.getConfig("upid")}})}function $(e){var t=F.databaseError,n=s.default.confirm({title:r.ZP.t("系统消息"),content:t,okText:r.ZP.t("刷新"),onOk:function(){window.location.reload()},cancelText:r.ZP.t("联系我们"),onCancel:function(){return(0,c.cx)(e),!1}});h.e.doms.push(n),(0,E.V)({errorCode:e,message:"errorUI-client-showDatabaseErrorModal()",snackbarMsg:t,tipsCustom:{upid:x.q.getConfig("upid")}})}function K(e){var t=F.crashFeedBack.join(""),n={title:r.ZP.t("系统消息"),content:t,cancelText:null,okText:r.ZP.t("反馈"),onOk:function(){(0,v.nz)()}},i=s.default.confirm(n);h.e.doms.push(i),(0,E.V)({errorCode:e,message:"errorUI-client-showCommonCrashAndFeedBackModal()",snackbarMsg:t,tipsCustom:{upid:x.q.getConfig("upid")}})}function J(e,t){void 0===t&&(t=!1);var n=F.offlineData.join("("+e+")"),i=a.default.show({id:e,message:n,style:{zIndex:10003},autoClose:!1,action:[t?{text:r.ZP.t("如何处理"),onClick:function(){return(0,c.vT)(e),!1}}:{text:r.ZP.t("刷新"),onClick:function(){window.location.reload()}}]});h.e.doms.push(i),(0,E.V)({errorCode:e,message:"errorUI-client-showOfflineSyncError()",snackbarMsg:n,tipsCustom:{upid:x.q.getConfig("upid")}})}function ee(e){var t,n=F.shutDown.join("");return t=s.default.confirm({title:r.ZP.t("系统消息"),content:n,okText:r.ZP.t("刷新"),onOk:function(){window.location.reload()},cancelText:r.ZP.t("联系我们"),onCancel:function(){window.open(S.Z.getConfig("links.feedback")+"?customInfo="+e,"_blank")},onClose:function(){window.location.reload()}}),h.e.doms.push(t),(0,E.V)({errorCode:e,message:"errorUI-client-showDoBehaviorAfterShutDownModal()",snackbarMsg:n,tipsCustom:{upid:x.q.getConfig("upid")}}),t}},"../spread-sheet/src/external/errorUI/collector.ts":function(e,t,n){"use strict";n.d(t,{e:function(){return r}}),n("../node_modules/core-js/modules/web.dom-collections.for-each.js");var r={doms:[],destroy:function(){var e;null===(e=n.g.log)||void 0===e||e.debug("flow errorUICollector destroy()"),this.doms.forEach((function(e){e&&e.close&&e.close()})),this.doms=[]}}},"../spread-sheet/src/external/errorUI/utils.ts":function(e,t,n){"use strict";n.d(t,{cx:function(){return f},vT:function(){return m}});var r=n("../node_modules/i18next/dist/esm/i18next.js"),i=n("../node_modules/@tencent/dui/lib/components/Modal/index.js"),o=n("react"),s=n.n(o);function a(e,t,n){return void 0===n&&(n=!0),s().createElement("div",null,s().createElement("div",null,e),s().createElement("div",{style:{opacity:.4}},n?r.ZP.t("错误码"):r.ZP.t("状态码"),":",t," ",function(){var e=new Date,t=e.getFullYear(),n=e.getMonth()+1<10?"0"+(e.getMonth()+1):e.getMonth()+1,r=e.getDate()<10?"0"+e.getDate():e.getDate();return t+"-"+n+"-"+r}()))}var c=n("../spread-sheet/src/base/event/event.ts"),l=n("../spread-sheet/src/external/offline-edit/clear-type.ts"),u=n("../spread-sheet/src/external/errorUI/collector.ts"),d=n("../spread-sheet/src/external/export/interface.ts"),h=n("../spread-sheet/src/base/util/appConfig.ts");function f(e){window.open(h.Z.getConfig("links.feedback")+"?customInfo="+e,"_blank")}function m(e,t,o,s){var h;void 0===t&&(t=!0),void 0===o&&(o=!0),c.ZP.spreadsheetEvent.trigger("onShowHowToHandleDataLostModal"),h=t?i.default.confirm({maskStyle:{zIndex:10004},title:r.ZP.t("如何处理"),content:a(s||r.ZP.t("为防止内容丢失，请将刚刚编辑的内容复制粘贴到本地或导出文件进行备份，再点击修复。"),e,o),okText:r.ZP.t("导出文件"),onOk:function(){var e;return null===(e=n.g.SpreadsheetApp)||void 0===e||e.getSheetExportManager().then((function(e){return e.export(d.I.xlsxServer)})),!1},cancelText:r.ZP.t("修复"),onCancel:function(){!function(e){var t;t=i.default.confirm({maskStyle:{zIndex:10004},title:r.ZP.t("提示"),content:a(r.ZP.t("修复过程将会清除本地缓存，可能造成部分内容丢失。请确认内容已备份到本地，再开始修复。"),e),okText:r.ZP.t("开始修复"),cancelText:"",onOk:function(){return c.ZP.spreadsheetEvent.trigger("clearOfflineStore",{type:l.N.UN_COMMITTED,callback:function(){window.location.reload()}}),!1},action:r.ZP.t("联系我们"),onClickAction:function(){return f(e),!1},onClose:function(){}}),u.e.doms.push(t)}(e)},action:r.ZP.t("联系我们"),onClickAction:function(){return f(e),!1},onClose:function(){}}):i.default.confirm({maskStyle:{zIndex:10004},title:r.ZP.t("如何处理"),content:a(s||r.ZP.t("为防止数据丢失，请勿刷新或关掉页面。建议先导出文件或将编辑的内容复制粘贴到本地，然后再刷新页面。"),e,o),okText:r.ZP.t("导出文件"),onOk:function(){var e;return null===(e=n.g.SpreadsheetApp)||void 0===e||e.getSheetExportManager().then((function(e){return e.export(d.I.xlsxServer)})),!1},cancelText:r.ZP.t("刷新"),onCancel:function(){window.location.reload()},action:r.ZP.t("联系我们"),onClickAction:function(){return f(e),!1},onClose:function(){}}),u.e.doms.push(h)}},"../spread-sheet/src/external/export/interface.ts":function(e,t,n){"use strict";var r,i;n.d(t,{I:function(){return r},j:function(){return i}}),function(e){e.xlsx="xlsx",e.xlsxServer="xlsxServer",e.xlsxWithFiles="xlsxWithFiles",e.csv="csv"}(r||(r={})),function(e){e[e.LOOP_TIME_OUT=0]="LOOP_TIME_OUT",e[e.QUERY_ERROR_CATCH=1]="QUERY_ERROR_CATCH",e[e.QUERY_ERROR_UNEXPECT=2]="QUERY_ERROR_UNEXPECT",e[e.EXPORT_ERROR_CATCH=3]="EXPORT_ERROR_CATCH",e[e.EXPORT_ERROR_UNEXPECT=4]="EXPORT_ERROR_UNEXPECT"}(i||(i={}))},"../spread-sheet/src/external/feedback/supportpage.ts":function(e,t,n){"use strict";n.d(t,{nz:function(){return v},vt:function(){return w}}),n("../node_modules/regenerator-runtime/runtime.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.promise.js"),n("../node_modules/core-js/modules/es.function.name.js"),n("../node_modules/core-js/modules/es.number.constructor.js"),n("../node_modules/core-js/modules/es.regexp.exec.js"),n("../node_modules/core-js/modules/es.string.replace.js");var r=n("../spread-sheet/src/core/data/configService/spreadConfig.ts"),i=n("../node_modules/@tencent/docs-multi-tools/dist/index.js"),o=n("../node_modules/@tencent/docs-user-agent/dist/index.js"),s=n.n(o),a=n("../spread-sheet/src/core/utils/url.ts"),c=n("../node_modules/@tencent/tencent_doc_open_url/dist/index.js"),l=n("../node_modules/qs/lib/index.js"),u=n.n(l),d=n("../spread-sheet/src/core/feature/relateFormEnt/enterpriseStatus.ts"),h=n("../packages/common-utils/src/index.ts"),f=n("./node_modules/axios/index.js"),m=n.n(f),p=(n("../spread-sheet/src/base/util/domain-config.ts"),n("../spread-sheet/src/base/util/appConfig.ts")),g=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{c(r.next(e))}catch(t){o(t)}}function a(e){try{c(r.throw(e))}catch(t){o(t)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))};function v(){var e,t,o=Number(new Date),l=o-18e5,d=null===(t=null===(e=n.g.log)||void 0===e?void 0:e.report)||void 0===t?void 0:t.call(e,"TUCAO_EXCEL",{query:{startTs:l,endTs:o}}),h=r.q.getConfig("userName"),f=r.q.getConfig("userPic"),m=r.q.getConfig("uid")||"";m?"p"===m.charAt(0)&&(m=m.replace(/p./,"")):m=r.q.getConfig("uin");var g=n.g.location.href;try{g=encodeURIComponent(JSON.stringify({type:"excel",url:n.g.location.href,uid:(0,i.getUid)(),rid:d}))}catch(v){console.warn(v)}!function(e){var t=p.Z.getConfig("links.feedback");if(r.q.getConfig("isLogin"))if(s().isMiniProgram&&!s().isPC){var i=u().stringify({openid:e.openid,nickname:e.nickname,avatar:e.avatar,customInfo:e.customInfo,clientInfo:e.clientInfo}),o=(0,a._)(t,i);n.g.location.href=o}else{var l=document.createElement("form");for(var d in l.id="form",l.name="form",l.style.display="none",s().isMiniProgram&&s().isPC?l.setAttribute("target","_self"):l.setAttribute("target","_blank"),document.body.appendChild(l),e)if(Object.hasOwnProperty.call(e,d)){var h=document.createElement("input");h.type="text",h.name=d,h.value=e[d],l.appendChild(h)}l.method="POST",l.action=t,l.submit(),document.body.removeChild(l)}else{var f=u().stringify({customInfo:encodeURIComponent(n.g.location.href),clientInfo:n.g.navigator.userAgent}),m=(0,a._)(t,f);(0,c.tencentDocOpenUrlForAll)({url:m})}}({openid:m,nickname:h,avatar:f,customInfo:g,clientInfo:n.g.navigator.userAgent})}function w(){var e,t,i,o,a;return g(this,void 0,void 0,regeneratorRuntime.mark((function l(){var u,f,p,g,v,w;return regeneratorRuntime.wrap((function(l){for(;;)switch(l.prev=l.next){case 0:return u=r.q.getConfig("padId"),f=(0,h.IZ)("scode"),(p=new FormData).append("docid",u),p.append("share_code",f),p.append("scence","wedoc"),p.append("svr_type","report"),l.prev=7,l.next=10,m().post("/doc/feedback_to_ww",p);case 10:if(g=l.sent,v=g.data,0===(null===(e=v.head)||void 0===e?void 0:e.ret)){l.next=14;break}throw new Error("request /doc/feedback_to_ww fail, params: docid:"+u+", share_code:"+f);case 14:if(w=null===v||void 0===v?void 0:v.body.return_url){l.next=18;break}throw null===(t=window.tdocs)||void 0===t||t.log({message:"[CGI FAILED]: no url provided, params: docid:"+u+", share_code:"+f,level:"error"}),new Error("request /doc/feedback_to_ww fail, no url provided");case 18:(0,d.n_)()?s().isMobile?null===(o=null===(i=n.g.tdocs)||void 0===i?void 0:i.openUrl)||void 0===o||o.call(i,{url:w,target:3}):null===(a=n.g.tdocs)||void 0===a||a.openInBrowser({url:w}):(0,c.tencentDocOpenUrlForAll)({url:w}),l.next=24;break;case 21:l.prev=21,l.t0=l.catch(7),console.error(l.t0);case 24:case"end":return l.stop()}}),l,null,[[7,21]])})))}},"../spread-sheet/src/external/offline-edit/clear-type.ts":function(e,t,n){"use strict";var r;n.d(t,{N:function(){return r}}),function(e){e.ALL="all",e.COMMITTED="committed",e.UN_COMMITTED="unCommitted"}(r||(r={}))},"../spread-sheet/src/external/view/main/panel/FillterPanel/utils/event.ts":function(e,t,n){"use strict";n.d(t,{Tw:function(){return s},U5:function(){return o},tx:function(){return i}});var r=n("../packages/mutation/src/index.ts");function i(e,t){e.mutationBehavior.emitter.addListener(e.mutationBehavior.EVENT.AFTER_MUTATION_RUN,(function(e){var n=e.mutation;if(n.id===r.xF.SWITCH_FILTER_SYNC_MUTATION){var i=n.isOn;t(i)}}))}function o(e,t,n){if(e.id!==r.xF.DEFINE_FILTER_MUTATION||!t||e.getAffectedSheetId()!==n.spreadsheet.getActiveSheetId())return!1;var i=e.filterViewId;if(n.spreadsheet.activeSheet.getBasicFilterInSheet()&&!i)return!0;var o=n.spreadsheet.activeSheet.getBasicFilterInFilterView();return!(!o||o.filterViewReference.filterViewId!==e.filterViewId)}var s=function(e,t){return e&&t.id===r.xF.DEFINE_FILTER_MUTATION&&t.nonPersistingLocalChange}},"../spread-sheet/src/flow/browser/phase/workbench/workbench-feature-loader-registry.ts":function(e,t,n){"use strict";n.d(t,{P:function(){return r}}),n("../node_modules/core-js/modules/es.array.iterator.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.set.js"),n("../node_modules/core-js/modules/es.string.iterator.js"),n("../node_modules/core-js/modules/esnext.set.add-all.js"),n("../node_modules/core-js/modules/esnext.set.delete-all.js"),n("../node_modules/core-js/modules/esnext.set.difference.js"),n("../node_modules/core-js/modules/esnext.set.every.js"),n("../node_modules/core-js/modules/esnext.set.filter.js"),n("../node_modules/core-js/modules/esnext.set.find.js"),n("../node_modules/core-js/modules/esnext.set.intersection.js"),n("../node_modules/core-js/modules/esnext.set.is-disjoint-from.js"),n("../node_modules/core-js/modules/esnext.set.is-subset-of.js"),n("../node_modules/core-js/modules/esnext.set.is-superset-of.js"),n("../node_modules/core-js/modules/esnext.set.join.js"),n("../node_modules/core-js/modules/esnext.set.map.js"),n("../node_modules/core-js/modules/esnext.set.reduce.js"),n("../node_modules/core-js/modules/esnext.set.some.js"),n("../node_modules/core-js/modules/esnext.set.symmetric-difference.js"),n("../node_modules/core-js/modules/esnext.set.union.js"),n("../node_modules/core-js/modules/web.dom-collections.iterator.js");var r=new(function(){function e(){this.loaders=new Set}var t=e.prototype;return t.addLoader=function(e){this.loaders.add(e)},t.getLoaders=function(){return this.loaders},e}())},"../node_modules/chromatism/dist/chromatism.cjs.js":function(e,t){"use strict";function n(e){return u[e]}function r(e){return d[e]}function i(e){return e*(Math.PI/180)}function o(e,t){return(e%t+t)%t}function s(e,t){return e<t[0]?e=t[0]:e>t[1]&&(e=t[1]),e}function a(e){if(Math.cbrt)return Math.cbrt(e);var t=Math.pow(Math.abs(e),1/3);return e<0?-t:t}function c(e,t,n){if(void 0===t)throw new Error("No value provided");var r=n||function(e){var t=p.find((function(t){return m[t](e)}));if(!t)throw new Error("No type found for color "+e);return t}(t);if(r===e)return t;if(q[r][e])return X(r,e,t);var i=W[r],o="string"==typeof i?i:i[e]||i.default;return c(e,X(r,o,t),o)}function l(e){var t={};return Q.forEach((function(n){Object.defineProperty(t,n,{get:function(){return G(n,e)},enumerable:!0})})),t}var u={A:{X:1.0985*100,Y:100,Z:35.585},B:{X:99.072,Y:100,Z:85.223},C:{X:98.074,Y:100,Z:118.232},D50:{X:96.422,Y:100,Z:82.521},D55:{X:95.682,Y:100,Z:92.149},D65:{X:95.047,Y:100,Z:108.883},D75:{X:94.972,Y:100,Z:122.638},E:{X:100,Y:100,Z:100},F2:{X:.99186*100,Y:100,Z:67.393},F7:{X:95.041,Y:100,Z:108.747},F11:{X:1.00962*100,Y:100,Z:64.35}},d={BRADFORD:[[.8951,.2664,-.1614],[-.7502,1.7135,.0367],[.0389,-.0685,1.0296]],INVERSE_BRADFORD:[[.9869929,-.1470543,.1599627],[.4323053,.5183603,.0492912],[-.0085287,.0400428,.9684867]],SRGB_XYZ:[[.4124,.3576,.1805],[.2126,.7152,.0722],[.0193,.1192,.9505]],INVERSE_SRGB_XYZ:[[3.2406,-1.5372,-.4986],[-.9689,1.8758,.0415],[.0557,-.204,1.057]]},h=function(e,t){var n=new Set(Object.keys(e));return t.every((function(e){return n.has(e)}))},f=function(e,t){return"string"==typeof e&&e.slice(0,t.length)===t},m={hex:function(e){return f(e,"#")},rgb:function(e){return h(e,["r","g","b"])},cssrgb:function(e){return f(e,"rgb(")},hsl:function(e){return h(e,["h","s","l"])},csshsl:function(e){return f(e,"hsl(")},hsv:function(e){return h(e,["h","s","v"])},cmyk:function(e){return h(e,["c","m","y","k"])},yiq:function(e){return h(e,["y","i","q"])},XYZ:function(e){return h(e,["X","Y","Z"])},xyY:function(e){return h(e,["x","y","Y"])},lms:function(e){return h(e,["rho","gamma","beta"])},cielab:function(e){return h(e,["L","a","b"])},cieluv:function(e){return h(e,["L","u","v"])},cielch:function(e){return h(e,["L","C","h"])},hsluv:function(e){return h(e,["hu","s","l"])}},p=Object.keys(m),g=.008856,v=903.3,w=n("D65"),x=function(e){return Math.pow(e,3)>g?Math.pow(e,3):(116*e-16)/v},C={XYZ:function(e){var t=(e.L+16)/116,n=e.a/500+t,r=t-e.b/200,i=x(n),o=x(r),s=e.L>v*g?Math.pow(t,3):e.L/v;return{X:i*w.X,Y:s*w.Y,Z:o*w.Z}}},E={cieluv:function(e){var t=i(e.h),n=e.C*Math.cos(t),r=e.C*Math.sin(t);return{L:e.L,u:n,v:r}},hsluv:function(e){if(e.L>99.9999999)return{hu:e.h,s:0,l:100};if(e.L<1e-8)return{hu:e.h,s:0,l:0};for(var t=(e.L+16)/1560896,n=t>.008856?t:e.L/903.3,o=r("INVERSE_SRGB_XYZ"),s=[],a=0;a<3;a++)for(var c=o[a][0],l=o[a][1],u=o[a][2],d=0;d<2;d++){var h=(284517*c-94839*u)*n,f=(838422*u+769860*l+731718*c)*e.L*n-769860*d*e.L,m=(632260*u-126452*l)*n+126452*d;s.push({m:h/m,b:f/m})}var p=Number.MAX_VALUE,g=i(e.h);s.forEach((function(e){var t=e.b/(Math.sin(g)-e.m*Math.cos(g));t>=0&&(p=Math.min(p,t))}));var v=p;return{hu:e.h,s:e.C/v*100,l:e.L}}},b={XYZ:function(e){var t=n("D65"),r=function(e){return 4*e.X/(e.X+15*e.Y+3*e.Z)}(t),i=function(e){return 9*e.Y/(e.X+15*e.Y+3*e.Z)}(t),o=1/3*(52*e.L/(e.u+13*e.L*r)-1),s=e.L>903.3*.008856?Math.pow((e.L+16)/116,3):e.L/903.3,a=-5*s,c=(s*(39*e.L/(e.v+13*e.L*i)-5)-a)/(o- -1/3);return{X:100*c,Y:100*s,Z:100*(c*o+a)}},cielch:function(e){var t=Math.sqrt(Math.pow(e.u,2)+Math.pow(e.v,2)),n=Math.atan2(e.v,e.u);return n<0&&(n+=2*Math.PI),n=function(e){return e*(180/Math.PI)}(n),{L:e.L,C:t,h:n}}},_=function(e){return{r:255*(1-e.c)*(1-e.k),g:255*(1-e.m)*(1-e.k),b:255*(1-e.y)*(1-e.k)}},y={rgb:_,cssrgb:function(e){var t=_(e),n=t.r,r=t.g,i=t.b;return"rgb("+Math.round(n)+","+Math.round(r)+","+Math.round(i)+")"}},S={hsl:function(e){var t=e.replace(/(hsl\(|\)|%|[\s]*)/g,"").split(",").map((function(e){return parseInt(e,10)}));return{h:t[0],s:t[1],l:t[2]}}},I={rgb:function(e){var t=e.replace(/((rgb\(|\))|[\s]*)/g,"").split(",").map((function(e){return parseInt(e,10)}));return{r:t[0],g:t[1],b:t[2]}}},R={rgb:function(e){var t=e.replace("#","").match(/.{2}/g).map((function(e){return parseInt(e,16)}));return{r:t[0],g:t[1],b:t[2]}}},F={rgb:function(e){if(0===e.s){var t=e.l/100*255;return{r:t,g:t,b:t}}var n,r,i;n=e.l>=50?e.l/100+e.s/100-e.l/100*(e.s/100):e.l/100*(1+e.s/100),r=e.l/100*2-n;var s,a,c,l=(.333+(i=e.h/360))%1,u=i,d=o(i-.333,1);return(s=6*l<1?r+6*(n-r)*l:2*l<1?n:3*l<2?r+6*(.666-l)*(n-r):r)<0&&(s=0),(a=6*u<1?r+6*(n-r)*u:2*u<1?n:3*u<2?r+6*(.666-u)*(n-r):r)<0&&(a=0),(c=6*d<1?r+6*(n-r)*d:2*d<1?n:3*d<2?r+6*(.666-d)*(n-r):r)<0&&(c=0),{r:255*s,g:255*a,b:255*c}},csshsl:function(e){return"hsl("+Math.round(e.h)+","+Math.round(e.s)+"%,"+Math.round(e.l)+"%)"},hsv:function(e){var t=Object.assign({},e,{s:e.s/100,l:e.l/100}),n=t.s*(t.l<.5?t.l:1-t.l);return{h:t.h,s:2*n/(t.l+n)*100,v:100*(t.l+n)}}},T={cielch:function(e){if(e.L>99.9999999)return{L:100,C:0,h:e.hu};if(e.L<1e-8)return{L:0,C:0,h:e.hu};for(var t=(e.l+16)/1560896,n=t>.008856?t:e.l/903.3,o=r("INVERSE_SRGB_XYZ"),s=[],a=0;a<3;a++)for(var c=o[a][0],l=o[a][1],u=o[a][2],d=0;d<2;d++){var h=(284517*c-94839*u)*n,f=(838422*u+769860*l+731718*c)*e.l*n-769860*d*e.l,m=(632260*u-126452*l)*n+126452*d;s.push({m:h/m,b:f/m})}var p=Number.MAX_VALUE,g=i(e.hu);s.forEach((function(e){var t=e.b/(Math.sin(g)-e.m*Math.cos(g));t>=0&&(p=Math.min(p,t))}));var v=p;return{L:e.l,C:v/100*e.s,h:e.hu}}},P={hsl:function(e){var t=Object.assign({},e,{h:e.h/360,s:e.s/100,v:e.v/100});return{h:360*t.h,s:100*((2-t.s)*t.v<1?t.s*t.v/((2-t.s)*t.v):t.s*t.v/(2-(2-t.s)*t.v)),l:(2-t.s)*t.v/2*100}}},A={XYZ:function(e){var t=[e.rho,e.gamma,e.beta],n=r("INVERSE_BRADFORD").map((function(e){return t.reduce((function(t,n,r){return e[r]*n+t}),0)}));return{X:100*n[0],Y:100*n[1],Z:100*n[2]}}},V=function(e){return s(e,[0,255])},Z=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],r=!0,i=!1,o=void 0;try{for(var s,a=e[Symbol.iterator]();!(r=(s=a.next()).done)&&(n.push(s.value),!t||n.length!==t);r=!0);}catch(e){i=!0,o=e}finally{try{!r&&a.return&&a.return()}finally{if(i)throw o}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")},j=.008856,k=n("D65"),N={rgb:function(e){var t=[e.X,e.Y,e.Z].map((function(e){return e/100})),n=r("INVERSE_SRGB_XYZ").map((function(e){return t.reduce((function(t,n,r){return e[r]*n+t}),0)})).map((function(e){return e<=.0031308?12.92*e:1.055*Math.pow(e,1/2.4)-.055})).map((function(e){return 255*e})),i=Z(n,3);return function(e){return{r:V(e.r),g:V(e.g),b:V(e.b)}}({r:i[0],g:i[1],b:i[2]})},lms:function(e){var t=[e.X,e.Y,e.Z].map((function(e){return e/100})),n=r("BRADFORD").map((function(e){return t.reduce((function(t,n,r){return e[r]*n+t}),0)}));return{rho:n[0],gamma:n[1],beta:n[2]}},cielab:function(e){var t=e.X/k.X,n=e.Y/k.Y,r=e.Z/k.Z,i=function(e){return e>j?a(e):(903.3*e+16)/116},o=i(t),s=i(n);return{L:116*s-16,a:500*(o-s),b:200*(s-i(r))}},cieluv:function(e){var t=e.Y/k.Y,n=t>j?116*a(t)-16:903.3*t,r=function(e){return 4*e.X/(e.X+15*e.Y+3*e.Z)},i=function(e){return 9*e.Y/(e.X+15*e.Y+3*e.Z)};return{L:n,u:13*n*(r(e)-r(k)),v:13*n*(i(e)-i(k))}},xyY:function(e){return{x:e.X/(e.X+e.Y+e.Z),y:e.Y/(e.X+e.Y+e.Z),Y:e.Y}}},M=N.lms,O=N.cielab,L=N.cieluv,D=N.xyY,U=function(e){var t,n,r=e.r/255,i=e.g/255,o=e.b/255,s=[r,i,o].sort(),a=(s[0]+s[2])/2*100;return s[0]===s[2]?(t=0,n=0):(t=a>=50?(s[2]-s[0])/(2-s[2]-s[0])*100:(s[2]-s[0])/(s[2]+s[0])*100,(n=s[2]===r?(i-o)/(s[2]-s[0])*60:s[2]===i?60*(2+(o-r)/(s[2]-s[0])):60*(4+(r-i)/(s[2]-s[0])))<0?n+=360:n>360&&(n%=360)),{h:n,s:t,l:a}},B=function(e){var t=[e.r,e.g,e.b].map((function(e){return e/255})).map((function(e){return e<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)})),n=r("SRGB_XYZ").map((function(e){return t.reduce((function(t,n,r){return e[r]*n+t}),0)})).map((function(e){return 100*e})),i=Z(n,3);return{X:i[0],Y:i[1],Z:i[2]}},z={hex:function(e){var t=Math.round(e.r).toString(16);1===t.length&&(t="0"+t);var n=Math.round(e.g).toString(16);1===n.length&&(n="0"+n);var r=Math.round(e.b).toString(16);return 1===r.length&&(r="0"+r),"#"+t+n+r},cssrgb:function(e){return"rgb("+Math.round(e.r)+","+Math.round(e.g)+","+Math.round(e.b)+")"},hsl:U,csshsl:function(e){var t=U(e),n=t.h,r=t.s,i=t.l;return"hsl("+Math.round(n)+","+Math.round(r)+"%,"+Math.round(i)+"%)"},cmyk:function(e){var t=e.r/255,n=e.g/255,r=e.b/255,i=1-Math.max(t,n,r);return 1!==i?{c:(1-t-i)/(1-i),m:(1-n-i)/(1-i),y:(1-r-i)/(1-i),k:i}:{c:0,m:0,y:0,k:i}},yiq:function(e){var t=e.r/255*.299+e.g/255*.587+e.b/255*.114,n=e.r/255*.596+e.g/255*-.274+e.b/255*-.322,r=e.r/255*.211+e.g/255*-.523+e.b/255*.312;return{y:t,i:n=s(n,[-.5957,.5957]),q:r=s(r,[-.5226,.5226])}},XYZ:B,lms:function(e){return M(B(e))},cielab:function(e){return O(B(e))},cieluv:function(e){return L(B(e))},xyY:function(e){return D(B(e))}},H=function(e){return s(e,[0,255])},Y={rgb:function(e){var t=s(e.i,[-.5957,.5957]),n=s(e.q,[-.5226,.5226]);return{r:255*H(e.y+.956*t+.621*n),g:255*H(e.y+-.272*t+-.647*n),b:255*H(e.y+-1.106*t+-1.703*n)}}},q=Object.freeze({cielab:C,cielch:E,cieluv:b,cmyk:y,csshsl:S,cssrgb:I,hex:R,hsl:F,hsluv:T,hsv:P,lms:A,rgb:z,xyY:{XYZ:function(e){var t=e.x,n=e.y,r=e.Y;return{X:r/n*t,Y:r,Z:r/n*(1-t-n)}}},XYZ:N,yiq:Y}),W={rgb:{default:"XYZ",csshsl:"hsl",hsv:"hsl"},hex:"rgb",hsl:"rgb",hsv:"hsl",csshsl:"hsl",cssrgb:"rgb",cmyk:"rgb",XYZ:{default:"rgb",cielch:"cieluv",hsluv:"cieluv"},xyY:"XYZ",lms:"XYZ",cieluv:{default:"XYZ",hsluv:"cielch"},cielch:"cieluv",cielab:"XYZ",yiq:"rgb",hsluv:"cielch"},X=function(e,t,n){return q[e][t](n)},Q=Object.keys(m),G=function(e,t){return Array.isArray(t)?t.map((function(t){return c(e,t)})):c(e,t)};t.OQ=l},"../node_modules/css-element-queries/index.js":function(e,t,n){e.exports={ResizeSensor:n("../node_modules/css-element-queries/src/ResizeSensor.js"),ElementQueries:n("../node_modules/css-element-queries/src/ElementQueries.js")}},"../node_modules/css-element-queries/src/ElementQueries.js":function(e,t,n){"use strict";var r,i,o;"undefined"!==typeof window&&window,i=[n("../node_modules/css-element-queries/src/ResizeSensor.js")],void 0===(o="function"===typeof(r=function(e){var t=function(){var t,n={},r=[];function i(e){e||(e=document.documentElement);var t=window.getComputedStyle(e,null).fontSize;return parseFloat(t)||16}function o(e){if(!e.getBoundingClientRect)return{width:e.offsetWidth,height:e.offsetHeight};var t=e.getBoundingClientRect();return{width:Math.round(t.width),height:Math.round(t.height)}}function s(e,t){var n=t.split(/\d/),r=n[n.length-1];switch(t=parseFloat(t),r){case"px":default:return t;case"em":return t*i(e);case"rem":return t*i();case"vw":return t*document.documentElement.clientWidth/100;case"vh":return t*document.documentElement.clientHeight/100;case"vmin":case"vmax":var o=document.documentElement.clientWidth/100,s=document.documentElement.clientHeight/100;return t*(0,Math["vmin"===r?"min":"max"])(o,s)}}function a(e,t){var r,i,a,c,l,u,d,h;this.element=e;var f=["min-width","min-height","max-width","max-height"];this.call=function(){for(r in a=o(this.element),u={},n[t])n[t].hasOwnProperty(r)&&(i=n[t][r],c=s(this.element,i.value),l="width"===i.property?a.width:a.height,h=i.mode+"-"+i.property,d="","min"===i.mode&&l>=c&&(d+=i.value),"max"===i.mode&&l<=c&&(d+=i.value),u[h]||(u[h]=""),d&&-1===(" "+u[h]+" ").indexOf(" "+d+" ")&&(u[h]+=" "+d));for(var e in f)f.hasOwnProperty(e)&&(u[f[e]]?this.element.setAttribute(f[e],u[f[e]].substr(1)):this.element.removeAttribute(f[e]))}}function c(t,n){t.elementQueriesSetupInformation||(t.elementQueriesSetupInformation=new a(t,n)),t.elementQueriesSensor||(t.elementQueriesSensor=new e(t,(function(){t.elementQueriesSetupInformation.call()})))}function l(e,i,o,s){if("undefined"===typeof n[e]){n[e]=[];var a=r.length;t.innerHTML+="\n"+e+" {animation: 0.1s element-queries;}",t.innerHTML+="\n"+e+" > .resize-sensor {min-width: "+a+"px;}",r.push(e)}n[e].push({mode:i,property:o,value:s})}function u(e){var t;if(document.querySelectorAll&&(t=e?e.querySelectorAll.bind(e):document.querySelectorAll.bind(document)),t||"undefined"===typeof $$||(t=$$),t||"undefined"===typeof jQuery||(t=jQuery),!t)throw"No document.querySelectorAll, jQuery or Mootools's $$ found.";return t}function d(e){var t=u(e);for(var r in n)if(n.hasOwnProperty(r))for(var i=t(r,e),o=0,s=i.length;o<s;o++)c(i[o],r)}function h(t){var n=[],r=[],i=[],o=0,s=-1,a=[];for(var c in t.children)if(t.children.hasOwnProperty(c)&&t.children[c].tagName&&"img"===t.children[c].tagName.toLowerCase()){n.push(t.children[c]);var l=t.children[c].getAttribute("min-width")||t.children[c].getAttribute("data-min-width"),u=t.children[c].getAttribute("data-src")||t.children[c].getAttribute("url");i.push(u);var d={minWidth:l};r.push(d),l?t.children[c].style.display="none":(o=n.length-1,t.children[c].style.display="block")}function h(){var e,c=!1;for(e in n)n.hasOwnProperty(e)&&r[e].minWidth&&t.offsetWidth>r[e].minWidth&&(c=e);if(c||(c=o),s!==c)if(a[c])n[s].style.display="none",n[c].style.display="block",s=c;else{var l=new Image;l.onload=function(){n[c].src=i[c],n[s].style.display="none",n[c].style.display="block",a[c]=!0,s=c},l.src=i[c]}else n[c].src=i[c]}s=o,t.resizeSensorInstance=new e(t,h),h()}function f(){for(var e=u()("[data-responsive-image],[responsive-image]"),t=0,n=e.length;t<n;t++)h(e[t])}var m=/,?[\s\t]*([^,\n]*?)((?:\[[\s\t]*?(?:min|max)-(?:width|height)[\s\t]*?[~$\^]?=[\s\t]*?"[^"]*?"[\s\t]*?])+)([^,\n\s\{]*)/gim,p=/\[[\s\t]*?(min|max)-(width|height)[\s\t]*?[~$\^]?=[\s\t]*?"([^"]*?)"[\s\t]*?]/gim;function g(e){var t,n,r,i;for(e=e.replace(/'/g,'"');null!==(t=m.exec(e));)for(n=t[1]+t[3],r=t[2];null!==(i=p.exec(r));)l(n,i[1],i[2],i[3])}function v(e){var t="";if(e)if("string"===typeof e)-1===(e=e.toLowerCase()).indexOf("min-width")&&-1===e.indexOf("max-width")||g(e);else for(var n=0,r=e.length;n<r;n++)1===e[n].type?-1!==(t=e[n].selectorText||e[n].cssText).indexOf("min-height")||-1!==t.indexOf("max-height")?g(t):-1===t.indexOf("min-width")&&-1===t.indexOf("max-width")||g(t):4===e[n].type?v(e[n].cssRules||e[n].rules):3===e[n].type&&e[n].styleSheet.hasOwnProperty("cssRules")&&v(e[n].styleSheet.cssRules)}var w=!1;this.init=function(){var n="animationstart";"undefined"!==typeof document.documentElement.style.webkitAnimationName?n="webkitAnimationStart":"undefined"!==typeof document.documentElement.style.MozAnimationName?n="mozanimationstart":"undefined"!==typeof document.documentElement.style.OAnimationName&&(n="oanimationstart"),document.body.addEventListener(n,(function(t){var n=t.target,i=n&&window.getComputedStyle(n,null),o=i&&i.getPropertyValue("animation-name");if(o&&-1!==o.indexOf("element-queries")){n.elementQueriesSensor=new e(n,(function(){n.elementQueriesSetupInformation&&n.elementQueriesSetupInformation.call()}));var s=window.getComputedStyle(n.resizeSensor,null).getPropertyValue("min-width");s=parseInt(s.replace("px","")),c(t.target,r[s])}})),w||((t=document.createElement("style")).type="text/css",t.innerHTML="[responsive-image] > img, [data-responsive-image] {overflow: hidden; padding: 0; } [responsive-image] > img, [data-responsive-image] > img {width: 100%;}",t.innerHTML+="\n@keyframes element-queries { 0% { visibility: inherit; } }",document.getElementsByTagName("head")[0].appendChild(t),w=!0);for(var i=0,o=document.styleSheets.length;i<o;i++)try{document.styleSheets[i].href&&0===document.styleSheets[i].href.indexOf("file://")&&console.warn("CssElementQueries: unable to parse local css files, "+document.styleSheets[i].href),v(document.styleSheets[i].cssRules||document.styleSheets[i].rules||document.styleSheets[i].cssText)}catch(s){}f()},this.findElementQueriesElements=function(e){d(e)},this.update=function(){this.init()}};t.update=function(){t.instance.update()},t.detach=function(e){e.elementQueriesSetupInformation?(e.elementQueriesSensor.detach(),delete e.elementQueriesSetupInformation,delete e.elementQueriesSensor):e.resizeSensorInstance&&(e.resizeSensorInstance.detach(),delete e.resizeSensorInstance)},t.init=function(){t.instance||(t.instance=new t),t.instance.init()};var n=function(e){if(document.addEventListener)document.addEventListener("DOMContentLoaded",e,!1);else if(/KHTML|WebKit|iCab/i.test(navigator.userAgent))var t=setInterval((function(){/loaded|complete/i.test(document.readyState)&&(e(),clearInterval(t))}),10);else window.onload=e};return t.findElementQueriesElements=function(e){t.instance.findElementQueriesElements(e)},t.listen=function(){n(t.init)},t})?r.apply(t,i):r)||(e.exports=o)},"../node_modules/css-element-queries/src/ResizeSensor.js":function(e,t,n){"use strict";var r,i;"undefined"!==typeof window&&window,void 0===(i="function"===typeof(r=function(){if("undefined"===typeof window)return null;var e="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")(),t=e.requestAnimationFrame||e.mozRequestAnimationFrame||e.webkitRequestAnimationFrame||function(t){return e.setTimeout(t,20)},n=e.cancelAnimationFrame||e.mozCancelAnimationFrame||e.webkitCancelAnimationFrame||function(t){e.clearTimeout(t)};function r(e,t){var n=Object.prototype.toString.call(e),r="[object Array]"===n||"[object NodeList]"===n||"[object HTMLCollection]"===n||"[object Object]"===n||"undefined"!==typeof jQuery&&e instanceof jQuery||"undefined"!==typeof Elements&&e instanceof Elements,i=0,o=e.length;if(r)for(;i<o;i++)t(e[i]);else t(e)}function i(e){if(!e.getBoundingClientRect)return{width:e.offsetWidth,height:e.offsetHeight};var t=e.getBoundingClientRect();return{width:Math.round(t.width),height:Math.round(t.height)}}function o(e,t){Object.keys(t).forEach((function(n){e.style[n]=t[n]}))}var s=function(e,a){var c=0;function l(){var e,t,n=[];this.add=function(e){n.push(e)},this.call=function(r){for(e=0,t=n.length;e<t;e++)n[e].call(this,r)},this.remove=function(r){var i=[];for(e=0,t=n.length;e<t;e++)n[e]!==r&&i.push(n[e]);n=i},this.length=function(){return n.length}}function u(e,n){if(e)if(e.resizedAttached)e.resizedAttached.add(n);else{e.resizedAttached=new l,e.resizedAttached.add(n),e.resizeSensor=document.createElement("div"),e.resizeSensor.dir="ltr",e.resizeSensor.className="resize-sensor";var r={pointerEvents:"none",position:"absolute",left:"0px",top:"0px",right:"0px",bottom:"0px",overflow:"hidden",zIndex:"-1",visibility:"hidden",maxWidth:"100%"},s={position:"absolute",left:"0px",top:"0px",transition:"0s"};o(e.resizeSensor,r);var a=document.createElement("div");a.className="resize-sensor-expand",o(a,r);var u=document.createElement("div");o(u,s),a.appendChild(u);var d=document.createElement("div");d.className="resize-sensor-shrink",o(d,r);var h=document.createElement("div");o(h,s),o(h,{width:"200%",height:"200%"}),d.appendChild(h),e.resizeSensor.appendChild(a),e.resizeSensor.appendChild(d),e.appendChild(e.resizeSensor);var f=window.getComputedStyle(e),m=f?f.getPropertyValue("position"):null;"absolute"!==m&&"relative"!==m&&"fixed"!==m&&"sticky"!==m&&(e.style.position="relative");var p=!1,g=0,v=i(e),w=0,x=0,C=!0;c=0;var E=function(){var t=e.offsetWidth,n=e.offsetHeight;u.style.width=t+10+"px",u.style.height=n+10+"px",a.scrollLeft=t+10,a.scrollTop=n+10,d.scrollLeft=t+10,d.scrollTop=n+10},b=function(){if(C){if(0===e.offsetWidth&&0===e.offsetHeight)return void(c||(c=t((function(){c=0,b()}))));C=!1}E()};e.resizeSensor.resetSensor=b;var _=function(){g=0,p&&(w=v.width,x=v.height,e.resizedAttached&&e.resizedAttached.call(v))},y=function(){v=i(e),(p=v.width!==w||v.height!==x)&&!g&&(g=t(_)),b()},S=function(e,t,n){e.attachEvent?e.attachEvent("on"+t,n):e.addEventListener(t,n)};S(a,"scroll",y),S(d,"scroll",y),c=t((function(){c=0,b()}))}}r(e,(function(e){u(e,a)})),this.detach=function(t){c||(n(c),c=0),s.detach(e,t)},this.reset=function(){e.resizeSensor.resetSensor()}};if(s.reset=function(e){r(e,(function(e){e.resizeSensor.resetSensor()}))},s.detach=function(e,t){r(e,(function(e){e&&(e.resizedAttached&&"function"===typeof t&&(e.resizedAttached.remove(t),e.resizedAttached.length())||e.resizeSensor&&(e.contains(e.resizeSensor)&&e.removeChild(e.resizeSensor),delete e.resizeSensor,delete e.resizedAttached))}))},"undefined"!==typeof MutationObserver){var a=new MutationObserver((function(e){for(var t in e)if(e.hasOwnProperty(t))for(var n=e[t].addedNodes,r=0;r<n.length;r++)n[r].resizeSensor&&s.reset(n[r])}));document.addEventListener("DOMContentLoaded",(function(e){a.observe(document.body,{childList:!0,subtree:!0})}))}return s})?r.call(t,n,t,e):r)||(e.exports=i)},"../node_modules/dom-helpers/esm/addClass.js":function(e,t,n){"use strict";function r(e,t){e.classList?e.classList.add(t):function(e,t){return e.classList?!!t&&e.classList.contains(t):-1!==(" "+(e.className.baseVal||e.className)+" ").indexOf(" "+t+" ")}(e,t)||("string"===typeof e.className?e.className=e.className+" "+t:e.setAttribute("class",(e.className&&e.className.baseVal||"")+" "+t))}n.d(t,{Z:function(){return r}})},"../node_modules/dom-helpers/esm/removeClass.js":function(e,t,n){"use strict";function r(e,t){return e.replace(new RegExp("(^|\\s)"+t+"(?:\\s|$)","g"),"$1").replace(/\s+/g," ").replace(/^\s*|\s*$/g,"")}function i(e,t){e.classList?e.classList.remove(t):"string"===typeof e.className?e.className=r(e.className,t):e.setAttribute("class",r(e.className&&e.className.baseVal||"",t))}n.d(t,{Z:function(){return i}})}}]),window.jsExecEndTimeStamp=Date.now(),window.cachedPerformanceEntries||(window.cachedPerformanceEntries=[]),window.cachedPerformanceEntries.push({name:"jsExec: js/bundle_view_lazy_module1.c906ac171b67057b65db.js",entryType:"jsExec",startTime:window.jsExecStartTimeStamp,endTime:window.jsExecEndTimeStamp});
//# sourceMappingURL=bundle_view_lazy_module1.c906ac171b67057b65db.js.map