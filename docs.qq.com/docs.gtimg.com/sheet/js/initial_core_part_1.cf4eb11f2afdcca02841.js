self.window=self,window.jsExecStartTimeStamp=Date.now(),(self.webpackChunk_tencent_alloy_builder=self.webpackChunk_tencent_alloy_builder||[]).push([["initial_core_part_1"],{"../spread-sheet/src/base/config/font.ts":function(e,t,n){n.d(t,{FS:function(){return p},X2:function(){return i},XP:function(){return c},em:function(){return a},g_:function(){return d},te:function(){return u},yy:function(){return l}});var r,o=n("../node_modules/@babel/runtime/helpers/esm/toConsumableArray.js"),s=(n("../node_modules/core-js/modules/es.array.concat.js"),n("../node_modules/i18next/dist/esm/i18next.js")),a=(n("../spread-sheet/src/base/util/domain-config.ts"),"Helvetica Neue, Helvetica, PingFang SC, Microsoft YaHei, Source Han Sans SC, Noto Sans CJK SC, WenQuanYi Micro Hei, sans-serif"),i=((r={})[a]=s.ZP.t("默认字体"),r["Microsoft YaHei"]=s.ZP.t("微软雅黑"),r.SimSun=s.ZP.t("宋体"),r.SimHei=s.ZP.t("黑体"),r.FangSong=s.ZP.t("仿宋"),r.KaiTi=s.ZP.t("楷体"),r["DFKai-SB"]=s.ZP.t("标楷体"),r.STFangsong=s.ZP.t("华文仿宋"),r.STKaiti=s.ZP.t("华文楷体"),r.STSong=s.ZP.t("华文宋体"),r.NSimSun=s.ZP.t("新宋体"),r["Microsoft JhengHei"]=s.ZP.t("微软正黑体"),r.PMingLiU=s.ZP.t("新细明体"),r["Hiragino Sans GB"]=s.ZP.t("冬青黑简体中文"),r["PingFang SC"]=s.ZP.t("苹方"),r.TencentSans=s.ZP.t("腾讯体"),r),c={"默认字体":a,"微软雅黑":"Microsoft YaHei","宋体":"SimSun","黑体":"SimHei","仿宋":"FangSong","楷体":"KaiTi","标楷体":"DFKai-SB","华文仿宋":"STFangsong","华文楷体":"STKaiti","华文宋体":"STSong","新宋体":"NSimSun","微软正黑体":"Microsoft JhengHei","新细明体":"PMingLiU","冬青黑简体中文":"Hiragino Sans GB","苹方":"PingFang SC"},u=["Microsoft YaHei","SimSun","SimHei","FangSong","KaiTi","DFKai-SB","STFangsong","STKaiti","STSong","NSimSun","Microsoft JhengHei","PMingLiU"].concat((0,o.Z)([]),["Arial","Times New Roman","Calibri","Comic Sans MS","Courier New","Georgia","Microsoft Uighur","Impact","Trebuchet MS","Verdana","Aharoni","Andalus","AngsanaUPC","Angsana New","Aparajita","Arabic Typesetting","Arial Black","Arial Narrow","Batang","BatangChe","Bookman Old Style","Book Antiqua","Bradley Hand ITC","BrowalliaUPC","Browallia New","Cambria","Cambria Math","Candara","Century","Century Gothic","Consolas","Constantia","Corbel","CordiaUPC","Cordia New","DaunPenh","David","DilleniaUPC","DokChampa","Dotum","DotumChe","Ebrima","Estrangelo Edessa","EucrosiaUPC","Euphemia","Franklin Gothic","Franklin Gothic Medium","FrankRuehl","FreesiaUPC","Freestyle Script","French Script MT","Gabriola","Gadugi","Garamond","Gisha","Gulim","GulimChe","Gungsuh","GungsuhChe","Haettenschweiler","IrisUPC","Iskoola Pota","JasmineUPC","Juice ITC","Kalinga","Kartika","Khmer UI","KodchiangUPC","Kokila","Kristen ITC","Lao UI","Latha","Leelawadee","Levenim MT","LilyUPC","Lucida Console","Lucida Handwriting","Lucida Sans Unicode","Malgun Gothic","Mangal","Marlett","Meiryo","Meiryo UI","Microsoft Himalaya","Microsoft JhengHei UI","Microsoft JhengHei UI Light","Microsoft New Tai Lue","Microsoft PhagsPa","Microsoft Sans Serif","Microsoft Tai Le","Microsoft YaHei UI","Microsoft YaHei UI Light","Microsoft Yi Baiti","MingLiU-ExtB","MingLiU_HKSCS-ExtB","MingLiU_HKSCS","Miriam","Miriam Fixed","Mistral","Mongolian Baiti","Monotype.com","Monotype Corsiva","MoolBoran","MS Gothic","MS Mincho","MS Outlook","MS PGothic","MS PMincho","MS UI Gothic","MT Extra","MV Boli","Narkisim","Nirmala UI","Nyala","Palatino Linotype","Papyrus","Plantagenet Cherokee","PMingLiU-ExtB","Pristina","Raavi","Rod","Sakkal Majalla","Segoe Print","Segoe Script","Segoe UI Symbol","Shonar Bangla","Shruti","Simplified Arabic Fixed","Sylfaen","Symbol","Tahoma","Tempus Sans ITC","Traditional Arabic","Tunga","Utsaah","Vani","Vijaya","Vrinda","Webdings","Wingdings"]),d=["SimSun","Hiragino Sans GB","PingFang SC","STSong","STFangsong","STKaiti"].concat((0,o.Z)([]),["Arial","Times New Roman","Comic Sans MS","Courier New","Georgia","Impact","Trebuchet MS","Verdana","Al Bayan","Al Nile","Al Tarikh","American Typewriter","Andale Mono","Arial Black","Arial Hebrew","Arial Hebrew Scholar","Arial Narrow","Arial Rounded MT Bold","Arial Unicode MS","Athelas","Avenir","Avenir Next","Avenir Next Condensed","Ayuthaya","Baghdad","Bangla MN","Bangla Sangam MN","Baskerville","Beirut","Big Caslon","Bodoni Ornaments","Bradley Hand","Brush Script MT","Chalkboard","Chalkboard SE","Chalkduster","Charter","Cochin","Copperplate","Corsiva Hebrew","Courier","Damascus","DecoType Naskh","Devanagari MT","Devanagari Sangam MN","Didot","DIN Alternate","DIN Condensed","Diwan Kufi","Diwan Thuluth","Euphemia UCAS","Farah","Farisi","Futura","GB18030 Bitmap","Geeza Pro","Geneva","Gill Sans","Gujarati MT","Gujarati Sangam MN","Gurmukhi MN","Gurmukhi MT","Gurmukhi Sangam MN","Hei","Helvetica","Helvetica Neue","Herculanum","Hiragino Kaku Gothic Pro","Hiragino Kaku Gothic ProN","Hiragino Kaku Gothic Std","Hiragino Kaku Gothic StdN","Hiragino Maru Gothic Pro","Hiragino Maru Gothic ProN","Hiragino Mincho Pro","Hiragino Mincho ProN","Hiragino Sans","Hoefler Text","InaiMathi","Iowan Old Style","ITF Devanagari","ITF Devanagari Marathi","Kai","Kailasa","Kannada MN","Kannada Sangam MN","Kefa","Khmer MN","Khmer Sangam MN","Kohinoor Bangla","Kohinoor Devanagari","Kohinoor Telugu","Kokonor","Krungthep","KufiStandardGK","Lao MN","Lao Sangam MN","Lucida Grande","Luminari","Malayalam MN","Malayalam Sangam MN","Marion","Marker Felt","Menlo","Microsoft Sans Serif","Mishafi","Mishafi Gold","Monaco","Mshtakan","Muna","Myanmar MN","Myanmar Sangam MN","Nadeem","New Peninim MT","Noteworthy","Noto Nastaliq Urdu","Optima","Oriya MN","Oriya Sangam MN","Palatino","Papyrus","Phosphate","Plantagenet Cherokee","PT Mono","PT Sans","PT Sans Caption","PT Sans Narrow","PT Serif","PT Serif Caption","Raanana","Sana","Sathu","Savoye LET","Seravek","SignPainter","Silom","Sinhala MN","Sinhala Sangam MN","Skia","Snell Roundhand","STIXGeneral","STIXIntegralsD","STIXIntegralsSm","STIXIntegralsUp","STIXIntegralsUpD","STIXIntegralsUpSm","STIXNonUnicode","STIXSizeFiveSym","STIXSizeFourSym","STIXSizeOneSym","STIXSizeThreeSym","STIXSizeTwoSym","STIXVariants","Sukhumvit Set","Superclarendon","Symbol","Tahoma","Tamil MN","Tamil Sangam MN","Telugu MN","Telugu Sangam MN","Thonburi","Times","Trattatello","Waseem","Webdings","Wingdings","Zapf Dingbats","Zapfino","Apple Braille","Apple Chancery","Apple Color Emoji","Apple SD Gothic Neo","Apple Symbols","AppleGothic","AppleMyungjo"]),l=["Times New Roman","Courier New","Futrua","Papyrus","Rockwell","Trebuchet MS","Verdana"],p=["Times New Roman","Courier New","Georgia","Baskerville","Monaco","Palatino","Times","Courier"]},"../spread-sheet/src/base/config/report.ts":function(e,t,n){n.r(t),n.d(t,{CONFIG:function(){return _},MONITOR_POINTS:function(){return d},PROACTIVE_REPORT_ERROR:function(){return v},SENTRY_ERROR_TYPE:function(){return p},SPEED_REPORT_LOG:function(){return m},SPEED_REPORT_POINTS:function(){return h},TDW_ACTION:function(){return i},TDW_MODULE:function(){return a},TDW_VER5_VALUE:function(){return c},ZZS_REPORT_ATTR:function(){return f},getTdwObj3Value:function(){return l}}),n("../node_modules/core-js/modules/es.array.join.js");var r,o,s,a,i,c,u=n("../packages/mutation/src/MutationOperationType.ts"),d={CHECK_MUTATION_ERROR:33624582,CHECK_MUTATION_FAIL_MAP:((r={})[u.Z.HISTORY]=33692346,r[u.Z.LOCAL]=33692347,r[u.Z.UNDO]=33692348,r[u.Z.REDO]=33692349,r[u.Z.COLLAB]=33692350,r),CHECK_HISTORY_MUTATION_FAIL_MAP:{0:35306455,1:35306456,2:35306457,3:35306458,4:35306459,5:35306460,6:35306461,7:35306462,8:35306463,9:35306464,10:35306465,11:35306466,12:35306467,13:35306468,14:35306469,15:35306470,16:35306471,17:35306472,18:35306473,19:35306474,20:35306475,21:35306476,22:35306477,23:35306478,24:35306479,25:35306480,26:35306481,27:35306482,28:35306483,29:35306484,30:35306485,31:35306486,32:35306487,33:35306488,34:35306489,35:35306490,36:35306491,37:35306492},CHECK_LOCAL_MUTATION_FAIL_MAP:{0:35306624,1:35306625,2:35306626,3:35306627,4:35306628,5:35306629,6:35306630,7:35306631,8:35306632,9:35306633,10:35306634,11:35306635,12:35306636,13:35306637,14:35306638,15:35306639,16:35306640,17:35306641,18:35306642,19:35306643,20:35306644,21:35306645,22:35306646,23:35306647,24:35306648,25:35306649,26:35306650,27:35306651,28:35306652,29:35306653,30:35306654,31:35306655,32:35306656,33:35306657,34:35306658,35:35306659,36:35306660,37:35306661},CHECK_UNDO_MUTATION_FAIL_MAP:{0:35308055,1:35308056,2:35308057,3:35308058,4:35308059,5:35308060,6:35308061,7:35308062,8:35308063,9:35308064,10:35308065,11:35308066,12:35308067,13:35308068,14:35308069,15:35308070,16:35308071,17:35308072,18:35308073,19:35308074,20:35308075,21:35308076,22:35308077,23:35308078,24:35308079,25:35308080,26:35308081,27:35308082,28:35308083,29:35308084,30:35308085,31:35308086,32:35308087,33:35308088,34:35308089,35:35308090,36:35308091,37:35308092},CHECK_REDO_MUTATION_FAIL_MAP:{0:35308143,1:35308144,2:35308145,3:35308146,4:35308147,5:35308148,6:35308149,7:35308150,8:35308151,9:35308152,10:35308153,11:35308154,12:35308155,13:35308156,14:35308157,15:35308158,16:35308159,17:35308160,18:35308161,19:35308162,20:35308163,21:35308164,22:35308165,23:35308166,24:35308167,25:35308168,26:35308169,27:35308170,28:35308171,29:35308172,30:35308173,31:35308174,32:35308175,33:35308176,34:35308177,35:35308178,36:35308179,37:35308180},CHECK_COLLAB_MUTATION_FAIL_MAP:{0:35308235,1:35308236,2:35308237,3:35308238,4:35308239,5:35308240,6:35308241,7:35308242,8:35308243,9:35308244,10:35308245,11:35308246,12:35308247,13:35308248,14:35308249,15:35308250,16:35308251,17:35308252,18:35308253,19:35308254,20:35308255,21:35308256,22:35308257,23:35308258,24:35308259,25:35308260,26:35308261,27:35308262,28:35308263,29:35308264,30:35308265,31:35308266,32:35308267,33:35308268,34:35308269,35:35308270,36:35308271,37:35308272},RUN_MUTATION_ERROR_MAP:((o={})[u.Z.HISTORY]=33692646,o[u.Z.LOCAL]=33692647,o[u.Z.UNDO]=33692648,o[u.Z.REDO]=33692649,o[u.Z.COLLAB]=33692650,o),DESERIALIZE_MUTATION_ERROR:34817507,DESERIALIZE_MUTATION_ERROR_OLD:34817508,DESERIALIZE_MUTATION_FAIL:34817509,DESERIALIZE_MUTATION_FAIL_OLD:34860812,MERGE_GRID_RANGE_ERROR:33659770};function l(e,t){var n,r="";return e===a.MUTATION&&(r=[null===(n=t.getAffectedSheetId)||void 0===n?void 0:n.call(t),t.requestId,t.id,t.operationType].join("-")),r}!function(e){e.MUTATION="mutation",e.OPERATION="operation"}(a||(a={})),function(e){e.CHECK_MUTATION="checkMutation",e.RUN_MUTATION="runMutation",e.DESERIALIZE_MUTATION="deserializeMutation",e.DESERIALIZE_MUTATION_FAIL="deserializeMutationFail",e.DESERIALIZE_MUTATION_ERROR="deserializeMutationError",e.PASTE_DATA_GENERATE_MUTATION="pasteDataGenerateMutation",e.MERGE_GRID_RANGE_ERROR="mergeGridRangeError"}(i||(i={})),function(e){e.CHECK_MUTATION_ERROR="1",e.CHECK_MUTATION_FAIL="2",e.RUN_MUTATION_ERROR="1",e.DESERIALIZE_MUTATION_FAIL="1",e.DESERIALIZE_MUTATION_FAIL_OLD="2",e.DESERIALIZE_MUTATION_ERROR="1",e.DESERIALIZE_MUTATION_ERROR_OLD="2",e.PASTE_DATA_GENERATE_MUTATION_INSERT_ERROR_NO_OPTION="1",e.PASTE_DATA_GENERATE_MUTATION_INSERT_ERROR_NO_EXPANSION="2",e.PASTE_DATA_GENERATE_MUTATION_SETRANGE_ERROR_NO_GRIDRANGE="3"}(c||(c={}));var p,h,_={CHECK_MUTATION_ERROR:"CHECK_MUTATION_ERROR",RUN_MUTATION_ERROR:"RUN_MUTATION_ERROR",CHECK_MUTATION_RESULT_ERROR:"CHECK_MUTATION_RESULT_ERROR",AFTER_MUTATION_RUN_CATCH_ERROR:"AFTER_MUTATION_RUN_CATCH_ERROR",AFTER_MUTATION_RUN_DATA_CHANGE_CATCH_ERROR:"AFTER_MUTATION_RUN_DATA_CHANGE_CATCH_ERROR",COMMIT_EMPTY_MUTATION:"COMMIT_EMPTY_MUTATION",DO_BEHAVIOR_AFTER_SHUTDOWN:"DO_BEHAVIOR_AFTER_SHUTDOWN",COMMIT_MUTATION_CATCH_ERROR:"COMMIT_MUTATION_CATCH_ERROR",COMMIT_MUTATION:"COMMIT_MUTATION",CACHE_DATA_FLOW_COMMIT_MUTATION:"CACHE_DATA_FLOW_COMMIT_MUTATION",PAGE_LOAD:"PAGE_LOAD",DUPLICATE_SHEET_ID:"DUPLICATE_SHEET_ID",SERIALIZE_MUTATION:"SERIALIZE_MUTATION",DESERIALIZE_MUTATION_FAIL:"DESERIALIZE_MUTATION_FAIL",DESERIALIZE_MUTATION_FAIL_OLD:"DESERIALIZE_MUTATION_FAIL_OLD",DESERIALIZE_MUTATION_CATCH_ERROR:"DESERIALIZE_MUTATION_CATCH_ERROR",DESERIALIZE_MUTATION_CATCH_ERROR_OLD:"DESERIALIZE_MUTATION_CATCH_ERROR_OLD",GET_COLLAB_MUTATIONS:"GET_COLLAB_MUTATIONS",CREATE_ZIPKETFRAME:"CREATE_ZIPKETFRAME",APPLY_NEW_CHANGES_ERROR:"APPLY_NEW_CHANGES_ERROR",LOAD_REQUEST:"LOAD_REQUEST",APPLY_BEHAVIOR_ERROR:"APPLY_BEHAVIOR_ERROR",APPLY_BEHAVIOR_CATCH_SCRIPT_ERROR:"APPLY_BEHAVIOR_CATCH_SCRIPT_ERROR",APPLY_BEHAVIOR_NOT_LOADED:"APPLY_BEHAVIOR_NOT_LOADED",APPLY_BEHAVIOR_LEVEL_INFO:"APPLY_BEHAVIOR_LEVEL_INFO",APPLY_BEHAVIOR_LEVEL_IMPORTANT:"APPLY_BEHAVIOR_LEVEL_IMPORTANT",APPLY_BEHAVIOR_LEVEL_IMPORTANT_MONITOR:"APPLY_BEHAVIOR_LEVEL_IMPORTANT_MONITOR",REQUEST_SIZE_OVER_LIMIT:"REQUEST_SIZE_OVER_LIMIT",FOLLOW_REQUEST_MUTATIONS:"FOLLOW_REQUEST_MUTATIONS",PASTE_DATA_GENERATE_MUTATION_1:"PASTE_DATA_GENERATE_MUTATION_1",PASTE_DATA_GENERATE_MUTATION_2:"PASTE_DATA_GENERATE_MUTATION_2",PASTE_DATA_GENERATE_MUTATION_3:"PASTE_DATA_GENERATE_MUTATION_3",DO_KEYFRAME_CATCH_ERROR_1:"DO_KEYFRAME_CATCH_ERROR_1",DO_KEYFRAME_CATCH_ERROR_2:"DO_KEYFRAME_CATCH_ERROR_2",DO_KEYFRAME_CATCH_ERROR_3:"DO_KEYFRAME_CATCH_ERROR_3",DO_KEYFRAME:"DO_KEYFRAME",DO_MUTATIONS:"DO_MUTATIONS",ZIP_KEYFRAME:"ZIP_KEYFRAME",ZIP_KEYFRAME_CATCH_ERROR:"ZIP_KEYFRAME_CATCH_ERROR",COPY_PASTE:"COPY_PASTE",CHOOSE_FORMAT_ERROR:"CHOOSE_FORMAT_ERROR",PARSE_FORMAT_ERROR:"PARSE_FORMAT_ERROR",RETRY_SENDMESSAGE:"RETRY_SENDMESSAGE",MOVE_MESSAGEINFO_COMMITING_QUEUE:"MOVE_MESSAGEINFO_COMMITING_QUEUE",RETRY_COMMIT:"RETRY_COMMIT",SEND_USERCHANGE:"SEND_USERCHANGE",SEND_USERCHANGE_1:"SEND_USERCHANGE_1",ACCEPT_COMMIT:"ACCEPT_COMMIT",HANDLE_COMMIT_ERROR:"HANDLE_COMMIT_ERROR",HANDLE_TASK_DUPLICATE:"HANDLE_TASK_DUPLICATE",TASK_DUPLICATE_VERSION_TOO_LOW:"TASK_DUPLICATE_VERSION_TOO_LOW",HANDLE_NEW_CHANGES:"HANDLE_NEW_CHANGES",APPLY_NEWCHANGES_VERROR:"APPLY_NEWCHANGES_VERROR",COMMITING_QUEUE_BLOCK:"COMMITING_QUEUE_BLOCK",DUPLICATE_MESSAGE:"DUPLICATE_MESSAGE",APPLY_NEWCHANGES_CATCH_ERROR:"APPLY_NEWCHANGES_CATCH_ERROR",APPLY_NEWCHANGES:"APPLY_NEWCHANGES",APPLY_NEWCHANGES_VERROR2:"APPLY_NEWCHANGES_VERROR2",APPLY_NEWCHANGES_VERROR5:"APPLY_NEWCHANGES_VERROR5",APPLY_NEWCHANGES_VERROR6:"APPLY_NEWCHANGES_VERROR6",SWITCH_CHANEL_STATUS:"SWITCH_CHANEL_STATUS",HANDLE_FETCH_RESULT:"HANDLE_FETCH_RESULT",FETCH_USERCHANGES_ERROR:"FETCH_USERCHANGES_ERROR",FETCH_AND_APPLY_MISSCHANGES:"FETCH_AND_APPLY_MISSCHANGES",EMPTY_KEYFRAME_BY_AUTOEXPAND:"EMPTY_KEYFRAME_BY_AUTOEXPAND",ADD_USER_CHANGE:"ADD_USER_CHANGE",CLEAR_OFFLINE_DATA_SIZE:"CLEAR_OFFLINE_DATA_SIZE",UPDATE_BASEVERSION:"UPDATE_BASEVERSION",UPDATE_BASEVERSION_ERROR:"UPDATE_BASEVERSION_ERROR",ACCEPT_COMMIT_2:"ACCEPT_COMMIT_2",FETCH_USERCHANGE_ARGUMENT:"FETCH_USERCHANGE_ARGUMENT",FETCH_USERCHANGES:"FETCH_USERCHANGES",FETCH_USERCHANGES_3:"FETCH_USERCHANGES_3",INIT_DATA_ERROR:"INIT_DATA_ERROR",STORE_DATA_ERROR:"STORE_DATA_ERROR",NOT_SUPPORT_INDEXEDDB:"NOT_SUPPORT_INDEXEDDB",OPEN_INDEXED_DB_FAIL:"OPEN_INDEXED_DB_FAIL",UPDATE_INDEXED_DB:"UPDATE_INDEXED_DB",STORE_UNVALIABLE_WHEN_SET:"STORE_UNVALIABLE_WHEN_SET",INDEXDB_SET_VALUE:"INDEXDB_SET_VALUE",INDEXDB_SET_VALUE_ONERROR:"INDEXDB_SET_VALUE_ONERROR",CHANGE_DATAKEY:"CHANGE_DATAKEY",STORE_UNVALIABLE_WHEN_UPDATE:"STORE_UNVALIABLE_WHEN_UPDATE",OFFLINE_DATABASE_ERROR:"OFFLINE_DATABASE_ERROR",INDEXEDDB_UPDATE_VALUE:"INDEXEDDB_UPDATE_VALUE",INDEXEDDB_UPDATE_VALUE_2:"INDEXEDDB_UPDATE_VALUE_2",INDEXEDDB_UPDATE_VALUE_3:"INDEXEDDB_UPDATE_VALUE_3",INDEXEDDB_UPDATE_VALUE_4:"INDEXEDDB_UPDATE_VALUE_4",DELETE_DATA_ERROR:"DELETE_DATA_ERROR",DELETE_VALUE:"DELETE_VALUE",DELETE_VALUE_2:"DELETE_VALUE_2",CLEAR_DATA_ERROR:"CLEAR_DATA_ERROR",CLEAR_DATA:"CLEAR_DATA",CLEAR_DATA_2:"CLEAR_DATA_2",GET_DATA_ERROR:"GET_DATA_ERROR",GET_DATA:"GET_DATA",GET_DATA_ERROR_2:"GET_DATA_ERROR_2",GET_DATA_SUCC:"GET_DATA_SUCC",NETWORK_ERROR:"NETWORK_ERROR",WEBSOCKET_CLOSE:"WEBSOCKET_CLOSE",LONG_TIME_HIDDEN_1:"LONG_TIME_HIDDEN_1",LONG_TIME_HIDDEN_2:"LONG_TIME_HIDDEN_2",ACCEPT_MESSAGE:"ACCEPT_MESSAGE",ROOM_STATE_CHANGE:"ROOM_STATE_CHANGE",HANDLE_SHUTDOWN:"HANDLE_SHUTDOWN",SWITCH_SHEET_IN_PREVIEW:"SWITCH_SHEET_IN_PREVIEW",PREVIEW_SERVER_SHEET_DATA:"PREVIEW_SERVER_SHEET_DATA",PREVIEW_SERVER_SHEET_DATA_ON_RESPONSE:"PREVIEW_SERVER_SHEET_DATA_ON_RESPONSE",SWITCH_SHEET_ON_SUCCESS:"SWITCH_SHEET_ON_SUCCESS",SWITCH_SHEET_ON_FAIL:"SWITCH_SHEET_ON_FAIL",DUPLICATE_SHEET_ID_2:"DUPLICATE_SHEET_ID_2",DUPLICATE_SHEET_ID_3:"DUPLICATE_SHEET_ID_3",FETCH_DATA_ERROR:"FETCH_DATA_ERROR",FETCH_DATA_ERROR_2:"FETCH_DATA_ERROR_2",K2S_CONVERTER:"K2S_CONVERTER",RELOAD_TIP:"RELOAD_TIP",RELOAD_TIP_DEBUG:"RELOAD_TIP_DEBUG",INIT_OFFLINE_STORE_ERROR:"INIT_OFFLINE_STORE_ERROR",GET_OFFLINE_DATA:"GET_OFFLINE_DATA",CHANGEDATAKEY_CATCH_ERROR:"CHANGEDATAKEY_CATCH_ERROR",SETDATA_CATCH_ERROR:"SETDATA_CATCH_ERROR",UPDATEDATA_CATCH_ERROR:"UPDATEDATA_CATCH_ERROR",DELETEDATA_CATCH_ERROR:"DELETEDATA_CATCH_ERROR",CLEARDATA_CATCH_ERROR:"CLEARDATA_CATCH_ERROR",GETDATA_CATCH_ERROR:"GETDATA_CATCH_ERROR",SWITCH_SHEET_NO_NETWORK:"SWITCH_SHEET_NO_NETWORK",SWITCH_SHEET_SERVER_FAIL:"SWITCH_SHEET_SERVER_FAIL",SWITCH_SHEET_FRONT_FAIL:"SWITCH_SHEET_FRONT_FAIL",PARSE_KEYFRAME_ERROR:"PARSE_KEYFRAME_ERROR",UNZIP_KEYFRAME_ERROR:"UNZIP_KEYFRAME_ERROR",PARSE_KEYFRAME_ERROR_2:"PARSE_KEYFRAME_ERROR_2",UNZIP_KEYFRAME:"UNZIP_KEYFRAME",MESSAGECENTER_DATA_ERROR_TIP:"MESSAGECENTER_DATA_ERROR_TIP",NET_OFFLINE_ERROR_TIP:"NET_OFFLINE_ERROR_TIP",MESSAGECENTER_DATA_ERROR_TIP_IMPORTANT:"MESSAGECENTER_DATA_ERROR_TIP_IMPORTANT",APPLY_BEHAVIOR_UNDO:"APPLY_BEHAVIOR_UNDO",APPLY_BEHAVIOR_REDO:"APPLY_BEHAVIOR_REDO",APPLY_BEHAVIOR_LOCAL:"APPLY_BEHAVIOR_LOCAL",CREATE_WORKER_ERROR:"CREATE_WORKER_ERROR",UPDATE_SMART_SELECTION_ERROR:"UPDATE_SMART_SELECTION_ERROR",INVER_MUTATION_ERROR:"INVER_MUTATION_ERROR",FILL_DRAG:"FILL_DRAG",FILL_SERIES:"FILL_SERIES",FILL_COPY:"FILL_COPY",FILL_OPTION:"FILL_OPTION",FILL_OPTION_COPY:"FILL_OPTION_COPY",FILL_OPTION_SERIES:"FILL_OPTION_SERIES",FILL_FORMAT:"FILL_FORMAT",FILL_WITHOUT_FORMAT:"FILL_WITHOUT_FORMAT",MOBILE_FILL_SERIES:"MOBILE_FILL_SERIES",MOBILE_FILL_COP:"MOBILE_FILL_COP",CLK_FILL_SUCCESS:"CLK_FILL_SUCCESS",LOAD_DATA_SUCC:"LOAD_DATA_SUCC",SWITCH_SHEET_SUCC:"SWITCH_SHEET_SUCC",REPORT_FILES_TIMES:"REPORT_FILES_TIMES",REPORT_FOR_QUICK_LOOK:"REPORT_FOR_QUICK_LOOK",SHEET_STATUS_REPORT:"SHEET_STATUS_REPORT",SWITCH_SHEET_SPEED:"SWITCH_SHEET_SPEED",RENDER_TRANSFORM_SPEED:"RENDER_TRANSFORM_SPEED",RENDER_CANVAS_SPEED:"RENDER_CANVAS_SPEED",TIME_PASTE_FROM_OUTER_SPEED:"TIME_PASTE_FROM_OUTER_SPEED",TIME_COPY_SPEED:"TIME_COPY_SPEED",HANDDATA_SETSHEETDATA:"HANDDATA_SETSHEETDATA",REPORT_FOR_QL_PV:"REPORT_FOR_QL_PV",REPORT_FOR_PV:"REPORT_FOR_PV",RESET_DEFAULT_TDW_DATA:"RESET_DEFAULT_TDW_DATA",REPORT_FOR_SSR:"REPORT_FOR_SSR",REPORT_FOR_JSONP:"REPORT_FOR_JSONP",PARSE_PUSH_MESSAGE_ERROR:"PARSE_PUSH_MESSAGE_ERROR",MERGE_GRID_RANGE_ERROR:"MERGE_GRID_RANGE_ERROR",MUTATION_QUEUE_MAX_SIZE:"MUTATION_QUEUE_MAX_SIZE",MUTATION_QUEUE_COMPLETE_TIMEOUT:"MUTATION_QUEUE_COMPLETE_TIMEOUT",VIEW_ERROR_INPUT:"VIEW_ERROR_INPUT",VIEW_GET_DIMENSION_OVERFLOW:"VIEW_GET_DIMENSION_OVERFLOW",MUTATION_JANK_NUMBER_FORMAT:"applyMutation_local_25",SHEETS_BAR_JANK_SWITCH_SHEET:"SHEETS_BAR_JANK_SWITCH_SHEET"};!function(e){e.CHECK_MUTATION_ERROR="CheckMutationError",e.RUN_MUTATION_ERROR="RunMutationError",e.DESERIALIZE_MUTATION_ERROR="DeserializeMutationError",e.DESERIALIZE_MUTATION_ERROR_OLD="DeserializeMutationErrorOld"}(p||(p={})),function(e){e.NAVIGATION_TO_FETCH="navigation_to_fetch",e.DNS="dns",e.CONNECT="connect",e.HTML_TTFB="html_ttfb",e.HTML_LOAD="html_load",e.WHITESCREEN="whitescreen",e.SYNC_JS_RUN="sync_js_run",e.DOM_CONTENT_LOAD="dom_content_load",e.KEYFRAME_TRANSFORM="keyframe_transform",e.KEYFRAME_V0_DESERIALIZATION="keyframe_v0_deserialization",e.AFTER_KEYFRAME_RUN="after_keyframe_run",e.MUTATIONS_DESERIALIZATION="mutations_deserialization",e.MUTATIONS_RUN="mutations_run",e.AFTER_MUTATIONS_RUN="after_mutations_run",e.FIRST_SCREEN="first_screen",e.FIRST_SCREEN_NO_SSR="first_screen_no_ssr",e.FIRST_SCREEN_SSR="first_screen_ssr",e.FIRST_SCREEN_CSR="first_screen_csr",e.INTERACTABLE="interactable",e.PART_INTERACTABLE="part_interactable",e.REQUEST_API_READY="request_api_ready",e.REAL_PART_INTERACTABLE="real_part_interactable",e.ENTIRE_INTERACTABLE="entire_interactable",e.AFTER_ALL_RENDER="after_all_render",e.LOAD_CGI_DATA_TIME="load_cgi_data_total_cost",e.LOAD_CGI_DATA_SERVER_COST_TIME="load_cgi_data_server_cost",e.SWITCH_SHEET_TIME="switch_sheet_time",e.EXPORT_FILE_FRONT_DOWNLOAD_TIME="export_file_front_download_time",e.COPY_PASTE_COPY_TIME="copy_paste_copy_time",e.COPY_PASTE_OUTER_PASTE="copy_paste_outer_paste",e.COPY_PASTE_INNER_PASTE="copy_paste_inner_paste",e.HTML_BOTTOM_TO_LOADED="html_bottom_to_loaded"}(h||(h={}));var f,m=((s={})[h.NAVIGATION_TO_FETCH]="[打开]navigation到fetch耗时",s[h.DNS]="[打开]DNS查询",s[h.CONNECT]="[打开]建立连接",s[h.HTML_TTFB]="[打开]html的ttfb耗时",s[h.HTML_LOAD]="[打开]html加载耗时",s[h.WHITESCREEN]="[打开]白屏时间",s[h.SYNC_JS_RUN]="[打开]同步js执行耗时",s[h.DOM_CONTENT_LOAD]="[打开]DomContentLoad耗时",s[h.KEYFRAME_TRANSFORM]="[打开]keyframe解析耗时",s[h.KEYFRAME_V0_DESERIALIZATION]="[打开]导入的keyframeV0反序列化耗时",s[h.AFTER_KEYFRAME_RUN]="[打开]afterKeyframeRun耗时",s[h.MUTATIONS_DESERIALIZATION]="[打开]mutations反序列化耗时",s[h.MUTATIONS_RUN]="[打开]mutations执行耗时",s[h.AFTER_MUTATIONS_RUN]="[打开]afterMutationsRun耗时",s[h.FIRST_SCREEN]="[打开]首屏",s[h.FIRST_SCREEN_NO_SSR]="[打开]首屏无SSR",s[h.FIRST_SCREEN_SSR]="[打开]首屏有SSR",s[h.PART_INTERACTABLE]="[打开]部分可交互",s[h.REQUEST_API_READY]="[打开]requestAPI完成初始化",s[h.REAL_PART_INTERACTABLE]="[打开]部分真实可交互",s[h.ENTIRE_INTERACTABLE]="[打开]完整可交互",s[h.AFTER_ALL_RENDER]="[打开]整体渲染结束",s[h.LOAD_CGI_DATA_TIME]="[打开]opendoc整体耗时",s[h.LOAD_CGI_DATA_SERVER_COST_TIME]="[打开]opendoc后台耗时",s[h.SWITCH_SHEET_TIME]="[编辑]切表耗时",s[h.EXPORT_FILE_FRONT_DOWNLOAD_TIME]="[导出]前端下载耗时",s[h.COPY_PASTE_COPY_TIME]="[编辑]复制耗时",s[h.COPY_PASTE_OUTER_PASTE]="[编辑]外部粘贴耗时",s[h.COPY_PASTE_INNER_PASTE]="[编辑]内部粘贴耗时",s);!function(e){e.PV="pv",e.OPENDOC_LOAD_FAIL="关键数据获取失败",e.FIRST_SCREEN_CHUNK_DATA_LOAD_FAIL="核心cgi请求失败率",e.SOCKET_COMMIT_ERROR="关键请求失败",e.MUTATION_APPLY_TO_MODEL_ERROR="mutation应用到数据层出错",e.MUTATION_APPLY_TO_VIEW_ERROR="mutation应用到渲染层出错",e.APPLY_NEW_CHANGES_ERROR="协同数据应用失败",e.NO_SOCKET_AFTER_90S="90秒以内未和后台建立编辑通道",e.SOCKET_SHUTDOWN="后台编辑通道被关闭",e.SYNC_OFFLINE_DATA_ERROR="同步离线数据出错",e.FULL_MEMBER_FETCH_DATA_FAIL="满员拉取数据失败",e.HOTDOCS_FETCH_DATA_FAIL="hotDocs文档数据拉取失败",e.WORKER_JS_NOTFOUND="worker加载404",e.WORKER_COMMUNICATION_FAIL="worker通信失败",e.FIRST_SCREEN_TIME="首屏可见耗时",e.INTERACTABLE_TIME="可交互耗时",e.FIRST_SCREEN_TIME_IN_5S="5s打开成功率",e.JS_ERROR="JS报错数",e.STUTTERS="运行期间卡顿数",e.OFFLINE_INDEXDB_NOT_AVAILABLE="离线状态下indexdb不可用",e.FORMULA_WASM_LOADED="加载 formula wasm 成功",e.FORMULA_WASM_RUN="执行 formula wasm 成功",e.JS_FLOW_ERROR="flow流程加载报错"}(f||(f={}));var v="proactive_report_error"},"../spread-sheet/src/base/config/version.ts":function(e,t){t.Z={KEYFRAME_VER:5,KEYFRAME_VER_LOWEST_SUPPORT:3,CODE_VER:1,CLIENT_VER:1}},"../spread-sheet/src/base/dynamicImport/config.ts":function(e,t){var n;!function(e){e[e.CORE_SHEET=0]="CORE_SHEET",e[e.CORE_SHEET_LAZY=1]="CORE_SHEET_LAZY",e[e.SPREADSHEET_APP_EDIT=2]="SPREADSHEET_APP_EDIT",e[e.VIEW_TABLECONTENT_LAZY=3]="VIEW_TABLECONTENT_LAZY",e[e.SPREADSHEET_APP_TOOL_LAZY=4]="SPREADSHEET_APP_TOOL_LAZY",e[e.ERROR_CODE=5]="ERROR_CODE",e[e.ERROR_CODE_MODAL=6]="ERROR_CODE_MODAL",e[e.REPORT=7]="REPORT",e[e.MESSAGE_CENTER=8]="MESSAGE_CENTER",e[e.SOCKET=9]="SOCKET",e[e.REQUEST_API=10]="REQUEST_API",e[e.CALCCONTROLLER=11]="CALCCONTROLLER",e[e.PC_SIDE_CANVAS=12]="PC_SIDE_CANVAS",e[e.PAD_SIDE_CANVAS=13]="PAD_SIDE_CANVAS",e[e.MOBILE_SIDE_CANVAS=14]="MOBILE_SIDE_CANVAS",e[e.EXCEL_PLUGIN_PC=15]="EXCEL_PLUGIN_PC",e[e.EXCEL_PLUGIN_MOBILE=16]="EXCEL_PLUGIN_MOBILE",e[e.EXCEL_PLUGIN_PAD=17]="EXCEL_PLUGIN_PAD",e[e.FEATURE=18]="FEATURE",e[e.PREVIEW_FEATURE=19]="PREVIEW_FEATURE",e[e.PC_HEADER=20]="PC_HEADER",e[e.MOBILE_HEADER=21]="MOBILE_HEADER",e[e.PC_TOOL_BAR=22]="PC_TOOL_BAR",e[e.MOBILE_TOOL_BAR=23]="MOBILE_TOOL_BAR",e[e.PC_SHEET_BAR=24]="PC_SHEET_BAR",e[e.MOBILE_SHEET_BAR=25]="MOBILE_SHEET_BAR",e[e.PAD_SHEET_BAR=26]="PAD_SHEET_BAR",e[e.READONLY_SHEETSBAR=27]="READONLY_SHEETSBAR",e[e.SHEETSBAR_MANAGE=28]="SHEETSBAR_MANAGE",e[e.MOBILE_DISCUSS=29]="MOBILE_DISCUSS",e[e.PAD_HISTORY=30]="PAD_HISTORY",e[e.PC_HISTORY=31]="PC_HISTORY",e[e.MOBILE_HISTORY=32]="MOBILE_HISTORY",e[e.PREVIEW=33]="PREVIEW",e[e.FILE=34]="FILE",e[e.WORKBENCH=35]="WORKBENCH",e[e.OFFLINE_EDIT=36]="OFFLINE_EDIT",e[e.UI_MANAGER=37]="UI_MANAGER",e[e.PC_RANGE_AUTH=38]="PC_RANGE_AUTH",e[e.MOBILE_RANGE_AUTH=39]="MOBILE_RANGE_AUTH",e[e.WATERMARK=40]="WATERMARK",e[e.TITLE_SYNC=41]="TITLE_SYNC",e[e.DOCUMENT_SYNC=42]="DOCUMENT_SYNC",e[e.FULL_MEMBER=43]="FULL_MEMBER",e[e.USER_GUIDE=44]="USER_GUIDE",e[e.RESET_LOCATION=45]="RESET_LOCATION",e[e.SERRCH_REPLACE=46]="SERRCH_REPLACE",e[e.SHARE=47]="SHARE",e[e.MENTION=48]="MENTION",e[e.MENTION_MOBILE=49]="MENTION_MOBILE",e[e.ARIA_HELP=50]="ARIA_HELP",e[e.SHEET_EXPORT_MANAGER=51]="SHEET_EXPORT_MANAGER",e[e.AUTO_URL=52]="AUTO_URL",e[e.INPUT_AUTOFILL=53]="INPUT_AUTOFILL",e[e.JS_SDK_SERVICE=54]="JS_SDK_SERVICE"}(n||(n={})),t.Z=n},"../spread-sheet/src/base/dynamicImport/index.ts":function(e,t,n){n.d(t,{ZP:function(){return c}}),n("../node_modules/regenerator-runtime/runtime.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.promise.js"),n("../node_modules/core-js/modules/es.array.iterator.js"),n("../node_modules/core-js/modules/es.string.iterator.js"),n("../node_modules/core-js/modules/web.dom-collections.iterator.js"),n("../spread-sheet/src/base/util/domain-config.ts");var r=n("../spread-sheet/src/base/dynamicImport/config.ts"),o=function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function a(e){try{c(r.next(e))}catch(t){s(t)}}function i(e){try{c(r.throw(e))}catch(t){s(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,i)}c((r=r.apply(e,t||[])).next())}))},s=function(){function e(e){this.stack=[],this.parent=e}var t=e.prototype;return t.add=function(e,t){Array.isArray(e)||(e=[e]),this.stack.push({chainNode:e,callback:t})},t.executeNode=function(e){return o(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n,r,o,s,a,i;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=e.chainNode.length,r=0,o=[],s=0;case 4:if(!(e.chainNode&&s<e.chainNode.length)){t.next=19;break}if(a=e.chainNode[s]){t.next=8;break}return t.abrupt("continue",16);case 8:return t.next=10,this.parent.getModule(a);case 10:if(i=t.sent,o.push(i),(r+=1)!==n){t.next=16;break}return e.callback(o),t.abrupt("return",o);case 16:s++,t.next=4;break;case 19:case"end":return t.stop()}}),t,this)})))},t.run=function(){return o(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==this.stack.length){e.next=2;break}return e.abrupt("return");case 2:if(t=this.stack.shift()){e.next=5;break}return e.abrupt("return");case 5:return e.next=7,this.executeNode(t);case 7:this.run();case 8:case"end":return e.stop()}}),e,this)})))},e}(),a=function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function a(e){try{c(r.next(e))}catch(t){s(t)}}function i(e){try{c(r.throw(e))}catch(t){s(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,i)}c((r=r.apply(e,t||[])).next())}))};function i(e){var t=this,n=null;return function(){for(var r=arguments.length,o=new Array(r),s=0;s<r;s++)o[s]=arguments[s];return n||(n=e.apply(t,o))}}var c=new(function(){function e(e){this._modules=e}var t=e.prototype;return t.getModule=function(e){return a(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n,r,o;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=this._modules.length,r=0;case 2:if(!(r<n)){t.next=11;break}if(this._modules[r].moduleName!==e){t.next=8;break}return o=this._modules[r],t.next=7,i(o.modulePath)();case 7:return t.abrupt("return",t.sent);case 8:r++,t.next=2;break;case 11:case"end":return t.stop()}}),t,this)})))},t.getSpreadSheetToolLazy=function(){return a(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getModule(r.Z.SPREADSHEET_APP_TOOL_LAZY);case 2:return t=e.sent,e.abrupt("return",t);case 4:case"end":return e.stop()}}),e,this)})))},t.loadCoreSheetLazyModule=function(){return a(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getModule(r.Z.CORE_SHEET_LAZY);case 2:return t=e.sent,e.abrupt("return",t);case 4:case"end":return e.stop()}}),e,this)})))},t.createChain=function(){return new s(this)},e}())([{moduleName:r.Z.SPREADSHEET_APP_TOOL_LAZY,modulePath:function(){return a(void 0,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([n.e("vendors-node_modules_atob_browser-atob_js-node_modules_pako_index_js"),n.e("bundle_spreadsheet_tool_lazy")]).then(n.bind(n,"../spread-sheet/src/core/app/lazytool/index.ts"));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))}},{moduleName:r.Z.ERROR_CODE,modulePath:function(){return a(void 0,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([n.e("bundle_vendors_workbench"),n.e("initial_vendors_tencent_dui"),n.e("initial_vendors_tencent_4"),n.e("vendors-node_modules_tencent_docs-service-worker_lib_index_esm_js"),n.e("spread-sheet_src_core_workbench_common_base-drawer_tsx-spread-sheet_src_external_rangeAuth_ut-2939e0"),n.e("spread-sheet_src_external_view_ui-layer_range-auth_components_range-auth-drawer_tsx"),n.e("spread-sheet_src_core_view_level-2_mention_api_MentionApi_ts-spread-sheet_src_external_rangeA-10e443"),n.e("bundle_plugin_common_init")]).then(n.bind(n,"../spread-sheet/src/external/errorCode/ErrorCode.ts"));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))}},{moduleName:r.Z.ERROR_CODE_MODAL,modulePath:function(){return a(void 0,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([n.e("bundle_vendors_workbench"),n.e("initial_vendors_tencent_dui"),n.e("initial_vendors_tencent_4"),n.e("vendors-node_modules_tencent_docs-service-worker_lib_index_esm_js"),n.e("spread-sheet_src_core_workbench_common_base-drawer_tsx-spread-sheet_src_external_rangeAuth_ut-2939e0"),n.e("spread-sheet_src_external_view_ui-layer_range-auth_components_range-auth-drawer_tsx"),n.e("spread-sheet_src_core_view_level-2_mention_api_MentionApi_ts-spread-sheet_src_external_rangeA-10e443"),n.e("bundle_plugin_common_init")]).then(n.bind(n,"../spread-sheet/src/external/errorUI/index.ts"));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))}},{moduleName:r.Z.REPORT,modulePath:function(){return a(void 0,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([n.e("bundle_vendors_workbench"),n.e("initial_vendors_tencent_dui"),n.e("initial_vendors_tencent_4"),n.e("vendors-node_modules_tencent_docs-service-worker_lib_index_esm_js"),n.e("spread-sheet_src_core_workbench_common_base-drawer_tsx-spread-sheet_src_external_rangeAuth_ut-2939e0"),n.e("spread-sheet_src_external_view_ui-layer_range-auth_components_range-auth-drawer_tsx"),n.e("spread-sheet_src_core_view_level-2_mention_api_MentionApi_ts-spread-sheet_src_external_rangeA-10e443"),n.e("bundle_plugin_common_init")]).then(n.bind(n,"../spread-sheet/src/external/report/index.ts"));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))}},{moduleName:r.Z.MOBILE_HEADER,modulePath:function(){return a(void 0,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([n.e("bundle_vendors_workbench"),n.e("initial_vendors_tencent_dui"),n.e("initial_vendors_tencent_4"),n.e("vendors-node_modules_tencent_facade-config_dist_index_js"),n.e("vendors-node_modules_react-transition-group_index_js"),n.e("vendors-node_modules_tencent_alloyreport-sdk_dist_alloyreport_inline_js-node_modules_tencent_-391aaf"),n.e("spread-sheet_src_core_view_level-2_condition-format-center_ui_utils_dataUtils_ts"),n.e("spread-sheet_src_external_check-slr_sc-lazy-loader_ts-spread-sheet_src_external_templateinfo_-54b3ca"),n.e("spread-sheet_src_core_utils_gray_ts-spread-sheet_src_core_view_level-2_condition-format-cente-74d507"),n.e("bundle_view_header")]).then(n.bind(n,"../spread-sheet/src/external/view/mobile/header/index.tsx"));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))}},{moduleName:r.Z.MOBILE_TOOL_BAR,modulePath:function(){return a(void 0,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([n.e("bundle_vendors_workbench"),n.e("initial_vendors_tencent_dui"),n.e("initial_vendors_tencent_4"),n.e("initial_vendors_public_1"),n.e("vendors-node_modules_react-transition-group_index_js"),n.e("spread-sheet_src_external_view_mobile_toolbar_quick-panel_quick-panel-component_index_less-sp-8a755a"),n.e("bundle_view_toolbar")]).then(n.bind(n,"../spread-sheet/src/external/view/mobile/toolbar/index.ts"));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))}},{moduleName:r.Z.MOBILE_DISCUSS,modulePath:function(){return a(void 0,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([n.e("spread-sheet_src_external_view_ui-layer_range-auth_components_range-auth-drawer_tsx"),n.e("spread-sheet_src_core_view_level-2_mention_api_MentionApi_ts-spread-sheet_src_external_rangeA-10e443"),n.e("bundle_plugin_m_init")]).then(n.bind(n,"../spread-sheet/src/external/view/discuss/mobileDiscuss.ts"));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))}},{moduleName:r.Z.PC_RANGE_AUTH,modulePath:function(){return a(void 0,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([n.e("bundle_vendors_workbench"),n.e("initial_vendors_tencent_dui"),n.e("initial_vendors_tencent_4"),n.e("vendors-node_modules_tencent_docs-service-worker_lib_index_esm_js"),n.e("spread-sheet_src_core_workbench_common_base-drawer_tsx-spread-sheet_src_external_rangeAuth_ut-2939e0"),n.e("spread-sheet_src_external_view_ui-layer_range-auth_components_range-auth-drawer_tsx"),n.e("spread-sheet_src_core_view_level-2_mention_api_MentionApi_ts-spread-sheet_src_external_rangeA-10e443"),n.e("bundle_plugin_common_init")]).then(n.bind(n,"../spread-sheet/src/external/rangeAuth/range-auth-plugin.pc.ts"));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))}},{moduleName:r.Z.MOBILE_RANGE_AUTH,modulePath:function(){return a(void 0,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([n.e("spread-sheet_src_external_view_ui-layer_range-auth_components_range-auth-drawer_tsx"),n.e("spread-sheet_src_core_view_level-2_mention_api_MentionApi_ts-spread-sheet_src_external_rangeA-10e443"),n.e("bundle_plugin_m_init")]).then(n.bind(n,"../spread-sheet/src/external/rangeAuth/range-auth-plugin.m.ts"));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))}},{moduleName:r.Z.WATERMARK,modulePath:function(){return a(void 0,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([n.e("bundle_vendors_workbench"),n.e("initial_vendors_tencent_dui"),n.e("initial_vendors_tencent_4"),n.e("vendors-node_modules_tencent_docs-service-worker_lib_index_esm_js"),n.e("spread-sheet_src_core_workbench_common_base-drawer_tsx-spread-sheet_src_external_rangeAuth_ut-2939e0"),n.e("spread-sheet_src_external_view_ui-layer_range-auth_components_range-auth-drawer_tsx"),n.e("spread-sheet_src_core_view_level-2_mention_api_MentionApi_ts-spread-sheet_src_external_rangeA-10e443"),n.e("bundle_plugin_common_init")]).then(n.bind(n,"../spread-sheet/src/external/waterMark/watermark-controller.ts"));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))}},{moduleName:r.Z.DOCUMENT_SYNC,modulePath:function(){return a(void 0,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([n.e("bundle_vendors_workbench"),n.e("initial_vendors_tencent_dui"),n.e("initial_vendors_tencent_4"),n.e("vendors-node_modules_tencent_docs-service-worker_lib_index_esm_js"),n.e("spread-sheet_src_core_workbench_common_base-drawer_tsx-spread-sheet_src_external_rangeAuth_ut-2939e0"),n.e("spread-sheet_src_external_view_ui-layer_range-auth_components_range-auth-drawer_tsx"),n.e("spread-sheet_src_core_view_level-2_mention_api_MentionApi_ts-spread-sheet_src_external_rangeA-10e443"),n.e("bundle_plugin_common_init")]).then(n.bind(n,"../spread-sheet/src/external/documentInfoSync/DocumentInfoSync.ts"));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))}},{moduleName:r.Z.FULL_MEMBER,modulePath:function(){return a(void 0,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([n.e("bundle_vendors_workbench"),n.e("initial_vendors_tencent_dui"),n.e("initial_vendors_tencent_4"),n.e("vendors-node_modules_tencent_docs-service-worker_lib_index_esm_js"),n.e("spread-sheet_src_core_workbench_common_base-drawer_tsx-spread-sheet_src_external_rangeAuth_ut-2939e0"),n.e("spread-sheet_src_external_view_ui-layer_range-auth_components_range-auth-drawer_tsx"),n.e("spread-sheet_src_core_view_level-2_mention_api_MentionApi_ts-spread-sheet_src_external_rangeA-10e443"),n.e("bundle_plugin_common_init")]).then(n.bind(n,"../spread-sheet/src/external/fullMember/fullMember.ts"));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))}},{moduleName:r.Z.USER_GUIDE,modulePath:function(){return a(void 0,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([n.e("bundle_vendors_workbench"),n.e("initial_vendors_tencent_dui"),n.e("initial_vendors_tencent_4"),n.e("vendors-node_modules_tencent_docs-service-worker_lib_index_esm_js"),n.e("spread-sheet_src_core_workbench_common_base-drawer_tsx-spread-sheet_src_external_rangeAuth_ut-2939e0"),n.e("spread-sheet_src_external_view_ui-layer_range-auth_components_range-auth-drawer_tsx"),n.e("spread-sheet_src_core_view_level-2_mention_api_MentionApi_ts-spread-sheet_src_external_rangeA-10e443"),n.e("bundle_plugin_common_init")]).then(n.bind(n,"../spread-sheet/src/external/userGuide/userGuide.ts"));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))}},{moduleName:r.Z.UI_MANAGER,modulePath:function(){return a(void 0,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([n.e("bundle_vendors_workbench"),n.e("initial_vendors_tencent_dui"),n.e("initial_vendors_tencent_4"),n.e("vendors-node_modules_tencent_docs-service-worker_lib_index_esm_js"),n.e("spread-sheet_src_core_workbench_common_base-drawer_tsx-spread-sheet_src_external_rangeAuth_ut-2939e0"),n.e("spread-sheet_src_external_view_ui-layer_range-auth_components_range-auth-drawer_tsx"),n.e("spread-sheet_src_core_view_level-2_mention_api_MentionApi_ts-spread-sheet_src_external_rangeA-10e443"),n.e("bundle_plugin_common_init")]).then(n.bind(n,"../spread-sheet/src/external/uiManager/uiManager.ts"));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))}},{moduleName:r.Z.RESET_LOCATION,modulePath:function(){return a(void 0,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.e("bundle_plugin_resetlocation").then(n.bind(n,"../spread-sheet/src/external/resetLocation/index.ts"));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))}},{moduleName:r.Z.SHARE,modulePath:function(){return a(void 0,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([n.e("spread-sheet_src_external_view_ui-layer_range-auth_components_range-auth-drawer_tsx"),n.e("spread-sheet_src_core_view_level-2_mention_api_MentionApi_ts-spread-sheet_src_external_rangeA-10e443"),n.e("bundle_plugin_m_init")]).then(n.bind(n,"../spread-sheet/src/external/share/index.ts"));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))}},{moduleName:r.Z.CORE_SHEET,modulePath:function(){return a(void 0,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([n.e("bundle_vendors_workbench"),n.e("initial_vendors_tencent_dui"),n.e("initial_vendors_tencent_4"),n.e("vendors-node_modules_tencent_docs-service-worker_lib_index_esm_js"),n.e("spread-sheet_src_core_workbench_common_base-drawer_tsx-spread-sheet_src_external_rangeAuth_ut-2939e0"),n.e("spread-sheet_src_external_view_ui-layer_range-auth_components_range-auth-drawer_tsx"),n.e("spread-sheet_src_core_view_level-2_mention_api_MentionApi_ts-spread-sheet_src_external_rangeA-10e443"),n.e("bundle_plugin_common_init")]).then(n.bind(n,"../core-sheet/js/index.js"));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))}},{moduleName:r.Z.REQUEST_API,modulePath:function(){return a(void 0,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([n.e("initial_vendors_public_1"),n.e("initial_chunk_part_2"),n.e("vendors-node_modules_atob_browser-atob_js-node_modules_pako_index_js"),n.e("spread-sheet_src_core_app_dataCallCore_ts-spread-sheet_src_external_view_workbench_service_cr-4ddb4c"),n.e("bundle_module_behavior_api")]).then(n.bind(n,"../spread-sheet/src/core/behavior/api.ts"));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))}},{moduleName:r.Z.MENTION,modulePath:function(){return a(void 0,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.next=6;break;case 3:e.t0=e.sent,e.next=9;break;case 6:return e.next=8,n.e("bundle_plugin_mention").then(n.bind(n,"../spread-sheet/src/external/mention/mentionPlugin.ts"));case 8:e.t0=e.sent;case 9:return e.abrupt("return",e.t0);case 10:case"end":return e.stop()}}),e)})))}},{moduleName:r.Z.PAD_HISTORY,modulePath:function(){return a(void 0,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.e("bundle_plugin_history").then(n.bind(n,"../spread-sheet/src/external/history/pad/History.tsx"));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))}},{moduleName:r.Z.PC_HISTORY,modulePath:function(){return a(void 0,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.e("bundle_plugin_history").then(n.bind(n,"../spread-sheet/src/external/history/pc/History.tsx"));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))}},{moduleName:r.Z.MOBILE_HISTORY,modulePath:function(){return a(void 0,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.e("bundle_plugin_history").then(n.bind(n,"../spread-sheet/src/external/history/m/History.tsx"));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))}},{moduleName:r.Z.MENTION_MOBILE,modulePath:function(){return a(void 0,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.next=6;break;case 3:e.t0=e.sent,e.next=9;break;case 6:return e.next=8,n.e("bundle_plugin_mention").then(n.bind(n,"../spread-sheet/src/external/mention/mentionPlugin.ts"));case 8:e.t0=e.sent;case 9:return e.abrupt("return",e.t0);case 10:case"end":return e.stop()}}),e)})))}},{moduleName:r.Z.ARIA_HELP,modulePath:function(){return a(void 0,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([n.e("bundle_vendors_workbench"),n.e("initial_vendors_tencent_dui"),n.e("initial_vendors_tencent_4"),n.e("vendors-node_modules_tencent_docs-service-worker_lib_index_esm_js"),n.e("spread-sheet_src_core_workbench_common_base-drawer_tsx-spread-sheet_src_external_rangeAuth_ut-2939e0"),n.e("spread-sheet_src_external_view_ui-layer_range-auth_components_range-auth-drawer_tsx"),n.e("spread-sheet_src_core_view_level-2_mention_api_MentionApi_ts-spread-sheet_src_external_rangeA-10e443"),n.e("bundle_plugin_common_init")]).then(n.bind(n,"../spread-sheet/src/external/ariaHelp/index.ts"));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))}},{moduleName:r.Z.SHEET_EXPORT_MANAGER,modulePath:function(){return a(void 0,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([n.e("vendors-node_modules_atob_browser-atob_js-node_modules_pako_index_js"),n.e("spread-sheet_src_core_feature_dataValidation_api_DataValidationError_ts-spread-sheet_src_core-860e25"),n.e("bundle_plugin_sheet_export_manager")]).then(n.bind(n,"../spread-sheet/src/external/export/SheetExportManager.ts"));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))}},{moduleName:r.Z.AUTO_URL,modulePath:function(){return a(void 0,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.e("bundle_plugin_auto_url").then(n.bind(n,"../spread-sheet/src/external/autoUrl/index.ts"));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))}},{moduleName:r.Z.INPUT_AUTOFILL,modulePath:function(){return a(void 0,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.e("bundle_plugin_inputautofill").then(n.bind(n,"../spread-sheet/src/external/inputAutofill/index.tsx"));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))}},{moduleName:r.Z.JS_SDK_SERVICE,modulePath:function(){return a(void 0,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([n.e("spread-sheet_src_external_view_ui-layer_range-auth_components_range-auth-drawer_tsx"),n.e("spread-sheet_src_core_view_level-2_mention_api_MentionApi_ts-spread-sheet_src_external_rangeA-10e443"),n.e("bundle_plugin_m_init")]).then(n.bind(n,"../spread-sheet/src/external/load-sdk/index.ts"));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))}}])},"../spread-sheet/src/base/error/error-code-report.ts":function(e,t,n){n.d(t,{V:function(){return u}});var r=n("../spread-sheet/src/core/data/configService/spreadConfig.ts"),o=n("../node_modules/@tencent/docs-multi-tools/dist/index.js"),s=n("../node_modules/@tencent/tencent-doc-report/libs/tencent-doc-report.es.js"),a=n("../packages/report/src/index.ts"),i=n("../packages/common-utils/src/index.ts"),c=n("../node_modules/@tencent/docs-opentelemetry/lib/index.esm.js");function u(e){if("test"!==(0,i.IZ)("mode")){var t=e.errorCode,u=e.message,d=e.snackbarMsg,l=void 0===d?"":d,p=e.type,h=void 0===p?"error":p,_=e.tipsCustom,f=e.padType,m=void 0===f?s.LogPadType.Sheet:f,v=n.g.location.href,E=(0,o.getUid)(),g=r.q.getConfig("isLogin"),R={errorCode:t,message:u,padType:m,uid:E,url:v,snackbarMsg:l,tipsCustom:JSON.stringify(_),type:h,isLogin:g},S=(0,c.vt)("sheet");a.ZP.tipReport(R,S)}}},"../spread-sheet/src/base/error/errorCodeModalProxy.ts":function(e,t,n){n.d(t,{f:function(){return r}}),n("../node_modules/core-js/modules/web.dom-collections.for-each.js"),n("../node_modules/core-js/modules/es.regexp.exec.js"),n("../node_modules/core-js/modules/es.string.split.js");var r=function(){function e(e){this.cache=[],this.funcName=e,this.module=null,this.init()}e.eachLoad=function(t){e.stack.forEach((function(e){e.initLoad(t)}))};var t=e.prototype;return t.init=function(){e.stack.push(this)},t.getExecuteObj=function(e,t){var n=t.shift();return n?0===t.length?{self:e,func:e[n]}:this.getExecuteObj(e[n],t):e},t.execute=function(){for(var e=this.funcName.split("."),t=this.getExecuteObj(this.module,e),n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return t.func.apply(t.self,r)},t.initLoad=function(e){this.module=e,this.cache.length&&this.cache.forEach((function(e){e()}))},t.getProxy=function(e){var t=this;return void 0===e&&(e=!1),function(){for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return t.module?t.execute.apply(t,r):e?null:void t.cache.push((function(){return t.execute.apply(t,r)}))}},e}();r.stack=[];var o={client:{showNetworkOfflineTip:new r("client.showNetworkOfflineTip").getProxy(),showSaveFrontEndErrorTip:new r("client.showSaveFrontEndErrorTip").getProxy(),showLoginExpiredTip:new r("client.showLoginExpiredTip").getProxy(),showUnAuthTip:new r("client.showUnAuthTip").getProxy(),showBigDataFromFrontTip:new r("client.showBigDataFromFrontTip").getProxy(),showSecurityTip:new r("client.showSecurityTip").getProxy(),showSheetBarDuplicateSheetId:new r("client.showSheetBarDuplicateSheetId").getProxy(),showPermissionChangesTip:new r("client.showPermissionChangesTip").getProxy(),showUserChangeSaveSuccessTip:new r("client.showUserChangeSaveSuccessTip").getProxy(),showUserChangeSaveFailTip:new r("client.showUserChangeSaveFailTip").getProxy(),showNetOfflineErrorTip:new r("client.showNetOfflineErrorTip").getProxy(),showOfflineSyncError:new r("client.showOfflineSyncError").getProxy(),showOfflineEditingTip:new r("client.showOfflineEditingTip").getProxy(),showSavedText:new r("client.showSavedText").getProxy(),showServerConnectFailTip:new r("client.showServerConnectFailTip").getProxy(),showCommonErrorModal1:new r("client.showCommonErrorModal1").getProxy(),showCommonCrashAndFeedBackModal:new r("client.showCommonCrashAndFeedBackModal").getProxy(),showDatabaseErrorModal:new r("client.showDatabaseErrorModal").getProxy(),showFileNotExsitErrorTip:new r("client.showFileNotExsitErrorTip").getProxy()},server:{showServerErrorTip:new r("server.showServerErrorTip").getProxy(),showServerConnectTimeout:new r("server.showServerConnectTimeout").getProxy(),showServerTaskTimeout:new r("server.showServerTaskTimeout").getProxy(),showFullMemberTip:new r("server.showFullMemberTip").getProxy(),showBigDataFromServerTip:new r("server.showBigDataFromServerTip").getProxy(),showFrequentEditTip:new r("server.showFrequentEditTip").getProxy(),showSaveBackEndErrorTip:new r("server.showSaveBackEndErrorTip").getProxy(),showUpgradeTip:new r("server.showUpgradeTip").getProxy(),showBlacklistBlock:new r("server.showBlacklistBlock").getProxy(),showUpdatePadTip:new r("server.showUpdatePadTip").getProxy(),showApplyNewChangeErrorTip:new r("server.showApplyNewChangeErrorTip").getProxy(),switchSheetError:new r("server.switchSheetError").getProxy(),checkVipToast:new r("server.checkVipToast").getProxy(),showFullMemberTipWithRefresh:new r("server.showFullMemberTipWithRefresh").getProxy(),showRefreshTips:new r("server.showRefreshTips").getProxy(),showFileDeletedTip:new r("server.showFileDeletedTip").getProxy(),showOverMaxAmountFromServerTip:new r("server.showOverMaxAmountFromServerTip").getProxy(),docOccupiedTips:new r("server.docOccupiedTips").getProxy(),meetingErrorTips:new r("server.meetingErrorTips").getProxy()},portraitToast:new r("portraitToast").getProxy(),changePermission:new r("changePermission").getProxy(),showFormulaLayerCalcErrorTips:new r("showFormulaLayerCalcErrorTips").getProxy()};t.Z=o},"../spread-sheet/src/base/error/index.ts":function(e,t,n){n.d(t,{B:function(){return d}}),n("../node_modules/core-js/modules/es.object.assign.js");var r={LOGIN_SWITCHED:"010001",SHOW_RELOGIN:"010002",PS_KEY_ERROR:"010003",LOGGED_OUT:"010004",LOGIN_ERROR:"010005"},o={MUTATION_SHEET_ID_NOT_MATCH_SHEET:"S0001",SHEET_ID_NOT_EXIST:"S0002",MUTATION_SHEET_ID_NOT_BELONG_TO_WORKBOOK:"S0003",SHEET_ID_INIT_OLD_DUPLICATE:"S0004",SHEET_ID_SHEET_BAR_OLD_DUPLICATE:"S0005",SHEET_ID_SHEET_BAR_NEW_DUPLICATE:"S0006",SHEET_FETCH_ERROR:"S0007",SHEET_FETCH_FRONT_ERROR:"S0008"},s={APPLY_NEW_CHANGE_ERROR:"D0001",REQUEST_SIZE_LIMIT:"D0002",DATA_VERSION_TOO_LOW:"D0003",DATABASE_ERROR:"Z0001"},a={KICK:"N0001",RELOAD:"N0002",SOCKET_NOT_SET_UP:"N0003",OFFLINE_INDEXDB_NOT_AVAILABLE:"N0004",COMMIT_ERROR_CODE_UNDEFINED:"N0005",COMMITING_QUEUE_BLOCK:"N0006",FRONTEND_SOCKET_ERROR_CODE_UNDEFINED:"N0007",PERMISSION_CHANGE:"N0008",FULL_MEMBER:"N0009",LONG_TIME_HIDDEN:"N0010",OFFLINE_SYNC_ERROR:"N0011",RECONNECT_FAIL:"N0012",TASK_DUPLICATE_VERSION_TOO_LOW:"D0004",KEYFRAME_UNZIP_ERROR:"K0001",TASK_RUN_ERROR:"T0001"},i={RESPONSE_NOT_CONTINUE:"F0001",TO_LESS_THAN_FROM:"F0002",CGI_HTTP_ERROR:"F0003",RESPONSE_DATA_EMPTY:"F0004",RESPONSE_ARRAY_EMPTY:"F0005",RESPONSE_ERROR_CODE:"F0006"},c={PASTE_IMAGE_FROM_OUTER:"060001"},u={LOAD_NEW_DOC:"LOAD_NEW_DOC"},d=Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},r),o),s),a),i),c),u)},"../spread-sheet/src/base/event/event.ts":function(e,t,n){n.d(t,{ju:function(){return d},l9:function(){return l},ZP:function(){return u}}),n("../node_modules/core-js/modules/es.object.assign.js"),n("../node_modules/core-js/modules/web.dom-collections.for-each.js"),n("../node_modules/core-js/modules/es.object.keys.js"),n("../node_modules/core-js/modules/es.array.splice.js");var r=function(){var e=function(){var e=Array.prototype.shift,t=Array.prototype.unshift,n={},r=function(e,t){for(var n,r=e.length-1;r>=0;r--){var o=e[r];o&&(n=t.call(o,r,o))}return n},o=function(e,t,n){if(t[e]&&n)for(var r=t[e].length-1;r>=0;r--)if("function"===typeof t[e][r]&&t[e][r].once){t[e].splice(r,1);break}},s=function(){for(var t=arguments.length,n=new Array(t),s=0;s<t;s++)n[s]=arguments[s];var a=e.call(n),i=e.call(n),c=this,u=a[i];if(u&&u.length)return r(u,(function(){var e=this.apply(c,n);return this.once&&o(i,a,this),e}))};return{create:function(e){var o={},a=[],i={listen:function(e,t,n){!function(e,t,n){n[e]||(n[e]=[]),n[e].unshift(t)}(e,t,o);var s=a[e];void 0!==s?"listened"!==s&&Array.isArray(s)&&("last"===n?s.length&&s.pop()():"ignoreOffline"===n||r(s,(function(){this()})),a[e]="listened"):a[e]="listened"},one:function(e,t,n){this.listen(e,t,n),t.once=!0},remove:function(e,t){!function(e,t,n){if(t[e])if(n)for(var r=t[e].length;r>=0;r--)t[e][r]===n&&t[e].splice(r,1);else t[e]=[]}(e,o,t)},removeAll:function(){Object.keys(o).forEach((function(e){delete o[e]}))},trigger:function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];var i=this;t.call(n,o);var c=function(){return s.apply(i,n)},u=n[1];return"listened"===a[u]?c():(a[u]||(a[u]=[]),Array.isArray(a[u])?a[u].unshift(c):void 0)},destroy:function(){this.removeAll()}};return(e=e||"default")?n[e]?n[e]:n[e]=i:i}}}();return e}(),o=function(){var e=function(e){return r.create(e)};return{create:e,init:function(){return e("default")}}}(),s=(n("../node_modules/core-js/modules/es.array.iterator.js"),n("../node_modules/core-js/modules/es.map.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.string.iterator.js"),n("../node_modules/core-js/modules/esnext.map.delete-all.js"),n("../node_modules/core-js/modules/esnext.map.every.js"),n("../node_modules/core-js/modules/esnext.map.filter.js"),n("../node_modules/core-js/modules/esnext.map.find.js"),n("../node_modules/core-js/modules/esnext.map.find-key.js"),n("../node_modules/core-js/modules/esnext.map.includes.js"),n("../node_modules/core-js/modules/esnext.map.key-of.js"),n("../node_modules/core-js/modules/esnext.map.map-keys.js"),n("../node_modules/core-js/modules/esnext.map.map-values.js"),n("../node_modules/core-js/modules/esnext.map.merge.js"),n("../node_modules/core-js/modules/esnext.map.reduce.js"),n("../node_modules/core-js/modules/esnext.map.some.js"),n("../node_modules/core-js/modules/esnext.map.update.js"),n("../node_modules/core-js/modules/web.dom-collections.iterator.js"),n("../spread-sheet/src/base/util/type.ts")),a=function(){function e(e){this.parent=e,this.cache=new Map}var t=e.prototype;return t.listen=function(e,t){if(this.parent&&this.parent.addEventListener)switch(e){case"resize":return this.bind(e,t,200);case"mousemoveLazy":return this.bind("mousemove",t,200);case"mousedown":case"mousemove":case"mouseup":case"keyup":case"keydown":case"click":case"touchstart":case"touchmove":case"touchend":case"popState":return this.bind(e,t);case"visibilitychange":case"mozvisibilitychange":case"msvisibilitychange":case"webkitvisibilitychange":return this.bind("visibilitychange",t);default:throw new Error(e+" is not found in DomEventModule")}},t.remove=function(e,t){if(this.parent&&this.parent.addEventListener){var n=this.cache.get(e);if(n){if(t)for(var r=n.length;r>=0;r--)n[r]===t&&n.splice(r,1);else n=[];0===n.length&&(this.parent.removeEventListener(e,n.eventCallback),this.cache.delete(e))}}},t.trigger=function(e,t){var n=this.cache.get(e);n&&n.eventCallback(t)},t.one=function(e,t){this.listen(e,t),this.remove(e,t)},t.removeAll=function(){var e=this;this.cache.forEach((function(t,n){e.parent.removeEventListener(n,e.cache.get(n).eventCallback,!1),e.cache.delete(n)}))},t.destroy=function(){var e=this;this.cache.forEach((function(t,n){e.parent.removeEventListener(n,e.cache.get(n).eventCallback,!1),e.cache.delete(n)}))},t.bind=function(e,t,n){var r=this,o=this.cache.get(e);if(o||(o=[],this.cache.set(e,o)),n&&(t=(0,s.throttle)(t,n)),o.push(t),1===o.length){var a=function(e){o.forEach((function(t){t(e)}))};this.parent.addEventListener(e,a,!1),o.eventCallback=a}return{remove:function(){return r.remove(e,t)}}},e}(),i=n("../node_modules/@tencent/containerized/build/main/index.js"),c=Object.assign(Object.assign({},function(){var e=o.create("sheetsBar"),t=o.create("default"),n=o.create("toolBar"),r=o.create("spreadsheetApp"),s=o.create("search"),i=o.create("sheetStatus"),c=o.create("network"),u=o.create("history"),d=o.create("init"),l=o.create("view"),p=o.create("reportEvent"),h=o.create("notificationCenter"),_=o.create("keyboard"),f=o.create("login"),m=o.create("formula"),v=o.create("errorCode"),E=o.create("mentionEvent"),g=o.create("pageLoad"),R=o.create("rangeAuthEvent"),S=o.create("dateReminderEvent"),A=o.create("todo"),w=o.create("commentEvent"),T=o.create("collabEvent"),y=o.create("discussionEvent"),I=o.create("formRelationEvent"),O=o.create("linkCenter"),D=o.create("drag"),b=o.create("badge"),C=o.create("header"),x=o.create("filterView"),N=o.create("formDetailsEvent"),P=o.create("tencentMeetingEvent"),L=o.create("chartEvent");return{sheetsBar:e,default:t,toolBar:n,spreadsheetEvent:r,search:s,sheetStatus:i,network:c,history:u,windowEvent:new a("undefined"===typeof window?{}:window),bodyEvent:new a("undefined"===typeof window||"undefined"===typeof window.document?{}:window.document.body),init:d,view:l,reportEvent:p,notificationCenter:h,keyboard:_,loginEvent:f,formula:m,errorCode:v,mentionEvent:E,pageLoad:g,rangeAuthEvent:R,dateReminderEvent:S,todoEvent:A,commentEvent:w,collabEvent:T,discussionEvent:y,formRelationEvent:I,linkCenter:O,dragCenterEvent:D,badge:b,header:C,filterView:x,formDetailsEvent:N,tencentMeetingEvent:P,chartEvent:L}}()),{destroy:function(){var e;null===(e=n.g.log)||void 0===e||e.debug("flow IEvent destroy()"),Object.keys(c).forEach((function(e){var t,n;null===(n=(t=c[e]).destroy)||void 0===n||n.call(t)}))}}),u=c,d=function(){return c},l=(0,i.yh)("IEvent")},"../spread-sheet/src/base/event/eventName.ts":function(e,t,n){var r,o,s;n.d(t,{QM:function(){return s},W1:function(){return r},Xs:function(){return o}}),function(e){e.PART_INTERACTABLE="part_interactable",e.AFTER_FIRST_RENDER="after_first_render",e.AFTER_ALL_RENDER="after_all_render",e.INTERACTABLE="interactable",e.SELECTION_CHANGE="selection_change",e.ACTIVATION_CHANGE="activation_change",e.SELECTION_ENTER_VIEW="selection_enter_view",e.SELECTION_LEAVE_VIEW="selection_view_view",e.SELECT_PIC="select_pic",e.DATA_CHANGE="dataChange",e.INPUT_END="input_end",e.INPUT_CHANGE="input_change",e.ENTER_INPUT_STATUS="enter_input_status",e.ENTER_ACTIVE_STATUS="enter_active_status",e.ENTER_NORMAL_STATUS="enter_normal_status",e.EXIT_ACTIVE_STATUS="exit_active_status",e.ENTER_SCAN_STATUS="enter_scan_status",e.RESET_INTERACTION_STATUS="reset_interaction_status",e.UI_SHOW="ui_show",e.UI_HIDE="ui_hide",e.TITLE_AUTO_CHANGE="title_auto_change",e.DATABASE_ERROR="dababase_error",e.LOAD_FIRST_DATA_START="load_first_data_start",e.LOAD_FIRST_DATA_END="load_first_data_end",e.CORE_SHEET_LAZY_LOADED="core_sheet_lazy_loaded",e.START_IGNORE_BRIDGE_KEYBOARD_EVENT="start_ignore_bridge_keyboard_event",e.END_IGNORE_BRIDGE_KEYBOARD_EVENT="end_ignore_bridge_keyboard_event",e.ENTER_FILTER_VIEW="enter_filter_view",e.EXIT_FILTER_VIEW="exit_filter_view"}(r||(r={})),function(e){e.COMMENT_PANEL_M="comment-panel-m",e.SEARCH_PANEL_PC="search-panel-pc",e.SHAPE_PREVIEW_M="shape-preview-m",e.SHAPE_PREVIEW_PC="shape-preview-pc",e.SHAPE_ZOOM_M="shape-zoom-m",e.SHAPE_ZOOM_PC="shape-zoom-pc",e.SWITCH_SHEET="switch-sheet",e.AT_MESSAGE="at-message",e.QQ_SHARE_M="qqshare-m",e.FILTER_PANEL_PC="filter-panel-pc",e.FORMULA_EDITOR_PANEL="formula-editor-panel",e.AUTH_M="auth-m",e.MORE_MENU_M="more-menu-m",e.RENAME_DOCUMENT_M="rename-document-m",e.FILTER_PANEL_M="filter-panel-m",e.FORMULA_PANEL_M="formula-panel-m",e.NUMBER_FORMAT_PANEL_M="number-format-panel-m",e.VALIDATION_LIST_CARD_M="validation-list-card-m",e.FORMULA_BOARD="formula-board",e.SEARCH_PANEL_M="search-panel-m",e.QUICK_FILL_M="quick-fill-m",e.ITEM_LIST_M="item-list-m",e.RENAME_SHEET_NAME_M="rename-sheet-name-m",e.DIALOG="dialog",e.SHEET_LIST_BOX="sheet-list-box",e.MOBILE_TOOLBAR="toolbar-m",e.CELL_EDITOR_M="cell-editor-m"}(o||(o={})),function(e){e.TABLE_RENDER_END="table_render_end",e.FOOTER_RENDER_END="footer_render_end"}(s||(s={}))},"../spread-sheet/src/base/helper/font-detect-engine.ts":function(e,t,n){n.d(t,{r:function(){return a}}),n("../node_modules/core-js/modules/es.array.iterator.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.set.js"),n("../node_modules/core-js/modules/es.string.iterator.js"),n("../node_modules/core-js/modules/esnext.set.add-all.js"),n("../node_modules/core-js/modules/esnext.set.delete-all.js"),n("../node_modules/core-js/modules/esnext.set.difference.js"),n("../node_modules/core-js/modules/esnext.set.every.js"),n("../node_modules/core-js/modules/esnext.set.filter.js"),n("../node_modules/core-js/modules/esnext.set.find.js"),n("../node_modules/core-js/modules/esnext.set.intersection.js"),n("../node_modules/core-js/modules/esnext.set.is-disjoint-from.js"),n("../node_modules/core-js/modules/esnext.set.is-subset-of.js"),n("../node_modules/core-js/modules/esnext.set.is-superset-of.js"),n("../node_modules/core-js/modules/esnext.set.join.js"),n("../node_modules/core-js/modules/esnext.set.map.js"),n("../node_modules/core-js/modules/esnext.set.reduce.js"),n("../node_modules/core-js/modules/esnext.set.some.js"),n("../node_modules/core-js/modules/esnext.set.symmetric-difference.js"),n("../node_modules/core-js/modules/esnext.set.union.js"),n("../node_modules/core-js/modules/web.dom-collections.iterator.js"),n("../node_modules/core-js/modules/es.array.join.js"),n("../node_modules/core-js/modules/es.array.filter.js"),n("../node_modules/core-js/modules/es.array.slice.js"),n("../node_modules/core-js/modules/es.array.concat.js");var r=n("../node_modules/@tencent/docs-user-agent/dist/index.js"),o=n.n(r),s=n("../spread-sheet/src/base/config/font.ts"),a=function(){function e(){this.supportedFontFamily=new Set;try{if("undefined"===typeof window)this.initDefaultSupportedFontFamily();else{var e=document.createElement("canvas");this.measureCtx=e.getContext("2d"),this.measureCtx||this.initDefaultSupportedFontFamily(),e.width=100,e.height=100,this.measureCtx.textAlign="center",this.measureCtx.fillStyle="black",this.measureCtx.textBaseline="middle",this.initSupportedFontFamily()}}catch(t){throw n.g.log.error("FontDetectEngine","constructor error",null===t||void 0===t?void 0:t.message,null===t||void 0===t?void 0:t.stack),n.g.log.report("font_detect_engine_error"),new Error(t)}}e.getInstance=function(){return this.instance||(this.instance=new e),this.instance},e.destroy=function(){this.instance=void 0};var t=e.prototype;return t.isSupportFontFamily=function(e,t){var n=this.supportedFontFamily.has(e);return!n&&t&&(n=this.measureFont("Arial").join("")!==this.measureFont(e).join(""))&&this.supportedFontFamily.add(e),n},t.getSupportedFontFamily=function(){return this.supportedFontFamily},t.measureFont=function(e){this.measureCtx.clearRect(0,0,30,30),this.measureCtx.font="100px "+e+", Arial",this.measureCtx.fillText("a",15,15);var t=this.measureCtx.getImageData(0,0,30,30).data;return[].slice.call(t).filter((function(e){return 0!==e}))},t.initSupportedFontFamily=function(){var e,t,r=this;if(o().isWindows)this.supportedFontFamily=new Set([s.em].concat(s.te));else if(o().isMac)this.supportedFontFamily=new Set([s.em].concat(s.g_));else{if(o().isIOS){var a=s.yy.filter((function(e){return r.isSupportFontFamily(e,!0)}));return null===(e=n.g.log)||void 0===e||e.info("FontDetectEngine ios supported font:"+a),void(this.supportedFontFamily=new Set([s.em].concat(a)))}if(o().isAndroid){var i=s.FS.filter((function(e){return r.isSupportFontFamily(e,!0)}));return null===(t=n.g.log)||void 0===t||t.info("FontDetectEngine android supported font:"+i),void(this.supportedFontFamily=new Set([s.em].concat(i)))}this.initDefaultSupportedFontFamily()}},t.initDefaultSupportedFontFamily=function(){this.supportedFontFamily=new Set([s.em].concat(s.te))},e}()},"../spread-sheet/src/base/helper/font-polyfill.ts":function(e,t,n){n.d(t,{A:function(){return s}}),n("../node_modules/core-js/modules/es.regexp.exec.js"),n("../node_modules/core-js/modules/es.string.split.js"),n("../node_modules/core-js/modules/es.array.includes.js"),n("../node_modules/core-js/modules/es.array.join.js");var r=n("../spread-sheet/src/base/config/font.ts"),o=n("../spread-sheet/src/base/helper/font-detect-engine.ts");function s(e){var t=r.XP[e]?r.XP[e]:e;return t&&(o.r.getInstance().isSupportFontFamily(t)||(t=function(e){void 0===e&&(e="");var t=e.split(" ");return t.length>1&&(t.pop(),["Wingdings"].includes(t.join(" ")))?"":t.join(" ")}(t))&&o.r.getInstance().isSupportFontFamily(t))?t:r.em}},"../spread-sheet/src/base/i18nInit.ts":function(e,t,n){n("../node_modules/core-js/modules/es.object.keys.js"),n("../node_modules/core-js/modules/es.array.find.js"),n("../node_modules/@tencent/wdocs-utils/dist/index.es.js");var r=n("../node_modules/i18next/dist/esm/i18next.js"),o=n("../node_modules/@tencent/docs-scenario-components-language-pack/dist/index.js"),s=n("../locales/index.js");n("../spread-sheet/src/base/util/domain-config.ts"),r.ZP.use(o.detectors).init({resources:s,defaultNS:"legacy",nsSeparator:"|",fallbackLng:o.fallbackLng,detection:o.detection,interpolation:o.interpolation,saveMissing:!0,missingKeyHandler:function(e,t,n){"en-US"===r.ZP.language&&console.info("missingKey",e,t,n)}}).then((function(){"undefined"!==typeof document&&(document.documentElement.lang=r.ZP.language)})),window.i18n=r.ZP},"../spread-sheet/src/base/index.ts":function(e,t,n){n.d(t,{Z:function(){return g}});var r={};n.r(r),n.d(r,{getStrBytes:function(){return l},getSubstr36Bytes:function(){return p},hasEmojiCharacter:function(){return d}});var o=n("../spread-sheet/src/base/event/eventName.ts"),s=n("../spread-sheet/src/base/event/event.ts"),a=n("../spread-sheet/src/base/util/object.ts"),i=[[118784,128895],[129311,129311],[129320,129327],[129329,129330],[129356,129356],[129375,129375],[129376,129387],[129426,129431],[129504,129510],[129488,129491]],c=[[8448,10239],[11013,11015],[10548,10549],[12951,12953],[169,169],[174,174],[12349,12349],[12336,12336],[11093,11093],[11036,11036],[11035,11035],[11088,11088]],u=[9786,10084,9757,9996,9994,9995];function d(e){for(var t=function(t){var n=e.charCodeAt(t);if(55296<=n&&n<=56319){if(e.length>1){var r=e.charCodeAt(t+1),o=1024*(n-55296)+(r-56320)+65536;if(i.some((function(e){return e[0]<=o&&o<=e[1]})))return{v:!0}}}else if(e.length>1){if(8419===e.charCodeAt(t+1))return{v:!0}}else if(c.some((function(e){return e[0]<=n&&n<=e[1]})))return{v:!0};if(u.some((function(e){return e===n}))&&e.length>t&&65039===e.charCodeAt(t+1))return{v:!0}},n=0;n<e.length;n++){var r=t(n);if("object"===typeof r)return r.v}return!1}function l(e){var t,n,r=0,o=0;for(o=0,n=e.length;o<n;o++)(t=e.charCodeAt(o))<=127?r+=1:t<=2047?r+=2:t<=65535&&(r+=3);return r}function p(e){var t,n,r=0,o=0;for(o=0,n=e.length;o<n&&((t=e.charCodeAt(o))<=127?r+=1:t<=2047?r+=2:t<=65535&&(r+=3),!(r>36));o++);return e.substring(0,o)}var h,_=n("../spread-sheet/src/base/util/timer.ts"),f=n("../spread-sheet/src/base/util/type.ts"),m=n("../spread-sheet/src/base/config/report.ts"),v=n("../spread-sheet/src/base/report/flowlog.js"),E={QUICKLOOK_STEP:6e5,QUICKLOOK_STEP_PC:6e5,QUICKLOOK_STEP_PAD:6e5,QUICKLOOK_STEP_MOBILE:6e5,QUICKLOOK_MAX_COSTTIME:2e3,QUICKLOOK_INIT_TIME:3e4};!function(e){e.EVENT_NAME=o.W1,e.event=s.ZP,e.flowlog=v.Z,function(e){e.object=a,e.string=r,e.timer=_.Z,e.type=f}(e.util||(e.util={})),function(e){e.report=m,e.viewConfig=E}(e.config||(e.config={}))}(h||(h={}));var g=h},"../spread-sheet/src/base/log/production-log.ts":function(e,t,n){n.d(t,{$:function(){return o}});var r=n("../packages/report/src/utils/env.ts"),o={report:function(){var e,t;r.i&&(null===(t=n.g.log)||void 0===t||(e=t).report.apply(e,arguments))}}},"../spread-sheet/src/base/report/core-link-reporter.ts":function(e,t,n){n.d(t,{$:function(){return h},Z:function(){return _}}),n("../node_modules/core-js/modules/es.array.filter.js"),n("../node_modules/core-js/modules/es.object.assign.js"),n("../node_modules/core-js/modules/es.array.find.js");var r,o,s=n("../node_modules/lodash/isFunction.js"),a=n.n(s),i=n("../packages/report/src/proxy.ts"),c=n("../node_modules/@tencent/containerized/build/main/index.js"),u=n("../node_modules/@tencent/docs-user-agent/dist/index.js"),d=n.n(u),l=n("../spread-sheet/src/base/util/appConfig.ts");!function(e){e.zzs="zzs"}(o||(o={}));var p=((r={})[o.zzs]=l.Z.getConfig("runtime.reportCgiMap.zzsReport"),r),h=(0,c.yh)("ICoreLinkReporter"),_="page-editor"==n.j?function(){function e(){}var t=e.prototype;return t.init=function(){this.initClientInfo(),this.initListener()},t.zzsStatus=function(e){var t,r,s=e.attrid,a=e.status,i=["",e.dimensions].filter((function(e){return void 0!==e})),c=Object.assign({datas:[["sheet","status",s,a,i]]},this.clientInfo||{});try{r=new Blob([JSON.stringify(c)],{type:"application/json"})}catch(u){null===(t=n.g.log)||void 0===t||t.debug(u.message)}this.postReport(o.zzs,r)},t.initClientInfo=function(){var e,t,r,o,s;this.clientInfo={domain:(null===(t=null===(e=n.g.AppConfig)||void 0===e?void 0:e.normal)||void 0===t?void 0:t.domain)||(null===(o=null===(r=n.g.AppConfig)||void 0===r?void 0:r.normal)||void 0===o?void 0:o.instance)||l.Z.getConfig("runtime.domainName"),platform:this.getPlatform(),source:this.getSource(),version:null!==(s=n.g.__globalReleaseVersion)&&void 0!==s?s:""}},t.getPlatform=function(){return[["iPhone",d().isIPhone],["ipad",d().isIPad],["androidPad",d().isAndroidPad],["mac",d().isMac],["windows",d().isWindows],["other",!0]].find((function(e){return e[1]}))[0]},t.getSource=function(){return[[d().isWxMiniProgram,"wxMiniProgram"],[d().isQQMiniProgram,"qqMiniProgram"],[d().isWxWork,"wxWork"],[d().isChrome,"chrome"],[d().isSafari,"safari"],[d().isFirefox,"firefox"],[d().isChromiumEdge,"chromiumEdge"],[d().isQQBrowser,"qqBrowser"],[d().isTencentDocsApp,"tencentDocsApp"],[d().isPCTencentDocsClient,"pcTencentDocsClient"],[d().isWeiYunApp,"weiYunApp"],[d().isElectronTencentDocsClient,"electronTencentDocsClient"],[d().isWeChat,"weChat"],[d().isQQ,"qq"],[d().isTim,"tim"],[d().isWindowsUWP,"windowsUwp"],[!0,""]].find((function(e){return e[0]}))[1]},t.postReport=function(e,t){var r;if(a()(navigator.sendBeacon)&&t)try{navigator.sendBeacon(p[e],t)}catch(o){null===(r=n.g.log)||void 0===r||r.debug(o.message)}},t.initListener=function(){this.listenBeforeunload()},t.listenBeforeunload=function(){var e=this;n.g.addEventListener("beforeunload",(function(){i.O.isStackEmpty||i.O.eachLoad(e,!0)}))},e}():null},"../spread-sheet/src/base/report/flowlog.js":function(e,t){var n=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n]},r={log:function(e){n(e)},info:function(e){n(e)},error:function(e,t){n(e,t)}};["init","debug","log","info","warn","error","report","loadAsset"].forEach((function(e){r[e]=function(){}}));try{r=window.log?window.log:r}catch(o){}t.Z=r},"../spread-sheet/src/base/report/fps.ts":function(e,t,n){n("../node_modules/core-js/modules/web.dom-collections.for-each.js");var r=n("../packages/report/src/index.ts"),o=n("../node_modules/@tencent/tdocs_fps/lib/index.js"),s={"0-10":0,"11-20":0,"21-30":0,"31-40":0,"41-50":0,"51-55":0,56:0,57:0,58:0,59:0,60:0,"大于60":0},a=function(){function e(){var e=this;this._fps=new o.T,this._cacheAction="",this._handle=function(t){if(""!==e._cacheAction&&Math.random()<.05){var n=function(e){return e.reduce((function(e,t){return e+t}),0)/e.length}(t);!function(e){s["0-10"]=0,s["11-20"]=0,s["21-30"]=0,s["31-40"]=0,s["41-50"]=0,s[56]=0,s[57]=0,s[58]=0,s[59]=0,s[60]=0,s["大于60"]=0,e.forEach((function(e){var t=Math.round(1e3/e);switch(!0){case t<=10:s["0-10"]+=1;break;case t<=20:s["11-20"]+=1;break;case t<=30:s["21-30"]+=1;break;case t<=40:s["31-40"]+=1;break;case t<=50:s["41-50"]+=1;break;case 56===t:s[56]+=1;break;case 57===t:s[57]+=1;break;case 58===t:s[58]+=1;break;case 59===t:s[59]+=1;break;case 60===t:s[60]+=1;break;default:s["大于60"]+=1}}))}(t),r.ZP.tdwReport({opername:"quality_doc",module:"detail",action:e._cacheAction,ver7:n,ver8:JSON.stringify(s)})}e._cacheAction=""},this._fps.addListener(this._handle)}var t=e.prototype;return t.start=function(e){this._cacheAction=e,this._fps.start()},t.end=function(e){this._cacheAction!==e&&(this._cacheAction=""),this._fps.end()},e}();t.Z=new a},"../spread-sheet/src/base/ssr/ssr-dom-attr.ts":function(e,t,n){n.d(t,{PX:function(){return s},US:function(){return a},Zu:function(){return r},vs:function(){return o}});var r="ssrContainerWrapper",o="footer-ssr-container",s="ssrLoadingContainerWrapper",a="privilegetype"},"../spread-sheet/src/base/ssr/ssr-dom-remove-util.ts":function(e,t,n){n.d(t,{$Q:function(){return c},Cs:function(){return s},kv:function(){return i},rV:function(){return o}});var r=n("../spread-sheet/src/base/ssr/ssr-dom-attr.ts");function o(){a(r.vs,1e3)}function s(){var e=document.querySelector(".DTable");e&&setTimeout((function(){var t;null===(t=e.parentElement)||void 0===t||t.removeChild(e)}))}function a(e,t){void 0===t&&(t=0);var r=document.getElementById(e);r&&setTimeout((function(){var t,o;null===(t=r.parentElement)||void 0===t||t.removeChild(r),null===(o=n.g.log)||void 0===o||o.info("ssr",e+" 被移除")}),t)}function i(){a(r.Zu,1e3),a(r.PX)}function c(){a(r.PX)}},"../spread-sheet/src/base/storage/collaborator.ts":function(e,t,n){function r(){return n.g.location.pathname.replace("/sheet/","")+"_COLLAB_EYE_COUNT"}function o(){return n.g.location.pathname.replace("/sheet/","")+"_COLLAB_COUNT"}n.d(t,{j:function(){return o},o:function(){return r}}),n("../node_modules/core-js/modules/es.regexp.exec.js"),n("../node_modules/core-js/modules/es.string.replace.js")},"../spread-sheet/src/base/util/appConfig.ts":function(e,t,n){n.d(t,{z:function(){return s}});var r=n("../node_modules/@tencent/docs-config/dist/index.js"),o=n.n(r),s=function(){return o().getInstance()},a=s();!function(e){"pc"===(e.getConfig("platform")||"pc")&&"wecom"===e.getConfig("domain")&&window.isTimelineMode&&e.bind({"titlebar.collaborators":!1})}(a),t.Z=a},"../spread-sheet/src/base/util/container.ts":function(e,t,n){n.d(t,{x:function(){return r}});var r=function(){var e=document.querySelector("#footerContainer"),t=(null===e||void 0===e?void 0:e.clientHeight)||33,n=document.querySelector("#headerContainer");return((null===n||void 0===n?void 0:n.clientHeight)||0)+t}},"../spread-sheet/src/base/util/domain-config.ts":function(e,t,n){n.d(t,{P8:function(){return s},oT:function(){return a},xc:function(){return o}});var r=n("../spread-sheet/src/base/util/appConfig.ts"),o="wecom"===r.Z.getConfig("domain"),s=function(){return 1===window.__is_conversation_embedded||window.self!==window.top},a="toc"===r.Z.getConfig("domain")},"../spread-sheet/src/base/util/handle-header-hidden-style.ts":function(e,t,n){n.d(t,{C:function(){return o}});var r=n("../spread-sheet/src/base/util/appConfig.ts");function o(){var e=!!r.Z.getConfig("titlebar"),t=!!r.Z.getConfig("toolbar");if(!e){var n=document.getElementById("headerTop");n&&(n.style.display="none")}if(!t){var o=document.getElementById("headerBottom");o&&(o.style.display="none")}}},"../spread-sheet/src/base/util/mobile.ts":function(e,t,n){n.d(t,{cY:function(){return l},x9:function(){return p}});var r=window.devicePixelRatio;function o(e,t){var n=window.screen.width,r=window.screen.height;return n===e&&r===t||n===t&&r===e}function s(){return 3===r&&o(375,812)}function a(){return 3===r&&o(414,896)}function i(){return 2===r&&o(414,896)}function c(){return 3===r&&(o(390,844)||o(375,812))}function u(){return 3===r&&(o(428,926)||o(414,896))}function d(){var e=window.navigator.userAgent;return/iphone/gi.test(e)&&(c()||u())}var l=function(){var e=window.navigator.userAgent;return!!/iphone x/gi.test(e)||!!/iphone/gi.test(e)&&(s()||a()||i())}(),p=d()},"../spread-sheet/src/base/util/object.ts":function(e,t,n){function r(e,t){if(!e&&!t)return{};if(!t)return e;if(!e)return t;for(var n=Object.keys(t),r=n.length;r;)e[n[r-=1]]=t[n[r]];return e}function o(e){return"object"===typeof e?JSON.parse(JSON.stringify(e)):e}function s(e){var t={};return i(e,(function(e,n){t[n]=e})),t}function a(e,t){return Object.keys(e).filter((function(t){return c(e,t)})).map((function(n){return t(e[n],n,e)}))}function i(e,t){a(e,t)}function c(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function u(e){for(var t=[],n={},r=[{parent:n,key:void 0,data:e}];r.length;){var o=r.pop();if(o){var s=o.parent,a=o.key,i=o.data,c=s;"undefined"!==typeof a&&(s[a]={},c=s[a]);var u=d(t,i);if(u){s[a]=u.target;continue}for(var l in t.push({source:i,target:c}),i)i.hasOwnProperty(l)&&("object"===typeof i[l]?r.push({parent:c,key:l,data:i[l]}):c[l]=i[l])}}return n}function d(e,t){for(var n=0;n<e.length;n++)if(e[n].source===t)return e[n];return null}function l(e,t){return t.forEach((function(t){Object.getOwnPropertyNames(t.prototype).forEach((function(n){"constructor"!==n&&Object.defineProperty(e.prototype,n,Object.getOwnPropertyDescriptor(t.prototype,n))}))})),t}n.r(t),n.d(t,{applyMixins:function(){return l},clone:function(){return s},cloneForce:function(){return u},deepClone:function(){return o},extend:function(){return r},hasOwnProperty:function(){return c},objectEach:function(){return i},objectMap:function(){return a}}),n("../node_modules/core-js/modules/es.object.keys.js"),n("../node_modules/core-js/modules/es.array.map.js"),n("../node_modules/core-js/modules/es.array.filter.js"),n("../node_modules/core-js/modules/web.dom-collections.for-each.js"),n("../node_modules/core-js/modules/es.object.get-own-property-names.js"),n("../node_modules/core-js/modules/es.object.get-own-property-descriptor.js")},"../spread-sheet/src/base/util/phone-number.ts":function(e,t,n){n.d(t,{AI:function(){return c},E$:function(){return _},Iq:function(){return s},YH:function(){return p},un:function(){return l}}),n("../node_modules/core-js/modules/es.regexp.exec.js"),n("../node_modules/core-js/modules/es.string.split.js"),n("../node_modules/core-js/modules/es.string.replace.js"),n("../node_modules/core-js/modules/es.object.values.js"),n("../node_modules/core-js/modules/es.regexp.constructor.js"),n("../node_modules/core-js/modules/es.regexp.to-string.js"),n("../node_modules/core-js/modules/esnext.global-this.js"),n("../node_modules/core-js/modules/es.number.constructor.js");var r=n("../node_modules/@tencent/docs-user-agent/dist/index.js"),o=n.n(r),s={"ar-DZ":"^(\\+?213|0)(5|6|7)\\d{8}$","ar-SY":"^(!?(\\+?963)|0)9\\d{8}$","ar-SA":"^(!?(\\+?966)|0)5\\d{8}$","en-US":"^(\\+?1)[2-9]\\d{2}[2-9](?!11)\\d{6}$","cs-CZ":"^(\\+?420)[1-9][0-9]{2} ?[0-9]{3} ?[0-9]{3}$","de-DE":"^(\\+?0{0,2}49[\\-]?)([0-9]{10,11})$","da-DK":"^(\\+?45)(\\d{8})$","el-GR":"^(\\+?30)(69\\d{8})$","en-AU":"^(\\+?61|0)4\\d{8}$","en-GB":"^(\\+?44|0)7\\d{9}$","en-HK":"^(\\+?852\\-?)[569]\\d{3}\\-?\\d{4}$","en-IN":"^(\\+?91|0)[789]\\d{9}$","en-NZ":"^(\\+?64|0)2\\d{7,9}$","en-ZA":"^(\\+?27|0)\\d{9}$","en-ZM":"^(\\+?26)09[567]\\d{7}$","es-ES":"^(\\+?34)(6\\d{1}|7[1234])\\d{7}$","fi-FI":"^(\\+?358|0)\\s(4(0|1|2|4|5)?|50)\\s?(\\d\\s?){4,8}\\d$","fr-FR":"^(\\+?33|0)[67]\\d{8}$","he-IL":"^(\\+972|0)([23489]|5[0248]|77)[1-9]\\d{6}","hu-HU":"^(\\+?36)(20|30|70)\\d{7}$","it-IT":"^(\\+?39)\\s?3\\d{2} ?\\d{6,7}$","ja-JP":"^(\\+?81|0)\\d{1,4}[ \\-]?\\d{1,4}[ \\-]?\\d{4}$","ms-MY":"^(\\+?6?01){1}(([145]{1}(\\-|\\s)?\\d{7,8})|([236789]{1}(\\s|\\-)?\\d{7}))$","nb-NO":"^(\\+?47)[49]\\d{7}$","nl-BE":"^(\\+?32|0)4\\d{8}$","nn-NO":"^(\\+?47)[49]\\d{7}$","pl-PL":"^(\\+?48)[5-8]\\d ?\\d{3} ?\\d{2} ?\\d{2}$","pt-BR":"^(\\+?55|0)\\-?[1-9]{2}\\-?[2-9]{1}\\d{3,4}\\-?\\d{4}$","pt-PT":"^(\\+?351)9[1236]\\d{7}$","ru-RU":"^(\\+?7|8)9\\d{9}$","sr-RS":"^(\\+3816|06)[- \\d]{5,9}$","tr-TR":"^(\\+?90|0)5\\d{9}$","vi-VN":"^(\\+?84|0)((1(2([0-9])|6([2-9])|88|99))|(9((?!5)[0-9])))([0-9]{7})$","zh-CN":"^(\\+?0?86\\-?)?((13[0-9])|(14[5-9])|(15([0-3]|[5-9]))|(16[6-7])|(17[1-8])|(18[0-9])|(19[1|3])|(19[5|6])|(19[8|9]))\\d{8}$","zh-TW":"^(\\+?886\\-?|0)9\\d{8}$"},a={"zh-CN":{regExp:"^([\\(（]?\\+?0?0?\\d{2,3}[\\)）]?[- ]?)?([\\(（]?0?\\d{2,3}[\\)）]?[- ]?)?([2-8]\\d{2,3}[- ]?\\d{4})((-|转|,| )(\\d+))?$",getExtIndex:function(e){var t=e.split("-");if(2===t.length&&7===t[0].length&&4===t[1].length)return e.lastIndexOf("-");var n=e.replace(this.regExp,"$4");return n?e.lastIndexOf(n):void 0}}},i=[110,119,120,122,999,112,114,1e4,10010,10011,10060,10086,11185,12300,12310,12315,12319,12333,12345,12348,12358,12365,12365,12366,12369,12395,12395,12591,16300,17900,17901,17908,17909,17910,17911,17920,17921,17931,17950,17951,17970,17971,17979,17987,17990,17991,17999,95033,95105,95116,95118,95119,95120,95160,95168,95169,95188,95384,95500,95501,95511,95512,95516,95518,95519,95522,95533,95555,95558,95559,95561,95566,95567,95568,95577,95588,95595,95598,95599,95766,95777,95803,95805,95806,95808,95809,95810,95811,95812,95813,95815,95816,95828,95829,95838,95839,95858,95859,95877,95880,5888,95900,95901,95911,95936,95937,95938,95939,95950,95951,95958,95963,95968,95993,96e3,96001,96002,96003,96005,96008,96010,96011,96014,96015,96096,96100,96101,96105,96110,96111,96112,96113,96118,96119,96120,96121,96126,96128,96129,96157,96158,96166,96168,96169,96177,96178,96179,96181,96188,96190,96191,96196,96197,96199,96300];function c(e,t){for(var n={isValid:!1,regExp:null,getExtIndex:null},r=String(e).replace(/((\s)|(-))/g,""),o=[u,d,h],s=0,a=o.length;s<a;s++){var i=0===s?r:e,c=o[s](String(i),t);if(c.isValid){n=c;break}}return n}function u(e,t){for(var n=t?[s[t]]:Object.values(s),r=0;r<n.length;r++){var o=new RegExp(n[r]);if(o.test(String(e)))return{isValid:!0,regExp:o,getExtIndex:null}}return{isValid:!1,getExtIndex:null,regExp:null}}function d(e,t){for(var n=t?[a[t]]:Object.values(a),r=0;r<n.length;r++){var o=new RegExp(n[r].regExp);if(o.test(String(e)))return{isValid:!0,getExtIndex:n[r].getExtIndex,regExp:o}}return{isValid:!1,getExtIndex:null,regExp:null}}function l(e){var t,r=String(e),o=c(r);if(!o.isValid)return null===n.g||void 0===n.g||n.g.log.error("不合法的号码: "+r),r;var s=null===(t=o.getExtIndex)||void 0===t?void 0:t.call(o,r);return void 0!==s&&o.regExp?String(e).substring(0,s)+","+String(e).substring(s+1):e}function p(e){var t;if(!e)return null;if(o().isTencentDocsApp)return null===(t=null===globalThis||void 0===globalThis?void 0:globalThis.mqq)||void 0===t?void 0:t.invoke("nav","openSchema",{uri:"tel:"+e});var n=document.getElementById("dial-phone");n&&document.body.removeChild(n);var r=document.createElement("a");r.id="dial-phone",r.href="tel:"+e,document.body.appendChild(r),null===r||void 0===r||r.click()}function h(e,t){var n=!1,r=Number(e);return i.forEach((function(e){e===r&&(n=!0)})),{isValid:n,getExtIndex:null,regExp:null}}function _(e){var t;if(!e)return null;if(o().isTencentDocsApp)return null===(t=null===globalThis||void 0===globalThis?void 0:globalThis.mqq)||void 0===t?void 0:t.invoke("nav","openSchema",{uri:e});var n=document.getElementById("email-string");n&&document.body.removeChild(n);var r=document.createElement("a");r.id="email-string",r.href=e,document.body.appendChild(r),null===r||void 0===r||r.click()}},"../spread-sheet/src/base/util/timer.ts":function(e,t,n){n.d(t,{_:function(){return s}});var r=n("../node_modules/@babel/runtime/helpers/esm/toConsumableArray.js"),o=(n("../node_modules/regenerator-runtime/runtime.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.promise.js"),n("../node_modules/core-js/modules/es.number.is-integer.js"),n("../node_modules/core-js/modules/es.number.constructor.js"),n("../node_modules/core-js/modules/web.dom-collections.for-each.js"),n("../node_modules/core-js/modules/es.array.filter.js"),n("../node_modules/core-js/modules/es.array.splice.js"),function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function a(e){try{c(r.next(e))}catch(t){s(t)}}function i(e){try{c(r.throw(e))}catch(t){s(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,i)}c((r=r.apply(e,t||[])).next())}))});function s(e){return o(this,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise((function(t){setTimeout(t,e)})));case 1:case"end":return t.stop()}}),t)})))}var a=function(){function e(e,t){this.timer=e,this.done=!1,this.callback=function(){},this.frames=t/e.interval|0}var t=e.prototype;return t.setFrame=function(e){this.frames=e,0!==this.frames&&(this.frames=Number.isInteger(this.frames)?this.frames:1+(0|this.frames))},t.run=function(e){return this.callback=e,this.setFrame(this.frames+this.timer.currFrame),this.timer.push(this),this},t.stop=function(){this.timer.erase(this)},e}(),i=function(){function e(){this.zeroFrameDone=!1,this.times=0,this.started=!1,this.interval=500,this.t=null,this.cache={},this.currFrame=0,this.maxFrame=0}var t=e.prototype;return t.pause=function(){clearInterval(this.t)},t.restart=function(){this.started=!1,this.start()},t.clear=function(){this.cache={},this.started=!1,this.currFrame=0,this.maxFrame=0,clearInterval(this.t),this.t=null},t.execNextFrame=function(){if(this.currFrame>this.maxFrame)return this.clear();var e=this.cache[this.currFrame];if(e){e.forEach((function(e){var t;if(e){e.done=!0;try{null===e||void 0===e||e.callback()}catch(n){console.error(n),null===(t=window.log)||void 0===t||t.error(n.stack)}}e=null}));var t,n=e.filter((function(e){return!e.done}));n.length&&(this.cache[this.currFrame+1]||(this.cache[this.currFrame+1]=[]),(t=this.cache[this.currFrame+1]).push.apply(t,(0,r.Z)(n)),this.maxFrame+=1),this.cache[this.currFrame]=void 0}},t.push=function(e){this.cache[e.frames]||(this.cache[e.frames]=[]),this.cache[e.frames].push(e),this.maxFrame=Math.max(this.maxFrame,e.frames),this.start()},t.erase=function(e){if(e){var t=e.frames;if(void 0!==this.cache[t]){var n=this.cache[t].indexOf(e);n>-1&&this.cache[t].splice(n,1)}}},t.wait=function(e){return new a(this,e)},t.start=function(){var e=this;if(!this.started){if(this.started=!0,this.cache[0]&&!this.zeroFrameDone)return this.zeroFrameDone=!0,setTimeout((function(){try{e.execNextFrame()}catch(t){console.error(t)}}),0),this.started=!1;this.t=setInterval((function(){try{e.execNextFrame()}catch(t){console.error(t)}e.currFrame+=1}),this.interval)}},e}();t.Z=new i},"../spread-sheet/src/base/util/toggle.ts":function(e,t,n){n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.promise.js"),n("../node_modules/@tencent/toggle-client-js/dist/toggle.es.js")},"../spread-sheet/src/base/util/type.ts":function(e,t,n){function r(e,t){if(e===t)return!0;if(e instanceof Array===!1||t instanceof Array===!1||e.length!==t.length)return!1;for(var n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}function o(e,t,n,r){var o;return r="undefined"===typeof r||r,function(){for(var s=arguments.length,a=new Array(s),i=0;i<s;i++)a[i]=arguments[i];var c=this;return"undefined"!==typeof n&&(c=n),r?(e.apply(c,a),r=!1):!o&&void(o=setTimeout((function(){clearTimeout(o),o=null,e.apply(c,a)}),t))}}function s(e,t){for(var n=0;n<e.length;n++){var r=e[n];if(r&&r===t)return!0}return!1}function a(e){return e.reduce((function(e,t){return e[t]=!0,e}),{})}n.r(t),n.d(t,{arrToObjectKey:function(){return a},arrayEqual:function(){return r},inArray:function(){return s},throttle:function(){return o}})},"../spread-sheet/src/base/util/ui.tsx":function(e,t,n){n.d(t,{WW:function(){return d},nN:function(){return c},vb:function(){return u}});var r=n("../node_modules/@babel/runtime/helpers/esm/inheritsLoose.js"),o=(n("../node_modules/core-js/modules/web.dom-collections.for-each.js"),n("../node_modules/core-js/modules/es.object.assign.js"),n("../spread-sheet/src/base/index.ts")),s=n("react"),a=n.n(s),i=new(function(){function e(){this.callbacks=[],this.running=!1,window.addEventListener("resize",this.resize.bind(this))}var t=e.prototype;return t.resize=function(){this.running||(this.running=!0,window.requestAnimationFrame?window.requestAnimationFrame(this.runCallbacks.bind(this)):o.Z.util.timer.wait(66).run(this.runCallbacks.bind(this)))},t.runCallbacks=function(){this.callbacks.forEach((function(e){e()})),this.running=!1},t.addCallback=function(e){e&&this.callbacks.push(e)},e}());function c(e){i.addCallback(e)}function u(e){if(e&&e.tagName){var t=0;e.addEventListener("touchstart",(function(e){t=e.changedTouches[0].pageY})),e.addEventListener("touchmove",(function(n){var r=e.offsetHeight,o=e.scrollTop,s=e.scrollHeight,a=n.changedTouches[0].pageY;(a-t>0&&o<=0||a-t<0&&r+o>=s)&&n.preventDefault()}))}}var d=function(e){function t(t){var n;(n=e.call(this,t)||this).searchBoardRef=a().createRef();var r=n.props,o=r.height,s=r.width,i=r.left,c=r.top,u=r.hidden;return n.state={height:o,width:s,left:i,top:c,hidden:u},n}return(0,r.Z)(t,e),t.prototype.render=function(){var e,t,n=this.state,r=n.height,o=n.width,s=n.left,i=n.top,c=n.hidden?"hidden":"visible";return a().createElement("div",{ref:this.searchBoardRef,className:null!==(e=this.props.className)&&void 0!==e?e:"",style:Object.assign(Object.assign({height:r,width:o,left:s,top:i,visibility:c},{position:"absolute"}),null!==(t=this.props.style)&&void 0!==t?t:{})})},t}(a().Component)},"../spread-sheet/src/base/util/url.ts":function(e,t,n){n.d(t,{Fb:function(){return g},KM:function(){return T},Kc:function(){return v},NK:function(){return w},TV:function(){return b},kq:function(){return E},lS:function(){return m},nx:function(){return C},sx:function(){return O},vj:function(){return f},wE:function(){return D},wI:function(){return I}}),n("../node_modules/regenerator-runtime/runtime.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.promise.js"),n("../node_modules/core-js/modules/es.regexp.exec.js"),n("../node_modules/core-js/modules/es.string.split.js"),n("../node_modules/core-js/modules/es.string.trim.js"),n("../node_modules/core-js/modules/es.object.values.js"),n("../node_modules/core-js/modules/es.array.join.js"),n("../node_modules/core-js/modules/es.array.map.js"),n("../node_modules/core-js/modules/es.string.replace.js"),n("../node_modules/core-js/modules/es.regexp.constructor.js"),n("../node_modules/core-js/modules/es.regexp.to-string.js"),n("../node_modules/core-js/modules/web.dom-collections.for-each.js"),n("../node_modules/core-js/modules/es.object.keys.js"),n("../node_modules/core-js/modules/es.array.includes.js"),n("../node_modules/core-js/modules/es.string.includes.js"),n("../node_modules/core-js/modules/es.array.slice.js"),n("../node_modules/core-js/modules/es.function.name.js"),n("../node_modules/core-js/modules/es.string.starts-with.js");var r,o=n("../packages/model/src/cell/HyperlinkType.ts"),s=n("./node_modules/axios/index.js"),a=n.n(s),i=n("../packages/common-utils/src/index.ts"),c=n("../node_modules/qs/lib/index.js"),u=n.n(c),d=n("../spread-sheet/src/core/data/configService/spreadConfig.ts"),l=n("../node_modules/@tencent/docs-user-agent/dist/index.js"),p=n.n(l),h=n("../spread-sheet/src/base/util/appConfig.ts"),_=function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function a(e){try{c(r.next(e))}catch(t){s(t)}}function i(e){try{c(r.throw(e))}catch(t){s(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,i)}c((r=r.apply(e,t||[])).next())}))},f=/^(mailto:(\/\/)?)?([a-z\u00a1-\uffff0-9_\-.])+@([a-z\u00a1-\uffff0-9_\-.])+\.([a-z]{2,})$/i;function m(e){var t=e.split("#tab=");if(!t||2!==t.length)return null;var n=t[0],r=t[1];return""!==n?null:r}function v(e,t){void 0===t&&(t=!0);var n=function(e){e=String(e).trim();var t=/\.com$/i,n=/^www\./i,r=/^((http(s)?|ftp|file):\/\/)/i;return!/javascript:./i.test(e)&&(r.test(e)||t.test(e)||n.test(e)||f.test(e))}(e=String(e).trim());return t&&!/^(https?|ftp|file):\/\//i.test(e)&&(/^(\/\/)/.test(e)?e="http:"+e:/^[A-Za-z0-9]/.test(e)&&(e="http://"+e)),n?e:null}var E=function(){return Object.values(h.Z.getConfig("runtime.domainNameAlias"))},g=function(){return"(?:"+E().map((function(e){return null===e||void 0===e?void 0:e.replace(/\./g,"\\.")})).join("|")+")(/|$)"},R="(?:"+["doc.weixin.qq.com"].map((function(e){return null===e||void 0===e?void 0:e.replace(/\./g,"\\.")})).join("|")+")(/|$)",S=function(){return"(?:"+[h.Z.getConfig("custom.standaloneDomains.drive_weixin_qq_com")].map((function(e){return null===e||void 0===e?void 0:e.replace(/\./g,"\\.")})).join("|")+")(/|$)"},A=((r={})[o.ZP.TXT]="txt,rtf,plist,ini,xml,log,md".split(","),r[o.ZP.HTML]="html,htm,xhtml,mht,shtml,shtm,h,hpp,m,js,jsp,java,c,cpp,stp,json,asp,aspx,cs,css,cxx,php,vbs,py".split(","),r[o.ZP.IMAGE]="jpg,jpeg,jpe,png,bmp,gif,tiff,ico,icns,cr2".split(","),r[o.ZP.MUSIC]="mp3,mp2,ac3,aif,amr,au,kar,m3u,mid,midi,mpeg,ra,ram,rmi,snd,wav,wma,m4a,f4a,ogg,flac,f4a,aac,ac3,ogg".split(","),r[o.ZP.VIDEO]="wav,mp2,ape,mkv,rmvb,wmv,mp4,f4v,flv,avi,mov,qt,m4v,asf,rm,mpe,mpeg,mpg,vob,ts,3gp,3gpp,3gp2,ogv,mp4,webm,f4m,avi,fla,swf,m4u,movie,mxu".split(","),r[o.ZP.ZIP]="zip,7z,rar,bz2,gz,tar,tbz,tgz,cab,gzip,bzip2,deb,xz,wim,lzh,iso".split(","),r[o.ZP.FONT]="ttf,ttc,otf,eot,woff,woff2".split(","),r[o.ZP.MAIL]="eml".split(","),r[o.ZP.XMIND]="xmind,mmap".split(","),r[o.ZP.EXE]="exe,msi,scr,cmd,bat,com".split(","),r[o.ZP.OFFICE_EXCEL]="xls,xlsx,xlsm,et,ett,csv".split(","),r[o.ZP.OFFICE_PPT]="ppt,pptx,pptm,dps,dpt".split(","),r[o.ZP.OFFICE_WORD]="doc,docx,wps,wpt,docm,dot,dotm".split(","),r[o.ZP.NUMBERS]="numbers".split(","),r[o.ZP.KEYNOTE]="key".split(","),r[o.ZP.PAGES]="pages".split(","),r[o.ZP.CAD]="dwg,dxf,dws,dwt".split(","),r[o.ZP.CDR]="cdr".split(","),r[o.ZP.SOLID_WORK]="sldprt,step,slddrw".split(","),r[o.ZP.PSD]="psd,psb".split(","),r[o.ZP.AI]="ai,eps,svg,svgz".split(","),r[o.ZP.PDF]="pdf".split(","),r[o.ZP.SKETCH]="sketch".split(","),r[o.ZP.ANDROID]="apk".split(","),r[o.ZP.MAC]="dmg,pkg".split(","),r[o.ZP.FOLDER]="folder".split(","),r);function w(e){return m(e)?o.ZP.SHEET_LINK:T(e)}function T(e){for(var t=[["doc",o.ZP.DOC],["sheet",o.ZP.SHEET],["slide",o.ZP.SLIDE],["form",o.ZP.FORM],["pdf",o.ZP.PDF],["image",o.ZP.IMAGE],["mind",o.ZP.MIND],["flowchart",o.ZP.FLOWCHART],["desktop/mydoc/folder/",o.ZP.FOLDER],["desktop/shared/folder",o.ZP.FOLDER_SHARE],["txdoc/word",o.ZP.DOC],["txdoc/excel",o.ZP.SHEET],["formcol",o.ZP.FORM],["",o.ZP.TENCENTDOC]],n=[["board",o.ZP.BOARD],["",o.ZP.OTHER]],r=0,s=t;r<s.length;r++){var a=s[r],i=a[0],c=a[1],u=new RegExp("(https://)?"+g()+i),d=new RegExp("(https://)?"+R+i);if(u.test(e)||d.test(e)){if(d.test(e)&&""===i)return;return c}}for(var l=0,p=n;l<p.length;l++){var h=p[l],_=h[0],f=h[1];if(new RegExp("(https://)?"+S()+_).test(e))return f}}function y(e){var t,n=(null===(t=/.*\.(.*)$/.exec(e))||void 0===t?void 0:t[1])||"",r=null;return Object.keys(A).forEach((function(e){A[e].includes(n.toLowerCase())&&(r=parseInt(e,10))})),r}function I(e){var t,n,r,s,i,c,d,l;return _(this,void 0,void 0,regeneratorRuntime.mark((function p(){var h,_,f,m,v,E,g,R,A,w;return regeneratorRuntime.wrap((function(p){for(;;)switch(p.prev=p.next){case 0:if(p.prev=0,!new RegExp("(https://)?"+S()+"board").test(e)){p.next=11;break}return h=u().parse(e.slice(e.lastIndexOf("?")+1),{ignoreQueryPrefix:!0}),(_=new FormData).append("blackboard_id",null===h||void 0===h?void 0:h.k),p.next=7,a().post("/blackboard/getblackboardinfo",_);case 7:if(f=p.sent,m=f.data,!(null===(n=null===(t=null===m||void 0===m?void 0:m.body)||void 0===t?void 0:t.info)||void 0===n?void 0:n.info)){p.next=11;break}return p.abrupt("return",{fileId:null===(i=null===(s=null===(r=null===m||void 0===m?void 0:m.body)||void 0===r?void 0:r.info)||void 0===s?void 0:s.info)||void 0===i?void 0:i.blackboard_id,fileName:null===(l=null===(d=null===(c=null===m||void 0===m?void 0:m.body)||void 0===c?void 0:c.info)||void 0===d?void 0:d.info)||void 0===l?void 0:l.name,hyperlinkType:o.ZP.BOARD});case 11:return p.next=13,a().get("/wedoc/getfileinfobyurl?url="+encodeURIComponent(e),{timeout:2e3});case 13:if(0!==(v=p.sent).data.head.ret){p.next=19;break}return E=v.data.body,g=E.filename,R=E.fileid,A=E.entry_type,(w=1===A?o.ZP.FOLDER:T(e)||o.ZP.OTHER)===o.ZP.OTHER&&(w=y(g)||o.ZP.OTHER),p.abrupt("return",{fileId:R,fileName:g,hyperlinkType:w});case 19:throw new Error("[CGI ERROR] /wedoc/getfileinfobyurl "+v.data.head.ret+" "+v.data.head.msg);case 22:return p.prev=22,p.t0=p.catch(0),console.error("[CGI ERROR] /wedoc/getfileinfobyurl "+p.t0.message),p.abrupt("return",null);case 26:case"end":return p.stop()}}),p,null,[[0,22]])})))}function O(e){var t=this;return new Promise((function(n,r){return _(t,void 0,void 0,regeneratorRuntime.mark((function t(){var o,s;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=1,t.next=4,a()({method:"post",url:"/v2/file/link/getinfo",timeout:2e3,data:JSON.stringify({docUrl:e}),headers:{"Content-type":"application/json"}});case 4:o=t.sent,(s=null===o||void 0===o?void 0:o.data)&&0===s.retcode?n(s.result.linkInfo):r(),t.next=12;break;case 9:t.prev=9,t.t0=t.catch(1),r();case 12:case"end":return t.stop()}}),t,null,[[1,9]])})))}))}function D(e){return new RegExp("^https://"+g()+"(sheet|doc|slide|form|pdf|file)/").test(e)}function b(){var e=location.href;d.q.setConfig({originalUrl:e}),function(){var e=location.origin+location.pathname,t=(0,i.IZ)("scode"),r=(0,i.IZ)("tab"),o=(0,i.IZ)("fv");t&&r&&o&&!p().isWxWork&&(e+="?scode="+(0,i.r)(t)+"&tab="+(0,i.r)(r),n.g.history.pushState("",document.title,e))}()}function C(e){if(null===e)return null;var t=e;t.startsWith("\n")&&(t=t.substring(1));var n=t.indexOf("\n");return-1!==n?t.slice(0,n):t}},"../spread-sheet/src/core/ark-extensions/extensions/guide-interflow.ts":function(e,t,n){n("../node_modules/@tencent/ark-extensions/lib/index.js").LoadType.ON_DEMAND},"../spread-sheet/src/core/behavior/request/other/formula-model-service/strategy-base/ChartStrategyBase.ts":function(e,t,n){n.d(t,{Z:function(){return a}}),n("../node_modules/core-js/modules/web.dom-collections.for-each.js");var r=n("../packages/model/src/cell/data-validation/data-validation-utils.ts"),o=n("../packages/model/src/range/hexRangeUtils.ts"),s=n("../spread-sheet/src/core/behavior/request/other/formula-model-service/FormulaModelManager.ts"),a=function(){function e(e,t){this.onlyRefRangeChange=!0,this.type=s.S.CHART,this.workbookRangeManager=t,this.externalMethods=e}return e.prototype.getFormulaModelNodes=function(e){var t=this,n=[];return this.workbookRangeManager.chartWorkbookRangeMap.forEach((function(e,s){var a=e.range,i=t.externalMethods.getSheetBySheetId(a.sheetId);if(i){var c=a.startRowIndex,u=a.startColIndex,d=a.sheetId,l=(0,o.range2AbsoluteHex)(a,i),p={row:-1,col:-1,formulaModel:(0,r.IC)(l,c,u,d),sheetId:d,workbookRangeId:s,embeddedObjectId:e.embeddedObjectId};n.push(p)}})),n},e}()},"../spread-sheet/src/core/behavior/request/other/formula-model-service/strategy-base/ConditionalFormatStrategyBase.ts":function(e,t,n){n.d(t,{Z:function(){return i}});var r=n("../node_modules/@babel/runtime/helpers/esm/toConsumableArray.js"),o=(n("../node_modules/core-js/modules/web.dom-collections.for-each.js"),n("../node_modules/core-js/modules/es.array.join.js"),n("../spread-sheet/src/core/feature/formula/utils/parseUtil.ts")),s=n("../packages/model/src/range/hexRangeUtils.ts"),a=n("../spread-sheet/src/core/behavior/request/other/formula-model-service/FormulaModelManager.ts"),i=function(){function e(e,t){this.onlyRefRangeChange=!1,this.type=a.S.CONDITION,this.externalMethods=e,this.formulaModelManager=t}var t=e.prototype;return t.getFormulaModelNodes=function(e){var t,n,o=this,s=[];return null===(t=this.getConditionalFormatRuleManager(e))||void 0===t||t.each((function(e){var t=o.generateNodeFromRuleRange(e.index,e.rule);t&&s.push(t)})),null===(n=this.formulaModelManager)||void 0===n||n.each(a.S.CONDITION,e,(function(t){var n=o.generateNodeFromCustomFormula(t,e);(null===n||void 0===n?void 0:n.length)>0&&s.push.apply(s,(0,r.Z)(n))})),s},t.transformGridRangesToFormulaString=function(e,t){var n=[];return e.forEach((function(e){n.push((0,s.range2AbsoluteHex)(e,t))})),"=("+n.join(",")+")"},t.getConditionalFormatRuleManager=function(e){var t;return null===(t=this.externalMethods.getSheetBySheetId(e))||void 0===t?void 0:t.conditionalFormatRuleManager},t.generateNodeFromRuleRange=function(e,t){var n=t.ruleRanges[0];if(n){var r=n.startRowIndex,s=n.startColIndex,a=n.sheetId,i=this.externalMethods.getSheetBySheetId(n.sheetId);if(i){var c=this.transformGridRangesToFormulaString(t.ruleRanges,i),u=(0,o.EG)(c,r,s,a);if(null!==u)return{ruleIndex:e,formulaModel:u,sheetId:n.sheetId,row:-1,col:-1,isRuleRangeNode:!0}}}},t.generateNodeFromCustomFormula=function(e,t){var n=e.formulaModel,r=e.index;if(!n)return[];var o=[];return e.rule.ruleRanges.forEach((function(e){e.each((function(e,s){o.push({ruleIndex:r,row:e,col:s,sheetId:t,formulaModel:n,isCustomFormulaNode:!0})}))})),o},e}()},"../spread-sheet/src/core/behavior/request/other/formula-model-service/strategy-base/DataValidationStrategyBase.ts":function(e,t,n){n.d(t,{Z:function(){return o}});var r=n("../spread-sheet/src/core/behavior/request/other/formula-model-service/FormulaModelManager.ts"),o=function(){function e(e,t){this.onlyRefRangeChange=!0,this.type=r.S.DV,this.externalMethods=t,this.formulaModelManager=e}return e.prototype.getFormulaModelNodes=function(e){var t=[];return this.formulaModelManager.each(r.S.DV,e,(function(e){var n=e.row,r=e.col,o=e.sheetId,s=e.formulaModel,a=e.dataValidation;if(s){var i={formulaModel:s.clone(),col:r,row:n,sheetId:o,dataValidation:a};t.push(i)}})),t},e}()},"../spread-sheet/src/core/behavior/request/other/formula-model-service/strategy-base/FormulaNodeStrategyBase.ts":function(e,t,n){n.d(t,{Z:function(){return o}});var r=n("../spread-sheet/src/core/behavior/request/other/formula-model-service/FormulaModelManager.ts"),o=function(){function e(e,t){this.onlyRefRangeChange=!0,this.type=r.S.FORMULA,this.formulaModelManager=e,this.externalMethods=t}return e.prototype.getFormulaModelNodes=function(e){var t=[];return this.formulaModelManager.each(r.S.FORMULA,e,(function(e){var n=e.row,r=e.col,o=e.sheetId,s=e.formulaModel;if(s){var a={formulaModel:s,col:r,row:n,sheetId:o};t.push(a)}})),t},e}()},"../spread-sheet/src/core/feature/copyPaste/core/copy-flow.ts":function(e,t,n){n.d(t,{S:function(){return h},T:function(){return _}}),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.array.iterator.js"),n("../node_modules/core-js/modules/es.map.js"),n("../node_modules/core-js/modules/es.string.iterator.js"),n("../node_modules/core-js/modules/esnext.map.delete-all.js"),n("../node_modules/core-js/modules/esnext.map.every.js"),n("../node_modules/core-js/modules/esnext.map.filter.js"),n("../node_modules/core-js/modules/esnext.map.find.js"),n("../node_modules/core-js/modules/esnext.map.find-key.js"),n("../node_modules/core-js/modules/esnext.map.includes.js"),n("../node_modules/core-js/modules/esnext.map.key-of.js"),n("../node_modules/core-js/modules/esnext.map.map-keys.js"),n("../node_modules/core-js/modules/esnext.map.map-values.js"),n("../node_modules/core-js/modules/esnext.map.merge.js"),n("../node_modules/core-js/modules/esnext.map.reduce.js"),n("../node_modules/core-js/modules/esnext.map.some.js"),n("../node_modules/core-js/modules/esnext.map.update.js"),n("../node_modules/core-js/modules/web.dom-collections.iterator.js");var r=n("../spread-sheet/src/core/feature/copyPaste/interfaces.ts"),o=n("../packages/model/src/range/gridRangeUtils.ts"),s=n("../packages/model/src/range/GridRange.ts"),a=n("../spread-sheet/src/core/feature/copyPaste/util.ts"),i=n("../spread-sheet/src/core/feature/copyPaste/core/getCopyTextHTML.ts"),c=n("../spread-sheet/src/core/app/sheetStatus/private-range.ts"),u=n("../spread-sheet/src/core/utils/selection.ts"),d=n("../spread-sheet/src/core/app/sheetStatus/auth-range.ts"),l=n("../spread-sheet/src/core/feature/copyPaste/utils/cellMergeReference.ts"),p=n("../spread-sheet/src/core/data/configService/spreadConfig.ts"),h=function(e){var t=e.hotInstance,n=e.from,s=e.copyType,a={isSingle:!1,isMerge:!1,merge:[],rowDataUpdate:[{values:[]}],fromType:r.gN.COPY_CACHE,fromApp:r.o_.tencent,select:{selectAll:!1,selectCol:!1,selectRow:!1},containTable:!0,rowsDimensionProperties:[],colsDimensionProperties:[]},i=A(t),c=i.activeSheet,u=i.activeSheetId,d=(0,o.convertXYRangeToDimensionRanges)(n,u),l=(0,o.convertDimensionRangesToGridRange)(d),p=S(l,c),h=p.isSingle,_=p.isMerge,f=E({activeSheet:c,from:n,fromGridRange:l,copyType:s}),m=f.rowDataUpdate,v=f.mergeCells,g=f.colsDimensionProperties,R=f.rowsDimensionProperties;return a.isMerge=_,a.isSingle=h,a.rowDataUpdate=m,a.merge=v,a.colsDimensionProperties=g,a.rowsDimensionProperties=R,a},_=function(e){var t=e.from,n=e.copyType,o=e.isSelectAll,a=e.hotInstance,c=e.previewActiveSheetId,u=v(a,o),d=u.selectAll,l=u.selectRow,p=u.selectCol,h=A(a),_=h.activeSheetId,E=h.activeSheet,g=R(E,t),S=g.fromXStart,w=g.fromYStart,T=g.fromXEnd,y=g.fromYEnd,I=new s.Z(_,w,y,S,T),O=f(n,I).cutRange,D=m(n,I).copyRange,b=(0,i.YX)({spreadsheetApp:a,copyType:n,range:t,previewActiveSheetId:c,select:{selectAll:d,selectRow:l,selectCol:p}}),C={timeStamp:b.timeStamp,html:b.html,plain:b.plain};return{copyHTMLType:r.GI.table,from:t,pasteType:n,sheetId:_,valid:!0,select:{selectAll:d,selectRow:l,selectCol:p},copyRangeIsChange:!!c,clipboardCopyData:C,copyRange:D,cutRange:O,cellImageCache:b.imageCache}},f=function(e,t){return e===r.lb.cut?{cutRange:t}:{cutRange:null}},m=function(e,t){return e===r.lb.copy?{copyRange:t}:{copyRange:null}},v=function(e,t){var n;if(null===(n=t?{selectAll:!0,selectRow:!1,selectCol:!1}:e.view.canvas.normalSelectData.select))throw new Error("复制粘贴选区异常！");return n},E=function(e){for(var t=e.activeSheet,n=e.from,s=e.fromGridRange,a=e.copyType,i=R(t,n),u=i.fromXStart,h=i.fromYStart,_=i.fromXEnd,f=i.fromYEnd,m=i.hiddenRowMap,v=[],E=[],S=[],A=[],w=h;w<=f;w++)if(a!==r.lb.copy||!t.isRowHiddenByFilter(w)){for(var T={values:[]},y=[],I={isOwner:p.q.getConfig("isOwner"),ownerId:p.q.getConfig("ownerId"),tinyid:p.q.getConfig("tinyid")},O=u;O<=_;O++){var D=t.getCellDataAtPosition(w,O),b=null===D||void 0===D?void 0:D.getMergeReference();w%(f-h+1)===0&&S.push(t.getColProperties(O)),O%(_-u+1)===0&&A.push(t.getRowProperties(w)),b=g({mergeReference:b,hiddenRowMap:m,fromGridRange:s,x:O,y:w,copyType:a});var C=(0,l.G)({cellData:D,hiddenRowMap:m,copyRange:(0,o.convertXYRangeToGridRange)(n,t.getSheetId()),x:O,y:w,rowData:t.data.rowData,copyType:a}).newCellData;D=null===C||void 0===C?void 0:C.clone(),(0,c.xy)(t.spreadsheetReference,w,O,t,I)||(0,d.tE)(t.spreadsheetReference.parent,w,O)?T.values.push(null):T.values.push(D);var x=!!b&&{w:b.getColCount(),h:b.getRowCount()};y.push(x)}v.push(T),E.push(y)}return{rowDataUpdate:v,mergeCells:E,colsDimensionProperties:S,rowsDimensionProperties:A}},g=function(e){var t=e.mergeReference,n=e.hiddenRowMap,r=e.fromGridRange,o=e.x,i=e.y,c=e.copyType;if(!t)return null;var u=t.clone(),d=(0,a.bF)({mergeReference:u,hiddenRowMap:n,copyRange:r,copyType:c,isCopyForOuter:!1}),l=d.xUnit,p=d.yUnit,h=d.x,_=d.y;return u=h===o&&_===i&&(l>1||p>1)?new s.Z("sheetid",_,_+p-1,h,h+l-1):null},R=function(e,t){var n=t.xRange[0],r=t.yRange[0],o=t.xRange[1],s=t.yRange[1],a=e.getColCount(),i=e.getRowCount();o>a&&(o=a),s>i&&(s=i);var c=e.getBasicFilter();return{fromXStart:n,fromYStart:r,fromXEnd:o,fromYEnd:s,hiddenRowMap:c?c.getHiddenRowMap():new Map}},S=function(e,t){var n={isMerge:!1,isSingle:!1},r=e.startRowIndex,o=e.startColIndex,s=e.isSingle(),a=t.getCellDataAtPosition(r,o);return((0,u.rangeIsMergeCell)(e,a)||s)&&(n.isSingle=!0,(0,u.rangeIsMergeCell)(e,a)?n.isMerge=!0:n.isMerge=!1),n},A=function(e){return{activeSheet:e.spreadsheet.activeSheet,activeSheetId:e.spreadsheet.activeSheetId}}},"../spread-sheet/src/core/feature/copyPaste/core/paste-flow.ts":function(e,t,n){n.d(t,{LC:function(){return T}}),n("../node_modules/core-js/modules/web.dom-collections.for-each.js"),n("../node_modules/core-js/modules/es.object.assign.js"),n("../node_modules/core-js/modules/es.string.anchor.js"),n("../node_modules/core-js/modules/es.array.map.js"),n("../node_modules/core-js/modules/es.array.concat.js"),n("../node_modules/core-js/modules/es.array.iterator.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/web.dom-collections.iterator.js"),n("../node_modules/core-js/modules/es.map.js"),n("../node_modules/core-js/modules/es.string.iterator.js"),n("../node_modules/core-js/modules/esnext.map.delete-all.js"),n("../node_modules/core-js/modules/esnext.map.every.js"),n("../node_modules/core-js/modules/esnext.map.filter.js"),n("../node_modules/core-js/modules/esnext.map.find.js"),n("../node_modules/core-js/modules/esnext.map.find-key.js"),n("../node_modules/core-js/modules/esnext.map.includes.js"),n("../node_modules/core-js/modules/esnext.map.key-of.js"),n("../node_modules/core-js/modules/esnext.map.map-keys.js"),n("../node_modules/core-js/modules/esnext.map.map-values.js"),n("../node_modules/core-js/modules/esnext.map.merge.js"),n("../node_modules/core-js/modules/esnext.map.reduce.js"),n("../node_modules/core-js/modules/esnext.map.some.js"),n("../node_modules/core-js/modules/esnext.map.update.js");var r=n("../spread-sheet/src/core/feature/copyPaste/interfaces.ts"),o=n("../packages/model/src/cell/index.ts"),s=n("../packages/model/src/cell/CellDataSlot.ts"),a=n("../packages/model/src/range/GridRange.ts"),i=n("../packages/model/src/range/gridRangeUtils.ts"),c=n("../spread-sheet/src/core/feature/copyPaste/utils/mergeRangeUtils.ts"),u=n("../packages/model/src/range/DimensionRange.ts"),d=n("../packages/model/src/dimension/DimensionType.ts"),l=n("../spread-sheet/src/core/feature/copyPaste/preVerify/showTips.ui.ts"),p=n("../packages/model/src/dimension/DimensionProperties.ts"),h=n("../spread-sheet/src/core/feature/copyPaste/middleware/index.ts"),_=n("../spread-sheet/src/core/feature/copyPaste/middleware/interface.ts"),f=n("../spread-sheet/src/core/feature/copyPaste/util.ts"),m=n("../spread-sheet/src/core/utils/index.ts"),v=n("../spread-sheet/src/core/feature/formula/utils/parseUtil.ts"),E=n("../spread-sheet/src/core/feature/copyPaste/convertor/convertShapeData2IAddImage.ts"),g=n("../spread-sheet/src/core/feature/copyPaste/utils/onPaste.ts"),R=n("../spread-sheet/src/core/feature/copyPaste/lib/PasteSpecial/logics/pasteTypes.ts"),S=n("../spread-sheet/src/core/app/sheetStatus/private-range.ts"),A=n("../spread-sheet/src/core/data/configService/spreadConfig.ts");function w(e){var t=e.xIndex,n=e.yIndex,r=e.shapeDatas,o=[];return r.forEach((function(e){e&&o.push(Object.assign(Object.assign({},e),{anchor:{col:e.anchor?e.anchor.col+t:t,row:e.anchor?e.anchor.row+n:n}}))})),o}var T=function(e,t,n,r,o,s,a,i){var c=(0,g.lY)(s),u=s.containTable,d=s.infoDimension,l=(0,g.FU)(c,n),p=y({activeSheet:t,sheetManager:e,activeSheetId:r,cacheState:n,to:o,pasteData:s,fromCache:c,config:a,containTable:u,isCut:l}),h=p.fromGridRange,_=p.fromGridRangeLen,f=p.toGridRange,m=p.fromGridRangeType,v=p.toGridRangeType,R=p.pasteTile,S=p.useXYLen,A=p.mappingTypeWithOutMergeAndUnMerge,T=I(c,s,l,n,e,_),O=N(s),D=C(f,S),b=D.endRowIndex,k=D.endColIndex;if(f.endRowIndex=b,f.endColIndex=k,!(null===a||void 0===a?void 0:a.isInsertOrDeleteRange)&&!P(S,f,t,a))return!1;var F=x(T),M=L({fromGridRangeLen:_,pasteData:s,activeSheetId:r,toGridRange:f,fromGridRange:h,useXYLen:S,cacheState:n,isCut:l,mappingTypeWithOutMergeAndUnMerge:A,cutRanges:F,cutData:T,config:a,activeSheet:t,sheetManager:e,envs:i}),H=M.rowDataUpdate,U=M.newColsDimensionProperties,V=M.newRowsDimensionProperties,Z=M.unMergeCellsPaste,G=M.mergeCellsPaste,B=M.propsKeys,W=M.isFomulaInCut,z=j(c,s,V,U,n,_,f),X=z.pasteDimensionPropsRanges,q=z.changeRowProps,J=z.changeColProps,Q=Y(t,f,S,r,l),$=Q.crossFilterRow,ee=Q.pasteRanges,te=(0,g.tK)(s,n),ne=K(s,n),re=ne.cellMask,oe=ne.formatMask,se=ne.fromOuterContentType,ae=(0,g.iI)({toGridRange:f,useXYLen:S,crossFilterRow:$,changeRowProps:q,changeColProps:J,pasteData:s});return{option:Object.assign(Object.assign({params:{fromOuterContentType:se,pasteSpecialType:null===i||void 0===i?void 0:i.pasteSpecialType},cellMask:re,formatMask:oe,sheetId:r,pasteRanges:ee,unmergeInfos:Z,mergeInfos:G,cutData:T,copyRange:te,toGridRange:f,propsKeys:B,infoDimension:Object.assign(d||{},{sheet:t,pasteRange:f,pasteDimensionPropsRanges:X,rowsDimensionProperties:V,columnsDimensionProperties:U,crossFilterRow:$}),pasteEmbeddedObjects:w({xIndex:f.startColIndex,yIndex:f.startRowIndex,shapeDatas:O}).map((function(e){return(0,E.zn)(e,r)})),isFormatPainter:!!(null===a||void 0===a?void 0:a.isFormatPainter)},(null===i||void 0===i?void 0:i.clearRangeContent)?{clearRangeContent:i.clearRangeContent}:{}),{cutEmbeddedArray:s.cutEmbeddedArray||[]}),rowDataUpdate:H,crossFilterRow:$,useXYLen:S,fromCache:c,isCut:l,pasteTile:R,fromGridRangeType:m,toGridRangeType:v,pasteRanges:ee,selectAreaCellRange:ae,isFomulaInCut:W}},y=function(e){var t=e.activeSheet,n=e.activeSheetId,r=e.cacheState,o=e.to,s=e.pasteData,a=e.fromCache,i=e.config,c=e.containTable,u=e.isCut,d=(0,g.U4)(t,r,n,o,s,u),l=d.fromGridRange,p=d.fromGridRangeLen,h=d.toGridRange,_=d.toGridRangeLen,f=(0,g.RD)(t,s,h),m=f.fromGridRangeType,v=f.toGridRangeType,E=(0,g.AZ)(p,_,a),R=(0,g._l)(t,h,p,_,E,i);return{fromGridRange:l,fromGridRangeLen:p,toGridRange:h,fromGridRangeType:m,toGridRangeType:v,pasteTile:E,useXYLen:R,mappingTypeWithOutMergeAndUnMerge:(0,g.Ci)(c,m,v,R)}},I=function(e,t,n,r,o,s){var i={cutGridRanges:[],cutUnmergeOptions:[],cutRowsDimensionRanges:[],cutColumnsDimensionRanges:[]};if(e&&n&&r.sheetId){var c=r.from.xRange,u=c[0],d=c[1],l=r.from.yRange,p=l[0],h=l[1],_=r.sheetId,f=s.fromXLen,m=s.fromYLen;i.cutGridRanges=[new a.Z(_,p,h,u,d)],O(t,f,m,u,p,_,i),D(i,r,_,f,u),b(i,r,_,m,p)}return i},O=function(e,t,n,r,o,s,a){if(e.merge)for(var i=0;i<n;i++)for(var c=o+i,u=0;u<t;u++){var d=r+u,l=e.merge[i][u];l&&W(l)&&a.cutUnmergeOptions.push({startRowIndex:c,endRowIndex:c+l.h-1,startColIndex:d,endColIndex:d+l.w-1,sheetId:s})}},D=function(e,t,n,r,o){t.select.selectCol&&e.cutColumnsDimensionRanges.push(new u.Z(n,o,o+r-1,d.Z.COLUMNS))},b=function(e,t,n,r,o){t.select.selectRow&&e.cutRowsDimensionRanges.push(new u.Z(n,o,o+r-1,d.Z.ROWS))},C=function(e,t){return{endRowIndex:e.startRowIndex+t.useYLen-1,endColIndex:e.startColIndex+t.useXLen-1}},x=function(e){return[].concat(e.cutGridRanges,e.cutColumnsDimensionRanges,e.cutRowsDimensionRanges)},N=function(e){return e.images&&e.images.length>0?e.images:[]},P=function(e,t,n,r){for(var o=e.useXLen,s=e.useYLen,a=t.startRowIndex,i=t.startColIndex,u=0;u<s;u++)for(var d=a+u,p=0;p<o;p++){var h=i+p;if((0,c.Ft)(n.getCellDataAtPosition(d,h),d,h)){var _=n.getCellDataAtPosition(d,h),f=null===_||void 0===_?void 0:_.getMergeReference();if(f&&!t.contain(f))return console.error("粘贴区域不允许和合并单元格相交"),(0,l.oc)(),!1}if((null===r||void 0===r?void 0:r.isFormatPainter)&&(0,c.aB)(n.getCellDataAtPosition(d,h),d,h)){var m=n.getCellDataAtPosition(d,h),v=null===m||void 0===m?void 0:m.getMergeReference();if(v&&!t.contain(v))return console.error("格式刷在刷单元格的时候，目的范围必须包含合并单元格"),(0,l.nS)(),!1}}return!0},L=function(e){for(var t,n=e.fromGridRangeLen,r=e.pasteData,s=e.activeSheetId,a=e.toGridRange,i=e.fromGridRange,c=e.useXYLen,u=e.cacheState,d=e.isCut,l=e.mappingTypeWithOutMergeAndUnMerge,p=e.cutRanges,f=e.cutData,m=e.config,E=e.sheetManager,g=e.activeSheet,w=e.envs,T={cellImage:[]},y=a.startRowIndex,I=a.startColIndex,O=c.useXLen,D=c.useYLen,b=[],C=[],x=[],N=[],P=[],L=!1,j={isOwner:A.q.getConfig("isOwner"),ownerId:A.q.getConfig("ownerId"),tinyid:A.q.getConfig("tinyid")},k=function(e){var c=y+e,A=e%n.fromYLen;b.push({values:[]});for(var D=function(y){var O=I+y,D=y%n.fromXLen,k=r.rowDataUpdate[A].values[D];(0,S.xy)(g.spreadsheetReference,c,O,g,j)&&(k=void 0);var U=B(O,c,i,u,s);h.Z.getMiddleWaresByLevel(_.aC.CELL_PROPS).forEach((function(e){var t,n={cellData:k,pasteData:r,offset:{row:c,col:O,fromRow:A,fromCol:D},sheetManager:E,activeSheet:g,activeSheetId:s,cacheState:u,ext:{propsKeys:T,isPasteCellInCopyRange:U}},o=((null===(t=e.processPasteData)||void 0===t?void 0:t.call(e,n))||{}).newCellData;o&&(k=o)}));var V=d?Z(k,{fromOffsetX:D,fromOffsetY:A},{toX:O,toY:c},u,p):G(r,{fromOffsetX:D,fromOffsetY:A},{toX:O,toY:c});if(V&&(d?(L=!0,k.setFormula(V)):k.setFormula((0,v.EG)(V,c,O,s))),(null===w||void 0===w?void 0:w.pasteSpecialType)!==R.bX.ONLYVALUES&&(null===k||void 0===k?void 0:k.getFormula())&&(null===k||void 0===k||k.clearEffectiveValue()),(null===w||void 0===w?void 0:w.pasteSpecialType)===R.bX.ONLYVALUES&&(null===(t=null===k||void 0===k?void 0:k.getEffectiveValue())||void 0===t?void 0:t.type)===o.EXTENDED_VALUE_TYPE.ERROR&&(null===k||void 0===k||k.clearEffectiveValue()),null===k||void 0===k||k.clearIsDataValid(),H({offsetX:y,offsetY:e},{fromOffsetX:D,fromOffsetY:A},{toX:O,toY:c},C,x,r,g),b[e].values.push(k),l)return"continue";M({toX:O,toY:c},N,g,u,f,s),F({fromOffsetX:D,fromOffsetY:A},{toX:O,toY:c},r,P,a,s,m)},k=0;k<O;k++)D(k)},U=0;U<D;U++)k(U);return{rowDataUpdate:b,newColsDimensionProperties:x,newRowsDimensionProperties:C,unMergeCellsPaste:N,mergeCellsPaste:P,propsKeys:T,isFomulaInCut:L}},j=function(e,t,n,r,o,s,a){var c=s.fromXLen,u=s.fromYLen,l=k(e,o,t,c,u),p=l.changeRowProps,h=l.changeColProps,_=t.infoDimension,f=(0,i.convertGridRangeToDimensionRanges)(a),m=f.rowDimensionRange,v=f.colDimensionRange,E=[];if(_){var g=_.insertDimensionRanges;g&&g.forEach((function(e){var t=e.dimension;t===d.Z.ROWS?E.push(m):t===d.Z.COLUMNS&&E.push(v)}))}else n.length>0&&p&&E.push(m),r.length>0&&h&&E.push(v);return{pasteDimensionPropsRanges:E,changeRowProps:p,changeColProps:h}},k=function(e,t,n,o,s){var a=!1,i=!1;return e&&t.select?(a=t.select.selectAll||t.select.selectRow,i=t.select.selectAll||t.select.selectCol):n.fromApp===r.o_.tencent?(a=n.select.selectAll||n.select.selectRow,i=n.select.selectAll||n.select.selectCol):(a=!(1===o),i=!(1===s)),{changeRowProps:a,changeColProps:i}},F=function(e,t,n,r,o,s,a){var i,c=null===(i=n.merge)||void 0===i?void 0:i[e.fromOffsetY][e.fromOffsetX];if(W(c)){var u=o.endRowIndex,d=o.endColIndex,l=Math.min(t.toY+c.h-1,u),p=Math.min(t.toX+c.w-1,d);if((null===a||void 0===a?void 0:a.isFormatPainter)&&p===t.toX&&l===t.toY)return;r.push({startRowIndex:t.toY,endRowIndex:l,startColIndex:t.toX,endColIndex:p,sheetId:s})}},M=function(e,t,n,r,o,s){if((0,c.aB)(n.getCellDataAtPosition(e.toY,e.toX),e.toY,e.toX)){var a=n.getCellDataAtPosition(e.toY,e.toX);if(a){var i=a.getMergeReference();i&&(r.sheetId===s&&o.cutUnmergeOptions.reduce((function(e,t){return e||t.startRowIndex===i.startRowIndex&&t.startColIndex===i.startColIndex&&t.endRowIndex===i.endRowIndex&&t.endColIndex===i.endColIndex}),!1)||t.push(i))}}},H=function(e,t,n,r,o,s,a){U(e,t,n,r,s,a),V(e,t,n,o,s,a)},U=function(e,t,n,o,s,a){var i=a.data.rowMetadata;if(0===e.offsetX&&s.rowsDimensionProperties){var c=s.rowsDimensionProperties[t.fromOffsetY],u=null===i||void 0===i?void 0:i[n.toY],d=null===u||void 0===u?void 0:u.pixelSize;if(null===c)return void o.push(null);if(s.fromApp===r.o_.tencent||void 0===d||0===d||null===d)return void o.push(c);if(c=p.Z.createInstance(Object.assign(Object.assign({},c),{pixelSize:d})),!u||!c.equal(u))return void o.push(c);o.push(null)}},V=function(e,t,n,o,s,a){var i=a.data.colMetadata;if(0===e.offsetY&&s.colsDimensionProperties){var c=s.colsDimensionProperties[t.fromOffsetX],u=null===i||void 0===i?void 0:i[n.toX],d=null===u||void 0===u?void 0:u.pixelSize;if(null===c)return void o.push(null);if(s.fromApp===r.o_.tencent||null===d||void 0===d||0===d)return void o.push(c);if(c=p.Z.createInstance(Object.assign(Object.assign({},c),{pixelSize:d})),!u||!c.equal(u))return void o.push(c);o.push(null)}},Z=function(e,t,n,r,o){var s,a=r.from,i=[a.xRange[0],a.yRange[0],a.xRange[1],a.yRange[1]];if(null===e||void 0===e?void 0:e.getFormula()){var c=e.getFormula();c&&(s=(0,f.Bs)(c,{cutRanges:o,oldRow:i[1]+t.fromOffsetY,oldCol:i[0]+t.fromOffsetX,newRow:n.toY,newCol:n.toX}))}return s},G=function(e,t,n){var r=e.formula;if(r){var o=r[t.fromOffsetY]?r[t.fromOffsetY][t.fromOffsetX]:null;if(o)return o=(0,f.$8)(o),m.Z.formula.util.getFormulaWithRelativeFormula(o,n.toY,n.toX)}},B=function(e,t,n,r,o){if(!n)return!1;if(r.sheetId!==o)return!1;var s=n.endColIndex,a=n.endRowIndex,i=n.startColIndex,c=n.startRowIndex;return e>=i&&e<=s&&t>=c&&t<=a},W=function(e){return"object"===typeof e},K=function(e,t){var n=e.cellMask,o=void 0===n?s.i.ALL:n,a=e.formatMask,i=e.fromOuterContentType;return t.pasteType===r.lb.copy&&"undefined"!==typeof o&&(o-=1<<s.Z.SLOT_MENTION),{cellMask:o,formatMask:a,fromOuterContentType:i}},Y=function(e,t,n,r,o){for(var s=0,c=e.getBasicFilter(),u=[],d=c?c.getHiddenRowMap():new Map,l=t.startRowIndex,p=t.startColIndex,h=n.useXLen,_=n.useYLen,f=0,m=l,v=l-1;f<_;f++){var E=p,g=p+h-1;if(v+=1,d.get(v)){if(o){var R=new a.Z(r,m,v,E,g);f!==_-1&&(m=v+1),u.push(R);continue}if(f-=1,s+=1,v-m<1){m=v+1;continue}var S=new a.Z(r,m,v-1,E,g);u.push(S),m=v+1}else if(f===_-1){var A=new a.Z(r,m,v,E,g);u.push(A)}}return{crossFilterRow:s,pasteRanges:(0,i.mergeGridRanges)(u)}}},"../spread-sheet/src/core/feature/formula/calculate-plugin/calc-plugin-base.ts":function(e,t,n){n.d(t,{Z:function(){return r}});var r=function(){function e(){}var t=e.prototype;return t.beforeBatchCalculate=function(){},t.beforeEveryCalculation=function(e,t){},t.afterEveryCalculation=function(e,t,n,r){},e}()},"../spread-sheet/src/core/network/datacenter/loader/loaderErrorType.ts":function(e,t,n){var r,o;n.d(t,{H:function(){return o}}),function(e){e.LOAD_OFFLINE_DOCUMENT_DATA_FAIL="LOAD_OFFLINE_DOCUMENT_DATA_FAIL",e.LOAD_OFFLINE_CHUNK_DATA_FAIL="LOAD_OFFLINE_CHUNK_DATA_FAIL",e.LOAD_OFFLINE_VERSION_DATA_NULL="LOAD_OFFLINE_VERSION_DATA_NULL",e.LOAD_OFFLINE_VERSION_DATA_INVALID="LOAD_OFFLINE_VERSION_DATA_INVALID",e.LOAD_OFFLINE_SHEET_DATA_FAIL="LOAD_OFFLINE_SHEET_DATA_FAIL",e.LOAD_ONLINE_DOCUMENT_DATA_FAIL="LOAD_ONLINE_DOCUMENT_DATA_FAIL",e.LOAD_ONLINE_SHEET_DATA_FAIL="LOAD_ONLINE_SHEET_DATA_FAIL",e.LOAD_ONLINE_SHEET_DATA_CATCH_ERROR="LOAD_ONLINE_SHEET_DATA_CATCH_ERROR",e.OPEN_DOC_JSON_PARSE_ERROR="OPEN_DOC_JSON_PARSE_ERROR",e.OPEN_DOC_BLANK_PAGE_FORBIDDEN_RETRY="OPEN_DOC_BLANK_PAGE_FORBIDDEN_RETRY",e.OPEN_DOC_BLANK_PAGE_ERROR_MAX_RETRY="OPEN_DOC_BLANK_PAGE_ERROR_MAX_RETRY",e.OPEN_DOC_NOT_200_ERROR_MAX_RETRY="OPEN_DOC_BLANK_PAGE_ERROR_MAX_RETRY",e.OPEN_DOC_PAD_TYPE_ERROR="OPEN_DOC_PAD_TYPE_ERROR",e.OPEN_DOC_ERROR_UNKNOWN="OPEN_DOC_ERROR_UNKNOWN",e.OPEN_DOC_PAD_NO_EXIST="OPEN_DOC_PAD_NO_EXIST",e.OPEN_DOC_AXIOS_ERROR="OPEN_DOC_AXIOS_ERROR"}(r||(r={})),function(e){e.DATA_NULL="DATA_NULL",e.RETCODE_ERROR="RETCODE_ERROR",e.FETCH_FAIL="FETCH_FAIL"}(o||(o={})),t.Z=r},"../spread-sheet/src/core/network/datacenter/loader/loaderUtil.ts":function(e,t,n){n.d(t,{KE:function(){return c},c2:function(){return a},mm:function(){return d},zV:function(){return u}}),n("../node_modules/core-js/modules/es.regexp.exec.js"),n("../node_modules/core-js/modules/es.string.split.js");var r=n("../node_modules/i18next/dist/esm/i18next.js"),o=n("../node_modules/@tencent/docs_offline/lib/index.js"),s=n("../spread-sheet/src/base/util/appConfig.ts"),a={sheetId:"BB08J2",firstChunkEndRow:60,firstChunkEndCol:25,rowCount:200,colCount:26,padType:"sheet"},i=2e3;function c(e){var t=e.from,n=e.to;if(t>n)return[];for(var r=[];t<=n;){if(!(t+i<n)){r.push({from:t,to:n});break}r.push({from:t,to:t+i}),t=t+i+1}return r}function u(e){var t=a.padType,i=a.firstChunkEndRow,c=a.firstChunkEndCol,u=a.rowCount,d=a.colCount,l=a.sheetId,p=e.globalPadId,h=e.secretId,_=e.uid,f="string"===typeof p?p.split("$")[0]:"",m="string"===typeof p?p.split("$")[1]:"",v=e.title?1:0,E=e.title||r.ZP.t("无标题表格"),g="D0000000000000001"===h;return{appInfoConfig:null,padType:t,isProPad:!0,shortLink:"https://"+s.Z.getConfig("runtime.domainName")+"/sheet/"+h,docStatus:0,advPolicy:{view_forbid_copy_print:0,reader_can_comment:0,writer_can_comment:0},uin:"",isEmbed:!0,invitedGroupInfos:[],newOpenSvc:1,nameGuess:null,colorPalette:[],domainId:f,userId:_,useFbChat:!1,localPadId:m,userName:"",disableFB:!0,relativeUrl:null,collab_client_vars:{padType:t,rev:0,sheetId:"BB08J2",client:{sid:"",upid:h,tid:0,sig:""},initialAttributedText:{text:[[[{t:14,v:5,c:[l,14,0,u]},{t:14,v:5,c:[l,2,0,d]}],[{t:3,v:5,c:[[l,0,i,0,c],{},{0:[],1:[],2:[]}]}]]],attribs:""},globalPadId:p,ver:6,bad:2,padSubId:l,gray:0,apool:{},header:[{d:[{id:l,name:r.ZP.t("工作表1")}],type:"ms"}],wmode:"wb",pos:1,websocket:!0,apid:{},pver:1,dirty:2,padId:m,websocketReopenCount:-1,dver:n.g.__globalCodeVersion,pollingAttemptNumber:0},padTitle:E,padStatus:e.isLocalNewFile||g?o.DL.LOCAL:o.DL.NORMAL,isUserChangeTitle:v,initialOptions:{guestPolicy:""},globalPadId:p,titleIsReadOnly:!0,relative:null,envi:{port:8084,type:1,ip:0},userColor:0,isOwner:!0,policy:0,friendUserIds:[],clientIp:"",userIsGuest:!1,proTitle:"",userDomain:"",ownerId:_,specialKey:null,isTimDomain:!0,isOverConNum:!1,shouldGetFbLoginStatus:!0,initialSpaces:null,ownerAppid:"",accountPrivs:{maxRevisions:1e8},isPublicPad:!1,userInfo:{uid:_,corp_id:"",uin:0,third_uid:"",domain:"",fullName:"",wx_openid:"oDzL40GSNzd1-VCksCAEF8hDYi7o"},padId:m,rightFlag:4294967295,isPadAdmin:!0,siteName:"",isLogin:!0,initialRevisionList:[],specialKeyTranslation:null,userPic:"",privilegeExpire:0,privilegeAttribute:{can_read:1,is_auth:1,can_edit:1,can_link_exp:1,can_watermark:1,can_history:1,can_copy_doc:1,can_translate:1,can_about:1,can_copy:1,can_comment:1,can_add_user:1,can_search:1,can_edit_title:1,can_share:1,can_spit_slot:1,can_view_image:1,can_print:1,can_edit_tab:1},creatorId:_,initialTitle:E,creatorDomain:f,isOpendocxfromTim:!1,isCreator:!1,encrypted:"",userLink:"",dropboxConnected:!1,invitedUserInfos:[],isTimOnline:!0,preview:"",lastModifyUser:"",createdDate:Date.now(),isSnapshot:!1,metaCreateTime:Date.now(),tinyid:"",lastModifyTime:Date.now(),oPadSubId:l,userType:"",uidKey:"",vipInfo:"",enableToCVipFeature:!1,templateInfo:"",newPadType:""}}function d(e){return!(!e.data||!e.status||200!==e.status)}},"../spread-sheet/src/core/network/datacenter/utils/report.ts":function(e,t,n){n.d(t,{CL:function(){return h},Nr:function(){return l},mz:function(){return o}}),n("../node_modules/core-js/modules/es.array.includes.js");var r,o,s=n("../spread-sheet/src/external/report/alloyreport.ts"),a=n("../packages/report/src/index.ts"),i=(n("../node_modules/@tencent/docs-user-agent/dist/index.js"),n("../spread-sheet/src/base/config/report.ts")),c=n("../spread-sheet/src/core/network/datacenter/loader/loaderErrorType.ts"),u=n("../spread-sheet/src/base/log/production-log.ts");!function(e){e[e.LOAD_OFFLINE_VERSION_DATA_NULL=35260568]="LOAD_OFFLINE_VERSION_DATA_NULL",e[e.LOAD_OFFLINE_VERSION_DATA_INVALID=35260545]="LOAD_OFFLINE_VERSION_DATA_INVALID",e[e.SWITCH_SHEET_PRELOAD_CACHE_MOBILE=35245212]="SWITCH_SHEET_PRELOAD_CACHE_MOBILE",e[e.SWITCH_SHEET_PRELOAD_CACHE_PC=35245210]="SWITCH_SHEET_PRELOAD_CACHE_PC",e[e.SWITCH_SHEET_PRELOAD_CACHE_PAD=35245211]="SWITCH_SHEET_PRELOAD_CACHE_PAD",e[e.SWITCH_SHEET_SECOND_SWITCH_CACHE_MOBILE=35245215]="SWITCH_SHEET_SECOND_SWITCH_CACHE_MOBILE",e[e.SWITCH_SHEET_SECOND_SWITCH_CACHE_PC=35245213]="SWITCH_SHEET_SECOND_SWITCH_CACHE_PC",e[e.SWITCH_SHEET_SECOND_SWITCH_CACHE_PAD=35245214]="SWITCH_SHEET_SECOND_SWITCH_CACHE_PAD",e[e.SWITCH_SHEET_NO_CACHE_MOBILE=35245218]="SWITCH_SHEET_NO_CACHE_MOBILE",e[e.SWITCH_SHEET_NO_CACHE_PC=35245216]="SWITCH_SHEET_NO_CACHE_PC",e[e.SWITCH_SHEET_NO_CACHE_PAD=35245217]="SWITCH_SHEET_NO_CACHE_PAD"}(r||(r={})),function(e){e.SERVER_LOADER_OPEN_DOC_INLINE_DATA="SERVER_LOADER_OPEN_DOC_INLINE_DATA",e.SERVER_LOADER_OPEN_DOC_INLINE_NOT_DATA="SERVER_LOADER_OPEN_DOC_INLINE_NOT_DATA",e.SERVER_LOADER_FETCH_OPEN_DOC_ERROR="SERVER_LOADER_FETCH_OPEN_DOC_ERROR",e.SERVER_LOADER_FETCH_OPEN_DOC="SERVER_LOADER_FETCH_OPEN_DOC",e.SERVER_LOADER_OPEN_DOC_RESPONSE="SERVER_LOADER_OPEN_DOC_RESPONSE",e.SERVER_LOADER_HANDLE_BLANK_PAGE_JSONP="SERVER_LOADER_HANDLE_BLANK_PAGE_JSONP",e.SERVER_LOADER_HANDLE_OPEN_DOC_RESPONSE_FROM_RETRY="SERVER_LOADER_HANDLE_OPEN_DOC_RESPONSE_FROM_RETRY",e.SERVER_LOADER_HANDLE_BLANK_PAGE="SERVER_LOADER_HANDLE_BLANK_PAGE",e.SERVER_LOADER_LOAD_CHUNK_DATA="SERVER_LOADER_LOAD_CHUNK_DATA",e.SERVER_LOADER_LOAD_CHUNK_DATA_ERROR="SERVER_LOADER_LOAD_CHUNK_DATA_ERROR",e.SERVER_LOADER_LOAD_CHUNK_DATA_RESPONSE_NOT_DATA="SERVER_LOADER_LOAD_CHUNK_DATA_RESPONSE_NOT_DATA",e.SERVER_LOADER_LOAD_CHUNK_DATA_RESPONSE="SERVER_LOADER_LOAD_CHUNK_DATA_RESPONSE",e.SERVER_LOADER_DECREASE_SLICED_ROW_COUNT="SERVER_LOADER_DECREASE_SLICED_ROW_COUNT",e.SERVER_LOADER_FETCH_SHEET_CHUNK="SERVER_LOADER_FETCH_SHEET_CHUNK",e.SERVER_LOADER_FETCH_SHEET_CHUNK_RETRY_3_TIMES_ERROR="SERVER_LOADER_FETCH_SHEET_CHUNK_RETRY_3_TIMES_ERROR",e.SERVER_LOADER_HANDLE_SHEET_DATA_RESPONSE="SERVER_LOADER_HANDLE_SHEET_DATA_RESPONSE",e.SERVER_LOADER_SET_SLICE_ROW_COUNT="SERVER_LOADER_SET_SLICE_ROW_COUNT",e.LOADER_PAUSE="LOADER_PAUSE",e.LOADER_WORK="LOADER_WORK",e.OFFLINE_LOADER_LOAD_DOCUMENT_DATA="OFFLINE_LOADER_LOAD_DOCUMENT_DATA",e.OFFLINE_LOADER_LOAD_DOCUMENT_DATA_SUCCESS="OFFLINE_LOADER_LOAD_DOCUMENT_DATA_SUCCESS",e.OFFLINE_LOADER_HANDLE_SNAP_SHOT="OFFLINE_LOADER_HANDLE_SNAP_SHOT",e.OFFLINE_LOADER_HANDLE_SNAP_SHOT_NOT_DATA="OFFLINE_LOADER_HANDLE_SNAP_SHOT_NOT_DATA",e.OFFLINE_LOADER_HANDLE_CHUNK_DATA="OFFLINE_LOADER_HANDLE_CHUNK_DATA",e.OFFLINE_LOADER_HANDLE_CHUNK_DATA_NOT_DATA="OFFLINE_LOADER_HANDLE_CHUNK_DATA_NOT_DATA",e.OFFLINE_LOADER_HANDLE_VERSION_DATA_ERROR="OFFLINE_LOADER_HANDLE_VERSION_DATA_ERROR",e.OFFLINE_LOADER_HANDLE_VERSION_DATA="OFFLINE_LOADER_HANDLE_VERSION_DATA",e.OFFLINE_LOADER_HANDLE_VERSION_DATA_VERSION_ERROR="OFFLINE_LOADER_HANDLE_VERSION_DATA_VERSION_ERROR",e.OFFLINE_LOADER_LOAD_SHEET_DATA="OFFLINE_LOADER_LOAD_SHEET_DATA",e.OFFLINE_LOADER_LOAD_SHEET_DATA_SUCCESS="OFFLINE_LOADER_LOAD_SHEET_DATA_SUCCESS",e.OFFLINE_LOADER_HANDLE_SHEET_SNAP_SHOT="OFFLINE_LOADER_HANDLE_SHEET_SNAP_SHOT",e.OFFLINE_LOADER_LOAD_SHEET_DATA_FAIL="OFFLINE_LOADER_LOAD_SHEET_DATA_FAIL",e.OFFLINE_LOADER_LOAD_DOCUMENT_DATA_FAIL="OFFLINE_LOADER_LOAD_DOCUMENT_DATA_FAIL",e.LOAD_OFFLINE_VERSION_DATA_NULL="LOAD_OFFLINE_VERSION_DATA_NULL",e.LOAD_OFFLINE_VERSION_DATA_INVALID="LOAD_OFFLINE_VERSION_DATA_INVALID",e.LOAD_ERROR="LOAD_ERROR"}(o||(o={}));var d,l={SERVER_LOADER_OPEN_DOC_INLINE_DATA:function(e){return(0,s.ji)({level:s.y8.INFO,moduleValue:"serverLoader",actionValue:"openDocInlineData",detail:e})},SERVER_LOADER_OPEN_DOC_INLINE_NOT_DATA:function(e){return(0,s.ji)({level:s.y8.INFO,moduleValue:"serverLoader",actionValue:"openDocInlineNotData",detail:e})},SERVER_LOADER_FETCH_OPEN_DOC_ERROR:function(e){return(0,s.ji)({level:s.y8.INFO,moduleValue:"serverLoader",actionValue:"fetchOpenDocError",detail:e})},SERVER_LOADER_FETCH_OPEN_DOC:function(e){return(0,s.ji)({level:s.y8.INFO,moduleValue:"serverLoader",actionValue:"fetchOpenDoc",detail:e})},SERVER_LOADER_OPEN_DOC_RESPONSE:function(e){return(0,s.ji)({level:s.y8.INFO,moduleValue:"serverLoader",actionValue:"openDocResponse",detail:e})},SERVER_LOADER_HANDLE_BLANK_PAGE_JSONP:function(e){return(0,s.ji)({level:s.y8.INFO,moduleValue:"serverLoader",actionValue:"handleBlankPageJsonP",detail:e})},SERVER_LOADER_HANDLE_OPEN_DOC_RESPONSE_FROM_RETRY:function(e){return(0,s.ji)({level:s.y8.INFO,moduleValue:"serverLoader",actionValue:"handleOpenDocResponseFromRetry",detail:e})},SERVER_LOADER_HANDLE_BLANK_PAGE:function(e){return(0,s.ji)({level:s.y8.INFO,moduleValue:"serverLoader",actionValue:"handleBlankPage",detail:e})},SERVER_LOADER_LOAD_CHUNK_DATA:function(e){return(0,s.ji)({level:s.y8.INFO,moduleValue:"serverLoader",actionValue:"loadChunkData",detail:e})},SERVER_LOADER_LOAD_CHUNK_DATA_ERROR:function(e){return(0,s.ji)({level:s.y8.INFO,moduleValue:"serverLoader",actionValue:"loadChunkDataError",detail:e})},SERVER_LOADER_LOAD_CHUNK_DATA_RESPONSE_NOT_DATA:function(e){return(0,s.ji)({level:s.y8.INFO,moduleValue:"serverLoader",actionValue:"loadChunkDataResponseNotData",detail:e})},SERVER_LOADER_LOAD_CHUNK_DATA_RESPONSE:function(e){return(0,s.ji)({level:s.y8.INFO,moduleValue:"serverLoader",actionValue:"loadChunkDataResponse",detail:e})},SERVER_LOADER_DECREASE_SLICED_ROW_COUNT:function(e){return(0,s.ji)({level:s.y8.INFO,moduleValue:"serverLoader",actionValue:"decreaseSlicedRowCount",detail:e})},SERVER_LOADER_FETCH_SHEET_CHUNK:function(e){return(0,s.ji)({level:s.y8.INFO,moduleValue:"serverLoader",actionValue:"fetchSheetChunk",detail:e})},SERVER_LOADER_FETCH_SHEET_CHUNK_RETRY_3_TIMES_ERROR:function(e){return(0,s.ji)({level:s.y8.INFO,moduleValue:"serverLoader",actionValue:"fetchSheetRetry3TimesError",detail:e})},SERVER_LOADER_HANDLE_SHEET_DATA_RESPONSE:function(e){return(0,s.ji)({level:s.y8.INFO,moduleValue:"serverLoader",actionValue:"handleSheetDataResponse",detail:e})},SERVER_LOADER_SET_SLICE_ROW_COUNT:function(e){return(0,s.ji)({level:s.y8.INFO,moduleValue:"serverLoader",actionValue:"setSliceRowCount",detail:e})},LOADER_PAUSE:function(e){return(0,s.ji)({level:s.y8.INFO,moduleValue:"loader",actionValue:"pause",detail:e})},LOADER_WORK:function(e){return(0,s.ji)({level:s.y8.INFO,moduleValue:"loader",actionValue:"work",detail:e})},OFFLINE_LOADER_LOAD_DOCUMENT_DATA:function(e){return(0,s.ji)({level:s.y8.INFO,moduleValue:"offlineLoader",actionValue:"loadDocumentData",detail:e})},OFFLINE_LOADER_LOAD_DOCUMENT_DATA_SUCCESS:function(e){return(0,s.ji)({level:s.y8.INFO,moduleValue:"offlineLoader",actionValue:"loadDocumentDataSuccess",detail:e})},OFFLINE_LOADER_HANDLE_SNAP_SHOT:function(e){return(0,s.ji)({level:s.y8.INFO,moduleValue:"offlineLoader",actionValue:"handleSnapShot",detail:e})},OFFLINE_LOADER_HANDLE_SNAP_SHOT_NOT_DATA:function(e){return(0,s.ji)({level:s.y8.INFO,moduleValue:"offlineLoader",actionValue:"handleSnapShotNotData",detail:e})},OFFLINE_LOADER_HANDLE_CHUNK_DATA:function(e){return(0,s.ji)({level:s.y8.INFO,moduleValue:"offlineLoader",actionValue:"handleChunkData",detail:e})},OFFLINE_LOADER_HANDLE_CHUNK_DATA_NOT_DATA:function(e){return(0,s.ji)({level:s.y8.INFO,moduleValue:"offlineLoader",actionValue:"handleChunkDataNotData",detail:e})},OFFLINE_LOADER_HANDLE_VERSION_DATA_ERROR:function(e){return(0,s.ji)({level:s.y8.INFO,moduleValue:"offlineLoader",actionValue:"handleVersionDataError",detail:e})},OFFLINE_LOADER_HANDLE_VERSION_DATA:function(e){return(0,s.ji)({level:s.y8.INFO,moduleValue:"offlineLoader",actionValue:"handleVersionData",detail:e})},OFFLINE_LOADER_HANDLE_VERSION_DATA_VERSION_ERROR:function(e){return(0,s.ji)({level:s.y8.INFO,moduleValue:"offlineLoader",actionValue:"handleVersionDataVersionError",detail:e})},OFFLINE_LOADER_LOAD_SHEET_DATA:function(e){return(0,s.ji)({level:s.y8.INFO,moduleValue:"offlineLoader",actionValue:"loadSheetData",detail:e})},OFFLINE_LOADER_LOAD_SHEET_DATA_SUCCESS:function(e){return(0,s.ji)({level:s.y8.INFO,moduleValue:"offlineLoader",actionValue:"loadSheetDataSuccess",detail:e})},OFFLINE_LOADER_HANDLE_SHEET_SNAP_SHOT:function(e){return(0,s.ji)({level:s.y8.INFO,moduleValue:"offlineLoader",actionValue:"handleSheetSnapShot",detail:e})},OFFLINE_LOADER_LOAD_SHEET_DATA_FAIL:function(e){return(0,s.ji)({level:s.y8.INFO,moduleValue:"offlineLoader",actionValue:"loadSheetDataFail",detail:e})},OFFLINE_LOADER_LOAD_DOCUMENT_DATA_FAIL:function(e){return(0,s.ji)({level:s.y8.INFO,moduleValue:"offlineLoader",actionValue:"loadDocumentDataFail",detail:e})},LOAD_ERROR:function(e,t){return(0,s.ji)({level:s.y8.DEBUG,moduleValue:"errorHandler",actionValue:t,detail:e})},LOAD_OFFLINE_VERSION_DATA_NULL:function(){return a.ZP.monitor(r.LOAD_OFFLINE_VERSION_DATA_NULL)},LOAD_OFFLINE_VERSION_DATA_INVALID:function(){return a.ZP.monitor(r.LOAD_OFFLINE_VERSION_DATA_INVALID)}};!function(e){e[e.PRELOAD_CACHE=0]="PRELOAD_CACHE",e[e.SECOND_SWITCH_CACHE=1]="SECOND_SWITCH_CACHE",e[e.NO_CACHE=2]="NO_CACHE"}(d||(d={}));var p=[1,2,4,8,9,10,14,15,20],h={loadDocumentDataFail:function(e){var t,n;p.includes(null===(n=null===(t=null===e||void 0===e?void 0:e.data)||void 0===t?void 0:t.clientVars)||void 0===n?void 0:n.type)||e.type===c.Z.OPEN_DOC_PAD_TYPE_ERROR||(a.ZP.zzsStatus({attrid:i.ZZS_REPORT_ATTR.OPENDOC_LOAD_FAIL,status:1}),u.$.report("OPENDOC_LOAD_FAIL"))}}},"../spread-sheet/src/core/network/message-center/base/BaseMessageCenterAdapter.ts":function(e,t,n){var r=n("../node_modules/@babel/runtime/helpers/esm/inheritsLoose.js"),o=function(e){function t(){return e.apply(this,arguments)||this}return(0,r.Z)(t,e),t}(n("../node_modules/@tencent/containerized/build/main/index.js").JT);t.Z=o},"../spread-sheet/src/core/network/message-center/model/MissChange.ts":function(e,t){t.Z=function(e){this.isValid=!0,this.commitId=e.commitId,this.sheetId=e.subId,this.newVersion=e.newRev,this.changeset=e.changeset,this.changesetType=e.changesetType,this.isNeedKeyframe=e.need,this.head=e.head,this.isWorkbook=e.isWorkbook||!1,this.revert=e.revert,this.collabUserId=e.author,this.keyData=e.keyData}},"../spread-sheet/src/core/network/message-center/model/PendingControl.ts":function(e,t,n){var r=n("../node_modules/@babel/runtime/helpers/esm/createClass.js"),o=(n("../node_modules/core-js/modules/es.object.keys.js"),function(){function e(){this._sheet={},this._loadingCount=0}var t=e.prototype;return t.startLoadSheet=function(e){return this._sheet[e]?(console.warn("sheet has loading"),!1):(this._loadingCount=this._loadingCount+1,this._sheet[e]=1,!0)},t.finishLoadSheet=function(e){return this._sheet[e]?(this._loadingCount=this._loadingCount-1,this._sheet[e]=void 0,!0):(console.error("sheet has't loading"),!1)},(0,r.Z)(e,[{key:"loadingCount",get:function(){return this._loadingCount}},{key:"sheet",get:function(){return Object.keys(this._sheet)}}]),e}());t.Z=o},"../spread-sheet/src/core/network/message-center/model/UserChange.ts":function(e,t,n){n.d(t,{t:function(){return r}});var r,o=n("../node_modules/@babel/runtime/helpers/esm/createClass.js"),s=(n("../node_modules/core-js/modules/web.dom-collections.for-each.js"),n("../packages/report/src/index.ts")),a=n("../spread-sheet/src/base/config/report.ts"),i=n("../spread-sheet/src/core/behavior/multi-type-follow.ts");!function(e){e[e.WATING=0]="WATING",e[e.COMMITING=1]="COMMITING",e[e.ACCEPT=2]="ACCEPT"}(r||(r={}));var c=function(){function e(e){var t,o,c=this;this.head=!1,this.isWorkbook=!1,this.status=r.WATING,this.taskId=0,this.isOfflineMessage=!1,this.allowAutoMerge=!1,this.commitTimes=0,this.createMessageSeq=function(){return Math.ceil(2147483648*Math.random())},this.globalPadId=e.globalPadId,this.baseVersion=e.baseVersion,this.sheetId=e.sheetId,this.mutations=[],e.data&&(null===(o=null===(t=null===e||void 0===e?void 0:e.data)||void 0===t?void 0:t.mutations)||void 0===o||o.forEach((function(t){if(t&&Array.isArray(t)){var n=[];t.forEach((function(t){var r,o=(0,i.Xe)(t,null===(r=e.data)||void 0===r?void 0:r.changesetType);o&&n.push(o)})),c.mutations.push(n)}else s.ZP.run(a.CONFIG.INIT_DATA_ERROR,[e.data.mutations])})),this.changesetType=e.data.changesetType,this.changeData=e.data.changedata||e.data.changeData||null,this.keyData=e.data.keyData||null,this.head=e.data.head||!1,this.isWorkbook=e.data.isWorkbook||!1,this.originSheetId=e.data.oSubId||null,this.taskId=e.data.taskId||this.createMessageSeq()),this.isOfflineMessage=e.isOfflineMessage||!1,this.allowAutoMerge=e.allowAutoMerge||!1,this.time=e.time||(new Date).getTime(),this.status=e.status||r.WATING,this.dver=e.dver||n.g.__globalCodeVersion}var t=e.prototype;return t.isMutationChange=function(){return!this.changeData},t.setChangeData=function(e){this.changeData=e},t.setOrAppendMutations=function(e){this.mutations.push(e)},t.setKeyData=function(e){this.keyData=e},t.isWithKeyData=function(){return!!this.keyData},(0,o.Z)(e,[{key:"requestCount",get:function(){return this.isMutationChange()?(null===this||void 0===this?void 0:this.mutations.length)||0:1}},{key:"isEmpty",get:function(){return(!this.mutations||0===this.mutations.length)&&!this.changeData||0===this.taskId}},{key:"key",get:function(){return this.globalPadId+"_"+this.sheetId+"_"+this.time}}]),e}();t.Z=c},"../spread-sheet/src/core/network/message-center/model/changeset-type.ts":function(e,t,n){var r;n.d(t,{G:function(){return r}}),function(e){e.SMARTSHEET="smartsheet"}(r||(r={}))},"../spread-sheet/src/core/network/message-center/model/missChange-helper.ts":function(e,t,n){n.d(t,{AV:function(){return A},Ey:function(){return w},Tn:function(){return S},mb:function(){return f}});var r=n("../node_modules/@babel/runtime/helpers/esm/toConsumableArray.js"),o=(n("../node_modules/regenerator-runtime/runtime.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.promise.js"),n("../node_modules/core-js/modules/es.array.map.js"),n("../node_modules/core-js/modules/es.object.assign.js"),n("../node_modules/i18next/dist/esm/i18next.js")),s=n("./node_modules/axios/index.js"),a=n.n(s),i=n("../packages/common-utils/src/index.ts"),c=n("../spread-sheet/src/core/network/message-center/model/MissChange.ts"),u=n("../packages/report/src/index.ts"),d=n("../spread-sheet/src/base/config/report.ts"),l=n("../spread-sheet/src/base/error/index.ts"),p=n("../packages/utils/src/safe.ts"),h=(n("../spread-sheet/src/core/worker/worker-thread/index.ts"),function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function a(e){try{c(r.next(e))}catch(t){s(t)}}function i(e){try{c(r.throw(e))}catch(t){s(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,i)}c((r=r.apply(e,t||[])).next())}))});function _(e){return!(void 0!=e.revUpper&&e.revUpper<e.revLower)}function f(e){return h(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n,r,o,s,a;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:t.next=6;break;case 3:t.t0=t.sent,t.next=7;break;case 6:t.t0=(0,p.f)();case 7:return n=t.t0,r=(0,i.IZ)("snaptk"),o=(0,i.IZ)("snapts"),s=void 0===e.revUpper?"":"&to="+e.revUpper,a="/dop-api/get/changes?padId="+e.padId+"&from="+e.revLower+s+"&xsrf="+n+"&snpatk="+r+"&snapts="+o,t.abrupt("return",a);case 13:case"end":return t.stop()}}),t)})))}function m(e){var t,r;return h(this,void 0,void 0,regeneratorRuntime.mark((function o(){var s;return regeneratorRuntime.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return o.prev=0,o.next=3,a()({method:"get",url:e,responseType:"json"});case 3:if(s=o.sent,0===(null===(t=s.data)||void 0===t?void 0:t.retcode)){o.next=6;break}return o.abrupt("return",{isSuccess:!1,data:s});case 6:return o.abrupt("return",{isSuccess:!0,data:s});case 9:return o.prev=9,o.t0=o.catch(0),null===(r=n.g.log)||void 0===r||r.error("sendMissChangesRequest catch error.",null===o.t0||void 0===o.t0?void 0:o.t0.stack),o.abrupt("return",{isSuccess:!1,data:void 0});case 13:case"end":return o.stop()}}),o,null,[[0,9]])})))}function v(e,t){return void 0===t&&(t=2),h(this,void 0,void 0,regeneratorRuntime.mark((function n(){var r,o;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:r={isSuccess:!1,data:void 0},o=0;case 2:if(!(o<t)){n.next=14;break}return n.next=5,m(e);case 5:if(!(r=n.sent).isSuccess){n.next=9;break}return 1===o&&u.ZP.monitor(34276670),n.abrupt("break",14);case 9:return n.next=11,new Promise((function(e){setTimeout((function(){e(void 0)}),1e3)}));case 11:o+=1,n.next=2;break;case 14:return n.abrupt("return",r);case 15:case"end":return n.stop()}}),n)})))}function E(e){var t=e||{},n=t.status,r=t.data,s=t.statusText,a=void 0===s?"response is void":s;if(void 0===r)return{isSuccess:!1,data:void 0,errorCode:l.B.RESPONSE_DATA_EMPTY,errorMessage:a,reportCode:d.CONFIG.FETCH_USERCHANGES_3,reportOptions:[n,r]};var i=r.retcode,p=r.result;if(0!==i)return function(e){var t={1e5:33612375,100002:33612376,100003:33612377,200105:33612378,200200:33612379};e&&u.ZP.monitor(t[e])}(r.retcode),{isSuccess:!1,data:void 0,errorCode:l.B.RESPONSE_ERROR_CODE,errorMessage:"retcode="+r.retcode};var h=p.to,_=p.rev,f=p.changes;return 0===f.length?(u.ZP.monitor(33633645),{isSuccess:!1,data:void 0,errorCode:l.B.RESPONSE_ARRAY_EMPTY,errorMessage:o.ZP.t("userchanges长度为0")}):{isSuccess:!0,data:{maxRev:h,endRev:_,misschanges:f.map((function(e){var t=e.data;return new c.Z(t)}))}}}function g(e){return h(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n,r,s,a,i,c;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=0,_(e)){t.next=3;break}return t.abrupt("return",{isSuccess:!1,data:void 0,errorCode:l.B.RESPONSE_DATA_EMPTY,errorMessage:o.ZP.t("参数to小于from"),reportCode:d.CONFIG.FETCH_USERCHANGE_ARGUMENT,reportOptions:[e.revLower,e.revUpper]});case 3:return u.ZP.run(d.CONFIG.FETCH_USERCHANGES,[e.revLower,e.revUpper,n]),t.next=6,f(e);case 6:return r=t.sent,t.next=9,v(r);case 9:if(s=t.sent,a=s.isSuccess,i=s.data,a){t.next=13;break}return t.abrupt("return",{isSuccess:!1,data:void 0,errorCode:l.B.CGI_HTTP_ERROR,errorMessage:"fetch cgi error."});case 13:return c=E(i),t.abrupt("return",c);case 15:case"end":return t.stop()}}),t)})))}function R(e,t,n){return void 0===e&&n>t?{isFinish:!1,revLower:t+1,revUpper:n}:void 0!==e&&e>t&&e<=n?{isFinish:!1,revLower:t+1,revUpper:e}:{isFinish:!0}}function S(e){return h(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n,o,s,a;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=[],o=Object.assign({},e);case 2:return t.next=5,g(o);case 5:if((s=t.sent).isSuccess){t.next=10;break}return e.callback(!1,s.data,s.errorCode,s.errorMessage),void 0!==s.reportCode&&u.ZP.run(s.reportCode,s.reportOptions),t.abrupt("return");case 10:if(n.push.apply(n,(0,r.Z)(s.data.misschanges)),!(a=R(e.revUpper,s.data.maxRev,s.data.endRev)).isFinish){t.next=15;break}return e.callback(!0,n),t.abrupt("return");case 15:o=Object.assign(e,{revLower:a.revLower,revUpper:a.revUpper}),t.next=2;break;case 18:case"end":return t.stop()}}),t)})))}function A(e){return{commitId:e.commitId,subId:e.sheetId,newRev:e.newVersion,changeset:e.changeset,need:e.isNeedKeyframe,head:e.head,revert:e.revert,author:e.collabUserId,keyData:e.keyData}}function w(e){return new c.Z(e)}},"../spread-sheet/src/core/network/message-center/model/userChange-helper.ts":function(e,t,n){n.d(t,{HJ:function(){return d},Jv:function(){return u},PL:function(){return h},bR:function(){return p},rg:function(){return l}}),n("../node_modules/core-js/modules/web.dom-collections.for-each.js"),n("../node_modules/core-js/modules/es.array.concat.js");var r=n("../spread-sheet/src/core/network/message-center/model/UserChange.ts"),o=n("../packages/report/src/index.ts"),s=n("../spread-sheet/src/base/config/report.ts"),a=n("../spread-sheet/src/core/behavior/multi-type-follow.ts"),i=n("../spread-sheet/src/core/network/message-center/model/changeset-type.ts");function c(e){if(e.changeData)return JSON.stringify(e.changeData);if(e.mutations){var t=[];return e.mutations.forEach((function(e){var n=[];e.forEach((function(e){var t=window.SpreadsheetApp.mutationBehavior.serializeMutation(e);n.push(t)})),t.push(n)})),JSON.stringify(t)}return JSON.stringify([])}function u(e){var t,n={};n.baseVersion=e.baseVersion,n.sheetId=e.sheetId;var r=[];null===(t=e.mutations)||void 0===t||t.forEach((function(t){var n=[];t.forEach((function(t){var r=window.SpreadsheetApp.mutationBehavior.serializeMutation(t);r?n.push(r):o.ZP.run(s.CONFIG.STORE_DATA_ERROR,[e.mutations])})),r.push(n)}));var a=e.changeData||null,i={type:"USER_CHANGES",taskId:e.taskId,baseRev:e.baseVersion,mutations:r,changeData:a,keyData:e.keyData,head:e.head,subId:e.sheetId,oSubId:e.originSheetId||!1,pver:1,changesetType:e.changesetType};return n.isOfflineMessage=!0,n.data=i,n.time=e.time,n.status=e.status,n.dver=e.dver,n}function d(e){var t={type:"USER_CHANGES",baseRev:e.baseVersion,changeset:c(e),changesetType:e.changesetType,keydata:e.keyData||!1,head:e.head,isWorkbook:e.isWorkbook,subId:e.sheetId,oSubId:e.originSheetId||!1,changeSetCount:e.requestCount,offlineMsg:e.isOfflineMessage,taskId:e.taskId,pver:1};return t.changeset=t.changeset+"\n",t.keydata&&(t.keydata=t.keydata+"\n"),JSON.stringify(t)}function l(e){var t={globalPadId:e.globalPadId,baseVersion:e.baseVersion,sheetId:e.sheetId,status:e.status,data:{}};if(e.mutations){var n=[];e.mutations.forEach((function(e){var t=[];e.forEach((function(e){var n=window.SpreadsheetApp.mutationBehavior.serializeMutation(e);t.push(n)})),n.push(t)})),t.data.mutations=JSON.stringify(n),t.data.changesetType=e.changesetType}return e.changeData&&(t.data.changeData=JSON.stringify(e.changeData)),void 0!==e.head&&(t.data.head=e.head),void 0!==e.originSheetId&&(t.data.oSubId=e.originSheetId),void 0!==e.taskId&&(t.data.taskId=e.taskId),void 0!==e.isWorkbook&&(t.data.isWorkbook=e.isWorkbook),t}function p(e){var t,n,o,s=e;if("smartsheet"===(null===(t=s.data)||void 0===t?void 0:t.changesetType)&&(s.data.mutations=[]),null===(n=s.data)||void 0===n?void 0:n.mutations)try{s.data.mutations=JSON.parse(s.data.mutations)}catch(a){}return(null===(o=s.data)||void 0===o?void 0:o.changeData)&&(s.data.changeData=JSON.parse(s.data.changeData)),new r.Z(s)}function h(e,t){var n=e.spreadsheet.sheetManager.getSheetBySheetId(t.sheetId),r=t.changesetType,o=[];t.mutations.forEach((function(e){o=o.concat(e)})),(t.head||t.isWorkbook||(null===n||void 0===n?void 0:n.isLoaded)||(null===n||void 0===n?void 0:n.getSheetId())===e.spreadsheet.activeSheetId&&r!==i.G.SMARTSHEET)&&(0,a.d)(o,r)}},"../spread-sheet/src/core/view/layout/basePreviewView.ts":function(e,t,n){var r=n("../node_modules/@babel/runtime/helpers/esm/inheritsLoose.js"),o=(n("../node_modules/regenerator-runtime/runtime.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.promise.js"),n("../spread-sheet/src/core/view/layout/view.ts")),s=n("../spread-sheet/src/core/view/spreadsheet-view/table-view/utils.ts"),a=n("../spread-sheet/src/base/event/eventName.ts"),i=function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function a(e){try{c(r.next(e))}catch(t){s(t)}}function i(e){try{c(r.throw(e))}catch(t){s(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,i)}c((r=r.apply(e,t||[])).next())}))},c=function(e){function t(t,n){var r;return(r=e.call(this,t,t.spreadsheet)||this).app=t,r.spreadsheet=n,r.plugins={},r}(0,r.Z)(t,e);var o=t.prototype;return o.renderFirstScreen=function(){return i(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.canvas.initLevel1({preview:!0});case 2:(0,s.gB)(this.canvas.tableView,0,this.app.spreadsheet.activeSheet.getRowCount(),0,this.app.spreadsheet.activeSheet.getColCount()),this.canvas.renderApi.renderTable(),this.app.event.init.trigger(a.W1.AFTER_FIRST_RENDER);case 5:case"end":return e.stop()}}),e,this)})))},o.renderLevelPreview=function(){var e,t,r;return i(this,void 0,void 0,regeneratorRuntime.mark((function o(){return regeneratorRuntime.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,this.canvas.initPreview();case 2:this.canvas.renderApi.renderNextTick(),this._afterCanvasLoaded(),this.app.event.init.trigger(a.W1.AFTER_ALL_RENDER),n.g.SpreadsheetAppInitComplete&&this.canvas.shapeStage.refresh(),null===(r=null===(t=null===(e=null===n.g||void 0===n.g?void 0:n.g.document)||void 0===e?void 0:e.body)||void 0===t?void 0:t.classList)||void 0===r||r.add("all-ready");case 7:case"end":return o.stop()}}),o,this)})))},t}(o.ZP);t.Z="page-history"==n.j?c:null},"../spread-sheet/src/core/view/level-1/scroll-bar/ScrollBar.base.ts":function(e,t,n){var r=n("../packages/lib/EventEmitter.ts"),o=function(e){this.emitter=new r.Z,this._mainBoard=e.mainBoard,this._areaData=e.areaData,this._scale=e.scale};o.EVENT={SCROLL:"scroll"},t.Z=o},"../spread-sheet/src/core/view/level-1/select-center/base/BaseSelectData.ts":function(e,t,n){n.d(t,{Z:function(){return m}});var r=n("../node_modules/@babel/runtime/helpers/esm/createClass.js"),o=n("../node_modules/@babel/runtime/helpers/esm/assertThisInitialized.js"),s=n("../node_modules/@babel/runtime/helpers/esm/inheritsLoose.js"),a=(n("../node_modules/core-js/modules/es.array.splice.js"),n("../spread-sheet/src/core/view/level-1/select-center/base/selection/AllSelection.ts")),i=n("../spread-sheet/src/core/view/level-1/select-center/base/selection/RowSelection.ts"),c=n("../spread-sheet/src/core/view/level-1/select-center/base/selection/ColSelection.ts"),u=n("../spread-sheet/src/core/view/level-1/select-center/base/selection/CellSelection.ts"),d=n("../spread-sheet/src/core/view/level-1/select-center/base/utils.ts"),l=function(e,t){this.row=-1,this.col=-1,this.row=e,this.col=t},p=n("../spread-sheet/src/core/view/level-1/select-center/base/selection/EmptySelection.ts"),h=n("../node_modules/@tencent/containerized/build/main/index.js"),_=n("../packages/lib/index.ts"),f=function(e){function t(t){var n;return(n=e.call(this)||this)._updateSelectDataByMerge=function(e){for(var t=e.startRow,r=e.endRow,o=e.startCol,s=e.endCol,a=n._selectData.selectQueue,i=0;i<a.length;i++){var c=a[i];c instanceof u.Z&&r>=c.yRange[0]&&t<=c.yRange[1]&&s>=c.xRange[0]&&o<=c.xRange[1]&&n._selectData.updateSelection(i,c,c.activation)}},n._updateSelectDataByInsertCol=function(e){if(n.isCurrentSheet(e))for(var t=e.index,r=e.amount,o=n._selectData.selectQueue,s=0;s<o.length;s++){var a=o[s],i=!1,d=a.activation;d&&t<=d.col&&(i=!0,d.col+=r),(a instanceof c.Z||a instanceof u.Z)&&(t<=a.xRange[0]&&(i=!0,a.xRange[0]+=r),t<=a.xRange[1]&&(i=!0,a.xRange[1]+=r)),i&&n._selectData.updateSelection(s,a,d)}},n._updateSelectDataByInsertRow=function(e){if(n.isCurrentSheet(e))for(var t=e.index,r=e.amount,o=n._selectData.selectQueue,s=0;s<o.length;s++){var a=o[s],c=!1,d=a.activation;d&&t<=d.row&&(c=!0,d.row+=r),(a instanceof i.Z||a instanceof u.Z)&&(t<=a.yRange[0]&&(c=!0,a.yRange[0]+=r),t<=a.yRange[1]&&(c=!0,a.yRange[1]+=r)),c&&n._selectData.updateSelection(s,a,d)}},n._updateSelectDataByDeleteCol=function(e){if(n.isCurrentSheet(e))for(var t=e.index,r=e.amount,o=n._selectData.selectQueue,s=0;s<o.length;s++){var a=o[s],i=!1,d=a.activation;d&&t<=d.col&&(i=!0,d.col=Math.min(n._spreadsheetView.rowcolAccessor.getColCount()-1,Math.max(t,d.col-r))),(a instanceof c.Z||a instanceof u.Z)&&(t<=a.xRange[0]&&(i=!0,a.xRange[0]=Math.min(n._spreadsheetView.rowcolAccessor.getColCount()-1,Math.max(t,a.xRange[0]-r))),t<=a.xRange[1]&&(i=!0,a.xRange[1]=Math.min(n._spreadsheetView.rowcolAccessor.getColCount()-1,Math.max(t,a.xRange[1]-r)))),i&&n._selectData.updateSelection(s,a,d)}},n._updateSelectDataByDeleteRow=function(e){if(n.isCurrentSheet(e))for(var t=e.index,r=e.amount,o=n._selectData.selectQueue,s=0;s<o.length;s++){var a=o[s],c=!1,d=a.activation;d&&t<=d.row&&(c=!0,d.row=Math.min(n._spreadsheetView.rowcolAccessor.getRowCount()-1,Math.max(t,d.row-r))),(a instanceof i.Z||a instanceof u.Z)&&(t<=a.yRange[0]&&(c=!0,a.yRange[0]=Math.min(n._spreadsheetView.rowcolAccessor.getRowCount()-1,Math.max(t,a.yRange[0]-r))),t<=a.yRange[1]&&(c=!0,a.yRange[1]=Math.min(n._spreadsheetView.rowcolAccessor.getRowCount()-1,Math.max(t,a.yRange[1]-r)))),c&&n._selectData.updateSelection(s,a,d)}},n._selectData=t.selectData,n._dataCallView=t.dataCallView,n._spreadsheetView=t.spreadsheetView,n._register(n._dataCallView.onMergeUnmerge(n._updateSelectDataByMerge)),n._register(n._dataCallView.onInsertCol(n._updateSelectDataByInsertCol)),n._register(n._dataCallView.onInsertRow(n._updateSelectDataByInsertRow)),n._register(n._dataCallView.onDeleteCol(n._updateSelectDataByDeleteCol)),n._register(n._dataCallView.onDeleteRow(n._updateSelectDataByDeleteRow)),n}return(0,s.Z)(t,e),t.prototype.isCurrentSheet=function(e){return e.sheetId===this._spreadsheetView.getActiveSheetId()},t}(h.JT),m=function(e){function t(t,n){var r;return(r=e.call(this)||this).dataCallView=t,r.spreadsheetView=n,r._selectQueue=[],r.onAddSelectDataEmitter=new _.Q5,r.onUpdateSelectDataEmitter=new _.Q5,r.onRemoveSelectDataEmitter=new _.Q5,r.onResetSelectDataEmitter=new _.Q5,r.isInsertion=!1,r.onAddSelectData=r.onAddSelectDataEmitter.event,r.onUpdateSelectData=r.onUpdateSelectDataEmitter.event,r.onRemoveSelectData=r.onRemoveSelectDataEmitter.event,r.onResetSelectData=r.onResetSelectDataEmitter.event,r._register(new f({dataCallView:r.dataCallView,spreadsheetView:r.spreadsheetView,selectData:(0,o.Z)(r)})),r}(0,s.Z)(t,e);var n=t.prototype;return n.isValid=function(){return!!this._selectQueue.length},n.setIsInsertion=function(e){this.isInsertion=e},n.getIsInsertion=function(){return this.isInsertion},n.addSelection=function(e,t){var n;if(null===e)n=p.Z.newInstance();else if(t){var r=this.correctSelection(e,t),o=r.correctParam,s=r.correctActivation;n=this.newSelectionWithActivation(o,s)}else n=this.newSelection(e);this._selectQueue.splice(this.currentSelectIndex+1,0,n)},n.updateSelection=function(e,t,n){var r,o=this._selectQueue[e];if(void 0===o)throw new Error("index error when change selectData");if(n){var s=this.correctSelection(t,n),a=s.correctParam,i=s.correctActivation;r=this.newSelectionWithActivation(a,i)}else r=this.newSelection(t);this._selectQueue[e]=r,this._clearSelection(o)},n.removeSelection=function(e){var t=this._selectQueue.splice(e,1)[0];if(void 0===t)throw new Error("index error when remove selectData");this._clearSelection(t)},n.resetSelection=function(){for(var e;e=this._selectQueue.shift();)this._clearSelection(e)},n.correctSelection=function(e,t){var n=this.spreadsheetView,r=n.rowcolAccessor,o=n.tableView;if(e.xRange&&e.yRange){var s=(0,d.Ci)(r,t,e),a=s.correctParam,i=s.correctActivation;return(0,d.nM)(o,e.yRange,e.xRange,d.mk.EXTEND),{correctParam:a,correctActivation:i}}if(e.xRange){var c=(0,d.ml)(o,r,t,e);return{correctParam:c.correctParam,correctActivation:c.correctActivation}}if(e.yRange){var u=(0,d.me)(o,r,t,e);return{correctParam:u.correctParam,correctActivation:u.correctActivation}}var l=(0,d.Ci)(r,t,e);return{correctParam:l.correctParam,correctActivation:l.correctActivation}},n._clearSelection=function(e){if(e.activation&&(e.activation=null),e instanceof a.Z)a.Z.destroy(e);else if(e instanceof i.Z)i.Z.destroy(e);else if(e instanceof c.Z)c.Z.destroy(e);else if(e instanceof u.Z)u.Z.destroy(e);else{if(!(e instanceof p.Z))throw new Error("unknown selection type");p.Z.destroy(e)}},n.newSelection=function(e){var t;return e.xRange&&e.yRange?((0,d.nM)(this.spreadsheetView.tableView,e.yRange,e.xRange,d.mk.EXTEND),t=u.Z.newInstance(e.yRange[0],e.yRange[1],e.xRange[0],e.xRange[1])):t=e.xRange?c.Z.newInstance(e.xRange[0],e.xRange[1]):e.yRange?i.Z.newInstance(e.yRange[0],e.yRange[1]):a.Z.newInstance(),t},n.newSelectionWithActivation=function(e,t){var n,r=this.spreadsheetView.tableView;if(e.xRange&&e.yRange?((0,d.nM)(r,e.yRange,e.xRange,d.mk.EXTEND),n=u.Z.newInstance(e.yRange[0],e.yRange[1],e.xRange[0],e.xRange[1])):n=e.xRange?c.Z.newInstance(e.xRange[0],e.xRange[1]):e.yRange?i.Z.newInstance(e.yRange[0],e.yRange[1]):a.Z.newInstance(),null===r.getCellViewAtPosition(t.row,t.col))throw new Error("getCellViewAtPosition error!");return n.activation=new l(t.row,t.col),n},(0,r.Z)(t,[{key:"select",get:function(){return this._selectQueue[this._selectQueue.length-1]||null}},{key:"selectQueue",get:function(){return this._selectQueue}},{key:"currentSelectIndex",get:function(){return this._selectQueue.length-1}}]),t}(h.JT)},"../spread-sheet/src/core/view/level-1/select-center/base/selection/AllSelection.ts":function(e,t,n){var r=n("../node_modules/@babel/runtime/helpers/esm/createClass.js"),o=n("../node_modules/@babel/runtime/helpers/esm/inheritsLoose.js"),s=function(e){function t(){var t;return(t=e.call(this)||this)._selectAll=!0,t.using=!1,t.using=!0,t}return(0,o.Z)(t,e),t.newInstance=function(){var e=t.pools.pop();return e?(e.using=!0,e):new t},t.destroy=function(e){e.using=!1,t.pools.push(e)},(0,r.Z)(t,[{key:"selectAll",get:function(){return this._selectAll}}]),t}(n("../spread-sheet/src/core/view/level-1/select-center/base/selection/BaseSelection.ts").Z);s.pools=[],t.Z=s},"../spread-sheet/src/core/view/level-1/select-center/base/selection/BaseSelection.ts":function(e,t,n){var r=n("../node_modules/@babel/runtime/helpers/esm/createClass.js"),o=function(){function e(){this.activation=null,this._selectRow=!1,this._selectCol=!1,this._selectCell=!1,this._selectAll=!1}return(0,r.Z)(e,[{key:"selectRow",get:function(){return this._selectRow}},{key:"selectCol",get:function(){return this._selectCol}},{key:"selectCell",get:function(){return this._selectCell}},{key:"selectAll",get:function(){return this._selectAll}}]),e}();t.Z=o},"../spread-sheet/src/core/view/level-1/select-center/base/selection/CellSelection.ts":function(e,t,n){var r=n("../node_modules/@babel/runtime/helpers/esm/createClass.js"),o=n("../node_modules/@babel/runtime/helpers/esm/inheritsLoose.js"),s=(n("../node_modules/core-js/modules/es.array.iterator.js"),n("../node_modules/core-js/modules/es.array-buffer.slice.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.typed-array.uint32-array.js"),n("../node_modules/core-js/modules/es.typed-array.copy-within.js"),n("../node_modules/core-js/modules/es.typed-array.every.js"),n("../node_modules/core-js/modules/es.typed-array.fill.js"),n("../node_modules/core-js/modules/es.typed-array.filter.js"),n("../node_modules/core-js/modules/es.typed-array.find.js"),n("../node_modules/core-js/modules/es.typed-array.find-index.js"),n("../node_modules/core-js/modules/es.typed-array.for-each.js"),n("../node_modules/core-js/modules/es.typed-array.includes.js"),n("../node_modules/core-js/modules/es.typed-array.index-of.js"),n("../node_modules/core-js/modules/es.typed-array.iterator.js"),n("../node_modules/core-js/modules/es.typed-array.join.js"),n("../node_modules/core-js/modules/es.typed-array.last-index-of.js"),n("../node_modules/core-js/modules/es.typed-array.map.js"),n("../node_modules/core-js/modules/es.typed-array.reduce.js"),n("../node_modules/core-js/modules/es.typed-array.reduce-right.js"),n("../node_modules/core-js/modules/es.typed-array.reverse.js"),n("../node_modules/core-js/modules/es.typed-array.set.js"),n("../node_modules/core-js/modules/es.typed-array.slice.js"),n("../node_modules/core-js/modules/es.typed-array.some.js"),n("../node_modules/core-js/modules/es.typed-array.sort.js"),n("../node_modules/core-js/modules/es.typed-array.subarray.js"),n("../node_modules/core-js/modules/es.typed-array.to-locale-string.js"),n("../node_modules/core-js/modules/es.typed-array.to-string.js"),function(e){function t(t,n,r,o){var s;return(s=e.call(this)||this).xRange=new Uint32Array(2),s.yRange=new Uint32Array(2),s._selectCell=!0,s._using=!1,s._true=!0,s._using=!0,s.yRange[0]=t,s.yRange[1]=n,s.xRange[0]=r,s.xRange[1]=o,s}return(0,o.Z)(t,e),t.newInstance=function(e,n,r,o){var s=t.pools.pop();return s?(s._using=!0,s.yRange[0]=e,s.yRange[1]=n,s.xRange[0]=r,s.xRange[1]=o,s):new t(e,n,r,o)},t.destroy=function(e){e._using=!1,e.xRange[0]=0,e.xRange[1]=0,e.yRange[0]=0,e.yRange[1]=0,t.pools.push(e)},(0,r.Z)(t,[{key:"selectCell",get:function(){return this._selectCell}}]),t}(n("../spread-sheet/src/core/view/level-1/select-center/base/selection/BaseSelection.ts").Z));s.pools=[],t.Z=s},"../spread-sheet/src/core/view/level-1/select-center/base/selection/ColSelection.ts":function(e,t,n){var r=n("../node_modules/@babel/runtime/helpers/esm/createClass.js"),o=n("../node_modules/@babel/runtime/helpers/esm/inheritsLoose.js"),s=(n("../node_modules/core-js/modules/es.array.iterator.js"),n("../node_modules/core-js/modules/es.array-buffer.slice.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.typed-array.uint32-array.js"),n("../node_modules/core-js/modules/es.typed-array.copy-within.js"),n("../node_modules/core-js/modules/es.typed-array.every.js"),n("../node_modules/core-js/modules/es.typed-array.fill.js"),n("../node_modules/core-js/modules/es.typed-array.filter.js"),n("../node_modules/core-js/modules/es.typed-array.find.js"),n("../node_modules/core-js/modules/es.typed-array.find-index.js"),n("../node_modules/core-js/modules/es.typed-array.for-each.js"),n("../node_modules/core-js/modules/es.typed-array.includes.js"),n("../node_modules/core-js/modules/es.typed-array.index-of.js"),n("../node_modules/core-js/modules/es.typed-array.iterator.js"),n("../node_modules/core-js/modules/es.typed-array.join.js"),n("../node_modules/core-js/modules/es.typed-array.last-index-of.js"),n("../node_modules/core-js/modules/es.typed-array.map.js"),n("../node_modules/core-js/modules/es.typed-array.reduce.js"),n("../node_modules/core-js/modules/es.typed-array.reduce-right.js"),n("../node_modules/core-js/modules/es.typed-array.reverse.js"),n("../node_modules/core-js/modules/es.typed-array.set.js"),n("../node_modules/core-js/modules/es.typed-array.slice.js"),n("../node_modules/core-js/modules/es.typed-array.some.js"),n("../node_modules/core-js/modules/es.typed-array.sort.js"),n("../node_modules/core-js/modules/es.typed-array.subarray.js"),n("../node_modules/core-js/modules/es.typed-array.to-locale-string.js"),n("../node_modules/core-js/modules/es.typed-array.to-string.js"),function(e){function t(t,n){var r;return(r=e.call(this)||this).xRange=new Uint32Array(2),r._selectCol=!0,r._using=!1,r._using=!0,r.xRange[0]=t,r.xRange[1]=n,r}return(0,o.Z)(t,e),t.newInstance=function(e,n){var r=t.pools.pop();return r?(r._using=!0,r.xRange[0]=e,r.xRange[1]=n,r):new t(e,n)},t.destroy=function(e){e._using=!1,e.xRange[0]=0,e.xRange[1]=0,t.pools.push(e)},(0,r.Z)(t,[{key:"selectCol",get:function(){return this._selectCol}}]),t}(n("../spread-sheet/src/core/view/level-1/select-center/base/selection/BaseSelection.ts").Z));s.pools=[],t.Z=s},"../spread-sheet/src/core/view/level-1/select-center/base/selection/EmptySelection.ts":function(e,t,n){var r=n("../node_modules/@babel/runtime/helpers/esm/inheritsLoose.js"),o=function(e){function t(){var t;return(t=e.call(this)||this)._using=!1,t._using=!0,t}return(0,r.Z)(t,e),t.newInstance=function(){var e=t.pools.pop();return e?(e._using=!0,e):new t},t.destroy=function(e){e._using=!1,t.pools.push(e)},t}(n("../spread-sheet/src/core/view/level-1/select-center/base/selection/BaseSelection.ts").Z);o.pools=[],t.Z=o},"../spread-sheet/src/core/view/level-1/select-center/base/selection/RowSelection.ts":function(e,t,n){var r=n("../node_modules/@babel/runtime/helpers/esm/createClass.js"),o=n("../node_modules/@babel/runtime/helpers/esm/inheritsLoose.js"),s=(n("../node_modules/core-js/modules/es.array.iterator.js"),n("../node_modules/core-js/modules/es.array-buffer.slice.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.typed-array.uint32-array.js"),n("../node_modules/core-js/modules/es.typed-array.copy-within.js"),n("../node_modules/core-js/modules/es.typed-array.every.js"),n("../node_modules/core-js/modules/es.typed-array.fill.js"),n("../node_modules/core-js/modules/es.typed-array.filter.js"),n("../node_modules/core-js/modules/es.typed-array.find.js"),n("../node_modules/core-js/modules/es.typed-array.find-index.js"),n("../node_modules/core-js/modules/es.typed-array.for-each.js"),n("../node_modules/core-js/modules/es.typed-array.includes.js"),n("../node_modules/core-js/modules/es.typed-array.index-of.js"),n("../node_modules/core-js/modules/es.typed-array.iterator.js"),n("../node_modules/core-js/modules/es.typed-array.join.js"),n("../node_modules/core-js/modules/es.typed-array.last-index-of.js"),n("../node_modules/core-js/modules/es.typed-array.map.js"),n("../node_modules/core-js/modules/es.typed-array.reduce.js"),n("../node_modules/core-js/modules/es.typed-array.reduce-right.js"),n("../node_modules/core-js/modules/es.typed-array.reverse.js"),n("../node_modules/core-js/modules/es.typed-array.set.js"),n("../node_modules/core-js/modules/es.typed-array.slice.js"),n("../node_modules/core-js/modules/es.typed-array.some.js"),n("../node_modules/core-js/modules/es.typed-array.sort.js"),n("../node_modules/core-js/modules/es.typed-array.subarray.js"),n("../node_modules/core-js/modules/es.typed-array.to-locale-string.js"),n("../node_modules/core-js/modules/es.typed-array.to-string.js"),function(e){function t(t,n){var r;return(r=e.call(this)||this).yRange=new Uint32Array(2),r._selectRow=!0,r._using=!1,r._using=!0,r.yRange[0]=t,r.yRange[1]=n,r}return(0,o.Z)(t,e),t.newInstance=function(e,n){var r=t.pools.pop();return r?(r._using=!0,r.yRange[0]=e,r.yRange[1]=n,r):new t(e,n)},t.destroy=function(e){e._using=!1,e.yRange[0]=0,e.yRange[1]=0,t.pools.push(e)},(0,r.Z)(t,[{key:"selectRow",get:function(){return this._selectRow}}]),t}(n("../spread-sheet/src/core/view/level-1/select-center/base/selection/BaseSelection.ts").Z));s.pools=[],t.Z=s},"../spread-sheet/src/core/view/level-1/select-center/base/stage/BaseSelectionStage.ts":function(e,t,n){var r=n("../node_modules/@babel/runtime/helpers/esm/assertThisInitialized.js"),o=n("../node_modules/@babel/runtime/helpers/esm/inheritsLoose.js"),s=n("../node_modules/@tencent/containerized/build/main/index.js"),a=n("../packages/lib/index.ts"),i=function(e){function t(t){var n;return(n=e.call(this)||this).onSelectionStageVisiableChangeEmitter=new a.Q5,n._showing=!0,n._selectData=t,n._register(n._selectData.onAddSelectData(n._addSelection.bind((0,r.Z)(n)))),n._register(n._selectData.onUpdateSelectData(n._updateSelection.bind((0,r.Z)(n)))),n._register(n._selectData.onRemoveSelectData(n._removeSelection.bind((0,r.Z)(n)))),n._register(n._selectData.onResetSelectData(n._resetSelection.bind((0,r.Z)(n)))),n.onSelectionStageVisiableChange=n.onSelectionStageVisiableChangeEmitter.event,n}return(0,o.Z)(t,e),t}(s.JT);t.Z=i},"../spread-sheet/src/core/view/level-1/select-center/base/stage/utils.ts":function(e,t,n){n.d(t,{i:function(){return d}}),n("../node_modules/core-js/modules/es.number.max-safe-integer.js"),n("../node_modules/core-js/modules/es.number.constructor.js");var r=n("../spread-sheet/src/core/view/level-1/select-center/base/selection/AllSelection.ts"),o=n("../spread-sheet/src/core/view/level-1/select-center/base/selection/RowSelection.ts"),s=n("../spread-sheet/src/core/view/level-1/select-center/base/selection/ColSelection.ts"),a=n("../spread-sheet/src/core/view/level-1/select-center/base/selection/CellSelection.ts"),i=n("../spread-sheet/src/core/view/level-1/select-center/base/utils.ts"),c=n("../spread-sheet/src/core/view/level-1/select-center/base/selection/EmptySelection.ts");function u(e){return function(e){return e%1===0}(e)?e:Math.round(e)+.5}function d(e,t,n){var d,l,p,h,_,f,m,v,E;if(n instanceof r.Z)d=0,l=0,p=u(t.col.frozen.contentSize+t.col.flow.contentSize),h=u(t.row.frozen.contentSize+t.row.flow.contentSize),f=0,v=0,m=Number.MAX_SAFE_INTEGER,E=Number.MAX_SAFE_INTEGER;else if(n instanceof o.Z)d=0,l=t.getDisplayGlobalTopByRow(n.yRange[0]),p=u(t.col.frozen.contentSize+t.col.flow.contentSize),h=u(t.getDisplayGlobalBottomByRow(n.yRange[1]))-l,f=n.yRange[0],v=0,m=n.yRange[1],E=Number.MAX_SAFE_INTEGER;else if(n instanceof s.Z)d=t.getDisplayGlobalLeftByCol(n.xRange[0]),l=0,p=u(t.getDisplayGlobalRightByCol(n.xRange[1]))-d,h=u(t.row.frozen.contentSize+t.row.flow.contentSize),f=0,v=n.xRange[0],m=Number.MAX_SAFE_INTEGER,E=n.xRange[1];else if(n instanceof a.Z)d=t.getDisplayGlobalLeftByCol(n.xRange[0]),l=t.getDisplayGlobalTopByRow(n.yRange[0]),p=u(t.getDisplayGlobalRightByCol(n.xRange[1]))-d,h=u(t.getDisplayGlobalBottomByRow(n.yRange[1]))-l,f=n.yRange[0],v=n.xRange[0],m=n.yRange[1],E=n.xRange[1];else{if(!(n instanceof c.Z))throw new Error("不可用的选区类型");d=-1,l=-1,p=-1,h=-1,f=-1,v=-1,m=-1,E=-1}if(n.activation&&n.activation.row>-1&&n.activation.col>-1){var g=(0,i.Uz)(e,n.activation.row,n.activation.col),R=g.row,S=g.col;if(R>=0&&S>=0){_=[0,0,0,0];var A=e.getCellViewAtPosition(R,S);if(null===A)throw new Error("展示选区异常");var w=R+(A.mergeData?A.mergeData.rowCount-1:0),T=S+(A.mergeData?A.mergeData.colCount-1:0),y=u(t.getDisplayGlobalLeftByCol(S)),I=u(t.getDisplayGlobalTopByRow(R)),O=u(t.getDisplayGlobalRightByCol(T)),D=u(t.getDisplayGlobalBottomByRow(w));_[0]=I-l,_[3]=y-d,_[1]=d+p-O,_[2]=l+h-D}}return{left:d,top:l,width:p,height:h,padding:_,startRow:f,endRow:m,startCol:v,endCol:E}}},"../spread-sheet/src/core/view/level-1/select-center/base/utils.ts":function(e,t,n){n.d(t,{BS:function(){return _},CK:function(){return I},Ci:function(){return E},Kt:function(){return w},Q8:function(){return p},TD:function(){return y},TS:function(){return g},UN:function(){return A},Uz:function(){return l},Xe:function(){return h},fq:function(){return O},lP:function(){return f},me:function(){return m},mk:function(){return r},ml:function(){return v},nM:function(){return d},rl:function(){return T},rz:function(){return R},yW:function(){return S}}),n("../node_modules/core-js/modules/es.object.assign.js");var r,o=n("../spread-sheet/src/core/view/utils/lambda.ts"),s=n("../spread-sheet/src/core/view/level-1/select-center/base/selection/ColSelection.ts"),a=n("../spread-sheet/src/core/view/level-1/select-center/base/selection/CellSelection.ts"),i=n("../spread-sheet/src/core/view/level-1/select-center/base/selection/RowSelection.ts"),c=n("../packages/model/src/range/index.ts"),u=n("../packages/model/src/range/GridRange.ts");function d(e,t,n,o){var s,a,i,c,u,d,l,p,h,_,f,m;for(void 0===o&&(o=r.EXTEND),i=n[0],u=n[1],c=t[0],d=t[1],s=c;s<=d;s++){for(h=!1,l=s===c||s===d?1:Math.max(u-i,1),a=i;a<=u;a+=l){if(null===(p=e.getCellViewAtPosition(s,a)))throw"getCellViewAtPosition error!, y: "+s+", x: "+a;if(p.mergeParent||p.mergeData){if(p.mergeParent?(_=a+p.mergeParent.x,f=s+p.mergeParent.y,m=e.getCellViewAtPosition(f,_)):(_=a,f=s,m=p),null===m)throw"getCellViewAtPosition error!, y: "+f+", x: "+_;if(o===r.DISCARD){if(m.mergeData.colCount+_-1>u){if((u=_-1)<i)return!1;h=!0;break}if(m.mergeData.rowCount+f-1>d){if((d=f-1)<c)return!1;h=!0;break}if(_<i){if((i=m.mergeData.colCount+_)>u)return!1;h=!0;break}if(f<c){if((c=m.mergeData.rowCount+f)>d)return!1;h=!0;break}}else if(m.mergeData.rowCount+f>d+1&&(d=m.mergeData.rowCount+f-1),f<c&&(s=c=f,h=!0),m.mergeData.colCount+_>u+1&&(u=m.mergeData.colCount+_-1,h=!0),_<i&&(i=_,h=!0),h)break}}h&&(s=c-1)}return n[0]=i,n[1]=u,t[0]=c,t[1]=d,!0}function l(e,t,n){var r=e.getCellViewAtPosition(t,n);return null===r?{row:-1,col:-1}:r.mergeParent?{col:n+r.mergeParent.x,row:t+r.mergeParent.y}:{row:t,col:n}}function p(e,t,n,r,o){for(;n<=r;){if(o(e,n,t))return n;n+=1}return null}function h(e,t,n,r,o){for(;n>=r;){if(o(e,n,t))return n;n-=1}return null}function _(e,t,n,r,o){for(;t<=r;){if(o(e,n,t))return t;t+=1}return null}function f(e,t,n,r,o){for(;t>=r;){if(o(e,n,t))return t;t-=1}return null}function m(e,t,n,r){var s=Object.assign({},n),a=Object.assign({},r),i=p(e,n.row,n.col,t.getColCount()-1,(function(e,n,r){return(0,o.D0)(e,n,r)&&(0,o.hZ)(t,n,r)}));return null===i&&(a.xRange&&(a.xRange=[0,0]),i=0),s.col=i,{correctParam:a,correctActivation:s}}function v(e,t,n,r){var s=Object.assign({},n),a=Object.assign({},r),i=_(e,n.row,n.col,t.getRowCount()-1,(function(e,n,r){return(0,o.dK)(e,n,r)&&(0,o.hZ)(t,n,r)}));return null===i&&(a.yRange&&(a.yRange=[0,0]),i=0),s.row=i,{correctParam:a,correctActivation:s}}function E(e,t,n){var r=Object.assign({},t),s=Object.assign({},n),a=p(e,t.row,t.col,e.getColCount()-1,o.Sl),i=_(e,t.row,t.col,e.getRowCount()-1,o.So);return null===a&&(s.xRange=[0,0],a=0),null===i&&(s.yRange=[0,0],i=0),r.row=i,r.col=a,{correctParam:s,correctActivation:r}}function g(e,t){for(var n=[],r=0;r<t.length;r++){var o=t[r];o.selectAll||o.selectCol?n.push([0,e.getRowCount()-1]):(o.selectRow||o.selectCell)&&n.push([o.yRange[0],o.yRange[1]])}return n}function R(e,t){for(var n=[],r=0;r<t.length;r++){var o=t[r];o.selectAll||o.selectRow?n.push([0,e.getColCount()-1]):(o.selectCol||o.selectCell)&&n.push([o.xRange[0],o.xRange[1]])}return n}function S(e,t){for(var n=[],r=0;r<t.length;r++){var o=t[r];o.selectAll?n.push({xRange:[0,e.getColCount()-1],yRange:[0,e.getRowCount()-1]}):o.selectCol?n.push({xRange:[o.xRange[0],o.xRange[1]],yRange:[0,e.getRowCount()-1]}):o.selectRow?n.push({xRange:[0,e.getColCount()-1],yRange:[o.yRange[0],o.yRange[1]]}):o.selectCell&&n.push({xRange:[o.xRange[0],o.xRange[1]],yRange:[o.yRange[0],o.yRange[1]]})}return n}function A(e,t,n){for(var r=[],o=t.getRowCount()-1,s=t.getColCount()-1,a=0;a<n.length;a++){var i=n[a],u=void 0;if(i.selectAll)u=new c.GridRange(e,0,o,0,s);else if(i.selectRow)u=new c.GridRange(e,i.yRange[0],i.yRange[1],0,s);else if(i.selectCol)u=new c.GridRange(e,0,o,i.xRange[0],i.xRange[1]);else{if(!i.selectCell)throw new Error("不可用的选区类型");u=new c.GridRange(e,i.yRange[0],i.yRange[1],i.xRange[0],i.xRange[1])}r.push(u)}return r}function w(e,t,n){for(var r=n.selectQueue,o=0;o<r.length;o++){var c=r[o];if(c.selectAll)return!0;if(c instanceof i.Z){if(e>=c.yRange[0]&&e<=c.yRange[1])return!0}else if(c instanceof s.Z){if(t>=c.xRange[0]&&t<=c.xRange[1])return!0}else{if(!(c instanceof a.Z))throw new Error("不可用的选区类型");if(e>=c.yRange[0]&&e<=c.yRange[1]&&t>=c.xRange[0]&&t<=c.xRange[1])return!0}}return!1}function T(e,t){for(var n=t.selectQueue,r=0;r<n.length;r++){var o=n[r];if(o.selectAll)return!0;if(o instanceof s.Z&&e>=o.xRange[0]&&e<=o.xRange[1])return!0}return!1}function y(e,t){for(var n=t.selectQueue,r=0;r<n.length;r++){var o=n[r];if(o.selectAll)return!0;if(o instanceof i.Z&&e>=o.yRange[0]&&e<=o.yRange[1])return!0}return!1}function I(e,t){if(1!==t.selectQueue.length)return!1;var n=t.select;if(n instanceof a.Z){var r=n.xRange,o=r[0],s=r[1],i=n.yRange,c=i[0],u=i[1];if(o===s&&c===u)return!0;var d=e.getCellViewAtPosition(c,o);if(null===d||void 0===d?void 0:d.mergeData){var l=d.mergeData;if(l.colCount===s-o+1&&l.rowCount===u-c+1)return!0}}return!1}function O(e,t,n){for(var r=[],o=n.selectQueue,d=0;d<o.length;d++){var l=o[d];l.selectAll?r.push(new c.GridRange(e)):l instanceof s.Z?r.push(new c.GridRange(e,u.v,u.v,l.xRange[0],l.xRange[1])):l instanceof i.Z?r.push(new c.GridRange(e,l.yRange[0],l.yRange[1],u.v,u.v)):l instanceof a.Z&&r.push(new c.GridRange(e,l.yRange[0],l.yRange[1],l.xRange[0],l.xRange[1]))}return r}!function(e){e[e.DISCARD=0]="DISCARD",e[e.EXTEND=1]="EXTEND"}(r||(r={}))},"../spread-sheet/src/core/view/spreadsheet-view/render-manager/alloy-excel/table/body/cell-renders/base-cell-render.ts":function(e,t){var n=function(){function e(e){this.transformTable=e}var t=e.prototype;return t.renderTextCheck=function(e){return!1},t.renderText=function(e,t){},t.renderBackgroundCheck=function(e){return!1},t.renderBackground=function(e,t){},e}();t.Z=n},"../spread-sheet/src/core/view/utils/base-func.ts":function(e,t,n){function r(e){var t,n;null===(t=e.stopPropagation)||void 0===t||t.call(e),null===(n=e.preventDefault)||void 0===n||n.call(e)}function o(e){var t;null===(t=e.stopPropagation)||void 0===t||t.call(e)}function s(e){var t;null===(t=e.preventDefault)||void 0===t||t.call(e)}function a(e,t){return e>=t[0]&&e<=t[1]}function i(e,t,n,r){return[e,t,e+n,t,e+n,t+r,e,t+r,e,t]}function c(e){var t=this,n=null;return function(){for(var r=arguments.length,o=new Array(r),s=0;s<r;s++)o[s]=arguments[s];n||(n=Promise.resolve().then((function(){e.apply(t,o),n=null})))}}function u(e,t){var n=this;void 0===t&&(t=0);var r=null;return function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];r||(r=setTimeout((function(){e.apply(n,s),r=null}),t))}}function d(e,t){var n=this;void 0===t&&(t=0);var r=0,o=0;return function(){for(var s=arguments.length,a=new Array(s),i=0;i<s;i++)a[i]=arguments[i];o=Date.now();var c=function(){Date.now()-o>t||(e.apply(n,a),u())},u=function(){r=requestAnimationFrame(c)};r&&(cancelAnimationFrame(r),r=0),u()}}n.d(t,{Ic:function(){return d},PF:function(){return s},UW:function(){return o},ad:function(){return c},j9:function(){return i},kf:function(){return u},p7:function(){return r},yQ:function(){return a}}),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.promise.js")},"../spread-sheet/src/core/worker/common/base-controller.ts":function(e,t,n){n.d(t,{Z:function(){return s}}),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.promise.js");var r=n("../spread-sheet/src/base/util/timer.ts"),o=n("../spread-sheet/src/core/worker/util.ts"),s=function(){function e(){this.isDebugMode=!1,this.actionHandlerMap={}}var t=e.prototype;return t.request=function(e,t){if(this.channel)return this.channel.request(e,t);console.error("没有通信 Channel.")},t.requestPromise=function(e,t,n){return void 0===t&&(t=""),this.channel?this.channel.requestPromise(e,t,n):Promise.reject(new Error("no Channel."))},t.addActionHandler=function(e,t){if(this.isDebugMode,this.hasActionHandler(e))throw new Error("已注册事务 `"+e+"` 的处理器, 不能重复注册");this.actionHandlerMap[e]=t},t.actionHandler=function(e){var t=this,n=e.actionType,s=e.payload;if(!this.hasActionHandler(n))throw new Error("没有找到事务 `"+n+"` 的处理器, 是否已注册.");try{var a=this.actionHandlerMap[n](s);return(0,o.tI)(a)?a.catch((function(e){return r.Z.wait(0).run((function(){t.reportActionHandlerError(n,e)})),Promise.reject(e)})):Promise.resolve(a)}catch(i){return this.reportActionHandlerError(n,i),Promise.reject(i)}},t.addOnmessageListener=function(e){var t=this;return this.worker.addEventListener("message",e),function(){t.worker.removeEventListener("message",e)}},t.hasActionHandler=function(e){return!!this.actionHandlerMap[e]},t.reportActionHandlerError=function(e,t){var r,o="Worker action "+e+" error";console.error(o,t),null===(r=n.g.log)||void 0===r||r.error(o,t)},e}()},"../spread-sheet/src/entry/base.ts":function(e,t,n){n.d(t,{s:function(){return S}}),n("../node_modules/regenerator-runtime/runtime.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.promise.js"),n("../node_modules/core-js/modules/es.array.iterator.js"),n("../node_modules/core-js/modules/es.string.iterator.js"),n("../node_modules/core-js/modules/web.dom-collections.iterator.js"),n("../node_modules/core-js/modules/es.regexp.exec.js"),n("../node_modules/core-js/modules/es.number.constructor.js"),n("../node_modules/@tencent/dui/lib/utils/polyfill.js"),n("../spread-sheet/src/entry/requestidlecallback-polyfill.ts"),n("../spread-sheet/src/base/i18nInit.ts"),n("../core-sheet/js/report/weblog-config.js"),n("../core-sheet/js/report/raven-config.js");var r=window.log,o=(n("../node_modules/@tencent/wdocs-utils/dist/index.es.js"),n("../node_modules/@tencent/docs-opentelemetry/lib/index.esm.js")),s=n("../packages/report/src/index.ts"),a=n("./node_modules/axios/index.js"),i=n.n(a),c=n("../spread-sheet/src/base/event/event.ts"),u=n("../spread-sheet/src/base/event/eventName.ts"),d=n("../node_modules/@tencent/tencent_doc_net/dist/index.js"),l=n("../spread-sheet/src/base/util/appConfig.ts");(0,d.Interceptor)({urlWhiteList:[l.Z.getConfig("custom.standaloneDomains.report_idqqimg_com"),"tam/report"]});var p=[11e3,11005,11004,11007,11008,1e5,100001,100003,100004,100100,100101,100012,111111,99999,99992,1007,1e4,10001,30001,30002,30003,40001,40002,40003,40004,40005,40006,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115];i().interceptors.request.use((function(e){return e.metadata={startTime:new Date},e.url&&!(0,d.isInUrlWhiteList)(e.url)&&(e.url=(0,d.getMultUrl)(e.url)),e}),(function(e){return Promise.reject(e)})),i().interceptors.response.use((function(e){e.config.metadata.endTime=new Date;var t=e.config.metadata.endTime-e.config.metadata.startTime,n=null,r=e.data;if(void 0!==(null===r||void 0===r?void 0:r.retCode)?n=r.retCode:void 0!==(null===r||void 0===r?void 0:r.retcode)?n=r.retcode:r&&(n=r.ret),null!==n&&void 0!==n||(n=-998),0===(n=parseInt(n,10)))s.ZP.retcode({url:e.config.url||"",type:1,code:0,time:t});else{var o=2;-1!==p.indexOf(n)&&(o=3),s.ZP.retcode({url:e.config.url||"",type:o,code:n,time:t})}return e}),(function(e){if(!e.config)return Promise.reject(e);e.config.metadata.endTime=new Date;var t=e.config.metadata.endTime-e.config.metadata.startTime;return s.ZP.retcode({url:e.config.url||"",type:2,code:0,time:t}),Promise.reject(e)})),c.ZP.init.listen(u.W1.AFTER_ALL_RENDER,(function(){s.ZP.retcode({url:"https://"+l.Z.getConfig("runtime.domainName")+"/dop-api/opendoc",type:1,code:0,time:window._openDocEndTime-window._openDocStartTime})}));var h,_=n("../spread-sheet/src/base/config/report.ts"),f=(n("../spread-sheet/src/core/script-loader/script-loader.ts"),n("../spread-sheet/src/core/app/doc-performance.ts")),m=n("../packages/common-utils/src/index.ts"),v=n("../node_modules/@tencent/weblog-super-logger/dist/opentelemetry-logger.js"),E=(n("../spread-sheet/src/base/util/domain-config.ts"),function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function a(e){try{c(r.next(e))}catch(t){s(t)}}function i(e){try{c(r.throw(e))}catch(t){s(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,i)}c((r=r.apply(e,t||[])).next())}))});"test"===(0,m.IZ)("mode")&&n.e("spread-sheet_src_sdk_browser_tsheet_browser_sdk_ts").then(n.bind(n,"../spread-sheet/src/sdk/browser/tsheet.browser.sdk.ts")),(0,o.ed)({serviceName:"sheet",onTraceExport:function(e){var t=e.attributes;(null===t||void 0===t?void 0:t.component)&&v.ZP.xlog(e)}}),r.info("AppLoadSuccess"),null===(h=window.cachedPerformanceEntries)||void 0===h||h.push({name:"AppLoadSuccess",entryType:"mark",startTime:Date.now(),endTime:Date.now()}),r.info(window.__DWS_INFO__),window.__isOfflinePkg&&r.info("命中离线包"+window.__globalCodeVersion),window.ssrReport&&r.info("命中SSR"+window.__globalCodeVersion);var g=/\d+\.\d+\.(\d+)/.exec(window.__globalCodeVersion);if(null===g||void 0===g?void 0:g[1]){var R=new Date(1e3*Number(g[1])*60);r.info("代码构建时间："+R)}r.info("初始化 ua: "+navigator.userAgent);var S=function(){function e(){}var t=e.prototype;return t.run=function(){return E(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.beforeStart(),e.prev=1,e.next=4,this.start();case 4:e.next=9;break;case 6:e.prev=6,e.t0=e.catch(1),console.error(e.t0);case 9:case"end":return e.stop()}}),e,this,[[1,6]])})))},t.reportCorePointer=function(){s.ZP.run(_.CONFIG.RESET_DEFAULT_TDW_DATA),s.ZP.run(_.CONFIG.PAGE_LOAD,window.__globalCodeVersion),s.ZP.run(_.CONFIG.REPORT_FOR_SSR),s.ZP.run(_.CONFIG.REPORT_FOR_JSONP),s.ZP.kvrOss({itemname:"wwdoc_view_sheet"})},t.flowEnd=function(){var e,t;null===(e=window.log)||void 0===e||e.log("flow","set coresheet spreadsheet autorun flag done"),null===(t=window.__ws)||void 0===t||t.trigger("setLoadData",{type:"spreadsheet"})},t.beforeStart=function(){var e;null===(e=n.g.__ws)||void 0===e||e.trigger("entryStart"),n.g.tDocsPerformance=new f.Es,n.g.tDocsPerformance.mark("entryStart",{startTime:Date.now()}),window.performanceData=window.performanceData||{},window.performanceData.jsStartRun=Date.now(),window._grayVersion="2.10.27534546",window.__globalCommitHash="cc26aba101\n",this.replaceConsole();try{window.__console.log("%c【版本信息】"),window.__console.log("%c当前数据版本："+window._grayVersion,"color: green; font-size: 16px;"),window.__console.log("%c当前版本："+window.__globalReleaseVersion,"color: blue; font-size: 16px;"),window.__console.log("%c当前commit："+window.__globalCommitHash,"color: pink; font-size: 16px;"),window.__isOfflinePkg&&window.__console.log("%c当前代码使用了离线包","color: pink; font-size: 16px;")}catch(t){}this.reportCorePointer()},t.replaceConsole=function(){var e=(0,m.IZ)("showLog");window.__console={};var t=function(){};["log","error","warn","debug"].forEach((function(n){window.__console[n]=window.console[n],e||(window.console[n]=t)}))},e}()},"../spread-sheet/src/external/auth/base/AdvPermissions.ts":function(e,t,n){n("../node_modules/regenerator-runtime/runtime.js"),n("../node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),n("../node_modules/core-js/modules/esnext.reflect.metadata.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.promise.js"),n("../node_modules/core-js/modules/es.regexp.exec.js"),n("../node_modules/core-js/modules/es.string.split.js"),n("../node_modules/core-js/modules/es.number.constructor.js");var r,o=n("../spread-sheet/src/core/utils/config.ts"),s=n("../spread-sheet/src/core/app/SpreadsheetApp.interface.ts"),a=n("../spread-sheet/src/core/data/configService/spreadConfig.ts"),i=n("./node_modules/axios/index.js"),c=n.n(i),u=n("../node_modules/@tencent/docs-user-agent/dist/index.js"),d=n.n(u),l=n("../packages/common-utils/src/index.ts"),p=(n("../spread-sheet/src/base/util/domain-config.ts"),n("../spread-sheet/src/core/utils/offline-env.ts")),h=function(e,t,n,r){var o,s=arguments.length,a=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var i=e.length-1;i>=0;i--)(o=e[i])&&(a=(s<3?o(a):s>3?o(t,n,a):o(t,n))||a);return s>3&&a&&Object.defineProperty(t,n,a),a},_=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},f=function(e,t){return function(n,r){t(n,r,e)}},m=function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function a(e){try{c(r.next(e))}catch(t){s(t)}}function i(e){try{c(r.throw(e))}catch(t){s(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,i)}c((r=r.apply(e,t||[])).next())}))},v=function(){function e(e){var t=this;this.app=e,this.onUpdateAuthExpInfo=function(e){e&&(a.q.getConfig("isPreview")||(t.expireTimeId&&null!==t.expireTimeId&&clearTimeout(t.expireTimeId),t.setAuthExpHandleLogic(e)))},this.showExptimeTipsForOwner=function(){throw new Error("AdvPermissions 子类需重写 showExptimeTipsForOwner")},this.showWillExptimeTipsForCollaborator=function(){throw new Error("AdvPermissions 子类需重写 showWillExptimeTipsForCollaborator")},this.setAuthExpHandleLogic=function(e){t.setAuthInfo(e),e.settime&&0!==e.settime&&(0!==e.remaintime?t.setDocsExpInterval(e):t.showExpTips())},this.setDocsExpInterval=function(e){var n=e.remaintime||0;!a.q.getConfig("isCreator")&&n>5&&(n-=3),n*=1e3,t.expireTimeId=setTimeout((function(){return m(t,void 0,void 0,regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.expireTimeId=null,e.next=3,this.getAuthInfo();case 3:t=e.sent,this.setAuthInfo(t),0===t.remaintime?this.showExpTips():this.onUpdateAuthExpInfo(t);case 6:case"end":return e.stop()}}),e,this)})))}),n)},this.showExpTips=function(){a.q.getConfig("isCreator")?t.isSetAuthExpReaded()||t.showExptimeTipsForOwner():t.showWillExptimeTipsForCollaborator()},this.isSetAuthExpReaded=function(){var e=a.q.getConfig("padId");if(!e||!n.g.localStorage)return!1;var t="exptime-readed-set",r=n.g.localStorage.getItem(t),o=";";if(!r)return r=e,n.g.localStorage.setItem(t,""+r+o),!1;if(-1===r.indexOf(""+e+o)){if(r.split(o).length-1>20){var s=r.indexOf(o);r=r.substring(s+1,r.length)}return r=r+e+o,localStorage.setItem(t,r),!1}return!0},this.isInit=!1,this.gettedAdvPermissions=!1}var t=e.prototype;return t.init=function(){return m(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(this.isInit||(0,o.q)()||!this.app.sheetStatus.workbookStatus.isOnline&&(0,p.j)())){e.next=2;break}return e.abrupt("return");case 2:if(a.q.getConfig("isLogin")){e.next=5;break}return e.abrupt("return");case 5:if(!a.q.getConfig("isPreview")){e.next=8;break}return e.abrupt("return");case 8:e.next=10;break;case 10:return e.next=12,this.getAuthInfo();case 12:if(0===(t=e.sent).retcode){e.next=16;break}return this.showError(),e.abrupt("return");case 16:this.setAuthExpHandleLogic(t);case 17:case"end":return e.stop()}}),e,this)})))},t.isAuthExpExpire=function(){if(!0===this.gettedAdvPermissions){if(!this.authInfo.settime)return!1;if(0!==this.authInfo.settime&&0===this.authInfo.remaintime)return!0}return!1},t.showError=function(){throw new Error("AdvPermissions 子类需重写 showError")},t.refreshPage=function(){d().isMiniProgram?n.g.wx.miniProgram.redirectTo({url:"/pages/detail/detail?url="+encodeURIComponent((0,l.XK)(n.g.location.href,{rtime:Number(new Date)}))}):n.g.location.href=(0,l.XK)(n.g.location.href,{rtime:Number(new Date)})},t.setAuthInfo=function(e){this.gettedAdvPermissions=!0,this.authInfo=e},t.getAuthInfo=function(){return m(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c().get("/cgi-bin/online_docs/auth_exp/get",{params:{domainId:a.q.getConfig("domainId"),localPadId:a.q.getConfig("padId")}});case 2:return t=e.sent,e.abrupt("return",t.data);case 4:case"end":return e.stop()}}),e)})))},e}();v=h([f(0,s.m),_("design:paramtypes",["function"===typeof(r="undefined"!==typeof s.m&&s.m)?r:Object])],v),t.Z="page-editor"==n.j?v:null},"../spread-sheet/src/external/history/base/config.ts":function(e,t,n){n.d(t,{Z:function(){return r},i:function(){return o}});var r,o=["#B30000","#E6118F","#F1633A","#3646A0","#3184E9","#09A9B9","#822F1D","#C67600","#FFB400","#0D6C54","#918B3D","#7BB725"];!function(e){e.Ready="HistoryReady",e.Error="HistoryLoadError"}(r||(r={}))},"../spread-sheet/src/external/history/base/utils/authors-info.ts":function(e,t,n){n.d(t,{Z:function(){return o}}),n("../node_modules/core-js/modules/es.array.slice.js"),n("../node_modules/core-js/modules/es.array.splice.js");var r=n("../spread-sheet/src/external/history/base/config.ts"),o=function(){function e(){this.historyItemChangeColorList=r.i,this.subHistoryItemChangeColorList=r.i.slice(0)}e.getInstance=function(){return e.instance||new e};var t=e.prototype;return t.getColorFromId=function(e){if(e){if(!this.getColorsMap()[e]){this.subHistoryItemChangeColorList.length<=0&&(this.subHistoryItemChangeColorList=this.historyItemChangeColorList.slice(0));var t=Math.floor(Math.random()*this.subHistoryItemChangeColorList.length);this.setColor(e,this.subHistoryItemChangeColorList[t]),this.subHistoryItemChangeColorList.splice(t,1)}return this.getColorsMap()[e]}},t.setName=function(e,t,r){void 0===r&&(r=!1);var o=this.getNamesMap();if(r||!o[e]){o[e]=t;var s=JSON.stringify(o);n.g.sessionStorage.setItem("author_names",s)}},t.getNameFromId=function(e){if(e)return this.getNamesMap()[e]},t.getColorsMap=function(){var e=n.g.sessionStorage.getItem("author_colors")||"{}";return JSON.parse(e)},t.setColor=function(e,t){var r=this.getColorsMap();r[e]=t;var o=JSON.stringify(r);n.g.sessionStorage.setItem("author_colors",o)},t.getNamesMap=function(){var e=n.g.sessionStorage.getItem("author_names")||"{}";return JSON.parse(e)},e}()},"../spread-sheet/src/external/interaction/base/interaction-base.interface.ts":function(e,t,n){var r;n.d(t,{$:function(){return r}}),function(e){e.NORMAL="normal",e.ACTIVE="active",e.INPUT="input",e.SCAN="scan"}(r||(r={}))},"../spread-sheet/src/external/sheet-adapter/workbench/smart-workbench-adapter.base.ts":function(e,t,n){n("../node_modules/regenerator-runtime/runtime.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.promise.js");var r=n("../node_modules/@tencent/ioc/lib/esm/index.js"),o=n("../node_modules/@tencent/workbench/lib/esm/services/settings/setting-service.js"),s=n("../spread-sheet/src/base/util/container.ts"),a=n("../packages/model/src/sheet/index.ts"),i=function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function a(e){try{c(r.next(e))}catch(t){s(t)}}function i(e){try{c(r.throw(e))}catch(t){s(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,i)}c((r=r.apply(e,t||[])).next())}))},c=function(){function e(e){var t=this;this.firstTime=!0,this.enter=function(e){return i(t,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.openSmartSheet(e);case 2:case"end":return t.stop()}}),t,this)})))},this.exit=function(){},this.updateWorkbenchSetting=function(){return i(t,void 0,void 0,regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getWorkbenchSettings();case 2:t=e.sent,r.Am.get(o.I).addMountSettings(t);case 5:case"end":return e.stop()}}),e,this)})))},this.app=e,this.app.viewManager.getView(a.SHEET_TYPE.SMART_SHEET).onResize(this.resize)}var t=e.prototype;return t.changeInitialConfigSettings=function(e){var t,n=r.Am.get(o.I);void 0!==(null===(t=null===e||void 0===e?void 0:e.contextMenu)||void 0===t?void 0:t.hasOverlay)&&n.set("contextMenu.hasOverlay",e.contextMenu.hasOverlay)},t.resize=function(){var e=document.getElementById("workbenchContainer");e&&(e.style.height="calc(100% - "+(0,s.x)()+"px)")},e}();t.Z=c},"../spread-sheet/src/external/tencentMeeting/operation/cursor-operation/cursor-operation-base.ts":function(e,t,n){n.d(t,{Z:function(){return s}});var r=n("../packages/model/src/grid/index.ts"),o=n("../spread-sheet/src/external/tencentMeeting/operation/operation.interface.ts"),s=function(){function e(e){this.operationType=o.C8.UPDATE_CURSOR,this.app=e}var t=e.prototype;return t.initHostOperationListener=function(e){var t=this,n=this.app.view,r=n.canvas.inputManager;n.onSelectionChange((function(){return e(t.operationType)})),r.emitter.on(r.EVENT.ENTER_INPUT,(function(){return e(t.operationType)})),r.emitter.on(r.EVENT.EXIT_INPUT,(function(){return e(t.operationType)}))},t.getHostOperationInfo=function(){return{selectionInfo:this.getSelectionInfo()}},t.getSelectionInfo=function(){var e=this.app.view.getSelection(),t=e.rangeSelections,n=e.selectQueue,o=void 0===n?[]:n,s=e.type===r.SelectionType.SHAPE?void 0:t[0],a={isSelectAll:!1,isSelectCol:!1,isSelectRow:!1};if(o[0]){var i=o[0];a={isSelectAll:i.selectAll,isSelectCol:i.selectCol,isSelectRow:i.selectRow}}return{selection:s,baseSelection:a}},e}()},"../spread-sheet/src/flow/browser/adaptor/pc/sheet-life-adaptor.ts":function(e,t,n){n.d(t,{u:function(){return O}}),n("../node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),n("../node_modules/core-js/modules/esnext.reflect.metadata.js");var r,o,s,a,i,c,u,d,l,p,h,_,f,m,v,E,g,R=n("../node_modules/@tencent/tdoc-scheduler/lib/tdoc-scheduler.cjs.js"),S=n("../spread-sheet/src/flow/browser/tasks/names.ts"),A=n("../spread-sheet/src/flow/lib/scheduler/base/safe-job.ts"),w=n("../spread-sheet/src/core/app/sheetStatus/index.ts"),T=function(e,t,n,r){var o,s=arguments.length,a=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var i=e.length-1;i>=0;i--)(o=e[i])&&(a=(s<3?o(a):s>3?o(t,n,a):o(t,n))||a);return s>3&&a&&Object.defineProperty(t,n,a),a},y=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},I=function(e,t){return function(n,r){t(n,r,e)}},O=function(){function e(e,t,n,r,o,s,a,i,c,u,d,l,p,h,_,f,m){this.sheetStatus=e,this.renderFirstScreenTask=t,this.hideEditorSSRTask=n,this.reportPVTask=r,this.initEditorServiceTask=o,this.hideHeaderBarSSRTask=s,this.toggleToolbarModeTask=a,this.initFeatureTask=i,this.initPcReadonlyPluginServiceTask=c,this.initPcEditPluginServiceTask=u,this.emitInitPluginsEndTask=d,this.renderPcFooterBarTask=l,this.renderPcHeaderBarTask=p,this.initTencentMeettingTask=h,this.startInitWorkbenchFrameworkTask=_,this.workbenchFeatureLoadTask=f,this.workbenchFrameworkReadyTask=m}var t=e.prototype;return t.renderEditorFirstScreen=function(){var e=A.A.getSafeJob();return e.serialNext([this.renderFirstScreenTask,this.hideEditorSSRTask,this.reportPVTask]),e},t.initEditorServices=function(){var e=A.A.getSafeJob();return e.serialNext([this.initEditorServiceTask]),e},t.renderPanel=function(){var e=A.A.getSafeJob();return e.serialNext([this.initTencentMeettingTask,this.startInitWorkbenchFrameworkTask,this.initFeatureTask,this.workbenchFeatureLoadTask,this.workbenchFrameworkReadyTask,this.renderPcHeaderBarTask,this.hideHeaderBarSSRTask,this.toggleToolbarModeTask,this.renderPcFooterBarTask]),e},t.initPluginServices=function(){var e=A.A.getSafeJob(),t=[this.initPcReadonlyPluginServiceTask];return this.sheetStatus.workbookStatus.canEdit&&t.push(this.initPcEditPluginServiceTask),t.push(this.emitInitPluginsEndTask),e.serialNext(t),e},e}();O=T([I(0,w.T),I(1,S.Hq),I(2,S.vn),I(3,S.g_),I(4,S.uP),I(5,S.c9),I(6,S.N6),I(7,S.vo),I(8,S.OX),I(9,S.dJ),I(10,S.T3),I(11,S.bN),I(12,S.GS),I(13,S.l1),I(14,S.ZJ),I(15,S.CE),I(16,S.hf),y("design:paramtypes",["function"===typeof(r="undefined"!==typeof w.T&&w.T)?r:Object,"function"===typeof(o="undefined"!==typeof R.ITask&&R.ITask)?o:Object,"function"===typeof(s="undefined"!==typeof R.ITask&&R.ITask)?s:Object,"function"===typeof(a="undefined"!==typeof R.ITask&&R.ITask)?a:Object,"function"===typeof(i="undefined"!==typeof R.ITask&&R.ITask)?i:Object,"function"===typeof(c="undefined"!==typeof R.ITask&&R.ITask)?c:Object,"function"===typeof(u="undefined"!==typeof R.ITask&&R.ITask)?u:Object,"function"===typeof(d="undefined"!==typeof R.ITask&&R.ITask)?d:Object,"function"===typeof(l="undefined"!==typeof R.ITask&&R.ITask)?l:Object,"function"===typeof(p="undefined"!==typeof R.ITask&&R.ITask)?p:Object,"function"===typeof(h="undefined"!==typeof R.ITask&&R.ITask)?h:Object,"function"===typeof(_="undefined"!==typeof R.ITask&&R.ITask)?_:Object,"function"===typeof(f="undefined"!==typeof R.ITask&&R.ITask)?f:Object,"function"===typeof(m="undefined"!==typeof R.ITask&&R.ITask)?m:Object,"function"===typeof(v="undefined"!==typeof R.ITask&&R.ITask)?v:Object,"function"===typeof(E="undefined"!==typeof R.ITask&&R.ITask)?E:Object,"function"===typeof(g="undefined"!==typeof R.ITask&&R.ITask)?g:Object])],O)},"../spread-sheet/src/flow/browser/index.ts":function(e,t,n){n.d(t,{Z:function(){return ee}}),n("../node_modules/regenerator-runtime/runtime.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.promise.js");var r=n("../spread-sheet/src/core/app/SpreadsheetApp.interface.ts"),o=n("../packages/lib/EventEmitter.ts"),s=n("../spread-sheet/src/flow/common/initialization.ts"),a=n("../node_modules/@babel/runtime/helpers/esm/inheritsLoose.js"),i=(n("../node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),n("../node_modules/core-js/modules/esnext.reflect.metadata.js"),n("../node_modules/@tencent/tdoc-scheduler/lib/tdoc-scheduler.cjs.js")),c=n("../node_modules/@babel/runtime/helpers/esm/toConsumableArray.js");function u(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){if(e){if("string"===typeof e)return d(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?d(e,t):void 0}}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0;return function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function d(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}n("../node_modules/core-js/modules/web.dom-collections.for-each.js"),n("../node_modules/core-js/modules/es.array.concat.js"),n("../node_modules/core-js/modules/es.array.iterator.js"),n("../node_modules/core-js/modules/es.map.js"),n("../node_modules/core-js/modules/es.string.iterator.js"),n("../node_modules/core-js/modules/esnext.map.delete-all.js"),n("../node_modules/core-js/modules/esnext.map.every.js"),n("../node_modules/core-js/modules/esnext.map.filter.js"),n("../node_modules/core-js/modules/esnext.map.find.js"),n("../node_modules/core-js/modules/esnext.map.find-key.js"),n("../node_modules/core-js/modules/esnext.map.includes.js"),n("../node_modules/core-js/modules/esnext.map.key-of.js"),n("../node_modules/core-js/modules/esnext.map.map-keys.js"),n("../node_modules/core-js/modules/esnext.map.map-values.js"),n("../node_modules/core-js/modules/esnext.map.merge.js"),n("../node_modules/core-js/modules/esnext.map.reduce.js"),n("../node_modules/core-js/modules/esnext.map.some.js"),n("../node_modules/core-js/modules/esnext.map.update.js"),n("../node_modules/core-js/modules/web.dom-collections.iterator.js"),n("../node_modules/core-js/modules/es.array.includes.js"),n("../node_modules/core-js/modules/es.string.includes.js"),n("../node_modules/core-js/modules/es.array.slice.js"),n("../node_modules/core-js/modules/es.array.splice.js"),n("../node_modules/core-js/modules/es.function.name.js"),n("../node_modules/core-js/modules/es.array.from.js"),n("../node_modules/core-js/modules/es.symbol.js"),n("../node_modules/core-js/modules/es.symbol.description.js"),n("../node_modules/core-js/modules/es.symbol.iterator.js");var l=new(function(){function e(){this.data=new Map}var t=e.prototype;return t.add=function(e,t){this.data.set(e,t)},t.knows=function(e){return this.data.has(e)},t.as=function(e){return this.data.get(e)||null},t.dispose=function(){this.data.clear()},e}()),p=function(){function e(e){this.allowedPhaseSeq=[],this.phaseSeq=[],this.callback=[],this.allowedPhaseSeq=e}var t=e.prototype;return t.hasPhase=function(e){return this.phaseSeq.includes(e)},t.addIntercept=function(e,t){this.phaseSeq.push(e),this.callback.push({phase:e,methodName:t})},t.getIntercepts=function(){return this.callback.slice()},t.vailidateDecoratoedPhaseSeq=function(){var e=this.getDecoratedSeq();if(0!==e[0])return!1;if(e.length!==this.allowedPhaseSeq.length)return!1;for(var t=0;t+1<e.length;t++)if(e[t]>=e[t+1])return!1;return!0},t.getDecoratedLifeIntercept=function(){for(var e=[],t=this.getDecoratedSeq(),n=0;n+1<t.length;n++){var r=t[n],o=t[n+1];if(o>r+1){for(var s=this.phaseSeq[r],a=[],i=r+1;i<o;i++)a.push(this.phaseSeq[i]);e.push({interceptPoint:s,phases:a})}}return e},t.dispose=function(){this.callback.splice(0),this.phaseSeq.splice(0),this.allowedPhaseSeq.splice(0)},t.getDecoratedSeq=function(){for(var e,t=[],n=u(this.allowedPhaseSeq);!(e=n()).done;){var r=e.value,o=this.phaseSeq.indexOf(r);t.push(o)}return t},e}();n("../node_modules/core-js/modules/es.array.find.js"),n("../node_modules/core-js/modules/es.regexp.exec.js"),n("../node_modules/core-js/modules/es.string.search.js"),n("../node_modules/core-js/modules/es.array.map.js");var h=n("../node_modules/@tencent/logger/lib/index.js"),_=(n("../node_modules/core-js/modules/es.regexp.to-string.js"),function(){function e(e){this.phaseName=e}return e.prototype.toString=function(){return this.phaseName},e}());_.ILLEGAL=new _("ILLEGAL_PHASE");var f=n("../spread-sheet/src/flow/lib/scheduler/base/barrier.ts"),m=function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function a(e){try{c(r.next(e))}catch(t){s(t)}}function i(e){try{c(r.throw(e))}catch(t){s(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,i)}c((r=r.apply(e,t||[])).next())}))},v=function(){function e(e,t){this.lifeHook=e,this.blockingMode=t,t&&(this.asyncLock=new f.U)}var t=e.prototype;return t.wait=function(){var e;return m(this,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,null===(e=this.asyncLock)||void 0===e?void 0:e.wait();case 2:case"end":return t.stop()}}),t,this)})))},t.execute=function(e){var t;return m(this,void 0,void 0,regeneratorRuntime.mark((function n(){var r=this;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.lifeHook((function(){return m(r,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.blockingMode){t.next=2;break}throw new Error("ILLEGAL STATE: should not switch to next life in blocking mode");case 2:return t.next=4,e();case 4:case"end":return t.stop()}}),t,this)})))}));case 2:null===(t=this.asyncLock)||void 0===t||t.open();case 3:case"end":return n.stop()}}),n,this)})))},e}(),E=n("../node_modules/@babel/runtime/helpers/esm/createClass.js"),g=function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function a(e){try{c(r.next(e))}catch(t){s(t)}}function i(e){try{c(r.throw(e))}catch(t){s(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,i)}c((r=r.apply(e,t||[])).next())}))},R=function(){function e(e,t){this.innerPhase=e,this.lifephaseChain=t,this.isKilled=!1,this.phaseWhen=new Map}var t=e.prototype;return t.when=function(e){return g(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(this.lifephaseChain.compare(e,this.innerPhase)<=0)){t.next=2;break}return t.abrupt("return");case 2:return(n=this.phaseWhen.get(e))||(n=new f.U,this.phaseWhen.set(e,n)),t.next=6,n.wait();case 6:case"end":return t.stop()}}),t,this)})))},t.kill=function(){this.isKilled=!0},t.dispose=function(){this.kill(),this.phaseWhen.clear()},(0,E.Z)(e,[{key:"phase",get:function(){return this.innerPhase},set:function(e){if(this.lifephaseChain.compare(e,this.innerPhase)<0)throw new Error("Lifecycle cannot go backwards from "+this.innerPhase+" to "+e);if(this.innerPhase!==e&&!this.isKilled){this.innerPhase=e;var t=this.phaseWhen.get(this.innerPhase);t&&(t.open(),this.phaseWhen.delete(e))}}}]),e}();function S(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){if(e){if("string"===typeof e)return A(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?A(e,t):void 0}}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0;return function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function A(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var w=function(){function e(e){var t=this;this.lifePhases=e,this.lifePhaseLinked=new Array,this.lifePhases.forEach((function(e){t.lifePhaseLinked.push(e)}))}var t=e.prototype;return t.compare=function(e,t){var n=this.lifePhaseLinked.indexOf(e),r=this.lifePhaseLinked.indexOf(t);return n===r?0:n>r?1:-1},t.isBootstrap=function(e){return this.lifePhases[0]===e},t.find=function(e){return this.lifePhaseLinked.indexOf(e)},t.push=function(e){this.lifePhaseLinked.push(e)},t.insert=function(e,t){var n=this.lifePhaseLinked.indexOf(t);-1!==n&&this.lifePhaseLinked.splice(n+1,0,e)},t.each=function(e){this.lifePhaseLinked.forEach(e)},t.search=function(e,t){for(var n,r=_.ILLEGAL,o=S(this.lifePhaseLinked.slice(e));!(n=o()).done;){var s=n.value;if(t(s)){r=s;break}}return r},t.dispose=function(){this.lifePhaseLinked.splice(0,this.lifePhaseLinked.length)},e}(),T=function(){function e(){this.perfLog=new Map}var t=e.prototype;return t.mark=function(e){if(!this.perfLog.get(e)){var t=Date.now();return this.perfLog.set(e,t),!0}return!1},t.getDuration=function(e,t){var n=this.perfLog.get(e),r=this.perfLog.get(t);return n&&r?r-n:-1},e}(),y=function(){function e(){this.current=Promise.resolve(null)}var t=e.prototype;return t.queue=function(e){this.current=this.current.then((function(){return e}))},t.wait=function(){return this.current},e}();function I(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){if(e){if("string"===typeof e)return O(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?O(e,t):void 0}}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0;return function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function O(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var D,b,C,x,N,P,L,j,k,F,M=function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function a(e){try{c(r.next(e))}catch(t){s(t)}}function i(e){try{c(r.throw(e))}catch(t){s(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,i)}c((r=r.apply(e,t||[])).next())}))},H=function(){function e(e){if(this.logger=new h.Yd("LifecycleScheduler").use("console"),this.toBeInvoked=new Map,this.isLifecycleStarted=!1,this.lifePhaseChian=new w(e),0===e.length)throw new Error("lifePhaseSeq should not be empty");this.lifecycleService=new R(e[0],this.lifePhaseChian),this.lifePerformance=new T}var t=e.prototype;return t.getPerformace=function(){return this.lifePerformance},t.registerLifeEntry=function(e,t,n){if(-1!==this.lifePhaseChian.find(e))if(this.lifePhaseChian.compare(this.lifecycleService.phase,e)>=0&&!this.lifePhaseChian.isBootstrap(this.lifecycleService.phase))this.safeInvoke(new v(t,!!n),e);else{var r=this.toBeInvoked.get(e);r||(r=[],this.toBeInvoked.set(e,r)),r.push(new v(t,!!n))}},t.registerLifeEntities=function(e){var t=this;e.forEach((function(e){t.registerLifeEntry(e.phase,e.entryFn)}))},t.interceptLifePhase=function(e){var t=this;if(this.isLifecycleStarted)throw new Error("illegal lifecycle state: lifecycle scheduler has already started");if(-1===this.lifePhaseChian.find(e))throw new Error("Illegal life phase: "+e);for(var n=arguments.length,r=new Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];r.reduce((function(e,n){return t.lifePhaseChian.insert(n,e),n}),e)},t.start=function(){return M(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t,n=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.logger.info("lifecycle scheduler starup"),this.isLifecycleStarted=!0,t=new y,this.lifePhaseChian.each((function(e){return t.queue(n.invokeByPhase(e))})),e.next=6,t.wait();case 6:case"end":return e.stop()}}),e,this)})))},t.dispose=function(){this.toBeInvoked.clear(),this.isLifecycleStarted=!1,this.lifePhaseChian.dispose(),this.lifecycleService.dispose()},t.getNextValidPhase=function(){var e=this,t=this.lifecycleService.phase,n=this.lifePhaseChian.find(t);return this.lifePhaseChian.search(n+1,(function(t){return!(t===_.ILLEGAL||!e.toBeInvoked.get(t))}))},t.invokeByPhase=function(e){return M(this,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(this.lifePhaseChian.compare(this.lifecycleService.phase,e)>=0)){t.next=6;break}return this.lifePerformance.mark(e),t.next=4,this.doInvokeByPhase(e);case 4:t.next=10;break;case 6:return t.next=8,this.lifecycleService.when(e);case 8:return t.next=10,this.doInvokeByPhase(e);case 10:case"end":return t.stop()}}),t,this)})))},t.waitPhaseReady=function(e){return M(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n,r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=this.toBeInvoked.get(e),r=null===n||void 0===n?void 0:n.map((function(e){return e.wait()})),t.next=4,Promise.all(r||[]);case 4:case"end":return t.stop()}}),t,this)})))},t.doInvokeByPhase=function(e){return M(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n,r,o,s;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(n=this.toBeInvoked.get(e))){t.next=9;break}r=I(n);case 3:if((o=r()).done){t.next=9;break}return s=o.value,t.next=7,this.safeInvoke(s,e);case 7:t.next=3;break;case 9:case"end":return t.stop()}}),t,this)})))},t.safeInvoke=function(e,t){return M(this,void 0,void 0,regeneratorRuntime.mark((function n(){var r,o=this;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r=function(){return M(o,void 0,void 0,regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.lifecycleService.phase===t){e.next=3;break}return console.warn("生命周期已经发生变化 "+t+" : "+this.lifecycleService.phase),e.abrupt("return");case 3:if((n=this.getNextValidPhase())===_.ILLEGAL){e.next=9;break}return e.next=7,this.waitPhaseReady(t);case 7:this.lifePerformance.mark(n),this.lifecycleService.phase=n;case 9:case"end":return e.stop()}}),e,this)})))},n.next=3,e.execute(r);case 3:case"end":return n.stop()}}),n)})))},e}(),U=function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function a(e){try{c(r.next(e))}catch(t){s(t)}}function i(e){try{c(r.throw(e))}catch(t){s(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,i)}c((r=r.apply(e,t||[])).next())}))},V=function(){function e(e,t){this.lifeName=e,this.lifecycleScheduler=new H(t),this.initLifecycle()}var t=e.prototype;return t.getPerformace=function(){return this.lifecycleScheduler.getPerformace()},t.startup=function(){return U(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.lifecycleScheduler.start();case 2:case"end":return e.stop()}}),e,this)})))},t.initLifecycle=function(){var e=this,t=l.as(this.lifeName);if(!t.vailidateDecoratoedPhaseSeq())throw new Error("ILLEGAL STATE: @LifeAction was been mistaken used");t.getDecoratedLifeIntercept().forEach((function(t){var n;(n=e.lifecycleScheduler).interceptLifePhase.apply(n,[t.interceptPoint].concat((0,c.Z)(t.phases)))})),this.registerAppLifeCycle()},t.registerAppLifeCycle=function(){var e=this;l.as(this.lifeName).getIntercepts().forEach((function(t){e.lifecycleScheduler.registerLifeEntry(t.phase,(function(n){return U(e,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this[t.methodName].call(this);case 2:return e.next=4,n();case 4:case"end":return e.stop()}}),e,this)})))}))}))},e}(),Z=n("../spread-sheet/src/flow/lib/tasks/names.ts"),G="sheet",B={PAGE_LOAD_START:new _("PAGE_LOAD_START"),PAGE_EDITOR_FIRST_SCREEN:new _("PAGE_EDITOR_FIRST_SCREEN"),PAGE_EDITOR_READY:new _("PAGE_EDITOR_READY"),PAGE_PANEL_READY:new _("PAGE_PANEL_READY"),PAGE_PLUGIN_READY:new _("PAGE_PLUGIN_READY"),PAGE_LOAD_FINISHED:new _("PAGE_LOAD_FINISHED")},W=[B.PAGE_LOAD_START,B.PAGE_EDITOR_FIRST_SCREEN,B.PAGE_EDITOR_READY,B.PAGE_PANEL_READY,B.PAGE_PLUGIN_READY,B.PAGE_LOAD_FINISHED],K=function(e,t,n,r){var o,s=arguments.length,a=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var i=e.length-1;i>=0;i--)(o=e[i])&&(a=(s<3?o(a):s>3?o(t,n,a):o(t,n))||a);return s>3&&a&&Object.defineProperty(t,n,a),a},Y=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},z=function(e,t){return function(n,r){t(n,r,e)}},X=function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function a(e){try{c(r.next(e))}catch(t){s(t)}}function i(e){try{c(r.throw(e))}catch(t){s(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,i)}c((r=r.apply(e,t||[])).next())}))},q=(k=G,F=W,l.knows(k)||l.add(k,new p(F)),function(e){if(!F.includes(e))throw new Error("@LifeAction decorator only support: "+F);return function(t,n){if(!n)throw new Error("@LifeAction can only be used as method's decorator");var r=l.as(k);if(r.hasPhase(e))throw new Error("decorator @LifeAction with parameter "+e+" has already been used");r.addIntercept(e,n)}}),J=function(e){function t(t,n){var r;return(r=e.call(this,G,W)||this).hideFirstLoadingTask=t,r.hideAllLoadingTask=n,r}(0,a.Z)(t,e);var r=t.prototype;return r.start=function(t){var n=Object.create(null,{startup:{get:function(){return e.prototype.startup}}});return X(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.lifeAdatpor=t,e.next=3,n.startup.call(this);case 3:case"end":return e.stop()}}),e,this)})))},r.pageLoadStart=function(){return X(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.lifeAdatpor.renderEditorFirstScreen(),(n=new i.Wf).add(t),e.next=5,n.done();case 5:case"end":return e.stop()}}),e,this)})))},r.pageEditorFirstScreen=function(){return X(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t,n,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.lifeAdatpor.initEditorServices(),(n=new i.JC).serialNext([this.hideFirstLoadingTask]),(r=new i.Wf).add(n),r.add(t),e.next=8,r.done();case 8:case"end":return e.stop()}}),e,this)})))},r.pageEditorReady=function(){return X(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.lifeAdatpor.renderPanel(),(n=new i.Wf).add(t),e.next=5,n.done();case 5:case"end":return e.stop()}}),e,this)})))},r.pagePanelReady=function(){return X(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t,n,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.lifeAdatpor.initPluginServices(),n=new i.Wf,(r=new i.JC).serialNext([this.hideAllLoadingTask]),n.add(r),n.add(t),e.next=8,n.done();case 8:case"end":return e.stop()}}),e,this)})))},r.pagePluginReady=function(){return X(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return");case 1:case"end":return e.stop()}}),e)})))},r.pageLoadFinished=function(){var e;return X(this,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return null===(e=n.g.log)||void 0===e||e.info("pageLoadFinished",this.getPerformace()),t.abrupt("return");case 3:case"end":return t.stop()}}),t,this)})))},t}(V);K([q(B.PAGE_LOAD_START),Y("design:type",Function),Y("design:paramtypes",[]),Y("design:returntype","function"===typeof(D="undefined"!==typeof Promise&&Promise)?D:Object)],J.prototype,"pageLoadStart",null),K([q(B.PAGE_EDITOR_FIRST_SCREEN),Y("design:type",Function),Y("design:paramtypes",[]),Y("design:returntype","function"===typeof(b="undefined"!==typeof Promise&&Promise)?b:Object)],J.prototype,"pageEditorFirstScreen",null),K([q(B.PAGE_EDITOR_READY),Y("design:type",Function),Y("design:paramtypes",[]),Y("design:returntype","function"===typeof(C="undefined"!==typeof Promise&&Promise)?C:Object)],J.prototype,"pageEditorReady",null),K([q(B.PAGE_PANEL_READY),Y("design:type",Function),Y("design:paramtypes",[]),Y("design:returntype","function"===typeof(x="undefined"!==typeof Promise&&Promise)?x:Object)],J.prototype,"pagePanelReady",null),K([q(B.PAGE_PLUGIN_READY),Y("design:type",Function),Y("design:paramtypes",[]),Y("design:returntype","function"===typeof(N="undefined"!==typeof Promise&&Promise)?N:Object)],J.prototype,"pagePluginReady",null),K([q(B.PAGE_LOAD_FINISHED),Y("design:type",Function),Y("design:paramtypes",[]),Y("design:returntype","function"===typeof(P="undefined"!==typeof Promise&&Promise)?P:Object)],J.prototype,"pageLoadFinished",null),J=K([z(0,Z.UU),z(1,Z.QY),Y("design:paramtypes",["function"===typeof(L="undefined"!==typeof i.ITask&&i.ITask)?L:Object,"function"===typeof(j="undefined"!==typeof i.ITask&&i.ITask)?j:Object])],J);var Q,$=function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function a(e){try{c(r.next(e))}catch(t){s(t)}}function i(e){try{c(r.throw(e))}catch(t){s(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,i)}c((r=r.apply(e,t||[])).next())}))},ee="page-editor"==n.j?function(){function e(){n.g.performanceData.fetchStart=Date.now(),this.initAppService(),this.initSpreadsheetApp(),this.initCoreService()}var t=e.prototype;return t.startSheetLife=function(e){var t;return $(this,void 0,void 0,regeneratorRuntime.mark((function r(){var o;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return null===(t=n.g.log)||void 0===t||t.info("flow: startSheetLife()"),o=s.V7.createInstance(J),r.next=4,o.start(e);case 4:case"end":return r.stop()}}),r)})))},t.initAppService=function(){var e;null===(e=n.g.log)||void 0===e||e.debug("flow","initAppService()"),(0,s.R1)()},t.initCoreService=function(){var e;null===(e=n.g.log)||void 0===e||e.debug("flow","initCoreService()"),(0,s.Q2)()},t.initSpreadsheetApp=function(){var e,t=this;null===(e=n.g.log)||void 0===e||e.debug("flow","initSpreadsheetApp()"),s.QI.invokeFunction((function(e){var s=e.get(r.m);t.app=s,n.g.SpreadsheetApp=s;var a=t.app.emitter||new o.Z;t.app.initEmitter(a),t.initListenLifeCycle()}))},t.initListenLifeCycle=function(){var e,t=this;null===(e=n.g.log)||void 0===e||e.info("flow","initListenLifeCycle()"),this.app.emitter.on(this.app.EVENT.PAGE_LOAD_START,(function(){t.app.setLifeCycle(t.app.EVENT.PAGE_LOAD_START)})),this.app.emitter.on(this.app.EVENT.SPREAD_SHEET_SDK_CORE_END,(function(){t.app.setLifeCycle(t.app.EVENT.SPREAD_SHEET_SDK_CORE_END)})),this.app.emitter.on(this.app.EVENT.SPREAD_SHEET_PART_INTERACTIVE_END,(function(){t.app.setLifeCycle(t.app.EVENT.SPREAD_SHEET_PART_INTERACTIVE_END)})),this.app.emitter.on(this.app.EVENT.SPREAD_SHEET_MESSAGE_END,(function(){t.app.setLifeCycle(t.app.EVENT.SPREAD_SHEET_MESSAGE_END)})),this.app.emitter.on(this.app.EVENT.SPREAD_SHEET_PLUGINS_END,(function(){t.app.setLifeCycle(t.app.EVENT.SPREAD_SHEET_PLUGINS_END)})),this.app.emitter.on(this.app.EVENT.PAGE_LOAD_FINISHED,(function(){t.app.setLifeCycle(t.app.EVENT.PAGE_LOAD_FINISHED)}))},e}():null;!function(e){e.WHITE_SCREEN_ERROR="WHITE_SCREEN_ERROR",e.NO_WHITE_SCREEN_ERROR="NO_WHITE_SCREEN_ERROR"}(Q||(Q={}))},"../spread-sheet/src/flow/browser/phase/services/commandService.ts":function(e,t,n){n.d(t,{H:function(){return f}});var r,o,s,a=n("../node_modules/@babel/runtime/helpers/esm/toConsumableArray.js"),i=n("../node_modules/@babel/runtime/helpers/esm/assertThisInitialized.js"),c=n("../node_modules/@babel/runtime/helpers/esm/inheritsLoose.js"),u=(n("../node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),n("../node_modules/core-js/modules/esnext.reflect.metadata.js"),n("../node_modules/core-js/modules/es.array.iterator.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.promise.js"),n("../node_modules/core-js/modules/es.string.iterator.js"),n("../node_modules/core-js/modules/web.dom-collections.iterator.js"),n("../node_modules/core-js/modules/es.array.filter.js"),n("../node_modules/core-js/modules/es.array.concat.js"),n("../node_modules/core-js/modules/es.weak-map.js"),n("../node_modules/core-js/modules/esnext.weak-map.delete-all.js"),n("../node_modules/@tencent/containerized/build/main/index.js")),d=n("../node_modules/@tencent/doc-command/dist/index.js"),l=function(e,t,n,r){var o,s=arguments.length,a=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var i=e.length-1;i>=0;i--)(o=e[i])&&(a=(s<3?o(a):s>3?o(t,n,a):o(t,n))||a);return s>3&&a&&Object.defineProperty(t,n,a),a},p=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},h=function(e,t){return function(n,r){t(n,r,e)}},_=function(e,t,n,r){if("a"===n&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"===typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(e):r?r.value:t.get(e)},f=(0,u.yh)("ICommandService"),m=function(e){function t(t){var n;return(n=e.call(this)||this)._instantiationService=t,r.set((0,i.Z)(n),n._register(new d.Emitter)),n.onWillExecuteCommand=_((0,i.Z)(n),r,"f").event,o.set((0,i.Z)(n),new d.Emitter),n.onDidExecuteCommand=_((0,i.Z)(n),o,"f").event,n}(0,c.Z)(t,e);var n=t.prototype;return n.executeCommand=function(e){for(var t=this,n=arguments.length,r=new Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];var s,a=!!d.CommandsRegistry.getCommand(e);return a?this.tryExecuteCommand(e,r):(a||(s=Promise.all([Promise.race([d.Event.toPromise(d.Event.filter(d.CommandsRegistry.onDidRegisterCommand,(function(t){return t===e})))])])),s.then((function(){return t.tryExecuteCommand(e,r)})))},n.registerCommand=function(e,t){return"string"===typeof e?d.CommandsRegistry.registerCommand(e,t):d.CommandsRegistry.registerCommand(e)},n.tryExecuteCommand=function(e,t){var n=d.CommandsRegistry.getCommand(e);if(!n)return Promise.reject(new Error("command '"+e+"' not found"));try{var s;_(this,r,"f").fire({commandId:e,args:t});var i=(s=this._instantiationService).invokeFunction.apply(s,[n.handler].concat((0,a.Z)(t)));return _(this,o,"f").fire({commandId:e,args:t}),Promise.resolve(i)}catch(c){return Promise.reject(c)}},t}(u.JT);r=new WeakMap,o=new WeakMap,m=l([h(0,u.TG),p("design:paramtypes",["function"===typeof(s="undefined"!==typeof u.TG&&u.TG)?s:Object])],m),t.Z=m},"../spread-sheet/src/flow/browser/phase/services/partInteractable.interface.ts":function(e,t,n){n.d(t,{P:function(){return r}});var r=(0,n("../node_modules/@tencent/containerized/build/main/index.js").yh)("IPartInteractableService")},"../spread-sheet/src/flow/browser/phase/services/partInteractable.ts":function(e,t,n){n.d(t,{Z:function(){return k},I:function(){return F}}),n("../node_modules/regenerator-runtime/runtime.js"),n("../node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),n("../node_modules/core-js/modules/esnext.reflect.metadata.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.promise.js"),n("../node_modules/core-js/modules/es.object.assign.js");var r,o,s,a=n("../node_modules/@tencent/docs-user-agent/dist/index.js"),i=n.n(a),c=n("../spread-sheet/src/core/app/SpreadsheetApp.interface.ts"),u=n("../spread-sheet/src/core/view/layout/interface/pc-view.ts"),d=n("../spread-sheet/src/core/data/configService/spreadConfig.ts"),l=n("../core-sheet/js/report/whitescreen.js"),p=n("../node_modules/@tencent/containerized/build/main/index.js"),h=n("../spread-sheet/src/core/view/spreadsheet-view/SpreadsheetView.interface.ts"),_=n("../spread-sheet/src/core/view/spreadsheet-view/SpreadsheetView.browser.ts"),f=n("../packages/model/src/spreadsheet/index.ts"),m=n("../spread-sheet/src/core/view/data-call-view/DataCallView.interface.ts"),v=n("../spread-sheet/src/core/view/layout/common/ocr-util.ts"),E=n("../spread-sheet/src/core/view/config/default.ts"),g=(n("../spread-sheet/src/base/util/domain-config.ts"),n("../spread-sheet/src/base/event/eventName.ts")),R=n("../spread-sheet/src/base/ssr/ssr-dom-attr.ts"),S=n("../spread-sheet/src/base/ssr/ssr-dom-remove-util.ts"),A=(n("../node_modules/core-js/modules/es.array.slice.js"),n("../node_modules/core-js/modules/web.dom-collections.for-each.js"),n("../packages/common-utils/src/index.ts")),w=n("../packages/model/src/sheet/PrivilegeType.ts"),T=n("../spread-sheet/src/external/view/main/footer/footer-ssr/generate-footer-str-browser.ts"),y=function(e){var t={sheetId:(0,A.IZ)("tab"),sheetList:window.clientVars.collab_client_vars.header[0].d},n="";try{n=(0,T.v)(t.sheetId,t.sheetList||[])}catch(o){console.error("generateFooterStrBrowser------------"+o)}var r=document.createElement("div");r.innerHTML=n,r.setAttribute(R.US,""+function(){var e=window.clientVars;return e.isOwner?w.Y.OWNER:e.privilegeAttribute.can_edit?w.Y.EDITABLE:w.Y.READABLE}()),null===e||void 0===e||e.appendChild(r)},I=function(){var e=Array.prototype.slice.call(document.querySelectorAll("#pcFooterSSRContainer"));e&&e.length>0&&e.forEach((function(e){e.addEventListener("click",(function(){n.g.snackLoading.showWithAutoHide(1e3)}))}))},O=function(){!function(){var e=document.getElementById("workbench_preivew_ssr");e&&e.addEventListener("click",(function(){n.g.snackLoading.showWithAutoHide(1e3)}))}(),I()},D=I,b=function(){function e(e,t){this.app=e,this.emitter=t,this.initSsrLifeCycle()}var t=e.prototype;return t.initSsrLifeCycle=function(){this.emitter.on(this.app.EVENT.SPREAD_SHEET_PART_INTERACTIVE_START,this.onPartInterActiveStart),this.app.event.sheetsBar.listen(g.QM.TABLE_RENDER_END,this.onTableRenderEnd),this.app.event.sheetsBar.listen(g.QM.FOOTER_RENDER_END,this.onFooterRenderEnd)},t.onPartInterActiveStart=function(){O();var e=document.getElementById(R.Zu);e&&(document.getElementById(R.vs)||(y(e),D()))},t.onTableRenderEnd=function(){(0,S.Cs)()},t.onFooterRenderEnd=function(){(0,S.rV)(),(0,S.kv)()},e}(),C=n("../spread-sheet/src/flow/browser/phase/services/sheetLifecyle.interface.ts"),x=function(e,t,n,r){var o,s=arguments.length,a=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var i=e.length-1;i>=0;i--)(o=e[i])&&(a=(s<3?o(a):s>3?o(t,n,a):o(t,n))||a);return s>3&&a&&Object.defineProperty(t,n,a),a},N=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},P=function(e,t){return function(n,r){t(n,r,e)}},L=function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function a(e){try{c(r.next(e))}catch(t){s(t)}}function i(e){try{c(r.throw(e))}catch(t){s(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,i)}c((r=r.apply(e,t||[])).next())}))},j=function(){function e(e,t,n){this.app=e,this.instantiationService=t,this.sheetLifeService=n,new b(this.app,this.app.emitter)}var t=e.prototype;return t.initPartInteractable=function(){var e,t,r;return L(this,void 0,void 0,regeneratorRuntime.mark((function o(){var s,a,i;return regeneratorRuntime.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:if(null===(e=n.g.log)||void 0===e||e.info("flow PartInteractableService initPartInteractable()",!!this.app.view),this.app.emitter.emit(this.app.EVENT.SPREAD_SHEET_PART_INTERACTIVE_START,this.app.spreadsheet.activeSheetId),this.sheetLifeService.phase=C.P.SPREAD_SHEET_PART_INTERACTIVE_START,this.initTitleDom(),this.app.initInstantiationService(this.instantiationService),s=d.q.getConfig("isHistory"),a=this.app.spreadsheet.sheetManager.activeSheet,i=a.getSheetType(),l.IF.start(),this.initCanvasDom(),!this.app.view){o.next=16;break}return null===(t=n.g.log)||void 0===t||t.info("flow","PartInteractableService reset view & Canvas"),o.next=14,this.app.view.resetAndRefreshExcelView(this.app.spreadsheet.activeSheetId);case 14:o.next=20;break;case 16:return null===(r=n.g.log)||void 0===r||r.info("flow","PartInteractableService init view & Canvas"),this.initView(),o.next=20,this.app.view.initCanvas();case 20:a.isExternalSheet()&&!s&&this.app.viewManager.renderView(i,a.getSheetId()),l.IF.end(),this.app.emitter.emit(this.app.EVENT.SPREAD_SHEET_PART_INTERACTIVE_END,this.app.spreadsheet.activeSheetId),this.sheetLifeService.phase=C.P.SPREAD_SHEET_PART_INTERACTIVE_START;case 24:case"end":return o.stop()}}),o,this)})))},t.initTitleDom=function(){var e,t;null===(e=n.g.log)||void 0===e||e.info("flow","PartInteractableService initTitleDom()");var r=document.getElementById("padAloneTitle"),o=d.q.getConfig("title");r&&r.setAttribute("value",o),document.title=o,i().isIOS&&(null===(t=n.g.mqq)||void 0===t||t.invoke("ui","setWebviewNaviTitle",{title:o,refreshDocList:"true"}))},t.initView=function(){var e,t=this;null===(e=n.g.log)||void 0===e||e.info("flow","PartInteractableService initView()"),this.instantiationService.invokeFunction((function(e){var n=e.get(u.w);t.app.initView(n)}))},t.initCanvasDom=function(e){var t,r;if(void 0===e&&(e=!0),null===(t=n.g.log)||void 0===t||t.info("flow","PartInteractableService initCanvasDom()",!!this.app.view),!this.app.view)return i().isPC?r=F():i().isMobilePhone||i().isAndroidPad?r=function(e){if(e&&!document.body.querySelector("header"))throw n.g.log.log("mobile ua",navigator.userAgent),new Error("视图初始化异常, header 不存在");document.querySelector("html").style.width="100%",document.body.style.height="100vh",document.body.style.width="100vw",document.body.style.overflow="hidden";var t=document.createElement("div");Object.assign(t.style,{width:"100%",height:"100vh",overflow:"hidden",position:"absolute",top:"0",zIndex:v.VQ?"10000":"1000",backgroundColor:"#f4f5f9"}),t.setAttribute("id","canvasContainerOuter");var r=document.createElement("div");return Object.assign(r.style,{position:"absolute",top:(v.VQ?0:E.MN)+"px",zIndex:"1001",width:"100%",height:"100vh",overflow:"hidden",backgroundColor:"#f4f5f9",transformOrigin:"left top"}),r.setAttribute("id","canvasContainer"),r.dataset.testid="canvasContainer",t.appendChild(r),document.body.appendChild(t),r}(e):i().isIPad&&(r=function(e){if(e){var t=document.body.querySelector("header");if(!t)throw n.g.log.log("pad ua",navigator.userAgent),new Error("视图初始化异常, header 不存在");Object.assign(t.style,{top:"0",height:"auto"})}document.querySelector("html").style.width="100%",document.body.style.height="100%",document.body.style.width="100%",document.body.style.overflow="hidden";var r=document.querySelector("#mainEditor .editor-wrapper");if(r&&Object.assign(r.style,{width:"100%",height:"100vh",overflow:"hidden",position:"absolute",top:"0",zIndex:"500",backgroundColor:"#f4f5f9"}),v.VQ){var o=document.querySelector("#mainContainer");o&&(o.style.zIndex="10000");var s=document.querySelector("#footerContainer");s&&(s.style.display="none")}var a=document.getElementById("mainEditor"),i=document.createElement("div");i.id="canvasContainer",i.dataset.testid="canvasContainer",a.innerHTML="",a.appendChild(i);var c=v.VQ?0:E.Mz;Object.assign(i.style,{position:"absolute",top:"0",marginTop:"0",zIndex:"501",width:"100%",height:window.innerHeight-c+"px",overflow:"hidden",transform:"translateY("+c+"px)",backgroundColor:"#f4f5f9",transformOrigin:"left top",padding:"0",borderTop:"1px solid #e2e4e8"});var u=document.querySelector("#mainContainer");return u&&(u.style.position="fixed",u.style.top="0",u.style.width="100%"),i}(e)),this.initSpreadsheetView(r),/mozilla/.test(navigator.userAgent)&&!/(compatible|webkit)/.test(navigator.userAgent)&&(document.documentElement.style.position="fixed"),r},t.initSpreadsheetView=function(e){var t,r=this;null===(t=n.g.log)||void 0===t||t.info("flow","PartInteractableService initSpreadsheetView()"),this.app.instantiationService.invokeFunction((function(t){var n,o=new _.Z(e,t.get(f.ISpreadsheet),t.get(m.Z));null===(n=r.app.instantiationService.getParent())||void 0===n||n.addService(h.Z,o)}))},e}();j=x([P(0,c.m),P(1,p.TG),P(2,C.n),N("design:paramtypes",["function"===typeof(r="undefined"!==typeof c.m&&c.m)?r:Object,"function"===typeof(o="undefined"!==typeof p.TG&&p.TG)?o:Object,"function"===typeof(s="undefined"!==typeof C.n&&C.n)?s:Object])],j);var k="page-editor"==n.j?j:null;function F(){var e=document.getElementById("mainEditor"),t=document.createElement("div");if(t.id="canvasContainer",t.dataset.testid="canvasContainer",t.innerHTML="",t.style.width="100%",IntersectionObserver){var n=new IntersectionObserver((function(r){var o=r[0].boundingClientRect.top;t.style.height=window.innerHeight-o+"px",n.unobserve(e),n.disconnect()}));n.observe(e)}else{var r=e?e.getBoundingClientRect().top:0;t.style.height=window.innerHeight-r+"px"}return t.style.zIndex="500",t.style.display="block",t.style.borderTop="1px solid #e2e4e8",e.innerHTML="",e.appendChild(t),t}},"../spread-sheet/src/flow/browser/phase/services/plugins/level2/readonly-plugins-service-pc.ts":function(e,t,n){n.r(t),n.d(t,{IReadonlyLevel2Service:function(){return _}}),n("../node_modules/regenerator-runtime/runtime.js"),n("../node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),n("../node_modules/core-js/modules/esnext.reflect.metadata.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.promise.js"),n("../node_modules/core-js/modules/esnext.global-this.js");var r,o,s=n("../node_modules/@tencent/containerized/build/main/index.js"),a=n("../spread-sheet/src/core/app/SpreadsheetApp.interface.ts"),i=n("../spread-sheet/src/core/view/spreadsheet-view/SpreadsheetView.interface.ts"),c=n("../spread-sheet/src/core/view/level-2/LazyIndex.pc.ts"),u=n("../spread-sheet/src/ServiceCollection/index.ts"),d=(n("../spread-sheet/src/base/util/domain-config.ts"),function(e,t,n,r){var o,s=arguments.length,a=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var i=e.length-1;i>=0;i--)(o=e[i])&&(a=(s<3?o(a):s>3?o(t,n,a):o(t,n))||a);return s>3&&a&&Object.defineProperty(t,n,a),a}),l=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},p=function(e,t){return function(n,r){t(n,r,e)}},h=function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function a(e){try{c(r.next(e))}catch(t){s(t)}}function i(e){try{c(r.throw(e))}catch(t){s(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,i)}c((r=r.apply(e,t||[])).next())}))},_=(0,s.yh)("IReadonlyLevel2Service");function f(e){var t,n;return null===(n=null===(t=null===globalThis||void 0===globalThis?void 0:globalThis.aegis)||void 0===t?void 0:t.error)||void 0===n||n.call(t,e),console.error(e),Promise.resolve()}var m=function(){function e(e,t){this.app=e,this.spreadsheetView=t}var t=e.prototype;return t.init=function(){var e;return h(this,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return null===(e=n.g.log)||void 0===e||e.info("flow ReadonlyService init()",!!this.app.view.plugins),t.next=3,this.initPlugins();case 3:case"end":return t.stop()}}),t,this)})))},t.initPlugins=function(){return h(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.initPreviewImageIcon().catch(f);case 2:return e.next=4,this.initRenderPluginExtension().catch(f);case 4:return e.next=6,this.initShapeEdit().catch(f);case 6:return e.next=8,this.initCollabCursor().catch(f);case 8:return e.next=10,this.initCollabAreaCursorRenderPlugin().catch(f);case 10:return e.next=12,this.initCellCornerPlugin().catch(f);case 12:return e.next=14,this.initCellImageViewer().catch(f);case 14:return e.next=16,this.initAreaTexturePlugin().catch(f);case 16:return e.next=18,this.initRangeAuthRenderPlugin().catch(f);case 18:return e.next=20,this.initPrivateRangeRenderPlugin().catch(f);case 20:return e.next=22,this.initDimensionEdit().catch(f);case 22:return e.next=24,this.initDimensionColor().catch(f);case 24:return e.next=26,this.initTableKeyboard().catch(f);case 26:return e.next=28,this.initAddonCenter().catch(f);case 28:return e.next=30,this.initEntHoverCardCenter().catch(f);case 30:e.next=33;break;case 33:return e.next=35,this.initCardCenter().catch(f);case 35:return e.next=37,this.initFormulaErrorCenter().catch(f);case 37:return e.next=39,this.initErrorTip().catch(f);case 39:return e.next=41,this.initSearchReplaceCenter().catch(f);case 41:case"end":return e.stop()}}),e,this)})))},t.initShapeEdit=function(){return h(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c.U[c.k.SHAPE_EDIT_CENTER]();case 2:t=e.sent.default,this.app.view.canvas.shapeEditCenter=new t({mainBoard:this.app.view.canvas.mainBoard,shapeStage:this.app.view.canvas.shapeStage,areaData:this.app.view.canvas.areaData,scale:this.app.view.canvas.scale,modifyShapeBroker:this.app.view.canvas.modifyShapeBroker,operateData:this.app.view.canvas.operateData,sheetStatus:this.app.sheetStatus,normalSelectStage:this.app.view.canvas.normalSelectionStage,selectCells:this.app.view.canvas.selectCellsCenter.selectOperate,mutexManagement:this.app.view.canvas.mutexManagement,spreadsheet:this.app.view.canvas.spreadsheet,autoScroll:this.app.view.canvas.autoScroll,dataCallView:this.app.view.canvas.dataCallView,alloyExcel:this.app.view.canvas.alloyExcel,tableView:this.app.view.canvas.tableView,rowcolAccessor:this.app.view.canvas.rowcolAccessor,renderApi:this.app.view.canvas.renderApi,renderPluginExtension:this.app.view.canvas.renderPluginExtension});case 4:case"end":return e.stop()}}),e,this)})))},t.initCollabCursor=function(){return h(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c.U[c.k.COLLAB_CURSOR]();case 2:t=e.sent.default,this.app.view.canvas.collabCursor=new t({spreadsheetApp:this.app,renderApi:this.spreadsheetView.renderManager.renderApi,normalSelectData:this.app.view.canvas.normalSelectData,shapeEdit:this.app.view.canvas.shapeEditCenter.shapeEdit,shapeStage:this.app.view.canvas.shapeStage,alloyExcel:this.app.view.canvas.alloyExcel,rowcolAccessor:this.app.view.canvas.rowcolAccessor,tableView:this.app.view.canvas.tableView,dataCallView:this.app.view.canvas.dataCallView,baseInputManager:this.app.view.canvas.inputManager,selectCells:this.app.view.canvas.selectCellsCenter.selectOperate});case 4:case"end":return e.stop()}}),e,this)})))},t.initCollabAreaCursorRenderPlugin=function(){return h(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c.U[c.k.COLLAB_AREA_CURSOR]();case 2:t=e.sent.default,this.app.view.canvas.collabAreaCursorRenderPlugin=new t({alloyExcel:this.app.view.canvas.alloyExcel,spreadsheet:this.app.spreadsheet,renderApi:this.app.view.canvas.renderApi,areaData:this.app.view.canvas.areaData,headSize:this.app.view.canvas.headSize,rowcolAccessor:this.app.view.canvas.rowcolAccessor,tableView:this.app.view.canvas.tableView});case 4:case"end":return e.stop()}}),e,this)})))},t.initRenderPluginExtension=function(){return h(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c.U[c.k.RENDER_PLUGIN_EXTENSION]();case 2:t=e.sent.default,this.app.view.canvas.renderPluginExtension=new t({alloyExcel:this.app.view.canvas.alloyExcel});case 4:case"end":return e.stop()}}),e,this)})))},t.initCellCornerPlugin=function(){return h(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c.U[c.k.CELL_CORNER_PLUGIN]();case 2:return t=e.sent.default,this.app.view.canvas.cellCornerPlugin=new t({renderPluginExtension:this.app.view.canvas.renderPluginExtension,rowcolAccessor:this.app.view.canvas.rowcolAccessor,tableView:this.app.view.canvas.tableView,alloyExcel:this.app.view.canvas.alloyExcel}),e.next=6,c.U[c.k.CORNER_TRIANGLE_RENDER_PLUGIN]();case 6:new(0,e.sent.default)({alloyExcel:this.app.view.canvas.alloyExcel,normalSelectData:this.app.view.canvas.normalSelectData,transformTable:this.app.view.canvas.transformTable,coverBackgroundCollect:this.app.view.canvas.renderPluginExtension.coverBackgroundCollect,spreadsheet:this.app.spreadsheet});case 8:case"end":return e.stop()}}),e,this)})))},t.initCellImageViewer=function(){var e,t;return h(this,void 0,void 0,regeneratorRuntime.mark((function n(){var r;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,c.U[c.k.CELL_IMAGE_VIEWER]();case 2:r=n.sent.default,this.app.view.canvas.cellImageViewer=new r({mouseOperate:this.app.view.canvas.mouseOperate,normalSelectData:this.app.view.canvas.normalSelectData,spreadsheet:this.app.view.canvas.spreadsheet,operateBoard:this.app.view.canvas.operateBoard,shapeZoom:null===(t=null===(e=this.app.view.canvas.shapeEditCenter)||void 0===e?void 0:e.shapeEdit)||void 0===t?void 0:t.shapeZoom,operateData:this.app.view.canvas.operateData,touchOperate:this.app.view.canvas.touchOperate});case 4:case"end":return n.stop()}}),n,this)})))},t.initAreaTexturePlugin=function(){return h(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c.U[c.k.AREA_TEXTURE_PLUGIN]();case 2:t=e.sent.default,this.app.view.canvas.areaTexturePlugin=new t({alloyExcel:this.app.view.canvas.alloyExcel,spreadsheet:this.app.view.canvas.spreadsheet,rowcolAccessor:this.app.view.canvas.rowcolAccessor,tableView:this.app.view.canvas.tableView,textureBackgroundCollector:this.app.view.canvas.renderPluginExtension.textureBackgroundCollector,renderApi:this.app.view.canvas.renderApi,areaData:this.app.view.canvas.areaData,headSize:this.app.view.canvas.headSize});case 4:case"end":return e.stop()}}),e,this)})))},t.initRangeAuthRenderPlugin=function(){return h(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c.U[c.k.RANGE_AUTH_RENDER_PLUGIN]();case 2:t=e.sent.default,this.app.view.canvas.rangeAuthRenderPlugin=new t({sheetStatus:this.app.view.canvas.spreadsheetApp.sheetStatus,spreadsheet:this.app.view.canvas.spreadsheet,areaTexturePlugin:this.app.view.canvas.areaTexturePlugin});case 4:case"end":return e.stop()}}),e,this)})))},t.initPrivateRangeRenderPlugin=function(){return h(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c.U[c.k.PRIVATE_RANGE_RENDER_PLUGIN]();case 2:t=e.sent.default,this.app.view.canvas.privateRangeRenderPlugin=new t({spreadsheet:this.app.view.canvas.spreadsheet,areaTexturePlugin:this.app.view.canvas.areaTexturePlugin});case 4:case"end":return e.stop()}}),e,this)})))},t.initDimensionEdit=function(){return h(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c.U[c.k.PC_DIMENSION_EDIT]();case 2:t=e.sent.default,this.app.view.canvas.dimensionEdit=new t({spreadsheetApp:this.app,spreadsheet:this.app.spreadsheet,rowcolAccessor:this.app.view.canvas.rowcolAccessor,alloyExcel:this.app.view.canvas.alloyExcel,areaData:this.app.view.canvas.areaData,renderApi:this.app.view.canvas.renderApi,mouseOperate:this.app.view.canvas.mouseOperate,touchOperate:this.app.view.canvas.touchOperate,headSize:this.app.view.canvas.headSize,operateData:this.app.view.canvas.operateData,scale:this.app.view.canvas.scale,clientRect:this.app.view.canvas.clientRect,autoScroll:this.app.view.canvas.autoScroll,scrollApi:this.app.view.canvas.scrollApi,mainBoard:this.app.view.canvas.mainBoard,container:this.app.view.canvas.container,sheetStatus:this.app.sheetStatus,resize:this.app.view.canvas.resize,normalSelectData:this.app.view.canvas.normalSelectData,operateBoard:this.app.view.canvas.operateBoard,modifyDimensionBroker:this.app.view.canvas.modifyDimensionBroker,modifySelectionBroker:this.app.view.canvas.modifySelectionBroker,coverBackgroundCollect:this.app.view.canvas.renderPluginExtension.coverBackgroundCollect});case 4:case"end":return e.stop()}}),e,this)})))},t.initDimensionColor=function(){return h(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c.U[c.k.DIMENSION_COLOR]();case 2:t=e.sent.default,this.app.view.canvas.dimensionColor=new t(this.app.view.canvas.normalSelectData,this.app.view.canvas.transformTable,this.app.view.canvas.areaData,this.app.view.canvas.scale,this.app.view.canvas.spreadsheet);case 4:case"end":return e.stop()}}),e,this)})))},t.initPreviewImageIcon=function(){return h(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c.U[c.k.PREVIEW_IMAGE_ICON]();case 2:new(0,e.sent.default)({alloyExcel:this.app.view.canvas.alloyExcel,spreadsheet:this.app.spreadsheet,spreadsheetView:this.spreadsheetView});case 4:case"end":return e.stop()}}),e,this)})))},t.initTableKeyboard=function(){return h(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c.U[c.k.TABLE_KEYBOARD]();case 2:t=e.sent.default,this.app.view.canvas.tableKeyboard=new t({spreadsheetApp:this.app,board:this.app.view.canvas.container,config:{base:!0,edit:!0,copyPaste:!0,loadingImg:!0,sheet:!0}});case 4:case"end":return e.stop()}}),e,this)})))},t.initAddonCenter=function(){return h(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c.U[c.k.ADDON_CENTER]();case 2:t=e.sent.default,this.app.view.canvas.addonCenter=new t({dataCallView:this.app.view.canvas.dataCallView,spreadsheet:this.app.spreadsheet,areaData:this.app.view.canvas.areaData,scale:this.app.view.canvas.scale,mainBoard:this.app.view.canvas.mainBoard,operateData:this.app.view.canvas.operateData,mutexManagement:this.app.view.canvas.mutexManagement,spreadsheetApp:this.app});case 4:case"end":return e.stop()}}),e,this)})))},t.initEntHoverCardCenter=function(){var e;return h(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,c.U[c.k.HOVER_CARD_CENTER]();case 2:if(t.t1=e=t.sent,t.t0=null===t.t1,t.t0){t.next=6;break}t.t0=void 0===e;case 6:if(!t.t0){t.next=10;break}t.t2=void 0,t.next=11;break;case 10:t.t2=e.default;case 11:(n=t.t2)&&(this.app.view.canvas.hoverCardCenter=new n({spreadsheet:this.app.spreadsheet,selectCells:this.app.view.canvas.selectCellsCenter.selectOperate,tableView:this.app.view.canvas.tableView,touchOperate:this.app.view.canvas.touchOperate,mouseOperate:this.app.view.canvas.mouseOperate,operateData:this.app.view.canvas.operateData,inputManager:this.app.view.canvas.inputManager,areaData:this.app.view.canvas.areaData,scale:this.app.view.canvas.scale}));case 13:case"end":return t.stop()}}),t,this)})))},t.initInputAutofill=function(){var e;return h(this,void 0,void 0,regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=this.app.serviceCollection.createLoader(u.kh.INPUT_AUTOFILL),t.next=3,r.init(this.app);case 3:t.sent.init(this.app),null===(e=n.g.log)||void 0===e||e.debug("flow PcPluginService initInputAutofill() end");case 6:case"end":return t.stop()}}),t,this)})))},t.initCardCenter=function(){var e;return h(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n,r,o,s,a=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,c.U[c.k.CARD_CENTER]();case 2:return n=t.sent.default,this.app.view.canvas.cardCenter=new n({tableView:this.app.view.canvas.tableView,mainBoard:this.app.view.canvas.mainBoard,areaData:this.app.view.canvas.areaData,clientRect:this.app.view.canvas.clientRect,dataCallView:this.app.view.canvas.dataCallView,headSize:this.app.view.canvas.headSize,mutexManagement:this.app.view.canvas.mutexManagement,spreadsheet:this.app.spreadsheet}),t.next=6,c.U[c.k.FILE_SELECTOR]();case 6:if(t.t1=e=t.sent,t.t0=null===t.t1,t.t0){t.next=10;break}t.t0=void 0===e;case 10:if(!t.t0){t.next=14;break}t.t2=void 0,t.next=15;break;case 14:t.t2=e.default;case 15:return(r=t.t2)&&(this.app.view.canvas.fileSelector=new r({requestApi:this.app.requestApi,inputManager:this.app.view.canvas.inputManager,cardCenter:this.app.view.canvas.cardCenter})),t.next=19,c.U[c.k.LINK_CENTER]();case 19:return o=t.sent.default,this.app.view.canvas.linkCenter=new o({tableView:this.app.view.canvas.tableView,areaData:this.app.view.canvas.areaData,touchOperate:this.app.view.canvas.touchOperate,mouseOperate:this.app.view.canvas.mouseOperate,spreadsheet:this.app.spreadsheet,headSize:this.app.view.canvas.headSize,clientRect:this.app.view.canvas.clientRect,rowcolAccessor:this.app.view.canvas.rowcolAccessor,modifyLinkBroker:this.app.view.canvas.modifyLinkBroker,cardCenter:this.app.view.canvas.cardCenter,operateData:this.app.view.canvas.operateData,scale:this.app.view.canvas.scale,sheetStatus:this.app.sheetStatus,modifyCellBroker:this.app.view.canvas.modifyCellBroker,scrollApi:this.app.view.canvas.scrollApi,selectApi:this.app.view.canvas.selectApi,normalSelectData:this.app.view.canvas.normalSelectData,spreadsheetApp:this.app,positionApi:this.app.view.canvas.positionApi,hoverCardCenter:this.app.view.canvas.hoverCardCenter,fileSelector:this.app.view.canvas.fileSelector,inputManager:this.app.view.canvas.inputManager}),t.next=23,c.U[c.k.COMMENT_CENTER]();case 23:s=t.sent.default,this.app.view.canvas.commentCenter=new s({app:this.app,spreadsheet:this.app.spreadsheet,selectCells:this.app.view.canvas.selectCellsCenter.selectOperate,cellCornerPlugin:this.app.view.canvas.cellCornerPlugin,areaData:this.app.view.canvas.areaData,headSize:this.app.view.canvas.headSize,normalSelectData:this.app.view.canvas.normalSelectData,clientRect:this.app.view.canvas.clientRect,scrollApi:this.app.view.canvas.scrollApi,selectApi:this.app.view.canvas.selectApi,alloyExcel:this.app.view.canvas.alloyExcel,rowcolAccessor:this.app.view.canvas.rowcolAccessor,cardCenter:this.app.view.canvas.cardCenter,sheetStatus:this.app.view.canvas.spreadsheetApp.sheetStatus,renderApi:this.app.view.canvas.renderApi,requestApi:this.app.requestApi,tableView:this.app.view.canvas.tableView,scale:this.app.view.canvas.scale,hoverCardCenter:this.app.view.canvas.hoverCardCenter,getQQGroupName:function(){var e,t;return null===(t=null===(e=a.app.view)||void 0===e?void 0:e.discuss)||void 0===t?void 0:t.getQQGroupName()}});case 25:case"end":return t.stop()}}),t,this)})))},t.initFormulaErrorCenter=function(){return h(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c.U[c.k.FORMULA_ERROR_CENTER]();case 2:t=e.sent.default,this.app.view.canvas.formulaErrorCenter=new t({selectCells:this.app.view.canvas.selectCells,spreadsheet:this.app.spreadsheet,cardCenter:this.app.view.canvas.cardCenter,operateData:this.app.view.canvas.operateData,tableView:this.app.view.canvas.tableView,mouseOperate:this.app.view.canvas.mouseOperate,cellCornerPlugin:this.app.view.canvas.cellCornerPlugin});case 4:case"end":return e.stop()}}),e,this)})))},t.initErrorTip=function(){return h(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c.U[c.k.ERROR_TIP]();case 2:t=e.sent.default,this.app.view.canvas.errorTip=new t(this.app.instantiationService,this.app,this.app.view.canvas.errorTipAccessor,this.app.view.canvas.cellCornerPlugin,this.app.view.canvas.renderApi,this.app.view.canvas.dataCallView,this.app.view.canvas.normalSelectData,this.app.view.canvas.areaData);case 4:case"end":return e.stop()}}),e,this)})))},t.initSearchReplaceCenter=function(){return h(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c.U[c.k.SEARCH_REPLACE]();case 2:t=e.sent.default,this.app.view.canvas.searchReplaceCenter=new t({spreadsheetApp:this.app,spreadsheet:this.app.spreadsheet,rowcolAccessor:this.app.view.canvas.rowcolAccessor,alloyExcel:this.app.view.canvas.alloyExcel,tableView:this.app.view.canvas.tableView,renderApi:this.app.view.canvas.renderApi,scrollApi:this.app.view.canvas.scrollApi,selectApi:this.app.view.canvas.selectApi,normalSelectData:this.app.view.canvas.normalSelectData,renderPluginExtension:this.app.view.canvas.renderPluginExtension});case 4:case"end":return e.stop()}}),e,this)})))},e}();m=d([p(0,a.m),p(1,i.N),l("design:paramtypes",["function"===typeof(r="undefined"!==typeof a.m&&a.m)?r:Object,"function"===typeof(o="undefined"!==typeof i.N&&i.N)?o:Object])],m),t.default="page-editor"==n.j?m:null},"../spread-sheet/src/flow/browser/phase/services/sdkCoreService.interface.ts":function(e,t,n){n.d(t,{i:function(){return r}});var r=(0,n("../node_modules/@tencent/containerized/build/main/index.js").yh)("ISdkCoreService")},"../spread-sheet/src/flow/browser/phase/services/sdkCoreService.ts":function(e,t,n){n.d(t,{qs:function(){return ut},ZP:function(){return dt}}),n("../node_modules/regenerator-runtime/runtime.js"),n("../node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),n("../node_modules/core-js/modules/esnext.reflect.metadata.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.promise.js"),n("../node_modules/core-js/modules/es.array.iterator.js"),n("../node_modules/core-js/modules/es.string.iterator.js"),n("../node_modules/core-js/modules/web.dom-collections.iterator.js"),n("../node_modules/core-js/modules/web.url.js"),n("../node_modules/core-js/modules/web.url-search-params.js"),n("../node_modules/core-js/modules/es.regexp.exec.js"),n("../node_modules/core-js/modules/es.string.split.js"),n("../node_modules/core-js/modules/es.string.replace.js"),n("../node_modules/core-js/modules/es.array.filter.js"),n("../node_modules/core-js/modules/es.array.includes.js"),n("../node_modules/core-js/modules/es.string.includes.js"),n("../node_modules/core-js/modules/es.array.map.js"),n("../node_modules/core-js/modules/es.string.search.js"),n("../node_modules/core-js/modules/es.array.slice.js"),n("../node_modules/core-js/modules/es.function.name.js"),n("../node_modules/core-js/modules/es.array.from.js"),n("../node_modules/core-js/modules/es.symbol.js"),n("../node_modules/core-js/modules/es.symbol.description.js"),n("../node_modules/core-js/modules/es.symbol.iterator.js");var r,o=n("../spread-sheet/src/core/app/event-init.ts");!function(e){e.LOAD_DOCUMENT_DATA_ERROR="LOAD_DOCUMENT_DATA_ERROR"}(r||(r={}));var s,a,i,c=n("../packages/common-utils/src/index.ts"),u=n("../node_modules/@babel/runtime/helpers/esm/createClass.js"),d=n("../node_modules/@babel/runtime/helpers/esm/assertThisInitialized.js"),l=n("../node_modules/@babel/runtime/helpers/esm/inheritsLoose.js"),p=(n("../node_modules/core-js/modules/es.map.js"),n("../node_modules/core-js/modules/esnext.map.delete-all.js"),n("../node_modules/core-js/modules/esnext.map.every.js"),n("../node_modules/core-js/modules/esnext.map.filter.js"),n("../node_modules/core-js/modules/esnext.map.find.js"),n("../node_modules/core-js/modules/esnext.map.find-key.js"),n("../node_modules/core-js/modules/esnext.map.includes.js"),n("../node_modules/core-js/modules/esnext.map.key-of.js"),n("../node_modules/core-js/modules/esnext.map.map-keys.js"),n("../node_modules/core-js/modules/esnext.map.map-values.js"),n("../node_modules/core-js/modules/esnext.map.merge.js"),n("../node_modules/core-js/modules/esnext.map.reduce.js"),n("../node_modules/core-js/modules/esnext.map.some.js"),n("../node_modules/core-js/modules/esnext.map.update.js"),n("../node_modules/core-js/modules/es.number.constructor.js"),n("../node_modules/core-js/modules/es.array.find.js"),n("../node_modules/core-js/modules/web.dom-collections.for-each.js"),n("../node_modules/core-js/modules/es.object.assign.js"),n("../node_modules/core-js/modules/es.array.sort.js"),n("../node_modules/i18next/dist/esm/i18next.js")),h=n("./node_modules/axios/index.js"),_=n.n(h),f=n("../packages/report/src/index.ts"),m=n("../spread-sheet/src/core/network/datacenter/utils/report.ts");!function(e){e.INIT="INIT",e.WORKING="WORKING",e.PAUSED="PAUSED"}(s||(s={})),function(e){e.OFFLINE="OFFLINE",e.SERVER="SERVER"}(a||(a={})),function(e){e.FAIL="FAIL",e.SUCCESS="SUCCESS"}(i||(i={}));var v=function(){function e(e){this.status=s.INIT,this.name=e.name,this._containerID=n.g.containerID}var t=e.prototype;return t.pause=function(){f.ZP.run(m.mz.LOADER_PAUSE,["暂停 loader",this._containerID,this.name]),this.status=s.PAUSED},t.work=function(){f.ZP.run(m.mz.LOADER_WORK,["启动 loader",this._containerID,this.name]),this.status=s.WORKING},t.isPause=function(){return this.status===s.PAUSED},e}(),E=n("../packages/utils/src/safe.ts"),g=n("../spread-sheet/src/core/network/datacenter/loader/loaderUtil.ts"),R=n("../spread-sheet/src/core/network/datacenter/loader/loaderErrorType.ts"),S=n("../spread-sheet/src/core/data/configService/spreadConfig.ts");function A(e){return e.isPreview=e.preview||(0,c.IZ)("inToastPreview"),S.q.reloadConfig(e),S.q}var w=n("../packages/model/src/config/index.ts"),T=n("../node_modules/@tencent/docs-user-agent/dist/index.js"),y=n.n(T),I=n("../node_modules/@tencent/tencent_doc_net/dist/index.js"),O=n("../node_modules/qs/lib/index.js"),D=n.n(O),b=n("../spread-sheet/src/flow/common/utils.ts"),C=n("../node_modules/@tencent/smartsheet-sdk/es/index.js"),x=n("../spread-sheet/src/base/util/timer.ts"),N=n("../packages/model/src/utils/index.ts"),P=function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function a(e){try{c(r.next(e))}catch(t){s(t)}}function i(e){try{c(r.throw(e))}catch(t){s(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,i)}c((r=r.apply(e,t||[])).next())}))},L=function(e){function t(t){var n;return(n=e.call(this,t)||this).slicedRowCount={},n.openDocRetryTimes=3,n.priority=0,n.from=w.DEFAULT_FIRST_CHUNK_START_ROW,n.count=w.DEFAULT_FIRST_CHUNK_END_ROW,n.firstDataRowCount=61,n.retryFetchChunkTime=0,n._init(),n}(0,l.Z)(t,e);var r=t.prototype;return r.destroy=function(){this._init()},r.loadDocumentData=function(e){return P(this,void 0,void 0,regeneratorRuntime.mark((function t(){var r=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.work(),t.abrupt("return",new Promise((function(t,o){return P(r,void 0,void 0,regeneratorRuntime.mark((function r(){var s,a,i,c,u,d;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(s=n.g,a=s.openDocResponseText,i=n.g,c=i.openDocType,u=i.openDocXhr,"JSONP"!==c){r.next=8;break}if(void 0===a){r.next=6;break}return f.ZP.run(m.mz.SERVER_LOADER_OPEN_DOC_INLINE_DATA,["HTML 内联 JSONP 返回了 openDoc 数据",this._containerID,e.sheetId,this.from,this.count,a]),r.abrupt("return",this.handleOpenDocResponseJSONP(a,t,o,e));case 6:r.next=14;break;case 8:if(!u||void 0===a){r.next=11;break}return f.ZP.run(m.mz.SERVER_LOADER_OPEN_DOC_INLINE_DATA,["HTML 内联 ajax 返回了 openDoc 数据",this._containerID,e.sheetId,this.from,this.count,a]),r.abrupt("return",this._handleOpenDocResponse(u,a,t,o,e));case 11:if(!u||void 0!==a){r.next=14;break}return f.ZP.run(m.mz.SERVER_LOADER_OPEN_DOC_INLINE_NOT_DATA,["HTML 内联 ajax 请求了 openDoc 但未回包",this._containerID,e.sheetId,this.from,this.count]),r.abrupt("return",this._overWriteXhrReadyStateChange(u,t,o,e));case 14:return r.prev=14,r.next=17,this._fetchOpenDoc(e);case 17:d=r.sent,r.next=24;break;case 20:return r.prev=20,r.t0=r.catch(14),f.ZP.run(m.mz.SERVER_LOADER_FETCH_OPEN_DOC_ERROR,["openDoc 请求失败了",this._containerID,e.sheetId,this.from,this.count,null===r.t0||void 0===r.t0?void 0:r.t0.stack]),r.abrupt("return",t({isSuccess:!1,error:{type:R.Z.OPEN_DOC_AXIOS_ERROR,message:null===r.t0||void 0===r.t0?void 0:r.t0.message,isTryLowerPriorityLoader:!0},loader:this}));case 24:return r.abrupt("return",this._handleOpenDocResponse(d,d.data,t,o,e));case 25:case"end":return r.stop()}}),r,this,[[14,20]])})))})).then((function(t){return P(r,void 0,void 0,regeneratorRuntime.mark((function r(){var o,s,a,i,c,u,d,l,p,h;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(n.g.openDocType=void 0,n.g.openDocXhr=void 0,n.g.openDocResponseText=void 0,!this.isPause()){r.next=5;break}return r.abrupt("return");case 5:if(t.isSuccess&&!t.error){r.next=7;break}return r.abrupt("return",t);case 7:return a=t.data.clientVars,i=null===(o=a.collab_client_vars)||void 0===o?void 0:o.initialAttributedText.text,a.collab_client_vars.initialAttributedText=void 0,c=A(t.data.clientVars),null===(s=e.handleClientVars)||void 0===s||s.call(e,a,c),u=a.collab_client_vars,d=u.maxRow,l=u.padSubId,p=b.UG.deduplication(c.getConfig("sheetList")),h=b.UG.getSheetType(p,l),this._handleSliceRow(l,d-1,Object.assign(Object.assign({},e),{sheetType:h,baseVersion:c.getConfig("rev")})),r.abrupt("return",{clientVars:a,spreadConfig:c,firstData:i,sheetId:l,isFinished:d<=this.firstDataRowCount,isLastChunk:d<=this.firstDataRowCount,loader:this,isSuccess:!0,startRow:w.DEFAULT_FIRST_CHUNK_START_ROW,endRow:Math.min(w.DEFAULT_FIRST_CHUNK_END_ROW,d-1)});case 17:case"end":return r.stop()}}),r,this)})))})));case 2:case"end":return t.stop()}}),t,this)})))},r.loadSheetData=function(e){return P(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.work(),t.abrupt("return",new Promise((function(t,r){return P(n,void 0,void 0,regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:this._handleSheetData(t,r,e);case 1:case"end":return n.stop()}}),n,this)})))})).then((function(t){return P(n,void 0,void 0,regeneratorRuntime.mark((function n(){var r,o,s,a,i,c,u;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!this.isPause()){n.next=2;break}return n.abrupt("return");case 2:if(r=e.sheetId,o=e.onSuccess,s=e.onFail,a=t.isSuccess,i=t.maxRow,a){n.next=6;break}return n.abrupt("return",t);case 6:if(null===o||void 0===o||o(t),e.ignoreChunk){n.next=19;break}c=(0,g.KE)({from:this.from+this.count+1,to:i-1}),this._setSlicedRowCount(r,c.length),u=0;case 11:if(!(u<c.length)){n.next=17;break}return n.next=14,this._loadChunkData({baseVersion:e.baseVersion,from:c[u].from,to:c[u].to,sheetId:r,callback:o}).catch((function(e){null===s||void 0===s||s(e)}));case 14:u+=1,n.next=11;break;case 17:n.next=20;break;case 19:this._loadChunkData({baseVersion:e.baseVersion,from:this.from+this.count+1,to:i-1||w.DEFAULT_ROW_COUNT,sheetId:r,callback:o}).catch((function(e){null===s||void 0===s||s(e)}));case 20:return n.abrupt("return",t);case 21:case"end":return n.stop()}}),n,this)})))})));case 2:case"end":return t.stop()}}),t,this)})))},r._handleSliceRow=function(e,t,n){var r=this,o=(0,g.KE)({from:this.firstDataRowCount,to:null!==t&&void 0!==t?t:200});this._setSlicedRowCount(e,o.length);var s=(0,N.getIsExternalSheetBySheetType)(n.sheetType),a=this.getIsAllowSlice();if(!o.length||s&&!a)setTimeout((function(){n.onSuccess({startRow:null,endRow:null,sheetId:e,chunkData:[[[]]],isFinished:!0,isLastChunk:!0})}),0);else{var i=0,c=function(t,s){return P(r,void 0,void 0,regeneratorRuntime.mark((function r(){var a,i;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:for(a=[],i=t;i<=s;i+=1)a.push(this._loadChunkData({baseVersion:n.baseVersion,from:o[i].from,to:o[i].to,sheetId:e,callback:n.onSuccess,isFirstLoad:!0}));return r.next=4,Promise.all(a).then((function(){a.length=0})).catch((function(e){var t;console.error(e),null===(t=n.onFail)||void 0===t||t.call(n,e),a.length=0}));case 4:case"end":return r.stop()}}),r,this)})))};!function e(){setTimeout((function(){return P(r,void 0,void 0,regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(i<o.length)){t.next=8;break}return(n=Math.min(o.length-1,i))>o.length-1&&(n=o.length-1),t.next=5,c(i,n);case 5:return i=n+1,t.next=8,e();case 8:case"end":return t.stop()}}),t)})))}),300)}()}},r._init=function(){this.slicedRowCount={},this.openDocRetryTimes=3},r._handleOpenDocResponse=function(e,t,n,r,o,s){return P(this,void 0,void 0,regeneratorRuntime.mark((function a(){var i;return regeneratorRuntime.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(a.prev=0,i="string"===typeof t?JSON.parse(t):t){a.next=5;break}return f.ZP.run(m.mz.SERVER_LOADER_HANDLE_OPEN_DOC_RESPONSE_FROM_RETRY,["openDoc 请求异常",this._containerID,e.responseType,e.responseText]),a.abrupt("return",n({isSuccess:!1,error:{type:R.Z.OPEN_DOC_JSON_PARSE_ERROR,message:p.ZP.t("Opendoc数据解析出错, 数据可能出现错误、未正常返回或被限制请求。")},loader:this}));case 5:a.next=10;break;case 7:return a.prev=7,a.t0=a.catch(0),a.abrupt("return",n({isSuccess:!1,error:{type:R.Z.OPEN_DOC_JSON_PARSE_ERROR,message:null===a.t0||void 0===a.t0?void 0:a.t0.stack},loader:this}));case 10:if("blankpage"!==i.padType){a.next=14;break}return a.next=13,this._handleBlankPage(e,i,n,r,o);case 13:return a.abrupt("return",a.sent);case 14:if("sheet"!==i.padType){a.next=17;break}return"fromRetry"===s&&f.ZP.run(m.mz.SERVER_LOADER_HANDLE_OPEN_DOC_RESPONSE_FROM_RETRY,["openDoc 重试后正常回包",this._containerID,i]),a.abrupt("return",n({isSuccess:!0,data:i,loader:this}));case 17:if("doc"!==i.padType){a.next=19;break}return a.abrupt("return",n({isSuccess:!0,error:{type:R.Z.OPEN_DOC_PAD_TYPE_ERROR,message:p.ZP.t("明明请求的是 sheet，却返回了 doc，需要 url 重新跳转")},loader:this}));case 19:return a.abrupt("return",r({isSuccess:!0,error:{type:R.Z.OPEN_DOC_ERROR_UNKNOWN,message:p.ZP.t("opendoc 未知错误")},loader:this}));case 20:case"end":return a.stop()}}),a,this,[[0,7]])})))},r.handleOpenDocResponseJSONP=function(e,t,r,o,s){var a;return P(this,void 0,void 0,regeneratorRuntime.mark((function i(){var c,u,d,l;return regeneratorRuntime.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:i.prev=0,c="string"===typeof e?JSON.parse(e):e,i.next=12;break;case 4:if(i.prev=4,i.t0=i.catch(0),"fromRetry"!==s){i.next=8;break}return i.abrupt("return",t({isSuccess:!1,error:{type:R.Z.OPEN_DOC_JSON_PARSE_ERROR,message:null===i.t0||void 0===i.t0?void 0:i.t0.stack},loader:this}));case 8:return i.next=10,this._fetchOpenDoc(o);case 10:return u=i.sent,i.abrupt("return",this.handleOpenDocResponseJSONP(u.data,t,r,o,"fromRetry"));case 12:if(!y().isWxWork||!(null===(a=n.g.tdocs)||void 0===a?void 0:a.docLogin)||!1!==c.isLogin){i.next=30;break}if(d=this._getOpenDocUrl(o.secretId,o.sheetId,this.from,this.from+this.count),!I.renewService.renewTicket(d)){i.next=30;break}return i.prev=15,i.next=18,I.renewService.awaitLoginTicket(d);case 18:return i.next=20,this._fetchOpenDoc(o);case 20:return l=i.sent,I.renewService.renewSuccess(d),i.abrupt("return",this.handleOpenDocResponseJSONP(l.data,t,r,o,"fromRetry"));case 25:return i.prev=25,i.t1=i.catch(15),i.next=29,this.handleBlankPageJSONP(c,t);case 29:case 33:return i.abrupt("return",i.sent);case 30:if("blankpage"!==c.padType){i.next=34;break}return i.next=33,this.handleBlankPageJSONP(c,t);case 34:if("sheet"!==c.padType){i.next=36;break}return i.abrupt("return",t({isSuccess:!0,data:c,loader:this}));case 36:if("doc"!==c.padType){i.next=38;break}return i.abrupt("return",t({isSuccess:!0,error:{type:R.Z.OPEN_DOC_PAD_TYPE_ERROR,message:p.ZP.t("明明请求的是 sheet，却返回了 doc，需要 url 重新跳转")},loader:this}));case 38:return i.abrupt("return",r({isSuccess:!0,error:{type:R.Z.OPEN_DOC_ERROR_UNKNOWN,message:p.ZP.t("opendoc 未知错误")},loader:this}));case 39:case"end":return i.stop()}}),i,this,[[0,4],[15,25]])})))},r._handleBlankPage=function(e,t,n,r,o){return P(this,void 0,void 0,regeneratorRuntime.mark((function s(){var a,i;return regeneratorRuntime.wrap((function(s){for(;;)switch(s.prev=s.next){case 0:if(20!==t.clientVars.type){s.next=2;break}return s.abrupt("return",n({isSuccess:!1,error:{type:R.Z.OPEN_DOC_PAD_NO_EXIST,message:p.ZP.t("文档不存在"),data:t,isTryLowerPriorityLoader:!0},loader:this}));case 2:if(a=e instanceof XMLHttpRequest?e.getResponseHeader("forbidden-retry"):e.headers["forbidden-retry"],f.ZP.run(m.mz.SERVER_LOADER_HANDLE_BLANK_PAGE,["处理 ajax openDoc 空白页",this._containerID,a,this.openDocRetryTimes,t]),"true"===a){s.next=6;break}return s.abrupt("return",n({isSuccess:!0,error:{type:R.Z.OPEN_DOC_BLANK_PAGE_FORBIDDEN_RETRY,message:p.ZP.t("open后台错误，后台不允许重试，外层应该跳转到空白页面，给参数3和 data"),data:t},loader:this}));case 6:if(!(this.openDocRetryTimes>0)){s.next=12;break}return this.openDocRetryTimes-=1,s.next=10,this._fetchOpenDoc(o);case 10:return i=s.sent,s.abrupt("return",this._handleOpenDocResponse(e,i.data,n,r,o,"fromRetry"));case 12:return s.abrupt("return",n({isSuccess:!0,error:{type:R.Z.OPEN_DOC_BLANK_PAGE_ERROR_MAX_RETRY,message:p.ZP.t("opendoc 重试了三次，依然返回空白页，要跳转到空页面，给参数3和 data"),data:t},loader:this}));case 13:case"end":return s.stop()}}),s,this)})))},r.handleBlankPageJSONP=function(e,t){return f.ZP.run(m.mz.SERVER_LOADER_HANDLE_BLANK_PAGE_JSONP,["处理 JSONP openDoc 空白页",this._containerID,e]),20===e.clientVars.type?t({isSuccess:!1,error:{type:R.Z.OPEN_DOC_PAD_NO_EXIST,message:p.ZP.t("文档不存在"),data:e,isTryLowerPriorityLoader:!0},loader:this}):t({isSuccess:!0,error:{type:R.Z.OPEN_DOC_BLANK_PAGE_FORBIDDEN_RETRY,message:p.ZP.t("opendoc 直接失败，依然返回空白页，要跳转到空页面，给参数3和 data"),data:e},loader:this})},r._fetchOpenDoc=function(e){return P(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n,r=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=this._getOpenDocUrl(e.secretId,e.sheetId,this.from,this.from+this.count),f.ZP.run(m.mz.SERVER_LOADER_FETCH_OPEN_DOC,["ajax 请求 openDoc",this._containerID,e.sheetId,this.from,this.count]),t.abrupt("return",_()({url:n,method:"GET",responseType:"json"}).then((function(t){return f.ZP.run(m.mz.SERVER_LOADER_OPEN_DOC_RESPONSE,["openDoc 成功回包",r._containerID,e.sheetId,r.from,r.count]),t})));case 3:case"end":return t.stop()}}),t,this)})))},r._overWriteXhrReadyStateChange=function(e,t,n,r){var o=this;e.onreadystatechange=function(){return P(o,void 0,void 0,regeneratorRuntime.mark((function o(){var s;return regeneratorRuntime.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:if(e.readyState===XMLHttpRequest.DONE){o.next=2;break}return o.abrupt("return");case 2:if(200===e.status){o.next=10;break}if(!(this.openDocRetryTimes>0)){o.next=9;break}return this.openDocRetryTimes-=1,o.next=7,this._fetchOpenDoc(r);case 7:return s=o.sent,o.abrupt("return",this._handleOpenDocResponse(e,s.data,t,n,r,"fromRetry"));case 9:return o.abrupt("return",n({isSuccess:!1,error:{type:R.Z.OPEN_DOC_NOT_200_ERROR_MAX_RETRY,message:p.ZP.t("opendoc 连续三次请求非 200")}}));case 10:this._handleOpenDocResponse(e,e.responseText,t,n,r);case 11:case"end":return o.stop()}}),o,this)})))}},r._loadChunkData=function(e,t){return void 0===t&&(t=2),P(this,void 0,void 0,regeneratorRuntime.mark((function r(){var o=this;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",new Promise((function(r,s){return P(o,void 0,void 0,regeneratorRuntime.mark((function o(){var a,i,c,u,d,l,p,h,v,E,g,A,w,T,y,I,O,D,b,N,P;return regeneratorRuntime.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return a=S.q.getConfig("globalPadId"),i=e.sheetId,c=e.from,u=e.to,d=e.callback,l=e.baseVersion,p=e.isFirstLoad,h=this._getSheetCgi(a,i,c,u,l),(v=p?n.g.clientVars.viewId:(0,C.XE)(i))&&(h+="&viewId="+v),f.ZP.run(m.mz.SERVER_LOADER_LOAD_CHUNK_DATA,["请求首片外分片",this._containerID,this.name,c,u,i]),o.prev=6,o.next=9,_()({method:"get",url:h,responseType:"json"});case 9:(g=o.sent).data?0===g.data.retcode?(A=g.data.data,w=A.sheetId,T=A.startrow,y=A.endrow,I=A.maxrow,O=A.maxcol,f.ZP.run(m.mz.SERVER_LOADER_LOAD_CHUNK_DATA_RESPONSE,["首片外分片正常回包",this._containerID,this.name,this.isPause(),c,u,w,t]),D=g.data.data.initialAttributedText.text,this._decreaseSlicedRowCount(w),b=Number(y)-Number(I)>=-1,N={startRow:+T,endRow:+y,sheetId:w,chunkData:D,isFinished:0===this._getSlicedRowCount(w),isLastChunk:b,loader:this,maxRow:I,maxCol:O},E=N):(f.ZP.run(m.mz.SERVER_LOADER_LOAD_CHUNK_DATA_RESPONSE,["首片外分片正常回包，retcode 不为 0",this._containerID,this.name,this.isPause(),c,u,i,g.data.retcode]),E={error:{message:g.data.retcode,type:R.Z.LOAD_ONLINE_SHEET_DATA_FAIL,code:""+g.data.retcode}}):(f.ZP.run(m.mz.SERVER_LOADER_LOAD_CHUNK_DATA_RESPONSE_NOT_DATA,["首片外分片成功回包，但数据格式不正确",this._containerID,this.name,c,u,i,g,t]),E={error:{message:"chunk data is null",type:R.Z.LOAD_ONLINE_SHEET_DATA_FAIL,code:R.H.DATA_NULL}}),o.next=18;break;case 13:o.prev=13,o.t0=o.catch(6),console.error(o.t0),f.ZP.run(m.mz.SERVER_LOADER_LOAD_CHUNK_DATA_ERROR,["首片外分片请求失败了",this._containerID,this.name,c,u,i,t,o.t0]),E={error:{message:o.t0,type:R.Z.LOAD_ONLINE_SHEET_DATA_FAIL,code:R.H.FETCH_FAIL}};case 18:if(!this.isPause()){o.next=20;break}return o.abrupt("return");case 20:if(E.error){o.next=24;break}return o.next=23,null===d||void 0===d?void 0:d(E);case 23:return o.abrupt("return",r(E));case 24:if(!t){o.next=37;break}return o.prev=25,o.next=28,(0,x._)(1e3);case 28:return o.next=30,this._loadChunkData(e,t-1);case 30:P=o.sent,r(P),o.next=37;break;case 34:o.prev=34,o.t1=o.catch(25),s(o.t1);case 37:s(E);case 38:case"end":return o.stop()}}),o,this,[[6,13],[25,34]])})))})));case 1:case"end":return r.stop()}}),r)})))},r._getSheetCgi=function(e,t,n,r,o){var s={padId:e,subId:t,startrow:n,endrow:r,xsrf:(0,E.f)(),_r:Math.random(),outformat:1,normal:1,preview_token:(0,c.ej)("preview_token"),nowb:1};(0,c.IZ)("uniquefileid")&&(s.uniquefileid=(0,c.IZ)("uniquefileid")),(0,c.IZ)("preview")&&(s.preview=(0,c.IZ)("preview"));var a="/dop-api/get/sheet?"+D().stringify(s);return a+="&enableSmartsheetSplit=1",o&&(a+="&rev="+o),a},r._getOpenDocUrl=function(e,t,n,r){var o=e||location.pathname.replace(/\/sheet\/(history\/)?/,""),s=location.search;(s=(0,c.oW)(s,["uid","uid_key","tab"]))&&s.indexOf("?")>-1?s+="&":s+="?";var a="preview_token",i=(0,c.ej)(a),u=(0,E.f)();return t&&(s=(0,c.oW)(s,"tab"),s+="tab="+t),"/dop-api/opendoc"+s+"&outformat=1&normal=1&id="+o+"&"+a+"="+i+"&startrow="+n+"&endrow="+r+"&t="+Number(new Date)+"&wb=1&nowb=0&xsrf="+u},r._handleSheetData=function(e,t,n){var r;return P(this,void 0,void 0,regeneratorRuntime.mark((function t(){var o,s,a,i,c,u,d,l,h,_,v;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return o=n.sheetId,t.prev=1,t.next=4,this._fetchSheetChunk(n);case 4:s=t.sent,t.next=11;break;case 7:return t.prev=7,t.t0=t.catch(1),console.error(t.t0),t.abrupt("return",e({isSuccess:!1,error:{type:R.Z.LOAD_ONLINE_SHEET_DATA_CATCH_ERROR,message:p.ZP.t("切表 get/sheet 拉取数据 catch 失败"),code:-1,error:t.t0,sheetId:o},loader:this}));case 11:if(a=this.isPause(),f.ZP.run(m.mz.SERVER_LOADER_HANDLE_SHEET_DATA_RESPONSE,["拉子 sheet 首片数据回包",this._containerID,this.name,a,n]),!a){t.next=15;break}return t.abrupt("return");case 15:if(s&&s.data&&0===s.data.retcode){t.next=17;break}return t.abrupt("return",e({isSuccess:!1,error:{type:R.Z.LOAD_ONLINE_SHEET_DATA_FAIL,message:p.ZP.t("切表/首屏数据拉取失败"),code:(null===(r=null===s||void 0===s?void 0:s.data)||void 0===r?void 0:r.retcode)||-2,sheetId:o},loader:this}));case 17:return i=s.data.data,c=i.startrow,u=i.endrow,d=i.initialAttributedText,l=i.maxrow,h=i.maxcol,_=d.text,v={isSuccess:!0,sheetId:o,chunkData:_,startRow:+c,endRow:"-1"===u?l-1:+u,isFinished:"-1"===u||l<=+u+1,isLastChunk:"-1"===u||l<=+u+1,maxRow:l,maxCol:h},t.abrupt("return",e(v));case 22:case"end":return t.stop()}}),t,this,[[1,7]])})))},r._fetchSheetChunk=function(e){return P(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n,r,o,s,a,i,c,u;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=S.q.getConfig("globalPadId"),r=e.sheetId,o=this.from,a=this.count,e.ignoreChunk&&(a=-1),i=this._getSheetCgi(n,r,o,a,e.baseVersion),(c=(0,C.XE)(r))&&(i+="&viewId="+c),f.ZP.run(m.mz.SERVER_LOADER_FETCH_SHEET_CHUNK,["拉子 sheet 首片数据",this._containerID,this.name,this.retryFetchChunkTime,e,o,a]),t.prev=9,t.next=12,_().get(i,{responseType:"json"});case 12:(null===(u=t.sent)||void 0===u?void 0:u.status)>=500&&(f.ZP.run(m.mz.SERVER_LOADER_LOAD_CHUNK_DATA_ERROR,["拉子 sheet 返回分片接口异常 500错误",this._containerID,this.name,e,u.status]),s=!0),t.next=20;break;case 16:t.prev=16,t.t0=t.catch(9),s=!0,f.ZP.run(m.mz.SERVER_LOADER_LOAD_CHUNK_DATA_ERROR,["拉子 sheet 返回分片接口异常",this._containerID,this.name,e,t.t0]);case 20:if(!(s&&this.retryFetchChunkTime<=2)){t.next=25;break}return this.retryFetchChunkTime+=1,t.next=24,this._fetchSheetChunk(e);case 24:u=t.sent;case 25:if(!(this.retryFetchChunkTime>2)){t.next=28;break}throw f.ZP.run(m.mz.SERVER_LOADER_FETCH_SHEET_CHUNK_RETRY_3_TIMES_ERROR,["拉子 sheet 首片数据请求重试 3 次失败",this._containerID,this.name,e]),new Error("切表 get/sheet 请求数据 catch 失败");case 28:return t.abrupt("return",u);case 29:case"end":return t.stop()}}),t,this,[[9,16]])})))},r._setSlicedRowCount=function(e,t){f.ZP.run(m.mz.SERVER_LOADER_SET_SLICE_ROW_COUNT,["设置分片计数器",this._containerID,this.name,e,t]),this.slicedRowCount[e]=t},r._getSlicedRowCount=function(e){return this.slicedRowCount[e]},r._decreaseSlicedRowCount=function(e){this.slicedRowCount[e]-=1,f.ZP.run(m.mz.SERVER_LOADER_DECREASE_SLICED_ROW_COUNT,["分片计数器自减",this._containerID,this.name,e,this.slicedRowCount])},r.getIsAllowSlice=function(){var e=document.getElementsByTagName("script");return Array.prototype.find.call(e,(function(e){return e.src.includes("enableSmartsheetSplit=1")}))},t}(v);L.priority=0;var j=n("../node_modules/@tencent/docs_offline/lib/index.js"),k=function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function a(e){try{c(r.next(e))}catch(t){s(t)}}function i(e){try{c(r.throw(e))}catch(t){s(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,i)}c((r=r.apply(e,t||[])).next())}))},F=function(e){function t(t){var n;return(n=e.call(this,t)||this).priority=1,n}(0,l.Z)(t,e);var r=t.prototype;return r.destroy=function(){this._init()},r.loadDocumentData=function(e){return k(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.work(),t.abrupt("return",new Promise((function(t){return k(n,void 0,void 0,regeneratorRuntime.mark((function n(){var r=this;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:f.ZP.run(m.mz.OFFLINE_LOADER_LOAD_DOCUMENT_DATA,["请求首表数据",this._containerID,e]),j.V0.loadDocumentData({id:e.secretId,subId:e.sheetId,onSuccess:function(n){r._loadDocumentDataSuccess(n,t,e)},onFail:function(n){r._loadDocumentDataFail(t,n,e)}});case 2:case"end":return n.stop()}}),n,this)})))})));case 2:case"end":return t.stop()}}),t,this)})))},r.loadSheetData=function(e){return k(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.work(),t.abrupt("return",new Promise((function(t){return k(n,void 0,void 0,regeneratorRuntime.mark((function n(){var r,o=this;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:f.ZP.run(m.mz.OFFLINE_LOADER_LOAD_SHEET_DATA,["切表/预加载子 sheet",this._containerID,e]),r=location.pathname.replace(/\/sheet\/(history\/)?/,""),j.V0.loadSubDocumentData({subId:e.sheetId,baseVersion:e.baseVersion,id:r,onSuccess:function(n){o._loadSheetDataSuccess(n,t,e)},onFail:function(n){o._loadSheetDataFail(t,n,e)}});case 3:case"end":return n.stop()}}),n,this)})))})));case 2:case"end":return t.stop()}}),t,this)})))},r._loadDocumentDataSuccess=function(e,t,n){var r=e.dataType,o=this.isPause();if(f.ZP.run(m.mz.OFFLINE_LOADER_LOAD_DOCUMENT_DATA_SUCCESS,["首表数据成功回包",this._containerID,r,o]),!o)switch(r){case j.h6.SNAP_SHOT:return this._handleSnapShot(e,n,t);case j.h6.CHUNK:return this._handleChunkData(e,n,t);case j.h6.VERSION_DATA:return this._handleVersionData(e,n,!1,t);default:return}},r._loadDocumentDataFail=function(e,t,n){f.ZP.run(m.mz.OFFLINE_LOADER_LOAD_DOCUMENT_DATA_FAIL,["首表数据请求失败",this._containerID,n.sheetId,t]),e({isSuccess:!1,error:{type:R.Z.LOAD_OFFLINE_DOCUMENT_DATA_FAIL,message:p.ZP.t("offlineLoader 请求 离线 失败")},loader:this})},r._loadSheetDataSuccess=function(e,t,n){return k(this,void 0,void 0,regeneratorRuntime.mark((function r(){return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:f.ZP.run(m.mz.OFFLINE_LOADER_LOAD_SHEET_DATA_SUCCESS,["切表/预加载子 sheet 数据成功回包",this._containerID,n.sheetId,e.dataType]),r.t0=e.dataType,r.next=r.t0===j.h6.SNAP_SHOT?4:r.t0===j.h6.VERSION_DATA?5:6;break;case 4:return r.abrupt("return",this._handleSheetSnapShot(e,n,t));case 5:return r.abrupt("return",this._handleVersionData(e,n,!0,t));case 6:return r.abrupt("return");case 7:case"end":return r.stop()}}),r,this)})))},r._loadSheetDataFail=function(e,t,n){f.ZP.run(m.mz.OFFLINE_LOADER_LOAD_SHEET_DATA_FAIL,["切表/预加载子 sheet 数据请求失败",this._containerID,n.sheetId,t]),e({isSuccess:!1,error:{type:R.Z.LOAD_OFFLINE_SHEET_DATA_FAIL,message:p.ZP.t("请求 离线 sheet 数据失败"),sheetId:n.sheetId},loader:this})},r._init=function(){},r._handleSnapShot=function(e,t,n){var r,o=e.clientVars,s=e.workbookData,a=e.chunkData,i=e.subId,c=e.isFinished,u=(o||{}).collab_client_vars;if(f.ZP.run(m.mz.OFFLINE_LOADER_HANDLE_SNAP_SHOT,["处理首表首片数据",this._containerID,i,null===u||void 0===u?void 0:u.rev,c]),!o||!s||!a)return f.ZP.run(m.mz.OFFLINE_LOADER_HANDLE_SNAP_SHOT_NOT_DATA,["首表首片数据为空",this._containerID,i,!o,!s,!a,c]),this.pause(),n({isSuccess:!1,error:{type:R.Z.LOAD_OFFLINE_DOCUMENT_DATA_FAIL,message:p.ZP.t("离线首屏数据为空，")},loader:this});var d=A(o);return null===(r=t.handleClientVars)||void 0===r||r.call(t,o,d),n({spreadConfig:d,clientVars:o,firstData:[s.data,a.data],sheetId:i,isFinished:!1,loader:this,isSuccess:!0,startRow:a.startRow,endRow:a.endRow})},r._handleChunkData=function(e,t,n){var r,o;return k(this,void 0,void 0,regeneratorRuntime.mark((function s(){var a,i,c;return regeneratorRuntime.wrap((function(s){for(;;)switch(s.prev=s.next){case 0:if(a=e.chunkData,i=e.subId,c=e.isFinished,f.ZP.run(m.mz.OFFLINE_LOADER_HANDLE_CHUNK_DATA,["处理首表分片数据",this._containerID,i,c]),a&&a.data){s.next=6;break}return f.ZP.run(m.mz.OFFLINE_LOADER_HANDLE_CHUNK_DATA_NOT_DATA,["首表分片数据为空",this._containerID,i,c]),null===(r=t.onFail)||void 0===r||r.call(t,{isSuccess:!1,error:{type:R.Z.LOAD_OFFLINE_CHUNK_DATA_FAIL,message:p.ZP.t("离线分片数据为空")}}),s.abrupt("return");case 6:return s.next=8,null===(o=t.onSuccess)||void 0===o?void 0:o.call(t,{isSuccess:!0,chunkData:[a.data],sheetId:i,isFinished:c,isLastChunk:c,startRow:a.startRow,endRow:a.endRow,loader:this});case 8:null===n||void 0===n||n();case 9:case"end":return s.stop()}}),s,this)})))},r._isWorkbookMutation=function(e){for(var t=e.length,n=0;n<t;n++)for(var r=e[n].length,o=0;o<r;o++){var s=e[n][o].r;if(s>=45&&s<=58)return!0}return!1},r._handleVersionData=function(e,t,n,r){var o,s,a;return void 0===n&&(n=!1),k(this,void 0,void 0,regeneratorRuntime.mark((function i(){var c,u,d,l,h,_=this;return regeneratorRuntime.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:if(c=e.chunkData,u=e.isFinished,d=e.subId,c){i.next=5;break}return f.ZP.run(m.mz.OFFLINE_LOADER_HANDLE_VERSION_DATA_ERROR,["增量版本数据格式异常",d,u,n]),null===(o=t.onFail)||void 0===o||o.call(t,{isSuccess:!1,error:{type:R.Z.LOAD_OFFLINE_VERSION_DATA_NULL,message:p.ZP.t("离线 版本数据异常")}}),i.abrupt("return",null===r||void 0===r?void 0:r());case 5:if(l=c.map((function(e){if(n){if(e.subId===d&&!_._isWorkbookMutation(e.data))return e.data}else if(e.subId===d||_._isWorkbookMutation(e.data))return e.data;return[[]]})),h=c.map((function(e){return e.version})),f.ZP.run(m.mz.OFFLINE_LOADER_HANDLE_VERSION_DATA,["处理增量版本数据",this._containerID,d,t.sheetId,c.length,h,n]),n||this.isVersionDataValid(h)){i.next=12;break}return f.ZP.run(m.mz.OFFLINE_LOADER_HANDLE_VERSION_DATA_VERSION_ERROR,["增量版本数据版本不连续",this._containerID,d,n]),null===(s=t.onFail)||void 0===s||s.call(t,{isSuccess:!1,error:{type:R.Z.LOAD_OFFLINE_VERSION_DATA_INVALID,message:p.ZP.t("离线 版本数据异常"),code:"O00001"}}),i.abrupt("return",null===r||void 0===r?void 0:r());case 12:return i.next=14,null===(a=t.onSuccess)||void 0===a?void 0:a.call(t,{isSuccess:!0,chunkData:l,isFinished:u,sheetId:d,loader:this,startRow:null,endRow:null});case 14:null===r||void 0===r||r();case 15:case"end":return i.stop()}}),i,this)})))},r.isVersionDataValid=function(e){if(!e.length)return!0;var t=e.sort((function(e,t){return e-t})),n=t.length,r=t[0];return t[n-1]-r+1===n},r._handleSheetSnapShot=function(e,t,r){var o,s=e.chunkData,a=e.isFinished,i=this.isPause();if(f.ZP.run(m.mz.OFFLINE_LOADER_HANDLE_SHEET_SNAP_SHOT,["处理切表/预加载子 sheet分片数据",this._containerID,t.sheetId,a,i]),!i){var c={startRow:0,endRow:0,isSuccess:!0,sheetId:t.sheetId,chunkData:[],isFinished:a,loader:this};s.forEach((function(e){var r;if(c.chunkData.push(e.data.data||[[]]),a){var o=(null===(r=n.g.SpreadsheetApp.spreadsheet.sheetManager.getSheetBySheetId(t.sheetId))||void 0===r?void 0:r.getRowCount())-1;c.endRow=Math.min(o,e.data.endRow)}else c.endRow=e.data.endRow})),r(c),null===(o=t.onSuccess)||void 0===o||o.call(t,c)}},t}(v);F.priority=1;var M=n("../node_modules/@tencent/containerized/build/main/index.js"),H=(n("../node_modules/core-js/modules/es.number.is-integer.js"),n("../node_modules/core-js/modules/es.object.values.js"),n("../node_modules/core-js/modules/es.object.keys.js"),function(){function e(){this.store={},this.curPriorityIndex=-1}var t=e.prototype;return t.add=function(e,t){if(t<0||!Number.isInteger(t))throw new Error("priority 必须是非负整数");this.store[t]||(this.store[t]=[]),this.store[t].push(e)},t.next=function(){return this.curPriorityIndex+=1,this.store[this.prioritySet[this.curPriorityIndex]]},t.destroy=function(){this.curPriorityIndex=-1,Object.values(this.store).forEach((function(e){e.forEach((function(e){var t;null===(t=e.destroy)||void 0===t||t.call(e)}))}))},(0,u.Z)(e,[{key:"prioritySet",get:function(){return Object.keys(this.store).map((function(e){return Number(e)}))}}]),e}()),U=function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function a(e){try{c(r.next(e))}catch(t){s(t)}}function i(e){try{c(r.throw(e))}catch(t){s(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,i)}c((r=r.apply(e,t||[])).next())}))},V=function(e){function t(){var t;(t=e.call(this)||this).loadersStore=new H,t.errorLoaderCount=0,t.destroy=function(){t.init(),t.loadersStore.destroy()};var r=new L({name:a.SERVER});if(t.loadersStore.add(r,L.priority),n.g.__SUPPORT_FULL_OFFLINE_MODE){var o=new F({name:a.OFFLINE});t.loadersStore.add(o,F.priority)}return t.init(),t._register((0,M.OF)(t.destroy)),t}(0,l.Z)(t,e);var r=t.prototype;return r.loadDocumentData=function(e){var t;return U(this,void 0,void 0,regeneratorRuntime.mark((function n(){var r,o,s;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:r=!1;case 1:if((s=this.loadersStore.next())&&0!==s.length){n.next=4;break}return n.abrupt("break",11);case 4:return n.next=6,this.loadDocumentDataByCompetition(s,e);case 6:if(!(o=n.sent).isSuccess){n.next=9;break}return n.abrupt("break",11);case 9:r=!!(null===(t=o.error)||void 0===t?void 0:t.isTryLowerPriorityLoader);case 10:if(r){n.next=1;break}case 11:return n.abrupt("return",o);case 12:case"end":return n.stop()}}),n,this)})))},r.loadSheetData=function(e){return U(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.firstSuccessComeBackLoader.loadSheetData(e);case 2:if(!(null===(n=t.sent)||void 0===n?void 0:n.isSuccess)){t.next=5;break}return t.abrupt("return",n);case 5:case"end":return t.stop()}}),t,this)})))},r.loadDocumentDataByCompetition=function(e,t){return U(this,void 0,void 0,regeneratorRuntime.mark((function n(){var r=this;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",new Promise((function(n,o){r.errorLoaderCount=0;for(var s=0;s<e.length;s++)e[s].loadDocumentData(t).then((function(t){return t.isSuccess?(r.firstSuccessComeBackLoader||(r.firstSuccessComeBackLoader=t.loader),r.pauseOtherLoader(e),n(t)):(r.errorLoaderCount+=1,r.errorLoaderCount===e.length?n(t):void 0)})).catch((function(e){o(e)}))})));case 1:case"end":return n.stop()}}),n)})))},r.init=function(){this.errorLoaderCount=0,this.firstSuccessComeBackLoader=void 0},r.pauseOtherLoader=function(e){if(this.firstSuccessComeBackLoader){var t=this.firstSuccessComeBackLoader.name;e.forEach((function(e){e.name!==t&&e.pause()}))}},t}(M.JT),Z=n("../spread-sheet/src/base/event/event.ts"),G=n("../spread-sheet/src/core/data/converter/tencentdoc/keyframeToSheetConverter.ts"),B=n("../packages/mutation/src/other/InitDataMutation.ts"),W=n("../spread-sheet/src/core/data/converter/tencentdoc/doMutation.ts"),K=n("../packages/model/src/index.ts"),Y=n("../spread-sheet/src/core/app/SpreadsheetApp.interface.ts");function z(){var e=(0,c.IZ)("title",n.g.__originUrl);return e&&(e=decodeURIComponent(e)),e}var X=n("../spread-sheet/src/base/error/errorCodeModalProxy.ts"),q=n("../node_modules/@tencent/tencent_doc_open_url/dist/index.js"),J=n("../spread-sheet/src/external/view/mobile/header/native-header/api.ts"),Q=n("../spread-sheet/src/external/view/mobile/header/native-header/utils.ts");function $(e,t){var r,o=location.pathname.replace(/\/sheet\/(history\/)?/,"");try{(0,Q.W)()&&J.n.hideButtonsBeforeJump();var s={};s[o]=3===e&&t?t:4===e?{padType:"blankpage",clientVars:{type:7}}:{padType:"blankpage",clientVars:{}},s[o].sourcePadType="sheet",s[o].sourceType=e,s[o]._openDocStartTime=window._openDocStartTime,s[o]._openDocEndTime=window._openDocEndTime;var a=JSON.stringify(s),i=location.href.replace("/sheet/","/blankpage/");null===(r=n.g.log)||void 0===r||r.warn("跳转到空白页 setBlankPageData",i,a),localStorage.setItem("blankPageData",a),setTimeout((function(){(0,q.tencentDocOpenUrlForAll)({url:i,replace:!0})}),300)}catch(c){throw c}}n("../spread-sheet/src/base/util/domain-config.ts");var ee=n("../node_modules/@tencent/docs-multi-tools/dist/index.js");function te(e){var t=e.error;if(t)switch(t.type){case R.Z.OPEN_DOC_BLANK_PAGE_FORBIDDEN_RETRY:case R.Z.OPEN_DOC_BLANK_PAGE_ERROR_MAX_RETRY:case R.Z.OPEN_DOC_NOT_200_ERROR_MAX_RETRY:case R.Z.OPEN_DOC_AXIOS_ERROR:case R.Z.OPEN_DOC_PAD_NO_EXIST:return $(3,t.data);case R.Z.OPEN_DOC_JSON_PARSE_ERROR:return $(2);case R.Z.OPEN_DOC_PAD_TYPE_ERROR:return location.replace(location.href.replace("/sheet/","/doc/"));case R.Z.OPEN_DOC_ERROR_UNKNOWN:default:return $(1)}}function ne(e){switch(Z.ZP.default.trigger("afterLoadData",{sheetId:e.sheetId}),e.type){case R.Z.LOAD_ONLINE_DOCUMENT_DATA_FAIL:oe("D",e.code),f.ZP.monitor(34871108);break;case R.Z.LOAD_ONLINE_SHEET_DATA_FAIL:oe("C",e.code),f.ZP.monitor(33701441);break;case R.Z.LOAD_ONLINE_SHEET_DATA_CATCH_ERROR:f.ZP.monitor(34871107);break;case R.Z.LOAD_OFFLINE_DOCUMENT_DATA_FAIL:case R.Z.LOAD_OFFLINE_CHUNK_DATA_FAIL:case R.Z.LOAD_OFFLINE_SHEET_DATA_FAIL:break;case R.Z.LOAD_OFFLINE_VERSION_DATA_NULL:f.ZP.run(m.mz.LOAD_OFFLINE_VERSION_DATA_NULL);break;case R.Z.LOAD_OFFLINE_VERSION_DATA_INVALID:f.ZP.run(m.mz.LOAD_OFFLINE_VERSION_DATA_INVALID),j.V0.clearDocumentCache(location.pathname.replace("/sheet/",""),(0,ee.getUid)())}f.ZP.run(m.mz.LOAD_ERROR,[e.sheetId,e.message,e.error],e.type)}var re={LOAD_ERROR:p.ZP.t("无法加载表格，我们对此引起的不便表示抱歉，你可以尝试刷新重试或反馈，帮助我们改善体验。"),SERVICE_ERROR:p.ZP.t("服务异常，我们对此引起的不便表示抱歉，你可以尝试刷新重试或反馈，帮助我们改善体验。"),REFER_ERROR:p.ZP.t("Refer来源发生变化，请检查请求来源。"),TIMEOUT:p.ZP.t("服务超时，我们对此引起的不便表示抱歉，你可以尝试刷新重试或反馈，帮助我们改善体验。"),UNKNOWN_ERROR:p.ZP.t("未知错误，我们对此引起的不便表示抱歉，你可以尝试刷新重试或反馈，帮助我们改善体验。"),QUERY_ERROR:p.ZP.t("文档信息查询失败，我们对此引起的不便表示抱歉，你可以尝试刷新重试或反馈，帮助我们改善体验。")};function oe(e,t){var r;switch(t){case"1":try{null===(r=null===n.g||void 0===n.g?void 0:n.g.localStorage)||void 0===r||r.clear()}catch(o){console.error("清除localStorage失败",o)}X.Z.server.showRefreshTips(e+"-"+t,re.LOAD_ERROR,!0);break;case"100000":case"200105":case"200700":X.Z.client.showLoginExpiredTip(e+"-"+t);break;case"100003":X.Z.server.showRefreshTips(e+"-"+t,re.SERVICE_ERROR,!0);break;case"100010":X.Z.server.showRefreshTips(e+"-"+t,re.REFER_ERROR);break;case"100012":X.Z.server.showRefreshTips(e+"-"+t,re.TIMEOUT,!0);break;case"111111":X.Z.server.showRefreshTips(e+"-"+t,re.UNKNOWN_ERROR,!0);break;case"200026":X.Z.server.showRefreshTips(e+"-"+t,re.QUERY_ERROR,!0);break;case"200040":X.Z.server.showRefreshTips(e+"-"+t,re.LOAD_ERROR,!0);break;case"200109":X.Z.server.showFileDeletedTip(e+"-"+t);break;default:X.Z.server.showRefreshTips(e+"-"+(t||"000"),re.LOAD_ERROR,!0)}}var se,ae,ie,ce=n("../spread-sheet/src/base/util/appConfig.ts"),ue=n("../packages/model/src/sheet/SheetType.ts"),de=n("../spread-sheet/src/core/feature/formula/calcControllerTaskQueue.ts"),le=n("../packages/mutation/src/index.ts"),pe=n("../node_modules/lodash/mean.js"),he=n.n(pe),_e=function(e,t,n,r){var o,s=arguments.length,a=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var i=e.length-1;i>=0;i--)(o=e[i])&&(a=(s<3?o(a):s>3?o(t,n,a):o(t,n))||a);return s>3&&a&&Object.defineProperty(t,n,a),a},fe=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},me=function(e,t){return function(n,r){t(n,r,e)}},ve=function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function a(e){try{c(r.next(e))}catch(t){s(t)}}function i(e){try{c(r.throw(e))}catch(t){s(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,i)}c((r=r.apply(e,t||[])).next())}))},Ee=function(e){function t(t,r){var o;return(o=e.call(this)||this).getBaseVersion=t,o.app=r,o.loaderManager=new V,o.loadSheetDataCallbackMap={},o.isLocateScroll=!1,o.sheetChunkDataListMap=new Map,o.applyStatusCache={isChunkApplying:!1,taskChunkTimes:[],splitChunkLen:[]},o.startApplyChunkData=function(){return ve((0,d.Z)(o),void 0,void 0,regeneratorRuntime.mark((function e(){var t,r,o,s,a,i,c,u,d,l,p,h,_,f,m,v,E,g,R;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.applyStatusCache.isChunkApplying){e.next=2;break}return e.abrupt("return");case 2:if(i=this.getPrioritySheetId()){e.next=5;break}return e.abrupt("return");case 5:if(c=null===(t=this.sheetChunkDataListMap.get(i))||void 0===t?void 0:t.shift()){e.next=8;break}return e.abrupt("return");case 8:u=this.app.spreadsheet.sheetManager.getSheetBySheetId(i),this.applyStatusCache.isChunkApplying=!0,d=c,l=40,p=201,h=30;case 14:if(!(null===(r=null===d||void 0===d?void 0:d.chunkData)||void 0===r?void 0:r.length)){e.next=30;break}if(_=Math.round(he()(this.applyStatusCache.splitChunkLen))||p,f=Math.round(he()(this.applyStatusCache.taskChunkTimes))||l,m=(m=this.applyStatusCache.taskChunkTimes.length?Math.round(_*l/f):_)>h?m:h+1,v=this.splitChunkData(d,m),E=v[0],!(null===(o=null===E||void 0===E?void 0:E.chunkData)||void 0===o?void 0:o.length)){e.next=27;break}return e.next=24,this.handleMutationLazy(E,this.app.getDidEditable());case 24:g=e.sent,this.applyStatusCache.taskChunkTimes.push(Number(g)),this.applyStatusCache.splitChunkLen.push(m);case 27:d=v[1];case 28:e.next=14;break;case 30:return 0===c.startRow&&this.triggerLoadSheetFirstDataSuccessCallback((null===c||void 0===c?void 0:c.sheetId)||""),R=SpreadsheetApp.initOptions.activeSheetId===c.sheetId,c.isLastChunk&&!(null===(s=null===d||void 0===d?void 0:d.chunkData)||void 0===s?void 0:s.length)&&(this.handleLoadEnd(u,{isInit:R}),this.triggerLoadSheetDataFinishCallback((null===c||void 0===c?void 0:c.sheetId)||""),null===(a=n.g.log)||void 0===a||a.info("[分片加载] 分片执行结束，执行情况：",this.applyStatusCache)),i!==this.app.spreadsheet.getActiveSheetId()||this.isLocateScroll||(this.isLocateScroll=this.app.view.setSheetScroll(i)),this.applyStatusCache.isChunkApplying=!1,e.next=37,this.startApplyChunkData();case 37:case"end":return e.stop()}}),e,this)})))},o.getPrioritySheetId=function(){var e,t,n=o.app.spreadsheet,r=n.activeSheetId,s=n.activeSheet;if((null===(e=o.sheetChunkDataListMap.get(r))||void 0===e?void 0:e.length)&&Number(null===(t=o.sheetChunkDataListMap.get(r))||void 0===t?void 0:t[0].startRow)<=Number(null===s||void 0===s?void 0:s.highWaterMark.getMark())+1)return r;var a=Array.from(o.sheetChunkDataListMap).find((function(e){var t,n=e[0],r=e[1],s=o.app.spreadsheet.sheetManager.getSheetBySheetId(n),a=Number(null===(t=r[0])||void 0===t?void 0:t.startRow);return r.length>0&&a<=Number(null===s||void 0===s?void 0:s.highWaterMark.getMark())+1}));return null===a||void 0===a?void 0:a[0]},o.splitChunkData=function(e,t){var n=[],r=e.chunkData;return null===r||void 0===r||r.forEach((function(r){r.forEach((function(r){r.forEach((function(r){if(r.t!==le.xF.SET_RANGE_MUTATION&&r.id!==le.xF.SET_RANGE_MUTATION)return[];for(var s=r instanceof le.qi?r:o.app.mutationBehavior.deserializeMutation(r),a=s.gridRange,i=a.startRowIndex,c=a.endRowIndex,u=a.sheetId,d=a.startColIndex,l=a.endColIndex,p=s.id,h=s.operationType,_=s.requestId,f=s.version,m=function(r){var o=r,a=r+t>c||r>i?c:r+t-1,m={gridRange:new K.Range.GridRange(u,o,a,d,l),cellDataDeltaAtPositions:s.cellDataDeltaAtPositions.filter((function(e){return e.rowIndex<=a&&e.rowIndex>=o})),id:p,operationType:h,requestId:_,version:f},E=new le.qi(m);n.push(Object.assign({},e,{sheetId:u,startRow:o,endRow:a},{chunkData:[[[E]]]})),v=r+=t},v=i;v<=i+t+1&&v<=c;)m(v)}))}))})),n},o.setAsyncSliceScheduler=function(e,t){var n=t.sheetId;return ve((0,d.Z)(o),void 0,void 0,regeneratorRuntime.mark((function t(){var r,o,s,a=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.sheetChunkDataListMap.get(n)||this.sheetChunkDataListMap.set(n,[]),null===(r=this.sheetChunkDataListMap.get(n))||void 0===r||r.push(e),s=null===(o=this.sheetChunkDataListMap.get(n))||void 0===o?void 0:o.sort((function(e,t){return Number(e.startRow)-Number(t.startRow)})),this.sheetChunkDataListMap.set(n,s||[e]),t.next=6,this.startApplyChunkData();case 6:clearInterval(this.applyChunkInterval),this.applyChunkInterval=setInterval((function(){return ve(a,void 0,void 0,regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(null===(t=Array.from(this.sheetChunkDataListMap).filter((function(e){var t=e[1];return(null===t||void 0===t?void 0:t.length)>0})))||void 0===t?void 0:t.length)||clearInterval(this.applyChunkInterval),e.next=3,this.startApplyChunkData();case 3:case"end":return e.stop()}}),e,this)})))}),1e3);case 8:case"end":return t.stop()}}),t,this)})))},o.applyChunkImmediate=function(e,t){var n=t.sheetId,r=t.isInit,s=t.sheet;(0,W.zf)(o.app.spreadsheet,e.chunkData,{sheetId:e.sheetId,startRowIndex:e.startRow,endRowIndex:e.endRow,rowCount:null===e||void 0===e?void 0:e.maxRow,colCount:null===e||void 0===e?void 0:e.maxCol},o.app.getDidEditable(),0===e.startRow),0===e.startRow&&o.triggerLoadSheetFirstDataSuccessCallback(n),e.isFinished&&(o.applyStatusCache.taskChunkTimes=[],o.applyStatusCache.splitChunkLen=[],o.handleLoadEnd(s,{isInit:r}),o.triggerLoadSheetDataFinishCallback(n))},o._containerID=n.g.containerID,o}(0,l.Z)(t,e);var o=t.prototype;return o.destroy=function(){var t;e.prototype.dispose.call(this),null===(t=n.g.log)||void 0===t||t.debug("flow DataCenter destroy()"),this.loaderManager.destroy()},o.loadDocumentData=function(e){var t,o,s,i,u,d,l;return ve(this,void 0,void 0,regeneratorRuntime.mark((function h(){var _,f,v,E,S,w,T,y,I,O,D,b,C;return regeneratorRuntime.wrap((function(h){for(;;)switch(h.prev=h.next){case 0:if(null===(t=n.g.log)||void 0===t||t.info("datacenter loadDocumentData()",e),_=e.secretId,f=e.sheetId,v=e.onSuccess,E="true"===(0,c.IZ)("new",n.g.__originUrl),"D0000000000000001"!==_&&!E){h.next=18;break}return S=g.c2.firstChunkEndRow,w=g.c2.rowCount,T="D0000000000000001"===_?"300000000$A00000000001":"300000000$"+atob(_.substr(1)),y=z(),I=(0,g.zV)({globalPadId:T,secretId:_,uid:(0,ee.getUid)(),title:y,isLocalNewFile:E}),O=I.collab_client_vars.sheetId,(0,c.oW)(location.href,["new","isShareme","folder","isOnlineBorrowed"]),(D=A(I)).setConfig({isNewDoc:E}),n.g.spreadConfig=D,n.g.clientVars=I,b={sheetId:O,clientVars:I,spreadConfig:D,firstData:[[[]]],isFinished:!0,isLastChunk:!0,startRow:0,endRow:S},x.Z.wait(0).run((function(){null===v||void 0===v||v({isSuccess:!0,startRow:S+1,endRow:w-1,chunkData:[[[]]],sheetId:O,isFinished:!0,isLastChunk:!0})})),h.abrupt("return",b);case 18:return h.prev=18,h.next=21,this.loaderManager.loadDocumentData(e);case 21:if(C=h.sent,(null===(o=this.loaderManager.firstSuccessComeBackLoader)||void 0===o?void 0:o.name)===a.OFFLINE&&this.app.setDidEditable(!1),Z.ZP.default.trigger("startLoadData",{sheetId:C.sheetId}),C.isSuccess&&!C.error){h.next=30;break}return(0,ce.z)(),null===(s=n.g.log)||void 0===s||s.error("datacenter.loadDocumentData() error",C),te(C),m.CL.loadDocumentDataFail(C.error),h.abrupt("return",Promise.reject(r.LOAD_DOCUMENT_DATA_ERROR));case 30:return null===(i=n.g.log)||void 0===i||i.debug("flow DataCenter loadDocumentData response",C.spreadConfig,null===(u=C.loader)||void 0===u?void 0:u.name),null===(d=n.g.log)||void 0===d||d.info("loadDocumentData Success"),h.abrupt("return",C);case 35:return h.prev=35,h.t0=h.catch(18),null===(l=n.g.log)||void 0===l||l.error("flow DataCenter.loadDocumentData()",null===h.t0||void 0===h.t0?void 0:h.t0.stack),ne({sheetId:f,code:"1",type:R.Z.LOAD_ONLINE_DOCUMENT_DATA_FAIL,error:h.t0,message:p.ZP.t("数据拉取失败")}),m.CL.loadDocumentDataFail(h.t0),h.abrupt("return",Promise.reject(r.LOAD_DOCUMENT_DATA_ERROR));case 41:case"end":return h.stop()}}),h,this,[[18,35]])})))},o.loadSheetData=function(e,t){var r,o=this,s=e.sheetId,i=e.onFirstChunkSuccess,c=e.onFinished,u=e.onFail,d=e.sheetType,l=void 0===d?ue.ZP.GRID:d,p=this.app.spreadsheet.sheetManager.getSheetBySheetId(s);if(null===(r=n.g.log)||void 0===r||r.info("flow DataCenter.loadSheetData()",e,p.isLoaded,p.isFetching),p.isLoaded)return null===i||void 0===i||i(p.getSheetId()),void(null===c||void 0===c||c(p.getSheetId()));if(this.addLoadSheetDataCallback(s,{onFirstChunkSuccess:i,onFinished:c,onFail:u}),p.isFetching)this.app.spreadsheet.activeSheetId!==s&&p.highWaterMark.getMark()>0&&(null===i||void 0===i||i(p.getSheetId()));else{Z.ZP.default.trigger("startLoadData",{sheetId:s});try{null===p||void 0===p||p.startLoading(),this.loaderManager.loadSheetData(Object.assign(Object.assign({},e),{sheetType:l,baseVersion:this.getBaseVersion(),onSuccess:function(e){var n;(null===(n=e.loader)||void 0===n?void 0:n.name)===a.OFFLINE&&o.app.setDidEditable(!1),o.applyChunkData(e,{isSlice:t})},onFail:function(e){var t=e.error;o.triggerLoadSheetDataFailCallback(s,e),ne({type:t.type,message:t.message,sheetId:s,code:t.code})}}))}catch(_){null===p||void 0===p||p.stopLoading(!1);var h={sheetId:s,type:R.Z.LOAD_ONLINE_DOCUMENT_DATA_FAIL,code:"3",message:"loaderManager.loadSheetData catch error",error:_};this.triggerLoadSheetDataFailCallback(s,h),ne(h)}}},o.applyChunkData=function(e,t){var r,o;return void 0===t&&(t={}),ve(this,void 0,void 0,regeneratorRuntime.mark((function s(){var i,c,u,d,l,p,h;return regeneratorRuntime.wrap((function(s){for(;;)switch(s.prev=s.next){case 0:if(i=e.sheetId,u=(c=t).isSlice,d=c.isInit,(l=this.app.spreadsheet.sheetManager.getSheetBySheetId(i))&&i){s.next=6;break}return null===(r=n.g.log)||void 0===r||r.info("flow DataCenter.applyChunkData  sheet not found.",i,t),s.abrupt("return");case 6:if(e.chunkData){s.next=8;break}return s.abrupt("return");case 8:if(!l.isExternalSheet()){s.next=15;break}return p=l.getSheetType(),null===(h=this.app.sheetAdapterManager.getAdapterBySheetType(p))||void 0===h||h.applySheetData(i,e),0===e.startRow&&this.triggerLoadSheetFirstDataSuccessCallback(i),e.isFinished&&(this.handleLoadEnd(l,{isInit:d}),this.triggerLoadSheetDataFinishCallback(i)),s.abrupt("return");case 15:if(!this.app.getDidEditable()&&this.app.view.canvas.inputManager.inputable&&(this.app.view.canvas.inputManager.inputable=!1,this.app.sheetStatus.frozenStatus.isActive||this.app.permissions.activeFrozen((function(){var e;null===(e=n.g.log)||void 0===e||e.log("applyChunkData() 打开阶段不允许的编辑的情况")}))),u&&0!==e.startRow&&(null===(o=e.loader)||void 0===o?void 0:o.name)!==a.OFFLINE){s.next=19;break}return this.applyChunkImmediate(e,{sheetId:i,isInit:!!d,sheet:l}),s.abrupt("return");case 19:this.setAsyncSliceScheduler(e,{sheetId:i});case 20:case"end":return s.stop()}}),s,this)})))},o.handleLoadEnd=function(e,t){var r,o,s,a=(void 0===t?{}:t).isInit;return ve(this,void 0,void 0,regeneratorRuntime.mark((function t(){var i,c,u,d,l,p,h,_,f,m=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(i=e.getSheetId(),null===(r=n.g.log)||void 0===r||r.info("DataCenter handleLoadEnd:",i,a),e.stopLoading(),c=function(){m.transformSheetInWorker(i),Z.ZP.default.trigger("afterLoadData",{sheetId:i})},a){t.next=16;break}if(u=Array.from(this.sheetChunkDataListMap).some((function(e){var t,n=e[0];return null===(t=m.app.spreadsheet.sheetManager.getSheetBySheetId(n))||void 0===t?void 0:t.isFetching})),u||(this.app.setDidEditable(!0),this.app.view.canvas.inputManager.inputable=!0,this.app.permissions.unActiveFrozen()),null===(o=this.app.mainThreadWorker.sheetData)||void 0===o?void 0:o.isSheetDataReady){t.next=14;break}return d=this.app.initOptions,l=d.sheetList,p=d.spreadsheetId,h=d.baseVersion,_=d.workbookRanges,f=void 0===_?[]:_,t.next=11,null===(s=this.app.mainThreadWorker.sheetData)||void 0===s?void 0:s.initSpreadsheetApp({activeSheetId:e.getSheetId(),header:l,spreadsheetId:p,title:e.getTitle(),waitForFormulaLayerToBeInitialized:!0,baseVersion:h,workbookRanges:f});case 11:c(),t.next=16;break;case 14:c(),console.info("[分片加载]-切表加载完成时worker已同数据","transformSheetInWorker");case 16:case"end":return t.stop()}}),t,this)})))},o.transformSpreadsheet=function(e,t,n,r){var o=e.getSheetId();return(0,G.Z)(this.app.spreadsheet,o,t,n,r),this.transformSheetInWorker(o),e},o.updateSheetData=function(e){var t=this.app.spreadsheet.sheetManager.getSheetBySheetId(e);if(t){var n=new B.Z({sheetId:t.getSheetId(),lastRow:t.getRowCount()-1,lastCol:t.getColCount()-1});t.spreadsheetReference.parent.mutationBehavior.applyMutation(n,{isLocal:!0},t)}},o.addLoadSheetDataCallback=function(e,t){this.loadSheetDataCallbackMap[e]||(this.loadSheetDataCallbackMap[e]=[]),this.loadSheetDataCallbackMap[e].push(t)},o.triggerLoadSheetFirstDataSuccessCallback=function(e){var t;null===(t=this.loadSheetDataCallbackMap[e])||void 0===t||t.forEach((function(e){var t;null===(t=e.onFirstChunkSuccess)||void 0===t||t.call(e)}))},o.triggerLoadSheetDataFinishCallback=function(e){var t,r;null===(t=this.loadSheetDataCallbackMap[e])||void 0===t||t.forEach((function(e){var t;null===(t=e.onFinished)||void 0===t||t.call(e)})),this.loadSheetDataCallbackMap[e]=void 0,null===(r=n.g.log)||void 0===r||r.info("[分片加载] 分片应用完成 triggerLoadSheetDataFinishCallback")},o.triggerLoadSheetDataFailCallback=function(e,t){var n;null===(n=this.loadSheetDataCallbackMap[e])||void 0===n||n.forEach((function(e){var n;null===(n=e.onFail)||void 0===n||n.call(e,t)})),this.loadSheetDataCallbackMap[e]=void 0},o.transformSheetInWorker=function(e){(0,this.app.getCurrentMainThreadWorker().loadSheetToWorkerIfNeeded)(e)||this.triggerSetSheetInitializedForSwitchSheet(e)},o.triggerSetSheetInitializedForSwitchSheet=function(e){var t=function(){Z.ZP.default.trigger("setSheetInitializedForSwitchSheet",{sheetId:e})};this.app.calcController?t():(0,de.gI)(t)},o.handleMutationLazy=function(e,t){var n=this,r=e.sheetId,o=e.chunkData,s=e.startRow,a=e.endRow,i=e.maxRow,c=e.maxCol;return new Promise((function(e){setTimeout((function(){var u=Date.now();(0,W.zf)(n.app.spreadsheet,o,{sheetId:r,startRowIndex:s,endRowIndex:a,rowCount:i,colCount:c},t),e(Date.now()-u)}),5)}))},(0,u.Z)(t,[{key:"containerID",get:function(){return this._containerID}}]),t}(M.JT);Ee=_e([me(1,Y.m),fe("design:paramtypes",["function"===typeof(se="undefined"!==typeof Function&&Function)?se:Object,"function"===typeof(ae="undefined"!==typeof Y.m&&Y.m)?ae:Object])],Ee),function(e){e.LOAD_DOCUMENT_DATA_ERROR="LOAD_DOCUMENT_DATA_ERROR"}(ie||(ie={}));var ge=(0,M.yh)("IDataCenter"),Re=n("../spread-sheet/src/core/app/permissions/index.ts"),Se=n("../spread-sheet/src/core/app/sheetStatus/index.ts"),Ae=n("../packages/mutation/src/api.interface.ts"),we=n("../spread-sheet/src/base/config/report.ts"),Te=n("../spread-sheet/src/base/event/eventName.ts"),ye=n("../spread-sheet/src/core/app/utils.ts"),Ie=n("../packages/model/src/spreadsheet/Spreadsheet.interface.ts"),Oe=n("../node_modules/@tencent/tdocs_support_bridge/lib/index.js");n("../node_modules/core-js/modules/es.array.join.js");var De={PC:{F_Init_App_Service_START:49,F_Init_Spreadsheet_App_START:50,F_Init_Emitter_END:51,F_Init_Listen_Life_Cycle_START:52,F_Init_Core_Service_START:53,F_Init_SDK_Core_START:55,F_Init_Speed_Report_Event_START:56,F_Init_Sheet_Status_END:57,F_Init_Permissions_END:58,F_Init_Spreadsheet_END:59,F_Init_Mutation_Behavior_END:60,F_Init_Event_START:61,F_Init_Data_Center_START:62,F_Get_Document_Data_START:64,F_Init_Data_START:65,F_Update_Spreadsheet_START:66,F_Set_Inited_END:67,F_Init_Part_Interactable_START:69,F_Init_Title_Dom_START:70,F_Init_Canvas_Dom_START:71,F_Init_View_START:72,F_Init_Worker_START:77,F_Init_Main_Thread_Worker_END:79,F_Init_Calc_Controller_END:81,F_Init_Network_Status_END:86,F_Init_MessageCenter_END:87,F_Init_Offline_Edit_END:89,F_On_All_Chunk_Ready_START:90,F_Init_Spreadsheet_App_In_Worker_START:91,F_Init_Editable_START:94,F_Init_Undo_Redo_Stack_START:95,F_Init_Service_Collection_START:98,F_Init_Tools_START:117,F_Init_Plugins_START:118,F_Init_Core_Sheet_START:119,F_Init_Feature_START:120,F_Init_Error_Code_START:121,F_Init_UI_Manager_START:122,F_Init_Title_Sync_START:123,F_Init_Full_Member_START:124,F_Init_Record_Modal_START:125,F_Init_User_Guide_START:126,F_Init_Report_START:127,F_Init_Error_Code_Modal_START:128,F_Init_Range_Auth_START:129,F_Init_Preview_START:130,F_Init_File_START:131,F_Init_Reset_Location_START:132,F_Init_Mention_START:133,F_Init_Work_Bench_START:137,F_Init_Sheetbar_START:138,F_Load_Toc_Config_LOADED:139,F_Load_Toc_Config_START:140},MOBILE:{F_Init_App_Service_START:58,F_Init_Spreadsheet_App_START:59,F_Init_Emitter_END:60,F_Init_Listen_Life_Cycle_START:61,F_Init_Core_Service_START:62,F_Init_Document_Manager_END:63,F_Init_SDK_Core_START:65,F_Init_Speed_Report_Event_START:66,F_Init_Sheet_Status_END:67,F_Init_Permissions_END:68,F_Init_Spreadsheet_END:69,F_Init_Mutation_Behavior_END:70,F_Init_Event_START:71,F_Init_Data_Center_START:72,F_Get_Document_Data_START:74,F_Init_Data_START:75,F_Update_Spreadsheet_START:76,F_Set_Inited_END:77,F_Init_Part_Interactable_START:79,F_Init_Title_Dom_START:80,F_Init_Canvas_Dom_START:81,F_Init_View_START:82,F_Init_Worker_START:87,F_Init_Main_Thread_Worker_END:89,F_Init_Calc_Controller_END:91,F_Init_Network_Status_END:96,F_Init_MessageCenter_END:97,F_Init_Offline_Edit_END:99,F_Init_Editable_START:102,F_Init_Undo_Redo_Stack_START:103,F_On_All_Chunk_Ready_START:105,F_Init_Spreadsheet_App_In_Worker_START:106,F_Init_Service_Collection_START:108,F_Document_Manager_onReady_START:110,F_Init_Start_Init_Mobile_Plugins_START:111,F_Init_Tools_START:112,F_Init_Feature_END:113,F_Init_File_END:114,F_Init_Plugins_END:115,F_Document_Manager_replaceUrl:116},PAD:{F_Init_App_Service_START:58,F_Init_Spreadsheet_App_START:59,F_Init_Emitter_END:60,F_Init_Listen_Life_Cycle_START:61,F_Init_Core_Service_START:62,F_Init_Document_Manager_END:63,F_Init_SDK_Core_START:65,F_Init_Speed_Report_Event_START:66,F_Init_Sheet_Status_END:67,F_Init_Permissions_END:68,F_Init_Spreadsheet_END:69,F_Init_Mutation_Behavior_END:70,F_Init_Event_START:71,F_Init_Data_Center_START:72,F_Get_Document_Data_START:74,F_Init_Data_START:75,F_Update_Spreadsheet_START:76,F_Set_Inited_END:77,F_Init_Part_Interactable_START:79,F_Init_Title_Dom_START:80,F_Init_Canvas_Dom_START:81,F_Init_View_START:82,F_Init_Worker_START:87,F_Init_Main_Thread_Worker_END:89,F_Init_Calc_Controller_END:91,F_Init_Network_Status_END:96,F_Init_MessageCenter_END:97,F_Init_Offline_Edit_END:99,F_Init_Editable_START:102,F_Init_Undo_Redo_Stack_START:103,F_Init_Service_Collection_START:106,F_Start_Init_Pad_Plugins_START:108,F_Init_Tools_START:109,F_On_All_Chunk_Ready_START:110,F_Init_Spreadsheet_App_In_Worker_START:111,F_Document_Manager_onReady_START:112,F_Document_Manager_replaceUrl:117}},be=n("../spread-sheet/src/core/login/index.ts"),Ce=n("../spread-sheet/src/core/user-info/index.ts"),xe=n("../spread-sheet/src/flow/browser/phase/services/sheetLifecyle.interface.ts"),Ne=n("../spread-sheet/src/core/view-manager/index.ts"),Pe=n("../spread-sheet/src/external/sheet-adapter/sheet-adapter-manager.interface.ts"),Le=n("../spread-sheet/src/external/tencentMeeting/report.ts"),je=n("../spread-sheet/src/core/ark-extensions/index.ts"),ke=n("../spread-sheet/src/core/doc-info/index.ts"),Fe=n("../spread-sheet/src/base/util/url.ts"),Me=n("../spread-sheet/src/core/view/level-2/discussion-ent/utils.ts"),He=n("../spread-sheet/src/core/script-loader/index.ts"),Ue=n("../node_modules/lodash/flattenDeep.js"),Ve=n.n(Ue),Ze=n("../packages/mutation/src/MutationId.ts"),Ge=n("../spread-sheet/src/base/report/core-link-reporter.ts"),Be=n("../spread-sheet/src/base/log/production-log.ts");function We(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){if(e){if("string"===typeof e)return Ke(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Ke(e,t):void 0}}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0;return function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Ke(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Ye,ze,Xe,qe,Je,Qe,$e,et,tt,nt=function(e,t,n,r){var o,s=arguments.length,a=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var i=e.length-1;i>=0;i--)(o=e[i])&&(a=(s<3?o(a):s>3?o(t,n,a):o(t,n))||a);return s>3&&a&&Object.defineProperty(t,n,a),a},rt=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},ot=function(e,t){return function(n,r){t(n,r,e)}},st=function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function a(e){try{c(r.next(e))}catch(t){s(t)}}function i(e){try{c(r.throw(e))}catch(t){s(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,i)}c((r=r.apply(e,t||[])).next())}))};function at(){var e=location.href;return new URL(e).pathname.split("/").pop()||""}function it(){return(0,c.IZ)("tab")||"BB08J2"}var ct=function(){function e(e,t,r,o,s,a,i,c,u){var d=this;this.app=e,this.instantiationService=t,this.sheetStatus=r,this.permissions=o,this.spreadsheet=s,this.mutationBehavior=a,this.sheetLifeService=i,this.coreLinkReporter=c,this.sheetAdapterManager=u,this.handleChunkDataReturn=function(e){return st(d,void 0,void 0,regeneratorRuntime.mark((function t(){var r,o;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return o=(0,W.eR)(this.app.spreadsheet),null===(r=n.g.log)||void 0===r||r.info("[分片应用前检查离线数据]-",o),t.next=4,this.app.dataCenter.applyChunkData(e,{isSlice:!0,isInit:!0});case 4:case"end":return t.stop()}}),t,this)})))}}var t=e.prototype;return t.initSdkCore=function(){var e,t,o,s,a,i;return st(this,void 0,void 0,regeneratorRuntime.mark((function u(){var d,l,p,h,_,f,m,v,E,g,R,S,A,w;return regeneratorRuntime.wrap((function(u){for(;;)switch(u.prev=u.next){case 0:return null===(e=n.g.log)||void 0===e||e.info("flow","SdkCoreService initSdkCore()"),this.initSciprtLoader(),this.initFlowEventListener(),this.initSpeedReportEvent(),this.app.emitter.emit(this.app.EVENT.SPREAD_SHEET_SDK_CORE_START),this.sheetLifeService.phase=xe.P.SPREAD_SHEET_SDK_CORE_START,this.coreLinkReporter.init(),this.app.data={initMutations:[]},this.app.sheetStatus?this.app.sheetStatus.update():this.app.initSheetStatus(this.sheetStatus),this.app.initPermissions(this.permissions),this.app.initSpreadsheet(this.spreadsheet),this.app.initMutationBehavior(this.mutationBehavior),this.app.viewManager=new Ne.v(this.app),this.app.initSheetAdapterManager(this.sheetAdapterManager),u.next=16,this.app.sheetAdapterManager.init();case 16:return this.app.initAppConfigInstance(ce.Z),this.initEvent(),this.initDataCenter(),this.initLogin(),u.prev=20,n.g.performanceData&&(n.g.performanceData.spreadInitDataStart=+new Date),u.next=24,this.getDocumentData();case 24:if(d=u.sent,n.g.performanceData&&(n.g.performanceData.spreadInitDataEnd=+new Date),l=d.spreadConfig,p=d.firstData,h=d.isFinished,_=d.startRow,f=d.endRow,m=l.getConfig("dver"),v=n.g.__globalCodeVersion,this.checkDver(m,v)){u.next=35;break}return null===(t=n.g.log)||void 0===t||t.error("flow SdkCoreService checkDver false",m,v),u.next=33,null===(o=this.app.documentManager)||void 0===o?void 0:o.notifyNativeSingleDocVersionMap(at(),m);case 33:return n.g.location.reload(),u.abrupt("return");case 35:if(n.g.performanceData&&(n.g.performanceData.dataStart=+new Date),E=l.getConfig("defaultSheetId"),g=b.UG.deduplication(l.getConfig("sheetList")),!b.UG.checkAllHidden(g)){u.next=42;break}g=b.UG.showOnlySheet(g,E),u.next=48;break;case 42:if(!b.UG.checkCurrHidden(g,E)){u.next=48;break}throw R=b.UG.showNextSheet(g,E),null===(s=n.g.log)||void 0===s||s.error("flow SdkCoreService 当前sheet是隐藏的，跳转到其他sheet. currentSheetId="+E+" nextSheetId="+R),n.g.location.replace((0,c.XK)(n.g.location.href,{tab:R})),ut.NO_WHITE_SCREEN_ERROR;case 48:return this.updateSpreadsheet({sheetList:g,defaultSheetId:E,spreadsheetId:l.getConfig("globalPadId"),title:l.getConfig("title"),baseVersion:l.getConfig("rev")},p,_,f,h),u.next=51,b.UG.initExternalSDK(g,this.app);case 51:S=this.app.spreadsheet.sheetManager.getSheetBySheetId(E),A=S.getSheetType(),null===(w=this.app.sheetAdapterManager.getAdapterBySheetType(A))||void 0===w||w.applySheetData(E,d),null===w||void 0===w||w.switchFirstScreenReport(),this.app.viewManager.hiddenOtherContainer(A),n.g.performanceData&&(n.g.performanceData.dataEnd=+new Date),this.app.permissions.update(l),null===(a=this.app.documentManager)||void 0===a||a.notifyNativeSingleDocVersionMap(at(),m),u.next=69;break;case 62:if(u.prev=62,u.t0=u.catch(20),console.error("flow SdkCoreService initSdkCore error: ",u.t0),null===(i=n.g.log)||void 0===i||i.error("flow SdkCoreService initSdkCore error",null===u.t0||void 0===u.t0?void 0:u.t0.stack),!u.t0||u.t0!==r.LOAD_DOCUMENT_DATA_ERROR){u.next=68;break}throw ut.NO_WHITE_SCREEN_ERROR;case 68:throw u.t0;case 69:this.initDocInfo(),this.initUserInfo(),u.next=74;break;case 74:this.app.login.postLogin(),this.initAuthOperation(),this.app.setInited(!0),this.app.emitter.emit(this.app.EVENT.SPREAD_SHEET_SDK_CORE_END),this.sheetLifeService.phase=xe.P.SPREAD_SHEET_SDK_CORE_END;case 79:case"end":return u.stop()}}),u,this,[[20,62]])})))},t.initSciprtLoader=function(){var e;null===(e=n.g.log)||void 0===e||e.info("flow","PartInteractableService initScriptLoader"),(0,He.CN)()},t.initEvent=function(){var e;null===(e=n.g.log)||void 0===e||e.info("flow","SdkCoreService initEvent()"),new o.Z(this.app)},t.initFlowEventListener=function(){var e,t=this;null===(e=n.g.log)||void 0===e||e.info("flow","SdkCoreService initFlowEventListener()"),this.listenAppEvents([this.app.EVENT.SPREAD_SHEET_ALL_CHUNK_READY,this.app.EVENT.SPREAD_SHEET_REQUEST_API_READY],(function(){return st(t,void 0,void 0,regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.app.offlineEdit.applyOfflineDataCache(),this.app.setDidEditable(!0),this.app.view.canvas.inputManager.inputable=!0,this.app.permissions.unActiveFrozen(),null===(t=n.g.log)||void 0===t||t.info("flow","SPREAD_SHEET_EDITABLE 完整可编辑"),this.app.emitter.emit(this.app.EVENT.SPREAD_SHEET_EDITABLE),this.app.event.default.trigger("afterLoadData",{sheetId:this.app.initOptions.activeSheetId});case 7:case"end":return e.stop()}}),e,this)})))}))},t.updateSpreadsheet=function(e,t,r,o,s){var a,i=e.sheetList,c=e.spreadsheetId,u=e.defaultSheetId,d=e.title,l=e.baseVersion;null===(a=n.g.log)||void 0===a||a.info("flow","SdkCoreService updateSpreadsheet()",e,s),this.app.spreadsheet.reInit({spreadsheetId:c,title:d,sheetList:i,activeSheetId:u}),function(e){for(var t,n={},r=We(e);!(t=r()).done;){var o=t.value.id;if(n[o])return!0;n[o]=!0}return!1}(i)&&f.ZP.run(we.CONFIG.DUPLICATE_SHEET_ID,[i]);var p=this.app.spreadsheet.sheetManager.getSheetBySheetId(u);if(null===p||void 0===p||p.startLoading(),this.app.spreadsheet.isExternalSheet()){var h=this.filterWorkbookMutaitons(t);(0,G.Z)(this.app.spreadsheet,u,[[h]],null,null)}else(0,G.Z)(this.app.spreadsheet,u,t,r,o);var _={spreadsheetId:c,title:d,sheetList:i,activeSheetId:u,baseVersion:l,workbookRanges:this.app.spreadsheet.workbookRangeManager.serialize()};this.app.initOptions=_,this.app.setInited(!0)},t.filterWorkbookMutaitons=function(e){var t=[Ze.ZP.SWITCH_FILTER_SYNC_MUTATION,Ze.ZP.NEW_ADD_EMBEDDED_OBJECT_MUTATION,Ze.ZP.NEW_DELETE_EMBEDDED_OBJECT_MUTATION,Ze.ZP.NEW_UPDATE_EMBEDDED_OBJECT_MUTATION,Ze.ZP.SET_WORKBOOK_PROPERTIES_MUTATION,Ze.ZP.DEFINE_WORKBOOK_RANGE_MUTATION,Ze.ZP.UPDATE_WORKBOOK_RANGE_MUTATION,Ze.ZP.DELETE_WORKBOOK_RANGE_MUTATION];return Ve()(e).filter((function(e){return t.includes(e.t)}))},t.onAllChunkReady=function(){var e;null===(e=n.g.log)||void 0===e||e.info("flow SdkCoreService onAllChunkReady()"),console.info("flow SdkCoreService onAllChunkReady()"),this.app.emitter.emit(this.app.EVENT.SPREAD_SHEET_ALL_CHUNK_READY),n.g.SpreadsheetAppInitComplete=!0,n.g.performanceData&&(n.g.performanceData.entireInteractable=+new Date),this.app.emitter.on(this.app.EVENT.PAGE_LOAD_FINISHED,(function(){var e,t,r=(void 0===(t=n.g.__loadedModules)&&(t=[]),t.map((function(e){var t="PC";y().isPC?t="PC":y().isMobile||y().isAndroidPad?t="MOBILE":y().isIPad&&(t="PAD");var n=De[t][e.moduleName+"_"+e.step];return void 0===n?"":String(n)})).filter((function(e){return""!==e})).join("_"));null===(e=n.g.log)||void 0===e||e.info("reportLoadFlow",r,n.g.isContainer,n.g.__isOfflinePkg),f.ZP.tdwReport({opername:"excel_performance",module:"start",action:"moduleLoadFlow",ver5:r,ver9:JSON.stringify({container:n.g.isContainer?1:0,offline_package:n.g.__isOfflinePkg?1:0}),ver11:it()}),(0,Le.G)(),(0,Fe.TV)()}))},t.listenAppEvents=function(e,t){var n=this,r=e.map((function(e){return new Promise((function(t){n.app.emitter.once(e,t)}))}));Promise.all(r).then((function(){t()}))},t.initSpeedReportEvent=function(){var e,t=this;null===(e=n.g.log)||void 0===e||e.info("flow","SdkCoreService initSpeedReportEvent()"),this.app.event.init.listen(Te.W1.AFTER_FIRST_RENDER,(function(){Oe.Jn.sendEvent("sheet","fcp"),n.g.performanceData&&(n.g.performanceData.afterFirstRender=+new Date)})),this.app.event.init.listen(Te.W1.AFTER_ALL_RENDER,(function(){n.g.performanceData&&(n.g.performanceData.afterAllRender=+new Date),t.app.emitter.emit(t.app.EVENT.PAGE_LOAD_FINISHED)})),this.app.emitter.on(this.app.EVENT.SPREAD_SHEET_PART_INTERACTIVE_END,(function(){Oe.Jn.sendEvent("sheet","tti"),n.g.performanceData&&(n.g.performanceData.partInteractable=+new Date)})),this.app.emitter.on(this.app.EVENT.SPREAD_SHEET_SDK_CORE_START,(function(){n.g.performanceData&&(n.g.performanceData.spreadInitStart=+new Date)})),this.app.emitter.on(this.app.EVENT.SPREAD_SHEET_SDK_CORE_END,(function(){n.g.performanceData&&(n.g.performanceData.spreadInitEnd=+new Date)})),this.app.emitter.on(this.app.EVENT.SPREAD_SHEET_PART_INTERACTIVE_START,(function(){n.g.performanceData&&(n.g.performanceData.viewStart=+new Date)})),this.app.emitter.on(this.app.EVENT.SPREAD_SHEET_PART_INTERACTIVE_END,(function(){n.g.performanceData&&(n.g.performanceData.viewEnd=+new Date)})),this.app.emitter.on(this.app.EVENT.PAGE_LOAD_FINISHED,(function(){Oe.Jn.sendEvent("sheet","pageLoadFinished"),n.g.performanceData&&(n.g.performanceData.pageLoadFinished=+new Date)})),this.app.emitter.on(this.app.EVENT.SPREAD_SHEET_REQUEST_API_READY,(function(){n.g.performanceData&&(n.g.performanceData.requestApiReady=+new Date),n.g.performanceData&&(n.g.performanceData.realPartInteractable=+new Date)}))},t.initLogin=function(){var e;null===(e=n.g.log)||void 0===e||e.info("flow","SdkCoreService initLogin()"),be.Z.init(),this.app.initLogin(be.Z)},t.initAuthOperation=function(){var e,t;null===(e=n.g.log)||void 0===e||e.debug("flow SdkCoreService initAuthOperation()");var r=null===(t=null===window||void 0===window?void 0:window.clientVars)||void 0===t?void 0:t.wecom_allow_op,o=(0,b.dD)(r);S.q.setConfig({wecomAllowOperations:o})},t.initDataCenter=function(){var e,t=this;null===(e=n.g.log)||void 0===e||e.info("flow","SdkCoreService initDataCenter()"),this.instantiationService.addService(ge,new M.Mj(Ee,[function(){var e;return null===(e=t.app.messageCenter)||void 0===e?void 0:e.versionManager.getCurrentVersion()}])),this.instantiationService.invokeFunction((function(e){var n=e.get(ge);t.app.initDataCenter(n)}))},t.getDocumentData=function(){var e;return st(this,void 0,void 0,regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return null===(e=n.g.log)||void 0===e||e.info("flow SdkCoreService getDocumentData()"),console.info("[分片加载] - flow SdkCoreService getDocumentData()",it()),t.next=4,this.initData(at(),it());case 4:return r=t.sent,t.abrupt("return",r);case 6:case"end":return t.stop()}}),t,this)})))},t.initData=function(e,t){var r=this;return this.app.dataCenter.loadDocumentData({secretId:e,sheetType:ue.ZP.GRID,sheetId:t,onSuccess:function(e){return st(r,void 0,void 0,regeneratorRuntime.mark((function n(){var r=this;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return e.isFinished&&this.app.dataCenter.addLoadSheetDataCallback((null===e||void 0===e?void 0:e.sheetId)||t,{onFinished:function(){console.info("[分片加载] LoadSheetDataCallback onFinished"),r.onAllChunkReady(),f.ZP.zzsStatus({attrid:we.ZZS_REPORT_ATTR.FIRST_SCREEN_CHUNK_DATA_LOAD_FAIL,status:0})}}),n.next=3,this.sheetLifeService.when(xe.P.SPREAD_SHEET_REQUEST_API_READY);case 3:this.handleChunkDataReturn(e);case 4:case"end":return n.stop()}}),n,this)})))},onFail:function(e){var n,r;f.ZP.zzsStatus({attrid:we.ZZS_REPORT_ATTR.FIRST_SCREEN_CHUNK_DATA_LOAD_FAIL,status:1}),Be.$.report("FIRST_SCREEN_CHUNK_DATA_LOAD_FAIL"),ne({sheetId:t,message:(null===e||void 0===e?void 0:e.error.message)||"数据拉取失败",type:(null===(n=null===e||void 0===e?void 0:e.error)||void 0===n?void 0:n.type)||R.Z.LOAD_ONLINE_SHEET_DATA_FAIL,code:(null===(r=null===e||void 0===e?void 0:e.error)||void 0===r?void 0:r.code)||-1,error:e})},handleClientVars:function(e,t){var r,o;n.g.spreadConfig=t;var s=!!(0,c.IZ)("inToastPreview"),a=!s&&e.isCreator&&!!(0,c.IZ)("uniquefileid");Object.defineProperty(e,"preview",{value:!a&&(e.preview||s)}),n.g.clientVars=e,je.default.updateDomainWithClientVars(window.clientVars);var i=e.collab_client_vars.padSubId;i&&n.g.history.replaceState(i,"",(0,c.XK)(n.g.location.href,{tab:i}));try{var u=(0,ee.getUid)();u&&(null===(r=n.g.log)||void 0===r||r.identify(u))}catch(d){null===(o=n.g.log)||void 0===o||o.error("log.identify",d)}}})},t.initDocInfo=function(){(0,ke.J)((function(e){var t;null===(t=n.g.log)||void 0===t||t.debug("flow SdkCoreService getDocInfo()",e),S.q.setConfig({docInfo:e})}))},t.initUserInfo=function(){(0,Ce.b)((function(e){var t;null===(t=n.g.log)||void 0===t||t.info("flow","SdkCoreService getUserInfo()",JSON.stringify(e,null,2)),S.q.setConfig({userInfo:e})}))},t.initGrayConfig=function(){return st(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(0,Me.e)()){e.next=3;break}return e.next=3,this.loadDiscussion();case 3:S.q.setConfig({weworkTimelineGray:!0});case 4:case"end":return e.stop()}}),e,this)})))},t.loadDiscussion=function(){return new Promise((function(e){var t=document.createElement("script");t.onload=function(){return e()},t.onerror=function(){return e()},t.nonce="NONCE_PLACEHOLDER",t.type="text/javascript",t.src=/debug=1/.test(window.location.search)?"/direflowBundle.js":ce.Z.getConfig("runtime.library.TENCENT_DOCS_LIBRARY__weixin_discussion_ext"),document.body.appendChild(t)}))},t.checkDver=function(e,t){var r;return!n.g.isContainer||!!(0,ye.bG)(e,t)||(null===(r=n.g.log)||void 0===r||r.error("flow checkDver 数据的版本号和代码的版本号不一致，走线上",t,e),window.location.replace(location.href),!1)},e}();ct=nt([ot(0,Y.m),ot(1,M.TG),ot(2,Se.T),ot(3,Re.H),ot(4,Ie.V),ot(5,Ae.D),ot(6,xe.n),ot(7,Ge.$),ot(8,Pe.c),rt("design:paramtypes",["function"===typeof(Ye="undefined"!==typeof Y.m&&Y.m)?Ye:Object,"function"===typeof(ze="undefined"!==typeof M.TG&&M.TG)?ze:Object,"function"===typeof(Xe="undefined"!==typeof Se.T&&Se.T)?Xe:Object,"function"===typeof(qe="undefined"!==typeof Re.H&&Re.H)?qe:Object,"function"===typeof(Je="undefined"!==typeof Ie.V&&Ie.V)?Je:Object,"function"===typeof(Qe="undefined"!==typeof Ae.D&&Ae.D)?Qe:Object,"function"===typeof($e="undefined"!==typeof xe.n&&xe.n)?$e:Object,"function"===typeof(et="undefined"!==typeof Ge.$&&Ge.$)?et:Object,"function"===typeof(tt="undefined"!==typeof Pe.c&&Pe.c)?tt:Object])],ct);var ut,dt="page-editor"==n.j?ct:null;!function(e){e.WHITE_SCREEN_ERROR="WHITE_SCREEN_ERROR",e.NO_WHITE_SCREEN_ERROR="NO_WHITE_SCREEN_ERROR"}(ut||(ut={}))},"../spread-sheet/src/flow/browser/phase/services/sheetLifecycle.ts":function(e,t,n){n.d(t,{h:function(){return i}});var r=n("../node_modules/@babel/runtime/helpers/esm/createClass.js"),o=(n("../node_modules/regenerator-runtime/runtime.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.promise.js"),n("../node_modules/core-js/modules/es.array.iterator.js"),n("../node_modules/core-js/modules/es.map.js"),n("../node_modules/core-js/modules/es.string.iterator.js"),n("../node_modules/core-js/modules/esnext.map.delete-all.js"),n("../node_modules/core-js/modules/esnext.map.every.js"),n("../node_modules/core-js/modules/esnext.map.filter.js"),n("../node_modules/core-js/modules/esnext.map.find.js"),n("../node_modules/core-js/modules/esnext.map.find-key.js"),n("../node_modules/core-js/modules/esnext.map.includes.js"),n("../node_modules/core-js/modules/esnext.map.key-of.js"),n("../node_modules/core-js/modules/esnext.map.map-keys.js"),n("../node_modules/core-js/modules/esnext.map.map-values.js"),n("../node_modules/core-js/modules/esnext.map.merge.js"),n("../node_modules/core-js/modules/esnext.map.reduce.js"),n("../node_modules/core-js/modules/esnext.map.some.js"),n("../node_modules/core-js/modules/esnext.map.update.js"),n("../node_modules/core-js/modules/web.dom-collections.iterator.js"),n("../spread-sheet/src/flow/lib/scheduler/base/barrier.ts")),s=n("../spread-sheet/src/flow/browser/phase/services/sheetLifecyle.interface.ts"),a=function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function a(e){try{c(r.next(e))}catch(t){s(t)}}function i(e){try{c(r.throw(e))}catch(t){s(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,i)}c((r=r.apply(e,t||[])).next())}))},i=function(){function e(){this.innerPhase=s.P.PAGE_LOAD_START,this.phaseWhen=new Map}var t=e.prototype;return t.when=function(e){return a(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(e<=this.innerPhase)){t.next=2;break}return t.abrupt("return");case 2:return(n=this.phaseWhen.get(e))||(n=new o.U,this.phaseWhen.set(e,n)),t.next=6,n.wait();case 6:case"end":return t.stop()}}),t,this)})))},t.compare=function(e){return this.innerPhase-e},(0,r.Z)(e,[{key:"phase",get:function(){return this.innerPhase},set:function(e){var t;if(e<this.phase)throw null===(t=n.g.log)||void 0===t||t.error("Lifecycle cannot go backwards from "+this.phase+" to "+e),new Error("Lifecycle cannot go backwards from "+this.phase+" to "+e);if(this.innerPhase!==e){this.innerPhase=e;var r=this.phaseWhen.get(this.innerPhase);r&&(r.open(),this.phaseWhen.delete(this.innerPhase))}}}]),e}()},"../spread-sheet/src/flow/browser/phase/services/sheetLifecyle.interface.ts":function(e,t,n){n.d(t,{P:function(){return r},n:function(){return s}});var r,o=n("../node_modules/@tencent/containerized/build/main/index.js");!function(e){e[e.PAGE_LOAD_START=1]="PAGE_LOAD_START",e[e.SPREAD_SHEET_SDK_CORE_START=2]="SPREAD_SHEET_SDK_CORE_START",e[e.SPREAD_SHEET_SDK_CORE_END=3]="SPREAD_SHEET_SDK_CORE_END",e[e.SPREAD_SHEET_PART_INTERACTIVE_START=4]="SPREAD_SHEET_PART_INTERACTIVE_START",e[e.SPREAD_SHEET_PART_INTERACTIVE_END=5]="SPREAD_SHEET_PART_INTERACTIVE_END",e[e.SPREAD_SHEET_MESSAGE_START=6]="SPREAD_SHEET_MESSAGE_START",e[e.SPREAD_SHEET_MESSAGE_END=7]="SPREAD_SHEET_MESSAGE_END",e[e.SPREAD_SHEET_WORKER_SATRT=8]="SPREAD_SHEET_WORKER_SATRT",e[e.SPREAD_SHEET_WORKER_END=9]="SPREAD_SHEET_WORKER_END",e[e.SPREAD_SHEET_REQUEST_API_READY=10]="SPREAD_SHEET_REQUEST_API_READY",e[e.SPREAD_SHEET_WORKBENCH_START=11]="SPREAD_SHEET_WORKBENCH_START",e[e.SPREAD_SHEET_WORKBENCH_END=12]="SPREAD_SHEET_WORKBENCH_END",e[e.SPREAD_SHEET_PLUGINS_START=13]="SPREAD_SHEET_PLUGINS_START",e[e.SPREAD_SHEET_PLUGINS_END=14]="SPREAD_SHEET_PLUGINS_END",e[e.PAGE_LOAD_FINISHED=15]="PAGE_LOAD_FINISHED"}(r||(r={}));var s=(0,o.yh)("ILifecycleService")},"../spread-sheet/src/flow/browser/phase/services/workerService.interface.ts":function(e,t,n){n.d(t,{V:function(){return s},k:function(){return o}});var r=n("../node_modules/@tencent/containerized/build/main/index.js"),o=(0,r.yh)("ICalculationService"),s=(0,r.yh)("IWorkerService")},"../spread-sheet/src/flow/browser/phase/workbench/workbench-feature-loader-registry.ts":function(e,t,n){n.d(t,{P:function(){return r}}),n("../node_modules/core-js/modules/es.array.iterator.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.set.js"),n("../node_modules/core-js/modules/es.string.iterator.js"),n("../node_modules/core-js/modules/esnext.set.add-all.js"),n("../node_modules/core-js/modules/esnext.set.delete-all.js"),n("../node_modules/core-js/modules/esnext.set.difference.js"),n("../node_modules/core-js/modules/esnext.set.every.js"),n("../node_modules/core-js/modules/esnext.set.filter.js"),n("../node_modules/core-js/modules/esnext.set.find.js"),n("../node_modules/core-js/modules/esnext.set.intersection.js"),n("../node_modules/core-js/modules/esnext.set.is-disjoint-from.js"),n("../node_modules/core-js/modules/esnext.set.is-subset-of.js"),n("../node_modules/core-js/modules/esnext.set.is-superset-of.js"),n("../node_modules/core-js/modules/esnext.set.join.js"),n("../node_modules/core-js/modules/esnext.set.map.js"),n("../node_modules/core-js/modules/esnext.set.reduce.js"),n("../node_modules/core-js/modules/esnext.set.some.js"),n("../node_modules/core-js/modules/esnext.set.symmetric-difference.js"),n("../node_modules/core-js/modules/esnext.set.union.js"),n("../node_modules/core-js/modules/web.dom-collections.iterator.js");var r=new(function(){function e(){this.loaders=new Set}var t=e.prototype;return t.addLoader=function(e){this.loaders.add(e)},t.getLoaders=function(){return this.loaders},e}())},"../spread-sheet/src/flow/browser/phase/workbench/workbench-state.interface.ts":function(e,t,n){n.d(t,{i:function(){return r}});var r=(0,n("../node_modules/@tencent/containerized/build/main/index.js").yh)("IWorkbenchState")},"../spread-sheet/src/flow/browser/registry/pc.ts":function(e,t,n){var r=n("../node_modules/@babel/runtime/helpers/esm/inheritsLoose.js"),o=(n("../node_modules/regenerator-runtime/runtime.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.promise.js"),n("../node_modules/core-js/modules/es.array.iterator.js"),n("../node_modules/core-js/modules/es.string.iterator.js"),n("../node_modules/core-js/modules/web.dom-collections.iterator.js"),n("../node_modules/@tencent/containerized/build/main/index.js")),s=n("../spread-sheet/src/flow/common/initialization.ts"),a=n("../spread-sheet/src/external/view/main/footer/footer.interface.ts"),i=n("../spread-sheet/src/external/view/workbench/workbench.interface.ts"),c=n("../spread-sheet/src/external/history/pc/History.interface.ts"),u=n("../spread-sheet/src/external/auth/pc/AdvPermissions.ts"),d=n("../spread-sheet/src/core/feature/cellImage/cellImage.interface.ts"),l=n("../spread-sheet/src/external/titleSync/titleSync.interface.ts"),p=n("../spread-sheet/src/external/badgeServiceExcelAdapter/badgeServiceExcelAdapter.interface.ts"),h=n("../spread-sheet/src/core/feature/Feature.interface.ts"),_=n("../spread-sheet/src/core/feature/edit-feature.interface.ts"),f=n("../spread-sheet/src/external/resetLocation/resetLocation.interface.ts"),m=n("../spread-sheet/src/external/app-guide/index.ts"),v=n("../spread-sheet/src/external/templateinfo/templateinfo.interface.ts"),E=n("../spread-sheet/src/external/collaboration/collaboration-manager.interface.ts"),g=n("../spread-sheet/src/external/share/share-controller.interface.ts"),R=n("../spread-sheet/src/external/sync-guide/sync-guide.interface.ts"),S=function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function a(e){try{c(r.next(e))}catch(t){s(t)}}function i(e){try{c(r.throw(e))}catch(t){s(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,i)}c((r=r.apply(e,t||[])).next())}))};s.VW.register(l.J,function(e){function t(){return e.apply(this,arguments)||this}return(0,r.Z)(t,e),t.prototype.getModule=function(){return S(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([n.e("vendors-node_modules_tencent_docs-universal-config-sdk_build_index_js"),n.e("bundle_plugin_init")]).then(n.bind(n,"../spread-sheet/src/external/titleSync/titleSync.ts"));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))},t}(o.RU)),s.VW.register(p.P,function(e){function t(){return e.apply(this,arguments)||this}return(0,r.Z)(t,e),t.prototype.getModule=function(){return S(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([n.e("vendors-node_modules_tencent_docs-universal-config-sdk_build_index_js"),n.e("bundle_plugin_init")]).then(n.bind(n,"../spread-sheet/src/external/badgeServiceExcelAdapter/badgeServiceExcelAdapter.ts"));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))},t}(o.RU)),s.VW.register(h._,function(e){function t(){return e.apply(this,arguments)||this}return(0,r.Z)(t,e),t.prototype.getModule=function(){return S(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([n.e("vendors-node_modules_tencent_toggle-client-js_dist_toggle_es_js-node_modules_tencent_wedocs-i-565a10"),n.e("spread-sheet_src_base_util_decorator_loading-decorator_ts-spread-sheet_src_core_feature_copyP-33f189"),n.e("spread-sheet_src_core_feature_relateForm_index_ts"),n.e("spread-sheet_src_core_feature_bootstrap_ts"),n.e("bundle_feature")]).then(n.bind(n,"../spread-sheet/src/core/feature/Feature.ts"));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))},t}(o.RU)),s.VW.register(_.g,function(e){function t(){return e.apply(this,arguments)||this}return(0,r.Z)(t,e),t.prototype.getModule=function(){return S(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.e("bundle_edit_feature").then(n.bind(n,"../spread-sheet/src/core/feature/edit-feature.ts"));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))},t}(o.RU)),s.VW.register(f.h,function(e){function t(){return e.apply(this,arguments)||this}return(0,r.Z)(t,e),t.prototype.getModule=function(){return S(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([n.e("vendors-node_modules_tencent_docs-universal-config-sdk_build_index_js"),n.e("bundle_plugin_init")]).then(n.bind(n,"../spread-sheet/src/external/resetLocation/index.ts"));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))},t}(o.RU)),s.VW.register(m.s,function(e){function t(){return e.apply(this,arguments)||this}return(0,r.Z)(t,e),t.prototype.getModule=function(){return S(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.resolve().then(n.bind(n,"../spread-sheet/src/external/app-guide/app-guide.ts"));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))},t}(o.RU)),s.VW.register(v.J,function(e){function t(){return e.apply(this,arguments)||this}return(0,r.Z)(t,e),t.prototype.getModule=function(){return S(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.e("bundle_view_level2_edit_lazy_module0").then(n.bind(n,"../spread-sheet/src/external/templateinfo/templateinfo.ts"));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))},t}(o.RU)),s.VW.register(E.pI,function(e){function t(){return e.apply(this,arguments)||this}return(0,r.Z)(t,e),t.prototype.getModule=function(){return S(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.resolve().then(n.bind(n,"../spread-sheet/src/external/collaboration/collaboration-manager.ts"));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))},t}(o.RU)),s.VW.register(g.N,function(e){function t(){return e.apply(this,arguments)||this}return(0,r.Z)(t,e),t.prototype.getModule=function(){return S(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([n.e("vendors-node_modules_tencent_docs-design-resources_mobile_png_2x_cdn_js-node_modules_tencent_-e09a13"),n.e("bundle_shareconstrol")]).then(n.bind(n,"../spread-sheet/src/external/share/share-controller.ts"));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))},t}(o.RU)),s.VW.register(R.F,function(e){function t(){return e.apply(this,arguments)||this}return(0,r.Z)(t,e),t.prototype.getModule=function(){return S(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([n.e("vendors-node_modules_tencent_docs-universal-config-sdk_build_index_js"),n.e("bundle_plugin_init")]).then(n.bind(n,"../spread-sheet/src/external/sync-guide/sync-guide.ts"));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))},t}(o.RU));var A=function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function a(e){try{c(r.next(e))}catch(t){s(t)}}function i(e){try{c(r.throw(e))}catch(t){s(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,i)}c((r=r.apply(e,t||[])).next())}))};s.VW.register(a.F,function(e){function t(){return e.apply(this,arguments)||this}return(0,r.Z)(t,e),t.prototype.getModule=function(){return A(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([n.e("vendors-node_modules_tencent_toggle-client-js_dist_toggle_es_js-node_modules_tencent_docs-des-f28a76"),n.e("spread-sheet_src_external_rangeAuth_loader_RangeAuthManager_ts-spread-sheet_src_external_view-9a5060"),n.e("bundle_plugin_pcFooter")]).then(n.bind(n,"../spread-sheet/src/external/view/pc/footer/footer.ts"));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))},t}(o.RU)),s.VW.register(i.E,function(e){function t(){return e.apply(this,arguments)||this}return(0,r.Z)(t,e),t.prototype.getModule=function(){return A(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.e("bundle_view_workbench").then(n.bind(n,"../spread-sheet/src/external/view/workbench/workbench.ts"));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))},t}(o.RU)),s.VW.register(c.z,function(e){function t(){return e.apply(this,arguments)||this}return(0,r.Z)(t,e),t.prototype.getModule=function(){return A(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.e("bundle_plugin_history").then(n.bind(n,"../spread-sheet/src/external/history/pc/History.tsx"));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))},t}(o.RU)),s.VW.register(u.IAdvPermissionsPC,function(e){function t(){return e.apply(this,arguments)||this}return(0,r.Z)(t,e),t.prototype.getModule=function(){return A(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.resolve().then(n.bind(n,"../spread-sheet/src/external/auth/pc/AdvPermissions.ts"));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))},t}(o.RU)),s.VW.register(d.k,function(e){function t(){return e.apply(this,arguments)||this}return(0,r.Z)(t,e),t.prototype.getModule=function(){return A(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.e("bundle_edit_feature").then(n.bind(n,"../spread-sheet/src/core/feature/cellImage/index.ts"));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))},t}(o.RU));var w,T,y,I,O=n("../spread-sheet/src/flow/browser/tasks/names.ts"),D=(n("../node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),n("../node_modules/core-js/modules/esnext.reflect.metadata.js"),n("../node_modules/@tencent/tdoc-scheduler/lib/tdoc-scheduler.cjs.js")),b=n("../spread-sheet/src/core/app/devtool/tools.ts"),C=n("../spread-sheet/src/core/app/SpreadsheetApp.interface.ts"),x=n("../spread-sheet/src/ServiceCollection/index.ts"),N=n("../spread-sheet/src/flow/lib/scheduler/base/safe-task.ts"),P=n("../spread-sheet/src/core/app/sheetStatus/index.ts"),L=function(e,t,n,r){var o,s=arguments.length,a=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var i=e.length-1;i>=0;i--)(o=e[i])&&(a=(s<3?o(a):s>3?o(t,n,a):o(t,n))||a);return s>3&&a&&Object.defineProperty(t,n,a),a},j=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},k=function(e,t){return function(n,r){t(n,r,e)}},F=function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function a(e){try{c(r.next(e))}catch(t){s(t)}}function i(e){try{c(r.throw(e))}catch(t){s(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,i)}c((r=r.apply(e,t||[])).next())}))},M=function(e){function t(t,n,r,o){var s;return(s=e.call(this)||this).app=t,s.dynamicFeature=n,s.sheetStatus=r,s.editFeatureLoader=o,s}(0,r.Z)(t,e);var o=t.prototype;return o.safeRun=function(){return F(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.initTools(),e.next=3,this.initCoreSheet();case 3:return e.next=5,this.initFeature();case 5:if(!this.sheetStatus.workbookStatus.canEdit){e.next=8;break}return e.next=8,this.initEditFeature();case 8:return e.abrupt("return",{status:D.TE.success});case 9:case"end":return e.stop()}}),e,this)})))},o.initTools=function(){(0,b.Z)(this.app)},o.initFeature=function(){var e;return F(this,void 0,void 0,regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.dynamicFeature.getInstance();case 2:return r=t.sent,this.app.initFeature(r),t.next=6,r.init();case 6:return t.next=8,r.getJankToast();case 8:(0,t.sent)(),null===(e=n.g.log)||void 0===e||e.info("flow","PcPluginService initFeature() end");case 11:case"end":return t.stop()}}),t,this)})))},o.initCoreSheet=function(){var e;return F(this,void 0,void 0,regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=this.app.serviceCollection.createLoader(x.kh.CORE_SHEET),t.next=3,r.load();case 3:t.sent.default(),null===(e=n.g.log)||void 0===e||e.info("flow","PcPluginService initCoreSheet() end");case 6:case"end":return t.stop()}}),t,this)})))},o.initEditFeature=function(){return F(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.editFeatureLoader.getInstance();case 2:return t=e.sent,this.app.initEditFeature(t),e.next=6,t.init();case 6:case"end":return e.stop()}}),e,this)})))},t}(N.E);M=L([k(0,C.m),k(1,h._),k(2,P.T),k(3,_.g),j("design:paramtypes",["function"===typeof(w="undefined"!==typeof C.m&&C.m)?w:Object,"function"===typeof(T="undefined"!==typeof o.IDynamicLoader&&o.IDynamicLoader)?T:Object,"function"===typeof(y="undefined"!==typeof P.T&&P.T)?y:Object,"function"===typeof(I="undefined"!==typeof o.IDynamicLoader&&o.IDynamicLoader)?I:Object])],M);var H=function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function a(e){try{c(r.next(e))}catch(t){s(t)}}function i(e){try{c(r.throw(e))}catch(t){s(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,i)}c((r=r.apply(e,t||[])).next())}))},U=function(e){function t(){return e.apply(this,arguments)||this}return(0,r.Z)(t,e),t.prototype.safeRun=function(){return H(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return");case 1:case"end":return e.stop()}}),e)})))},t}(N.E),V=n("../spread-sheet/src/external/tencentMeeting/utils.ts"),Z=function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function a(e){try{c(r.next(e))}catch(t){s(t)}}function i(e){try{c(r.throw(e))}catch(t){s(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,i)}c((r=r.apply(e,t||[])).next())}))},G=function(e){function t(){return e.apply(this,arguments)||this}(0,r.Z)(t,e);var o=t.prototype;return o.safeRun=function(){return Z(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.selectModeForMeeting(),e.abrupt("return",{status:D.TE.success});case 2:case"end":return e.stop()}}),e,this)})))},o.selectModeForMeeting=function(){return Z(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t,r,o,s;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((0,V.isFromTencentMeetingSharing)()){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,Promise.all([n.e("bundle_vendors_workbench"),n.e("initial_vendors_tencent_dui"),n.e("initial_vendors_tencent_4"),n.e("initial_vendors_public_1"),n.e("bundle_workbench")]).then(n.bind(n,"../node_modules/@tencent/workbench/lib/esm/index.js"));case 4:return t=e.sent.InjectorService,e.next=7,Promise.all([n.e("bundle_vendors_workbench"),n.e("initial_vendors_tencent_dui"),n.e("initial_vendors_tencent_4"),n.e("initial_vendors_public_1"),n.e("bundle_workbench")]).then(n.bind(n,"../spread-sheet/src/external/view/ui-layer/toolbar-mode/toolbar-mode-feature.tsx"));case 7:return r=e.sent.ToolbarModeFeature,e.next=10,Promise.all([n.e("bundle_vendors_workbench"),n.e("initial_vendors_tencent_dui"),n.e("initial_vendors_tencent_4"),n.e("initial_vendors_public_1"),n.e("bundle_workbench")]).then(n.bind(n,"../spread-sheet/src/external/view/ui-layer/toolbar-mode/config.tsx"));case 10:o=e.sent.ToolbarModeOrders,s=t.get(r),n.g.setTimeout((function(){s.selectToolbarMode(o.HIDE_TOOLBAR)}),120);case 13:case"end":return e.stop()}}),e)})))},t}(N.E),B=n("../packages/report/src/index.ts"),W=!1;function K(e){if(!W){W=!0;var t=e-(new Date).getTime();B.ZP.tdwReport({opername:"doc_excel_editor",module:"excel_sheet",action:"sheetsbar_load_cost",ver1:t})}}var Y,z,X,q,J,Q=(0,o.yh)("IWorkbenchInitService"),$=n("../spread-sheet/src/flow/browser/phase/workbench/workbench-state.interface.ts"),ee=function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function a(e){try{c(r.next(e))}catch(t){s(t)}}function i(e){try{c(r.throw(e))}catch(t){s(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,i)}c((r=r.apply(e,t||[])).next())}))},te=function(e){function t(){return e.apply(this,arguments)||this}(0,r.Z)(t,e);var o=t.prototype;return o.getModule=function(){return ee(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t,r,o,s;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.next=8;break;case 3:r=e.sent,this.dynamicBinding=r.bindWorkBenchMobile,t=r.WorkbenchInitService,e.next=22;break;case 8:e.next=16;break;case 11:o=e.sent,this.dynamicBinding=o.bindWorkBenchPad,t=o.WorkbenchInitService,e.next=22;break;case 16:return e.next=19,Promise.all([n.e("bundle_vendors_workbench"),n.e("initial_vendors_tencent_dui"),n.e("initial_vendors_tencent_4"),n.e("initial_vendors_public_1"),n.e("initial_vendors_public_3"),n.e("initial_chunk_part_2"),n.e("vendors-node_modules_tencent_docs-design-resources_pc_png_2x_cdn-function-export_js"),n.e("vendors-node_modules_tencent_docs-design-resources_pc_png_2x_cdn_js-node_modules_tencent_docs-70ebca"),n.e("vendors-node_modules_tencent_docs-scenario-components-pc-header-badge_dist_index_js-node_modu-b423ba"),n.e("spread-sheet_src_external_view_mobile_toolbar_quick-panel_quick-panel-component_index_less-sp-8a755a"),n.e("spread-sheet_src_external_view_ui-layer_filter_filter-controller_tsx-spread-sheet_src_externa-d82123"),n.e("spread-sheet_src_core_workbench_common_commonService_ts-spread-sheet_src_core_workbench_middl-293cf0"),n.e("spread-sheet_src_core_workbench_common_base-drawer_tsx-spread-sheet_src_external_rangeAuth_ut-2939e0"),n.e("spread-sheet_src_external_view_main_toolbar_IconBox_tsx"),n.e("spread-sheet_src_external_check-slr_sc-lazy-loader_ts-spread-sheet_src_external_templateinfo_-54b3ca"),n.e("spread-sheet_src_core_network_message-center_adapter_MessageCenterAdapter_interface_ts-spread-e88071"),n.e("spread-sheet_src_external_view_ui-layer_comment-ent_comment-ent-controller_tsx-spread-sheet_s-7248e3"),n.e("bundle_workbench_pc")]).then(n.bind(n,"../spread-sheet/src/core/workbench/initialization/workbenchInitServicePc.ts"));case 19:s=e.sent,this.dynamicBinding=s.bindWorkBenchPc,t=s.WorkbenchInitService;case 22:return this.di&&this.dynamicBinding&&this.dynamicBinding(this.di),e.abrupt("return",t);case 24:case"end":return e.stop()}}),e,this)})))},o.setDi=function(e){this.di=e},t}(o.RU),ne=function(e,t,n,r){var o,s=arguments.length,a=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var i=e.length-1;i>=0;i--)(o=e[i])&&(a=(s<3?o(a):s>3?o(t,n,a):o(t,n))||a);return s>3&&a&&Object.defineProperty(t,n,a),a},re=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},oe=function(e,t){return function(n,r){t(n,r,e)}},se=function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function a(e){try{c(r.next(e))}catch(t){s(t)}}function i(e){try{c(r.throw(e))}catch(t){s(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,i)}c((r=r.apply(e,t||[])).next())}))},ae=function(e){function t(t,n,r,o,s){var a;return(a=e.call(this)||this).app=t,a.footer=n,a.workbenchInitServiceLoader=r,a.instantiationService=o,a.workbenchState=s,a}(0,r.Z)(t,e);var o=t.prototype;return o.safeRun=function(){return se(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.renderSheetBar();case 2:return e.abrupt("return");case 3:case"end":return e.stop()}}),e,this)})))},o.renderSheetBar=function(){var e;return se(this,void 0,void 0,regeneratorRuntime.mark((function t(){var r,o;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=(new Date).getTime(),t.next=3,this.footer.getInstance();case 3:return o=t.sent,this.app.view.footer=o,t.next=7,o.init({});case 7:K(r),null===(e=n.g.log)||void 0===e||e.info("flow","PcPluginService initFooter() end");case 9:case"end":return t.stop()}}),t,this)})))},t}(N.E);ae=ne([oe(0,C.m),oe(1,a.F),oe(2,Q),oe(3,o.TG),oe(4,$.i),re("design:paramtypes",["function"===typeof(Y="undefined"!==typeof C.m&&C.m)?Y:Object,"function"===typeof(z="undefined"!==typeof o.IDynamicLoader&&o.IDynamicLoader)?z:Object,"function"===typeof(X="undefined"!==typeof te&&te)?X:Object,"function"===typeof(q="undefined"!==typeof o.TG&&o.TG)?q:Object,"function"===typeof(J="undefined"!==typeof $.i&&$.i)?J:Object])],ae);var ie,ce,ue,de,le=n("../spread-sheet/src/flow/browser/tasks/common/render-editor-first-screen.ts"),pe=(0,o.yh)("IEditableService"),he=(0,o.yh)("IMessageService"),_e=n("../spread-sheet/src/flow/browser/phase/services/workerService.interface.ts"),fe=function(e,t,n,r){var o,s=arguments.length,a=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var i=e.length-1;i>=0;i--)(o=e[i])&&(a=(s<3?o(a):s>3?o(t,n,a):o(t,n))||a);return s>3&&a&&Object.defineProperty(t,n,a),a},me=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},ve=function(e,t){return function(n,r){t(n,r,e)}},Ee=function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function a(e){try{c(r.next(e))}catch(t){s(t)}}function i(e){try{c(r.throw(e))}catch(t){s(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,i)}c((r=r.apply(e,t||[])).next())}))},ge=function(e){function t(t,n,r,o){var s;return(s=e.call(this)||this).messageServiceLoader=t,s.calculationServiceLoader=n,s.workerServiceLoader=r,s.editableServiceLoader=o,s}return(0,r.Z)(t,e),t.prototype.safeRun=function(){return Ee(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t,n,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.messageServiceLoader.getInstance();case 2:return t=e.sent,e.next=5,this.workerServiceLoader.getInstance();case 5:return n=e.sent,e.next=8,this.editableServiceLoader.getInstance();case 8:return r=e.sent,e.next=11,t.initMessageCenter();case 11:return e.next=13,this.calculationServiceLoader.getInstance();case 13:return e.next=15,n.initWorker();case 15:return e.next=17,r.initEditable();case 17:return e.abrupt("return");case 18:case"end":return e.stop()}}),e,this)})))},t}(N.E);ge=fe([ve(0,he),ve(1,_e.k),ve(2,_e.V),ve(3,pe),me("design:paramtypes",["function"===typeof(ie="undefined"!==typeof o.IDynamicLoader&&o.IDynamicLoader)?ie:Object,"function"===typeof(ce="undefined"!==typeof o.IDynamicLoader&&o.IDynamicLoader)?ce:Object,"function"===typeof(ue="undefined"!==typeof o.IDynamicLoader&&o.IDynamicLoader)?ue:Object,"function"===typeof(de="undefined"!==typeof o.IDynamicLoader&&o.IDynamicLoader)?de:Object])],ge);var Re,Se=n("../spread-sheet/src/base/ssr/ssr-dom-remove-util.ts"),Ae=function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function a(e){try{c(r.next(e))}catch(t){s(t)}}function i(e){try{c(r.throw(e))}catch(t){s(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,i)}c((r=r.apply(e,t||[])).next())}))},we=function(e){function t(){return e.apply(this,arguments)||this}return(0,r.Z)(t,e),t.prototype.safeRun=function(){return Ae(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(0,Se.$Q)(),(0,Se.Cs)(),e.abrupt("return");case 3:case"end":return e.stop()}}),e)})))},t}(N.E),Te=(n("../spread-sheet/src/base/util/domain-config.ts"),function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function a(e){try{c(r.next(e))}catch(t){s(t)}}function i(e){try{c(r.throw(e))}catch(t){s(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,i)}c((r=r.apply(e,t||[])).next())}))}),ye=function(e){function t(){return e.apply(this,arguments)||this}(0,r.Z)(t,e);var o=t.prototype;return o.safeRun=function(){return Te(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.hideHeadbarSSR(),e.abrupt("return",{status:D.TE.success});case 2:case"end":return e.stop()}}),e,this)})))},o.hideHeadbarSSR=function(){var e=document.getElementById("header_legacy_ssr"),t=document.getElementById("workbench_preivew_ssr");e&&n.g.setTimeout((function(){e.remove()}),12e3),t&&n.g.setTimeout((function(){document.querySelector("#workbenchContainer #workbench-titlebar"),document.querySelector("#workbenchContainer #workbench-toolbar"),t.remove()}),120)},t}(N.E),Ie=n("../spread-sheet/src/base/config/report.ts"),Oe=function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function a(e){try{c(r.next(e))}catch(t){s(t)}}function i(e){try{c(r.throw(e))}catch(t){s(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,i)}c((r=r.apply(e,t||[])).next())}))},De=function(e){function t(){return e.apply(this,arguments)||this}return(0,r.Z)(t,e),t.prototype.safeRun=function(){return Oe(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return B.ZP.run(Ie.CONFIG.REPORT_FOR_PV),B.ZP.run(Ie.CONFIG.REPORT_FOR_QL_PV),e.abrupt("return");case 3:case"end":return e.stop()}}),e)})))},t}(N.E),be=n("../spread-sheet/src/external/tencentMeeting/controller/tencent-meeting-controller.ts"),Ce=function(e,t,n,r){var o,s=arguments.length,a=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var i=e.length-1;i>=0;i--)(o=e[i])&&(a=(s<3?o(a):s>3?o(t,n,a):o(t,n))||a);return s>3&&a&&Object.defineProperty(t,n,a),a},xe=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},Ne=function(e,t){return function(n,r){t(n,r,e)}},Pe=function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function a(e){try{c(r.next(e))}catch(t){s(t)}}function i(e){try{c(r.throw(e))}catch(t){s(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,i)}c((r=r.apply(e,t||[])).next())}))},Le=function(e){function t(t){var n;return(n=e.call(this)||this).app=t,n}(0,r.Z)(t,e);var n=t.prototype;return n.safeRun=function(){return Pe(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.initTencentMeeting();case 2:return e.abrupt("return",{status:D.TE.success});case 3:case"end":return e.stop()}}),e,this)})))},n.initTencentMeeting=function(){return Pe(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((0,V.isFromTencentMeetingSharing)()){e.next=2;break}return e.abrupt("return");case 2:return t=be.p.getInstance(this.app),e.next=5,t.init();case 5:case"end":return e.stop()}}),e,this)})))},t}(N.E);Le=Ce([Ne(0,C.m),xe("design:paramtypes",["function"===typeof(Re="undefined"!==typeof C.m&&C.m)?Re:Object])],Le);var je,ke,Fe=function(e,t,n,r){var o,s=arguments.length,a=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var i=e.length-1;i>=0;i--)(o=e[i])&&(a=(s<3?o(a):s>3?o(t,n,a):o(t,n))||a);return s>3&&a&&Object.defineProperty(t,n,a),a},Me=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},He=function(e,t){return function(n,r){t(n,r,e)}},Ue=function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function a(e){try{c(r.next(e))}catch(t){s(t)}}function i(e){try{c(r.throw(e))}catch(t){s(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,i)}c((r=r.apply(e,t||[])).next())}))},Ve=function(e){function t(t,n){var r;return(r=e.call(this)||this).workbenchInitServiceLoader=t,r.instantiationService=n,r}(0,r.Z)(t,e);var n=t.prototype;return n.safeRun=function(){return Ue(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.initWorkbench();case 2:return e.abrupt("return");case 3:case"end":return e.stop()}}),e,this)})))},n.initWorkbench=function(){return Ue(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.workbenchInitServiceLoader.setDi(this.instantiationService),e.next=3,this.workbenchInitServiceLoader.getInstance();case 3:return t=e.sent,e.next=6,t.init();case 6:case"end":return e.stop()}}),e,this)})))},t}(N.E);Ve=Fe([He(0,Q),He(1,o.TG),Me("design:paramtypes",["function"===typeof(je="undefined"!==typeof te&&te)?je:Object,"function"===typeof(ke="undefined"!==typeof o.TG&&o.TG)?ke:Object])],Ve);var Ze,Ge=function(e,t,n,r){var o,s=arguments.length,a=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var i=e.length-1;i>=0;i--)(o=e[i])&&(a=(s<3?o(a):s>3?o(t,n,a):o(t,n))||a);return s>3&&a&&Object.defineProperty(t,n,a),a},Be=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},We=function(e,t){return function(n,r){t(n,r,e)}},Ke=function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function a(e){try{c(r.next(e))}catch(t){s(t)}}function i(e){try{c(r.throw(e))}catch(t){s(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,i)}c((r=r.apply(e,t||[])).next())}))},Ye=function(e){function t(t){var n;return(n=e.call(this)||this).workbenchState=t,n}(0,r.Z)(t,e);var n=t.prototype;return n.safeRun=function(){return Ke(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.renderHeaderBar();case 2:return e.abrupt("return");case 3:case"end":return e.stop()}}),e,this)})))},n.renderHeaderBar=function(){return Ke(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.workbenchState.waitReady();case 2:case"end":return e.stop()}}),e,this)})))},t}(N.E);Ye=Ge([We(0,$.i),Be("design:paramtypes",["function"===typeof(Ze="undefined"!==typeof $.i&&$.i)?Ze:Object])],Ye),n("../node_modules/core-js/modules/web.dom-collections.for-each.js");var ze,Xe,qe=n("../node_modules/@tencent/ioc/lib/esm/index.js"),Je=n("../node_modules/@tencent/workbench/lib/esm/services/toolbar/toolbar-service.js"),Qe=n("../spread-sheet/src/flow/browser/phase/workbench/workbench-feature-loader-registry.ts"),$e=function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function a(e){try{c(r.next(e))}catch(t){s(t)}}function i(e){try{c(r.throw(e))}catch(t){s(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,i)}c((r=r.apply(e,t||[])).next())}))},et=function(e){function t(){return e.apply(this,arguments)||this}return(0,r.Z)(t,e),t.prototype.safeRun=function(){return $e(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Qe.P.getLoaders().forEach((function(e){return $e(t,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e();case 2:qe.Am.get(Je.O).update();case 3:case"end":return t.stop()}}),t)})))})),e.abrupt("return");case 3:case"end":return e.stop()}}),e)})))},t}(N.E),tt=n("../spread-sheet/src/flow/browser/phase/services/sheetLifecyle.interface.ts"),nt=function(e,t,n,r){var o,s=arguments.length,a=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var i=e.length-1;i>=0;i--)(o=e[i])&&(a=(s<3?o(a):s>3?o(t,n,a):o(t,n))||a);return s>3&&a&&Object.defineProperty(t,n,a),a},rt=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},ot=function(e,t){return function(n,r){t(n,r,e)}},st=function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function a(e){try{c(r.next(e))}catch(t){s(t)}}function i(e){try{c(r.throw(e))}catch(t){s(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,i)}c((r=r.apply(e,t||[])).next())}))},at=function(e){function t(t,n){var r;return(r=e.call(this)||this).app=t,r.sheetLifeService=n,r}return(0,r.Z)(t,e),t.prototype.safeRun=function(){return st(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.app.emitter.emit(this.app.EVENT.SPREAD_SHEET_PLUGINS_END),this.sheetLifeService.phase=tt.P.SPREAD_SHEET_PLUGINS_END,this.sheetLifeService.phase=tt.P.PAGE_LOAD_FINISHED,e.abrupt("return");case 4:case"end":return e.stop()}}),e,this)})))},t}(N.E);at=nt([ot(0,C.m),ot(1,tt.n),rt("design:paramtypes",["function"===typeof(ze="undefined"!==typeof C.m&&C.m)?ze:Object,"function"===typeof(Xe="undefined"!==typeof tt.n&&tt.n)?Xe:Object])],at),s.VW.register(O.Hq,le.B),s.VW.register(O.uP,ge),s.VW.register(O.vn,we),s.VW.register(O.c9,ye),s.VW.register(O.T3,at),s.VW.register(O.g_,De),s.VW.register(O.l1,Le),s.VW.register(O.ZJ,Ve),s.VW.register(O.hf,Ye),s.VW.register(O.CE,et);var it,ct=(0,o.yh)("IEditPluginService"),ut=function(e,t,n,r){var o,s=arguments.length,a=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var i=e.length-1;i>=0;i--)(o=e[i])&&(a=(s<3?o(a):s>3?o(t,n,a):o(t,n))||a);return s>3&&a&&Object.defineProperty(t,n,a),a},dt=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},lt=function(e,t){return function(n,r){t(n,r,e)}},pt=function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function a(e){try{c(r.next(e))}catch(t){s(t)}}function i(e){try{c(r.throw(e))}catch(t){s(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,i)}c((r=r.apply(e,t||[])).next())}))},ht=function(e){function t(t){var n;return(n=e.call(this)||this).pcEditPluginService=t,n}return(0,r.Z)(t,e),t.prototype.safeRun=function(){return pt(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.pcEditPluginService.getInstance();case 2:return t=e.sent,e.next=5,t.init();case 5:return e.abrupt("return");case 6:case"end":return e.stop()}}),e,this)})))},t}(N.E);ht=ut([lt(0,ct),dt("design:paramtypes",["function"===typeof(it="undefined"!==typeof o.IDynamicLoader&&o.IDynamicLoader)?it:Object])],ht);var _t,ft,mt=(0,o.yh)("IReadonlyPluginService"),vt=n("../spread-sheet/src/flow/browser/phase/services/plugins/level2/readonly-plugins-service-pc.ts"),Et=function(e,t,n,r){var o,s=arguments.length,a=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var i=e.length-1;i>=0;i--)(o=e[i])&&(a=(s<3?o(a):s>3?o(t,n,a):o(t,n))||a);return s>3&&a&&Object.defineProperty(t,n,a),a},gt=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},Rt=function(e,t){return function(n,r){t(n,r,e)}},St=function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function a(e){try{c(r.next(e))}catch(t){s(t)}}function i(e){try{c(r.throw(e))}catch(t){s(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,i)}c((r=r.apply(e,t||[])).next())}))},At=function(e){function t(t,n){var r;return(r=e.call(this)||this).pcReadonlyPluginService=t,r.pcReadonlyLevel2Service=n,r}return(0,r.Z)(t,e),t.prototype.safeRun=function(){return St(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.pcReadonlyPluginService.getInstance();case 3:return t=e.sent,e.next=6,t.init();case 6:e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),console.error("pcReadonlyPluginService");case 11:return e.prev=11,e.next=14,this.pcReadonlyLevel2Service.getInstance();case 14:return n=e.sent,e.next=17,n.init();case 17:e.next=22;break;case 19:e.prev=19,e.t1=e.catch(11),console.error("pcReadonlyLevel2Service");case 22:return e.abrupt("return");case 23:case"end":return e.stop()}}),e,this,[[0,8],[11,19]])})))},t}(N.E);At=Et([Rt(0,mt),Rt(1,vt.IReadonlyLevel2Service),gt("design:paramtypes",["function"===typeof(_t="undefined"!==typeof o.IDynamicLoader&&o.IDynamicLoader)?_t:Object,"function"===typeof(ft="undefined"!==typeof o.IDynamicLoader&&o.IDynamicLoader)?ft:Object])],At),s.VW.register(O.vo,M),s.VW.register(O.GS,U),s.VW.register(O.bN,ae),s.VW.register(O.N6,G),s.VW.register(O.dJ,ht),s.VW.register(O.OX,At);var wt=n("../spread-sheet/src/core/app/SpreadsheetApp.ts"),Tt=n("../packages/mutation/src/index.ts"),yt=n("../packages/undoRedoStack/src/index.ts"),It=n("../spread-sheet/src/core/app/permissions/index.ts"),Ot=n("../spread-sheet/src/core/app/permissions/permissionManage.ts"),Dt=n("../spread-sheet/src/core/behavior/api.interface.ts"),bt=n("../spread-sheet/src/base/event/event.ts"),Ct=n("../packages/model/src/spreadsheet/Spreadsheet.interface.ts"),xt=n("../packages/model/src/spreadsheet/Spreadsheet.ts"),Nt=n("../spread-sheet/src/core/view/layout/pcView.ts"),Pt=n("../spread-sheet/src/core/view/layout/interface/pc-view.ts"),Lt=n("../spread-sheet/src/flow/browser/phase/services/commandService.ts"),jt=n("../spread-sheet/src/core/view/data-call-view/DataCallView.interface.ts"),kt=n("../spread-sheet/src/core/view/data-call-view/DataCallView.ts"),Ft=n("../spread-sheet/src/core/view/lib/mutex-management/MutexManagement.interface.ts"),Mt=n("../spread-sheet/src/core/view/lib/mutex-management/MutexManagement.ts"),Ht=n("../spread-sheet/src/core/app/contributes/interface.ts"),Ut=n("../spread-sheet/src/core/app/contributes/index.ts"),Vt=n("../spread-sheet/src/external/sheet-adapter/sheet-adapter-manager.interface.ts"),Zt=n("../spread-sheet/src/external/sheet-adapter/sheet-adapter-manager.ts"),Gt=n("../spread-sheet/src/core/feature/relateForm/relate-form.interface.ts"),Bt=n("../spread-sheet/src/core/feature/relateForm/index.ts"),Wt=n("../spread-sheet/src/flow/browser/phase/services/sdkCoreService.interface.ts"),Kt=n("../spread-sheet/src/flow/browser/phase/services/sdkCoreService.ts"),Yt=n("../spread-sheet/src/flow/browser/phase/services/partInteractable.interface.ts"),zt=n("../spread-sheet/src/flow/browser/phase/services/partInteractable.ts"),Xt=n("../spread-sheet/src/flow/lib/scheduler/base/barrier.ts"),qt=function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function a(e){try{c(r.next(e))}catch(t){s(t)}}function i(e){try{c(r.throw(e))}catch(t){s(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,i)}c((r=r.apply(e,t||[])).next())}))},Jt=function(){function e(){this.asyncLock=new Xt.U}var t=e.prototype;return t.waitReady=function(){return qt(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.asyncLock.wait());case 1:case"end":return e.stop()}}),e,this)})))},t.onReady=function(){this.asyncLock.isOpen()||this.asyncLock.open()},e}(),Qt=n("../spread-sheet/src/flow/browser/phase/services/sheetLifecycle.ts"),$t=n("../spread-sheet/src/base/report/core-link-reporter.ts"),en=function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function a(e){try{c(r.next(e))}catch(t){s(t)}}function i(e){try{c(r.throw(e))}catch(t){s(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,i)}c((r=r.apply(e,t||[])).next())}))};s.I6.register(C.m,wt.Z),s.I6.register(Ct.V,xt.Z),s.I6.register(jt.Z,kt.Z),s.I6.register(Ft.Z,Mt.Z),s.I6.register(Pt.w,Nt.Z),s.I6.register(P.T,P.Z),s.I6.register($t.$,$t.Z),s.VW.register(Tt.Dm,Tt.kS,[],!0),s.VW.register(yt.vT,yt.gp),s.VW.register(It.H,It.P),s.VW.register(Ot.a,Ot.N),s.VW.register(bt.l9,bt.ju),s.VW.register(Gt.e,Bt.default),s.VW.register(Dt.V,function(e){function t(){return e.apply(this,arguments)||this}return(0,r.Z)(t,e),t.prototype.getModule=function(){return en(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([n.e("initial_vendors_public_1"),n.e("initial_chunk_part_2"),n.e("vendors-node_modules_atob_browser-atob_js-node_modules_pako_index_js"),n.e("spread-sheet_src_core_app_dataCallCore_ts-spread-sheet_src_external_view_workbench_service_cr-4ddb4c"),n.e("bundle_module_behavior_api")]).then(n.bind(n,"../spread-sheet/src/core/behavior/api.ts"));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))},t}(o.RU)),s.VW.register(Lt.H,Lt.Z),s.VW.register(Ht.T,Ut.Z),s.VW.register(Vt.c,Zt.Z),s.VW.register(Wt.i,Kt.ZP),s.VW.register(Yt.P,zt.Z),s.VW.register(he,function(e){function t(){return e.apply(this,arguments)||this}return(0,r.Z)(t,e),t.prototype.getModule=function(){return en(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([n.e("initial_vendors_public_1"),n.e("vendors-node_modules_atob_browser-atob_js-node_modules_pako_index_js"),n.e("vendors-node_modules_tencent_ark-offline-edit_lib_index_js"),n.e("spread-sheet_src_core_app_dataCallCore_ts-spread-sheet_src_external_view_workbench_service_cr-4ddb4c"),n.e("bundle_messageService")]).then(n.bind(n,"../spread-sheet/src/flow/browser/phase/services/messageService.ts"));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))},t}(o.RU)),s.VW.register(_e.k,function(e){function t(){return e.apply(this,arguments)||this}return(0,r.Z)(t,e),t.prototype.getModule=function(){return en(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([n.e("initial_vendors_public_1"),n.e("spread-sheet_src_core_feature_formula_controller_ts-spread-sheet_src_core_worker_worker-threa-ff1554"),n.e("bundle_workerService")]).then(n.bind(n,"../spread-sheet/src/flow/browser/phase/services/workerService.ts"));case 2:return e.abrupt("return",e.sent.CalculationService);case 3:case"end":return e.stop()}}),e)})))},t}(o.RU)),s.VW.register(_e.V,function(e){function t(){return e.apply(this,arguments)||this}return(0,r.Z)(t,e),t.prototype.getModule=function(){return en(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([n.e("initial_vendors_public_1"),n.e("spread-sheet_src_core_feature_formula_controller_ts-spread-sheet_src_core_worker_worker-threa-ff1554"),n.e("bundle_workerService")]).then(n.bind(n,"../spread-sheet/src/flow/browser/phase/services/workerService.ts"));case 2:return e.abrupt("return",e.sent.WorkerService);case 3:case"end":return e.stop()}}),e)})))},t}(o.RU)),s.VW.register(pe,function(e){function t(){return e.apply(this,arguments)||this}return(0,r.Z)(t,e),t.prototype.getModule=function(){return en(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([n.e("initial_vendors_public_1"),n.e("vendors-node_modules_atob_browser-atob_js-node_modules_pako_index_js"),n.e("spread-sheet_src_core_app_dataCallCore_ts-spread-sheet_src_external_view_workbench_service_cr-4ddb4c"),n.e("bundle_editableService")]).then(n.bind(n,"../spread-sheet/src/flow/browser/phase/services/editableService.ts"));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))},t}(o.RU)),s.VW.register(Q,te),s.VW.register($.i,Jt),s.VW.register(tt.n,Qt.h);var tn=n("../spread-sheet/src/flow/lib/tasks/names.ts"),nn=n("../spread-sheet/src/flow/lib/tasks/common/hide-first-loading.ts"),rn=n("../spread-sheet/src/flow/lib/tasks/common/show-data-sync-loading.ts"),on=n("../spread-sheet/src/flow/lib/tasks/common/hide-all-loading.ts");s.VW.register(tn.UU,nn.k),s.VW.register(tn.Oh,rn.x),s.VW.register(tn.QY,on.K);var sn=function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function a(e){try{c(r.next(e))}catch(t){s(t)}}function i(e){try{c(r.throw(e))}catch(t){s(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,i)}c((r=r.apply(e,t||[])).next())}))};s.VW.register(mt,function(e){function t(){return e.apply(this,arguments)||this}return(0,r.Z)(t,e),t.prototype.getModule=function(){return sn(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.e("bundle_pcReadonlyPluginService").then(n.bind(n,"../spread-sheet/src/flow/browser/phase/services/plugins/level1/readonly-plugins-service-pc.ts"));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))},t}(o.RU)),s.VW.register(vt.IReadonlyLevel2Service,function(e){function t(){return e.apply(this,arguments)||this}return(0,r.Z)(t,e),t.prototype.getModule=function(){return sn(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.resolve().then(n.bind(n,"../spread-sheet/src/flow/browser/phase/services/plugins/level2/readonly-plugins-service-pc.ts"));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))},t}(o.RU)),s.VW.register(ct,function(e){function t(){return e.apply(this,arguments)||this}return(0,r.Z)(t,e),t.prototype.getModule=function(){return sn(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.e("bundle_pcEditPluginService").then(n.bind(n,"../spread-sheet/src/flow/browser/phase/services/plugins/level2/edit-plugins-service-pc.ts"));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))},t}(o.RU))},"../spread-sheet/src/flow/browser/tasks/common/render-editor-first-screen.ts":function(e,t,n){n.d(t,{B:function(){return f}});var r,o,s,a=n("../node_modules/@babel/runtime/helpers/esm/inheritsLoose.js"),i=(n("../node_modules/regenerator-runtime/runtime.js"),n("../node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),n("../node_modules/core-js/modules/esnext.reflect.metadata.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.promise.js"),n("../spread-sheet/src/flow/browser/phase/services/partInteractable.interface.ts")),c=n("../spread-sheet/src/flow/browser/phase/services/sdkCoreService.interface.ts"),u=n("../spread-sheet/src/flow/lib/scheduler/base/safe-task.ts"),d=n("../spread-sheet/src/flow/browser/phase/services/sheetLifecyle.interface.ts"),l=function(e,t,n,r){var o,s=arguments.length,a=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var i=e.length-1;i>=0;i--)(o=e[i])&&(a=(s<3?o(a):s>3?o(t,n,a):o(t,n))||a);return s>3&&a&&Object.defineProperty(t,n,a),a},p=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},h=function(e,t){return function(n,r){t(n,r,e)}},_=function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function a(e){try{c(r.next(e))}catch(t){s(t)}}function i(e){try{c(r.throw(e))}catch(t){s(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,i)}c((r=r.apply(e,t||[])).next())}))},f=function(e){function t(t,n,r){var o;return(o=e.call(this)||this).sdkCoreService=t,o.partInteractableService=n,o.sheetLifeService=r,o}return(0,a.Z)(t,e),t.prototype.safeRun=function(){return _(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.sheetLifeService.phase=d.P.PAGE_LOAD_START,e.next=3,this.sdkCoreService.initSdkCore();case 3:return e.next=5,this.partInteractableService.initPartInteractable();case 5:return e.abrupt("return");case 6:case"end":return e.stop()}}),e,this)})))},t}(u.E);f=l([h(0,c.i),h(1,i.P),h(2,d.n),p("design:paramtypes",["function"===typeof(r="undefined"!==typeof c.i&&c.i)?r:Object,"function"===typeof(o="undefined"!==typeof i.P&&i.P)?o:Object,"function"===typeof(s="undefined"!==typeof d.n&&d.n)?s:Object])],f)},"../spread-sheet/src/flow/browser/tasks/names.ts":function(e,t,n){n.d(t,{CE:function(){return h},GS:function(){return m},Hq:function(){return o},N6:function(){return d},OX:function(){return E},T3:function(){return f},ZJ:function(){return l},bN:function(){return v},c9:function(){return u},dJ:function(){return g},g_:function(){return _},hf:function(){return p},l1:function(){return c},uP:function(){return a},vn:function(){return s},vo:function(){return i}});var r=n("../node_modules/@tencent/containerized/build/main/index.js"),o=(0,r.yh)("IRenderFirstScreenTask"),s=(0,r.yh)("IHideEditorSSRTask"),a=(0,r.yh)("IInitEditorServiceTask"),i=(0,r.yh)("IIniitFeature"),c=(0,r.yh)("IInitTencentMettingTask"),u=(0,r.yh)("IHideHeaderBarSSRTask"),d=(0,r.yh)("IToggleToolbarModeTask"),l=((0,r.yh)("IInitPluginServiceTask"),(0,r.yh)("IStartInitWorkbenchFrameworkTask")),p=(0,r.yh)("IWorkbenchFrameworkReadyTask"),h=(0,r.yh)("IWorkbenchFeatureLoadTask"),_=(0,r.yh)("IReportPVTask"),f=(0,r.yh)("IEmitInitPluginsEndTask"),m=(0,r.yh)("IRenderPcHeaderBarTask"),v=(0,r.yh)("IRenderPcFooterBarTask"),E=(0,r.yh)("IInitPcReadonlyPluginServiceTask"),g=(0,r.yh)("IInitPcEditPluginServiceTask");(0,r.yh)("IRenderMobileHeaderBarTask"),(0,r.yh)("IRenderMobileSheetBarTask"),(0,r.yh)("IRenderMobileTopBarTask"),(0,r.yh)("IRenderMobileToolbarTask"),(0,r.yh)("IInitMobileBarsInteractionTask"),(0,r.yh)("IInitMobileReadonlyPluginServiceTask"),(0,r.yh)("IInitMobileEditPluginServiceTask"),(0,r.yh)("IRenderPadHeaderBarTask"),(0,r.yh)("IRenderPadSheetBarTask"),(0,r.yh)("IRenderPadTopBarTask"),(0,r.yh)("IRenderPadToolBarTask"),(0,r.yh)("IInitPadBarsInteractionTask")},"../spread-sheet/src/flow/common/initialization.ts":function(e,t,n){n.d(t,{Ch:function(){return l},I6:function(){return o},Q2:function(){return d},QI:function(){return a},R1:function(){return u},V7:function(){return i},VW:function(){return s}}),n("../node_modules/core-js/modules/web.dom-collections.for-each.js");var r=n("../node_modules/@tencent/containerized/build/main/index.js"),o=new r.o5,s=new r.o5,a=new r.FS,i=a.createChild(),c=i.createChild();r.RU.initStaticInstantiationService(c);var u=function(){o.getServiceDescriptors().forEach((function(e){var t=e[0],n=e[1];a.addService(t,n)}))},d=function(){s.getServiceDescriptors().forEach((function(e){var t=e[0],n=e[1];i.addService(t,n)}))},l=function(e,t,n,o){(0,r.kl)(c,e,t,n,o)}},"../spread-sheet/src/flow/common/utils.ts":function(e,t,n){n.d(t,{AU:function(){return d},UG:function(){return c},dD:function(){return u}}),n("../node_modules/regenerator-runtime/runtime.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.promise.js"),n("../node_modules/core-js/modules/web.dom-collections.for-each.js"),n("../node_modules/core-js/modules/es.array.map.js"),n("../node_modules/core-js/modules/es.array.filter.js"),n("../node_modules/core-js/modules/es.string.iterator.js"),n("../node_modules/core-js/modules/es.array.iterator.js"),n("../node_modules/core-js/modules/web.dom-collections.iterator.js"),n("../node_modules/core-js/modules/es.array.find.js"),n("../node_modules/core-js/modules/es.array.join.js"),n("../node_modules/core-js/modules/es.array.slice.js"),n("../node_modules/core-js/modules/es.function.name.js"),n("../node_modules/core-js/modules/es.array.from.js"),n("../node_modules/core-js/modules/es.symbol.js"),n("../node_modules/core-js/modules/es.symbol.description.js"),n("../node_modules/core-js/modules/es.symbol.iterator.js"),n("../node_modules/@tencent/docs-user-agent/dist/index.js");var r=n("../packages/model/src/utils/index.ts");function o(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){if(e){if("string"===typeof e)return s(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?s(e,t):void 0}}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0;return function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function s(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var a,i=function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function a(e){try{c(r.next(e))}catch(t){s(t)}}function i(e){try{c(r.throw(e))}catch(t){s(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,i)}c((r=r.apply(e,t||[])).next())}))},c={deduplication:function(e){var t=[],n={};return e.forEach((function(e){n[e.id]||(t.push(e),n[e.id]=1)})),t},checkAllHidden:function(e){var t=!0;return e.forEach((function(e){!1!==e.hidden&&void 0!==e.hidden||(t=!1)})),t},checkCurrHidden:function(e,t){var n=!1;return e.forEach((function(e){e.id===t&&(n=!!e.hidden)})),n},showOnlySheet:function(e,t){return e.map((function(e){var n=e;return e.id===t&&(n.hidden=!1),n}))},showNextSheet:function(e,t){var n=e.filter((function(e){return!1===e.hidden||void 0===e.hidden||e.id===t})).map((function(e){return e.id}));if(n.length<=1)return n[0];var r=n.indexOf(t);return 0===r?n[1]:n[r-1]},initExternalSDK:function(e,t){return i(void 0,void 0,void 0,regeneratorRuntime.mark((function n(){var s,a,i,c;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:s=[],a=regeneratorRuntime.mark((function e(){var n,o,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=c.value,o=n.type,s.find((function(e){return e===o}))||!o){e.next=8;break}if(s.push(o),!(0,r.getIsExternalSheetBySheetType)(o)){e.next=8;break}return a=t.sheetAdapterManager.getAdapterBySheetType(o),e.next=8,null===a||void 0===a?void 0:a.init();case 8:case"end":return e.stop()}}),e)})),i=o(e);case 3:if((c=i()).done){n.next=7;break}return n.delegateYield(a(),"t0",5);case 5:n.next=3;break;case 7:case"end":return n.stop()}}),n)})))},getSheetType:function(e,t){var n=e.find((function(e){return e.id===t}));return null===n||void 0===n?void 0:n.type}};function u(e){if(!e||!(e instanceof Array)||0===e.length)return{role:"",canRead:!1,canShowInWedrive:!1,canModifyAuth:!1,canEdit:!1,canExport:!1,canPrint:!1,canShare:!1,canSaveAsLink:!1,canMove:!1,canCopy:!1,canClone:!1,canSaveAsTemplate:!1,canForward:!1,canHistory:!1};var t={};e.forEach((function(e){return t[e]=!0}));var n=function(e){return!0===t[e]};return{role:"",canRead:n(a.DocView),canModifyAuth:n(a.ShowAuthInfo),canModifyAuthSelfInvited:n(a.CanModifyAuthSelfInvited),canModifyAuthAny:n(a.CanModifyAuthAny),canDelete:n(a.CanDelete),canShowInWedrive:n(a.DocSaveAsLink),canEdit:n(a.DocEdit),canExport:n(a.DocExport),canPrint:n(a.DocPrint),canShare:n(a.DocShare),canSaveAsLink:n(a.DocSaveAsLink),canMove:n(a.SpaceObjectMove),canCopy:n(a.DocCopyContent),canClone:n(a.DocClone),canSaveAsTemplate:n(a.DocSaveAsTemplate),canForward:n(a.DocForward),canHistory:n(a.DocHistory)}}function d(e){var t,n;return(null===(n=null===(t=window.basicClientVars)||void 0===t?void 0:t.userInfo)||void 0===n?void 0:n.userType)===e}!function(e){e[e.SpaceMember=21]="SpaceMember",e[e.SpaceObjectMove=22]="SpaceObjectMove",e[e.ShowAuthInfo=100]="ShowAuthInfo",e[e.CanModifyAuthSelfInvited=104]="CanModifyAuthSelfInvited",e[e.CanModifyAuthAny=103]="CanModifyAuthAny",e[e.CanDelete=23]="CanDelete",e[e.DocView=112]="DocView",e[e.DocEdit=150]="DocEdit",e[e.DocExport=151]="DocExport",e[e.DocPrint=152]="DocPrint",e[e.DocShare=153]="DocShare",e[e.DocSaveAsLink=154]="DocSaveAsLink",e[e.DocCopyContent=155]="DocCopyContent",e[e.DocClone=156]="DocClone",e[e.DocSaveAsTemplate=157]="DocSaveAsTemplate",e[e.DocForward=158]="DocForward",e[e.DocHistory=159]="DocHistory"}(a||(a={}))},"../spread-sheet/src/flow/history/index.ts":function(e,t,n){n.d(t,{Z:function(){return w}}),n("../spread-sheet/src/flow/browser/index.ts");var r,o,s,a,i,c,u,d=n("../spread-sheet/src/flow/common/initialization.ts"),l=(n("../node_modules/regenerator-runtime/runtime.js"),n("../node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),n("../node_modules/core-js/modules/esnext.reflect.metadata.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.promise.js"),n("../node_modules/@tencent/tdoc-scheduler/lib/tdoc-scheduler.cjs.js")),p=n("../spread-sheet/src/flow/history/tasks/names.ts"),h=n("../spread-sheet/src/flow/browser/tasks/names.ts"),_=n("../spread-sheet/src/flow/lib/tasks/names.ts"),f=n("../spread-sheet/src/flow/lib/scheduler/base/safe-job.ts"),m=function(e,t,n,r){var o,s=arguments.length,a=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var i=e.length-1;i>=0;i--)(o=e[i])&&(a=(s<3?o(a):s>3?o(t,n,a):o(t,n))||a);return s>3&&a&&Object.defineProperty(t,n,a),a},v=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},E=function(e,t){return function(n,r){t(n,r,e)}},g=function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function a(e){try{c(r.next(e))}catch(t){s(t)}}function i(e){try{c(r.throw(e))}catch(t){s(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,i)}c((r=r.apply(e,t||[])).next())}))},R=function(){function e(e,t,n,r,o,s,a){this.renderHistoryFirstScreen=e,this.initHistoryEditorService=t,this.hideHistoryFristLoading=n,this.showHistoryDataSyncLoading=r,this.initHistoryFeature=o,this.renderHistoryFooter=s,this.hideAllHistoryLoading=a}return e.prototype.start=function(){return g(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=new l.Wf,(n=f.A.getSafeJob()).serialNext([this.renderHistoryFirstScreen,this.hideHistoryFristLoading,this.showHistoryDataSyncLoading,this.initHistoryEditorService,this.initHistoryFeature,this.renderHistoryFooter,this.hideAllHistoryLoading]),t.add(n),e.next=6,t.done();case 6:case"end":return e.stop()}}),e,this)})))},e}();R=m([E(0,h.Hq),E(1,p._5),E(2,_.UU),E(3,_.Oh),E(4,p.Fq),E(5,p.Bi),E(6,_.QY),v("design:paramtypes",["function"===typeof(r="undefined"!==typeof l.ITask&&l.ITask)?r:Object,"function"===typeof(o="undefined"!==typeof l.ITask&&l.ITask)?o:Object,"function"===typeof(s="undefined"!==typeof l.ITask&&l.ITask)?s:Object,"function"===typeof(a="undefined"!==typeof l.ITask&&l.ITask)?a:Object,"function"===typeof(i="undefined"!==typeof l.ITask&&l.ITask)?i:Object,"function"===typeof(c="undefined"!==typeof l.ITask&&l.ITask)?c:Object,"function"===typeof(u="undefined"!==typeof l.ITask&&l.ITask)?u:Object])],R);var S=n("../spread-sheet/src/core/app/SpreadsheetApp.interface.ts"),A=n("../packages/lib/EventEmitter.ts"),w=function(){function e(){this.initAppService(),this.initSpreadsheetApp(),this.initCoreService()}var t=e.prototype;return t.startSheetLife=function(){var e;null===(e=n.g.log)||void 0===e||e.info("flow: startSheetLife()"),d.V7.createInstance(R).start()},t.initAppService=function(){(0,d.R1)()},t.initCoreService=function(){(0,d.Q2)()},t.initSpreadsheetApp=function(){var e=this;d.QI.invokeFunction((function(t){var r=t.get(S.m);e.app=r,n.g.SpreadsheetApp=r;var o=new A.Z;e.app.initEmitter(o),e.initListenLifeCycle()}))},t.initListenLifeCycle=function(){var e,t=this;null===(e=n.g.log)||void 0===e||e.info("flow","initListenLifeCycle()"),this.app.emitter.on(this.app.EVENT.PAGE_LOAD_START,(function(){t.app.setLifeCycle(t.app.EVENT.PAGE_LOAD_START)})),this.app.emitter.on(this.app.EVENT.SPREAD_SHEET_SDK_CORE_END,(function(){t.app.setLifeCycle(t.app.EVENT.SPREAD_SHEET_SDK_CORE_END)})),this.app.emitter.on(this.app.EVENT.SPREAD_SHEET_PART_INTERACTIVE_END,(function(){t.app.setLifeCycle(t.app.EVENT.SPREAD_SHEET_PART_INTERACTIVE_END)})),this.app.emitter.on(this.app.EVENT.SPREAD_SHEET_MESSAGE_END,(function(){t.app.setLifeCycle(t.app.EVENT.SPREAD_SHEET_MESSAGE_END)})),this.app.emitter.on(this.app.EVENT.SPREAD_SHEET_PLUGINS_END,(function(){t.app.setLifeCycle(t.app.EVENT.SPREAD_SHEET_PLUGINS_END)})),this.app.emitter.on(this.app.EVENT.PAGE_LOAD_FINISHED,(function(){t.app.setLifeCycle(t.app.EVENT.PAGE_LOAD_FINISHED)}))},e}()},"../spread-sheet/src/flow/history/registry/pc.ts":function(e,t,n){var r=n("../node_modules/@babel/runtime/helpers/esm/inheritsLoose.js"),o=(n("../node_modules/regenerator-runtime/runtime.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.promise.js"),n("../node_modules/core-js/modules/es.array.iterator.js"),n("../node_modules/core-js/modules/es.string.iterator.js"),n("../node_modules/core-js/modules/web.dom-collections.iterator.js"),n("../spread-sheet/src/flow/common/initialization.ts")),s=n("../spread-sheet/src/core/app/SpreadsheetApp.ts"),a=n("../spread-sheet/src/core/app/SpreadsheetApp.interface.ts"),i=n("../packages/mutation/src/index.ts"),c=n("../spread-sheet/src/core/app/permissions/index.ts"),u=n("../spread-sheet/src/core/app/sheetStatus/index.ts"),d=n("../spread-sheet/src/base/event/event.ts"),l=n("../packages/model/src/spreadsheet/index.ts"),p=n("../packages/model/src/spreadsheet/Spreadsheet.ts"),h=n("../spread-sheet/src/core/view/layout/pcPreviewView.ts"),_=n("../node_modules/@tencent/containerized/build/main/index.js"),f=(0,_.yh)("IHistoryDataCenter"),m=n("../node_modules/@babel/runtime/helpers/esm/createClass.js"),v=(n("../node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),n("../node_modules/core-js/modules/esnext.reflect.metadata.js"),n("../node_modules/core-js/modules/web.dom-collections.for-each.js"),n("../node_modules/core-js/modules/es.number.constructor.js"),n("../node_modules/core-js/modules/es.object.assign.js"),n("../node_modules/core-js/modules/es.array.join.js"),n("../node_modules/core-js/modules/es.array.map.js"),n("../node_modules/core-js/modules/es.regexp.exec.js"),n("../node_modules/core-js/modules/es.string.replace.js"),n("../packages/report/src/index.ts")),E=n("../spread-sheet/src/base/config/report.ts"),g=n("./node_modules/axios/index.js"),R=n.n(g),S=n("../packages/utils/src/safe.ts"),A=n("../spread-sheet/src/core/data/converter/tencentdoc/keyframeToSheetConverter.ts"),w=n("../packages/model/src/range/index.ts"),T=n("../packages/model/src/dimension/index.ts"),y=n("../packages/model/src/cell/format/colorUtils.ts"),I=n("../packages/model/src/cell/CellFormatDelta.ts"),O=n("../packages/model/src/cell/CellDataDelta.ts"),D=n("../packages/model/src/cell/CellDataSlot.ts"),b=n("../packages/model/src/cell/CellFormatSlot.ts"),C=n("../packages/mutation/src/cell/SetCellPropertiesMutation.ts");function x(e,t){var n=t.color,r=t.author,o=t.gridRange;if(o){var s=new I.Z;n&&s.setSlot(b.Z.BACKGROUND_COLOR,(0,y.transparentColor)(n,.2));var a=new O.Z;a.setSlot(D.Z.SLOT_EFFIECTIVE_FORMAT_DELTA,s),a.setSlot(D.Z.SLOT_AUTHOR,r);var i=new C.Z({gridRange:o,cellDataDelta:a});e.spreadsheetReference.parent.mutationBehavior.applyMutation(i,{isLocal:!0},e)}}var N,P,L,j,k=n("../packages/common-utils/src/index.ts"),F=n("../spread-sheet/src/core/feature/formula/workUtils.ts"),M=n("../spread-sheet/src/external/history/base/utils/authors-info.ts"),H=n("../node_modules/qs/lib/index.js"),U=n.n(H),V=n("../spread-sheet/src/core/data/configService/spreadConfig.ts"),Z=(n("../node_modules/core-js/modules/es.array.filter.js"),n("../packages/mutation/src/MutationId.ts")),G=function(){function e(e){this.historyGrid={},this.focusIndex=0,this.app=e}var t=e.prototype;return t.resetHistoryGrid=function(e){this.historyGrid[e]=[]},t.getHistoryGridById=function(e){return this.historyGrid[e]},t.getHistoryGridSizeById=function(e){var t;return(null===(t=this.historyGrid[e])||void 0===t?void 0:t.length)||0},t.resetFocusIndex=function(){this.focusIndex=0},t.createEditCellGrid=function(e,t){var n=this;if(this.app.spreadsheet.sheetManager.getSheetBySheetId(e)){var r=function(){var r=t.author,o=t.action,s=[];if(o.forEach((function(e){"ms"!==e.type&&"ct"!==e.type&&"revert"!==e.type&&s.push(n.app.spreadsheet.parent.mutationBehavior.getCollabMutations(e))})),s)for(var a=0,i=s.length;a<i;a++)s[a].forEach((function(t){n.handleMutation(e,t,r)}));return{v:n.historyGrid[e]}}();if("object"===typeof r)return r.v}},t.focusOn=function(e){var t=this.app.view.canvas.recordHover;if(this.historyGrid[this.app.spreadsheet.activeSheetId]&&0!==this.historyGrid[this.app.spreadsheet.activeSheetId].length){this.focusIndex=e%this.historyGrid[this.app.spreadsheet.activeSheetId].length;var n=this.historyGrid[this.app.spreadsheet.activeSheetId][this.focusIndex].gridRange,r=n.startRowIndex,o=n.startColIndex,s=n.endRowIndex,a=n.endColIndex;this.app.view.canvas.scrollApi.scrollToVisible({row:r,col:o,x:25,y:100},!0),this.app.view.canvas.selectApi.selectCells(this.app.view.canvas.normalSelectData,{xRange:[o,a],yRange:[r,s]},null),t.showTips(r,o)}else t.hideTips()},t.deleteExistHistory=function(e,t){var n;this.historyGrid[e]=null===(n=this.historyGrid[e])||void 0===n?void 0:n.filter((function(e){if(!e)return!1;var n=e.gridRange;return!t.contain(n)}))},t.updateHistoryGrid=function(e,t,n){var r;this.deleteExistHistory(e,t),null===(r=this.historyGrid[e])||void 0===r||r.push({gridRange:t,author:n})},t.handleMutation=function(e,t,n){switch(t.operationType=i.g8.HISTORY,t.id){case Z.ZP.INSERT_DIMENSION_MUTATION:this.handleInsertDimensionMutation(e,t,n);break;case Z.ZP.DELETE_DIMENSION_MUTATION:this.handleDeleteDimensionMutation(e,t);break;case Z.ZP.SET_DIMENSION_PROPERTIES_MUTATION:this.handleSetDimensionPropertiesMutation(e,t,n);break;case Z.ZP.SET_CELL_PROPERTIES_MUTATION:case Z.ZP.DEFINE_FILTER_MUTATION:case Z.ZP.SET_RANGE_MUTATION:this.handleCellRangeMutation(e,t,n);break;case Z.ZP.MERGE_CELLS_MUTATION:case Z.ZP.UNMERGE_CELLS_MUTATION:this.handleMergeCellsMutation(e,t,n);break;case Z.ZP.COPY_PASTE_MUTATION:this.handleCopyPasteMutation(e,t,n);break;case Z.ZP.REORDER_RANGE_MUTATION:this.handleReorderRangeMutation(e,t,n)}},t.handleSetDimensionPropertiesMutation=function(e,t,n){var r=t.ranges[0],o=this.app.spreadsheet.sheetManager.getSheetBySheetId(e);if(o&&r){var s=t.type===T.DIMENSION_TYPE.COLUMNS,a=r.startIndex,i=r.endIndex,c=new w.GridRange(e,s?0:a,s?o.getRowCount()-1:i,s?a:0,s?i:o.getColCount()-1);this.updateHistoryGrid(e,c,n)}},t.handleMergeCellsMutation=function(e,t,n){var r=new w.GridRange(e,t.startRowIndex,t.endRowIndex,t.startColIndex,t.endColIndex);this.updateHistoryGrid(e,r,n)},t.handleInsertDimensionMutation=function(e,t,n){var r,o,s,a,i=t.type,c=t.amount,u=t.index;if(i===T.DIMENSION_TYPE.ROWS){null===(r=this.historyGrid[e])||void 0===r||r.filter((function(e){return!!e})).forEach((function(e){if(null===e||void 0===e?void 0:e.gridRange){var t=e.gridRange;u<=t.startRowIndex?(t.startRowIndex=t.startRowIndex+c,t.endRowIndex=t.endRowIndex+c):u>=t.startRowIndex&&u+c<t.endRowIndex&&(t.endRowIndex=t.endRowIndex+c)}}));var d=((null===(o=this.app.spreadsheet.sheetManager.getSheetBySheetId(e))||void 0===o?void 0:o.getColCount())||0)-1,l=new w.GridRange(e,u,u+c-1,0,d);this.updateHistoryGrid(e,l,n)}else{null===(s=this.historyGrid[e])||void 0===s||s.filter((function(e){return!!e})).forEach((function(e){if(null===e||void 0===e?void 0:e.gridRange){var t=e.gridRange;u<=t.startColIndex?(t.startColIndex=t.startColIndex+c,t.endColIndex=t.endColIndex+c):u>=t.startColIndex&&u+c<t.endColIndex&&(t.endColIndex=t.endColIndex+c)}}));var p=((null===(a=this.app.spreadsheet.sheetManager.getSheetBySheetId(e))||void 0===a?void 0:a.getRowCount())||0)-1,h=new w.GridRange(e,0,p,u,u+c-1);this.updateHistoryGrid(e,h,n)}},t.handleDeleteDimensionMutation=function(e,t){var n,r,o=this,s=t.type,a=t.index,i=t.amount,c=a+i-1;s===T.DIMENSION_TYPE.ROWS?null===(n=this.historyGrid[e])||void 0===n||n.forEach((function(t,n){if(t){var r=t.gridRange;a<=r.startRowIndex&&c>=r.endRowIndex?o.historyGrid[e]&&(o.historyGrid[e][n]=null):a<=r.startRowIndex?(r.startRowIndex=Math.max(r.startRowIndex-i,a),r.endRowIndex=Math.max(r.endRowIndex-i,a)):a>=r.startRowIndex&&a<=r.endRowIndex&&(r.endRowIndex=Math.max(r.endRowIndex-i,a-1))}})):null===(r=this.historyGrid[e])||void 0===r||r.forEach((function(t,n){if(t){var r=t.gridRange;a<=r.startColIndex&&c>=r.endColIndex?o.historyGrid[e]&&(o.historyGrid[e][n]=null):a<=r.startColIndex?(r.startColIndex=Math.max(r.startColIndex-i,a),r.endColIndex=Math.max(r.endColIndex-i,a)):a>=r.startColIndex&&a<=r.endColIndex&&(r.endColIndex=Math.max(r.endColIndex-i,a-1))}}))},t.handleCellRangeMutation=function(e,t,n){this.updateHistoryGrid(e,t.gridRange,n)},t.handleCopyPasteMutation=function(e,t,n){var r=this;t.pasteMappings.forEach((function(t){r.updateHistoryGrid(e,t.destination,n)}))},t.handleReorderRangeMutation=function(e,t,n){this.updateHistoryGrid(e,t.range,n)},e}(),B=n("../packages/lib/index.ts"),W=n("../spread-sheet/src/core/data/converter/keyframe/keyframe.ts"),K=n("../packages/model/src/utils/index.ts"),Y=n("../spread-sheet/src/base/util/appConfig.ts"),z=function(e,t,n,r){var o,s=arguments.length,a=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var i=e.length-1;i>=0;i--)(o=e[i])&&(a=(s<3?o(a):s>3?o(t,n,a):o(t,n))||a);return s>3&&a&&Object.defineProperty(t,n,a),a},X=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},q=function(e,t){return function(n,r){t(n,r,e)}},J=function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function a(e){try{c(r.next(e))}catch(t){s(t)}}function i(e){try{c(r.throw(e))}catch(t){s(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,i)}c((r=r.apply(e,t||[])).next())}))},Q=M.Z.getInstance(),$=function(){function e(e,t){var r=this;this.spreadsheet=e,this.app=t,this.onLoadSheetEmitter=new B.Q5,this.loadTaskId=0,this.onResponse=function(e,t,n,o,s,a){return J(r,void 0,void 0,regeneratorRuntime.mark((function r(){var i,c,u,d,l,p,h,_,f,m=this;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(i=this.dataOptions,c=i.subId,u=i.revertAuthor,d=i.isFirst,t===this.loadTaskId){r.next=3;break}return r.abrupt("return");case 3:return l=this.spreadsheet.sheetManager.getSheetBySheetId(c),p=l.getSheetType(),h=l.isExternalSheet(),_=function(){return(0,A.Z)(m.spreadsheet,c,e,n,o,{afterConvert:function(){var e;if(m.cellEditHistory.resetFocusIndex(),m.cellEditHistory.resetHistoryGrid(c),null===s||void 0===s?void 0:s.length){for(var t=0;t<s.length;t++)m.cellEditHistory.createEditCellGrid(c,{author:s[t].author,action:JSON.parse(s[t].action)});null===(e=m.cellEditHistory.getHistoryGridById(c))||void 0===e||e.forEach((function(e){e&&m.handleMutation(e)}))}else u&&m.revertCallback(l,{author:u});m.onLoadSheetEmitter.fire()}})},this.handleResponse(p,a,h?void 0:_),r.next=10,this.getAuthorsInfo(s);case 10:f=r.sent,this.saveAuthorsInfo(f),d||(0,F.f)(this.spreadsheet,c).needLoadInWorker&&this.app.mainThreadWorker.sheetData.initSheet({sheetData:e,sheetId:c,sheetTitle:l.getName(),startRow:n,endRow:o});case 13:case"end":return r.stop()}}),r,this)})))},this.cellEditHistory=new G(this.app),this.onLoadSheet=this.onLoadSheetEmitter.event,n.g.addEventListener("replaceState",(function(){return J(r,void 0,void 0,regeneratorRuntime.mark((function e(){var t,r,o,s,a,i=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.app.mainThreadWorker){e.next=3;break}return n.g.location.reload(),e.abrupt("return");case 3:return null===(t=n.g.snackLoading)||void 0===t||t.show(),o=(0,k.IZ)("revertAuthor"),e.next=7,this.loadSheetList({padId:(0,k.IZ)("padId"),rev:Number((0,k.IZ)("rev")),fRev:o?-1:Number((0,k.IZ)("fRev"))});case 7:s=e.sent,a=s.some((function(e){return e.id===i.spreadsheet.activeSheetId&&!e.hidden}))?this.spreadsheet.activeSheetId:s[0].id,this.updateSpreadsheet({sheetList:s,activeSheetId:a}),this.loadSheetData({subId:a,rev:Number((0,k.IZ)("rev")),fRev:Number((0,k.IZ)("fRev")),padId:(0,k.IZ)("padId"),wb:1,revertAuthor:o},null===(r=n.g.snackLoading)||void 0===r?void 0:r.hide);case 11:case"end":return e.stop()}}),e,this)})))}))}var t=e.prototype;return t.loadSheetList=function(e){var t,n;return J(this,void 0,void 0,regeneratorRuntime.mark((function r(){var o,s,a;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return this.listOptions=e,(o=JSON.parse(JSON.stringify(e))).fRev<0&&delete o.fRev,r.next=5,R().get("/dop-api/get/tabs",{params:Object.assign(Object.assign({},e),{xsrf:(0,S.f)()})});case 5:return s=r.sent,a=s.data,r.abrupt("return",null===(n=null===(t=null===a||void 0===a?void 0:a.header)||void 0===t?void 0:t[0])||void 0===n?void 0:n.d);case 8:case"end":return r.stop()}}),r,this)})))},t.loadSheetData=function(e,t){return J(this,void 0,void 0,regeneratorRuntime.mark((function n(){var r,o,s;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(this.loadTaskId+=1,e.isSwitch?this.dataOptions=Object.assign(Object.assign(Object.assign({},this.dataOptions),e),{isFirst:!1}):this.dataOptions=Object.assign(Object.assign({},e),{nowb:void 0===e.wb?this.dataOptions.nowb:1^e.wb}),!(null===(r=this.spreadsheet.sheetManager.getSheetBySheetId(e.subId))||void 0===r?void 0:r.isLoaded)){n.next=8;break}return this.spreadsheet.setActiveSheetId(e.subId),o=r.getSheetType(),this.handleResponse(o),n.abrupt("return");case 8:if(e.isFirst||this.clearManager(),!this.showOfflineData){n.next=15;break}return n.next=12,this.offlineLoader();case 12:s=n.sent,n.next=18;break;case 15:return n.next=17,this.serverLoader(this.onResponse,this.loadTaskId);case 17:s=n.sent;case 18:return null===t||void 0===t||t(0===(null===s||void 0===s?void 0:s.retcode)),n.abrupt("return",s);case 20:case"end":return n.stop()}}),n,this)})))},t.offlineLoader=function(){return J(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})))},t.serverLoader=function(e,t){var n;return J(this,void 0,void 0,regeneratorRuntime.mark((function r(){var o,s,a,i,c,u,d;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(this.dataOptions.subId||(this.dataOptions.subId=this.spreadsheet.getActiveSheetId()),o=this.spreadsheet.sheetManager.getSheetBySheetId(this.dataOptions.subId)){r.next=4;break}return r.abrupt("return");case 4:return v.ZP.run(E.CONFIG.PREVIEW_SERVER_SHEET_DATA,[this.dataOptions]),o.startLoading(),r.prev=6,(s=JSON.parse(JSON.stringify(this.dataOptions))).fRev>=0&&!s.revertAuthor||delete s.fRev,delete s.isFirst,delete s.revertAuthor,r.next=13,R().get("/dop-api/get/sheet",{params:Object.assign(Object.assign({},s),{xsrf:(0,S.f)(),_r:parseInt(String(1e4*Math.random())),revdata:1})});case 13:if(200!==(a=r.sent).status||0!==(null===(n=a.data)||void 0===n?void 0:n.retcode)){r.next=21;break}return i=a.data,v.ZP.run(E.CONFIG.PREVIEW_SERVER_SHEET_DATA_ON_RESPONSE,[this.dataOptions]),c=i.data,u=c.initialAttributedText,d=c.actionlist,e(u.text,t,0,i.data.maxrow-1,d,i.data),o.stopLoading(!0),r.abrupt("return",i);case 21:o.stopLoading(!1),r.next=27;break;case 24:r.prev=24,r.t0=r.catch(6),o.stopLoading(!1);case 27:case"end":return r.stop()}}),r,this,[[6,24]])})))},t.handleMutation=function(e){var t=this.spreadsheet.sheetManager.getSheetBySheetId(this.dataOptions.subId),n=e.author,r=Q.getColorFromId(n);r&&x(t,{gridRange:e.gridRange,author:n,color:r})},t.revertCallback=function(e,t){var n=t.author,r=Q.getColorFromId(n),o=e.getColCount()-1,s=e.getRowCount()-1;x(e,{gridRange:new w.GridRange(e.getSheetId(),0,s,0,o),author:n,color:r})},t.handleResponse=function(e,t,n){var r,o=this,s=this.dataOptions,a=s.isFirst,i=s.subId;if(v.ZP.jank.log({moduleValue:"keyframeMutation",actionValue:"switchRecordSheet"}),a||this.app.view.canvas.dataCallView.stop(),null===n||void 0===n||n(),!a)if((0,K.getIsExternalSheetBySheetType)(e)){this.app.viewManager.hiddenOtherContainer(e);var c=this.app.sheetAdapterManager.getAdapterBySheetType(e);null===c||void 0===c||c.renderHistory(this.spreadsheet.activeSheetId,this.historyDataFormat(t)),this.app.view.canvas.dataCallView.start()}else this.app.viewManager.hiddenOtherContainer(e),this.app.view.canvas.dataCallView.start(),this.app.view.canvas.resize.resize(),this.app.view.canvas.init(this.spreadsheet.activeSheetId),this.app.view.render(this.spreadsheet.activeSheetId);!a&&this.app.view.footer?(this.app.view.footer.spreadsheet=this.spreadsheet,null===(r=this.app.view.footer)||void 0===r||r.refreshUI(),d.ZP.sheetsBar.trigger("switchSheetEnd",i)):a||d.ZP.sheetsBar.listen("loadEnd",(function(){o.app.view.footer.spreadsheet=o.spreadsheet,d.ZP.sheetsBar.trigger("switchSheetEnd",i)}))},t.clearAndReInitSheets=function(e){this.app.mainThreadWorker.sheetData.clearAndReInitSheets({sheetList:e}),this.spreadsheet.sheetManager.clearSheets(),this.spreadsheet.sheetManager.setSheets(e)},t.clearManager=function(){this.spreadsheet.workbookRangeManager.clear(),this.spreadsheet.embeddedObjectManager.clear()},t.updateSpreadsheet=function(e){var t=e.spreadsheetId,n=e.title,r=e.activeSheetId,o=e.baseVersion,s=e.sheetList,a={spreadsheetId:t||(0,k.IZ)("padId"),title:n||"",baseVersion:o||Number((0,k.IZ)("rev")),activeSheetId:r,sheetList:s};this.app.initOptions=a,this.spreadsheet.reInit({spreadsheetId:t,title:n,sheetList:s,activeSheetId:r}),this.clearAndReInitSheets(s),this.spreadsheet.setActiveSheetId(r)},t.getAuthorsInfo=function(e){var t,n;return J(this,void 0,void 0,regeneratorRuntime.mark((function r(){var o,s,a;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(o=[],null===e||void 0===e||e.forEach((function(e){var t=e.author;Q.getNameFromId(t)||o.push(t)})),0!==o.length){r.next=4;break}return r.abrupt("return",[]);case 4:return s=U().stringify({bkn:(0,S.G)(),domainId:V.q.getConfig("domainId"),localPadId:V.q.getConfig("padId"),uids:"["+o.map((function(e){return e.replace(/^(.*)\./,"")})).join(",")+"]",xsrf:(0,S.f)()}),r.prev=5,r.next=8,R().post("//"+Y.Z.getConfig("runtime.domainName")+"/sdc/getusermarkname",s,{withCredentials:!0});case 8:a=r.sent,r.next=14;break;case 11:r.prev=11,r.t0=r.catch(5),console.error(r.t0);case 14:if(0!==(null===(t=null===a||void 0===a?void 0:a.data)||void 0===t?void 0:t.retcode)||!(null===(n=a.data.result)||void 0===n?void 0:n.rsp)){r.next=16;break}return r.abrupt("return",a.data.result.rsp);case 16:return r.abrupt("return",[]);case 18:case"end":return r.stop()}}),r,null,[[5,11]])})))},t.saveAuthorsInfo=function(e){e.forEach((function(e){Q.setName("p."+e.uid,e.markName)}))},t.historyDataFormat=function(e){var t,n;return(null===(t=null===e||void 0===e?void 0:e.initialAttributedText)||void 0===t?void 0:t.text)&&(e.initialAttributedText.text=(0,W.C)(null===(n=null===e||void 0===e?void 0:e.initialAttributedText)||void 0===n?void 0:n.text)),e},(0,m.Z)(e,[{key:"showOfflineData",get:function(){return n.g.showOfflineData}}]),e}(),ee=$=z([q(0,l.ISpreadsheet),q(1,a.m),X("design:paramtypes",["function"===typeof(N="undefined"!==typeof l.ISpreadsheet&&l.ISpreadsheet)?N:Object,"function"===typeof(P="undefined"!==typeof a.m&&a.m)?P:Object])],$),te=n("../spread-sheet/src/flow/browser/phase/services/commandService.ts"),ne=n("../spread-sheet/src/core/app/contributes/interface.ts"),re=n("../spread-sheet/src/core/app/contributes/index.ts"),oe=n("../spread-sheet/src/core/view/data-call-view/DataCallView.interface.ts"),se=n("../spread-sheet/src/core/view/data-call-view/DataCallView.ts"),ae=n("../spread-sheet/src/core/view/lib/mutex-management/MutexManagement.interface.ts"),ie=n("../spread-sheet/src/core/view/lib/mutex-management/MutexManagement.ts"),ce=n("../spread-sheet/src/core/app/permissions/permissionManage.ts"),ue=n("../spread-sheet/src/core/behavior/api.interface.ts"),de=n("../spread-sheet/src/flow/browser/phase/services/sdkCoreService.interface.ts"),le=(n("../node_modules/core-js/modules/es.array.find.js"),n("../packages/mutation/src/api.interface.ts")),pe=n("../spread-sheet/src/flow/common/utils.ts"),he=n("../spread-sheet/src/core/view-manager/index.ts"),_e=n("../spread-sheet/src/external/sheet-adapter/sheet-adapter-manager.interface.ts"),fe=n("../spread-sheet/src/external/history/base/config.ts"),me=n("../spread-sheet/src/core/app/event-init.ts"),ve=n("../node_modules/@tencent/workbench/lib/esm/index.js"),Ee=function(e,t,n,r){var o,s=arguments.length,a=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var i=e.length-1;i>=0;i--)(o=e[i])&&(a=(s<3?o(a):s>3?o(t,n,a):o(t,n))||a);return s>3&&a&&Object.defineProperty(t,n,a),a},ge=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},Re=function(e,t){return function(n,r){t(n,r,e)}},Se=function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function a(e){try{c(r.next(e))}catch(t){s(t)}}function i(e){try{c(r.throw(e))}catch(t){s(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,i)}c((r=r.apply(e,t||[])).next())}))};window.workbench=ve;var Ae,we,Te,ye,Ie,Oe=function(){return Number((0,k.IZ)("rev"))||V.q.getConfig("rev")},De=function(){return Number((0,k.IZ)("fRev"))||V.q.getConfig("rev")},be=function(){return(0,k.IZ)("padId")||V.q.getConfig("globalPadId")},Ce=function(){function e(e,t){this.app=e,this.instantiationService=t}var t=e.prototype;return t.initSdkCore=function(){var e,t;return Se(this,void 0,void 0,regeneratorRuntime.mark((function r(){var o,s,a,i,d,p,h,_=this;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(null===(e=n.g.log)||void 0===e||e.debug("History flow SdkCoreService initSdkCore()"),this.app.emitter.emit(this.app.EVENT.SPREAD_SHEET_SDK_CORE_START),null===(o=this.initSpreadConfig())||void 0===o?void 0:o.getConfig("canRead")){r.next=5;break}return r.abrupt("return");case 5:return this.app.data={initMutations:[]},this.app.viewManager=new he.v(this.app),this.instantiationService.invokeFunction((function(e){if(_.app.sheetStatus)_.app.sheetStatus.update();else{var t=e.get(u.T);_.app.initSheetStatus(t)}var n=e.get(c.H);_.app.initPermissions(n);var r=e.get(l.ISpreadsheet);_.app.initSpreadsheet(r);var o=e.get(le.D);_.app.initMutationBehavior(o);var s=e.get(f);_.app.initHistoryDataCenter(s);var a=e.get(_e.c);_.app.initSheetAdapterManager(a)})),r.next=10,this.app.sheetAdapterManager.init();case 10:return this.initPermissions(),this.initEvent(),r.next=14,this.app.historyDataCenter.loadSheetList({padId:be(),rev:Oe(),fRev:De()});case 14:if((s=r.sent)&&0!==s.length){r.next=17;break}return r.abrupt("return");case 17:if(a=this.getDefaultSheetId(s)){r.next=20;break}return r.abrupt("return");case 20:return r.next=22,pe.UG.initExternalSDK(s,this.app);case 22:return this.updateSpreadsheet({title:o.getConfig("title"),sheetList:s,defaultSheetId:a,spreadsheetId:be(),baseVersion:Oe()}),r.next=25,this.app.historyDataCenter.loadSheetData({subId:a,rev:Oe(),fRev:De(),padId:be(),wb:1,isFirst:!0,revertAuthor:(0,k.IZ)("revertAuthor")},(function(e){e&&(_.app.emitter.emit(_.app.EVENT.SPREAD_SHEET_ALL_CHUNK_READY),n.g.SpreadsheetAppInitComplete=!0)}));case 25:i=r.sent,d=this.app.spreadsheet.sheetManager.getSheetBySheetId(a),p=d.getSheetType(),h=this.app.sheetAdapterManager.getAdapterBySheetType(p),this.app.viewManager.hiddenOtherContainer(p),null===h||void 0===h||h.renderHistory(a,this.historyDataFormat(i.data)),this.app.setInited(!0),this.app.emitter.emit(this.app.EVENT.SPREAD_SHEET_SDK_CORE_END),null===(t=n.g.parent)||void 0===t||t.dispatchEvent(new Event(fe.Z.Ready));case 34:case"end":return r.stop()}}),r,this)})))},t.initEvent=function(){var e;null===(e=n.g.log)||void 0===e||e.info("History flow","SdkCoreService initEvent()"),new me.Z(this.app)},t.updateSpreadsheet=function(e){var t,r=e.sheetList,o=e.spreadsheetId,s=e.defaultSheetId,a=e.title,i=e.baseVersion;null===(t=n.g.log)||void 0===t||t.info("History flow","SdkCoreService updateSpreadsheet()",e);var c={spreadsheetId:o,title:a,sheetList:r,activeSheetId:s,baseVersion:i};this.app.initOptions=c,this.app.spreadsheet.reInit({spreadsheetId:o,title:a,sheetList:r,activeSheetId:s}),(0,A.Z)(this.app.spreadsheet,s,[],null,null),this.app.setInited(!0)},t.initSpreadConfig=function(){var e,t=n.g.openDocResponseText,r="string"===typeof t?JSON.parse(t):t;if("sheet"===r.padType)return r.clientVars.isHistory=!0,n.g.clientVars=r.clientVars,V.q.reloadConfig(r.clientVars),n.g.spreadConfig=V.q,n.g.openDocResponseText=void 0,V.q;null===(e=n.g.log)||void 0===e||e.error("修订记录 openDoc padType 错误, padType: "+(null===r||void 0===r?void 0:r.padType))},t.initPermissions=function(){this.app.permissions.update(V.q),this.app.permissions.setWorkbookStatusCanEdit(!1),this.app.permissions.setWorkbookStatusCanComment(!1)},t.getDefaultSheetId=function(e){if(e.some((function(e){return e.id===(0,k.IZ)("tab")&&!e.hidden})))return(0,k.IZ)("tab");var t=e.find((function(e){return!e.hidden}));return null===t||void 0===t?void 0:t.id},t.historyDataFormat=function(e){var t,n;return(null===(t=null===e||void 0===e?void 0:e.initialAttributedText)||void 0===t?void 0:t.text)&&(e.initialAttributedText.text=(0,W.C)(null===(n=null===e||void 0===e?void 0:e.initialAttributedText)||void 0===n?void 0:n.text)),e},e}(),xe=Ce=Ee([Re(0,a.m),Re(1,_.TG),ge("design:paramtypes",["function"===typeof(L="undefined"!==typeof a.m&&a.m)?L:Object,"function"===typeof(j="undefined"!==typeof _.TG&&_.TG)?j:Object])],Ce),Ne=n("../spread-sheet/src/flow/browser/phase/services/partInteractable.interface.ts"),Pe=n("../spread-sheet/src/flow/browser/phase/services/partInteractable.ts"),Le=n("../core-sheet/js/report/whitescreen.js"),je=n("../spread-sheet/src/core/view/spreadsheet-view/SpreadsheetView.browser.ts"),ke=n("../spread-sheet/src/core/view/spreadsheet-view/SpreadsheetView.interface.ts"),Fe=function(e,t,n,r){var o,s=arguments.length,a=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var i=e.length-1;i>=0;i--)(o=e[i])&&(a=(s<3?o(a):s>3?o(t,n,a):o(t,n))||a);return s>3&&a&&Object.defineProperty(t,n,a),a},Me=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},He=function(e,t){return function(n,r){t(n,r,e)}},Ue=function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function a(e){try{c(r.next(e))}catch(t){s(t)}}function i(e){try{c(r.throw(e))}catch(t){s(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,i)}c((r=r.apply(e,t||[])).next())}))},Ve=function(){function e(e,t){this.app=e,this.instantiationService=t}var t=e.prototype;return t.initPartInteractable=function(){var e,t;return Ue(this,void 0,void 0,regeneratorRuntime.mark((function r(){return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return null===(e=n.g.log)||void 0===e||e.info("History flow PartInteractableService initPartInteractable()",!!this.app.view),this.app.emitter.emit(this.app.EVENT.SPREAD_SHEET_PART_INTERACTIVE_START,this.app.spreadsheet.activeSheetId),this.app.initInstantiationService(this.instantiationService),Le.IF.start(),this.initCanvasDom(),null===(t=n.g.log)||void 0===t||t.info("flow","PartInteractableService init view & Canvas"),this.initView(),r.next=9,this.app.view.initCanvas();case 9:Le.IF.end(),this.app.emitter.emit(this.app.EVENT.SPREAD_SHEET_PART_INTERACTIVE_END,this.app.spreadsheet.activeSheetId);case 11:case"end":return r.stop()}}),r,this)})))},t.initCanvasDom=function(){var e=(0,Pe.I)();this.initSpreadsheetView(e)},t.initSpreadsheetView=function(e){var t,r=this;null===(t=n.g.log)||void 0===t||t.info("History flow","PartInteractableService initSpreadsheetView()"),this.app.instantiationService.invokeFunction((function(t){var n,o=new je.Z(e,t.get(l.ISpreadsheet),t.get(oe.Z));null===(n=r.app.instantiationService.getParent())||void 0===n||n.addService(ke.Z,o)}))},t.initView=function(){var e,t=this;null===(e=n.g.log)||void 0===e||e.debug("History flow PartInteractableService initView()"),this.instantiationService.invokeFunction((function(e){var n=e.get(h.w);t.app.initView(n)}))},e}(),Ze=Ve=Fe([He(0,a.m),He(1,_.TG),Me("design:paramtypes",["function"===typeof(Ae="undefined"!==typeof a.m&&a.m)?Ae:Object,"function"===typeof(we="undefined"!==typeof _.TG&&_.TG)?we:Object])],Ve),Ge=n("../spread-sheet/src/core/feature/Feature.preview.interface.ts"),Be=n("../spread-sheet/src/external/view/main/footer/footer.interface.ts"),We=n("../spread-sheet/src/flow/browser/phase/services/workerService.interface.ts"),Ke=n("../spread-sheet/src/flow/browser/tasks/common/render-editor-first-screen.ts"),Ye=n("../spread-sheet/src/flow/history/tasks/names.ts"),ze=n("../spread-sheet/src/base/event/eventName.ts"),Xe=n("../spread-sheet/src/core/feature/Feature.interface.ts"),qe=n("../spread-sheet/src/external/waterMark/config.ts"),Je=n("../spread-sheet/src/external/waterMark/watermark.tsx"),Qe=n("../spread-sheet/src/flow/lib/scheduler/base/safe-task.ts"),$e=function(e,t,n,r){var o,s=arguments.length,a=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var i=e.length-1;i>=0;i--)(o=e[i])&&(a=(s<3?o(a):s>3?o(t,n,a):o(t,n))||a);return s>3&&a&&Object.defineProperty(t,n,a),a},et=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},tt=function(e,t){return function(n,r){t(n,r,e)}},nt=function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function a(e){try{c(r.next(e))}catch(t){s(t)}}function i(e){try{c(r.throw(e))}catch(t){s(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,i)}c((r=r.apply(e,t||[])).next())}))},rt=function(e){function t(t,n,r){var o;return(o=e.call(this)||this).app=t,o.instantiationService=n,o.dynamicFeature=r,o}(0,r.Z)(t,e);var o=t.prototype;return o.safeRun=function(){return nt(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.app.emitter.emit(this.app.EVENT.SPREAD_SHEET_PLUGINS_START),this.initCSS(),e.next=4,this.initWatermark();case 4:return e.next=6,this.initFeature();case 6:return this.app.event.init.listen(ze.W1.AFTER_ALL_RENDER,this.emitPageLoadFinished.bind(this)),e.abrupt("return");case 8:case"end":return e.stop()}}),e,this)})))},o.emitPageLoadFinished=function(){this.app.emitter.emit(this.app.EVENT.PAGE_LOAD_FINISHED)},o.initCSS=function(){n.e("bundle_base_css").then(n.bind(n,"../core-sheet/css/base.less")),n.e("bundle_lazy_css").then(n.bind(n,"../core-sheet/css/index-lazy-pc.less"))},o.initFeature=function(){var e;return nt(this,void 0,void 0,regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.dynamicFeature.getInstance();case 2:return r=t.sent,this.app.initFeature(r),t.next=6,r.init();case 6:null===(e=n.g.log)||void 0===e||e.debug("History flow PcPluginService initFeature() end");case 7:case"end":return t.stop()}}),t,this)})))},o.initWatermark=function(){return nt(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!qe.a){e.next=3;break}return e.next=3,(0,Je.t)(!1);case 3:case"end":return e.stop()}}),e)})))},t}(Qe.E);rt=$e([tt(0,a.m),tt(1,_.TG),tt(2,Xe._),et("design:paramtypes",["function"===typeof(Te="undefined"!==typeof a.m&&a.m)?Te:Object,"function"===typeof(ye="undefined"!==typeof _.TG&&_.TG)?ye:Object,"function"===typeof(Ie="undefined"!==typeof _.IDynamicLoader&&_.IDynamicLoader)?Ie:Object])],rt);var ot,st,at=function(e,t,n,r){var o,s=arguments.length,a=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var i=e.length-1;i>=0;i--)(o=e[i])&&(a=(s<3?o(a):s>3?o(t,n,a):o(t,n))||a);return s>3&&a&&Object.defineProperty(t,n,a),a},it=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},ct=function(e,t){return function(n,r){t(n,r,e)}},ut=function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function a(e){try{c(r.next(e))}catch(t){s(t)}}function i(e){try{c(r.throw(e))}catch(t){s(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,i)}c((r=r.apply(e,t||[])).next())}))},dt=function(e){function t(t,n){var r;return(r=e.call(this)||this).app=t,r.footer=n,r}(0,r.Z)(t,e);var n=t.prototype;return n.safeRun=function(){return ut(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.initFooter();case 2:return this.app.emitter.emit(this.app.EVENT.SPREAD_SHEET_PLUGINS_END),e.abrupt("return");case 4:case"end":return e.stop()}}),e,this)})))},n.initFooter=function(){return ut(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.footer.getInstance();case 2:return t=e.sent,this.app.view.footer=t,e.next=6,t.init({});case 6:case"end":return e.stop()}}),e,this)})))},t}(Qe.E);dt=at([ct(0,a.m),ct(1,Be.F),it("design:paramtypes",["function"===typeof(ot="undefined"!==typeof a.m&&a.m)?ot:Object,"function"===typeof(st="undefined"!==typeof _.IDynamicLoader&&_.IDynamicLoader)?st:Object])],dt);var lt,pt,ht=function(e,t,n,r){var o,s=arguments.length,a=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var i=e.length-1;i>=0;i--)(o=e[i])&&(a=(s<3?o(a):s>3?o(t,n,a):o(t,n))||a);return s>3&&a&&Object.defineProperty(t,n,a),a},_t=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},ft=function(e,t){return function(n,r){t(n,r,e)}},mt=function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function a(e){try{c(r.next(e))}catch(t){s(t)}}function i(e){try{c(r.throw(e))}catch(t){s(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,i)}c((r=r.apply(e,t||[])).next())}))},vt=function(e){function t(t,n){var r;return(r=e.call(this)||this).calculationServiceLoader=t,r.workerServiceLoader=n,r}return(0,r.Z)(t,e),t.prototype.safeRun=function(){return mt(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.workerServiceLoader.getInstance();case 2:return t=e.sent,e.next=5,this.calculationServiceLoader.getInstance();case 5:return e.next=7,t.initWorker();case 7:return e.abrupt("return");case 8:case"end":return e.stop()}}),e,this)})))},t}(Qe.E);vt=ht([ft(0,We.k),ft(1,We.V),_t("design:paramtypes",["function"===typeof(lt="undefined"!==typeof _.IDynamicLoader&&_.IDynamicLoader)?lt:Object,"function"===typeof(pt="undefined"!==typeof _.IDynamicLoader&&_.IDynamicLoader)?pt:Object])],vt);var Et=n("../spread-sheet/src/flow/lib/tasks/names.ts"),gt=n("../spread-sheet/src/flow/lib/tasks/common/hide-first-loading.ts"),Rt=n("../spread-sheet/src/flow/lib/tasks/common/show-data-sync-loading.ts"),St=n("../spread-sheet/src/flow/lib/tasks/common/hide-all-loading.ts");o.VW.register(Et.UU,gt.k),o.VW.register(Et.Oh,Rt.x),o.VW.register(Et.QY,St.K);var At=n("../spread-sheet/src/flow/browser/tasks/names.ts"),wt=n("../spread-sheet/src/flow/browser/phase/services/sheetLifecycle.ts"),Tt=n("../spread-sheet/src/flow/browser/phase/services/sheetLifecyle.interface.ts"),yt=n("../spread-sheet/src/external/sheet-adapter/sheet-adapter-manager.ts"),It=n("../spread-sheet/src/external/collaboration/index.ts"),Ot=function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function a(e){try{c(r.next(e))}catch(t){s(t)}}function i(e){try{c(r.throw(e))}catch(t){s(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,i)}c((r=r.apply(e,t||[])).next())}))};o.I6.register(a.m,s.Z),o.I6.register(l.ISpreadsheet,p.Z),o.I6.register(oe.Z,se.Z),o.I6.register(ae.Z,ie.Z),o.I6.register(h.w,h.Z),o.I6.register(u.T,u.Z),o.VW.register(i.Dm,i.kS,[],!0),o.VW.register(f,ee),o.VW.register(c.H,c.P),o.VW.register(ce.a,ce.N),o.VW.register(d.l9,d.ju),o.VW.register(ue.V,function(e){function t(){return e.apply(this,arguments)||this}return(0,r.Z)(t,e),t.prototype.getModule=function(){return Ot(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",{default:function(){}});case 1:case"end":return e.stop()}}),e)})))},t}(_.RU)),o.VW.register(te.H,te.Z),o.VW.register(ne.T,re.Z),o.VW.register(_e.c,yt.Z),o.VW.register(It.pI,function(e){function t(){return e.apply(this,arguments)||this}return(0,r.Z)(t,e),t.prototype.getModule=function(){return Ot(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.resolve().then(n.bind(n,"../spread-sheet/src/external/collaboration/collaboration-manager.ts"));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))},t}(_.RU)),o.VW.register(We.k,function(e){function t(){return e.apply(this,arguments)||this}return(0,r.Z)(t,e),t.prototype.getModule=function(){return Ot(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([n.e("initial_vendors_public_1"),n.e("spread-sheet_src_core_feature_formula_controller_ts-spread-sheet_src_core_worker_worker-threa-ff1554"),n.e("bundle_workerService")]).then(n.bind(n,"../spread-sheet/src/flow/browser/phase/services/workerService.ts"));case 2:return e.abrupt("return",e.sent.CalculationService);case 3:case"end":return e.stop()}}),e)})))},t}(_.RU)),o.VW.register(We.V,function(e){function t(){return e.apply(this,arguments)||this}return(0,r.Z)(t,e),t.prototype.getModule=function(){return Ot(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([n.e("initial_vendors_public_1"),n.e("spread-sheet_src_core_feature_formula_controller_ts-spread-sheet_src_core_worker_worker-threa-ff1554"),n.e("bundle_workerService")]).then(n.bind(n,"../spread-sheet/src/flow/browser/phase/services/workerService.ts"));case 2:return e.abrupt("return",e.sent.WorkerService);case 3:case"end":return e.stop()}}),e)})))},t}(_.RU)),o.VW.register(Ge.e,function(e){function t(){return e.apply(this,arguments)||this}return(0,r.Z)(t,e),t.prototype.getModule=function(){return Ot(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([n.e("spread-sheet_src_base_util_decorator_loading-decorator_ts-spread-sheet_src_core_feature_copyP-33f189"),n.e("spread-sheet_src_core_feature_bootstrap_ts"),n.e("bundle_feature_preview")]).then(n.bind(n,"../spread-sheet/src/core/feature/Feature.preview.ts"));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))},t}(_.RU)),o.VW.register(Be.F,function(e){function t(){return e.apply(this,arguments)||this}return(0,r.Z)(t,e),t.prototype.getModule=function(){return Ot(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([n.e("vendors-node_modules_tencent_toggle-client-js_dist_toggle_es_js-node_modules_tencent_docs-des-f28a76"),n.e("spread-sheet_src_external_rangeAuth_loader_RangeAuthManager_ts-spread-sheet_src_external_view-9a5060"),n.e("bundle_plugin_pcFooter")]).then(n.bind(n,"../spread-sheet/src/external/view/pc/footer/footer.ts"));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))},t}(_.RU)),o.VW.register(de.i,xe),o.VW.register(Ne.P,Ze),o.VW.register(At.Hq,Ke.B),o.VW.register(Ye._5,vt),o.VW.register(Ye.Fq,rt),o.VW.register(Ye.Bi,dt),o.VW.register(Tt.n,wt.h)},"../spread-sheet/src/flow/history/tasks/names.ts":function(e,t,n){n.d(t,{Bi:function(){return a},Fq:function(){return s},_5:function(){return o}});var r=n("../node_modules/@tencent/containerized/build/main/index.js"),o=(0,r.yh)("IInitHistoryEditorServiceTask"),s=(0,r.yh)("IIniitHistoryFeature"),a=(0,r.yh)("IRenderHistoryFooter")},"../spread-sheet/src/flow/lib/scheduler/base/barrier.ts":function(e,t,n){n.d(t,{U:function(){return r}}),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.promise.js");var r=function(){function e(){var e=this;this.isInnerOpen=!1,this.innerPromise=new Promise((function(t){e.completePromise=t}))}var t=e.prototype;return t.isOpen=function(){return this.isInnerOpen},t.open=function(){this.isInnerOpen=!0,this.completePromise(!0)},t.wait=function(){return this.innerPromise},e}()},"../spread-sheet/src/flow/lib/scheduler/base/safe-job.ts":function(e,t,n){n.d(t,{A:function(){return o}});var r=n("../node_modules/@tencent/tdoc-scheduler/lib/tdoc-scheduler.cjs.js"),o=function(){function e(){}return e.getSafeJob=function(e){return new r.JC({onError:function(t){null===e||void 0===e||e(t),n.g.log.error("job error: "+t)}})},e}()},"../spread-sheet/src/flow/lib/scheduler/base/safe-task.ts":function(e,t,n){n.d(t,{E:function(){return c}}),n("../node_modules/regenerator-runtime/runtime.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.promise.js"),n("../node_modules/core-js/modules/es.function.name.js");var r=n("../node_modules/@tencent/tdoc-scheduler/lib/tdoc-scheduler.cjs.js"),o=n("../spread-sheet/src/flow/browser/phase/services/sdkCoreService.ts"),s=n("../spread-sheet/src/base/config/report.ts"),a=n("../packages/report/src/index.ts"),i=function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function a(e){try{c(r.next(e))}catch(t){s(t)}}function i(e){try{c(r.throw(e))}catch(t){s(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,i)}c((r=r.apply(e,t||[])).next())}))},c=function(){function e(){}return e.prototype.run=function(){return i(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.safeRun();case 3:t=e.sent,e.next=10;break;case 6:e.prev=6,e.t0=e.catch(0),t=e.t0,e.t0&&e.t0!==o.qs.NO_WHITE_SCREEN_ERROR&&(n.g.__ws.trigger("taskError"),n.g.log.error("task error: ",this.constructor.name,null===e.t0||void 0===e.t0?void 0:e.t0.message),n.g.log.error("task error: ",this.constructor.name,null===e.t0||void 0===e.t0?void 0:e.t0.stack),n.g.log.report("safe-task-error"),a.ZP.zzsStatus({attrid:s.ZZS_REPORT_ATTR.JS_FLOW_ERROR,status:1}));case 10:return e.abrupt("return",{data:t,status:r.TE.success});case 11:case"end":return e.stop()}}),e,this,[[0,6]])})))},e}()},"../spread-sheet/src/flow/lib/tasks/common/hide-all-loading.ts":function(e,t,n){n.d(t,{K:function(){return i}});var r=n("../node_modules/@babel/runtime/helpers/esm/inheritsLoose.js");function o(){var e;null===(e=n.g.log)||void 0===e||e.info("hideAllLoading()",!!n.g.snackLoading,!!n.g.brandLoading),n.g.snackLoading&&n.g.snackLoading.hide()}n("../node_modules/regenerator-runtime/runtime.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.promise.js");var s=n("../spread-sheet/src/flow/lib/scheduler/base/safe-task.ts"),a=function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function a(e){try{c(r.next(e))}catch(t){s(t)}}function i(e){try{c(r.throw(e))}catch(t){s(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,i)}c((r=r.apply(e,t||[])).next())}))},i=function(e){function t(){return e.apply(this,arguments)||this}return(0,r.Z)(t,e),t.prototype.safeRun=function(){return a(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o(),e.abrupt("return");case 2:case"end":return e.stop()}}),e)})))},t}(s.E)},"../spread-sheet/src/flow/lib/tasks/common/hide-first-loading.ts":function(e,t,n){n.d(t,{k:function(){return c}});var r=n("../node_modules/@babel/runtime/helpers/esm/inheritsLoose.js"),o=(n("../node_modules/regenerator-runtime/runtime.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.promise.js"),n("../node_modules/core-js/modules/es.array.iterator.js"),n("../node_modules/core-js/modules/es.string.iterator.js"),n("../node_modules/core-js/modules/web.dom-collections.iterator.js"),n("../node_modules/@tencent/docs-user-agent/dist/index.js")),s=n.n(o),a=n("../spread-sheet/src/flow/lib/scheduler/base/safe-task.ts"),i=function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function a(e){try{c(r.next(e))}catch(t){s(t)}}function i(e){try{c(r.throw(e))}catch(t){s(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,i)}c((r=r.apply(e,t||[])).next())}))},c=function(e){function t(){return e.apply(this,arguments)||this}(0,r.Z)(t,e);var o=t.prototype;return o.safeRun=function(){return i(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.removeLoading(),e.abrupt("return");case 2:case"end":return e.stop()}}),e,this)})))},o.removeLoading=function(){var e,t,r,o,a,c;return i(this,void 0,void 0,regeneratorRuntime.mark((function i(){return regeneratorRuntime.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:if(null===(t=null===(e=n.g.brandLoading)||void 0===e?void 0:e.hide)||void 0===t||t.call(e),!s().isTencentMeeting){i.next=11;break}if(null===(r=n.g.log)||void 0===r||r.info("tencentMeetingSDK.ui.closeLoading"),!(null===(o=n.g.tdocs)||void 0===o?void 0:o.closeLoading)){i.next=6;break}return null===(c=null===(a=n.g.tdocs)||void 0===a?void 0:a.closeLoading)||void 0===c||c.call(a),i.abrupt("return");case 6:return i.next=8,n.e("bundle_tencent-meeting-js-sdk").then(n.t.bind(n,"../node_modules/@tencent/wemeet-js-sdk/build/index.js",23));case 8:i.sent.ui.closeLoading().catch((function(){var e;null===(e=n.g.log)||void 0===e||e.error("tencentMeetingSDK.ui.closeLoading error")}));case 11:case"end":return i.stop()}}),i)})))},t}(a.E)},"../spread-sheet/src/flow/lib/tasks/common/show-data-sync-loading.ts":function(e,t,n){n.d(t,{x:function(){return i}});var r=n("../node_modules/@babel/runtime/helpers/esm/inheritsLoose.js"),o=(n("../node_modules/regenerator-runtime/runtime.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.promise.js"),n("../spread-sheet/src/core/data/configService/spreadConfigUtil.ts")),s=n("../spread-sheet/src/flow/lib/scheduler/base/safe-task.ts"),a=function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function a(e){try{c(r.next(e))}catch(t){s(t)}}function i(e){try{c(r.throw(e))}catch(t){s(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,i)}c((r=r.apply(e,t||[])).next())}))},i=function(e){function t(){return e.apply(this,arguments)||this}return(0,r.Z)(t,e),t.prototype.safeRun=function(){var e;return a(this,void 0,void 0,regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=!(0,o.c)(),n.g.snackLoading&&r&&(null===(e=n.g.log)||void 0===e||e.info("5s 后显示正在同步loading"),n.g.snackLoading.show(5e3)),t.abrupt("return");case 3:case"end":return t.stop()}}),t)})))},t}(s.E)},"../spread-sheet/src/flow/lib/tasks/names.ts":function(e,t,n){n.d(t,{Oh:function(){return s},QY:function(){return a},UU:function(){return o}});var r=n("../node_modules/@tencent/containerized/build/main/index.js"),o=(0,r.yh)("IHideLoadingTask"),s=(0,r.yh)("IShowDataSyncLoadingTask"),a=(0,r.yh)("IHideAllLodingTask")}}]),window.jsExecEndTimeStamp=Date.now(),window.cachedPerformanceEntries||(window.cachedPerformanceEntries=[]),window.cachedPerformanceEntries.push({name:"jsExec: js/initial_core_part_1.cf4eb11f2afdcca02841.js",entryType:"jsExec",startTime:window.jsExecStartTimeStamp,endTime:window.jsExecEndTimeStamp});
//# sourceMappingURL=initial_core_part_1.cf4eb11f2afdcca02841.js.map