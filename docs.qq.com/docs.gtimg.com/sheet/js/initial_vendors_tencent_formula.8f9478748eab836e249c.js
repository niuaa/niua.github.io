self.window=self,window.jsExecStartTimeStamp=Date.now(),(self.webpackChunk_tencent_alloy_builder=self.webpackChunk_tencent_alloy_builder||[]).push([["initial_vendors_tencent_formula"],{"../node_modules/@tencent/sheet-formula-sdk/lib/index.js":function(e,t,r){r.d(t,{AD:function(){return v},D_:function(){return C},Fz:function(){return A},Pz:function(){return y},QS:function(){return N},R8:function(){return I},VT:function(){return E},de:function(){return T},hP:function(){return M},nx:function(){return _},zD:function(){return R},zH:function(){return S}}),r("../node_modules/core-js/modules/es.symbol.iterator.js");var n=r("../node_modules/@babel/runtime/helpers/esm/inheritsLoose.js"),a=r("../node_modules/@babel/runtime/helpers/esm/toConsumableArray.js"),o=r("../node_modules/@babel/runtime/helpers/esm/createClass.js"),i=(r("../node_modules/regenerator-runtime/runtime.js"),r("../node_modules/core-js/modules/es.object.to-string.js"),r("../node_modules/core-js/modules/es.promise.js"),r("../node_modules/core-js/modules/es.array.join.js"),r("../node_modules/core-js/modules/es.number.constructor.js"),r("../node_modules/core-js/modules/es.regexp.exec.js"),r("../node_modules/core-js/modules/es.string.replace.js"),r("../node_modules/core-js/modules/es.string.split.js"),r("../node_modules/core-js/modules/es.function.name.js"),r("../node_modules/core-js/modules/es.string.match.js"),r("../node_modules/core-js/modules/es.regexp.to-string.js"),r("../node_modules/core-js/modules/es.array.slice.js"),r("../node_modules/core-js/modules/web.url.to-json.js"),r("../node_modules/core-js/modules/web.dom-collections.for-each.js"),r("../node_modules/core-js/modules/es.array.iterator.js"),r("../node_modules/core-js/modules/es.string.iterator.js"),r("../node_modules/core-js/modules/web.dom-collections.iterator.js"),r("../node_modules/core-js/modules/es.regexp.constructor.js"),r("../node_modules/core-js/modules/es.string.search.js"),r("../node_modules/core-js/modules/es.string.trim.js"),r("../node_modules/core-js/modules/es.array.concat.js"),r("../node_modules/core-js/modules/es.array-buffer.constructor.js"),r("../node_modules/core-js/modules/es.array-buffer.slice.js"),r("../node_modules/core-js/modules/es.array-buffer.is-view.js"),r("../node_modules/core-js/modules/web.url-search-params.js"),r("../node_modules/core-js/modules/es.typed-array.uint32-array.js"),r("../node_modules/core-js/modules/es.typed-array.copy-within.js"),r("../node_modules/core-js/modules/es.typed-array.every.js"),r("../node_modules/core-js/modules/es.typed-array.fill.js"),r("../node_modules/core-js/modules/es.typed-array.filter.js"),r("../node_modules/core-js/modules/es.typed-array.find.js"),r("../node_modules/core-js/modules/es.typed-array.find-index.js"),r("../node_modules/core-js/modules/es.typed-array.for-each.js"),r("../node_modules/core-js/modules/es.typed-array.includes.js"),r("../node_modules/core-js/modules/es.typed-array.index-of.js"),r("../node_modules/core-js/modules/es.typed-array.iterator.js"),r("../node_modules/core-js/modules/es.typed-array.join.js"),r("../node_modules/core-js/modules/es.typed-array.last-index-of.js"),r("../node_modules/core-js/modules/es.typed-array.map.js"),r("../node_modules/core-js/modules/es.typed-array.reduce.js"),r("../node_modules/core-js/modules/es.typed-array.reduce-right.js"),r("../node_modules/core-js/modules/es.typed-array.reverse.js"),r("../node_modules/core-js/modules/es.typed-array.set.js"),r("../node_modules/core-js/modules/es.typed-array.slice.js"),r("../node_modules/core-js/modules/es.typed-array.some.js"),r("../node_modules/core-js/modules/es.typed-array.sort.js"),r("../node_modules/core-js/modules/es.typed-array.subarray.js"),r("../node_modules/core-js/modules/es.typed-array.to-locale-string.js"),r("../node_modules/core-js/modules/es.typed-array.to-string.js"),r("../node_modules/core-js/modules/es.string.sub.js"),r("../node_modules/core-js/modules/es.array.splice.js"),r("../node_modules/core-js/modules/es.array.sort.js"),r("../node_modules/core-js/modules/esnext.array.last-index.js"),r("../node_modules/core-js/modules/es.number.to-fixed.js"),r("../node_modules/core-js/modules/es.object.keys.js"),r("../node_modules/core-js/modules/esnext.global-this.js"),r("../node_modules/core-js/modules/es.symbol.js"),r("../node_modules/core-js/modules/es.symbol.description.js"),r("../node_modules/core-js/modules/es.symbol.to-string-tag.js"),r("../node_modules/core-js/modules/es.json.to-string-tag.js"),r("../node_modules/core-js/modules/es.math.to-string-tag.js"),r("../node_modules/core-js/modules/es.map.js"),r("../node_modules/core-js/modules/esnext.map.delete-all.js"),r("../node_modules/core-js/modules/esnext.map.every.js"),r("../node_modules/core-js/modules/esnext.map.filter.js"),r("../node_modules/core-js/modules/esnext.map.find.js"),r("../node_modules/core-js/modules/esnext.map.find-key.js"),r("../node_modules/core-js/modules/esnext.map.includes.js"),r("../node_modules/core-js/modules/esnext.map.key-of.js"),r("../node_modules/core-js/modules/esnext.map.map-keys.js"),r("../node_modules/core-js/modules/esnext.map.map-values.js"),r("../node_modules/core-js/modules/esnext.map.merge.js"),r("../node_modules/core-js/modules/esnext.map.reduce.js"),r("../node_modules/core-js/modules/esnext.map.some.js"),r("../node_modules/core-js/modules/esnext.map.update.js"),r("../node_modules/core-js/modules/es.set.js"),r("../node_modules/core-js/modules/esnext.set.add-all.js"),r("../node_modules/core-js/modules/esnext.set.delete-all.js"),r("../node_modules/core-js/modules/esnext.set.difference.js"),r("../node_modules/core-js/modules/esnext.set.every.js"),r("../node_modules/core-js/modules/esnext.set.filter.js"),r("../node_modules/core-js/modules/esnext.set.find.js"),r("../node_modules/core-js/modules/esnext.set.intersection.js"),r("../node_modules/core-js/modules/esnext.set.is-disjoint-from.js"),r("../node_modules/core-js/modules/esnext.set.is-subset-of.js"),r("../node_modules/core-js/modules/esnext.set.is-superset-of.js"),r("../node_modules/core-js/modules/esnext.set.join.js"),r("../node_modules/core-js/modules/esnext.set.map.js"),r("../node_modules/core-js/modules/esnext.set.reduce.js"),r("../node_modules/core-js/modules/esnext.set.some.js"),r("../node_modules/core-js/modules/esnext.set.symmetric-difference.js"),r("../node_modules/core-js/modules/esnext.set.union.js"),r("../node_modules/core-js/modules/es.array.from.js"),r("../node_modules/core-js/modules/es.array.map.js"),r("../node_modules/core-js/modules/es.object.assign.js"),r("../node_modules/core-js/modules/es.object.entries.js"),r("../node_modules/core-js/modules/es.array.includes.js"),r("../node_modules/core-js/modules/es.string.includes.js"),r("../node_modules/core-js/modules/es.array.find-index.js"),r("../node_modules/core-js/modules/es.weak-set.js"),r("../node_modules/core-js/modules/esnext.weak-set.add-all.js"),r("../node_modules/core-js/modules/esnext.weak-set.delete-all.js"),r("../node_modules/core-js/modules/es.array.find.js"),r("../node_modules/core-js/modules/es.object.values.js"),r("../node_modules/core-js/modules/es.array.filter.js"),r("../node_modules/core-js/modules/es.string.starts-with.js"),r("../node_modules/core-js/modules/es.string.ends-with.js"),r("../node_modules/core-js/modules/es.number.parse-int.js"),r("../node_modules/core-js/modules/es.number.is-nan.js"),r("../node_modules/core-js/modules/es.number.parse-float.js"),r("../node_modules/i18next/dist/esm/i18next.js")),u=r("../node_modules/pinyin/lib/web-pinyin.js"),s=r.n(u),l=r("../node_modules/@tencent/tdocs-format-render/lib/index.js");function c(e,t){var r="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(r)return(r=r.call(e)).next.bind(r);if(Array.isArray(e)||(r=function(e,t){if(e){if("string"===typeof e)return f(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?f(e,t):void 0}}(e))||t&&e&&"number"===typeof e.length){r&&(e=r);var n=0;return function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function f(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var d=function(e,t,r,n){return new(r||(r=Promise))((function(a,o){function i(e){try{s(n.next(e))}catch(t){o(t)}}function u(e){try{s(n.throw(e))}catch(t){o(t)}}function s(e){var t;e.done?a(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(i,u)}s((n=n.apply(e,t||[])).next())}))},h={4277:function(e,t){t.kE=void 0;var r=/^\s*[+-]?\s*((\d+(\.\d+)?(e[+-]?\d+)?)|(0x[a-f\d]+))\s*$/i;t.kE=function(e){var t=typeof e;return("string"!==t||0!==e.toLowerCase().indexOf("0x"))&&("number"===t?!isNaN(e)&&isFinite(e):"string"===t?function(e){return 0!==e.toLowerCase().indexOf("0x")&&0!==e.length&&(1===e.length?/\d/.test(e):r.test(e))}(e):"object"===t&&!(!e||"number"!=typeof e.valueOf()||e instanceof Date))}},8177:function(e){e.exports=function(){var e="millisecond",t="second",r="minute",n="hour",a="day",o="week",i="month",u="quarter",s="year",l=/^(\d{4})[-/](\d{1,2})[-/](\d{0,2})([^0-9]+(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?.?(\d{1,3})?)?(\+\d{1,4})?$/,c=/\[([^\]]+)]|Y{2,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,f=function(e,t,r){var n=String(e);return!n||n.length>=t?e:""+Array(t+1-n.length).join(r)+e},d={s:f,z:function(e){var t=-e.utcOffset(),r=Math.abs(t),n=Math.floor(r/60),a=r%60;return(t<=0?"+":"-")+f(n,2,"0")+":"+f(a,2,"0")},m:function(e,t){var r=12*(t.year()-e.year())+(t.month()-e.month()),n=e.clone().add(r,i),a=t-n<0,o=e.clone().add(r+(a?-1:1),i);return Number(-(r+(t-n)/(a?n-o:o-n))||0)},a:function(e){return e<0?Math.ceil(e)||0:Math.floor(e)},p:function(l){return{M:i,y:s,w:o,d:a,h:n,m:r,s:t,ms:e,Q:u}[l]||String(l||"").toLowerCase().replace(/s$/,"")},u:function(e){return void 0===e}},h={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_")},m="en",g={};g[m]=h;var p=function(e){return e instanceof R},v=function(e,t,r){var n;if(!e)return m;if("string"==typeof e)g[e]&&(n=e),t&&(g[e]=t,n=e);else{var a=e.name;g[a]=e,n=a}return r||(m=n),n},y=function(e,t,r){if(p(e))return e.clone();var n=t?"string"==typeof t?{format:t,pl:r}:t:{};return n.date=e,new R(n)},N=d;N.l=v,N.i=p,N.w=function(e,t){return y(e,{locale:t.$L,utc:t.$u})};var M=function(e){var t=e.date,r=e.utc,n=e.autoIncrease;if(null===t)return new Date(NaN);if(N.u(t))return new Date;if(t instanceof Date)return new Date(t);if("string"==typeof t&&!/Z$/i.test(t)){var a=t.match(l);if(a)return n?r?new Date(Date.UTC(a[1],a[2]-1,a[3]||1,a[5]||0,a[6]||0,a[7]||0,a[8]||0)):new Date(a[1],a[2]-1,a[3]||1,a[4]||0,a[5]||0,a[6]||0,a[7]||0):function(){var e=new Date(arguments.length<=1?void 0:arguments[1],arguments.length<=2?void 0:arguments[2],arguments.length<=3?void 0:arguments[3],arguments.length<=4?void 0:arguments[4],arguments.length<=5?void 0:arguments[5],arguments.length<=6?void 0:arguments[6]);return e.getFullYear()!==(arguments.length<=1?void 0:arguments[1])||e.getMonth()!==(arguments.length<=2?void 0:arguments[2])||e.getDate()!==(arguments.length<=3?void 0:arguments[3])||e.getHours()!==(arguments.length<=4?void 0:arguments[4])||e.getMinutes()!==(arguments.length<=5?void 0:arguments[5])||e.getSeconds()!==(arguments.length<=6?void 0:arguments[6])?null:e}(t,Number(a[1]),Number(a[2]-1),Number(a[3]||1),Number(a[5]||0),Number(a[6]||0),Number(a[7]||0))||new Date(NaN)}return new Date(t)},R=function(){function l(e){this.$L=this.$L||v(e.locale,null,!0),this.parse(e)}var f=l.prototype;return f.parse=function(e){this.$d=M(e),this.init()},f.init=function(){var e=this.$d;this.$y=e.getFullYear(),this.$M=e.getMonth(),this.$D=e.getDate(),this.$W=e.getDay(),this.$H=e.getHours(),this.$m=e.getMinutes(),this.$s=e.getSeconds(),this.$ms=e.getMilliseconds()},f.$utils=function(){return N},f.isValid=function(){return!("Invalid Date"===this.$d.toString())},f.isSame=function(e,t){var r=y(e);return this.startOf(t)<=r&&r<=this.endOf(t)},f.isAfter=function(e,t){return y(e)<this.startOf(t)},f.isBefore=function(e,t){return this.endOf(t)<y(e)},f.$g=function(e,t,r){return N.u(e)?this[t]:this.set(r,e)},f.year=function(e){return this.$g(e,"$y",s)},f.month=function(e){return this.$g(e,"$M",i)},f.day=function(e){return this.$g(e,"$W",a)},f.date=function(e){return this.$g(e,"$D","date")},f.hour=function(e){return this.$g(e,"$H",n)},f.minute=function(e){return this.$g(e,"$m",r)},f.second=function(e){return this.$g(e,"$s",t)},f.millisecond=function(t){return this.$g(t,"$ms",e)},f.unix=function(){return Math.floor(this.valueOf()/1e3)},f.valueOf=function(){return this.$d.getTime()},f.startOf=function(e,u){var l=this,c=!!N.u(u)||u,f=N.p(e),d=function(e,t){var r=N.w(l.$u?Date.UTC(l.$y,t,e):new Date(l.$y,t,e),l);return c?r:r.endOf(a)},h=function(e,t){return N.w(l.toDate()[e].apply(l.toDate(),(c?[0,0,0,0]:[23,59,59,999]).slice(t)),l)},m=this.$W,g=this.$M,p=this.$D,v="set"+(this.$u?"UTC":"");switch(f){case s:return c?d(1,0):d(31,11);case i:return c?d(1,g):d(0,g+1);case o:var y=this.$locale().weekStart||0,M=(m<y?m+7:m)-y;return d(c?p-M:p+(6-M),g);case a:case"date":return h(v+"Hours",0);case n:return h(v+"Minutes",1);case r:return h(v+"Seconds",2);case t:return h(v+"Milliseconds",3);default:return this.clone()}},f.endOf=function(e){return this.startOf(e,!1)},f.$set=function(o,u){var l,c=N.p(o),f="set"+(this.$u?"UTC":""),d=(l={},l[a]=f+"Date",l.date=f+"Date",l[i]=f+"Month",l[s]=f+"FullYear",l[n]=f+"Hours",l[r]=f+"Minutes",l[t]=f+"Seconds",l[e]=f+"Milliseconds",l)[c],h=c===a?this.$D+(u-this.$W):u;if(c===i||c===s){var m=this.clone().set("date",1);m.$d[d](h),m.init(),this.$d=m.set("date",Math.min(this.$D,m.daysInMonth())).toDate()}else d&&this.$d[d](h);return this.init(),this},f.set=function(e,t){return this.clone().$set(e,t)},f.get=function(e){return this[N.p(e)]()},f.add=function(e,u){var l,c=this;e=Number(e);var f=N.p(u),d=function(t){var r=y(c);return N.w(r.date(r.date()+Math.round(t*e)),c)};if(f===i)return this.set(i,this.$M+e);if(f===s)return this.set(s,this.$y+e);if(f===a)return d(1);if(f===o)return d(7);var h=(l={},l[r]=6e4,l[n]=36e5,l[t]=1e3,l)[f]||1,m=this.valueOf()+e*h;return N.w(m,this)},f.subtract=function(e,t){return this.add(-1*e,t)},f.format=function(e){var t=this;if(!this.isValid())return"Invalid Date";var r=e||"YYYY-MM-DDTHH:mm:ssZ",n=N.z(this),a=this.$locale(),o=this.$H,i=this.$m,u=this.$M,s=a.weekdays,l=a.months,f=function(e,n,a,o){return e&&(e[n]||e(t,r))||a[n].substr(0,o)},d=function(e){return N.s(o%12||12,e,"0")},h=a.meridiem||function(e,t,r){var n=e<12?"AM":"PM";return r?n.toLowerCase():n},m={YY:String(this.$y).slice(-2),YYYY:this.$y,M:u+1,MM:N.s(u+1,2,"0"),MMM:f(a.monthsShort,u,l,3),MMMM:l[u]||l(this,r),D:this.$D,DD:N.s(this.$D,2,"0"),d:String(this.$W),dd:f(a.weekdaysMin,this.$W,s,2),ddd:f(a.weekdaysShort,this.$W,s,3),dddd:s[this.$W],H:String(o),HH:N.s(o,2,"0"),h:d(1),hh:d(2),a:h(o,i,!0),A:h(o,i,!1),m:String(i),mm:N.s(i,2,"0"),s:String(this.$s),ss:N.s(this.$s,2,"0"),SSS:N.s(this.$ms,3,"0"),Z:n};return r.replace(c,(function(e,t){return t||m[e]||n.replace(":","")}))},f.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},f.diff=function(e,l,c){var f,d=N.p(l),h=y(e),m=6e4*(h.utcOffset()-this.utcOffset()),g=this-h,p=N.m(this,h);return p=(f={},f[s]=p/12,f[i]=p,f[u]=p/3,f[o]=(g-m)/6048e5,f[a]=(g-m)/864e5,f[n]=g/36e5,f[r]=g/6e4,f[t]=g/1e3,f)[d]||g,c?p:N.a(p)},f.daysInMonth=function(){return this.endOf(i).$D},f.$locale=function(){return g[this.$L]},f.locale=function(e,t){if(!e)return this.$L;var r=this.clone();return r.$L=v(e,t,!0),r},f.clone=function(){return N.w(this.toDate(),this)},f.toDate=function(){return new Date(this.$d)},f.toJSON=function(){return this.isValid()?this.toISOString():null},f.toISOString=function(){return this.$d.toISOString()},f.toString=function(){return this.$d.toUTCString()},l}();return y.prototype=R.prototype,y.extend=function(e,t){return e(t,R,y),y},y.locale=v,y.isDayjs=p,y.unix=function(e){return y(1e3*e)},y.en=g[m],y.Ls=g,y}()},9669:function(e,t,r){e.exports=r(1609)},5448:function(e,t,r){var n=r(4867),a=r(6026),o=r(5327),i=r(4109),u=r(7985),s=r(5061);e.exports=function(e){return new Promise((function(t,l){var c=e.data,f=e.headers;n.isFormData(c)&&delete f["Content-Type"];var d=new XMLHttpRequest;if(e.auth){var h=e.auth.username||"",m=e.auth.password||"";f.Authorization="Basic "+btoa(h+":"+m)}if(d.open(e.method.toUpperCase(),o(e.url,e.params,e.paramsSerializer),!0),d.timeout=e.timeout,d.onreadystatechange=function(){if(d&&4===d.readyState&&(0!==d.status||d.responseURL&&0===d.responseURL.indexOf("file:"))){var r="getAllResponseHeaders"in d?i(d.getAllResponseHeaders()):null,n={data:e.responseType&&"text"!==e.responseType?d.response:d.responseText,status:d.status,statusText:d.statusText,headers:r,config:e,request:d};a(t,l,n),d=null}},d.onerror=function(){l(s("Network Error",e,null,d)),d=null},d.ontimeout=function(){l(s("timeout of "+e.timeout+"ms exceeded",e,"ECONNABORTED",d)),d=null},n.isStandardBrowserEnv()){var g=r(4372),p=(e.withCredentials||u(e.url))&&e.xsrfCookieName?g.read(e.xsrfCookieName):void 0;p&&(f[e.xsrfHeaderName]=p)}if("setRequestHeader"in d&&n.forEach(f,(function(e,t){void 0===c&&"content-type"===t.toLowerCase()?delete f[t]:d.setRequestHeader(t,e)})),e.withCredentials&&(d.withCredentials=!0),e.responseType)try{d.responseType=e.responseType}catch(t){if("json"!==e.responseType)throw t}"function"==typeof e.onDownloadProgress&&d.addEventListener("progress",e.onDownloadProgress),"function"==typeof e.onUploadProgress&&d.upload&&d.upload.addEventListener("progress",e.onUploadProgress),e.cancelToken&&e.cancelToken.promise.then((function(e){d&&(d.abort(),l(e),d=null)})),void 0===c&&(c=null),d.send(c)}))}},1609:function(e,t,r){var n=r(4867),a=r(1849),o=r(321),i=r(5655);function u(e){var t=new o(e),r=a(o.prototype.request,t);return n.extend(r,o.prototype,t),n.extend(r,t),r}var s=u(i);s.Axios=o,s.create=function(e){return u(n.merge(i,e))},s.Cancel=r(5263),s.CancelToken=r(4972),s.isCancel=r(6502),s.all=function(e){return Promise.all(e)},s.spread=r(8713),e.exports=s,e.exports.default=s},5263:function(e){function t(e){this.message=e}t.prototype.toString=function(){return"Cancel"+(this.message?": "+this.message:"")},t.prototype.__CANCEL__=!0,e.exports=t},4972:function(e,t,r){var n=r(5263);function a(e){if("function"!=typeof e)throw new TypeError("executor must be a function.");var t;this.promise=new Promise((function(e){t=e}));var r=this;e((function(e){r.reason||(r.reason=new n(e),t(r.reason))}))}a.prototype.throwIfRequested=function(){if(this.reason)throw this.reason},a.source=function(){var e;return{token:new a((function(t){e=t})),cancel:e}},e.exports=a},6502:function(e){e.exports=function(e){return!(!e||!e.__CANCEL__)}},321:function(e,t,r){var n=r(5655),a=r(4867),o=r(782),i=r(3572);function u(e){this.defaults=e,this.interceptors={request:new o,response:new o}}u.prototype.request=function(e){"string"==typeof e&&(e=a.merge({url:arguments[0]},arguments[1])),(e=a.merge(n,{method:"get"},this.defaults,e)).method=e.method.toLowerCase();var t=[i,void 0],r=Promise.resolve(e);for(this.interceptors.request.forEach((function(e){t.unshift(e.fulfilled,e.rejected)})),this.interceptors.response.forEach((function(e){t.push(e.fulfilled,e.rejected)}));t.length;)r=r.then(t.shift(),t.shift());return r},a.forEach(["delete","get","head","options"],(function(e){u.prototype[e]=function(t,r){return this.request(a.merge(r||{},{method:e,url:t}))}})),a.forEach(["post","put","patch"],(function(e){u.prototype[e]=function(t,r,n){return this.request(a.merge(n||{},{method:e,url:t,data:r}))}})),e.exports=u},782:function(e,t,r){var n=r(4867);function a(){this.handlers=[]}a.prototype.use=function(e,t){return this.handlers.push({fulfilled:e,rejected:t}),this.handlers.length-1},a.prototype.eject=function(e){this.handlers[e]&&(this.handlers[e]=null)},a.prototype.forEach=function(e){n.forEach(this.handlers,(function(t){null!==t&&e(t)}))},e.exports=a},5061:function(e,t,r){var n=r(481);e.exports=function(e,t,r,a,o){var i=new Error(e);return n(i,t,r,a,o)}},3572:function(e,t,r){var n=r(4867),a=r(8527),o=r(6502),i=r(5655),u=r(1793),s=r(7303);function l(e){e.cancelToken&&e.cancelToken.throwIfRequested()}e.exports=function(e){return l(e),e.baseURL&&!u(e.url)&&(e.url=s(e.baseURL,e.url)),e.headers=e.headers||{},e.data=a(e.data,e.headers,e.transformRequest),e.headers=n.merge(e.headers.common||{},e.headers[e.method]||{},e.headers||{}),n.forEach(["delete","get","head","post","put","patch","common"],(function(t){delete e.headers[t]})),(e.adapter||i.adapter)(e).then((function(t){return l(e),t.data=a(t.data,t.headers,e.transformResponse),t}),(function(t){return o(t)||(l(e),t&&t.response&&(t.response.data=a(t.response.data,t.response.headers,e.transformResponse))),Promise.reject(t)}))}},481:function(e){e.exports=function(e,t,r,n,a){return e.config=t,r&&(e.code=r),e.request=n,e.response=a,e}},6026:function(e,t,r){var n=r(5061);e.exports=function(e,t,r){var a=r.config.validateStatus;r.status&&a&&!a(r.status)?t(n("Request failed with status code "+r.status,r.config,null,r.request,r)):e(r)}},8527:function(e,t,r){var n=r(4867);e.exports=function(e,t,r){return n.forEach(r,(function(r){e=r(e,t)})),e}},5655:function(e,t,r){var n=r(4867),a=r(6016),o={"Content-Type":"application/x-www-form-urlencoded"};function i(e,t){!n.isUndefined(e)&&n.isUndefined(e["Content-Type"])&&(e["Content-Type"]=t)}var u,s={adapter:(("undefined"!=typeof XMLHttpRequest||"undefined"!=typeof process)&&(u=r(5448)),u),transformRequest:[function(e,t){return a(t,"Content-Type"),n.isFormData(e)||n.isArrayBuffer(e)||n.isBuffer(e)||n.isStream(e)||n.isFile(e)||n.isBlob(e)?e:n.isArrayBufferView(e)?e.buffer:n.isURLSearchParams(e)?(i(t,"application/x-www-form-urlencoded;charset=utf-8"),e.toString()):n.isObject(e)?(i(t,"application/json;charset=utf-8"),JSON.stringify(e)):e}],transformResponse:[function(e){if("string"==typeof e)try{e=JSON.parse(e)}catch(e){}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*"}}};n.forEach(["delete","get","head"],(function(e){s.headers[e]={}})),n.forEach(["post","put","patch"],(function(e){s.headers[e]=n.merge(o)})),e.exports=s},1849:function(e){e.exports=function(e,t){return function(){for(var r=new Array(arguments.length),n=0;n<r.length;n++)r[n]=arguments[n];return e.apply(t,r)}}},5327:function(e,t,r){var n=r(4867);function a(e){return encodeURIComponent(e).replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}e.exports=function(e,t,r){if(!t)return e;var o;if(r)o=r(t);else if(n.isURLSearchParams(t))o=t.toString();else{var i=[];n.forEach(t,(function(e,t){null!=e&&(n.isArray(e)?t+="[]":e=[e],n.forEach(e,(function(e){n.isDate(e)?e=e.toISOString():n.isObject(e)&&(e=JSON.stringify(e)),i.push(a(t)+"="+a(e))})))})),o=i.join("&")}return o&&(e+=(-1===e.indexOf("?")?"?":"&")+o),e}},7303:function(e){e.exports=function(e,t){return t?e.replace(/\/+$/,"")+"/"+t.replace(/^\/+/,""):e}},4372:function(e,t,r){var n=r(4867);e.exports=n.isStandardBrowserEnv()?{write:function(e,t,r,a,o,i){var u=[];u.push(e+"="+encodeURIComponent(t)),n.isNumber(r)&&u.push("expires="+new Date(r).toGMTString()),n.isString(a)&&u.push("path="+a),n.isString(o)&&u.push("domain="+o),!0===i&&u.push("secure"),document.cookie=u.join("; ")},read:function(e){var t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove:function(e){this.write(e,"",Date.now()-864e5)}}:{write:function(){},read:function(){return null},remove:function(){}}},1793:function(e){e.exports=function(e){return/^([a-z][a-z\d\+\-\.]*:)?\/\//i.test(e)}},7985:function(e,t,r){var n=r(4867);e.exports=n.isStandardBrowserEnv()?function(){var e,t=/(msie|trident)/i.test(navigator.userAgent),r=document.createElement("a");function a(e){var n=e;return t&&(r.setAttribute("href",n),n=r.href),r.setAttribute("href",n),{href:r.href,protocol:r.protocol?r.protocol.replace(/:$/,""):"",host:r.host,search:r.search?r.search.replace(/^\?/,""):"",hash:r.hash?r.hash.replace(/^#/,""):"",hostname:r.hostname,port:r.port,pathname:"/"===r.pathname.charAt(0)?r.pathname:"/"+r.pathname}}return e=a(window.location.href),function(t){var r=n.isString(t)?a(t):t;return r.protocol===e.protocol&&r.host===e.host}}():function(){return!0}},6016:function(e,t,r){var n=r(4867);e.exports=function(e,t){n.forEach(e,(function(r,n){n!==t&&n.toUpperCase()===t.toUpperCase()&&(e[t]=r,delete e[n])}))}},4109:function(e,t,r){var n=r(4867),a=["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"];e.exports=function(e){var t,r,o,i={};return e?(n.forEach(e.split("\n"),(function(e){if(o=e.indexOf(":"),t=n.trim(e.substr(0,o)).toLowerCase(),r=n.trim(e.substr(o+1)),t){if(i[t]&&a.indexOf(t)>=0)return;i[t]="set-cookie"===t?(i[t]?i[t]:[]).concat([r]):i[t]?i[t]+", "+r:r}})),i):i}},8713:function(e){e.exports=function(e){return function(t){return e.apply(null,t)}}},4867:function(e,t,r){var n=r(1849),a=r(8778),o=Object.prototype.toString;function i(e){return"[object Array]"===o.call(e)}function u(e){return null!==e&&"object"==typeof e}function s(e){return"[object Function]"===o.call(e)}function l(e,t){if(null!=e)if("object"!=typeof e&&(e=[e]),i(e))for(var r=0,n=e.length;r<n;r++)t.call(null,e[r],r,e);else for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.call(null,e[a],a,e)}e.exports={isArray:i,isArrayBuffer:function(e){return"[object ArrayBuffer]"===o.call(e)},isBuffer:a,isFormData:function(e){return"undefined"!=typeof FormData&&e instanceof FormData},isArrayBufferView:function(e){return"undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer&&e.buffer instanceof ArrayBuffer},isString:function(e){return"string"==typeof e},isNumber:function(e){return"number"==typeof e},isObject:u,isUndefined:function(e){return void 0===e},isDate:function(e){return"[object Date]"===o.call(e)},isFile:function(e){return"[object File]"===o.call(e)},isBlob:function(e){return"[object Blob]"===o.call(e)},isFunction:s,isStream:function(e){return u(e)&&s(e.pipe)},isURLSearchParams:function(e){return"undefined"!=typeof URLSearchParams&&e instanceof URLSearchParams},isStandardBrowserEnv:function(){return("undefined"==typeof navigator||"ReactNative"!==navigator.product)&&"undefined"!=typeof window&&"undefined"!=typeof document},forEach:l,merge:function e(){var t={};function r(r,n){"object"==typeof t[n]&&"object"==typeof r?t[n]=e(t[n],r):t[n]=r}for(var n=0,a=arguments.length;n<a;n++)l(arguments[n],r);return t},extend:function(e,t,r){return l(t,(function(t,a){e[a]=r&&"function"==typeof t?n(t,r):t})),e},trim:function(e){return e.replace(/^\s*/,"").replace(/\s*$/,"")}}},8778:function(e){e.exports=function(e){return null!=e&&null!=e.constructor&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)}},3776:function(e,t,r){var n;!function(a){var o,i,u,s=9e15,l=1e9,c="0123456789abcdef",f="2.3025850929940456840179914546843642076011014886287729760333279009675726096773524802359972050895982983419677840422862486334095254650828067566662873690987816894829072083255546808437998948262331985283935053089653777326288461633662222876982198867465436674744042432743651550489343149393914796194044002221051017141748003688084012647080685567743216228355220114804663715659121373450747856947683463616792101806445070648000277502684916746550586856935673420670581136429224554405758925724208241314695689016758940256776311356919292033376587141660230105703089634572075440370847469940168269282808481184289314848524948644871927809676271275775397027668605952496716674183485704422507197965004714951050492214776567636938662976979522110718264549734772662425709429322582798502585509785265383207606726317164309505995087807523710333101197857547331541421808427543863591778117054309827482385045648019095610299291824318237525357709750539565187697510374970888692180205189339507238539205144634197265287286965110862571492198849978748873771345686209167058",d="3.1415926535897932384626433832795028841971693993751058209749445923078164062862089986280348253421170679821480865132823066470938446095505822317253594081284811174502841027019385211055596446229489549303819644288109756659334461284756482337867831652712019091456485669234603486104543266482133936072602491412737245870066063155881748815209209628292540917153643678925903600113305305488204665213841469519415116094330572703657595919530921861173819326117931051185480744623799627495673518857527248912279381830119491298336733624406566430860213949463952247371907021798609437027705392171762931767523846748184676694051320005681271452635608277857713427577896091736371787214684409012249534301465495853710507922796892589235420199561121290219608640344181598136297747713099605187072113499999983729780499510597317328160963185950244594553469083026425223082533446850352619311881710100031378387528865875332083814206171776691473035982534904287554687311595628638823537875937519577818577805321712268066130019278766111959092164201989380952572010654858632789",h={precision:20,rounding:4,modulo:1,toExpNeg:-7,toExpPos:21,minE:-s,maxE:s,crypto:!1},m=!0,g="[DecimalError] ",p=g+"Invalid argument: ",v=g+"Precision limit exceeded",y=g+"crypto unavailable",N=Math.floor,M=Math.pow,R=/^0b([01]+(\.[01]*)?|\.[01]+)(p[+-]?\d+)?$/i,_=/^0x([0-9a-f]+(\.[0-9a-f]*)?|\.[0-9a-f]+)(p[+-]?\d+)?$/i,E=/^0o([0-7]+(\.[0-7]*)?|\.[0-7]+)(p[+-]?\d+)?$/i,T=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,S=1e7,C=f.length-1,I=d.length-1,A={name:"[object Decimal]"};function w(e){var t,r,n,a=e.length-1,o="",i=e[0];if(a>0){for(o+=i,t=1;t<a;t++)(r=7-(n=e[t]+"").length)&&(o+=G(r)),o+=n;(r=7-(n=(i=e[t])+"").length)&&(o+=G(r))}else if(0===i)return"0";for(;i%10==0;)i/=10;return o+i}function x(e,t,r){if(e!==~~e||e<t||e>r)throw Error(p+e)}function D(e,t,r,n){var a,o,i,u;for(o=e[0];o>=10;o/=10)--t;return--t<0?(t+=7,a=0):(a=Math.ceil((t+1)/7),t%=7),o=M(10,7-t),u=e[a]%o|0,null==n?t<3?(0==t?u=u/100|0:1==t&&(u=u/10|0),i=r<4&&99999==u||r>3&&49999==u||5e4==u||0==u):i=(r<4&&u+1==o||r>3&&u+1==o/2)&&(e[a+1]/o/100|0)==M(10,t-2)-1||(u==o/2||0==u)&&0==(e[a+1]/o/100|0):t<4?(0==t?u=u/1e3|0:1==t?u=u/100|0:2==t&&(u=u/10|0),i=(n||r<4)&&9999==u||!n&&r>3&&4999==u):i=((n||r<4)&&u+1==o||!n&&r>3&&u+1==o/2)&&(e[a+1]/o/1e3|0)==M(10,t-3)-1,i}function b(e,t,r){for(var n,a,o=[0],i=0,u=e.length;i<u;){for(a=o.length;a--;)o[a]*=t;for(o[0]+=c.indexOf(e.charAt(i++)),n=0;n<o.length;n++)o[n]>r-1&&(void 0===o[n+1]&&(o[n+1]=0),o[n+1]+=o[n]/r|0,o[n]%=r)}return o.reverse()}A.absoluteValue=A.abs=function(){var e=new this.constructor(this);return e.s<0&&(e.s=1),F(e)},A.ceil=function(){return F(new this.constructor(this),this.e+1,2)},A.comparedTo=A.cmp=function(e){var t,r,n,a,o=this,i=o.d,u=(e=new o.constructor(e)).d,s=o.s,l=e.s;if(!i||!u)return s&&l?s!==l?s:i===u?0:!i^s<0?1:-1:NaN;if(!i[0]||!u[0])return i[0]?s:u[0]?-l:0;if(s!==l)return s;if(o.e!==e.e)return o.e>e.e^s<0?1:-1;for(t=0,r=(n=i.length)<(a=u.length)?n:a;t<r;++t)if(i[t]!==u[t])return i[t]>u[t]^s<0?1:-1;return n===a?0:n>a^s<0?1:-1},A.cosine=A.cos=function(){var e,t,r=this,n=r.constructor;return r.d?r.d[0]?(e=n.precision,t=n.rounding,n.precision=e+Math.max(r.e,r.sd())+7,n.rounding=1,r=function(e,t){var r,n,a=t.d.length;a<32?n=(1/z(4,r=Math.ceil(a/3))).toString():(r=16,n="2.3283064365386962890625e-10"),e.precision+=r,t=K(e,1,t.times(n),new e(1));for(var o=r;o--;){var i=t.times(t);t=i.times(i).minus(i).times(8).plus(1)}return e.precision-=r,t}(n,q(n,r)),n.precision=e,n.rounding=t,F(2==u||3==u?r.neg():r,e,t,!0)):new n(1):new n(NaN)},A.cubeRoot=A.cbrt=function(){var e,t,r,n,a,o,i,u,s,l,c=this,f=c.constructor;if(!c.isFinite()||c.isZero())return new f(c);for(m=!1,(o=c.s*M(c.s*c,1/3))&&Math.abs(o)!=1/0?n=new f(o.toString()):(r=w(c.d),(o=((e=c.e)-r.length+1)%3)&&(r+=1==o||-2==o?"0":"00"),o=M(r,1/3),e=N((e+1)/3)-(e%3==(e<0?-1:2)),(n=new f(r=o==1/0?"5e"+e:(r=o.toExponential()).slice(0,r.indexOf("e")+1)+e)).s=c.s),i=(e=f.precision)+3;;)if(l=(s=(u=n).times(u).times(u)).plus(c),n=O(l.plus(c).times(u),l.plus(s),i+2,1),w(u.d).slice(0,i)===(r=w(n.d)).slice(0,i)){if("9999"!=(r=r.slice(i-3,i+1))&&(a||"4999"!=r)){+r&&(+r.slice(1)||"5"!=r.charAt(0))||(F(n,e+1,1),t=!n.times(n).times(n).eq(c));break}if(!a&&(F(u,e+1,0),u.times(u).times(u).eq(c))){n=u;break}i+=4,a=1}return m=!0,F(n,e,f.rounding,t)},A.decimalPlaces=A.dp=function(){var e,t=this.d,r=NaN;if(t){if(r=7*((e=t.length-1)-N(this.e/7)),e=t[e])for(;e%10==0;e/=10)r--;r<0&&(r=0)}return r},A.dividedBy=A.div=function(e){return O(this,new this.constructor(e))},A.dividedToIntegerBy=A.divToInt=function(e){var t=this.constructor;return F(O(this,new t(e),0,1,1),t.precision,t.rounding)},A.equals=A.eq=function(e){return 0===this.cmp(e)},A.floor=function(){return F(new this.constructor(this),this.e+1,3)},A.greaterThan=A.gt=function(e){return this.cmp(e)>0},A.greaterThanOrEqualTo=A.gte=function(e){var t=this.cmp(e);return 1==t||0===t},A.hyperbolicCosine=A.cosh=function(){var e,t,r,n,a,o=this,i=o.constructor,u=new i(1);if(!o.isFinite())return new i(o.s?1/0:NaN);if(o.isZero())return u;r=i.precision,n=i.rounding,i.precision=r+Math.max(o.e,o.sd())+4,i.rounding=1,(a=o.d.length)<32?t=(1/z(4,e=Math.ceil(a/3))).toString():(e=16,t="2.3283064365386962890625e-10"),o=K(i,1,o.times(t),new i(1),!0);for(var s,l=e,c=new i(8);l--;)s=o.times(o),o=u.minus(s.times(c.minus(s.times(c))));return F(o,i.precision=r,i.rounding=n,!0)},A.hyperbolicSine=A.sinh=function(){var e,t,r,n,a=this,o=a.constructor;if(!a.isFinite()||a.isZero())return new o(a);if(t=o.precision,r=o.rounding,o.precision=t+Math.max(a.e,a.sd())+4,o.rounding=1,(n=a.d.length)<3)a=K(o,2,a,a,!0);else{e=(e=1.4*Math.sqrt(n))>16?16:0|e,a=K(o,2,a=a.times(1/z(5,e)),a,!0);for(var i,u=new o(5),s=new o(16),l=new o(20);e--;)i=a.times(a),a=a.times(u.plus(i.times(s.times(i).plus(l))))}return o.precision=t,o.rounding=r,F(a,t,r,!0)},A.hyperbolicTangent=A.tanh=function(){var e,t,r=this,n=r.constructor;return r.isFinite()?r.isZero()?new n(r):(e=n.precision,t=n.rounding,n.precision=e+7,n.rounding=1,O(r.sinh(),r.cosh(),n.precision=e,n.rounding=t)):new n(r.s)},A.inverseCosine=A.acos=function(){var e,t=this,r=t.constructor,n=t.abs().cmp(1),a=r.precision,o=r.rounding;return-1!==n?0===n?t.isNeg()?k(r,a,o):new r(0):new r(NaN):t.isZero()?k(r,a+4,o).times(.5):(r.precision=a+6,r.rounding=1,t=t.asin(),e=k(r,a+4,o).times(.5),r.precision=a,r.rounding=o,e.minus(t))},A.inverseHyperbolicCosine=A.acosh=function(){var e,t,r=this,n=r.constructor;return r.lte(1)?new n(r.eq(1)?0:NaN):r.isFinite()?(e=n.precision,t=n.rounding,n.precision=e+Math.max(Math.abs(r.e),r.sd())+4,n.rounding=1,m=!1,r=r.times(r).minus(1).sqrt().plus(r),m=!0,n.precision=e,n.rounding=t,r.ln()):new n(r)},A.inverseHyperbolicSine=A.asinh=function(){var e,t,r=this,n=r.constructor;return!r.isFinite()||r.isZero()?new n(r):(e=n.precision,t=n.rounding,n.precision=e+2*Math.max(Math.abs(r.e),r.sd())+6,n.rounding=1,m=!1,r=r.times(r).plus(1).sqrt().plus(r),m=!0,n.precision=e,n.rounding=t,r.ln())},A.inverseHyperbolicTangent=A.atanh=function(){var e,t,r,n,a=this,o=a.constructor;return a.isFinite()?a.e>=0?new o(a.abs().eq(1)?a.s/0:a.isZero()?a:NaN):(e=o.precision,t=o.rounding,n=a.sd(),Math.max(n,e)<2*-a.e-1?F(new o(a),e,t,!0):(o.precision=r=n-a.e,a=O(a.plus(1),new o(1).minus(a),r+e,1),o.precision=e+4,o.rounding=1,a=a.ln(),o.precision=e,o.rounding=t,a.times(.5))):new o(NaN)},A.inverseSine=A.asin=function(){var e,t,r,n,a=this,o=a.constructor;return a.isZero()?new o(a):(t=a.abs().cmp(1),r=o.precision,n=o.rounding,-1!==t?0===t?((e=k(o,r+4,n).times(.5)).s=a.s,e):new o(NaN):(o.precision=r+6,o.rounding=1,a=a.div(new o(1).minus(a.times(a)).sqrt().plus(1)).atan(),o.precision=r,o.rounding=n,a.times(2)))},A.inverseTangent=A.atan=function(){var e,t,r,n,a,o,i,u,s,l=this,c=l.constructor,f=c.precision,d=c.rounding;if(l.isFinite()){if(l.isZero())return new c(l);if(l.abs().eq(1)&&f+4<=I)return(i=k(c,f+4,d).times(.25)).s=l.s,i}else{if(!l.s)return new c(NaN);if(f+4<=I)return(i=k(c,f+4,d).times(.5)).s=l.s,i}for(c.precision=u=f+10,c.rounding=1,e=r=Math.min(28,u/7+2|0);e;--e)l=l.div(l.times(l).plus(1).sqrt().plus(1));for(m=!1,t=Math.ceil(u/7),n=1,s=l.times(l),i=new c(l),a=l;-1!==e;)if(a=a.times(s),o=i.minus(a.div(n+=2)),a=a.times(s),void 0!==(i=o.plus(a.div(n+=2))).d[t])for(e=t;i.d[e]===o.d[e]&&e--;);return r&&(i=i.times(2<<r-1)),m=!0,F(i,c.precision=f,c.rounding=d,!0)},A.isFinite=function(){return!!this.d},A.isInteger=A.isInt=function(){return!!this.d&&N(this.e/7)>this.d.length-2},A.isNaN=function(){return!this.s},A.isNegative=A.isNeg=function(){return this.s<0},A.isPositive=A.isPos=function(){return this.s>0},A.isZero=function(){return!!this.d&&0===this.d[0]},A.lessThan=A.lt=function(e){return this.cmp(e)<0},A.lessThanOrEqualTo=A.lte=function(e){return this.cmp(e)<1},A.logarithm=A.log=function(e){var t,r,n,a,o,i,u,s,l=this,c=l.constructor,f=c.precision,d=c.rounding;if(null==e)e=new c(10),t=!0;else{if(r=(e=new c(e)).d,e.s<0||!r||!r[0]||e.eq(1))return new c(NaN);t=e.eq(10)}if(r=l.d,l.s<0||!r||!r[0]||l.eq(1))return new c(r&&!r[0]?-1/0:1!=l.s?NaN:r?0:1/0);if(t)if(r.length>1)o=!0;else{for(a=r[0];a%10==0;)a/=10;o=1!==a}if(m=!1,i=$(l,u=f+5),n=t?B(c,u+10):$(e,u),D((s=O(i,n,u,1)).d,a=f,d))do{if(i=$(l,u+=10),n=t?B(c,u+10):$(e,u),s=O(i,n,u,1),!o){+w(s.d).slice(a+1,a+15)+1==1e14&&(s=F(s,f+1,0));break}}while(D(s.d,a+=10,d));return m=!0,F(s,f,d)},A.minus=A.sub=function(e){var t,r,n,a,o,i,u,s,l,c,f,d,h=this,g=h.constructor;if(e=new g(e),!h.d||!e.d)return h.s&&e.s?h.d?e.s=-e.s:e=new g(e.d||h.s!==e.s?h:NaN):e=new g(NaN),e;if(h.s!=e.s)return e.s=-e.s,h.plus(e);if(l=h.d,d=e.d,u=g.precision,s=g.rounding,!l[0]||!d[0]){if(d[0])e.s=-e.s;else{if(!l[0])return new g(3===s?-0:0);e=new g(h)}return m?F(e,u,s):e}if(r=N(e.e/7),c=N(h.e/7),l=l.slice(),o=c-r){for((f=o<0)?(t=l,o=-o,i=d.length):(t=d,r=c,i=l.length),o>(n=Math.max(Math.ceil(u/7),i)+2)&&(o=n,t.length=1),t.reverse(),n=o;n--;)t.push(0);t.reverse()}else{for((f=(n=l.length)<(i=d.length))&&(i=n),n=0;n<i;n++)if(l[n]!=d[n]){f=l[n]<d[n];break}o=0}for(f&&(t=l,l=d,d=t,e.s=-e.s),i=l.length,n=d.length-i;n>0;--n)l[i++]=0;for(n=d.length;n>o;){if(l[--n]<d[n]){for(a=n;a&&0===l[--a];)l[a]=S-1;--l[a],l[n]+=S}l[n]-=d[n]}for(;0===l[--i];)l.pop();for(;0===l[0];l.shift())--r;return l[0]?(e.d=l,e.e=L(l,r),m?F(e,u,s):e):new g(3===s?-0:0)},A.modulo=A.mod=function(e){var t,r=this,n=r.constructor;return e=new n(e),!r.d||!e.s||e.d&&!e.d[0]?new n(NaN):!e.d||r.d&&!r.d[0]?F(new n(r),n.precision,n.rounding):(m=!1,9==n.modulo?(t=O(r,e.abs(),0,3,1)).s*=e.s:t=O(r,e,0,n.modulo,1),t=t.times(e),m=!0,r.minus(t))},A.naturalExponential=A.exp=function(){return V(this)},A.naturalLogarithm=A.ln=function(){return $(this)},A.negated=A.neg=function(){var e=new this.constructor(this);return e.s=-e.s,F(e)},A.plus=A.add=function(e){var t,r,n,a,o,i,u,s,l,c,f=this,d=f.constructor;if(e=new d(e),!f.d||!e.d)return f.s&&e.s?f.d||(e=new d(e.d||f.s===e.s?f:NaN)):e=new d(NaN),e;if(f.s!=e.s)return e.s=-e.s,f.minus(e);if(l=f.d,c=e.d,u=d.precision,s=d.rounding,!l[0]||!c[0])return c[0]||(e=new d(f)),m?F(e,u,s):e;if(o=N(f.e/7),n=N(e.e/7),l=l.slice(),a=o-n){for(a<0?(r=l,a=-a,i=c.length):(r=c,n=o,i=l.length),a>(i=(o=Math.ceil(u/7))>i?o+1:i+1)&&(a=i,r.length=1),r.reverse();a--;)r.push(0);r.reverse()}for((i=l.length)-(a=c.length)<0&&(a=i,r=c,c=l,l=r),t=0;a;)t=(l[--a]=l[a]+c[a]+t)/S|0,l[a]%=S;for(t&&(l.unshift(t),++n),i=l.length;0==l[--i];)l.pop();return e.d=l,e.e=L(l,n),m?F(e,u,s):e},A.precision=A.sd=function(e){var t,r=this;if(void 0!==e&&e!==!!e&&1!==e&&0!==e)throw Error(p+e);return r.d?(t=P(r.d),e&&r.e+1>t&&(t=r.e+1)):t=NaN,t},A.round=function(){var e=this,t=e.constructor;return F(new t(e),e.e+1,t.rounding)},A.sine=A.sin=function(){var e,t,r=this,n=r.constructor;return r.isFinite()?r.isZero()?new n(r):(e=n.precision,t=n.rounding,n.precision=e+Math.max(r.e,r.sd())+7,n.rounding=1,r=function(e,t){var r,n=t.d.length;if(n<3)return K(e,2,t,t);r=(r=1.4*Math.sqrt(n))>16?16:0|r,t=K(e,2,t=t.times(1/z(5,r)),t);for(var a,o=new e(5),i=new e(16),u=new e(20);r--;)a=t.times(t),t=t.times(o.plus(a.times(i.times(a).minus(u))));return t}(n,q(n,r)),n.precision=e,n.rounding=t,F(u>2?r.neg():r,e,t,!0)):new n(NaN)},A.squareRoot=A.sqrt=function(){var e,t,r,n,a,o,i=this,u=i.d,s=i.e,l=i.s,c=i.constructor;if(1!==l||!u||!u[0])return new c(!l||l<0&&(!u||u[0])?NaN:u?i:1/0);for(m=!1,0==(l=Math.sqrt(+i))||l==1/0?(((t=w(u)).length+s)%2==0&&(t+="0"),l=Math.sqrt(t),s=N((s+1)/2)-(s<0||s%2),n=new c(t=l==1/0?"5e"+s:(t=l.toExponential()).slice(0,t.indexOf("e")+1)+s)):n=new c(l.toString()),r=(s=c.precision)+3;;)if(n=(o=n).plus(O(i,o,r+2,1)).times(.5),w(o.d).slice(0,r)===(t=w(n.d)).slice(0,r)){if("9999"!=(t=t.slice(r-3,r+1))&&(a||"4999"!=t)){+t&&(+t.slice(1)||"5"!=t.charAt(0))||(F(n,s+1,1),e=!n.times(n).eq(i));break}if(!a&&(F(o,s+1,0),o.times(o).eq(i))){n=o;break}r+=4,a=1}return m=!0,F(n,s,c.rounding,e)},A.tangent=A.tan=function(){var e,t,r=this,n=r.constructor;return r.isFinite()?r.isZero()?new n(r):(e=n.precision,t=n.rounding,n.precision=e+10,n.rounding=1,(r=r.sin()).s=1,r=O(r,new n(1).minus(r.times(r)).sqrt(),e+10,0),n.precision=e,n.rounding=t,F(2==u||4==u?r.neg():r,e,t,!0)):new n(NaN)},A.times=A.mul=function(e){var t,r,n,a,o,i,u,s,l,c=this,f=c.constructor,d=c.d,h=(e=new f(e)).d;if(e.s*=c.s,!(d&&d[0]&&h&&h[0]))return new f(!e.s||d&&!d[0]&&!h||h&&!h[0]&&!d?NaN:d&&h?0*e.s:e.s/0);for(r=N(c.e/7)+N(e.e/7),(s=d.length)<(l=h.length)&&(o=d,d=h,h=o,i=s,s=l,l=i),o=[],n=i=s+l;n--;)o.push(0);for(n=l;--n>=0;){for(t=0,a=s+n;a>n;)u=o[a]+h[n]*d[a-n-1]+t,o[a--]=u%S|0,t=u/S|0;o[a]=(o[a]+t)%S|0}for(;!o[--i];)o.pop();return t?++r:o.shift(),e.d=o,e.e=L(o,r),m?F(e,f.precision,f.rounding):e},A.toBinary=function(e,t){return J(this,2,e,t)},A.toDecimalPlaces=A.toDP=function(e,t){var r=this,n=r.constructor;return r=new n(r),void 0===e?r:(x(e,0,l),void 0===t?t=n.rounding:x(t,0,8),F(r,e+r.e+1,t))},A.toExponential=function(e,t){var r,n=this,a=n.constructor;return void 0===e?r=U(n,!0):(x(e,0,l),void 0===t?t=a.rounding:x(t,0,8),r=U(n=F(new a(n),e+1,t),!0,e+1)),n.isNeg()&&!n.isZero()?"-"+r:r},A.toFixed=function(e,t){var r,n,a=this,o=a.constructor;return void 0===e?r=U(a):(x(e,0,l),void 0===t?t=o.rounding:x(t,0,8),r=U(n=F(new o(a),e+a.e+1,t),!1,e+n.e+1)),a.isNeg()&&!a.isZero()?"-"+r:r},A.toFraction=function(e){var t,r,n,a,o,i,u,s,l,c,f,d,h=this,g=h.d,v=h.constructor;if(!g)return new v(h);if(l=r=new v(1),n=s=new v(0),i=(o=(t=new v(n)).e=P(g)-h.e-1)%7,t.d[0]=M(10,i<0?7+i:i),null==e)e=o>0?t:l;else{if(!(u=new v(e)).isInt()||u.lt(l))throw Error(p+u);e=u.gt(t)?o>0?t:l:u}for(m=!1,u=new v(w(g)),c=v.precision,v.precision=o=7*g.length*2;f=O(u,t,0,1,1),1!=(a=r.plus(f.times(n))).cmp(e);)r=n,n=a,a=l,l=s.plus(f.times(a)),s=a,a=t,t=u.minus(f.times(a)),u=a;return a=O(e.minus(r),n,0,1,1),s=s.plus(a.times(l)),r=r.plus(a.times(n)),s.s=l.s=h.s,d=O(l,n,o,1).minus(h).abs().cmp(O(s,r,o,1).minus(h).abs())<1?[l,n]:[s,r],v.precision=c,m=!0,d},A.toHexadecimal=A.toHex=function(e,t){return J(this,16,e,t)},A.toNearest=function(e,t){var r=this,n=r.constructor;if(r=new n(r),null==e){if(!r.d)return r;e=new n(1),t=n.rounding}else{if(e=new n(e),void 0===t?t=n.rounding:x(t,0,8),!r.d)return e.s?r:e;if(!e.d)return e.s&&(e.s=r.s),e}return e.d[0]?(m=!1,r=O(r,e,0,t,1).times(e),m=!0,F(r)):(e.s=r.s,r=e),r},A.toNumber=function(){return+this},A.toOctal=function(e,t){return J(this,8,e,t)},A.toPower=A.pow=function(e){var t,r,n,a,o,i,u=this,s=u.constructor,l=+(e=new s(e));if(!(u.d&&e.d&&u.d[0]&&e.d[0]))return new s(M(+u,l));if((u=new s(u)).eq(1))return u;if(n=s.precision,o=s.rounding,e.eq(1))return F(u,n,o);if((t=N(e.e/7))>=e.d.length-1&&(r=l<0?-l:l)<=9007199254740991)return a=H(s,u,r,n),e.s<0?new s(1).div(a):F(a,n,o);if((i=u.s)<0){if(t<e.d.length-1)return new s(NaN);if(0==(1&e.d[t])&&(i=1),0==u.e&&1==u.d[0]&&1==u.d.length)return u.s=i,u}return(t=0!=(r=M(+u,l))&&isFinite(r)?new s(r+"").e:N(l*(Math.log("0."+w(u.d))/Math.LN10+u.e+1)))>s.maxE+1||t<s.minE-1?new s(t>0?i/0:0):(m=!1,s.rounding=u.s=1,r=Math.min(12,(t+"").length),(a=V(e.times($(u,n+r)),n)).d&&D((a=F(a,n+5,1)).d,n,o)&&(t=n+10,+w((a=F(V(e.times($(u,t+r)),t),t+5,1)).d).slice(n+1,n+15)+1==1e14&&(a=F(a,n+1,0))),a.s=i,m=!0,s.rounding=o,F(a,n,o))},A.toPrecision=function(e,t){var r,n=this,a=n.constructor;return void 0===e?r=U(n,n.e<=a.toExpNeg||n.e>=a.toExpPos):(x(e,1,l),void 0===t?t=a.rounding:x(t,0,8),r=U(n=F(new a(n),e,t),e<=n.e||n.e<=a.toExpNeg,e)),n.isNeg()&&!n.isZero()?"-"+r:r},A.toSignificantDigits=A.toSD=function(e,t){var r=this.constructor;return void 0===e?(e=r.precision,t=r.rounding):(x(e,1,l),void 0===t?t=r.rounding:x(t,0,8)),F(new r(this),e,t)},A.toString=function(){var e=this,t=e.constructor,r=U(e,e.e<=t.toExpNeg||e.e>=t.toExpPos);return e.isNeg()&&!e.isZero()?"-"+r:r},A.truncated=A.trunc=function(){return F(new this.constructor(this),this.e+1,1)},A.valueOf=A.toJSON=function(){var e=this,t=e.constructor,r=U(e,e.e<=t.toExpNeg||e.e>=t.toExpPos);return e.isNeg()?"-"+r:r};var O=function(){function e(e,t,r){var n,a=0,o=e.length;for(e=e.slice();o--;)n=e[o]*t+a,e[o]=n%r|0,a=n/r|0;return a&&e.unshift(a),e}function t(e,t,r,n){var a,o;if(r!=n)o=r>n?1:-1;else for(a=o=0;a<r;a++)if(e[a]!=t[a]){o=e[a]>t[a]?1:-1;break}return o}function r(e,t,r,n){for(var a=0;r--;)e[r]-=a,a=e[r]<t[r]?1:0,e[r]=a*n+e[r]-t[r];for(;!e[0]&&e.length>1;)e.shift()}return function(n,a,o,u,s,l){var c,f,d,h,m,g,p,v,y,M,R,_,E,T,C,I,A,w,x,D,b=n.constructor,O=n.s==a.s?1:-1,U=n.d,L=a.d;if(!(U&&U[0]&&L&&L[0]))return new b(n.s&&a.s&&(U?!L||U[0]!=L[0]:L)?U&&0==U[0]||!L?0*O:O/0:NaN);for(l?(m=1,f=n.e-a.e):(l=S,m=7,f=N(n.e/m)-N(a.e/m)),x=L.length,A=U.length,M=(y=new b(O)).d=[],d=0;L[d]==(U[d]||0);d++);if(L[d]>(U[d]||0)&&f--,null==o?(T=o=b.precision,u=b.rounding):T=s?o+(n.e-a.e)+1:o,T<0)M.push(1),g=!0;else{if(T=T/m+2|0,d=0,1==x){for(h=0,L=L[0],T++;(d<A||h)&&T--;d++)C=h*l+(U[d]||0),M[d]=C/L|0,h=C%L|0;g=h||d<A}else{for((h=l/(L[0]+1)|0)>1&&(L=e(L,h,l),U=e(U,h,l),x=L.length,A=U.length),I=x,_=(R=U.slice(0,x)).length;_<x;)R[_++]=0;(D=L.slice()).unshift(0),w=L[0],L[1]>=l/2&&++w;do{h=0,(c=t(L,R,x,_))<0?(E=R[0],x!=_&&(E=E*l+(R[1]||0)),(h=E/w|0)>1?(h>=l&&(h=l-1),1==(c=t(p=e(L,h,l),R,v=p.length,_=R.length))&&(h--,r(p,x<v?D:L,v,l))):(0==h&&(c=h=1),p=L.slice()),(v=p.length)<_&&p.unshift(0),r(R,p,_,l),-1==c&&(c=t(L,R,x,_=R.length))<1&&(h++,r(R,x<_?D:L,_,l)),_=R.length):0===c&&(h++,R=[0]),M[d++]=h,c&&R[0]?R[_++]=U[I]||0:(R=[U[I]],_=1)}while((I++<A||void 0!==R[0])&&T--);g=void 0!==R[0]}M[0]||M.shift()}if(1==m)y.e=f,i=g;else{for(d=1,h=M[0];h>=10;h/=10)d++;y.e=d+f*m-1,F(y,s?o+y.e+1:o,u,g)}return y}}();function F(e,t,r,n){var a,o,i,u,s,l,c,f,d,h=e.constructor;e:if(null!=t){if(!(f=e.d))return e;for(a=1,u=f[0];u>=10;u/=10)a++;if((o=t-a)<0)o+=7,i=t,s=(c=f[d=0])/M(10,a-i-1)%10|0;else if((d=Math.ceil((o+1)/7))>=(u=f.length)){if(!n)break e;for(;u++<=d;)f.push(0);c=s=0,a=1,i=(o%=7)-7+1}else{for(c=u=f[d],a=1;u>=10;u/=10)a++;s=(i=(o%=7)-7+a)<0?0:c/M(10,a-i-1)%10|0}if(n=n||t<0||void 0!==f[d+1]||(i<0?c:c%M(10,a-i-1)),l=r<4?(s||n)&&(0==r||r==(e.s<0?3:2)):s>5||5==s&&(4==r||n||6==r&&(o>0?i>0?c/M(10,a-i):0:f[d-1])%10&1||r==(e.s<0?8:7)),t<1||!f[0])return f.length=0,l?(t-=e.e+1,f[0]=M(10,(7-t%7)%7),e.e=-t||0):f[0]=e.e=0,e;if(0==o?(f.length=d,u=1,d--):(f.length=d+1,u=M(10,7-o),f[d]=i>0?(c/M(10,a-i)%M(10,i)|0)*u:0),l)for(;;){if(0==d){for(o=1,i=f[0];i>=10;i/=10)o++;for(i=f[0]+=u,u=1;i>=10;i/=10)u++;o!=u&&(e.e++,f[0]==S&&(f[0]=1));break}if(f[d]+=u,f[d]!=S)break;f[d--]=0,u=1}for(o=f.length;0===f[--o];)f.pop()}return m&&(e.e>h.maxE?(e.d=null,e.e=NaN):e.e<h.minE&&(e.e=0,e.d=[0])),e}function U(e,t,r){if(!e.isFinite())return Z(e);var n,a=e.e,o=w(e.d),i=o.length;return t?(r&&(n=r-i)>0?o=o.charAt(0)+"."+o.slice(1)+G(n):i>1&&(o=o.charAt(0)+"."+o.slice(1)),o=o+(e.e<0?"e":"e+")+e.e):a<0?(o="0."+G(-a-1)+o,r&&(n=r-i)>0&&(o+=G(n))):a>=i?(o+=G(a+1-i),r&&(n=r-a-1)>0&&(o=o+"."+G(n))):((n=a+1)<i&&(o=o.slice(0,n)+"."+o.slice(n)),r&&(n=r-i)>0&&(a+1===i&&(o+="."),o+=G(n))),o}function L(e,t){var r=e[0];for(t*=7;r>=10;r/=10)t++;return t}function B(e,t,r){if(t>C)throw m=!0,r&&(e.precision=r),Error(v);return F(new e(f),t,1,!0)}function k(e,t,r){if(t>I)throw Error(v);return F(new e(d),t,r,!0)}function P(e){var t=e.length-1,r=7*t+1;if(t=e[t]){for(;t%10==0;t/=10)r--;for(t=e[0];t>=10;t/=10)r++}return r}function G(e){for(var t="";e--;)t+="0";return t}function H(e,t,r,n){var a,o=new e(1),i=Math.ceil(n/7+4);for(m=!1;;){if(r%2&&Q((o=o.times(t)).d,i)&&(a=!0),0===(r=N(r/2))){r=o.d.length-1,a&&0===o.d[r]&&++o.d[r];break}Q((t=t.times(t)).d,i)}return m=!0,o}function Y(e){return 1&e.d[e.d.length-1]}function j(e,t,r){for(var n,a=new e(t[0]),o=0;++o<t.length;){if(!(n=new e(t[o])).s){a=n;break}a[r](n)&&(a=n)}return a}function V(e,t){var r,n,a,o,i,u,s,l=0,c=0,f=0,d=e.constructor,h=d.rounding,g=d.precision;if(!e.d||!e.d[0]||e.e>17)return new d(e.d?e.d[0]?e.s<0?0:1/0:1:e.s?e.s<0?0:e:NaN);for(null==t?(m=!1,s=g):s=t,u=new d(.03125);e.e>-2;)e=e.times(u),f+=5;for(s+=n=Math.log(M(2,f))/Math.LN10*2+5|0,r=o=i=new d(1),d.precision=s;;){if(o=F(o.times(e),s,1),r=r.times(++c),w((u=i.plus(O(o,r,s,1))).d).slice(0,s)===w(i.d).slice(0,s)){for(a=f;a--;)i=F(i.times(i),s,1);if(null!=t)return d.precision=g,i;if(!(l<3&&D(i.d,s-n,h,l)))return F(i,d.precision=g,h,m=!0);d.precision=s+=10,r=o=u=new d(1),c=0,l++}i=u}}function $(e,t){var r,n,a,o,i,u,s,l,c,f,d,h=1,g=e,p=g.d,v=g.constructor,y=v.rounding,N=v.precision;if(g.s<0||!p||!p[0]||!g.e&&1==p[0]&&1==p.length)return new v(p&&!p[0]?-1/0:1!=g.s?NaN:p?0:g);if(null==t?(m=!1,c=N):c=t,v.precision=c+=10,n=(r=w(p)).charAt(0),!(Math.abs(o=g.e)<15e14))return l=B(v,c+2,N).times(o+""),g=$(new v(n+"."+r.slice(1)),c-10).plus(l),v.precision=N,null==t?F(g,N,y,m=!0):g;for(;n<7&&1!=n||1==n&&r.charAt(1)>3;)n=(r=w((g=g.times(e)).d)).charAt(0),h++;for(o=g.e,n>1?(g=new v("0."+r),o++):g=new v(n+"."+r.slice(1)),f=g,s=i=g=O(g.minus(1),g.plus(1),c,1),d=F(g.times(g),c,1),a=3;;){if(i=F(i.times(d),c,1),w((l=s.plus(O(i,new v(a),c,1))).d).slice(0,c)===w(s.d).slice(0,c)){if(s=s.times(2),0!==o&&(s=s.plus(B(v,c+2,N).times(o+""))),s=O(s,new v(h),c,1),null!=t)return v.precision=N,s;if(!D(s.d,c-10,y,u))return F(s,v.precision=N,y,m=!0);v.precision=c+=10,l=i=g=O(f.minus(1),f.plus(1),c,1),d=F(g.times(g),c,1),a=u=1}s=l,a+=2}}function Z(e){return String(e.s*e.s/0)}function W(e,t){var r,n,a;for((r=t.indexOf("."))>-1&&(t=t.replace(".","")),(n=t.search(/e/i))>0?(r<0&&(r=n),r+=+t.slice(n+1),t=t.substring(0,n)):r<0&&(r=t.length),n=0;48===t.charCodeAt(n);n++);for(a=t.length;48===t.charCodeAt(a-1);--a);if(t=t.slice(n,a)){if(a-=n,e.e=r=r-n-1,e.d=[],n=(r+1)%7,r<0&&(n+=7),n<a){for(n&&e.d.push(+t.slice(0,n)),a-=7;n<a;)e.d.push(+t.slice(n,n+=7));n=7-(t=t.slice(n)).length}else n-=a;for(;n--;)t+="0";e.d.push(+t),m&&(e.e>e.constructor.maxE?(e.d=null,e.e=NaN):e.e<e.constructor.minE&&(e.e=0,e.d=[0]))}else e.e=0,e.d=[0];return e}function X(e,t){var r,n,a,i,u,s,l,c,f;if("Infinity"===t||"NaN"===t)return+t||(e.s=NaN),e.e=NaN,e.d=null,e;if(_.test(t))r=16,t=t.toLowerCase();else if(R.test(t))r=2;else{if(!E.test(t))throw Error(p+t);r=8}for((i=t.search(/p/i))>0?(l=+t.slice(i+1),t=t.substring(2,i)):t=t.slice(2),u=(i=t.indexOf("."))>=0,n=e.constructor,u&&(i=(s=(t=t.replace(".","")).length)-i,a=H(n,new n(r),i,2*i)),i=f=(c=b(t,r,S)).length-1;0===c[i];--i)c.pop();return i<0?new n(0*e.s):(e.e=L(c,f),e.d=c,m=!1,u&&(e=O(e,a,4*s)),l&&(e=e.times(Math.abs(l)<54?M(2,l):o.pow(2,l))),m=!0,e)}function K(e,t,r,n,a){var o,i,u,s,l=e.precision,c=Math.ceil(l/7);for(m=!1,s=r.times(r),u=new e(n);;){if(i=O(u.times(s),new e(t++*t++),l,1),u=a?n.plus(i):n.minus(i),n=O(i.times(s),new e(t++*t++),l,1),void 0!==(i=u.plus(n)).d[c]){for(o=c;i.d[o]===u.d[o]&&o--;);if(-1==o)break}o=u,u=n,n=i,i=o}return m=!0,i.d.length=c+1,i}function z(e,t){for(var r=e;--t;)r*=e;return r}function q(e,t){var r,n=t.s<0,a=k(e,e.precision,1),o=a.times(.5);if((t=t.abs()).lte(o))return u=n?4:1,t;if((r=t.divToInt(a)).isZero())u=n?3:2;else{if((t=t.minus(r.times(a))).lte(o))return u=Y(r)?n?2:3:n?4:1,t;u=Y(r)?n?1:4:n?3:2}return t.minus(a).abs()}function J(e,t,r,n){var a,o,u,s,f,d,h,m,g,p=e.constructor,v=void 0!==r;if(v?(x(r,1,l),void 0===n?n=p.rounding:x(n,0,8)):(r=p.precision,n=p.rounding),e.isFinite()){for(v?(a=2,16==t?r=4*r-3:8==t&&(r=3*r-2)):a=t,(u=(h=U(e)).indexOf("."))>=0&&(h=h.replace(".",""),(g=new p(1)).e=h.length-u,g.d=b(U(g),10,a),g.e=g.d.length),o=f=(m=b(h,10,a)).length;0==m[--f];)m.pop();if(m[0]){if(u<0?o--:((e=new p(e)).d=m,e.e=o,m=(e=O(e,g,r,n,0,a)).d,o=e.e,d=i),u=m[r],s=a/2,d=d||void 0!==m[r+1],d=n<4?(void 0!==u||d)&&(0===n||n===(e.s<0?3:2)):u>s||u===s&&(4===n||d||6===n&&1&m[r-1]||n===(e.s<0?8:7)),m.length=r,d)for(;++m[--r]>a-1;)m[r]=0,r||(++o,m.unshift(1));for(f=m.length;!m[f-1];--f);for(u=0,h="";u<f;u++)h+=c.charAt(m[u]);if(v){if(f>1)if(16==t||8==t){for(u=16==t?4:3,--f;f%u;f++)h+="0";for(f=(m=b(h,a,t)).length;!m[f-1];--f);for(u=1,h="1.";u<f;u++)h+=c.charAt(m[u])}else h=h.charAt(0)+"."+h.slice(1);h=h+(o<0?"p":"p+")+o}else if(o<0){for(;++o;)h="0"+h;h="0."+h}else if(++o>f)for(o-=f;o--;)h+="0";else o<f&&(h=h.slice(0,o)+"."+h.slice(o))}else h=v?"0p+0":"0";h=(16==t?"0x":2==t?"0b":8==t?"0o":"")+h}else h=Z(e);return e.s<0?"-"+h:h}function Q(e,t){if(e.length>t)return e.length=t,!0}function ee(e){return new this(e).abs()}function te(e){return new this(e).acos()}function re(e){return new this(e).acosh()}function ne(e,t){return new this(e).plus(t)}function ae(e){return new this(e).asin()}function oe(e){return new this(e).asinh()}function ie(e){return new this(e).atan()}function ue(e){return new this(e).atanh()}function se(e,t){e=new this(e),t=new this(t);var r,n=this.precision,a=this.rounding,o=n+4;return e.s&&t.s?e.d||t.d?!t.d||e.isZero()?(r=t.s<0?k(this,n,a):new this(0)).s=e.s:!e.d||t.isZero()?(r=k(this,o,1).times(.5)).s=e.s:t.s<0?(this.precision=o,this.rounding=1,r=this.atan(O(e,t,o,1)),t=k(this,o,1),this.precision=n,this.rounding=a,r=e.s<0?r.minus(t):r.plus(t)):r=this.atan(O(e,t,o,1)):(r=k(this,o,1).times(t.s>0?.25:.75)).s=e.s:r=new this(NaN),r}function le(e){return new this(e).cbrt()}function ce(e){return F(e=new this(e),e.e+1,2)}function fe(e){if(!e||"object"!=typeof e)throw Error(g+"Object expected");var t,r,n,a=!0===e.defaults,o=["precision",1,l,"rounding",0,8,"toExpNeg",-s,0,"toExpPos",0,s,"maxE",0,s,"minE",-s,0,"modulo",0,9];for(t=0;t<o.length;t+=3)if(r=o[t],a&&(this[r]=h[r]),void 0!==(n=e[r])){if(!(N(n)===n&&n>=o[t+1]&&n<=o[t+2]))throw Error(p+r+": "+n);this[r]=n}if(r="crypto",a&&(this[r]=h[r]),void 0!==(n=e[r])){if(!0!==n&&!1!==n&&0!==n&&1!==n)throw Error(p+r+": "+n);if(n){if("undefined"==typeof crypto||!crypto||!crypto.getRandomValues&&!crypto.randomBytes)throw Error(y);this[r]=!0}else this[r]=!1}return this}function de(e){return new this(e).cos()}function he(e){return new this(e).cosh()}function me(e,t){return new this(e).div(t)}function ge(e){return new this(e).exp()}function pe(e){return F(e=new this(e),e.e+1,3)}function ve(){var e,t,r=new this(0);for(m=!1,e=0;e<arguments.length;)if((t=new this(arguments[e++])).d)r.d&&(r=r.plus(t.times(t)));else{if(t.s)return m=!0,new this(1/0);r=t}return m=!0,r.sqrt()}function ye(e){return e instanceof o||e&&"[object Decimal]"===e.name||!1}function Ne(e){return new this(e).ln()}function Me(e,t){return new this(e).log(t)}function Re(e){return new this(e).log(2)}function _e(e){return new this(e).log(10)}function Ee(){return j(this,arguments,"lt")}function Te(){return j(this,arguments,"gt")}function Se(e,t){return new this(e).mod(t)}function Ce(e,t){return new this(e).mul(t)}function Ie(e,t){return new this(e).pow(t)}function Ae(e){var t,r,n,a,o=0,i=new this(1),u=[];if(void 0===e?e=this.precision:x(e,1,l),n=Math.ceil(e/7),this.crypto)if(crypto.getRandomValues)for(t=crypto.getRandomValues(new Uint32Array(n));o<n;)(a=t[o])>=429e7?t[o]=crypto.getRandomValues(new Uint32Array(1))[0]:u[o++]=a%1e7;else{if(!crypto.randomBytes)throw Error(y);for(t=crypto.randomBytes(n*=4);o<n;)(a=t[o]+(t[o+1]<<8)+(t[o+2]<<16)+((127&t[o+3])<<24))>=214e7?crypto.randomBytes(4).copy(t,o):(u.push(a%1e7),o+=4);o=n/4}else for(;o<n;)u[o++]=1e7*Math.random()|0;for(e%=7,(n=u[--o])&&e&&(a=M(10,7-e),u[o]=(n/a|0)*a);0===u[o];o--)u.pop();if(o<0)r=0,u=[0];else{for(r=-1;0===u[0];r-=7)u.shift();for(n=1,a=u[0];a>=10;a/=10)n++;n<7&&(r-=7-n)}return i.e=r,i.d=u,i}function we(e){return F(e=new this(e),e.e+1,this.rounding)}function xe(e){return(e=new this(e)).d?e.d[0]?e.s:0*e.s:e.s||NaN}function De(e){return new this(e).sin()}function be(e){return new this(e).sinh()}function Oe(e){return new this(e).sqrt()}function Fe(e,t){return new this(e).sub(t)}function Ue(e){return new this(e).tan()}function Le(e){return new this(e).tanh()}function Be(e){return F(e=new this(e),e.e+1,1)}(o=function e(t){var r,n,a;function o(e){var t,r,n,a=this;if(!(a instanceof o))return new o(e);if(a.constructor=o,e instanceof o)return a.s=e.s,void(m?!e.d||e.e>o.maxE?(a.e=NaN,a.d=null):e.e<o.minE?(a.e=0,a.d=[0]):(a.e=e.e,a.d=e.d.slice()):(a.e=e.e,a.d=e.d?e.d.slice():e.d));if("number"==(n=typeof e)){if(0===e)return a.s=1/e<0?-1:1,a.e=0,void(a.d=[0]);if(e<0?(e=-e,a.s=-1):a.s=1,e===~~e&&e<1e7){for(t=0,r=e;r>=10;r/=10)t++;return void(m?t>o.maxE?(a.e=NaN,a.d=null):t<o.minE?(a.e=0,a.d=[0]):(a.e=t,a.d=[e]):(a.e=t,a.d=[e]))}return 0*e!=0?(e||(a.s=NaN),a.e=NaN,void(a.d=null)):W(a,e.toString())}if("string"!==n)throw Error(p+e);return 45===(r=e.charCodeAt(0))?(e=e.slice(1),a.s=-1):(43===r&&(e=e.slice(1)),a.s=1),T.test(e)?W(a,e):X(a,e)}if(o.prototype=A,o.ROUND_UP=0,o.ROUND_DOWN=1,o.ROUND_CEIL=2,o.ROUND_FLOOR=3,o.ROUND_HALF_UP=4,o.ROUND_HALF_DOWN=5,o.ROUND_HALF_EVEN=6,o.ROUND_HALF_CEIL=7,o.ROUND_HALF_FLOOR=8,o.EUCLID=9,o.config=o.set=fe,o.clone=e,o.isDecimal=ye,o.abs=ee,o.acos=te,o.acosh=re,o.add=ne,o.asin=ae,o.asinh=oe,o.atan=ie,o.atanh=ue,o.atan2=se,o.cbrt=le,o.ceil=ce,o.cos=de,o.cosh=he,o.div=me,o.exp=ge,o.floor=pe,o.hypot=ve,o.ln=Ne,o.log=Me,o.log10=_e,o.log2=Re,o.max=Ee,o.min=Te,o.mod=Se,o.mul=Ce,o.pow=Ie,o.random=Ae,o.round=we,o.sign=xe,o.sin=De,o.sinh=be,o.sqrt=Oe,o.sub=Fe,o.tan=Ue,o.tanh=Le,o.trunc=Be,void 0===t&&(t={}),t&&!0!==t.defaults)for(a=["precision","rounding","toExpNeg","toExpPos","maxE","minE","modulo","crypto"],r=0;r<a.length;)t.hasOwnProperty(n=a[r++])||(t[n]=this[n]);return o.config(t),o}(h)).default=o.Decimal=o,f=new o(f),d=new o(d),void 0===(n=function(){return o}.call(t,r,t,e))||(e.exports=n)}()},2705:function(e,t,r){var n=r(5639).Symbol;e.exports=n},2488:function(e){e.exports=function(e,t){for(var r=-1,n=t.length,a=e.length;++r<n;)e[a+r]=t[r];return e}},1078:function(e,t,r){var n=r(2488),a=r(7285);e.exports=function e(t,r,o,i,u){var s=-1,l=t.length;for(o||(o=a),u||(u=[]);++s<l;){var c=t[s];r>0&&o(c)?r>1?e(c,r-1,o,i,u):n(u,c):i||(u[u.length]=c)}return u}},4239:function(e,t,r){var n=r(2705),a=r(9607),o=r(2333),i=n?n.toStringTag:void 0;e.exports=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":i&&i in Object(e)?a(e):o(e)}},9454:function(e,t,r){var n=r(4239),a=r(7005);e.exports=function(e){return a(e)&&"[object Arguments]"==n(e)}},1957:function(e,t,r){var n="object"==typeof r.g&&r.g&&r.g.Object===Object&&r.g;e.exports=n},9607:function(e,t,r){var n=r(2705),a=Object.prototype,o=a.hasOwnProperty,i=a.toString,u=n?n.toStringTag:void 0;e.exports=function(e){var t=o.call(e,u),r=e[u];try{e[u]=void 0;var n=!0}catch(e){}var a=i.call(e);return n&&(t?e[u]=r:delete e[u]),a}},7285:function(e,t,r){var n=r(2705),a=r(5694),o=r(1469),i=n?n.isConcatSpreadable:void 0;e.exports=function(e){return o(e)||a(e)||!!(i&&e&&e[i])}},2333:function(e){var t=Object.prototype.toString;e.exports=function(e){return t.call(e)}},5639:function(e,t,r){var n=r(1957),a="object"==typeof self&&self&&self.Object===Object&&self,o=n||a||Function("return this")();e.exports=o},5564:function(e,t,r){var n=r(1078);e.exports=function(e){return null!=e&&e.length?n(e,1):[]}},5694:function(e,t,r){var n=r(9454),a=r(7005),o=Object.prototype,i=o.hasOwnProperty,u=o.propertyIsEnumerable,s=n(function(){return arguments}())?n:function(e){return a(e)&&i.call(e,"callee")&&!u.call(e,"callee")};e.exports=s},1469:function(e){var t=Array.isArray;e.exports=t},7005:function(e){e.exports=function(e){return null!=e&&"object"==typeof e}},2582:function(e){e.exports=function(){function e(e,n,a,o,i){!function e(r,n,a,o,i){for(;o>a;){if(o-a>600){var u=o-a+1,s=n-a+1,l=Math.log(u),c=.5*Math.exp(2*l/3),f=.5*Math.sqrt(l*c*(u-c)/u)*(s-u/2<0?-1:1);e(r,n,Math.max(a,Math.floor(n-s*c/u+f)),Math.min(o,Math.floor(n+(u-s)*c/u+f)),i)}var d=r[n],h=a,m=o;for(t(r,a,n),i(r[o],d)>0&&t(r,a,o);h<m;){for(t(r,h,m),h++,m--;i(r[h],d)<0;)h++;for(;i(r[m],d)>0;)m--}0===i(r[a],d)?t(r,a,m):t(r,++m,o),m<=n&&(a=m+1),n<=m&&(o=m-1)}}(e,n,a||0,o||e.length-1,i||r)}function t(e,t,r){var n=e[t];e[t]=e[r],e[r]=n}function r(e,t){return e<t?-1:e>t?1:0}var n=function(e){void 0===e&&(e=9),this._maxEntries=Math.max(4,e),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),this.clear()};function a(e,t,r){if(!r)return t.indexOf(e);for(var n=0;n<t.length;n++)if(r(e,t[n]))return n;return-1}function o(e,t){i(e,0,e.children.length,t,e)}function i(e,t,r,n,a){a||(a=m(null)),a.minX=1/0,a.minY=1/0,a.maxX=-1/0,a.maxY=-1/0;for(var o=t;o<r;o++){var i=e.children[o];u(a,e.leaf?n(i):i)}return a}function u(e,t){return e.minX=Math.min(e.minX,t.minX),e.minY=Math.min(e.minY,t.minY),e.maxX=Math.max(e.maxX,t.maxX),e.maxY=Math.max(e.maxY,t.maxY),e}function s(e,t){return e.minX-t.minX}function l(e,t){return e.minY-t.minY}function c(e){return(e.maxX-e.minX)*(e.maxY-e.minY)}function f(e){return e.maxX-e.minX+(e.maxY-e.minY)}function d(e,t){return e.minX<=t.minX&&e.minY<=t.minY&&t.maxX<=e.maxX&&t.maxY<=e.maxY}function h(e,t){return t.minX<=e.maxX&&t.minY<=e.maxY&&t.maxX>=e.minX&&t.maxY>=e.minY}function m(e){return{children:e,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function g(t,r,n,a,o){for(var i=[r,n];i.length;)if(!((n=i.pop())-(r=i.pop())<=a)){var u=r+Math.ceil((n-r)/a/2)*a;e(t,u,r,n,o),i.push(r,u,u,n)}}return n.prototype.all=function(){return this._all(this.data,[])},n.prototype.search=function(e){var t=this.data,r=[];if(!h(e,t))return r;for(var n=this.toBBox,a=[];t;){for(var o=0;o<t.children.length;o++){var i=t.children[o],u=t.leaf?n(i):i;h(e,u)&&(t.leaf?r.push(i):d(e,u)?this._all(i,r):a.push(i))}t=a.pop()}return r},n.prototype.collides=function(e){var t=this.data;if(!h(e,t))return!1;for(var r=[];t;){for(var n=0;n<t.children.length;n++){var a=t.children[n],o=t.leaf?this.toBBox(a):a;if(h(e,o)){if(t.leaf||d(e,o))return!0;r.push(a)}}t=r.pop()}return!1},n.prototype.load=function(e){if(!e||!e.length)return this;if(e.length<this._minEntries){for(var t=0;t<e.length;t++)this.insert(e[t]);return this}var r=this._build(e.slice(),0,e.length-1,0);if(this.data.children.length)if(this.data.height===r.height)this._splitRoot(this.data,r);else{if(this.data.height<r.height){var n=this.data;this.data=r,r=n}this._insert(r,this.data.height-r.height-1,!0)}else this.data=r;return this},n.prototype.insert=function(e){return e&&this._insert(e,this.data.height-1),this},n.prototype.clear=function(){return this.data=m([]),this},n.prototype.remove=function(e,t){if(!e)return this;for(var r,n,o,i=this.data,u=this.toBBox(e),s=[],l=[];i||s.length;){if(i||(i=s.pop(),n=s[s.length-1],r=l.pop(),o=!0),i.leaf){var c=a(e,i.children,t);if(-1!==c)return i.children.splice(c,1),s.push(i),this._condense(s),this}o||i.leaf||!d(i,u)?n?(r++,i=n.children[r],o=!1):i=null:(s.push(i),l.push(r),r=0,n=i,i=i.children[0])}return this},n.prototype.toBBox=function(e){return e},n.prototype.compareMinX=function(e,t){return e.minX-t.minX},n.prototype.compareMinY=function(e,t){return e.minY-t.minY},n.prototype.toJSON=function(){return this.data},n.prototype.fromJSON=function(e){return this.data=e,this},n.prototype._all=function(e,t){for(var r=[];e;)e.leaf?t.push.apply(t,e.children):r.push.apply(r,e.children),e=r.pop();return t},n.prototype._build=function(e,t,r,n){var a,i=r-t+1,u=this._maxEntries;if(i<=u)return o(a=m(e.slice(t,r+1)),this.toBBox),a;n||(n=Math.ceil(Math.log(i)/Math.log(u)),u=Math.ceil(i/Math.pow(u,n-1))),(a=m([])).leaf=!1,a.height=n;var s=Math.ceil(i/u),l=s*Math.ceil(Math.sqrt(u));g(e,t,r,l,this.compareMinX);for(var c=t;c<=r;c+=l){var f=Math.min(c+l-1,r);g(e,c,f,s,this.compareMinY);for(var d=c;d<=f;d+=s){var h=Math.min(d+s-1,f);a.children.push(this._build(e,d,h,n-1))}}return o(a,this.toBBox),a},n.prototype._chooseSubtree=function(e,t,r,n){for(;n.push(t),!t.leaf&&n.length-1!==r;){for(var a=1/0,o=1/0,i=void 0,u=0;u<t.children.length;u++){var s=t.children[u],l=c(s),f=(d=e,h=s,(Math.max(h.maxX,d.maxX)-Math.min(h.minX,d.minX))*(Math.max(h.maxY,d.maxY)-Math.min(h.minY,d.minY))-l);f<o?(o=f,a=l<a?l:a,i=s):f===o&&l<a&&(a=l,i=s)}t=i||t.children[0]}var d,h;return t},n.prototype._insert=function(e,t,r){var n=r?e:this.toBBox(e),a=[],o=this._chooseSubtree(n,this.data,t,a);for(o.children.push(e),u(o,n);t>=0&&a[t].children.length>this._maxEntries;)this._split(a,t),t--;this._adjustParentBBoxes(n,a,t)},n.prototype._split=function(e,t){var r=e[t],n=r.children.length,a=this._minEntries;this._chooseSplitAxis(r,a,n);var i=this._chooseSplitIndex(r,a,n),u=m(r.children.splice(i,r.children.length-i));u.height=r.height,u.leaf=r.leaf,o(r,this.toBBox),o(u,this.toBBox),t?e[t-1].children.push(u):this._splitRoot(r,u)},n.prototype._splitRoot=function(e,t){this.data=m([e,t]),this.data.height=e.height+1,this.data.leaf=!1,o(this.data,this.toBBox)},n.prototype._chooseSplitIndex=function(e,t,r){for(var n,a,o,u,s,l,f,d=1/0,h=1/0,m=t;m<=r-t;m++){var g=i(e,0,m,this.toBBox),p=i(e,m,r,this.toBBox),v=(a=g,o=p,u=Math.max(a.minX,o.minX),s=Math.max(a.minY,o.minY),l=Math.min(a.maxX,o.maxX),f=Math.min(a.maxY,o.maxY),Math.max(0,l-u)*Math.max(0,f-s)),y=c(g)+c(p);v<d?(d=v,n=m,h=y<h?y:h):v===d&&y<h&&(h=y,n=m)}return n||r-t},n.prototype._chooseSplitAxis=function(e,t,r){var n=e.leaf?this.compareMinX:s,a=e.leaf?this.compareMinY:l;this._allDistMargin(e,t,r,n)<this._allDistMargin(e,t,r,a)&&e.children.sort(n)},n.prototype._allDistMargin=function(e,t,r,n){e.children.sort(n);for(var a=this.toBBox,o=i(e,0,t,a),s=i(e,r-t,r,a),l=f(o)+f(s),c=t;c<r-t;c++){var d=e.children[c];u(o,e.leaf?a(d):d),l+=f(o)}for(var h=r-t-1;h>=t;h--){var m=e.children[h];u(s,e.leaf?a(m):m),l+=f(s)}return l},n.prototype._adjustParentBBoxes=function(e,t,r){for(var n=r;n>=0;n--)u(t[n],e)},n.prototype._condense=function(e){for(var t=e.length-1,r=void 0;t>=0;t--)0===e[t].children.length?t>0?(r=e[t-1].children).splice(r.indexOf(e[t]),1):this.clear():o(e[t],this.toBBox)},n}()},8045:function(e,t,r){r.d(t,{HD:function(){return o},de:function(){return d},jr:function(){return a},lA:function(){return l},lr:function(){return c},n0:function(){return u},o8:function(){return i},yH:function(){return s},zH:function(){return f}});var n=r(8902);function a(e){return"string"==typeof e&&"="===e[0]&&e.length>1}function o(e){return"[object String]"===Object.prototype.toString.call(e)}function i(e){return void 0===e}function u(e){return/(^|!)\d+:\d+$/.test(e)}function s(e){return/(^|!)[A-Za-z]+:[A-Za-z]+$/.test(e)}function l(e){var t=e;if("string"!=typeof t)return!1;var r=t.lastIndexOf("!");return t=t.slice(r+1),/^\$?([A-Za-z]{1,3})\$?([1-9][0-9]{0,5})$/g.test(t)}function c(e){var t=e.split(":");return 2===t.length&&t.every((function(e){return l(e)}))}function f(e){var t;return!!(null===(t=e)||void 0===t?void 0:t.displayText)}function d(e){return void 0!==n.fR[e.funcName]}},8902:function(e,t,r){r.d(t,{A1:function(){return d},BT:function(){return u},JJ:function(){return l},JK:function(){return o},fR:function(){return h},kY:function(){return f},tM:function(){return m},u7:function(){return n},vG:function(){return i},v_:function(){return c},xU:function(){return a},yc:function(){return s}});var n,a={AND:!0,STOCK:!0,DAYS360:!0,DATEDIF:!0,E:!0,FALSE:!0,HLOOKUP:!0,IF:!0,INT:!0,ISEVEN:!0,ISODD:!0,ISNUMBER:!0,IFERROR:!0,ISNA:!0,ISERROR:!0,ISERR:!0,INDIRECT:!0,INDEX:!0,LOOKUP:!0,MATCH:!0,NOT:!0,OR:!0,TRUE:!0,VLOOKUP:!0,COUNTIF:!0,ASC:!0,CONCATENATE:!0,CONCAT:!0,TRIM:!0,VALUE:!0,SUBSTITUTE:!0,UPPER:!0,"WORKDAY.ORIGIN":!0,"WORKDAY.INTL":!0,FIXED:!0,PRODUCT:!0,REPT:!0,LOGICMATCH:!0,SPECIALMATCH:!0,EOMONTH:!0,EDATE:!0,IMSUB:!0,IMCONJUGATE:!0,COMPLEX:!0,SQRTPI:!0,FVSCHEDULE:!0,PROPER:!0,N:!0,EFFECT:!0,NOMINAL:!0,BIN2DEC:!0,BIN2OCT:!0,BIN2HEX:!0,OCT2BIN:!0,OCT2DEC:!0,OCT2HEX:!0,HEX2BIN:!0,HEX2OCT:!0,HEX2DEC:!0,DEC2BIN:!0,DEC2OCT:!0,DEC2HEX:!0,"ERF.ORIGIN":!0,"ERF.PRECISE":!0,"ERFC.PRECISE":!0,RANDBETWEEN:!0,CONVERT:!0,DELTA:!0,GESTEP:!0,LEN:!0},o={ID:!0,ID_FOR_HK:!0,MID:!0,RIGHT:!0,LEFT:!0,SPECIALMATCH:!0,COUNTIF:!0,COUNTIFS:!0,BIN2OCT:!0,BIN2DEC:!0,BIN2HEX:!0,OCT2BIN:!0,OCT2DEC:!0,OCT2HEX:!0,HEX2BIN:!0,HEX2OCT:!0,HEX2DEC:!0,SUBSTITUTE:!0,CONCAT:!0,CONCATENATE:!0},i={VLOOKUP:!0},u={ISERROR:!0,IFERROR:!0,ISERR:!0,ISNA:!0,IF:!0,COUNT:!0,COUNTA:!0,COUNTIF:!0,COUNTIFS:!0,CHOOSE:!0,ISNUMBER:!0,SUMIF:!0,SUMIFS:!0,ISBLANK:!0,COLUMN:!0,MATCH:!0,ISFORMULA:!0,ISREF:!0},s={VLOOKUP:!0,HLOOKUP:!0,LOOKUP:!0,ISNUMBER:!0,OR:!0,MATHMATCH:!0,LOGICMATCH:!0,AVERAGEA:!0,COUNTIFS:!0,MOD:!0,RANK:!0,"RANK.EQ":!0,"RANK.AVG":!0},l={OFFSET:!0,VLOOKUP:!0,HLOOKUP:!0},c={IFERROR:!0,ROW:!0,COLUMN:!0,N:!0},f={STOCK:!0},d={SUMPRODUCT:!0,LOOKUP:!0};!function(e){e.BOOL="BOOL",e.STRING="STRING",e.NUMBER="NUMBER",e.DATE="DATE",e.ARRAY="ARRAY",e.NOT_ARRAY="NOT_ARRAY",e.ANY="ANY"}(n||(n={}));var h={},m={SUM:{argumentsType:n.ANY,acceptRef:!0,min:1},IF:{argumentsType:[n.BOOL,n.NOT_ARRAY,n.NOT_ARRAY],min:2,max:3,acceptRef:!0},STOCK:{min:2,max:2},ID:{min:2,max:2},ID_FOR_HK:{min:2,max:2},ROUND:{argumentsType:[n.NUMBER,n.NUMBER],min:2,max:2},AVERAGE:{argumentsType:n.ANY,min:1,max:255,acceptRef:!0},COUNTIF:{argumentsType:[n.ANY,n.STRING],min:2,max:2,acceptRef:!0},MID:{argumentsType:[n.STRING,n.NUMBER,n.NUMBER],min:3,max:3},MAX:{argumentsType:n.ANY,min:1,max:255,acceptRef:!0},COUNTA:{argumentsType:n.ANY,min:1,max:255,acceptRef:!0},DATEDIF:{argumentsType:[n.DATE,n.DATE,n.STRING],min:3,max:3},COUNTIFS:{argumentsType:[n.ANY,n.STRING,n.ANY,n.STRING,n.ANY,n.STRING,n.ANY,n.STRING],min:2},SUBTOTAL:{argumentsType:[n.NUMBER,n.ANY,n.ANY],min:2,acceptRef:!0},MIN:{argumentsType:n.ANY,min:1,max:255,acceptRef:!0},COUNT:{argumentsType:n.ANY,min:1,acceptRef:!0},SUMIF:{argumentsType:[n.ANY,n.STRING,n.ANY],min:2,max:3,acceptRef:!0},SUMIFS:{argumentsType:[n.ANY,n.ANY,n.STRING,n.ANY,n.STRING,n.ANY,n.STRING],min:3,max:254},TEXT:{argumentsType:[n.NOT_ARRAY,n.STRING],min:2,max:2},LEFT:{argumentsType:[n.STRING,n.NUMBER],min:1,max:2},RIGHT:{argumentsType:[n.STRING,n.NUMBER],min:1,max:2},YEAR:{argumentsType:[n.DATE],min:1,max:1},INT:{argumentsType:[n.NUMBER],min:1,max:1},MOD:{argumentsType:[n.NUMBER,n.NUMBER],min:2,max:2},DATE:{argumentsType:[n.NUMBER,n.NUMBER,n.NUMBER],min:3,max:3},NOW:{argumentsType:[n.ANY],min:0,max:0},ABS:{argumentsType:[n.NUMBER],min:1,max:1},MONTH:{argumentsType:[n.DATE],min:1,max:1},RAND:{argumentsType:[n.ANY],min:0,max:0},SQRT:{argumentsType:[n.NUMBER],min:1,max:1},DAY:{argumentsType:[n.DATE],min:1,max:1},LEN:{argumentsType:[n.STRING],min:1,max:1},WEEKDAY:{argumentsType:[n.DATE,n.NUMBER],min:1,max:2},OR:{argumentsType:[n.ANY],min:1,max:255},INDIRECT:{argumentsType:[n.STRING,n.BOOL],min:1,max:2,acceptRef:!0},AND:{argumentsType:[n.ANY],min:1,max:255},ROUNDUP:{argumentsType:[n.NUMBER,n.NUMBER],min:2,max:2},ROUNDDOWN:{argumentsType:[n.NUMBER,n.NUMBER],min:2,max:2},VLOOKUP:{argumentsType:[n.NOT_ARRAY,n.ANY,n.STRING,n.BOOL],min:3,max:4,acceptRef:!0},HLOOKUP:{argumentsType:[n.NOT_ARRAY,n.ANY,n.STRING,n.BOOL],min:3,max:4,acceptRef:!0},LOOKUP:{argumentsType:[n.NOT_ARRAY,n.ANY,n.ANY],min:2,max:3,acceptRef:!0},INDEX:{argumentsType:[n.ANY,n.NUMBER,n.NUMBER,n.NUMBER],min:2,max:4,acceptRef:!0},ISERROR:{argumentsType:[n.NOT_ARRAY],min:1,max:1},ISERR:{argumentsType:[n.NOT_ARRAY],min:1,max:1},FIND:{argumentsType:[n.STRING,n.STRING,n.NUMBER],min:2,max:3},SUMPRODUCT:{argumentsType:n.ANY,min:1,acceptRef:!0},ISNA:{argumentsType:[n.ANY],min:1,max:1},ISNUMBER:{argumentsType:[n.NOT_ARRAY],min:1,max:1},IFERROR:{argumentsType:[n.ANY,n.NOT_ARRAY],min:2,max:2},ROW:{argumentsType:[n.ANY],min:0,max:1,acceptRef:!0},TODAY:{argumentsType:[n.ANY],min:0,max:0},MATCH:{argumentsType:[n.NOT_ARRAY,n.ARRAY,n.ANY],min:2,max:3,acceptRef:!0},TRIM:{argumentsType:[n.STRING],min:1,max:1},CONCATENATE:{argumentsType:[n.ARRAY],min:1},CONCAT:{argumentsType:n.ANY,min:1},CHOOSE:{argumentsType:[n.NUMBER,n.ANY],min:2,max:255,acceptRef:!0},PRODUCT:{argumentsType:n.ANY,min:1,acceptRef:!0},SPECIALMATCH:{argumentsType:[n.ANY,n.ANY,n.STRING],min:3,max:3},MATHMATCH:{argumentsType:[n.NUMBER,n.NUMBER,n.STRING],min:3,max:3,acceptRef:!0},LOGICMATCH:{argumentsType:[n.NOT_ARRAY,n.NOT_ARRAY,n.STRING],min:3,max:3},SUBSTITUTE:{argumentsType:[n.STRING,n.STRING,n.STRING,n.NUMBER],min:3,max:4},TRUNC:{argumentsType:[n.NUMBER,n.NUMBER],min:1,max:2},OFFSET:{argumentsType:[n.ANY,n.NUMBER,n.NUMBER,n.NUMBER,n.NUMBER],min:3,max:5,acceptRef:!0},VALUE:{argumentsType:[n.STRING],min:1,max:1},FIXED:{argumentsType:[n.NUMBER,n.NUMBER,n.BOOL],min:1,max:3},ISBLANK:{argumentsType:[n.NOT_ARRAY],min:1,max:1},ASC:{argumentsType:[n.STRING],min:1,max:1},UPPER:{argumentsType:[n.STRING],min:1,max:1},LN:{argumentsType:[n.NUMBER],min:1,max:1},"CEILING.ORIGIN":{argumentsType:[n.NUMBER,n.NUMBER],min:2,max:2},"CEILING.MATH":{argumentsType:[n.NUMBER,n.NUMBER,n.NUMBER],min:1,max:3},"CEILING.PRECISE":{argumentsType:[n.NUMBER,n.NUMBER],min:1,max:2},"FLOOR.ORIGIN":{argumentsType:[n.NUMBER,n.NUMBER],min:2,max:2},"FLOOR.MATH":{argumentsType:[n.NUMBER,n.NUMBER,n.NUMBER],min:1,max:3},"FLOOR.PRECISE":{argumentsType:[n.NUMBER,n.NUMBER],min:1,max:2},ADDRESS:{argumentsType:[n.NUMBER,n.NUMBER,n.NUMBER,n.BOOL,n.STRING],min:2,max:5},COLUMN:{argumentsType:[n.ANY],min:0,max:1,acceptRef:!0},"WORKDAY.ORIGIN":{argumentsType:[n.DATE,n.NOT_ARRAY,n.ARRAY],min:2,max:3},"WORKDAY.INTL":{argumentsType:[n.DATE,n.NOT_ARRAY,n.NUMBER,n.ARRAY],min:2,max:4},AVERAGEIF:{argumentsType:[n.ANY,n.ANY,n.ANY],min:2,max:3,acceptRef:!0},"RANK.EQ":{argumentsType:[n.NUMBER,n.ARRAY,n.NUMBER],min:2,max:3},"RANK.AVG":{argumentsType:[n.NUMBER,n.ARRAY,n.NUMBER],min:2,max:3},AVERAGEA:{argumentsType:n.ANY,min:1},LOG:{argumentsType:[n.NUMBER,n.NUMBER],min:1,max:2},CHAR:{argumentsType:[n.NUMBER],min:1,max:1},COS:{argumentsType:[n.NUMBER],min:1,max:1},SIN:{argumentsType:[n.NUMBER],min:1,max:1},SINH:{argumentsType:[n.NUMBER],min:1,max:1},TAN:{argumentsType:[n.NUMBER],min:1,max:1},ASIN:{argumentsType:[n.NUMBER],min:1,max:1},ACOS:{argumentsType:[n.NUMBER],min:1,max:1},ATAN:{argumentsType:[n.NUMBER],min:1,max:1},PI:{argumentsType:[],min:0,max:0},DEGREES:{argumentsType:[n.NUMBER],min:1,max:1},RADIANS:{argumentsType:[n.NUMBER],min:1,max:1},ISODD:{argumentsType:[n.NOT_ARRAY],min:1,max:1},N:{argumentsType:[n.ANY],min:1,max:1},REPT:{argumentsType:[n.STRING,n.NUMBER],min:2,max:2},SMALL:{argumentsType:[n.ARRAY,n.NOT_ARRAY],min:2,max:2},LARGE:{argumentsType:[n.ARRAY,n.NOT_ARRAY],min:2,max:2},MINUTE:{argumentsType:[n.DATE],min:1,max:1},HOUR:{argumentsType:[n.DATE],min:1,max:1},SECOND:{argumentsType:[n.DATE],min:1,max:1},NOT:{argumentsType:[n.NOT_ARRAY],min:1,max:1},PROPER:{argumentsType:[n.NOT_ARRAY],min:1,max:1},LOWER:{argumentsType:[n.NOT_ARRAY],min:1,max:1},EOMONTH:{argumentsType:[n.DATE,n.NUMBER],min:2,max:2},EDATE:{argumentsType:[n.DATE,n.NUMBER],min:2,max:2},PMT:{argumentsType:[n.NUMBER,n.NUMBER,n.NUMBER,n.NUMBER,n.NUMBER],min:3,max:5},IMSUB:{argumentsType:[n.NOT_ARRAY,n.NOT_ARRAY],min:2,max:2},IMCONJUGATE:{argumentsType:[n.NOT_ARRAY],min:1,max:1},COMPLEX:{argumentsType:[n.NUMBER,n.NUMBER,n.STRING],min:2,max:3},POWER:{argumentsType:[n.NUMBER,n.NUMBER],min:2,max:2},TRUE:{argumentsType:[],min:0,max:0},FALSE:{argumentsType:[],min:0,max:0},LOG10:{argumentsType:[n.NUMBER],min:1,max:1},EXP:{argumentsType:[n.NUMBER],min:1,max:1},RATE:{argumentsType:[n.NUMBER,n.NUMBER,n.NUMBER,n.NUMBER,n.NUMBER,n.NUMBER],min:3,max:6},SUMSQ:{argumentsType:n.ANY,min:1},STDEVA:{argumentsType:n.ANY,min:1},STDEVPA:{argumentsType:n.ANY,min:1},VARA:{argumentsType:n.ANY,min:1},VARPA:{argumentsType:n.ANY,min:1},AVEDEV:{argumentsType:n.ANY,min:1},DEVSQ:{argumentsType:n.ANY,min:1},EXACT:{argumentsType:[n.STRING,n.STRING],min:2,max:2},ROMAN:{argumentsType:[n.NUMBER,n.NUMBER],min:1,max:2},CORREL:{argumentsType:[n.ARRAY,n.ARRAY],min:2,max:2},TEXTJOIN:{argumentsType:n.ANY,min:3},GEOMEAN:{argumentsType:n.ANY,min:1},HARMEAN:{argumentsType:n.ANY,min:1},IPMT:{argumentsType:[n.NUMBER,n.NUMBER,n.NUMBER,n.NUMBER,n.NUMBER,n.NUMBER],min:4,max:6},PPMT:{argumentsType:[n.NUMBER,n.NUMBER,n.NUMBER,n.NUMBER,n.NUMBER,n.NUMBER],min:4,max:6},UNICHAR:{argumentsType:[n.NUMBER],min:1,max:1},UNICODE:{argumentsType:[n.ANY],min:1,max:1},CHIDIST:{argumentsType:[n.NUMBER,n.NUMBER],min:2,max:2},KURT:{argumentsType:n.ANY,min:1},INTERCEPT:{argumentsType:[n.ARRAY,n.ARRAY],min:2,max:2},PEARSON:{argumentsType:[n.ARRAY,n.ARRAY],min:2,max:2},RSQ:{argumentsType:[n.ARRAY,n.ARRAY],min:2,max:2},ISEVEN:{argumentsType:[n.NOT_ARRAY],min:1,max:1},"SKEW.ORIGIN":{argumentsType:n.ANY,min:1},"SKEW.P":{argumentsType:n.ANY,min:1},WEEKNUM:{argumentsType:[n.DATE,n.NUMBER],min:1,max:2},ISOWEEKNUM:{argumentsType:[n.DATE],min:1,max:1},SLOPE:{argumentsType:n.ANY,min:2,max:2},CODE:{min:1,max:1},ATAN2:{argumentsType:[n.NUMBER,n.NUMBER],min:2,max:2},ASINH:{argumentsType:[n.NUMBER],min:1,max:1},ACOSH:{argumentsType:[n.NUMBER],min:1,max:1},TANH:{argumentsType:[n.NUMBER],min:1,max:1},ATANH:{argumentsType:[n.NUMBER],min:1,max:1},COSH:{argumentsType:[n.NUMBER],min:1,max:1},COT:{argumentsType:[n.NUMBER],min:1,max:1},COTH:{argumentsType:[n.NUMBER],min:1,max:1},ACOT:{argumentsType:[n.NUMBER],min:1,max:1},ACOTH:{argumentsType:[n.NUMBER],min:1,max:1},REPLACE:{argumentsType:[n.STRING,n.NUMBER,n.NUMBER,n.STRING],min:4,max:4},CLEAN:{argumentsType:[n.STRING],min:1,max:1},FV:{argumentsType:[n.NUMBER,n.NUMBER,n.NUMBER,n.NUMBER,n.NUMBER],min:3,max:5},DOLLAR:{argumentsType:[n.NUMBER,n.NUMBER],min:1,max:2},XOR:{argumentsType:n.ANY,min:1},PV:{argumentsType:[n.NUMBER,n.NUMBER,n.NUMBER,n.NUMBER,n.NUMBER],min:3,max:5},SQRTPI:{argumentsType:[n.NUMBER],min:1,max:1},TIME:{argumentsType:[n.NUMBER,n.NUMBER,n.NUMBER],min:3,max:3},DATEVALUE:{argumentsType:[n.STRING],min:1,max:1},TIMEVALUE:{argumentsType:[n.STRING],min:1,max:1},FVSCHEDULE:{argumentsType:[n.NOT_ARRAY,n.ANY],min:2,max:2},"VAR.P":{argumentsType:n.ANY,min:1},"VAR.S":{argumentsType:n.ANY,min:1},"STDEV.S":{argumentsType:n.ANY,min:1},IRR:{argumentsType:[n.ARRAY,n.NUMBER],min:1,max:2},DAYS:{argumentsType:[n.DATE,n.DATE],min:2,max:2},DAYS360:{argumentsType:[n.DATE,n.DATE,n.BOOL],min:2,max:3},YEARFRAC:{argumentsType:[n.DATE,n.DATE,n.NUMBER],min:2,max:3},CUMIPMT:{argumentsType:[n.NUMBER,n.NUMBER,n.NUMBER,n.NUMBER,n.NUMBER,n.NUMBER],min:6,max:6},CUMPRINC:{argumentsType:[n.NUMBER,n.NUMBER,n.NUMBER,n.NUMBER,n.NUMBER,n.NUMBER],min:6,max:6},T:{argumentsType:[n.ANY],min:1,max:1},MROUND:{argumentsType:[n.NUMBER,n.NUMBER],min:2,max:2},EFFECT:{argumentsType:[n.NUMBER,n.NUMBER],min:2,max:2},NOMINAL:{argumentsType:[n.NUMBER,n.NUMBER],min:2,max:2},EVEN:{argumentsType:[n.NUMBER],min:1,max:1},ODD:{argumentsType:[n.NUMBER],min:1,max:1},BESSELI:{argumentsType:[n.NUMBER,n.NUMBER],min:2,max:2},BESSELJ:{argumentsType:[n.NUMBER,n.NUMBER],min:2,max:2},BESSELK:{argumentsType:[n.NUMBER,n.NUMBER],min:2,max:2},BESSELY:{argumentsType:[n.NUMBER,n.NUMBER],min:2,max:2},TRIMMEAN:{argumentsType:[n.ANY,n.NUMBER],min:2,max:2},BIN2DEC:{argumentsType:[n.STRING],min:1,max:1},BIN2OCT:{argumentsType:[n.STRING,n.NUMBER],min:1,max:2},BIN2HEX:{argumentsType:[n.STRING,n.NUMBER],min:1,max:2},OCT2DEC:{argumentsType:[n.STRING],min:1,max:1},OCT2BIN:{argumentsType:[n.STRING,n.NUMBER],min:1,max:2},OCT2HEX:{argumentsType:[n.STRING,n.NUMBER],min:1,max:2},HEX2BIN:{argumentsType:[n.STRING,n.NUMBER],min:1,max:2},HEX2OCT:{argumentsType:[n.STRING,n.NUMBER],min:1,max:2},HEX2DEC:{argumentsType:[n.STRING],min:1,max:1},DEC2BIN:{argumentsType:[n.STRING,n.NUMBER],min:1,max:2},DEC2OCT:{argumentsType:[n.STRING,n.NUMBER],min:1,max:2},DEC2HEX:{argumentsType:[n.STRING,n.NUMBER],min:1,max:2},SYD:{argumentsType:[n.NUMBER,n.NUMBER,n.NUMBER,n.NUMBER],min:4,max:4},SLN:{argumentsType:[n.NUMBER,n.NUMBER,n.NUMBER],min:3,max:3},MAXA:{argumentsType:n.ANY,min:1},MINA:{argumentsType:n.ANY,min:1},PRICE:{argumentsType:[n.DATE,n.DATE,n.NUMBER,n.NUMBER,n.NUMBER,n.NUMBER,n.NUMBER],min:6,max:7},PRICEDISC:{argumentsType:[n.DATE,n.DATE,n.NUMBER,n.NUMBER,n.NUMBER],min:4,max:5},"MODE.SNGL":{argumentsType:n.ANY,min:1},MEDIAN:{argumentsType:n.ANY,min:1},PRICEMAT:{argumentsType:[n.DATE,n.DATE,n.DATE,n.NUMBER,n.NUMBER,n.NUMBER],min:5,max:6},"PERCENTRANK.INC":{argumentsType:[n.ARRAY,n.NUMBER,n.NUMBER],min:2,max:3},"PERCENTRANK.EXC":{argumentsType:[n.ARRAY,n.NUMBER,n.NUMBER],min:2,max:3},YIELD:{argumentsType:[n.DATE,n.DATE,n.NUMBER,n.NUMBER,n.NUMBER,n.NUMBER,n.NUMBER],min:6,max:7},YIELDMAT:{argumentsType:[n.DATE,n.DATE,n.DATE,n.NUMBER,n.NUMBER,n.NUMBER],min:5,max:6},YIELDDISC:{argumentsType:[n.DATE,n.DATE,n.NUMBER,n.NUMBER,n.NUMBER],min:4,max:5},DB:{argumentsType:[n.NUMBER,n.NUMBER,n.NUMBER,n.NUMBER,n.NUMBER],min:4,max:5},"ERF.ORIGIN":{argumentsType:[n.NUMBER,n.NUMBER],min:1,max:2},"ERF.PRECISE":{argumentsType:[n.NUMBER],min:1,max:1},"ERFC.PRECISE":{argumentsType:[n.NUMBER],min:1,max:1},NA:{argumentsType:[],min:0,max:0},SEARCH:{argumentsType:[n.STRING,n.STRING,n.NUMBER],min:2,max:3},RANDBETWEEN:{argumentsType:[n.NUMBER,n.NUMBER],min:2,max:2},CONVERT:{argumentsType:[n.NUMBER,n.STRING,n.STRING],min:3,max:3},COUNTBLANK:{argumentsType:[n.ARRAY],min:1,max:1},DELTA:{argumentsType:[n.NUMBER,n.NUMBER],min:1,max:2},GESTEP:{argumentsType:[n.NUMBER,n.NUMBER],min:1,max:2},MINVERSE:{argumentsType:[n.ANY],min:1,max:1,acceptRef:!0},MMULT:{argumentsType:[n.ANY,n.ANY],min:2,max:2,acceptRef:!0},"NETWORKDAYS.ORIGIN":{argumentsType:[n.NOT_ARRAY,n.NOT_ARRAY],min:2,max:3},"NETWORKDAYS.INTL":{argumentsType:[n.NOT_ARRAY,n.NOT_ARRAY],min:2,max:4},ISFORMULA:{argumentsType:n.ANY,min:1,max:1,acceptRef:!0},ISREF:{argumentsType:n.ANY,min:1,max:1,acceptRef:!0},AVERAGEIFS:{argumentsType:n.ANY,min:1,acceptRef:!0},FREQUENCY:{argumentsType:[n.ANY,n.ANY],min:2,max:2,acceptRef:!0},TRANSPOSE:{argumentsType:n.ANY,min:1,max:1},MINIFS:{argumentsType:n.ANY,min:3,acceptRef:!0},MAXIFS:{argumentsType:n.ANY,min:3,acceptRef:!0},REGEXMATCH:{argumentsType:[n.STRING,n.STRING,n.BOOL],min:3,acceptRef:!0},HYPERLINK:{argumentsType:[n.STRING,n.STRING],min:1,max:2},URL:{argumentsType:[n.ANY],min:1,max:1,acceptRef:!0}}},9678:function(e,t,r){r.d(t,{Z:function(){return n}});var n=function(){function e(){}function t(e,r){for(var n in r)if(r.hasOwnProperty(n)){var a=r[n];Array.isArray(a)?(e[n]=[],t(e[n],r[n])):"object"==typeof a?(e[n]={},t(e[n],r[n])):e[n]=r[n]}}return e._insert=function(e,t,r){e.splice(t,0,r)},e._add=function(e,t){e.push(t)},e._contains=function(e,t){return e.indexOf(t)>-1},e._remove=function(e,t){var r=e.indexOf(t);r>-1&&e.splice(r,1)},e._removeByIndex=function(e,t){return e.slice(0,t).concat(e.slice(t+1))},e._indexOf=function(e,t,r){return e.indexOf(t,r)},e._clear=function(e,t,r){if(!(t<0))for(var n=0;n<r&&t+n<e.length;n++)e[t+n]=null},e._nextNonEmptyIndex=function(e,t){t<0&&(t=-1);for(var r=t+1;r<e.length;r++)if(void 0!==e[r]&&null!==e[r])return r;return-1},e._getLength=function(e){return e&&e.length},e._clone=function(e){var r=[];return t(r,e),r},e}()},1501:function(e,t,r){r.d(t,{s:function(){return T}});var n=r(2021),a=r(8657),o=r(7686),i=r(8045),u=o.Z,s=u._inherit,l=u._each,c=void 0,f=null;window;var d=["MM/dd/yyyy","MM/d/yyyy","M/dd/yyyy","M/d/yyyy","yy/MM/dd","yy/MM/d","yy/M/dd","yy/M/d","yyyy/MM/dd","yyyy/MM/d","yyyy/M/dd","yyyy/M/d"],h=["hh:mm:ss","hh:mm:s","hh:m:ss","hh:m:s","h:mm:ss","h:mm:s","h:m:ss","h:m:s","hh:mm:ss tt","hh:mm:s tt","hh:m:ss tt","hh:m:s tt","h:mm:ss tt","h:mm:s tt","h:m:ss tt","h:m:s tt","hh:mm","hh:m","h:mm","h:m","hh:mm tt","hh:m tt","h:mm tt","h:m tt"],m=["MM-dd-yyyy","MM-d-yyyy","M-dd-yyyy","M-d-yyyy","yy-MM-dd","yy-MM-d","yy-M-dd","yy-M-d","yyyy-MM-dd","yyyy-MM-d","yyyy-M-dd","yyyy-M-d","dd-MMMM-yy","dd-MMM-yy"],g=d.concat(h);l(d,(function(e,t){l(h,(function(e,r){e<h.length-4&&g.push(t+" "+r)}))})),g=g.concat(m),l(m,(function(e,t){l(h,(function(e,r){e<h.length-4&&g.push(t+" "+r)}))}));var p=function(){function e(){this.NumberFormat={currencyDecimalDigits:2,currencyDecimalSeparator:".",currencyGroupSeparator:",",currencyGroupSizes:[3],currencyNegativePattern:0,currencyPositivePattern:0,currencySymbol:"",digitSubstitution:1,isReadOnly:!0,numberGroupSizes:[3],nanSymbol:"NaN",nativeDigits:["0","1","2","3","4","5","6","7","8","9"],numberNegativePattern:1,negativeInfinitySymbol:"-Infinity",negativeSign:"-",numberDecimalDigits:2,numberDecimalSeparator:".",numberGroupSeparator:",",positiveInfinitySymbol:"Infinity",positiveSign:"+",percentDecimalDigits:2,percentDecimalSeparator:".",percentGroupSeparator:",",percentGroupSizes:[3],percentNegativePattern:0,percentPositivePattern:0,percentSymbol:"%",perMilleSymbol:"",listSeparator:",",arrayListSeparator:",",arrayGroupSeparator:";",dbNumber:{}},this.DateTimeFormat={abbreviatedDayNames:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],abbreviatedMonthGenitiveNames:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec",""],abbreviatedMonthNames:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec",""],amDesignator:"AM",calendarIsReadOnly:!0,calendarWeekRule:0,Calendar:{MinSupportedDateTime:"@-62135568000000@",MaxSupportedDateTime:"@253402300799999@",AlgorithmType:1,CalendarType:1,Eras:[1],TwoDigitYearMax:2029,isReadOnly:!0},dateSeparator:"/",dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],firstDayOfWeek:0,fullDateTimePattern:"dddd, dd MMMM yyyy HH:mm:ss",longDatePattern:"dddd, dd MMMM yyyy",longTimePattern:"HH:mm:ss",monthDayPattern:"MMMM dd",monthGenitiveNames:["January","February","March","April","May","June","July","August","September","October","November","December",""],monthNames:["January","February","March","April","May","June","July","August","September","October","November","December",""],nativeCalendarName:"Gregorian Calendar",pmDesignator:"PM",rfc1123Pattern:"ddd, dd MMM yyyy HH':'mm':'ss 'GMT'",shortDatePattern:"MM/dd/yyyy",shortestDayNames:["Su","Mo","Tu","We","Th","Fr","Sa"],shortTimePattern:"HH:mm",sortableDateTimePattern:"yyyy'-'MM'-'dd'T'HH':'mm':'ss",timeSeparator:":",universalSortableDateTimePattern:"yyyy'-'MM'-'dd HH':'mm':'ss'Z'",yearMonthPattern:"yyyy MMMM",filterDialogDateFormatter:"yyyy/mmmm/dd"},this.name=function(){return""},this.id=-1}function t(e){return e.split("").join(" ").toUpperCase()}function r(e){for(var r=[],n=0,a=e.length;n<a;n++)r[n]=t(e[n]);return r}function n(e,r,n){var a=t(e),o=r.indexOf(a);return-1===o&&(o=n.indexOf(a)),o}return e.prototype={constructor:e,_getDateTimePattern:function(){if(!this._dateTimeFormatPattern){var e=this.DateTimeFormat.shortDatePattern.replace(/m/g,"M"),t=[e,e+" h:mm",e+" h:mm:ss",e+" h:mm:ss.0","MMMdd","MMMd","MMM dd","MMM d"];this._dateTimeFormatPattern=t.concat(g)}return this._dateTimeFormatPattern},_getMonthIndex:function(e){var t=this;return t._upperMonths||(t._upperMonths=r(t.DateTimeFormat.monthNames),t._upperMonthsGenitive=r(t.DateTimeFormat.monthGenitiveNames)),n(e,t._upperMonths,t._upperMonthsGenitive)},_getAbbrMonthIndex:function(e){var t=this;return t._upperAbbrMonths||(t._upperAbbrMonths=r(t.DateTimeFormat.abbreviatedMonthNames),t._upperAbbrMonthsGenitive=r(t.DateTimeFormat.abbreviatedMonthGenitiveNames)),n(e,t._upperAbbrMonths,t._upperAbbrMonthsGenitive)},_getDayIndex:function(e){var n=this;return n._upperDays||(n._upperDays=r(n.DateTimeFormat.dayNames)),n._upperDays.indexOf(t(e))},_getAbbrDayIndex:function(e){var n=this;return n._upperAbbrDays||(n._upperAbbrDays=r(n.DateTimeFormat.abbreviatedDayNames)),n._upperAbbrDays.indexOf(t(e))}},e}(),v=function(){function e(){}return e._isValidEraDate=function(e){return e>=this._getEraMin()&&e<=this._getEraMax()},e._getEraDates=function(){var e=p.eras;if(e!==c){for(var t=[],r=0;r<e.length;r++)t[r]=new Date(e[r].startDate.replace(/-/g,"/"));return t}return this._EraDates},e._getEraPropByFormat=function(e){var t,r,n=this;switch(e){case"g":t="symbol",r=n._symbols;break;case"gg":t="abbreviation",r=n._abbreviations;break;case"ggg":t="name",r=n._names;break;default:return[]}var a=p.eras,o=[];if(a!==c){for(var i=0;i<a.length;i++)o[i]=a[i][t];return o}return r},e._getEraMax=function(){var e=p.eras;if(e!==c&&e.length>0){var t=new Date(e[e.length-1].startDate.replace(/-/g,"/"));return t.setFullYear(t.getFullYear()+99),t}return this._EraMax},e._getEraMin=function(){var e=p.eras;return e!==c&&e.length>0?new Date(e[0].startDate.replace(/-/g,"/")):this._EraMin},e._getEraCount=function(){var e=p.eras;return e!==c?e.length:this._EraCount},e._getEraYears=function(){var e=p.eras;if(e!==c){for(var t=[],r=1;r<e.length;r++){var n=new Date(e[r-1].startDate.replace(/-/g,"/")),a=new Date(e[r].startDate.replace(/-/g,"/"));t[r-1]=a.getFullYear()-n.getFullYear()+1}return t[r-1]=99,t}return this._EraYears},e._getEraDate=function(e){var t={_era:-1,_eraYear:-1},r=this;if(!r._isValidEraDate(e))return t;for(var n=0;n<r._getEraCount();n++)if(e<(n+1!==r._getEraCount()?r._getEraDates()[n+1]:r._addMilliseconds(r._getEraMax(),1))){t._era=n,t._eraYear=e.getFullYear()-r._getEraDates()[n].getFullYear()+1;break}return t},e._addMilliseconds=function(e,t){var r=new Date(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds());return r.setMilliseconds(r.getMilliseconds()+t),new Date(r.valueOf())},e._getYearFromEra=function(t,r){return e._getEraDates()[t].getFullYear()+r-1},e._parseEraPart=function(t,r){r=r.toUpperCase();for(var n=e._getEraPropByFormat(t),a=0;a<n.length;a++)if(n[a]===r)return a;return-1},e._formatEraPart=function(t,r){var n=e,a=n._getEraDate(r),o=a._era;if(o>=0){var i=n._getEraPropByFormat(t);if(i.length>0)return i[o]}var u=a._eraYear;if(u>=0){var s=u.toString();if("ee"===t)return 1===s.length&&(s="0"+s),s;if("e"===t)return s}return""},e._EraDates=[new Date(1868,8,8),new Date(1912,6,30),new Date(1926,11,25),new Date(1989,0,8)],e._EraCount=4,e._EraYears=[45,15,64,99],e._EraMax=new Date(2087,11,31,23,59,59),e._EraMin=new Date(1868,8,8),e._shortcuts=["1,m","2,t","3,s","4,h"],e._EraIndices=[0,1,2,3,0,1,2,3],e._names=[n.default.t(""),n.default.t(""),n.default.t(""),n.default.t("")],e._symbols=["M","T","S","H"],e._abbreviations=[n.default.t(""),n.default.t(""),n.default.t(""),n.default.t("")],e._EraYearMax=99,e}(),y=function(e){function t(){e.apply(this,arguments),E.call(this,"NumberFormat",["currencySymbol","isReadOnly"],["$",!1]),E.call(this,"DateTimeFormat",["fullDateTimePattern","longDatePattern","longTimePattern","shortDatePattern","shortTimePattern","yearMonthPattern","calendarIsReadOnly"],["dddd, MMMM dd, yyyy h:mm:ss tt","dddd, MMMM dd, yyyy","h:mm:ss tt","M/d/yyyy","h:mm tt","MMMM, yyyy",!1]),this.name=function(){return"en-US"},this.id=1033}return s(t,e),t}(p),N=function(e){function t(){e.apply(this,arguments);var t={1:{letters:[n.default.t(""),n.default.t(""),n.default.t(""),n.default.t(""),n.default.t(""),n.default.t(""),n.default.t(""),n.default.t(""),n.default.t(""),n.default.t(""),n.default.t(""),n.default.t(""),""],numbers:["",n.default.t(""),n.default.t(""),n.default.t(""),n.default.t(""),n.default.t(""),n.default.t(""),n.default.t(""),n.default.t(""),n.default.t("")]},2:{letters:[n.default.t(""),n.default.t(""),n.default.t(""),n.default.t(""),n.default.t(""),n.default.t(""),n.default.t(""),n.default.t(""),n.default.t(""),n.default.t(""),n.default.t(""),n.default.t(""),""],numbers:["",n.default.t(""),n.default.t(""),n.default.t(""),n.default.t(""),n.default.t(""),n.default.t(""),n.default.t(""),n.default.t(""),n.default.t("")]},3:{letters:f,numbers:["","","","","","","","","",""]}};E.call(this,"NumberFormat",["currencyDecimalDigits","currencyNegativePattern","currencySymbol","isReadOnly","nanSymbol","negativeInfinitySymbol","percentNegativePattern","percentPositivePattern","positiveInfinitySymbol","dbNumber"],[0,1,"",!1,n.default.t("NaN ()"),"-",1,1,"+",t]);var r=["1","2","3","4","5","6","7","8","9","10","11","12",""],a=[n.default.t("1"),n.default.t("2"),n.default.t("3"),n.default.t("4"),n.default.t("5"),n.default.t("6"),n.default.t("7"),n.default.t("8"),n.default.t("9"),n.default.t("10"),n.default.t("11"),n.default.t("12"),""];E.call(this,"DateTimeFormat",["abbreviatedDayNames","abbreviatedMonthGenitiveNames","abbreviatedMonthNames","amDesignator","calendarIsReadOnly","dayNames","fullDateTimePattern","longDatePattern","longTimePattern","monthDayPattern","monthGenitiveNames","monthNames","nativeCalendarName","pmDesignator","shortDatePattern","shortestDayNames","shortTimePattern","yearMonthPattern","filterDialogDateFormatter","EraFilterDialogDateFormatter"],[[n.default.t(""),n.default.t(""),n.default.t(""),n.default.t(""),n.default.t(""),n.default.t(""),n.default.t("")],r,r,n.default.t(""),!1,[n.default.t(""),n.default.t(""),n.default.t(""),n.default.t(""),n.default.t(""),n.default.t(""),n.default.t("")],n.default.t("yyyy''M''d'' H:mm:ss"),n.default.t("yyyy''M''d''"),"H:mm:ss",n.default.t("M''d''"),a,a,n.default.t(" ()"),n.default.t(""),"yyyy/MM/dd",[n.default.t(""),n.default.t(""),n.default.t(""),n.default.t(""),n.default.t(""),n.default.t(""),n.default.t("")],"H:mm",n.default.t("yyyy''M''"),n.default.t("yyyy/mmmm/d"),n.default.t("ggge/mmmm/d")]),this.DateTimeFormat.eras=v,this.name=function(){return"ja-JP"},this.id=1041,this.isJCKCulture=!0}return s(t,e),t}(p),M=function(e){function t(){e.apply(this,arguments);var t={1:{letters:[n.default.t(""),n.default.t(""),n.default.t(""),n.default.t(""),n.default.t(""),n.default.t(""),n.default.t(""),n.default.t(""),n.default.t(""),n.default.t(""),n.default.t(""),n.default.t(""),""],numbers:["",n.default.t(""),n.default.t(""),n.default.t(""),n.default.t(""),n.default.t(""),n.default.t(""),n.default.t(""),n.default.t(""),n.default.t("")]},2:{letters:[n.default.t(""),n.default.t(""),n.default.t(""),n.default.t(""),n.default.t(""),n.default.t(""),n.default.t(""),n.default.t(""),n.default.t(""),n.default.t(""),n.default.t(""),n.default.t(""),""],numbers:[n.default.t(""),n.default.t(""),n.default.t(""),n.default.t(""),n.default.t(""),n.default.t(""),n.default.t(""),n.default.t(""),n.default.t(""),n.default.t("")]},3:{letters:f,numbers:["","","","","","","","","",""]}};E.call(this,"NumberFormat",["currencyNegativePattern","currencySymbol","isReadOnly","nanSymbol","negativeInfinitySymbol","percentNegativePattern","percentPositivePattern","positiveInfinitySymbol","dbNumber"],[2,"",!1,n.default.t(""),n.default.t(""),1,1,n.default.t(""),t]);var r=[n.default.t("1"),n.default.t("2"),n.default.t("3"),n.default.t("4"),n.default.t("5"),n.default.t("6"),n.default.t("7"),n.default.t("8"),n.default.t("9"),n.default.t("10"),n.default.t("11"),n.default.t("12"),""],a=[n.default.t(""),n.default.t(""),n.default.t(""),n.default.t(""),n.default.t(""),n.default.t(""),n.default.t(""),n.default.t(""),n.default.t(""),n.default.t(""),n.default.t(""),n.default.t(""),""];E.call(this,"DateTimeFormat",["abbreviatedDayNames","abbreviatedMonthGenitiveNames","abbreviatedMonthNames","amDesignator","calendarIsReadOnly","dayNames","firstDayOfWeek","fullDateTimePattern","longDatePattern","longTimePattern","monthDayPattern","monthGenitiveNames","monthNames","nativeCalendarName","pmDesignator","shortDatePattern","shortestDayNames","shortTimePattern","yearMonthPattern","filterDialogDateFormatter"],[[n.default.t(""),n.default.t(""),n.default.t(""),n.default.t(""),n.default.t(""),n.default.t(""),n.default.t("")],r,r,n.default.t(""),!1,[n.default.t(""),n.default.t(""),n.default.t(""),n.default.t(""),n.default.t(""),n.default.t(""),n.default.t("")],1,n.default.t("yyyy''M''d'' H:mm:ss"),n.default.t("yyyy''M''d''"),"H:mm:ss",n.default.t("M''d''"),a,a,n.default.t(""),n.default.t(""),"yyyy/M/d",[n.default.t(""),n.default.t(""),n.default.t(""),n.default.t(""),n.default.t(""),n.default.t(""),n.default.t("")],"H:mm",n.default.t("yyyy''M''"),n.default.t("yyyy/mmmm/d")]),this.name=function(){return"zh-cn"},this.id=2052,this.isJCKCulture=!0}return s(t,e),t}(p),R=function(e){function t(){e.apply(this,arguments);var t={1:{letters:[n.default.t(""),n.default.t(""),n.default.t(""),n.default.t(""),n.default.t(""),n.default.t(""),n.default.t(""),n.default.t(""),n.default.t(""),n.default.t(""),n.default.t(""),n.default.t(""),""],numbers:["",n.default.t(""),n.default.t(""),n.default.t(""),n.default.t(""),n.default.t(""),"",n.default.t(""),n.default.t(""),n.default.t("")]},2:{letters:[n.default.t(""),n.default.t(""),n.default.t(""),"",n.default.t(""),n.default.t(""),n.default.t(""),"",n.default.t(""),n.default.t(""),n.default.t(""),"",""],numbers:["",n.default.t(""),n.default.t(""),"",n.default.t(""),n.default.t(""),"",n.default.t(""),n.default.t(""),n.default.t("")]},3:{letters:[n.default.t(""),n.default.t(""),n.default.t(""),n.default.t(""),n.default.t(""),n.default.t(""),n.default.t(""),n.default.t(""),n.default.t(""),n.default.t(""),n.default.t(""),n.default.t(""),""],numbers:["","","","","","","","","",""]}};E.call(this,"NumberFormat",["currencyDecimalDigits","currencyNegativePattern","currencySymbol","isReadOnly","dbNumber"],[0,1,"",!1,t]);var r=["1","2","3","4","5","6","7","8","9","10","11","12",""],a=["1","2","3","4","5","6","7","8","9","10","11","12",""];E.call(this,"DateTimeFormat",["abbreviatedDayNames","abbreviatedMonthGenitiveNames","abbreviatedMonthNames","amDesignator","calendarIsReadOnly","dayNames","firstDayOfWeek","fullDateTimePattern","longDatePattern","longTimePattern","monthDayPattern","monthGenitiveNames","monthNames","nativeCalendarName","pmDesignator","shortDatePattern","shortestDayNames","shortTimePattern","yearMonthPattern","filterDialogDateFormatter"],[["","","","","","",""],r,r,"",!1,["","","","","","",""],1,"yyyy'' M'' d'' dddd h:mm:ss","yyyy'' M'' d'' dddd","h:mm:ss","M'' d''",a,a,"","","yyyy-MM-dd",["","","","","","",""],"tt h:mm","yyyy'' M''","yyyy/mmmm/d"]),this.name=function(){return"ko-kr"},this.id=1042,this.isJCKCulture=!0}return s(t,e),t}(p),_={invariant:new p,"en-us":new y,"ja-jp":new N,"zh-cn":new M,"ko-kr":new R};function E(e,t,r){for(var n,a=0,o=t.length;a<o;a++)n=t[a],this[e][n]=r[a]}var T=new(function(){if("object"==typeof e.instance)return e.instance;function e(){var t="en-us";this.culture=function(e){if(0===arguments.length)return t;e&&t!==e&&(t=e.toLowerCase())},this.addCultureInfo=function(e,t){var r=t.NumberFormat.numberDecimalSeparator,n=t.NumberFormat.arrayListSeparator,o=t.NumberFormat.arrayGroupSeparator;if(r===t.NumberFormat.listSeparator||o===n)throw new Error(a.wI.Exp_Separator);_[e.toLowerCase()]=t},this.getCultureInfo=function(e){if(0===arguments.length)return _[t];e=(0,i.HD)(e)?e.toLowerCase():e;var r=_,n=f;for(var a in r)if(a===e||r[a].id!==c&&r[a].id===e){n=r[a];break}return n},this._getCultureInfo=function(e){var r=this.getCultureInfo(e);return r||(r=_[t])||(r=new p),r},this._getFilterDialogFormatterStr=function(e,t){var r=(this.getCultureInfo(e)||this.getCultureInfo("en-US")).DateTimeFormat,n=r.filterDialogDateFormatter;return(t.indexOf("g")>=0||t.indexOf("e")>=0)&&(n=r.EraFilterDialogDateFormatter||n),n},e.instance=this}return e}())},8422:function(e,t,r){r.d(t,{Z:function(){return v}});var n=r(8657),a=r(6593),o=r(9678),i=r(1501),u=r(7686).Z._isNullOrUndefined,s=a.Z._padZeroLeft,l=null,c=parseInt,f=!1,d=!0,h=Math.floor,m=Math.abs,g={},p=function(){function e(e,t,r){var n,a,o,i,u,s=f;for((u=r).slice(1).forEach((function(e){e&&(s=!0)})),s||(u=u.concat(t._getDateTimePattern())),n=1,a=u.length;n<a;n++)if((i=u[n])&&(s=d,o=y(e,i,t)))return o;return l}function t(e,a,o){var i=o.DateTimeFormat,u=i.Calendar.convert;if(!a||!a.length)return o&&o.name.length?u?t(e,i.fullDateTimePattern,o):e.toLocaleString():e.toString();var l,c,f,g=i.eras,p="",v=/([^d]|^)(d|dd)([^d]|$)/g;function y(){return c||f||(c=v.test(a),f=d),c}var N,M=0,R=/\/|dddd|ddd|dd|d|MMMM|MMM|MM|M|yyyy|yyy|yy|y|hh|h|HH|H|mm|m|ss|s|tt|t|fff|ff|f|000|00|0|zzz|zz|z|ggg|gg|g|ee|e|\[H\]|\[HH\]|\[h\]|\[hh\]|\[mm\]|\[s\]|\[ss\]/g;function _(e,t){if(N)return N[t];switch(t){case 0:return e.getFullYear();case 1:return e.getMonth();case 2:return e.getDate();default:return}}"s"!==a&&u&&(N=u.fromGregorian(e));for(var E=-2,T=-2,S={_value:""},C=0;;C++){var I=R.lastIndex,A=R.exec(a),w=a.slice(I,A?A.index:a.length);if(S._value="",M+=r(w,S),p+=S._value,!A)break;if(M%2!=1){var x=e.getFullYear(),D=e.getDay(),b=e.getHours(),O=e.getMinutes(),F=e.getSeconds(),U=e.getMilliseconds(),L=e.getTimezoneOffset();switch(e>=new Date("1900/1/1")&&e<=new Date("1900/1/7")&&(D=(D+6)%7),A[0]){case"dddd":p+=i.dayNames[D];break;case"ddd":p+=i.abbreviatedDayNames[D];break;case"dd":c=d,p+=s(_(e,2),2);break;case"d":c=d,p+=_(e,2);break;case"MMMM":p+=i.monthGenitiveNames&&y()?i.monthGenitiveNames[_(e,1)]:i.monthNames[_(e,1)];break;case"MMM":p+=i.abbreviatedMonthGenitiveNames&&y()?i.abbreviatedMonthGenitiveNames[_(e,1)]:i.abbreviatedMonthNames[_(e,1)];break;case"MM":p+=s(_(e,1)+1,2);break;case"M":p+=_(e,1)+1;break;case"yyyy":case"yyy":p+=E>=0?g._formatEraPart("ee",e):s(N?N[0]:x,4);break;case"yy":p+=E>=0?g._formatEraPart("ee",e):s((N?N[0]:x)%100,2);break;case"y":p+=E>=0?g._formatEraPart("e",e):((N?N[0]:x)%100).toString();break;case"hh":0==(l=b%12)&&(l=12),p+=s(l,2);break;case"h":0==(l=b%12)&&(l=12),p+=l;break;case"HH":p+=s(b,2);break;case"H":p+=b.toString();break;case"mm":p+=s(O,2);break;case"m":p+=O.toString();break;case"ss":p+=s(F,2);break;case"s":p+=F.toString();break;case"tt":p+=b<12?i.amDesignator:i.pmDesignator;break;case"t":p+=(b<12?i.amDesignator:i.pmDesignator).charAt(0);break;case"f":case"0":p+=s(U,3).charAt(0);break;case"ff":case"00":p+=s(U,3).substr(0,2);break;case"fff":case"000":p+=s(U,3);break;case"z":p+=((l=L/60)<=0?"+":"-")+h(m(l));break;case"zz":p+=((l=L/60)<=0?"+":"-")+s(h(m(l)),2);break;case"zzz":p+=((l=L/60)<=0?"+":"-")+s(h(m(l)),2)+":"+s(m(L%60),2);break;case"g":case"gg":case"ggg":if(!g)break;if(E===C-1){E=C;break}p+=g._formatEraPart(A[0],e),E=C;break;case"e":case"ee":if(!g){p+=s(N?N[0]:x,4);break}if(T===C-1){T=C;break}p+=g._formatEraPart(A[0],e),T=C;break;case"/":p+=i.dateSeparator;break;case"[h]":case"[hh]":case"[H]":case"[HH]":case"[mm]":case"[ss]":case"[s]":p+=A[0];break;default:throw new Error(n.wI.Exp_InvalidDateFormat)}}else p+=A[0]}return p.toString()}function r(e,t){for(var r=0,n=f,a=0,o=e.length;a<o;a++){var i=e.charAt(a);switch(i){case'"':n?t._value+="'":r++,n=f;break;case"\\":n&&(t._value+="\\"),n=!n;break;default:t._value+=i,n=f}}return r}function v(e,t){var r=new Date,n=e.DateTimeFormat.eras;if(n&&t<100){var a=n._getEraDate(r)._eraYear;(t+=a-a%100)>e.DateTimeFormat.Calendar.TwoDigitYearMax&&(t-=100)}return t}function y(e,t,i){e=e.trim();var u=i.DateTimeFormat,s=function(e,t){if(e._parseRegExp){if(e._parseRegExp[t])return e._parseRegExp[t]}else e._parseRegExp={};var a=t;a=(a=a.replace("%M","M")).replace(/([\^\$\.\*\+\?\|\[\]\(\)\{\}])/g,"\\\\$1");for(var i,u="^",s={_value:""},c=[],f=0,d=0,h=/\/|dddd|ddd|dd|d|MMMM|MMM|MM|M|yyyy|yyy|yy|y|hh|h|HH|H|mm|m|ss|s|tt|t|fff|ff|f|000|00|0|zzz|zz|z|ggg|gg|g|ee|e|\[H\]|\[HH\]|\[h\]|\[hh\]|\[mm\]|\[s\]|\[ss\]/g;(i=h.exec(a))!==l;){s._value="";var m=a.slice(f,i.index);if(f=h.lastIndex,d+=r(m,s),u+=s._value,d%2!=1){switch(i[0]){case"dddd":case"ddd":case"MMMM":case"MMM":case"gggg":case"ggg":case"gg":case"g":u+="(\\D+)";break;case"tt":case"t":u+="(\\D*)";break;case"dd":case"d":case"MM":case"M":case"yy":case"y":case"eee":case"ee":case"e":case"HH":case"H":case"hh":case"h":case"mm":case"m":case"ss":case"s":u+="(\\d\\d?)";break;case"yyy":case"yyyy":u+="(\\d{2}|\\d{4})";break;case"fff":case"000":u+="(\\d{3})";break;case"ff":case"00":u+="(\\d{2})";break;case"f":case"0":u+="(\\d)";break;case"zzz":u+="([+-]?\\d\\d?:\\d{2})";break;case"zz":case"z":u+="([+-]?\\d\\d?)";break;case"/":u+="(\\"+e.dateSeparator+")";break;default:throw new Error(n.wI.Exp_InvalidDateFormat)}o.Z._add(c,i[0])}else u+=i[0]}s._value="",r(a.slice(f),s),u+=s._value;var g=(u+="$").toString().replace(/\s+/g,"\\s+"),p={_regExp:g,_groups:c,_exp:new RegExp(g)};return e._parseRegExp[t]=p,p}(u,t),h=s._exp.exec(e);if(h===l)return l;for(var m,g=f,p=s._groups,y=l,N=l,M=l,R=l,_=l,E=0,T=0,S=0,C=0,I=l,A=f,w=0,x=p.length;w<x;w++){var D=h[w+1];if(D)switch(p[w]){case"dd":case"d":if((R=c(D,10))<1||R>31)return l;break;case"MMMM":if((M=i._getMonthIndex(D))<0||M>11)return l;break;case"MMM":if((M=i._getAbbrMonthIndex(D))<0||M>11)return l;break;case"M":case"MM":case"%M":if((M=c(D,10)-1)<0||M>11)return l;break;case"e":case"ee":if((N=v(i,c(D,10)))<0||N>9999)return l;break;case"y":case"yy":case"yyy":case"yyyy":if((N=c(D,10))<0||N>9999)return l;break;case"h":case"hh":case"H":case"HH":if((E=c(D,10))<0)return l;break;case"m":case"mm":if((T=c(D,10))<0||T>59)return l;break;case"s":case"ss":if((S=c(D,10))<0||S>59)return l;break;case"tt":case"t":var b=D.toUpperCase();if(!(A=b===u.pmDesignator.toUpperCase()||"PM"===b)&&b!==u.amDesignator.toUpperCase()&&"AM"!==b)return l;g=d;break;case"f":case"0":if((C=100*c(D,10))<0||C>999)return l;break;case"ff":case"00":if((C=10*c(D,10))<0||C>999)return l;break;case"fff":case"000":if((C=c(D,10))<0||C>999)return l;break;case"dddd":if((_=i._getDayIndex(D))<0||_>6)return l;break;case"ddd":if((_=i._getAbbrDayIndex(D))<0||_>6)return l;break;case"zzz":var O=D.split(/:/);if(2!==O.length)return l;if((m=c(O[0],10))<-12||m>13)return l;var F=c(O[1],10);if(F<0||F>59)return l;I=60*m+(a.Z._startsWith(D,"-")?-F:F);break;case"z":case"zz":if((m=c(D,10))<-12||m>13)return l;I=60*m;break;case"g":case"gg":case"ggg":var U=D;if(!U||!u.eras)return l;if((y=u.eras._parseEraPart(p[w],U))<0)return l}}var L,B=/^(\d|\d\d):/.test(e),k=new Date("1970/01/01 00:00:00 +0800"),P=B?new Date(k.getTime()+-22090752e5):new Date,G=u.Calendar.convert;if(G&&(L=G.fromGregorian(P)),G||(L=[P.getFullYear(),P.getMonth(),P.getDate()]),N===l?N=L[0]:N<100&&(u.eras&&y!==l?N=u.eras._getYearFromEra(y||0,N):N+=N>=30?1900:2e3),M===l&&(M=L[1]),R===l&&(R=L[2]),G){if((P=G.toGregorian(N,M,R))===l)return l}else{if(P.setFullYear(N,M,R),P.getDate()!==R)return l;if(_!==l&&P.getDay()!==_)return l}if(g&&E>12)return l;if(A&&E<12&&(E+=12),g&&!A&&12===E&&(E=0),P.setHours(E,T,S,C),I!==l){var H=P.getMinutes()-(I+P.getTimezoneOffset());P.setHours(P.getHours()+H/60,H%60)}return P}function N(e){var t=e.getTimezoneOffset();return-485===t&&(t=-485-43/60),t}return{_customCultureFormat:function(e,r,n){return n||(n=i.s._getCultureInfo()),t(e,r,n)},_localeFormat:function(e,r,n){return t(e,r,n||i.s._getCultureInfo())},_parseLocale:function(t,r,n){var a,o;return r||n||void 0===(o=g[t])?(a=r?[t,r]:[t],o=e(t,n||i.s._getCultureInfo(),a),r||n||(g[t]=o),o?new Date(o):o):o?new Date(o):o},_parseInvariant:function(t,r){return e(t,i.s._getCultureInfo("invariant"),[t,r])},_parseExact:y,_fromOADate:function(e){var t=e-25568,r=t>=0?1:-1,n=N(new Date(864e5*t)),a=(864e5*e*1440+r-3181068288e6+864e5*n)/1440,o=new Date(a),i=n>=0?1:-1,u=N(new Date(a+36e5*i));if(n!==u&&366!==e){var s=new Date(a+60*(u-n)*1e3);if(n>u){if(-1===i||u===N(o))return 999===s.getMilliseconds()?new Date(s.valueOf()+1):s}else if(n<u&&(1===i||u===N(o)))return 999===s.getMilliseconds()?new Date(s.valueOf()+1):s}return 999===o.getMilliseconds()?new Date(o.valueOf()+1):o},_fromOADateString:function(e){if("/OADate("===e.substr(0,8)){var t=parseFloat(e.substr(8,e.length-10));return this._fromOADate(t)}},_toOADateString:function(e){return"/OADate("+this._toOADate(e)+")/"},_toOADate:function(e){if(u(e))return 0;"number"==typeof e&&(e=new Date(e));var t=N(e);return(1440*e.getTime()+3181068288e6-864e5*t)/124416e6},_DT:function(e){var t=l,r=d;if(u(e))t=this._fromOADate(0);else if(e instanceof Date)t=new Date(e.valueOf());else if("string"==typeof e){var a=this._parseLocale(e);if(!a)if(isNaN(e))if(this._isInvalidDateString(e))r=f;else{a=new Date(e),isNaN(a.valueOf())&&(r=f);var o=/^[-+=\s]*(\d+)\W+(\d+)\W+(\d+)$/.exec(e.replace(/ |\n/g,"").trim());o&&4===o.length&&(-1!==o.indexOf(a.getFullYear().toString())&&-1!==o.indexOf((a.getMonth()+1).toString())&&-1!==o.indexOf(a.getDate().toString())||(r=f))}else(a=p._fromOADate(parseFloat(e)))||(r=f);t=a}else"number"==typeof e?t=this._fromOADate(e):r=f;if(r)return t;throw n.wI.Exp_InvalidCast},_isInvalidDateString:function(e){var t=i.s._getCultureInfo().DateTimeFormat,r=function(e,t){var r=0;return t.forEach((function(t){t&&e.indexOf(t)>-1&&r++})),r>1};return r(e,t.monthNames)||r(e,t.abbreviatedMonthNames)||r(e,t.dayNames)||r(e,t.abbreviatedDayNames)},_isDate:function(e){return e&&(e.constructor===Date||e.getUTCDate&&e.setFullYear)}}}(),v=p},2471:function(e,t,r){r.d(t,{Z:function(){return R}});var n=r(8657),a=r(6593),o=(r(9678),r(1501)),i=r(7686).Z._isNullOrUndefined,u=a.Z,s=u._padZeroLeft,l=u._padZeroRight,c=null,f=parseInt,d=parseFloat,h=!1,m=!0,g=Math.floor,p=Math.abs,v=Math.pow,y=Math.min;function N(e,t,r){return e.substr(t,r)}function M(e){return RegexHelper._getReg(e)}var R=function(){var e="##################0",t="################",r={1:"+",0:"","-1":"-"},u=["0","#","?"],R={"":"",Br:"Br",Fdj:"Fdj",Nfk:"Nfk",R:"R",$:"$",FCFA:"FCFA","GH":"GH","":"","..":"..",XDR:"XDR","..":"..","..":"..","..":"..","..":"..","":"","..":"..","..":"..","...":"...","..":"..","..":"..","..":"..","..":"..","..":"..","..":"..","..":"..","..":"..",S:"S","":"","..":"..","..":"..","..":"..","":"",TSh:"TSh","":"","":"","":"",K:"K",".":".","":"",CFA:"CFA","":"","":"",KM:"KM","":"",USh:"USh","K":"K","kr.":"kr.",Ksh:"Ksh",CHF:"CHF",".":".","Nu.":"Nu.",EC$:"EC$",P:"P",US$:"US$",D:"D",Rp:"Rp",Ar:"Ar",MOP$:"MOP$",Rs:"Rs",MK:"MK",RM:"RM","":"",RF:"RF",SR:"SR",SDG:"SDG",Le:"Le","NAf.":"NAf.",E:"E",T$:"T$",VT:"VT",WS$:"WS$",Bs:"Bs","":"",Q:"Q",L:"L",C$:"C$","B/.":"B/.","S/.":"S/.","":"","Bs.":"Bs.","":"",FG:"FG",UM:"UM",kr:"kr",FBu:"FBu",FC:"FC",DA:"DA",G:"G",CF:"CF",DH:"DH",FCFP:"FCFP",LS:"LS",DT:"DT",kn:"kn",HUF:"HUF","":"",ISK:"ISK","":"","":"","":"","":"","":"","":"",Kz:"Kz","":"",MTn:"MTn","":"","":"","":"","Afl.":"Afl.",".":".",".":".","z":"z","":"",R$:"R$",Db:"Db",RON:"RON","":"",MAD:"MAD",".":".","Lek":"Lek",den:"den",RSD:"RSD",".":".","..":"..","Rs.":"Rs.","":"","":"","m.":"m.","":"","":"","som":"som","":"","":"",HK$:"HK$",MOP:"MOP",NT$:"NT$"};function _(e,t){for(var r=g(p(e)),n={_integer:1,_decimal:0};r>=10;)r/=10,n._integer++;var a,o=e.toString(),i=o.search(/e/gi),u=o.indexOf(t);if(-1!==i){var s=N(o,0,i),l=N(o,i+1),c=0;-1!==u&&(c=N(s,u+1).length),(a=c-d(l))<0&&(a=0),n._decimal=a}else a=0,-1!==u&&(a=N(o,u+1).length),n._decimal=a;return n}function E(e){for(var t={_symbol:e.charAt(0),_sign:0,_exp:0},r="",a=1;a<e.length;a++)if("+"===(r=e.charAt(a)))t._sign=1;else{if("-"!==r){if("0"===r){t._exp=e.length-a;break}throw new Error(n.wI.Exp_InvalidExponentFormat)}t._sign=-1}return t}function T(e,t){for(var r,n={_intPart:c,_decPart:c,_group:h,_scale:0,_percent:0,_permille:0,_exponent:c},a="",o=h,i=h,s=h,l=h,f=h,d=h,g=c,p=[],v=0;v<e.length;v++){if(r=e.charAt(v),o)a+=r,'"'===r&&(p.push(a),a="",o=h);else if(i){if("E"===g||"e"===g){if(!(["+","-","0"].indexOf(r)>=0)){i=h,v--;continue}a+=r}else if("+"===g||"-"===g){if("0"!==r){i=h,v--;continue}a+=r}else if("0"===g){if("0"!==r){i=h,f||(f=m,n._exponent=E(a)),v--;continue}a+=r}}else if("*"!==g&&"_"!==g&&"\\"!==g||""===a)if("*"===r||"_"===r||"\\"===r)d=h,""!==a&&(p.push(a),a=""),a+=r;else if("'"===r)d=h,""!==a&&(p.push(a),a=""),p.push(r);else if('"'===r)d=h,o=m,""!==a&&(p.push(a),a=""),a+=r;else if(u.indexOf(r)>=0)d=m,u.indexOf(g)<0&&""!==a&&(p.push(a),a=""),a+=r;else if("."!==r||s)if(r===t.percentSymbol)d=h,n._percent++,""!==a&&(p.push(a),a=""),p.push(r);else if(r===t.perMilleSymbol)d=h,n._permille++,""!==a&&(p.push(a),a=""),p.push(r);else if(r===t.percentGroupSeparator)if(d){""!==a&&(p.push(a),a="");for(var y=m,N="",M=v+1;M<e.length;M++){var R=e.charAt(M);if(""===N)if('"'===R)N=R;else{if(u.indexOf(R)>=0){y=h;break}if(R===t.numberDecimalSeparator||";"===R)break}else'"'===R&&(N="")}y?n._scale++:s||(R=e.charAt(v+1))&&u.indexOf(R)>=0&&(l=m)}else a+=r;else"E"===r||"e"===r?(d=h,i=m,""!==a&&(p.push(a),a=""),a+=r):(d=h,u.indexOf(g)>=0&&""!==a&&(p.push(a),a=""),a+=r);else""!==a&&(p.push(a),a=""),n._intPart=p,p=[],s=m,d=h;else a+=r,p.push(a),a="";g=r}return""!==a&&(i&&!f&&(n._exponent=E(a)),p.push(a)),l&&(n._group=m),s?n._decPart=p:n._intPart=p,n}function S(e){var t=c;if(e){t="";for(var r=0;r<e.length;r++){var n=e[r];/^(0|#|\?)+/g.test(n)&&(t+=n)}}return t}function C(a,o,i,u){var c=[];a=function(e,t,r,n){var a=e;return t>0&&(a=e*v(100,t)),r>0&&(a=e*v(1e3,r)),n>0&&(a=e/v(1e3,n)),a}(a,o._percent,o._permille,o._scale);var d=o._intPart,g=o._decPart;if(!d&&!g)return c;var M,E=S(d),T=S(g);if(T||(T=""),o._exponent){var C=function(e,t,r){var n={value:e,exponentValue:0},a=_(e,".")._integer,o=p(e),i=r?r.length:1;if(o>=1)a>i?(a-=i,n.value=e/v(10,a),n.exponentValue=a):n.exponentValue=0,-1===t._sign&&(t._sign=0);else if(o<1&&o>0){t._sign=-1;for(var u=v(10,i);10*o<u;)o*=10,n.exponentValue++;n.value*=v(10,n.exponentValue)}return n}(a,o._exponent,E);a=C.value,M=C.exponentValue}var I=_(a,"."),A=(i.numberGroupSizes,i.numberGroupSeparator,i.numberDecimalSeparator),w=i.negativeSign,x=function(e,t,r,n,a,o){var i=function(e,t){if(void 0===typeof t||0==+t)return Math.round(e);if(e=+e,t=+t,isNaN(e)||t%1!=0)return NaN;var r=e<0;return e=(e=r?-e:e).toString().split("e"),e=Math.round(+(e[0]+"e"+(e[1]?+e[1]-t:-t))),+((e=(e=r?-e:e).toString().split("e"))[0]+"e"+(e[1]?+e[1]+t:t))}(e,-t);isFinite(i)||(i=e);var u,c,d=(e=i).toString(),h=d.split(/e/i);return d=h[0],c=h.length>1?f(h[1],10):0,h=d.split("."),d=h[0],u=h.length>1?h[1]:"",c>0?(d+=(u=l(u,c)).slice(0,c),u=N(u,c)):c<0&&(c=-c,u=(d=e<0?o+s(d.replace(o,""),c+1):s(d,c+1)).slice(-c,d.length)+u,d=d.slice(0,-c)),d+(t>0?a+(u=u.length>t?u.slice(0,t):l(u,t)):"")}(a,y(I._decimal,T.length),0,0,A,w);if(u||(x=function(e,t){var r=e;return-1!==e.indexOf(t)&&(r=e.replace(/0+$/,"")),r}(x,A)),""===x)return c.push({type:"text",value:(d?d.join(""):"")+(g?g.join(""):"")}),c;var D={hasInfilling:h,infillIndex:-1,replaceExponent:h},b=x.split(A)[0];return d&&function(e,t,a,o,i,u,l,c){var f=c.numberGroupSizes,d=c.numberGroupSeparator,g=c.negativeSign,p=c.percentSymbol,v=c.perMilleSymbol,y=o._exponent,M=N(t,0,1);M===g&&(t=N(t,1));var _=1===t.length&&"0"===t?0:t.length;t=0===_?"":t;for(var E=0,T="",S=e.length-1;S>=0;S--){var C="",I=e[S];if(/^(0|#|\?)+/g.test(I)){if(T!==a){for(var A=I.length,w=_-E-1;w>=0&&A>0;w--)C=t.charAt(w)+C,A--,E++;for(var x=A-1;x>=0;x--){var D=I[x];E++,"0"===D?C=D+C:"?"===D&&(""!==C&&(u.push({type:"number",value:C}),C=""),u.push({type:"numberPlaceholder",value:D}))}(T=I+T)===a&&E<_&&(C=t.substr(0,_-E)+C),""!==C&&u.push({type:"number",value:C})}}else if(o._exponent&&!l.replaceExponent&&/^((E(\+|-)?|e(\+|-)?)\d+)/g.test(I)){l.replaceExponent=m;var b="";b+=y._symbol,b+=r[y._sign],b+=s(i.toString(),y._exp),u.push({type:"exponent",value:b})}else"_"===I[0]?u.push({type:"placeholder",value:I[1]}):"*"===I[0]?l.hasInfilling||(u.push({type:"fillingChar",value:I[1]}),l.hasInfilling=!0,l.infillIndex=u.length-1):"\\"===I[0]?2===I.length&&u.push({type:"text",value:I[1]}):'"'===I[0]&&'"'===I[I.length-1]?I.length>2&&u.push({type:"text",value:I.substr(1,I.length-2)}):I===p?u.push({type:"percent",value:I}):I===v?u.push({type:"permille",value:I}):R[I]?u.push({type:"currency",value:I}):u.push({type:"text",value:I})}M===g&&u.push({type:"text",value:M}),o._group===m&&function(e,t,r,a){for(var o=t[0],i=1,u=0,s=h,l=e.length,c=0;c<l;c++){var f=e[c].type;if("number"===f){for(var d="",g=e[c].value,p=g.length-1;p>=0;){if(o<1||o>9)throw new Error(n.wI.Exp_InvalidNumberGroupSize);/\d/gi.test(g[p])?(s&&(d&&e.push({type:"number",value:d}),e.push({type:"groupSeparator",value:r}),d="",s=h),u++):u=0,d=g[p]+d,u===o&&(s=m,u=0,i<t.length&&(o=t[i],i++)),p--}d&&e.push({type:f,value:d})}else"fillingChar"===f&&(a.infillIndex=e.length-l),e.push({type:f,value:e[c].value})}e.splice(0,l)}(u,f,d,l),u=u.reverse(),l.infillIndex=u.length-1-l.infillIndex}(d,b,E,o,M,c,D,i),"0"!==b&&""===E&&g&&c.push({type:"number",value:b}),g&&function(n,a,o,i,u,l,c,f,d){var h=d.numberDecimalSeparator,g=d.percentSymbol,p=d.perMilleSymbol,v=a.indexOf(h),y=u._exponent;(v>0||i!==e||o!==t)&&c.push({type:"decimalSeparator",value:h});for(var N=-1!==v?a.substring(v+1):"",M=0,_="",E=0;E<n.length;E++){var T=n[E];if(/^(0|#|\?)+/g.test(T)){var S="";if(_!==o){for(var C=T.length,I=0,A=M;C>0&&N.length-M>0;)S+=N.charAt(A),C--,M++,I++,A++;for(var w=I;C>0;){var x=T[w];w++,M++,C--,"0"===x?S+=x:"?"===x&&(""!==S&&(c.push({type:"number",value:S}),S=""),c.push({type:"numberPlaceholder",value:x}))}""!==S&&c.push({type:"number",value:S}),_+=T}}else if(y&&!f.replaceExponent&&/^((E(\+|-)?|e(\+|-)?)\d+)/g.test(T)){f.replaceExponent=m;var D="";D+=y._symbol,D+=r[y._sign],D+=s(l.toString(),y._exp),c.push({type:"exponent",value:D})}else"_"===T[0]?c.push({type:"placeholder",value:T[1]}):"*"===T[0]?(c.push({type:"fillingChar",value:T[1]}),f.hasInfilling&&c.splice(f.infillIndex,1),f.hasInfilling=!0,f.infillIndex=c.length-1):"\\"===T[0]?2===T.length&&c.push({type:"text",value:T[1]}):'"'===T[0]&&'"'===T[T.length-1]?T.length>2&&c.push({type:"text",value:T.substr(1,T.length-2)}):T===g?c.push({type:"percent",value:T}):T===p?c.push({type:"permille",value:T}):R[T]?c.push({type:"currency",value:T}):c.push({type:"text",value:T})}}(g,x,T,E,o,M,c,D,i),c}function I(e,t){if((e=i(e)?"":a.Z._trimEnd(e,"")).match(/^[+-]?infinity$/i))return d(e);if(e.match(/^0x[a-f0-9]+$/i))return f(e,10);var r,n,o=t.NumberFormat,u=o.numberNegativePattern,s=A(e,o,u),l=s[0],h=s[1];""===l&&1!==u&&(l=(s=A(e,o,1))[0],h=s[1]),""===l&&(l="+"),h[0]===o.currencySymbol&&(h=N(h,1));var m,g,p=h.indexOf("e");p<0&&(p=h.indexOf("E")),p<0?(n=h,r=c):(n=N(h,0,p),r=N(h,p+1));var v=n.indexOf(".");v<0?(m=n,g=c):(m=N(n,0,v),g=N(n,v+".".length)),m=m.split(",").join("");var y=",".replace(/\u00A0/g," ");","!==y&&(m=m.split(y).join(""));var M=l+m;if(g!==c&&(M+="."+g),M[M.length-1]===o.percentSymbol){M=N(M,0,M.length-1);var R=(M=a.Z._trimEnd(M,"")).indexOf(".");-1===R&&(R=M.length);var _="";_+=N(M,0,R-2),_+=".",_+=N(M,R-2,2),M=_+=N(M,R+1)}if(r!==c){var E=A(r,o,1);""===E[0]&&(E[0]="+"),M+="e"+E[0]+E[1]}return M.match(/^[+-]?\d*\.?\d*(e[+-]?\d+)?$/)?d(M):NaN}function A(e,t,r){var n=t.negativeSign,o=t.positiveSign,i=a.Z;if(4!==r&&2!==r||(n=" "+n,o=" "+o),4===r||3===r){if(i._endsWith(e,n))return["-",N(e,0,e.length-n.length)];if(i._endsWith(e,o))return["+",N(e,0,e.length-o.length)]}else if(2===r||1===r){if(i._startsWith(e,n))return["-",N(e,n.length)];if(i._startsWith(e,o))return["+",N(e,o.length)]}else{if(0!==r)throw new Error("");if(i._startsWith(e,"(")&&i._endsWith(e,")"))return["-",N(e,1,e.length-2)]}return["",e]}var w="#dot#",x="#group#";function D(e){var t=o.s._getCultureInfo().NumberFormat;return"string"==typeof e&&(t=o.s._getCultureInfo(e).NumberFormat),t}return{_parseLocale:function(e){return I(e,o.s._getCultureInfo())},_parseInvariant:function(e){return I(e,o.s._getCultureInfo("invariant"))},_customCultureFormat:function(e,t,r,n){return r||(r=o.s._getCultureInfo()),function(e,t,r,n){return t&&0!==t.length&&"i"!==t?function(e,t,r,n){return C(e,T(t,r),r,n)}(e,t,r.NumberFormat,n):r&&r.name.length>0?e.toLocaleString():e.toString()}(e,t,r,n)},_replaceNormalToCultureSymbol:function(e,t){if("string"!=typeof e)return e;var r=D(t),n=r.numberDecimalSeparator,a=r.numberGroupSeparator;return"."!==n&&(e=e.replace(M("[.]"),w)),","!==a&&(e=e.replace(M("[,]"),x)),"."!==n&&(e=e.replace(M(w),n)),","!==a&&(e=e.replace(M(x),a)),e},_replaceCultureSymbolToNormal:function(e,t){if("string"!=typeof e)return e;var r=D(t),n=r.numberDecimalSeparator,a=r.numberGroupSeparator;return"."!==n&&(e=e.replace(M("["+n+"]"),w)),","!==a&&(e=e.replace(M("["+a+"]"),x)),"."!==n&&(e=e.replace(M(w),".")),","!==a&&(e=e.replace(M(x),",")),e},_isValidCultureNumberString:function(e,t){if("string"==typeof e){var r=D(t),n=r.numberDecimalSeparator,a=r.numberGroupSeparator;if("."!==n&&"."!==a&&e.indexOf(".")>=0||","!==n&&","!==a&&e.indexOf(",")>=0)return!1}return!0},_parseFloat:function(e,t){return d(this._replaceCultureSymbolToNormal(e,t))},_toHexString:function(e,t,r){if(0!==p(g(e)-e))throw new Error(n.wI.Exp_BadFormatSpecifier);var a=e>=0?e.toString(16):(4294967295+e+1).toString(16);return a=t?a.toLowerCase():a.toUpperCase(),!i(r)&&a.length<r?s(a,r):a},_parseCustomNumberFormatter:T,_formatNumber:C,_formatObjectToSrting:function(e){var t="";if(Array.isArray(e)&&e.length>0)for(var r=0;r<e.length;r++){var n=e[r].type,a=e[r].value;if("placeholder"===n)t+=" ";else{if("fillingChar"===n)continue;t+="numberPlaceholder"===n?" ":a}}return t},_generalNumberInt:e,_generalNumberDec:t,_fixNumber:function(e,t){return"number"==typeof e&&e.toString().length>=t&&(e=e<1&&e>-1?+e.toFixed(t):+e.toPrecision(t)),e}}}()},8751:function(e,t,r){r.d(t,{Z:function(){return a}});var n=r(6593),a=function(){function e(){}return e._getReg=function(t){var r=e._regDict[t];return r||(r=e._regDict[t]=new RegExp(t,"g")),r.lastIndex=0,r},e._getRegIgnoreCase=function(t){var r=e._regDictIgnoreCase[t];return r||(r=e._regDictIgnoreCase[t]=new RegExp(t,"gi")),r.lastIndex=0,r},e._getRegWithConditions=function(t,r){var n=e._regDictIgnoreCase[t];return n||(n=e._regDictIgnoreCase[t]=new RegExp(t,r)),n.lastIndex=0,n},e._getWildcardCriteria=function(t,r,n,a){if(void 0===a&&(a=!1),e._wildcardParseRecord[t])return e._wildcardParseResultBuffer[t];var o="[~?*]+";if(a&&(o="[?*]+"),e._getReg(o).test(t)){for(var i,u=[],s=t.split(""),l={".":!0,"+":!0,$:!0,"^":!0,"[":!0,"]":!0,"(":!0,")":!0,"{":!0,"}":!0,"|":!0,"/":!0},c=0;c<s.length;c++)"~"===(i=s[c])&&c<s.length-1?("*"===(i=s[++c])||"?"===i?u.push("\\"):r&&u.push("~"),u.push(i)):"?"===i?u.push("."):"*"===i?(u.push("."),n?u.push("+"):u.push("*")):l[i]?(u.push("\\"),u.push(i)):"\\"===i?u.push("\\\\"):u.push(i);return u.join("")}return null},e._getWildcardCriteriaFullMatch=function(t,r,n,a){void 0===a&&(a=!1);var o=e._getWildcardCriteria(t,r,n,a);return o&&(o="^"+o+"$"),o},e._getReplaceSymbol=function(e,t){for(var r="#"+e+"0#",a=1;t.indexOf(r)>0;)r=n.Z._join(r,"#"+e+(a-1)+"#","#"+e+a+"#"),a++;return r},e._regDict={},e._regDictIgnoreCase={},e._wildcardParseRecord={},e._wildcardParseResultBuffer={},e._replaceRegString2NormalString=function(e){return e.replace(/([\~\!\@\#\$\%\^\&\*\(\)\-\_\+\=\[\]\{\}\|\\\;\:\'\"\,\.\/\<\>\?])/,"\\$1")},e}()},8657:function(e,t,r){r.d(t,{Z:function(){return o},wI:function(){return a}});var n=r(2021),a={Exp_InvalidDateFormat:n.default.t(""),Exp_InvalidExponentFormat:n.default.t(""),Exp_InvalidSemicolons:n.default.t(" : "),Exp_InvalidNumberGroupSize:n.default.t(" 1  9 "),Exp_BadFormatSpecifier:n.default.t(""),Exp_InvalidNumberFormat:n.default.t(""),Exp_InvalidCast:n.default.t(""),Exp_Separator:n.default.t(", ")},o={Exp_TokenIsNull:"token is null",Exp_InvalidBackslash:"the '\\' cannot be evaluated",Exp_FormatIllegal:"format is illegal.",Exp_ValueIsNull:"value is null",Exp_DuplicatedDescriptor:"The type of descriptor was added.",Exp_TokenIllegal:"token is illegal.",Exp_ValueIllegal:"value is illegal.",Exp_InvalidCast:"InvalidCastException"}},6593:function(e,t,r){r.d(t,{Z:function(){return u}});var n=r(7686).Z._isNullOrUndefined;function a(e,t,r){return e.substr(t,r)}var o={_contains:function(e,t,r){return r&&(e=e.toLowerCase(),t=t.toLowerCase()),""===t||e.indexOf(t)>=0},_indexOf:function(e,t,r){if(r){var n=e.toLowerCase(),a=t.toLowerCase();return n.indexOf(a)}return e.indexOf(t)},_trimStart:function(e,t){if(!t)return e;for(var r=e;a(r,0,t.length)===t;)r=a(r,t.length);return r},_trimEnd:function(e,t){if(!t)return e;for(var r=e;a(r,r.length-t.length,t.length)===t;)r=a(r,0,r.length-t.length);return r},_insert:function(e,t,r){if(t<0||t>e.length||n(r))throw new Error;return a(e,0,t)+r+a(e,t,e.length-t)},_remove:function(e,t,r){if(n(r)&&(r=e.length-t),t<0||r<0||t+r>e.length)throw new Error;return a(e,0,t)+a(e,t+r,e.length-t-r)},_startsWith:function(e,t,r){return i(e,t,r,(function(e,t){return e.slice(0,t.length)===t}))},_endsWith:function(e,t,r){return i(e,t,r,(function(e,t){return e.slice(-t.length)===t}))},_replace:function(e,t,r,n){if(!t)throw new Error;return r=(""+r).replace(/\$/g,"$$$$"),e.replace(new RegExp(t,"g"+(n?"i":"")),r)},_replaceAllNoReg:function(e,t,n,a){return t=r(8751).Z._replaceRegString2NormalString(t),this._replace(e,t,n,a)},_leftBefore:function(e,t){var r=e.indexOf(t);return r<0||r>=e.length?e:a(e,0,r)},_count:function(e,t){for(var r=0,n=e.indexOf(t);n>=0;)r+=1,n=e.indexOf(t,n+1);return r},_join:function(e,t,r){return e.split(t).join(r)},_format:function(e,t){for(var r=e,n=0;n<t.length;n++){var a=new RegExp("\\{"+n+"\\}","g");r=r.replace(a,t[n])}return r},_padZero:function(e,t,r){for(var n=e.toString(),a=n.length;a<t;a++)n=r?"0"+n:n+"0";return n},_padZeroLeft:function(e,t){return o._padZero(e,t,!0)},_padZeroRight:function(e,t){return o._padZero(e,t,!1)},_compareStringIgnoreCase:function(e,t){return e===t||!e&&!t||e&&t&&e.toLowerCase()===t.toLowerCase()},_toUpperCase:function(e){return e.toUpperCase()},_escapeHtml:function(e){var t={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},n=r(8751).Z._getReg("(?:&|<|>|\"|'|`)");return n.test(e)?e.replace(n,(function(e){return t[e]})):e},_unescapeHtml:function(e){var t={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#x27;":"'","&#x60;":"`"},n=r(8751).Z._getReg("(?:&amp;|&lt;|&gt;|&quot;|&#x27;|&#x60;)");return n.test(e)?e.replace(n,(function(e){return t[e]})):e}};function i(e,t,r,a){if(n(t))throw new Error;if(""===t)return!0;if(t.length>e.length)return!1;var o=e,i=t;return r&&(o=o.toLowerCase(),i=i.toLowerCase()),a(o,i)}var u=o},7686:function(e,t,r){r.d(t,{Z:function(){return a}});var n={_each:function(e,t){if(n._isArraylike(e))for(var r=0,a=e.length;r<a&&!1!==t.call(e[r],r,e[r]);r++);else for(var o in e)if(e.hasOwnProperty(o)&&!1===t.call(e[o],o,e[o]))break;return e},_isEmptyObject:function(e){return!e||"object"==typeof e&&0===Object.keys(e).length},_isFunction:function(e){return"function"===n._getType(e)},_isArray:function(e){return Array.isArray?Array.isArray(e):"array"===n._getType(e)},_isNumeric:function(e){return!isNaN(parseFloat(e))&&isFinite(e)},_getType:function(e){if(null===e)return"null";var t=n._class2type;if(!t){t=n._class2type={};for(var r=["Boolean","Number","String","Function","Array","Date","RegExp","Object","Error"],a=0,o=r.length;a<o;a++)t["[object "+r[a]+"]"]=r[a].toLowerCase()}var i=t.toString,u=typeof e;return"object"===u||"function"===u?t[i.call(e)]||"object":u},_inArray:function(e,t,r){var a;if(t){var o=[].indexOf;if(o)return o.call(t,e,r);for(a=t.length,n._isNullOrUndefined(r)&&(r=0),r=r<0?Math.max(0,a+r):r;r<a;r++)if(r in t&&t[r]===e)return r}return-1},_merge:function(e,t){var r=t.length,n=e.length,a=0;if("number"==typeof r)for(;a<r;a++)e[n++]=t[a];else for(;void 0!==t[a];)e[n++]=t[a++];return e.length=n,e},_map:function(e,t,r){var a,o=0,i=e.length,u=[];if(n._isArraylike(e))for(;o<i;o++)null!==(a=t(e[o],o,r))&&(u[u.length]=a);else for(o in e)e.hasOwnProperty(o)&&null!==(a=t(e[o],o,r))&&(u[u.length]=a);return[].concat.apply([],u)},_extend:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r,a,o,i,u,s,l=arguments[0]||{},c=1,f=arguments.length,d=!1;for("boolean"==typeof l&&(d=l,l=arguments[1]||{},c=2),"object"==typeof l||n._isFunction(l)||(l={}),f===c&&(l=this,--c);c<f;c++)if(u=arguments[c],!n._isNullOrUndefined(u))for(i in u)r=l[i],l!==(o=u[i])&&(a=n._isArray(o),d&&o&&(n._isPlainObject(o)||a)?(s=a?r&&n._isArray(r)?r:[]:r&&n._isPlainObject(r)?r:{},l[i]=n._extend(d,s,o)):void 0!==o&&(l[i]=o));return l},_inherit:function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);function n(){this.constructor=e}n.prototype=t.prototype,e.prototype=new n},_isWindow:function(e){return null!==e&&e===e.window},_isPlainObject:function(e){if(!e||"object"!==n._getType(e)||e.nodeType||n._isWindow(e))return!1;var t,r={}.hasOwnProperty;try{if(e.constructor&&!r.call(e,"constructor")&&!r.call(e.constructor.prototype,"isPrototypeOf"))return!1}catch(e){return!1}for(t in e);return void 0===t||r.call(e,t)},_isArraylike:function(e){if(n._isNullOrUndefined(e))return!1;var t=e.length,r=n._getType(e);return!n._isWindow(e)&&(!(1!==e.nodeType||!t)||"array"===r||"function"!==r&&(0===t||"number"==typeof t&&t>0&&t-1 in e))},_makeArray:function(e,t){var r=t||[];return null!==e&&(n._isArraylike(Object(e))?n._merge(r,"string"==typeof e?[e]:e):[].push.call(r,e)),r},_isType:function(e,t){return n._isNullOrUndefined(e)?"null"===t:!!t&&(t instanceof Function&&e instanceof t||typeof e===t||!("function"!==t||!/^\s*\bfunction\b/.test(""+e))||Object.prototype.toString.call(e).slice(8,-1).toLowerCase()===t.toLowerCase()||("DateTime"===t||"TimeSpan"===t?e instanceof Date:("string"==typeof t&&"undefined number boolean string".indexOf(t),!1)))},_isNullOrUndefined:function(e){return null==e},_isNumber:function(e,t){var a=r(2471).Z;return!!a._isValidCultureNumberString(e,t)&&(e=a._replaceCultureSymbolToNormal(e,t),n._isType(e,"number")||n._isType(e,"DateTime")||n._isType(e,"TimeSpan")||e&&!n._isType(e,"boolean")&&!isNaN(e)&&!isNaN(parseFloat(e))&&!(e.length>=2&&"0"===e[0]&&"x"===e[1]))},_toDouble:function(e){var t=r(8422).Z;return n._isNullOrUndefined(e)||""===e?0:n._isType(e,"number")?e:n._isType(e,"string")&&!isNaN(e)?r(2471).Z._parseLocale(e):n._isType(e,"boolean")?e?1:0:n._isType(e,"DateTime")?t._toOADate(e):n._isType(e,"TimeSpan")?Math.floor(t._toOADate(e)):parseFloat(e)},_cloneObject:function(e){if(!e)return e;if("number"==typeof e||"string"==typeof e||"boolean"==typeof e||n._isNullOrUndefined(e))return e;if(e.clone)return e.clone();if(e instanceof Date)return new Date(e);var t,r,a;for(r in t=e instanceof Object?new e.constructor:new e.constructor(e.valueOf()),e)e.hasOwnProperty(r)&&(a=e[r],e.hasOwnProperty(r)&&t[r]!==a&&(t[r]="object"==typeof a?n._cloneObject(a):a));return t.toString=e.toString,t.valueOf=e.valueOf,t}},a=n},2021:function(e,t,r){var n,a;e.exports=(n={default:function(){return i.ZP}},a={},r.d(a,n),a)}},m={};/*! For license information please see index.js.LICENSE.txt */function g(e){var t=m[e];if(void 0!==t)return t.exports;var r=m[e]={exports:{}};return h[e].call(r.exports,r,r.exports,g),r.exports}g.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return g.d(t,{a:t}),t},g.d=function(e,t){for(var r in t)g.o(t,r)&&!g.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},g.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),g.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},g.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var p={};!function(){var e;g.d(p,{AD:function(){return i},Pz:function(){return T},QS:function(){return xt},hP:function(){return qm},zD:function(){return t},nx:function(){return r},G8:function(){return Q},uC:function(){return K},VT:function(){return q},_S:function(){return z},lA:function(){return yr.lA},lr:function(){return yr.lr},yH:function(){return yr.yH},de:function(){return yr.de},zH:function(){return yr.zH},jr:function(){return yr.jr},D_:function(){return W},i1:function(){return X},n0:function(){return yr.n0},HD:function(){return yr.HD},o8:function(){return yr.o8},R8:function(){return ee},Fz:function(){return J}});var t={};g.r(t),g.d(t,{DIMENSION_TYPE:function(){return H},Direction:function(){return Y},FormulaGridRange:function(){return B},MUTATION_ID:function(){return j},deleteDimensionInGridRange:function(){return re},getExceptRange:function(){return ae},getTwoGridRangeIntersect:function(){return ie},gridRangeToString:function(){return de},insertDimensionInGridRange:function(){return te},isGridRangeValid:function(){return fe},isTwoGridRangeIntersect:function(){return oe},iteratorWithLimitGridRange:function(){return ne},mergeGridRanges:function(){return se},mergeGridRangesWithDirection:function(){return le},splitIntersectGridRanges:function(){return ue}});var r={};g.r(r),g.d(r,{BaseCustomNodePlugin:function(){return et},BaseGraphSegmentManager:function(){return Le},DEFAULT_DIMENSION_END:function(){return O},DEFAULT_DIMENSION_START:function(){return b},DegreeTreeType:function(){return V},FORMULA_TYPE:function(){return D},FULL_TABLE_FORMULA_MODEL:function(){return L},FormulaGraph:function(){return Je},GraphMergeableType:function(){return Ze},GraphSegmentNode:function(){return ke},GraphSegmentType:function(){return S},GraphService:function(){return He},GraphUpdateService:function(){return We},MergeableGraphSegmentManager:function(){return Pe},getDepOffsetRangeByRefOffsetRangeAndPart:function(){return me},getSheetIdsFromPart:function(){return ge}});var i={};g.r(i),g.d(i,{AST_TYPE:function(){return C},BaseNode:function(){return ot},CELL_RANGE_TYPE:function(){return w},CROSS_TABLE_TYPE:function(){return I},CalcRef:function(){return ft},CellNode:function(){return it},CellRangeBinaryNode:function(){return st},CellRangeNode:function(){return ut},FunctionNode:function(){return lt},RANGE_BINARY_TYPE:function(){return x},VARIABLE_TYPE:function(){return A},VariableNode:function(){return ct},default:function(){return Dt},isASTNode:function(){return dt},isCalcRef:function(){return ht},isCell:function(){return mt},isCellNode:function(){return gt},isCellNodeCrossTable:function(){return vt},isCellRangeBinaryNode:function(){return _t},isCellRangeNode:function(){return Et},isCellRangeNodeCrossTable:function(){return Mt},isCellRangeNodeCrossTableThreeDimension:function(){return Rt},isCrossTableCellNode:function(){return pt},isCrossTableCellRangeNode:function(){return yt},isCurrentNodeInPositionRelyFunction:function(){return It},isFunctionNode:function(){return Tt},isFunctionNodeButNotBinaryNode:function(){return St},isUserRange:function(){return Nt},isVariableNode:function(){return Ct},walk:function(){return wt}});var u={};g.r(u),g.d(u,{asyncCalculate:function(){return on},calculateAstNode:function(){return un},cellValueCalcFunc:function(){return rn},getCalcRef:function(){return sn},getCellValueByData:function(){return tn},getRangeValue:function(){return ln},getSheetIdBySheetName:function(){return en}});var f={};g.r(f),g.d(f,{HLOOKUP:function(){return vo},LOOKUP:function(){return yo},MATCH:function(){return ao},VLOOKUP:function(){return po}});var h={};g.r(h),g.d(h,{ERROR:function(){return Ro},ISBLANK:function(){return bo},ISERR:function(){return _o},ISERROR:function(){return Eo},ISEVEN:function(){return Fo},ISFORMULA:function(){return To},ISLOGICAL:function(){return So},ISNA:function(){return Co},ISNUMBER:function(){return Io},ISODD:function(){return Oo},ISREF:function(){return Ao},ISTEXT:function(){return wo},N:function(){return Uo},NA:function(){return xo},TYPE:function(){return Do}});var m={};g.r(m),g.d(m,{DATE:function(){return Zo},DATEVALUE:function(){return Mi},DAY:function(){return Wo},DAYS:function(){return _i},DAYS360:function(){return Ei},EDATE:function(){return gi},EOMONTH:function(){return mi},HOUR:function(){return fi},ISOWEEKNUM:function(){return pi},MINUTE:function(){return ci},MONTH:function(){return Xo},NETWORKDAYS:function(){return qo},NOW:function(){return Jo},SECOND:function(){return di},TIME:function(){return Ni},TIMEVALUE:function(){return ai},TODAY:function(){return Qo},WEEKDAY:function(){return ei},WEEKNUM:function(){return yi},WORKDAY:function(){return li},YEAR:function(){return ti},YEARFRAC:function(){return Ti},isLeapYear:function(){return ri},transSpDate:function(){return ni},weekday:function(){return oi}});var v={};g.r(v),g.d(v,{FLATTEN:function(){return Du},JOIN:function(){return bu}});var y={};g.r(y),g.d(y,{AVERAGE:function(){return Lu},AVERAGEA:function(){return as},AVERAGEIF:function(){return ns},AVERAGEIFS:function(){return Bu},CHIDIST:function(){return Ns},CORREL:function(){return gs},COUNT:function(){return ku},COUNTA:function(){return Pu},COUNTBLANK:function(){return Gu},COUNTIF:function(){return Vu},COUNTIFS:function(){return $u},FREQUENCY:function(){return Zu},GEOMEAN:function(){return vs},HARMEAN:function(){return ys},INTERCEPT:function(){return Rs},KURT:function(){return Ms},LARGE:function(){return us},MAX:function(){return Xu},MAXA:function(){return As},MEDIAN:function(){return ss},MIN:function(){return Ku},MINA:function(){return ws},MODE:function(){return ls},PEARSON:function(){return _s},PERCENTRANK:function(){return Ds},RANK:function(){return es},RSQ:function(){return Es},SKEW:function(){return Ts},SLOPE:function(){return Ss},SMALL:function(){return is},STDEV:function(){return zu},STDEVA:function(){return fs},STDEVPA:function(){return ds},TRANSPOSE:function(){return qu},TRIMMEAN:function(){return Cs},VAR:function(){return Ju},VARA:function(){return hs},VARPA:function(){return ms}});var N={};g.r(N),g.d(N,{ABS:function(){return el},ACOS:function(){return ic},ACOSH:function(){return _c},ACOT:function(){return Ac},ACOTH:function(){return wc},ADD:function(){return gl},ADDRESS:function(){return ql},ASIN:function(){return oc},ASINH:function(){return Rc},ATAN:function(){return uc},ATAN2:function(){return Mc},ATANH:function(){return Tc},AVEDEV:function(){return pc},CEILING:function(){return Xl},COLUMN:function(){return Al},COS:function(){return nc},COSH:function(){return Sc},COT:function(){return Cc},COTH:function(){return Ic},DECIMAL:function(){return ul},DEGREES:function(){return lc},DEVSQ:function(){return vc},DIVIDE:function(){return vl},EQ:function(){return _l},EVEN:function(){return Fc},EXP:function(){return hc},FLOOR:function(){return zl},GTE:function(){return Nl},ID:function(){return kl},ID_FOR_HK:function(){return Pl},IFERROR:function(){return Sl},INT:function(){return sl},ISO:function(){return Kl},LN:function(){return Vl},LOG:function(){return ec},LOG10:function(){return dc},LOGICMATCH:function(){return ol},LT:function(){return Ml},LTE:function(){return Rl},MATHMATCH:function(){return al},MAXIFS:function(){return Fl},MINIFS:function(){return Ul},MINUS:function(){return pl},MINVERSE:function(){return xl},MMULT:function(){return Dl},MOD:function(){return ll},MROUND:function(){return Dc},MULTIPLY:function(){return yl},NE:function(){return El},ODD:function(){return Oc},PI:function(){return sc},POW:function(){return Tl},POWER:function(){return fc},PRODUCT:function(){return Ql},RADIANS:function(){return cc},RAND:function(){return cl},RANDBETWEEN:function(){return Uc},ROMAN:function(){return yc},ROUND:function(){return fl},ROUNDDOWN:function(){return Yl},ROUNDUP:function(){return dl},ROW:function(){return Il},SIN:function(){return rc},SINH:function(){return Nc},SPECIALMATCH:function(){return tl},SQRT:function(){return hl},SQRTPI:function(){return xc},STOCK:function(){return il},SUBTOTAL:function(){return ml},SUM:function(){return wl},SUMIF:function(){return Ll},SUMIFS:function(){return Ol},SUMPRODUCT:function(){return Bl},SUMSQ:function(){return mc},TAN:function(){return ac},TANH:function(){return Ec},TRUNC:function(){return Hl},round:function(){return jl}});var M={};g.r(M),g.d(M,{ASC:function(){return nf},CHAR:function(){return of},CLEAN:function(){return vf},CODE:function(){return gf},CONCAT:function(){return Jc},CONCATENATE:function(){return qc},DOLLAR:function(){return yf},EXACT:function(){return lf},FIND:function(){return Hc},FIXED:function(){return tf},HYPERLINK:function(){return _f},LEFT:function(){return Yc},LEN:function(){return $c},LOWER:function(){return mf},MID:function(){return Zc},PROPER:function(){return sf},REGEXMATCH:function(){return Wc},REPLACE:function(){return pf},REPT:function(){return uf},RIGHT:function(){return jc},SEARCH:function(){return Rf},SUBSTITUTE:function(){return Xc},T:function(){return Nf},TEXT:function(){return Mf},TEXTJOIN:function(){return ff},TRIM:function(){return Kc},UNICHAR:function(){return df},UNICODE:function(){return hf},UPPER:function(){return af},URL:function(){return Ef},VALUE:function(){return Qc}});var R={};g.r(R),g.d(R,{BESSELI:function(){return ld},BESSELJ:function(){return cd},BESSELK:function(){return fd},BESSELY:function(){return dd},BIN2DEC:function(){return yd},BIN2HEX:function(){return Md},BIN2OCT:function(){return Nd},COMPLEX:function(){return id},CONVERT:function(){return sh},DATEDIF:function(){return xd},DEC2BIN:function(){return Id},DEC2HEX:function(){return Ad},DEC2OCT:function(){return wd},DELTA:function(){return lh},ERF:function(){return Dd},ERFC:function(){return bd},GESTEP:function(){return ch},HEX2BIN:function(){return Sd},HEX2DEC:function(){return Td},HEX2OCT:function(){return Cd},IMCONJUGATE:function(){return od},IMSUB:function(){return ad},INDEX:function(){return ed},INDIRECT:function(){return td},OCT2BIN:function(){return _d},OCT2DEC:function(){return Rd},OCT2HEX:function(){return Ed},OFFSET:function(){return rd}});var _={};g.r(_),g.d(_,{CUMIPMT:function(){return cm},CUMPRINC:function(){return fm},DB:function(){return _m},EFFECT:function(){return dm},FV:function(){return am},FVSCHEDULE:function(){return qh},IPMT:function(){return tm},IRR:function(){return sm},NOMINAL:function(){return hm},PMT:function(){return Qh},PPMT:function(){return rm},PRICE:function(){return pm},PRICEDISC:function(){return vm},PRICEMAT:function(){return ym},PV:function(){return om},RATE:function(){return em},SLN:function(){return gm},SYD:function(){return mm},YIELD:function(){return Nm},YIELDDISC:function(){return Rm},YIELDMAT:function(){return Mm}});var E={};g.r(E),g.d(E,{AND:function(){return Sm},CHOOSE:function(){return xm},FALSE:function(){return Cm},IF:function(){return Im},NOT:function(){return Dm},OR:function(){return Am},TRUE:function(){return wm},XOR:function(){return bm}});var T={};g.r(T),g.d(T,{CalculateCenter:function(){return Xm},Parser:function(){return pr},Token:function(){return at},TokenType:function(){return Qe},calcContext:function(){return rt},error:function(){return Bt},hasError:function(){return Pt},parseNumber:function(){return $t},parseTokens:function(){return ur},toCellId:function(){return Zt}});var S,C,I,A,w,x,D="FORMULA",b=0,O=1048576,F=["ROW()","COLUMN()"],U={startRowIndex:b,endRowIndex:O,startColIndex:b,endColIndex:O,isStartRowRelative:!1,isEndRowRelative:!1,isStartColRelative:!1,isEndColRelative:!1,isRowArray:!0,isColArray:!0,isPositionRely:!0,startSheetId:"",endSheetId:"",isCellRangeReferenceCorrect:!0},L={getAllCellRangeWithFixedInfo:function(){return[U]},getParts:function(){return["=SINGLE(",U,")"]},toString:function(e,t,r){return""},hasReferenceError:!1};!function(e){e.FORMULA="FORMULA_DEPENDENCY",e.DYNAMIC="DYNAMIC_DEPENDENCY",e.FULL_TABLE="FULL_TABLE_DEPENDENCY"}(S||(S={}));var B=function(){function e(e,t,r,n,a){this.sheetId=e,this.startRowIndex=t,this.endRowIndex=r,this.startColIndex=n,this.endColIndex=a}return(0,o.Z)(e,[{key:"isRow",get:function(){return this.startColIndex===b&&this.endColIndex===O}},{key:"isCol",get:function(){return this.startRowIndex===b&&this.endRowIndex===O}},{key:"isSheet",get:function(){return this.isRow&&this.isCol}}]),e}();!function(e){e.CELL="CELL",e.FUNCTION="FUNCTION",e.VARIABLE="VARIABLE",e.CELL_RANGE="CELL_RANGE",e.CELL_RANGE_BINARY="CELL_RANGE_BINARY"}(C||(C={})),function(e){e.NONE="NONE",e.NORMAL="NORMAL",e.THREE_DIMENSION="THREE_DIMENSION"}(I||(I={})),function(e){e.VARIABLE="VARIABLE",e.BINARY="BINARY",e.ORIGIN="ORIGIN",e.STR="STR",e.NUM="NUM",e.MINUS="MINUS",e.PERCENTAGE="PERCENTAGE",e.PLACEHOLDER="PLACEHOLDER",e.BOOL="BOOL",e.TIME="TIME",e.ERROR="ERROR"}(A||(A={})),function(e){e.NORMAL="NORMAL",e.ROW="ROW",e.COL="COL",e.USER_RANGE="USER_RANGE",e.CELL="CELL"}(w||(w={})),function(e){e.INTERSECTION="INTERSECTION",e.CONCAT="CONCAT"}(x||(x={}));var k=[1,26,676],P=[1,10,100,1e3,1e4,1e5,1e6,1e6];function G(e){return e<=127}var H,Y,j,V,$,Z=[14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,11,24,24,24,26,24,24,24,20,21,24,25,24,19,24,24,8,8,8,8,8,8,8,8,8,8,24,24,25,25,25,24,24,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,20,24,21,27,18,27,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,20,25,21,25,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,11,24,26,26,26,26,28,28,27,28,1,22,25,19,28,27,28,25,10,10,27,1,28,24,27,10,1,23,10,10,10,24,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,25,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,25,1,1,1,1,1,1,1,1];function W(e){var t=e.charCodeAt(0);return!function(e){return e<=255}(t)||(G(t)?(t|=32)>=96&&t<=122:0===Z[t]||1===Z[t])}function X(e){var t=e.charCodeAt(0);return G(t)?t>=48&&t<=57:8===Z[t]||10===Z[t]}function K(e){for(var t=e.length,r={row:-1,col:-1},n=!1,a=!1,o=0;o<t;++o){var i=o,u=e[o],s=0;if(W(u)&&!n){do{(o+=1)<t&&(u=e[o])}while(o<t&&W(u));if(o-i>3)return{row:-1,col:-1};for(var l=o-1,c=l;c>=i;--c)s+=((32|e[c].charCodeAt(0))-96)*k[l-c];if(!(s<=16384))return{row:-1,col:-1};r.col=s-1,n=!0,o-=1}else{if(!X(u)||"0"===u||a){if("$"===u)continue;return{row:-1,col:-1}}do{(o+=1)<t&&(u=e[o])}while(o<t&&X(u));if(o-i>7)return{row:-1,col:-1};for(var f=o-1,d=0;f>=i;--f,++d)s+=(e[f].charCodeAt(0)-48)*P[d];s<=1048576&&(r.row=s-1),a=!0,o-=1}}return r}function z(e){for(var t="";e>=0;)t=String.fromCharCode(e%26+65)+t,e=Math.floor(e/26)-1;return t}function q(e){var t=e;"$"===t[0]&&(t=e.slice(1));var r,n=-1,a=0,o=t.length;do{r=t[n+=1]}while(n<o&&W(r));for(var i=n-1,u=i;u>=0;--u)a+=((32|t[u].charCodeAt(0))-96)*k[i-u];return a-1}function J(e){if(-1===e.indexOf("$"))return parseInt(e,10)-1;var t=e;return t=t.replace(/\$/g,""),parseInt(t,10)-1}function Q(e,t,r){var n,a,o,i,u=e,s=t;switch(r){case w.NORMAL:var l,c,f=K(u),d=K(s),h=f.row,m=f.col,g=d.row,p=d.col;h>g&&(h=(l=[g,h])[0],g=l[1]),m>p&&(m=(c=[p,m])[0],p=c[1]),n=h,o=g-h+1,a=m,i=p-m+1;break;case w.ROW:var v;"$"===u[0]&&(u=u.slice(1)),"$"===s[0]&&(s=s.slice(1));var y=Number(u),N=Number(s);y>N&&(y=(v=[N,y])[0],N=v[1]),n=y-1,o=N-y+1,a=0,i=void 0;break;case w.COL:var M;"$"===u[0]&&(u=u.slice(1)),"$"===s[0]&&(s=s.slice(1));var R=q(u),_=q(s);R>_&&(R=(M=[_,R])[0],_=M[1]),n=0,o=void 0,a=R,i=_-R+1}return{row:n,col:a,rowCount:o,colCount:i}}function ee(e){var t=e.lastIndexOf("!"),r=e;return t>-1&&(r=e.slice(t+1)),r}function te(e,t){var r=t.sheetId,n=t.type,a=t.index,o=t.amount;if(e.sheetId!==r)return!1;if(e.isSheet||e.isRow&&n===H.COLUMNS||e.isCol&&n===H.ROWS)return!0;var i,u,s=!0;return n===H.ROWS?(i=e.startRowIndex,u=e.endRowIndex):(i=e.startColIndex,u=e.endColIndex),i>=a?(i+=o,u+=o):u>=a?u+=o:s=!1,n===H.ROWS?(e.startRowIndex=i,e.endRowIndex=u):(e.startColIndex=i,e.endColIndex=u),s}function re(e,t){var r=t.sheetId,n=t.type,a=t.index,o=t.amount;if(e.sheetId!==r)return!1;if(e.isSheet||e.isRow&&n===H.COLUMNS||e.isCol&&n===H.ROWS)return!0;var i,u,s=!0;return n===H.ROWS?(i=e.startRowIndex,u=e.endRowIndex):(i=e.startColIndex,u=e.endColIndex),i>=a?(i=Math.max(a,i-o),u-=o):u>=a?u=Math.max(a-1,u-o):s=!1,n===H.ROWS?(e.startRowIndex=i,e.endRowIndex=u):(e.startColIndex=i,e.endColIndex=u),s}function ne(e,t,r){var n=e.startRowIndex,a=e.startColIndex,o=e.sheetId,i=e.endRowIndex,u=e.endColIndex;if(e.isRow){if(!(null==r?void 0:r.colCount))return void console.error("gridRange each: isRow lack of sheet");u=r.colCount-1}if(e.isCol){if(!(null==r?void 0:r.rowCount))return void console.error("gridRange each: isCol lack of sheet");i=r.rowCount-1}for(var s=n;s<=i;s++)for(var l=a;l<=u;l++)t(s,l,o)}function ae(e,t){if(!oe(e,t))return[e];var r=new B(e.sheetId,e.startRowIndex,e.endRowIndex,e.startColIndex,e.endColIndex),n=new B(t.sheetId,t.startRowIndex,t.endRowIndex,t.startColIndex,t.endColIndex),a=[];if(r.startRowIndex<n.startRowIndex&&a.push(new B(e.sheetId,r.startRowIndex,n.startRowIndex-1,e.startColIndex,e.endColIndex)),r.endRowIndex>n.endRowIndex&&a.push(new B(e.sheetId,n.endRowIndex+1,r.endRowIndex,e.startColIndex,e.endColIndex)),r.startColIndex<n.startColIndex||r.endColIndex>n.endColIndex){var o=Math.max(e.startRowIndex,t.startRowIndex),i=Math.min(e.endRowIndex,t.endRowIndex);r.startColIndex<n.startColIndex&&a.push(new B(e.sheetId,o,i,r.startColIndex,n.startColIndex-1)),r.endColIndex>n.endColIndex&&a.push(new B(e.sheetId,o,i,n.endColIndex+1,r.endColIndex))}return a}function oe(e,t){return e.sheetId===t.sheetId&&(!!(e.isSheet||t.isSheet||e.isRow&&t.isCol||e.isCol&&t.isRow)||(e.isRow||t.isRow?t.endRowIndex>=e.startRowIndex&&t.startRowIndex<=e.endRowIndex:e.isCol||t.isCol?t.endColIndex>=e.startColIndex&&t.startColIndex<=e.endColIndex:t.endRowIndex>=e.startRowIndex&&t.startRowIndex<=e.endRowIndex&&t.endColIndex>=e.startColIndex&&t.startColIndex<=e.endColIndex))}function ie(e,t){if(!oe(e,t))return null;var r=Math.max(e.startRowIndex,t.startRowIndex),n=Math.max(e.startColIndex,t.startColIndex),a=Math.min(e.endRowIndex,t.endRowIndex),o=Math.min(e.endColIndex,t.endColIndex);return new B(e.sheetId,r,a,n,o)}function ue(e){var t=[];return e.forEach((function(e){var r=[e];t.forEach((function(e){for(var t=[],n=0;n<r.length;n++)t.push.apply(t,(0,a.Z)(ae(r[n],e)));r=t})),t.push.apply(t,(0,a.Z)(r))})),t}function se(e){var t=le(e,Y.row),r=le(t,Y.col);return le(r,Y.row)}function le(e,t){var r=new Map;e.forEach((function(e){var n=e.sheetId,a=e.startRowIndex,o=e.endRowIndex,i=e.startColIndex,u=e.endColIndex,s=ce(e,t),l=s.startMatchRangeKey,c=s.endMatchRangeKey,f=r.get(l),d=r.get(c);if(r.delete(l),r.delete(c),f||d){var h,m=ce(h=f&&d?new B(f.sheetId,f.startRowIndex,d.endRowIndex,f.startColIndex,d.endColIndex):f&&!d?new B(f.sheetId,f.startRowIndex,o,f.startColIndex,u):new B(d.sheetId,a,d.endRowIndex,i,d.endColIndex),t),g=m.startMatchRangeKey,p=m.endMatchRangeKey;r.set(g,h),r.set(p,h)}else{var v=new B(n,a,o,i,u);r.set(c,v),r.set(l,v)}}));var n=new Set;return r.forEach((function(e){n.add(e)})),Array.from(n)}function ce(e,t){var r=e.startRowIndex,n=e.endRowIndex,a=e.startColIndex,o=e.endColIndex,i=e.sheetId,u=r,s=n,l=a-1,c=o;return t===Y.col&&(u=a,s=o,l=r-1,c=n),{startMatchRangeKey:i+","+u+","+s+","+l,endMatchRangeKey:i+","+u+","+s+","+c}}function fe(e,t,r){return!!e.isSheet||(e.isRow?e.startRowIndex>=0&&e.startRowIndex<=e.endRowIndex&&(void 0===t||e.endRowIndex<=t-1):e.isCol?e.startColIndex>=0&&e.startColIndex<=e.endColIndex&&(void 0===r||e.endColIndex<=r-1):e.startRowIndex>=0&&e.startColIndex>=0&&e.startRowIndex<=e.endRowIndex&&e.startColIndex<=e.endColIndex&&(void 0===t||e.endRowIndex<=t-1)&&(void 0===r||e.endColIndex<=r-1))}function de(e,t){return void 0===t&&(t=!1),e.isSheet?e.sheetId+"!":e.isRow?(t?e.sheetId+"!":"")+(e.startRowIndex+1)+":"+(e.endRowIndex+1):e.isCol?(t?e.sheetId+"!":"")+z(e.startColIndex)+":"+z(e.endColIndex):(t?e.sheetId+"!":"")+(z(e.startColIndex)+(e.startRowIndex+1))+":"+(z(e.endColIndex)+(e.endRowIndex+1))}function he(e,t){return!(!e||!t)}function me(e,t){var r=e.startRowIndex,n=e.endRowIndex,a=e.startColIndex,o=e.endColIndex,i=e.isStartRowRelative,u=e.isStartColRelative,s=e.isEndRowRelative,l=e.isEndColRelative,c=e.isRowArray,f=e.isColArray,d=t.startRowIndex,h=t.endRowIndex,m=t.startColIndex,g=t.endColIndex,p=i?d+r:r,v=s?h+n:n,y=u?m+a:a,N=l?g+o:o;return c?(y=b,N=O):f&&(p=b,v=O),{startRow:p,endRow:v,startCol:y,endCol:N}}function ge(e,t,r){var n=e.startSheetId,a=e.endSheetId,o=[t];return he(n,a)&&(o=r(n,a)),o}!function(e){e.ROWS="ROWS",e.COLUMNS="COLUMNS"}(H||(H={})),function(e){e[e.row=0]="row",e[e.col=1]="col"}(Y||(Y={})),($=j||(j={}))[$.INSERT_DIMENSION_MUTATION=0]="INSERT_DIMENSION_MUTATION",$[$.DELETE_DIMENSION_MUTATION=1]="DELETE_DIMENSION_MUTATION",$[$.MAP_RANGE_MUTATION=2]="MAP_RANGE_MUTATION",$[$.SET_RANGE_MUTATION=3]="SET_RANGE_MUTATION",$[$.SET_CELL_PROPERTIES_MUTATION=4]="SET_CELL_PROPERTIES_MUTATION",$[$.INSERT_SHEET_MUTATION=5]="INSERT_SHEET_MUTATION",$[$.DELETE_SHEET_MUTATION=6]="DELETE_SHEET_MUTATION",$[$.MOVE_SHEET_MUTATION=7]="MOVE_SHEET_MUTATION",function(e){e[e.IN_DEGREE=0]="IN_DEGREE",e[e.OUT_DEGREE=1]="OUT_DEGREE"}(V||(V={}));var pe,ve,ye=g(3776),Ne=g.n(ye),Me=(pe={default:function(){return s()}},ve={},g.d(ve,pe),ve),Re=g(9669),_e=g.n(Re),Ee=g(4277),Te=g(2582),Se=g.n(Te),Ce=g(5564),Ie=g.n(Ce);function Ae(e,t){return void 0===t&&(t=""),e.sheetId+","+e.startRowIndex+","+e.endRowIndex+","+e.startColIndex+","+e.endColIndex+","+t}function we(e,t){return new B(e,t.minY,t.maxY,t.minX,t.maxX)}function xe(e,t){var r=e.id,n=e.index,a=e.type,o=e.amount,i=t.startRowIndex,u=t.startColIndex,s=t.endRowIndex,l=t.endColIndex,c=a===H.ROWS?i:u,f=a===H.ROWS?s:l;return!(t.isRow&&a===H.COLUMNS||t.isCol&&a===H.ROWS||!(r===j.INSERT_DIMENSION_MUTATION?n>c&&n<=f:r===j.DELETE_DIMENSION_MUTATION&&n<=f&&n+o-1>=c))}function De(e,t){var r=e.id,n=e.index,a=e.type,o=a===H.ROWS?t.startRowIndex:t.startColIndex;return!(t.isRow&&a===H.COLUMNS||t.isCol&&a===H.ROWS||!(r===j.INSERT_DIMENSION_MUTATION?n<=o:r===j.DELETE_DIMENSION_MUTATION?n<o:n<=o))}function be(e,t){switch(e.id){case j.INSERT_DIMENSION_MUTATION:te(t,e);break;case j.DELETE_DIMENSION_MUTATION:re(t,e)}return t}function Oe(e){var t=e.topSortRanges,r=e.cycleRanges;return[].concat((0,a.Z)(r.map((function(e){return{range:e,isInCycle:!0}}))),(0,a.Z)(t.map((function(e){return{range:e}}))))}function Fe(e,t){var r;return r=function(e){return!!e.getId()}(e)?{range:t,id:e.getId()}:{range:t},r}function Ue(e){var t,r=e.inDegreeSegmentNode,n=e.partIdx,a=e.customType,o=e.getFormulaModelByRowCol;if(void 0!==n){var i=r.gridRange,u=o(i.startRowIndex,i.startColIndex,i.sheetId,{customType:a,inDegreeSegmentNode:r});return null===(t=null==u?void 0:u.getAllCellRangeWithFixedInfo())||void 0===t?void 0:t[n]}}var Le=function(){function e(e,t){this.externalMethods=t,this.type=e,this.inDegreeTree={},this.outDegreeTree={}}var t=e.prototype;return t.destroy=function(){this.inDegreeTree={},this.outDegreeTree={}},t.getTreeMap=function(){return{inDegreeTreeMap:this.inDegreeTree,outDegreeTreeMap:this.outDegreeTree}},t.getTreeBySheetId=function(e){return{inDegreeTree:this.inDegreeTree[e],outDegreeTree:this.outDegreeTree[e]}},t.getTreeBySheetIdAndDegreeTreeType=function(e,t){return t===V.IN_DEGREE?this.inDegreeTree[e]:this.outDegreeTree[e]},t.searchInTree=function(e,t){var r,n=e.sheetId,a=e.startColIndex,o=e.endColIndex,i=e.startRowIndex,u=e.endRowIndex;return(null===(r=(t===V.IN_DEGREE?this.inDegreeTree:this.outDegreeTree)[n])||void 0===r?void 0:r.search({minX:a,maxX:o,minY:i,maxY:u}))||[]},t.removeNodeAndRelatedNodesInTree=function(e,t){var r=this,n=t===V.IN_DEGREE?V.OUT_DEGREE:V.IN_DEGREE;e.relationshipSegments.forEach((function(t){var a=t.node,o=a.gridRange.sheetId;a.removeRelationship(e),0===a.relationshipSegments.length&&r.removeNodeInTree(o,a,n)}));var a=e.gridRange.sheetId;this.removeNodeInTree(a,e,t)},t.getRefRangeByDepRange=function(e,t){var r=this;this.searchInTree(e,V.OUT_DEGREE).forEach((function(n){var a=ie(n.gridRange,e);a&&n.relationshipSegments.forEach((function(e){var n=e.node,o=Ue({inDegreeSegmentNode:n,partIdx:e.partIdx,customType:r.type,getFormulaModelByRowCol:r.externalMethods.getFormulaModelByRowCol});if(o){var i=function(e,t,r){var n=r.startRowIndex,a=r.endRowIndex,o=r.startColIndex,i=r.endColIndex,u=r.isStartRowRelative,s=r.isStartColRelative,l=r.isEndRowRelative,c=r.isEndColRelative,f=r.isRowArray,d=r.isColArray,h=e.startRowIndex,m=e.endRowIndex,g=e.startColIndex,p=e.endColIndex,v=u?t.startRowIndex-a:e.startRowIndex,y=l?t.endRowIndex-n:e.endRowIndex,N=s?t.startColIndex-i:e.startColIndex,M=c?t.endColIndex-o:e.endColIndex;return v=Math.max(h,v),N=Math.max(g,N),y=Math.min(m,y),M=Math.min(p,M),f?(N=e.startColIndex,M=e.endColIndex):d&&(v=e.startRowIndex,y=e.endRowIndex),{startRow:v,endRow:y,startCol:N,endCol:M}}(n.gridRange,a,o),u=i.startRow,s=i.endRow,l=i.startCol,c=i.endCol,f=new B(n.gridRange.sheetId,u,s,l,c);fe(f)&&t({inDegreeSegmentNode:n,offsetRefRange:f})}else t({inDegreeSegmentNode:n,offsetRefRange:n.gridRange})}))}))},t.getDepRangeByRefRange=function(e,t){var r=this;this.searchInTree(e,V.IN_DEGREE).forEach((function(n){var a=ie(n.gridRange,e);a&&n.relationshipSegments.forEach((function(e){var o=e.node,i=e.partIdx,u=Ue({inDegreeSegmentNode:n,partIdx:i,customType:r.type,getFormulaModelByRowCol:r.externalMethods.getFormulaModelByRowCol});if(u){var s=u.startRowIndex,l=u.endRowIndex,c=u.startColIndex,f=u.endColIndex,d=u.isStartRowRelative,h=u.isStartColRelative,m=u.isEndRowRelative,g=u.isEndColRelative,p=d?a.startRowIndex+s:s,v=m?a.endRowIndex+l:l,y=h?a.startColIndex+c:c,N=g?a.endColIndex+f:f,M=new B(o.gridRange.sheetId,p,v,y,N);fe(M)&&t({outDegreeSegmentNode:o,offsetRefRange:M})}else t({outDegreeSegmentNode:o,offsetRefRange:o.gridRange})}))}))},t.addDependency=function(e,t){return e.addRelationshipSegment(t),t.addRelationshipSegment(e),this.loadNodesInTree(e.gridRange.sheetId,[e],V.IN_DEGREE),this.loadNodesInTree(t.gridRange.sheetId,[t],V.OUT_DEGREE),!0},t.toJson=function(e){var t=void 0===e,r=this.getTreeMap(),n=r.inDegreeTreeMap,a=r.outDegreeTreeMap,o=function(e){return Object.assign(Object.assign({},e),{relationshipSegments:[]})},i={};return Object.entries(n).forEach((function(r){var n=r[0],a=r[1];(t||(null==e?void 0:e.includes(n)))&&(i[n]={outDegreeNodes:[],inDegreeNodes:(null==a?void 0:a.all().map(o))||[]})})),Object.entries(a).forEach((function(r){var n=r[0],a=r[1];(t||(null==e?void 0:e.includes(n)))&&(i[n]=Object.assign(Object.assign({},i[n]),{outDegreeNodes:(null==a?void 0:a.all().map(o))||[]}))})),i},t.loadNodesInTree=function(e,t,r){var n,a=r===V.IN_DEGREE?this.inDegreeTree:this.outDegreeTree;a[e]||this.createTree(e),null===(n=a[e])||void 0===n||n.load(t)},t.removeTree=function(e){var t=this,r=this.getTreeBySheetIdAndDegreeTreeType(e,V.IN_DEGREE);null==r||r.all().forEach((function(e){t.removeNodeAndRelatedNodesInTree(e,V.IN_DEGREE)}));var n=this.getTreeBySheetIdAndDegreeTreeType(e,V.OUT_DEGREE);null==n||n.all().forEach((function(e){t.removeNodeAndRelatedNodesInTree(e,V.IN_DEGREE)}))},t.removeNodeInTree=function(e,t,r){var n;null===(n=(r===V.IN_DEGREE?this.inDegreeTree:this.outDegreeTree)[e])||void 0===n||n.remove(t),t.clearRelationship()},t.createTree=function(e){this.inDegreeTree[e]=new Be(7),this.outDegreeTree[e]=new Be(7)},e}(),Be=function(e){function t(){return e.apply(this,arguments)||this}(0,n.Z)(t,e);var r=t.prototype;return r.toBBox=function(e){var t=e.gridRange;return{minX:t.startColIndex,minY:t.startRowIndex,maxX:t.endColIndex,maxY:t.endRowIndex}},r.compareMinX=function(e,t){var r=e.gridRange,n=t.gridRange;return r.startColIndex-n.startColIndex},r.compareMinY=function(e,t){var r=e.gridRange,n=t.gridRange;return r.startRowIndex-n.startRowIndex},r.walk=function(e){for(var t=[this.data];t.length>0;){var r=t.pop();!1!==e(r)&&!1===r.leaf&&t.push.apply(t,(0,a.Z)(r.children))}},t}(Se()),ke=function(){function e(e,t){this.gridRange=e,t&&(this.nodeInfo=t),this.relationshipSegments=[]}var t=e.prototype;return t.addRelationshipSegment=function(e,t){this.relationshipSegments.some((function(t){return t.node===e}))||this.relationshipSegments.push({node:e,partIdx:t})},t.removeRelationship=function(e){var t=this.relationshipSegments.findIndex((function(t){return t.node===e}));-1!==t&&this.relationshipSegments.splice(t,1)},t.clearRelationship=function(){this.relationshipSegments=[]},t.getId=function(){var e;return null===(e=this.nodeInfo)||void 0===e?void 0:e.id},e}(),Pe=function(e){function t(t,r){return e.call(this,t,r)||this}(0,n.Z)(t,e);var r=t.prototype;return r.addNodesFromChangedNodes=function(e){if(0!==e.length){var t=this.getSameFormulaModelChangedNodes(e),r=t.formulaBecomeConstNodesMap,n=t.sameFormulaModelChangedNodesMap,a=this.getAddAndDeleteRanges(r,n),o=a.deleteGraphSegmentNodesMap,i=a.addGraphSegmentNodesMap,u=this.compareWithOldSegmentAndGetDeleteAddSegment(o,i),s=u.deleteInDegreeGraphSegmentSet,l=u.needAddGraphSegmentNodesMap;this.loadSegmentInTree({deleteInDegreeGraphSegmentSet:s,needAddGraphSegmentNodesMap:l})}},r.loadSegmentInTree=function(e){var t=this,r=e.deleteInDegreeGraphSegmentSet,n=e.needAddGraphSegmentNodesMap;r.forEach((function(e){t.removeNodeAndRelatedNodesInTree(e,V.IN_DEGREE)}));var a=this.generateDegreeListHashByInDegreeMap(n),o=a.inDegreeGraphSegmentNodeHash,i=a.outDegreeGraphSegmentNodeHash;Object.keys(o).forEach((function(e){var r=o[e];t.loadNodesInTree(e,r,V.IN_DEGREE)})),Object.keys(i).forEach((function(e){var r=i[e];t.loadNodesInTree(e,r,V.OUT_DEGREE)}))},r.generateDegreeListHashByInDegreeMap=function(e){var t=this,r={},n={},a={};return e.forEach((function(e,o){var i=e.gridRanges,u=e.nodeInfo;i.forEach((function(e){if(o){var i=new ke(e,u);(null==o?void 0:o.getAllCellRangeWithFixedInfo()).forEach((function(n,o){if(!0!==n.isPositionRely){var u=me(n,e),s=u.startRow,l=u.endRow,c=u.startCol,f=u.endCol;ge(n,e.sheetId,t.externalMethods.getSheetIdsAmongTwoSheets).forEach((function(e){var t=Ae({startRowIndex:s,endRowIndex:l,startColIndex:c,endColIndex:f,sheetId:e}),n=a[t];n||(n=new ke(new B(e,s,l,c,f)),a[t]=n,r[e]||(r[e]=[]),r[e].push(n)),n.addRelationshipSegment(i,o),i.addRelationshipSegment(n,o)}))}})),n[e.sheetId]||(n[e.sheetId]=[]),n[e.sheetId].push(i)}else console.error("",e)}))})),{inDegreeGraphSegmentNodeHash:n,outDegreeGraphSegmentNodeHash:r}},r.compareWithOldSegmentAndGetDeleteAddSegment=function(e,t){var r=this,n=new Set,o=new Map;this.splitOldInDegreeSegmentWithAddRange({deleteInDegreeGraphSegmentSet:n,splitGraphSegmentNodeMap:o,addGraphSegmentNodesMap:t}),e.forEach((function(e,t){e.gridRanges.forEach((function(e){r.splitOldInDegreeSegment({inDegreeSegment:t,gridRange:e,deleteInDegreeGraphSegmentSet:n,splitGraphSegmentNodeMap:o})}))}));var i=new Set;return o.forEach((function(e,n){var o;if(0!==e.gridRanges.length){var u=e.gridRanges[0],s=u.startRowIndex,l=u.startColIndex,c=u.sheetId,f=r.externalMethods.getFormulaModelByRowCol(s,l,c,{customType:r.type,id:n.getId(),inDegreeSegmentNode:n});if(f){var d=t.get(f)||{gridRanges:[],nodeInfo:e.nodeInfo};(o=d.gridRanges).push.apply(o,(0,a.Z)(e.gridRanges)),t.set(f,d),i.add(f)}}})),i.forEach((function(e){var r,n=t.get(e);if(n&&(null===(r=n.gridRanges)||void 0===r?void 0:r.length)){var a=se(ue(n.gridRanges));t.set(e,{nodeInfo:n.nodeInfo,gridRanges:a})}else t.delete(e)})),{deleteInDegreeGraphSegmentSet:n,needAddGraphSegmentNodesMap:t}},r.splitOldInDegreeSegmentWithAddRange=function(e){var t=this,r=e.deleteInDegreeGraphSegmentSet,n=e.splitGraphSegmentNodeMap;e.addGraphSegmentNodesMap.forEach((function(e,a){e.gridRanges.forEach((function(e){var o=e.startColIndex,i=e.endColIndex,u=e.startRowIndex,s=e.endRowIndex,l=e.sheetId;t.mergeOldInDegreeSegment({formulaModel:a,gridRange:e,deleteInDegreeGraphSegmentSet:r,splitGraphSegmentNodeMap:n}),t.searchInTree({sheetId:l,startColIndex:o,endColIndex:i,startRowIndex:u,endRowIndex:s},V.IN_DEGREE).forEach((function(a){t.splitOldInDegreeSegment({gridRange:e,inDegreeSegment:a,deleteInDegreeGraphSegmentSet:r,splitGraphSegmentNodeMap:n})}))}))}))},r.mergeOldInDegreeSegment=function(e){var t,r=this,n=e.formulaModel,a=e.gridRange,o=e.deleteInDegreeGraphSegmentSet,i=e.splitGraphSegmentNodeMap,u=function(e){return new B(e.sheetId,e.startRowIndex-1,e.endRowIndex+1,e.startColIndex-1,e.endColIndex+1)}(a);return this.searchInTree(u,V.IN_DEGREE).every((function(e){var u=e.gridRange,s=u.startRowIndex,l=u.startColIndex,c=u.sheetId,f=r.externalMethods.getFormulaModelByRowCol(s,l,c,{customType:r.type,id:e.getId(),inDegreeSegmentNode:e});if(n!==f)return!0;var d=i.get(e)||{gridRanges:[e.gridRange],nodeInfo:e.nodeInfo};return d.gridRanges.every((function(u,s){var l;if(oe(u,a))return!0;var c,f,h=(f=a,(c=u).sheetId!==f.sheetId?null:c.startRowIndex!==f.startRowIndex||c.endRowIndex!==f.endRowIndex||c.endColIndex!==f.startColIndex-1&&f.endColIndex!==c.startColIndex-1?c.startColIndex!==f.startColIndex||c.endColIndex!==f.endColIndex||c.endRowIndex!==f.startRowIndex-1&&f.endRowIndex!==c.startRowIndex-1?null:Y.col:Y.row);if(null===h)return!0;l=le([u,a],h),t=l[0],o.add(e);var m=r.mergeOldInDegreeSegment({formulaModel:n,gridRange:t,deleteInDegreeGraphSegmentSet:o,splitGraphSegmentNodeMap:i});return t=m||t,d.gridRanges[s]=t,i.set(e,d),!1}))})),t},r.splitOldInDegreeSegment=function(e){var t=e.gridRange,r=e.inDegreeSegment,n=e.deleteInDegreeGraphSegmentSet,o=e.splitGraphSegmentNodeMap,i=o.get(r)||{gridRanges:[r.gridRange],nodeInfo:r.nodeInfo},u={gridRanges:[]};i.gridRanges.forEach((function(e){var r,n=ae(e,t);n.length?(r=u.gridRanges).push.apply(r,(0,a.Z)(n)):oe(e,t)||u.gridRanges.push(e),u.nodeInfo=i.nodeInfo})),0===u.gridRanges.length?o.delete(r):o.set(r,u),n.add(r)},r.getAddAndDeleteRanges=function(e,t){var r=new Map,n=new Map;return t.forEach((function(e,t){var n=se(e.map((function(e){var t=e.row,r=e.col;return{startRowIndex:t,endRowIndex:t,startColIndex:r,endColIndex:r,sheetId:e.sheetId}})));r.set(t,{gridRanges:n,nodeInfo:e[0].nodeInfo})})),e.forEach((function(e,t){var r=se(e.map((function(e){var t=e.row,r=e.col;return{startRowIndex:t,endRowIndex:t,startColIndex:r,endColIndex:r,sheetId:e.sheetId}})));n.set(t,{gridRanges:r,nodeInfo:e[0].nodeInfo})})),{deleteGraphSegmentNodesMap:n,addGraphSegmentNodesMap:r}},r.getSameFormulaModelChangedNodes=function(e){var t=this,r=new Map,n=new Map;return e.forEach((function(e){var a=e.col,o=e.row,i=e.sheetId;if(e.formulaModel){var u=r.get(e.formulaModel);u||(u=[],r.set(e.formulaModel,u)),u.push(e)}else{var s=t.searchInTree({sheetId:i,startColIndex:a,endColIndex:a,startRowIndex:o,endRowIndex:o},V.IN_DEGREE)[0];if(s){var l=n.get(s);l||(l=[],n.set(s,l)),l.push(e)}}})),{sameFormulaModelChangedNodesMap:r,formulaBecomeConstNodesMap:n}},t}(Le);function Ge(e){return{sheetId:e.sheetId,startRowIndex:e.row,endRowIndex:e.row,startColIndex:e.col,endColIndex:e.col}}var He=function(){function e(e,t){var r;this.externalMethods=t;var n=new Pe(e,t),a=new Pe(e,t),o=new Le(e,t);this.graphSegmentManagerMap=((r={})[S.FORMULA]=n,r[S.DYNAMIC]=o,r[S.FULL_TABLE]=a,r)}var t=e.prototype;return t.destroy=function(){this.graphSegmentManagerMap.DYNAMIC_DEPENDENCY.destroy(),this.graphSegmentManagerMap.FULL_TABLE_DEPENDENCY.destroy(),this.graphSegmentManagerMap.FORMULA_DEPENDENCY.destroy()},t.getFormulaGraphSegmentManager=function(){return this.graphSegmentManagerMap[S.FORMULA]},t.getFullTableGraphSegmentManager=function(){return this.graphSegmentManagerMap[S.FULL_TABLE]},t.getDynamicGraphSegmentManager=function(){return this.graphSegmentManagerMap[S.DYNAMIC]},t.addDynamicDependency=function(e,t,r){var n=e.sheetId,a=this.getDynamicGraphSegmentManager(),o=this.getFullTableGraphSegmentManager(),i=this.isAlreadyHasThisDependencyRelationship(e,t,a).isAlreadyHasThisDependency;if(!i){var u=new ke(e,r),s=new ke(t);a.addDependency(u,s);var l=Object.assign(r||{},{formulaModel:L}),c=new ke(e,l),f=new ke(new B(n,b,O,b,O));o.addDependency(c,f)}return!i},t.addDependency=function(e,t,r){var n=this.getFormulaGraphSegmentManager(),a=new ke(e,r),o=new ke(t);return n.addDependency(a,o)},t.clearDynamicDependencies=function(e){var t=this.getDynamicGraphSegmentManager(),r=t.getTreeMap().inDegreeTreeMap[e];r&&r.all().forEach((function(e){t.removeNodeAndRelatedNodesInTree(e,V.IN_DEGREE)}))},t.addFormulaNodes=function(e){var t=this,r=[],n=[],a=this.getFormulaGraphSegmentManager(),o=this.getFullTableGraphSegmentManager(),i=this.getDynamicGraphSegmentManager();e.forEach((function(e){r.push(e);var a=t.isInDegreeNodeDynamicDependency(e),o=a.isDynamicDependency,u=a.inDegreeNode;o&&(i.removeNodeAndRelatedNodesInTree(u,V.IN_DEGREE),n.push(Object.assign(Object.assign({},e),{formulaModel:void 0})));var s=t.isInDegreeNodePositionDependency(e),l=function(e){if(!e)return!1;for(var t=e.getParts(),r=function(e){var r=t[e];if("string"==typeof r){if(F.some((function(e){return r.includes(e)})))return{v:!0}}else if(null==r?void 0:r.isPositionRely)return{v:!0}},n=0;n<t.length;n++){var a=r(n);if("object"===typeof a)return a.v}return!1}(e.formulaModel);!s&&l?n.push(Object.assign(Object.assign({},e),{formulaModel:L})):s&&!l&&n.push(Object.assign(Object.assign({},e),{formulaModel:void 0}))})),a.addNodesFromChangedNodes(r),o.addNodesFromChangedNodes(n)},t.getRefRangeByDepRange=function(e,t){var r=[];this.getDynamicGraphSegmentManager().getRefRangeByDepRange(e,(function(e){var t=e.offsetRefRange;r.push(t)}));var n=this.getFormulaGraphSegmentManager(),a=new WeakSet;r.forEach((function(e){n.searchInTree(e,V.IN_DEGREE).forEach((function(r){t({offsetRefRange:e,inDegreeSegmentNode:r}),a.add(r)}))})),this.getFormulaGraphSegmentManager().getRefRangeByDepRange(e,(function(e){var r=e.inDegreeSegmentNode,n=e.offsetRefRange;a.has(r)||t({inDegreeSegmentNode:r,offsetRefRange:n})}))},t.getDepRangeByRefRange=function(e,t){var r=[];this.getDynamicGraphSegmentManager().getDepRangeByRefRange(e,(function(e){var t=e.offsetRefRange;r.push(t)}));var n=this.getFormulaGraphSegmentManager(),a=new WeakSet;r.forEach((function(e){n.searchInTree(e,V.OUT_DEGREE).forEach((function(r){t({offsetRefRange:e,outDegreeSegmentNode:r}),a.add(r)}))})),this.getFormulaGraphSegmentManager().getDepRangeByRefRange(e,(function(e){var r=e.outDegreeSegmentNode,n=e.offsetRefRange;a.has(r)||t({outDegreeSegmentNode:r,offsetRefRange:n})}))},t.getInDegreeNodesBySheetId=function(e){return[].concat((0,a.Z)(this.getInDegreeNodeBySheetIdAndType(e,S.DYNAMIC)),(0,a.Z)(this.getInDegreeNodeBySheetIdAndType(e,S.FORMULA)),(0,a.Z)(this.getInDegreeNodeBySheetIdAndType(e,S.FULL_TABLE)))},t.getOutDegreeNodesBySheetId=function(e){return[].concat((0,a.Z)(this.getOutDegreeNodeBySheetIdAndType(e,S.DYNAMIC)),(0,a.Z)(this.getOutDegreeNodeBySheetIdAndType(e,S.FORMULA)),(0,a.Z)(this.getOutDegreeNodeBySheetIdAndType(e,S.FULL_TABLE)))},t.getInDegreeNodeBySheetIdAndType=function(e,t){var r;return(null===(r=this.graphSegmentManagerMap[t].getTreeBySheetIdAndDegreeTreeType(e,V.IN_DEGREE))||void 0===r?void 0:r.all())||[]},t.getOutDegreeNodeBySheetIdAndType=function(e,t){var r;return(null===(r=this.graphSegmentManagerMap[t].getTreeBySheetIdAndDegreeTreeType(e,V.OUT_DEGREE))||void 0===r?void 0:r.all())||[]},t.toJson=function(e){var t=this;return Object.keys(this.graphSegmentManagerMap).reduce((function(r,n){return r[n]=t.graphSegmentManagerMap[n].toJson(e),r}),{})},t.isAlreadyHasThisDependencyRelationship=function(e,t,r){var n,a,o=r.searchInTree(e,V.IN_DEGREE);return 0===o.length?{isAlreadyHasThisDependency:!1}:{isAlreadyHasThisDependency:o.some((function(e){var r;return n=e,a=null===(r=e.relationshipSegments.find((function(e){return de(e.node.gridRange,!0)===de(t,!0)})))||void 0===r?void 0:r.node})),alreadyExistInDegreeNode:n,alreadyExistOutDegreeNode:a}},t.isInDegreeNodePositionDependency=function(e){return this.getFullTableGraphSegmentManager().searchInTree(Ge(e),V.IN_DEGREE).length>0},t.isInDegreeNodeDynamicDependency=function(e){var t=this.getDynamicGraphSegmentManager().searchInTree(Ge(e),V.IN_DEGREE);return{isDynamicDependency:t.length>0,inDegreeNode:t[0]}},e}();function Ye(e){return e.id===j.INSERT_DIMENSION_MUTATION}function je(e){return e.id===j.DELETE_DIMENSION_MUTATION}function Ve(e){return e.id===j.MAP_RANGE_MUTATION}function $e(e){return e.id===j.INSERT_SHEET_MUTATION}var Ze,We=function(){function e(e){this.externalMethods=e}var t=e.prototype;return t.updateGraphAfterMutation=function(e,t){return Ye(t)||je(t)?this.updateAfterInsertDeleteDimension(e,t):Ve(t)?this.updateAfterMapRange(e,t):$e(t)?this.updateAfterInsertSheet(e,t):function(e){return e.id===j.DELETE_SHEET_MUTATION}(t)?this.updateAfterDeleteSheet(e,t):function(e){return e.id===j.MOVE_SHEET_MUTATION}(t)?this.updateAfterMoveSheet(e,{sheetIndex:t.toIndex}):[]},t.updateAfterInsertDeleteDimension=function(e,t){var r=this,n=new Set,a=function(a){var o=t.getAffectedSheetId(),i=e.getTreeBySheetIdAndDegreeTreeType(o,a);i&&i.walk((function(e){return e.leaf?r.updateLeafNodeAfterInsertDeleteDimension({rTreeNode:e,mutation:t,degreeTreeType:a,needRebuildInDegreeNodeSet:n}):r.updateChildNodeAfterInsertDeleteDimension({rTreeNode:e,mutation:t})}))};return a(V.IN_DEGREE),a(V.OUT_DEGREE),Array.from(n)},t.updateAfterMapRange=function(e,t){var r=t.getAffectedSheetId(),n=e.getTreeBySheetIdAndDegreeTreeType(r,V.IN_DEGREE);if(!n)return[];var a=function(e){var t,r,n,a,o=e.row,i=e.column,u=-1!==o.to,s=(u?o:i).from,l=s.startIndex,c=s.endIndex,f=0,d=0,h=0,m=0;return u?(f=(t=[l,c])[0],d=t[1],h=(r=[b,O])[0],m=r[1]):(f=(n=[b,O])[0],d=n[1],h=(a=[l,c])[0],m=a[1]),{startColIndex:h,endColIndex:m,startRowIndex:f,endRowIndex:d}}(t),o=n.search({minX:a.startColIndex,maxX:a.endColIndex,minY:a.startRowIndex,maxY:a.endRowIndex}),i=new Set;return o.forEach((function(e){var r=e.gridRange,n=function(e,t){var r,n,a,o,i=e.row,u=e.column,s=-1!==i.to,l=s?i:u,c=l.to,f=l.from,d=f.startIndex,h=f.endIndex,m=e.getAffectedSheetId(),g=h-d,p=0,v=0,y=0,N=0;return s?(p=(r=[c,c+g])[0],v=r[1],y=(n=[t.startColIndex,t.endColIndex])[0],N=n[1]):(p=(a=[t.startRowIndex,t.endRowIndex])[0],v=a[1],y=(o=[c,c+g])[0],N=o[1]),new B(m,p,v,y,N)}(t,r);i.add(new ke(n,e.nodeInfo))})),Array.from(i)},t.updateAfterMoveSheet=function(e,t){var r=t.sheetIndex,n=(0,this.externalMethods.getSheetIdBySheetIndex)(r);return this.updateAfterMoveDeleteSheet(e,n)},t.updateAfterDeleteSheet=function(e,t){var r=this.updateAfterMoveDeleteSheet(e,t.sheetId);return e.removeTree(t.sheetId),Array.from(r)},t.updateAfterMoveDeleteSheet=function(e,t){var r=this,n=e.getTreeBySheetIdAndDegreeTreeType(t,V.OUT_DEGREE);if(void 0===n)return[];var a=new Set;return n.all().forEach((function(t){var n=t.relationshipSegments[0],o=Ue({inDegreeSegmentNode:n.node,partIdx:n.partIdx,customType:e.type,getFormulaModelByRowCol:r.externalMethods.getFormulaModelByRowCol});o&&he(o.startSheetId,o.endSheetId)&&a.add(n.node)})),Array.from(a)},t.updateAfterInsertSheet=function(e,t){var r=this,n=t.sheetId,a=t.sheetIndex-1;if(a<0)return[];var o=this.externalMethods.getSheetIdBySheetIndex(a),i=e.getTreeBySheetIdAndDegreeTreeType(o,V.OUT_DEGREE);if(!i)return[];var u=new Set;return i.all().forEach((function(t){var a=t.relationshipSegments[0],o=Ue({inDegreeSegmentNode:a.node,partIdx:a.partIdx,customType:e.type,getFormulaModelByRowCol:r.externalMethods.getFormulaModelByRowCol});if(void 0!==o){var i=o.startSheetId,s=o.endSheetId;(function(e,t){return e!==t&&""!==e})(i,s)&&r.externalMethods.getSheetIdsAmongTwoSheets(i,s).includes(n)&&u.add(a.node)}})),Array.from(u)},t.updateChildNodeAfterInsertDeleteDimension=function(e){var t=e.rTreeNode,r=e.mutation,n=we(r.sheetId,t),a=xe(r,n),o=De(r,n);if(o){var i,u,s=be(r,n);i=[s.startColIndex,s.endColIndex],t.minX=i[0],t.maxX=i[1],u=[s.startRowIndex,s.endRowIndex],t.minY=u[0],t.maxY=u[1]}return a||o},t.updateLeafNodeAfterInsertDeleteDimension=function(e){var t,r,n=e.rTreeNode,a=e.mutation,o=e.degreeTreeType,i=e.needRebuildInDegreeNodeSet;n.children.forEach((function(e){var t=e.gridRange;xe(a,t)&&(o===V.IN_DEGREE?(be(a,t),i.add(e)):e.relationshipSegments.forEach((function(e){var t=e.node;i.add(t)}))),De(a,t)&&be(a,t)}));var u=we(a.sheetId,n),s=be(a,u);return t=[s.startColIndex,s.endColIndex],n.minX=t[0],n.maxX=t[1],r=[s.startRowIndex,s.endRowIndex],n.minY=r[0],n.maxY=r[1],!1},e}(),Xe=function(){function e(e){this.depSize=0,this.gridRange=e,this.refRelationshipSegments=new Set,this.depRelationshipSegments=new Set}var t=e.prototype;return t.addRefRelationshipSegment=function(e){return!this.refRelationshipSegments.has(e)&&(this.refRelationshipSegments.add(e),!0)},t.addDepRelationshipSegment=function(e){return!this.depRelationshipSegments.has(e)&&(this.depRelationshipSegments.add(e),!0)},t.removeDepRelationshipSegment=function(e){return this.depRelationshipSegments.delete(e)},t.removeRefRelationshipSegment=function(e){return this.refRelationshipSegments.delete(e)},e}(),Ke=function(){function e(e){this.externalMethods=e,this.subGraphSegmentNodeMap=new Map}var t=e.prototype;return t.getTopSortNodesBySheetIdsAndNodes=function(e,t,r){void 0===t&&(t=[]),this.graphService=r;var n=[],o=[];if(e.forEach((function(e){n.push.apply(n,(0,a.Z)(r.getInDegreeNodesBySheetId(e))),o.push.apply(o,(0,a.Z)(r.getOutDegreeNodesBySheetId(e)))})),n.push.apply(n,(0,a.Z)(t)),0===n.length&&0===o.length)return{topSortRanges:[],cycleRanges:[]};var i=this.getSubGraphInDegreeSegmentNodes({inDegreeNodes:n,outDegreeNodes:o}),u=this.getDyeSubGraphByInDegreeSegmentNodes(i),s=this.getTopSortNodesBySubGraph(u),l=s.topSortRanges,c=s.cycleRanges;return this.graphService=void 0,{topSortRanges:l,cycleRanges:c}},t.getTopSortNodesByChangedNodes=function(e,t){this.graphService=t;var r=this.getInDegreeSegmentNodesByChangedNodes(e),n=this.getDyeSubGraphByInDegreeSegmentNodes(r),a=this.getTopSortNodesBySubGraph(n),o=a.topSortRanges,i=a.cycleRanges;return this.graphService=void 0,{topSortRanges:o,cycleRanges:i}},t.getTopSortNodesBySubGraph=function(e){var t=this,r=Object.values(e),n=[],a=[],o=this.getTopSortNodesBySubGraphSegmentNodes(r,(function(e){var r=t.getCycle(e),n=r.cycles,a=r.sortNodes;return console.warn("",{sortNodes:a,cycles:n}),{cycles:n,sortNodes:a}})),i=o.cycles;return o.sortNodes.forEach((function(e){n.push(e.gridRange)})),i.forEach((function(e){a.push(e.gridRange)})),{topSortRanges:n,cycleRanges:a}},t.getTopSortNodesBySubGraphSegmentNodes=function(e,t){for(var r=[];0!==e.length;){var n=e;if(e=[],n.forEach((function(t){t.depSize?e.push(t):(r.push(t),t.refRelationshipSegments.forEach((function(e){e.depSize-=1})))})),e.length===n.length){var o=t(e),i=o.cycles,u=o.sortNodes;return r.push.apply(r,(0,a.Z)(u)),{cycles:i,sortNodes:r}}}return{cycles:[],sortNodes:r}},t.getCycle=function(e){var t=this.searchCycle(e),r=t.needSortedNodes,n=t.cycles,a=this.getTopSortNodesBySubGraphSegmentNodes(r,(function(e){return console.warn("cycle error",r),{cycles:[],sortNodes:e}}));return{cycles:n,sortNodes:a.sortNodes}},t.searchCycle=function(e){var t=new Set,r=[],n=[];return e.forEach((function(e){r.push(e);for(var a=new Set,o=function(){var e=r[r.length-1],n=!1;e.refRelationshipSegments.forEach((function(e){if(!n){if(a.has(e))return!1;if(a.add(e),!e.depSize)return!1;var o=r.indexOf(e);if(-1!==o){for(var i=[];o!==r.length;){var u=r.pop();u.depSize>0&&(u.depSize-=1),t.add(u),i.push(u)}return i.forEach((function(e){0===e.depSize&&e.refRelationshipSegments.forEach((function(e){t.has(e)||e.depSize<=0||(e.depSize-=1)}))})),!1}return r.push(e),n=!0,!0}})),e===r[r.length-1]&&r.pop()};r.length;)o();t.has(e)||n.push(e)})),{cycles:Array.from(t),needSortedNodes:n}},t.getDyeSubGraphByInDegreeSegmentNodes=function(e){for(var t=this,r=new Map,n={},a={},o=function(e){var t=Ae(e.gridRange);return!!n[t]},i=function(e){var t=Ae(e.gridRange);return!!a[t]||(a[t]=!0,!1)},u=function(a){var u=e[a];if(o(u))return"continue";var s=r.get(u);if(s)return s.forEach((function(t){o(t)||i(t)||e.push(t)})),"continue";var l=Ae(u.gridRange);n[l]=u;var c=u.gridRange,f=new Set;t.getRefRangeByDependencyRange({dependencyRange:c,splitGraphMap:r,callBack:function(t){var r=t.inDegreeSegmentNode,a=t.exceptSegmentNodes,s=Ae(t.inDegreeParentSegmentNode.gridRange);a.length>0&&n[s]&&(f.add(s),a.forEach((function(t){o(t)||i(t)||e.push(t)}))),o(r)||i(r)||e.push(r);var l=u.addRefRelationshipSegment(r),c=r.addDepRelationshipSegment(u);l&&c&&(r.depSize+=1)}}),f.forEach((function(e){var t,r=n[e];null===(t=null==r?void 0:r.refRelationshipSegments)||void 0===t||t.forEach((function(e){e.removeDepRelationshipSegment(r),e.depSize-=1})),delete n[e]}))},s=0;s<e.length;s++)u(s);return r.forEach((function(e,t){var r=Ae(t.gridRange);n[r]&&console.warn("")})),this.subGraphSegmentNodeMap.clear(),n},t.getExceptRangeWithOffsetRange=function(e){return ae(e.inDegreeParentRange,e.inDegreeOffsetRange)},t.getInDegreeSegmentNodesByChangedNodes=function(e){var t=[],r=[];return e.forEach((function(e){var n=e.row,a=e.col,o=e.sheetId,i=e.formulaModel,u=new B(o,n,n,a,a);void 0!==i?r.push(u):t.push(u)})),[].concat((0,a.Z)(this.getInDegreeSegmentNodesByConstGridRanges(t)),(0,a.Z)(this.getInDegreeSegmentNodesByFormulaGridRanges(r)))},t.getInDegreeSegmentNodesByConstGridRanges=function(e){var t=this,r=new Set;return se(e).forEach((function(e){t.getRefRangeByDependencyRange({dependencyRange:e,callBack:function(e){var t=e.inDegreeSegmentNode;r.add(t)}})})),r},t.getInDegreeSegmentNodesByFormulaGridRanges=function(e){var t=this,r=new Set;return se(e).forEach((function(e){t.getRefRangeByDependencyRange({dependencyRange:e,callBack:function(e){var t=e.inDegreeSegmentNode;r.add(t)}});var n=t.graphService.getFormulaGraphSegmentManager().searchInTree(e,V.IN_DEGREE);null==n||n.forEach((function(n){if(t.externalMethods.isNodeNeedCalculateHook(n)){var a=ie(n.gridRange,e);a&&fe(a)&&r.add(t.getSubGraphSegmentNodeByRange(a))}}))})),r},t.getRefRangeByDependencyRange=function(e){var t,r=this,n=e.dependencyRange,o=e.splitGraphMap,i=e.callBack;null===(t=this.graphService)||void 0===t||t.getRefRangeByDepRange(n,(function(e){var t=e.offsetRefRange,n=e.inDegreeSegmentNode;if(r.externalMethods.isNodeNeedCalculateHook(n)){var u=(null==o?void 0:o.get(n))||[r.getSubGraphSegmentNodeByRange(n.gridRange)],s=u.length;u.forEach((function(e,n){var s=ie(e.gridRange,t);if(s){var l=r.getExceptRangeWithOffsetRange({inDegreeOffsetRange:s,inDegreeParentRange:e.gridRange}),c=[e];l.length>0&&(c=[s].concat((0,a.Z)(l)).map((function(t){var n=r.getSubGraphSegmentNodeByRange(t);return e.depRelationshipSegments.forEach((function(t){t.removeRefRelationshipSegment(e),t.addRefRelationshipSegment(n)})),n.depSize=e.depSize,n.depRelationshipSegments=new Set(Array.from(e.depRelationshipSegments)),n})),o&&(o.set(e,c),delete u[n],u.push.apply(u,(0,a.Z)(c)))),i({inDegreeParentSegmentNode:e,inDegreeSegmentNode:c[0],exceptSegmentNodes:c.slice(1)})}})),o&&u.length>s&&o.set(n,u)}}))},t.getSubGraphInDegreeSegmentNodes=function(e){var t=this,r=e.inDegreeNodes,n=e.outDegreeNodes,a=new Set,o=function(e){if(t.externalMethods.isNodeNeedCalculateHook(e)){var r=t.getSubGraphSegmentNodeByRange(e.gridRange);a.add(r)}};return r.forEach((function(e){o(e)})),n.forEach((function(e){e.relationshipSegments.forEach((function(e){var t=e.node;o(t)}))})),Array.from(a)},t.getSubGraphSegmentNodeByRange=function(e){var t=Ae(e),r=this.subGraphSegmentNodeMap.get(t);return r||(r=new Xe(e),this.subGraphSegmentNodeMap.set(t,r)),r},e}(),ze=function(){function e(e){this.graphServiceMap=new Map,this.externalMethods=e,this.graphServiceMap=new Map}var t=e.prototype;return t.getGraphServiceMap=function(){return this.graphServiceMap},t.getGraphServiceByCustomType=function(e){return this.graphServiceMap.get(e)},t.addCustomNodesWithAuto=function(e,t){var r=this.getOrCreateGraphServiceByCustomType(e),n=[];t.forEach((function(e){var t=e.gridRange,r=e.formulaModel,a=e.nodeInfo;ne(t,(function(e,t,o){n.push({row:e,col:t,sheetId:o,formulaModel:r,nodeInfo:a})}))})),r.addFormulaNodes(n)},t.addCustomNodesWithManual=function(e,t){var r=this,n=this.getOrCreateGraphServiceByCustomType(e);t.forEach((function(e){var t=e.gridRange,a=e.formulaModel,o=e.nodeInfo,i=null==a?void 0:a.getAllCellRangeWithFixedInfo();if(i.forEach((function(e){var a=me(e,t),i=a.startRow,u=a.endRow,s=a.startCol,l=a.endCol;ge(e,t.sheetId,r.externalMethods.getSheetIdsAmongTwoSheets).forEach((function(e){var r=new B(e,i,u,s,l);n.addDependency(t,r,o)}))})),0===i.length){var u=n.getFormulaGraphSegmentManager(),s=new ke(t,o);u.loadNodesInTree(t.sheetId,[s],V.IN_DEGREE)}}))},t.removeCustomNodesWithAuto=function(e,t){var r=[];t.forEach((function(e){ne(e.gridRange,(function(e,t,n){r.push({row:e,col:t,sheetId:n,formulaModel:void 0,nodeInfo:void 0})}))})),this.getOrCreateGraphServiceByCustomType(e).getFormulaGraphSegmentManager().addNodesFromChangedNodes(r)},t.removeCustomNodesWhitManual=function(e,t){var r=this.getOrCreateGraphServiceByCustomType(e).getFormulaGraphSegmentManager();t.forEach((function(e){var t=e.gridRange,n=e.id,a=r.searchInTree(t,V.IN_DEGREE).filter((function(e){return e.getId()===n}));0!==a.length&&a.forEach((function(e){r.removeNodeAndRelatedNodesInTree(e,V.IN_DEGREE)}))}))},t.getOrCreateGraphServiceByCustomType=function(e){var t=this.graphServiceMap.get(e);return void 0===t&&(t=new He(e,{getSheetIdsAmongTwoSheets:this.externalMethods.getSheetIdsAmongTwoSheets,getFormulaModelByRowCol:this.externalMethods.getFormulaModelByRowCol}),this.graphServiceMap.set(e,t)),t},e}(),qe=function(){function e(e){this.pluginMap=new Map,this.customGraphNodeService=e}var t=e.prototype;return t.getCustomNodeService=function(){return this.customGraphNodeService},t.destroy=function(){this.pluginMap.clear()},t.addPlugin=function(e,t){t.setCustomGraphNodeService(this.customGraphNodeService),this.pluginMap.set(e,t)},t.getPlugin=function(e){return this.pluginMap.get(e)||void 0},t.notifyPluginAfterSingleNodeCalculated=function(e){var t=e.customType,r=this.pluginMap.get(t);void 0!==r&&r.afterSingleNodeCalculated(e)},t.notifyPluginAfterAllNodesCalculated=function(e){if(void 0!==e){var t=this.pluginMap.get(e);void 0!==t&&t.afterAllNodesCalculated()}},e}(),Je=function(){function e(e){var t;this.externalMethods=e,this.sortService=new Ke({isNodeNeedCalculateHook:(null===(t=this.externalMethods)||void 0===t?void 0:t.isNodeNeedCalculateHook)||function(){return!0}}),this.customNodeService=new ze({getSheetIdsAmongTwoSheets:this.externalMethods.getSheetIdsAmongTwoSheets,getFormulaModelByRowCol:this.externalMethods.getFormulaModelByRowCol}),this.customNodePluginManager=new qe(this.customNodeService),this.graphUpdateService=new We({getSheetIdBySheetIndex:this.externalMethods.getSheetIdBySheetIndex,getSheetIdsAmongTwoSheets:this.externalMethods.getSheetIdsAmongTwoSheets,getFormulaModelByRowCol:this.externalMethods.getFormulaModelByRowCol}),this.graphService=new He(D,{getSheetIdsAmongTwoSheets:this.externalMethods.getSheetIdsAmongTwoSheets,getFormulaModelByRowCol:this.externalMethods.getFormulaModelByRowCol}),this.resetPerformanceInfo()}var t=e.prototype;return t.toJson=function(e){var t={};return t[D]=this.graphService.toJson(e),this.customNodeService.getGraphServiceMap().forEach((function(r,n){t[n]=r.toJson(e)})),t},t.getPerformanceInfo=function(){return this.performanceInfo},t.resetPerformanceInfo=function(){this.performanceInfo={buildGraphDuration:0,topSortDuration:0}},t.destroy=function(){this.graphService.destroy(),this.customNodeService.getGraphServiceMap().forEach((function(e){e.destroy()})),this.customNodePluginManager.destroy()},t.getGraphService=function(e){return function(e){return void 0!==e&&e!==D}(e)?this.customNodeService.getGraphServiceByCustomType(e):this.graphService},t.getCustomNodePluginManager=function(){return this.customNodePluginManager},t.addCustomNodePlugin=function(e,t){this.customNodePluginManager.addPlugin(e,t)},t.addNodes=function(e){var t=Date.now();this.graphService.addFormulaNodes(e);var r=Date.now();this.performanceInfo.buildGraphDuration+=r-t},t.removeNodes=function(e){this.graphService.addFormulaNodes(e.map((function(e){return Object.assign(Object.assign({},e),{formulaModel:void 0})})))},t.addCustomNodes=function(e,t){var r;return(null===(r=this.customNodePluginManager.getPlugin(e))||void 0===r?void 0:r.addNodes(t))||[]},t.removeCustomNodes=function(e,t){var r;return(null===(r=this.customNodePluginManager.getPlugin(e))||void 0===r?void 0:r.removeNodes(t))||[]},t.eachDegreeTree=function(e,t){var r=function(r,n){var a=r.getFormulaGraphSegmentManager().getTreeMap(),o=a.outDegreeTreeMap,i=a.inDegreeTreeMap,u=e===V.IN_DEGREE?i:o;t(u,n,S.FORMULA,r);var s=r.getDynamicGraphSegmentManager().getTreeMap(),l=s.outDegreeTreeMap,c=s.inDegreeTreeMap,f=e===V.IN_DEGREE?c:l;t(f,n,S.DYNAMIC,r)};r(this.graphService,D),this.customNodeService.getGraphServiceMap().forEach((function(e,t){r(e,t)}))},t.addDynamicDependency=function(e){var t=e.inDegreeNode,r=e.outDegreeNode,n=e.customType,a=this.getGraphService(n);if(!a)return!1;var o=new B(t.sheetId,t.row,t.row,t.col,t.col),i=new B(r.startSheetId,r.startRow,r.endRow,r.startCol,r.endCol);return a.addDynamicDependency(o,i)},t.getRefRangeByDepRange=function(e,t,r){var n=this,a=t===D;a&&this.graphService.getRefRangeByDepRange(e,(function(e){var t=e.offsetRefRange,a=e.inDegreeSegmentNode;r({offsetRefRange:t,inDegreeSegmentNode:a,graphSegmentManager:n.graphService,customType:D})})),this.customNodeService.getGraphServiceMap().forEach((function(n,o){(a||o===t)&&n.getRefRangeByDepRange(e,(function(e){var t=e.offsetRefRange,a=e.inDegreeSegmentNode;r({offsetRefRange:t,inDegreeSegmentNode:a,graphSegmentManager:n,customType:o})}))}))},t.getDepRangeByRefRange=function(e,t,r){var n=this;t===D?this.graphService.getDepRangeByRefRange(e,(function(e){var t=e.offsetRefRange,a=e.outDegreeSegmentNode;r({offsetRefRange:t,outDegreeSegmentNode:a,graphSegmentManager:n.graphService,customType:D})})):this.customNodeService.getGraphServiceMap().forEach((function(n,a){a===t&&n.getDepRangeByRefRange(e,(function(e){var t=e.offsetRefRange,o=e.outDegreeSegmentNode;r({offsetRefRange:t,outDegreeSegmentNode:o,graphSegmentManager:n,customType:a}),r({offsetRefRange:t,outDegreeSegmentNode:o,graphSegmentManager:n,customType:D})}))}))},t.getRecalculateTopSortNodesBySheetIdsAndNodes=function(e,t){var r,n=Date.now(),a=this.sortService.getTopSortNodesBySheetIdsAndNodes(e,t,this.getGraphService(D)),o=Date.now();this.performanceInfo.topSortDuration+=o-n;var i=Oe(a),u=this.getRecalculateCustomTopSortNodesBySheetIds(e),s=this.getRecalculateCustomTopSortNodesByChangedNodes([],i),l=((r={})[D]=i,r);return this.customNodeService.getGraphServiceMap().forEach((function(e,t){Object.assign(u[t],s[t]),l[t]=Object.values(u[t])})),console.warn("",l),l},t.getRecalculateTopSortNodesByChangedNodes=function(e){var t;if(0===e.length)return{};var r=Date.now(),n=this.sortService.getTopSortNodesByChangedNodes(e,this.getGraphService(D)),a=Date.now();this.performanceInfo.topSortDuration+=a-r;var o=Oe(n),i=this.getRecalculateCustomTopSortNodesByChangedNodes(e,o),u=((t={})[D]=o,t);return this.customNodeService.getGraphServiceMap().forEach((function(e,t){u[t]=Object.values(i[t])})),console.warn("",u),u},t.commitMutation=function(e){var t=this,r=e.getAffectedSheetId(),n=[],o=!1;return this.getNeedUpdateGraphServiceMap().forEach((function(i,u){var s=i.getFormulaGraphSegmentManager(),l=t.graphUpdateService.updateGraphAfterMutation(s,e);l.length>0&&(o=!0);var c=t.rebuildInDegreeNodesAndRelatedOutDegreeNodes(u,S.FORMULA,s,l);c.length>0&&n.push.apply(n,(0,a.Z)(c));var f=i.getFullTableGraphSegmentManager(),d=t.graphUpdateService.updateGraphAfterMutation(f,e);t.rebuildInDegreeNodesAndRelatedOutDegreeNodes(u,S.FULL_TABLE,f,d),$e(e)||(i.clearDynamicDependencies(r),n.push.apply(n,(0,a.Z)(t.getNeedCalculateFullTableNodes(f,r))))})),{needRecalculateNodes:n,isGraphChange:o}},t.getNeedUpdateGraphServiceMap=function(){var e=new Map(this.customNodeService.getGraphServiceMap());return e.set(D,this.getGraphService(D)),e},t.getRecalculateCustomTopSortNodesBySheetIds=function(e){for(var t,r=this,n={},a=function(){var a=t.value,o=a[0],i=a[1];n[o]={};var u=i.getFormulaGraphSegmentManager();e.forEach((function(t){var a=u.getTreeBySheetIdAndDegreeTreeType(t,V.IN_DEGREE),i=null==a?void 0:a.all();null==i||i.forEach((function(e){var t,a,i;if(null===(a=(t=r.externalMethods).isNodeNeedCalculateHook)||void 0===a?void 0:a.call(t,e)){var u=Fe(e,e.gridRange),s=Ae(e.gridRange,null===(i=e.nodeInfo)||void 0===i?void 0:i.id);n[o][s]=u}}));var s=u.getTreeBySheetIdAndDegreeTreeType(t,V.OUT_DEGREE),l=null==s?void 0:s.all();null==l||l.forEach((function(t){t.relationshipSegments.forEach((function(t){var a,i,u=t.node;if(!e.includes(u.gridRange.sheetId)&&(null===(i=(a=r.externalMethods).isNodeNeedCalculateHook)||void 0===i?void 0:i.call(a,u))){var s=Ae(u.gridRange,u.getId());if(!n[o][s]){var l=Fe(u,u.gridRange);n[o][s]=l}}}))}))}))},o=c(this.customNodeService.getGraphServiceMap());!(t=o()).done;)a();return n},t.getRecalculateCustomTopSortNodesByChangedNodes=function(e,t){for(var r,n=this,o={},i=[].concat((0,a.Z)(t),(0,a.Z)(e.map((function(e){var t=e.row,r=e.col,n=e.sheetId;return{range:new B(n,t,t,r,r)}})))),u=function(){var e=r.value,t=e[0],a=e[1];o[t]={},i.forEach((function(e){var r=e.range;a.getRefRangeByDepRange(r,(function(e){var r,a,i=e.offsetRefRange,u=e.inDegreeSegmentNode;if(null===(a=(r=n.externalMethods).isNodeNeedCalculateHook)||void 0===a?void 0:a.call(r,u)){var s=Fe(u,i),l=Ae(s.range,s.id);o[t][l]||(o[t][l]=s)}}))}))},s=c(this.customNodeService.getGraphServiceMap());!(r=s()).done;)u();return console.warn(o),o},t.getNeedCalculateFullTableNodes=function(e,t){var r=[],n=e.getTreeBySheetId(t).inDegreeTree;return null==n||n.all().forEach((function(e){ne(e.gridRange,(function(e,n){var a=L;r.push({row:e,col:n,sheetId:t,formulaModel:a,nodeInfo:void 0})}))})),r},t.rebuildInDegreeNodesAndRelatedOutDegreeNodes=function(e,t,r,n){var a=this,o=[];return n.forEach((function(n){var i=n.gridRange,u=i.sheetId;r.removeNodeAndRelatedNodesInTree(n,V.IN_DEGREE),ne(i,(function(r,i){var s=null;if(t===S.FORMULA?s=a.externalMethods.getFormulaModelByRowCol(r,i,u,{customType:e,id:n.getId(),inDegreeSegmentNode:n}):t===S.FULL_TABLE&&(s=L),s){var l={row:r,col:i,sheetId:u,formulaModel:s,nodeInfo:n.nodeInfo};o.push(l)}}))})),r.addNodesFromChangedNodes(o),o},e}();!function(e){e[e.AUTO=0]="AUTO",e[e.MANUAL=1]="MANUAL"}(Ze||(Ze={}));var Qe,et=function(){function e(){}var t=e.prototype;return t.setCustomGraphNodeService=function(e){this.customGraphNodeService=e},t.addNodes=function(e){var t=this,r=Ie()(e.map((function(e){return t.generateShouldAddedNodes(e)})));return this.mergeableType===Ze.AUTO?this.customGraphNodeService.addCustomNodesWithAuto(this.customType,r):this.customGraphNodeService.addCustomNodesWithManual(this.customType,r),r},t.removeNodes=function(e){var t=this,r=Ie()(e.map((function(e){return t.generateShouldRemovedNodes(e)})));return this.mergeableType===Ze.AUTO?this.customGraphNodeService.removeCustomNodesWithAuto(this.customType,r):this.customGraphNodeService.removeCustomNodesWhitManual(this.customType,r),r},e}(),tt={style:1,segment:!1,heteronym:!1},rt=new(function(){function e(){this.pinyinCache={}}var t=e.prototype;return t.getAstNodes=function(){return this._astNodes},t.setAstNodes=function(e){this._astNodes=e},t.getFuncNode=function(){return this._funcNode},t.setFuncNode=function(e){this._funcNode=e},t.getElement=function(){return this._element},t.setElement=function(e){this._element=e},t.getInstance=function(){return this._instance},t.setInstance=function(e){this._instance=e},t.getPinyin=function(e){var t=this.pinyinCache[e];return t||(t=(0,Me.default)(e,tt),this.pinyinCache[e]=t),t},t.clear=function(){this._astNodes=void 0,this._funcNode=void 0,this._instance=void 0,this._element=void 0},t.clearCache=function(){this.pinyinCache={}},e}());function nt(e,t,r,n){return new(r||(r=Promise))((function(a,o){function i(e){try{s(n.next(e))}catch(e){o(e)}}function u(e){try{s(n.throw(e))}catch(e){o(e)}}function s(e){var t;e.done?a(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(i,u)}s((n=n.apply(e,t||[])).next())}))}Object.create,Object.create,function(e){e.CELL="CELL",e.COL="COL",e.ROW="ROW",e.VARIABLE="VARIABLE",e.STRING="STRING",e.ERROR="ERROR",e.NUMBER="NUMBER",e.SHEET="SHEET",e.SEPARATOR="SEPARATOR",e.USERARRAY="USERARRAY",e.UNKNOW="UNKNOW"}(Qe||(Qe={}));var at=function(e,t){this.value=e,this.type=t},ot=function(){function e(){this.calculateParentFunctionNode=void 0}var t=e.prototype;return t.setCalculateParentFunctionNode=function(e){this.calculateParentFunctionNode=e},t.setValue=function(e){this.value=e},e}(),it=function(e){function t(t,r,n,a,o,i){var u;return(u=e.call(this)||this).cellId=t,u.originValue=r,u.row=n,u.col=a,u.sheetId=o,u.nodeType=C.CELL,u.crossTableType=i,u.asyncFunctionNodeList=[],u}(0,n.Z)(t,e);var r=t.prototype;return r.setFormula=function(e){this.formula=e},r.equalsFormula=function(e){return this.formula===e},r.setAsyncFunctionNodeList=function(e){void 0===e&&(e=[]),this.asyncFunctionNodeList=e},r.getAsyncFunctionNodeList=function(){return this.asyncFunctionNodeList},r.setBody=function(e){this.body=e},r.toString=function(e,t){if("function"==typeof t.CELL)t.CELL(e,this);else{if(this.originValue.indexOf("'")>=0){var r=this.originValue.lastIndexOf("!"),n=this.originValue.slice(0,r);"'"===n[0]&&n.slice(1,n.length-1).indexOf("'")>=0&&(n=(n=(n=n.slice(1,n.length-1)).replace(/'/g,"''")).slice(1,n.length-1)),this.originValue=n+this.originValue.slice(r)}e.push(this.originValue)}},r.toFormulaModel=function(e,t){var r=[];return"function"==typeof e.CELL&&e.CELL(r,this,t),r},t}(ot),ut=function(e){function t(t,r,n,a,o,i,u,s,l){var c;return(c=e.call(this)||this).nodeType=C.CELL_RANGE,c.startSheetId=t,c.endSheetId=r,c.cellRangeType=u,c.crossTableType=s,c.start=n,c.end=a,c.scope=o,c.sheetIds=i,c.originValue=l,c}(0,n.Z)(t,e);var r=t.prototype;return r.updateSheetIds=function(e){this.sheetIds=e},r.toString=function(e,t){if("function"==typeof t.CELL_RANGE)t.CELL_RANGE(e,this);else{if(this.originValue.indexOf("'")>=0){var r=this.originValue.lastIndexOf("!"),n=this.originValue.slice(0,r);"'"===n[0]&&n.slice(1,n.length-1).indexOf("'")>=0&&(n=(n=(n=n.slice(1,n.length-1)).replace(/'/g,"''")).slice(1,n.length-1)),this.originValue=n+this.originValue.slice(r)}e.push(this.originValue)}},r.toFormulaModel=function(e,t){var r=[];return"function"==typeof e.CELL_RANGE&&e.CELL_RANGE(r,this,t),r},t}(ot),st=function(e){function t(t,r,n){var a;return(a=e.call(this)||this).nodeType=C.CELL_RANGE_BINARY,a.binaryType=n,a.leftRange=t,a.rightRange=r,a}(0,n.Z)(t,e);var r=t.prototype;return r.toString=function(e,t){this.binaryType===x.CONCAT?(this.leftRange.toString(e,t),e.push(","),this.rightRange.toString(e,t)):this.binaryType===x.INTERSECTION&&(this.leftRange.toString(e,t),e.push(" "),this.rightRange.toString(e,t))},r.toFormulaModel=function(e,t){var r=[];return this.binaryType===x.CONCAT?((r=r.concat(this.leftRange.toFormulaModel(e,t))).push(","),r=r.concat(this.rightRange.toFormulaModel(e,t))):this.binaryType===x.INTERSECTION&&((r=r.concat(this.leftRange.toFormulaModel(e,t))).push(" "),r=r.concat(this.rightRange.toFormulaModel(e,t))),r},t}(ot),lt=function(e){function t(t,r){var n;return(n=e.call(this)||this).nodeType=C.FUNCTION,n.args=r,n.funcName=t,n}(0,n.Z)(t,e);var r=t.prototype;return r.setFormatType=function(e){this.formatType=e},r.toString=function(e,t){if(e.parentFunctionNode=this,{LOGICMATCH:!0,SPECIALMATCH:!0,MATHMATCH:!0}[this.funcName])this.args[0].toString(e,t),this.args[2].toString(e,t),this.args[1].toString(e,t);else{e.push(this.funcName+"(");for(var r=0;r<this.args.length;r++)this.args[r].toString(e,t),r!==this.args.length-1&&e.push(",");e.push(")")}},r.toFormulaModel=function(e,t){var r=[];if({LOGICMATCH:!0,SPECIALMATCH:!0,MATHMATCH:!0}[this.funcName])r=(r=(r=r.concat(this.args[0].toFormulaModel(e,this))).concat(this.args[2].toFormulaModel(e,this))).concat(this.args[1].toFormulaModel(e,this));else{r.push(this.funcName+"(");for(var n=0;n<this.args.length;n++){var a=this.args[n];r=r.concat(a.toFormulaModel(e,this)),n!==this.args.length-1&&r.push(",")}r.push(")")}return r},t}(ot),ct=function(e){function t(t,r,n){var a;return(a=e.call(this)||this).nodeType=C.VARIABLE,a.variableType=r,a.originValueNode=t,a.toString=n||function(e){void 0===e&&(e=[]);var t=this.originValueNode;return this.variableType===A.STR&&((t=t.slice(1,t.length-1)).indexOf('"')>=0&&(t=t.replace(/"/g,'""')),t='"'+t+'"'),e.push(t),t},a}return(0,n.Z)(t,e),t.prototype.toFormulaModel=function(e,t){var r=[];return this.toString(r,e),r},t}(ot),ft=function(){function e(e,t,r){var n=this;this.identities=e,this.isCell=t,this.toArray=function(){for(var e=arguments.length,t=new Array(e),a=0;a<e;a++)t[a]=arguments[a];var o=r.apply(n,t);return n.setValue(o),o}}var t=e.prototype;return t.getRangeCount=function(){return this.identities.length},t.getIdentities=function(e){return this.identities[e]},t.getRowCount=function(e){return this.identities[e].rowCount},t.getColumnCount=function(e){return this.identities[e].colCount},t.getRow=function(e){return this.identities[e].row},t.getColumn=function(e){return this.identities[e].col},t.getSheetId=function(e){return this.identities[e].sheetId},t.setValue=function(e){this.value=e},e}();function dt(e){return!!e&&"string"!=typeof e&&void 0!==e.nodeType&&null!==e.nodeType}function ht(e){return e&&e instanceof ft}function mt(e){return e&&e.nodeType===C.CELL}function gt(e){return!!e&&e.nodeType===C.CELL}function pt(e){return!!gt(e)&&e.crossTableType===I.NORMAL}function vt(e){return e&&e.crossTableType===I.NORMAL}function yt(e){return!!Et(e)&&e.crossTableType!==I.NONE}function Nt(e){return!!Et(e)&&e.cellRangeType===w.USER_RANGE}function Mt(e){return e&&e.crossTableType!==I.NONE}function Rt(e){return e&&e.crossTableType===I.THREE_DIMENSION}function _t(e){return e&&e.nodeType===C.CELL_RANGE_BINARY}function Et(e){return e&&e.nodeType===C.CELL_RANGE}function Tt(e){return"boolean"!=typeof e&&e&&e.nodeType===C.FUNCTION}function St(e){return Tt(e)&&"MATHMATCH"!==e.funcName&&"LOGICMATCH"!==e.funcName&&"SPECIALMATCH"!==e.funcName}function Ct(e){return e&&e.nodeType===C.VARIABLE}function It(e,t){if(t)if("OFFSET"===t.funcName){if(0===t.args.indexOf(e))return!0}else if("ROW"===t.funcName||"COLUMN"===t.funcName)return!0;return!1}var At={stopSearchingDown:!1,stopParallelTraversal:!1,stopAll:!1,walkContext:{}};function wt(e,t,r,n){var a=void 0===r?{}:r,o=a.preorder,i=void 0!==o&&o,u=a.walkContext,s=void 0===u?{}:u;return void 0===n&&(n=[]),n.length||n.push(e),gt(e)?function(e,t,r,n){var a=r.preorder,o=r.walkContext;if(!e.body)return{stopAll:!1};var i=n.concat([e.body]),u=t(e.body,i,{walkContext:o})||At,s=u.stopSearchingDown,l=void 0!==s&&s,c=u.stopAll,f=void 0!==c&&c,d=u.walkContext;return f?{stopAll:!0}:!0!==l?wt(e.body,t,{preorder:a,walkContext:d||o},i):{stopAll:f}}(e,t,{preorder:i,walkContext:s},n):Tt(e)?function(e,t,r,n){for(var a=r.preorder,o=r.walkContext,i=e.args,u=a?0:i.length-1,s=a?i.length-1:0,l=u;a?l<=s:l>=s;a?l+=1:l-=1){var c=i[l],f=n.concat(c),d=t(c,f,{walkContext:o})||At,h=d.stopSearchingDown,m=void 0!==h&&h,g=d.stopParallelTraversal,p=void 0!==g&&g,v=d.stopAll,y=void 0!==v&&v,N=d.walkContext;if(y)return{stopAll:y};if(!0!==m&&wt(c,t,{preorder:a,walkContext:N||o},f).stopAll)return{stopAll:!0};if(!0===p)break}return{stopAll:!1}}(e,t,{preorder:i,walkContext:s},n):Et(e)?{stopAll:!1}:Ct(e)?function(e,t,r,n){var a=r.preorder,o=r.walkContext,i=e.originValueNode;if(dt(i)){var u=n.concat([i]),s=t(i,u,{walkContext:o})||At,l=s.stopSearchingDown,c=void 0!==l&&l,f=s.stopAll,d=void 0!==f&&f,h=s.walkContext;return d?{stopAll:!0}:!0!==c?wt(i,t,{preorder:a,walkContext:h||o},u):{stopAll:d}}return{stopAll:!1}}(e,t,{preorder:i,walkContext:s},n):_t(e)?function(e,t,r,n){var a=r.preorder,o=r.walkContext,i={rightRange:n.concat([e.rightRange]),leftRange:n.concat([e.leftRange])},u=!1,s=!1;return(a?["leftRange","rightRange"]:["rightRange","leftRange"]).forEach((function(r){if(!u&&!s){var n=t(e[r],i[r],{walkContext:o})||At,l=n.stopSearchingDown,c=void 0!==l&&l,f=n.stopParallelTraversal,d=void 0!==f&&f,h=n.stopAll,m=void 0!==h&&h,g=n.walkContext;if(m)s=m;else if(u=!!d,!0===c)u=d;else{var p=wt(e[r],t,{preorder:a,walkContext:g||o},i[r]).stopAll;s=p}}})),{stopAll:s}}(e,t,{preorder:i,walkContext:s},n):{stopAll:!1}}var xt,Dt={BaseNode:ot,CellNode:it,CellRangeNode:ut,CellRangeBinaryNode:st,FunctionNode:lt,VariableNode:ct},bt=new(function(){function e(){this.asyncFuncNodeList=[],this.initCellMapData()}var t=e.prototype;return t.initCellMapData=function(){this.cell={},this.rangeCache={},this.cacheStatus=!1,this.asyncFuncNodeList=[]},t.cleanAllAstNodes=function(e,t,r,n,a){for(var o=t;o<=r;o++)for(var i=n;i<=a;i++)this.deleteCell(e,o,i)},t.destroy=function(){this.cell={},this.rangeCache={},this.cacheStatus=!1,this.asyncFuncNodeList=[]},t.toggleCacheStatus=function(e){this.cacheStatus=e},t.getCacheStatus=function(){return this.cacheStatus},t.setCell=function(e,t,r,n){if(this.cacheStatus){var a=this.cell[e];void 0===a&&(a=[],this.cell[e]=[]),void 0===a[t]&&(a[t]=[]),a[t][r],a[t][r]=n}},t.getCell=function(e,t,r){if(this.cacheStatus){var n=this.cell[e],a=null==n?void 0:n[t];return null==a?void 0:a[r]}},t.deleteCell=function(e,t,r){var n,a;(null===(a=null===(n=this.cell[e])||void 0===n?void 0:n[t])||void 0===a?void 0:a[r])&&delete this.cell[e][t][r]},t.addAsyncFunctionNodeList=function(e){this.asyncFuncNodeList.push(e)},t.getAsyncFunctionNodeList=function(){return this.asyncFuncNodeList},t.cleanAsyncFunctionNodeList=function(){this.asyncFuncNodeList&&this.asyncFuncNodeList.length>0&&(this.asyncFuncNodeList=[])},t.startCalc=function(){this.rangeCache={}},e}()),Ot=g(8902);!function(e){e[e.ERROR=0]="ERROR",e[e.NULL_VALUE=1]="NULL_VALUE",e[e.DIVIDE_BY_ZERO=2]="DIVIDE_BY_ZERO",e[e.VALUE=3]="VALUE",e[e.REF=4]="REF",e[e.NAME=5]="NAME",e[e.NUM=6]="NUM",e[e.N_A=7]="N_A",e[e.LOADING=8]="LOADING",e[e.CIRCLE=9]="CIRCLE"}(xt||(xt={}));var Ft=/^\s*$/,Ut=function(){return g.g.debugFormula},Lt=function(e){for(var t,r=arguments.length,n=new Array(r>1?r-1:0),a=1;a<r;a++)n[a-1]=arguments[a];Ut()&&(t=console).error.apply(t,[e].concat(n))},Bt={null:"#NULL!",div0:"#DIV/0!",value:"#VALUE!",ref:"#REF!",circle:"#CIRCLE!",name:"#NAME?",num:"#NUM!",na:"#N/A",error:"#ERROR!",data:"#GETTING_DATA",paramsErr:"#PARAMS!",paramsLack:"#PARAMS_LACK",paramsOver:"#PARAMS_OVER",needUpdate:"#NEED_UPDATE",reorderInFilterView:"#FUNC!"},kt={};function Pt(e){return!("string"!=typeof e||!Object.prototype.hasOwnProperty.call(kt,e))&&kt[e]}function Gt(e){var t=e;return Pt(t)||(t=Bt.error),t}function Ht(e){return e<10?"0"+e:e}Object.values(Bt).forEach((function(e){kt[e]=!0}));var Yt=new Map;function jt(e){if(""===e)return e;var t=0,r=e.length;return"'"===e[0]&&(t+=1,r-=1),e.slice(t,r)}function Vt(e,t){var r=e;return"number"==typeof r&&r.toString().length>=t&&(r=+r.toPrecision(t)),r}function $t(e){if("string"==typeof e&&(n=e,!Ft.test(n))){var t=e.indexOf(".");if((-1===t?e.length:t)>=16)return e;var r=Number(e).valueOf();return isFinite(r)?r:e}var n;return e}function Zt(e,t){return z(t)+(e+1)}var Wt={"#NULL!":xt.NULL_VALUE,"#DIV/0!":xt.DIVIDE_BY_ZERO,"#VALUE!":xt.VALUE,"#REF!":xt.REF,"#CIRCLE!":xt.CIRCLE,"#NAME?":xt.NAME,"#NUM!":xt.NUM,"#N/A":xt.N_A,"#ERROR!":xt.ERROR,"#NEED_UPDATE":xt.LOADING};function Xt(e,t,r,n,a){var o=K(t);return new it(t,n,o.row,o.col,r,a)}function Kt(e,t,r,n){return new st(t,r,n)}function zt(e,t,r){var n=new lt(t,r);return Ot.kY[t]&&bt.addAsyncFunctionNodeList(n),n}function qt(e,t,r,n){return new ct(t,r,n)}function Jt(e,t){var r=t.start,n=t.end,a=t.startSheetId,o=t.endSheetId,i=t.originValue,u=t.cellRangeType,s=t.crossTableType,l=[a];o!==a&&(l=e.getSheetIdsAmongTwoSheets(a,o));var c=Q(r,n,u);return new ut(a,o,r,n,c,l,u,s,i)}var Qt=Object.values(Bt),er=function(){function e(e){var t=this;this.value="",this.tokenStack=[],this.start=0,this.formula="",this.strateyies=[{match:function(e,t){return nr(t)},action:function(e){t.value+=e}},{match:function(e,t){return tr(t)||rr(e)},action:function(e){if(t.value.length>0)t.value+=e;else{var r=dr(t.formula,t.start);if(r.isError)throw new Error("number parse error "+t.formula.slice(t.start));t.start=r.end-1;var n=t.formula[t.start+1];if(or(n)||void 0===n){var a=new at(r.result,Qe.NUMBER);t.tokenStack.push(a)}else t.value+=r.result}}},{match:function(e,t){return 34===t},action:function(e){if(t.value.length>0)throw new Error("token:"+t.value+e);var r=hr(t.formula,t.start,'"','"');if(r.isError)throw new Error("token:"+t.formula.slice(t.start,r.end));t.start=r.end;var n=new at(r.result,Qe.STRING);t.tokenStack.push(n)}},{match:function(e){return or(e)},action:function(e){if(t.value.length>0){var r=fr(t.value);if(r.isError)throw new Error("token:"+t.value);var n=new at(t.value,r.tokenType);t.tokenStack.push(n)}if(" "===e){t.start=ir(t.start+1,t.formula);var a=t.formula[t.start+1];or(a)&&(e=a,t.start+=1)}var o=new at(e,Qe.SEPARATOR);t.tokenStack.push(o),t.value="",t.start=ir(t.start+1,t.formula)}},{match:function(e,t){return 123===t},action:function(e){if(t.value.length>0)throw new Error("token:"+t.value+e);var r=hr(t.formula,t.start,"{","}");if(r.isError)throw new Error("token:"+t.formula.slice(t.start,r.end));t.start=r.end;var n=new at(r.result,Qe.USERARRAY);t.tokenStack.push(n)}},{match:function(e,t){return 39===t},action:function(){var e=hr(t.formula,t.start,"'","'"),r=t.formula[e.end+1].charCodeAt(0);if(e.isError)throw new Error("token:"+t.formula.slice(t.start,e.end));if(!ar(r))throw new Error("token:"+t.formula.slice(t.start,e.end+1));t.start=e.end+1;var n=new at("'"+e.result+"'",Qe.SHEET);t.tokenStack.push(n)}},{match:function(e,t){return ar(t)},action:function(){if(""===t.value)throw new Error(""+t.formula);var e=new at(t.value,Qe.SHEET);t.tokenStack.push(e),t.value=""}},{match:function(e,t){return 35===t},action:function(e){if(t.value.length>0)throw new Error("token:"+t.value+e);var r=function(e,t){for(var r=Qt.length,n=!0,a="",o=0;o<r;o++){var i=Qt[o];if(t+i.length<=e.length){var u=e.slice(t,t+i.length);if(u===i){t+=i.length,a=u,n=!1;break}}}return{result:a,end:t,isError:n}}(t.formula,t.start);if(r.isError)throw new Error("token:"+t.formula.slice(t.start));t.start=r.end-1;var n=new at(r.result,Qe.ERROR);t.tokenStack.push(n)}},{match:function(e,t){return 13===t||10===t},action:function(){}},{match:function(){return!0},action:function(e){t.value+=e}}],this.formula=e}var t=e.prototype;return t.traverseFormula=function(){for(var e=this.formula.length;this.start<e;this.start++)for(var t=this.formula[this.start],r=t.charCodeAt(0),n=0;n<this.strateyies.length;n++){var a=this.strateyies[n];if(a.match(t,r)){a.action(t);break}}if(this.value.length>0){var o=fr(this.value);if(o.isError)throw new Error("token:"+this.value);var i=new at(this.value,o.tokenType);this.tokenStack.push(i)}},t.getTokenStack=function(){return this.tokenStack},e}();function tr(e){return e>=48&&e<=57}function rr(e){return"."===e}function nr(e){return e>=97&&e<=122||e>=65&&e<=90}function ar(e){return 33===e}function or(e){return{"&":!0,"=":!0,"<":!0,">":!0,"+":!0,"-":!0,"*":!0,"/":!0,"%":!0,"^":!0,":":!0,"(":!0,")":!0,",":!0," ":!0}[e]}function ir(e,t){for(var r=e;" "===t[r];)r+=1;return r-1}var ur=function(e){var t=new er(e);return t.traverseFormula(),t.getTokenStack()};function sr(e,t,r,n,a){for(var o=e.length,i=0;r<o&&t(e[r].charCodeAt(0));r++)i+=1;return{accept:i>=n&&i<=a,end:r}}var lr=function(e,t){var r=sr(e,nr,t+1,0,2),n=1;return r.accept||(n=6),{state:n,idx:r.end-1}},cr=function(e,t){var r=sr(e,tr,t+1,0,5),n=7;return r.end-t>=7&&Number(e.slice(t,r.end))>1048576&&(n=6),{state:n,idx:r.end-1}},fr=function(){var e={1:Qe.COL,6:Qe.VARIABLE,7:Qe.CELL,8:Qe.ROW},t=[[lr,2,,6],[,5,cr,6],[lr,,function(e,t){return{state:8,idx:sr(e,tr,t+1,0,5).end-1}}],[],[],[,,function(e,t){return{state:7,idx:sr(e,tr,t+1,0,5).end-1}}],[6,,6,6],[6,,,6],[]];return function(r){for(var n=0,a=0,o=!1,i=r.length;a<i;a++){var u,s=r[a];u=nr(s.charCodeAt(0))?0:X(s)?2:"$"===s?1:3;var l=t[n][u],c=typeof l;if("number"===c)n=l;else{if("function"!==c){o=!0;break}var f=l(r,a);if(void 0===f){o=!0;break}n=f.state,a=f.idx}}return{tokenType:e[n]||Qe.UNKNOW,isError:o}}}(),dr=function(){var e=[[1,2],[1,2,4],[3,,4],[3,,4],[6,,,5],[6],[6]],t={1:!0,3:!0,6:!0},r=0;return function(n,a){r=0;for(var o="",i=n.length,u=a;u<i;u++){var s,l=n[u];s=tr(l.charCodeAt(0))?0:rr(l)?1:"E"===l||"e"===l?2:"+"===l||"-"===l?3:4;var c=e[r][s];if(void 0===c)break;o+=l,r=c}var f=u;return u-=1,{result:o,end:f,isError:!t[r]}}}();function hr(e,t,r,n){for(var a=e.length,o="",i=!0,u=!1;t<a;t++){var s=e[t];if(u||s!==r){if(u&&s===n){if(e[t+1]===s){t+=1,o+=s;continue}i=!1;break}u&&(o+=s)}else u=!0}return{result:o,end:t,isError:i}}var mr,gr,pr=function(){function e(e){this.context=e}var t=e.prototype;return t.parse=function(e,t){this.idx=0,this.stack=[],this.context.element=t,this.tokens=ur(e),this.expression(!0);var r=this.stack[this.stack.length-1],n=ee(t.id),a=Xt(this.context,n,t.sheetId,n,I.NONE);return a.setBody(r),a.setFormula(e),a},t.llkMatchType=function(e,t){var r=this.tokens[this.idx+t];return r&&r.type===e},t.llkMatchTypeAndChar=function(e,t,r){var n=this.tokens[this.idx+r];return n&&n.value===t&&n.type===e},t.matchType=function(e){return this.llkMatchType(e,0)},t.matchTypeAndChar=function(e,t){return this.llkMatchTypeAndChar(e,t,0)},t.advance=function(){this.idx+=1},t.back=function(){this.idx-=1},t.currentTokenValue=function(){return this.tokens[this.idx].value},t.isGTorLTorNotEqual=function(e,t){return">"===e&&"="===t||"<"===e&&("="===t||">"===t)},t.expression=function(e){this.expression1(),this.expression0(e)},t.expression1=function(){this.expression2(),this.expression21()},t.expression0=function(e){if(this.matchPriorityOperation0()){var t=this.currentTokenValue();if(this.advance(),this.idx>=this.tokens.length)throw new Error("expected expressionbut got empty");var r=this.currentTokenValue();if(this.isGTorLTorNotEqual(t,r)&&(this.advance(),t+=r),this.expression1(),this.stack.length<2)throw new Error("expected expressionbut got empty");var n=qt(this.context,t,A.BINARY),a=this.stack[this.stack.length-2],o=this.stack[this.stack.length-1],i=zt(this.context,"LOGICMATCH",[a,o,n]);this.stack.pop(),this.stack.pop(),this.stack.push(i),this.expression0()}else if(e&&this.idx!==this.tokens.length)throw new Error("expected operation, but got "+this.currentTokenValue())},t.expression21=function(){if(this.matchTypeAndChar(Qe.SEPARATOR,"&")){var e=this.currentTokenValue();if(this.advance(),this.expression2(),this.stack.length<2)throw new Error("expected expressionbut got empty");var t=qt(this.context,e,A.BINARY),r=this.stack[this.stack.length-2],n=this.stack[this.stack.length-1],a=zt(this.context,"SPECIALMATCH",[r,n,t]);this.stack.pop(),this.stack.pop(),this.stack.push(a),this.expression21()}},t.expression2=function(){this.expression3(),this.expression31()},t.expression31=function(){if(this.matchTypeAndChar(Qe.SEPARATOR,"+")||this.matchTypeAndChar(Qe.SEPARATOR,"-")){var e=this.currentTokenValue();if(this.advance(),this.expression3(),this.stack.length<2)throw new Error("expected expressionbut got empty");var t=qt(this.context,e,A.BINARY),r=this.stack[this.stack.length-2],n=this.stack[this.stack.length-1],a=zt(this.context,"MATHMATCH",[r,n,t]);this.stack.pop(),this.stack.pop(),this.stack.push(a),this.expression31()}},t.expression3=function(){this.expression4(),this.expression41()},t.expression41=function(){if(this.matchTypeAndChar(Qe.SEPARATOR,"*")||this.matchTypeAndChar(Qe.SEPARATOR,"/")){var e=this.currentTokenValue();if(this.advance(),this.expression4(),this.stack.length<2)throw new Error("expected expressionbut got empty");var t=qt(this.context,e,A.BINARY),r=this.stack[this.stack.length-2],n=this.stack[this.stack.length-1],a=zt(this.context,"MATHMATCH",[r,n,t]);this.stack.pop(),this.stack.pop(),this.stack.push(a),this.expression41()}},t.expression4=function(){if(this.matchTypeAndChar(Qe.SEPARATOR,"-")||this.matchTypeAndChar(Qe.SEPARATOR,"+")){var e=this.currentTokenValue();this.advance(),this.expression4();var t=this.stack[this.stack.length-1],r="-"===e?A.MINUS:A.NUM,n=qt(this.context,t,r,(function(t,r){t.push(e),this.originValueNode.toString(t,r)}));this.stack.pop(),this.stack.push(n)}else this.expression5(),this.expression51()},t.expression51=function(){if(this.matchTypeAndChar(Qe.SEPARATOR,"%")){this.advance();var e=this.stack[this.stack.length-1],t=qt(this.context,e,A.PERCENTAGE,(function(e,t){this.originValueNode.toString(e,t),e.push("%")}));this.stack.pop(),this.stack.push(t),this.expression51()}else if(this.matchTypeAndChar(Qe.SEPARATOR,"^")){var r=this.currentTokenValue();if(this.advance(),this.expression5(),this.stack.length<2)throw new Error("expected expressionbut got empty");var n=qt(this.context,r,A.BINARY),a=this.stack[this.stack.length-2],o=this.stack[this.stack.length-1],i=zt(this.context,"MATHMATCH",[a,o,n]);this.stack.pop(),this.stack.pop(),this.stack.push(i),this.expression51()}},t.expression5=function(){this.expression6(),this.expression61()},t.expression61=function(){},t.expression6=function(){if(this.matchTypeAndChar(Qe.SEPARATOR,"("))this.advance(),this.expression7();else if(this.lfFunction())this.function();else if(this.lfReference())this.reference(),this.matchTypeAndChar(Qe.SEPARATOR," ")&&this.cellRangeIntersectionSeq();else if(this.matchType(Qe.STRING)){var e=qt(this.context,'"'+this.currentTokenValue()+'"',A.STR);this.stack.push(e),this.advance()}else if(this.matchType(Qe.NUMBER)){var t=qt(this.context,this.currentTokenValue(),A.NUM);this.stack.push(t),this.advance()}else if(this.lfVariable())this.variable();else if(this.matchType(Qe.ERROR)){var r=qt(this.context,this.currentTokenValue(),A.ERROR);this.stack.push(r),this.advance()}},t.cellRangeIntersectionSeq=function(){this.cellRangeIntersectionSeq1()},t.cellRangeIntersectionSeq1=function(){this.matchTypeAndChar(Qe.SEPARATOR," ")&&(this.stack.push(this.currentTokenValue()),this.advance(),this.reference(),this.newCellRangeIntersection(),this.cellRangeIntersectionSeq1())},t.newCellRangeIntersection=function(){var e=x.INTERSECTION,t=this.stack[this.stack.length-3],r=this.stack[this.stack.length-1],n=Kt(this.context,t,r,e);return this.stack.pop(),this.stack.pop(),this.stack.pop(),this.stack.push(n),n},t.function=function(){if(this.stack.push(this.currentTokenValue()),this.advance(),!this.matchTypeAndChar(Qe.SEPARATOR,"("))throw new Error("expected (but got"+this.currentTokenValue());if(this.stack.push(this.currentTokenValue()),this.advance(),this.matchTypeAndChar(Qe.SEPARATOR,")"))this.stack.push([]),this.stack.push(this.currentTokenValue()),this.advance(),this.newFunctionNode();else{if(this.expseq(),!this.matchTypeAndChar(Qe.SEPARATOR,")"))throw new Error("expected )but got"+this.currentTokenValue());this.stack.push(this.currentTokenValue()),this.advance(),this.newFunctionNode()}},t.newFunctionNode=function(){var e=this.stack[this.stack.length-4],t=this.stack[this.stack.length-2],r=zt(this.context,e,t);this.stack.pop(),this.stack.pop(),this.stack.pop(),this.stack.pop(),this.stack.push(r)},t.variable=function(){if(!this.matchType(Qe.VARIABLE)&&!this.matchType(Qe.COL))throw new Error("expected VARIABLE or COLbut got"+this.currentTokenValue());var e=this.currentTokenValue(),t=qt(this.context,e,A.VARIABLE);this.stack.push(t),this.advance()},t.isCellOrRangeWithComma=function(){return this.lfCell()&&this.llkMatchTypeAndChar(Qe.SEPARATOR,",",1)||this.lfCellRange()&&this.llkMatchTypeAndChar(Qe.SEPARATOR,",",3)},t.expression7=function(){if(this.isCellOrRangeWithComma()?this.cellRangeConcatSeq():this.expression(),!this.matchTypeAndChar(Qe.SEPARATOR,")"))throw new Error("expected )but got"+this.currentTokenValue());this.advance();var e=this.stack[this.stack.length-1],t=qt(this.context,e,A.ORIGIN,(function(e,t){e.push("("),this.originValueNode.toString(e,t),e.push(")")}));this.stack.pop(),this.stack.push(t)},t.cellRangeConcatSeq=function(){this.reference(),this.cellRangeConcatSeq1()},t.cellRangeConcatSeq1=function(){this.matchTypeAndChar(Qe.SEPARATOR,",")&&(this.stack.push(this.currentTokenValue()),this.advance(),this.reference(),this.newCellRangeConcatSeq(),this.cellRangeConcatSeq1())},t.newCellRangeConcatSeq=function(){var e=x.CONCAT,t=this.stack[this.stack.length-3],r=this.stack[this.stack.length-1],n=Kt(this.context,t,r,e);return this.stack.pop(),this.stack.pop(),this.stack.pop(),this.stack.push(n),n},t.reference=function(){this.lfWildcardSheetNameReference()?this.wildcardReference():this.lfCell()?this.cell():this.cellRange()},t.wildcardReference=function(){var e=this.currentTokenValue(),t=function(e,t){function r(e,t){var r=null;if(e[0]===t)r=[{startSheetName:e[1],endSheetName:e[e.length-1]}];else if(e[e.length-1]===t)r=[{startSheetName:e[0],endSheetName:e[e.length-2]}];else{var n=e.indexOf(t);r=[{startSheetName:e[0],endSheetName:e[n-1]},{startSheetName:e[n+1],endSheetName:e[e.length-1]}]}return r}var n=e.getSheetNames();if(1===n.length)throw new Error("sheet is not enough");var a=jt(t),o=e.getSheetNameBySheetId(e.element.sheetId),i=null;if("*"===a)i=r(n,o);else{var u=a;u.indexOf("*")>=0&&(u=u.replace(/\*/g,"[\\w\\W]*")),u.indexOf("?")>=0&&(u=u.replace(/\?/g,"[\\w\\W]"));for(var s=new RegExp("^"+u+"$","i"),l=[],c=0;c<n.length;c++){var f=n[c];s.test(f)&&l.push(f)}-1===l.indexOf(o)&&l.push(o),i=r(l,o)}return i}(this.context,e);if(this.advance(),1===t.length){var r=t[0],n=r.startSheetName,a=r.endSheetName,o=new at("'"+(n===a?n:n+":"+a)+"'",Qe.SHEET);return this.back(),this.tokens[this.idx]=o,this.reference()}var i=t[0],u=i.startSheetName,s=i.endSheetName,l=new at("'"+(u===s?u:u+":"+s)+"'",Qe.SHEET),c=t[1],f=c.startSheetName,d=c.endSheetName,h=new at("'"+(f===d?f:f+":"+d)+"'",Qe.SHEET),m=new at(",",Qe.SEPARATOR);if(this.lfLocalCell()){var g=this.tokens[this.idx];this.back(),this.tokens[this.idx]=l,this.tokens.splice(this.idx+2,0,m,h,g)}else if(this.lfLocalCellRange()){var p=this.tokens[this.idx],v=this.tokens[this.idx+1],y=this.tokens[this.idx+2];this.back(),this.tokens[this.idx]=l,this.tokens.splice(this.idx+4,0,m,h,p,v,y)}return this.reference()},t.cell=function(){this.lfLocalCell()?this.localCell():this.lfSheetCell()&&this.sheetCell()},t.localCell=function(){var e=this.currentTokenValue(),t=I.NONE,r=Xt(this.context,e,this.context.element.sheetId,e,t);this.stack.push(r),this.advance()},t.sheetCell=function(){var e=this.currentTokenValue(),t=this.context.getSheetIdBySheetName(e);this.advance();var r=this.currentTokenValue();this.advance();var n=e+"!"+r,a=I.NORMAL,o=Xt(this.context,r,t,n,a);this.stack.push(o)},t.cellRange=function(){if(this.lfLocalCellRange())this.localCellRange();else if(this.lfSheetCellRange()){var e=this.currentTokenValue();if(e.indexOf(":")>=0){this.advance();var t=e.slice(1,e.length-1).split(":"),r=t[0],n=t[1],a=this.context.getSheetIdBySheetName(r),o=this.context.getSheetIdBySheetName(n);e+="!",this.isSheetSingleCell()?this.newThreeDimensionCellNode(e,a,o):this.threeDimensionCellRange({sheetName:e,startSheetId:a,endSheetId:o})}else this.sheetCellRange()}else if(this.lfThreeDimensionCellRange()){var i=this.currentTokenValue(),u=this.context.getSheetIdBySheetName(i,Bt.name);this.advance(),this.advance();var s=this.currentTokenValue(),l=this.context.getSheetIdBySheetName(s,Bt.name);this.advance();var c=i+":"+s+"!";this.threeDimensionCellRange({sheetName:c,startSheetId:u,endSheetId:l})}},t.localCellRange=function(){if(this.isSheetCellRangeNormal()){var e=w.NORMAL,t=I.NONE;this.newCellRangeNode(e,t,Jt)}else if(this.isSheetColRange()){var r=w.COL,n=I.NONE;this.newCellRangeNode(r,n,Jt)}else if(this.isSheetRowRange()){var a=w.ROW,o=I.NONE;this.newCellRangeNode(a,o,Jt)}else{if(!this.matchType(Qe.USERARRAY))throw new Error("expected cellRangebut got"+this.currentTokenValue());var i=this.currentTokenValue(),u=w.USER_RANGE,s=I.NONE,l="{"+i+"}",c=this.context.element.sheetId,f=Jt(this.context,{start:l,end:l,startSheetId:c,endSheetId:c,originValue:l,cellRangeType:u,crossTableType:s});this.stack.push(f),this.advance()}},t.sheetCellRange=function(){var e=this.currentTokenValue(),t=this.context.getSheetIdBySheetName(e);if(this.advance(),this.isSheetCellRangeNormal()){var r=w.NORMAL,n=I.NORMAL;this.newCellRangeNode(r,n,Jt,{startSheetId:t,endSheetId:t,sheetName:e+"!"})}else if(this.isSheetCellRangeNormalWithSheetName()){var a=w.NORMAL,o=I.NORMAL,i=this.currentTokenValue();this.advance();var u=this.currentTokenValue();this.advance(),this.advance();var s=this.currentTokenValue();this.advance();var l=e+i+u+e+s,c=Jt(this.context,{start:i,end:s,startSheetId:t,endSheetId:t,originValue:l,cellRangeType:a,crossTableType:o});this.stack.push(c)}else if(this.isSheetColRange()){var f=w.COL,d=I.NORMAL;this.newCellRangeNode(f,d,Jt,{startSheetId:t,endSheetId:t,sheetName:e+"!"})}else{if(!this.isSheetRowRange())throw new Error("expected cross table cellRangebut got"+this.currentTokenValue());var h=w.ROW,m=I.NORMAL;this.newCellRangeNode(h,m,Jt,{startSheetId:t,endSheetId:t,sheetName:e+"!"})}},t.isSheetSingleCell=function(e){return void 0===e&&(e=0),this.llkMatchType(Qe.CELL,e)&&!this.llkMatchTypeAndChar(Qe.SEPARATOR,":",e+1)},t.isSheetCellRangeNormal=function(e){return void 0===e&&(e=0),this.llkMatchType(Qe.CELL,e)&&this.llkMatchTypeAndChar(Qe.SEPARATOR,":",e+1)&&this.llkMatchType(Qe.CELL,e+2)},t.isSheetCellRangeNormalWithSheetName=function(e){return void 0===e&&(e=0),this.llkMatchType(Qe.CELL,e)&&this.llkMatchTypeAndChar(Qe.SEPARATOR,":",e+1)&&this.llkMatchType(Qe.SHEET,e+2)&&this.llkMatchType(Qe.CELL,e+3)},t.isSheetColRange=function(e){return void 0===e&&(e=0),this.llkMatchType(Qe.COL,e)&&this.llkMatchTypeAndChar(Qe.SEPARATOR,":",e+1)&&this.llkMatchType(Qe.COL,e+2)},t.isSheetRowRange=function(e){return void 0===e&&(e=0),(this.llkMatchType(Qe.ROW,e)||this.llkMatchType(Qe.NUMBER,e))&&this.llkMatchTypeAndChar(Qe.SEPARATOR,":",e+1)&&(this.llkMatchType(Qe.ROW,e+2)||this.llkMatchType(Qe.NUMBER,e+2))},t.newCellRangeNode=function(e,t,r,n){void 0===n&&(n={startSheetId:this.context.element.sheetId,endSheetId:this.context.element.sheetId,sheetName:""});var a=n,o=a.startSheetId,i=a.endSheetId,u=a.sheetName;this.stack.push(this.currentTokenValue()),this.advance(),this.stack.push(this.currentTokenValue()),this.advance(),this.stack.push(this.currentTokenValue()),this.advance();var s=this.stack[this.stack.length-3],l=this.stack[this.stack.length-2],c=this.stack[this.stack.length-1],f=u+s+l+c;this.stack.pop(),this.stack.pop(),this.stack.pop();var d=r(this.context,{start:s,end:c,startSheetId:o,endSheetId:i,originValue:f,cellRangeType:e,crossTableType:t});this.stack.push(d)},t.newThreeDimensionCellNode=function(e,t,r){var n=w.NORMAL,a=I.THREE_DIMENSION,o=this.currentTokenValue();this.advance();var i=e+o,u=Jt(this.context,{start:o,end:o,startSheetId:t,endSheetId:r,originValue:i,cellRangeType:n,crossTableType:a});this.stack.push(u)},t.threeDimensionCellRange=function(e){var t=e.startSheetId,r=e.endSheetId,n=e.sheetName;if(this.isSheetSingleCell())this.newThreeDimensionCellNode(n,t,r);else if(this.isSheetCellRangeNormal()){var a=w.NORMAL,o=I.THREE_DIMENSION;this.newCellRangeNode(a,o,Jt,{startSheetId:t,endSheetId:r,sheetName:n})}else if(this.isSheetColRange()){var i=w.COL,u=I.THREE_DIMENSION;this.newCellRangeNode(i,u,Jt,{startSheetId:t,endSheetId:r,sheetName:n})}else{if(!this.isSheetRowRange())throw new Error("expected cross table cellRangebut got"+this.currentTokenValue());var s=w.ROW,l=I.THREE_DIMENSION;this.newCellRangeNode(s,l,Jt,{startSheetId:t,endSheetId:r,sheetName:n})}},t.expseq=function(){var e=this.stack;if(this.stack=[],this.expression(),this.expseq1(),this.llkMatchTypeAndChar(Qe.SEPARATOR,",",-1)){var t=qt(this.context,"",A.PLACEHOLDER);this.stack.push(t)}e.push(this.stack),this.stack=e},t.expseq1=function(){if(this.matchTypeAndChar(Qe.SEPARATOR,",")){if(this.llkMatchTypeAndChar(Qe.SEPARATOR,"(",-1)||this.llkMatchTypeAndChar(Qe.SEPARATOR,",",-1)){var e=qt(this.context,"",A.PLACEHOLDER);this.stack.push(e)}this.advance(),this.expression(),this.expseq1()}},t.lfWildcardSheetNameReference=function(){var e=this.currentTokenValue();return this.matchType(Qe.SHEET)&&(-1!==e.indexOf("*")||-1!==e.indexOf("?"))},t.lfCell=function(){return this.lfLocalCell()||this.lfSheetCell()},t.lfLocalCell=function(){return this.matchType(Qe.CELL)&&!this.llkMatchTypeAndChar(Qe.SEPARATOR,":",1)},t.lfSheetCell=function(){var e=this.currentTokenValue();return this.matchType(Qe.SHEET)&&-1===e.indexOf(":")&&this.llkMatchType(Qe.CELL,1)&&!this.llkMatchTypeAndChar(Qe.SEPARATOR,":",2)},t.lfCellRange=function(){return this.lfLocalCellRange()||this.lfSheetCellRange()||this.lfThreeDimensionCellRange()},t.lfLocalCellRange=function(){return this.isSheetCellRangeNormal()||this.isSheetColRange()||this.isSheetRowRange()||this.matchType(Qe.USERARRAY)},t.lfSheetCellRange=function(){if(this.matchType(Qe.SHEET)){var e=this.currentTokenValue();return this.llkMatchType(Qe.CELL,1)&&!this.llkMatchTypeAndChar(Qe.SEPARATOR,":",2)&&e.indexOf(":")>=0||this.isSheetCellRangeNormalWithSheetName(1)||this.isSheetCellRangeNormal(1)||this.isSheetColRange(1)||this.isSheetRowRange(1)}return!1},t.lfThreeDimensionCellRange=function(){return!(!this.llkMatchTypeAndChar(Qe.SEPARATOR,":",1)||!this.llkMatchType(Qe.SHEET,2))&&(this.isSheetSingleCell(3)||this.isSheetCellRangeNormal(3)||this.isSheetColRange(3)||this.isSheetRowRange(3))},t.lfFunction=function(){return(this.matchType(Qe.VARIABLE)||this.matchType(Qe.COL)||this.matchType(Qe.CELL))&&this.llkMatchTypeAndChar(Qe.SEPARATOR,"(",1)},t.lfVariable=function(){return this.matchType(Qe.VARIABLE)||this.matchType(Qe.COL)&&!this.llkMatchTypeAndChar(Qe.SEPARATOR,":",1)},t.lfReference=function(){return this.lfCell()||this.lfCellRange()},t.matchPriorityOperation0=function(){var e=this.tokens[this.idx];return e&&("="===e.value||"<"===e.value||">"===e.value)},e}(),vr=function(){function e(e){var t=this;this.parse=function(e,r){var n,a,o=null;try{var i=e;n=t.parser.parse(i,r);var u=bt.getAsyncFunctionNodeList();u.length>0&&(n.setAsyncFunctionNodeList(u),bt.cleanAsyncFunctionNodeList()),bt.setCell(r.sheetId,r.row,r.col,n)}catch(e){Lt("",e),a=Gt(e.message),o=e.prop,n={error:a,errorProp:o,value:n}}return n},this.processInjectFunctions(e),this.parser=new pr(e)}return e.prototype.processInjectFunctions=function(e){var t=e.getSheetIdBySheetName;e.getSheetIdBySheetName=function(e,r){void 0===e&&(e=""),void 0===r&&(r=Bt.ref);var n=jt(e),a=t(n);if(!a)throw new Error(r);return a}},e}(),yr=g(8045),Nr=g(2021),Mr=g(8177),Rr=g.n(Mr),_r=function(e){var t={};return g.d(t,e),t}({SUPPORT_CURRENCY_LIST:function(){return l.SUPPORT_CURRENCY_LIST},getCellNumberFormatType:function(){return l.getCellNumberFormatType},getDefaultNumberFormat:function(){return l.getDefaultNumberFormat},getNumberFormatByFormatCode:function(){return l.getNumberFormatByFormatCode},isNumeric:function(){return l.isNumeric}}),Er={name:"en",weekdays:"SUNDAY_MONDAY_TUESDAY_WEDNESDAY_THURSDAY_FRIDAY_SATURDAY".split("_"),weekdaysShort:"SUN_MON_TUE_WED_THU_FRI_SAT".split("_"),months:"JANUARY_FEBRUARY_MARCH_APRIL_MAY_JUNE_JULY_AUGUST_SEPTEMBER_OCTOBER_NOVEMBER_DECEMBER".split("_"),monthsShort:"JAN_FEB_MAR_APR_MAY_JUN_JUL_AUG_SEP_OCT_NOV_DEC".split("_")},Tr={name:"zh-cn",weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),months:"___________".split("_"),monthsShort:"1_2_3_4_5_6_7_8_9_10_11_12".split("_")};(gr=mr||(mr={}))[gr.NUMBER=0]="NUMBER",gr[gr.STRING=1]="STRING",gr[gr.BOOL=2]="BOOL",gr[gr.FORMULA=3]="FORMULA";var Sr,Cr,Ir=mr;(Cr=Sr||(Sr={})).GENERAL="auto",Cr.TEXT="text",Cr.NUMBER="number",Cr.PERCENT="percent",Cr.CURRENCY="currency",Cr.DATE="date",Cr.TIME="time",Cr.DATE_TIME="date-time",Cr.FRACTION="fraction",Cr.SCIENTIFIC="scientific",Cr.ACCOUNTING="accounting",Cr.SPECIAL="special",Cr.CUSTOM="custom";var Ar=Sr;function wr(e,t){return function(e,t){if("string"==typeof e){var r,n,a=(e=e.replace(/\//g,"-")).match(/\s*[0-9a-zA-Z](\s+)[0-9aApP]+/);if(a&&a[0]&&a[1]){var o=a.index+1,i=e.substring(0,o);if(!/^\s+/.test(i)){i=i.replace(/\s/g,"");var u=e.substring(o,e.length).replace(/\s/g,"");u=function(e){var t=e,r=(e=e.replace(/\s/g,"")).length,n=e.substring(r-2,r).toUpperCase(),a=e[r-1].toUpperCase();return-1!==["AM","PM","",""].indexOf(n)?e.substring(0,r-2)+" "+n:-1!==["A","P"].indexOf(a)?e.substring(0,r-1)+" "+a:t}(u);var s=Yr(i),l=Hr(u);if(s&&l&&0!==s.moment.year()){var c=s.moment.format("YYYY-MM-DD")+"T"+l.moment.format("HH:mm:ss")+"+08:00",f=zr(c);return f>0&&(n=Kr(f,t)),void 0!==n?(r="yyyy/m/d h:mm",l.pattern&&-1!==l.pattern.indexOf("s")&&(r="yyyy/m/d h:mm:ss;@"),{type:Ar.DATE_TIME,pattern:r,numericValue:n,valueType:Ir.NUMBER}):void 0}}}}}(e,t)||Yr(e,t)||Hr(e,t)}function xr(e,t){return jr(e,t)||$r(e,t)||Wr(e,t)||Xr(e,t)||Vr(e,t)||Pr(e,t)||wr(e,t)||{numericValue:e}}function Dr(e){return null==(t=e.value)||""===t||/\n/.test(t)?{isSuccess:!0,data:void 0}:{isSuccess:!1};var t}function br(e){return"number"==typeof e.value?{isSuccess:!0,data:{newValue:e.value,type:e.numberFormatType.type,pattern:e.numberFormat.pattern,numericValue:e.value,valueType:Ir.NUMBER}}:{isSuccess:!1}}function Or(e){return e.numberFormatType.type===Ar.TEXT?{isSuccess:!0,data:{newValue:e.value,type:Ar.TEXT,pattern:"@",numericValue:e.value,valueType:Ir.STRING}}:{isSuccess:!1}}function Fr(e){return"string"==typeof e.value&&"="===e.value[0]&&e.value.length>1?{isSuccess:!0,data:{newValue:e.value,type:e.numberFormatType.type,pattern:e.numberFormat.pattern,numericValue:e.value,valueType:Ir.FORMULA}}:{isSuccess:!1}}function Ur(e,t){return 0===e.parseMode&&/^[-]?(0|[1-9][0-9]*)(\.[0-9]*)?$/.test(e.value)?{isSuccess:!0,data:{newValue:Kr(e.value,t),type:e.numberFormatType.type,pattern:e.numberFormat.pattern,numericValue:Kr(e.value,t),valueType:Ir.NUMBER}}:{isSuccess:!1}}function Lr(e,t){var r=function(e,t){var r=t&&t.numberFormat;if("string"==typeof(e=e||"")){var n,a=(0,_r.getCellNumberFormatType)(r).group;if(n=e.match(/^(\d+)\/(\d*[1-9]\d*)$/))switch(a){case Ar.FRACTION:n=Pr(e,t);break;case Ar.NUMBER:(n=Pr(e,t))&&(n.type=Ar.NUMBER,n.pattern="0.00_);[Red](0.00)");break;default:n=Yr(e,t)}return n?{originValue:e,numericValue:n.numericValue,type:n.type,pattern:n.pattern,valueType:n.valueType}:void 0}}(e.value,t)||jr(e.value,t)||$r(e.value,t)||Wr(e.value,t)||Xr(e.value,t)||Vr(e.value,t)||Pr(e.value,t)||wr(e.value,t),n=void 0!==r?r.numericValue:e.value,a=void 0!==r?r.valueType:Ir.STRING,o=function(e,t){var r,n;if(t&&1===e.parseMode){var a=(0,_r.getCellNumberFormatType)(t.pattern);t.type===Ar.NUMBER?kr(e.numberFormatType.group)||e.numberFormatType.group===Ar.GENERAL?(r=Ar.GENERAL,n="General"):(r=e.numberFormatType.type,n=e.numberFormat.pattern):kr(e.numberFormatType.group)&&e.numberFormatType.group===a.group||e.numberFormatType.type===t.type?(r=e.numberFormatType.type,n=e.numberFormat.pattern):(r=t.type,n=t.pattern)}else 0===e.parseMode&&e.numberFormatType.type===Ar.GENERAL&&t&&t.type!==Ar.NUMBER?(r=t.type,n=t.pattern):(r=e.numberFormatType.type,n=e.numberFormat.pattern);return{type:r,pattern:n}}(e,r);return{isSuccess:!0,data:{newValue:n,type:o.type,pattern:o.pattern,numericValue:n,valueType:a}}}var Br=function(e,t,r){var n=(null==r?void 0:r.parseMode)||0;try{t=t||(0,_r.getDefaultNumberFormat)(),r&&(r.numberFormat=t);for(var a,o,i,u=(0,_r.getCellNumberFormatType)(t),s=e,l={value:e,numberFormat:t,numberFormatType:u,parseMode:n},c=[Dr,br,Or,Fr,Ur,Lr];i=c.shift();)if((o=i.apply(this,[l,r])).isSuccess){a=o.data;break}var f=o.data||{newValue:e},d=f.newValue,h=f.pattern;return d!==-1/0&&d!==1/0&&a||(d=e,h=t.pattern),t=(0,_r.getNumberFormatByFormatCode)(h),null==d&&(d=""),{originValue:s,value:d,numberFormat:t,valueType:a?a.valueType:Ir.STRING}}catch(t){console.warn(t);var m=e;return null==m&&(m=""),{originValue:e,value:m,numberFormat:(0,_r.getDefaultNumberFormat)(),valueType:Ir.STRING}}};function kr(e){switch(e){case Ar.DATE:case Ar.TIME:case Ar.DATE_TIME:return!0}return!1}function Pr(e,t){var r=t&&t.numberFormat,n=/^\s*[(]\s*((\d+\s)?(\d+)\/(\d*[1-9]\d*))\s*[)]\s*$/.exec(e);n&&n[1]&&(e="-"+n[1]);var a=e&&"string"==typeof e&&e.match(/^([+-]?\s*)(\d+\s)?(\d+)\/(\d*[1-9]\d*)$/),o=(0,_r.getCellNumberFormatType)(r).group;if(a&&a[3]&&a[4]){var i=new(Ne())(a[3]),u=new(Ne())(a[4]),s=!(!a[1]||"-"!==a[1].trim());if(i.greaterThan(32767)||u.greaterThan(32767))return;var l=a[4].length,c=i.div(u),f=!!a[2];if(f){var d=new(Ne())(a[2].trim());c=c.plus(d)}else if(o===Ar.GENERAL||0===u.toNumber()||!f&&0===i.toNumber())return;s&&(c=c.mul(-1));var h=new Array(l+1).join("?"),m="# "+h+"/"+h;return{type:Ar.FRACTION,pattern:m,numericValue:c.toNumber(),valueType:Ir.NUMBER}}}function Gr(e,t,r){return void 0===t&&(t=!0),t&&void 0!==r&&(e=-1!=="P_PM_".split("_").indexOf(r.toUpperCase())?(Number(e)%12+12).toString():(Number(e)%12+0).toString()),e&&e.length<2&&(e="0"+e),e}function Hr(e,t){if("string"==typeof e){var r,n=function(e){var t;if(t=e.match(/^\s*([0-9]{1,2})\s*:\s*([0-9]{1,2})\s*:\s*([0-9]{1,2})(\.(\d+))?\s*$/)){var r=[{dateTime:"1970-01-01T"+Gr(t[1])+":"+Gr(t[2])+":"+Gr(t[3])+"."+(t[5]||0)+"+0800",targetFormat:void 0===t[5]?"h:mm:ss;@":"h:mm:ss.0"}];return qr.instance().parseMoment(r)}if(t=e.match(/^\s*([0-9]{1,2})\s*:\s*([0-9]{1,2})(\.(\d+))?\s*$/)){var n,a,o;void 0===t[4]?(n=Gr(t[1]),a=Gr(t[2]),o="00"):(n="00",a=Gr(t[1]),o=Gr(t[2]));var i=[{dateTime:"1970-01-01T"+n+":"+a+":"+o+"."+(t[4]||0)+"+0800",targetFormat:void 0===t[4]?"h:mm;@":"mm:ss.0"}];return qr.instance().parseMoment(i)}return!1}(e=e.replace(//g,":"))||function(e){var t;if(t=e.match(/^([0-9]{1,2})\s*:\s*([0-9]{1,2})\s*:\s*([0-9]{1,2})(\.(\d+))?\s+(A|AM|P|PM||)\s*$/i)){var r=[{dateTime:"1970-01-01T"+Gr(t[1],!0,t[6])+":"+Gr(t[2])+":"+Gr(t[3])+"."+(t[5]||0)+"+0800",targetFormat:void 0===t[5]?"[$-409]h:mm:ss\\ AM/PM;@":"h:mm:ss.0"}];return qr.instance().parseMoment(r)}if(t=e.match(/^([0-9]{1,2})\s*:\s*([0-9]{1,2})(\.(\d+))?\s+(A|AM|P|PM||)$/i)){var n,a,o;void 0===t[4]?(n=Gr(t[1],!0,t[5]),a=Gr(t[2]),o="00"):(n=Gr("00",!0,t[5]),a=Gr(t[1]),o=Gr(t[2]));var i=[{dateTime:"1970-01-01T"+n+":"+a+":"+o+"."+(t[4]||0)+"+0800",targetFormat:void 0===t[4]?"[$-409]h:mm AM/PM;@":"mm:ss.0"}];return qr.instance().parseMoment(i)}return!1}(e)||function(e){var t;if(t=e.match(/^\s*(A|AM|P|PM||)([0-9]{1,2})([0-9]{1,2})\s*$/i)){var r=[{dateTime:"1970-01-01T"+Gr(t[2],!0,t[1])+":"+Gr(t[3])+":00.0+0800",targetFormat:Nr.default.t('/h""mm"";@')}];return qr.instance().parseMoment(r)}if(t=e.match(/^\s*(A|AM|P|PM||)([0-9]{1,2})([0-9]{1,2})([0-9]{1,2})\s*$/i)){var n=[{dateTime:"1970-01-01T"+Gr(t[2],!0,t[1])+":"+Gr(t[3])+":"+Gr(t[4])+".0+0800",targetFormat:Nr.default.t('/h""mm""ss"";@')}];return qr.instance().parseMoment(n)}return!1}(e)||function(e){var t;if(t=e.match(/^\s*([0-9]{1,2})([0-9]{1,2})([0-9]{1,2})$/i)){var r=[{dateTime:"1970-01-01T"+Gr(t[1])+":"+Gr(t[2])+":"+Gr(t[3])+".0+0800",targetFormat:Nr.default.t('h""mm""ss"";@')}];return qr.instance().parseMoment(r)}if(t=e.match(/^\s*([0-9]{1,2})([0-9]{1,2})\s*$/i)){var n=[{dateTime:"1970-01-01T"+Gr(t[1])+":"+Gr(t[2])+":00.0+0800",targetFormat:Nr.default.t('h""mm"";@')}];return qr.instance().parseMoment(n)}}(e);if(null==n?void 0:n.moment){if("1970-01-01"!==n.moment.format("YYYY-MM-DD"))return;var a=n.moment.format("HH:mm:ss.SSS");r=zr("1899-12-31T"+a+"+08:00")}return void 0!==r?(r=Kr(r,t),{type:Ar.TIME,pattern:n&&n.pattern,numericValue:r,valueType:Ir.NUMBER,moment:n&&n.moment}):void 0}}function Yr(e,t){if("string"==typeof e){var r,n=function(e){var t;if(t=e.match(/^([0-9]{1,4})\s*-\s*([0-9]{1,4})\s*-\s*([0-9]{1,4})\s*$/)){var r=[{dateTime:qr.instance().getFullYear(t[1])+"-"+t[2]+"-"+t[3],targetFormat:"yyyy/m/d"},{dateTime:qr.instance().getFullYear(t[3])+"-"+t[1]+"-"+t[2],targetFormat:"m/d/yyyy"}];return qr.instance().parseMoment(r)}if(t=e.match(/^([0-9]{0,4})\s*-\s*([0-9]{1,4})\s*$/)){var n=Number(t[1]);if(n>=0&&n<=99&&t[1].length<=2||n>=1900){var a=[{dateTime:qr.instance().getFullYear()+"-"+t[1]+"-"+t[2],targetFormat:Nr.default.t('m""d"";@')},{dateTime:qr.instance().getFullYear()+"-"+t[2]+"-"+t[1],targetFormat:Nr.default.t('m""d"";@')},{dateTime:qr.instance().getFullYear(t[1])+"-"+t[2]+"-1",targetFormat:"mmm-yy"}];return qr.instance().parseMoment(a)}}return!1}(e=e.replace(/\//g,"-"))||function(e){var t;if(t=e.match(/^\s*([0-9]{1,4})([0-9]{1,4})([0-9]{1,4})\s*$/)){var r=[{dateTime:qr.instance().getFullYear(t[1])+"-"+t[2]+"-"+t[3],targetFormat:Nr.default.t('yyyy""m""d"";@')}];return qr.instance().parseMoment(r)}if(t=e.match(/^\s*([0-9]{1,4})([0-9]{1,4})\s*$/)){var n=[{dateTime:qr.instance().getFullYear(t[1])+"-"+t[2]+"-1",targetFormat:Nr.default.t('yyyy""m"";@')}];return qr.instance().parseMoment(n)}if(t=e.match(/^\s*([0-9]{1,4})([0-9]{1,4})\s*$/)){var a=[{dateTime:qr.instance().getFullYear()+"-"+t[1]+"-"+t[2],targetFormat:Nr.default.t('m""d"";@')}];return qr.instance().parseMoment(a)}return!1}(e)||function(e){var t;if(t=e.match(/^([0-9]{1,4})\s*-\s*((JAN|FEB|MAR|APR|MAY|JUN|JUL|AUG|SEP|OCT|NOV|DEC)[A-Z]*)\s*-\s*([0-9]{1,4})\s*$/i)){var r=[{dateTime:qr.instance().getFullYear(t[4])+"-"+qr.instance().getMonthNum(t[2],"en")+"-"+t[1],targetFormat:"[$-409]d-mmm-yy;@"}];return qr.instance().parseMoment(r)}if(t=e.match(/^((JAN|FEB|MAR|APR|MAY|JUN|JUL|AUG|SEP|OCT|NOV|DEC)[A-Z]*)\s*-\s*([0-9]{1,4})\s*$/i)){var n=qr.instance().getMonthNum(t[1],"en"),a=[{dateTime:qr.instance().getFullYear()+"-"+n+"-"+t[3],targetFormat:"d-mmm"},{dateTime:qr.instance().getFullYear(t[3])+"-"+n+"-1",targetFormat:"mmm-yy"}];return qr.instance().parseMoment(a)}if(t=e.match(/^\s*([0-9]{1,4})\s*-\s*((JAN|FEB|MAR|APR|MAY|JUN|JUL|AUG|SEP|OCT|NOV|DEC)[A-Z]*)\s*$/i)){var o=qr.instance().getMonthNum(t[2],"en"),i=[{dateTime:qr.instance().getFullYear()+"-"+o+"-"+t[1],targetFormat:"d-mmm"}];return qr.instance().parseMoment(i)}return!1}(e)||function(e){var t;if(t=e.match(/^([0-9]{2,4})\s*\.\s*([0-9]{1,2})\s*\.\s*([0-9]{1,2})\s*$/)){var r=[{dateTime:qr.instance().getFullYear(t[1])+"-"+t[2]+"-"+t[3],targetFormat:'yyyy"."m"."d'}];return qr.instance().parseMoment(r)}if(t=e.match(/^\s*([0-9]{1,4})([0-9]{1,4})([0-9]{1,4})\s*$/)){var n=[{dateTime:qr.instance().getFullYear(t[1])+"-"+t[2]+"-"+t[3],targetFormat:Nr.default.t('yyyy""m""d""')}];return qr.instance().parseMoment(n)}if(t=e.match(/^\s*([0-9]{1,4})([0-9]{1,4})\s*$/)){var a=[{dateTime:qr.instance().getFullYear()+"-"+t[1]+"-"+t[2],targetFormat:Nr.default.t('m""d""')}];return qr.instance().parseMoment(a)}return!1}(e);if(n&&n.moment){if(0===n.moment.year())return;var a=n.moment.format("YYYY-MM-DDTHH:mm:ss.SSS+08:00"),o=zr(a);o>0&&(r=Kr(o,t))}return void 0!==r?{type:Ar.DATE,pattern:n&&n.pattern,numericValue:r,valueType:Ir.NUMBER,moment:n&&n.moment}:void 0}}function jr(e,t){var r=/^\s*[(]\s*((\d+(\.\d+)?)|(\.\d+))\s*[)]\s*$/.exec(e);if(r&&r[1]&&(e="-"+r[1]),/^\s*[+-]?\s*((\d+(\.\d*)?)|(\.\d+))\s*$/.test(e))return e=Kr(e=e.replace(/\s/g,""),t),{type:Ar.NUMBER,pattern:"0.00_);[Red](0.00)",numericValue:e,valueType:Ir.NUMBER}}function Vr(e,t){var r=/^\s*[(]\s*(\d{1,3}([,]\d{3})+(\.\d*)?)*\s*[)]\s*$/.exec(e);if(r&&r[1]&&(e="-"+r[1]),r=/^\s*[+-]?\s*((\d{1,3})([,]\d{3})+(\.\d*)?)\s*$/.exec(e)){var n="#,##0";-1!==(e=e.replace(/[,\s]/g,"")).indexOf(".")&&(n="#,##0.00");var a=e=Kr(e,t);if(/^0{1,3}$/.test(r[2]))return;return{type:"thousand_numeral",pattern:n,numericValue:a,valueType:Ir.NUMBER}}}function $r(e,t){if("string"==typeof e){var r,n=/^\s*[(]\s*((\d{1,3}([,]?\d{3})*(\.\d*)?)|(\.\d+))\s*%\s*[)]\s*$/.exec(e)||/^\s*[(]\s*((\d{1,3}([,]?\d{3})*(\.\d*)?)|(\.\d+))\s*[)]\s*%\s*$/.exec(e)||/^\s*[(]\s*%\s*((\d{1,3}([,]?\d{3})*(\.\d*)?)|(\.\d+))\s*[)]\s*$/.exec(e)||/^\s*%\s*[(]\s*((\d{1,3}([,]?\d{3})*(\.\d*)?)|(\.\d+))\s*[)]\s*$/.exec(e);n&&n[1]&&(e="-"+n[1]+"%");var a=-1!==e.indexOf(".");if(r=function(e){return/^\s*[+-]?\s*((\d{1,3}([,]?\d{3})*(\.\d*)?)|(\.\d+))\s*%\s*$/.test(e)?(e=e.replace(/\s/g,"")).substr(0,e.length-1):!(!/^\s*%\s*[+-]?\s*((\d{1,3}([,]?\d{3})*(\.\d*)?)|(\.\d+))\s*$/.test(e)&&!/^\s*[+-]?\s*%\s*((\d{1,3}([,]?\d{3})*(\.\d*)?)|(\.\d+))\s*$/.test(e))&&(-1!==(e=e.replace(/\s/g,"")).indexOf("+")?e.substr(2,e.length):-1!==e.indexOf("-")?"-"+e.substr(2,e.length):e.substr(1,e.length))}(e),/^\s*[(]\s*((\d+\s)?(\d+)\/(\d*[1-9]\d*)(%))\s*[)]\s*$/.test(e)||/^([+-]?\s*)(\d+\s)?(\d+)\/(\d*[1-9]\d*)(%)$/.test(e)){var o=Pr(e.replace(/%/g,""),t);null!=o&&(a="string"==typeof(r=o.numericValue)&&-1!==r.indexOf("."))}if("string"==typeof r){r=Kr(r=r.replace(/[,]/g,""),t),r=new(Ne())(r).div(100).toString();var i=a?"0.00%":"0%";return{type:Ar.PERCENT,pattern:i,numericValue:r,valueType:Ir.NUMBER}}}}Rr().prototype.parseTwoDigitYear=function(e){var t=(new Date).getFullYear()+11,r=parseInt(e,10);return r+2e3<=t?r+2e3:r+1900};var Zr=["$"];function Wr(e,t){if("string"==typeof e){e=e.toUpperCase();var r=/^\s*(\$|||HK\$|US\$)\s*[(]\s*((\d{1,3}([,]?\d{3})*(\.\d*)?)|(\.\d+))\s*[)]\s*$/.exec(e)||/^\s*[(]\s*(\$|||HK\$|US\$)\s*((\d{1,3}([,]?\d{3})*(\.\d*)?)|(\.\d+))\s*[)]\s*$/.exec(e);r&&r[1]&&r[2]&&(e="-"+r[1]+r[2]);for(var n=0;n<_r.SUPPORT_CURRENCY_LIST.length;n++){for(var a=_r.SUPPORT_CURRENCY_LIST[n],o=a.symbol,i=0;i<Zr.length;i++)o=o.replace(Zr[i],"\\"+Zr[i]);if(new RegExp("^\\s*[+-]?\\s*"+o+"\\s*[+-]?\\s*((\\d{1,3})([,]?\\d{3})*(\\.\\d*)?|(\\.\\d+))\\s*$").test(e)){e=e.replace(/\s/g,"").replace(a.symbol,"").replace(/[,]/g,"");var u=a.pattern;-1!==e.indexOf(".")&&(u=a.pattern_decimal);var s=Kr(e,t);if((0,_r.isNumeric)(s))return{type:a.type,pattern:u,numericValue:s,valueType:Ir.NUMBER}}}}}function Xr(e,t){if("string"==typeof e){var r=/^\s*[(]((\d{1,3}([,]?\d{3})*(\.\d*)?)|(\.\d+))E([+-]?\d+)[)]\s*$/.exec(e.toUpperCase());if(r&&r[1]&&r[6]&&(e="-"+r[1]+"E"+r[6]),(r=/^\s*[(]((\d{1,3}([,]?\d{3})*(\.\d*)?)|(\.\d+))E([+-]?\d+)\s*%\s*[)]\s*$/.exec(e.toUpperCase())||/^\s*[(]((\d{1,3}([,]?\d{3})*(\.\d*)?)|(\.\d+))E([+-]?\d+)[)]\s*%\s*$/.exec(e.toUpperCase()))&&r[1]&&r[6]&&(e="-"+r[1]+"E"+(Number(r[6])-2)),r=/^\s*([+-])?\s*((\d{1,3}([,]?\d{3})*(\.\d*)?)|(\.\d+))[Ee]([+-]?\d+)\s*(%\s*)?$/.exec(e)){var n=parseInt(r[7],10);if(r[8]?(n-=2,e=""+(r[1]?r[1]:"")+r[2]+"E"+(Number(r[7])-2)):e=""+(r[1]?r[1]:"")+r[2]+"E"+r[7],!(n>=308||n<=-310)){-309===n&&(e="0");var a=e=Kr(e=e.replace(/[,]/g,""),t);return{type:Ar.SCIENTIFIC,numericValue:a,pattern:"0.00E+00",valueType:Ir.NUMBER}}}}}function Kr(e,t){var r=function(e,t,r){t=t||15;var n=parseFloat(e);if(isNaN(n))return e;var a="",o=-1===(e=(e=""+e).trim()).indexOf("e")?e.indexOf("E"):e.indexOf("e");-1!==o&&(a=e.slice(o),e=e.slice(0,o));for(var i=e.split(""),u=0,s=0,l=!1,c=0;c<i.length;c++){var f=i[c];if("-"!==f||0!==c)if("."===f)l=!0,u>=t&&(i[c]="");else if(isNaN(parseInt(f,10)))i[c]="";else if(l){if(s+=1,(u>=t||u+s>t)&&(i[c]=""),!0===r&&u+s===t+1&&parseInt(f,10)>=5){var d=""===i[c-1]?c-2:c-1,h=parseInt(i[d],10);isNaN(h)||(i[d]=""+(h+1))}}else(u+=1)>t&&(i[c]="0"),!0===r&&u===t+1&&parseInt(f,10)>=5&&(i[c-1]=""+(parseInt(i[c-1],10)+1))}return i.join("")+a}(e,void 0,t&&t.toRound);return t&&t.toRound?r:function(e){if("number"==typeof e)return!1;if(!e)return!1;var t=e.indexOf(".");-1!==t&&(e=e.substr(0,t)+e.substr(t+1,e.length));var r=(e=(e=e.replace(/[+-]/,"")).toUpperCase()).indexOf("E");-1!==r&&(e=e.substr(0,r));var n=e.match(/^[0]*([1-9]([0-9]*[1-9])?)[0]*$/);return!!(n&&n[1].length>16)}(e)?e:parseFloat(e)}var zr=function(e,t){var r=(void 0===t?{}:t).need_1900_2_29,n=void 0!==r&&r,a=e,o=!1;/1900-0?2-29/.test(e)&&(a=e.replace("1900-2-29","1900-3-1"),o=!0);var i=(Date.parse(a)-Date.parse("1970-01-01T00:00:00.000+08:00"))/864e5+25568;return n&&(i=i>=60&&!o?i+1:i),i},qr=function(){function e(){this.supportLocales=new Map,this.supportLocales.set("en",Er),this.supportLocales.set("zh-cn",Tr)}e.instance=function(){return e._instance};var t=e.prototype;return t.getFullYear=function(e){if(!e)return(new Date).getFullYear().toString();if(e.length>=4)return e;var t=(new Date).getFullYear()+11,r=parseInt(e,10);return r+2e3<=t?r+2e3:r+1900},t.getMonthNum=function(e,t){var r=0;if(e.length<3)return r;var n=this.supportLocales.get(t);if(n){e=e.toUpperCase();for(var a=0;a<n.months.length;a++)if(n.months[a].startsWith(e)){r=a+1;break}}return r},t.parseMoment=function(e){for(var t=0;t<e.length;t++){var r=e[t],n=r.dateTime,a=Rr()(n);if(a.isValid())return{moment:a,pattern:r.targetFormat}}},e}();qr._instance=new qr;var Jr=function(e){var t;return t=ht(e)?e.toArray()[0]:e,(0,Ee.kE)(t)?"number"==typeof t?t:"string"==typeof e?Br(e).value:t:t},Qr=function(e){var t,r,n=e;if(ht(n)&&(n.isCell?(t=n.toArray(),n=t[0]):n=n.toArray()),Array.isArray(n))r=n.map((function(e){return-1*Br(e).value}));else{if(r=Jr(n),isNaN(r))return Bt.value;r*=-1}return r},en=function(e,t){void 0===e&&(e=""),void 0===t&&(t=Bt.ref);var r=jt(e),n=Vm.instance.getExternalMethod().getSheetIdBySheetName(r);if(!n)throw new Error(t);return n},tn=function(e,t,r){var n=rt.getFuncNode(),a=(null==n?void 0:n.funcName)||"",o=!Ot.JK[a],i=Vm.instance.getExternalMethod().cellValue(e,t,r);if("object"==typeof i&&i&&i.displayText)i=i.displayText;else if(""===i)""===Vm.instance.getExternalMethod().cellEditValue(e,t,r)&&(i=null);else if(o){var u=$t(i);Ot.vG[a]?(null==i?void 0:i.toString())===String(u)&&(i=u):i=u}return i};function rn(){var e,t=this.identities[0],r=tn(t.row,t.col,t.sheetId);Pt(r)&&(e=[r]);var n=[r];return n.error=e,n.rowCount=t.rowCount,n.colCount=t.colCount,n.rangeCount=1,n}function nn(){var e,t,r,n=bt.getCacheStatus(),a=this.identities,o=0,i=0,u=0,s=0,l=0,c=0,f=[],d=!1,h=n?bt.rangeCache:{},m=rt.getFuncNode(),g=(null==m?void 0:m.funcName)||"";f.error=[];for(var p=a.length,v=0;v<p;v++){var y,N=void 0;if(o=(y=a[v]).rowCount,i=y.colCount,e=y.sheetId,l=(u=y.row)+o,c=(s=y.col)+i,(d=o*i>1500)&&(N=h[r=u+"_"+s+"_"+o+"_"+i+"_"+e]),N)Array.prototype.push.apply(f,N);else{for(var M=!Ot.JK[g],R=u;R<l;R++)for(var _=s;_<c;_++){var E=Vm.instance.getExternalMethod().cellValue(R,_,e);if(E&&(0,yr.zH)(E))t=E.displayText;else if(""===E)t=""===Vm.instance.getExternalMethod().cellEditValue(R,_,e)?null:E;else if(M){t=E;var T=$t(E);Ot.vG[g]?(null==t?void 0:t.toString())===String(T)&&(t=T):t=T}else t=E;Pt(t)&&f.error.push(t),f.push(t)}d&&(h[r]=f)}}return f.rowCount=o,f.colCount=i,f.rangeCount=p,f.row=u,f.col=s,f}var an=function(e,t){void 0===t&&(t=!1);var r=e.value,n=Ot.kY[e.funcName];if(!t&&!n||t&&n){for(var a=e.args.length,o=[],i=0;i<a;i++){var u=e.args[i];u.setCalculateParentFunctionNode(e);var s=un(u);Ct(u)&&u.variableType===A.PLACEHOLDER&&(s=cn[e.funcName]?"":0),o.push(s)}try{r=function(e,t,r,n){void 0===t&&(t=[]);var a=e.toUpperCase(),o=Vm.instance.element,i=Vm.instance.formulas[a];if(i){rt.setAstNodes(r),rt.setFuncNode(n),o&&rt.setElement(o),rt.setInstance(Vm.instance);var u=Vt(i(t),15);return rt.clear(),u}throw console.error(a+""),new Error(Bt.name)}(e.funcName,o,e.args,e),function(e){var t=e.astNode;if(Ut()&&Tt(t)){var r=[];t.toString(r,{}),r.join("")}}({astNode:e,args:o,result:r})}catch(e){Lt(e),r=Gt(e.message)}"number"!=typeof r||isFinite(r)||(r=Bt.num)}return r},on=function(e){return nt(void 0,void 0,void 0,regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,an(e,!0);case 2:return r=t.sent,t.abrupt("return",(e.setValue(r),r));case 4:case"end":return t.stop()}}),t)})))},un=function e(t){var r=null;return gt(t)?r=function(e,t,r){var n={sheetId:t,row:r.row,col:r.col,rowCount:1,colCount:1,refType:w.CELL};return new ft([n],!0,rn)}(t.cellId,t.sheetId,t):Tt(t)?r=an(t):Et(t)?r=Nt(t)?function(e){var t=e.split(";"),r=[];return t.forEach((function(e){for(var t=e.split(","),n=0;n<t.length;n++){var a=t[n].trim(),o=Number(a);if(isNaN(o))if(a.startsWith('"')&&a.endsWith('"'))t[n]=a.slice(1,-1);else{if("TRUE"!==a&&"FALSE"!==a&&"true"!==a&&"false"!==a)throw new Error(Bt.value);t[n]="TRUE"===a.toUpperCase()}else t[n]=o}r.push(t)})),[r]}(t.start.slice(1,t.start.length-1)):function(e){var t,r,n=e.scope,a=n.row,o=n.col,i=n.rowCount,u=n.colCount,s=e.sheetIds,l=[];s.length>1&&(s=Vm.instance.getExternalMethod().getSheetIdsAmongTwoSheets(s[0],s[s.length-1]),e.updateSheetIds(s));var c=a,f=o;return s.forEach((function(n){t=Vm.instance.getExternalMethod().countRows(n),r=Vm.instance.getExternalMethod().countCols(n),l.push({row:c,col:f,rowCount:void 0===i?t-c:Math.min(i,t-c),colCount:void 0===u?r-f:Math.min(u,r-f),sheetId:n,refType:e.cellRangeType})})),new ft(l,!1,nn)}(t):_t(t)?r=function(t){t.leftRange.setCalculateParentFunctionNode(t.calculateParentFunctionNode),t.rightRange.setCalculateParentFunctionNode(t.calculateParentFunctionNode);var r,n=e(t.leftRange),a=e(t.rightRange);return t.binaryType===x.INTERSECTION?r=function(e,t){if(!ht(e)||!ht(t))return Bt.null;var r=e.identities[0],n=t.identities[0],a=r,o=n;r.row>n.row&&(o=r,a=n);var i=r,u=n;if(r.col>n.col&&(u=r,i=n),o.row>=a.row+a.rowCount||u.col>=i.col+i.colCount)return Bt.null;var s=u.col,l=o.row,c=r;r.row+r.rowCount>n.row+n.rowCount&&(c=n);var f=r;r.col+r.colCount>n.col+n.colCount&&(f=n);var d=c.row+c.rowCount-o.row,h=f.col+f.colCount-u.col,m=1===d&&1===h,g=m?rn:function(e){return void 0===e&&(e={}),ln(e,this.identities[0])},p=[{sheetId:r.sheetId,row:l,col:s,rowCount:d,colCount:h,refType:w.NORMAL}];return new ft(p,m,g)}(n,a):t.binaryType===x.CONCAT&&(r=function(e,t){var r=[];return Array.prototype.push.apply(r,e.identities),Array.prototype.push.apply(r,t.identities),new ft(r,!1,nn)}(n,a)),r}(t):Ct(t)&&(r=function(t){var r,n=t.originValueNode;switch(t.originValueNode instanceof ot&&(t.originValueNode.setCalculateParentFunctionNode(t.calculateParentFunctionNode),n=e(t.originValueNode)),t.variableType){case A.NUM:r=Jr(n);break;case A.PERCENTAGE:r=function(e){var t=Jr(e);return"number"!=typeof t||isNaN(t)?Bt.value:Vt(t*=.01,15)}(n);break;case A.MINUS:r=Qr(n);break;case A.STR:r=function(e){var t=e.slice(1,e.length-1),r=t.length-1,n=t;if(t.startsWith("(")&&t.endsWith(")")){var a=dr(t,1);a.isError||a.end!==r||(n=Qr(a.result))}return n}(n);break;case A.ORIGIN:r=n;break;case A.PLACEHOLDER:r="";break;case A.BINARY:case A.ERROR:r=n;break;case A.VARIABLE:r=function(e){if(e){var t=e.toUpperCase();return"TRUE"===t||"FALSE"!==t&&Bt.name}return Bt.name}(n)}return r}(t)),t.setValue(r),r},sn=function(e,t,r){return new ft(e,t,r||nn)},ln=function(e,t){void 0===e&&(e={});var r,n=t.sheetId,a=t.row,o=t.col,i=t.rowCount,u=t.colCount;if(1===i&&1===u){var s=tn(a,o,n);(r=t.refType===w.CELL?[s]:[[s]]).rangeCount=1,r.row=a,r.col=o,r.rowCount=i,r.colCount=u}else r=function(e,t,r,n,a,o){void 0===e&&(e={});var i,u=e.newLine,s=0,l=[];l.error=[];for(var c=r+a,f=n+o,d=r;d<c;d++)for(var h=n;h<f;h++)if(Pt(i=tn(d,h,t))&&l.error.push(i),void 0!==u){var m=Math.floor(s/u);void 0===l[m]&&(l[m]=[]),l[m].push(i),s+=1}else l.push(i);return l}(e,n,a,o,i,u),r.rangeCount=1,r.row=a,r.col=o,r.rowCount=i,r.colCount=u;return r},cn={LEFT:!0,RIGHT:!0,MID:!0,SUMPRODUCT:!0,FIND:!0,SUBSTITUTE:!0,CONCATENATE:!0,CONCAT:!0,OFFSET:!0,FIXED:!0,REPT:!0,SMALL:!0,LARGE:!0,EOMONTH:!0,EDATE:!0,WEEKNUM:!0,DOLLAR:!0,"FLOOR.MATH":!0,"CEILING.MATH":!0,"FLOOR.PRECISE":!0,"CEILING.PRECISE":!0,BIN2OCT:!0,BIN2HEX:!0,OCT2BIN:!0,OCT2HEX:!0,HEX2BIN:!0,HEX2OCT:!0,DEC2BIN:!0,DEC2OCT:!0,DEC2HEX:!0,COMPLEX:!0,MODE:!0,"MODE.SNGL":!0,PERCENTRANK:!0,"PERCENTRANK.INC":!0,"PERCENTRANK.EXC":!0,ERF:!0,"WORKDAY.INTL":!0,RANDBETWEEN:!0};function fn(e){return e&&e.reduce?e.reduce((function(e,t){var r=Array.isArray(e),n=Array.isArray(t);return r&&n?(e=e.concat(),t=t.concat(),e.concat(t)):r?((e=e.concat()).push(t),e):n?(t=t.concat(),[e].concat(t)):[e,t]})):e}function dn(e){if(!e)return!1;for(var t=0;t<e.length;++t)if(Array.isArray(e[t]))return!1;return!0}function hn(){for(var e=pn.apply(null,arguments);!dn(e);)e=fn(e);return e}function mn(e){for(var t=e[0],r=[],n=t.length,a=t[0].length,o=0;o<a;o++)for(var i=0;i<n;i++)r.push(t[i][o]);return r}function gn(e){return Array.isArray(e)&&e.length>0?e=gn(e[0]):e}function pn(e){return(t=e)&&"object"==typeof t&&isFinite(t.length)&&t.length>=0&&t.length===Math.floor(t.length)&&t.length<4294967296?Array.prototype.slice.call(e,0):[e];var t}function vn(e,t){var r=e+t,n=r.toString();if(n.length<15||n.replace(/[^\d]/g,"").length<15)return r;var a=new(Ne())(e),o=new(Ne())(t),i=a.plus(o).toPrecision(15).toString();return parseFloat(i)}function yn(e){if(void 0===e||""===e)return Bt.value;if("boolean"==typeof e)return+e;if(!isNaN(e))return parseFloat(e);if(/^(\d+\/\d+\/\d+|\d+\/\d+\/\d+\s*?\d+:\d+:\d+)$/.test(e)){var t=new Date(e+" 00:00:00 +0800"),r=new Date("1970/1/1 00:00:00 +0800");return(t.getTime()-r.getTime())/864e5+25568}if(/^\d+\/\d+\/\d+ \d+:\d+:\d+$/.test(e)){var n=new Date(e+" +0800"),a=new Date("1970/1/1 00:00:00 +0800");return(n.getTime()-a.getTime())/864e5+25568}return Bt.value}var Nn=new Date("1970/01/01 00:00:00");function Mn(e,t){var r=(t=t||{}).baseYear||1900;if(!isNaN(e)){if(e instanceof Date)return new Date(e);var n=parseInt(e,10);return 1900===r&&(n-=25567),n<-25567?Bt.num:new Date(Nn.getTime()+864e5*(n-1))}return"string"!=typeof e||(e=e.replace(/[-]/,"/").replace(/[-]/,"/").replace(/[-]/,""),e=new Date(e),isNaN(e))?Bt.value:e}function Rn(){for(var e=arguments.length;e--;)if(Pt(arguments[e]))return!0;return!1}function _n(e,t){var r=typeof e,n=typeof t;return r===n?"string"===r?En(e,t):e===t?0:e>t?1:-1:"boolean"===r||"string"===r&&"number"===n||null===t?1:-1}function En(e,t){if((e=e.toLowerCase())===(t=t.toLowerCase()))return 0;if(0===e.length||0===t.length)return e>t?1:-1;var r=Tn(e[0]),n=Tn(t[0]);if(1==(r^n))return r?-1:1;if(r&&n){var a=e.split("").reduce((function(e,t,r){return e.length!==r||Tn(t)&&(e=""+e+t),e}),""),o=t.split("").reduce((function(e,t,r){return e.length!==r||Tn(t)&&(e=""+e+t),e}),"");return a.length===e.length&&o.length===t.length?e>t?1:-1:a.length!==o.length?a>o?1:-1:a===o?En(e.replace(a,""),t.replace(o,"")):a>o?1:-1}var i=rt.getPinyin(e),u=rt.getPinyin(t);if("a".localeCompare("z")==="z".localeCompare("a"))return String(i)>String(u)?1:-1;var s=String(i).localeCompare(String(u));return 0===s?e>t?1:-1:s/Math.abs(s)}function Tn(e){var t=e.charCodeAt(0);if(!function(e){return e<=127}(t))return!1;var r=32|t;return r>=97&&r<=122}function Sn(e){return"boolean"==typeof e&&(e=e?1:0),e}function Cn(e,t){return!gt(t)&&"string"==typeof e&&""===e.trim()}function In(e,t){var r="";return"string"==typeof e&&!Nt(t)&&(gt(t)||Et(t)||_t(t))&&(r=e.toLowerCase()),"true"===r||"false"===r}function An(e,t,r){return In(e,t)?(e=e.toLowerCase(),r?"true"===e?1:0:"true"===e):e}function wn(e,t,r){if(void 0===r&&(r=!1),"number"==typeof e)return e;if(!r&&Cn(e,t))throw new Error(Bt.value);return"string"==typeof(e=An(e,t,!0))&&(e=(e=xr(e)).numericValue),e}var xn=g(8422),Dn=g(6593),bn="number",On="string",Fn="boolean",Un=null,Ln=Math.abs;Math.pow;var Bn=function(e){this.array=e};function kn(e,t){return typeof e===bn||e instanceof Date||!t&&(typeof e===Fn||!isNaN(e)&&!isNaN(parseFloat(e)))}function Pn(e){return Pt(e)}function Gn(e){return isNaN(e)||!isFinite(e)}function Hn(e){var t=Yn(e);if(Ln(t)<1e21)return parseInt(t,10);throw new Error(Bt.value)}function Yn(e){var t={value:0};if(Vn(e,t))return t.value;throw new Error(Bt.value)}var jn={JAN:1,FEB:2,MAR:3,APR:4,MAY:5,JUN:6,JUL:7,AUG:8,SEP:9,OCT:10,NOV:11,DEC:12};function Vn(e,t){var r=Un;if(!e)return t.value=0,!0;var n=typeof e;try{if(n===bn)r=e;else if(n===On){if(0===(e=e.trim()).length)return t.value=0,!0;var a=".",o=!1;if("%"===e.charAt(e.length-1)&&(o=!0,e=e.substr(0,e.length-1)),"$"===e[0])return!1;if(e.indexOf(a)!==e.lastIndexOf(a))return!1;if(e.length>=2&&"0"===e[0]&&"x"===e[1])return!1;if(Gn(r=Number(e).valueOf())){var i=e.charCodeAt(0);if(i|=32,e.length>4&&i>=96&&i<=122){var u=e[0]+e[1]+e[2];if(u=u.toUpperCase(),!jn[u])return!1}if("/"===e[0]||"/"===e[e.length-1])return!1;if(e.indexOf('"')>-1||e.indexOf("'")>-1)return!1;var s=wr(e);if(void 0===s)return!1;r=Gn((r=new Date(e.replace(/-/g,"/"))).valueOf())?s.numericValue:xn.Z._toOADate(r)}o&&(r/=100)}else if(n===Fn)r=e?1:0;else{if(!(e instanceof Date))return!1;r=xn.Z._toOADate(e)}}catch(e){return!1}return t.value=r,!0}function $n(e,t){try{if(e)if(typeof e===Fn);else if(e instanceof Date)e=0!==xn.Z._toOADate(e);else{if(!kn(e))return!1;e=0!==e}else e=!1}catch(e){return!1}return t.value=e,!0}function Zn(e){try{if(void 0===e||e===Un)return"";if(typeof e===Fn)return e?"TRUE":"FALSE";if(typeof e===On)return e;if(e instanceof Date)return xn.Z._toOADate(e).toString();if(function(e){return e instanceof Bn}(e))throw new Error(Bt.value);return e.toString()}catch(e){throw new Error(Bt.value)}}function Wn(e){return Gn(e)?Bt.num:e}function Xn(e){var t={value:Un};if(zn(e,t))return t.value;throw new Error(Bt.value)}function Kn(e){var t;if(e&&e.length&&!Array.isArray(e[0])&&e.rowCount&&e.colCount)return e.error=e.error||[],e;if(ht(e))(t=e.toArray()).isReference=!0;else if(Array.isArray(e)&&e.length>0){(t=[]).error=[];for(var r=e[0],n=0,a=!0,o=0;o<r.length;o++)for(var i=0;i<r[o].length;i++){for(var u=0;u<e.length;u++){a&&(n+=e[u][o].length);var s=e[u][o][i];t.error&&t.error.length>0||!Pt(s)||(t.error=[s]),t.push(s)}a=!1}t.isArray=!0,t.rowCount=e[0].length,t.colCount=n,t.rangeCount=1}else(t=[]).error=[],t.push(e),t.rowCount=1,t.colCount=1,t.rangeCount=1;return t}function zn(e,t){if(e)if(e instanceof Date)t.value=new Date(e);else if(typeof e===On){var r=xn.Z._parseLocale(e);if(!r)if(isNaN(e)){if(r=new Date(e),isNaN(r.valueOf()))return!1;try{var n=Dn.Z._trimEnd(Dn.Z._trimStart(e.replace(/ |\n/g,"")," ")," "),a=/^[-+=\s]*(\d+)\W+(\d+)\W+(\d+)$/.exec(n);if(a&&4===a.length&&(-1===a.indexOf(r.getYear().toString())||-1===a.indexOf(r.getMonth().toString())||-1===a.indexOf(r.getDate().toString())))return!1}catch(e){return!1}}else if(!(r=xn.Z._fromOADate(parseFloat(e))))return!1;t.value=r}else{if(typeof e!==bn)return!1;t.value=xn.Z._fromOADate(e)}else t.value=xn.Z._fromOADate(0);return!0}var qn={},Jn=g(7686),Qn=g(8657),ea=g(9678),ta=g(8751),ra=Jn.Z._isNullOrUndefined,na=ea.Z._getLength,aa=isNaN,oa=Math.abs,ia=Math.exp,ua=Math.log,sa=Math.pow,la=179769e303;function ca(e,t){var r=16777216;return e===t||oa(e-t)<oa(e)/(r*r)}function fa(e,t,r){var n;return!(2!==e&&4!==e&&"string"==typeof t&&"string"==typeof r&&!isNaN(r)&&!r.match(/^(0x|0b|0o)/i))&&(0===e?n=t<=r:1===e?n=t>=r:2===e?n=t!==r:3===e?n=t<r:4===e?n=t===r:5===e&&(n=t>r),n)}function da(e,t,r){void 0===r&&(r=!1);var n=-1,a=!0,o={value:0},i=ta.Z._getWildcardCriteriaFullMatch(t,!1,!1,r),u=!1;if(4===e&&(u=!0),ra(t))a=!1,n=null;else if(""===t)a=!1,n="";else if(i){a=!1;var s=function(e){var t=ta.Z._getRegWithConditions(i,"gim");return t.lastIndex=0,t.test(e)}}else Vn(t.toString(),o)?n=o.value:a=!1;return function(r){if(Pt(r))return!1;var o={value:0};if(null===r&&4===e&&""===t)return!0;if(null===r&&2!==e)return!1;if(a&&""!==r&&Vn(r,o))return fa(e,o.value,n);if(i&&kn(r,!0))return!1;if(s&&!u){var l=s(r.toString()),c=r.toString().toUpperCase(),f=c;return l||(f=ra(t)?"":t.toString().toUpperCase()),fa(e,c,f)}var d=ra(t)?null:t.toString().toUpperCase(),h=ra(r)?null:r.toString();return i&&u?s(h):fa(e,null===h?h:h.toUpperCase(),d)}}var ha={},ma={_approxFloor:function(e){var t=Math.floor(e);return ca(e,t+1)?t+1:t},_parseCriteria:function(e,t){void 0===t&&(t=!1);var r=e;ht(r)&&(r=Kn(r));var n=ha;n||(ha=n={});var a=n[r];if(a&&!t)return a;if(kn(r))return n[r]=da(4,r);var o,i,u=ra(r)?"":r.toString().toUpperCase(),s="\0";for(o=0;o<2&&o<na(u);o++){if(i=u[o],-1==="=><".indexOf(i)){if("<"===s)return n[r]=a=da(3,u.substring(1)),a;if(">"===s)return n[r]=a=da(5,u.substring(1)),a;break}if("="===i)return a="<"===s?da(0,u.substring(2)):">"===s?da(1,u.substring(2)):da(4,"\0"===s?u.substring(1):r),n[r]=a,a;if("\0"===s)s=i;else{if("<"===s)return a=">"===i?da(2,u.length>2?u.substring(2):null):da(3,u.substring(1)),n[r]=a,a;if(">"===s)return n[r]=a=da(5,u.substring(1)),a}}return n[r]=a=da(4,r,t),a},_pow10:function(e){var t=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13,1e14,1e15,1e16][e];return ra(t)?sa(10,parseFloat(e)):t},_approxCeiling:function(e){var t=Math.ceil(e);return ca(e,t-1)?t-1:t},_round:function(e,t){var r=ma._pow10(oa(t));return e=(e=t<0?e/r:e*r)<0?ma._approxCeiling(e-.5):ma._approxFloor(e+.5),Wn(e=t<0?e*r:e/r)},_combin:function(e,t){if(e<0||t<0||e<t)return CalcErrorsNumber;var r,n=1;for(t=Math.min(e-t,t),r=1;r<=t;r++)n*=e-r+1,n/=r;return Wn(n)},_pow1p:function(e,t){var r=oa(e)>.5?sa(1+e,t):ia(t*ua(1+e));return isFinite(r)?aa(r)&&(r=5e-324):r===Number.POSITIVE_INFINITY?r=la:r===Number.NEGATIVE_INFINITY&&(r=-la),r},_sinhCosh:function(e,t){return(ia(e)+(t?-1:1)*ia(-e))/2},_log:function(e,t){return aa(e)?e:aa(t)?t:1!==t&&1===e||0!==t&&t!==Number.POSITIVE_INFINITY?ua(e)/ua(t):NaN}},ga=ma,pa=xn.Z._toOADate,va=ea.Z._getLength,ya=Jn.Z._inArray,Na=(Jn.Z._isNullOrUndefined,isNaN,parseInt),Ma=Math.abs,Ra=(Math.exp,Math.log,Math.pow,Math.floor,Bt.value,Bt.num),_a=(Bt.div0,Bt.na),Ea=Bt.null,Ta=Hn,Sa=Yn,Ca={};function Ia(e){return e%400==0||e%4==0&&e%100!=0}function Aa(e,t){switch(t){case 0:case 2:case 4:return 360;case 1:return Ia(e.getFullYear())?366:365;case 3:return 365;default:return-1}}function wa(e,t){return e-t}function xa(e,t){return ya(t,[0,2,4,6,7,9,11])>=0?31:ya(t,[3,5,8,10])>=0?30:1===t?Ia(e)?29:28:void 0}function Da(e,t,r,n){var a=r.getFullYear(),o=r.getMonth(),i=r.getDate(),u=n.getFullYear(),s=n.getMonth(),l=n.getDate();if(e){var c=1===o&&xa(a,o)===i,f=1===s&&xa(u,s)===l;t?(c&&f&&(l=30),c&&(i=30),31===i&&(i=30),30===i&&31===l&&(l=30),31===l&&(l=30)):(31===i&&(i=30),31===l&&(l=30))}return 360*(u-a)+30*(s-o)+l-i}function ba(e,t,r){var n=1;if(wa(e,t)>0){var a=e;e=t,t=a,n=-1}return ya(r,[1,2,3])>=0?n*Ta(pa(t)-pa(e)):ya(r,[4,5])>=0?n*Da(!0,!1,e,t):n*Da(!0,!0,e,t)}function Oa(e){var t,r=[];for(t=0;t<va(e);t++)Fa(e[t],r);return r}function Fa(e,t){for(var r=0;r<va(e);r++){var n=e[r];n!==qn&&t.push(n)}!function(e){e.sort((function(e,t){return e-t}))}(t)}function Ua(e,t,r){var n=[];Fa(t,n);var a=va(n);return r<=0||a<r?Ra:e?n[a-r]:n[r-1]}function La(e,t,r){this._real=e,this._imag=t,this._suffix=r||"i"}function Ba(e,t){return e.charAt(t)}function ka(e,t){for(var r=e.length,n=!1;t<r&&!isNaN(Ba(e,t));)t++,n=!0;for(t<r&&"."===Ba(e,t)&&t++;t<r&&!isNaN(Ba(e,t));)t++,n=!0;if(t<r&&("E"===Ba(e,t)||"e"===Ba(e,t)))for(n=!1,++t<r&&("+"===Ba(e,t)||"-"===Ba(e,t))&&t++;t<r&&!isNaN(Ba(e,t));)t++,n=!0;return{_digitFlag:n,_index:t}}function Pa(e){try{return e?"number"==typeof e?new La(parseFloat(e),0):"string"==typeof e?function(e){var t,r,n,a=0,o=0,i=!1,u=0,s=0,l=0,c=e.length;if(!e)throw Qn.wI.Exp_ArgumentNull;if(0===c)throw Qn.wI.Exp_Format;l<c&&("+"===Ba(e,l)||"-"===Ba(e,l))&&l++;var f=ka(e,l);if(l=f._index,t=f._digitFlag,l<c&&("+"===Ba(e,l)||"-"===Ba(e,l))?(u=l,l=(f=ka(e,++l))._index,r=f._digitFlag,l<c&&("i"===Ba(e,l)||"j"===Ba(e,l))&&(n=Ba(e,l),l++,i=!0),s=l-u):l<c&&("i"===Ba(e,l)||"j"===Ba(e,l))?(n=Ba(e,l),s=++l,r=t,i=!0,t=!1):u=l,l<c)throw Qn.wI.Exp_Format;if(u>0){if(!t)throw Qn.wI.Exp_Format;a=parseInt(e.substr(0,u),10)}if(s>0){if(!i)throw Qn.wI.Exp_Format;if(1===s||2===s&&"+"===Ba(e,u))o=1;else if(2===s&&"-"===Ba(e,u))o=-1;else{if(!r)throw Qn.wI.Exp_Format;o=parseInt(e.substr(u,s-1),10)}}return new La(a,o,n)}(e):null:new La(0,0)}catch(e){return null}}Ca._MAX_DOUBLE_VALUE=179769e303,Ca._isBoolean=function(e){return"boolean"==typeof e},Ca._isString=function(e){return"string"==typeof e},Ca._isNumber=function(e){return"number"==typeof e},Ca._isLeapYear=Ia,Ca._annualYearBasis=Aa,Ca._compareDateTime=wa,Ca._getDaysInMonth=xa,Ca._daysBetweenBasis=ba,Ca._st_normsdist=function(e){var t,r,n;return r=0===e?0:(n=.5*Ma(e))>=3?1:n<1?((((((((.000124818987*(t=n*n)-.001075204047)*t+.005198775019)*t-.019198292004)*t+.059054035642)*t-.151968751364)*t+.319152932694)*t-.5319230073)*t+.797884560593)*n*2:(((((((((((((-45255659e-12*(n-=2)+.00015252929)*n-19538132e-12)*n-.000676904986)*n+.001390604284)*n-.00079462082)*n-.002034254874)*n+.006549791214)*n-.010557625006)*n+.011630447319)*n-.009279453341)*n+.005353579108)*n-.002141268741)*n+.000535310849)*n+.999936657524,e>0?.5*(r+1):.5*(1-r)},Ca._st_includeAggregateMulti=function(e,t){var r=13===t,n=14===t,a=15===t;return 12===t?function(){var e=Oa(arguments[0]),t=va(e);return 0===t?Ra:t%2==0?(Sa(e[t/2-1])+Sa(e[t/2]))/2:e[Na((t/2).toString())]}(e):r?function(){var e,t,r,n=null,a=0,o=arguments[0],i=va(o);for(e=0;e<i;e++){for(r=0,t=0;t<i;t++)t!==e&&o[t]===o[e]&&r++;r>a&&(a=r,n=o[e])}return 0===a?_a:n}(e):n?Ua(!0,e[0],e[1]):a?function(e,t){return Ua(!1,e,t)}(e[0],e[1]):Ea},Ca._fact=function(e){var t,r=1;for(t=e;t>1;t--)r*=t;return r},Ca._days360=function(e,t,r){var n=e.getDate(),a=t.getDate(),o=e.getMonth(),i=t.getMonth(),u=e.getFullYear(),s=t.getFullYear();return n=31===n?30:n,r?a=31===a?30:a:31===a&&(n<30?(a=1,++i>12&&(i=1,s++)):a=30),30*(12*(s-u)+i-o)+a-n},Ca._yearfrac=function(e,t,r){return r<0||r>4?Ra:function(e,t,r){var n,a=ba(e,t,r);if(a<0){a=-a;var o=e;e=t,t=o}if(1===r){var i,u,s,l,c=e.getFullYear(),f=t.getFullYear();(i=new Date(e.valueOf())).setFullYear(i.getFullYear()+1),wa(t,i)>0?(l=f+1-c,i=new Date(c,0,1),u=new Date(f+1,0,1),s=Ta(pa(u)-pa(i))-365*(f+1-c)):(l=1,s=Ia(c)&&e.getMonth()<3||Ia(f)&&256*t.getMonth()+t.getDate()>=541?1:0),n=365+Sa(s)/Sa(l)}else n=Aa(new Date,r);return a/n}(e,t,r)},La.prototype={_getReal:function(){return this._real},_getImag:function(){return this._imag},_getSuffix:function(){return this._suffix},_toString:function(e){e=e||this._suffix||"i";var t=this._real,r=this._imag,n="";return 0===t&&0!==r||(n+=t.toString()),-1===r?n+="-":0!==t&&r>0&&(n+="+"),-1!==r&&0!==r&&1!==r&&(n+=r.toString()),0!==r&&(n+=e),n}},Ca._Complex=La,Ca._convertToComplex=Pa,Ca.convertArgToComplex=function(e,t){void 0===t&&(t=!1);var r=Pa(e);return r=!r||t&&0===r._getReal()&&0===r._getImag()?Bt.num:{_real:r._getReal(),_imag:r._getImag(),_suffix:r._getSuffix()}};var Ga,Ha,Ya,ja,Va,$a,Za=Ca,Wa=null,Xa=Jn.Z._isNullOrUndefined,Ka=Za._isBoolean,za=Za._isString,qa=xn.Z._parseInvariant,Ja=ea.Z,Qa=Ja._getLength,eo=Ja._getLength,to=ta.Z,ro=to._getWildcardCriteriaFullMatch,no=to._getRegIgnoreCase;function ao(e,t,r){void 0===r&&(r=1);var n=!1;if(ht(r)){var a=rt._element,o=rt._instance,i=a.row,u=a.col;r=o.custom.getValueByTopCellPosition(r,i,u),n=!0}if("number"!=typeof r)throw n?new Error(Bt.ref):new Error(Bt.value);function s(e,t){var r,n=eo(e);for(r=1;r<n;r++)if(2===lo(e[r-1],e[r],!1)&&!t)return!1;return!0}var l=Kn(e),c=Kn(t);if(!c.isArray&&!c.isReference)return Bt.na;var f=c.colCount,d=c.rowCount,h=-1;return f>1&&d>1||1===r&&!s(c,!0)||-1===r&&!s(c,!1)?Bt.na:(1===r?h=fo(l,c,1,d>1):0===r?h=ho(l,c,0,d>1):-1===r&&(h=fo(l,c,-1,d>1)),-1===h?Bt.na:h+1)}function oo(e,t,r,n,a){if(e<0||t<0||t<e||r<e||r>t)return-1;if(a)return Ga=e,Ha=t,ja=r,Va=n,$a=n,Ya=r;if(Va){if(++Ya>Ha){if(Va!==$a)return-1;Ya=ja-1,Va=!1}}else if(--Ya<Ga){if(Va!==$a)return-1;Ya=ja+1,Va=!0}return Ya}function io(e,t){return!(Xa(t)||!((Xa(e)||kn(e,!0))&&kn(t,!0)||Ka(e)&&Ka(t))&&(!za(e)||!za(t)))}function uo(e,t,r){if(Xa(e))return Wa;if(e.isArray||e.isReference){var n=e.colCount;if(t>n){var a=t;t=r,r=a}return e[r*n+t]}return e[0]}function so(e,t,r){var n=qa(e),a=r;return n===t?a=0:n>t?a=1:n<t&&(a=2),a}function lo(e,t,r,n){if(void 0===r&&(r=!1),void 0===n&&(n=!1),e===t)return 0;if(za(e)){if(!t&&0===Qa(e.toString()))return 0;if(kn(t)&&!kn(e))return 1;if(Ka(t))return 2;if(za(t)){if(!n&&(escape(e).indexOf("%u")>=0||escape(t).indexOf("%u")>=0))var a=En(e,t);else a=r?e.toString().localeCompare(t.toString()):e.toLowerCase().localeCompare(t.toLowerCase());return 0===a?0:a>0?1:2}return t instanceof Date?so(e,t,1):-1}if(za(t))return e||0!==Qa(t.toString())?kn(e)?2:Ka(e)?1:e instanceof Date?so(e,t,2):-1:0;if(Ka(e)&&kn(t))return 1;if(Ka(t)&&kn(e))return 2;var o=Yn(e),i=Yn(t);return o===i?0:o<i?2:1}function co(e,t,r){var n=uo(e,t,r);return Xa(n)?0:n}function fo(e,t,r,n,a){void 0===a&&(a=!1);var o,i=-1,u=0,s=-1,l=-1;if(o=n?t.rowCount:t.colCount,--o<u)return-1;for(;u<=o;){var c,f=Wa,d=e[0];for(r>=1!=(2===i)&&(s=l),c=l=oo(u,o,l=Hn((u+o)/2),r>=0,!0);!io(d,f)&&-1!==l&&!io(d,f=n?uo(t,0,l):uo(t,l,0));)l=oo(0,0,0,!1,!1),r>=0&&l<c?o=l:r<0&&l>c&&(u=l);if(-1===l&&r>=1!=(2===i))return s;if(-1===l)return-1;if(i=lo(d,f,!1,a),r>=1&&1===i)u=l+1;else if(r>=1&&2===i)o=l-1;else if(r<=-1&&1===i)o=l-1;else if(r<=-1&&2===i)u=l+1;else if(0===i){for(;r<=-1&&l>u||r>=0&&l<o;){var h;if(h=r>=0?l+1:l-1,null===(f=n?co(t,0,h):co(t,h,0)))return-1;if(!io(d,f))break;if(0!==(i=lo(d,f,!1,a)))break;l=h}return l}}return r>=1!=(2===i)?l:s}function ho(e,t,r,n,a){void 0===a&&(a=!1);var o,i,u,s,l,c=Wa,f=-1,d=e[0],h=za(d),m=ro(d);for(i=n?t.rowCount:t.colCount,h&&m&&(s=no(m)),u=0;u<i;u++)if(io(d,l=n?uo(t,0,u):uo(t,u,0))){var g=za(l);if(h&&g&&m?(s.lastIndex=0,o=s.test(l)?0:1):o=lo(d,l,!1,a),r>=1&&1===o)o=-1,f>=0&&(o=lo(l,c,!1,a)),(f<0||f>=0&&1===o)&&(f=u,c=l);else if(r<=-1&&2===o)o=-1,f>=0&&(o=lo(l,c,!1,a)),(f<0||f>=0&&2===o)&&(f=u,c=l);else if(0===o)return u}return f}function mo(e,t,r,n,a){var o=n?fo(e,t,1,a,!0):ho(e,t,0,a,!0);return o>=0?a?co(r,0,o):co(r,o,0):Bt.na}function go(e,t,r,n,a){var o=t.identities[0],i=o.row,u=o.col,s=o.rowCount,l=o.colCount,c=o.sheetId;if(a&&r>l||!a&&r>s)return Bt.ref;var f={row:i,col:u,rowCount:a?s:1,colCount:a?1:l,sheetId:c,refType:w.NORMAL},d=Kn(rt._instance.helper.getCalcRef([f],!1)),h={row:a?i:i+r-1,col:a?u+r-1:u,rowCount:a?s:1,colCount:a?1:l,sheetId:c,refType:w.NORMAL};return mo(e,d,Kn(rt._instance.helper.getCalcRef([h],!1)),n,a)}function po(e,t,r,n){if(void 0===n&&(n=!0),e=Kn(e),r=(r=Kn(r))&&r[0],n=(n=Kn(n))&&n[0],ht(t))return go(e,t,r,n,!0);var a=t=Kn(t),o=a.colCount,i=a.rowCount;if(r>o)return Bt.ref;for(var u=[],s=[],l=0;l<i;l++)u.push([t[l*o]]),s.push([t[l*o+r-1]]);return mo(e,Kn([u]),Kn([s]),n,!0)}function vo(e,t,r,n){if(e=Kn(e),r=(r=Kn(r))&&r[0],n=(n=Kn(n))&&n[0],ht(t))return go(e,t,r,n,!1);var a=t=Kn(t),o=a.colCount;if(r>a.rowCount)return Bt.ref;var i=[t.slice(0,o)],u=[t.slice((r-1)*o,r*o)];return mo(e,Kn([i]),Kn([u]),n,!1)}function yo(e,t,r){if("object"!=typeof t)return Bt.value;if(!0===t.isCell)return Bt.value;e=Kn(e);var n=[];if(t=Kn(t))for(var a=0;a<t.length;a++)n.push(t[a]);t.colCount<=t.rowCount?(n.colCount=t.colCount,n.rowCount=Math.ceil(n.length/n.colCount)):(n.rowCount=t.rowCount,n.colCount=Math.ceil(n.length/n.rowCount)),Xa(t.isReference)||(n.isReference=t.isReference),Xa(t.isArray)||(n.isArray=t.isArray),n.rangeCount=t.rangeCount;var o,i,u=n.colCount,s=n.rowCount,l=e;if(void 0===r){var c=u>s?vo(l,n,s,!0):po(l,n,u,!0);return Pt(c)?Bt.na:c}if(i=Kn(r)){if(i.colCount>1&&i.rowCount>1)return Bt.na}else i=n;return(o=fo(l,n,1,!(u>s)))>=0?(u=i.colCount)>(s=i.rowCount)?co(i,o,s-1):co(i,u-1,o):Bt.na}var No=ga._approxFloor,Mo=Jn.Z._isNullOrUndefined,Ro={};function _o(e){if(e&&e[0]&&e[0].length>1||e&&e[0]&&e[0].length>0&&e[0][0].length>1)return!0;var t=!1;return Pt(e=gn(e))&&(t=!0),!!(t=t||"number"==typeof e&&(isNaN(e)||!isFinite(e)))&&e!==Bt.na}function Eo(e){if(e&&e[0]&&e[0].length>1||e&&e[0]&&e[0].length>0&&e[0][0].length>1)return!0;var t=!1;return Pt(e=gn(e))&&(t=!0),t||"number"==typeof e&&(isNaN(e)||!isFinite(e))}function To(e){var t=rt._instance,r=e.getRow(0),n=e.getColumn(0),a=e.getSheetId(0),o=t.custom.cellEditValue(r,n,a);return!!(0,yr.jr)(o)}function So(e){return!0===e||!1===e}function Co(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return!((t=hn(t)).length>1)&&gn(t)===Bt.na}function Io(e){var t=hn(e);if(t.length>1&&!e.__isUserWrite)return!1;var r=t[0];return!(""===r||null==r||"boolean"==typeof r||Eo(r)||"number"!=typeof r||(r=Number(r),"number"!=typeof r||isNaN(r)||!isFinite(r)))}function Ao(e){return ht(e)}function wo(e){return"string"==typeof e}function xo(){return Bt.na}function Do(e){return Io(e)?1:wo(e)?2:So(e)?4:Eo(e)?16:Array.isArray(e)?64:void 0}function bo(e){return""===e||Mo(e)}function Oo(e){return"number"!=typeof(e=wn(e,rt._astNodes[0],!1))&&""!==e?Bt.value:No(Math.abs(e))%2!=0}function Fo(e){return"number"!=typeof(e=wn(e,rt._astNodes[0],!1))&&""!==e?Bt.value:No(Math.abs(e))%2==0}function Uo(e){return Array.isArray(e)&&(e=(e=hn(e))[0]),kn(e,!0)?Yn(e):(e=An(e,rt._astNodes[0]),Za._isBoolean(e)?e?1:0:Pn(e)?e:0)}Ro.TYPE=function(e){switch(e){case Bt.null:return 1;case Bt.div0:return 2;case Bt.value:return 3;case Bt.ref:return 4;case Bt.name:return 5;case Bt.num:return 6;case Bt.na:return 7;case Bt.data:return 8}throw new Error(Bt.na)};var Lo=xn.Z,Bo=Lo._parseLocale,ko=Lo._toOADate,Po=ea.Z._getLength,Go=Jn.Z._inArray,Ho=void 0,Yo=Pt,jo=Hn,Vo=new Date("1970/01/01 00:00:00"),$o=[[],[1,2,3,4,5,6,7],[7,1,2,3,4,5,6],[6,0,1,2,3,4,5],[],[],[],[],[],[],[],[7,1,2,3,4,5,6],[6,7,1,2,3,4,5],[5,6,7,1,2,3,4],[4,5,6,7,1,2,3],[3,4,5,6,7,1,2],[2,3,4,5,6,7,1],[1,2,3,4,5,6,7]];function Zo(e,t,r){if(Rn(e,t,r)||!(0,Ee.kE)(e)||!(0,Ee.kE)(t)||!(0,Ee.kE)(r))throw new Error(Bt.value);if((e=yn(e))<0||e>=1e4)throw new Error(Bt.num);var n;return e<=1899&&e>=0&&(e=1900+e),(t=yn(t))>12?(e+=parseInt(t/12),t%=12):t<1&&(e=e-parseInt(Math.abs(t/12))-1,t=12-Math.abs(t%12)),r=yn(r),n=new Date(e+"/"+t+"/"+r).getTime()<0?Date.parse(parseInt(e,10)+"/"+parseInt(t,10)+"/1 00:00:00"):Date.parse(parseInt(e,10)+"/"+parseInt(t,10)+"/1 08:00:00"),parseInt((n-Vo)/864e5,10)+r+25567}function Wo(e){if(Array.isArray(e)&&(e=e[0]),Array.isArray(e)){if(e.length>1)throw new Error(Bt.value);if(e[0]&&e[0].length>1)throw new Error(Bt.value);e=gn(e)}if(/\d{4},\d{1,2},\d{1,2}/.test(e))throw new Error(Bt.value);if(Io(e)&&(e=Number(e))>2958465)throw new Error(Bt.num);"string"==typeof e&&(e=e.replace(/-/g,"/"));var t=Mn(e||0);return t instanceof Date?1899===t.getFullYear()?0:t.getDate():t}function Xo(e){if(Array.isArray(e)){if(e.length>1)throw new Error(Bt.value);e[0]&&e[0].length>1&&(e=e[0]),e=gn(e)}if(/\d{4},\d{1,2},\d{1,2}/.test(e))throw new Error(Bt.value);return(e=Mn(e||0))instanceof Date?1899===e.getFullYear()?1:e.getMonth()+1:e}function Ko(e,t,r,n,a,o){var i={value:void 0};if(!zn(t,i))throw new Error(Bt.value);if(t=i.value,!zn(r,i={value:void 0}))throw new Error(Bt.value);r=i.value;var u=Hn(ko(t)),s=Hn(ko(r)),l=!1;if(u>s){var c=t;t=r,r=c;var f=u;u=s,s=f,l=!0}var d=s-u+1;return d=o(t,r,d,n),e&&Pt(d)?d:d<=0?0:(d=function(e,t,r,n,a,o){var i,u;if(o&&Pt(u=ii(e=e!==Ho?e:"0000011")))return u;if(t!==Ho&&(i=Kn(t)),!i)return a;if(i.isError)return i[0];var s,l=Po(i),c=[];for(s=0;s<l;s++){var f=i[s],d=xn.Z._fromOADate(f),h=d.getDay(),m=Po(u)?u[ei(d,3)]:6===h||0===h;-1===c.indexOf(f)&&!m&&f>=r&&f<=n&&c.push(f)}return a-Po(c)}(n,a,u,s,d,e),d=l?-d:d)}function zo(e,t,r,n){var a,o=ii(n=n!==Ho?n:"0000011"),i=0,u=0;if(Yo(o))return o;for(a=0;a<Po(o);a++)1===o[a]&&i++;if(r<30){for(a=0;a<r;a++)o[(jo(ei(e,3))+a)%7]&&u++;return r-u}var s=r,l=0,c=0;for(a=0;a<s&&jo(ei(e,3)+a)%7!=0;a++)l++;for(a=0;a<l;a++)o[(jo(ei(e,3))+a)%7]&&u++;for(a=0;a<s&&(jo(ei(t,3))+7-a)%7!=6;a++)c++;for(a=0;a<c;a++)o[(jo(ei(t,3))+7-a)%7]&&u++;return(r-=jo((s=s-l-c)/7)*i)-u}var qo={};function Jo(){var e,t=new Date;e=t.getFullYear(),e+="/",e+=t.getMonth()+1,e+="/",e+=t.getDate(),e+=" ",e+=t.getHours(),e+=":",e+=t.getMinutes(),e+=":",e+=t.getSeconds();var r=(Date.parse(e)-Vo)/864e5;return Number((r+25568).toFixed(4))}function Qo(){var e=new Date;return parseInt((Date.parse(e.getFullYear()+"/"+(e.getMonth()+1)+"/"+e.getDate()+" 00:00:00")-Vo)/864e5,10)+25568}function ei(e,t){if(void 0===t&&(t=1),!Io(t))throw new Error(Bt.value);if([1,2,3,11,12,13,14,15,16,17].indexOf(t)<0)throw new Error(Bt.num);if(function(e){if(function(e){return!("string"!=typeof e||!/1900(?:-|\/)0?2(?:-|\/)29/.test(e))||60===parseInt(e)}(e))return!0;var t=Mn(e);t instanceof Date&&1900===t.getFullYear()&&t.getMonth()}(e=gn(e)),e=Mn(e),0===Number(t))throw new Error(Bt.num);if(!(e instanceof Date))return e;if(1899===e.getFullYear())return 7;var r=e.getDay();return isNaN(r)&&(r=6),$o[t][r]}function ti(e){if(Array.isArray(e)){if(e.length>1)throw new Error(Bt.value);if(e[0]&&e[0].length>1)throw new Error(Bt.value);e=gn(e)}if(/\d{4},\d{1,2},\d{1,2}/.test(e))throw new Error(Bt.value);return(e=Mn(e||0))instanceof Date?Math.max(e.getFullYear(),1900):e}function ri(e){return 1===new Date(e,1,29).getMonth()}function ni(e){var t,r=new Date;return"string"!=typeof e?e:(t=e.match(/^(\d*)(\d*)(\d*)$/))?t[1]+"/"+t[2]+"/"+t[3]:(t=e.match(/^(\d*)(\d*)$/))?t[1]+"/"+t[2]+"/1":(t=e.match(/^(\d*)(\d*)$/))||(t=e.match(/^(\d*)[-/](\d*)$/))?r.getFullYear()+"/"+t[1]+"/"+t[2]:e}function ai(e){if(""===(e=wn(e,rt._astNodes[0])))return Bt.value;var t=Xn(e);return(60*(60*t.getHours()+t.getMinutes())+t.getSeconds())/86400}function oi(e,t){var r=e.getDay();switch(t){case 1:return r+1;case 2:return 0===r?7:r;case 3:return 0===r?6:r-1;default:return Bt.num}}function ii(e){if(Za._isString(e)){if(7!==Po(e)||isNaN(parseInt(e)))return Bt.value}else if(!isNaN(e)){if(Math.floor(e)<1||Math.floor(e)>17)return Bt.num;e=e.toString()}var t,r=["1","2","3","4","5","6","7"],n=[0,0,0,0,0,0,0];switch(Po(e)){case 1:if(Go(e,r)>=0){n[((t=parseInt(e))+4)%7]=1,n[(t+5)%7]=1;break}return Bt.num;case 2:if("1"===e[0]&&Go(e[1],r)>=0){n[((t=parseInt(e[1]))+5)%7]=1;break}return Bt.num;case 7:for(t=0;t<7;t++)n[t]=parseInt(e[t]);break;default:return Bt.value}return n}function ui(e,t,r,n,a){void 0===n&&(n=[]),t=Xn(t=Hn(t)),r=Hn(r);var o=oi(t,3);if(Pn(o))return o;for(var i=Hn(o);r<0;++r)t.setDate(t.getDate()-1),i=0===i?6:--i,(e&&(5===i||6===i)||!e&&a[i]||n.indexOf(ko(t))>=0)&&r--;for(;r>0;--r)t.setDate(t.getDate()+1),i=6===i?0:++i,(e&&(5===i||6===i)||!e&&a[i]||n.indexOf(ko(t))>=0)&&r++;return t.getFullYear()<1900?Bt.num:ko(t)}function si(e,t){e=Array.isArray(e)?hn(e):[e];for(var r=Nt(t),n=0,a=e.length;n<a;n++){var o=e[n];if(r&&""===o)return Bt.value;"number"!=typeof o&&(o=Xn(ni(o)),e[n]=ko(o))}return e}qo.ORIGIN=function(e,t,r){return Ko(!1,e,t,void 0,r,(function(e,t,r){var n=Hn(ko(t)-ko(e))%7,a=Hn(ei(e,2)+n),o=0===e.getDay()?1:2;return(r-=n=(n=a>5?a-5:0)>o?o:n)-2*Math.floor(r/7)}))},qo.INTL=function(e,t,r,n){return Ko(!0,e,t,r,n,zo)};var li={};function ci(e){return Cn(e,rt._astNodes[0])?Bt.value:(e=Xn(e)).getMinutes()}function fi(e){return Cn(e,rt._astNodes[0])?Bt.value:(e=Xn(e)).getHours()}function di(e){return Cn(e,rt._astNodes[0])?Bt.value:(e=Xn(e)).getSeconds()}function hi(e,t,r){if("boolean"==typeof t||"boolean"==typeof r)return Bt.value;if(Cn(t,rt._astNodes[0]))return Bt.na;if(Cn(r,rt._astNodes[1]))return Bt.na;if(t=wn(t,rt._astNodes[0]),r=wn(r,rt._astNodes[1]),""!==t&&0!==t||(t=new Date(1900,0,1)).setHours(0,0,0,0),""===r&&(r=0),r=Hn(r),isNaN(r))return Bt.value;t=Xn(t);var n=new Date(t.getFullYear(),t.getMonth(),1);n.setMonth(n.getMonth()+r);var a=Za._getDaysInMonth(n.getFullYear(),n.getMonth());return n.setDate(e?a:Math.min(t.getDate(),a)),ko(n)}function mi(e,t){return hi(!0,e,t)}function gi(e,t){return hi(!1,e,t)}function pi(e){if(e=Xn(e=wn(e,rt._astNodes[0])),isNaN(e))return Bt.num;function t(e){var t=new Date(e,0,4),r=t.getDay();return 0===r&&(r=7),t.setDate(t.getDate()+1-r),t}var r,n=new Date(1900,1,28);e.getTime()<=n.getTime()&&e.setDate(e.getDate()-1),1900===(r=e.getFullYear())?r+=400:9999===r&&(r-=400),e.setYear(r),e.getTime()<new Date(r,11,29).getTime()&&r--;var a=t(r+1);return e.getTime()<a.getTime()&&(a=t(r)),parseInt((e.getTime()-a.getTime())/864e5/7)+1}li.ORIGIN=function(e,t,r){return e=wn(e,rt._astNodes[0]),t=wn(t,rt._astNodes[1]),Pn(r=si(r,rt._astNodes[2]))?r:ui(!0,e,t,r)},li.INTL=function(e,t,r,n){void 0===r&&(r=1),e=wn(e,rt._astNodes[0]),t=wn(t,rt._astNodes[1]),"string"==typeof r&&/^[01]{7}$/.test(r)||""===(r=wn(r,rt._astNodes[2],!0))&&(r=1);var a=ii(r);return Pn(a)?a:Pn(n=si(n,rt._astNodes[3]))?n:"1111111"===a.join("")?Bt.value:ui(!1,e,t,n,a)};var vi=[void 0,0,1,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,1,2,3,4,5,6,0];function yi(e,t){if(void 0===t&&(t=1),e=wn(e,rt._astNodes[0]),t=wn(t,rt._astNodes[1],!0),e=Xn(e),gt(rt._astNodes[1])||""!==t||(t=1),t=Hn(t),isNaN(t))return Bt.value;if(21===t)return pi(e);if(void 0!==vi[t]){var r=vi[t],n=new Date(e.getFullYear(),0,1),a=(7-(r-n.getDay()))%7,o=n-24*a*60*60*1e3;return Math.floor((e-o)/864e5/7+1)}return Bt.num}function Ni(e,t,r){e=wn(e,rt._astNodes[0]),t=wn(t,rt._astNodes[1]),r=wn(r,rt._astNodes[2]),e=Hn(e),t=Hn(t),r=Hn(r);var n=xn.Z._fromOADate(0);if(n.setHours(e),n.setMinutes(t),n.setSeconds(r),n.setMilliseconds(0),n.getHours()<0&&n.getMinutes()<0&&n.getSeconds()<0)return Bt.num;var a=ko(n);return a<0?Bt.num:(rt._funcNode.setFormatType("[$-409]h:mm AM/PM;@"),a)}function Mi(e){var t,r;if(wn(e,rt._astNodes[0]),Za._isString(e)&&(e=ni(e),(t=Bo(e))||(t=new Date(e))&&!isNaN(t.valueOf())||(t=null)),!t)return Bt.value;var n=t.getFullYear(),a=function(e){var t,r=e.getFullYear(),n=e.getMonth(),a=e.getDate();for(t=0;t<n;t++)a+=Za._getDaysInMonth(r,t);return a}(t);if(n<1900)return Bt.value;for(r=1900;r<n;r++)a+=365,ri(r)&&a++;return a}function Ri(e){var t,r={value:0};return Vn(e,r)?(t=r.value)>=0&&t<2958466?r:Bt.num:Bt.value}function _i(e,t){e=wn(e,rt._astNodes[0]),t=wn(t,rt._astNodes[1]);var r=Ri(e);if(Pn(r))return r;var n=Ri(t);return Pn(n)?n:r.value-n.value}function Ei(e,t,r){if(void 0===r&&(r=!1),e=wn(e,rt._astNodes[0]),t=wn(t,rt._astNodes[1]),e=Xn(e),t=Xn(t),Cn(r,rt._astNodes[2]))return Bt.value;var n=Ri(e);if(Pn(n))return n;var a=Ri(t);return Pn(a)?a:Za._days360(e,t,r)}function Ti(e,t,r){if(void 0===r&&(r=0),e=wn(e,rt._astNodes[0]),t=wn(t,rt._astNodes[1]),e=Xn(e),t=Xn(t),Cn(r,rt._astNodes[2]))return Bt.value;var n=Ri(e);if(Pn(n))return n;var a=Ri(t);return Pn(a)?a:(r=Hn(r),Za._yearfrac(e,t,r))}var Si=g(1501),Ci=g(2471),Ii=null,Ai=void 0,wi=Math.abs,xi=Dn.Z,Di=xn.Z,bi=Ci.Z,Oi=Jn.Z._isType,Fi=Jn.Z._isArray,Ui=bi._generalNumberInt+"."+bi._generalNumberDec,Li=bi._formatObjectToSrting,Bi=bi._customCultureFormat,ki=bi._fixNumber,Pi=Jn.Z._isNullOrUndefined,Gi=function(e){return Si.s._getCultureInfo(e)},Hi=function(e){return Gi(e).DateTimeFormat},Yi=function(e){return Gi(e).NumberFormat},ji=function(e){return e&&e.toLowerCase()},Vi=function(){throw new Error(Qn.Z.Exp_FormatIllegal)},$i={_Empty:"",_format:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(0===arguments.length)return Ii;for(var r=e[0],n=1;n<arguments.length;n++){var a=new RegExp("\\{"+(n-1)+"\\}","gm");r=r.replace(a,arguments[n])}return r},_isNullOrEmpty:function(e){return!e||e===$i._Empty}},Zi=function(e){var t=e.charCodeAt(0);return t>=48&&t<=57},Wi=function(e){var t=e.charCodeAt(0);return t>=9&&t<=13||32===t||133===t||160===t},Xi=function(){function e(e,t){Ru.call(this,t);var r=this;r._content=e;var n=r._content,a=pu(n[0],"$",!1),o=n.indexOf("-");if(!(a&&o>-1))throw new Error(Qn.Z.Exp_TokenIllegal);r._currencySymbol=iu(n,1,o-1),(n=xi._remove(n,0,o+1)).length>0&&(r._locateID=parseInt(n,16))}return e.Name="LocaleIDFormatPart",e.prototype={cultureInfo:function(){var e=this;return e._cultureInfo||(e._cultureInfo=Gi(e._locateID),e._currencySymbol&&e._currencySymbol!==$i._Empty&&!e._cultureInfo.NumberFormat.isReadOnly&&(e._cultureInfo.NumberFormat.currencySymbol=e._currencySymbol)),e._cultureInfo},currencySymbol:function(){return this._currencySymbol?xi._replace(this._currencySymbol,"\\.",'"."'):$i._Empty},allowScience:function(){if(this._cultureInfo)return!(0===this._cultureInfo.name().indexOf("ja")||0===this._cultureInfo.name().indexOf("zh"))},toString:function(){return this._content?fu(this._content):$i._Empty}},e}(),Ki=function(){function e(e,t){this.formatCached=e,this.cultureName=t,this.typeName=""}return e.prototype={format:function(e,t){return Ii},parse:function(e){return Ii},formatString:function(){return this.formatCached},toJSON:function(){var e={};for(var t in this)this.hasOwnProperty(t)&&(e[t]=this[t]);return e},fromJSON:function(e){if(e)for(var t in e)e[t]!==Ai&&(this[t]=e[t])}},e}(),zi={_yearTwoDigit:"yy",_yearSingleDigit:"y",_yearFourDigit:"yyyy",_monthSingleDigit:"m",_monthTwoDigit:"mm",_monthAbbreviation:"mmm",_monthUnabbreviated:"mmmm",_monthJD:"mmmmm",_daySingleDigit:"d",_dayTwoDigit:"dd",_dayWeekDayAbbreviation:"aaa",_dayWeekDayUnabbreviated:"aaaa",_hoursSingleDigit:"h",_hoursTwoDigit:"hh",_minuteSingleDigit:"m",_minuteTwoDigit:"mm",_secondSingleDigit:"s",_secondTwoDigit:"ss",_eraYear:"e",_aMPMTwoDigit:"AM/PM",_aMPMSingleDigit:"A/P",_placeholderMonthJD:"@mmmmm",_defaultAbsoluteTime:new Date(1899,11,31,0,0,0,0)},qi=[zi._yearSingleDigit,zi._yearTwoDigit,zi._yearFourDigit,zi._monthSingleDigit,zi._monthTwoDigit,zi._monthAbbreviation,zi._monthUnabbreviated,zi._monthJD,zi._daySingleDigit,zi._dayTwoDigit,zi._dayWeekDayAbbreviation,zi._dayWeekDayUnabbreviated,zi._hoursSingleDigit,zi._hoursTwoDigit,zi._minuteSingleDigit,zi._minuteTwoDigit,zi._secondSingleDigit,zi._secondTwoDigit,"ggg","gg","g","ee","e"],Ji=function(){function e(e,t){Ru.call(this,t);for(var r,n,a,o,i,u=this,s=["<=","<>",">=",">","<","="],l=0,c=s.length;l<c;l++)if(r=s[l],xi._startsWith(e,r,!0)){n=xi._remove(e,0,r.length);var f=parseFloat(n);isNaN(f)||(a=f);break}if(a===Ii&&a===Ai)throw new Error(Qn.Z.Exp_TokenIllegal);u.value=a,u._compareOperator=r,u.isMeetCondition=(o="var self = this;",i="="===(i="<>"===(i=u._compareOperator)?"!=":i)?"===":i,new Function(["value"],o+="return value "+i+" self.value;"))}return e.Name="ConditionalFormatPart",e.prototype={toString:function(){return fu(this._compareOperator+this.value.toString())}},e}(),Qi=function(){function e(e,t){Ru.call(this,t);var r=this;if(r.token=e,r.type=parseInt(xi._remove(e,0,"dbnum".length),10),r.type<0||r.type>3)throw new Error(Qn.Z.Exp_TokenIllegal)}function t(e,t,n){var a=e.split(".");if(a){if(1===a.length)return r(a[0],t.numbers,n?t.letters:Ii);if(2===a.length)return r(a[0],t.numbers,n?t.letters:Ii)+"."+r(a[1],t.numbers)}throw new Error(Qn.Z.Exp_ValueIllegal)}function r(e,t,n){var a,o=e,i=0,u=0;if(2===arguments.length){var s="";for(i=0;i<o.length;i++)a=iu(o,i,1),s+=t[u=parseInt(a,10)];return s}if(3===arguments.length){if(!n)return r(e,t);var l=0,c="",f=o.length,d=!1,h=[];for(i=0;i<f;i++){var m=n.length-1-i;m>-1?h.push(n[m].toString()):h.push($i._Empty)}for(var g=[],p=h.length-1;p>=0;p--)g[h.length-p-1]=h[p];h=g;var v=!1;for(p=0;p<f;p++){var y;a=iu(o,p,1),u=parseInt(a,10);var N=$i._Empty;f-p-16>0?(y=t[u],N="",v=!0):p!==f-1&&p!==f-5&&p!==f-9&&p!==f-13?"0"===a?(y="",N="",l+=1):"0"!==a&&0!==l?(y=t[0]+t[u],N=h[p],l=0):(y=t[u],N=h[p],l=0):"0"!==a&&0!==l?(y=t[0]+t[u],N=h[p],l=0):"0"!==a&&0===l||v?(y=t[u],N=h[p],l=0,v=!1):"0"===a&&l>=3?(y="",N="",l+=1):f>=11?(y="",l+=1):(y="",N=h[p],l+=1);var M=y+N===$i._Empty;M||(d=!1),p!==f-13||d||(N=h[p],d=!0),p!==f-9||d||(N=h[p],d=!0),p===f-1&&(N=h[p],d=!0),c=c+y+N}var R=parseInt(e,10);return 0===R?t[0]:c}}return e.Name="DBNumberFormatPart",e.prototype={_replaceNumberString:function(e,r,n){if(!e||e===$i._Empty)return e;for(var a,o,i,u=e,s=e,l=-1,c=-1,f=!1,d=e.length-1;d>=0;d--){var h=s[d];!isNaN(h)&&!pu(h," ",!1)||pu(h,".",!1)&&!f?(pu(h,".",!1)&&(f=!0),-1===l&&(l=d),c=d):c>-1&&l>-1&&(a=iu(s,c,l-c+1),o=parseFloat(a),isNaN(o)||(i=t(a,r,n),u=xi._remove(u,c,l-c+1),u=xi._insert(u,c,i)),l=-1,c=-1,f=!1)}return c>-1&&l>-1&&(a=iu(s,c,l-c+1),o=parseFloat(a),isNaN(o)||(i=t(a,r,n),u=xi._remove(u,c,l-c+1),u=xi._insert(u,c,i))),u},toString:function(){if(this.type>-1)return fu("DBNum"+this.type);throw new Error}},e}(),eu=function(){function e(e,t,r,n,a){Mu.call(this,t,r,n);var o=this;o._formatString=o._fixFormat(vu(e)),o._absTimeParts=a,o._formatType=2,o._init()}function t(e){return xi._indexOf(e,zi._hoursSingleDigit[0],!0)>-1||xi._indexOf(e,zi._secondSingleDigit[0],!0)>-1}function r(e){return xi._indexOf(e,zi._yearTwoDigit[0],!0)>-1||xi._indexOf(e,zi._daySingleDigit[0],!0)>-1}return e.prototype={_init:function(){var t=this,r={_value:t._formatString};if(e._evaluateFormat(r._value)){var n=t._processAMPM(r);if(t.hasJD=t._replace(r._value,zi._monthJD,'"'+zi._placeholderMonthJD+'"',!0,!1,r,!1),t._replace(r._value,zi._monthUnabbreviated,"MMMM",!0,!1,r,!1),t._replace(r._value,zi._monthAbbreviation,"MMM",!0,!1,r,!1),t._replace(r._value,zi._monthTwoDigit,"MM",!0,!1,r,!1),t._replace(r._value,zi._monthSingleDigit,"M",!0,!1,r,!1),t._replace(r._value,zi._dayWeekDayAbbreviation,"ddd",!0,!0,r,!0),t._replace(r._value,zi._dayWeekDayUnabbreviated,"dddd",!0,!0,r,!0),n||(t._replace(r._value,zi._hoursSingleDigit,"H",!0,!0,r,!1),t._replace(r._value,zi._hoursTwoDigit,"HH",!0,!0,r,!1)),t._partDBNumberFormat&&t._partLocaleID&&(t._hasYearDelay=t._hasYearDelay||t._replace(r._value,zi._yearFourDigit,'"@'+zi._yearFourDigit+'"',!0,!1,r,!0),t._hasYearDelay=t._hasYearDelay||t._replace(r._value,zi._yearTwoDigit,'"@'+zi._yearTwoDigit+'"',!0,!1,r,!0)),t._absTimeParts)for(var a=0;a<t._absTimeParts.length;a++){var o=t._absTimeParts[a];t._replace(r._value,o._originalToken,"@"+o._originalToken,!0,!0,r,!0)}t._validDateTimeFormatString=r._value}else Vi()},formatString:function(){return this._formatString},format:function(e){var t=this,r=$i._Empty,n=Ii,a=t._validDateTimeFormatString,o=t._formatString.match(/(am\/pm|a\/p)/i);a=(a=a.replace(/H/gi,o?"h":"H")).replace(/(h{2})h+/i,"$1");var i=t.cultureName;a.match(/ddd/i)&&(i="zh-cn");try{if((n=Di._DT(e))&&isNaN(n.valueOf())&&(n=Ii),n?e=n:r=e.toString(),n){if(r=Di._customCultureFormat(n,a,t._partLocaleID&&t._partLocaleID.cultureInfo()||Gi(i)),t.hasJD){var u=Gi(i).DateTimeFormat.monthNames[n.getMonth()];r=xi._replace(r,zi._placeholderMonthJD,iu(u,0,1))}if(t._absTimeParts)for(var s=24*(Di._toOADate(n)-Di._toOADate(zi._defaultAbsoluteTime))*60*60*1e3,l=0;l<t._absTimeParts.length;l++){var c=t._absTimeParts[l],f=c._getTimeSpan(s);if(!Pi(f)){var d=c._originalToken.replace(/H/gi,o?"h":"H"),h=(d=d.replace(/(h{2})h+/i,"$1")).replace("[","\\[").replace("]","\\]");r=xi._replace(r,"@"+h,f)}}}}catch(t){r=uu(e)}return function(e,t,r,n,a){var o=e;if(!Pi(n)&&t instanceof Date){var i=Eu(r,n.type,a);o=n._replaceNumberString(o,i,!0),1===n.type&&(o=o.replace(new RegExp("","g"),"")),o=(o=o.replace("@"+zi._yearFourDigit,Di._localeFormat(t,zi._yearFourDigit))).replace("@"+zi._yearTwoDigit,Di._localeFormat(t,zi._yearTwoDigit)),o=n._replaceNumberString(o,i,!1)}return o}(r,e,t._partLocaleID,t._partDBNumberFormat,i)},parse:function(e){if(!e||e===$i._Empty)return Ii;var t=this,r=e,n=ji(r);if("true"===n)return!0;if("false"===n)return!1;if(t._validDateTimeFormatString){var a=Di._parseExact(r,t._validDateTimeFormatString,Gi(t.cultureName));if(a)return a}try{var o=Di._DT(r);return o&&!isNaN(o)?o:(o=new Date(r),isNaN(o.valueOf())?r:o)}catch(e){return r}},_fixFormat:function(e){for(var t=e,r="",n=!1,a=0;a<t.length;a++){var o=t[a];if('"'===o)n=!n;else if(!n)if("Y"===o||"D"===o||"S"===o||"E"===o||"G"===o)o=ji(o);else if("M"===o){var i=t[a-1];pu("A",i,!0)||pu("P",i,!0)||(o=ji(o))}r+=o}return r},_processAMPM:function(e){for(var t=[zi._aMPMTwoDigit,Hi(this.cultureName).amDesignator+"/"+Hi(this.cultureName).pmDesignator,zi._aMPMSingleDigit],r=["tt","tt","t"],n=0;n<3;n++)if(xi._contains(e._value,t[n],1))return e._value=xi._replace(e._value,t[n],r[n],!0),!0;return!1},_replace:function(e,n,a,o,i,u,s){if(o||i){var l=[],c=!0;!r(e)&&t(e)&&(c=!1);for(var f=!1,d=0;d<e.length;d++){var h=e[d];if(t(h)?c=!1:r(h)&&(c=!0),o&&pu(h,n[0],s)&&c||i&&pu(h,n[0],s)&&!c){for(var m=!0,g=0;g<n.length;g++)if(g+d>=e.length||!pu(n[g],e[g+d],s)){m=!1;break}var p=d+n.length-1;if(m&&p+1<e.length){var v=e[p],y=-1;for(y=p+1;y<e.length&&pu(v,e[y],s);y++);y>p+1&&(d=y,m=!1)}m&&!f&&l.splice(0,0,d)}'"'===h&&(f=!f)}if(u._value=e,l.length>0){for(d=0;d<l.length;d++){var N=l[d];u._value=xi._remove(u._value,N,n.length),u._value=xi._insert(u._value,N,a)}return!0}return!1}return!1}},e._evaluateFormat=function(e){return yu(e,qi)},e}(),tu=function(e,t){Ru.call(this,t);var r,n=ji(e)[0];if("h"===n)r=3600;else if("m"===n)r=60;else{if("s"!==n)throw new Error(Qn.Z.Exp_TokenIllegal);r=1}this._getTimeSpan=function(e){var t=e/1e3/r;return Math.abs(t-Math.round(t))<1e-6?Math.round(t):Math.floor(t)}};tu.Name="ABSTimeFormatPart";var ru=function(){function e(e,t){Ru.call(this,t),this.foreColor=e}return e.Name="ColorFormatPart",e.prototype.toString=function(){return fu(this.foreColor)},e}(),nu=function(){function e(e,t,r,n){Mu.call(this,t,r,n);var a=this;a._isGeneralNumber=!1,a._formatType=1,a._fullFormatString=du(e);var o=vu(e);if(t&&(o=mu(o,a._partLocaleID._originalToken,a._partLocaleID.currencySymbol())),(o=du(o)).indexOf("/")>-1){var i=function(e,t){var r=[];if(e===Ii||""===e)return r;var n,a,o=!1,i=[],u=!1;for(n=0;n<e.length;n++)'"'!==(a=e[n])||o||(u=!u),o||u||"/"!==a?i.push(a):(r.push(i.join("")),i=[]),o="\\"===a&&!o;return r.push(i.join("")),r}(o);if(i&&2===i.length){a._fractionDenominatorFormat=i[1];var u=i[0];if(u){var s=u.lastIndexOf(" ");s>-1?(a._fractionIntegerFormat=iu(u,0,s),a._fractionNumeratorFormat=iu(u,s+1,u.length-s-1)):a._fractionNumeratorFormat=u}}}a._numberFormatString=o}return e.prototype={formatString:function(){return this._fullFormatString},format:function(e){if(Oi(e,"boolean"))return e.toString().toUpperCase();var t=this,r=Jn.Z._toDouble(e);if(isNaN(r)||!isFinite(r)||isNaN(e))return"string"==typeof e?e:Ii;var n,a,o,i,u,s=Gi(t.cultureName);if(t._fractionNumeratorFormat&&t._fractionDenominatorFormat){var l={value:0},c={value:0},f={value:0};if(function(e,t,r,n,a,o){var i=!!o.match(/^#\s+/),u=function(e,t){for(var r,n=t.maxDenominatorLength,a=void 0===n?7:n,o=[0,1],i=[1,0],u=e-parseInt(e),s=parseInt(u.toString().replace("0.","")),l=e,c=NaN,f=2;f<1e3;f++){var d=Math.floor(l),h=d*o[f-1]+o[f-2];if(Math.abs(o[f])>s)break;var m=d*i[f-1]+i[f-2];if(a&&m.toString().length>a)break;if(o[f]=h,i[f]=m,(r=o[f]/i[f])===c||r===e)break;c=r,l=1/(l-d)}var g=o.length-1;return g<2?{numerator:e,denominator:1}:{numerator:o[g],denominator:i[g]}}(Math.abs(e),{maxDenominatorLength:Math.min(7,t)}),s=u.numerator,l=u.denominator,c=parseInt(s/l);return e<0&&(c=-c),r.value=i&&1!==l?c:0,n.value=i&&1!==l?s%l:s,a.value=l,!0}(r,t._getDenominatorLength(),l,c,f,t._numberFormatString)){if(t._fractionIntegerFormat){u="",1===f.value&&(l.value+=c.value,c.value=0,f.value=0),0===l.value&&r<0&&(u+=s.NumberFormat.negativeSign);var d=Li(Bi(l.value,t._fractionIntegerFormat,s));d&&"0"!==d?(u+=d,u+=" "):0===l.value&&t._numberFormatString.match(/^#\s\?/)&&(u+=" "),0===r&&(u+="0"),n=t._fractionDenominatorFormat,a=parseFloat(n),!isNaN(a)&&a>0&&(0!==c.value&&0!==f.value&&(c.value*=a/f.value),f.value=a,n=n.replace(/^\d+/,function(e){return e.toString().replace(/\d/g,"?")}(a)),i=(o=Math.ceil(c.value))-c.value,c.value=i<=.5&&i>=0?parseFloat(o.toString()):parseFloat((o-1).toString()));var h=t._fractionNumeratorFormat,m=parseFloat(h);if(!isNaN(m)&&0===m){var g=h.length,p=c.value.toString(),v=p.length;g>v?h=h.substr(0,g-(g-v)):g<v&&(p=p.substr(0,v-(v-g)),c.value=parseInt(p,10))}var y=t._getFormattedFractionString(c.value,f.value,h,n,s);return 0===c.value&&(y=y.replace(/./g," "),""===d)?"0 "+y:""===(u+=y)?"0":u}u="",0===l.value&&r<0&&(u+=s.NumberFormat.negativeSign);var N=l.value*f.value+c.value;return n=t._fractionDenominatorFormat,(a=parseFloat(n))>0?(N*=a/f.value,f.value=a,u+=(N=(i=(o=Math.ceil(N))-N)<=.5&&i>=0?parseFloat(o.toString()):parseFloat((o-1).toString()))+"/"+f.value):u+=t._getFormattedFractionString(N,f.value,t._fractionNumeratorFormat,t._fractionDenominatorFormat,s),0===N?"0":u}return r.toString()}return function(e,t,r,n,a){if(!Pi(n)){var o=Eu(r,n.type,a);if(!Pi(o)){for(var i,u,s=!1,l=Gi(a),c=0,f=e.length;c<f;c++)"decimalSeparator"===e[c].type&&(s=!0,e[c].value=n._replaceNumberString(e[c].value,o,t),i=e[c].value),"number"===e[c].type&&(e[c].value=s?n._replaceNumberString(i+e[c].value,o,t).slice(1):n._replaceNumberString(e[c].value,o,t),"ja-JP"===l.name()&&e[c].value.length>1&&(""===(u=e[c].value.substr(0,2))||""===u||""===u)&&(e[c].value=e[c].value.substr(1)));return e}}return e}(Bi(r,t._numberFormatString,s),t._isGeneralNumber,t._partLocaleID,t._partDBNumberFormat,t.cultureName)},parse:function(e){var t=this;if(!e||e===$i._Empty)return Ii;var r=ji(e);if("true"===r)return!0;if("false"===r)return!1;e=t._trimSpecialSymbol(e),e=t._trimCurrencySymbol(e);var n=t._trimPercentSign(e),a=n._isPer,o=n._str;if(t._isValidaNumberString(o)){o=xi._replaceAllNoReg(o,Yi(t.cultureName).numberGroupSeparator,"");var i=bi._parseFloat(o,t.cultureName);if(!isNaN(i)&&isFinite(i))return a&&(i=ki(i/100,15)),i}return Ii},_getDenominatorLength:function(){var e=this._fractionDenominatorFormat,t=0;if(e)for(var r=e.length,n=0;n<r&&e[n].match(/[#?0\d]/);n++)t++;return t},_isValidaNumberString:function(e){for(var t="",r=0,n=0,a=0,o=!0,i=Yi(this.cultureName),u=e.length-1;u>-1;u--){if(e[u]===i.numberDecimalSeparator)r++,a>0&&(o=!1),t="";else if("e"===ji(e[u])){if(n++,t="",u===e.length-1)return!1}else if(e[u]===i.numberGroupSeparator)o=3===t.length,a++,t="";else if("-"===e[u]||"+"===e[u]){if(u>0&&"e"!==ji(e[u-1]))return!1}else{if(!Zi(e[u]))return!1;t+=e[u]}if(r>1||n>1||!o)return!1}return!0},_trimSpecialSymbol:function(e){for(var t=e,r=[],n=0;n<t.length;n++)Zi(t[n])&&r.push(n);for(var a=Yi(this.cultureName),o=[a.currencyDecimalSeparator,a.currencyGroupSeparator,a.currencySymbol,a.nanSymbol,a.negativeInfinitySymbol,a.negativeSign,a.numberDecimalSeparator,a.numberGroupSeparator,a.percentDecimalSeparator,a.percentGroupSeparator,a.percentSymbol,a.perMilleSymbol,a.positiveInfinitySymbol,a.positiveSign],i=t.length-1;i>-1;i--){var u=t[i];if(!Wi(u)||o.indexOf(u.toString())>-1){if("-"===u||"+"===u){var s=i>0?t[i-1].toString():Ii;if(["e","E","(",Yi(this.cultureName).currencySymbol].indexOf(s)<0)break}}else(i<r[0]||r[r.length-1]<i)&&(t=xi._remove(t,i,1))}return t},_trimCurrencySymbol:function(e){var t=Yi(this.cultureName).currencySymbol,r=xi._startsWith(e,t)?xi._remove(e,0,t.length):e;return r.indexOf(t)<0?r:e},_trimPercentSign:function(e){var t=Yi(this.cultureName).percentSymbol,r=!0,n=e;return xi._startsWith(e,t)?n=xi._remove(e,0,t.length):xi._endsWith(e,t)?n=xi._remove(e,e.length-t.length,t.length):r=!1,xi._contains(n,t)&&(r=!1),{_str:n,_isPer:r}},_getFormattedFractionString:function(e,t,r,n,a){var o=Li(Bi(e,r,a)),i=Li(Bi("0."+t,"#."+n,a,!0)),u=o+"/"+i.substr(i.indexOf(".")+1);return""===r&&(u=e+u),""===n&&(u+=t),u}},e}(),au=function(){function e(e,t,r,n){Mu.call(this,t,r,n),arguments.length>0?((e.indexOf("0")>=0||e.indexOf("#")>=0||e.indexOf(".")>=0||e.indexOf("@")>=0)&&Vi(),this._fullFormatString=e):this._fullFormatString="General",this._formatType=0}return e.prototype={_getDigitalFormat:function(){var e=this;if(!e._digitalFormat){var t=e._fullFormatString;t=mu(t,"General",Ui),e._digitalFormat=new nu(t,e._partLocaleID,e._partDBNumberFormat,e.cultureName),e._digitalFormat._isGeneralNumber=!0}return e._digitalFormat},_getExponentialDigitalFormat:function(){var e=this;return e._exponentialDigitalFormat||(e._exponentialDigitalFormat=new nu("0.#####E+00",e._partLocaleID,e._partDBNumberFormat,e.cultureName),e._exponentialDigitalFormat._isGeneralNumber=!0),e._exponentialDigitalFormat},formatString:function(){return xi._replace(this._fullFormatString,"@NumberFormat","General")},format:function(e){var t=this;if(Jn.Z._isNumber(e,t.cultureName)){var r=!t._partLocaleID||t._partLocaleID.allowScience(),n=Jn.Z._toDouble(e);if(n!==Ai&&n!==Ii)return wi(n)>99999999999&&r||wi(n)<1e-11&&0!==n?t._getExponentialDigitalFormat().format(e):t._getDigitalFormat().format(e)}else{if(Oi(e,"string")){var a=xi._replace(t.formatString(),'"',"");return(a=gu(a))?xi._replace(a,"General",e):e}if(Oi(e,"boolean"))return e.toString().toUpperCase()}return""},parse:function(e){if($i._isNullOrEmpty(e))return Ii;if("number"==typeof e)return e;var t,r=!1,n=xi._indexOf(e,"-");if(n>0&&!pu(e.charAt(n-1),"E",!0)&&(r=!0),xi._contains(e,"/")||r||xi._contains(e,":")||xi._contains(e,"-")){var a=Di._parseLocale(e);if(a)return a}var o="-"===e.charAt(0),i=o?xi._remove(e,0,1):e,u="("===i.charAt(0)&&")"===e.charAt(e.length-1);return(t=this._getDigitalFormat().parse(i))!==Ii&&t!==Ai?(u||o)&&Oi(t,"number")?-1*wi(t):t:e}},e}(),ou=function(){function e(e,t,r,n){var a=this;Mu.call(a,t,r,n);var o=vu(e,!1);t&&(o=mu(o,a._partLocaleID._originalToken,a._partLocaleID.currencySymbol())),o=gu(o=du(o)),a._formatString=o,a._formatType=3}return e.prototype={format:function(e){var t=this;try{var r;r=e instanceof Date?Di._toOADate(e).toString():uu(e);var n=t._parseFormat(t._formatString);return t._toFormattedObject(r,n)}catch(e){return""}},parse:function(e){return e||""},formatString:function(){return this._formatString},_parseFormat:function(e){for(var t,r="",n=!1,a=Ii,o=[],i=0;i<e.length;i++)t=e.charAt(i),n?('"'!==t?r+=t:(r+=t,o.push(r),r="",n=!1),a=t):"*"!==a&&"_"!==a&&"\\"!==a||""===r?"*"!==t&&"_"!==t&&"\\"!==t?"@"!==t?'"'!==t?(r+=t,a=t):(a=t,""!==r&&o.push(r),r=t,n=!0):(a=t,""!==r&&(o.push(r),r=""),o.push(t)):(a=t,""!==r&&(o.push(r),r=""),r+=t):(r+=t,o.push(r),r="");return""!==r&&o.push(r),o},_toFormattedObject:function(e,t){for(var r=[],n=!1,a=t.length-1;a>=0;a--){var o=t[a];"*"===o[0]?n||(n=!0,r.push({type:"fillingChar",value:o[1]})):"_"===o[0]?r.push({type:"placeholder",value:o[1]}):'"'===o[0]&&'"'===o[o.length-1]?o.length>2&&r.push({type:"text",value:o.substr(1,o.length-2)}):"@"===o[0]?r.push({type:"text",value:e}):r.push({type:"text",value:o})}return r.reverse()}},e}();function iu(e,t,r){return e.substr(t,r)}function uu(e){return Jn.Z._isNullOrUndefined(e)?"":"boolean"==typeof e?e?"TRUE":"FALSE":"string"==typeof e?e:e.toString()}var su={_positive:0,_negative:1,_zero:2,_text:3},lu=new RegExp("([.+?*$^\\[\\](){}|/])","g");function cu(e,t){if("\\"===e[t])throw new Error(Qn.Z.Exp_InvalidBackslash);if(t-1>0&&t-1<e.length&&"\\"===e[t-1]){if(t-2<0)return!0;if(t-2>0&&t-2<e.length)return"\\"!==e[t-2]}return!1}function fu(e){if(!e)throw new Error(Qn.Z.Exp_TokenIsNull);return"["+e+"]"}function du(e){if(e===Ai||e===Ii||""===e)return e;for(var t="",r=0,n=0;n<e.length;n++){var a=e[n];"["===a?r++:"]"===a?--r<0&&(r=0):0===r&&(t+=a)}return t.toString()}function hu(e){return e=mu(e,"[",""),mu(e,"]","")}function mu(e,t,r){return!e||e===$i._Empty||pu(t,r,!0)?e:(t=t.replace(lu,"\\$1"),e.replace(new RegExp(t,"g"),r))}function gu(e){for(var t=e.length,r=!1,n="",a=0;a<t;a++){var o=e.charAt(a);"\\"===o?(r=!r)||(n+=o):(r=!1,n+=o)}return n}function pu(e,t,r){return r?ji(e)===ji(t):e===t}function vu(e,t){1===arguments.length&&(t=!0);for(var r=!1,n="",a=0;a<e.length;a++){var o=e[a];if('"'===o)r=!r;else if(!r&&!t&&"/"===o&&!cu(e,a)){"_"===o&&a++;continue}n+=o}return n}function yu(e,t){if(!e||e===$i._Empty)return!1;for(var r=function(e){for(var t="",r=!1,n=0,a=e.length;n<a;n++){var o=e[n];'"'===o&&(r=!r),"E"===o||r||(t+=ji(o))}return t}(vu(e)),n=0;n<t.length;n++){var a=r.indexOf(t[n]);if(0===a)return!0;if(a>0&&"_"!==r[a-1]&&"*"!==r[a-1])return!0}return!1}var Nu=[["M/d","MMM/d","MMMM/d","d/M","d/MMM","d/MMMM","M-d","MMM-d","MMMM-d","d-M","d-MMM","d-MMMM"],["M/y","MMM/y","M/yyyy","MMM/yyyy","M-y","MMM-y","M-yyyy","MMM-yyyy"],["M/d/y","MMM/d/y","MMMM/d/y","M/d/yyyy","MMM/d/yyyy","MMMM/d/yyyy","d/M/y","d/MMM/y","d/MMMM/y","d/M/yyyy","d/MMM/yyyy","d/MMMM/yyyy","yyyy/M/d","M-d-y","MMM-d-y","MMMM-d-y","M-d-yyyy","MMM-d-yyyy","MMMM-d-yyyy","d-M-y","d-MMM-y","d-MMMM-y","d-M-yyyy","d-MMM-yyyy","d-MMMM-yyyy","yyyy-M-d"],["H:m","h:m tt"],["H:m:s","h:m:s tt","H:m:s","h:mm:ss tt"],["H:m:s.FFF","h:m:s.FFF tt"],["M/d H:m","MMM/d H:m","MMMM/d H:m","d/M H:m","d/MMM H:m","d/MMMM H:m","M/y H:m","MMM/y H:m","M/yyyy H:m","MMM/yyyy H:m","M/d/y H:m","MMM/d/y H:m","MMMM/d/y H:m","M/d/yyyy H:m","MMM/d/yyyy H:m","MMMM/d/yyyy H:m","M-d H:m","MMM-d H:m","MMMM-d H:m","d-M H:m","d-MMM H:m","d-MMMM H:m","M-y H:m","MMM-y H:m","M-yyyy H:m","MMM-yyyy H:m","M-d-y H:m","MMM-d-y H:m","MMMM-d-y H:m","M-d-yyyy H:m","MMM-d-yyyy H:m","MMMM-d-yyyy H:m","M/d h:m tt","MMM/d h:m tt","MMMM/d h:m tt","d/M h:m tt","d/MMM h:m tt","d/MMMM h:m tt","M/y h:m tt","MMM/y h:m tt","M/yyyy h:m tt","MMM/yyyy h:m tt","M/d/y h:m tt","MMM/d/y h:m tt","MMMM/d/y h:m tt","M/d/yyyy h:m tt","MMM/d/yyyy h:m tt","MMMM/d/yyyy h:m tt","M-d h:m tt","MMM-d h:m tt","MMMM-d h:m tt","d-M h:m tt","d-MMM h:m tt","d-MMMM h:m tt","M-y h:m tt","MMM-y h:m tt","M-yyyy h:m tt","MMM-yyyy h:m tt","M-d-y h:m tt","MMM-d-y h:m tt","MMMM-d-y h:m tt","M-d-yyyy h:m tt","MMM-d-yyyy h:m tt","MMMM-d-yyyy h:m tt"],["M/d H:m:s","MMM/d H:m:s","MMMM/d H:m:s","d/M H:m:s","d/MMM H:m:s","d/MMMM H:m:s","M/y H:m:s","MMM/y H:m:s","M/yyyy H:m:s","MMM/yyyy H:m:s","M/d/y H:m:s","MMM/d/y H:m:s","MMMM/d/y H:m:s","M/d/yyyy H:m:s","MMM/d/yyyy H:m:s","MMMM/d/yyyy H:m:s","d/M/y H:m:s","d/MMM/y H:m:s","d/MMMM/y H:m:s","d/M/yyyy H:m:s","d/MMM/yyyy H:m:s","d/MMMM/yyyy H:m:s","yyyy/M/d H:m:s","M-d H:m:s","MMM-d H:m:s","MMMM-d H:m:s","d-M H:m:s","d-MMM H:m:s","d-MMMM H:m:s","M-y H:m:s","MMM-y H:m:s","M-yyyy H:m:s","MMM-yyyy H:m:s","M-d-y H:m:s","MMM-d-y H:m:s","MMMM-d-y H:m:s","M-d-yyyy H:m:s","MMM-d-yyyy H:m:s","MMMM-d-yyyy H:m:s","d-M-y H:m:s","d-MMM-y H:m:s","d-MMMM-y H:m:s","d-M-yyyy H:m:s","d-MMM-yyyy H:m:s","d-MMMM-yyyy H:m:s","yyyy-M-d H:m:s","M/d h:m:s tt","MMM/d h:m:s tt","MMMM/d h:m:s tt","d/M h:m:s tt","d/MMM h:m:s tt","d/MMMM h:m:s tt","M/y h:m:s tt","MMM/y h:m:s tt","M/yyyy h:m:s tt","MMM/yyyy h:m:s tt","M/d/y h:m:s tt","MMM/d/y h:m:s tt","MMMM/d/y h:m:s tt","M/d/yyyy h:m:s tt","MMM/d/yyyy h:m:s tt","MMMM/d/yyyy h:m:s tt","d/M/y h:m:s tt","d/MMM/y h:m:s tt","d/MMMM/y h:m:s tt","d/M/yyyy h:m:s tt","d/MMM/yyyy h:m:s tt","d/MMMM/yyyy h:m:s tt","yyyy/M/d h:m:s tt","M/d/yyyy h:mm:ss tt","M-d h:m:s tt","MMM-d h:m:s tt","MMMM-d h:m:s tt","d-M h:m:s tt","d-MMM h:m:s tt","d-MMMM h:m:s tt","M-y h:m:s tt","MMM-y h:m:s tt","M-yyyy h:m:s tt","MMM-yyyy h:m:s tt","M-d-y h:m:s tt","MMM-d-y h:m:s tt","MMMM-d-y h:m:s tt","M-d-yyyy h:m:s tt","MMM-d-yyyy h:m:s tt","MMMM-d-yyyy h:m:s tt","d-M-y h:m:s tt","d-MMM-y h:m:s tt","d-MMMM-y h:m:s tt","d-M-yyyy h:m:s tt","d-MMM-yyyy h:m:s tt","d-MMMM-yyyy h:m:s tt","yyyy-M-d h:m:s tt"],["M/d H:m:s.FFF","MMM/d H:m:s.FFF","MMMM/d H:m:s.FFF","d/M H:m:s.FFF","d/MMM H:m:s.FFF","d/MMMM H:m:s.FFF","M/y H:m:s.FFF","MMM/y H:m:s.FFF","M/yyyy H:m:s.FFF","MMM/yyyy H:m:s.FFF","d/M/y H:m","d/MMM/y H:m","d/MMMM/y H:m","d/M/yyyy H:m","d/mmm/yyyy H:m","d/MMMM/yyyy H:m","yyyy/M/d H:m","M/d/y H:m:s.FFF","MMM/d/y H:m:s.FFF","MMMM/d/y H:m:s.FFF","M/d/yyyy H:m:s","MMM/d/yyyy H:m:s.FFF","MMMM/d/yyyy H:m:s.FFF","d/M/y H:m:s.FFF","d/MMM/y H:m:s.FFF","d/MMMM/y H:m:s.FFF","d/M/yyyy H:m:s.FFF","d/MMM/yyyy H:m:s.FFF","d/MMMM/yyyy H:m:s.FFF","yyyy/M/d H:m:s.FFF","M-d H:m:s.FFF","MMM-d H:m:s.FFF","MMMM-d H:m:s.FFF","d-M H:m:s.FFF","d-MMM H:m:s.FFF","d-MMMM H:m:s.FFF","M-y H:m:s.FFF","MMM-y H:m:s.FFF","M-yyyy H:m:s.FFF","MMM-Yyyy H:m:s.FFF","d-M-y H:m","d-MMM-y H:m","d-MMMM-y H:m","d-M-yyyy H:m","d-MMM-yyyy H:m","d-MMMM-yyyy H:m","yyyy-M-d H:m","M-d-y H:m:s.FFF","MMM-d-y H:m:s.FFF","MMMM-d-y H:m:s.FFF","M-d-yyyy H:m:s","MMM-d-yyyy H:m:s.FFF","MMMM-d-yyyy H:m:s.FFF","D-M-y H:m:s.FFF","d-MMM-y H:m:s.FFF","d-MMMM-y H:m:s.FFF","D-M-yyyy H:m:s.FFF","d-MMM-yyyy H:m:s.FFF","d-MMMM-yyyy H:m:s.FFF","yyyy-M-d H:m:s.FFF","M/d h:m:s.FFF tt","MMM/d h:m:s.FFF tt","MMMM/d h:m:s.FFF tt","d/M h:m:s.FFF tt","d/MMM h:m:s.FFF tt","d/MMMM h:m:s.FFF tt","M/y h:m:s.FFF tt","MMM/y h:m:s.FFF tt","M/yyyy h:m:s.FFF tt","MMM/yyyy h:m:s.FFF tt","d/M/y h:m tt","d/MMM/y h:m tt","d/MMMM/y h:m tt","d/M/yyyy h:m tt","d/mmm/yyyy h:m tt","d/MMMM/yyyy h:m tt","yyyy/M/d h:m tt","M/d/y h:m:s.FFF tt","MMM/d/y h:m:s.FFF tt","MMMM/d/y h:m:s.FFF tt","M/d/yyyy h:m:s tt","MMM/d/yyyy h:m:s.FFF tt","MMMM/d/yyyy h:m:s.FFF tt","d/M/y h:m:s.FFF tt","d/MMM/y h:m:s.FFF tt","d/MMMM/y h:m:s.FFF tt","d/M/yyyy h:m:s.FFF tt","d/MMM/yyyy h:m:s.FFF tt","d/MMMM/yyyy h:m:s.FFF tt","yyyy/M/d h:m:s.FFF tt","M-d h:m:s.FFF tt","MMM-d h:m:s.FFF tt","MMMM-d h:m:s.FFF tt","d-M h:m:s.FFF tt","d-MMM h:m:s.FFF tt","d-MMMM h:m:s.FFF tt","M-y h:m:s.FFF tt","MMM-y h:m:s.FFF tt","M-yyyy h:m:s.FFF tt","MMM-Yyyy h:m:s.FFF tt","d-M-y h:m tt","d-MMM-y h:m tt","d-MMMM-y h:m tt","d-M-yyyy h:m tt","d-MMM-yyyy h:m tt","d-MMMM-yyyy h:m tt","yyyy-M-d h:m tt","M-d-y h:m:s.FFF tt","MMM-d-y h:m:s.FFF tt","MMMM-d-y h:m:s.FFF tt","M-d-yyyy H:m:s tt","MMM-d-yyyy H:m:s.FFF tt","MMMM-d-yyyy h:m:s.FFF tt","d-M-y h:m:s.FFF tt","d-MMM-y h:m:s.FFF tt","d-MMMM-y h:m:s.FFF tt","d-M-yyyy h:m:s.FFF tt","d-MMM-yyyy h:m:s.FFF tt","d-MMMM-yyyy h:m:s.FFF tt","yyyy-M-d h:m:s.FFF tt"]];function Mu(e,t,r){this._partLocaleID=e,this._partDBNumberFormat=t,this.cultureName=r}function Ru(e){this._originalToken=e}function _u(e){var t,r=hu(e);if(!r||r===$i._Empty)return t;var n=r[0];return["<",">","="].indexOf(n)>-1?(t=Ji).Name="ConditionalFormatPart":xi._startsWith(r,"DBNum",!0)?(t=Qi).Name="DBNumberFormatPart":pu(r[0],"$",!1)&&r.indexOf("-")>-1?(t=Xi).Name="LocaleIDFormatPart":function(e){var t=ji(e),r=t[0];if("h"!==r&&"m"!==r&&"s"!==r)return!1;for(var n=1;n<t.length;n++)if(r!==t[n])return!1;return!0}(r)?(t=tu).Name="ABSTimeFormatPart":r.indexOf("$")<0&&r.length>=3&&((t=ru).Name="ColorFormatPart"),t}function Eu(e,t,r){var n=(e?e.cultureInfo():Gi(r)).NumberFormat.dbNumber;return n?n[t]:Ii}var Tu=function(){function e(e,t){var r=this;0===arguments.length?(r.formatCached="General",r._numberFormat=new au):r._init(e,t)}var t=["colorFormatPart","conditionalFormatPart","dbNumberFormatPart","localeIDFormatPart"];function r(e){if(!e||e===$i._Empty)throw new Error(Qn.Z.Exp_TokenIllegal)}function n(e){r(e);var t=hu(e);return r(t),t}function a(e){var t=n(e);return"$"===t[0]&&(t=t.slice(1)),'"'+t+'"'}return e.prototype={_init:function(e,t){e!==Ii&&e!==Ai||Vi();var r=e,o=this;o.formatCached=e;for(var i="",u="",s=!1,l=[],c=0;c<e.length;c++){var f=e[c];if("["===f)s&&Vi(),u&&(i||(i=""),i+=u),u=f.toString(),s=!0;else if("]"===f){if(s||Vi(),u){var d=(u+=f).toString(),h=_u(u.toString());if(h)"ABSTimeFormatPart"===h.Name?(l.push(new h(n(d),d)),i+=u):o.addPart(h,d);else{var m=a(d);i+=m,r=mu(e,d,m)}u=""}else Vi();s=!1}else u+=f}u?s?Vi():i+=u:i||(i=o._getDBNumberDefaultFormat()),o.localeIDFormatPart&&(t=o.localeIDFormatPart.cultureInfo().name());var g,p,v,y,N=(g=i,p=o.conditionalFormatPart,y=!1,yu(g=g?g.toString():$i._Empty,["general"])?v=au:eu._evaluateFormat(g)?v=eu:yu(g,["E+","E-","#",".",",","%","0","/","?"])||p?(y=!0,v=nu):(y=!0,v=ou),{_isDigitalOrText:y,_type:v}),M=N._type,R=N._isDigitalOrText?r:i;M?o._numberFormat=new M(R,o.localeIDFormatPart,o.dbNumberFormatPart,t,l.length>0?l:Ii):Vi()},_getDBNumberDefaultFormat:function(){var e=this,r="";return e.dbNumberFormatPart&&(t.some((function(t){return"dbNumberFormatPart"!==t&&e[t]}))||(r="General")),r},formatString:function(){for(var e=this,r="",n=0,a=t.length;n<a;n++){var o=t[n];e[o]&&(r+=e[o].toString())}return r+e._numberFormat.formatString()},addPart:function(e,r){for(var a=n(r),o=0,i=t.length;o<i;o++){var u=t[o];if(pu(u,e.Name,!0)){if(this[u])throw new Error(Qn.Z.Exp_DuplicatedDescriptor);this[u]=new e(a,r)}}},format:function(e){return this._numberFormat.format(e)},parse:function(e){return this._numberFormat.parse(e)}},e}(),Su=function(e){function t(e,t){var r=this;r._isSingleFormatterInfo=!0,r.PropertyChanged=[],$i._isNullOrEmpty(e)&&(e="General"),r.formatCached=e,r.cultureName=t,r.init()}function r(e){var r=t[e];return r||(r=new t(e),t[e]=r),r}return Jn.Z._inherit(t,e),t.prototype={toJSON:function(){var e=this,t={formatCached:e.formatCached};return e.cultureName&&(t.customerCultureName=e.cultureName),"general"===ji(e.formatCached)&&delete t.formatCached,t},hasFormatedColor:function(){for(var e in su)if(su.hasOwnProperty(e)){var t=this.getFormatter(su[e]);if(t&&t.colorFormatPart)return!0}return!1},formatString:function(e){var t=this;if(0===arguments.length){for(var r=$i._Empty,n=0,a=t.formatters.length;n<a;n++){var o=t.formatters[n];r+=o.formatString(),n!==a-1&&(r+=";")}return r}if(!e)throw new Error(Qn.Z.Exp_ValueIsNull);return t.formatters=Ii,t.formatCached=e,t.init(),t._raisePropertyChanged("formatString"),t},getFormatter:function(e){return this.formatters&&this.formatters[e]},getPreferredEditingFormatter:function(e){var t=Hi(this.cultureName);if(Oi(e,"DateTime")){var n=0===e.getHours()&&0===e.getMinutes()&&0===e.getSeconds()&&0===e.getMilliseconds()?"":" h:mm:ss";return r(t.shortDatePattern+n)}if(Oi(e,"TimeSpan"))return r(t.longTimePattern);if(Jn.Z._isNumber(e,this.cultureName)){var a=Jn.Z._toDouble(e);return r(a>=1e20||a<=1e-17&&a>0||a<=-1e20||a<0&&a>=-1e-17?"0.##E+00":Ui)}return r("General")},getPreferredDisplayFormatter:function(e,n){var a=this;if(n||(n={value:Ii}),n.value=Ii,$i._isNullOrEmpty(e))return new t;var o=e,i=n.value=a.parse(o);if(Oi(i,"DateTime")||Oi(i,"TimeSpan"))for(var u={pattern:Nu,formatter:["d-mmm","mmm-yy",Hi().shortDatePattern,"h:mm","h:mm:ss","h:mm:ss.0",Hi().shortDatePattern+" h:mm",Hi().shortDatePattern+" h:mm:ss",Hi().shortDatePattern+" h:mm:ss.0"]},s=u.pattern,l=u.formatter,c=0;c<s.length;c++)for(var f=s[c],d=0;d<f.length;d++){var h=f[d],m=Di._parseLocale(e,h);if(m&&m-i==0)return new t(l[c])}else if(Jn.Z._isNumber(i,a.cultureName)){var g=Yi(a.cultureName),p=g.currencySymbol,v=g.numberDecimalSeparator,y=g.percentSymbol,N=g.numberGroupSeparator,M=xi._contains,R=M(o,v)?".00":"";if(o[0]===p)return r($i._format("{0}#,##0{1};[Red]({0}#,##0{1})",p,R));if(M(o,"E",1))return r("0.00E+00");if(o[0].toString()===y||o[o.length-1].toString()===y)return r($i._format("0{0}%",R));if(M(o,N))return r($i._format("#,##0{0}",R))}return r("General")},format:function(e,t){if(Oi(e,"boolean"))return e.toString().toUpperCase();var r=this._getFormatInfo(e);if(r){var n=r.colorFormatPart;t&&n&&(t.conditionalForeColor=t.value=n.foreColor);var a=0,o=Jn.Z._isNumber(e,self.cultureName);o&&(a=Jn.Z._toDouble(e));var i=$i._Empty;try{o&&r===this.getFormatter(su._negative)?i=r.format(wi(a)):(i=r.value)===Ai&&(i=r.format(e)),t&&(t.content=Fi(i)?i:[{type:"text",value:i}]),Fi(i)&&(i=bi._formatObjectToSrting(i))}catch(t){Oi(e,"string")&&(i=e.toString())}return i===r.formatCached&&(""!==e&&null!=e&&!isNaN(e)||(i=e)),i}return o&&a<0?"-".toString():Oi(e,"string")?e.toString():e===Ai||e===Ii?$i._Empty:e.toString()},parse:function(e){var t=this;return t.formatters&&t.formatters.length>0?t.formatters[0].parse(e):Ii},init:function(){var e=this,t=e.formatCached;$i._isNullOrEmpty(t)&&Vi(),e.formatters=[];var r=t.split(";");e._isSingleFormatterInfo=1===r.length,(!r||r.length<1||r.length>4)&&Vi();for(var n=0;n<r.length;n++){var a=new Tu(r[n],e.cultureName);e.formatters.push(a)}e.getFormatter(su._positive)||Vi()},_getFormatInfo:function(e){var t=this,r=t.getFormatter(su._positive),n=r&&r.conditionalFormatPart,a=t.getFormatter(su._text);if("string"==typeof e&&isNaN(e))return a||(n?e:r);if(Jn.Z._isNumber(e,t.cultureName)||Oi(e,"boolean")){var o,i=t.getFormatter(su._negative),u=t.getFormatter(su._zero),s=Jn.Z._toDouble(e),l=n&&r.conditionalFormatPart.isMeetCondition(s),c=i&&i.conditionalFormatPart,f=c&&i.conditionalFormatPart.isMeetCondition(s);if(t._isSingleFormatterInfo||(n?l:s>0||0===s&&!u))o=r;else if(c?f:s<0)o=i;else if(u)o=u;else if(i){if(n&&c)return{value:""===u?"":s+""};o=i}return o}return Ii},_raisePropertyChanged:function(e){var t=this;if(t.PropertyChanged)for(var r=0;r<t.PropertyChanged.length;r++){var n=t.PropertyChanged[r];"function"==typeof n&&n(t,e)}}},t}(Ki),Cu={BAND_INDEX_CONST:-2147483648,MAX_ROW_COUNT:1048576,MAX_COLUMN_COUNT:16384},Iu=[14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,11,24,24,24,26,24,24,24,20,21,24,25,24,19,24,24,8,8,8,8,8,8,8,8,8,8,24,24,25,25,25,24,24,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,20,24,21,27,18,27,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,20,25,21,25,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,11,24,26,26,26,26,28,28,27,28,1,22,25,19,28,27,28,25,10,10,27,1,28,24,27,10,1,23,10,10,10,24,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,25,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,25,1,1,1,1,1,1,1,1];function Au(e){return e<=255}function wu(e){return e<=127}Cu.isDigit=function(e){return e>=48&&e<=57},Cu._isLetter=function(e){var t=e.charCodeAt(0);return!Au(t)||(wu(t)?(t|=32)>=96&&t<=122:0===Iu[t]||1===Iu[t])},Cu._isLetterOrDigit=function(e){var t=e.charCodeAt(0);return!Au(t)||(wu(t)?t<=57?t>=48:(t|=32)>=96&&t<=122:0===Iu[t]||1===Iu[t])};var xu=Cu,Du=hn;function bu(e,t){try{return t[0][0].join(e)}catch(e){}}var Ou=ea.Z._getLength,Fu=Math.pow,Uu=Math.sqrt;function Lu(){var e,t=arguments;t[t.length-1].isHiddenCells&&"[object Object]"===Object.prototype.toString.call(t[t.length-1])&&(e=t[t.length-1],t=Array.from(t).slice(0,-1));var r,n=0,a=0;for(r=0;r<t.length;r++){var o,i=t[r],u=void 0,s=!1;if(ht(i)){if(u=e&&e[r],(o=i.toArray()).error&&o.error.length>0)return o.error[0]}else if(Array.isArray(i)){if((o=Kn(i)).error&&o.error.length>0)return o.error[0]}else s=!0,o=Kn(i);for(var l=0;l<o.length;l++){if(u){var c=o.row+Math.floor(l/o.colCount),f=o.col+l%o.colCount;if(u[c]&&u[c][f])continue}var d=o[l];if("number"==typeof d)n+=d,a++;else if(s&&"string"==typeof d){var h=parseFloat(d);if(isNaN(h))throw new Error(Bt.value);n+=h,a++}else s&&"boolean"==typeof d&&(n+=Number(d),a++)}}if(0===a)throw new Error(Bt.div0);return n/a}function Bu(e){var t,r,n,a,o=arguments,i=0,u=0,s=(e=Kn(e)).length,l=o.length,c=[];for(c.push(e),n=1;n<l;n+=2){if((a=Kn(o[n])).error&&a.error.length>0)return a.error[0];c.push(a);var f=o[n+1],d=ga._parseCriteria(f);c.push(d)}for(r=0;r<s;r++)if("number"==typeof(t=e[r])){var h=!0;for(n=1;n<l&&(h=(d=c[n+1])(c[n][r]));n+=2);h&&(i+=t,u++)}return 0===u?Bt.div0:Wn(i/u)}function ku(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var n;"[object Object]"===Object.prototype.toString.call(t[t.length-1])&&t[t.length-1].isHiddenCells&&(n=t[t.length-1],t=t.slice(0,-1));for(var a=[],o=0;o<t.length;o++){var i=void 0,u=void 0,s=t[o],l=!1;if(ht(s))i=n&&n[o],u=s.toArray();else if(Array.isArray(s)){if((u=Kn(s)).error&&u.error.length>0)return u.error[0]}else l=!0,u=Kn(s);for(var c=0;c<u.length;c++){var f=u.row+Math.floor(c/u.colCount),d=u.col+c%u.colCount;if(!(i&&i[f]&&i[f][d])){var h=u[c];l&&"number"!=typeof h&&(h=parseFloat(h)),"number"!=typeof h||isNaN(h)||a.push(h)}}}return a.length}function Pu(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var n,a=rt._instance;"[object Object]"===Object.prototype.toString.call(t[t.length-1])&&t[t.length-1].isHiddenCells&&(n=t[t.length-1],t=t.slice(0,-1));for(var o=0,i=0;i<t.length;i++){var u=t[i];if(ht(u))for(var s=n&&n[i],l=u.identities,c=0;c<l.length;c++)for(var f=l[c],d=0;d<f.rowCount;d++)for(var h=0;h<f.colCount;h++){var m=f.row+d,g=f.col+h;if(!(s&&s[m]&&s[m][g])){var p=a.custom.cellEditValue(d+f.row,h+f.col,f.sheetId);null!==p&&""!==p&&o++}}else o+=Kn(u).length}return o}function Gu(e){var t=rt._astNodes[0];if(Array.isArray(e)){if(Nt(t))return Bt.value;e=hn(e)}else{if(!gt(t))return Bt.value;e=[e]}for(var r=0,n=0;n<Ou(e);n++)null!==e[n]&&""!==e[n]||r++;return r}var Hu={};function Yu(e,t){var r=0===t||"*"===t,n=Hu[t];return n||(n=ga._parseCriteria(t)),!(r&&null===e||!n||!n(e))}function ju(e,t){for(var r=0,n=0;n<ea.Z._getLength(e);n++)Yu(e[n],t)&&r++;return Wn(r)}function Vu(e,t){var r,n,a,o=0;if(e=Kn(e),Array.isArray(t)||ht(t)){for(t=Kn(t),a=0;a<ea.Z._getLength(t);a++){if(Pt(n=ju(e,t[a])))return n;if(r=Yn(n),isNaN(r))return Bt.value;o+=r}return o}return ju(e,t)}function $u(){for(var e,t=0,r=[],n=arguments.length,a=new Array(n),o=0;o<n;o++)a[o]=arguments[o];if(a.length%2!=0)throw new Error(Bt.paramsLack);Array.isArray(a[0])||(a[0]=[[[a[0]]]]);for(var i=0;i<a.length;i+=2){var u=a[i][0],s=u.length+"-"+u[0].length;if(void 0===e)e=s;else if(e!==s)throw new Error(Bt.value);a[i]=a[i][0];var l=a[i+1];r.push({values:a[i],criteria:l})}for(var c=r[0].values.length,f=r[0].values[0].length,d=function(e){for(var n=function(n){r.every((function(t){var r=t.values,a=t.criteria;return Yu(r[e][n],a)}))&&t++},a=0;a<f;a++)n(a)},h=0;h<c;h++)d(h);return t}function Zu(e,t){var r=rt._instance.helper.getRangeValue;if(ht(e)){var n=e.getIdentities(0);e=r({newLine:n.colCount},n)}if(ht(t)){var a=t.getIdentities(0);t=r({newLine:a.colCount},a)}var o,i,u,s=0,l=t.rowCount,c=t.colCount;for(o=0;o<l;o++)for(i=0;i<c;i++)"number"==typeof t[o][i]&&s++;var f=e.rowCount,d=e.colCount,h=[],m=[],g=s+1;for(s=0,o=0;o<l;o++)for(i=0;i<c;i++)(u=t[o][i])!==qn&&(h[s++]=Yn(u));var p=h.slice(0);for(h.sort((function(e,t){return e-t})),o=0;o<g;o++)m[o]=[0];for(o=0;o<f;o++)for(i=0;i<d;i++)if(kn(u=e[o][i])){for(var v=Yn(u),y=!1,N=0;!y&&N<s;N++)v<=h[N]&&(m[p.indexOf(h[N])][0]++,y=!0);y||m[s][0]++}return[m]}function Wu(e){var t;"[object Object]"===Object.prototype.toString.call(e[e.length-1])&&e[e.length-1].isHiddenCells&&(t=e[e.length-1],e=e.slice(0,-1));for(var r=[],n=0;n<e.length;n++){var a=t&&t[n],o=Kn(e[n]);if(o.error&&o.error.length>0)throw new Error(o.error[0]);for(var i=0;i<o.length;i++){var u=o.row+Math.floor(i/o.colCount),s=o.col+i%o.colCount;if(!(a&&a[u]&&a[u][s])){var l=o[i];"number"!=typeof l||isNaN(l)||r.push(l)}}}return r}function Xu(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var n=Wu(t);return 0===n.length?0:Math.max.apply(Math,n)}function Ku(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var n=Wu(t);return 0===n.length?0:Math.min.apply(Math,n)}var zu={};function qu(e){if(!e)throw new Error(Bt.na);for(var t=[],r=e[0],n=0;n<r.length;n++)for(var a=0;a<r[n].length;a++)Array.isArray(t[a])||(t[a]=[]),t[a].push(r[n][a]);return[t]}zu.P=function(){var e=Ju.P.apply(this,arguments);return Rn(e)?e:Math.sqrt(e)},zu.S=function(){var e=Ju.S.apply(this,arguments);return Rn(e)?e:Math.sqrt(e)};var Ju={};function Qu(e,t,r,n){if(void 0===n&&(n=0),Array.isArray(r)||""===r)return Bt.value;if(r=Yn(r=wn(r,rt._astNodes[0])),isNaN(r))return Bt.value;if(Array.isArray(t)&&!Nt(rt._astNodes[1]))t=hn(t);else{if(!gt(rt._astNodes[1]))return Bt.value;t=[t]}if(t=t.filter((function(e){return"number"==typeof e})),Cn(n,rt._astNodes[2]))return Bt.value;if("string"==typeof n)switch(n.toLowerCase()){case"true":n=1;break;case"false":case"":n=0}if("number"!=typeof n)return Bt.value;var a,o,i,u=0,s=0,l=0;for(a=0,i=Ou(t);a<i;a++)(o=t[a])!==qn&&(o<r?u++:r<o?l++:s++);if(0===s)return Bt.na;var c=(0===n?l:u)+1;return e?c:c+(s-1)/2}Ju.P=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];for(var n=Wu(t),a=n.length,o=0,i=Lu.apply(void 0,t),u=0;u<a;u++)o+=Math.pow(n[u]-i,2);return o/a},Ju.S=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];for(var n=Wu(t),a=n.length,o=0,i=Lu.apply(void 0,t),u=0;u<a;u++)o+=Math.pow(n[u]-i,2);return o/(a-1)};var es={};function ts(e,t,r){var n=0,a=0,o=ga._parseCriteria(t);if(e.rowCount!==r.rowCount||e.colCount!==r.colCount)return Bt.value;for(var i=0;i<ea.Z._getLength(e);i++){var u=e[i];if(o&&o(u)){var s=r[i];"number"==typeof s&&(n=vn(n,s),a++)}}return 0===a?Bt.div0:Wn(n/a)}function rs(e,t,r,n){var a,o,i,u=e?t.length:t.getRowCount(0),s=e?t[0].length:t.getColumnCount(0),l=[];for(e||(i=t.toArray()),a=0;a<u;a++)for(l[a]=[],o=0;o<s;o++){var c=e?t[a][o]:i[a*s+o];l[a][o]=ts(r,c,n)}return[l]}function ns(e,t,r){if(!ht(e)||!ht(r)&&void 0!==r)throw new Error(Bt.paramsErr);if(void 0!==r){var n=rt._instance.helper.getRangeValue,a=e.identities[0];e=n(void 0,a);var o=r.identities[0];if((r=n(void 0,{sheetId:o.sheetId,row:o.row,col:o.col,rowCount:a.rowCount,colCount:a.colCount,refType:a.refType})).error&&r.error.length>0)return r.error[0]}else{if((e=Kn(e)).error&&e.error.length>0)return e.error[0];r=e}return ht(t)?rs(!1,t,e,r):Array.isArray(t)?rs(!0,t=t[0],e,r):ts(e,t,r)}function as(){for(var e,t,r,n,a=0,o=0,i=arguments.length,u=new Array(i),s=0;s<i;s++)u[s]=arguments[s];var l=function(){var i=rt._astNodes[e];if(n=u[e],Array.isArray(n))n=hn(n),Nt(i)||(n=n.filter((function(e){return null!==e}))),n=n.map((function(e){return e=An(e,i,!0),Za._isString(e)?0:e}));else{if(n=wn(n,i),Za._isString(n)&&!gt(i))return{v:Bt.value};n=null===n?[]:[n]}for(t=0;t<Ou(n);t++)r=n[t],Za._isNumber(r)||Za._isBoolean(r)?(a+=Yn(r),o++):(null===r||Za._isString(r))&&o++};for(e=0;e<Ou(u);e++){var c=l();if("object"===typeof c)return c.v}return 0===o?Bt.div0:Wn(a/o)}function os(e,t,r){return e=wn(e,rt._astNodes[0]),t=wn(t,rt._astNodes[1]),""===e?Bt.num:(e=(e=Array.isArray(e)?hn(e):[e]).filter((function(e){return"number"==typeof e})),Za._st_includeAggregateMulti([e,t],r))}function is(e,t){return os(e,t,15)}function us(e,t){return os(e,t,14)}function ss(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];for(var n=0,a=t.length;n<a;n++){var o=t[n],i=rt._astNodes[n];if(Array.isArray(o))o=(o=hn(o)).filter((function(e){return"number"==typeof e})),t[n]=o;else{if(gt(i)&&"number"!=typeof o){o=qn,t[n]=[o];continue}if(o=wn(o,i),o=Number(o),isNaN(o))return Bt.value;t[n]=[o]}}return Za._st_includeAggregateMulti(t,12)}es.EQ=function(e,t,r){return void 0===r&&(r=0),Qu(!0,t,e,r)},es.AVG=function(e,t,r){return void 0===r&&(r=0),Qu(!1,t,e,r)};var ls={};function cs(e,t,r){for(var n=0,a=e.length;n<a;n++){var o=e[n];Array.isArray(o)?(o=(o=hn(o)).filter((function(e){return"number"==typeof e})),e[n]=o):(""===(o=wn(o,rt._astNodes[n]))&&(o={}),e[n]=[o])}var i={_sumx:0,_sumx2:0,n:0},u=function(e,t){var r,n,a,o,i;for(o=0;o<Ou(e);o++)for(r=e[o],i=0;i<Ou(r);i++)if(null===(a=r[i]))t.n++;else if(Za._isString(a)){var u={value:0};if(Vn(a,u))n=u.value,t._sumx+=n,t._sumx2+=n*n;else if(!Array.isArray(r))return Bt.value;t.n++}else{if(Pn(a))return a;kn(a)&&(n=Yn(a),t._sumx+=n,t._sumx2+=n*n,t.n++)}}(e,i);if(Pn(u))return u;if(i.n<=t)return Bt.div0;var s=Math.max(0,(i.n*i._sumx2-i._sumx*i._sumx)/(i.n*(i.n-t)));return Wn(s=r?Math.sqrt(s):s)}function fs(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return cs(t,1,!0)}function ds(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return cs(t,0,!0)}function hs(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return cs(t,1,!1)}function ms(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return cs(t,0,!1)}function gs(e,t){if(!Array.isArray(e)||!Array.isArray(t))return Bt.div0;e=(e=hn(e)).map((function(e){return"number"!=typeof e&&(e=qn),e})),t=(t=hn(t)).map((function(e){return"number"!=typeof e&&(e=qn),e}));var r,n,a,o,i=0,u=0,s=0,l=0,c=0,f=Ou(t);if(f!==Ou(e))return Bt.na;var d,h,m,g=0;for(d=0;d<f;d++)h=e[d],m=t[d],h!==qn&&m!==qn&&(i+=h,u+=m,s+=h*h,l+=m*m,g++);if(g<=1)return Bt.div0;if(r=i/g,n=u/g,a=Math.sqrt((g*s-i*i)/(g*(g-1))),o=Math.sqrt((g*l-u*u)/(g*(g-1))),0===a||0===o)return Bt.div0;for(d=0;d<f;d++)h=e[d],m=t[d],h!==qn&&m!==qn&&(c+=(h-r)*(m-n));return Wn(c/Yn((g-1)*a*o))}function ps(e,t){for(var r=0,n=t.length;r<n;r++){var a=t[r];if(Array.isArray(a))a=(a=hn(a)).filter((function(e){return"number"==typeof e})),t[r]=a;else{var o=rt._astNodes[r];if(a=wn(a,o),gt(o)&&"number"!=typeof a&&(a=0),a=Number(a),isNaN(a))return Bt.value;t[r]=[a]}}var i,u,s,l,c=e?1:0,f=0;for(s=0;s<Ou(t);s++)for(i=t[s],l=0;l<Ou(i);l++)if((u=i[l])!==qn){if(u<=0)return Bt.num;c=e?c*u:c+1/u,f++}return e?f<=0?Bt.div0:Wn(Math.pow(c,1/f)):0===c?Bt.div0:Wn(f/c)}function vs(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return ps(!0,t)}function ys(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return ps(!1,t)}function Ns(e,t){if(e=wn(e,rt._astNodes[0]),t=wn(t,rt._astNodes[1]),e=Yn(e),t=Yn(t),isNaN(e)||isNaN(t))return Bt.value;if(t=Math.floor(t),e<0)return Bt.num;if(t<1||t>1e10)return Bt.num;var r,n,a,o,i=Math.log(Math.sqrt(Math.PI)),u=1/Math.sqrt(Math.PI),s=0,l=e,c=.5*l,f=t%2==0;t>1&&(s=Math.exp(-c));var d=Za._st_normsdist(-Math.sqrt(l));if(Pn(d))return d;var h=Yn(d);if(n=f?s:2*h,t>2){if(l=.5*(t-1),a=f?1:.5,c>20){for(r=f?0:i,o=Math.log(c);a<=l;)r=Math.log(a)+r,n+=Math.exp(o*a-c-r),a+=1;return n}for(r=f?1:u/Math.sqrt(c),o=0;a<=l;)o+=r*=c/a,a+=1;return o*s+n}return n}function Ms(){return function(){for(var e,t=[],r=0,n=arguments.length;r<n;r++){var a=r<0||arguments.length<=r?void 0:arguments[r];if(Array.isArray(a))a=(a=hn(a)).filter((function(e){return"number"==typeof e})),t=t.concat(a);else{var o=rt._astNodes[r];if(a=wn(a,o),gt(o)&&"number"!=typeof a)continue;if(a=Number(a),isNaN(a))return Bt.value;t.push(a)}}var i,u,s,l,c,f=0,d=0,h=0,m=0,g=Ou(t),p=[];if(g>0){for(c=t,p.push(c),s=0;s<Ou(c);s++)(e=c[s])!==qn&&(f+=e,d+=e*e,m++);if(m<=3)return Bt.div0;if(i=f/m,0===(u=Uu((m*d-f*f)/(m*(m-1)))))return Bt.div0;for(l=0;l<g;l++)for(c=p[l],s=0;s<Ou(c);s++)(e=c[s])!==qn&&(h+=Fu((e-i)/u,4));return Wn(m*(m+1)*h/((m-1)*(m-2)*(m-3))-3*(m-1)*(m-1)/((m-2)*(m-3)))}}.apply(void 0,arguments)}function Rs(e,t){Array.isArray(e)&&(e=(e=hn(e)).map((function(e){return"number"!=typeof e?qn:e}))),Array.isArray(t)&&(t=(t=hn(t)).map((function(e){return"number"!=typeof e?qn:e})));var r,n,a,o=0,i=0,u=0,s=0,l=0,c=Ou(e);if(c!==Ou(t))return Bt.na;for(a=0;a<c;a++)r=e[a],(n=t[a])!==qn&&r!==qn&&(o+=r,i+=n,u+=n*n,s+=n*r,l++);return 0===l||l*u-i*i==0?Bt.div0:Wn(o/l-(l*s-i*o)/(l*u-i*i)*(i/l))}function _s(e,t){Array.isArray(e)&&(e=(e=hn(e)).map((function(e){return"number"!=typeof e?qn:e}))),Array.isArray(t)&&(t=(t=hn(t)).map((function(e){return"number"!=typeof e?qn:e})));var r=0,n=0,a=0,o=0,i=0,u=Ou(e);if(u!==Ou(t))return Bt.na;for(var s=0,l=0;l<u;l++){var c=e[l],f=t[l];Za._isNumber(c)&&Za._isNumber(f)&&(r+=c,n+=f,a+=c*c,o+=f*f,i+=c*f,s++)}return s*a-r*r==0||s*o-n*n==0?Bt.div0:(s*i-r*n)/Math.sqrt((s*a-r*r)*(s*o-n*n))}function Es(e,t){Array.isArray(e)&&(e=(e=hn(e)).map((function(e){return"number"!=typeof e?qn:e}))),Array.isArray(t)&&(t=(t=hn(t)).map((function(e){return"number"!=typeof e?qn:e})));var r=0,n=0,a=0,o=0,i=0,u=0,s=Ou(t);if(s!==Ou(e))return Bt.na;for(var l=0;l<s;l++){var c=t[l],f=e[l];Za._isNumber(c)&&Za._isNumber(f)&&(r+=c,n+=f,a+=c*c,o+=f*f,i+=c*f,u++)}var d=Uu((u*a-r*r)*(u*o-n*n));if(0===d)return Bt.div0;var h=(u*i-r*n)/d;return Wn(h*h)}ls.SNGL=function(){for(var e=[],t=0,r=arguments.length;t<r;t++){var n=t<0||arguments.length<=t?void 0:arguments[t];if(rt._astNodes[t],Array.isArray(n))n=(n=hn(n)).filter((function(e){return"number"==typeof e})),e=e.concat(n);else{if("number"!=typeof n)return Bt.value;e.push(n)}}return Za._st_includeAggregateMulti(e,13)};var Ts={};function Ss(){return function(e,t){var r=Array.isArray(e)?hn(e):[e],n=Array.isArray(t)?hn(t):[t],a=0,o=0,i=0,u=0,s=0,l=Ou(n);if(l!==Ou(r))return Bt.na;for(var c=0;c<l;c++){var f=r[c],d=n[c];if(d!==qn&&f!==qn&&!Pn(d)&&!Pn(f)&&"number"==typeof f&&"number"==typeof d){var h=Yn(f),m=Yn(d);a+=h,o+=m,i+=m*m,u+=m*h,s++}}return s*i-o*o==0?Bt.div0:Wn((s*u-o*a)/(s*i-o*o))}.apply(void 0,arguments)}function Cs(){return function(e,t){if("number"!=typeof t||t<0||t>=1)throw new Error(Bt.num);var r=0,n=[];Fa(hn(e).filter((function(e){return"number"==typeof e})),n);for(var a=function(e){for(var t=0,r=0;r<e.length;r++)e[r]!==qn&&t++;return t}(n),o=parseInt((a*t/2).toString(),10),i=o;i<a-o;i++)r+=Yn(n[i]);return r/(a-2*o)}.apply(void 0,arguments)}function Is(e,t){for(var r=[],n=function(e,n){var a=t[e],o=rt._astNodes[e];if(Array.isArray(a))a=(a=hn(a)).map((function(e){return Nt(o)||(e=An(e,o,!0),Za._isString(e)&&(e=0)),e})),a=a.filter((function(e){return Za._isNumber(e)})),r=r.concat(a);else{if(""===(a=wn(a,o)))return"continue";if(a=Yn(a),isNaN(a))return{v:Bt.value};r.push(a)}},a=0,o=t.length;a<o;a++){var i=n(a);if("continue"!==i&&"object"===typeof i)return i.v}var u,s,l,c=!1,f=0;for(s=0;s<Ou(r);s++)if(kn(l=r[s])||Za._isBoolean(l)||Za._isString(l))u=Za._isString(l)?0:Yn(l),(!c||e&&u>f||!e&&u<f)&&(f=u),c=!0;else if(Pn(l))return l;return f}function As(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return Is(!0,t)}function ws(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return Is(!1,t)}function xs(e,t,r,n){if(void 0===r&&(r=3),e=Array.isArray(e)?(e=hn(e)).filter((function(e){return"number"==typeof e})):[e=wn(e,rt._astNodes[0])],t=wn(t,rt._astNodes[1]),r=wn(r,rt._astNodes[2],!0),t=Yn(t),isNaN(t))return Bt.value;if(""===r&&(r=3),(r=Hn(r))<1)return Bt.num;var a=[];Fa(e,a);var o=Ou(a);if(0===o||t<a[0]||t>a[o-1])return Bt.na;var i=1===o?1:function(e,t,r){var n,a,o=Ou(e);if(t!==e[0]){var i=0,u=e[0];for(a=1;a<o&&e[a]<t;a++)e[a]!==u&&(i=a,u=e[a]);if(e[a]!==u&&(i=a),t===e[a])n=r?i/(o-1):(a+1)/(o+1);else if(0===i)n=0;else{var s=(t-e[i-1])/(e[i]-e[i-1]);n=r?(i-1+s)/(o-1):(i+s)/(o+1)}}else n=r?0:1/(o+1);return n}(a,t,n);return 0!==i?Math.floor(i*Fu(10,r))/Fu(10,r):i}Ts.ORIGIN=function(){for(var e=[],t=0,r=arguments.length;t<r;t++){var n=t<0||arguments.length<=t?void 0:arguments[t];if(Array.isArray(n))n=(n=hn(n)).filter((function(e){return"number"==typeof e})),e.push(n);else{var a=rt._astNodes[t];if(n=wn(n,a),gt(a)&&"number"!=typeof n)continue;if(n=Number(n),isNaN(n))return Bt.value;e.push([n])}}var o,i,u,s,l,c,f=0,d=0,h=0,m=0,g=[];for(u=0;u<Ou(e);u++)for(c=e[u],g.push(c),s=0;s<Ou(c);s++)(l=c[s])!==qn&&(f+=l,d+=l*l,m++);if(m<=2)return Bt.div0;if(o=f/m,0===(i=Uu((m*d-f*f)/(m*(m-1)))))return Bt.div0;for(u=0;u<Ou(g);u++)for(c=g[u],s=0;s<Ou(c);s++)(l=c[s])!==qn&&(h+=Fu((l-o)/i,3));return Wn(m*h/((m-1)*(m-2)))},Ts.P=function(){for(var e=[],t=0,r=arguments.length;t<r;t++){var n=t<0||arguments.length<=t?void 0:arguments[t];if(Array.isArray(n))n=(n=hn(n)).filter((function(e){return"number"==typeof e})),e.push(n);else{var a=rt._astNodes[t];if(n=wn(n,a),gt(a)&&"number"!=typeof n)continue;if(n=Yn(n),isNaN(n))return Bt.value;e.push([n])}}var o,i,u,s,l,c,f=0,d=0,h=[];for(u=0;u<Ou(e);u++){if(c=e[u],1===Ou(e)&&0===Ou(c))return Bt.null;for(s=0;s<Ou(c);s++){var m={value:0};(l=c[s])!==qn&&"boolean"!=typeof l&&Vn(l,m)&&(f+=m.value,d++,h.push(m.value))}}if(d<=2)return Bt.div0;o=f/d;var g=0,p=0,v=0;for(u=0;u<h.length;u++)v=h[u]-o,p+=Fu(v,2),g+=Fu(v,3);return 0===(i=Uu(p/d))?Bt.div0:Wn(g/d/i/i/i)};var Ds={INC:function(e,t,r){return xs(e,t,r,!0)},EXC:function(e,t,r){return xs(e,t,r,!1)}},bs=[[8,"0131","0301","0331","0429","0528","0627","0726","0825","0924","1023","1122","1222","1320"],[0,"0219","0320","0419","0518","0616","0716","0814","0913","1012","1111","1211","1310"],[0,"0208","0310","0408","0508","0606","0705","0804","0902","1002","1031","1130","1230"],[5,"0129","0227","0329","0427","0527","0625","0724","0823","0921","1020","1119","1219","1317"],[0,"0216","0317","0416","0515","0614","0713","0811","0910","1009","1107","1207","1306"],[0,"0204","0306","0405","0504","0603","0703","0801","0830","0929","1028","1127","1226"],[4,"0125","0223","0325","0424","0523","0622","0721","0820","0918","1018","1116","1216","1314"],[0,"0213","0314","0413","0512","0611","0710","0809","0908","1007","1106","1205","1304"],[0,"0202","0303","0401","0430","0530","0629","0728","0827","0925","1025","1124","1223"],[2,"0122","0220","0322","0420","0519","0618","0717","0816","0914","1014","1113","1213","1311"],[0,"0210","0311","0410","0509","0607","0707","0805","0904","1003","1102","1202","1301"],[6,"0130","0301","0330","0429","0528","0626","0726","0824","0922","1022","1121","1220","1319"],[0,"0218","0319","0417","0517","0615","0714","0813","0911","1010","1109","1209","1307"],[0,"0206","0308","0407","0506","0605","0704","0802","0901","0930","1029","1128","1227"],[5,"0126","0225","0327","0425","0525","0623","0723","0821","0920","1019","1117","1217","1315"],[0,"0214","0316","0414","0514","0613","0712","0811","0909","1009","1107","1207","1305"],[0,"0203","0304","0403","0502","0601","0630","0730","0829","0927","1027","1125","1225"],[2,"0123","0222","0323","0421","0521","0619","0719","0818","0916","1016","1115","1214","1313"],[0,"0211","0313","0411","0510","0609","0708","0807","0905","1005","1104","1203","1302"],[7,"0201","0302","0401","0430","0529","0628","0727","0825","0924","1024","1122","1222","1321"],[0,"0220","0320","0419","0518","0616","0716","0814","0912","1012","1110","1210","1309"],[0,"0208","0310","0408","0508","0606","0705","0804","0902","1001","1031","1129","1229"],[5,"0128","0227","0328","0427","0527","0625","0724","0823","0921","1020","1119","1218","1317"],[0,"0216","0317","0416","0516","0614","0714","0812","0911","1010","1108","1208","1306"],[0,"0205","0305","0404","0504","0602","0702","0801","0830","0929","1028","1127","1226"],[4,"0124","0223","0324","0423","0522","0621","0721","0819","0918","1018","1116","1216","1314"],[0,"0213","0314","0412","0512","0610","0710","0808","0907","1007","1105","1205","1304"],[0,"0202","0304","0402","0501","0531","0629","0729","0827","0926","1025","1124","1224"],[2,"0123","0221","0322","0420","0519","0618","0717","0815","0914","1013","1112","1212","1311"],[0,"0210","0311","0410","0509","0607","0707","0805","0903","1003","1101","1201","1231"],[6,"0130","0228","0330","0429","0528","0626","0726","0824","0922","1022","1120","1220","1319"],[0,"0217","0319","0418","0517","0616","0715","0814","0912","1011","1110","1209","1308"],[0,"0206","0307","0406","0506","0604","0704","0802","0901","0930","1029","1128","1227"],[5,"0126","0224","0326","0425","0524","0623","0722","0821","0920","1019","1118","1217","1315"],[0,"0214","0315","0414","0513","0612","0712","0810","0909","1008","1107","1207","1305"],[0,"0204","0305","0403","0503","0601","0701","0730","0829","0928","1027","1126","1226"],[3,"0124","0223","0323","0421","0521","0619","0718","0817","0916","1015","1114","1214","1313"],[0,"0211","0313","0411","0510","0609","0708","0806","0905","1004","1103","1203","1302"],[7,"0131","0302","0401","0430","0529","0628","0727","0825","0924","1023","1122","1222","1320"],[0,"0219","0321","0420","0519","0617","0717","0815","0913","1013","1111","1211","1309"],[0,"0208","0309","0408","0507","0606","0705","0804","0902","1001","1031","1129","1229"],[6,"0127","0226","0328","0426","0526","0625","0724","0823","0921","1020","1119","1218","1317"],[0,"0215","0317","0415","0515","0614","0713","0812","0910","1010","1108","1208","1306"],[0,"0205","0306","0405","0504","0603","0702","0801","0831","0929","1029","1127","1227"],[4,"0125","0224","0324","0423","0522","0621","0720","0819","0917","1017","1116","1215","1314"],[0,"0213","0314","0412","0512","0610","0709","0808","0906","1006","1105","1205","1303"],[0,"0202","0304","0402","0501","0531","0629","0728","0827","0925","1025","1124","1223"],[2,"0122","0221","0323","0421","0520","0619","0718","0816","0915","1014","1113","1212","1311"],[0,"0210","0311","0409","0509","0607","0707","0805","0903","1003","1101","1201","1230"],[7,"0129","0228","0329","0428","0528","0626","0726","0824","0922","1022","1120","1220","1318"],[0,"0217","0318","0417","0517","0615","0715","0814","0912","1011","1110","1209","1308"],[0,"0206","0308","0406","0506","0605","0704","0803","0901","1001","1030","1129","1228"],[5,"0127","0225","0326","0424","0524","0622","0722","0820","0919","1019","1117","1217","1315"],[0,"0214","0315","0414","0513","0611","0711","0810","0908","1008","1107","1206","1305"],[0,"0203","0305","0403","0503","0601","0630","0730","0828","0927","1027","1126","1225"],[3,"0124","0222","0324","0422","0522","0620","0719","0818","0916","1016","1114","1214","1313"],[0,"0212","0312","0411","0510","0609","0708","0806","0905","1004","1103","1203","1301"],[8,"0131","0302","0331","0430","0529","0628","0727","0825","0924","1023","1122","1221","1320"],[0,"0218","0320","0419","0519","0617","0717","0815","0913","1013","1111","1211","1309"],[0,"0208","0309","0408","0508","0606","0706","0804","0903","1002","1101","1130","1230"],[6,"0128","0227","0327","0426","0525","0624","0724","0822","0921","1020","1119","1218","1317"],[0,"0215","0317","0415","0515","0613","0713","0811","0910","1010","1108","1208","1306"],[0,"0205","0306","0405","0504","0602","0702","0731","0830","0929","1028","1127","1227"],[4,"0125","0224","0325","0424","0523","0621","0721","0819","0918","1017","1116","1216","1315"],[0,"0213","0314","0412","0512","0610","0709","0808","0906","1006","1104","1204","1303"],[0,"0202","0303","0402","0501","0531","0629","0728","0827","0925","1024","1123","1223"],[3,"0121","0220","0322","0421","0520","0619","0718","0816","0915","1014","1112","1212","1311"],[0,"0209","0311","0410","0509","0608","0708","0806","0904","1004","1102","1202","1231"],[7,"0130","0228","0329","0427","0527","0626","0725","0824","0922","1022","1120","1220","1318"],[0,"0217","0318","0417","0516","0615","0714","0813","0912","1011","1110","1209","1308"],[0,"0206","0308","0406","0505","0604","0703","0802","0901","0930","1030","1129","1228"],[5,"0127","0225","0327","0425","0524","0623","0722","0821","0919","1019","1118","1218","1316"],[0,"0215","0315","0414","0513","0611","0711","0809","0908","1007","1106","1206","1304"],[0,"0203","0305","0403","0503","0601","0630","0730","0828","0926","1026","1125","1224"],[4,"0123","0222","0324","0422","0522","0620","0719","0818","0916","1015","1114","1214","1312"],[0,"0211","0313","0412","0511","0610","0709","0807","0906","1005","1103","1203","1301"],[8,"0131","0301","0331","0429","0529","0627","0727","0825","0924","1023","1121","1221","1319"],[0,"0218","0320","0418","0518","0617","0716","0815","0913","1013","1111","1211","1309"],[0,"0207","0309","0407","0507","0606","0705","0804","0902","1002","1101","1130","1230"],[6,"0128","0227","0328","0426","0526","0624","0724","0823","0921","1021","1120","1219","1318"],[0,"0216","0317","0415","0514","0613","0712","0811","0909","1009","1108","1207","1306"],[0,"0205","0306","0405","0504","0602","0702","0731","0829","0928","1028","1126","1226"],[4,"0125","0224","0325","0424","0523","0621","0721","0819","0917","1017","1115","1215","1314"],[0,"0213","0315","0413","0513","0611","0710","0809","0907","1006","1105","1204","1303"],[10,"0202","0303","0401","0501","0531","0629","0728","0827","0925","1024","1123","1222","1321"],[0,"0220","0321","0420","0520","0618","0718","0816","0915","1014","1112","1212","1310"],[0,"0209","0310","0409","0509","0607","0707","0806","0904","1004","1102","1202","1231"],[6,"0129","0228","0329","0428","0527","0626","0726","0824","0923","1023","1121","1221","1319"],[0,"0217","0318","0416","0516","0614","0714","0812","0911","1011","1109","1209","1308"],[0,"0206","0308","0406","0505","0604","0703","0802","0831","0930","1029","1128","1228"],[5,"0127","0225","0327","0425","0524","0623","0722","0820","0919","1018","1117","1217","1316"],[0,"0215","0316","0415","0514","0612","0712","0810","0908","1008","1106","1206","1305"],[0,"0204","0304","0403","0503","0601","0630","0730","0828","0926","1026","1124","1224"],[3,"0123","0221","0323","0422","0521","0620","0719","0818","0916","1015","1114","1213","1312"],[0,"0210","0312","0411","0511","0609","0709","0807","0906","1005","1103","1203","1301"],[8,"0131","0301","0331","0430","0529","0628","0727","0826","0925","1024","1122","1222","1320"],[0,"0219","0319","0418","0517","0616","0715","0814","0912","1012","1111","1211","1309"],[0,"0207","0309","0407","0507","0605","0705","0803","0902","1002","1031","1130","1230"],[5,"0128","0227","0328","0426","0526","0624","0723","0822","0921","1020","1119","1219","1317"],[0,"0216","0318","0416","0515","0614","0713","0811","0910","1009","1108","1208","1307"],[0,"0205","0306","0405","0504","0602","0702","0731","0829","0928","1027","1126","1226"],[4,"0124","0223","0325","0423","0523","0621","0721","0819","0917","1017","1115","1215","1313"],[0,"0212","0314","0413","0512","0611","0710","0809","0907","1006","1105","1204","1303"],[0,"0201","0303","0402","0501","0531","0630","0729","0828","0926","1025","1124","1223"],[2,"0122","0220","0321","0419","0519","0618","0717","0816","0914","1014","1112","1212","1310"],[0,"0209","0310","0409","0508","0607","0706","0805","0904","1003","1102","1201","1231"],[7,"0129","0228","0329","0428","0527","0626","0725","0824","0922","1022","1121","1220","1319"],[0,"0218","0319","0417","0517","0615","0714","0813","0911","1011","1110","1210","1308"],[0,"0207","0308","0406","0505","0604","0703","0801","0831","0929","1029","1128","1227"],[5,"0126","0225","0327","0425","0524","0623","0722","0820","0919","1018","1117","1216","1315"],[0,"0214","0316","0414","0514","0612","0712","0810","0908","1008","1106","1206","1304"],[0,"0203","0305","0403","0503","0602","0701","0731","0829","0927","1027","1125","1225"],[4,"0123","0222","0322","0421","0521","0619","0719","0817","0916","1015","1114","1213","1312"],[0,"0210","0312","0410","0510","0608","0708","0807","0905","1005","1103","1203","1301"],[9,"0131","0301","0331","0429","0529","0627","0727","0825","0924","1024","1122","1222","1320"],[0,"0219","0320","0419","0518","0616","0716","0814","0913","1013","1112","1211","1310"],[0,"0208","0309","0407","0507","0605","0704","0803","0901","1001","1031","1129","1229"],[6,"0128","0226","0328","0426","0526","0624","0723","0822","0920","1020","1118","1218","1317"],[0,"0216","0317","0416","0515","0614","0713","0811","0910","1009","1108","1207","1306"],[0,"0205","0307","0405","0505","0603","0703","0801","0830","0929","1028","1126","1226"],[4,"0125","0223","0324","0423","0523","0621","0721","0819","0917","1017","1115","1215","1313"],[0,"0212","0313","0412","0512","0610","0710","0808","0907","1006","1105","1204","1303"],[0,"0201","0303","0401","0501","0530","0629","0729","0827","0926","1025","1124","1223"],[2,"0122","0220","0322","0420","0519","0618","0718","0816","0915","1015","1113","1213","1311"],[0,"0210","0310","0409","0508","0606","0706","0804","0903","1003","1101","1201","1231"],[6,"0129","0228","0329","0428","0527","0625","0725","0823","0922","1021","1120","1220","1319"],[0,"0217","0319","0417","0517","0615","0714","0813","0911","1010","1109","1209","1308"],[0,"0206","0308","0407","0506","0605","0704","0802","0901","0930","1029","1128","1228"],[5,"0126","0225","0326","0425","0524","0623","0722","0820","0919","1018","1116","1216","1315"],[0,"0213","0315","0414","0513","0612","0711","0810","0908","1008","1106","1205","1304"],[0,"0203","0304","0403","0502","0601","0701","0730","0829","0927","1027","1125","1225"],[3,"0123","0221","0323","0422","0521","0620","0719","0818","0917","1016","1115","1214","1313"],[0,"0211","0312","0410","0509","0608","0707","0806","0905","1004","1103","1203","1301"],[7,"0131","0301","0331","0429","0528","0627","0726","0825","0923","1023","1122","1222","1320"],[0,"0219","0320","0419","0518","0616","0716","0814","0913","1012","1111","1211","1309"],[0,"0208","0310","0408","0508","0606","0705","0804","0902","1001","1031","1130","1229"],[6,"0128","0227","0328","0426","0526","0624","0723","0822","0920","1019","1118","1217","1316"],[0,"0215","0317","0416","0515","0614","0713","0811","0910","1009","1107","1207","1305"],[0,"0204","0306","0405","0504","0603","0702","0801","0830","0929","1028","1126","1226"],[5,"0124","0223","0325","0423","0523","0622","0721","0820","0918","1018","1116","1216","1314"],[0,"0212","0313","0411","0511","0610","0709","0808","0906","1006","1105","1204","1303"],[0,"0201","0302","0401","0430","0530","0628","0728","0827","0925","1025","1124","1223"],[2,"0122","0220","0322","0420","0519","0618","0717","0816","0914","1014","1113","1212","1311"],[0,"0210","0311","0410","0509","0607","0707","0805","0903","1003","1102","1201","1231"],[7,"0130","0229","0329","0428","0527","0625","0725","0823","0921","1021","1119","1219","1318"],[0,"0217","0319","0417","0517","0615","0714","0813","0911","1010","1109","1208","1307"],[0,"0206","0308","0406","0506","0604","0704","0802","0901","0930","1029","1128","1227"],[5,"0126","0225","0326","0425","0525","0623","0723","0821","0920","1019","1117","1217","1315"],[0,"0214","0314","0413","0513","0611","0711","0810","0908","1008","1106","1205","1304"],[0,"0202","0304","0402","0502","0531","0630","0730","0828","0927","1027","1125","1225"],[3,"0123","0221","0323","0421","0521","0619","0719","0817","0916","1016","1114","1214","1313"],[0,"0211","0313","0411","0510","0609","0708","0806","0905","1005","1103","1203","1302"],[8,"0201","0301","0331","0429","0528","0627","0726","0824","0923","1022","1121","1221","1320"],[0,"0219","0320","0419","0518","0616","0716","0814","0912","1012","1110","1210","1309"],[0,"0208","0309","0408","0508","0606","0705","0804","0902","1001","1031","1129","1229"],[6,"0128","0226","0328","0427","0526","0625","0724","0823","0921","1020","1119","1218","1317"],[0,"0215","0316","0415","0515","0613","0713","0811","0910","1009","1107","1207","1305"],[0,"0204","0305","0404","0504","0602","0702","0731","0830","0929","1028","1126","1226"],[4,"0124","0223","0324","0423","0522","0621","0720","0819","0918","1017","1116","1216","1314"],[0,"0212","0314","0412","0512","0610","0710","0808","0907","1006","1105","1205","1304"],[0,"0202","0303","0401","0501","0530","0628","0727","0826","0924","1024","1123","1223"],[3,"0121","0220","0322","0420","0519","0618","0717","0815","0914","1013","1112","1212","1311"],[0,"0209","0311","0410","0509","0607","0707","0805","0903","1003","1101","1201","1231"],[7,"0129","0228","0330","0428","0528","0626","0726","0824","0922","1022","1120","1220","1318"],[0,"0217","0318","0417","0516","0615","0714","0813","0911","1010","1109","1208","1307"],[0,"0205","0307","0406","0505","0604","0704","0802","0901","0930","1029","1128","1227"],[5,"0126","0224","0326","0424","0524","0623","0722","0821","0919","1019","1117","1217","1315"],[0,"0214","0315","0414","0513","0612","0711","0810","0909","1008","1107","1206","1305"],[0,"0203","0304","0402","0502","0531","0629","0729","0828","0926","1026","1125","1224"],[4,"0123","0221","0323","0421","0521","0619","0718","0817","0915","1015","1114","1214","1312"],[0,"0211","0312","0411","0510","0609","0708","0806","0905","1004","1103","1203","1301"],[8,"0131","0302","0331","0430","0529","0628","0727","0825","0924","1023","1122","1221","1320"],[0,"0219","0320","0418","0518","0616","0716","0814","0912","1012","1110","1210","1308"],[0,"0207","0309","0407","0507","0605","0704","0803","0901","0930","1030","1128","1228"],[6,"0126","0225","0326","0425","0525","0623","0723","0821","0920","1019","1118","1217","1316"],[0,"0214","0316","0414","0514","0612","0712","0811","0909","1009","1107","1207","1305"],[0,"0204","0304","0403","0502","0601","0630","0730","0828","0927","1027","1125","1225"],[0,"0123","0222","0323","0422","0521","0620","0719","0818","0917","1017","1115","1215"],[0,"0113","0212","0313","0412","0511","0609","0709","0807","0906","1006","1104","1204"],[0,"0103","0201","0303","0401","0501","0530","0628","0728","0826","0925","1024","1123"],[3,"1223","0122","0220","0321","0419","0519","0617","0716","0815","0913","1012","1111","1211"],[0,"0110","0208","0310","0409","0508","0607","0706","0804","0903","1002","1031","1130"],[7,"1230","0128","0227","0329","0428","0527","0625","0725","0823","0922","1021","1119","1219"],[0,"0118","0216","0318","0417","0516","0615","0714","0813","0911","1011","1109","1209"],[0,"0107","0206","0306","0405","0504","0603","0703","0801","0831","0929","1029","1127"],[5,"1227","0125","0224","0325","0423","0523","0622","0721","0820","0919","1018","1117","1216"],[0,"0115","0213","0315","0413","0512","0611","0710","0809","0908","1007","1106","1206"],[0,"0104","0203","0304","0403","0502","0531","0630","0729","0828","0926","1026","1125"],[4,"1225","0123","0222","0322","0421","0520","0618","0718","0816","0914","1014","1113","1213"],[0,"0111","0210","0312","0410","0510","0608","0707","0806","0904","1003","1102","1202"],[8,"1231","0130","0301","0331","0429","0529","0627","0726","0825","0923","1022","1121","1221"],[0,"0119","0218","0320","0418","0518","0616","0716","0814","0913","1012","1110","1210"],[0,"0108","0207","0308","0406","0506","0605","0704","0803","0901","1001","1030","1129"],[6,"1228","0126","0225","0327","0425","0525","0623","0723","0822","0920","1020","1118","1218"],[0,"0116","0214","0316","0414","0514","0612","0712","0811","0909","1009","1108","1207"],[0,"0106","0204","0306","0404","0503","0602","0701","0731","0829","0928","1028","1127"],[4,"1226","0125","0223","0324","0422","0521","0620","0719","0817","0916","1016","1115","1214"],[0,"0113","0212","0313","0412","0511","0609","0709","0807","0905","1005","1104","1203"],[0,"0102","0201","0303","0401","0501","0530","0628","0727","0826","0924","1024","1122"],[2,"1222","0121","0220","0321","0420","0520","0618","0717","0816","0914","1013","1112","1211"]],Os=1900,Fs={},Us=function(e,t,r){var n=e.getTime()-t.getTime();switch(r){case"y":return parseInt(e.getFullYear()-t.getFullYear());case"M":return parseInt(12*(e.getFullYear()-t.getFullYear())+(e.getMonth()-t.getMonth()));case"d":return Math.ceil(n/1e3/60/60/24);case"w":return Math.floor(n/1e3/60/60/24/7);case"h":return Math.floor(n/1e3/60/60);case"m":return Math.floor(n/1e3/60);case"s":return Math.floor(n/1e3);case"ms":return parseInt(n)}},Ls=function(e,t,r,n,a){var o=bs[t];if(!o)return!1;for(var i,u,s,l=e.getFullYear(),c=e.getMonth()+1,f=e.getDate(),d=l,h=o.length-1;h>0;h--){i=h;var m=Number(o[h].substring(0,2)),g=Number(o[h].substring(2,4));if(u=(s=a&&m>12?m-12:m)<c||s==c&&g<=f||(m<=r||m>=n)&&a,12==s&&s>c&&1==h&&(u=!0,l--),u)break}return!!u&&(a&&12==m&&(l-=1),{year:l,month:s,day:g,lunarYear:d=a?d-1:d,lunarMonth:i,leapMonth:o[0]})},Bs=function(e,t,r){return"M"==r?Fs.monthAdd(e,t):(Fs.lunarToSolar(e),Fs.solarToLunar(void 0))};Fs.dateAdd=function(e,t){for(var r=function(e){for(var t=e.match(/[+-]?\d+((ms)|[yMdhmsw])/g),r=[],n=0;n<t.length;n++){if(/([+-])(\d+)(.+)/.test(t[n])){var a=parseInt(RegExp.$2);"-"===RegExp.$1&&(a=-a),r.push({value:a,unit:RegExp.$3})}return r}}(t),n=0;n<r.length;n++)e=Bs(e,r[n]);return e},Fs.dateDiff=function(e,t,r){if("M"==r)return Fs.monthDiff(e,t);var n=Fs.lunarToSolar(e),a=Fs.lunarToSolar(t);return Us(a,n,r)},Fs.monthAdd=function(e,t){if(e instanceof Date&&(e=Fs.solarToLunar(e)),0==t)return e;var r,n=e.year,a=e.month;(e.leap||e.leapMonth>0&&e.month>e.leapMonth)&&a++;var o=!0;do{(t=t+a-(r=Fs.monthsOfYear(n)))<=0?(o=!1,a=n==e.year?r+t:r+t-a):(n++,a=1)}while(o);var i=Fs.leapMonthOfYear(n),u=!1;return i>0&&a>i&&(u=--a==i),{year:n,month:a,leap:u,leapMonth:i}},Fs.monthDiff=function(e,t){var r=0;if(e instanceof Date&&(e=Fs.solarToLunar(e)),t instanceof Date&&(t=Fs.solarToLunar(t)),e.year==t.year)r=t.month-e.month,e.leapMonth>=e.month&&e.leapMonth<=t.month&&r++;else{r=12,(e.leapMonth>e.month||e.leapMonth==e.month&&!e.isLeaMonth)&&(r+=1),r-=e.month;for(var n=e.year+1,a=n;a<t.year;a++)r+=Fs.monthsOfYear(n++);r+=t.month,(t.isLeapMonth||t.month<t.leapMonth)&&r++}return r},Fs.daysOfMonth=function(e,t,r){"object"==typeof e&&(t=e.month,r=e.leap,e=e.year);var n=Fs.lunarToSolar(e,t,1,r);Fs.leapMonthOfYear(e)!=t||r?12==t?(e++,t=1):(r=!1,t++):r=!0;var a=Fs.lunarToSolar(e,t,1,r);return Fs.dateDiff(a,n,"d")},Fs.monthsOfYear=function(e){return bs[e-Os].length-1},Fs.leapMonthOfYear=function(e){var t=bs[e-Os];return t?t[0]:0},Fs.lunarToSolar=function(e,t,r,n){var a=arguments[0];"object"==typeof a&&1==arguments.length&&(e=a.year,t=a.month,r=a.day,n=a.leap);var o=e-Os;if(o<0||o>bs.length)throw new Error("Specified date range is invalid.");var i=bs[o][0];(n&&t==i||i>0&&t>i)&&(t+=1);var u=bs[o][t],s=Number(u.substring(0,2)),l=Number(u.substring(2,4));s>12&&(e+=1,s-=12);var c=new Date(e,s-1,l),f=c.getTime()+24*(r-1)*60*60*1e3;return new Date(f)},Fs.solarToLunar=function(e,t){var r=e.getFullYear()-Os;if(r<=0||r>=bs.length)throw new Error("Specified date range is invalid.");var n=Ls(e,r,0,13,!1);if(!(n=n||Ls(e,r-1,12,99,!0)))return!1;var a=new Date(n.year,n.month-1,n.day),o=Us(e,a,"d")+1,i={leap:n.leapMonth>0&&n.leapMonth+1==n.lunarMonth,year:n.lunarYear,month:n.leapMonth>0&&n.lunarMonth>n.leapMonth?n.lunarMonth-1:n.lunarMonth,day:o,leapMonth:n.leapMonth};return t&&i?Fs.format(i,t):i},Fs.traditionalYearName=function(e){var t=Nr.default.t("").split(""),r=Nr.default.t("").split("");return t[(e=e-Os+36)%10]+r[e%12]+Nr.default.t("")},Fs.yearName=function(e){for(var t=Nr.default.t(",,,,,,,,,").split(","),r=e.toString(),n="",a=0;a<r.length;a++)n+=t[parseInt(r.charAt(a))];return n+Nr.default.t("")},Fs.animalName=function(e){return Nr.default.t("").split("")[(e-4)%12]},Fs.monthName=function(e,t,r){var n=Nr.default.t(",,,,,,,,,,,").split(",");return t&&(n[11]=Nr.default.t("")),(r?Nr.default.t(""):"")+n[e-1]+Nr.default.t("")},Fs.dayName=function(e){switch(e){case 10:return Nr.default.t("");case 20:return Nr.default.t("");case 30:return Nr.default.t("");default:return Nr.default.t("").split("")[Math.floor(e/10)]+Nr.default.t("").split("")[(e-1)%10]||e}},Fs.format=function(e,t){return t.replace(/[TAYyMmdD]/g,(function(t,r){switch(t){case"T":return Fs.traditionalYearName(e.year);case"A":return Fs.animalName(e.year);case"Y":return Fs.yearName(e.year);case"y":return e.year;case"m":return Fs.monthName(e.month,!1,e.leap);case"M":return Fs.monthName(e.month,!0,e.leap);case"d":return Fs.dayName(e.day);case"D":return 1==e.day?Fs.monthName(e.month,!1,e.leap):Fs.dayName(e.day)}}))};var ks=Fs,Ps=function(e,t,r){var n=new Date(e,t-1,r).getUTCDay();return{0:Nr.default.t(""),1:Nr.default.t(""),2:Nr.default.t(""),3:Nr.default.t(""),4:Nr.default.t(""),5:Nr.default.t(""),6:Nr.default.t("")}[n]},Gs=function(e,t){var r=Nr.default.t(""),n=2*e-(t<[20,19,21,21,21,22,23,23,23,23,22,22][e-1]?2:0);return r.substring(n,n+2)+Nr.default.t("")};function Hs(e){e=e.toString();for(var t=[7,9,10,5,8,4,2,1,6,3,7,9,10,5,8,4,2],r=0,n=0;n<17;n++)r+=e[n]*t[n];return[1,0,"X",9,8,7,6,5,4,3,2][r%11]}function Ys(e){var t,r,n,a,o,i;return i="TIME_ERROR"!=(o=function(e){e=(e=e.split(/\/|\\|-/))[0]+"-"+e[1]+"-"+e[2];var t=new Date(e);try{var r=ks.solarToLunar(t);return r.year+"-"+r.month+"-"+r.day}catch(e){return"TIME_ERROR"}}(t=(a=(e=e.toString()).substr(6,4))+"-"+(r=e.substr(10,2))+"-"+(n=e.substr(12,2))))?function(e){return(e=e%12-4)<0&&(e+=12),Nr.default.t("")[e]}(o.substr(0,4)):null,{date:t,nong:o,year:a,month:r,day:n,week:Ps(a,r,n),zodiac:Gs(r,n),zodiac_zh:i}}var js=ga._pow10,Vs=ga._approxFloor,$s=ga._approxCeiling,Zs=ea.Z._getLength,Ws=Math.abs,Xs=Math.sqrt,Ks=Math.floor,zs=Math.exp,qs=Math.log,Js=Math.PI,Qs=Math.random;function el(e){if(Rn(e))throw new Error(e);if(Rn(e=yn(e||0)))throw new Error(e);return Math.abs(e)}function tl(e,t,r){var n;return"&"===r&&(n=Array.isArray(e)&&Array.isArray(t)?e.map((function(e,r){var n=null===t||void 0===t?void 0:t[r];return e.map((function(e,t){return e.map((function(e,r){var a,o,i,u;return null===e&&null===(null===(a=null===n||void 0===n?void 0:n[t])||void 0===a?void 0:a[r])?"":(0,yr.o8)(e)||(0,yr.o8)(null===(o=null===n||void 0===n?void 0:n[t])||void 0===o?void 0:o[r])?Bt.na:e.toString()+(null===(u=null===(i=null===n||void 0===n?void 0:n[t])||void 0===i?void 0:i[r])||void 0===u?void 0:u.toString())}))}))})):Array.isArray(e)&&!Array.isArray(t)?e.map((function(e){return e.map((function(e){return e.map((function(e){return null===e?t.toString():e.toString()+t.toString()}))}))})):Array.isArray(t)&&!Array.isArray(e)?t.map((function(t){return t.map((function(t){return t.map((function(t){return null===t?e.toString():e.toString()+t.toString()}))}))})):e.toString()+t.toString()),n}function rl(e){var t=e;return ht(t)&&((t=t.toArray()).error&&t.error.length?t=new Error(t.error[0]):null===(t=t[0])?t=0:t===Bt.ref&&(t=new Error(Bt.ref))),t}function nl(e){var t=e;if("string"==typeof t&&""!==t){var r=Number(t).valueOf();if(isNaN(r)){var n=xr(t);t=n?n.numericValue:t}else t=r}return t}function al(e,t,r){var n,a,o=[e,t].map(rl),i=o[0],u=o[1],s=[i,u].find((function(e){return e instanceof Error}));if(s)throw s;if(n=[i,u].map(nl),i=n[0],u=n[1],i=Sn(i),u=Sn(u),isNaN(i)||isNaN(u)||""===i||""===u){if(i&&"="===i[0]||u&&"="===u[0])throw new Error(Bt.needUpdate);throw new Error(Bt.value)}switch(r){case"+":a=gl(i,u);break;case"-":a=pl(i,u);break;case"/":a=vl(i,u);break;case"*":a=yl(i,u);break;case"^":a=Tl(i,u)}return a}function ol(e,t,r){if(_o(e))return e;if(_o(t))return t;var n;switch("TRUE"===e&&(e=!0),"TRUE"===t&&(t=!0),"FALSE"===e&&(e=!1),"FALSE"===t&&(t=!1),null!==e||0!==t&&""!==t||(e=t),null!==t||0!==e&&""!==e||(t=e),r){case"=":"string"==typeof e&&"string"==typeof t&&(e=e.toUpperCase(),t=t.toUpperCase()),n=e===t;break;case">":n=1===_n(e,t);break;case"<":n=-1===_n(e,t);break;case">=":n=_n(e,t)>-1;break;case"<=":n=_n(e,t)<1;break;case"<>":case"NOT":"string"==typeof e&&"string"==typeof t&&(e=e.toUpperCase(),t=t.toUpperCase()),n=e!==t}return n}function il(e,t){return d(this,void 0,void 0,regeneratorRuntime.mark((function r(){var n;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return n=rt._funcNode,r.abrupt("return",new Promise((function(r){!function(e,t,r){var n=e,a={error:"#ERROR!",result:"#ERROR!",currencyFormat:""},o=(n=n.toString()).split("."),i=o[o.length-1]||"",u=i=i.toLowerCase(),s=o.slice(0,o.length-1).join(".")||"",l=i+s;-1!==["sh","sz"].indexOf(i)&&(i=""),function(e){var t=Yt.get(e);if(t)return t;var r=_e().get(e).then((function(t){return Yt.delete(e),t})).catch((function(t){return Yt.delete(e),t}));return Yt.set(e,r),r}("/ifzq/appstock/app/"+i+"fqkline/get?param="+l+",day,,,3,qfq").then((function(e){var n=e.headers.date,o=e.data,i=n;try{var c=function(e,t){if(void 0===t&&(t=!0),!e&&t)return new Date;var r=Ht(e.getMonth()+1),n=Ht(e.getDate());return[e.getFullYear(),r,n].join("-")}(i=i?new Date(i):new Date),f=o.data[l],d=f&&(f.qfqday||f.day),h=[];if(d&&d.length>=2&&(d.forEach((function(e){e[0]!==c&&h.push(e)})),h.length>1)){var m=h[h.length-1],g=h[h.length-2],p=m[2]-g[2],v=p/g[2],y="";switch(u){case"sh":case"sz":y='""#,##0.00_);[Red]\\(""#,##0.00\\)',/^(900)|^(20(0|1))/.test(s)&&(y="[$HK$-C04]#,##0.00_);[Red]\\([$HK$-C04]#,##0.00\\)");break;case"hk":y="[$HK$-C04]#,##0.00_);[Red]\\([$HK$-C04]#,##0.00\\)";break;case"us":y="\\$#,##0.00_);[Red]\\(\\$#,##0.00\\)";break;default:y="General"}var N={lastClosePrice:Number(m[2]),company:f.qt[l][1],risingPrice:Number(p),risingRate:v,todayOpenDay:Number(m[1]),todayHighestPrice:Number(m[3]),todayLowestPrice:Number(m[4]),todayVolume:Number.parseInt(m[5],10),realTimePrice:Number(d[d.length-1][2])},M=[N.lastClosePrice,N.company,N.risingPrice,N.risingRate,N.todayOpenDay,N.todayHighestPrice,N.todayLowestPrice,N.todayVolume,N.realTimePrice];void 0!==M[t]&&(a={error:null,result:M[t],currencyFormat:"General"},[0,2,4,5,6,8].includes(t)&&(a.currencyFormat=y),3===t&&"string"!=typeof N.risingRate&&(a.currencyFormat="0.00%"))}}catch(n){console.error("get stock data error!")}r(a)})).catch((function(){r(a)}))}(e,t,(function(e){e.error?r(e.error):(n.setFormatType(e.currencyFormat),r(e.result))}))})));case 2:case"end":return r.stop()}}),r)})))}function ul(e,t){if(arguments.length<1)throw new Error(Bt.value);return parseInt(e,t)}function sl(e){return e=wn(e,rt._astNodes[0]),isNaN(e)?Bt.value:"number"!=typeof(e=yn(e||0))?e:Math.floor(e)}function ll(e,t){var r=rt._astNodes,n=yn(e),a=r[0];if(Rn(n)&&(""!==e||!mt(a)))throw new Error(Bt.value);var o=r[1],i=null===t?0:yn(t);if(Rn(i)&&(""!==t||!mt(o)))throw new Error(Bt.value);if(0===i||mt(o)&&""===o.value)throw new Error(Bt.div0);return n-i*sl(n/i)}function cl(){if(arguments.length>0)throw new Error(Bt.error);return Math.random()}function fl(e,t){return e=yn(e||0),"number"==typeof(t=yn(t||0))&&(t=Math.floor(t)),Rn(e)?e:Rn(t)?t:ga._round(e,t)}function dl(e,t){return Gl.call(this,!0,e,t)}function hl(e){if(Rn(e=yn(e||0)))return e;if(e<0)throw new Error(Bt.num);return Math.sqrt(e)}function ml(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var n=yn(t[0]);if(n<1||n>11&&n<101||n>111)throw new Error(Bt.value);if(Rn(n))return n;var o,i=t.slice(1),u=[],s={},l=rt._instance.custom.isCellHidden;if(i)for(var c=0;c<i.length;c++){var f=i[c];if(!ht(f))throw new Error(Bt.value);if(f.isCell){var d=f.identities[0];if(l(d.row,d.col,d.sheetId,n>100?"ALL":"FILTER"))continue;u.push(f)}else{u.push(f);for(var h=0;h<f.identities.length;h++)for(var m=f.identities[h],g=m.row;g<m.row+m.rowCount;g++)for(var p=m.col;p<m.col+m.colCount;p++)l(g,p,m.sheetId,n>100?"ALL":"FILTER")&&(s[h]=s[h]||{},s[h][g]=s[h][g]||{},s[h][g][p]=!0)}}else u=i;switch(s.isHiddenCells=!0,u.push(s),n){case 1:case 101:o=Lu.apply(void 0,(0,a.Z)(u));break;case 2:case 102:o=ku.apply(void 0,(0,a.Z)(u));break;case 3:case 103:o=Pu.apply(void 0,(0,a.Z)(u));break;case 4:case 104:o=Xu.apply(void 0,(0,a.Z)(u));break;case 5:case 105:o=Ku.apply(void 0,(0,a.Z)(u));break;case 6:case 106:o=Ql.apply(void 0,(0,a.Z)(u));break;case 7:case 107:o=zu.S.apply(zu,(0,a.Z)(u));break;case 8:case 108:o=zu.P.apply(zu,(0,a.Z)(u));break;case 9:case 109:o=wl.apply(void 0,(0,a.Z)(u));break;case 10:case 110:o=Ju.S.apply(Ju,(0,a.Z)(u));break;case 11:case 111:o=Ju.P.apply(Ju,(0,a.Z)(u))}return o}function gl(e,t){return e+t}function pl(e,t){return e-t}function vl(e,t){return 0===t?Bt.div0:e/t}function yl(e,t){return e*t}function Nl(e,t){if(2!==arguments.length)throw new Error(Bt.na);if(Rn(e=yn(e),t=yn(t)))throw new Error(Bt.error);return e>=t}function Ml(e,t){if(2!==arguments.length)throw new Error(Bt.na);if(Rn(e=yn(e),t=yn(t)))throw new Error(Bt.error);return e<t}function Rl(e,t){if(2!==arguments.length)throw new Error(Bt.na);if(Rn(e=yn(e),t=yn(t)))throw new Error(Bt.error);return e<=t}function _l(e,t){if(2!==arguments.length)throw new Error(Bt.na);return e===t}function El(e,t){if(2!==arguments.length)throw new Error(Bt.na);return e!==t}function Tl(e,t){return 0===e&&0===t?Bt.num:Math.pow(e,t)}function Sl(e,t){return Nt(rt._astNodes[0])&&Array.isArray(e)?e[0][0][0]:Array.isArray(e)||Eo(e)?t:e}function Cl(e,t){var r=rt._instance,n=r.helper.getCalcRef,a=rt._element;if(!(e=void 0!==e?e:n([{sheetId:a.sheetId,row:a.row,col:a.col,refType:r.NODE_TYPE.CELL_RANGE_TYPE.CELL,rowCount:1,colCount:1}],!0))||!ht(e)||1!==e.getRangeCount())return Pt(e)?e:Bt.value;var o=[[]],i=e.getRow(0)+1,u=e.getColumn(0)+1,s=e.getRowCount(0),l=e.getColumnCount(0),c=u,f=l;if(t&&(c=i,f=s),f>1){for(var d=0;d<f;d++)o[0].push([c+d]);return o.rangeCount=1,o.colCount=l,o.rowCount=s,o.error=[],o.row=i,o.col=u,o}return c}function Il(e){return Cl(e,!0)}function Al(e){return Cl(e,!1)}function wl(){var e,t=arguments;t[t.length-1].isHiddenCells&&"[object Object]"===Object.prototype.toString.call(t[t.length-1])&&(e=t[t.length-1],t=Array.from(t).slice(0,-1));var r,n=0;for(r=0;r<t.length;r++){var a,o=t[r],i=void 0,u=!1;if(ht(o)){if(i=e&&e[r],(a=o.toArray()).error&&a.error.length>0)return a.error[0]}else if(Array.isArray(o)){if((a=Kn(o)).error&&a.error.length>0)return a.error[0]}else u=!0,a=Kn(o);for(var s=0;s<a.length;s++){if(i){var l=a.row+Math.floor(s/a.colCount),c=a.col+s%a.colCount;if(i[l]&&i[l][c])continue}var f=a[s];if("number"==typeof f)n+=f;else if(u&&"string"==typeof f){var d=parseFloat(f);if(isNaN(d))throw new Error(Bt.value);n+=d}else u&&"boolean"==typeof f&&(n+=Number(f))}}return n}function xl(e){if(ht(e)){var t=rt._instance.helper.getRangeValue,r=e.getIdentities(0);e=t({newLine:r.colCount},r)}var n,a,o,i,u,s,l,c,f,d,h,m,g,p,v,y,N=e.rowCount,M=[];if(e.rangeCount>1||N!==e.colCount)return Bt.value;for(n=0;n<N;n++)for(M[n]=[N],i=0;i<N;i++)M[n][i]=n===i?1:0;for(a=0;a<N;a++){if(0===e[a][a]){for(y=!1,u=a+1;!y&&u<N;u++)if(0!==e[u][a]){for(l=a;l<N;l++)p=e[a][l],e[a][l]=e[u][l],e[u][l]=p;for(c=1;c<N;c++)v=M[a][c],M[a][c]=M[u][c],M[u][c]=v;y=!0}if(!y)return Bt.num}for(s=0;s<N;s++)if(s!==a&&0!==e[s][a]){for(m=e[s][a]/e[a][a],f=a;f<N;f++)e[s][f]-=m*e[a][f];for(d=0;d<N;d++)M[s][d]-=m*M[a][d]}}for(o=0;o<N;o++)for(g=e[o][o],h=0;h<N;h++)M[o][h]/=g;return[M]}function Dl(e,t){var r=rt._instance.helper.getRangeValue;if(ht(e)){var n=e.getIdentities(0);e=r({newLine:n.colCount},n)}if(ht(t)){var a=t.getIdentities(0);t=r({newLine:a.colCount},a)}var o,i,u,s,l,c,f=e.rowCount,d=e.colCount,h=t.rowCount,m=t.colCount,g=[];if(d!==h)return Bt.value;for(u=0;u<f;u++)for(g[u]=o=[],i=e[u],s=0;s<m;s++){for(c=0,l=0;l<h;l++)c+=i[l]*t[l][s];o[s]=c}return[g]}function bl(e,t){var r,n,a,o,i,u,s=Kn(e[0]),l=Zs(s),c=s.rowCount,f=s.colCount,d=[],h=[],m=[];for(o=1;o<Zs(e);o+=2){var g=1===(u=Kn(e[o])).rowCount&&1===u.colCount&&!Et(rt._astNodes[o]);if(u.rowCount!==c||u.colCount!==f||g)return Bt.value;i=ga._parseCriteria(e[o+1],!0),d.push(u),h.push(i)}for(a=0;a<l;a++){for(n=!0,o=0;o<Zs(d)&&(i=h[o],r=d[o][a],n=i&&i(r));o++);n&&"number"==typeof(r=s[a])&&m.push(r)}return t(m)}function Ol(){return bl(arguments,(function(e){for(var t=0,r=0;r<e.length;r++)t+=e[r];return t}))}function Fl(){return bl(arguments,(function(e){var t=null;return e.length>0&&(t=Math.max.apply(null,e)),t}))}function Ul(){return bl(arguments,(function(e){var t=null;return e.length>0&&(t=Math.min.apply(null,e)),t}))}function Ll(e,t,r){var n=rt._instance.helper.getRangeValue;if(ht(t)&&(t=t.toArray()[0]),r=void 0!==r?r:e,!ht(e)||!ht(e))throw new Error(Bt.paramsErr);Jn.Z._isNullOrUndefined(t)&&(t=0);var a,o=0,i=ga._parseCriteria(t,!0),u=e.identities[0],s=r.identities[0],l={sheetId:s.sheetId,row:s.row,col:s.col,rowCount:u.rowCount,colCount:u.colCount,refType:u.refType},c=e.toArray(),f=n(void 0,l);for(a=0;a<ea.Z._getLength(c);a++)"number"==typeof f[a]&&i&&i(c[a])&&(o=vn(o,f[a]));return Wn(o)}function Bl(){var e,t,r,n,a,o,i,u=arguments,s=0,l=[],c=0;for(e=0;e<Zs(u);e++){if((n=Kn(u[e])).error&&n.error.length>0)return n.error[0];if(0===e)t=n.rowCount,r=n.colCount,c=Zs(n);else if(n.rowCount!==t||n.colCount!==r)throw new Error(Bt.value);l.push(n)}for(e=0;e<c;e++){for(a=1,o=0;o<Zs(u);o++){if("number"!=typeof(i=l[o][e])||isNaN(i)){a=0;break}a*=i}s+=a}return Wn(s)}function kl(e,t){var r,n=String(e),a=rt._funcNode;try{if(15===n.length&&(n=String(function(e){if(e=e.toString(),/(^\d{15}$)/.test(e))return function(e){return e=e.toString(),/(^\d{17}$)/.test(e)?e+Hs(e):/(^\d{18}$)/.test(e)?e.slice(0,17)+Hs(e):void 0}(e.slice(0,6)+"19"+e.slice(6,15))}(e))),r=(r=n).toString(),!/^\d{17}(\d|x)$/i.test(r)||Hs(r)!=r[17].toUpperCase())return Nr.default.t("#")}catch(e){throw console.warn(e),new Error(Bt.paramsErr)}switch(parseInt(t)){case 0:return function(e){var t=new Date,r=t.getMonth()+1,n=t.getDate(),a=t.getFullYear()-e.substring(6,10)-1;return(e.substring(10,12)<r||e.substring(10,12)==r&&e.substring(12,14)<=n)&&a++,a<=0&&(a=1),a}(n);case 1:return function(e){return(e=e.toString())[16]%2?Nr.default.t(""):Nr.default.t("")}(n);case 2:return a.setFormatType("yyyy/m/d"),wr(Ys(n).date).numericValue;case 3:return Ys(n).zodiac;case 4:var o=Ys(n).zodiac_zh;if(!o)throw new Error(Bt.paramsErr);return o;default:throw new Error(Bt.paramsErr)}}function Pl(e,t){var r=String(e);try{return!!function(e){if(e=e.toString(),!/^[A-Z](\d{6})([\(|]?)[\d|A]([|\)]?)$/g.test(e))return!1;var t=e.replace(/[\(|](?=\d|A)/,"").replace(/[|\)]$/,"").split("");return t[0]=t[0].toUpperCase().charCodeAt()-64,8===t.length&&!!function(e){var t=0;Array.from(e).forEach((function(e,r){Number(r)<7&&(t+=Number(e)*(8-Number(r)))}));var r=t%11;switch(r){case 0:return e[7]===r.toString();case 1:return"A"===e[7];default:return e[7]===(11-r).toString()}}(t)}(r)}catch(e){return console.warn(e),!1}}function Gl(e,t,r){t=wn(t,rt._astNodes[0]);var n=Hn(r=wn(r,rt._astNodes[1])),a=Yn(t),o=js(Math.abs(n)),i=$s(a=n<0?a/o:a*o),u=Vs(a);if(e){var s=i;i=u,u=s}return a=a<0?i:u,Wn(a=n<0?a*o:a/o)}function Hl(e,t){return void 0===t&&(t=0),Gl.call(this,!1,e,t)}function Yl(e,t){return Gl.call(this,!1,e,t)}function jl(e,t){return ga._round(e,t)}function Vl(e){return""===(e=wn(e,rt._astNodes[0]))&&(e=0),e=parseFloat(e),isNaN(e)?Bt.value:Wn(Math.log(e))}function $l(e,t,r,n){return void 0===t&&(t=1),void 0===r&&(r=0),""===(e=wn(e,rt._astNodes[0],!0))&&(e=0),""===(t=wn(t,rt._astNodes[1],!0))&&(t=1),""===(r=wn(r,rt._astNodes[2],!0))&&(r=0),e=Yn(e),t=Yn(t),r=Yn(r),0===t||0===e?0:0!==r&&e<0?!0===n?Vs(e/Math.abs(t))*Math.abs(t):$s(e/Math.abs(t))*Math.abs(t):!0===n?$s(e/Math.abs(t))*Math.abs(t):Vs(e/Math.abs(t))*Math.abs(t)}function Zl(e,t,r){return t=wn(t,rt._astNodes[0]),r=wn(r,rt._astNodes[1]),t=Yn(t),r=Yn(r),0===t||0===r?0:t>0&&r<0?Bt.num:t<0&&r>0?(r=-r,e?Vs(t/r)*r:$s(t/r)*r):e?$s(t/r)*r:Vs(t/r)*r}function Wl(e,t,r){return void 0===t&&(t=0),void 0===r&&(r=1),""===(t=wn(t,rt._astNodes[0],!0))&&(t=0),""===(r=wn(r,rt._astNodes[1],!0))&&(r=1),t=Yn(t),r=Yn(r),0===t||0===r?0:e?$s(t/Ws(r))*Ws(r):Vs(t/Ws(r))*Ws(r)}var Xl={ORIGIN:function(e,t){return Zl(!0,e,t)},MATH:function(e,t,r){return $l(e,t,r,!0)},PRECISE:function(e,t){return Wl(!0,e,t)}},Kl={CEILING:Xl},zl={};function ql(e,t,r,n,a){if(r=void 0===r?1:r,n=void 0===n||n,a=void 0===a?"":a,e=wn(e,rt._astNodes[0]),t=wn(t,rt._astNodes[1]),r=wn(r,rt._astNodes[2]),isNaN(e)||isNaN(t)||isNaN(r))return Bt.value;if("string"!=typeof a&&rt._astNodes[4]&&(a=rt._astNodes[4].originValue),"string"==typeof n)return Bt.value;if(n=Boolean(n),a=String(a),Number.isNaN(e)||Number.isNaN(t))return Bt.value;if(Number.isNaN(r))return Bt.value;if(e<1||e>xu.MAX_ROW_COUNT||t<1||t>xu.MAX_COLUMN_COUNT||r<1||4<r)return Bt.value;var o=3===r||4===r,i=2===r||4===r,u="";return u=function(e,t){if(void 0===e&&(e=""),t&&0<Zs(t)){var r,n=!xu._isLetter(t[0])&&"_"!==t[0];for(r=1;!n&&r<Zs(t);r++)n=!xu._isLetterOrDigit(t[r])&&"_"!==t[r];/^(true)|(false)$/i.test(t)&&(n=!0),n?(e+="'",e+=t.replace("'","''"),e+="'"):e+=t,e+="!"}return e}(u,a),n?(u=function(e,t,r){r||(e+="$");for(var n=e.length;t>.1;t=parseInt((t-1)/26),10)e=Dn.Z._insert(e,n,String.fromCharCode("A".charCodeAt(0)+(t-1)%26));return e}(u,t,i),u=function(e,t,r){return r||(e+="$"),e+t}(u,e,o)):(u=Jl(u,"R",e,o),u=Jl(u,"C",t,i)),u}function Jl(e,t,r,n){return e+=t,n?0!==r&&(e+="[",e+=r.toString(),e+="]"):e+=r,e}function Ql(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var n;"[object Object]"===Object.prototype.toString.call(t[t.length-1])&&t[t.length-1].isHiddenCells&&(n=t[t.length-1],t=t.slice(0,-1));for(var a=1,o=0,i=0;i<t.length;i++){var u=t[i];if(ht(u)||Array.isArray(u)){var s=n&&n[i],l=Kn(u);if(l.error&&l.error.length>0)throw new Error(l.error[0]);for(var c=0;c<l.length;c++){var f=l.row+Math.floor(c/l.colCount),d=l.col+c%l.colCount;if(!(s&&s[f]&&s[f][d])){var h=l[c];"number"!=typeof h||isNaN(h)||(a*=h,o++)}}}else{var m=yn(u);if(Pt(m))return m;a*=m,o++}}return 0===o&&(a=0),a}function ec(e,t){return void 0===t&&(t=10),e=wn(e,rt._astNodes[0]),t=wn(t,rt._astNodes[1]),Array.isArray(e)||Array.isArray(t)?Bt.value:t?(e=Yn(e),1===(t=Yn(t))?Bt.div0:Wn(ga._log(e,t))):Bt.num}function tc(e,t){return t=Yn(t=wn(t,rt._astNodes[0])),isNaN(t)?Bt.value:Wn(Math[e](t))}function rc(e){return tc("sin",e)}function nc(e){return tc("cos",e)}function ac(e){return tc("tan",e)}function oc(e){return tc("asin",e)}function ic(e){return tc("acos",e)}function uc(e){return tc("atan",e)}function sc(){return Math.PI}function lc(e){return""===(e=wn(e,rt._astNodes[0]))&&(e=0),e=parseFloat(e),isNaN(e)?Bt.value:180*e/Math.PI}function cc(e){return e=Yn(e=wn(e,rt._astNodes[0])),isNaN(e)?Bt.value:Math.PI*e/180}function fc(e,t){if(e=wn(e,rt._astNodes[0]),t=wn(t,rt._astNodes[1]),e=Number(e),t=Number(t),isNaN(e)||isNaN(t))return Bt.value;if(0===e&&0===t)return Bt.num;var r=Math.pow(e,t);return isNaN(r)?Bt.num:r}function dc(e){return e=Yn(e=wn(e,rt._astNodes[0])),isNaN(e)?Bt.value:Wn(ga._log(e,10))}function hc(e){return e=Yn(e=wn(e,rt._astNodes[0])),isNaN(e)?Bt.value:Wn(Math.exp(e))}function mc(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];for(var n=0,a=t.length;n<a;n++){var o=t[n];if(Array.isArray(o))o=(o=hn(o)).filter((function(e){return"number"==typeof e})),t[n]=o;else{var i=rt._astNodes[n];if(o=wn(o,i),gt(i)&&"number"!=typeof o&&(o=0),o=Number(o),isNaN(o))return Bt.value;t[n]=[o]}}var u,s,l,c,f=0;for(s=0;s<Zs(t);s++)for(c=t[s],l=0;l<Zs(c);l++)(u=c[l])!==qn&&(f+=u*u);return Wn(f)}function gc(e,t){for(var r=0,n=t.length;r<n;r++){var a=t[r];if(Array.isArray(a))a=(a=hn(a)).filter((function(e){return"number"==typeof e})),t[r]=a;else{var o=rt._astNodes[r];if(a=wn(a,o),gt(o)&&"number"!=typeof a&&(a=0),a=Number(a),isNaN(a))return Bt.value;t[r]=[a]}}var i,u,s,l,c,f=0,d=0,h=0,m=[];for(s=0;s<Zs(t);s++)for(c=t[s],m.push(c),l=0;l<Zs(c);l++)(i=c[l])!==qn&&(f+=i,h++);for(u=f/h,s=0;s<Zs(t);s++)for(c=m[s],l=0;l<Zs(c);l++)(i=c[l])!==qn&&(d+=e?(i-u)*(i-u):Math.abs(i-u));return e?Wn(d):0===h?Bt.div0:Wn(d/h)}function pc(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return gc(!1,t)}function vc(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return gc(!0,t)}function yc(e,t){if(e=wn(e,rt._astNodes[0]),t=wn(t,rt._astNodes[1]),e=Hn(e),t=Hn(t),isNaN(e)||isNaN(t))return Bt.value;if(e<0||e>3999)return Bt.value;if(t<0||t>4)return Bt.value;var r,n,a=["M","D","C","L","X","V","I"],o=[1e3,500,100,50,10,5,1],i=[];for(r=Za._isBoolean(t)?t?0:4:t,n=0;n<7;n+=2){if(2<=n&&o[n-2]-o[n]<=e){var u,s=n,l=n-2;for(u=0;u<r&&s+1<7&&o[l]-o[s+1]<=e;u++)s++;i.push(a[s]),i.push(a[l]),e+=o[s],e-=o[l]}if(1<=n&&o[n-1]<=e&&(i.push(a[n-1]),e-=o[n-1]),1<=n&&o[n-1]-o[n]<=e){var c,f=n,d=n-1;for(c=0;c<r&&f+1<7&&o[d]-o[f+1]<=e;c++)f++;i.push(a[f]),i.push(a[d]),e+=o[f],e-=o[d]}for(;o[n]<=e;)i.push(a[n]),e-=o[n]}return i.join("")}function Nc(e){return e=Yn(e=wn(e,rt._astNodes[0])),isNaN(e)?Bt.value:Wn(ga._sinhCosh(e,!0))}function Mc(e,t){return e=wn(e,rt._astNodes[0]),t=wn(t,rt._astNodes[1]),e=Yn(e),t=Yn(t),isNaN(e)||isNaN(t)?Bt.value:0===e&&0===t?Bt.div0:Wn(Math.atan2(t,e))}function Rc(e){return e=Yn(e=wn(e,rt._astNodes[0])),isNaN(e)?Bt.value:Wn(qs(e+Xs(e*e+1)))}function _c(e){return e=Yn(e=wn(e,rt._astNodes[0])),isNaN(e)?Bt.value:Wn(qs(e+Xs(e*e-1)))}function Ec(e){if(e=Yn(e=wn(e,rt._astNodes[0])),isNaN(e))return Bt.value;var t=zs(e),r=zs(-e);return Wn(t-r)/(t+r)}function Tc(e){return e=Yn(e=wn(e,rt._astNodes[0])),isNaN(e)?Bt.value:Ws(e)>=1?Bt.num:Wn(qs((1+e)/(1-e))/2)}function Sc(e){return e=Yn(e=wn(e,rt._astNodes[0])),isNaN(e)?Bt.value:Wn(ga._sinhCosh(e,!1))}function Cc(e){return e=Yn(e=wn(e,rt._astNodes[0])),isNaN(e)?Bt.value:Ws(e)>=134217728?Bt.num:0===e?Bt.div0:Wn(1/Math.tan(e))}function Ic(e){return e=Yn(e=wn(e,rt._astNodes[0])),isNaN(e)?Bt.value:0===e?Bt.div0:e>10?1:e<-10?-1:1/Ec(e)}function Ac(e){return e=Yn(e=wn(e,rt._astNodes[0])),isNaN(e)?Bt.value:Wn(e<0?Math.PI+Math.atan(1/e):Math.atan(1/e))}function wc(e){return e=Yn(e=wn(e,rt._astNodes[0])),isNaN(e)?Bt.value:Tc(1/e)}function xc(e){return"boolean"==typeof e?Bt.value:(e=Yn(e=wn(e,rt._astNodes[0])),isNaN(e)?Bt.value:e<0?Bt.num:Wn(Xs(e*Js)))}function Dc(e,t){return e=wn(e,rt._astNodes[0]),t=wn(t,rt._astNodes[1]),e=Yn(e),t=Yn(t),isNaN(e)||isNaN(t)?Bt.value:e<0&&t>0||t<0&&e>0?Bt.num:0===e||0===t?0:Vs(e/t+.5)*t}function bc(e,t){return t=wn(t,rt._astNodes[0]),t=Number(t),isNaN(t)?Bt.value:(t=t<0?Ks(t):Math.ceil(t),(e&&t%2==0||!e&&t%2!=0)&&(t+=t<0?-1:1),t)}function Oc(e){return bc(!0,e)}function Fc(e){return bc(!1,e)}function Uc(e,t){return Za._isBoolean(e)||Za._isBoolean(t)||In(e,rt._astNodes[0])||In(t,rt._astNodes[1])?Bt.value:(e=wn(e,rt._astNodes[0]),t=wn(t,rt._astNodes[1]),e=Hn(e),t=Hn(t),isNaN(e)||isNaN(t)?Bt.value:t<e?Bt.num:Hn(e+Qs()*(t-e+1)))}zl.ORIGIN=function(e,t){return Zl(!1,e,t)},zl.MATH=function(e,t,r){return $l(e,t,r,!1)},zl.PRECISE=function(e,t){return Wl(!1,e,t)};var Lc=Jn.Z._isNullOrUndefined,Bc=xn.Z,kc=Bc._parseLocale,Pc=Bc._toOADate,Gc=ea.Z._getLength;function Hc(e,t,r){if(void 0===r&&(r=1),r<=0)throw new Error(Bt.value);if(Array.isArray(e)){if(hn(e).length>1)throw new Error(Bt.value);e=String(hn(e)[0])}else e=String(e);if(Array.isArray(t)){if(hn(t).length>1)throw new Error(Bt.value);t=String(hn(t)[0])}else t=String(t);if(!t)throw new Error(Bt.value);if(""===e)return 1;var n=t.replace(/[\u200B-\u200D\uFEFF]/g,"").indexOf(e.replace(/[\u200B-\u200D\uFEFF]/g,""),r-1);if(-1===n)throw new Error(Bt.value);return n+1}function Yc(e,t){return void 0===t&&(t=1),Vc(!0,e,t)}function jc(e,t){return void 0===t&&(t=1),Vc(!1,e,t)}function Vc(e,t,r){if(r<0||isNaN(r))throw new Error(Bt.value);return r>=Gc(t)?t:("string"!=typeof t&&(t=t.toString()),t.substr(e?0:Gc(t)-r,r))}function $c(e){if(Rn(e))return e;if(!(e=Zn(e)))return 0;if("string"==typeof e)return e?e.length:0;if(e.length)return e.length;throw new Error(Bt.value)}function Zc(e,t,r){if(""===r&&(r=0),null===e&&(e=""),t<=0||r<0)throw new Error(Bt.value);if("number"==typeof e&&(e=String(e)),Rn(t=yn(t),r=yn(r))||"string"!=typeof e)return r;var n=t-1,a=n+r;return e.substring(n,a)}function Wc(e,t,r){if(!t)return!1;"object"==typeof e&&(e=e.toArray().toString());var n=e.toString().match(new RegExp(t));return r?n:!!n}function Xc(e,t,r,n){var a,o=Zn(e),i=Zn(t),u=Gc(i);if(Gc(arguments)>3){var s,l=Hn(n),c=0;if(l<1)return Bt.value;for(s=0;s<l;s++){if(-1===(c=o.indexOf(i,c)))return o;c+=u}var f=o.substring(0,c-u),d=o.substr(c);a=f.concat(r).concat(d)}else{if(""===i)return o;a=Dn.Z._join(o,i,r)}return a}function Kc(e){if(Array.isArray(e))return Bt.value;var t=Zn(e);t=t.trim();var r,n,a=[],o=!0,i=String.fromCharCode(160);for(r=0,n=Gc(t);r<n;r++){var u=t.charAt(r),s=" "===u||"\t"===u||u===i,l="\n"===u;l||s&&!o||a.push(u),o=l||!s}return a.join("")}function zc(e,t){var r,n,a=[],o=Gc(e);for(r=0;r<o;r++){if(Array.isArray(e[r]))return Bt.value;var i=Zn(e[r]),u=Gc(i);if(0===u&&"concat"===t)return Bt.nil;for(n=0;n<u;n++)Lc(i[n])||a.push(Zn(i[n]))}return a.join("")}function qc(){return zc(arguments,"concatenate")}function Jc(){for(var e=[],t=0,r=arguments.length;t<r;t++){var n=t<0||arguments.length<=t?void 0:arguments[t];Array.isArray(n)?(n=hn(n),e=e.concat(n)):e.push(n)}return zc(e,"concat")}function Qc(e){if(!(e=wn(e,rt._astNodes[0])))return 0;e=Zn(e);var t,r=kc(e);return Lc(r)?function(e){var t=Si.s._getCultureInfo().NumberFormat,r=xu.isDigit,n=!1;"$"!==e[0]&&e[0]!==t.currencySymbol||(e=e.substring(1),n=!0);var a=parseFloat(e);if(!e||isNaN(a)||!n&&isNaN(e)||!r(e[0].charCodeAt(0))&&"."!==e[0]&&"-"!==e[0])return Bt.value;"."===e[0]&&(e="0"+e);for(var o,i=e.length,u=0,s=0,l=0;u<i;u++){for(o=e[u];u<i&&r(o.charCodeAt(0));)o=e[++u];if(u===i){if(s&&u-s<=3)return Bt.value;break}if(o===t.numberGroupSeparator){if(l||s&&u-s<=3)return Bt.value;s=u}else if(o===t.numberDecimalSeparator){if(l||s&&u-s<=3)return Bt.value;l=u}}return e=Dn.Z._replace(e,",",""),parseFloat(e)}(e):Pn(t=Pc(r))?ai(r):t}function ef(e){var t,r=e.toString(),n="",a=[];e<0&&(r=r.substr(1),n="-");var o=r.split("."),i=Gc(o);if(i<1||i>2)return Bt.value;for(2===i&&(a.push(o[1]),a.push(".")),r=o[0],t=Gc(r)-3;t>=0;t-=3)a.push(r.substr(t,3)),t>0&&a.push(",");return a.push(r.substring(0,t+3)),a.reverse(),n+a.join("")}function tf(e,t,r){if(void 0===t&&(t=2),void 0===r&&(r=!1),e=wn(e,rt._astNodes[0],!0),""===(t=wn(t,rt._astNodes[1],!0))&&gt(rt._astNodes[1])&&(t=0),""===t&&(t=2),"string"==typeof r)switch(r.toLowerCase()){case"true":r=!0;break;case"false":case"":r=!1;break;default:return Bt.value}var n=0;t<0&&(e/=n=Hn(Math.pow(10,Math.abs(t)))),e=Yn(jl(e,Math.max(0,t))),t<0&&(e*=n),(e=r?e.toString():ef(e)).indexOf(".")<0&&t>0&&(e+=".");for(var a=e.length-e.indexOf(".");a<=t;a++)e+="0";return e}var rf={12449:65383,12451:65384,12453:65385,12455:65386,12457:65387,12540:65392,12450:65393,12452:65394,12454:65395,12456:65396,12458:65397,12459:65398,12461:65399,12463:65400,12465:65401,12467:65402,12469:65403,12471:65404,12473:65405,12475:65406,12477:65407,12479:65408,12481:65409,12484:65410,12486:65411,12488:65412,12490:65413,12491:65414,12492:65415,12493:65416,12494:65417,12495:65418,12498:65419,12501:65420,12504:65421,12507:65422,12510:65423,12511:65424,12512:65425,12513:65426,12514:65427,12516:65428,12518:65429,12520:65430,12521:65431,12522:65432,12523:65433,12524:65434,12525:65435,12527:65436,12530:65382,12531:65437,12483:65391};function nf(e){e=Zn(e);for(var t=[],r=!1,n=0,a=Gc(e);n<a;n++){var o=e.charCodeAt(n);12288!==o?o>65280&&o<65375?(t.push(String.fromCharCode(o-65248)),r=!0):rf[o]?(t.push(String.fromCharCode(rf[o])),r=!0):t.push(e[n]):(t.push(String.fromCharCode(32)),r=!0)}return r?t.join(""):e}function af(e){return(e=Zn(e)).toUpperCase()}function of(e){return(e=Hn(e))<1||e>255?Bt.value:String.fromCharCode(e)}function uf(e,t){if(Array.isArray(e))return Bt.value;""===(t=wn(t,rt._astNodes[1],!0))&&(t=0);var r,n=[];if((t=parseInt(t))<0||t*Gc(e)>32767)return Bt.value;for(r=0;r<t;r++)n.push(e);return n.join("")}function sf(e){if("boolean"==typeof e&&(e=e.toString()),"string"!=typeof e)return e;var t=Gc(e),r=[];if(t>0){var n=e.toUpperCase(),a=e.toLowerCase(),o=1;for(r[0]=n[0];o<t;)r[o]=xu._isLetter(e[o-1])?a[o]:n[o],o++}return r.join("")}function lf(e,t){return"string"!=typeof e&&(e=e.toString()),"string"!=typeof t&&(t=t.toString()),e===t}function cf(e,t){var r=Array.isArray(e)?mn(e):[e];if(r.isReference&&0===r.length)return CalcErrorsNull;var n={value:!1},a=!!Lc(t)||t;if(!$n(a,n))return Bt.value;a=n.value;var o,i,u=Array.from(arguments).map((function(e,t){return t<2?e:Array.isArray(e)?mn(e):[e]})),s=[],l=Gc(u);for(o=2;o<l;o++){var c=u[o],f=Gc(c);if(0===f)return Bt.null;for(i=0;i<f;i++)Lc(c[i])||""===c[i]?a||s.push(""):s.push(Zn(c[i]))}if(Array.isArray(r)){if(0===r.length)return Bt.null;var d=s[0];for(i=0,o=1;o<s.length;o++)i===r.length&&(i=0),d+=r[i++]+s[o];return d}return s.join(r)}function ff(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return cf.apply(this,t)}function df(e){if(e=wn(e,rt._astNodes[0])){var t=e;return t<=0||t>1114111?Bt.value:t>=55296&&t<=57343?Bt.na:t<1048576?String.fromCharCode(t):(t-=1048576,String.fromCharCode(55296+(t>>10),56320+(1023&t)))}return Bt.value}function hf(e){var t,r,n=Zn(e);return""===n||null===n?Bt.value:(t=n.charCodeAt(0))>=55296&&t<=56319?1===n.length?Bt.value:(r=n.charCodeAt(1))>=56320&&r<=57343?t|r<<8:1:t>=56320&&t<=57343?t-53248+53248:t}function mf(e){return(e=Zn(e)).toLowerCase()}function gf(e){return function(e){var t=e;if(Array.isArray(e)){if(!e.__isUserWrite)return Bt.value;t=e[0][0]}var r=Zn(t);return""===r?Bt.value:r.charCodeAt(0)}(e)}function pf(e,t,r,n){if(e=Zn(e),t=Hn(t=wn(t,rt._astNodes[1])),isNaN(t)||t<1)return Bt.value;if(""===(r=wn(r,rt._astNodes[2]))&&(r=0),r=Hn(r),isNaN(r)||r<0)return Bt.value;n=Zn(n);var a=Gc(e);t=Math.min(t,a+1),r=Math.min(r||0,a-t+1);var o=e.substring(0,t-1),i=e.substr(t-1+r);return o.concat(n).concat(i)}function vf(e){e=Zn(e);var t,r,n=[];for(t=0;t<Gc(e);t++)0<=(r=e.charCodeAt(t))&&r<=31||127===r||128<=r&&r<=159||n.push(e[t]);return n.join("")}function yf(e,t){if(void 0===t&&(t=2),""===(e=wn(e,rt._astNodes[0],!0))&&(e=0),""===(t=wn(t,rt._astNodes[1],!0))&&(t=2),e=Yn(e),t=Hn(t),isNaN(e)||isNaN(t))return Bt.value;if((e=Zn(e=Yn(jl(e,t)))).indexOf(".")>-1)for(var r=e.length-e.indexOf(".");r<=t;r++)e+="0";return function(e){var t=ef(e),r=[];return e<0&&(t=t.substr(1)),r.push(""),r.push(t),e<0&&(r.push(")"),r.unshift("(")),r.join("")}(e)}function Nf(e){return Array.isArray(e)&&(e=(e=hn(e))[0]),e=An(e,rt._astNodes[0]),Za._isString(e)?e:""}function Mf(e,t){if(""===(t=Zn(t)))return Zn(e);Lc(e)&&(e=0);try{return Su?new Su(t).format(e):e.toString()}catch(e){return Bt.value}}function Rf(e,t,r){if(void 0===r&&(r=1),e=Zn(e),t=Zn(t),""===(r=wn(r,rt._astNodes[0]))&&(r=0),(r=Hn(r))<=0)return Bt.value;var n,a,o=-1;return(n=ta.Z._getWildcardCriteria(e))?(a=ta.Z._getRegIgnoreCase(n).exec(t),o=Lc(a)?-1:a.index):o=t.toLowerCase().indexOf(e.toLowerCase(),--r),-1===o?Bt.value:o+1}function _f(e,t){var r=""+(t||e||""),n=""+(e||""),a=rt._instance.custom.setExtraCalcResult;return a&&a({hyperlink:n}),r}function Ef(e){var t=rt._instance.custom.getCellHyperlink;return ht(e)&&e.getRangeCount()>0&&t&&t(e.getRow(0),e.getColumn(0),e.getSheetId(0))||""}var Tf={version:"1.0.2"},Sf=Math;function Cf(e,t){for(var r=0,n=0;r<e.length;++r)n=t*n+e[r];return n}function If(e,t,r,n,a){if(0===t)return r;if(1===t)return n;for(var o=2/e,i=n,u=1;u<t;++u)i=n*u*o+a*r,r=n,n=i;return i}function Af(e,t,r,n,a){return function(r,o){if(n){if(0===r)return 1==n?-1/0:1/0;if(r<0)return NaN}return 0===o?e(r):1===o?t(r):o<0?NaN:If(r,o|=0,e(r),t(r),a)}}var wf,xf,Df,bf,Of,Ff,Uf,Lf,Bf,kf,Pf,Gf,Hf,Yf=function(){var e=.636619772,t=[57568490574,-13362590354,651619640.7,-11214424.18,77392.33017,-184.9052456].reverse(),r=[57568490411,1029532985,9494680.718,59272.64853,267.8532712,1].reverse(),n=[1,-.001098628627,2734510407e-14,-2073370639e-15,2.093887211e-7].reverse(),a=[-.01562499995,.0001430488765,-6911147651e-15,7.621095161e-7,-9.34935152e-8].reverse();function o(o){var i=0,u=0,s=0,l=o*o;if(o<8)i=(u=Cf(t,l))/(s=Cf(r,l));else{var c=o-.785398164;u=Cf(n,l=64/l),s=Cf(a,l),i=Sf.sqrt(e/o)*(Sf.cos(c)*u-Sf.sin(c)*s*8/o)}return i}var i=[72362614232,-7895059235,242396853.1,-2972611.439,15704.4826,-30.16036606].reverse(),u=[144725228442,2300535178,18583304.74,99447.43394,376.9991397,1].reverse(),s=[1,.00183105,-3516396496e-14,2457520174e-15,-2.40337019e-7].reverse(),l=[.04687499995,-.0002002690873,8449199096e-15,-8.8228987e-7,1.05787412e-7].reverse();function c(t){var r=0,n=0,a=0,o=t*t,c=Sf.abs(t)-2.356194491;return Math.abs(t)<8?r=(n=t*Cf(i,o))/(a=Cf(u,o)):(n=Cf(s,o=64/o),a=Cf(l,o),r=Sf.sqrt(e/Sf.abs(t))*(Sf.cos(c)*n-Sf.sin(c)*a*8/Sf.abs(t)),t<0&&(r=-r)),r}return function e(t,r){if(r=Math.round(r),!isFinite(t))return isNaN(t)?t:0;if(r<0)return(r%2?-1:1)*e(t,-r);if(t<0)return(r%2?-1:1)*e(-t,r);if(0===r)return o(t);if(1===r)return c(t);if(0===t)return 0;var n=0;if(t>r)n=If(t,r,o(t),c(t),-1);else{for(var a=!1,i=0,u=0,s=1,l=0,f=2/t,d=2*Sf.floor((r+Sf.floor(Sf.sqrt(40*r)))/2);d>0;d--)l=d*f*s-i,i=s,s=l,Sf.abs(s)>1e10&&(s*=1e-10,i*=1e-10,n*=1e-10,u*=1e-10),a&&(u+=s),a=!a,d==r&&(n=i);n/=u=2*u-s}return n}}(),jf=(wf=.636619772,xf=[-2957821389,7062834065,-512359803.6,10879881.29,-86327.92757,228.4622733].reverse(),Df=[40076544269,745249964.8,7189466.438,47447.2647,226.1030244,1].reverse(),bf=[1,-.001098628627,2734510407e-14,-2073370639e-15,2.093887211e-7].reverse(),Of=[-.01562499995,.0001430488765,-6911147651e-15,7.621095161e-7,-9.34945152e-8].reverse(),Ff=[-4900604943e3,127527439e4,-51534381390,734926455.1,-4237922.726,8511.937935].reverse(),Uf=[249958057e5,424441966400,3733650367,22459040.02,102042.605,354.9632885,1].reverse(),Lf=[1,.00183105,-3516396496e-14,2457520174e-15,-2.40337019e-7].reverse(),Bf=[.04687499995,-.0002002690873,8449199096e-15,-8.8228987e-7,1.05787412e-7].reverse(),Af((function(e){var t=0,r=0,n=0,a=e*e,o=e-.785398164;return e<8?t=(r=Cf(xf,a))/(n=Cf(Df,a))+wf*Yf(e,0)*Sf.log(e):(r=Cf(bf,a=64/a),n=Cf(Of,a),t=Sf.sqrt(wf/e)*(Sf.sin(o)*r+Sf.cos(o)*n*8/e)),t}),(function(e){var t=0,r=0,n=0,a=e*e,o=e-2.356194491;return e<8?t=(r=e*Cf(Ff,a))/(n=Cf(Uf,a))+wf*(Yf(e,1)*Sf.log(e)-1/e):(r=Cf(Lf,a=64/a),n=Cf(Bf,a),t=Sf.sqrt(wf/e)*(Sf.sin(o)*r+Sf.cos(o)*n*8/e)),t}),0,1,-1)),Vf=(kf=[1,3.5156229,3.0899424,1.2067492,.2659732,.0360768,.0045813].reverse(),Pf=[.39894228,.01328592,.00225319,-.00157565,.00916281,-.02057706,.02635537,-.01647633,.00392377].reverse(),Gf=[.5,.87890594,.51498869,.15084934,.02658733,.00301532,32411e-8].reverse(),Hf=[.39894228,-.03988024,-.00362018,.00163801,-.01031555,.02282967,-.02895312,.01787654,-.00420059].reverse(),function e(t,r){if(0===(r=Math.round(r)))return function(e){return e<=3.75?Cf(kf,e*e/14.0625):Sf.exp(Sf.abs(e))/Sf.sqrt(Sf.abs(e))*Cf(Pf,3.75/Sf.abs(e))}(t);if(1===r)return function(e){return e<3.75?e*Cf(Gf,e*e/14.0625):(e<0?-1:1)*Sf.exp(Sf.abs(e))/Sf.sqrt(Sf.abs(e))*Cf(Hf,3.75/Sf.abs(e))}(t);if(r<0)return NaN;if(0===Sf.abs(t))return 0;if(t==1/0)return 1/0;var n,a=0,o=2/Sf.abs(t),i=0,u=1,s=0;for(n=2*Sf.round((r+Sf.round(Sf.sqrt(40*r)))/2);n>0;n--)s=n*o*u+i,i=u,u=s,Sf.abs(u)>1e10&&(u*=1e-10,i*=1e-10,a*=1e-10),n==r&&(a=i);return a*=e(t,0)/u,t<0&&r%2?-a:a}),$f=function(){var e=[-.57721566,.4227842,.23069756,.0348859,.00262698,1075e-7,74e-7].reverse(),t=[1.25331414,-.07832358,.02189568,-.01062446,.00587872,-.0025154,53208e-8].reverse(),r=[1,.15443144,-.67278579,-.18156897,-.01919402,-.00110404,-4686e-8].reverse(),n=[1.25331414,.23498619,-.0365562,.01504268,-.00780353,.00325614,-68245e-8].reverse();return Af((function(r){return r<=2?-Sf.log(r/2)*Vf(r,0)+Cf(e,r*r/4):Sf.exp(-r)/Sf.sqrt(r)*Cf(t,2/r)}),(function(e){return e<=2?Sf.log(e/2)*Vf(e,1)+1/e*Cf(r,e*e/4):Sf.exp(-e)/Sf.sqrt(e)*Cf(n,2/e)}),0,2,1)}();Tf.besselj=Yf,Tf.bessely=jf,Tf.besseli=Vf,Tf.besselk=$f;var Zf=Tf,Wf=Za._Complex,Xf=Jn.Z._isNullOrUndefined,Kf=ea.Z._getLength,zf=function(e,t){return!!Vn(e,t)&&Ln(t.value)<1e21&&(t.value=parseInt(t.value,10),!0)},qf=Hn,Jf=void 0,Qf=null;function ed(e,t,r,n){function a(e,t,r,n,a,o){var i,u=e,s=[];n=n<0?0:n,a=(r=r<0?0:r)+a>t.rowCount?t.rowCount-r:a,o=n+o>t.colCount?t.colCount-n:o;for(var l=0;l<a;l++){i=[],s.push(i);for(var c=0;c<o;c++)i.push(u[l+r][c+n])}return[s]}function o(e){return!Xf(e)&&!e._error}ht(t)&&(t=t.toArray()[0]),ht(r)&&(r=r.toArray()[0]);var i=rt._element,u=rt._instance,s=u.helper.getCalcRef,l=!0;if(ht(e)){var c,f,d={value:-1},h=e,m=h.getRowCount(0),g=h.getColumnCount(0),p=h.getRow(0),v=h.getColumn(0),y=h.getSheetId(0);if(2===Kf(arguments)){if(1!==h.getRangeCount()||1!==m&&1!==g)return Bt.ref;var N=o(t)&&zf(t,d)?d.value:0;if(0!==N||l||(N=m>0?i.row:i.col),N<0)return Bt.value;if(m*g<N)return Bt.ref;if(0===N){var M=1===m&&1===g;return s([{sheetId:y,row:p,col:v,refType:M?u.NODE_TYPE.CELL_RANGE_TYPE.CELL:u.NODE_TYPE.CELL_RANGE_TYPE.NORMAL,rowCount:m,colCount:g}],M)}return s([{sheetId:y,row:c=Math.floor((N-1)/g)+p,col:f=(N-1)%g+v,refType:u.NODE_TYPE.CELL_RANGE_TYPE.CELL,rowCount:1,colCount:1}],!0)}if(t=o(t)&&zf(t,d)?d.value-1:-1,r=o(r)&&zf(r,d)?d.value-1:-1,(n=o(n)&&zf(n,d)?d.value-1:0)>=h.getRangeCount())return Bt.ref;m=h.getRowCount(n),g=h.getColumnCount(n);var R=h.getRow(n),_=h.getColumn(n);if(-1===t&&!l&&m>1&&i!==Qf&&(t=i.row),-1===r&&!l&&g>1&&i!==Qf&&(r=i.col),c=t+R,f=r+_,t<-1||r<-1||n<0)return Bt.value;if(m<=t||g<=r||h.getRangeCount()<=n)return Bt.ref;if(-1===t&&-1===r){var E=1===m&&1===g;return s([{sheetId:y,row:R,col:_,refType:E?u.NODE_TYPE.CELL_RANGE_TYPE.CELL:u.NODE_TYPE.CELL_RANGE_TYPE.NORMAL,rowCount:m,colCount:g}],E)}if(-1===t){var T=1===m;return s([{sheetId:y,row:R,col:f,refType:T?u.NODE_TYPE.CELL_RANGE_TYPE.CELL:u.NODE_TYPE.CELL_RANGE_TYPE.NORMAL,rowCount:m,colCount:1}],T)}if(-1===r){var S=1===g;return s([{sheetId:y,row:c,col:_,refType:S?u.NODE_TYPE.CELL_RANGE_TYPE.CELL:u.NODE_TYPE.CELL_RANGE_TYPE.NORMAL,rowCount:1,colCount:g}],S)}return s([{sheetId:y,row:c,col:f,refType:u.NODE_TYPE.CELL_RANGE_TYPE.CELL,rowCount:1,colCount:1}],!0)}if(Array.isArray(e)){var C=Kn(e),I=C.rowCount;if(t=t!==Jf?qf(t):-1,r=r!==Jf?qf(r):-1,1!=(n=n!==Jf?qf(n)-1:1))return Bt.ref;-1===t&&-1===r?t=r=0:-1===r&&1===I&&(r=t,t=1),t=-1===t?0:t,r=-1===r?0:r,I=C.rowCount;var A=C.colCount;return t<0||r<0||n<0?Bt.value:(t>I&&1===I&&r===Jf&&(r=t,t=0),I<t||A<r?Bt.ref:0===t&&0===r?a(e[0],C,0,0,I,A):0===t?a(e[0],C,0,r-1,I,1):0===r?a(e[0],C,t-1,0,1,A):e[0][t-1][r-1])}if(t>=0&&t<=1&&r>=0&&r<=1)return e;throw new Error(Bt.ref)}function td(e,t){var r,n=e;ht(e)&&(n=Kn(e)[0],r=e.getSheetId(0)),ht(t)&&(t=Kn(t)[0]);var a=rt._element,o=rt._instance;if(r=r||a.sheetId,""===n||"string"!=typeof n)throw new Error(Bt.ref);if(!n)throw new Error(Bt.na);void 0===t&&(t=!0);var i=n,u=i=i.replace(/\$/g,"");if(!(yr.lA(i)||yr.lr(i)||yr.yH(i)||yr.n0(i)))throw new Error(Bt.ref);function s(){var e=i.lastIndexOf("!");if(-1!==e){var t=i.slice(0,e);if(Pt(r=o.helper.getSheetIdBySheetName(t)))throw new Error(Bt.ref);i=i.slice(e+1)}}if(t){var l=rt._funcNode,c=(l.calculateParentFunctionNode&&l.calculateParentFunctionNode.funcName,{row:a.row,col:a.col,sheetId:a.sheetId}),f=!1;if(yr.lA(i)){s();var d=K(i),h=d.row,m=d.col,g={endRow:h,startRow:h,endCol:m,startCol:m,startSheetId:r,endSheetId:r};f=!o.custom.addDependency(c,g)}else if(yr.lr(i)){s();var p=i.split(":"),v=p[0],y=p[1],N=K(v),M=N.row,R=N.col,_=K(y),E={endRow:_.row,startRow:M,endCol:_.col,startCol:R,startSheetId:r,endSheetId:r};f=!o.custom.addDependency(c,E)}else if(yr.yH(i)){s();var T=i.split(":"),S=T[0],C=T[1],I=q(S),A=q(C),w={endRow:O,startRow:b,endCol:A,startCol:I,startSheetId:r,endSheetId:r};f=!o.custom.addDependency(c,w)}else if(yr.n0(i)){s();var x=i.split(":"),D=x[0],F=x[1],U=Number(D),L={endRow:Number(F),startRow:U,endCol:O,startCol:b,startSheetId:r,endSheetId:r};f=!o.custom.addDependency(c,L)}if(f){var B={id:a.id,sheetId:a.sheetId,row:a.row,col:a.col,rowCount:a.rowCount,colCount:a.colCount},k=o.custom.parse(u,B);return o.calculate(k,B)}return""}if("string"==typeof i){var P=i.match(/^R([\d])+C([\d])+/);if(P){var G=P[1],H=P[2];return o.custom.cellValue(G,H,a.sheetId)||0}throw new Error(Bt.na)}throw new Error(Bt.na)}function rd(e,t,r,n,a){""===t?t=0:ht(t)&&(t=Kn(t)[0]),""===r?r=0:ht(r)&&(r=Kn(r)[0]),""===n?n=1:ht(n)&&(n=Kn(n)[0]),""===a?a=1:ht(a)&&(a=Kn(a)[0]);var o=rt._instance,i=o.helper.getCalcRef,u=e.getSheetId(0);if(!e||!ht(e)||1!==e.getRangeCount())return Bt.value;n=n!==Jf?qf(n):e.getRowCount(0),a=a!==Jf?qf(a):e.getColumnCount(0);var s=e.getRow(0)+t,l=e.getColumn(0)+r;if(n<=0||a<=0||s<0||l<0)return Bt.ref;var c=1===n&&1===a,f=rt._element;return o.custom.addDependency({row:f.row,col:f.col,sheetId:f.sheetId},{endRow:s+n-1,startRow:s,endCol:l+a-1,startCol:l,startSheetId:u,endSheetId:u}),i([{sheetId:u,row:s,col:l,refType:c?o.NODE_TYPE.CELL_RANGE_TYPE.CELL:o.NODE_TYPE.CELL_RANGE_TYPE.NORMAL,rowCount:n,colCount:a}],c)}function nd(e,t){var r=Number.POSITIVE_INFINITY,n=e._getReal(),a=e._getImag();return isNaN(n)||n===r||isNaN(a)||a===r?Bt.num:e._toString(t)}function ad(e,t){return Za._isBoolean(e)||Za._isBoolean(t)?Bt.value:(e=wn(e,rt._astNodes[0],!0),t=wn(t,rt._astNodes[1],!0),Rn(e=Za.convertArgToComplex(e),t=Za.convertArgToComplex(t))||e._suffix!==t._suffix?Bt.num:nd(new Wf(e._real-t._real,e._imag-t._imag,e._suffix)))}function od(e){return Za._isBoolean(e)?Bt.value:(e=wn(e,rt._astNodes[0],!0),mt(rt._astNodes[0])||""!==e?Rn(e=Za.convertArgToComplex(e))?Bt.num:nd(new Wf(e._real,-e._imag,e._suffix)):Bt.num)}function id(e,t,r){return void 0===r&&(r="i"),Za._isBoolean(e)||Za._isBoolean(t)||In(e,rt._astNodes[0])||In(t,rt._astNodes[1])?Bt.value:(e=wn(e,rt._astNodes[0]),t=wn(t,rt._astNodes[1]),e=Yn(e),t=Yn(t),isNaN(e)||isNaN(t)?Bt.value:(""===(r=Zn(r))&&(r="i"),"i"!==r&&"j"!==r?Bt.value:nd(new Wf(e,t),r)))}function ud(e,t,r){return e=wn(e,rt._astNodes[0]),t=wn(t,rt._astNodes[1]),e=Yn(e),t=Hn(t),isNaN(e)||isNaN(t)?Bt.value:t<0?Bt.num:Wn(r?Zf.besseli(e,t):Zf.besselj(e,t))}function sd(e,t,r){return e=wn(e,rt._astNodes[0]),t=wn(t,rt._astNodes[1]),e=Yn(e),t=Hn(t),isNaN(e)||isNaN(t)?Bt.value:e<=0||t<0?Bt.num:Wn(r?Zf.besselk(e,t):Zf.bessely(e,t))}function ld(e,t){return ud(e,t,!0)}function cd(e,t){return ud(e,t,!1)}function fd(e,t){return sd(e,t,!0)}function dd(e,t){return sd(e,t,!1)}function hd(e,t){var r={2:"0b",8:"0o",16:"0x",10:""},n=r[t],a=Math.pow(t,10),o=Number(""+(e.startsWith(r[16])?"":n)+e);return isNaN(o)?Bt.num:a/2<=o?o-a:o}function md(e,t,r){e<0&&(e+=Math.pow(t,10));var n,a=e.toString(t),o=r-Kf(a);for(n=0;n<o;n++)a="0"+a;return a.toUpperCase()}function gd(e,t){if(Za._isBoolean(e)||In(e,rt._astNodes[0]))return Bt.value;if(Pn(e=Zn(e)))return e;if("0"===e||""===e)return 0;if(e.length>10)return Bt.num;var r=hd(e,t);return Kf(r)<Kf(e)?Bt.num:r}function pd(e,t,r){if(void 0===t&&(t=""),Za._isBoolean(e)||Za._isBoolean(t)||In(e,rt._astNodes[0])||In(t,rt._astNodes[1]))return Bt.value;if(!gt(rt._astNodes[0])&&""===e)return Bt.na;if(""===(e=wn(e,rt._astNodes[0]))&&(e=0),e=Yn(e),isNaN(e))return Bt.value;e=parseInt(e,10);var n=!0;if(t=wn(t,rt._astNodes[1],!0),gt(rt._astNodes[1])||""!==t||(t=1,n=!1),t=Hn(t),isNaN(t))return Bt.value;if(t<1||t>10)return Bt.num;var a=md(e,r,t);return 0<=a&&t<Kf(a)&&n?Bt.num:a}function vd(e,t,r,n,a){if(void 0===t&&(t=""),Za._isBoolean(e)||Za._isBoolean(t)||In(e,rt._astNodes[0])||In(t,rt._astNodes[1]))return Bt.value;if(Pn(e=Zn(e)))return e;if("0"===e||""===e)return 0;if(e.length>10)return Bt.num;var o=!0;if(t=wn(t,rt._astNodes[1],!0),gt(rt._astNodes[1])||""!==t||(t=1,o=!1),t=Hn(t),isNaN(t))return Bt.value;if(t<1||t>10)return Bt.num;var i=hd(e,r);if(Kf(i)<Kf(e))return Bt.num;if(a&&(i<-a||a-1<i))return Bt.num;var u=md(i,n,t);return 0<=i&&t<Kf(u)&&o?Bt.num:u}function yd(e){return gd(e,2)}function Nd(e,t){return vd(e,t,2,8)}function Md(e,t){return vd(e,t,2,16)}function Rd(e){return gd(e,8)}function _d(e,t){return vd(e,t,8,2,512)}function Ed(e,t){return vd(e,t,8,16,549755813888)}function Td(e){return gd(e,16)}function Sd(e,t){return vd(e,t,16,2,512)}function Cd(e,t){return vd(e,t,16,8,536870912)}function Id(e,t){return pd(e,t,2)}function Ad(e,t){return pd(e,t,16)}function wd(e,t){return pd(e,t,8)}function xd(e,t,r){e=wn(e,rt._astNodes[0]),t=wn(t,rt._astNodes[1]),e=Xn(e),t=Xn(t),r=Zn(r),e.setHours(0,0,0,0),t.setHours(0,0,0,0),r=r.toLocaleUpperCase();var n=function(){var e=[];return e[0]=function(e,t){return t.getFullYear()-e.getFullYear()+(t.getMonth()<e.getMonth()||t.getMonth()===e.getMonth()&&t.getDate()<e.getDate()?-1:0)},e[1]=function(e,t){return 12*(t.getFullYear()-e.getFullYear())+(t.getMonth()-e.getMonth())+(t.getDate()<e.getDate()?-1:0)},e[2]=function(e,t){return(t.getTime()-e.getTime())/864e5},e[3]=function(e,t){var r=new Date(t.getFullYear(),t.getMonth()+(t.getDate()<e.getDate()?-1:0),e.getDate());return(t.getTime()-r.getTime())/864e5},e[4]=function(e,t){return t.getMonth()-e.getMonth()+(t.getMonth()<e.getMonth()||t.getMonth()===e.getMonth()&&t.getDate()<e.getDate()?12:0)+(t.getDate()<e.getDate()?-1:0)},e[5]=function(e,t){var r=t.getFullYear()+(t.getMonth()<e.getMonth()||t.getMonth()===e.getMonth()&&t.getDate()<e.getDate()?-1:0),n=e.getMonth(),a=e.getDate(),o=ri(e.getFullYear());return 1!==n||29!==a||ri(r)||a--,!o&&1===n&&28===a&&ri(r)&&a++,(t-new Date(r,n,a))/864e5},e}(),a=Jn.Z._inArray(r,["Y","M","D","MD","YM","YD"]),o=!1;if(t<e){var i=e;e=t,t=i,o=!0}if(a<0)return Bt.num;var u=(0,n[a])(e,t);return o?-1*u:u}var Dd={ORIGIN:function(e,t){if(Za._isBoolean(e)||Za._isBoolean(t)||In(e,rt._astNodes[0])||In(t,rt._astNodes[1]))return Bt.value;var r=!0;if(e=wn(e,rt._astNodes[0]),""===(t=wn(t,rt._astNodes[1]))&&(t=0),void 0===t&&(t=0,r=!1),e=Yn(e),t=Yn(t),isNaN(e)||isNaN(t))return Bt.value;var n=Za._st_normsdist(e*Math.sqrt(2)),a=2*parseFloat(n)-1;return r&&(n=Za._st_normsdist(t*Math.sqrt(2)),a=2*parseFloat(n)-1-a),a},PRECISE:function(e){return Dd.ORIGIN(e)}},bd={};function Od(e,t){for(var r=0,n=Kf(t);r<n;r++)for(var a=t[r],o=0;a[o];o++)if(0===e.localeCompare(a[o]))return!1;return!0}function Fd(e,t,r,n){var a,o=0,i=1;for(a=0;e[a]._str;a++)if(0===r.localeCompare(e[a]._str))return{_hasUnit:!0,_prefix:i,_constant:o=e[a]._c};if(t)for(a=0;t[a]._str;a++)r.substr(0,1)===t[a]._str.substr(0,1)&&Od(r,n)&&(i=t[a]._c);for(a=0;e[a]._str;a++){var u=Kf(e[a]._str);if(r.substr(1,Kf(r))===e[a]._str.substr(0,u)&&Od(r,n))return{_hasUnit:!0,_prefix:i,_constant:o=e[a]._c}}return{_hasUnit:!1,_prefix:i,_constant:o}}function Ud(e,t){return{_str:e,_c:t}}function Ld(e,t){var r,n=[];for(r=0;r<Kf(e);r++)n.push(new Ud(e[r],t[r]));return n.push(new Ud(null,0)),n}bd.PRECISE=function(e){return 1-Dd.ORIGIN(e)};var Bd=Ld(["g","sg","lbm","u","ozm","grain","cwt","shweight","uk_cwt","lcwt","hweight","stone","ton","uk_ton","LTON","brton"],[1,6852205001e-14,.002204622915,602217e18,.035273972,1e8/6479891,173/7847148,173/7847148,55/2794129,55/2794129,55/2794129,1129/7169481,4/3628739,1/1016047,1/1016047]),kd=1e4/254,Pd=Ld(["m","mi","Nmi","in","ft","yd","ang","ell","ly","parsec","pc","Picapt","Pica","pica","survey_mi","km"],[1,.000621371192237334,1/1852,kd,3.2808398950131235,1.0936132983377078,1e10,1e3/1143,1057e-19,324078e-22,324078e-22,2834.645669,2834.645669,3e4/127,3937/6336e3,.001]),Gd=365.25,Hd=525960,Yd=31557600,jd=Ld(["yr","day","d","hr","mn","min","s","sec"],[1,Gd,Gd,8766,Hd,Hd,Yd,Yd]),Vd=.00750061708,$d=Ld(["Pa","atm","mmHg","p","at","psi","Torr"],[1,9869233e-12,Vd,1,Vd,857/5908807,152/20265]),Zd=1e5,Wd=Ld(["N","dyn","lbf","dy","pond"],[1,Zd,.224808924,Zd,2e7/196133]),Xd=745.6998715822702,Kd=Ld(["HP","W","h","w","PS"],[1,Xd,1,Xd,5567865/5491697]),zd=62146e14,qd=1/(3600*Xd),Jd=1/3600,Qd=947815e-9,eh=Ld(["J","e","c","cal","eV","HPh","Wh","flb","BTU","ev","hh","wh","btu"],[1,9999995.193,.239006249,.238846191,zd,qd,Jd,23.73042222,Qd,zd,qd,Jd,Qd]),th=Ld(["T","gs","ga"],[1,1e4,1e4]),rh=.0049289216,nh=Ld(["tsp","tspm","tbs","oz","cup","pt","qt","gal","l","uk_pt","us_pt","lt","L","uk_gal","ang3","ang^3","barrel","bushel","ft3","ft^3","in3","in^3","ly3","ly^3","m3","m^3","mi3","mi^3","yd3","yd^3","Nmi3","Nmi^3","Picapt3","Picapt^3","Pica3","Pica^3","GRT","regton","MTON"],[1,6636025/6731721,1/3,1/6,1/48,1/96,1/192,1/768,rh,.008675585,1/96,rh,rh,8530/7867471,492892e19,492892e19,1/32256,977/6985011,77/442368,77/442368,77/256,77/256,582074e-59,582074e-59,22/4463451,22/4463451,118251e-20,118251e-20,19/2947205,19/2947205,775941e-21,775941e-21,112266,112266,112266,112266,10/5745039,10/5745039,34/7813253]),ah=Ld(["bit","byte"],[1,1/8]),oh=Ld(["kn","m/s","m/sec","m/h","m/hr","admkn","mph"],[1,463/900,463/900,1852,1852,57875/57912,57875/50292]),ih=Ld(["uk_acre","us_acre","ang2","ang^2","ar","ft2","ft^2","ha","in2","in^2","ly2","ly^2","m2","m^2","Morgen","mi2","mi^2","Nmi2","Nmi^2","Picapt2","Pica2","Pica^2","Picapt^2","yd2","yd^2"],[1,.999996000004,404686e18,404686e18,40.468564224,43560,43560,3870320/9563769,6272640,6272640,452135e-34,452135e-34,4046.8564224,4046.8564224,15481280/9563769,1/640,10558/8948409,10558/8948409,32517365760,32517365760,32517365760,32517365760,4840,4840]),uh=Ld(["Y","Z","E","P","T","G","M","k","h","e","d","c","m","u","n","p","f","a","z","y"],[1e24,1e21,1e18,1e15,1e12,1e9,1e6,1e3,100,10,.1,.01,.001,1e-6,1e-9,1e-12,1e-15,1e-18,1e-21,1e-24]);function sh(e,t,r){if(Za._isBoolean(e)||In(e,rt._astNodes[0]))return Bt.value;if(e=wn(e,rt._astNodes[0]),e=Number(e),isNaN(e))return Bt.value;function n(e,t){return e===t}t=Zn(t),r=Zn(r);var a=273.15,o=459.67;if(!t||!r)return Bt.na;var i=n(t,"C")||n(t,"cel"),u=n(r,"C")||n(r,"cel"),s=n(t,"F")||n(t,"fah"),l=n(r,"F")||n(r,"fah"),c=n(t,"K")||n(t,"kel"),f=n(r,"K")||n(r,"kel"),d=n(t,"Rank"),h=n(r,"Rank"),m=n(t,"Reau"),g=n(r,"Reau");if(i&&u||s&&l||c&&f||d&&h||m&&g)return e;if(i&&l)return 9*e/5+32;if(s&&u)return 5*(e-32)/9;if(s&&f)return 5*(e-32)/9+a;if(c&&l)return 9*(e-a)/5+32;if(i&&f)return e+a;if(c&&u)return e-a;if(i&&h)return 9*e/5+32+o;if(s&&h)return e+o;if(c&&h)return 9*e/5;if(m&&h)return 9*e/4+32+o;if(d&&u)return(e-32-o)/1.8;if(d&&l)return e-o;if(d&&f)return e/1.8;if(d&&g)return(e-o-32)/(9/4);if(i&&g)return 4*e/5;if(s&&g)return(e-32)/(9/4);if(c&&g)return.8*(e-a);if(m&&u)return 5*e/4;if(m&&l)return 9*e/4+32;if(m&&f)return 5*e/4+a;for(var p=[Bd,Pd,jd,$d,Wd,eh,Kd,th,nh,ah,oh,ih],v=0;v<Kf(p);v++){var y=p[v],N=Fd(y,uh,t,p),M=N._hasUnit,R=N._constant,_=N._prefix,E=(N=Fd(y,uh,r,p))._hasUnit,T=N._prefix,S=N._constant;if(M&&E&&0!==R&&0!==T)return e*_/R*S/T}return Bt.na}function lh(e,t){return void 0===t&&(t=0),Za._isBoolean(e)||Za._isBoolean(t)||In(e,rt._astNodes[0])||In(t,rt._astNodes[1])?Bt.value:(e=wn(e,rt._astNodes[0]),t=wn(t,rt._astNodes[1]),e=Yn(e),t=Yn(t),isNaN(e)||isNaN(t)?Bt.value:ca(e,t)?1:0)}function ch(e,t){return void 0===t&&(t=0),Za._isBoolean(e)||Za._isBoolean(t)||In(e,rt._astNodes[0])||In(t,rt._astNodes[1])?Bt.value:(e=wn(e,rt._astNodes[0]),t=wn(t,rt._astNodes[1]),e=Yn(e),t=Yn(t),isNaN(e)||isNaN(t)?Bt.value:e>=t?1:0)}var fh=Jn.Z,dh=(fh._isNullOrUndefined,fh._inArray),hh=fh._isArray,mh=ea.Z._getLength,gh=ga._pow1p,ph=Za._MAX_DOUBLE_VALUE,vh=Za._daysBetweenBasis,yh=Za._getDaysInMonth,Nh=Za._compareDateTime,Mh=Za._days360,Rh=xn.Z._toOADate,_h=void 0,Eh=null,Th=isFinite;function Sh(e,t,r,n){if(e>-1&&0!==e){var a=r,o=Math.pow(1+e,a._nper-(n?1:0)),i=(Math.pow(1+e,a._nper)-1)/e;return[!0,t=n?-a._pmt*i/e+o*a._nper*(a._pv+a._pmt*(a._type+1/e)):a._pv*o+a._pmt*(1+e*a._type)*i+a._fv,r]}return[!1,t,r]}function Ch(e,t,r){return t>0?(r._havexpos?r._havexneg?Math.abs(e-r._xneg)<Math.abs(r._xpos-r._xneg)&&(r._xpos=e,r._ypos=t):t<r._ypos&&(r._xpos=e,r._ypos=t):(r._xpos=e,r._ypos=t,r._havexpos=!0),[!1,r]):t<0?(r._havexneg?r._havexpos?Math.abs(e-r._xpos)<Math.abs(r._xpos-r._xneg)&&(r._xneg=e,r._yneg=t):-t<-r._yneg&&(r._xneg=e,r._yneg=t):(r._xneg=e,r._yneg=t,r._havexneg=!0),[!1,r]):(r._root=e,[!0,r])}function Ih(e,t,r,n,a,o,i,u,s,l,c,f,d,h,m){var g,p,v,y,N=0,M=0,R=r-a,_=r+a,E=2===e;if(R<o._xmin&&(R=r),_>o._xmax&&(_=r),R===_)return E?[!1,n,o,i]:[!1,n,o];if(0===e?(g=t(i,u,s,R,c,f,d,h,m)-l,p=t(i,u,s,_,c,f,d,h,m)-l):1===e?(g=t(R,i,N,u),p=t(_,i,M,u)):(g=Sh(R,N,i),p=Sh(_,M,i)),hh(g)){if(y=g[2],N=g[1],!(v=g[0]))return E?[v,n,o,y]:[v,n,o]}else N=g;if(hh(p)){if(y=p[2],M=p[1],!(v=p[0]))return E?[v,n,o,y]:[v,n,o]}else M=p;return n=(M-N)/(_-R),E?[!0,n,o,y]:[!0,n,o]}function Ah(e,t,r){var n=0;if(t<e._xmin||t>e._xmax)return[!1,e,r];var a=Sh(t,n,r);if(r=a[2],n=a[1],!a[0])return[a[0],e,r];var o=Ch(t,n,e);return e=o[1],[!!o[0],e,r]}function wh(e,t,r,n,a,o,i,u,s,l){var c,f=0,d=e?15:2;if(!r._havexpos||!r._havexneg)return e?[!1,r,n]:[!1,r];var h=Math.abs(r._xpos-r._xneg)/(Math.abs(r._xpos)+Math.abs(r._xneg));for(c=0;c<100+4*d;c++){var m,g;if(m=c%4==0?1:c%4==2?2:3,r=(g=e?Dh(r,n,h,f,0,m):t?bh(!0,r,f,0,0,m,xh,h,a,n,Ih):bh(!1,r,f,0,0,m,$h,h,o,i,u,n,a,s,l))[1],n=g[2],f=e?g[3]:g[2],g[0])return e?[!0,r,n]:[!0,r]}return e?[!1,r,n]:[!1,r]}function xh(e,t,r,n){for(var a=0,o=mh(t),i=0;i<o;i++){var u=Vh(n[i])-Vh(n[0]);if(u<0)return[!1,r];a+=t[i]/gh(e,u/365)}return Th(a)?r=isNaN(a)?5e-324:a:a===Number.POSITIVE_INFINITY?r=ph:a===Number.NEGATIVE_INFINITY&&(r=-ph),[!0,r]}function Dh(e,t,r,n,a,o){var i;if(1===o){var u=Sh(i=(e._xpos+e._xneg)/2,a,t);if(t=u[2],a=u[1],!u[0])return[Eh,e,t,n];if(0===a)return[!0,e=Ch(i,a,e)[1],t,n];if(0===Math.sqrt(a*a-e._ypos*e._yneg))return[Eh,e,t,n]}else if(2===o){var s,l=0,c=0;if(r>.1)return Dh(e,t,r,n,a,o=3);var f=n++%4;if(0===f)s=e._xpos,l=e._ypos;else if(2===f)s=e._xneg,l=e._yneg;else if(t=(u=Sh(s=(e._xpos+e._xneg)/2,l,t))[2],l=u[1],!u[0])return[Eh,e,t,n];var d=Ih(2,void 0,s,c,Math.abs(e._xpos-e._xneg)/1e6,e,t);if(t=d[3],e=d[2],c=d[1],!d[0]||0===c)return[Eh,e,t,n];if((i=s-1.01*l/c)<e._xpos&&i<e._xneg||i>e._xpos&&i>e._xneg)return[Eh,e,t,n]}return[!1,e,t,n]}function bh(e,t,r,n,a,o,i,u,s,l,c,f,d,h,m,g,p){var v;switch(o){case 0:n=t._xpos-t._ypos*((t._xneg-t._xpos)/(t._yneg-t._ypos));break;case 1:if(n=(t._xpos+t._xneg)/2,v=e?i(n,l,a,s):i(f,d,s,n,c,h,m,g,p)-l,hh(v)){if(a=v[1],!v[0])return[Eh,t,r,n,a,o]}else a=v;if(0===a)return[!0,t=Ch(n,a,t)[1],r,n,a,o];var y=Math.sqrt(a*a-t._ypos*t._yneg);if(0===y)return[Eh,t,r,n,a,o];n+=(n-t._xpos)*a/y;break;case 3:n=(t._xpos+t._xneg)/2;break;case 2:var N,M,R=0,_=0;if(u>.1)return bh(e,t,r,n,a,o=3,i,u,s,l,c,f,d,h,m);var E=r++%4;if(0===E)N=t._xpos,R=t._ypos;else if(2===E)N=t._xneg,R=t._yneg;else if(N=(t._xpos+t._xneg)/2,v=e?i(N,l,R,s):i(f,d,s,N,c,h,m,g,p)-l,hh(v)){if(R=v[1],!v[0])return[Eh,t,r,n,a,o]}else R=v;M=Math.abs(t._xpos-t._xneg)/1e6;var T=e?c(1,i,N,_,M,t,l,s):Ih(0,i,N,_,M,t,f,d,s,l,c,h,m,g,p);if(t=T[2],_=T[1],!T[0]||0===_)return[Eh,t,r,n,a,o];if((n=N-1.01*R/_)<t._xpos&&n<t._xneg||n>t._xpos&&n>t._xneg)return[Eh,t,r,n,a,o]}return[!1,t,r,n,a,o]}function Oh(e,t,r,n,a,o,i,u,s,l,c,f,d){if(n<r._xmin||n>r._xmax)return[!1,r];var h=Ch(n,e?Fh(n,a):t(a,o,i,n,s,l,c,f,d)-u,r);return r=h[1],[!!h[0],r]}function Fh(e,t,r){var n,a=mh(t),o=0;for(n=0;n<a;n++)o+=(r?-n:1)*t[n]*Math.pow(1+e,-n-1-(r?1:0));return o}function Uh(e,t,r,n){return vh(kh(e,t,r,!1),e,n)}function Lh(e,t,r,n){return vh(e,kh(e,t,r,!0),n)}function Bh(e,t,r,n){return dh(n,[0,2,4,5])>=0?360/r:3===n?365/r:vh(kh(e,t,r,!1),kh(e,t,r,!0),1)}function kh(e,t,r,n){var a=Gh(t),o=Hh(t),i=Yh(t),u=new Date(1,0,1),s=(yh(a,o),12/r),l=a-Gh(e);u.setFullYear(1),l>0&&(l=(l-1)*r);do{l++,(u=new Date(a,o,i)).setMonth(o-l*s),Yh(u)!==i&&u.setDate(0)}while(Nh(e,u)<0);return n&&(l--,(u=new Date(a,o,i)).setMonth(o-l*s),Yh(u)!==i&&u.setDate(0)),u}function Ph(e,t,r){var n=Gh(t),a=Hh(t),o=Yh(t),i=new Date(n,a,o),u=a-Hh(e)+12*(n-Gh(e));if(i.setMonth(Hh(i)-u),o===yh(n,a))for(;Yh(i)!==yh(Gh(i),Hh(i));)i.setDate(Yh(i)+1);return Yh(e)>=Yh(i)&&u--,parseInt((1+u/(12/r)).toString())}function Gh(e){return e.getFullYear()}function Hh(e){return e.getMonth()}function Yh(e){return e.getDate()}function jh(e,t,r){var n=Gh(t)-Gh(e),a=Hh(t)-Hh(e)+12*n,o=Yh(t)-Yh(e),i=-1;return 0===r?i=Mh(e,t):dh(r,[1,2,3])>=0?i=Vh(t)-Vh(e):4===r&&(i=30*a+o),i}function Vh(e){return e instanceof Date?Rh(e):e}function $h(e,t,r,n,a,o,i){for(var u=Uh(e,t,o,i),s=Lh(e,t,o,i),l=Bh(e,t,o,i),c=parseInt(Ph(e,t,o).toString(),10),f=0,d=100*r/o,h=1+n/o,m=s/l,g=0;g<c;g++)f+=d/Math.pow(h,m+g);return a/Math.pow(h,c-1+s/l)+f-u/l*d}var Zh=Jn.Z._inArray,Wh=Za._MAX_DOUBLE_VALUE,Xh=Za._compareDateTime,Kh=Za._annualYearBasis,zh=Za._yearfrac;function qh(e,t){if("boolean"==typeof e)return Bt.value;if(!Array.isArray(t)&&"boolean"==typeof t)return Bt.value;if(e=wn(e,rt._astNodes[0]),isNaN(e))return Bt.value;t=hn(t),t=Nt(rt._astNodes[1])?t.map((function(e){if(Pt(e))return e;var t=Number.parseFloat(e);return isNaN(t)?Bt.value:t})):t.map((function(e){if(Pt(e))return e;if(null===e)return 0;var t=Number.parseFloat(e);return isNaN(t)?Bt.value:t}));for(var r,n=c(t);!(r=n()).done;){var a=r.value;if(Pt(a))return a}for(var o=t.length,i=e,u=0;u<o;u++)i*=1+t[u];return i}function Jh(e,t,r,n,a){if(n=n||0,a=void 0===a?0:a,e=wn(e,rt._astNodes[0]),t=wn(t,rt._astNodes[1]),r=wn(r,rt._astNodes[2]),n=wn(n,rt._astNodes[3]),a=wn(a,rt._astNodes[4]),isNaN(e)||isNaN(t)||isNaN(r)||isNaN(n)||isNaN(a))return Bt.value;a=0===a?0:1;var o=Math.pow(1+e,t);return Wn(-(o=0===e?(r+n)/t:(r*o+n)/((1+e*a)*(o-1)/e)))}function Qh(e,t,r,n,a){var o=Jh(e,t,r,n,a);return Pt(o),o}function em(e,t,r,n,a,o){var i=function(e,t,r,n,a,o){if(n=void 0===n?0:n,a=void 0===a?0:a,o=void 0===o?.1:o,e=wn(e,rt._astNodes[0]),t=wn(t,rt._astNodes[1]),r=wn(r,rt._astNodes[2]),n=wn(n,rt._astNodes[3]),a=wn(a,rt._astNodes[4]),o=wn(o,rt._astNodes[5]),isNaN(e)||isNaN(t)||isNaN(r)||isNaN(n)||isNaN(a)||isNaN(o))return Bt.value;a=0===a?0:1;var i={_precision:1e-10,_havexpos:!1,_xpos:0,_ypos:0,_havexneg:!1,_xneg:0,_yneg:0,_root:0},u=Math.pow(17976931348623157e282,1/e);i._xmin=Math.max(-1e10,1-u),i._xmax=Math.min(1e10,u-1);var s={_nper:e,_pmt:t,_pv:r,_fv:n,_type:a},l=function(e,t,r){var n,a=e._precision/2;for(n=0;n<100;n++){var o,i,u,s=0,l=0;if(r<e._xmin||r>e._xmax)return[!1,e,t];var c=Sh(r,s,t);if(t=c[2],s=c[1],!(u=c[0]))return[u,e,t];var f=Ch(r,s,e);if(e=f[1],f[0])return[!0,e,t];if(t=(c=Sh(r,l,t,!0))[2],l=c[1],!(u=c[0]))return[u,e,t];if(0===l)return[!1,e,t];if((o=r-1.000001*s/l)===r)return e._root=r,[!0,e,t];if(i=Math.abs(o-r)/(Math.abs(r)+Math.abs(o)),r=o,i<a)return e._root=r,[!0,e,t]}return[!1,e,t]}(i,s,o);s=l[2],i=l[1];var c,f=l[0];if(!f){for(c=2;(!i._havexneg||!i._havexpos)&&c<100;c*=2)s=(l=Ah(i,o*c,s))[2],s=(l=Ah(i=l[1],o/c,s))[2],i=l[1];i=(l=wh(!0,!1,i,s))[1],f=l[0]}return f?i._root:Bt.num}(e,t,r,n,a,o);return Pt(i)||rt._funcNode.setFormatType("0.00%"),i}function tm(e,t,r,n,a,o){var i=function(e,t,r,n,a,o){return a=void 0===a?0:a,o=void 0===o?0:o,e=wn(e,rt._astNodes[0]),t=wn(t,rt._astNodes[1]),r=wn(r,rt._astNodes[2]),n=wn(n,rt._astNodes[3]),a=wn(a,rt._astNodes[4]),o=wn(o,rt._astNodes[5]),isNaN(e)||isNaN(t)||isNaN(r)||isNaN(n)||isNaN(a)||isNaN(o)?Bt.value:(o=0===o?0:1,t>=r+1?Bt.num:1===t&&1===o?0:um(n,im(e,r,n,a,o),e,t-1,o))}(e,t,r,n,a,o);return Pt(i),i}function rm(e,t,r,n,a,o){var i=function(e,t,r,n,a,o){if(a=void 0===a?0:a,o=void 0===o?0:o,e=wn(e,rt._astNodes[0]),t=wn(t,rt._astNodes[1]),r=wn(r,rt._astNodes[2]),n=wn(n,rt._astNodes[3]),a=wn(a,rt._astNodes[4]),o=wn(o,rt._astNodes[5]),isNaN(e)||isNaN(t)||isNaN(r)||isNaN(n)||isNaN(a)||isNaN(o))return Bt.value;if(o=0===o?0:1,t>=r+1)return Bt.num;var i=im(e,r,n,a,o);return i-um(n,i,e,t-1,o)}(e,t,r,n,a,o);return Pt(i),i}function nm(e,t,r,n,a){if(n=void 0===n?0:n,a=void 0===a?0:a,e=wn(e,rt._astNodes[0]),t=wn(t,rt._astNodes[1]),r=wn(r,rt._astNodes[2]),n=wn(n,rt._astNodes[3]),a=wn(a,rt._astNodes[4]),isNaN(e)||isNaN(t)||isNaN(r)||isNaN(n)||isNaN(a))return Bt.value;a=0===a?0:1;var o=Math.pow(1+e,t);return Wn(-(o=0===e?r*t+n:n*o+r*(1+e*a)*(o-1)/e))}function am(e,t,r,n,a){var o=nm(e,t,r,n,a);return Pt(o),o}function om(e,t,r,n,a){var o=function(e,t,r,n,a){if(n=void 0===n?0:n,a=void 0===a?0:a,e=wn(e,rt._astNodes[0]),t=wn(t,rt._astNodes[1]),r=wn(r,rt._astNodes[2]),n=wn(n,rt._astNodes[3]),a=wn(a,rt._astNodes[4]),isNaN(e)||isNaN(t)||isNaN(r)||isNaN(n)||isNaN(a))return Bt.value;if(a=0===a?0:1,0===e)return Wn(-(r*t+n));var o=Math.pow(1+e,t);return-1===e?Bt.div0:Wn(-(n+r*(1+e*a)*(o-1)/e)/o)}(e,t,r,n,a);return Pt(o),o}function im(e,t,r,n,a){var o=Math.pow(1+e,t),i=isFinite(o)?o:Bt.num;return 0===e?t:(o=(o-1)/e,o=(-r*i-n)/((1+e*a)*(isFinite(o)?o:Bt.num)),isFinite(o)?o:Bt.num)}function um(e,t,r,n,a){if(1===a){var o=-(e*(i=Math.pow(1+r,n-1))*r+t*(1+r)*(i-1))-t*r;return isFinite(o)?o:Bt.num}var i;return o=-(e*(i=Math.pow(1+r,n))*r+t*(i-1)),isFinite(o)?o:Bt.num}function sm(e,t){var r=function(e,t){if(!Array.isArray(e))return Bt.num;if(e=hn(e),t=wn(t=void 0===t?.1:t,rt._astNodes[1]),isNaN(t))return Bt.value;Math.abs(t)>1&&(t=.1);var r=e,n=ea.Z._getLength(r),a=[],o=!1,i=!1,u={_xmin:-1,_xmax:1e10,_precision:1e-10,_havexpos:!1,_xpos:0,_ypos:0,_havexneg:!1,_xneg:0,_yneg:0,_root:0};if(n<2)return Bt.num;u._xmax=Math.min(u._xmax,Math.pow(Wh/1e10,1/n)-1);for(var s=0;s<n;s++){var l=r[s];if(Pt(l))return Bt.value;a[s]=l,l>0&&(o=!0),l<0&&(i=!0)}if(!o||!i)return Bt.num;var c=function(e,t,r){var n,a=e._precision/2;for(n=0;n<20;n++){var o,i,u,s;if(r<e._xmin||r>e._xmax)return[!1,e];var l=Ch(r,u=Fh(r,t),e);if(e=l[1],l[0])return[!0,e];if(0===(s=Fh(r,t,!0)))return[!1,e];if((o=r-1.000001*u/s)===r)return e._root=r,[!0,e];if(i=Math.abs(o-r)/(Math.abs(r)+Math.abs(o)),r=o,i<a)return e._root=r,[!0,e]}return[!1,e]}(u,a,t);u=c[1];var f,d=c[0];if(!d){for(f=2;(!u._havexneg||!u._havexpos)&&f<100;f*=2)u=Oh(!0,_h,u,t*f,a)[1],u=Oh(!0,_h,u,t/f,a)[1];c=function(e,t,r,n,a,o,i,u,s,l,c){var f,d,h=0;if(!t._havexpos||!t._havexneg)return[!1,t];for(d=Math.abs(t._xpos-t._xneg)/(Math.abs(t._xpos)+Math.abs(t._xneg)),f=0;f<160;f++){var m=0,g=0,p=bh(!0,t,h,m,g,f%4==0?1:f%4==2?2:3,Fh,d,_h,r,Ih);if(t=p[1],h=p[2],m=p[3],p[0]!==Eh){if(p[0])return[!0,t];var v=Ch(m,g=Fh(m,r),t);if(t=v[1],v[0])return[!0,t];if((d=Math.abs(t._xpos-t._xneg)/(Math.abs(t._xpos)+Math.abs(t._xneg)))<t._precision)return t._yneg<g&&(g=t._yneg,m=t._xneg),t._ypos<g&&(m=t._xpos),t._root=m,[!0,t]}}return[!1,t]}(0,u,a),u=c[1],d=c[0]}return d?u._root:Bt.num}(e,t);return Pt(r)||rt._funcNode.setFormatType("0.00%"),r}function lm(e,t,r,n,a,o,i){if(t=wn(t,rt._astNodes[1]),r=wn(r,rt._astNodes[2]),n=wn(n,rt._astNodes[3]),a=wn(a,rt._astNodes[4]),o=wn(o,rt._astNodes[5]),i=wn(i,rt._astNodes[6]),isNaN(t)||isNaN(r)||isNaN(a)||isNaN(o)||isNaN(i))return Bt.value;if(t<=0||r<=0||n<=0)return Bt.num;if(a<1||o<1)return Bt.num;if(o<a||o>r||0!==i&&1!==i)return Bt.num;var u,s,l=Jh(t,r,n,0,i),c=0;for(1===a&&(e&&(c=l),i<=0&&(c+=e?n*t:-n),a++),u=a;u<=o;u++)s=i>0?nm(t,u-2,l,n,1)-l:nm(t,u-1,l,n,0),c+=e?l-s*t:s;return e?c:c*t}function cm(e,t,r,n,a,o){var i=function(e,t,r,n,a,o){return lm(!1,e,t,r,n,a,o)}(e,t,r,n,a,o);return Pt(i),i}function fm(e,t,r,n,a,o){var i=function(e,t,r,n,a,o){return lm(!0,e,t,r,n,a,o)}(e,t,r,n,a,o);return Pt(i),i}function dm(e,t){var r=function(e,t){return"boolean"==typeof e||"boolean"==typeof t?Bt.value:(e=wn(e,rt._astNodes[0]),t=wn(t,rt._astNodes[1]),isNaN(e)||isNaN(t)?Bt.value:e<=0||t<1?Bt.num:(t=Hn(t),Math.pow(1+e/t,t)-1))}(e,t);return Pt(r)||rt._funcNode.setFormatType("0.00%"),r}function hm(e,t){var r=function(e,t){return"boolean"==typeof e||"boolean"==typeof t?Bt.value:(e=wn(e,rt._astNodes[0]),t=wn(t,rt._astNodes[1]),isNaN(e)||isNaN(t)?Bt.value:e<=0||t<1?Bt.num:t*(Math.pow(1+e,1/t)-1))}(e,t);return Pt(r)||rt._funcNode.setFormatType("0.00%"),r}function mm(e,t,r,n){var a=function(e,t,r,n){return e=wn(e,rt._astNodes[0]),t=wn(t,rt._astNodes[1]),r=wn(r,rt._astNodes[2]),n=wn(n,rt._astNodes[3]),isNaN(e)||isNaN(t)||isNaN(r)||isNaN(n)?Bt.value:t<0||r<=0||n<=0||n>r?Bt.num:(e-t)*(r-n+1)*2/(r*(r+1))}(e,t,r,n);return Pt(a),a}function gm(e,t,r){var n=function(e,t,r){return e=wn(e,rt._astNodes[0]),t=wn(t,rt._astNodes[1]),r=wn(r,rt._astNodes[2]),isNaN(e)||isNaN(t)||isNaN(r)?Bt.value:0===r?Bt.div0:(e-t)/r}(e,t,r);return Pt(n),n}function pm(e,t,r,n,a,o,i){var u=function(e,t,r,n,a,o,i){return i=void 0===i?0:i,e=Xn(e),t=Xn(t),e instanceof Date&&e.setHours(0,0,0),t instanceof Date&&t.setHours(0,0,0),r=wn(r,rt._astNodes[2]),n=wn(n,rt._astNodes[3]),a=wn(a,rt._astNodes[4]),o=wn(o,rt._astNodes[5]),i=wn(i,rt._astNodes[6]),isNaN(r)||isNaN(n)||isNaN(a)||isNaN(o)||isNaN(i)?Bt.value:(o=o>=0?Math.floor(o):Math.ceil(o),i=i>=0?Math.floor(i):math.ceil(i),r<0||n<0||a<=0||Zh(o,[1,2,4])<0||Zh(i,[0,1,2,3,4])<0||Xh(e,t)>=0?Bt.num:$h(e,t,r,n,a,o,i))}(e,t,r,n,a,o,i);return Pt(u),u}function vm(e,t,r,n,a){var o=function(e,t,r,n,a){if(a=void 0===a?0:a,e=Xn(e),t=Xn(t),e instanceof Date&&e.setHours(0,0,0),t instanceof Date&&t.setHours(0,0,0),r=wn(r,rt._astNodes[2]),n=wn(n,rt._astNodes[3]),a=wn(a,rt._astNodes[4]),isNaN(r)||isNaN(n)||isNaN(a))return Bt.value;if(a=a>=0?Math.floor(a):math.ceil(a),r<=0)return Bt.num;if(n<=0)return Bt.num;if(Zh(a,[0,1,2,3,4])<0)return Bt.num;if(Xh(e,t)>=0)return Bt.num;var o=jh(e,t,a),i=Kh(e,a);return o<=0||i<=0?Bt.num:n-r*n*o/i}(e,t,r,n,a);return Pt(o),o}function ym(e,t,r,n,a,o){var i=function(e,t,r,n,a,o){if(o=void 0===o?0:o,e=Xn(e),t=Xn(t),r=Xn(r),e instanceof Date&&e.setHours(0,0,0),t instanceof Date&&t.setHours(0,0,0),r instanceof Date&&r.setHours(0,0,0),n=wn(n,rt._astNodes[3]),a=wn(a,rt._astNodes[4]),o=wn(o,rt._astNodes[5]),isNaN(n)||isNaN(a)||isNaN(o))return Bt.value;if(o=o>=0?Math.floor(o):math.ceil(o),n<0)return Bt.num;if(a<0)return Bt.num;if(Zh(o,[0,1,2,3,4])<0)return Bt.num;if(Xh(e,t)>=0)return Bt.num;if(Xh(r,e)>=0)return Bt.num;if(Xh(r,t)>=0)return Bt.num;var i=jh(e,t,o),u=jh(r,t,o),s=jh(r,e,o),l=Kh(r,o);if(s<=0||l<=0||i<=0||u<=0)return Bt.num;var c=1+i/l*a;return 0===c?Bt.num:(100+u/l*n*100)/c-s/l*n*100}(e,t,r,n,a,o);return Pt(i)||rt._funcNode.setFormatType('""#,##0.00_);[Red]\\(""#,##0.00\\)'),i}function Nm(e,t,r,n,a,o,i){var u=function(e,t,r,n,a,o,i){if(i=void 0===i?0:i,e=Xn(e),t=Xn(t),e instanceof Date&&e.setHours(0,0,0),t instanceof Date&&t.setHours(0,0,0),r=wn(r,rt._astNodes[2]),n=wn(n,rt._astNodes[3]),a=wn(a,rt._astNodes[4]),o=wn(o,rt._astNodes[5]),i=wn(i,rt._astNodes[6]),isNaN(r)||isNaN(n)||isNaN(a)||isNaN(o)||isNaN(i))return Bt.value;if(o=o>=0?Math.floor(o):Math.ceil(o),i=i>=0?Math.floor(i):math.ceil(i),r<0)return Bt.num;if(n<=0)return Bt.num;if(a<=0)return Bt.num;if(Zh(o,[1,2,4])<0)return Bt.num;if(Zh(i,[0,1,2,3,4])<0)return Bt.num;if(Xh(e,t)>=0)return Bt.num;if(Ph(e,t,o)<=1){var u=Uh(e,t,o,i),s=Lh(e,t,o,i),l=Bh(e,t,o,i);return(a/100+r/o-(n/100+u/l*r/o))/(n/100+u/l*r/o)*(o*l/s)}var c,f=.1,d={_xmin:0,_xmax:1e3,_precision:1e-10,_havexpos:!1,_xpos:0,_ypos:0,_havexneg:!1,_xneg:0,_yneg:0,_root:0},h=function(e,t,r,n,a,o,i,u,s,l,c,f,d){var h,m,g,p=r._precision/2;for(h=0;h<20;h++){if(n<r._xmin||n>r._xmax)return[!1,r];var v=t(a,o,i,n,s,l,c,f,d)-u;if(hh(v)){if(g=v[1],!(m=v[0]))return[m,r]}else g=v;var y=Ch(n,g,r);if(r=y[1],y[0])return[!0,r];var N=r._havexneg&&r._havexpos?Math.abs(r._xpos-r._xneg):r._xmax-r._xmin,M=0;if(r=(y=Ih(0,t,n,M,(Math.abs(n)<1e-10?N:Math.abs(n))/1e6,r,a,o,i,u,s,l,c,f,d))[2],M=y[1]<0?y[1]:-y[1],!(m=y[0]))return[m,r];if(0===M)return[!1,r];var R=n-1.000001*g/M;if(R===n)return r._root=n,[!0,r];var _=Math.abs(R-n)/(Math.abs(n)+Math.abs(R));if(n=R,_<p)return r._root=n,[!0,r]}return[!1,r]}(0,$h,d,f,e,t,r,n,a,o,i);if(d=h[1],!(c=h[0])){for(f=1e-10;f<d._xmax;f*=2)d=Oh(!1,$h,d,f,e,t,r,n,a,o,i)[1];d=(h=wh(!1,!1,d,e,t,r,n,a,o,i))[1],c=h[0]}return c?d._root:Bt.num}(e,t,r,n,a,o,i);return Pt(u)||rt._funcNode.setFormatType("0.00%"),u}function Mm(e,t,r,n,a,o){var i=function(e,t,r,n,a,o){if(o=void 0===o?0:o,e=Xn(e),t=Xn(t),r=Xn(r),e instanceof Date&&e.setHours(0,0,0),t instanceof Date&&t.setHours(0,0,0),r instanceof Date&&r.setHours(0,0,0),n=wn(n,rt._astNodes[3]),a=wn(a,rt._astNodes[4]),o=wn(o,rt._astNodes[5]),isNaN(n)||isNaN(a)||isNaN(o))return Bt.value;if(o=o>=0?Math.floor(o):math.ceil(o),n<0)return Bt.num;if(a<=0)return Bt.num;if(Zh(o,[0,1,2,3,4])<0)return Bt.num;if(Xh(e,t)>=0)return Bt.num;if(Xh(r,e)>=0)return Bt.num;if(Xh(r,t)>=0)return Bt.num;var i=1+zh(r,t,o)*n;return i/=a/100+zh(r,e,o)*n,--i/zh(e,t,o)}(e,t,r,n,a,o);return Pt(i)||rt._funcNode.setFormatType("0.00%"),i}function Rm(e,t,r,n,a){var o=function(e,t,r,n,a){return a=void 0===a?0:a,e=Xn(e),t=Xn(t),e instanceof Date&&e.setHours(0,0,0),t instanceof Date&&t.setHours(0,0,0),r=wn(r,rt._astNodes[2]),n=wn(n,rt._astNodes[3]),a=wn(a,rt._astNodes[4]),isNaN(r)||isNaN(n)||isNaN(a)?Bt.value:(a=a>=0?Math.floor(a):math.ceil(a),r<=0||n<=0||Zh(a,[0,1,2,3,4])<0||Xh(e,t)>=0?Bt.num:(n/r-1)/zh(e,t,a))}(e,t,r,n,a);return Pt(o)||rt._funcNode.setFormatType("0.00%"),o}function _m(e,t,r,n,a){var o=function(e,t,r,n,a){if(a=void 0===a?12:a,e=wn(e,rt._astNodes[0]),t=wn(t,rt._astNodes[1]),r=wn(r,rt._astNodes[2]),n=wn(n,rt._astNodes[3]),a=wn(a,rt._astNodes[4]),isNaN(e)||isNaN(t)||isNaN(r)||isNaN(n)||isNaN(a))return Bt.value;if(e<0||t<0)return Bt.num;if(r<=0||n<=0)return Bt.num;if(Zh(a,[1,2,3,4,5,6,7,8,9,10,11,12])<0)return Bt.num;if(r+(a<12?1:0)<n)return Bt.num;if(0===e)return 0;for(var o=ga._round(1-Math.pow(t/e,1/r),3),i=0,u=0,s=1;s<=n;s++)i+=u=1===s?e*o*a/12:s===r+1?(e-i)*o*(12-a)/12:(e-i)*o;return u}(e,t,r,n,a);return Pt(o),o}var Em=Jn.Z._isNullOrUndefined,Tm=ea.Z._getLength;function Sm(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];t=hn(t);for(var n=!0,a=0;a<t.length;a++)t[a]||(n=!1),""!==t[a]&&"string"!=typeof t[a]||(n=Bt.value);return n}function Cm(){return!1}function Im(e,t,r){return ht(e)&&(e=e.toArray()[0]),Rn(e)?e:e?t:void 0!==r&&r}function Am(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];t=hn(t);for(var n=!1,a=0;a<t.length;a++)if(null===t[a]&&(n=Bt.value),t[a]){n=!0;break}return n}function wm(){return!0}function xm(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var n=t[0];if(ht(n)&&(n=Kn(n)[0]),Eo(n))return n;var a=Hn(n);return a<1||Tm(t)<=a?Bt.value:Em(t[a])?0:t[a]}function Dm(e){if(Cn(e,rt._astNodes[0]))return Bt.value;if("string"==typeof e)switch(e.toLowerCase()){case"true":e=!0;break;case"false":case"":e=!1;break;default:return Bt.value}var t={};return $n(e,t),!t.value}function bm(){for(var e=[],t=0,r=arguments.length;t<r;t++){var n=t<0||arguments.length<=t?void 0:arguments[t];if(Array.isArray(n))n=(n=hn(n)).filter((function(e){return"number"==typeof e||"boolean"==typeof e})),e=e.concat(n);else{if("number"!=typeof n&&"boolean"!=typeof n)return Bt.value;e.push(n)}}var a,o=0;for(a=0;a<Tm(e);a++)e[a]&&o++;return!!(o%2)}function Om(e,t){var r=t._element.row,n=t._element.col;return rt._instance.custom.getValueByTopCellPosition(e,r,n)}var Fm=((e={})[Ot.u7.BOOL]=function(e,t){return ht(e)&&!e.isCell&&(e=Om(e,t)),e},e[Ot.u7.STRING]=function(e,t){return ht(e)&&!e.isCell&&(e=Om(e,t)),e},e[Ot.u7.NUMBER]=function(e,t){return ht(e)&&!e.isCell&&(e=Om(e,t)),e},e[Ot.u7.DATE]=function(e,t){return ht(e)&&!e.isCell&&(e=Om(e,t)),e},e[Ot.u7.ARRAY]=function(e){return e},e[Ot.u7.NOT_ARRAY]=function(e,t){return ht(e)&&!e.isCell&&(e=Om(e,t)),e},e[Ot.u7.ANY]=function(e){return e},e);function Um(e,t,r){if(!Ot.BT[e])for(var n=t._funcNode.calculateParentFunctionNode,a=0;a<r.length;a++){var o=r[a];if(!ht(o))if(n&&Ot.A1[n.funcName]){if(Pt(n.expandValue))throw new Error(node.expandValue)}else if(Pt(o))throw new Error(o)}}function Lm(e,t,r,n,a,o){if(o===Ot.u7.ARRAY)return!1;if(o===Ot.u7.ANY&&!Ot.v_[e])return!1;var i=!1,u=r[n],s=Nt(t)||!Et(t)&&Array.isArray(u);if(i=s,!s&&ht(u)&&!u.isCell){var l=rt._instance,c=l.helper.getRangeValue;a=a&&a.calculateParentFunctionNode;for(var f=1e3;a&&f-- >0;){var d=a&&a.funcName;if(Ot.A1[d]){for(var h=[],m=Ot.v_[e],g=0;g<u.identities.length;g++){var p=u.getIdentities(g),v=p.rowCount,y=p.colCount;if("ROW"===e&&(y=1),"COLUMN"===e&&(v=1),m){for(var N=l.helper.cellValueCalcFunc,M=0;M<v;M++){h[M]=h[M]||[];for(var R=0;R<y;R++){var _={row:M+p.row,col:R+p.col,rowCount:1,colCount:1,sheetId:p.sheetId,refType:w.NORMAL};h[M].push(new ft([_],!0,N))}}h=[h]}else{var E=c({newLine:p.colCount},p);h.push(E)}}r[n]=h,i=!0;break}a=a&&a.calculateParentFunctionNode}}return i}function Bm(e,t){if(ht(e)&&(!t||!t.acceptRef)){var r=rt._instance.helper.getRangeValue,n=e.getIdentities(0),a=r({newLine:n.colCount},n);e=e.isCell?a[0]:[a]}return e}function km(e,t,r){var n=rt._instance.helper.getRangeValue,a=rt,o=Ot.tM[t],i=[],u=function(e,t,r,n){var a=r,o=0,i=0,u=!1;if(t){!function(e,t){var r,n,a,o,i,u,s=(r=t,a=(n=(n={min:e.min,max:e.max})||{}).min,o=n.max,i=r.length,u="",void 0!==a&&i<a&&(u=Bt.paramsLack),void 0!==o&&i>o&&(u=Bt.paramsOver),u);if(s)throw new Error(s)}(t,r);var s=t.argumentsType;if(Array.isArray(s)){a=[];for(var l=0;l<r.length;l++){var c=s[l]||Ot.u7.ANY;if(Lm(e,n._astNodes[l],r,l,n._funcNode,c)){var f=r[l][0];if(i=i>f[0].length?i:f[0].length,o=o>f.length?o:f.length,"ROW"===e&&(i=1),"COLUMN"===e&&(o=1),Ot.JJ[e]){a.push(r[l][0][0][0]);continue}u=!0,f.isUserRange=!0,a.push(f)}else{var d=r[l],h=Fm[c];"function"==typeof h&&(d=h(d,n)),Ot.xU[e]||(d=Sn(d)),null!==(d=Bm(d,t))||Ot.yc[e]||(d=""),a.push(d)}}}}return{newArgs:a,canExpand:u,rowCount:o,colCount:i}}(t,o,r,a),s=u.newArgs,l=u.canExpand,c=u.rowCount,f=u.colCount;if(l){var d;!function(e,t,r){for(var n=0;n<e.length;n++){var a="",o=e[n],i=1===o.length,u=o[0]&&1===o[0].length&&o.length>1;o.isUserRange||(a=o,e[n]=[[o]],o=e[n]);for(var s=0;s<t;s++){void 0===o[s]&&(o[s]=[]);for(var l=0;l<r;l++)if(void 0===o[s][l]){var c=void 0;void 0===(c=i?o[0][l]:u?o[s][0]:o[s][l])&&(c=a),e[n][s][l]=c}}}}(s,c,f);for(var h=!1,m=0;m<s[0].length;m++)for(var g=0;g<s[0][m].length;g++){for(var p=void 0,v=[],y=0;y<s.length;y++)v.push(s[y][m][g]);void 0===i[m]&&(i[m]=[]),Um(t,a,v);try{p=e.apply(void 0,v)}catch(e){p=e&&e.message||Bt.error}!d&&Pt(p)&&(d=p),h||!Array.isArray(p)&&!ht(p)||(h=!0),i[m][g]=p}if(h){for(var N=[],M=0;M<i.length;M++)for(var R=0;R<i[M].length;R++){var _=i[M][R];if(Array.isArray(_))N.push(_[0]);else if(ht(_)){var E=_.getIdentities(0);N.push([n({newLine:E.colCount},E)])}else N.push([[_]])}i=N}else i=[i];i.errorValue=d}else{for(var T=0;T<s.length;T++){var S=s[T];Ot.xU[t]||(S=Sn(S)),S=Bm(S,o),Ot.yc[t]||null!==S||(S=""),s[T]=S}Um(t,a,s),i=e.apply(void 0,s)}return i}var Pm={};[f,m,R,_,h,E,N,v,y,M].forEach((function(e){Object.keys(e).forEach((function(t){if("object"==typeof e[t]){var r=e[t];Object.keys(r).forEach((function(e){var n=t+"."+e;Pm[n]||(Pm[n]=km.bind(void 0,r[e],n))}))}else Pm[t]||(Pm[t]=km.bind(void 0,e[t],t))}))}));var Gm={RANK:Pm["RANK.EQ"],NETWORKDAYS:Pm["NETWORKDAYS.ORIGIN"],CONFIDENCE:Pm["CONFIDENCE.NORM"],POISSON:Pm["POISSON.DIST"],QUARTILE:Pm["QUARTILE.INC"],STDEV:Pm["STDEV.S"],VAR:Pm["VAR.S"],WORKDAY:Pm["WORKDAY.ORIGIN"],SKEW:Pm["SKEW.ORIGIN"],CEILING:Pm["CEILING.ORIGIN"],FLOOR:Pm["FLOOR.ORIGIN"],MODE:Pm["MODE.SNGL"],PERCENTRANK:Pm["PERCENTRANK.INC"],ERF:Pm["ERF.ORIGIN"],ERFC:Pm["ERFC.PRECISE"]};Object.assign(Pm,Gm);var Hm=Pm,Ym=Object.assign({},u),jm=function(){function e(e){var t=this;this.formulas=Hm,this.bindExternalMethod=function(e){t.custom=e},this.getExternalMethod=function(){return t.custom},this.calculate=function(e,r){t.element=r,function(e){for(var t,r=arguments.length,n=new Array(r>1?r-1:0),a=1;a<r;a++)n[a-1]=arguments[a];Ut()&&(t=console).log.apply(t,[e].concat(n))}("|| === ");var n=Ym.calculateAstNode(e.body);return e.setValue(n),n},this.NODE_TYPE=e,this.helper=Ym}return(0,o.Z)(e,null,[{key:"instance",get:function(){return e.INSTANCE||(e.INSTANCE=new e({AST_TYPE:C,CROSS_TABLE_TYPE:I,CELL_RANGE_TYPE:w,VARIABLE_TYPE:A,RANGE_BINARY_TYPE:x})),e.INSTANCE}}]),e}(),Vm=jm,$m=function(e){return e.sheetId+"_"+e.row+"_"+e.col},Zm=function(e,t){if(e.sheetId!==t.getAffectedSheetId())return e;var r=e.row,n=e.col;if(Ye(t)){var a=t.index,o=t.amount,i=t.type;(i===H.ROWS?r>=a:n>=a)&&(r+=i===H.ROWS?o:0,n+=i===H.COLUMNS?o:0)}else if(je(t)){var u=t.index,s=t.amount,l=t.type;if(l===H.ROWS?r===u:n===u)return null;(l===H.ROWS?r>u:n>u)&&(r+=l===H.ROWS?-s:0,n+=l===H.COLUMNS?-s:0)}else if(Ve(t)){var c=t.row,f=t.column;if(-1!==c.to){var d=c.from,h=d.startIndex,m=d.endIndex,g=c.to-c.from.startIndex;r>=h&&r<=m&&(r+=g)}if(-1!==f.to){var p=f.from,v=p.startIndex,y=p.endIndex,N=f.to-f.from.startIndex;n>=v&&r<=y&&(n+=N)}}return{sheetId:e.sheetId,row:r,col:n}},Wm=function(){function e(){this.isCalculating=!1,this.asyncCalculateTaskMap=new Map}var t=e.prototype;return t.setTask=function(e,t){this.asyncCalculateTaskMap.set($m(e),t)},t.getTask=function(e){return this.asyncCalculateTaskMap.get($m(e))},t.stopTask=function(e){var t=this.asyncCalculateTaskMap.get($m(e));t&&t.resolve(!0)},t.dealWithAsyncTask=function(e,t){var r=function(e){return e},n=null==e?void 0:e.resolve,a=new Promise((function(e){r=function(t){return e(t),null==n||n(!0),!0}}));return e&&(e.resolve=function(e){return e}),{resolve:r,promise:a,dependencyTasks:t}},t.handleUserChange=function(e){if(!this.isCalculating)return null;if(!function(e){return e.id===j.INSERT_DIMENSION_MUTATION||e.id===j.DELETE_DIMENSION_MUTATION||e.id===j.MAP_RANGE_MUTATION}(e))return null;var t=[];return this.asyncCalculateTaskMap.forEach((function(r,n){var a=function(e){var t=e.split("_"),r=t[0],n=t[1],a=t[2],o=Number(n),i=Number(a);return!r||Number.isNaN(o)||Number.isNaN(i)?null:{sheetId:r,row:o,col:i}}(n);if(a){var o=Zm(a,e);o&&t.push(o)}})),t},t.startCalculateAsyncFunction=function(){this.isCalculating=!0},t.finishCalculateAsyncFunction=function(){this.isCalculating=!1,this.stopAllTask(),this.asyncCalculateTaskMap.clear()},t.getTaskMap=function(){return this.asyncCalculateTaskMap},t.stopAllTask=function(){this.asyncCalculateTaskMap.forEach((function(e){e.resolve(!0)}))},e}(),Xm=function(){function e(e){var t=this;this.cellMap=bt,this.asyncTaskManager=new Wm,this.customFunctionRegistry={},this.extraCalcResultCache=null,this.getResultBySingleFormula=function(e,r){var n=function(e){return{row:-1,col:-1,sheetId:e}}(r),a={row:n.row,col:n.col,rowCount:t.externalMethods.countRows(r),colCount:t.externalMethods.countCols(r),id:Zt(n.row,n.col),sheetId:r},o=t.getAstByCellInfo({cellInfo:a,formula:e}),i=t.calculateAndRunPostProcessing({ast:o,formula:e,cellInfo:a},n),u=(0,yr.zH)(i.result);return{ast:o,result:i.result,isError:u}},this.setExtraCalcResult=function(e){var r=t.extraCalcResultCache;r?Object.assign(r,e):t.extraCalcResultCache=e},this.getValueByTopCellPosition=function(e,r,n){if(ht(e)){var a,o;e.identities.length;var i=(o=e.identities[0]).sheetId;if(1===o.colCount&&1===o.rowCount)a=t.calculateService.helper.getCellValueByData(o.row,o.col,i);else if(1===o.colCount){if(r>o.row+o.rowCount-1||r<o.row)return Bt.value;var u=o.col,s=r;a=t.calculateService.helper.getCellValueByData(s,u,i)}else if(1===o.rowCount){if(n>o.col+o.colCount-1||n<o.col)return Bt.value;var l=o.row,c=n;a=t.externalMethods.getCellValue(l,c,i)}return void 0!==a?a:Bt.value}},this.externalMethods=e,this.formulaParser=new vr({getSheetIdsAmongTwoSheets:e.getSheetIdsAmongTwoSheets,getSheetNames:e.getSheetNames,getSheetNameBySheetId:e.getSheetNameBySheetId,getSheetIdBySheetName:e.getSheetIdBySheetName}),this.calculateService=Vm.instance,this.calculateService.bindExternalMethod({getCellHyperlink:e.getCellHyperlink,countCols:e.countCols,countRows:e.countRows,getSheetIdBySheetName:e.getSheetIdBySheetName,getSheetIdsAmongTwoSheets:e.getSheetIdsAmongTwoSheets,parse:this.formulaParser.parse.bind(this.formulaParser),addDependency:e.addDynamicDependency,cellValue:e.getCellValue,cellEditValue:e.getCellEditValue,getValueByTopCellPosition:this.getValueByTopCellPosition,isCellHidden:e.isCellHidden,setExtraCalcResult:this.setExtraCalcResult}),this.resetPerformanceInfo()}var t=e.prototype;return t.getPerformanceInfo=function(){return this.performanceInfo},t.resetPerformanceInfo=function(){this.performanceInfo={formulaCount:0,asyncFormulaCount:0,calculateFormulaDuration:0,formatDuration:0,parseDuration:0,calculateDuration:0,calculateCount:0}},t.destroy=function(){this.asyncTaskManager.finishCalculateAsyncFunction(),this.cellMap.destroy(),this.resetPerformanceInfo()},t.formulaBecomeConstant=function(e){var t=this;e.forEach((function(e){t.asyncTaskManager.stopTask(e)}))},t.handleUserChange=function(e){this.asyncTaskManager.handleUserChange(e),this.asyncTaskManager.finishCalculateAsyncFunction()},t.calculateTopSortNodes=function(e,t,r,n){var a=this,o=t.afterCalculateSingleNodeHook,i=t.afterCalculateAllSyncNodes,u=t.afterCalculateAllAsyncNodes,s=t.beforeEveryCalculation;void 0===n&&(n=D);var l=new Set;e.forEach((function(e){var t=e.range,r=e.id,i=e.isInCycle,u=t.sheetId;ne(t,(function(e,t){var c={row:e,col:t,sheetId:u,id:r,isInCycle:i},f=Date.now(),d=a.getFormulaModelAndAST(c,n);if(d)if(s(c,{customType:n}))o({result:{result:{displayText:"#FUNC!",type:xt.ERROR}},formulaInfo:d,sortedNode:c,customType:n});else{a.performanceInfo.formulaCount+=1;var h=a.analyseAsyncNode({ast:d.ast,node:c,customType:n}),m=h.isAsyncNode,g=h.asyncTask;if(m)l.add({sortedNode:c,task:g});else{var p=a.calculateAndRunPostProcessing(d,c),v=Date.now()-f;a.performanceInfo.formulaCount+=1,a.performanceInfo.calculateDuration+=v,a.clearExtraCalcResult(),a.afterCalculateResult({result:p,formulaInfo:d,formulaModel:d.formulaModel,sortedNode:c,customType:n,afterCalculateSingleNodeHook:o})}}}),{rowCount:a.externalMethods.countRows(u),colCount:a.externalMethods.countCols(u)})})),l.size>0&&(this.calculateTopSortNodesAsync(l,n,{afterCalculateSingleNodeHook:o,afterCalculateAllAsyncNodes:u}),this.performanceInfo.asyncFormulaCount+=l.size),i({customType:n}),rt.clearCache()},t.registerCustomFormula=function(e,t,r){if(!this.hasCustomFormulaRegistered(e)){var n=function(e){return t.apply(this,e)};this.customFunctionRegistry[e]=n,Vm.instance.formulas[e]=n,Ot.tM[e]=r,Ot.fR[e]=r}},t.hasCustomFormulaRegistered=function(e){return void 0!==this.customFunctionRegistry[e]},t.analyseAsyncNode=function(e){var t,r,n=this,a=e.ast,o=e.node,i=e.customType,u=this.asyncTaskManager.getTask(o),s=gt(a)&&(null===(t=a.getAsyncFunctionNodeList())||void 0===t?void 0:t.length)>0,l=[];(u||s)&&(l=this.getNodeDependencyTasks(o,i));var c=l.length>0,f=s||c;if(f){r=this.asyncTaskManager.dealWithAsyncTask(u,l),this.asyncTaskManager.setTask(o,r);var d=o.sheetId,h=o.row,m=o.col,g=new B(d,h,h,m,m);this.externalMethods.getReferencedCellNode(g,i,(function(e){var t=e.offsetRefRange,a=t.sheetId;ne(t,(function(e,t){n.asyncTaskManager.setTask({sheetId:a,row:e,col:t},{resolve:function(e){return e},promise:Promise.resolve(!1),dependencyTasks:[r.promise]})}))}))}else u&&u.resolve(!0);return{isAsyncNode:f,asyncTask:r}},t.calculateTopSortNodesAsync=function(e,t,r){var n=r.afterCalculateSingleNodeHook,a=r.afterCalculateAllAsyncNodes;return nt(this,void 0,void 0,regeneratorRuntime.mark((function r(){var o,i,u,s,l,f,d,h=this;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:for(this.asyncTaskManager.startCalculateAsyncFunction(),o=[],i=c(e);!(u=i()).done;)s=u.value,l=s.sortedNode,f=s.task,d=this.runAsyncCalculate({sortedNode:l,task:f,afterCalculateSingleNodeHook:n,customType:t}),o.push(d);return r.abrupt("return",Promise.all(o).then((function(){h.asyncTaskManager.finishCalculateAsyncFunction(),a({customType:t})})));case 4:case"end":return r.stop()}}),r,this)})))},t.runAsyncCalculate=function(e){var t=e.sortedNode,r=e.task,n=e.customType,a=e.afterCalculateSingleNodeHook;return nt(this,void 0,void 0,regeneratorRuntime.mark((function e(){var o=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e){return nt(o,void 0,void 0,regeneratorRuntime.mark((function o(){var i,u,s;return regeneratorRuntime.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,Promise.all(r.dependencyTasks);case 2:if((i=this.getFormulaModelAndAST(t,n))&&gt(i.ast)){o.next=5;break}return o.abrupt("return",(this.asyncTaskManager.getTaskMap().delete($m(t)),void e()));case 5:return o.next=7,this.calculateAsyncNodes(i.ast);case 7:return u=!1,r.resolve(u),o.next=11,r.promise.then((function(e){u=e}));case 11:if(!u){o.next=13;break}return o.abrupt("return",(this.asyncTaskManager.getTaskMap().delete($m(t)),void e()));case 13:s=this.calculateAndRunPostProcessing(i,t),this.afterCalculateResult({result:s,formulaInfo:i,formulaModel:i.formulaModel,sortedNode:t,customType:n,afterCalculateSingleNodeHook:a}),this.asyncTaskManager.getTaskMap().delete($m(t)),e();case 15:case"end":return o.stop()}}),o,this)})))})));case 1:case"end":return e.stop()}}),e)})))},t.calculateAsyncNodes=function(e){return nt(this,void 0,void 0,regeneratorRuntime.mark((function t(){var r,n,a,o;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(0===(r=e.getAsyncFunctionNodeList()).length){t.next=9;break}n=c(r);case 3:if((a=n()).done){t.next=9;break}return o=a.value,t.next=7,this.calculateService.helper.asyncCalculate(o);case 7:t.next=3;break;case 9:case"end":return t.stop()}}),t,this)})))},t.getNodeDependencyTasks=function(e,t){var r=this,n=[],a=e.sheetId,o=e.row,i=e.col,u=new B(a,o,o,i,i);return this.externalMethods.getDependencyCellNode(u,t,(function(e){var t=e.offsetRefRange,a=t.sheetId;ne(t,(function(e,t){var o=r.asyncTaskManager.getTask({sheetId:a,row:e,col:t});o&&n.push(o.promise)}))})),n},t.getFormulaModelAndAST=function(e,t){var r=this.externalMethods.getFormulaDataByRowCol(e,{customType:t,id:e.id});if(!r)return null;var n=r.cellInfo,a=r.formulaModel,o=r.formulaString;return{ast:this.getAstByCellInfo({cellInfo:n,formula:o}),formula:o,formulaModel:a,cellInfo:n}},t.calculateAndRunPostProcessing=function(e,t){var r,n=e.ast,a=e.formula,o=e.cellInfo;r=t.isInCycle?{result:"#CIRCLE!",error:"#CIRCLE!"}:this.calculateCell({ast:n,formula:a,cellInfo:o});var i=Date.now(),u=this.dealWithResultAfterCalculate(n,r);this.performanceInfo.formatDuration+=Date.now()-i;var s=u.result;if(u.error){var l=u.error;s={displayText:l,type:Wt[l]||xt.ERROR}}return Object.assign(Object.assign({},this.getExtraCalcResult()),{result:s})},t.afterCalculateResult=function(e){var t=e.result,r=e.formulaInfo,n=e.sortedNode,a=e.customType,o=e.afterCalculateSingleNodeHook;this.analyseCalculateNode(r,n),o({result:t,formulaInfo:r,sortedNode:n,customType:a})},t.getAstByCellInfo=function(e){var t,r=e.cellInfo,n=e.formula;n=(t=n)?t.length>=1&&"="===t[0]?t.substr(1,t.length):t:"";var a=Date.now(),o=this.formulaParser.parse(n,r),i=Date.now()-a;return this.performanceInfo.parseDuration+=i,o},t.calculateCell=function(e){var t,r=e.ast,n=e.formula,a=e.cellInfo;if(function(e){return!(gt(e)&&e.body)}(r))return"#ERROR!"===r.error&&n.indexOf("#REF!")>-1&&(r.error="#REF!"),{result:""===n?"=":r.error,error:r.error};try{var o=Date.now();t=this.calculateService.calculate(r,a);var i=Date.now()-o;this.performanceInfo.calculateFormulaDuration+=i}catch(r){console.error("",r),t="object"==typeof r?r.message:Bt.error}return this.performanceInfo.calculateCount+=1,{result:Vt(t,15)}},t.dealWithResultAfterCalculate=function(e,t){if(!gt(e))return t;if(Tt(e.body)&&(0,yr.de)(e.body))return t;var r=function(e,t,r){var n,a=t.error;if(Array.isArray(t.result))try{n=t.result[0][0][0]}catch(e){n=Bt.value}else if(ht(t.result)&&gt(e)){try{var o=t.result;n=t.result.isCell?o.toArray()[0]:r(o,e.row,e.col)}catch(e){n="object"==typeof e?e.message:Bt.error}null===n&&(n=0)}else n=t.result;return{result:n,error:a}}(e,t,this.getValueByTopCellPosition.bind(this)),n=r.result;return Pt(n)&&(r.error=n),function(e){return e===Bt.circle}(r.result)&&(r.result=Bt.ref,r.error=Bt.ref),r},t.getExtraCalcResult=function(){return this.extraCalcResultCache},t.clearExtraCalcResult=function(){this.extraCalcResultCache=null},t.analyseCalculateNode=function(e,t){var r,n,a,o,i=e.formula,u=e.formulaModel,s=t.sheetId,l=t.row,c=t.col;/\bRAND\b\(|\bNOW\b\(|\bRANDBETWEEN\b\(/g.test(i)?null===(n=(r=this.externalMethods).addAlwaysNeedCalculateNodeHook)||void 0===n||n.call(r,{sheetId:s,row:l,col:c,formulaModel:u,nodeInfo:void 0}):/STOCK\(\s*"(\w+(\.\w+)*)\.([A-Z]+)"\s*,\s*8\s*\)/i.test(i)&&(null===(o=(a=this.externalMethods).addTimingCalculateNodeHook)||void 0===o||o.call(a,{sheetId:s,row:l,col:c,formulaModel:u,nodeInfo:void 0}))},e}(),Km=function(){function e(){this.nodeMap={}}var t=e.prototype;return t.handleUserChange=function(e){var t=this,r=this.getAllNodes();this.nodeMap={},r.forEach((function(r){var n=Zm(r,e);null!==n&&t.addNode(Object.assign(Object.assign({},r),{row:n.row,col:n.col}))}))},t.addNode=function(e){var t;if(null!==e){var r=e.row,n=e.col,a=e.sheetId;void 0===this.nodeMap[a]&&(this.nodeMap[a]=[]),void 0===this.nodeMap[a][r]&&(this.nodeMap[a][r]=[]),(null===(t=this.nodeMap[a][r][n])||void 0===t?void 0:t.formulaModel)||(this.nodeMap[a][r][n]=e)}},t.removeNode=function(e){var t=e.row,r=e.col,n=e.sheetId;void 0!==this.nodeMap[n]&&void 0!==this.nodeMap[n][t]&&delete this.nodeMap[n][t][r]},t.addNodes=function(e){var t=this;e.forEach((function(e){t.addNode(e)}))},t.removeNodes=function(e){var t=this;e.forEach((function(e){t.removeNode(e)}))},t.clear=function(){this.nodeMap={}},t.getAllNodes=function(){var e=[];return Object.entries(this.nodeMap).forEach((function(t){t[1].forEach((function(t){t.forEach((function(t){e.push(t)}))}))})),e},e}(),zm=function(){function e(e){var t=this;this.afterCalculateSingleNode=function(e){if(t.needRecalculate)return!0;var r=e.result,n=e.formulaInfo,a=e.sortedNode,o=e.customType;if(o===D)return t.externalMethods.afterCalculateCellNode({result:r,formulaInfo:n,sortedNode:a,customType:o});gt(n.ast)&&t.externalMethods.afterCalculateCustomNode({result:r.result,formulaInfo:n,sortedNode:a,customType:o})},this.afterCalculateAllNodes=function(e){if(t.needRecalculate)return!0;t.externalMethods.afterCalculateAllNodes(e)},this.calculateCenter=new Xm(Object.assign(Object.assign({},e),{addDynamicDependency:this.hijackAddDependency.bind(this)})),this.externalMethods=e}var t=e.prototype;return t.destroy=function(){this.calculateCenter.destroy()},t.calculateSingleFormula=function(e,t){return this.calculateCenter.getResultBySingleFormula(e,t)},t.handleUserChange=function(e){this.calculateCenter.handleUserChange(e)},t.removeNodes=function(e){this.calculateCenter.formulaBecomeConstant(e)},t.calculateTopSortResult=function(e){for(var t=0,r=Object.entries(e);t<r.length;t++){var n=r[t],a=n[0],o=n[1];o&&0!==o.length?this.calculateTopSortNodes(o,{customType:a}):this.afterCalculateAllNodes({customType:a})}},t.calculateTopSortNodes=function(e,t){var r,n;this.currentCustomType=t.customType,this.externalMethods.beforeBatchCalculate();var a={afterCalculateSingleNodeHook:this.afterCalculateSingleNode,afterCalculateAllSyncNodes:this.afterCalculateAllNodes,afterCalculateAllAsyncNodes:this.afterCalculateAllNodes,beforeEveryCalculation:this.externalMethods.beforeCalculateSingleNode};if(this.needRecalculate=!1,this.calculateCenter.calculateTopSortNodes(e,a,0,t.customType),this.needRecalculate){this.needRecalculate=!1,console.warn(""),null===(n=(r=this.externalMethods).afterNodesChangedHook)||void 0===n||n.call(r);var o=function(e){var t=[];return e.forEach((function(e){var r=e.range,n=r.sheetId;ne(r,(function(e,r){var a=L;null!==a&&t.push({row:e,col:r,sheetId:n,formulaModel:a,nodeInfo:void 0})}))})),t}(e),i=this.externalMethods.getRecalculateTopSortNodesByChangedNodes(o)[t.customType];if(!i)return;this.calculateCenter.calculateTopSortNodes(i,a,0,t.customType)}},t.hijackAddDependency=function(e,t){var r=this.externalMethods.addDynamicDependency({inDegreeNode:e,outDegreeNode:t,customType:this.currentCustomType});return r&&(this.needRecalculate=!0),r},e}(),qm=function(){function e(e){var t=this;this.calculateTimingFormulas=function(){var e=t.timingRecalculateNodeContainer.getAllNodes();e.length>0&&t.calculateSomeNodesImmediately(e)},this.afterCalculateAllNodes=function(e){var r=e.customType;t.formulaGraph.getCustomNodePluginManager().notifyPluginAfterAllNodesCalculated(r),t.externalMethods.afterCalculateAllNodes({customType:r})},this.externalMethods=e,this.formulaGraph=new Je({getFormulaModelByRowCol:e.getFormulaModelByRowCol,getSheetIdBySheetIndex:e.getSheetIdBySheetIndex,getSheetIdsAmongTwoSheets:e.getSheetIdsAmongTwoSheets,isNodeNeedCalculateHook:e.isNodeNeedCalculateHook}),this.calculateLogicService=new zm({getCellHyperlink:e.getCellHyperlink,isCellHidden:e.isCellHidden,getCellEditValue:e.getCellEditValue,getCellValue:e.getCellValue,countRows:e.countRows,countCols:e.countCols,getSheetIdBySheetName:e.getSheetIdBySheetName,getSheetIdsAmongTwoSheets:e.getSheetIdsAmongTwoSheets,getSheetNames:e.getSheetNames,getSheetNameBySheetId:e.getSheetNameBySheetId,getFormulaModelByRowCol:e.getFormulaModelByRowCol,getFormulaDataByRowCol:e.getFormulaDataByRowCol,addDynamicDependency:this.formulaGraph.addDynamicDependency.bind(this.formulaGraph),getDependencyCellNode:this.formulaGraph.getDepRangeByRefRange.bind(this.formulaGraph),getReferencedCellNode:this.formulaGraph.getRefRangeByDepRange.bind(this.formulaGraph),getRecalculateTopSortNodesByChangedNodes:this.formulaGraph.getRecalculateTopSortNodesByChangedNodes.bind(this.formulaGraph),addAlwaysNeedCalculateNodeHook:this.addAlwaysCalculateNode.bind(this),addTimingCalculateNodeHook:this.addTimingCalculateNode.bind(this),beforeBatchCalculate:e.beforeBatchCalculate,beforeCalculateSingleNode:e.beforeCalculateSingleNode,afterCalculateAllNodes:this.afterCalculateAllNodes.bind(this),afterNodesChangedHook:this.externalMethods.afterNodesChangedHook,afterCalculateCellNode:e.afterCalculateSingleNode,afterCalculateCustomNode:function(e){t.formulaGraph.getCustomNodePluginManager().notifyPluginAfterSingleNodeCalculated(e)}}),this.batchCalculateNodeContainer=new Km,this.alwaysNeedRecalculateNodeContainer=new Km,this.timingRecalculateNodeContainer=new Km,this.timingRecalculateTimer=setInterval(this.calculateTimingFormulas,6e4)}var t=e.prototype;return t.destroy=function(){clearInterval(this.timingRecalculateTimer),this.timingRecalculateNodeContainer.clear(),this.alwaysNeedRecalculateNodeContainer.clear(),this.batchCalculateNodeContainer.clear(),this.formulaGraph.destroy(),this.calculateLogicService.destroy()},t.getGraphService=function(e){return this.formulaGraph.getGraphService(e)},t.commitChangingMutation=function(e){var t,r;if(void 0!==e){this.batchCalculateNodeContainer.handleUserChange(e),this.timingRecalculateNodeContainer.handleUserChange(e),this.alwaysNeedRecalculateNodeContainer.handleUserChange(e);var n=this.formulaGraph.commitMutation(e),a=n.needRecalculateNodes,o=n.isGraphChange;this.batchCalculateNodeContainer.addNodes(a),o&&(null===(r=(t=this.externalMethods).afterNodesChangedHook)||void 0===r||r.call(t)),(Ye(e)||je(e)||Ve(e))&&this.calculateLogicService.handleUserChange(e)}},t.commitChangingFormulaNodes=function(e,t){var r,n;void 0===t&&(t=!0),this.formulaGraph.addNodes(e),this.alwaysNeedRecalculateNodeContainer.removeNodes(e),this.timingRecalculateNodeContainer.removeNodes(e),this.calculateLogicService.removeNodes(e),!0===t&&this.batchCalculateNodeContainer.addNodes(e),null===(n=(r=this.externalMethods).afterNodesChangedHook)||void 0===n||n.call(r)},t.addCustomNodes=function(e,t,r){var n,a,o=this;void 0===r&&(r=!0);var i=this.formulaGraph.addCustomNodes(e,t);if(!0===r){var u=[];i.forEach((function(e){var t=e.gridRange,r=e.formulaModel,n=e.nodeInfo;ne(t,(function(e,t,a){u.push({row:e,col:t,sheetId:a,formulaModel:r,nodeInfo:n})}),{rowCount:o.externalMethods.countRows(t.sheetId),colCount:o.externalMethods.countCols(t.sheetId)})})),this.batchCalculateNodeContainer.addNodes(u)}null===(a=(n=this.externalMethods).afterNodesChangedHook)||void 0===a||a.call(n)},t.removeCustomNodes=function(e,t,r){var n,a,o=this;void 0===r&&(r=!0);var i=this.formulaGraph.removeCustomNodes(e,t);if(!0===r){var u=[];i.forEach((function(e){var t=e.gridRange;ne(t,(function(e,t,r){u.push({row:e,col:t,sheetId:r,nodeInfo:void 0})}),{rowCount:o.externalMethods.countRows(t.sheetId),colCount:o.externalMethods.countCols(t.sheetId)})})),this.batchCalculateNodeContainer.addNodes(u)}null===(a=(n=this.externalMethods).afterNodesChangedHook)||void 0===a||a.call(n)},t.calculateSomeSheetsImmediately=function(e,t){console.warn(""),this.batchCalculateNodeContainer.clear();var r=this.formulaGraph.getRecalculateTopSortNodesBySheetIdsAndNodes(e,t);this.calculateLogicService.calculateTopSortResult(r)},t.calculateSomeNodesImmediately=function(e){var t=[].concat((0,a.Z)(e),(0,a.Z)(this.alwaysNeedRecalculateNodeContainer.getAllNodes()));console.warn("");var r=this.formulaGraph.getRecalculateTopSortNodesByChangedNodes(t);this.calculateLogicService.calculateTopSortResult(r)},t.startCalculate=function(){this.calculateSomeNodesImmediately(this.batchCalculateNodeContainer.getAllNodes()),this.batchCalculateNodeContainer.clear()},t.getPerformanceInfo=function(){var e=this.calculateLogicService.calculateCenter.getPerformanceInfo(),t=this.formulaGraph.getPerformanceInfo();return Object.assign(Object.assign({},t),e)},t.resetPerformanceInfo=function(){this.calculateLogicService.calculateCenter.resetPerformanceInfo(),this.formulaGraph.resetPerformanceInfo()},t.addAlwaysCalculateNode=function(e){this.alwaysNeedRecalculateNodeContainer.addNode(e)},t.addTimingCalculateNode=function(e){this.timingRecalculateNodeContainer.addNode(e)},e}()}();var v=p.AD,y=p.Pz,N=p.QS,M=p.hP,R=p.zD,_=p.nx,E=p.VT,T=p.de,S=p.zH,C=p.D_,I=p.R8,A=p.Fz}}]),window.jsExecEndTimeStamp=Date.now(),window.cachedPerformanceEntries||(window.cachedPerformanceEntries=[]),window.cachedPerformanceEntries.push({name:"jsExec: js/initial_vendors_tencent_formula.8f9478748eab836e249c.js",entryType:"jsExec",startTime:window.jsExecStartTimeStamp,endTime:window.jsExecEndTimeStamp});
//# sourceMappingURL=initial_vendors_tencent_formula.8f9478748eab836e249c.js.map