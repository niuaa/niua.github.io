self.window=self,window.jsExecStartTimeStamp=Date.now(),(self.webpackChunk_tencent_alloy_builder=self.webpackChunk_tencent_alloy_builder||[]).push([["spread-sheet_src_external_rangeAuth_loader_RangeAuthManager_ts-spread-sheet_src_external_view-9a5060"],{"../spread-sheet/src/core/ui/index.ts":function(e,t,n){n.d(t,{Z:function(){return P}});var r={};n.r(r),n.d(r,{hideModal:function(){return d},showModal:function(){return l}});var o={};n.r(o),n.d(o,{Progress:function(){return S},default:function(){return b}});var s=n("../spread-sheet/src/core/ui/dialog/index.ts"),i=n("../spread-sheet/src/core/ui/alert/index.ts"),a=n("../spread-sheet/src/core/ui/lazyLoad.ts"),l=function(e,t,n){(0,a.Fd)().then((function(r){r.default.showModal(e,t,n)}))},d=function(e,t){(0,a.Fd)().then((function(n){n.default.hideModal(e,t)}))},c=n("../spread-sheet/src/core/ui/toast/index.ts"),u=n("../spread-sheet/src/core/ui/tooltip/index.ts"),g=n("../node_modules/@babel/runtime/helpers/esm/createClass.js"),p=(n("../node_modules/regenerator-runtime/runtime.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.promise.js"),n("../node_modules/core-js/modules/es.object.assign.js"),n("../node_modules/core-js/modules/es.array.includes.js"),n("../node_modules/core-js/modules/es.string.includes.js"),n("../node_modules/core-js/modules/es.array.map.js"),n("../node_modules/core-js/modules/es.array.fill.js"),n("../node_modules/core-js/modules/web.dom-collections.for-each.js"),n("../node_modules/core-js/modules/es.object.keys.js"),n("../node_modules/core-js/modules/es.array.iterator.js"),n("../node_modules/core-js/modules/web.dom-collections.iterator.js"),n("../spread-sheet/src/core/view/spreadsheet-view/utils.ts")),h=n("../packages/model/src/dimension/index.ts"),m=n("react"),f=n.n(m),v=n("react-dom"),w=n.n(v),I=function(e){var t=e.progress;if(t<=.05)return f().createElement("img",{style:{width:"16px",height:"16px"},src:"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHN0eWxlPSJtYXJnaW46YXV0byIgd2lkdGg9IjQwIiBoZWlnaHQ9IjQwIiB2aWV3Qm94PSIwIDAgMTAwIDEwMCIgcHJlc2VydmVBc3BlY3RSYXRpbz0ieE1pZFlNaWQiIGRpc3BsYXk9ImJsb2NrIj48Y2lyY2xlIGN4PSI1MCIgY3k9IjUwIiByPSIzMCIgc3Ryb2tlPSIjZGFlOWZmODAiIHN0cm9rZS13aWR0aD0iMTAiIGZpbGw9Im5vbmUiLz48Y2lyY2xlIGN4PSI1MCIgY3k9IjUwIiByPSIzMCIgc3Ryb2tlPSIjNDg5MmZlIiBzdHJva2Utd2lkdGg9IjEwIiBzdHJva2UtbGluZWNhcD0icm91bmQiIGZpbGw9Im5vbmUiIHRyYW5zZm9ybT0icm90YXRlKDcwOC45NTIgNTAgNTApIj48YW5pbWF0ZVRyYW5zZm9ybSBhdHRyaWJ1dGVOYW1lPSJ0cmFuc2Zvcm0iIHR5cGU9InJvdGF0ZSIgcmVwZWF0Q291bnQ9ImluZGVmaW5pdGUiIGR1cj0iMS4yNXMiIHZhbHVlcz0iMCA1MCA1MDsxODAgNTAgNTA7NzIwIDUwIDUwIiBrZXlUaW1lcz0iMDswLjU7MSIvPjxhbmltYXRlIGF0dHJpYnV0ZU5hbWU9InN0cm9rZS1kYXNoYXJyYXkiIHJlcGVhdENvdW50PSJpbmRlZmluaXRlIiBkdXI9IjEuMjVzIiB2YWx1ZXM9IjE4Ljg0OTU1NTkyMTUzODc2IDE2OS42NDYwMDMyOTM4NDg4Mjs3NS4zOTgyMjM2ODYxNTUwMyAxMTMuMDk3MzM1NTI5MjMyNTQ7MTguODQ5NTU1OTIxNTM4NzYgMTY5LjY0NjAwMzI5Mzg0ODgyIiBrZXlUaW1lcz0iMDswLjU7MSIvPjwvY2lyY2xlPjwvc3ZnPg=="});var n=6.28*55*t;return f().createElement("svg",{width:"14px",height:"14px",version:"1.1",viewBox:"0 0 120 120",preserveAspectRatio:"none"},f().createElement("circle",{cx:"140",cy:"60",r:"52",fill:"none",stroke:"#D4D5D9",strokeWidth:"14",strokeDasharray:"360,20000",transform:"rotate(-90,100,100)"}),f().createElement("circle",{cx:"140",cy:"60",r:"52",fill:"none",stroke:"#0082EF",strokeWidth:"14",strokeDasharray:n+",20000",transform:"rotate(-90,100,100)",strokeLinecap:"round"}))},x=function(e,t){void 0===e&&(e=0),w().render(f().createElement(I,{progress:e}),t)},y=function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function i(e){try{l(r.next(e))}catch(t){s(t)}}function a(e){try{l(r.throw(e))}catch(t){s(t)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,a)}l((r=r.apply(e,t||[])).next())}))},S=function(){function e(e){var t=this;this.translateX=0,this.translateY=0,this._eventDisposes=[],this.show=function(){return y(t,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.initPosition(),Object.assign(this.progressView.style,{position:"absolute",backgroundColor:"white",zIndex:1,display:"flex",alignItems:"center",overflow:"hidden",fontSize:"13px",pointerEvents:"none",borderWidth:"0px",boxShadow:"0 0 0 1px #E2E4E8",boxSizing:"border-box"}),this.visibile=!0,this.valid=!0,this.container.appendChild(this.progressView);case 5:case"end":return e.stop()}}),e,this)})))},this.updateProgress=function(e){x(e,t.iconSpan)},this.hide=function(){t.visibile=!1,t.container.contains(t.progressView)&&t.container.removeChild(t.progressView),t.handleEvent(!1)},this.cancelUpload=function(){t.valid=!1,t.hide()},this.getPositionInfo=function(){return{sheetId:t.sheetId,row:t.row,col:t.col}},this.setVisible=function(){t.visibile=!0,t.progressView.style.display="flex"},this.setHidden=function(){t.visibile=!1,t.progressView.style.display="none"},this.handleUpdateCells=function(e){var n=e.startRow,r=e.endRow,o=e.startCol,s=e.endCol;t.row>=n&&t.row<=r&&t.col>=o&&t.col<=s&&t.onRemove(t.id)},this.handleChange=function(e){return function(n){var r=n.sheetId,o=n.index,s=n.amount,i=n.type;if(r===t.sheetId){var a=i===h.DIMENSION_TYPE.ROWS?"row":"col";e&&new Array(s).fill(o).map((function(e,t){return e+t})).includes(t[a])?t.onRemove(t.id):(e&&o+s-1>t[a]&&(t[a]=Math.max(0,t[a]-s)),!e&&o+s-1<=t[a]&&(t[a]=t[a]+s),t.initPosition())}}},this.toggleVisible=function(e){if(e===t.sheetId)return t.setVisible();t.setHidden()},this.handleEvent=function(e){var n=t._eventDisposes;if(!e)return n.forEach((function(e){e.dispose()})),t._eventDisposes=[],void t.app.event.sheetsBar.remove("switchSheet",t.toggleVisible);var r=t.app.view.canvas,o=r.areaData,s=r.resize,i=r.scale,a=r.dataCallView;n.push(o.onUpdateOffset(t.updatePosition)),n.push(s.onResize(t.initPosition)),n.push(i.onScale(t.initPosition)),n.push(a.onSetRowHeight(t.initPosition)),n.push(a.onSetRowVisible(t.initPosition)),n.push(a.onSetColWidth(t.initPosition)),n.push(a.onSetColVisible(t.initPosition)),n.push(a.onMergeUnmerge(t.initPosition)),n.push(a.onUpdateChart(t.initPosition)),n.push(a.onUpdateFreeze(t.initPosition)),n.push(a.onUpdateCells(t.handleUpdateCells)),n.push(a.onDeleteRow(t.handleChange(!0))),n.push(a.onDeleteCol(t.handleChange(!0))),n.push(a.onInsertRow(t.handleChange(!1))),n.push(a.onInsertCol(t.handleChange(!1))),t.app.event.sheetsBar.listen("switchSheet",t.toggleVisible)},this.initDOM=function(){t.iconSpan=document.createElement("span"),t.iconSpan.style.margin="0 4px",t.iconSpan.style.width="14px",t.iconSpan.style.height="14px",t.progressView.appendChild(t.iconSpan),x(0,t.iconSpan),t.textSpan=document.createElement("span"),t.textSpan.style.color="#3677FD",t.textSpan.style.textDecoration="underline",t.textSpan.style.textDecorationColor="#3677FD",t.textSpan.style.whiteSpace="nowrap",t.textSpan.style.textOverflow="ellipsis",t.textSpan.style.overflow="hidden",t.progressView.appendChild(t.textSpan),t.textSpan.textContent=t.text},this.initPosition=function(){var e=t.app.view.canvas,n=e.tableView,r=e.areaData,o=e.headSize,s=e.rowcolAccessor,i=e.clientRect,a=n.getCellViewAtPosition(t.row,t.col),l=t.col,d=t.row,c=(0,p.E)(s,a,t.row),u=(0,p.o)(s,a,t.col),g=r.getDisplayViewTopByRow(d);(null===a||void 0===a?void 0:a.mergeData)&&(d+=a.mergeData.rowCount-1);var h=r.getDisplayViewBottomByRow(d),m=i.height-o.displayColHeadHeight;t.progressView.style.bottom=m-g+"px",t.progressView.style.top=h-c+"px";var f=r.getDisplayViewLeftByCol(l);t.progressView.style.left=f+"px",t.progressView.style.width=u-1+"px",t.progressView.style.height=c-1+"px",t.progressView.style.backgroundSize=Math.min(u,40)+"px "+Math.min(c,40)+"px",t.translateX=r.getDisplayViewLeftByCol(l),t.translateY=r.getDisplayViewTopByRow(d)},this.updatePosition=function(){var e=t.app.view.canvas,n=e.tableView,r=e.areaData,o=n.getCellViewAtPosition(t.row,t.col),s=t.col,i=t.row;(null===o||void 0===o?void 0:o.mergeData)&&(i+=o.mergeData.rowCount-1);var a=r.getDisplayViewLeftByCol(s),l=r.getDisplayViewTopByRow(i);t.progressView.style.transform="translate("+(a-t.translateX)+"px, "+(l-t.translateY)+"px)"},this.id=e.id,this.app=e.app,this.container=e.app.view.canvas.mainBoard.element,this.row=e.row,this.col=e.col,this.sheetId=e.sheetId,this.visibile=!1,this.progressView=document.createElement("div"),this.text=e.text,this.onRemove=e.onRemove,this.initDOM(),this.handleEvent(!0)}return e.prototype.getProgressView=function(){return this.progressView},(0,g.Z)(e,[{key:"isVisible",get:function(){return this.visibile}},{key:"isValid",get:function(){return this.valid}}]),e}(),_=function(){function e(){}return e.createInstance=function(t,n,r,o,s,i,a){if(null===n.view.getSelection())return null;var l=new S({id:t,app:n,row:r,col:o,sheetId:s,text:i,onRemove:a});return e.value[t]=l},e.getInstance=function(t){return e.value[t]},e.removeInstance=function(t){var n;Object.keys(e.value).includes(t)&&(null===(n=e.value[t])||void 0===n||n.cancelUpload(),e.value[t]=void 0)},e.keys=function(){return Object.keys(e.value)},e}();_.value={};var b=_,P={dialog:s,alert:i,modal:r,toast:c,tooltip:u,progress:o}},"../spread-sheet/src/core/ui/tooltip/index.ts":function(e,t,n){n.r(t),n.d(t,{changeTooltipText:function(){return c},default:function(){return g},hideTooltip:function(){return d},horizontalTooltip:function(){return u},showTooltip:function(){return l},toolTip:function(){return a}});var r=n("../spread-sheet/src/core/ui/lazyLoad.ts"),o=n("../node_modules/@tencent/docs-user-agent/dist/index.js"),s=n.n(o),i=n("../spread-sheet/src/base/event/event.ts"),a=function(e,t){(0,r.gB)().then((function(n){n.tooltip(e,t)}))},l=function(e,t){(0,r.gB)().then((function(n){n.tooltip(e,t)}))},d=function(){(0,r.gB)().then((function(e){e.hideTooltip()}))},c=function(e){(0,r.gB)().then((function(t){t.changeTooltipText(e)}))},u=function(e,t,n){(0,r.gB)().then((function(r){r.horizontalTooltip(e,t,n)}))};function g(){i.ZP.windowEvent.listen("resize",(function(){$("#tooltip").remove()})),i.ZP.windowEvent.listen("keydown",(function(){$("#tooltip").remove()})),s().isMobilePhone||s().isAndroidPad||!window.SpreadsheetApp.sheetStatus.canEdit||a("#toolbar [data-tooltip]")}},"../spread-sheet/src/external/rangeAuth/config/auth-constant.ts":function(e,t,n){n.d(t,{M:function(){return o},N7:function(){return i},Zx:function(){return l},jV:function(){return a},mA:function(){return s},mP:function(){return c},oI:function(){return r},q9:function(){return d}}),n("../spread-sheet/src/base/util/domain-config.ts");var r,o,s,i,a,l=[[],[!1,!1,!1],[!1,!1,!0]],d=[[],[!1,!0,!0],[!1,!0,!0]];!function(e){e[e.ONLY_I_CAN_EDIT=1]="ONLY_I_CAN_EDIT",e[e.SOME_CAN_EDIT=2]="SOME_CAN_EDIT"}(r||(r={})),function(e){e[e.NO_SET=0]="NO_SET",e[e.CAN_READ=1]="CAN_READ",e[e.CAN_EDIT=2]="CAN_EDIT"}(o||(o={})),function(e){e[e.CAN_VIEW=1]="CAN_VIEW",e[e.CAN_NOT_VIEW=2]="CAN_NOT_VIEW"}(s||(s={})),function(e){e[e.ONLY_RANGE_AUTH=1]="ONLY_RANGE_AUTH",e[e.SHEET_AUTH_AND_RANGE_AUTH=2]="SHEET_AUTH_AND_RANGE_AUTH"}(i||(i={})),function(e){e[e.SELF=0]="SELF",e[e.COOPERATION=1]="COOPERATION",e[e.VIEWABLE=2]="VIEWABLE",e[e.EDITBLE=3]="EDITBLE"}(a||(a={}));var c={USER_ONLY_VIEW:1,USER_CAN_EDIT:2}},"../spread-sheet/src/external/rangeAuth/loader/RangeAuthManager.ts":function(e,t,n){n.d(t,{d:function(){return I}}),n("../node_modules/regenerator-runtime/runtime.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.promise.js"),n("../node_modules/core-js/modules/es.array.iterator.js"),n("../node_modules/core-js/modules/web.dom-collections.iterator.js"),n("../node_modules/core-js/modules/es.number.constructor.js"),n("../node_modules/core-js/modules/es.array.slice.js"),n("../node_modules/core-js/modules/es.function.name.js"),n("../node_modules/core-js/modules/es.array.from.js"),n("../node_modules/core-js/modules/es.string.iterator.js"),n("../node_modules/core-js/modules/es.symbol.js"),n("../node_modules/core-js/modules/es.symbol.description.js"),n("../node_modules/core-js/modules/es.symbol.iterator.js");var r=n("../node_modules/@babel/runtime/helpers/esm/inheritsLoose.js"),o=function(){},s=n("../spread-sheet/src/external/rangeAuth/util/range-auth-request-util.ts"),i=n("../spread-sheet/src/core/app/tool.ts"),a=n("../spread-sheet/src/base/util/appConfig.ts"),l=function(e){function t(){return e.apply(this,arguments)||this}return(0,r.Z)(t,e),t.prototype.getUserRangePrivilege=function(e){var t=i.Z.window.rangeAuthVars?i.Z.window.rangeAuthVars.rangeRev:"";return new Promise((function(r,o){$.ajax({url:"//"+a.Z.getConfig("runtime.domainName")+"/cgi-go/range_priv/get_user_range_privilege",type:"POST",xhrFields:{withCredentials:!0},data:{localPadId:window.clientVars.localPadId,type:1,domain:(0,s.MQ)(),rangeIdList:JSON.stringify(e),rangeRev:t,xsrf:i.Z.getXsrf()},success:function(e){var t,o;if("string"===typeof e)try{o=JSON.parse(e)}catch(s){null===(t=n.g.log)||void 0===t||t.error("rangeAuthRequestUtil.tempData.parse",null===s||void 0===s?void 0:s.stack),o={}}else o=e;r(o)},error:function(e){o(e)}})}))},t}(o),d=n("../node_modules/@tencent/docs_offline/lib/index.js"),c=n("../spread-sheet/src/core/data/configService/spreadConfig.ts"),u=n("../spread-sheet/src/external/rangeAuth/util/util.ts"),g=function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function i(e){try{l(r.next(e))}catch(t){s(t)}}function a(e){try{l(r.throw(e))}catch(t){s(t)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,a)}l((r=r.apply(e,t||[])).next())}))},p=function(e){function t(t){var n;return(n=e.call(this)||this).app=t,n}return(0,r.Z)(t,e),t.prototype.getUserRangePrivilege=function(e){var t=this;return new Promise((function(r,o){return g(t,void 0,void 0,regeneratorRuntime.mark((function t(){var s,i,a,l;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,null===(s=this.app.offlineOpen)||void 0===s?void 0:s.offlineDataManager.getHelper(d.Gk.EXCEL).getRangePrivilege(c.q.getConfig("globalPadId"),e);case 3:a=t.sent,t.next=11;break;case 6:return t.prev=6,t.t0=t.catch(0),o(t.t0),null===(i=n.g.log)||void 0===i||i.error("getRangePrivilege error",null===t.t0||void 0===t.t0?void 0:t.t0.stack,null===t.t0||void 0===t.t0?void 0:t.t0.message),t.abrupt("return");case 11:a.error&&o(a.error),l=(0,u.convertToServerRangePrivilege)(a.data.data),r({data:{isOwner:!1,rangeCheckResList:l},msg:"",retcode:0});case 14:case"end":return t.stop()}}),t,this,[[0,6]])})))}))},t}(o),h=n("../node_modules/@tencent/netcheck/lib/index.js"),m=n("../spread-sheet/src/external/rangeAuth/logic/check-user-auth.ts");function f(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){if(e){if("string"===typeof e)return v(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?v(e,t):void 0}}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0;return function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function v(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var w=function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function i(e){try{l(r.next(e))}catch(t){s(t)}}function a(e){try{l(r.throw(e))}catch(t){s(t)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,a)}l((r=r.apply(e,t||[])).next())}))},I=function(){function e(t){var r=this;if(this.updateLocalUserRangePrivilege=function(e){for(var t,o,s,i=[],a=f((0,u.getProtectedMap)().keys());!(s=a()).done;){var l=s.value;i.push(l)}try{null===(t=r.app.offlineOpen)||void 0===t||t.offlineDataManager.getHelper(d.Gk.EXCEL).cacheRangePrivilege(c.q.getConfig("globalPadId"),(0,u.convertToLocalRangePrivilege)(e),i)}catch(g){null===(o=n.g.log)||void 0===o||o.error("cacheRangePrivilege error",null===g||void 0===g?void 0:g.stack,null===g||void 0===g?void 0:g.message)}},this.app=t,e.instance)return e.instance;this.serverLoader=new l,this.offlineLoader=new p(t),e.instance=this}var t=e.prototype;return t.getUserRangePrivilege=function(e){return void 0===e&&(e=[]),w(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!window.__SUPPORT_FULL_OFFLINE_MODE||h.network.isOnline){t.next=4;break}return t.next=3,this.offlineLoader.getUserRangePrivilege(e);case 3:return t.abrupt("return",t.sent);case 4:return t.next=6,this.serverLoader.getUserRangePrivilege(e);case 6:return n=t.sent,this.updateLocalUserRangePrivilege(n.data.rangeCheckResList),t.abrupt("return",n);case 9:case"end":return t.stop()}}),t,this)})))},t.deleteRangeAuth=function(e){var t,r;try{null===(t=this.app.offlineOpen)||void 0===t||t.offlineDataManager.getHelper(d.Gk.EXCEL).deleteRangeAuth(c.q.getConfig("globalPadId"),e)}catch(o){null===(r=n.g.log)||void 0===r||r.error("deleteRangeAuth error",null===o||void 0===o?void 0:o.stack,null===o||void 0===o?void 0:o.message)}},t.isSheetRangeCanEdit=function(e){var t=this;return new Promise((function(r){var o=t.app.sheetStatus.workbookStatus.canEdit,s=(0,u.getExistSheetRangeIdItem)(e);s||r(o),c.q.getConfig("isOwner")&&r(o),t.getUserRangePrivilege([s]).then((function(e){var t,n;if(null===(n=null===(t=e.data)||void 0===t?void 0:t.rangeCheckResList)||void 0===n?void 0:n[0]){var o=e.data.rangeCheckResList[0],s=Number(o.rangePolicy||1),i=Number(o.rangePrivilege||0),a=(0,m.f)(s,i);r(a)}else r(!0)})).catch((function(e){var t;null===(t=n.g.log)||void 0===t||t.error("rangeAuth.util.util.isSheetRangeCanEdit",null===e||void 0===e?void 0:e.stack),r(o)}))}))},e}()},"../spread-sheet/src/external/rangeAuth/logic/check-user-auth.ts":function(e,t,n){n.d(t,{O:function(){return s},f:function(){return o}});var r=n("../spread-sheet/src/external/rangeAuth/config/auth-constant.ts");function o(e,t){return 0!==e&&r.Zx[e][t]}function s(e,t,n){return n!==r.mA.CAN_NOT_VIEW||0!==e&&r.q9[e][t]}},"../spread-sheet/src/external/rangeAuth/util/range-auth-parse-util.ts":function(e,t,n){n.d(t,{Pw:function(){return i},rk:function(){return l}});var r=n("../node_modules/i18next/dist/esm/i18next.js"),o=n("../packages/model/src/range/hexRangeUtils.ts"),s=n("../packages/model/src/range/GridRange.ts");function i(e){if(e.isSheet)return"「"+n.g.SpreadsheetApp.spreadsheet.sheetManager.getSheetTitleBySheetId(e.sheetId)+"」";var t=e.startRowIndex,s=e.endRowIndex,i=e.startColIndex,a=e.endColIndex,l=e.isCol,d=e.isRow,c=e.isSheet,u=(0,o.colIndex2ColChar)(i),g=(0,o.colIndex2ColChar)(a);return l?u===g?r.ZP.t("（第{{startColName}}列）",{startColName:u}):r.ZP.t("（第{{startColName}}至{{endColName}}列）",{startColName:u,endColName:g}):d?t===s?r.ZP.t("（第{{value}}行）",{value:t+1}):r.ZP.t("（第{{value0}}至{{value1}}行）",{value0:t+1,value1:s+1}):c?n.g.SpreadsheetApp.spreadsheet.sheetManager.getSheetTitleBySheetId(e.sheetId):t===s&&u===g?"（"+u+(t+1)+"）":"（"+u+(t+1)+":"+g+(s+1)+"）"}function a(e){var t={text:"",isSingleSelect:!0,gridRange:new s.Z(n.g.SpreadsheetApp.spreadsheet.activeSheetId)};if(e.length>1||0===e.length)return t.isSingleSelect=!1,t;var r=e[0],o=function(e){var t={startRowIndex:0,endRowIndex:0,startColIndex:0,endColIndex:0},r=e.selectRow,o=e.selectAll,s=e.selectCol;return r?(t.startRowIndex=e.yRange[0],t.endRowIndex=e.yRange[1],t):s?(t.startColIndex=e.xRange[0],t.endColIndex=e.xRange[1],t):o?(t.endRowIndex=n.g.SpreadsheetApp.spreadsheet.activeSheet.getRowCount()-1,t.endColIndex=n.g.SpreadsheetApp.spreadsheet.activeSheet.getColCount()-1,t):(t.startRowIndex=e.yRange[0],t.endRowIndex=e.yRange[1],t.startColIndex=e.xRange[0],t.endColIndex=e.xRange[1],t)}(r),a=o.startRowIndex,l=o.endRowIndex,d=o.startColIndex,c=o.endColIndex;t.gridRange.startRowIndex=a,t.gridRange.endRowIndex=l,t.gridRange.startColIndex=d,t.gridRange.endColIndex=c;var u=r.selectRow,g=r.selectCol;return u?(t.gridRange.startColIndex=s.v,t.gridRange.endColIndex=s.v):g&&(t.gridRange.startRowIndex=s.v,t.gridRange.endRowIndex=s.v),t.text+=i(t.gridRange),t}function l(){return a(n.g.SpreadsheetApp.view.canvas.normalSelectData.selectQueue)}},"../spread-sheet/src/external/rangeAuth/util/range-auth-request-util.ts":function(e,t,n){n.d(t,{MQ:function(){return d},r2:function(){return v},ng:function(){return g},Fs:function(){return c},Vu:function(){return m},Sh:function(){return h},QQ:function(){return f}}),n("../node_modules/core-js/modules/es.regexp.exec.js"),n("../node_modules/core-js/modules/es.string.replace.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.regexp.to-string.js"),n("../node_modules/core-js/modules/es.promise.js"),n("../node_modules/core-js/modules/es.array.map.js");var r=n("../node_modules/i18next/dist/esm/i18next.js"),o=n("../spread-sheet/src/core/app/tool.ts"),s=n("../spread-sheet/src/external/rangeAuth/config/auth-constant.ts");n("../node_modules/core-js/modules/web.dom-collections.for-each.js");var i=n("../spread-sheet/src/base/util/object.ts"),a=n("../spread-sheet/src/core/data/configService/spreadConfig.ts"),l=n("../spread-sheet/src/base/util/appConfig.ts");function d(){return a.q.getConfig("domainId")}function c(){var e=(new Date).getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(t){var n=(e+16*Math.random())%16|0;return e=Math.floor(e/16),("x"===t?n:3&n|8).toString(16)}))}function u(e){var t,r;if("string"===typeof e)try{r=JSON.parse(e)}catch(o){null===(t=n.g.log)||void 0===t||t.error("rangeAuthRequestUtil.transitionData",null===o||void 0===o?void 0:o.stack),r={}}else r=e;return r}function g(e,t){return void 0===t&&(t=s.N7.ONLY_RANGE_AUTH),0===e.length?Promise.resolve({retcode:0,msg:"none",data:{localPadId:"",domain:"",padPolicy:s.jV.EDITBLE,protectedRangeList:[{rangePolicy:s.oI.ONLY_I_CAN_EDIT,rangeId:"0",setUid:"",setName:"",memlist:[]}]}}):new Promise((function(n,r){$.ajax({url:"//"+l.Z.getConfig("runtime.domainName")+"/cgi-go/range_priv/get_range_privilege",type:"POST",xhrFields:{withCredentials:!0},data:{localPadId:o.Z.window.clientVars.padId,type:t,domain:d(),rangeIdList:JSON.stringify(e),xsrf:o.Z.getXsrf()},success:function(e){var t;(t="string"===typeof e?JSON.parse(e):e).data.protectedRangeList&&0!==t.data.protectedRangeList.length||(t.data.protectedRangeList=[{rangePolicy:0,memlist:[]}]),n(t)},error:function(e){r(e)}})}))}var p=!1;function h(e,t){if(void 0===e&&(e=[]),!Array.isArray(e))return Promise.reject({msg:r.ZP.t("参数错误，请重试")});if(p)return Promise.reject({msg:r.ZP.t("正在设置中，请稍后～")});p=!0;var n=function(e){void 0===e&&(e=[]);var t=[],n="";return e.forEach((function(e){var r=[];e.addmemlist&&(r=e.addmemlist.map((function(e){return e.corp_id&&(n=e.corp_id),{uin:""+e.uin,rangePrivilegeType:e.rangePrivilegeType,isNew:e.isNew,workId:e.work_id||"",uintype:e.uintype||0,corpId:e.corp_id||""}})));var o=[];e.submemlist&&(o=e.submemlist.map((function(e){return e.corp_id&&(n=e.corp_id),{uin:""+e.uin,uintype:e.uintype||0}}))),t.push({rangeId:e.rangeId,rangePolicy:e.rangePolicy||0,rangeOtherPrivilegeType:e.rangeOtherPrivilegeType,addmemlist:r,submemlist:o,clear:e.clear})})),{filteredList:t,corpId:n}}(e),s=n.filteredList,a=n.corpId,g=e.map((function(e){return e.rangeId})),h={rangeSeq:c(),rangeAction:{rangeIdList:g}};return new Promise((function(e,n){$.ajax({url:"//"+l.Z.getConfig("runtime.domainName")+"/cgi-go/range_priv/set_range_privilege",type:"POST",xhrFields:{withCredentials:!0},data:{localPadId:o.Z.window.clientVars.padId,data:JSON.stringify(s),corpId:a,domain:d(),message:t?JSON.stringify(t):JSON.stringify(h),xsrf:o.Z.getXsrf()},success:function(t){var r=u(t);0===r.retcode?e(r):n(r),p=!1},error:function(e){var t=(0,i.deepClone)(e);p=!1;var o="";switch(t.retcode){case 10013:case 10018:o=r.ZP.t("添加的人不是好友");break;case 10014:o=r.ZP.t("成员列表超过限制数量");break;case 10015:o=r.ZP.t("单次添加的成员数量超过限制");break;case 10016:o=r.ZP.t("大表成员列表超过限制")}t.msg||(t.msg=o),n(t)}})}))}function m(){return new Promise((function(e,t){$.ajax({url:"//"+l.Z.getConfig("runtime.domainName")+"/cgi-bin/online_docs/auth_info/get",type:"POST",xhrFields:{withCredentials:!0},data:{localPadId:o.Z.window.clientVars.padId,domain:d(),type:1,ver:2,folderId:"",dataType:"",xsrf:o.Z.getXsrf()},success:function(n){var r=u(n);0===r.retcode?e(r):t(r)},error:function(e){t(e)}})}))}function f(e,t,r){var s;void 0===t&&(t=[]),void 0===r&&(r=[]);var i={seq:c(),action:1};try{"undefined"===typeof window.clientVars&&(window.clientVars={}),"undefined"===typeof window.clientVars.msgFilterData&&(window.clientVars.msgFilterData={}),window.clientVars.msgFilterData[i.seq]=i.action}catch(a){null===(s=n.g.log)||void 0===s||s.error("rangeAuthRequestUtil.setWorkbookAuth",null===a||void 0===a?void 0:a.stack)}return new Promise((function(n,s){$.ajax({url:"//"+l.Z.getConfig("runtime.domainName")+"/v2/privilege/set_user?xsrf="+o.Z.getXsrf(),type:"POST",xhrFields:{withCredentials:!0},contentType:"application/json",data:JSON.stringify({obj:{id:o.Z.window.clientVars.padId,type:2},policy:e,message:encodeURIComponent(JSON.stringify(i)),add:t,sub:r,xsrf:o.Z.getXsrf()}),success:function(e){var t=u(e);0===t.retcode?n(t):s(t)},error:function(e){s(e)}})}))}function v(e){if(o.Z.window.clientVars.ownerNick&&e)e(o.Z.window.clientVars.ownerNick);else{var t=a.q.getConfig("docInfo");(null===t||void 0===t?void 0:t.ownerName)&&(o.Z.window.clientVars.ownerNick=null===t||void 0===t?void 0:t.ownerName,o.Z.window.clientVars.ownerAvatar=null===t||void 0===t?void 0:t.ownerAvatar),null===e||void 0===e||e(null===t||void 0===t?void 0:t.ownerName)}}},"../spread-sheet/src/external/rangeAuth/util/util.ts":function(e,t,n){n.r(t),n.d(t,{convertToLocalRangePrivilege:function(){return j},convertToServerRangePrivilege:function(){return C},getActiveSheetRangeIds:function(){return w},getCurrentSheetRangeIdsAndAllSheetRangeIds:function(){return m},getExistSheetRangeIdItem:function(){return f},getGridRangeByRangeId:function(){return y},getGridRangeListBySheetId:function(){return S},getNewRangeId:function(){return p},getProtectedMap:function(){return h},getRangeAuthInfo:function(){return a.ng},getRangeAuthListCrossGridRange:function(){return b},getRangeAuthListCrossSelectArea:function(){return P},getRangeIdByGridRange:function(){return x},getRangeIdsBySheetId:function(){return v},getSheetIdByRangeId:function(){return E},getWorkbookAuth:function(){return a.Vu},isGridRangeSetAuth:function(){return _},isRangeCountExceedMaxValue:function(){return R},isSheetRangeSetAuth:function(){return I},isWedocUpgradedSheet:function(){return M},parseGridRangeText:function(){return l.Pw},parseSelectDataForRangeAuth:function(){return l.rk},setRangeAuthInfo:function(){return a.Sh},setWorkbookAuth:function(){return a.QQ}}),n("../node_modules/core-js/modules/web.dom-collections.for-each.js"),n("../node_modules/core-js/modules/es.array.iterator.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/web.dom-collections.iterator.js"),n("../node_modules/core-js/modules/es.array.find-index.js"),n("../node_modules/core-js/modules/es.number.constructor.js"),n("../node_modules/core-js/modules/es.object.keys.js"),n("../node_modules/core-js/modules/es.regexp.exec.js"),n("../node_modules/core-js/modules/es.string.match.js"),n("../node_modules/core-js/modules/es.array.slice.js"),n("../node_modules/core-js/modules/es.function.name.js"),n("../node_modules/core-js/modules/es.array.from.js"),n("../node_modules/core-js/modules/es.string.iterator.js"),n("../node_modules/core-js/modules/es.symbol.js"),n("../node_modules/core-js/modules/es.symbol.description.js"),n("../node_modules/core-js/modules/es.symbol.iterator.js");var r=n("../node_modules/i18next/dist/esm/i18next.js"),o=n("../spread-sheet/src/core/app/tool.ts"),s=n("../packages/utils/src/index.ts"),i=n("../packages/model/src/range/GridRange.ts"),a=n("../spread-sheet/src/external/rangeAuth/util/range-auth-request-util.ts"),l=n("../spread-sheet/src/external/rangeAuth/util/range-auth-parse-util.ts"),d=n("../node_modules/@tencent/dui/lib/components/Snackbar/index.js"),c=n("../spread-sheet/src/core/data/configService/spreadConfig.ts");function u(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){if(e){if("string"===typeof e)return g(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?g(e,t):void 0}}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0;return function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function g(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function p(){return s.kk.getRandomId()}function h(){return n.g.SpreadsheetApp.spreadsheet.workbookRangeManager.protectedRangeMap}function m(e,t){var n={currentSheetRangeIds:[],allSheetRangeIds:[]};return t.forEach((function(t,r){t.range.isSheet?n.allSheetRangeIds.push(r):t.range.sheetId===e&&n.currentSheetRangeIds.push(r)})),n}function f(e){var t="";return h().forEach((function(n,r){if(n.range.isSheet&&n.range.sheetId===e)return t=r})),t}function v(e){var t=[],n="";return h().forEach((function(r,o){r.range.sheetId===e&&(r.range.isSheet?n=o:t.push(o))})),{rangeIds:t,sheetRangeId:n}}function w(){return v(o.Z.window.SpreadsheetApp.spreadsheet.activeSheetId)}function I(e){return!!f(e)}function x(e){for(var t,n="",r=u(h().entries());!(t=r()).done;){var o=t.value,s=o[0];if(o[1].range.contain(e)){n=s;break}}return n}function y(e){var t=new i.Z(o.Z.window.SpreadsheetApp.spreadsheet.activeSheetId),n=h().get(e);return void 0!==n&&(t=n.range.clone()),t}function S(e){var t=[];return h().forEach((function(n){n.range.sheetId===e&&t.push(n.range.clone())})),t}function _(e){return-1!==S(e.sheetId).findIndex((function(t){return t.isCross(e)}))}function b(e){var t=[];return h().forEach((function(n,r){var o=n.range;o.isCross(e)&&!o.isSheet&&t.push({rangeId:r,modifyTime:n.properties.modifyTime||0,gridRange:n.range.clone()})})),t}function P(){var e=(0,l.rk)(),t=e.gridRange,n=e.isSingleSelect;return t.isSheet||!n?[]:b(t)}function R(){var e=h().size>=2e3;return e&&d.default.show({type:"info",message:r.ZP.t("受保护范围已超过2000个上限，请取消部分保护范围后重试。"),autoClose:!0,style:{zIndex:10004}}),e}function j(e){var t={};return e.length&&e.forEach((function(e){t[e.rangeId]=[e.rangePolicy,e.rangePrivilege,Number(e.setUid),e.uintype,e.rangeOtherPrivilegeType]})),t}function C(e){var t=[];return Object.keys(e).forEach((function(n){t.push({rangeId:n,rangePolicy:e[n][0],rangePrivilege:e[n][1],setUid:""+e[n][2],uintype:e[n][3],rangeOtherPrivilegeType:e[n][4]})})),t}function E(e,t){var n;return null===(n=t.get(e))||void 0===n?void 0:n.range.sheetId}function M(){return(c.q.getConfig("padId")||"").match(/^e2_/)}},"../spread-sheet/src/external/view/pc/footer/components/scalebar/scalebar.tsx":function(e,t,n){n.d(t,{Z:function(){return I},x:function(){return w}});var r=n("../node_modules/@babel/runtime/helpers/esm/assertThisInitialized.js"),o=n("../node_modules/@babel/runtime/helpers/esm/inheritsLoose.js"),s=(n("../node_modules/core-js/modules/es.array.map.js"),n("../node_modules/core-js/modules/web.dom-collections.for-each.js"),n("../node_modules/i18next/dist/esm/i18next.js")),i=n("react"),a=n("../spread-sheet/src/base/index.ts"),l=n("../spread-sheet/src/core/ui/index.ts"),d=n("../spread-sheet/src/base/util/type.ts"),c=n("../node_modules/@tencent/docs-user-agent/dist/index.js"),u=n.n(c),g=n("../packages/report/src/index.ts"),p=n("../node_modules/classnames/index.js"),h=n.n(p),m=n("../spread-sheet/src/core/view/spreadsheet-view/area-data/AreaData.interface.ts"),f=a.Z.event.sheetsBar,v=u().isMac?"Cmd":"Ctrl",w=5,I=function(e){function t(n){var o;return(o=e.call(this,n)||this).state={progress:t.MiddleProgress,sliderBarStyleLeft:(t.SliderRailWidth-t.SliderBarWidth)/2,rangeInputValue:(t.MaxRangeInputValue-t.MinRangeInputValue)/2,isSliderBarHover:!1,listVisibility:!1,showPreviewScale:!0,scaleList:[{value:t.MinProgress+"%",selected:!1},{value:"75%",selected:!1},{value:"100%",selected:!0},{value:"125%",selected:!1},{value:"150%",selected:!1},{value:"200%",selected:!1},{value:"300%",selected:!1},{value:t.MaxProgress+"%",selected:!1}],ScaleSource:m.oz.SLIENT},o.zoomOutClickHandler=o.zoomOutClickHandler.bind((0,r.Z)(o)),o.zoomInClickHandler=o.zoomInClickHandler.bind((0,r.Z)(o)),o.zoomOutKeyHandler=o.zoomOutKeyHandler.bind((0,r.Z)(o)),o.zoomInKeyHandler=o.zoomInKeyHandler.bind((0,r.Z)(o)),o.changeScaleHandler=o.changeScaleHandler.bind((0,r.Z)(o)),f.listen("changeScale",o.changeScaleHandler),o}(0,o.Z)(t,e);var n=t.prototype;return n.componentWillUnmount=function(){f.remove("changeScale",this.changeScaleHandler)},n.componentDidMount=function(){this.props.inToastPreview&&(this.scalebarInit(),document.body.onmousemove=(0,d.throttle)(this.handleMousemove,100,this,!1))},n.componentDidUpdate=function(e,n){if(this.state.progress!==n.progress){var r=this.state.progress/t.MiddleProgress;this.zoomExcel(r),f.trigger("scaleButtonClick",r,this.state.ScaleSource),g.ZP.tdwReport({opername:"doc_excel_editor",module:"excel_zoom",action:"zoom_data",ver1:this.state.progress})}},n.render=function(){var e=this,n=this.state.progress+"%",r=i.createElement("div",{className:h()({scalebar:!0,"scalebar-disabled":this.props.disabled}),tabIndex:-1,"data-tooltip-offsetleft":"-27.5"},i.createElement("div",{className:"scalebar__zoom scalebar__zoomout","data-tooltip":s.ZP.t("{{Ctrl}}+0可恢复至100%",{Ctrl:v}),"aria-label":s.ZP.t("缩小,{{Ctrl}}+0可恢复至100%",{Ctrl:v}),tabIndex:4,onClick:this.zoomOutClickHandler,onKeyPress:this.zoomOutKeyHandler},i.createElement("div",{className:"scalebar__zoom-btn"})),i.createElement("span",{className:"scalebar__progress",tabIndex:-1,onBlur:this.hideScalelist.bind(this)},i.createElement("span",{className:"content",onClick:this.switchListHandler.bind(this)},n),i.createElement("ul",{className:"scalebar__progress-list",style:{display:this.state.listVisibility?"block":"none"}},this.state.scaleList.map((function(t,r){return i.createElement("li",{key:r,className:"item"+(t.value===n?" selected":""),onClick:e.checkItem.bind(e,r,t.value)},t.value)})))),i.createElement("div",{className:"scalebar__zoom scalebar__zoomin","data-tooltip":s.ZP.t("{{Ctrl}}+0可恢复至100%",{Ctrl:v}),"aria-label":s.ZP.t("放大,{{Ctrl}}+0可恢复至100%",{Ctrl:v}),tabIndex:4,onClick:this.zoomInClickHandler,onKeyPress:this.zoomInKeyHandler},i.createElement("div",{className:"scalebar__zoom-btn"}),i.createElement("div",{className:"scalebar__zoom-btn--vertical"}))),o=i.createElement("div",{id:"preview-scalebar-contanier",className:this.state.showPreviewScale?"":"hidden"},i.createElement("span",{id:"preview-scale-zoomout",className:h()({"preview-scale-icon":!0,disable:this.state.progress<=t.MinProgress||this.props.disabled}),onClick:this.zoomOutClickHandler}),i.createElement("span",{id:"preview-scale-zoomin",className:h()({"preview-scale-icon":!0,disable:this.state.progress>=t.MaxProgress||this.props.disabled}),onClick:this.zoomInClickHandler}),i.createElement("span",{id:"preview-scale-restore",className:h()({"preview-scale-icon":!0,disable:this.state.progress===t.MiddleProgress||this.props.disabled}),onClick:this.checkItem.bind(this,2,"100")}));return this.props.inToastPreview?o:r},n.changeScaleHandler=function(e,n,r){var o;void 0===e&&(e=0),void 0===n&&(n=m.oz.SLIENT),o=0===e?t.MiddleProgress:this.getProgressByDelta(e,r);var s=this.getSliderBarStyleLeftByProgress(o),i=this.getRangeInputValueByProgress(o);this.setState({progress:o,sliderBarStyleLeft:s,rangeInputValue:i,ScaleSource:n});var a=0===e?"zoom_reset":e>0?"zoom_in_ctrl":"zoom_out_ctrl";g.ZP.tdwReport({opername:"doc_excel_editor",module:"excel_zoom",action:a,ver1:o})},n.zoomOutClickHandler=function(e){if(e.stopPropagation(),e.nativeEvent.stopImmediatePropagation(),!this.props.disabled){var t=this.getProgressByDelta(-1*w),n=this.getSliderBarStyleLeftByProgress(t),r=this.getRangeInputValueByProgress(t);this.setState({progress:t,sliderBarStyleLeft:n,rangeInputValue:r,ScaleSource:m.oz.USER}),l.Z.tooltip.hideTooltip(),g.ZP.tdwReport({opername:"doc_excel_editor",module:"excel_zoom",action:"zoom_out_click",ver1:t}),this.props.inToastPreview&&g.ZP.tdwReport({opername:"doc_preview",module:"pc_qqview",action:"cli_reduce"})}},n.zoomOutKeyHandler=function(e){e&&"Enter"===e.key&&this.zoomOutClickHandler(e)},n.zoomInClickHandler=function(e){if(e.stopPropagation(),e.nativeEvent.stopImmediatePropagation(),!this.props.disabled){var t=this.getProgressByDelta(w),n=this.getSliderBarStyleLeftByProgress(t),r=this.getRangeInputValueByProgress(t);this.setState({progress:t,sliderBarStyleLeft:n,rangeInputValue:r,ScaleSource:m.oz.USER}),l.Z.tooltip.hideTooltip(),g.ZP.tdwReport({opername:"doc_excel_editor",module:"excel_zoom",action:"zoom_in_click",ver1:t}),this.props.inToastPreview&&g.ZP.tdwReport({opername:"doc_preview",module:"pc_qqview",action:"cli_amp"})}},n.zoomInKeyHandler=function(e){e&&"Enter"===e.key&&this.zoomInClickHandler(e)},n.getProgressByDelta=function(e,n){var r=this.state.progress,o=Math.abs(e);return r%o===0||n?r+=e:r=r-r%o+(e+o)/2,r=Math.max(r,t.MinProgress),r=Math.min(r,t.MaxProgress),r>>=0},n.getSliderBarStyleLeftByProgress=function(e){return this.state.sliderBarStyleLeft,e>=t.MiddleProgress?(t.SliderRailWidth-t.SliderBarWidth)/2*(1+(e-t.MiddleProgress)/(t.MaxProgress-t.MiddleProgress)):(t.SliderRailWidth-t.SliderBarWidth)/2*(e-t.MinProgress)/(t.MiddleProgress-t.MinProgress)},n.rangeInputChangeHandler=function(e){var t=e.target.value,n=this.getProgressByRangeInputValue(t),r=this.getSliderBarStyleLeftByProgress(n),o=t>this.state.rangeInputValue?"zoom_in_drag":"zoom_out_drag";this.setState({rangeInputValue:t,progress:n,sliderBarStyleLeft:r}),l.Z.tooltip.hideTooltip(),g.ZP.tdwReport({opername:"doc_excel_editor",module:"excel_zoom",action:o,ver1:n})},n.switchListHandler=function(e){e.stopPropagation(),e.nativeEvent.stopImmediatePropagation(),this.props.disabled||this.setState({listVisibility:!this.state.listVisibility})},n.hideScalelist=function(){this.setState({listVisibility:!1})},n.checkItem=function(e,t){if(t){var n=parseInt(t,10)/100;this.zoomExcel(n),f.trigger("scaleSelect",n),this.state.scaleList.forEach((function(e){e.selected=!1})),this.state.scaleList[e].selected=!0,this.state.listVisibility=!1,this.state.progress=parseFloat(t),this.setState(this.state),this.props.inToastPreview&&g.ZP.tdwReport({opername:"doc_preview",module:"pc_qqview",action:"cli_recovery"})}},n.getProgressByRangeInputValue=function(e){var n=(t.MaxRangeInputValue-t.MinRangeInputValue)/2;return(e>=n?t.MaxProgress-(t.MaxProgress-t.MiddleProgress)*(t.MaxRangeInputValue-e)/(t.MaxRangeInputValue-n):t.MinProgress+(t.MiddleProgress-t.MinProgress)*(e-t.MinRangeInputValue)/(n-t.MinRangeInputValue))>>0},n.getRangeInputValueByProgress=function(e){var n=(t.MaxRangeInputValue-t.MinRangeInputValue)/2;return(e>=t.MiddleProgress?t.MaxRangeInputValue-(t.MaxRangeInputValue-n)*(t.MaxProgress-e)/(t.MaxProgress-t.MiddleProgress):t.MinRangeInputValue+(n-t.MinRangeInputValue)*(e-t.MinProgress)/(t.MiddleProgress-t.MinProgress))>>0},n.zoomExcel=function(e){var t,n;null===(n=null===(t=this.props.app)||void 0===t?void 0:t.view)||void 0===n||n.canvas.scale.scaleTo(e)},n.inputRangeMouseMoveOrClick=function(e){var t=this.refs.sliderBar.getBoundingClientRect();e.clientX>=t.left&&e.clientX<=t.right&&e.clientY>=t.top&&e.clientY<=t.bottom?this.setState({isSliderBarHover:!0}):this.setState({isSliderBarHover:!1}),e.target.blur()},n.inputRangeMouseLeave=function(){this.setState({isSliderBarHover:!1})},n.scalebarInit=function(){var e=this;a.Z.util.timer.wait(t.ShowTimeInterval).run((function(){e.setState({showPreviewScale:!1})}))},n.handleMousemove=function(e){var t=e.pageY;window.innerHeight-t<=window.innerHeight/4?this.state.showPreviewScale||this.setState({showPreviewScale:!0}):this.state.showPreviewScale&&this.setState({showPreviewScale:!1})},t}(i.Component);I.MaxProgress=400,I.MiddleProgress=100,I.MinProgress=50,I.SliderRailWidth=120,I.SliderBarWidth=18,I.MaxRangeInputValue=100,I.MinRangeInputValue=0,I.ShowTimeInterval=5e3}}]),window.jsExecEndTimeStamp=Date.now(),window.cachedPerformanceEntries||(window.cachedPerformanceEntries=[]),window.cachedPerformanceEntries.push({name:"jsExec: js/spread-sheet_src_external_rangeAuth_loader_RangeAuthManager_ts-spread-sheet_src_external_view-9a5060.54ca15ad1a9607ac5db3.js",entryType:"jsExec",startTime:window.jsExecStartTimeStamp,endTime:window.jsExecEndTimeStamp});
//# sourceMappingURL=spread-sheet_src_external_rangeAuth_loader_RangeAuthManager_ts-spread-sheet_src_external_view-9a5060.54ca15ad1a9607ac5db3.js.map