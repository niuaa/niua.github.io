self.window=self,window.jsExecStartTimeStamp=Date.now(),(self.webpackChunk_tencent_alloy_builder=self.webpackChunk_tencent_alloy_builder||[]).push([["bundle_workbench_feature"],{"../spread-sheet/src/core/app/spreadsheet-app-worker.interface.ts":function(e,t,n){n.d(t,{m:function(){return r}});var r=(0,n("../node_modules/@tencent/containerized/build/main/index.js").yh)("ISpreadsheetApp")},"../spread-sheet/src/core/view/level-2/link-center/report/attachment-export.ts":function(e,t,n){n.d(t,{Fr:function(){return s},IQ:function(){return i},l2:function(){return o},zT:function(){return a}});var r=n("../packages/report/src/index.ts"),o=function(){c("local_doc_add_zip")},s=function(){c("local_doc_only")},a=function(){c("popup_close")},i=function(){c("toast_cancel")},c=function(e){r.ZP.tdwReport({opername:"doc_word_editor",module:"local_files",file_type:2,action:e})}},"../spread-sheet/src/core/workbench/common/auth-range-service.ts":function(e,t,n){n("../node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),n("../node_modules/core-js/modules/esnext.reflect.metadata.js"),n("../node_modules/core-js/modules/es.array.find-index.js");var r,o,s,a=n("../node_modules/@tencent/workbench/lib/esm/decorators/class/service.js"),i=n("../spread-sheet/src/core/view/layout/interface/pc-view.ts"),c=n("../spread-sheet/src/core/app/sheetStatus/index.ts"),d=n("../packages/model/src/spreadsheet/index.ts"),u=function(e,t,n,r){var o,s=arguments.length,a=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var i=e.length-1;i>=0;i--)(o=e[i])&&(a=(s<3?o(a):s>3?o(t,n,a):o(t,n))||a);return s>3&&a&&Object.defineProperty(t,n,a),a},l=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},p=function(e,t){return function(n,r){t(n,r,e)}},f=function(){function e(e,t,n){this.view=e,this.spreadsheet=t,this.sheetStatus=n,this.rules={}}var t=e.prototype;return t.addRule=function(e,t){this.rules[e]=t},t.checkAuthRange=function(e){var t=this,n=this.rules[e];return(n&&n.getRanges?n.getRanges():this.view.getSelection().rangeSelections).some((function(e){return t.checkRangeCanEdit(e)}))},t.checkRangeCanEdit=function(e){var t=this.sheetStatus.getRangeCanEdit(e);return!!t&&((e.isRow||e.isCol)&&(t=this.checkCrossDimensionMergeCanEdit(e)),t)},t.checkCrossDimensionMergeCanEdit=function(e){var t=this;return-1===this.spreadsheet.activeSheet.mergeManager.mergeList.findIndex((function(n){return!!n.isCross(e)&&!t.sheetStatus.getRangeCanEdit(n)}))},e}();f=u([(0,a.t)(),p(0,i.w),p(1,d.ISpreadsheet),p(2,c.T),l("design:paramtypes",["function"===typeof(r="undefined"!==typeof i.w&&i.w)?r:Object,"function"===typeof(o="undefined"!==typeof d.ISpreadsheet&&d.ISpreadsheet)?o:Object,"function"===typeof(s="undefined"!==typeof c.T&&c.T)?s:Object])],f),t.Z="page-editor"==n.j?f:null},"../spread-sheet/src/core/workbench/common/input-manager-service.ts":function(e,t,n){n("../node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),n("../node_modules/core-js/modules/esnext.reflect.metadata.js"),n("../node_modules/core-js/modules/es.regexp.exec.js"),n("../node_modules/core-js/modules/es.string.replace.js");var r,o,s,a=n("../node_modules/@tencent/workbench/lib/esm/decorators/class/feature.js"),i=n("../node_modules/@tencent/workbench/lib/esm/services/toolbar/toolbar-service.js"),c=n("../node_modules/@tencent/workbench/lib/esm/services/mobile-toolbar/mobile-toolbar-service.js"),d=n("../packages/model/src/index.ts"),u=n("../spread-sheet/src/core/view/layout/interface/pc-view.ts"),l=n("../spread-sheet/src/external/view/schema/toolbar-schema.ts"),p=n("../spread-sheet/src/adapter/SpreadSheetAppAdapter.ts"),f=n("../packages/common-utils/src/index.ts"),m=function(e,t,n,r){var o,s=arguments.length,a=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var i=e.length-1;i>=0;i--)(o=e[i])&&(a=(s<3?o(a):s>3?o(t,n,a):o(t,n))||a);return s>3&&a&&Object.defineProperty(t,n,a),a},h=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},g=function(e,t){return function(n,r){t(n,r,e)}},v=function(){function e(e,t,n){var r=this;this.view=e,this.toolbarService=t,this.mobileToolbarService=n,this.inputState={},this.isEditing=!1,this.updateInputFormat=(0,f.P2)((function(){var e=r.view.canvas.inputManager;if(!e.isInputtingToolbar()){var t=e.getFormat();r.resetInputStyle(),r.setInputState(l.HM.BOLD,!!t[l.HM.BOLD]),r.setInputState(l.HM.ITALIC,!!t[l.HM.ITALIC]),r.setInputState(l.HM.UNDERLINE,!!t[l.HM.UNDERLINE]),r.setInputState(l.HM.STRIKETHROUGH,!!t.strikeThrough),r.setInputState(l.HM.FONT_FAMILY,(t.fontName||"").replace(/"|'/g,"")),r.setInputState(l.HM.FONT_SIZE,t.fontSize);var n=d.Cell.Format.colorUtils.colorValues(t.foreColor);n&&n.length>=3&&r.setInputState(l.HM.FONT_COLOR,d.Cell.Format.colorUtils.rgba2hex(n[0],n[1],n[2])),r.toolbarService.$forceUpdate()}}),100),this.handleEnterInput=function(){r.isEditing=!0,r.updateInputFormat(),r.toolbarService.$forceUpdate()},this.handleExitInput=function(){r.isEditing=!1,r.resetInputStyle()},this.initEvent()}var t=e.prototype;return t.isInputtingState=function(){var e=this.view.canvas.inputManager;return this.isEditing||e.isInputtingState()},t.getInputStateValue=function(e){return this.inputState[e]},t.checkInputAndFormat=function(e,t){var n=this.view.canvas.inputManager;return!!n.isInputtingState()&&(n.format(e,t),!0)},t.checkAndUndo=function(){var e=this.view.canvas.inputManager;return!!e.isInputtingState()&&(e.undo(),!0)},t.checkAndRedo=function(){var e=this.view.canvas.inputManager;return!!e.isInputtingState()&&(e.redo(),!0)},t.getCanUndo=function(){return this.view.canvas.inputManager.alloyRTE.canUndo()},t.getCanRedo=function(){return this.view.canvas.inputManager.alloyRTE.canRedo()},t.initEvent=function(){var e=this,t=this.view.canvas.inputManager;t.alloyRTE.on(t.alloyRTE.EVENT.FORMAT_CHANGE,(function(){return e.updateInputFormat()})),t.alloyRTE.on(t.alloyRTE.EVENT.SELECTION_CHANGE,(function(){return e.updateInputFormat()})),t.alloyRTE.on(t.alloyRTE.EVENT.UNDO_REDO_CHANGE,(function(){return e.updateInputFormat()})),t.emitter.on(t.EVENT.ENTER_INPUT,(function(){return e.handleEnterInput()})),t.emitter.on(t.EVENT.EXIT_INPUT,(function(){return e.handleExitInput()}))},t.setInputState=function(e,t){this.inputState[e]=t},t.resetInputStyle=function(){this.inputState={}},e}();v=m([(0,a.L)({adapters:[p.L]}),g(0,u.w),h("design:paramtypes",["function"===typeof(r="undefined"!==typeof u.w&&u.w)?r:Object,"function"===typeof(o="undefined"!==typeof i.O&&i.O)?o:Object,"function"===typeof(s="undefined"!==typeof c.n&&c.n)?s:Object])],v),t.Z="page-editor"==n.j?v:null},"../spread-sheet/src/core/workbench/interfaces/selection-service.interface.ts":function(e,t,n){n.d(t,{X:function(){return r}}),n("../node_modules/core-js/modules/es.symbol.js"),n("../node_modules/core-js/modules/es.symbol.description.js"),n("../node_modules/core-js/modules/es.object.to-string.js");var r=Symbol.for("ISelectionService")},"../spread-sheet/src/core/workbench/middleware/selection/selection-type.ts":function(e,t,n){var r;n.d(t,{R:function(){return r}}),function(e){e[e.ALL=0]="ALL",e[e.ROW=1]="ROW",e[e.DISCONTINUOUS_ROWS=2]="DISCONTINUOUS_ROWS",e[e.COL=3]="COL",e[e.DISCONTINUOUS_COLS=4]="DISCONTINUOUS_COLS",e[e.SINGLE_CELL=5]="SINGLE_CELL",e[e.MERGED_CELL=6]="MERGED_CELL",e[e.CONTINUOUS_MUTLI_CELLS=7]="CONTINUOUS_MUTLI_CELLS",e[e.DISCONTINUOUS_MUTLI_CELLS=8]="DISCONTINUOUS_MUTLI_CELLS",e[e.CHART=9]="CHART",e[e.SHAPE=10]="SHAPE"}(r||(r={}))},"../spread-sheet/src/external/rangeAuth/loader/RangeAuthManager.ts":function(e,t,n){n.d(t,{d:function(){return w}}),n("../node_modules/regenerator-runtime/runtime.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.promise.js"),n("../node_modules/core-js/modules/es.array.iterator.js"),n("../node_modules/core-js/modules/web.dom-collections.iterator.js"),n("../node_modules/core-js/modules/es.number.constructor.js"),n("../node_modules/core-js/modules/es.array.slice.js"),n("../node_modules/core-js/modules/es.function.name.js"),n("../node_modules/core-js/modules/es.array.from.js"),n("../node_modules/core-js/modules/es.string.iterator.js"),n("../node_modules/core-js/modules/es.symbol.js"),n("../node_modules/core-js/modules/es.symbol.description.js"),n("../node_modules/core-js/modules/es.symbol.iterator.js");var r=n("../node_modules/@babel/runtime/helpers/esm/inheritsLoose.js"),o=function(){},s=n("../spread-sheet/src/external/rangeAuth/util/range-auth-request-util.ts"),a=n("../spread-sheet/src/core/app/tool.ts"),i=n("../spread-sheet/src/base/util/appConfig.ts"),c=function(e){function t(){return e.apply(this,arguments)||this}return(0,r.Z)(t,e),t.prototype.getUserRangePrivilege=function(e){var t=a.Z.window.rangeAuthVars?a.Z.window.rangeAuthVars.rangeRev:"";return new Promise((function(r,o){$.ajax({url:"//"+i.Z.getConfig("runtime.domainName")+"/cgi-go/range_priv/get_user_range_privilege",type:"POST",xhrFields:{withCredentials:!0},data:{localPadId:window.clientVars.localPadId,type:1,domain:(0,s.MQ)(),rangeIdList:JSON.stringify(e),rangeRev:t,xsrf:a.Z.getXsrf()},success:function(e){var t,o;if("string"===typeof e)try{o=JSON.parse(e)}catch(s){null===(t=n.g.log)||void 0===t||t.error("rangeAuthRequestUtil.tempData.parse",null===s||void 0===s?void 0:s.stack),o={}}else o=e;r(o)},error:function(e){o(e)}})}))},t}(o),d=n("../node_modules/@tencent/docs_offline/lib/index.js"),u=n("../spread-sheet/src/core/data/configService/spreadConfig.ts"),l=n("../spread-sheet/src/external/rangeAuth/util/util.ts"),p=function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function a(e){try{c(r.next(e))}catch(t){s(t)}}function i(e){try{c(r.throw(e))}catch(t){s(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,i)}c((r=r.apply(e,t||[])).next())}))},f=function(e){function t(t){var n;return(n=e.call(this)||this).app=t,n}return(0,r.Z)(t,e),t.prototype.getUserRangePrivilege=function(e){var t=this;return new Promise((function(r,o){return p(t,void 0,void 0,regeneratorRuntime.mark((function t(){var s,a,i,c;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,null===(s=this.app.offlineOpen)||void 0===s?void 0:s.offlineDataManager.getHelper(d.Gk.EXCEL).getRangePrivilege(u.q.getConfig("globalPadId"),e);case 3:i=t.sent,t.next=11;break;case 6:return t.prev=6,t.t0=t.catch(0),o(t.t0),null===(a=n.g.log)||void 0===a||a.error("getRangePrivilege error",null===t.t0||void 0===t.t0?void 0:t.t0.stack,null===t.t0||void 0===t.t0?void 0:t.t0.message),t.abrupt("return");case 11:i.error&&o(i.error),c=(0,l.convertToServerRangePrivilege)(i.data.data),r({data:{isOwner:!1,rangeCheckResList:c},msg:"",retcode:0});case 14:case"end":return t.stop()}}),t,this,[[0,6]])})))}))},t}(o),m=n("../node_modules/@tencent/netcheck/lib/index.js"),h=n("../spread-sheet/src/external/rangeAuth/logic/check-user-auth.ts");function g(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){if(e){if("string"===typeof e)return v(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?v(e,t):void 0}}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0;return function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function v(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var y=function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function a(e){try{c(r.next(e))}catch(t){s(t)}}function i(e){try{c(r.throw(e))}catch(t){s(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,i)}c((r=r.apply(e,t||[])).next())}))},w=function(){function e(t){var r=this;if(this.updateLocalUserRangePrivilege=function(e){for(var t,o,s,a=[],i=g((0,l.getProtectedMap)().keys());!(s=i()).done;){var c=s.value;a.push(c)}try{null===(t=r.app.offlineOpen)||void 0===t||t.offlineDataManager.getHelper(d.Gk.EXCEL).cacheRangePrivilege(u.q.getConfig("globalPadId"),(0,l.convertToLocalRangePrivilege)(e),a)}catch(p){null===(o=n.g.log)||void 0===o||o.error("cacheRangePrivilege error",null===p||void 0===p?void 0:p.stack,null===p||void 0===p?void 0:p.message)}},this.app=t,e.instance)return e.instance;this.serverLoader=new c,this.offlineLoader=new f(t),e.instance=this}var t=e.prototype;return t.getUserRangePrivilege=function(e){return void 0===e&&(e=[]),y(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!window.__SUPPORT_FULL_OFFLINE_MODE||m.network.isOnline){t.next=4;break}return t.next=3,this.offlineLoader.getUserRangePrivilege(e);case 3:return t.abrupt("return",t.sent);case 4:return t.next=6,this.serverLoader.getUserRangePrivilege(e);case 6:return n=t.sent,this.updateLocalUserRangePrivilege(n.data.rangeCheckResList),t.abrupt("return",n);case 9:case"end":return t.stop()}}),t,this)})))},t.deleteRangeAuth=function(e){var t,r;try{null===(t=this.app.offlineOpen)||void 0===t||t.offlineDataManager.getHelper(d.Gk.EXCEL).deleteRangeAuth(u.q.getConfig("globalPadId"),e)}catch(o){null===(r=n.g.log)||void 0===r||r.error("deleteRangeAuth error",null===o||void 0===o?void 0:o.stack,null===o||void 0===o?void 0:o.message)}},t.isSheetRangeCanEdit=function(e){var t=this;return new Promise((function(r){var o=t.app.sheetStatus.workbookStatus.canEdit,s=(0,l.getExistSheetRangeIdItem)(e);s||r(o),u.q.getConfig("isOwner")&&r(o),t.getUserRangePrivilege([s]).then((function(e){var t,n;if(null===(n=null===(t=e.data)||void 0===t?void 0:t.rangeCheckResList)||void 0===n?void 0:n[0]){var o=e.data.rangeCheckResList[0],s=Number(o.rangePolicy||1),a=Number(o.rangePrivilege||0),i=(0,h.f)(s,a);r(i)}else r(!0)})).catch((function(e){var t;null===(t=n.g.log)||void 0===t||t.error("rangeAuth.util.util.isSheetRangeCanEdit",null===e||void 0===e?void 0:e.stack),r(o)}))}))},e}()},"../spread-sheet/src/external/rangeAuth/logic/check-user-auth.ts":function(e,t,n){n.d(t,{O:function(){return s},f:function(){return o}});var r=n("../spread-sheet/src/external/rangeAuth/config/auth-constant.ts");function o(e,t){return 0!==e&&r.Zx[e][t]}function s(e,t,n){return n!==r.mA.CAN_NOT_VIEW||0!==e&&r.q9[e][t]}},"../spread-sheet/src/external/rangeAuth/util/util.ts":function(e,t,n){n.r(t),n.d(t,{convertToLocalRangePrivilege:function(){return E},convertToServerRangePrivilege:function(){return I},getActiveSheetRangeIds:function(){return y},getCurrentSheetRangeIdsAndAllSheetRangeIds:function(){return h},getExistSheetRangeIdItem:function(){return g},getGridRangeByRangeId:function(){return _},getGridRangeListBySheetId:function(){return x},getNewRangeId:function(){return f},getProtectedMap:function(){return m},getRangeAuthInfo:function(){return i.ng},getRangeAuthListCrossGridRange:function(){return R},getRangeAuthListCrossSelectArea:function(){return S},getRangeIdByGridRange:function(){return j},getRangeIdsBySheetId:function(){return v},getSheetIdByRangeId:function(){return M},getWorkbookAuth:function(){return i.Vu},isGridRangeSetAuth:function(){return b},isRangeCountExceedMaxValue:function(){return C},isSheetRangeSetAuth:function(){return w},isWedocUpgradedSheet:function(){return T},parseGridRangeText:function(){return c.Pw},parseSelectDataForRangeAuth:function(){return c.rk},setRangeAuthInfo:function(){return i.Sh},setWorkbookAuth:function(){return i.QQ}}),n("../node_modules/core-js/modules/web.dom-collections.for-each.js"),n("../node_modules/core-js/modules/es.array.iterator.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/web.dom-collections.iterator.js"),n("../node_modules/core-js/modules/es.array.find-index.js"),n("../node_modules/core-js/modules/es.number.constructor.js"),n("../node_modules/core-js/modules/es.object.keys.js"),n("../node_modules/core-js/modules/es.regexp.exec.js"),n("../node_modules/core-js/modules/es.string.match.js"),n("../node_modules/core-js/modules/es.array.slice.js"),n("../node_modules/core-js/modules/es.function.name.js"),n("../node_modules/core-js/modules/es.array.from.js"),n("../node_modules/core-js/modules/es.string.iterator.js"),n("../node_modules/core-js/modules/es.symbol.js"),n("../node_modules/core-js/modules/es.symbol.description.js"),n("../node_modules/core-js/modules/es.symbol.iterator.js");var r=n("../node_modules/i18next/dist/esm/i18next.js"),o=n("../spread-sheet/src/core/app/tool.ts"),s=n("../packages/utils/src/index.ts"),a=n("../packages/model/src/range/GridRange.ts"),i=n("../spread-sheet/src/external/rangeAuth/util/range-auth-request-util.ts"),c=n("../spread-sheet/src/external/rangeAuth/util/range-auth-parse-util.ts"),d=n("../node_modules/@tencent/dui/lib/components/Snackbar/index.js"),u=n("../spread-sheet/src/core/data/configService/spreadConfig.ts");function l(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){if(e){if("string"===typeof e)return p(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?p(e,t):void 0}}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0;return function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function p(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function f(){return s.kk.getRandomId()}function m(){return n.g.SpreadsheetApp.spreadsheet.workbookRangeManager.protectedRangeMap}function h(e,t){var n={currentSheetRangeIds:[],allSheetRangeIds:[]};return t.forEach((function(t,r){t.range.isSheet?n.allSheetRangeIds.push(r):t.range.sheetId===e&&n.currentSheetRangeIds.push(r)})),n}function g(e){var t="";return m().forEach((function(n,r){if(n.range.isSheet&&n.range.sheetId===e)return t=r})),t}function v(e){var t=[],n="";return m().forEach((function(r,o){r.range.sheetId===e&&(r.range.isSheet?n=o:t.push(o))})),{rangeIds:t,sheetRangeId:n}}function y(){return v(o.Z.window.SpreadsheetApp.spreadsheet.activeSheetId)}function w(e){return!!g(e)}function j(e){for(var t,n="",r=l(m().entries());!(t=r()).done;){var o=t.value,s=o[0];if(o[1].range.contain(e)){n=s;break}}return n}function _(e){var t=new a.Z(o.Z.window.SpreadsheetApp.spreadsheet.activeSheetId),n=m().get(e);return void 0!==n&&(t=n.range.clone()),t}function x(e){var t=[];return m().forEach((function(n){n.range.sheetId===e&&t.push(n.range.clone())})),t}function b(e){return-1!==x(e.sheetId).findIndex((function(t){return t.isCross(e)}))}function R(e){var t=[];return m().forEach((function(n,r){var o=n.range;o.isCross(e)&&!o.isSheet&&t.push({rangeId:r,modifyTime:n.properties.modifyTime||0,gridRange:n.range.clone()})})),t}function S(){var e=(0,c.rk)(),t=e.gridRange,n=e.isSingleSelect;return t.isSheet||!n?[]:R(t)}function C(){var e=m().size>=2e3;return e&&d.default.show({type:"info",message:r.ZP.t("受保护范围已超过2000个上限，请取消部分保护范围后重试。"),autoClose:!0,style:{zIndex:10004}}),e}function E(e){var t={};return e.length&&e.forEach((function(e){t[e.rangeId]=[e.rangePolicy,e.rangePrivilege,Number(e.setUid),e.uintype,e.rangeOtherPrivilegeType]})),t}function I(e){var t=[];return Object.keys(e).forEach((function(n){t.push({rangeId:n,rangePolicy:e[n][0],rangePrivilege:e[n][1],setUid:""+e[n][2],uintype:e[n][3],rangeOtherPrivilegeType:e[n][4]})})),t}function M(e,t){var n;return null===(n=t.get(e))||void 0===n?void 0:n.range.sheetId}function T(){return(u.q.getConfig("padId")||"").match(/^e2_/)}},"../spread-sheet/src/external/sync-guide/cgi.ts":function(e,t,n){n.d(t,{Ll:function(){return i},Qe:function(){return c}}),n("../node_modules/regenerator-runtime/runtime.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.promise.js");var r=n("./node_modules/axios/index.js"),o=n.n(r),s=n("../spread-sheet/src/external/sync-guide/common.ts"),a=function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function a(e){try{c(r.next(e))}catch(t){s(t)}}function i(e){try{c(r.throw(e))}catch(t){s(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,i)}c((r=r.apply(e,t||[])).next())}))};function i(e){var t,r,i,c;return a(this,void 0,void 0,regeneratorRuntime.mark((function a(){var d,u,l,p;return regeneratorRuntime.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,o().post("/v2/enterprise/communication/get",{toggle_type:e.toggleType,file_id:e.fileId});case 3:if(d=a.sent,0!==(null===(t=null===d||void 0===d?void 0:d.data)||void 0===t?void 0:t.retcode)){a.next=13;break}if(u=d.data.result,l=u.toggleOn,p=u.toggleScope,!1!==l){a.next=9;break}return a.abrupt("return",s.wR.OFF);case 9:if(!0!==l||p!==s.wR.ALL){a.next=11;break}return a.abrupt("return",s.wR.ALL);case 11:if(!0!==l||p!==s.wR.SINGLE){a.next=13;break}return a.abrupt("return",s.wR.SINGLE);case 13:return null===(r=n.g.log)||void 0===r||r.info("getEntCommunicationToggle sync fail("+(null===(i=null===d||void 0===d?void 0:d.data)||void 0===i?void 0:i.retcode)+")"),a.abrupt("return",s.wR.OFF);case 17:return a.prev=17,a.t0=a.catch(0),null===(c=n.g.log)||void 0===c||c.info("getEntCommunicationToggle sync error("+a.t0+")"),a.abrupt("return",s.wR.OFF);case 21:case"end":return a.stop()}}),a,null,[[0,17]])})))}function c(e){var t=this;return new Promise((function(r,s){return a(t,void 0,void 0,regeneratorRuntime.mark((function t(){var a,i,c,d,u,l,p;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,o().post("/v2/enterprise/communication/set",{toggle_type:e.toggleType,toggle_scope:e.toggleScope,toggle_on:e.toggleOn,file_id:e.fileId||""});case 3:if(p=t.sent,0===(null===(a=null===p||void 0===p?void 0:p.data)||void 0===a?void 0:a.retcode)){t.next=7;break}return null===(i=n.g.log)||void 0===i||i.info("setEntCommunicationToggle sync fail("+(null===(c=null===p||void 0===p?void 0:p.data)||void 0===c?void 0:c.retcode)+")"),t.abrupt("return",s(null===(d=null===p||void 0===p?void 0:p.data)||void 0===d?void 0:d.retcode));case 7:return t.abrupt("return",r(null===(u=null===p||void 0===p?void 0:p.data)||void 0===u?void 0:u.retcode));case 10:return t.prev=10,t.t0=t.catch(0),null===(l=n.g.log)||void 0===l||l.info("setEntCommunicationToggle sync error("+t.t0+")"),t.abrupt("return",s(-1));case 14:case"end":return t.stop()}}),t,null,[[0,10]])})))}))}},"../spread-sheet/src/external/view/common/view-abtest.ts":function(e,t,n){n.d(t,{PA:function(){return d},c6:function(){return a},cp:function(){return u}}),n("../node_modules/regenerator-runtime/runtime.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.promise.js");var r,o=n("../node_modules/@tencent/facade-config/dist/index.js"),s=function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function a(e){try{c(r.next(e))}catch(t){s(t)}}function i(e){try{c(r.throw(e))}catch(t){s(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,i)}c((r=r.apply(e,t||[])).next())}))},a="txdoc_sheet_newcolourdisk",i={},c={appid:"170002",disableLocalStorage:!1};function d(e){return JSON.stringify(i[e])}function u(){return 2717096===(null===r||void 0===r?void 0:r.grayId)}o.default.initTabExp(c),setTimeout((function(){!function(e){var t;s(this,void 0,void 0,regeneratorRuntime.mark((function s(){return regeneratorRuntime.wrap((function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,o.default.tab.getRemoteExp(e);case 2:r=s.sent,i[e]={abtest_id:a,gray_id:r.grayId},null===(t=n.g.log)||void 0===t||t.info("TAB_EXP:"+a+" grayid:"+r.grayId);case 5:case"end":return s.stop()}}),s)})))}(a)}),5e3)},"../spread-sheet/src/external/view/main/panel/chartPanel/redux/interface.ts":function(e,t,n){var r;n.d(t,{o:function(){return r}}),function(e){e[e.RESET_STATE=0]="RESET_STATE",e[e.UPDATE_STATE=1]="UPDATE_STATE"}(r||(r={}))},"../spread-sheet/src/external/view/main/panel/chartPanel/redux/reducer.ts":function(e,t,n){n.d(t,{Z:function(){return c},_:function(){return i}}),n("../node_modules/core-js/modules/es.object.assign.js");var r=n("../packages/model/src/new-embedded/chart/ChartType.ts"),o=n("../spread-sheet/src/external/view/main/panel/chartPanel/redux/interface.ts"),s=n("../packages/model/src/new-embedded/chart/GridChartOptions.ts"),a=function(){return{type:r.Z.COLUMN_CHART,range:"",title:{text:""},subTitle:{text:""},asLegendIndex:0,asXAxisIndex:0,legendIndex:0,xAxisIndex:0,shouldTranspose:!1,shouldShowDataLabel:!1,stackingType:s.o.NONE}},i=a();function c(e,t){void 0===e&&(e=i);var n=Object.assign({},e),r=t.type,s=t.payload;switch(r){case o.o.RESET_STATE:return a();case o.o.UPDATE_STATE:return function(e,t){return Object.assign(Object.assign({},e),t)}(e,s)}return n}},"../spread-sheet/src/external/view/main/panel/chartPanel/util/chartConfig.ts":function(e,t,n){n.d(t,{c:function(){return o},u:function(){return r}});var r=30,o=40},"../spread-sheet/src/external/view/main/panel/chartPanel/util/chartUtils.ts":function(e,t,n){n.d(t,{VT:function(){return g},FJ:function(){return y},IM:function(){return h},aC:function(){return m}}),n("../node_modules/core-js/modules/es.object.assign.js"),n("../node_modules/core-js/modules/es.object.keys.js");var r=n("../packages/model/src/new-embedded/chart/ChartType.ts"),o=n("../packages/model/src/range/GridRange.ts"),s=n("../packages/model/src/range/hexRangeUtils.ts"),a=n("../spread-sheet/src/core/view/level-2/chart/charts/transform/transform.ts"),i=n("../packages/model/src/new-embedded/chart/AnnotationOptions.ts"),c=n("../spread-sheet/src/external/view/main/panel/chartPanel/util/chartConfig.ts"),d=(n("../node_modules/core-js/modules/es.array.fill.js"),n("../node_modules/core-js/modules/es.array.map.js"),n("../packages/model/src/cell/format/NumberFormatType.ts")),u=n("../packages/common-utils/src/index.ts"),l=n("../spread-sheet/src/core/view/level-2/chart/charts/transform/transform-datas.ts");function p(e,t){if(!t.isValid())return{asLegendIndex:-1,asXAxisIndex:-1,shouldTranspose:!1};var n=e.sheetManager.getSheetBySheetId(t.sheetId);if(!n)return console.error("图表获取渲染数据, 表格 "+t.sheetId+" 不存在"),{asLegendIndex:-1,asXAxisIndex:-1,shouldTranspose:!1};var r=t.clone(),o=[r.endRowIndex,r.endColIndex],s=o[0],a=o[1],i=[r.startRowIndex,r.startColIndex],c=i[0],p=i[1];s=Math.min(s,n.getRowCount()-1),a=Math.min(a,n.getColCount()-1),r.endRowIndex=s,r.endColIndex=a;var f=s-c+1,m=a-p+1,h=function(e,t){var n=[t.sheetId,t.startRowIndex,t.endRowIndex,t.startColIndex,t.endColIndex],r=n[0],o=n[1],s=n[2],a=n[3],i=n[4],c=e.sheetManager.getSheetBySheetId(r);if(!c)return console.error("图表获取渲染数据, 表格 "+r+" 不存在"),{renderDatas:[[]],cellDatas:[[]]};for(var l=i-a+1,p=function(e){var t={},n={},r=e.data,o=r.rowMetadata,s=r.colMetadata;return o&&(t=o.reduce((function(e,t,n){return t&&(t.hiddenByUser||t.hiddenByFilter)?Object.assign(Object.assign({},e),((r={})[n]=!0,r)):e;var r}),{})),s&&(n=s.reduce((function(e,t,n){return t&&(t.hiddenByUser||t.hiddenByFilter)?Object.assign(Object.assign({},e),((r={})[n]=!0,r)):e;var r}),{})),{hiddenRowMap:t,hiddenColMap:n}}(c),f=p.hiddenRowMap,m=p.hiddenColMap,h=[],g=[],v=o;v<=s;v++){var y=[],w=[];if(f[v])h.push(Array(l).fill("")),g.push(Array(l).fill(null));else{for(var j=a;j<=i;j++)if(m[j])y.push(""),w.push(null);else{var _=c.getCellDataAtPosition(v,j);if(w.push(_),_){var x=_.getUserEnteredFormat();if(x){var b=x.getNumberFormat();if(b){var R=b.type;if(R===d.Z.TIME){y.push("");continue}if(R===d.Z.TEXT){y.push(_.getEditValue()||"");continue}}}var S=_.getEffectiveValue();if(S){var C=S.value;(0,u.hj)(C)||(0,u.HD)(C)?y.push(C):((0,u.Kn)(C),y.push(""))}else y.push("")}else y.push("")}h.push(y),g.push(w)}}return{renderDatas:h,cellDatas:g}}(e,r),g=h.renderDatas,v=h.cellDatas,y=function(e,t,n){for(var r={},o={},s=0;s<t;s++)e[s].reduce((function(e,t){return!((0,u.hj)(t)||t.length>0)&&e}),!0)||(r[s]=!0);for(var a=function(t){e.map((function(e){return e[t]})).reduce((function(e,t){return!((0,u.hj)(t)||t.length>0)&&e}),!0)||(o[t]=!0)},i=0;i<n;i++)a(i);return{renderRowMap:r,renderColMap:o}}(g,f,m),w=y.renderRowMap,j=y.renderColMap,_=(0,l.qS)({renderDatas:g,cellDatas:v,renderRowMap:w,renderColMap:j,rowCount:f,colCount:m}).renderDatas;if((0,l.xP)(_))return{asLegendIndex:-1,asXAxisIndex:-1,shouldTranspose:!1};var x=function(e){var t=e.renderDatas,n=-1,r=-1;(0,l.VJ)(t[0])&&(n=0);var o=t.map((function(e){return e[0]}));return(0,l.VJ)(o)&&(r=0),{asLegendIndex:n,asXAxisIndex:r}}({renderDatas:_}),b=x.asLegendIndex,R=x.asXAxisIndex,S=!function(e){var t=e.length,n=e[0].length;(0,l.VJ)(e[0])&&(t-=1);var r=e.map((function(e){return e[0]}));return(0,l.VJ)(r)&&(n-=1),t>n}(_);if(S){var C=[R,b];b=C[0],R=C[1]}return{asLegendIndex:b,asXAxisIndex:R,shouldTranspose:S}}var f=n("../spread-sheet/src/external/view/main/panel/chartPanel/redux/reducer.ts");function m(e,t){var n=function(e,t){var n=t.getSelectionWithGridRanges();return 0===n.rangeSelections.length?new o.Z(e.activeSheetId,0,0,0,0):n.rangeSelections[n.rangeSelections.length-1]}(e,t),r=function(e,t){return(0,s.range2RelativeHex)(e,t)||""}(n,e.activeSheet),a=p(e,n),i=a.asLegendIndex,c=a.asXAxisIndex,d=a.shouldTranspose,u=n.startRowIndex,l=n.startColIndex;if(d){var m=[l,u];u=m[0],l=m[1]}return Object.assign(Object.assign({},f._),{range:r,asLegendIndex:i,asXAxisIndex:c,shouldTranspose:d,legendIndex:u,xAxisIndex:l,shouldShowDataLabel:!1})}function h(e,t){var n,o,c,d,u,l,p,f,m=e.spreadsheet.embeddedObjectManager.getEmbeddedObject(t);if(!m)return null;var h=m.properties.chart;if(!h)return null;var g=e.spreadsheet.workbookRangeManager.getChartWorkbookRangeById(h.workbookRangeId[0]);if(!g)return null;var v=h.chartModel.type||r.Z.COLUMN_CHART,y=(0,s.range2RelativeHex)(g.range,e.spreadsheet.sheetManager.getSheetBySheetId(g.range.sheetId));g.range.sheetId!==e.spreadsheet.activeSheetId&&(y=e.spreadsheet.sheetManager.getSheetTitleBySheetId(g.range.sheetId)+"!"+y),g.range.isValid()||(y="");var w=(null===(o=null===(n=h.chartModel.commonOptions)||void 0===n?void 0:n.title)||void 0===o?void 0:o.text)||"",j=(null===(d=null===(c=h.chartModel.commonOptions)||void 0===c?void 0:c.subTitle)||void 0===d?void 0:d.text)||"",_=h.headers,x=h.dataTransformation,b=(0,a.eo)(_,null===(u=null===x||void 0===x?void 0:x.colInfo)||void 0===u?void 0:u.columnIndex),R=b.asLegendIndex,S=b.asXAxisIndex,C=g.range.startRowIndex,E=g.range.startColIndex,I=!!h.transpose,M=h.chartModel,T=(null===(p=null===(l=M.gridChartOptions)||void 0===l?void 0:l.totalAnnotations)||void 0===p?void 0:p.type)===i.Mc.DATA,O=null===(f=M.gridChartOptions)||void 0===f?void 0:f.stackingType;if(I){var D=[E,C];C=D[0],E=D[1]}return{type:v,range:y,title:{text:w},subTitle:{text:j},asLegendIndex:R,asXAxisIndex:S,legendIndex:C,xAxisIndex:E,shouldTranspose:I,shouldShowDataLabel:T,stackingType:O}}function g(e,t){return!v(e,t)}function v(e,t){return Object.keys(e).reduce((function(n,r){if(!n)return!1;if(!Object.prototype.hasOwnProperty.call(t,r))return!1;var o=e[r],s=t[r];return typeof o===typeof s&&("object"===typeof o&&"object"===typeof s?v(o,s):o===s&&n)}),!0)}function y(e,t,n){return t?((0,s.isValidHexRangeWhetherCrossTable)(e.range,n)||0===e.range.length||(e.range=t.range),e.title.text.length>c.u&&(e.title.text=t.title.text),e.subTitle.text.length>c.c&&(e.subTitle.text=t.subTitle.text),e):e}},"../spread-sheet/src/external/view/main/panel/dataValidationPanelNew/utils.ts":function(e,t,n){n.d(t,{A3:function(){return g},MR:function(){return h},Su:function(){return v},qT:function(){return y},xK:function(){return m},xk:function(){return j}}),n("../node_modules/core-js/modules/es.array.includes.js"),n("../node_modules/core-js/modules/es.string.includes.js"),n("../node_modules/core-js/modules/es.array.map.js"),n("../node_modules/core-js/modules/es.regexp.exec.js"),n("../node_modules/core-js/modules/es.string.split.js");var r,o,s=n("../packages/model/src/range/hexRangeUtils.ts"),a=n("../packages/model/src/range/index.ts"),i=(n("../spread-sheet/src/core/view/spreadsheet-view/row-cover-accessor/utils.ts"),n("../spread-sheet/src/core/data/configService/spreadConfig.ts")),c=n("../packages/model/src/cell/metadata/CustomDataType.ts"),d=n("../spread-sheet/src/core/feature/dataValidation/constant.ts"),u=n("../spread-sheet/src/core/feature/dataValidation/api/DataValidationUIUtils.ts"),l=n("../packages/report/src/index.ts"),p=n("../packages/model/src/cell/data-validation/index.ts"),f=((r={})[p.uN.LIST]=d.cM.SELECT,r[p.uN.NUMBER_INT]=d.cM.NUMBER,r[p.uN.NUMBER_FLOAT_AND_INT]=d.cM.NUMBER,r[p.uN.CUSTOM_MUST_FLOAT]=d.cM.NUMBER,r[p.uN.TEXT_LENGTH]=d.cM.TEXT,r[p.uN.CUSTOM_TEXT_CONTAINS]=d.cM.TEXT,r[p.uN.DATE]=d.cM.DATE_TIME,r[p.uN.CUSTOM_STAR]=d.cM.STAR,r[p.uN.CUSTOM_CHECKBOX]=d.cM.CHECKBOX,r[p.uN.CUSTOM_PROGRESS]=d.cM.PROGRESS,r[p.uN.CUSTOM_ID_CARD]=d.cM.ID_CARD,r[p.uN.CUSTOM_NUM_PHONE]=d.cM.PHONE_NUMBER,r[p.uN.CUSTOM_NUM_TEL]=d.cM.TELEPHONE_NUMBER,r[p.uN.CUSTOM_TEXT_MAIL]=d.cM.EMAIL,r[p.uN.CUSTOM_NUMBER_TEMPERATURE]=d.cM.TEMPERATURE,r[p.uN.CUSTOM_CONTACT]=null,r[p.uN.CUSTOM_ATTACHMENT]=null,r[p.uN.CUSTOM]=null,r[p.uN.CUSTOM_TEXT_URL]=null,r[p.uN.CUSTOM_TEXT_GENDER]=null,r),m=((o={})[c.ZP.SELECT]=d.cM.SELECT,o[c.ZP.CHECKBOX]=d.cM.CHECKBOX,o[c.ZP.STAR]=d.cM.STAR,o[c.ZP.PROGRESS]=d.cM.PROGRESS,o[c.ZP.ID]=d.cM.ID_CARD,o[c.ZP.PHONE_NUM]=d.cM.PHONE_NUMBER,o[c.ZP.TELEPHONE_NUM]=d.cM.TELEPHONE_NUMBER,o[c.ZP.EMAIL]=d.cM.EMAIL,o[c.ZP.NUMBER]=d.cM.NUMBER,o[c.ZP.TEXT]=d.cM.TEXT,o[c.ZP.DATE_TIME]=d.cM.DATE_TIME,o[c.ZP.TEMPERATURE]=d.cM.TEMPERATURE,o[c.ZP.IMAGE]=null,o[c.ZP.ATTACHMENT]=null,o[c.ZP.CONTACT]=null,o[c.ZP.DATE_REMINDER]=null,o[c.ZP.GROUP_CARD]=null,o[c.ZP.MINI_APP]=null,o[c.ZP.SCHEDULE]=null,o[c.ZP.STAFF_CARD]=null,o[c.ZP.THIRD_PARTY_APP]=null,o[c.ZP.TODO]=null,o);function h(e,t){var n=null;return t&&(n=m[t.customDataType]),!n&&e&&(n=f[e.ruleType]),n}var g,v=function(e){var t=i.q.getConfig("isOwner")&&null!==e&&[d.cM.ID_CARD,d.cM.PHONE_NUMBER,d.cM.TELEPHONE_NUMBER,d.cM.EMAIL].includes(e);return e&&l.ZP.tdwReport({opername:"doc_excel",module:"privacy_fill",action:t?"view_on":"view_off",ver6:String(e)}),t};!function(e){e[e.CELL=0]="CELL",e[e.KEEP_COL=1]="KEEP_COL"}(g||(g={}));var y=function(e,t,n){return void 0===n&&(n=g.KEEP_COL),t.split(",").map((function(t){var r=(0,s.getRangeInfoFormHexRange)(e,t),o=r.sheetId,a=r.rangeString,i=o||e.getActiveSheetId();return w(e,(0,s.hex2Range)(a,i),n)}))},w=function(e,t,n){var r=e.sheetManager.getSheetBySheetId(t.sheetId);if(!r)return t;var o=r.getColCount()-1,s=r.getRowCount()-1;if(n===g.KEEP_COL&&t.isCol&&t.isValid(o,s))return t;var i=t.clampToSheetSize(r),c=i.startRowIndex,d=i.endRowIndex,u=i.startColIndex,l=i.endColIndex;return c=Math.max(0,c),d=Math.min(s,d),u=Math.max(0,u),l=Math.min(o,l),new a.GridRange(i.sheetId,c,d,u,l)},j=function(e){var t;e&&(l.ZP.tdwReport({opername:"doc_validation",module:"data_validation",action:"set_validation",ver10:(null===(t=(0,u.aW)(e.dvRuleType||""))||void 0===t?void 0:t.validType)||""}),e.isStrict&&l.ZP.tdwReport({opername:"doc_validation",module:"data_validation",action:"no_inter_toast"}),e.customInputTip&&l.ZP.tdwReport({opername:"doc_validation",module:"data_validation",action:"validation_toast"}),l.ZP.tdwReport({opername:"doc_validation",module:"data_validation",action:"validation_activedoc"}))}},"../spread-sheet/src/external/view/main/toolbar/defaultHook.ts":function(e,t,n){n("../node_modules/regenerator-runtime/runtime.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.promise.js");var r=n("../spread-sheet/src/core/view/level-2/search-replace2/panel/pc/search-replace-modal.tsx"),o=function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function a(e){try{c(r.next(e))}catch(t){s(t)}}function i(e){try{c(r.throw(e))}catch(t){s(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,i)}c((r=r.apply(e,t||[])).next())}))},s={doInsertDateReminder:function(e){var t,n;null===(n=null===(t=null===e||void 0===e?void 0:e.canvas)||void 0===t?void 0:t.dateReminderCenter)||void 0===n||n.clickCreateDateReminder("toolbar")},doInsertStaffCard:function(e){var t;null===(t=null===e||void 0===e?void 0:e.canvas.weworkComponentCenter)||void 0===t||t.insertStaffCard()},doInsertGroupCard:function(e){var t;null===(t=null===e||void 0===e?void 0:e.canvas.weworkComponentCenter)||void 0===t||t.insertGroupCard()},doInsertSchedule:function(e,t){var n;null===(n=null===e||void 0===e?void 0:e.canvas.weworkComponentCenter)||void 0===n||n.insertSchedule(t)},doInsertToto:function(e){var t;null===(t=null===e||void 0===e?void 0:e.canvas.todoCenter)||void 0===t||t.openEditPanelForInsert()},doInsertApp:function(e){var t;null===(t=null===e||void 0===e?void 0:e.canvas.weworkComponentCenter)||void 0===t||t.insertApp()},doClickComment:function(e){var t,n=e.canvas.normalSelectData.activeRow,r=e.canvas.normalSelectData.activeCol;n<0||r<0||null===(t=e.canvas.commentCenter)||void 0===t||t.openComment(n,r)},doClickSearch:function(e){var t;null===(t=e.canvas.searchReplaceCenter)||void 0===t||t.show(r.N.BASIC_SEARCH)},doShowFormatPanel:function(e){return o(void 0,void 0,void 0,regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.getCustomFormatPanel();case 2:if(t.t1=n=t.sent,t.t0=null===t.t1,t.t0){t.next=6;break}t.t0=void 0===n;case 6:if(!t.t0){t.next=10;break}t.next=11;break;case 10:n.show();case 11:case"end":return t.stop()}}),t)})))},doClickValidation:function(e){return o(void 0,void 0,void 0,regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.getDataValidationPanel();case 2:if(t.t1=n=t.sent,t.t0=null===t.t1,t.t0){t.next=6;break}t.t0=void 0===n;case 6:if(!t.t0){t.next=10;break}t.next=11;break;case 10:n.create();case 11:case"end":return t.stop()}}),t)})))},doClickMoreFormula:function(e,t,n){return o(void 0,void 0,void 0,regeneratorRuntime.mark((function r(){var o;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,e.getFormulaEditorPanel();case 2:(o=r.sent)&&(o.isShow()?(o.hide(),null===n||void 0===n||n()):(o.show(),null===t||void 0===t||t()));case 4:case"end":return r.stop()}}),r)})))},doFormulaDropdown:function(e){return o(void 0,void 0,void 0,regeneratorRuntime.mark((function t(){var n,r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.getFormulaEditorPanel();case 2:r=t.sent,null===(n=null===r||void 0===r?void 0:r.gethistory)||void 0===n||n.call(r);case 4:case"end":return t.stop()}}),t)})))},doClickSort:function(e,t){return o(void 0,void 0,void 0,regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,e.getSortRangePanel();case 2:n.sent.doSort(t);case 3:case"end":return n.stop()}}),n)})))}};t.Z="page-editor"==n.j?s:null},"../spread-sheet/src/external/view/schema/contextmenu-key.ts":function(e,t,n){var r;n.d(t,{B:function(){return r}}),function(e){e.CUT="cut",e.COPY="copy",e.PASTE="paste",e.DIVIDER="divider",e.MORE_OPERATE="more-operate",e.PASTE_SPECIAL="paste-special",e.KEEP_DEFAULT="keep-default",e.MERGE_STYLES="merge-styles",e.ONLY_VALUES="only-values",e.TRANSPOSE="transpose",e.CLEAR_AUTO_PARSE="clear-auto-parse",e.PASTE_SPECIAL_HELP="paste-special-help",e.INSERT_CUT_CELLS="insert-cut-cells",e.INSERT_COPY_CELLS="insert-copy-cells",e.INSERT="insert",e.INSERT_LINK="insert-link",e.INSERT_COMMENT="insert-comment",e.INSERT_COMMENT_ENT="insert-comment-ent",e.INSERT_CELL_PICTURE="insert-cell-picture",e.INSERT_ATTACHMENT="insert-attachment",e.CLEAR="clear",e.CLEAR_FORMAT="clear-format",e.CLEAR_CONTENT="clear-content",e.DATA_VALIDATION="data-validation",e.SMART_SPLIT="smart_split",e.NUMBER_FORMAT="number-format",e.DELETE_RANGE="delete-range",e.DELETE_RANGE_LEFT="delete-range-left",e.DELETE_RANGE_UP="delete-range-up",e.HYPERLINK_ICON_VISIBILITY="hyperlink-icon-visibility",e.HYPERLINK_ICON_INVISIBLE="hyperlink-icon-invisible",e.HYPERLINK_ICON_VISIBLE="hyperlink-icon-visible",e.INSERT_RANGE="insert-range",e.INSERT_RANGE_RIGHT="insert-range-right",e.INSERT_RANGE_DOWN="insert-range-down",e.MERGE_CELLS="merge-cells",e.UNMERGE_CELLS="unmerge-cells",e.PROTECT_SELECTED_RANGE="protect-selected-range",e.PROTECTED_RANGE_LIST="protected-range-list",e.EXPORT_FILE="export-file",e.CONVERT_IMAGE="convert-image",e.CONVERT_FLOAT_IMAGE="convert-float-image",e.CONVERT_CELL_IMAGE="convert-cell-image",e.CHART_DELETE="chart_delete",e.CHART_EDIT="chart_edit",e.CHART_TO_IMAGE="chart_to_image",e.FLOAT_IMG_CUT="float-img-cut",e.FLOAT_IMG_COPY="float-img-copy",e.FLOAT_IMG_CROP="float-img-crop",e.FLOAT_IMG_RESET="float-img-reset",e.FLOAT_IMG_TO_CELL_IMG="float-img-to-cell-img",e.FLOAT_IMG_DELETE="float-img-delete-img",e.INSERT_ROW_COL="insert-row-col",e.INSERT_ROW_ABOVE="insert-row-above",e.INSERT_ROW_BELOW="insert-row-below",e.INSERT_COPY_ROW="insert-copy-row",e.INSERT_CUT_ROW="insert-cut-row",e.DELETE_ROW="delete-row",e.FREEZE_ROW="freeze-row",e.CANCEL_FREEZE_ROW="cancel-freeze-row",e.SET_ROW_HEIGHT="set-row-height",e.HIDE_ROW="hide-row",e.CANCEL_HIDE_ROW="cancel-hide-row",e.ROW_OPERATE="row-operate",e.QUICK_FILL_ROW="quick-fill-row",e.INSERT_COL_LEFT="insert-col-left",e.INSERT_COL_RIGHT="insert-col-right",e.INSERT_COPY_COL="insert-copy-col",e.INSERT_CUT_COL="insert-cut-col",e.DELETE_COL="delete-col",e.FREEZE_COL="freeze-col",e.CANCEL_FREEZE_COL="cancel-freeze-col",e.SET_COL_WIDTH="set-col-width",e.HIDE_COL="hide-col",e.CANCEL_HIDE_COL="cancel-hide-col",e.COL_OPERATE="col-operate",e.EDIT="edit",e.CELL_OPERATE="cell-operate",e.COMMENT="comment",e.SMART_DRAG="mobile-context-menu-smart-drag",e.RESET_IMG="reset-img",e.TO_FLOAT_IMG="to-float-img",e.DIAL_NUMBER="dial-number",e.RANGE_TO_IMAGE_COPY="range-to-image-copy",e.LINK_RANGE="link-range",e.TODO_DONE="todo-done",e.TODO_UNDONE="todo-undone",e.CONVERT_TO_SMART_SHEET="convert-to-smart-sheet"}(r||(r={}))},"../spread-sheet/src/external/view/schema/mobile-menu-schema.ts":function(e,t,n){var r;n.d(t,{d:function(){return r}}),function(e){e.EXPORT_EXCEL="exportAs",e.CREATE_COPY="clone",e.RENAME_DOC="rename-doc",e.COPY_LINK="copyLink",e.SAVE_AS_TEMPLATE="saveTemplate",e.HELP_AND_FEEDBACK="helpCenter",e.HELP_AND_FEEDBACK_ABOUT="help-and-feedback-sub-about",e.HELP_AND_FEEDBACK_SUBSCRIBE="help-and-feedback-sub-subscribe",e.HELP_AND_FEEDBACK_HELP="help-and-feedback-sub-help",e.HELP_AND_FEEDBACK_TUCAO="help-and-feedback-sub-tucao",e.HELP_AND_FEEDBACK_REPORT="help-and-feedback-sub-report",e.HELP_AND_FEEDBACK_APPEAL="help-and-feedback-sub-appeal",e.HELP_AND_FEEDBACK_TEMPLATE="help-and-feedback-sub-about-template",e.HELP_AND_FEEDBACK_VERSION="help-and-feedback-sub-version",e.COMPLAINTS="complaints",e.SYNC_GUIDE="sync-guide",e.SYNC_GUIDE_OFF="sync-guide-off",e.SYNC_GUIDE_SINGLE="sync-guide-single",e.SYNC_GUIDE_ALL="sync-guide-all",e.FORM_CHECK="checkForm",e.FORM_CREATE_NEW="createForm",e.FORM_CANCEL="cancelForm",e.OFFLINE_EDIT="offline-edit",e.FILE_INFO="docCreateInfo",e.FIND="find",e.FIND_REPLACE="find-replace",e.FIND_REPLACE_SUB_FIND="find-replace-sub-find",e.FIND_REPLACE_SUB_REPLACE="find-replace-sub-replace",e.READ_RECORD="visitHistory",e.MOVE_TO="moveTo",e.SEND_TO_PC="sendToPc",e.AUTH="setAuth",e.APPLY_AUTH="applyAuth",e.EDIT_HISTORY="edit-history",e.DIAL_NUMBER="dial-number",e.SMART_SHEET_FIND="smart-sheet|find",e.SMART_SHEET_FIND_REPLACE="smart-sheet|find-replace",e.SMART_SHEET_FIND_REPLACE_SUB_FIND="smart-sheet|find-replace-sub-find",e.SMART_SHEET_FIND_REPLACE_SUB_REPLACE="smart-sheet|find-replace-sub-replace"}(r||(r={}));var o=["more-menu-header",{type:"horizontal",members:[r.EXPORT_EXCEL,r.CREATE_COPY,r.SEND_TO_PC]},{members:[r.AUTH,r.APPLY_AUTH]},{members:[r.COPY_LINK]},{members:[r.MOVE_TO,r.RENAME_DOC,r.SAVE_AS_TEMPLATE,{key:r.FIND_REPLACE,items:[r.FIND_REPLACE_SUB_FIND,r.FIND_REPLACE_SUB_REPLACE]},{key:r.SMART_SHEET_FIND_REPLACE,items:[r.SMART_SHEET_FIND_REPLACE_SUB_FIND,r.SMART_SHEET_FIND_REPLACE_SUB_REPLACE]},r.OFFLINE_EDIT,r.FIND,r.SMART_SHEET_FIND,r.EDIT_HISTORY,r.READ_RECORD,r.FORM_CREATE_NEW,r.FORM_CHECK,r.FORM_CANCEL,r.FILE_INFO]},{members:[{key:r.HELP_AND_FEEDBACK,items:["help-and-feedback-sub",r.HELP_AND_FEEDBACK_ABOUT,r.HELP_AND_FEEDBACK_SUBSCRIBE,r.HELP_AND_FEEDBACK_HELP,r.HELP_AND_FEEDBACK_TUCAO,r.HELP_AND_FEEDBACK_REPORT,r.HELP_AND_FEEDBACK_APPEAL,r.HELP_AND_FEEDBACK_TEMPLATE,r.HELP_AND_FEEDBACK_VERSION]}]}];t.Z="page-editor"==n.j?o:null},"../spread-sheet/src/external/view/ui-layer/accessibility/accessibility-feature.ts":function(e,t,n){n.r(t),n.d(t,{AccessibilityFeature:function(){return p}}),n("../node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),n("../node_modules/core-js/modules/esnext.reflect.metadata.js");var r,o=n("../node_modules/@tencent/workbench/lib/esm/decorators/class/feature.js"),s=n("../spread-sheet/src/core/app/SpreadsheetApp.interface.ts"),a=n("../spread-sheet/src/adapter/SpreadSheetAppAdapter.ts"),i=n("../spread-sheet/src/core/view/level-2/accessibility/Accessibility.tsx"),c=n("../node_modules/i18next/dist/esm/i18next.js"),d=function(e,t,n,r){var o,s=arguments.length,a=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var i=e.length-1;i>=0;i--)(o=e[i])&&(a=(s<3?o(a):s>3?o(t,n,a):o(t,n))||a);return s>3&&a&&Object.defineProperty(t,n,a),a},u=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},l=function(e,t){return function(n,r){t(n,r,e)}},p=function(){function e(e){this.app=e}var t=e.prototype;return t.handleClick=function(){this.app.view.canvas.accessibility.toggleA11Y()},t.getContent=function(){return i.default.isA11yEnabled()?c.ZP.t("关闭无障碍读屏"):c.ZP.t("开启无障碍读屏")},e}();p=d([(0,o.L)({adapters:[a.L],name:"AccessibilityFeature"}),l(0,s.m),u("design:paramtypes",["function"===typeof(r="undefined"!==typeof s.m&&s.m)?r:Object])],p)},"../spread-sheet/src/external/view/ui-layer/add-member-ent/add-member-feature.ts":function(e,t,n){n.r(t),n.d(t,{AddMemberFeature:function(){return u}}),n("../node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),n("../node_modules/core-js/modules/esnext.reflect.metadata.js");var r,o=n("../node_modules/@tencent/workbench/lib/esm/decorators/class/feature.js"),s=n("../spread-sheet/src/core/view/layout/interface/pc-view.ts"),a=n("../spread-sheet/src/core/utils/gray.ts"),i=function(e,t,n,r){var o,s=arguments.length,a=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var i=e.length-1;i>=0;i--)(o=e[i])&&(a=(s<3?o(a):s>3?o(t,n,a):o(t,n))||a);return s>3&&a&&Object.defineProperty(t,n,a),a},c=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},d=function(e,t){return function(n,r){t(n,r,e)}},u=function(){function e(e){this.view=e}var t=e.prototype;return t.addMember=function(){var e;null===(e=this.view.canvas.collabCenter)||void 0===e||e.onAddCollab()},t.hideAddMember=function(){return(0,a.i)()},e}();u=i([(0,o.L)({name:"AddMemberFeature"}),d(0,s.w),c("design:paramtypes",["function"===typeof(r="undefined"!==typeof s.w&&s.w)?r:Object])],u)},"../spread-sheet/src/external/view/ui-layer/auth-manager-ent/auth-manager-feature.ts":function(e,t,n){n.r(t),n.d(t,{AuthManagerFeature:function(){return d}}),n("../node_modules/core-js/modules/es.object.get-own-property-descriptor.js");var r=n("../node_modules/@tencent/workbench/lib/esm/decorators/class/feature.js"),o=n("../packages/report/src/index.ts"),s=n("../spread-sheet/src/core/data/configService/spreadConfig.ts"),a=n("../spread-sheet/src/base/util/appConfig.ts"),i=n("../spread-sheet/src/core/utils/gray.ts"),c=function(e,t,n,r){var o,s=arguments.length,a=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var i=e.length-1;i>=0;i--)(o=e[i])&&(a=(s<3?o(a):s>3?o(t,n,a):o(t,n))||a);return s>3&&a&&Object.defineProperty(t,n,a),a},d=function(){function e(){}var t=e.prototype;return t.showEnterpriseEnvAuthDialog=function(){var e=this;n.g.SLR.load("CooperationV2",(function(t){var n=s.q.getConfig("globalPadId"),r=s.q.getConfig("title"),o=s.q.getConfig("corpId"),a=s.q.getConfig("uid");t.init(e.getTrasnferAuthDetailContainer(),{thirdAuthPanel:{type:"enterpriseWx",options:{globalPadId:n,title:r,corpId:o,uid:a}}})})),o.ZP.tdwReport({module:"more_menu",opername:"doc_editor_topbar_pc",action:"permission"})},t.canManageAuth=function(){var e=s.q.getConfig("canModifyAuth"),t=s.q.getConfig("isOwner");return!!a.Z.getConfig("menu.auth")&&!(!e&&!t)&&!(0,i.i)()},t.getTrasnferAuthDetailContainer=function(){var e="avd-container",t=document.getElementById(e);return t||((t=document.createElement("div")).id=e,document.body.appendChild(t)),t},e}();d=c([(0,r.L)({name:"AuthManagerFeature"})],d)},"../spread-sheet/src/external/view/ui-layer/auth/auth-feature-mobile.ts":function(e,t,n){n.r(t),n.d(t,{AuthFeature:function(){return R}}),n("../node_modules/regenerator-runtime/runtime.js"),n("../node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),n("../node_modules/core-js/modules/esnext.reflect.metadata.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.promise.js"),n("../node_modules/core-js/modules/es.regexp.exec.js"),n("../node_modules/core-js/modules/es.string.split.js");var r,o,s,a=n("../node_modules/@tencent/tencent_doc_open_url/dist/index.js"),i=n("../node_modules/@tencent/workbench/lib/esm/decorators/class/feature.js"),c=n("../spread-sheet/src/adapter/SpreadSheetAppAdapter.ts"),d=n("../spread-sheet/src/core/app/SpreadsheetApp.interface.ts"),u=n("../spread-sheet/src/external/view/mobile/header/auth.ts"),l=n("../node_modules/@tencent/docs-user-agent/dist/index.js"),p=n.n(l),f=n("../spread-sheet/src/core/data/configService/spreadConfig.ts"),m=n("../spread-sheet/src/core/app/sheetStatus/index.ts"),h=n("../spread-sheet/src/external/view/mobile/header/helper.ts"),g=n("../packages/common-utils/src/index.ts"),v=n("../spread-sheet/src/external/sheet-adapter/smart-sheet-adapter/constants.ts"),y=n("../spread-sheet/src/external/view/ui-layer/auth/auth-drawer.ts"),w=n("../spread-sheet/src/base/util/appConfig.ts"),j=function(e,t,n,r){var o,s=arguments.length,a=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var i=e.length-1;i>=0;i--)(o=e[i])&&(a=(s<3?o(a):s>3?o(t,n,a):o(t,n))||a);return s>3&&a&&Object.defineProperty(t,n,a),a},_=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},x=function(e,t){return function(n,r){t(n,r,e)}},b=function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function a(e){try{c(r.next(e))}catch(t){s(t)}}function i(e){try{c(r.throw(e))}catch(t){s(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,i)}c((r=r.apply(e,t||[])).next())}))},R=function(){function e(e,t,n){this.app=e,this.sheetStatus=t,this.authDrawer=n}var t=e.prototype;return t.showAuthPanel=function(){var e;return b(this,void 0,void 0,regeneratorRuntime.mark((function t(){var r,o,s;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,!p().isTencentDocsApp||!p().isTencentDocsAppVersionAboveOrEqual("2.2.6")){t.next=3;break}return t.abrupt("return",null===(e=n.g.mqq)||void 0===e?void 0:e.invoke("QQApi","updatePermission",{},{}));case 3:t.next=6;break;case 6:if(!p().isQQ){t.next=13;break}return r=w.Z.getConfig("links.qqH5ToMiniprogram"),o=encodeURIComponent(window.location.href.split("?")[0]),s=encodeURIComponent("/packages/miniapp-privileges/permission-panel/permission-panel?url="+o),(0,a.tencentDocOpenUrlForAll)({url:r+"?s="+s,replace:!1}),t.abrupt("return");case 13:u.Z.loadCooperationMobile(),t.next=20;break;case 16:t.prev=16,t.t0=t.catch(0),n.g.log.error("showAuthPanel 权限面板打开失败",t.t0),u.Z.loadCooperationMobile();case 20:case"end":return t.stop()}}),t,this,[[0,16]])})))},t.onApplyAuth=function(){var e=f.q.getConfig("docInfo")||{};(0,h.X)(this.sheetStatus.canEdit,(0,g.nE)((null===e||void 0===e?void 0:e.ownerName)||"",7),{opername:"doc_author",module:"edit",action:"clk_apply_mobile"})},t.applyAuthShouldHide=function(){var e=f.q.getConfig("canApplyEdit");return this.sheetStatus.canEdit||!this.app.sheetStatus.workbookStatus.isOnline||!e},e}();R=j([(0,i.L)({name:"AuthFeature",adapters:[c.L,v.dH]}),x(0,d.m),x(1,m.T),_("design:paramtypes",["function"===typeof(r="undefined"!==typeof d.m&&d.m)?r:Object,"function"===typeof(o="undefined"!==typeof m.T&&m.T)?o:Object,"function"===typeof(s="undefined"!==typeof y.Z&&y.Z)?s:Object])],R)},"../spread-sheet/src/external/view/ui-layer/auth/auth-feature-pc.ts":function(e,t,n){n.r(t),n.d(t,{AuthFeaturePC:function(){return m}}),n("../node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),n("../node_modules/core-js/modules/esnext.reflect.metadata.js");var r,o=n("../node_modules/@tencent/workbench/lib/esm/decorators/class/feature.js"),s=n("../spread-sheet/src/core/app/SpreadsheetApp.interface.ts"),a=n("../spread-sheet/src/adapter/SpreadSheetAppAdapter.ts"),i=n("../packages/report/src/index.ts"),c=n("../spread-sheet/src/core/data/configService/spreadConfig.ts"),d=n("../spread-sheet/src/external/view/workbench/service/notification.ts"),u=n("../spread-sheet/src/external/sheet-adapter/smart-sheet-adapter/constants.ts"),l=function(e,t,n,r){var o,s=arguments.length,a=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var i=e.length-1;i>=0;i--)(o=e[i])&&(a=(s<3?o(a):s>3?o(t,n,a):o(t,n))||a);return s>3&&a&&Object.defineProperty(t,n,a),a},p=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},f=function(e,t){return function(n,r){t(n,r,e)}},m=function(){function e(e){this.app=e,this.getContainerById=function(e){var t=document.getElementById(e);return t||((t=document.createElement("div")).id=e,document.body.appendChild(t)),t},this.handleNotificationDisplay=function(){(0,d.Q2)()&&(0,d.yK)()},this.handleReport=function(e){i.ZP.tdwReport({module:"doc_excel_editor",opername:"excel_style",action:e,ver12:"new"})}}var t=e.prototype;return t.handleAuthSetting=function(){this.handleNotificationDisplay(),$("#header-btn-auth").click()},t.handleADVPermission=function(){var e,t=this,r=this.getContainerById("avd-container");null===(e=n.g.SLR)||void 0===e||e.load("MenuAdvPermission",(function(e){e.show(r,{domainId:c.q.getConfig("domainId"),padId:c.q.getConfig("padId"),creatorDomain:c.q.getConfig("creatorDomain"),padType:c.q.getConfig("docType"),userId:c.q.getConfig("uin"),relateForm:t.app.feature.relateForm})}))},t.handleTransferAuth=function(){var e,t=this.getContainerById("transfer-auth-container");t.style.display="block";var r=this.app.feature.relateForm,o=r&&r.getRelatedNumber()>0,s=this;null===(e=n.g.SLR)||void 0===e||e.load("TransferAuth",(function(e){e.show(t,{domainId:c.q.getConfig("domainId"),padId:c.q.getConfig("padId"),creatorDomain:c.q.getConfig("creatorDomain"),userId:c.q.getConfig("uin"),hasRelatedForm:o,onClose:function(){s.hideTransferAuth()}})})),this.handleReport("clk_transfer")},t.hideTransferAuth=function(){var e,t=this;null===(e=n.g.SLR)||void 0===e||e.load("TransferAuth",(function(e){e.remove(),t.getContainerById("transfer-auth-container").style.display="none"}))},e}();m=l([(0,o.L)({name:"AuthFeaturePC",adapters:[a.L,u.dH]}),f(0,s.m),p("design:paramtypes",["function"===typeof(r="undefined"!==typeof s.m&&s.m)?r:Object])],m)},"../spread-sheet/src/external/view/ui-layer/auto-wrap/auto-wrap-feature.ts":function(e,t,n){n.r(t),n.d(t,{AutoWrapFeature:function(){return b}}),n("../node_modules/regenerator-runtime/runtime.js"),n("../node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),n("../node_modules/core-js/modules/esnext.reflect.metadata.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.promise.js");var r,o=n("../node_modules/@tencent/containerized/build/main/index.js"),s=n("../node_modules/@tencent/workbench/lib/esm/constants/service-name.js"),a=n("../node_modules/@tencent/workbench/lib/esm/decorators/class/feature.js"),i=n("../spread-sheet/src/core/behavior/api.interface.ts"),c=n("../packages/report/src/index.ts"),d=n("../packages/model/src/index.ts"),u=n("../spread-sheet/src/core/app/SpreadsheetApp.interface.ts"),l=n("../spread-sheet/src/core/utils/cell.ts"),p=n("../spread-sheet/src/adapter/SpreadSheetAppAdapter.ts"),f=function(e,t,n,r){var o,s=arguments.length,a=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var i=e.length-1;i>=0;i--)(o=e[i])&&(a=(s<3?o(a):s>3?o(t,n,a):o(t,n))||a);return s>3&&a&&Object.defineProperty(t,n,a),a},m=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},h=function(e,t){return function(n,r){t(n,r,e)}},g=function(){function e(e){this.app=e}return e.prototype.getWrapStrategyForCurrentSelection=function(){return(0,l.getCellFormat)(this.app).getWrapStrategy()},e}();g=f([(0,a.L)({adapters:[p.L]}),h(0,u.m),m("design:paramtypes",["function"===typeof(r="undefined"!==typeof u.m&&u.m)?r:Object])],g);var v,y,w=function(e,t,n,r){var o,s=arguments.length,a=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var i=e.length-1;i>=0;i--)(o=e[i])&&(a=(s<3?o(a):s>3?o(t,n,a):o(t,n))||a);return s>3&&a&&Object.defineProperty(t,n,a),a},j=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},_=function(e,t){return function(n,r){t(n,r,e)}},x=function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function a(e){try{c(r.next(e))}catch(t){s(t)}}function i(e){try{c(r.throw(e))}catch(t){s(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,i)}c((r=r.apply(e,t||[])).next())}))},b=function(){function e(e,t){this.dynamicApi=e,this.autoWrapService=t}var t=e.prototype;return t.handleAutoWrap=function(e){return x(this,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.requestFontStrike();case 2:this.reportAutoWrap(e);case 3:case"end":return t.stop()}}),t,this)})))},t.isAutoWrap=function(){return this.getAutoWrapStragety()===d.Cell.Format.WRAP_STRATEGY.WRAP},t.getAutoWrapStragety=function(){return this.autoWrapService.getWrapStrategyForCurrentSelection()},t.reportAutoWrap=function(e){e===s.v.TOOLBAR?c.ZP.tdwReport({opername:"doc_excel_editor",module:"excel_wrap",action:"clk_auto_wrap",ver12:"new"}):c.ZP.tdwReport({opername:"doc_excel_editor",module:"excel_mob_wrap",action:"mob_clk_auto_wrap"})},t.requestFontStrike=function(){return x(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t,n,r,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.dynamicApi.getInstance();case 2:return t=e.sent,n=d.Cell.Format.WRAP_STRATEGY.WRAP,r=d.Cell.Format.WRAP_STRATEGY.OVERFLOW_CELL,o=this.getAutoWrapStragety(),e.next=8,t.autoWrap(o===n?r:n);case 8:case"end":return e.stop()}}),e,this)})))},e}();b=w([(0,a.L)({adapters:[p.L]}),_(0,i.V),j("design:paramtypes",["function"===typeof(v="undefined"!==typeof o.RU&&o.RU)?v:Object,"function"===typeof(y="undefined"!==typeof g&&g)?y:Object])],b)},"../spread-sheet/src/external/view/ui-layer/background-color/background-color-feature.tsx":function(e,t,n){n.r(t),n.d(t,{BackgroundColorFeature:function(){return M}}),n("../node_modules/regenerator-runtime/runtime.js"),n("../node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),n("../node_modules/core-js/modules/esnext.reflect.metadata.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.promise.js"),n("../node_modules/core-js/modules/es.array.find.js"),n("../node_modules/core-js/modules/es.function.name.js");var r,o,s,a=n("../node_modules/i18next/dist/esm/i18next.js"),i=n("react"),c=n.n(i),d=n("../node_modules/@tencent/workbench/lib/esm/components/toolbar/common-dropdown/colorpicker/colorpicker.js"),u=n("../node_modules/@tencent/workbench/lib/esm/decorators/class/feature.js"),l=n("../packages/model/src/cell/index.ts"),p=n("../node_modules/@tencent/containerized/build/main/index.js"),f=n("../node_modules/@tencent/dui-mobile/lib/components/Snackbar/index.js"),m=n("../spread-sheet/src/core/app/SpreadsheetApp.interface.ts"),h=n("../spread-sheet/src/core/behavior/api.interface.ts"),g=n("../spread-sheet/src/core/utils/selection.ts"),v=n("../spread-sheet/src/core/utils/cell.ts"),y=n("../spread-sheet/src/adapter/SpreadSheetAppAdapter.ts"),w=n("../spread-sheet/src/core/view/layout/interface/pc-view.ts"),j=n("../spread-sheet/src/external/view/ui-layer/background-color/config.tsx"),_=n("../packages/report/src/index.ts"),x=n("../spread-sheet/src/external/view/common/view-abtest.ts"),b=n("../packages/model/src/cell/format/Color.ts"),R=n("../spread-sheet/src/external/check-slr/sc-lazy-loader.ts"),S=function(e,t,n,r){var o,s=arguments.length,a=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var i=e.length-1;i>=0;i--)(o=e[i])&&(a=(s<3?o(a):s>3?o(t,n,a):o(t,n))||a);return s>3&&a&&Object.defineProperty(t,n,a),a},C=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},E=function(e,t){return function(n,r){t(n,r,e)}},I=function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function a(e){try{c(r.next(e))}catch(t){s(t)}}function i(e){try{c(r.throw(e))}catch(t){s(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,i)}c((r=r.apply(e,t||[])).next())}))},M=function(){function e(e,t,n){var r=this;this.dynamicApi=e,this.view=t,this.app=n,this.currentBackgroundColor=j.rk.MOBILE,this.currentSelectColor=j.rk.PC,this.colorPickerChange=function(e,t){return I(r,void 0,void 0,regeneratorRuntime.mark((function n(){var r,o;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r=e||j.rk.MOBILE,n.next=3,this.setPcBgColor(r);case 3:return n.next=5,(0,R.Tf)();case 5:o=n.sent,t===o.ColorSourceType.EYE_DROPPER?this.reportEyedropperSelect(r):this.reportSelectBgColor(r);case 7:case"end":return n.stop()}}),n,this)})))}}var t=e.prototype;return t.setPcBgColor=function(e){return I(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.dynamicApi.getInstance();case 2:n=t.sent,e&&(this.currentSelectColor=e),n.setBackgroundColor(this.currentSelectColor);case 5:case"end":return t.stop()}}),t,this)})))},t.getCurrentSelectColor=function(){return this.currentSelectColor},t.setMobileBgColor=function(e){return I(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n,r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.dynamicApi.getInstance();case 2:n=t.sent,this.view.canvas.conditionFormatCenter.conditionFormat.isSelectedRangeConditionalFormatBGColorEffect()&&f.default.show({message:a.ZP.t("此单元格已应用条件格式。"),type:"info",autoClose:!0,duration:3e3,style:{zIndex:10005}}),r=j.EL.find((function(t){return t.name===e.name})),n.setBackgroundColor(r.value);case 7:case"end":return t.stop()}}),t,this)})))},t.shouldMobileBtnChecked=function(e){var t=this.getMobileCurrentColor();return t!==j.rk.MOBILE&&j.EL.find((function(t){return t.name===e.name})).value===t},t.reportSetBgColor=function(){_.ZP.tdwReport({opername:"doc_excel_editor",module:"excel_style",action:"clk_bg_key_color",ver5:this.getCurrentSelectColor(),abtest:(0,x.PA)(x.c6)})},t.reportShowPalette=function(){_.ZP.tdwReport({opername:"doc_excel_editor",module:"excel_style",action:"clk_bgcolor",abtest:(0,x.PA)(x.c6)})},t.reportShowEyedropper=function(){_.ZP.tdwReport({opername:"doc_excel_editor",module:"excel_style",action:"clk_bg_user_get",abtest:(0,x.PA)(x.c6)})},t.reportSelectBgColor=function(e){_.ZP.tdwReport({opername:"doc_excel_editor",module:"excel_style",action:"clk_bg_color",ver5:e,abtest:(0,x.PA)(x.c6)})},t.reportEyedropperSelect=function(e){_.ZP.tdwReport({opername:"doc_excel_editor",module:"excel_style",action:"clk_bg_user_get_color",ver5:e,abtest:(0,x.PA)(x.c6)})},t.getColorPicker=function(){var e=this,t=this.app.view.canvas.container;return(0,x.cp)()?c().createElement(i.Suspense,{fallback:c().createElement("div",null)},c().createElement(R.h2,{eyedropperTargetDom:t,showSubPalette:!0,onColorChange:this.colorPickerChange,selectedColor:this.getCurrentSelectColor(),onEyedropperVisibleChange:function(t){return e.onEyedropperVisibleChange(t)}})):c().createElement(d.z,{showSubPalette:!0,onChange:this.colorPickerChange,selected:this.getCurrentSelectColor(),customColorText:a.ZP.t("自定义颜色"),recentColorsText:a.ZP.t("最近使用")})},t.getMobileCurrentColor=function(){var e=(0,g.getActiveCell)(this.app),t=(0,v.getCellFormat)(this.app);return e&&l.cellDataUtils.getExportFormat(e)&&t.getBackgroundColor()?this.currentBackgroundColor=b.Z.getColorHexCode(t.getBackgroundColor(),this.app.spreadsheet):this.currentBackgroundColor=j.rk.MOBILE,this.currentBackgroundColor},t.onEyedropperVisibleChange=function(e){e&&this.reportShowEyedropper()},e}();M=S([(0,u.L)({name:"BackgroundColorFeature",adapters:[y.L]}),E(0,h.V),E(1,w.w),E(2,m.m),C("design:paramtypes",["function"===typeof(r="undefined"!==typeof p.RU&&p.RU)?r:Object,"function"===typeof(o="undefined"!==typeof w.w&&w.w)?o:Object,"function"===typeof(s="undefined"!==typeof m.m&&m.m)?s:Object])],M)},"../spread-sheet/src/external/view/ui-layer/background-color/config.tsx":function(e,t,n){n.d(t,{EL:function(){return u},OY:function(){return d},rk:function(){return r}});var r,o=n("react"),s=n.n(o),a=n("../node_modules/i18next/dist/esm/i18next.js"),i=n("../spread-sheet/src/external/view/schema/toolbar-schema.ts"),c=n("../spread-sheet/src/external/view/schema/mobile-toolbar-schema.ts");!function(e){e.MOBILE="transparent",e.PC="#8CDDFA"}(r||(r={}));var d=[{name:i.HM.BACKGROUND_COLOR,type:"icon",color:"",tooltip:a.ZP.t("填充颜色"),hasArrow:!0,icon:s().createElement("div",{className:"icon-svg-toolbar_fill_color"}),sheetStatusMiddleware:{isDisabledWhenCannotEdit:!0},privateFillMiddleWareConfig:{shouldCheckWhenCellIsPrivate:!0},inputStatusMiddleWareConfig:{isDisableWhenInput:!0}}],u=[{name:c.cx.BACKGROUND_COLOR_GREY,type:"color",value:"#c0c0c0"},{name:c.cx.BACKGROUND_COLOR_WHITE,type:"color",value:"#ffffff"},{name:c.cx.BACKGROUND_COLOR_YELLOW,type:"color",value:"#f8e71c"},{name:c.cx.BACKGROUND_COLOR_ORANGE,type:"color",value:"#f5a623"},{name:c.cx.BACKGROUND_COLOR_RED,type:"color",value:"#ef4e2f"},{name:c.cx.BACKGROUND_COLOR_BLUE,type:"color",value:"#309fff"},{name:c.cx.BACKGROUND_COLOR_GREEN,type:"color",value:"#7ed321"}]},"../spread-sheet/src/external/view/ui-layer/cell-border/config.ts":function(e,t,n){n.d(t,{EL:function(){return l},OY:function(){return u},eO:function(){return p}}),n("../node_modules/core-js/modules/es.array.map.js"),n("../node_modules/core-js/modules/es.object.entries.js");var r,o,s=n("../node_modules/i18next/dist/esm/i18next.js"),a=n("../spread-sheet/src/external/view/schema/toolbar-schema.ts"),i=n("../spread-sheet/src/external/view/schema/mobile-toolbar-schema.ts"),c=n("../packages/model/src/cell/format/index.ts"),d=((r={})[i.cx.CELL_BORDER_NONE]="none",r[i.cx.CELL_BORDER_ALL]="all",r[i.cx.CELL_BORDER_OUTER]="outer",r[i.cx.CELL_BORDER_INNER]="inner",r[i.cx.CELL_BORDER_HORIZONTAL]="horizontal",r[i.cx.CELL_BORDER_VERTICAL]="vertical",r),u=[{name:a.HM.CELL_BORDER,type:"icon",tooltip:s.ZP.t("边框"),sheetStatusMiddleware:{isDisabledWhenCannotEdit:!0},privateFillMiddleWareConfig:{shouldCheckWhenCellIsPrivate:!0},inputStatusMiddleWareConfig:{isDisableWhenInput:!0}}],l=Object.entries(d).map((function(e){var t=e[0],n=e[1];return{value:n,name:t,type:"button",iconClass:"ui-icon-border-"+n}})),p=((o={})[c.BORDER_STYLE.THIN]="thin",o[c.BORDER_STYLE.THICK]="thick",o[c.BORDER_STYLE.DASHED]="dashed",o[c.BORDER_STYLE.MEDIUM]="medium",o[c.BORDER_STYLE.DOUBLE]="double",o[c.BORDER_STYLE.HAIR]="hair",o[c.BORDER_STYLE.DASH_DOT]="dash dot",o[c.BORDER_STYLE.DASH_DOT_DOT]="dash dot dot",o[c.BORDER_STYLE.DOTTED]="dotted",o[c.BORDER_STYLE.MEDIUM_DASH_DOT_DOT]="medium dash dot dot",o[c.BORDER_STYLE.MEDIUM_DASH_DOT]="medium dash dot",o[c.BORDER_STYLE.MEDIUM_DASHED]="medium dashed",o)},"../spread-sheet/src/external/view/ui-layer/cell-border/feature.tsx":function(e,t,n){n.r(t),n.d(t,{CellBorderFeature:function(){return k}}),n("../node_modules/regenerator-runtime/runtime.js"),n("../node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),n("../node_modules/core-js/modules/esnext.reflect.metadata.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.promise.js");var r=n("react"),o=n("../packages/report/src/index.ts"),s=n("../node_modules/@tencent/containerized/build/main/index.js"),a=n("../node_modules/@tencent/workbench/lib/esm/decorators/class/feature.js"),i=n("../packages/model/src/cell/format/index.ts"),c=n("../spread-sheet/src/core/behavior/api.interface.ts"),d=n("../spread-sheet/src/external/view/ui-layer/cell-border/config.ts"),u=n("../spread-sheet/src/adapter/SpreadSheetAppAdapter.ts"),l=n("../spread-sheet/src/core/app/SpreadsheetApp.interface.ts"),p=n("../node_modules/@babel/runtime/helpers/esm/inheritsLoose.js"),f=(n("../node_modules/core-js/modules/es.array.map.js"),n("../node_modules/core-js/modules/es.object.assign.js"),n("../node_modules/i18next/dist/esm/i18next.js")),m=n("../node_modules/classnames/index.js"),h=n.n(m),g=n("../node_modules/@tencent/dui/lib/components/Menu/index.js"),v=n("../node_modules/@tencent/dui/lib/components/Dropdown/index.js"),y=n("../node_modules/@tencent/dui/lib/components/Divider/index.js"),w=n("../spread-sheet/src/core/ui/tooltip/index.ts"),j=n("../packages/model/src/cell/format/BorderStyle.ts"),_=[{type:"clear",tooltip:f.ZP.t("无边框"),value:"clear"},{type:"all",tooltip:f.ZP.t("所有边框"),value:"all"},{type:"outer",tooltip:f.ZP.t("外部边框"),value:"outer"},{type:"medium-outer",tooltip:f.ZP.t("粗外边框"),value:"medium-outer"},{type:"left",tooltip:f.ZP.t("左侧边框"),value:"left"},{type:"top",tooltip:f.ZP.t("顶部边框"),value:"top"},{type:"right",tooltip:f.ZP.t("右侧边框"),value:"right"},{type:"bottom",tooltip:f.ZP.t("底部边框"),value:"bottom"}],x=[{type:"HAIR",toolTip:f.ZP.t("HAIR"),value:j.Z.HAIR},{type:"DASH_DOT",toolTip:f.ZP.t("DASH_DOT"),value:j.Z.DASH_DOT},{type:"DASH_DOT_DOT",toolTip:f.ZP.t("DASH_DOT_DOT"),value:j.Z.DASH_DOT_DOT},{type:"DOTTED",toolTip:f.ZP.t("DOTTED"),value:j.Z.DOTTED},{type:"DASHED",toolTip:f.ZP.t("DASHED"),value:j.Z.DASHED},{type:"THIN",toolTip:f.ZP.t("THIN"),value:j.Z.THIN},{type:"MEDIUM_DASH_DOT_DOT",toolTip:f.ZP.t("MEDIUM_DASH_DOT_DOT"),value:j.Z.MEDIUM_DASH_DOT_DOT},{type:"MEDIUM_DASH_DOT",toolTip:f.ZP.t("MEDIUM_DASH_DOT"),value:j.Z.MEDIUM_DASH_DOT},{type:"MEDIUM_DASHED",toolTip:f.ZP.t("MEDIUM_DASHED"),value:j.Z.MEDIUM_DASHED},{type:"MEDIUM",toolTip:f.ZP.t("MEDIUM"),value:j.Z.MEDIUM},{type:"DOUBLE",toolTip:f.ZP.t("DOUBLE"),value:j.Z.DOUBLE},{type:"THICK",toolTip:f.ZP.t("THICK"),value:j.Z.THICK}],b=n("../spread-sheet/src/external/check-slr/sc-lazy-loader.ts"),R=n("../spread-sheet/src/external/view/common/view-abtest.ts"),S=function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function a(e){try{c(r.next(e))}catch(t){s(t)}}function i(e){try{c(r.throw(e))}catch(t){s(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,i)}c((r=r.apply(e,t||[])).next())}))};function C(e,t){var n=e.nativeEvent,r=n.relatedTarget||n.toElement;if(r)return!!r.closest(t)}var E,I,M=function(e){function t(t){var n;(n=e.call(this,t)||this).hasReportPaletteShow=!1;var o=t.feature;return n.state={borderType:"all",isChecked:!0,isButtonHide:!1,isButtonDisabled:!1,isPanelHide:!0,isStylePanelHide:!0,isColorPanelHide:!0,borderSetting:{type:o.getBorderType(),style:o.getBorderStyle(),color:o.getBorderColor()}},n.panelRef=r.createRef(),n}(0,p.Z)(t,e);var n=t.prototype;return n.componentDidMount=function(){(0,w.showTooltip)(".cell-border-type-button[data-tooltip]",{})},n.render=function(){return r.createElement(v.default.Keep,null,r.createElement("div",{ref:this.panelRef,className:"cell-border-panel"},this.renderBorderTypes(),r.createElement(y.default,null),this.renderBorderMenus(),this.renderStylePicker(),(0,R.cp)()?this.renderColorPicker():this.renderOldColorPicker()))},n.renderBorderMenus=function(){var e=this,t=this.state.borderSetting;return r.createElement("div",{className:"cell-border-menus"},r.createElement("div",{className:"cell-border-color-menu cell-border-menu",onMouseEnter:function(){return e.handleOpenColorPicker()},onMouseLeave:function(t){return e.handleCloseColorPicker(t)},onMouseUp:function(e){return e.stopPropagation()},onTouchEnd:function(e){return e.stopPropagation()}},r.createElement("div",{className:"cell-border-color-menu-icon toolbar-inline-block"}),r.createElement("div",{className:"cell-border-color-menu-color-bar",style:{backgroundColor:t.color}}),r.createElement("div",{className:"cell-border-menu-text toolbar-inline-block"},f.ZP.t("边框颜色")),r.createElement("div",{className:"cell-border-menu-arrow toolbar-inline-block"})),r.createElement("div",{className:"cell-border-style-menu cell-border-menu",onMouseEnter:function(){return e.handleOpenStylePicker()},onMouseLeave:function(t){return e.handleCloseStylePicker(t)},onMouseUp:function(e){return e.stopPropagation()},onTouchEnd:function(e){return e.stopPropagation()}},r.createElement("div",{className:"cell-border-style-menu-icon toolbar-inline-block"}),r.createElement("div",{className:"cell-border-menu-text toolbar-inline-block"},f.ZP.t("边框样式")),r.createElement("div",{className:"cell-border-menu-arrow toolbar-inline-block"})))},n.renderBorderTypes=function(){var e=this,t=this.state.borderSetting;return r.createElement("div",{className:"cell-border-type",onMouseUp:function(e){return e.stopPropagation()},onTouchEnd:function(e){return e.stopPropagation()}},_.map((function(n){return r.createElement("div",{key:n.type,className:"cell-border-type-button-wrapper"},r.createElement("div",{"data-tooltip":n.tooltip,className:h()("cell-border-type-button",{"is-selected":t.type===n.value}),onClick:function(){return e.handleChangeType(n.value)}},r.createElement("div",{tabIndex:2,"aria-hidden":!0},r.createElement("div",{className:"icon-svg-toolbar_cell_border_"+n.value+" cell-border-type-icon"}))))})))},n.renderStylePicker=function(){var e=this,t=this.state,n=t.borderSetting,o=t.isStylePanelHide;return r.createElement("div",{className:h()("cell-border-picker","cell-border-style-picker",{hidden:o,left:this.panelShouldShowOnTheLeft(146)}),onMouseLeave:function(t){return e.handleCloseStylePicker(t)},onMouseUp:function(e){return e.stopPropagation()},onTouchEnd:function(e){return e.stopPropagation()}},r.createElement(g.default,null,x.map((function(t,o){return r.createElement(g.default.Item,{key:o,className:"cell-border-style-picker-item",selected:t.value===n.style,onClick:function(){return e.handleChangeStyle(t.value)}},r.createElement("div",{className:h()("cell-border-style-picker-item-example",t.type)}))}))))},n.renderOldColorPicker=function(){var e=this;this.reportShowColorPicker();var t=this.state,n=t.borderSetting,o=t.isColorPanelHide;return r.createElement("div",{className:h()("cell-border-picker","cell-border-color-picker",{hidden:o,left:this.panelShouldShowOnTheLeft(189)}),onMouseLeave:function(t){return e.handleCloseColorPicker(t)}},r.createElement(r.Suspense,{fallback:r.createElement("div",null)},r.createElement(b.XT,{id:"palette-panel-id",showSubPalette:!0,selectColor:n.color,onColorChange:function(t,n,r){e.handleChangeColor(t,n,r)},onInputMouseDown:function(e){return e.stopPropagation()}})))},n.renderColorPicker=function(){var e=this;this.reportShowColorPicker();var t=this.state,n=t.borderSetting,o=t.isColorPanelHide;return r.createElement("div",{className:h()("cell-border-picker","cell-border-color-picker",{hidden:o,left:this.panelShouldShowOnTheLeft(189)}),onMouseLeave:function(t){return e.handleCloseColorPicker(t)}},r.createElement(r.Suspense,{fallback:r.createElement("div",null)},r.createElement(b.h2,{showSubPalette:!0,eyedropperTargetDom:this.props.feature.app.view.canvas.container,selectedColor:n.color,onColorChange:function(t,n,r){return e.handleChangeColor(t||"",n,r)}})))},n.panelShouldShowOnTheLeft=function(e){var t=this.panelRef.current;return!!t&&t.getBoundingClientRect().right+e>window.innerWidth},n.handleOpenStylePicker=function(){this.setState({isStylePanelHide:!1}),o.ZP.tdwReport({opername:"doc_excel_editor",module:"excel_style",action:"hover_borderline-style",ver12:"new"})},n.handleCloseStylePicker=function(e){C(e,".cell-border-style-picker")||this.setState({isStylePanelHide:!0})},n.handleOpenColorPicker=function(){this.setState({isColorPanelHide:!1})},n.handleCloseColorPicker=function(e){C(e,".cell-border-color-picker")||this.setState({isColorPanelHide:!0})},n.handleChangeStyle=function(e){var t=this.state.borderSetting,n=this.props.feature,r=Object.assign(Object.assign({},t),{style:e});e!==i.BORDER_STYLE.MEDIUM&&"medium-outer"===t.type&&(r.type="outer",n.setBorderType("outer")),n.setBorderStyle(e),n.applyBorder(r),this.setState({borderSetting:r}),o.ZP.tdwReport({opername:"doc_excel_editor",module:"excel_style",action:"borderline-style-"+d.eO[e],ver12:"new"})},n.handleChangeType=function(e){var t=this.props.feature,n=this.state.borderSetting,r=Object.assign(Object.assign({},n),{type:e});"medium-outer"===e&&n.style!==i.BORDER_STYLE.MEDIUM&&(r.style=i.BORDER_STYLE.MEDIUM,t.setBorderStyle(i.BORDER_STYLE.MEDIUM)),"medium-outer"!==e&&"medium-outer"===n.type&&(r.style=i.BORDER_STYLE.THIN,t.setBorderStyle(i.BORDER_STYLE.THIN)),t.setBorderType(e),t.applyBorder(r),this.setState({borderSetting:r}),o.ZP.tdwReport({opername:"doc_excel_editor",module:"excel_style",action:"borderline-"+e})},n.handleChangeColor=function(e,t,n){return S(this,void 0,void 0,regeneratorRuntime.mark((function r(){var s,a,i,c,d;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,(0,b.Tf)();case 2:if(s=r.sent,"boolean"===typeof t&&(t=t?s.ColorSourceType.CUSTOM:s.ColorSourceType.STANDARD),a=this.props.feature,i=this.state.borderSetting,!n){r.next=8;break}return r.abrupt("return");case 8:c=Object.assign(Object.assign({},i),{color:e}),d=t!==s.ColorSourceType.CUSTOM,a.setBorderColor(e),a.applyBorder(c),this.setState({borderSetting:c,isColorPanelHide:d}),t===s.ColorSourceType.EYE_DROPPER?o.ZP.tdwReport({opername:"doc_excel_editor",module:"excel_style",action:"clk_borderline_user_get_color",ver5:e,abtest:(0,R.PA)(R.c6)}):o.ZP.tdwReport({opername:"doc_excel_editor",module:"excel_style",action:"clk_borderline_color",ver5:e,abtest:(0,R.PA)(R.c6)});case 14:case"end":return r.stop()}}),r,this)})))},n.reportShowColorPicker=function(){this.hasReportPaletteShow||(this.hasReportPaletteShow=!0,o.ZP.tdwReport({opername:"doc_excel_editor",module:"excel_style",action:"clk_borderlinecolor",abtest:(0,R.PA)(R.c6)}))},t}(r.Component),T=function(e,t,n,r){var o,s=arguments.length,a=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var i=e.length-1;i>=0;i--)(o=e[i])&&(a=(s<3?o(a):s>3?o(t,n,a):o(t,n))||a);return s>3&&a&&Object.defineProperty(t,n,a),a},O=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},D=function(e,t){return function(n,r){t(n,r,e)}},A=function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function a(e){try{c(r.next(e))}catch(t){s(t)}}function i(e){try{c(r.throw(e))}catch(t){s(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,i)}c((r=r.apply(e,t||[])).next())}))},k=function(){function e(e,t){this.dynamicApi=e,this.app=t,this.borderSetting={type:"all",color:"#000000",style:i.BORDER_STYLE.THIN},this.getBorderType=this.getBorderType.bind(this),this.getBorderColor=this.getBorderColor.bind(this),this.getBorderStyle=this.getBorderStyle.bind(this),this.setBorderType=this.setBorderType.bind(this),this.setBorderColor=this.setBorderColor.bind(this),this.setBorderStyle=this.setBorderStyle.bind(this),this.getBorderSetting=this.getBorderSetting.bind(this),this.applyBorder=this.applyBorder.bind(this)}var t=e.prototype;return t.getBorderSetting=function(){return this.borderSetting},t.getBorderType=function(){return this.borderSetting.type},t.getBorderStyle=function(){return this.borderSetting.style},t.getBorderColor=function(){return this.borderSetting.color},t.setBorderType=function(e){this.borderSetting.type=e},t.setBorderStyle=function(e){this.borderSetting.style=e},t.setBorderColor=function(e){this.borderSetting.color=e},t.applyBorder=function(e){var t=e.color,n=e.style,r=e.type;return A(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.dynamicApi.getInstance();case 2:e.sent.setBorder({color:t,style:n},"medium-outer"===r?"outer":r);case 4:case"end":return e.stop()}}),e,this)})))},t.setBorderMobile=function(e){this.borderSetting.type=e,this.borderSetting.style=i.BORDER_STYLE.THIN,this.borderSetting.color="#000",this.applyBorder(this.borderSetting),this.report()},t.getCellBorderDropdown=function(){return r.createElement(M,{feature:this})},t.report=function(){o.ZP.tdwReport({opername:"doc_excel_editor",module:"excel_style",action:"borderline-style-"+d.eO[this.borderSetting.style],ver12:"new"})},e}();k=T([(0,a.L)({adapters:[u.L]}),D(0,c.V),D(1,l.m),O("design:paramtypes",["function"===typeof(E="undefined"!==typeof s.RU&&s.RU)?E:Object,"function"===typeof(I="undefined"!==typeof l.m&&l.m)?I:Object])],k)},"../spread-sheet/src/external/view/ui-layer/chart-context-menu/chart-context-menu-feature.ts":function(e,t,n){n.r(t),n.d(t,{ChartContextMenuFeature:function(){return w}}),n("../node_modules/regenerator-runtime/runtime.js"),n("../node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),n("../node_modules/core-js/modules/esnext.reflect.metadata.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.promise.js");var r,o,s,a=n("../node_modules/@tencent/containerized/build/main/index.js"),i=n("../node_modules/@tencent/workbench/lib/esm/decorators/class/feature.js"),c=n("../packages/report/src/index.ts"),d=n("../spread-sheet/src/core/view/layout/pcView.ts"),u=n("../spread-sheet/src/core/view/layout/interface/pc-view.ts"),l=n("../spread-sheet/src/core/behavior/api.interface.ts"),p=n("../packages/model/src/spreadsheet/index.ts"),f=n("../spread-sheet/src/adapter/SpreadSheetAppAdapter.ts"),m=n("../spread-sheet/src/core/view/level-2/chart/charts/chart-data-api.ts"),h=function(e,t,n,r){var o,s=arguments.length,a=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var i=e.length-1;i>=0;i--)(o=e[i])&&(a=(s<3?o(a):s>3?o(t,n,a):o(t,n))||a);return s>3&&a&&Object.defineProperty(t,n,a),a},g=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},v=function(e,t){return function(n,r){t(n,r,e)}},y=function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function a(e){try{c(r.next(e))}catch(t){s(t)}}function i(e){try{c(r.throw(e))}catch(t){s(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,i)}c((r=r.apply(e,t||[])).next())}))},w=function(){function e(e,t,n){this.view=e,this.dynamicApi=t,this.spreadsheet=n}var t=e.prototype;return t.delete=function(){return y(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:m.H.delete(this.view.canvas.chartCenter.chartStage.getActiveChartBoxId()),c.ZP.tdwReport({opername:"doc_charts",module:"delete",action:"charts_delete"});case 2:case"end":return e.stop()}}),e,this)})))},t.editChart=function(){return y(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.view.getChartPanel();case 2:e.sent.showWithChartId(this.view.canvas.chartCenter.chartStage.getActiveChartBoxId());case 4:case"end":return e.stop()}}),e,this)})))},t.toImage=function(){var e;null===(e=this.spreadsheet.parent.feature._copyPaste)||void 0===e||e.doChartCopy(this.view.canvas.chartCenter.chartStage.getActiveChartBoxId())},e}();w=h([(0,i.L)({adapters:[f.L]}),v(0,u.w),v(1,l.V),v(2,p.ISpreadsheet),g("design:paramtypes",["function"===typeof(r="undefined"!==typeof d.Z&&d.Z)?r:Object,"function"===typeof(o="undefined"!==typeof a.RU&&a.RU)?o:Object,"function"===typeof(s="undefined"!==typeof p.ISpreadsheet&&p.ISpreadsheet)?s:Object])],w)},"../spread-sheet/src/external/view/ui-layer/clear/clear-feature.ts":function(e,t,n){n.r(t),n.d(t,{ClearFeature:function(){return h}}),n("../node_modules/regenerator-runtime/runtime.js"),n("../node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),n("../node_modules/core-js/modules/esnext.reflect.metadata.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.promise.js");var r,o=n("../node_modules/@tencent/workbench/lib/esm/constants/service-name.js"),s=n("../node_modules/@tencent/workbench/lib/esm/decorators/class/feature.js"),a=n("../spread-sheet/src/core/behavior/api.interface.ts"),i=n("../node_modules/@tencent/containerized/build/main/index.js"),c=n("../spread-sheet/src/adapter/SpreadSheetAppAdapter.ts"),d=n("../packages/report/src/index.ts"),u=n("../spread-sheet/src/base/index.ts"),l=function(e,t,n,r){var o,s=arguments.length,a=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var i=e.length-1;i>=0;i--)(o=e[i])&&(a=(s<3?o(a):s>3?o(t,n,a):o(t,n))||a);return s>3&&a&&Object.defineProperty(t,n,a),a},p=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},f=function(e,t){return function(n,r){t(n,r,e)}},m=function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function a(e){try{c(r.next(e))}catch(t){s(t)}}function i(e){try{c(r.throw(e))}catch(t){s(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,i)}c((r=r.apply(e,t||[])).next())}))},h=function(){function e(e){this.dynamicApi=e}var t=e.prototype;return t.clearFormat=function(e){return m(this,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.dynamicApi.getInstance();case 2:t.sent.clearFormat(),this.reportClearFormat(e.from);case 5:case"end":return t.stop()}}),t,this)})))},t.clearContent=function(e){return m(this,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.dynamicApi.getInstance();case 2:t.sent.clearContent(),e.from===o.v.MENU&&u.Z.event.view.trigger("input_end"),this.reportClearContent(e.from);case 6:case"end":return t.stop()}}),t,this)})))},t.reportClearFormat=function(e){e===o.v.TOOLBAR?d.ZP.tdwReport({opername:"doc_excel_editor",module:"excel_tool",action:"clk_del-format",ver12:"new"}):e===o.v.CONTEXT_MENU?d.ZP.tdwReport({module:"excel_menu",opername:"doc_excel_editor",action:"clk_menu_clearformat"}):e===o.v.MENU&&d.ZP.tdwReport({opername:"doc_excel_editor",module:"excel_drop-menu",action:"edit_clear_format",ver12:"new"})},t.reportClearContent=function(e){e===o.v.CONTEXT_MENU?d.ZP.tdwReport({module:"excel_menu",opername:"doc_excel_editor",action:"clk_menu_clearcontent"}):e===o.v.MENU&&d.ZP.tdwReport({opername:"doc_excel_editor",module:"excel_drop-menu",action:"edit_clear_content",ver12:"new"})},e}();h=l([(0,s.L)({name:"ClearFeature",adapters:[c.L]}),f(0,a.V),p("design:paramtypes",["function"===typeof(r="undefined"!==typeof i.RU&&i.RU)?r:Object])],h)},"../spread-sheet/src/external/view/ui-layer/comment-ent/comment-ent-feature.ts":function(e,t,n){n.r(t),n.d(t,{CommentEntFeature:function(){return y}}),n("../node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),n("../node_modules/core-js/modules/esnext.reflect.metadata.js");var r,o,s,a=n("../spread-sheet/src/core/view/layout/interface/pc-view.ts"),i=n("../node_modules/@tencent/workbench/lib/esm/decorators/class/feature.js"),c=n("../spread-sheet/src/core/app/sheetStatus/index.ts"),d=n("../spread-sheet/src/core/app/SpreadsheetApp.interface.ts"),u=n("../spread-sheet/src/core/utils/index.ts"),l=n("../spread-sheet/src/external/view/main/toolbar/defaultHook.ts"),p=n("../spread-sheet/src/base/util/domain-config.ts"),f=n("../packages/report/src/index.ts"),m=n("../spread-sheet/src/adapter/SpreadSheetAppAdapter.ts"),h=function(e,t,n,r){var o,s=arguments.length,a=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var i=e.length-1;i>=0;i--)(o=e[i])&&(a=(s<3?o(a):s>3?o(t,n,a):o(t,n))||a);return s>3&&a&&Object.defineProperty(t,n,a),a},g=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},v=function(e,t){return function(n,r){t(n,r,e)}},y=function(){function e(e,t,n){this.view=e,this.sheetStatus=t,this.app=n}var t=e.prototype;return t.insertComment=function(){var e;this.sheetStatus.canComment&&u.Z.selection.singleRange(this.app)&&!u.Z.selection.selectImage(this.app)&&(null===(e=l.Z.doClickComment)||void 0===e||e.call(l.Z,this.view))},t.addComment=function(){var e=this.view.canvas.normalSelectData.activeRow,t=this.view.canvas.normalSelectData.activeCol;e<0||t<0||(this.view.canvas.commentCenter.addComment(),f.ZP.tdwReport({module:"excel_comment",opername:"doc_cooper",action:"meno_add"}))},t.shouldHideContext=function(){return!p.xc},t.getSelection=function(){return this.view.getSelectionWithGridRanges()},t.commentDisabled=function(){return!this.app.sheetStatus.canComment},t.toggleCommentPanel=function(){this.view.canvas.commentCenter.toggleCommentPanel(!0)},e}();y=h([(0,i.L)({adapters:[m.L]}),v(0,a.w),v(1,c.T),v(2,d.m),g("design:paramtypes",["function"===typeof(r="undefined"!==typeof a.w&&a.w)?r:Object,"function"===typeof(o="undefined"!==typeof c.T&&c.T)?o:Object,"function"===typeof(s="undefined"!==typeof d.m&&d.m)?s:Object])],y)},"../spread-sheet/src/external/view/ui-layer/condition-format/condition-format-feature.ts":function(e,t,n){n.r(t),n.d(t,{ConditionFormatFeature:function(){return u}}),n("../node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),n("../node_modules/core-js/modules/esnext.reflect.metadata.js");var r,o=n("../node_modules/@tencent/workbench/lib/esm/decorators/class/feature.js"),s=n("../packages/report/src/index.ts"),a=n("../spread-sheet/src/adapter/SpreadSheetAppAdapter.ts"),i=n("../spread-sheet/src/external/view/ui-layer/condition-format/components/condition-format-drawer.tsx"),c=function(e,t,n,r){var o,s=arguments.length,a=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var i=e.length-1;i>=0;i--)(o=e[i])&&(a=(s<3?o(a):s>3?o(t,n,a):o(t,n))||a);return s>3&&a&&Object.defineProperty(t,n,a),a},d=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},u=function(){function e(e){this.conditionFormatDrawer=e,this.handleReport=function(){s.ZP.tdwReport({module:"excel_con_format",opername:"doc_excel_editor",action:"clk_drop-menu-format",ver12:"new"}),s.ZP.tdwReport({module:"conditional_format",opername:"doc_excel_editor",action:"click_format_type",ver10:"menu"})}}return e.prototype.showPanel=function(e){var t=e.conditionType,n=e.panelState;this.conditionFormatDrawer.openDrawer({panelState:n,conditionType:t}),this.handleReport()},e}();u=c([(0,o.L)({name:"ConditionFormatFeature",adapters:[a.L]}),d("design:paramtypes",["function"===typeof(r="undefined"!==typeof i.Z&&i.Z)?r:Object])],u)},"../spread-sheet/src/external/view/ui-layer/convert-image/convert-to-image-feature.tsx":function(e,t,n){n.r(t),n.d(t,{ConvertToImageFeature:function(){return j}}),n("../node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),n("../node_modules/core-js/modules/esnext.reflect.metadata.js"),n("../node_modules/core-js/modules/web.dom-collections.for-each.js"),n("../node_modules/core-js/modules/es.object.assign.js"),n("../node_modules/core-js/modules/es.array.map.js");var r,o,s,a=n("../node_modules/@tencent/workbench/lib/esm/decorators/class/feature.js"),i=n("../packages/model/src/embedded/index.ts"),c=n("../packages/report/src/index.ts"),d=n("../packages/model/src/cell/metadata/CustomDataType.ts"),u=n("../spread-sheet/src/core/view/layout/interface/pc-view.ts"),l=n("../packages/model/src/spreadsheet/Spreadsheet.interface.ts"),p=n("../spread-sheet/src/external/view/ui-layer/convert-image/float-image-to-cell-conflict-ui.tsx"),f=n("../spread-sheet/src/core/data/converter/tencentdoc/utils/files.ts"),m=n("../spread-sheet/src/core/view/level-2/context-menu-center/context-menu-config/pc/button/image/util.ts"),h=n("../spread-sheet/src/core/app/SpreadsheetApp.interface.ts"),g=n("../spread-sheet/src/adapter/SpreadSheetAppAdapter.ts"),v=function(e,t,n,r){var o,s=arguments.length,a=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var i=e.length-1;i>=0;i--)(o=e[i])&&(a=(s<3?o(a):s>3?o(t,n,a):o(t,n))||a);return s>3&&a&&Object.defineProperty(t,n,a),a},y=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},w=function(e,t){return function(n,r){t(n,r,e)}},j=function(){function e(e,t,n){this.app=e,this.view=t,this.spreadsheet=n}var t=e.prototype;return t.hasFloatImage=function(){var e=this.spreadsheet.activeSheet,t=this.view.getSelection().rangeSelections;return(0,f.Iv)(e,t)},t.convertCellImages=function(){var e,t=this,n=function(e,t){return e.rowIndex===t.rowIndex&&e.colIndex===t.colIndex},r=[],o=[];this.getFloatImages().forEach((function(s){var a,i=s.id;if(i){var c=t.getRelatedCell(i);if(c){var d=c.colIndex,u=c.rowIndex,l=t.spreadsheet.activeSheet.getCellDataAtPosition(u,d);if(null===(a=null===l||void 0===l?void 0:l.getEffectiveValue())||void 0===a?void 0:a.value)r.push({id:i,relatedCell:c,error:p.QS.ALREADY_HAVE_CONTENT});else{if(e&&n(e,c)){var f=o[o.length-1],m=r[r.length-1];if(m&&n(m.relatedCell,c))return;if(f&&n(f.relatedCell,c))return void r.push(Object.assign(Object.assign({},o.pop()),{error:p.QS.MULTIPLE_PICS}))}o.push({id:i,relatedCell:c}),e=c}}}})),o.length&&this.convertImage(o.map((function(e){return e.id}))),r.length&&(0,p.kl)(r,this.view)},t.hasCellImage=function(){var e=this.spreadsheet.activeSheet,t=this.view.getSelection().rangeSelections;return(0,f.oo)(e,t)},t.convertFloatImages=function(){var e=this,t=this.view.canvas.normalSelectData.activeCol,r=this.view.canvas.normalSelectData.activeRow;if(t<0||r<0)n.g.log.error("选区状态异常，无法转换浮动图片");else{c.ZP.tdwReport({opername:"doc_excel_editor",module:"excel_photo",action:"photo_change",ver10:"to_float_photo"});var o=this.getCellImages();o.length&&o.forEach((function(t){var n,r,o=t.row,s=t.col,a=null===(r=null===(n=e.spreadsheet.activeSheet.getCellDataAtPosition(o,s))||void 0===n?void 0:n.getRefIds())||void 0===r?void 0:r[0];a&&e.app.requestApi.convertImageType(a,i.EMBEDDED_OBJECT_TYPE.IMAGE)}))}},t.getFloatImages=function(){var e=this.view.getSelection().rangeSelections;return(0,f.Ll)(this.spreadsheet.activeSheet,e).files},t.getRelatedCell=function(e){return(0,m.O7)(this.app,e)},t.convertImage=function(e){(0,m.mP)(this.app,e)},t.getCellImages=function(){var e=this,t=this.spreadsheet.activeSheet,n=this.view.getSelection().rangeSelections,r=[];return n.forEach((function(n){n.each((function(t,n){e.isImageInCell(t,n)&&r.push({row:t,col:n})}),t)})),r},t.isImageInCell=function(e,t){var n=this.spreadsheet.activeSheet.getCellDataAtPosition(e,t),r=null===n||void 0===n?void 0:n.getMetadata();return!(!r||r.customDataType!==d.ZP.IMAGE)},e}();j=v([(0,a.L)({adapters:[g.L]}),w(0,h.m),w(1,u.w),w(2,l.V),y("design:paramtypes",["function"===typeof(r="undefined"!==typeof h.m&&h.m)?r:Object,"function"===typeof(o="undefined"!==typeof u.w&&u.w)?o:Object,"function"===typeof(s="undefined"!==typeof l.V&&l.V)?s:Object])],j)},"../spread-sheet/src/external/view/ui-layer/convert-to-smart-sheet/convert-to-smart-sheet-feature.tsx":function(e,t,n){n.r(t),n.d(t,{ConvertToSmartSheetFeature:function(){return E}}),n("../node_modules/regenerator-runtime/runtime.js"),n("../node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),n("../node_modules/core-js/modules/esnext.reflect.metadata.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.promise.js");var r=n("../node_modules/i18next/dist/esm/i18next.js"),o=n("../node_modules/@tencent/workbench/lib/esm/decorators/class/feature.js"),s=n("../node_modules/@tencent/workbench/lib/esm/services/contextmenu/context-menu-service.js"),a=n("../node_modules/@tencent/workbench/lib/esm/services/badge/badge-service.js"),i=n("../spread-sheet/src/core/app/SpreadsheetApp.interface.ts"),c=n("../spread-sheet/src/adapter/SpreadSheetAppAdapter.ts"),d=n("../packages/model/src/sheet/SheetType.ts"),u=n("../node_modules/@tencent/dui/lib/components/Snackbar/index.js"),l=n("../spread-sheet/src/base/event/event.ts"),p=n("../node_modules/@babel/runtime/helpers/esm/toConsumableArray.js"),f=(n("../node_modules/core-js/modules/es.array.iterator.js"),n("../node_modules/core-js/modules/es.map.js"),n("../node_modules/core-js/modules/es.string.iterator.js"),n("../node_modules/core-js/modules/esnext.map.delete-all.js"),n("../node_modules/core-js/modules/esnext.map.every.js"),n("../node_modules/core-js/modules/esnext.map.filter.js"),n("../node_modules/core-js/modules/esnext.map.find.js"),n("../node_modules/core-js/modules/esnext.map.find-key.js"),n("../node_modules/core-js/modules/esnext.map.includes.js"),n("../node_modules/core-js/modules/esnext.map.key-of.js"),n("../node_modules/core-js/modules/esnext.map.map-keys.js"),n("../node_modules/core-js/modules/esnext.map.map-values.js"),n("../node_modules/core-js/modules/esnext.map.merge.js"),n("../node_modules/core-js/modules/esnext.map.reduce.js"),n("../node_modules/core-js/modules/esnext.map.some.js"),n("../node_modules/core-js/modules/esnext.map.update.js"),n("../node_modules/core-js/modules/web.dom-collections.iterator.js"),n("../node_modules/core-js/modules/web.dom-collections.for-each.js"),n("../node_modules/core-js/modules/es.array.slice.js"),n("../node_modules/core-js/modules/es.array.from.js"),n("../packages/model/src/cell/metadata/CustomDataType.ts")),m=n("../packages/model/src/range/hexRangeUtils.ts");function h(e){var t=e.spreadsheet,n=t.activeSheet,r=t.activeSheetId,o=e.view.getSelection().rangeSelections,s=(0,m.range2RelativeHex)(o[0],n);return function(e,t){for(var n,r,o=e.spreadsheet.activeSheet,s=o.data,a=s.rowData,i=s.rowMetadata,c=t.startRowIndex,d=t.startColIndex,u=t.endRowIndex,l=t.endColIndex,p=[],f=new Map,m=-1,h=-1,y=l+1,w=-1,j=Math.min(u,a.length-1),_=c;_<=j;_++)if(!(null===(n=i[_])||void 0===n?void 0:n.hiddenByFilter)){var x=a[_];if(p.push([]),x){for(var b=p.length-1,R=x.values,S=!1,C=Math.min(l,R.length-1),E=d;E<=C;E++){var I=R[E];if(null===(r=null===I||void 0===I?void 0:I.getFormattedValue())||void 0===r?void 0:r.value)if(e.sheetStatus.isCellPrivate(_,E))p[b].push(void 0);else{S=!0;var M=I.clone();p[b].push(M),g(o,M,f);var T=p[b].length-1;y=Math.min(y,T),w=Math.max(w,T)}else p[b].push(void 0)}S&&(-1===m&&(m=b),h=b)}}return{selectData:v(p,{headRowIndex:m,tailRowIndex:h,headColIndex:y,tailColIndex:w}),resourceMap:f}}(e,(0,m.hex2Range)(s,r))}function g(e,t,n){var r;if((null===(r=t.getMetadata())||void 0===r?void 0:r.customDataType)===f.ZP.IMAGE){var o=t.getRefIds();null===o||void 0===o||o.forEach((function(t){var r,o=null===(r=e.imageManager.getImage(t))||void 0===r?void 0:r.url;o&&n.set(t,o)}))}}function v(e,t){var n=t.headRowIndex,r=t.tailRowIndex,o=t.headColIndex,s=t.tailColIndex;if(-1===n)return[];for(var a=e.slice(n,r+1),i=0;i<a.length;i++){var c=a[i].slice(o,s+1),d=Array.from({length:s-o+1-c.length});c.push.apply(c,(0,p.Z)(d)),a[i]=c}return a}var y,w,j,_,x=n("../spread-sheet/src/external/gray-service/gray-service.ts"),b=function(e,t,n,r){var o,s=arguments.length,a=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var i=e.length-1;i>=0;i--)(o=e[i])&&(a=(s<3?o(a):s>3?o(t,n,a):o(t,n))||a);return s>3&&a&&Object.defineProperty(t,n,a),a},R=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},S=function(e,t){return function(n,r){t(n,r,e)}},C=function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function a(e){try{c(r.next(e))}catch(t){s(t)}}function i(e){try{c(r.throw(e))}catch(t){s(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,i)}c((r=r.apply(e,t||[])).next())}))},E=function(e,t,n,o){var s=this;this.app=e,this.grayService=t,this.contextMenuService=n,this.badgeService=o,this.isInSmartSheetGray=!1,this.convertToSmartSheet=function(){return C(s,void 0,void 0,regeneratorRuntime.mark((function e(){var t,n,o,s,a,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.app.sheetAdapterManager.getAdapterBySheetType(d.ZP.SMART_SHEET),n=u.default.show({autoClose:!1,type:"loading",message:r.ZP.t("正在转换中...")}),t.isInitialized()){e.next=10;break}return e.next=5,t.init();case 5:if(e.sent){e.next=10;break}return n.close(),u.default.show({message:r.ZP.t("转换失败"),type:"error",closable:!0,action:r.ZP.t("重试"),onClickAction:this.convertToSmartSheet}),e.abrupt("return");case 10:if(o=h(this.app),s=o.selectData,a=o.resourceMap,!(s.length<2)){e.next=15;break}return n.close(),u.default.show({type:"info",message:r.ZP.t("请选择至少两行有内容的单元格"),duration:3e3}),e.abrupt("return");case 15:i=t.getTableJSONBySheetCellData(s,a),l.ZP.sheetsBar.trigger("addSheet",{autoSwitch:!0,sheetType:d.ZP.SMART_SHEET,tableJSON:i}),n.close();case 18:case"end":return e.stop()}}),e,this)})))},this.shouldHide=function(){if(s.app.sheetStatus.containsCanNotReadRange())return!0;if(!s.isInSmartSheetGray)return!0;var e=s.app.view.getSelectionWithGridRanges().rangeSelections[0],t=e.startRowIndex,n=e.endRowIndex;return!e.isCol&&n-t<1},this.getIsInSmartSheetGray=function(){return C(s,void 0,void 0,regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.grayService.isInGray(x.D.SMART_SHEET);case 2:(t=e.sent)&&(this.isInSmartSheetGray=t,this.contextMenuService.updateState());case 4:case"end":return e.stop()}}),e,this)})))},this.getIsInSmartSheetGray()};E=b([(0,o.L)({adapters:[c.L]}),S(0,i.m),R("design:paramtypes",["function"===typeof(y="undefined"!==typeof i.m&&i.m)?y:Object,"function"===typeof(w="undefined"!==typeof x.Z&&x.Z)?w:Object,"function"===typeof(j="undefined"!==typeof s.L&&s.L)?j:Object,"function"===typeof(_="undefined"!==typeof a.A&&a.A)?_:Object])],E)},"../spread-sheet/src/external/view/ui-layer/copy/copy-feature.ts":function(e,t,n){n.r(t),n.d(t,{CopyFeature:function(){return j}}),n("../node_modules/regenerator-runtime/runtime.js"),n("../node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),n("../node_modules/core-js/modules/esnext.reflect.metadata.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.promise.js");var r,o,s=n("../node_modules/i18next/dist/esm/i18next.js"),a=n("../node_modules/@tencent/workbench/lib/esm/decorators/class/feature.js"),i=n("../spread-sheet/src/core/app/SpreadsheetApp.interface.ts"),c=n("../spread-sheet/src/adapter/SpreadSheetAppAdapter.ts"),d=n("../spread-sheet/src/core/feature/copyPaste/interfaces.ts"),u=n("../spread-sheet/src/core/feature/copyPaste/index.ts"),l=n("../packages/report/src/index.ts"),p=n("../spread-sheet/src/core/ui/toast/index.ts"),f=n("../spread-sheet/src/core/feature/copyPaste/api/copyPasteAPI.m.ts"),m=n("../spread-sheet/src/core/data/configService/spreadConfig.ts"),h=n("../spread-sheet/src/core/app/permissions/index.ts"),g=function(e,t,n,r){var o,s=arguments.length,a=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var i=e.length-1;i>=0;i--)(o=e[i])&&(a=(s<3?o(a):s>3?o(t,n,a):o(t,n))||a);return s>3&&a&&Object.defineProperty(t,n,a),a},v=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},y=function(e,t){return function(n,r){t(n,r,e)}},w=function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function a(e){try{c(r.next(e))}catch(t){s(t)}}function i(e){try{c(r.throw(e))}catch(t){s(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,i)}c((r=r.apply(e,t||[])).next())}))},j=function(){function e(e,t){this.app=e,this.permissions=t}var t=e.prototype;return t.copy=function(){return w(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t={copyType:d.lb.copy},u.default.apiDoCopy(this.app,t);case 2:case"end":return e.stop()}}),e,this)})))},t.copyMobile=function(){return w(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(0,f.apiDoCopyM)(this.app,{copyType:d.lb.copy});case 1:case"end":return e.stop()}}),e,this)})))},t.copyWithShortCut=function(){return w(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.app.view.canvas.inputManager.isInputtingState()){e.next=2;break}return e.abrupt("return");case 2:if(this.app.sheetStatus.canCopy){e.next=5;break}return(0,p.showToast)(s.ZP.t("文档作者限制了查看者的操作权限，无法复制内容。"),{},{showCloseBtn:!0}),e.abrupt("return");case 5:return e.next=7,this.app.feature.getCopyPaste();case 7:return t=e.sent,e.next=10,this.app.feature.getCopyPasteBase();case 10:n=e.sent,m.q.getConfig("isHistory")&&l.ZP.tdwReport({opername:"doc_excel",module:"revise",action:"upv"}),t.doCopy({copyType:n.CopyType.copy}),l.ZP.tdwReport({module:"cut_copy_paste",opername:"doc_excel_editor",action:"cut_copy_paste_copy_click",ver10:"quick_click"});case 14:case"end":return e.stop()}}),e,this)})))},t.shouldHideCopy=function(){return!(this.app.sheetStatus.canCopy&&!this.app.sheetStatus.containsCanNotReadRange())},t.shouldDisabledCopy=function(){return!this.permissions.sheetStatus.workbookStatus.canCopy},e}();j=g([(0,a.L)({name:"CopyFeature",adapters:[c.L]}),y(0,i.m),y(1,h.H),v("design:paramtypes",["function"===typeof(r="undefined"!==typeof i.m&&i.m)?r:Object,"function"===typeof(o="undefined"!==typeof h.H&&h.H)?o:Object])],j)},"../spread-sheet/src/external/view/ui-layer/create-copy/create-copy-feature-mobile.ts":function(e,t,n){n.r(t),n.d(t,{CreateCopyFeature:function(){return P}}),n("../node_modules/regenerator-runtime/runtime.js"),n("../node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),n("../node_modules/core-js/modules/esnext.reflect.metadata.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.promise.js"),n("../node_modules/core-js/modules/es.regexp.exec.js"),n("../node_modules/core-js/modules/es.string.split.js");var r,o,s=n("../node_modules/i18next/dist/esm/i18next.js"),a=n("../node_modules/@tencent/workbench/lib/esm/decorators/class/feature.js"),i=n("../spread-sheet/src/core/ui/index.ts"),c=n("../node_modules/qs/lib/index.js"),d=n.n(c),u=n("../spread-sheet/src/core/data/configService/spreadConfig.ts"),l=n("../node_modules/@tencent/docs-user-agent/dist/index.js"),p=n.n(l),f=n("../packages/common-utils/src/index.ts"),m=n("../spread-sheet/src/base/storage/storage.ts"),h=n("../packages/report/src/index.ts"),g=n("./node_modules/axios/index.js"),v=n.n(g),y=n("../packages/model/src/spreadsheet/index.ts"),w=n("../spread-sheet/src/base/util/timer.ts"),j=n("../packages/utils/src/safe.ts"),_=n("../spread-sheet/src/core/app/sheetStatus/index.ts"),x=n("../spread-sheet/src/core/utils/config.ts"),b=n("../spread-sheet/src/external/view/workbench/service/show-dialog.ts"),R=n("../spread-sheet/src/external/sheet-adapter/smart-sheet-adapter/constants.ts"),S=n("../spread-sheet/src/adapter/SpreadSheetAppAdapter.ts"),C=n("../spread-sheet/src/core/ark-extensions/extensions/size-limit-dialog.ts"),E=n("../spread-sheet/src/base/util/appConfig.ts"),I=n("../spread-sheet/src/core/utils/url.ts"),M=n("../node_modules/@tencent/tencent_doc_open_url/dist/index.js"),T=n("../spread-sheet/src/core/utils/gray.ts"),O=function(e,t,n,r){var o,s=arguments.length,a=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var i=e.length-1;i>=0;i--)(o=e[i])&&(a=(s<3?o(a):s>3?o(t,n,a):o(t,n))||a);return s>3&&a&&Object.defineProperty(t,n,a),a},D=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},A=function(e,t){return function(n,r){t(n,r,e)}},k=function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function a(e){try{c(r.next(e))}catch(t){s(t)}}function i(e){try{c(r.throw(e))}catch(t){s(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,i)}c((r=r.apply(e,t||[])).next())}))},P=function(){function e(e,t){this.spreadsheet=e,this.sheetStatus=t}var t=e.prototype;return t.createCopy=function(){return k(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(h.ZP.tdwReport({opername:"doc_miniapp",module:"gene_copy",action:"clk"}),!(0,T.c)()){e.next=4;break}return this.requestCreateCopySync(),e.abrupt("return");case 4:return i.Z.toast.showToast(s.ZP.t("生成副本中，请稍候..."),{zIndex:9999},{supportMobile:!0,toolToastCloseTime:5e3}),e.next=7,this.requestCreateCopy();case 7:e.sent||i.Z.toast.showToast(s.ZP.t("生成副本失败"),{zIndex:9999},{supportMobile:!0,toolToastCloseTime:5e3});case 9:case"end":return e.stop()}}),e,this)})))},t.getShowState=function(){return!1!==E.Z.getConfig("menu.clone")&&this.sheetStatus.canCopy},t.getDisabledState=function(){return(0,x.q)()||!this.sheetStatus.workbookStatus.isOnline},t.requestCreateCopy=function(){return k(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t,n,r,o,a,c,d,l,p,f,m,h;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=u.q.getConfig("globalPadId"),n=t.split("$"),r=n[0],o=n[1],e.prev=2,(a=new FormData).append("title",s.ZP.t("副本-{{title}}",{title:this.spreadsheet.getTitle()})),a.append("domain_id",r),a.append("pad_id",o),a.append("xsrf",(0,j.f)()),e.next=10,v()({url:"/cgi-bin/online_docs/copydoc_async",method:"POST",timeout:3e3,data:a});case 10:if(c=e.sent,20010!==(d=c.data).retcode){e.next=16;break}return(0,b.S)(C.iR.SIZE_LIMIT_DUPLICATE_OWNER,C.C2.OWNER_CREATE_COPY),i.Z.toast.showToast(s.ZP.t("生成副本失败"),{zIndex:9999},{supportMobile:!0,toolToastCloseTime:5e3}),e.abrupt("return",!1);case 16:if(l=d.retcode,p=d.doc_id,f=p.domain_id,m=p.pad_id,0===l&&f&&m){e.next=19;break}return e.abrupt("return",!1);case 19:return e.next=21,this.requestCreateCopyLoop(d);case 21:return h=e.sent,e.abrupt("return",h);case 25:return e.prev=25,e.t0=e.catch(2),e.abrupt("return",!1);case 28:case"end":return e.stop()}}),e,this,[[2,25]])})))},t.requestCreateCopyLoop=function(e){var t;return k(this,void 0,void 0,regeneratorRuntime.mark((function r(){var o,a,i,c,d,l,p,f,h,g,y;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:o=e.doc_id,a=o.domain_id,i=o.pad_id,c=e.title,d=e.doc_url,l=u.q.getConfig("title"),p=u.q.getConfig("docType"),f=30;case 4:if(!(f-=1)){r.next=30;break}return r.next=7,(0,w._)(2e3);case 7:return r.prev=7,(h=new FormData).append("domain_id",a),h.append("pad_id",i),h.append("xsrf",(0,j.f)()),r.next=14,v()({url:"/cgi-bin/online_docs/copydoc_loop",method:"post",timeout:3e3,data:h});case 14:if(g=r.sent,10027!==(y=g.data).retcode){r.next=18;break}return r.abrupt("continue",4);case 18:if(0===y.retcode){r.next=20;break}return r.abrupt("return",!1);case 20:try{(0,m.G)("ADD",{domainId:a,localPadId:i,padType:p,title:c||s.ZP.t("副本-{{padTitle}}",{padTitle:l}),url:d,list_item_type:1})}catch(_){null===(t=n.g.log)||void 0===t||t.error("创建副本存到本地失败",e,_)}return this.redirectUrl(d),r.abrupt("return",!0);case 25:return r.prev=25,r.t0=r.catch(7),r.abrupt("return",!1);case 28:r.next=4;break;case 30:return r.abrupt("return",!1);case 31:case"end":return r.stop()}}),r,this,[[7,25]])})))},t.redirectUrl=function(e){var t=/^https:\/\//.test(e);t=(0,f.XK)(e,{newPad:1,newPadType:"clone"}),p().isMiniProgram?n.g.wx.miniProgram.redirectTo({url:"/pages/detail/detail?url="+encodeURIComponent(t)}):(0,M.tencentDocOpenUrlForAll)({url:t,style:3})},t.requestCreateCopySync=function(){var e=u.q.getConfig("padId"),t=u.q.getConfig("domainId"),n=u.q.getConfig("title"),r=d().stringify({title:s.ZP.t("副本-{{title}}",{title:n}),create_type:4,domain_id:t,pad_id:e,xsrf:(0,j.f)(),redirect:1,isMiniProgram:p().isMiniProgram?"1":""}),o=(0,I._)("https://"+E.Z.getConfig("runtime.domainName")+"/cgi-bin/online_docs/createdoc_new",r);return(0,M.tencentDocOpenUrlForAll)({url:o,wxUrl:"/pages/detail/detail?url="+encodeURIComponent(o)})},e}();P=O([(0,a.L)({adapters:[S.L,R.dH]}),A(0,y.ISpreadsheet),A(1,_.T),D("design:paramtypes",["function"===typeof(r="undefined"!==typeof y.ISpreadsheet&&y.ISpreadsheet)?r:Object,"function"===typeof(o="undefined"!==typeof _.T&&_.T)?o:Object])],P)},"../spread-sheet/src/external/view/ui-layer/create-copy/create-copy-feature-pc.ts":function(e,t,n){n.r(t),n.d(t,{CreateCopyFeature:function(){return V}});var r=n("../node_modules/@babel/runtime/helpers/esm/createClass.js"),o=(n("../node_modules/regenerator-runtime/runtime.js"),n("../node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),n("../node_modules/core-js/modules/esnext.reflect.metadata.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.promise.js"),n("../node_modules/core-js/modules/es.regexp.exec.js"),n("../node_modules/core-js/modules/es.string.replace.js"),n("../node_modules/core-js/modules/es.string.starts-with.js"),n("../node_modules/i18next/dist/esm/i18next.js")),s=n("../node_modules/@tencent/workbench/lib/esm/decorators/class/feature.js"),a=n("../node_modules/@tencent/dui/lib/components/Snackbar/index.js"),i=n("../spread-sheet/src/core/network/message-center/adapter/MessageCenterAdapter.interface.ts"),c=n("../spread-sheet/src/base/error/errorCodeModalProxy.ts"),d=n("../spread-sheet/src/external/view/ui-layer/create-copy/utils/external.ts"),u=n("../node_modules/@tencent/docs-user-agent/dist/index.js"),l=n.n(u),p=n("../node_modules/@tencent/tencent_doc_open_url/dist/index.js"),f=n("../spread-sheet/src/base/util/appConfig.ts"),m=l().isWindows&&l().isWeChat,h="//"+f.Z.getConfig("runtime.domainName")+"/scenario/jumppage.html?type=generatecopy";function g(e,t,n){if(n){var r={isFinished:!1,title:o.ZP.t("副本{{title}}",{title:e}),iconType:t,tips:o.ZP.t("正在生成副本...")};localStorage.setItem("jump_generatecopy",JSON.stringify(r)),(0,p.tencentDocOpenUrl)(h)}else a.default.show({message:o.ZP.t("生成副本中，请稍候..."),style:{zIndex:10003},autoClose:!0,duration:5e3})}var v=n("../node_modules/@tencent/netcheck/lib/index.js"),y=n("../node_modules/qs/lib/index.js"),w=n.n(y),j=n("../packages/utils/src/safe.ts"),_=n("../spread-sheet/src/core/utils/url.ts"),x=n("./node_modules/axios/index.js"),b=n.n(x),R=n("../packages/common-utils/src/index.ts"),S=n("../node_modules/lodash/isFunction.js"),C=n.n(S),E=n("../spread-sheet/src/core/app/sheetStatus/index.ts"),I=n("../spread-sheet/src/adapter/SpreadSheetAppAdapter.ts"),M=n("../spread-sheet/src/external/sheet-adapter/smart-sheet-adapter/constants.ts"),T=(n("../node_modules/core-js/modules/es.number.constructor.js"),n("../spread-sheet/src/core/data/configService/spreadConfig.ts")),O=function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function a(e){try{c(r.next(e))}catch(t){s(t)}}function i(e){try{c(r.throw(e))}catch(t){s(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,i)}c((r=r.apply(e,t||[])).next())}))};function D(){return O(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,A();case 2:return t=e.sent,e.next=5,k();case 5:if(!(e.sent<t)){e.next=8;break}return e.abrupt("return",!1);case 8:return e.abrupt("return",!0);case 9:case"end":return e.stop()}}),e)})))}function A(){return O(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t,r,o,s;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t="//"+f.Z.getConfig("runtime.domainName")+"/v2/drive/file/desc",e.prev=1,r=T.q.getConfig("padId"),e.next=5,b().post(t,{file_id:r});case 5:if(o=e.sent,0===(s=o.data).retcode){e.next=9;break}return e.abrupt("return",1/0);case 9:return e.abrupt("return",Number(s.result.size));case 12:return e.prev=12,e.t0=e.catch(1),n.g.log.error("[getCopiedDocSize] 请求出错"),e.abrupt("return",1/0);case 16:case"end":return e.stop()}}),e,null,[[1,12]])})))}function k(){return O(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t,r,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t="//"+f.Z.getConfig("runtime.domainName")+"/v2/file/storage/space",e.prev=1,e.next=4,b().post(t);case 4:if(r=e.sent,0===(o=r.data).retcode){e.next=8;break}return e.abrupt("return",0);case 8:return e.abrupt("return",Number(o.result.unused));case 11:return e.prev=11,e.t0=e.catch(1),n.g.log.error("[getDriveSpaceLeft] 请求出错"),e.abrupt("return",0);case 15:case"end":return e.stop()}}),e,null,[[1,11]])})))}var P,N,L=n("../spread-sheet/src/external/view/workbench/service/show-dialog.ts"),F=n("../spread-sheet/src/core/ark-extensions/extensions/size-limit-dialog.ts"),Z=function(e,t,n,r){var o,s=arguments.length,a=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var i=e.length-1;i>=0;i--)(o=e[i])&&(a=(s<3?o(a):s>3?o(t,n,a):o(t,n))||a);return s>3&&a&&Object.defineProperty(t,n,a),a},U=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},z=function(e,t){return function(n,r){t(n,r,e)}},B=function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function a(e){try{c(r.next(e))}catch(t){s(t)}}function i(e){try{c(r.throw(e))}catch(t){s(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,i)}c((r=r.apply(e,t||[])).next())}))},H={CREATE_COPY:location.protocol+"//"+f.Z.getConfig("runtime.domainName")+"/cgi-bin/online_docs/createdoc_new"},V=function(){function e(e,t){this.messageCenterAdapter=e,this.sheetStatus=t}var t=e.prototype;return t.createCopy=function(){return B(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t,r,s,i,d,u;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!v.network.isOnline){e.next=13;break}return a.default.show({type:"loading",message:o.ZP.t("生成副本中, 请稍候..."),autoClose:!0,duration:5e3}),t=n.g.clientVars,r=t.padId,s=t.domainId,i=t.padType,d=n.g.SpreadsheetApp.spreadsheet.getTitle(),u={docId:r,domainId:s,title:d,docType:i},e.next=7,D();case 7:if(e.sent){e.next=11;break}return(0,L.S)(F.iR.SIZE_LIMIT_DUPLICATE_OWNER,F.C2.OWNER_CREATE_COPY),e.abrupt("return");case 11:return this.isNeedDirectCopy?this.jumpDirectCopy(u):this.jumpPageCopy(u),e.abrupt("return");case 13:this.messageCenterAdapter.socketAdapter.hadShowOfflineTip||(c.Z.client.showNetworkOfflineTip(),this.messageCenterAdapter.socketAdapter.hadShowOfflineTip=!0);case 14:case"end":return e.stop()}}),e,this)})))},t.getDisabledState=function(){return!(this.sheetStatus.canCopy&&!this.sheetStatus.tempStatus.status.isHistory)&&!this.sheetStatus.canEdit},t.jumpDirectCopy=function(e){var t=e.docId,n=e.domainId,r=e.title,s=w().stringify({title:o.ZP.t("副本-{{title}}",{title:r}),create_type:4,domain_id:n,pad_id:t,xsrf:(0,j.f)(),redirect:1,isMiniProgram:l().isMiniProgram?"1":""}),a=(0,_._)(H.CREATE_COPY,s);return(0,p.tencentDocOpenUrlForAll)({url:a,wxUrl:"/pages/detail/detail?url="+encodeURIComponent(a)})},t.jumpPageCopy=function(e){return B(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n,r,s,a,i,c,d,u,l;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.docId,r=e.domainId,s=e.title,a=e.docType,i=w().stringify({title:o.ZP.t("副本-{{title}}",{title:s}),create_type:4,domain_id:r,pad_id:n,xsrf:(0,j.f)()}),c=this.getDirectToJumpPage(),t.prev=3,t.next=6,b().post("/cgi-bin/online_docs/createdoc_new",i);case 6:if(d=t.sent,20010!==(u=d.data).retcode){t.next=11;break}return(0,L.S)(F.iR.SIZE_LIMIT_DUPLICATE_OWNER,F.C2.OWNER_CREATE_COPY),t.abrupt("return");case 11:if(g(s,a,c),0===u.retcode){t.next=14;break}return t.abrupt("return",this.handleCreateCopyFail(s,a,u.retcode));case 14:l=(0,R.r)(u.doc_url)+"?newPad=1&newPadType=clone",this.handleCreateCopySuccess(s,a,l,u.retcode,c),t.next=21;break;case 18:t.prev=18,t.t0=t.catch(3),this.handleCreateCopyFail(s,a,-1);case 21:case"end":return t.stop()}}),t,this,[[3,18]])})))},t.getDirectToJumpPage=function(){return!l().isIPad&&!l().isMobile&&!l().isMiniProgram&&!l().isWxWork||l().isIPad&&(l().isChrome||l().isSafari)&&l().isQQBrowser},t.handleCreateCopySuccess=function(e,t,r,s,a){var i=(0,d.O)();if(l().isIPad&&l().isQQ||!C()(i)&&m)n.g.location.href=r;else if(C()(i))i(null,r,null,"");else{var c={isFinished:!0,title:o.ZP.t("副本-{{title}}",{title:e}),iconType:t,retcode:s,url:r};if(localStorage.setItem("jump_generatecopy",JSON.stringify(c)),!a){var u=r.replace("/","/");if(u=u.startsWith("https://")?u:"https:"+u,l().isMiniProgram)return void window.wx.miniProgram.redirectTo({url:"/pages/detail/detail?url="+encodeURIComponent(u)});(0,p.tencentDocOpenUrlForAll)({url:u})}}},t.handleCreateCopyFail=function(e,t,n){if(C()((0,d.O)())||m)a.default.show({type:"error",message:o.ZP.t("生成副本失败，请稍后重试。"),autoClose:!0,duration:2e3});else{var r={isFinished:!0,title:o.ZP.t("副本-{{title}}",{title:e}),iconType:t,retcode:n||-1,failImg:{src:"generator_fail"},tips:o.ZP.t("生成副本失败，请稍后重试。")};localStorage.setItem("jump_generatecopy",JSON.stringify(r))}},(0,r.Z)(e,[{key:"isNeedDirectCopy",get:function(){return l().isSafari&&l().isMac&&!l().isWxWork||l().isWxMiniProgram}}]),e}();V=Z([(0,s.L)({adapters:[I.L,M.dH]}),z(0,i.Z),z(1,E.T),U("design:paramtypes",["function"===typeof(P="undefined"!==typeof i.Z&&i.Z)?P:Object,"function"===typeof(N="undefined"!==typeof E.T&&E.T)?N:Object])],V)},"../spread-sheet/src/external/view/ui-layer/create-copy/utils/external.ts":function(e,t,n){function r(){var e;return null===(e=n.g.external)||void 0===e?void 0:e.openUrl}n.d(t,{O:function(){return r}})},"../spread-sheet/src/external/view/ui-layer/cut/cut-feature.ts":function(e,t,n){n.r(t),n.d(t,{CutFeature:function(){return h}}),n("../node_modules/regenerator-runtime/runtime.js"),n("../node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),n("../node_modules/core-js/modules/esnext.reflect.metadata.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.promise.js");var r,o=n("../node_modules/@tencent/workbench/lib/esm/decorators/class/feature.js"),s=n("../packages/report/src/index.ts"),a=n("../spread-sheet/src/core/app/SpreadsheetApp.interface.ts"),i=n("../spread-sheet/src/adapter/SpreadSheetAppAdapter.ts"),c=n("../spread-sheet/src/core/feature/copyPaste/interfaces.ts"),d=n("../spread-sheet/src/core/feature/copyPaste/index.ts"),u=n("../spread-sheet/src/core/feature/copyPaste/api/copyPasteAPI.m.ts"),l=function(e,t,n,r){var o,s=arguments.length,a=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var i=e.length-1;i>=0;i--)(o=e[i])&&(a=(s<3?o(a):s>3?o(t,n,a):o(t,n))||a);return s>3&&a&&Object.defineProperty(t,n,a),a},p=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},f=function(e,t){return function(n,r){t(n,r,e)}},m=function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function a(e){try{c(r.next(e))}catch(t){s(t)}}function i(e){try{c(r.throw(e))}catch(t){s(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,i)}c((r=r.apply(e,t||[])).next())}))},h=function(){function e(e){this.app=e}var t=e.prototype;return t.cut=function(){return m(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t={copyType:c.lb.cut},d.default.apiDoCopy(this.app,t);case 2:case"end":return e.stop()}}),e,this)})))},t.cutMobile=function(){return m(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,u.apiDoCopyM)(this.app,{copyType:c.lb.cut});case 2:case"end":return e.stop()}}),e,this)})))},t.cutWithShortCut=function(){return m(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.app.view.canvas.inputManager.isInputtingState()){e.next=2;break}return e.abrupt("return");case 2:if(this.app.sheetStatus.canCopy){e.next=4;break}return e.abrupt("return");case 4:return e.next=6,this.app.feature.getCopyPaste();case 6:return t=e.sent,e.next=9,this.app.feature.getCopyPasteBase();case 9:n=e.sent,t.doCopy({copyType:n.CopyType.cut}),s.ZP.tdwReport({module:"cut_copy_paste",opername:"doc_excel_editor",action:"cut_copy_paste_cut_click",ver10:"quick_click"});case 12:case"end":return e.stop()}}),e,this)})))},e}();h=l([(0,o.L)({name:"CutFeature",adapters:[i.L]}),f(0,a.m),p("design:paramtypes",["function"===typeof(r="undefined"!==typeof a.m&&a.m)?r:Object])],h)},"../spread-sheet/src/external/view/ui-layer/data-validation/data-validation-feature.ts":function(e,t,n){n.r(t),n.d(t,{DataValidationFeature:function(){return N}}),n("../node_modules/regenerator-runtime/runtime.js"),n("../node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),n("../node_modules/core-js/modules/esnext.reflect.metadata.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.promise.js"),n("../node_modules/core-js/modules/es.regexp.exec.js"),n("../node_modules/core-js/modules/es.string.replace.js"),n("../node_modules/core-js/modules/es.function.name.js"),n("../node_modules/core-js/modules/es.number.constructor.js");var r,o,s,a,i,c,d=n("../node_modules/i18next/dist/esm/i18next.js"),u=n("../node_modules/@tencent/containerized/build/main/index.js"),l=n("../node_modules/@tencent/workbench/lib/esm/decorators/class/feature.js"),p=n("../spread-sheet/src/core/behavior/api.interface.ts"),f=n("../spread-sheet/src/core/view/layout/interface/pc-view.ts"),m=n("../spread-sheet/src/core/app/SpreadsheetApp.interface.ts"),h=n("../node_modules/@babel/runtime/helpers/esm/toConsumableArray.js"),g=(n("../node_modules/core-js/modules/es.array.filter.js"),n("../node_modules/core-js/modules/web.dom-collections.for-each.js"),n("../node_modules/core-js/modules/es.array.iterator.js"),n("../node_modules/core-js/modules/web.dom-collections.iterator.js"),n("../node_modules/core-js/modules/es.array.map.js"),n("../spread-sheet/src/core/feature/relateForm/seeker-util.ts")),v=n("../spread-sheet/src/external/view/ui-layer/data-validation/data-validation-constants.ts"),y=n("../spread-sheet/src/adapter/SpreadSheetAppAdapter.ts"),w=function(e,t,n,r){var o,s=arguments.length,a=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var i=e.length-1;i>=0;i--)(o=e[i])&&(a=(s<3?o(a):s>3?o(t,n,a):o(t,n))||a);return s>3&&a&&Object.defineProperty(t,n,a),a},j=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},_=function(e,t){return function(n,r){t(n,r,e)}},x=function(){function e(e,t){this.app=e,this.view=t}var t=e.prototype;return t.getSelectionMetaData=function(e){var t,n,r,o,s,a=this.view.getSelectionWithGridRanges();if(e!==v.tx.COL){if((null===(n=null===a||void 0===a?void 0:a.selectQueue)||void 0===n?void 0:n.length)&&(null===a||void 0===a?void 0:a.selectQueue[0].selectCol)){var i=null===(r=null===a||void 0===a?void 0:a.selectQueue[0].activation)||void 0===r?void 0:r.col;return null===(o=this.app.spreadsheet.activeSheet.data.colMetadata[i])||void 0===o?void 0:o.columnTypeMetadata}if(e===v.tx.MENU||e===v.tx.CONTEXT){var c=this.view.getSelection().activeCell,d=c.rowIndex,u=c.colIndex;return null===(s=this.app.spreadsheet.activeSheet.getCellDataAtPosition(d,u))||void 0===s?void 0:s.getMetadata()}}else for(var l=a.rangeSelections.filter((function(e){return e.isCol})),p=0;p<l.length;p++)for(var f=l[p],m=f.startColIndex;m<=f.endColIndex;m++)if(null===(t=this.app.spreadsheet.activeSheet.data.colMetadata[m])||void 0===t?void 0:t.columnTypeMetadata)return this.app.spreadsheet.activeSheet.data.colMetadata[m].columnTypeMetadata},t.checkAllCellEffectiveValue=function(e,t,n){var r=this,o=[],s=[],a=(0,g.ns)(this.app.spreadsheet.activeSheet),i=e;return n===v.tx.COL&&a&&(i=[],e.forEach((function(e){var t;(t=i).push.apply(t,(0,h.Z)(e.getExcept(a,r.app.spreadsheet.activeSheet)))}))),i.forEach((function(e){var r=[e.startRowIndex,e.endRowIndex],i=[e.startColIndex,e.endColIndex],c=!!a&&n===v.tx.COL&&e.startColIndex>=a.startColIndex&&e.endColIndex<=a.endColIndex;t.forEach((function(e,t){var n;t<r[0]||t>r[1]||a&&c&&t<=(null===a||void 0===a?void 0:a.endRowIndex)||null===(n=null===e||void 0===e?void 0:e.values)||void 0===n||n.map((function(e,n){var r;n<i[0]||n>i[1]||((null===(r=null===e||void 0===e?void 0:e.getEffectiveValue())||void 0===r?void 0:r.value)&&o.push([n,t]),(null===e||void 0===e?void 0:e.getMetadata())&&s.push([n,t]))}))}))})),{hasValue:o,hasMeta:s}},t.getTargetRange=function(){var e;return(null===(e=this.app.view.getSelection())||void 0===e?void 0:e.rangeSelections)||[]},e}(),b=x=w([(0,l.L)({adapters:[y.L]}),_(0,m.m),_(1,f.w),j("design:paramtypes",["function"===typeof(r="undefined"!==typeof m.m&&m.m)?r:Object,"function"===typeof(o="undefined"!==typeof f.w&&f.w)?o:Object])],x),R=n("../spread-sheet/src/external/view/ui-layer/data-validation/data-validation-utils.ts"),S=n("../spread-sheet/src/core/utils/selection.ts"),C=n("../spread-sheet/src/external/view/main/panel/dataValidationPanelNew/utils.ts"),E=n("../spread-sheet/src/core/feature/dataValidation/api/DataValidationUIUtils.ts"),I=n("../node_modules/@tencent/dui/lib/components/Modal/index.js"),M=n("../spread-sheet/src/core/feature/dataValidation/constant.ts"),T=n("../packages/model/src/cell/metadata/CustomDataType.ts"),O=(n("../spread-sheet/src/base/util/domain-config.ts"),n("../packages/model/src/filter-view/utils/grid-range-util.ts")),D=function(e,t,n,r){var o,s=arguments.length,a=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var i=e.length-1;i>=0;i--)(o=e[i])&&(a=(s<3?o(a):s>3?o(t,n,a):o(t,n))||a);return s>3&&a&&Object.defineProperty(t,n,a),a},A=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},k=function(e,t){return function(n,r){t(n,r,e)}},P=function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function a(e){try{c(r.next(e))}catch(t){s(t)}}function i(e){try{c(r.throw(e))}catch(t){s(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,i)}c((r=r.apply(e,t||[])).next())}))},N=function(){function e(e,t,n,r){var o=this;this.app=e,this.view=t,this.dynamicApi=n,this.logic=r,this.firstCustomTypeUsed=!1,this.getActiveCellCustomUIType=function(){var e=o.app.view.getSelectionWithGridRanges().activeCell,t=e.rowIndex,n=e.colIndex,r=o.getActiveCellMetaData(),s=(0,E.Ii)(o.app.spreadsheet.activeSheet,t,n);return(0,C.MR)(s,r)}}var t=e.prototype;return t.showDVPanel=function(){return P(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.app.view.getDataValidationPanel();case 2:e.sent.create();case 3:case"end":return e.stop()}}),e,this)})))},t.handleDVSubMenuClick=function(e){var t,n,r;return P(this,void 0,void 0,regeneratorRuntime.mark((function o(){var s,a,i,c,u,l,p,f,m,h,g,y=this;return regeneratorRuntime.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:if(s=(0,R.RQ)(e.name.replace("data-validation_","")),a=this.logic.getSelectionMetaData(v.tx.CONTEXT),i=(0,T.NI)(Number(s.customTypeId)),c=(null===a||void 0===a?void 0:a.customDataType)!==Number(s.customTypeId),u=this.app.spreadsheet.activeSheet,(l=(0,O.e6)(this.logic.getTargetRange(),u)).length){o.next=10;break}return o.next=9,this.openDVPanel(s);case 9:return o.abrupt("return");case 10:if(p=this.logic.checkAllCellEffectiveValue(l,u.data.rowData,v.tx.CONTEXT),f=!i&&((null===(t=p.hasValue)||void 0===t?void 0:t.length)>0||(null===(n=p.hasMeta)||void 0===n?void 0:n.length)>0),m=i&&(null===(r=p.hasMeta)||void 0===r?void 0:r.length)>0,!c||this.firstCustomTypeUsed||!f&&!m){o.next=19;break}h=M.rX[(null===s||void 0===s?void 0:s.customUITypeId)||""],g=d.ZP.t("设置{{value}}，将覆盖原有单元格内容，继续设置吗？",{value:h.text}),I.default.confirm({title:d.ZP.t("{{value}}提示",{value:h.text}),okText:d.ZP.t("确定"),content:g,onOk:function(){y.openDVPanel(s),y.firstCustomTypeUsed=!0}}),o.next=21;break;case 19:return o.next=21,this.openDVPanel(s);case 21:case"end":return o.stop()}}),o,this)})))},t.openDVPanel=function(e){return P(this,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.app.view.getDataValidationPanel();case 2:t.sent.create({customDataType:Number(null===e||void 0===e?void 0:e.customTypeId)||void 0,templateType:Number(null===e||void 0===e?void 0:e.templateId)||void 0});case 3:case"end":return t.stop()}}),t,this)})))},t.getActiveCellMetaData=function(){var e=(0,S.getSelectedColumns)(this.app),t=e.length?e[0].start:void 0;if(void 0!==t){var n=this.app.spreadsheet.activeSheet.getColProperties(t);if(n)return n.columnTypeMetadata}return this.logic.getSelectionMetaData(v.tx.CONTEXT)},e}();N=D([(0,l.L)({adapters:[y.L]}),k(0,m.m),k(1,f.w),k(2,p.V),A("design:paramtypes",["function"===typeof(s="undefined"!==typeof m.m&&m.m)?s:Object,"function"===typeof(a="undefined"!==typeof f.w&&f.w)?a:Object,"function"===typeof(i="undefined"!==typeof u.RU&&u.RU)?i:Object,"function"===typeof(c="undefined"!==typeof b&&b)?c:Object])],N)},"../spread-sheet/src/external/view/ui-layer/decimal/decimal-feature.ts":function(e,t,n){n.r(t),n.d(t,{DecimalFeature:function(){return f}}),n("../node_modules/regenerator-runtime/runtime.js"),n("../node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),n("../node_modules/core-js/modules/esnext.reflect.metadata.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.promise.js");var r,o=n("../node_modules/@tencent/workbench/lib/esm/decorators/class/feature.js"),s=n("../spread-sheet/src/core/behavior/api.interface.ts"),a=n("../node_modules/@tencent/containerized/build/main/index.js"),i=n("../spread-sheet/src/adapter/SpreadSheetAppAdapter.ts"),c=n("../packages/report/src/index.ts"),d=function(e,t,n,r){var o,s=arguments.length,a=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var i=e.length-1;i>=0;i--)(o=e[i])&&(a=(s<3?o(a):s>3?o(t,n,a):o(t,n))||a);return s>3&&a&&Object.defineProperty(t,n,a),a},u=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},l=function(e,t){return function(n,r){t(n,r,e)}},p=function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function a(e){try{c(r.next(e))}catch(t){s(t)}}function i(e){try{c(r.throw(e))}catch(t){s(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,i)}c((r=r.apply(e,t||[])).next())}))},f=function(){function e(e){this.dynamicApi=e}var t=e.prototype;return t.increaceDecimal=function(){return p(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.dynamicApi.getInstance();case 2:e.sent.increaceDecimal(),c.ZP.tdwReport({opername:"doc_excel_editor",module:"excel_format",action:"clk_rise-decimal-plce",ver12:"new"});case 5:case"end":return e.stop()}}),e,this)})))},t.decreaceDecimal=function(){return p(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.dynamicApi.getInstance();case 2:e.sent.decreaceDecimal(),c.ZP.tdwReport({opername:"doc_excel_editor",module:"excel_format",action:"clk_decline-decimal-plce",ver12:"new"});case 5:case"end":return e.stop()}}),e,this)})))},e}();f=d([(0,o.L)({name:"DecimalFeature",adapters:[i.L]}),l(0,s.V),u("design:paramtypes",["function"===typeof(r="undefined"!==typeof a.RU&&a.RU)?r:Object])],f)},"../spread-sheet/src/external/view/ui-layer/delete-doc-ent/delete-doc-feature.ts":function(e,t,n){n.r(t),n.d(t,{DeleteDocFeature:function(){return h}}),n("../node_modules/regenerator-runtime/runtime.js"),n("../node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.promise.js");var r=n("../node_modules/i18next/dist/esm/i18next.js"),o=n("./node_modules/axios/index.js"),s=n.n(o),a=n("../node_modules/@tencent/workbench/lib/esm/decorators/class/feature.js"),i=n("../spread-sheet/src/core/data/configService/spreadConfig.ts"),c=n("../node_modules/@tencent/dui/lib/components/Loading/index.js"),d=n("../node_modules/@tencent/dui/lib/components/Modal/index.js"),u=n("../packages/report/src/index.ts"),l=n("../spread-sheet/src/base/event/event.ts"),p=n("../node_modules/@tencent/dui/lib/components/Snackbar/index.js"),f=function(e,t,n,r){var o,s=arguments.length,a=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var i=e.length-1;i>=0;i--)(o=e[i])&&(a=(s<3?o(a):s>3?o(t,n,a):o(t,n))||a);return s>3&&a&&Object.defineProperty(t,n,a),a},m=function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function a(e){try{c(r.next(e))}catch(t){s(t)}}function i(e){try{c(r.throw(e))}catch(t){s(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,i)}c((r=r.apply(e,t||[])).next())}))},h=function(){function e(){var e=this;this.deleteRequest=function(){return m(e,void 0,void 0,regeneratorRuntime.mark((function e(){var t,n,r,o,a,c,d,u,l,p,f=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return d=i.q.getConfig("padId"),(u=new FormData).append("selectAll","false"),u.append("async","true"),u.append("func","4"),u.append("doc_id",d),u.append("timestamp",""+(new Date).getTime()),e.prev=7,e.next=10,s().post("/webdisk/file_mgr",u);case 10:l=e.sent,0!==(null===(n=null===(t=null===l||void 0===l?void 0:l.data)||void 0===t?void 0:t.head)||void 0===n?void 0:n.ret)?this.handleDeleteFail():(null===(o=null===(r=null===l||void 0===l?void 0:l.data)||void 0===r?void 0:r.body)||void 0===o?void 0:o.task_id)&&(p=null===(c=null===(a=null===l||void 0===l?void 0:l.data)||void 0===a?void 0:a.body)||void 0===c?void 0:c.task_id,this.queryDeleteFileResult(p,{delay:1e3,retryTimes:5,success:function(){f.handleDeleteSuccess()},fail:function(e){f.handleDeleteFail(e)}})),e.next=17;break;case 14:e.prev=14,e.t0=e.catch(7),this.handleDeleteFail();case 17:case"end":return e.stop()}}),e,this,[[7,14]])})))},this.handleDeleteFail=function(t){var n;null===(n=e.loading)||void 0===n||n.close(),l.ZP.sheetStatus.trigger("userDeletePadFailed"),!0!==t?p.default.show({type:"error",message:r.ZP.t("删除失败"),autoClose:!0,duration:3e3,style:{zIndex:10004}}):console.error("[query over time]: 查询删除结果超时")},this.handleDeleteSuccess=function(){var t,n,r;null===(t=e.loading)||void 0===t||t.close(),(null===(n=null===window||void 0===window?void 0:window.tdocs)||void 0===n?void 0:n.closeWindow)?null===(r=null===window||void 0===window?void 0:window.tdocs)||void 0===r||r.closeWindow():window.close()}}var t=e.prototype;return t.handleClick=function(){var e=this;d.default.confirm({title:r.ZP.t("删除文档"),content:r.ZP.t("删除后，其他文档成员也将无法打开此文档。"),onOk:function(){var t,n,o,s;u.ZP.kvrOss({itemname:"timeline_web_menu_delete",biz:"personal",Channel1:"sheet"});var a=i.q.getConfig("padId");l.ZP.sheetStatus.trigger("userDeletePad"),e.deleteRequest(),e.loading=c.default.show({tip:r.ZP.t("删除中")}),null===(n=null===(t=window.tdocs)||void 0===t?void 0:t.removeConv)||void 0===n||n.call(t,{doc_id:a,conv_id:""}),null===(s=null===(o=null===window||void 0===window?void 0:window.tdocs)||void 0===o?void 0:o.monitorDocConv)||void 0===s||s.call(o,{doc_id:a,type:2})},cancelText:r.ZP.t("取消"),okText:r.ZP.t("删除")})},t.getHideState=function(){var e=i.q.getConfig("isOwner"),t=i.q.getConfig("canDelete");return!(e||t)},t.queryDeleteFileResult=function(e,t){var n=this,r=t.delay,o=t.retryTimes,s=t.success,a=t.fail;o<1?null===a||void 0===a||a(!0):this.queryDeleteFileResultRequest(e).then((function(t){var i,c,d,u;if(!0===(null===(c=null===(i=null===t||void 0===t?void 0:t.data)||void 0===i?void 0:i.body)||void 0===c?void 0:c.finish))return 0===(null===(u=null===(d=null===t||void 0===t?void 0:t.data)||void 0===d?void 0:d.body)||void 0===u?void 0:u.err_code)?void(null===s||void 0===s||s()):void(null===a||void 0===a||a());setTimeout((function(){n.queryDeleteFileResult(e,{success:s,fail:a,delay:r+1e3,retryTimes:o-1})}),r)})).catch((function(e){null===a||void 0===a||a(e)}))},t.queryDeleteFileResultRequest=function(e){return s()({method:"POST",url:"/diskfile/querytaskresult",params:{task_id:e}}).then((function(e){return e}))},e}();h=f([(0,a.L)({name:"DeleteDocFeature"})],h)},"../spread-sheet/src/external/view/ui-layer/delete-range/delete-range-feature.ts":function(e,t,n){n.r(t),n.d(t,{DeleteRangeFeature:function(){return m}}),n("../node_modules/regenerator-runtime/runtime.js"),n("../node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),n("../node_modules/core-js/modules/esnext.reflect.metadata.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.promise.js"),n("../node_modules/core-js/modules/es.function.name.js");var r,o=n("../node_modules/@tencent/workbench/lib/esm/decorators/class/feature.js"),s=n("../spread-sheet/src/core/app/SpreadsheetApp.interface.ts"),a=n("../spread-sheet/src/adapter/SpreadSheetAppAdapter.ts"),i=n("../spread-sheet/src/core/behavior/request/range/common/index.ts"),c=n("../spread-sheet/src/core/behavior/request/range/config.ts"),d=n("../spread-sheet/src/external/view/schema/contextmenu-key.ts"),u=function(e,t,n,r){var o,s=arguments.length,a=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var i=e.length-1;i>=0;i--)(o=e[i])&&(a=(s<3?o(a):s>3?o(t,n,a):o(t,n))||a);return s>3&&a&&Object.defineProperty(t,n,a),a},l=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},p=function(e,t){return function(n,r){t(n,r,e)}},f=function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function a(e){try{c(r.next(e))}catch(t){s(t)}}function i(e){try{c(r.throw(e))}catch(t){s(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,i)}c((r=r.apply(e,t||[])).next())}))},m=function(){function e(e){this.app=e}var t=e.prototype;return t.deleteRange=function(e){return f(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n,r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=(0,i.I9)(this.app),r=e.name===d.B.DELETE_RANGE_LEFT?c._z.LEFT:c._z.UP,this.app.requestApi.deleteRange({range:n,direction:r});case 3:case"end":return t.stop()}}),t,this)})))},t.getDeleteRangeDisabled=function(e){var t=this.app,n=t.spreadsheet,r=t.view,o=t.sheetStatus;return!(0,i.N2)(n.activeSheet,r.canvas.normalSelectData,o,e,c.Us.DELETE)},e}();m=u([(0,o.L)({name:"DeleteRangeFeature",adapters:[a.L]}),p(0,s.m),l("design:paramtypes",["function"===typeof(r="undefined"!==typeof s.m&&s.m)?r:Object])],m)},"../spread-sheet/src/external/view/ui-layer/delete-row-col/delete-row-col-feature.ts":function(e,t,n){n.r(t),n.d(t,{DeleteRowColFeature:function(){return j}}),n("../node_modules/regenerator-runtime/runtime.js"),n("../node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),n("../node_modules/core-js/modules/esnext.reflect.metadata.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.promise.js");var r,o,s,a,i=n("../node_modules/@tencent/workbench/lib/esm/decorators/class/feature.js"),c=n("../spread-sheet/src/core/view/layout/interface/pc-view.ts"),d=n("../node_modules/@tencent/containerized/build/main/index.js"),u=n("../spread-sheet/src/core/behavior/api.interface.ts"),l=n("../spread-sheet/src/adapter/SpreadSheetAppAdapter.ts"),p=n("../packages/model/src/range/index.ts"),f=n("../packages/model/src/spreadsheet/Spreadsheet.interface.ts"),m=n("../spread-sheet/src/core/workbench/common/auth-range-service.ts"),h=n("../spread-sheet/src/external/view/schema/contextmenu-key.ts"),g=function(e,t,n,r){var o,s=arguments.length,a=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var i=e.length-1;i>=0;i--)(o=e[i])&&(a=(s<3?o(a):s>3?o(t,n,a):o(t,n))||a);return s>3&&a&&Object.defineProperty(t,n,a),a},v=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},y=function(e,t){return function(n,r){t(n,r,e)}},w=function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function a(e){try{c(r.next(e))}catch(t){s(t)}}function i(e){try{c(r.throw(e))}catch(t){s(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,i)}c((r=r.apply(e,t||[])).next())}))},j=function(){function e(e,t,n,r){var o=this;this.dynamicApi=e,this.spreadsheet=t,this.view=n,this.authRangeService=r,this.authRangeService.addRule(h.B.DELETE_ROW,{getRanges:function(){return[o.getRowAuthRange()]}}),this.authRangeService.addRule(h.B.DELETE_COL,{getRanges:function(){return[o.getColAuthRange()]}})}var t=e.prototype;return t.deleteRow=function(){return w(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.dynamicApi.getInstance();case 2:e.sent.deleteRows();case 4:case"end":return e.stop()}}),e,this)})))},t.deleteCol=function(){return w(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.dynamicApi.getInstance();case 2:e.sent.deleteColumns();case 4:case"end":return e.stop()}}),e,this)})))},t.getRowAuthRange=function(){var e,t,n,r=(null===(n=null===(t=(e=this.view).getSelection)||void 0===t?void 0:t.call(e).rangeSelections[0])||void 0===n?void 0:n.startRowIndex)||p.DEFAULT_DIMENSION_INDEX;return new p.GridRange(this.spreadsheet.activeSheetId,r,r,p.DEFAULT_DIMENSION_INDEX,p.DEFAULT_DIMENSION_INDEX)},t.getColAuthRange=function(){var e,t,n,r=(null===(n=null===(t=(e=this.view).getSelection)||void 0===t?void 0:t.call(e).rangeSelections[0])||void 0===n?void 0:n.startColIndex)||p.DEFAULT_DIMENSION_INDEX;return new p.GridRange(this.spreadsheet.activeSheetId,p.DEFAULT_DIMENSION_INDEX,p.DEFAULT_DIMENSION_INDEX,r,r)},e}();j=g([(0,i.L)({adapters:[l.L]}),y(0,u.V),y(1,f.V),y(2,c.w),v("design:paramtypes",["function"===typeof(r="undefined"!==typeof d.RU&&d.RU)?r:Object,"function"===typeof(o="undefined"!==typeof f.V&&f.V)?o:Object,"function"===typeof(s="undefined"!==typeof c.w&&c.w)?s:Object,"function"===typeof(a="undefined"!==typeof m.Z&&m.Z)?a:Object])],j)},"../spread-sheet/src/external/view/ui-layer/dial-number/dial-number-feature.tsx":function(e,t,n){n.r(t),n.d(t,{DialNumberFeature:function(){return x}});var r,o=n("../node_modules/@babel/runtime/helpers/esm/toConsumableArray.js"),s=(n("../node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),n("../node_modules/core-js/modules/esnext.reflect.metadata.js"),n("../node_modules/core-js/modules/web.dom-collections.for-each.js"),n("../node_modules/core-js/modules/es.regexp.exec.js"),n("../node_modules/core-js/modules/es.string.replace.js"),n("../node_modules/core-js/modules/es.array.filter.js"),n("../node_modules/core-js/modules/es.string.split.js"),n("../node_modules/core-js/modules/es.array.concat.js"),n("react")),a=n.n(s),i=n("../node_modules/i18next/dist/esm/i18next.js"),c=n("../node_modules/@tencent/workbench/lib/esm/decorators/class/feature.js"),d=n("../packages/report/src/index.ts"),u=n("../node_modules/@tencent/dui-mobile/lib/components/ActionSheet/index.js"),l=n("../node_modules/@babel/runtime/helpers/esm/inheritsLoose.js"),p=function(e){function t(t){var n;return(n=e.call(this,t)||this).phoneNumber=t.phoneNumber,n}return(0,l.Z)(t,e),t.prototype.render=function(){return s.createElement("div",{className:"dial-phone-container"},s.createElement("span",{className:"dial-phone-title-name"}),s.createElement("span",{className:"dial-phone-description-name"},this.phoneNumber))},t}(s.Component),f=n("../spread-sheet/src/core/app/SpreadsheetApp.interface.ts"),m=n("../spread-sheet/src/base/util/phone-number.ts"),h=n("../spread-sheet/src/adapter/SpreadSheetAppAdapter.ts"),g=n("../node_modules/@tencent/docs-user-agent/dist/index.js"),v=n.n(g),y=n("../spread-sheet/src/base/util/domain-config.ts"),w=function(e,t,n,r){var o,s=arguments.length,a=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var i=e.length-1;i>=0;i--)(o=e[i])&&(a=(s<3?o(a):s>3?o(t,n,a):o(t,n))||a);return s>3&&a&&Object.defineProperty(t,n,a),a},j=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},_=function(e,t){return function(n,r){t(n,r,e)}},x=function(){function e(e){var t=this;this.app=e,this.checkPhoneNumber=function(){var e;if(t.app.sheetStatus.containsPrivateCell())return!1;var n=t.app.view.canvas.normalSelectData,r=n.activeRow,o=n.activeCol;return t.editValue=null,void 0!==r&&void 0!==o&&(t.editValue=null===(e=t.app.spreadsheet.activeSheet.getCellDataAtPosition(r,o))||void 0===e?void 0:e.getEditValue()),t.checkPhoneNumberCenter(t.editValue)},this.checkPhoneNumberCenter=function(e){if(!e)return!1;var n=t.handleStringCenter(e),r=[];return n.forEach((function(e){var t=(0,m.un)(e);if((0,m.AI)(t).isValid){var n=String(t).replace(/(\s)/g,"");r.push(n)}})),!!r.length&&(t.validNumberArray=r,!0)},this.handleStringCenter=function(e){return e.split(/(\t)|(\n)|(\s{2,})/g).filter(Boolean)},this.filterStringCenter=function(e){return e.replace(/([\u4e00-\u9fa5])|([（）])/g,"")},this.dialNumberCenter=function(){var e=t.validNumberArray.length;return e?1===e?(0,m.YH)(t.validNumberArray[0]):void t.showActionSheetPanal():null},this.showActionSheetPanal=function(){var e=t.getPhoneNumberOptionsList();u.default.show({options:[{id:"description",title:i.ZP.t("ui|dial number"),titleStyle:{fontSize:"14px"},disabled:!0}].concat((0,o.Z)(e)),onClickAction:function(e){(0,m.YH)(e)},onCancel:t.onCancel})},this.getPhoneNumberOptionsList=function(){var e=[],n={};return t.validNumberArray.forEach((function(r){var o=t.filterStringCenter(r),s={id:o,title:a().createElement(p,{phoneNumber:o}),titleClassName:"dial-number-phone-title-span",disabled:!1};n[r]||(n[r]=r,e.push(s))})),e}}var t=e.prototype;return t.dialNumber=function(){this.dialNumberCenter(),d.ZP.tdwReport({module:"excel_mob_menu",opername:"doc_excel_dial",action:"mob_clk_dial"})},t.hideContextMenu=function(){return!this.checkPhoneNumber()||v().isWxWork&&v().isIOS&&y.xc},t.onCancel=function(){d.ZP.tdwReport({module:"excel_mob_menu",opername:"doc_excel_dial",action:"mob_clk_dial_cancel"})},e}();x=w([(0,c.L)({adapters:[h.L]}),_(0,f.m),j("design:paramtypes",["function"===typeof(r="undefined"!==typeof f.m&&f.m)?r:Object])],x)},"../spread-sheet/src/external/view/ui-layer/download-file/download-file-feature.ts":function(e,t,n){n.r(t),n.d(t,{DownloadFileFeature:function(){return x}}),n("../node_modules/regenerator-runtime/runtime.js"),n("../node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),n("../node_modules/core-js/modules/esnext.reflect.metadata.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.promise.js");var r,o,s=n("../node_modules/i18next/dist/esm/i18next.js"),a=n("../node_modules/@tencent/workbench/lib/esm/decorators/class/feature.js"),i=n("../spread-sheet/src/core/view/layout/interface/pc-view.ts"),c=n("../packages/model/src/spreadsheet/index.ts"),d=n("../spread-sheet/src/core/data/converter/tencentdoc/utils/files.ts"),u=n("./node_modules/axios/index.js"),l=n.n(u),p=n("../node_modules/@tencent/dui/lib/components/Snackbar/index.js"),f=n("../spread-sheet/src/external/export/download.ts"),m=n("../spread-sheet/src/core/data/configService/spreadConfig.ts"),h=n("../spread-sheet/src/adapter/SpreadSheetAppAdapter.ts"),g=n("../node_modules/@tencent/netcheck/lib/index.js"),v=function(e,t,n,r){var o,s=arguments.length,a=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var i=e.length-1;i>=0;i--)(o=e[i])&&(a=(s<3?o(a):s>3?o(t,n,a):o(t,n))||a);return s>3&&a&&Object.defineProperty(t,n,a),a},y=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},w=function(e,t){return function(n,r){t(n,r,e)}},j=function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function a(e){try{c(r.next(e))}catch(t){s(t)}}function i(e){try{c(r.throw(e))}catch(t){s(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,i)}c((r=r.apply(e,t||[])).next())}))},_="download-file-button-toast",x=function(){function e(e,t){this.spreadsheet=e,this.view=t,this.files=[],this.toast=null}var t=e.prototype;return t.getFileCount=function(){var e=this.spreadsheet.activeSheet,t=this.view.getSelection(),n=(0,d.kZ)(e,t.rangeSelections);return this.files=n,n.length},t.hasFile=function(){var e=this.spreadsheet.activeSheet,t=this.view.getSelection();return(0,d.Ey)(e,t.rangeSelections)},t.reportDownloadPhotos=function(e){(0,d.Qe)(e,this.view.getSelection())},t.startDownloadTask=function(){return j(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t,n,r=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.stopQuery(),this.getFileCount(),g.network.isOnline){e.next=5;break}return p.default.show({message:s.ZP.t("网络异常，离线编辑中，请在网络恢复后试试。"),id:_}),e.abrupt("return");case 5:return e.prev=5,e.next=8,l().post("/v1/export/sheet/image/"+m.q.getConfig("padId"),this.files,{params:{domainId:m.q.getConfig("domainId")}});case 8:if(t=e.sent,n=t.data,this.checkCgiResult(n)){e.next=12;break}return e.abrupt("return");case 12:this.toast=p.default.show({message:s.ZP.t("正在导出{{length}}个附件，请稍候...{{progress}}%",{progress:0,length:this.files.length}),autoClose:!1,id:_}),this.startQueryProgress(n.operationId),(0,f.jh)(_,this.files.length,(function(e){var t;return null===(t=r.toast)||void 0===t?void 0:t.update({message:s.ZP.t("正在导出{{length}}个附件，请稍候...{{progress}}%",{progress:e,length:r.files.length})})})),e.next=20;break;case 17:e.prev=17,e.t0=e.catch(5),this.handleNetworkError(e.t0);case 20:case"end":return e.stop()}}),e,this,[[5,17]])})))},t.startQueryProgress=function(e){return j(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n,r=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=Date.now(),this.queryPollingId=setInterval((function(){return j(r,void 0,void 0,regeneratorRuntime.mark((function t(){var r,o;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(Date.now()-n>18e4)){t.next=5;break}return this.stopQuery(),p.default.show({message:s.ZP.t("导出超时，请重试。"),autoClose:!1,action:s.ZP.t("确定"),id:_}),(0,d.Qe)("fail",this.view.getSelection()),t.abrupt("return");case 5:return t.prev=5,t.next=8,l().get("/v1/export/sheet/image/progress/"+m.q.getConfig("padId"),{params:{operationId:e}});case 8:if(r=t.sent,o=r.data,this.checkCgiResult(o)){t.next=12;break}return t.abrupt("return");case 12:o.url&&(this.stopQuery(),(0,f.y5)(o.url),p.default.show({message:s.ZP.t("导出成功"),type:"success",id:_}),(0,d.Qe)("success",this.view.getSelection())),t.next=18;break;case 15:t.prev=15,t.t0=t.catch(5),this.handleNetworkError(t.t0);case 18:case"end":return t.stop()}}),t,this,[[5,15]])})))}),3e3);case 2:case"end":return t.stop()}}),t,this)})))},t.stopQuery=function(){var e;clearInterval(this.queryPollingId),(0,f.PZ)(_),null===(e=this.toast)||void 0===e||e.close(),this.toast=null},t.handleNetworkError=function(e){var t;this.stopQuery(),console.error(e),p.default.show({message:e.response?s.ZP.t("出现网络错误({{status}})，导出失败，请稍候重试。",{status:null===(t=e.response)||void 0===t?void 0:t.status}):s.ZP.t("网络超时，导出不成功，请在网络恢复后试试。"),id:_})},t.checkCgiResult=function(e){return 0===e.ret||(this.stopQuery(),p.default.show({message:e.msg,id:_,action:s.ZP.t("确定"),autoClose:!1}),!1)},e}();x=v([(0,a.L)({adapters:[h.L]}),w(0,c.ISpreadsheet),w(1,i.w),y("design:paramtypes",["function"===typeof(r="undefined"!==typeof c.ISpreadsheet&&c.ISpreadsheet)?r:Object,"function"===typeof(o="undefined"!==typeof i.w&&i.w)?o:Object])],x)},"../spread-sheet/src/external/view/ui-layer/edit-history/edit-history-feature-mobile.ts":function(e,t,n){n.r(t),n.d(t,{EditHistoryFeature:function(){return f}}),n("../node_modules/regenerator-runtime/runtime.js"),n("../node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),n("../node_modules/core-js/modules/esnext.reflect.metadata.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.promise.js");var r,o,s=n("../node_modules/@tencent/workbench/lib/esm/decorators/class/feature.js"),a=n("../spread-sheet/src/core/app/sheetStatus/index.ts"),i=n("../spread-sheet/src/core/app/SpreadsheetApp.interface.ts"),c=n("../spread-sheet/src/external/view/ui-layer/edit-history/report-utils.ts"),d=function(e,t,n,r){var o,s=arguments.length,a=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var i=e.length-1;i>=0;i--)(o=e[i])&&(a=(s<3?o(a):s>3?o(t,n,a):o(t,n))||a);return s>3&&a&&Object.defineProperty(t,n,a),a},u=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},l=function(e,t){return function(n,r){t(n,r,e)}},p=function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function a(e){try{c(r.next(e))}catch(t){s(t)}}function i(e){try{c(r.throw(e))}catch(t){s(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,i)}c((r=r.apply(e,t||[])).next())}))},f=function(){function e(e,t){this.sheetStatus=e,this.app=t}var t=e.prototype;return t.showEditHistory=function(){return p(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.app.history.getInstance();case 2:e.sent.show(),(0,c.S)();case 4:case"end":return e.stop()}}),e,this)})))},t.getShouldHideInPad=function(){return this.sheetStatus.canEdit,!0},e}();f=d([(0,s.L)({name:"EditHistoryFeature"}),l(0,a.T),l(1,i.m),u("design:paramtypes",["function"===typeof(r="undefined"!==typeof a.T&&a.T)?r:Object,"function"===typeof(o="undefined"!==typeof i.m&&i.m)?o:Object])],f)},"../spread-sheet/src/external/view/ui-layer/edit-history/edit-history-feature-pc.ts":function(e,t,n){n.r(t),n.d(t,{EditHistoryFeature:function(){return g}}),n("../node_modules/regenerator-runtime/runtime.js"),n("../node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),n("../node_modules/core-js/modules/esnext.reflect.metadata.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.promise.js");var r,o,s=n("../node_modules/i18next/dist/esm/i18next.js"),a=n("../node_modules/@tencent/workbench/lib/esm/decorators/class/feature.js"),i=n("../spread-sheet/src/core/app/sheetStatus/index.ts"),c=n("../spread-sheet/src/core/app/SpreadsheetApp.interface.ts"),d=(n("../spread-sheet/src/base/util/domain-config.ts"),n("../spread-sheet/src/adapter/SpreadSheetAppAdapter.ts")),u=n("../spread-sheet/src/external/sheet-adapter/smart-sheet-adapter/constants.ts"),l=n("../spread-sheet/src/external/view/ui-layer/edit-history/report-utils.ts"),p=function(e,t,n,r){var o,s=arguments.length,a=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var i=e.length-1;i>=0;i--)(o=e[i])&&(a=(s<3?o(a):s>3?o(t,n,a):o(t,n))||a);return s>3&&a&&Object.defineProperty(t,n,a),a},f=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},m=function(e,t){return function(n,r){t(n,r,e)}},h=function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function a(e){try{c(r.next(e))}catch(t){s(t)}}function i(e){try{c(r.throw(e))}catch(t){s(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,i)}c((r=r.apply(e,t||[])).next())}))},g=function(){function e(e,t){this.sheetStatus=e,this.app=t}var t=e.prototype;return t.showEditHistory=function(){return h(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.app.history.getInstance();case 2:e.sent.show(),(0,l.S)();case 4:case"end":return e.stop()}}),e,this)})))},t.getContent=function(){return s.ZP.t("修订记录")},t.getDisabledState=function(){return!this.sheetStatus.canEdit},e}();g=p([(0,a.L)({adapters:[d.L,u.dH]}),m(0,i.T),m(1,c.m),f("design:paramtypes",["function"===typeof(r="undefined"!==typeof i.T&&i.T)?r:Object,"function"===typeof(o="undefined"!==typeof c.m&&c.m)?o:Object])],g)},"../spread-sheet/src/external/view/ui-layer/edit-history/report-utils.ts":function(e,t,n){n.d(t,{S:function(){return o}});var r=n("../packages/report/src/index.ts");function o(){r.ZP.tdwReport({opername:"doc_excel_editor",module:"excel_drop-menu",action:"clk_history"})}},"../spread-sheet/src/external/view/ui-layer/edit-menu-ent/edit-menu-feature.ts":function(e,t,n){n.r(t),n.d(t,{EditMenuFeature:function(){return i}}),n("../node_modules/core-js/modules/es.object.get-own-property-descriptor.js");var r=n("../node_modules/@tencent/workbench/lib/esm/decorators/class/feature.js"),o=n("../node_modules/@tencent/docs-user-agent/dist/index.js"),s=n.n(o),a=function(e,t,n,r){var o,s=arguments.length,a=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var i=e.length-1;i>=0;i--)(o=e[i])&&(a=(s<3?o(a):s>3?o(t,n,a):o(t,n))||a);return s>3&&a&&Object.defineProperty(t,n,a),a},i=function(){function e(){}var t=e.prototype;return t.handleClick=function(){},t.hideEditMenu=function(){return!s().isWxWork},e}();i=a([(0,r.L)({name:"EditMenuFeature"})],i)},"../spread-sheet/src/external/view/ui-layer/enter-edit/enter-edit-feature.ts":function(e,t,n){n.r(t),n.d(t,{EnterEditFeature:function(){return I}}),n("../node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),n("../node_modules/core-js/modules/esnext.reflect.metadata.js");var r,o,s,a,i,c=n("../node_modules/i18next/dist/esm/i18next.js"),d=n("../node_modules/@tencent/dui-mobile/lib/components/Snackbar/index.js"),u=n("../packages/report/src/index.ts"),l=n("../node_modules/@tencent/workbench/lib/esm/decorators/class/feature.js"),p=n("../node_modules/@tencent/workbench/lib/esm/services/mobile-toolbar/mobile-toolbar-service.js"),f=n("../packages/model/src/spreadsheet/index.ts"),m=n("../spread-sheet/src/base/event/event.ts"),h=n("../spread-sheet/src/core/view/layout/interface/pc-view.ts"),g=n("../spread-sheet/src/adapter/SpreadSheetAppAdapter.ts"),v=n("../spread-sheet/src/base/event/eventName.ts"),y=n("../spread-sheet/src/base/error/errorCodeModalProxy.ts"),w=n("../spread-sheet/src/base/error/index.ts"),j=n("../spread-sheet/src/external/view/schema/mobile-toolbar-schema.ts"),_=n("../spread-sheet/src/core/app/sheetStatus/index.ts"),x=n("../spread-sheet/src/core/view/config/default.ts"),b=n("../packages/common-utils/src/index.ts"),R=n("../packages/model/src/cell/metadata/CustomDataType.ts"),S=function(e,t,n,r){var o,s=arguments.length,a=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var i=e.length-1;i>=0;i--)(o=e[i])&&(a=(s<3?o(a):s>3?o(t,n,a):o(t,n))||a);return s>3&&a&&Object.defineProperty(t,n,a),a},C=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},E=function(e,t){return function(n,r){t(n,r,e)}},I=function(){function e(e,t,n,r,o){this.view=e,this.spreadsheet=t,this.event=n,this.sheetStatus=r,this.mobileToolbarService=o}var t=e.prototype;return t.edit=function(){var e;null===(e=this.view.canvas.inputManager)||void 0===e||e.focus()},t.isCellImage=function(){var e=this.view.canvas.normalSelectData,t=e.activeRow,n=e.activeCol;return!(n<0||t<0)&&Boolean(this.spreadsheet.activeSheet.getCellImage(t,n))},t.shouldPreventInput=function(){var e=this.view.canvas.normalSelectData,t=e.activeRow,n=e.activeCol;return(0,R.wK)(this.spreadsheet.activeSheet,t,n)},t.editView=function(){this.canEdit()&&(this.event.view.trigger(v.W1.ENTER_INPUT_STATUS),this.sheetStatus.canEdit&&(this.mobileToolbarService.openPanel(j.w$.FONT_STYLE),this.scrollIntoView()),u.ZP.tdwReport({opername:"doc_excel_editor",module:"bottom_bar",action:"edit_click"}))},t.scrollIntoView=function(){var e=this.view.getSelectionWithGridRanges();this.view.canvas.scrollApi.scrollToVisible({row:e.activeCell.rowIndex,col:e.activeCell.colIndex,x:16/this.view.canvas.scale.scale,y:16/this.view.canvas.scale.scale,padding:{bottom:(x.oc+x.vN)/this.view.canvas.scale.scale}})},t.canEdit=function(){var e,t;return this.sheetStatus.canEditExceptWorkbookStatus?this.sheetStatus.canEditExceptRangeStatus?!(!this.sheetStatus.canEdit&&this.sheetStatus.canEditExceptRangeStatus)||(d.default.show({type:"info",message:c.ZP.t("此范围受保护，你没有编辑权限。"),autoClose:!0}),!1):(null===(t=null===(e=this.view.header)||void 0===e?void 0:e.component)||void 0===t||t.apply.showApplyGuide(),!1):((0,b.gr)()||d.default.show({type:"info",message:c.ZP.t("请切换屏幕方向后编辑"),autoClose:!0}),this.sheetStatus.workbookStatus.status.full&&y.Z.server.showFullMemberTip(w.B.FULL_MEMBER),!1)},e}();I=S([(0,l.L)({adapters:[g.L]}),E(0,h.w),E(1,f.ISpreadsheet),E(2,m.l9),E(3,_.T),C("design:paramtypes",["function"===typeof(r="undefined"!==typeof h.w&&h.w)?r:Object,"function"===typeof(o="undefined"!==typeof f.ISpreadsheet&&f.ISpreadsheet)?o:Object,"function"===typeof(s="undefined"!==typeof m.l9&&m.l9)?s:Object,"function"===typeof(a="undefined"!==typeof _.T&&_.T)?a:Object,"function"===typeof(i="undefined"!==typeof p.n&&p.n)?i:Object])],I)},"../spread-sheet/src/external/view/ui-layer/exit-collab-ent/exit-collab-feature.ts":function(e,t,n){n.r(t),n.d(t,{ExitCollabFeature:function(){return h}}),n("../node_modules/regenerator-runtime/runtime.js"),n("../node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),n("../node_modules/core-js/modules/esnext.reflect.metadata.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.promise.js"),n("../node_modules/core-js/modules/es.array.find.js");var r,o=n("../node_modules/i18next/dist/esm/i18next.js"),s=n("../node_modules/@tencent/dui/lib/components/Modal/index.js"),a=n("../node_modules/@tencent/workbench/lib/esm/decorators/class/feature.js"),i=n("../spread-sheet/src/core/view/layout/interface/pc-view.ts"),c=n("../spread-sheet/src/core/data/configService/spreadConfig.ts"),d=n("../packages/report/src/index.ts"),u=n("../spread-sheet/src/base/util/appConfig.ts"),l=function(e,t,n,r){var o,s=arguments.length,a=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var i=e.length-1;i>=0;i--)(o=e[i])&&(a=(s<3?o(a):s>3?o(t,n,a):o(t,n))||a);return s>3&&a&&Object.defineProperty(t,n,a),a},p=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},f=function(e,t){return function(n,r){t(n,r,e)}},m=function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function a(e){try{c(r.next(e))}catch(t){s(t)}}function i(e){try{c(r.throw(e))}catch(t){s(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,i)}c((r=r.apply(e,t||[])).next())}))},h=function(){function e(e){this.view=e}var t=e.prototype;return t.handleClick=function(){var e=this;s.default.confirm({content:o.ZP.t("退出后不会通知文档中的其他成员，且不再接收此文档的消息"),onOk:function(){return m(e,void 0,void 0,regeneratorRuntime.mark((function e(){var t,n,r,o,s,a,i,l,p;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return d.ZP.kvrOss({itemname:"timeline_web_menu_exit",biz:"personal",Channel1:"sheet"}),p=c.q.getConfig("padId"),e.next=4,null===(n=null===(t=this.view.canvas.collabCenter)||void 0===t?void 0:t.onQuitCollab)||void 0===n?void 0:n.call(t);case 4:e.sent&&(null===(o=null===(r=window.tdocs)||void 0===r?void 0:r.removeConv)||void 0===o||o.call(r,{doc_id:p,conv_id:""}),null===(a=null===(s=null===window||void 0===window?void 0:window.tdocs)||void 0===s?void 0:s.monitorDocConv)||void 0===a||a.call(s,{doc_id:p,type:2}),null===(l=null===(i=window.tdocs)||void 0===i?void 0:i.closeWindow)||void 0===l||l.call(i),location.href="https://"+u.Z.getConfig("runtime.domainName"));case 6:case"end":return e.stop()}}),e,this)})))},cancelText:o.ZP.t("取消"),okText:o.ZP.t("确认")})},t.getHiddenState=function(){var e,t;return!!c.q.getConfig("isOwner")||!((null===(t=null===(e=this.view.canvas.collabCenter)||void 0===e?void 0:e.getCollabs)||void 0===t?void 0:t.call(e))||[]).find((function(e){return e.isSelf}))},e}();h=l([(0,a.L)({name:"ExitCollabFeature"}),f(0,i.w),p("design:paramtypes",["function"===typeof(r="undefined"!==typeof i.w&&i.w)?r:Object])],h)},"../spread-sheet/src/external/view/ui-layer/export-file/export-file-feature-mobile.ts":function(e,t,n){n.r(t),n.d(t,{ExportFileFeatureMobile:function(){return _}}),n("../node_modules/regenerator-runtime/runtime.js"),n("../node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),n("../node_modules/core-js/modules/esnext.reflect.metadata.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.promise.js");var r,o,s=n("../node_modules/@tencent/workbench/lib/esm/decorators/class/feature.js"),a=n("../node_modules/@tencent/docs-user-agent/dist/index.js"),i=n.n(a),c=n("../spread-sheet/src/core/app/SpreadsheetApp.interface.ts"),d=n("../spread-sheet/src/external/export/interface.ts"),u=n("../node_modules/@tencent/tencent_doc_open_url/dist/index.js"),l=n("../spread-sheet/src/external/view/ui-layer/export-file/utils/index.ts"),p=n("../spread-sheet/src/core/app/sheetStatus/index.ts"),f=n("../spread-sheet/src/core/utils/gray.ts"),m=n("../spread-sheet/src/core/utils/config.ts"),h=n("../spread-sheet/src/adapter/SpreadSheetAppAdapter.ts"),g=n("../spread-sheet/src/external/sheet-adapter/smart-sheet-adapter/constants.ts"),v=function(e,t,n,r){var o,s=arguments.length,a=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var i=e.length-1;i>=0;i--)(o=e[i])&&(a=(s<3?o(a):s>3?o(t,n,a):o(t,n))||a);return s>3&&a&&Object.defineProperty(t,n,a),a},y=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},w=function(e,t){return function(n,r){t(n,r,e)}},j=function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function a(e){try{c(r.next(e))}catch(t){s(t)}}function i(e){try{c(r.throw(e))}catch(t){s(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,i)}c((r=r.apply(e,t||[])).next())}))},_=function(){function e(e,t){this.spreadsheetApp=e,this.sheetStatus=t}var t=e.prototype;return t.exportExcel=function(){var e;return j(this,void 0,void 0,regeneratorRuntime.mark((function t(){var r,o=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(i().isQQMiniProgram||i().isWxMiniProgram&&!i().isWxWork)){t.next=5;break}r="/pages/exportFile/exportFile?url="+encodeURIComponent(location.href),(0,u.tencentDocOpenUrlForAll)({url:location.href,wxUrl:r}),t.next=12;break;case 5:if(!i().isWeChat){t.next=9;break}null===(e=n.g.SLR)||void 0===e||e.load("ExportForAppGuidePanel",(function(e){var t=e.ExportForAppGuidePanel;null===t||void 0===t||t.show({callback:function(){return j(o,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.spreadsheetApp.getSheetExportManager();case 2:e.sent.export(d.I.xlsxServer);case 3:case"end":return e.stop()}}),e,this)})))}})})),t.next=12;break;case 9:return t.next=11,this.spreadsheetApp.getSheetExportManager();case 11:t.sent.export(d.I.xlsxServer);case 12:(0,l.mb)();case 13:case"end":return t.stop()}}),t,this)})))},t.getShowState=function(){return this.sheetStatus.canCopy&&(this.isVersionValid()||!i().isQQ&&!i().isQQMiniProgram&&!i().isTim&&!i().isTencentDocsApp)&&"complete"===document.readyState&&!(i().isWxWork&&(0,f.c)())},t.handleAfterShow=function(){(0,l.DF)()},t.getDisabledState=function(){return(0,m.q)()||!this.sheetStatus.workbookStatus.isOnline},t.isVersionValid=function(){return!i().isQQMiniProgram&&i().isQQVersionAboveOrEqual("7.9.7")||i().isQQMiniProgram&&i().isQQVersionAboveOrEqual("8.1.5")||i().isTencentDocsApp&&(i().isIOS&&i().isIOSVersionAboveOrEqual("13.0.0")||i().isAndroid&&i().isTencentDocsAppVersionAboveOrEqual("1.8.3"))},e}();_=v([(0,s.L)({adapters:[h.L,g.dH]}),w(0,c.m),w(1,p.T),y("design:paramtypes",["function"===typeof(r="undefined"!==typeof c.m&&c.m)?r:Object,"function"===typeof(o="undefined"!==typeof p.T&&p.T)?o:Object])],_)},"../spread-sheet/src/external/view/ui-layer/export-file/export-file-feature-pc.ts":function(e,t,n){n.r(t),n.d(t,{ExportFileFeaturePC:function(){return S}}),n("../node_modules/regenerator-runtime/runtime.js"),n("../node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),n("../node_modules/core-js/modules/esnext.reflect.metadata.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.promise.js"),n("../node_modules/core-js/modules/es.array.iterator.js"),n("../node_modules/core-js/modules/es.string.iterator.js"),n("../node_modules/core-js/modules/web.dom-collections.iterator.js"),n("../node_modules/core-js/modules/web.url-search-params.js"),n("../node_modules/core-js/modules/es.regexp.exec.js"),n("../node_modules/core-js/modules/es.string.replace.js");var r,o,s=n("./node_modules/axios/index.js"),a=n.n(s),i=n("../spread-sheet/src/core/view/level-2/link-center/report/attachment-export.ts"),c=n("../spread-sheet/src/core/app/sheetStatus/index.ts"),d=n("../spread-sheet/src/core/app/SpreadsheetApp.interface.ts"),u=n("../spread-sheet/src/core/data/configService/spreadConfig.ts"),l=n("../spread-sheet/src/core/data/converter/tencentdoc/utils/files.ts"),p=n("../spread-sheet/src/external/export/interface.ts"),f=n("../node_modules/@tencent/docs-user-agent/dist/index.js"),m=n.n(f),h=n("../spread-sheet/src/adapter/SpreadSheetAppAdapter.ts"),g=n("../spread-sheet/src/external/sheet-adapter/smart-sheet-adapter/constants.ts"),v=n("../packages/report/src/index.ts"),y=n("../node_modules/@tencent/workbench/lib/esm/decorators/class/feature.js"),w=n("../spread-sheet/src/external/view/ui-layer/export-file/utils/index.ts"),j=(n("../spread-sheet/src/base/util/domain-config.ts"),n("../spread-sheet/src/base/util/appConfig.ts")),_=function(e,t,n,r){var o,s=arguments.length,a=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var i=e.length-1;i>=0;i--)(o=e[i])&&(a=(s<3?o(a):s>3?o(t,n,a):o(t,n))||a);return s>3&&a&&Object.defineProperty(t,n,a),a},x=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},b=function(e,t){return function(n,r){t(n,r,e)}},R=function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function a(e){try{c(r.next(e))}catch(t){s(t)}}function i(e){try{c(r.throw(e))}catch(t){s(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,i)}c((r=r.apply(e,t||[])).next())}))},S=function(){function e(e,t){this.spreadsheetApp=e,this.sheetStatus=t,this.reportExportToLocalFileClick=function(){v.ZP.tdwReport({opername:"doc_word_editor",module:"export",file_type:2,action:"entrance_click"})}}var t=e.prototype;return t.getDisabledState=function(){return!!m().isTencentDocsApp||!(this.sheetStatus.canCopy&&!this.sheetStatus.tempStatus.status.isHistory)&&!this.sheetStatus.canEdit},t.exportToLocalFile=function(){return R(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.hasDocumentContainsAttachment();case 3:if(e.sent){e.next=6;break}return e.abrupt("return",this.exportToLocalXlsx());case 6:return e.abrupt("return",this.exportToLocalWithAttachmentDialog());case 9:return e.prev=9,e.t0=e.catch(0),n.g.log.error("导出本地表格时出错",e.t0),e.abrupt("return",this.exportToLocalXlsx());case 13:return e.prev=13,this.reportExportToLocalFileClick(),e.finish(13);case 16:case"end":return e.stop()}}),e,this,[[0,9,13,16]])})))},t.exportToLocalCsv=function(){return R(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.doExport(p.I.csv);case 2:case"end":return e.stop()}}),e,this)})))},t.exportToLocalShortcut=function(){n.g.location.href=this.createShortcut(),(0,w.Zk)()},t.getExportCSVDisabledState=function(){return this.spreadsheetApp.spreadsheet.isExternalSheet()},t.hasDocumentContainsAttachment=function(){return R(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t,n,r,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(t=new URLSearchParams).set("docId",u.q.getConfig("globalPadId")),e.next=4,a().post("//"+j.Z.getConfig("runtime.domainName")+"/v1/export/check",t,{headers:{"Content-Type":"application/x-www-form-urlencoded"}});case 4:if(n=e.sent,r=n.data,o=r.hasAttachment){e.next=9;break}throw new Error("请求 export/check CGI出现错误");case 9:return e.abrupt("return",!!o);case 10:case"end":return e.stop()}}),e)})))},t.exportToLocalWithAttachmentDialog=function(){return R(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.spreadsheetApp.view.canvas.linkCenter.attachmentUploadingManager.getAttachmentExtension();case 2:e.sent.showExportModal({category:"sheet",onOk:function(){return t.exportToLocalArchive()},onClickAction:function(){return t.exportToLocalXlsx()},onCancel:function(){return(0,i.zT)()}});case 4:case"end":return e.stop()}}),e,this)})))},t.exportToLocalXlsx=function(){return R(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.doExport(p.I.xlsxServer);case 2:(0,w.fX)(),(0,i.Fr)();case 4:case"end":return e.stop()}}),e,this)})))},t.exportToLocalArchive=function(){return R(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.doExport(p.I.xlsxWithFiles);case 2:(0,i.l2)();case 3:case"end":return e.stop()}}),e,this)})))},t.doExport=function(e){return R(this,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.spreadsheetApp.getSheetExportManager();case 2:t.sent.export(e),(0,l.Qe)("click",null);case 4:case"end":return t.stop()}}),t,this)})))},t.createShortcut=function(){var e={url:n.g.location.href.replace("previewtip=1",""),fname:n.g.clientVars.padTitle,sheet:!0},t=encodeURIComponent(JSON.stringify(e));return"https://"+j.Z.getConfig("runtime.domainName")+"/preview/link.url?info="+t},e}();S=_([(0,y.L)({adapters:[h.L,g.dH]}),b(0,d.m),b(1,c.T),x("design:paramtypes",["function"===typeof(r="undefined"!==typeof d.m&&d.m)?r:Object,"function"===typeof(o="undefined"!==typeof c.T&&c.T)?o:Object])],S)},"../spread-sheet/src/external/view/ui-layer/export-file/utils/index.ts":function(e,t,n){n.d(t,{Zk:function(){return d},mb:function(){return u},DF:function(){return l},fX:function(){return c}});var r,o=n("../packages/report/src/index.ts"),s=n("../node_modules/@tencent/docs-user-agent/dist/index.js"),a=n.n(s);function i(e){o.ZP.tdwReport({opername:"doc_excel_editor",module:"excel_drop-menu",action:e,ver12:"new"})}function c(){i(r.CLK_EXPORT)}function d(){i(r.EXPORT_SHORTCUT)}function u(){a().isQQMiniProgram&&o.ZP.tdwReport({opername:"doc_miniapp",module:"doc_impexp",action:"clk"}),o.ZP.tdwReport({opername:"doc_export",module:"mobile_export",action:"clk_export"})}function l(){try{a().isQQMiniProgram&&o.ZP.tdwReport({opername:"doc_miniapp",module:"doc_impexp",action:"exp"}),o.ZP.tdwReport({opername:"doc_export",module:"mobile_export",action:"expo_export"})}catch(e){console.error(e)}}!function(e){e.CLK_EXPORT="export_xlsx",e.EXPORT_SHORTCUT="export_shortcut"}(r||(r={}))},"../spread-sheet/src/external/view/ui-layer/extend-addon/feature.tsx":function(e,t,n){n.r(t),n.d(t,{AddonFeature:function(){return de}}),n("../node_modules/regenerator-runtime/runtime.js"),n("../node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),n("../node_modules/core-js/modules/esnext.reflect.metadata.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.promise.js"),n("../node_modules/core-js/modules/es.symbol.js"),n("../node_modules/core-js/modules/es.array.iterator.js"),n("../node_modules/core-js/modules/es.map.js"),n("../node_modules/core-js/modules/es.string.iterator.js"),n("../node_modules/core-js/modules/esnext.map.delete-all.js"),n("../node_modules/core-js/modules/esnext.map.every.js"),n("../node_modules/core-js/modules/esnext.map.filter.js"),n("../node_modules/core-js/modules/esnext.map.find.js"),n("../node_modules/core-js/modules/esnext.map.find-key.js"),n("../node_modules/core-js/modules/esnext.map.includes.js"),n("../node_modules/core-js/modules/esnext.map.key-of.js"),n("../node_modules/core-js/modules/esnext.map.map-keys.js"),n("../node_modules/core-js/modules/esnext.map.map-values.js"),n("../node_modules/core-js/modules/esnext.map.merge.js"),n("../node_modules/core-js/modules/esnext.map.reduce.js"),n("../node_modules/core-js/modules/esnext.map.some.js"),n("../node_modules/core-js/modules/esnext.map.update.js"),n("../node_modules/core-js/modules/web.dom-collections.iterator.js"),n("../node_modules/core-js/modules/es.array.map.js"),n("../node_modules/core-js/modules/es.function.name.js"),n("../node_modules/core-js/modules/es.string.small.js"),n("../node_modules/core-js/modules/es.object.assign.js");var r=n("../node_modules/i18next/dist/esm/i18next.js"),o=n("react"),s=n.n(o),a=n("../node_modules/@tencent/docs-addon-sdk/lib/index.esm.js"),i=n("../node_modules/@babel/runtime/helpers/esm/toConsumableArray.js"),c=(n("../node_modules/core-js/modules/es.array.find.js"),n("../node_modules/@babel/runtime/helpers/esm/inheritsLoose.js")),d=n("../node_modules/@tencent/dui/lib/components/Modal/index.js"),u=function(e){function t(){return e.apply(this,arguments)||this}return(0,c.Z)(t,e),t.prototype.render=function(){var e=this.props,t=e.options,n=e.iframeId,r={width:t.width+"px",height:t.height+"px",border:0,marginLeft:"-24px"};return s().createElement("div",{className:"addon-modal-content"},s().createElement("iframe",{id:n,style:r,src:t.src}))},t}(s().Component),l=function(e){function t(){return e.apply(this,arguments)||this}return(0,c.Z)(t,e),t.prototype.render=function(){return s().createElement(d.default,{style:{width:this.props.width,height:(this.props.height||0)+70},visible:!0,title:this.props.title,footer:null,onClose:this.props.onClose},s().createElement(u,{iframeId:this.props.id,options:{width:this.props.width||0,height:this.props.height||0,src:this.props.src}}))},t}(s().Component),p=n("../node_modules/@tencent/workbench/lib/esm/services/widget/widget-service.js"),f=n("../spread-sheet/src/core/app/SpreadsheetApp.interface.ts"),m=n("../spread-sheet/src/core/view/spreadsheet-view/SpreadsheetView.interface.ts"),h=n("../packages/model/src/new-embedded/index.ts"),g=n("../packages/model/src/new-embedded/addon/AddonProperties.ts"),v=n("../packages/model/src/new-embedded/EmbeddedObjectLocation.ts"),y=n("../packages/model/src/new-embedded/EmbeddedObjectType.ts");function w(e,t){void 0===t&&(t=!0);var n=e.app,r=e.objectId,o=e.addonOption,s=e.range,a=e.x,i=void 0===a?0:a,c=e.y,d=void 0===c?0:c,u=e.width,l=void 0===u?0:u,p=e.height,f=void 0===p?0:p,m=o.addonId,w=n.spreadsheet.activeSheetId,j=new v.Z({isOwnSheet:!1,sheetId:w,x:i,y:d,width:l,height:f,position:{rowIndex:s.startRowIndex,colIndex:s.startColIndex}}),_=new g.Z({addonId:m,addonData:Object.assign(o,{isNew:t})});return new h.EmbeddedObject({properties:new h.EmbeddedObjectProperties({type:y.Z.ADDON,addon:_}),objectId:r,location:j})}var j,_,x,b=n("../packages/model/src/range/index.ts"),R=n("../spread-sheet/src/core/view/level-2/addon/const.ts"),S=function(e,t,n,r){var o,s=arguments.length,a=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var i=e.length-1;i>=0;i--)(o=e[i])&&(a=(s<3?o(a):s>3?o(t,n,a):o(t,n))||a);return s>3&&a&&Object.defineProperty(t,n,a),a},C=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},E=function(e,t){return function(n,r){t(n,r,e)}},I=function(){function e(e,t,n){var o=this;this.widgetService=e,this.app=t,this.spreadsheetView=n,this.openDialog=function(e){o.widgetService.float({name:r.ZP.t("插件弹窗"),component:o.getWidgetComponent(e)})},this.openSidebar=function(){},this.closeDialog=function(){o.widgetService.remove(r.ZP.t("插件弹窗"),"float"),a.os.getDocHook().onDialogClose()},this.closeSidebar=function(){},this.updateDialog=function(){},this.updateSidebar=function(){},this.openURL=function(){},this.getCursor=function(){return{}},this.getSelectedDocElements=function(){var e,t=null===(e=o.app.view.canvas.addonCenter)||void 0===e?void 0:e.addonEdit.activeId,n=o.app.spreadsheet.embeddedObjectManager.embeddedObjectMap.get(t);return n?[n.properties.addon.addonData]:[]},this.insertDocElement=function(e,t){var n=e.width,r=e.height,s=e.anchorId,a=""+R._+s,i=o.app.view.getSelectionWithGridRanges().rangeSelections[0],c=w({app:o.app,objectId:a,addonOption:e,range:i,x:0,y:0,width:n||0,height:r||0});o.app.requestApi.addEmbeddedObject({range:i,objects:[c]})},this.removeDocElement=function(e){var t=o.app.spreadsheet.embeddedObjectManager.getEmbeddedObject(e);if(t){var n=t.location.sheetId;o.app.requestApi.deleteEmbeddedObject({embeddedObjectType:h.NEW_EMBEDDED_OBJECT_TYPE.ADDON,objectId:e,sheetId:n})}},this.updateDocElement=function(e){var t=e.anchorId,n=e.width,r=e.height,s=o.app.spreadsheet.embeddedObjectManager.embeddedObjectMap,a=(0,i.Z)(s.values()).find((function(e){var n;return(null===(n=e.properties.addon)||void 0===n?void 0:n.addonData.anchorId)===t}));if(a){var c=a.objectId,d=a.location,u=d.sheetId,l=d.position,p=d.x,f=d.y,m=l.rowIndex,h=l.colIndex,g=new b.GridRange(u,m,m,h,h),v=w({app:o.app,objectId:c,addonOption:e,range:g,x:p,y:f,width:n||0,height:r||0});o.app.requestApi.updateEmbeddedObject({sheetId:u,range:g,objects:[v]})}},this.uploadImage=function(e,t){return void 0===t&&(t=1),new Promise((function(){}))}}return e.prototype.getWidgetComponent=function(e){return s().createElement(l,Object.assign({onClose:this.closeDialog},e))},e}();I=S([E(1,f.m),C("design:paramtypes",["function"===typeof(j="undefined"!==typeof p.i&&p.i)?j:Object,"function"===typeof(_="undefined"!==typeof f.m&&f.m)?_:Object,"function"===typeof(x="undefined"!==typeof m.Z&&m.Z)?x:Object])],I);var M,T=n("../node_modules/@tencent/dui/lib/components/Snackbar/index.js"),O=n("../spread-sheet/src/core/data/configService/spreadConfig.ts"),D=n("../node_modules/@tencent/workbench/lib/esm/decorators/class/controller.js"),A=n("../node_modules/@tencent/workbench/lib/esm/decorators/class/feature.js"),k=n("../node_modules/@tencent/workbench/lib/esm/services/menu/menu-service.js"),P=n("../node_modules/@tencent/workbench/lib/esm/services/controller/controller-service.js"),N=n("../spread-sheet/src/external/view/schema/menu-schema.ts"),L=n("../node_modules/@babel/runtime/helpers/esm/createClass.js"),F=n("../node_modules/@tencent/workbench/lib/esm/index.js"),Z=n("../node_modules/@tencent/workbench/lib/esm/decorators/method/menu.js"),U=n("../node_modules/@tencent/workbench/lib/esm/decorators/param/param.js"),z=n("../node_modules/@tencent/ioc/lib/esm/index.js"),B=n("../spread-sheet/src/adapter/SpreadSheetAppAdapter.ts"),H=n("../spread-sheet/src/external/view/ui-layer/extend-addon/addon-interface.ts"),V=function(e,t,n,r){var o,s=arguments.length,a=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var i=e.length-1;i>=0;i--)(o=e[i])&&(a=(s<3?o(a):s>3?o(t,n,a):o(t,n))||a);return s>3&&a&&Object.defineProperty(t,n,a),a},Q=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},W=function(e,t){return function(n,r){t(n,r,e)}},G=function(){function e(e){this.loader=e}return e.prototype.clickHandler=function(e){var t;null===(t=this.feature.clickCallbacks.get(e))||void 0===t||t()},(0,L.Z)(e,[{key:"feature",get:function(){return this.loader.instance}}]),e}();V([(0,Z.v)("addon-:menuid","onClick"),W(0,(0,U.d)("menuid")),Q("design:type",Function),Q("design:paramtypes",[String]),Q("design:returntype",void 0)],G.prototype,"clickHandler",null),G=V([(0,D.Q)({adapters:[B.L]}),W(0,(0,z.aN)(H.f)),Q("design:paramtypes",["function"===typeof(M="undefined"!==typeof F.IDynamicLoader&&F.IDynamicLoader)?M:Object])],G);var Y={placement:"right",style:{display:"block"},overlayStyle:{backgroundColor:"hsla(0,0%,100%,.92)",padding:"20px 16px 24px",backdropFilter:"blur(16px)",boxShadow:"0 2px 12px 2px rgb(68 73 77 / 16%)",borderRadius:"4px",border:"solid 1px rgba(0, 0, 0, 0.12)"},alignment:"start",hoverDelay:200,safeWidth:230},q=new Map([["limitedFree","data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjYiIGhlaWdodD0iMTQiIHZpZXdCb3g9IjAgMCAyNiAxNCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48ZGVmcz48bGluZWFyR3JhZGllbnQgeDE9Ii03LjU0OSUiIHkxPSIzNS41MDMlIiB4Mj0iOTYuOCUiIHkyPSI2Mi40ODglIiBpZD0iYSI+PHN0b3Agc3RvcC1jb2xvcj0iI0ZGQjQ5MCIgb2Zmc2V0PSIwJSIvPjxzdG9wIHN0b3AtY29sb3I9IiNGRjgyNDYiIG9mZnNldD0iMTAwJSIvPjwvbGluZWFyR3JhZGllbnQ+PC9kZWZzPjxnIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+PHJlY3Qgd2lkdGg9IjI2IiBoZWlnaHQ9IjE0IiByeD0iMiIgZmlsbD0idXJsKCNhKSIvPjxwYXRoIGQ9Ik0xMi40NzY4MTE4LDEwLjk2ODExMTcgTDEyLjk1MzgxMTgsMTAuMjEyMTExNyBDMTIuMzMyODExOCw5Ljg1MjExMTcgMTEuODI4ODExOCw5LjQyMDExMTcgMTEuNDUwODExOCw4LjkyNTExMTcgQzExLjkyNzgxMTgsOC42NzMxMTE3IDEyLjM1OTgxMTgsOC4zMjIxMTE3IDEyLjczNzgxMTgsNy44NzIxMTE3IEwxMi4xODg4MTE4LDcuMzIzMTExNyBDMTEuODI4ODExOCw3Ljc1NTExMTcgMTEuNDUwODExOCw4LjA4ODExMTcgMTEuMDU0ODExOCw4LjMyMjExMTcgQzEwLjgzODgxMTgsNy45MjYxMTE3IDEwLjY3NjgxMTgsNy41MDMxMTE3IDEwLjU4NjgxMTgsNy4wNDQxMTE3IEwxMi4xOTc4MTE4LDcuMDQ0MTExNyBMMTIuMTk3ODExOCwzLjAyMTExMTcgTDguMTM4ODExODQsMy4wMjExMTE3IEw4LjEzODgxMTg0LDkuODk3MTExNyBDOC4xMzg4MTE4NCwxMC4wMTQxMTE3IDguMDU3ODExODQsMTAuMDk1MTExNyA3LjkxMzgxMTg0LDEwLjE0OTExMTcgTDguMTIwODExODQsMTAuODk2MTExNyBDOS4xMTk4MTE4NCwxMC42MzUxMTE3IDkuOTQ3ODExODQsMTAuMzY1MTExNyAxMC42MDQ4MTE4LDEwLjA5NTExMTcgTDEwLjQwNjgxMTgsOS4zMDMxMTE3IEM5LjkzODgxMTg0LDkuNTE5MTExNyA5LjQ2MTgxMTg0LDkuNjk5MTExNyA4Ljk3NTgxMTg0LDkuODQzMTExNyBMOC45NzU4MTE4NCw3LjA0NDExMTcgTDkuODIxODExODQsNy4wNDQxMTE3IEMxMC4xMDk4MTE4LDguNzAwMTExNyAxMS4wMDA4MTE4LDEwLjAwNTExMTcgMTIuNDc2ODExOCwxMC45NjgxMTE3IFogTTUuNzQ0ODExODQsMTEuMDQwMTExNyBMNS43NDQ4MTE4NCwzLjgzMTExMTcgTDYuOTc3ODExODQsMy44MzExMTE3IEM2Ljc0MzgxMTg0LDQuNTUxMTExNyA2LjQyODgxMTg0LDUuMzcwMTExNyA2LjAyMzgxMTg0LDYuMjcwMTExNyBDNi42MzU4MTE4NCw3LjAyNjExMTcgNi45NDE4MTE4NCw3LjcwMTExMTcgNi45NDE4MTE4NCw4LjMxMzExMTcgQzYuOTQxODExODQsOC40NjYxMTE3IDYuODk2ODExODQsOC41NzQxMTE3IDYuODE1ODExODQsOC42MzcxMTE3IEM2LjcyNTgxMTg0LDguNjkxMTExNyA2LjU2MzgxMTg0LDguNzI3MTExNyA2LjMxMTgxMTg0LDguNzQ1MTExNyBDNi4xODU4MTE4NCw4Ljc0NTExMTcgNi4wMzI4MTE4NCw4LjcyNzExMTcgNS44NTI4MTE4NCw4LjcwMDExMTcgTDYuMTMxODExODQsOS41NjQxMTE3IEM2Ljc5NzgxMTg0LDkuNTU1MTExNyA3LjI1NjgxMTg0LDkuNDM4MTExNyA3LjUyNjgxMTg0LDkuMjEzMTExNyBDNy43MDY4MTE4NCw5LjAzMzExMTcgNy43OTY4MTE4NCw4LjcyNzExMTcgNy43OTY4MTE4NCw4LjMxMzExMTcgQzcuNzYwODExODQsNy42OTIxMTE3IDcuNDU0ODExODQsNi45NzIxMTE3IDYuODg3ODExODQsNi4xNDQxMTE3IEM3LjI0NzgxMTg0LDUuMjg5MTExNyA3LjU2MjgxMTg0LDQuNDc5MTExNyA3LjgzMjgxMTg0LDMuNzA1MTExNyBMNy44MzI4MTE4NCwzLjAzMDExMTcgTDQuOTA3ODExODQsMy4wMzAxMTE3IEw0LjkwNzgxMTg0LDExLjA0MDExMTcgTDUuNzQ0ODExODQsMTEuMDQwMTExNyBaIE0xMS4zNjA4MTE4LDQuNjY4MTExNyBMOC45NzU4MTE4NCw0LjY2ODExMTcgTDguOTc1ODExODQsMy44MzExMTE3IEwxMS4zNjA4MTE4LDMuODMxMTExNyBMMTEuMzYwODExOCw0LjY2ODExMTcgWiBNMTEuMzYwODExOCw2LjI2MTExMTcgTDguOTc1ODExODQsNi4yNjExMTE3IEw4Ljk3NTgxMTg0LDUuNDQyMTExNyBMMTEuMzYwODExOCw1LjQ0MjExMTcgTDExLjM2MDgxMTgsNi4yNjExMTE3IFogTTE0LjI0MDgxMTgsMTEuMDU4MTExNyBDMTYuMDA0ODExOCwxMC4zNzQxMTE3IDE3LjExMTgxMTgsOS41MTAxMTE3IDE3LjU3OTgxMTgsOC40ODQxMTE3IEMxNy42NTE4MTE4LDguMzQwMTExNyAxNy43MTQ4MTE4LDguMTg3MTExNyAxNy43Njg4MTE4LDguMDI1MTExNyBMMTguMDgzODExOCw4LjAyNTExMTcgTDE4LjA4MzgxMTgsOS44NDMxMTE3IEMxOC4wODM4MTE4LDEwLjU0NTExMTcgMTguMzg5ODExOCwxMC44OTYxMTE3IDE5LjAxMDgxMTgsMTAuODk2MTExNyBMMjAuODAxODExOCwxMC44OTYxMTE3IEMyMS4xMjU4MTE4LDEwLjg5NjExMTcgMjEuMzU5ODExOCwxMC44MTUxMTE3IDIxLjUxMjgxMTgsMTAuNjUzMTExNyBDMjEuNjc0ODExOCwxMC40NzMxMTE3IDIxLjc4MjgxMTgsOS45NDIxMTE3IDIxLjg1NDgxMTgsOS4wNDIxMTE3IEwyMS4wNDQ4MTE4LDguNzgxMTExNyBDMjEuMDI2ODExOCw5LjQwMjExMTcgMjAuOTgxODExOCw5Ljc3MTExMTcgMjAuOTA5ODExOCw5Ljg5NzExMTcgQzIwLjg1NTgxMTgsMTAuMDA1MTExNyAyMC43NjU4MTE4LDEwLjA2ODExMTcgMjAuNjM5ODExOCwxMC4wNjgxMTE3IEwxOS4yNzE4MTE4LDEwLjA2ODExMTcgQzE5LjA0NjgxMTgsMTAuMDY4MTExNyAxOC45Mzg4MTE4LDkuOTMzMTExNyAxOC45Mzg4MTE4LDkuNjYzMTExNyBMMTguOTM4ODExOCw4LjAyNTExMTcgTDIwLjk3MjgxMTgsOC4wMjUxMTE3IEwyMC45NzI4MTE4LDUuMTM2MTExNyBMMTguOTExODExOCw1LjEzNjExMTcgQzE5LjIyNjgxMTgsNC44NDgxMTE3IDE5LjU0MTgxMTgsNC40OTcxMTE3IDE5Ljg2NTgxMTgsNC4wOTIxMTE3IEwxOS44NjU4MTE4LDMuNDQ0MTExNyBMMTYuODU5ODExOCwzLjQ0NDExMTcgQzE2Ljk5NDgxMTgsMy4yNTUxMTE3IDE3LjEyOTgxMTgsMy4wNjYxMTE3IDE3LjI1NTgxMTgsMi44NjgxMTE3IEwxNi4zOTE4MTE4LDIuNjc5MTExNyBDMTUuNjM1ODExOCwzLjc5NTExMTcgMTQuNzM1ODExOCw0LjY1OTExMTcgMTMuNjczODExOCw1LjI4OTExMTcgTDE0LjIxMzgxMTgsNS45NDYxMTE3IEMxNC4zODQ4MTE4LDUuODM4MTExNyAxNC41NTU4MTE4LDUuNzIxMTExNyAxNC43MTc4MTE4LDUuNjA0MTExNyBMMTQuNzE3ODExOCw4LjAyNTExMTcgTDE2Ljg1OTgxMTgsOC4wMjUxMTE3IEMxNi44MjM4MTE4LDguMDk3MTExNyAxNi43Nzg4MTE4LDguMTc4MTExNyAxNi43NDI4MTE4LDguMjY4MTExNyBDMTYuMjU2ODExOCw5LjEwNTExMTcgMTUuMjQ4ODExOCw5LjgxNjExMTcgMTMuNzAwODExOCwxMC4zOTIxMTE3IEwxNC4yNDA4MTE4LDExLjA1ODExMTcgWiBNMTcuODQwODExOCw1LjEzNjExMTcgTDE1LjMwMjgxMTgsNS4xMzYxMTE3IEMxNS42MjY4MTE4LDQuODU3MTExNyAxNS45MzI4MTE4LDQuNTUxMTExNyAxNi4yMzg4MTE4LDQuMjE4MTExNyBMMTguNzU4ODExOCw0LjIxODExMTcgQzE4LjQ1MjgxMTgsNC41NjAxMTE3IDE4LjE0NjgxMTgsNC44NjYxMTE3IDE3Ljg0MDgxMTgsNS4xMzYxMTE3IFogTTIwLjE1MzgxMTgsNy4yMjQxMTE3IEwxOC4wMDI4MTE4LDcuMjI0MTExNyBDMTguMDgzODExOCw2LjgyODExMTcgMTguMTM3ODExOCw2LjM5NjExMTcgMTguMTU1ODExOCw1LjkyODExMTcgTDIwLjE1MzgxMTgsNS45MjgxMTE3IEwyMC4xNTM4MTE4LDcuMjI0MTExNyBaIE0xNy4xMjA4MTE4LDcuMjI0MTExNyBMMTUuNTQ1ODExOCw3LjIyNDExMTcgTDE1LjU0NTgxMTgsNS45MjgxMTE3IEwxNy4zMDA4MTE4LDUuOTI4MTExNyBDMTcuMjczODExOCw2LjM5NjExMTcgMTcuMjEwODExOCw2LjgyODExMTcgMTcuMTIwODExOCw3LjIyNDExMTcgWiIgZmlsbD0iI0ZGRiIgZmlsbC1ydWxlPSJub256ZXJvIi8+PC9nPjwvc3ZnPg=="],["inAppPurchase","data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMzUiIGhlaWdodD0iMTQiIHZpZXdCb3g9IjAgMCAzNSAxNCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+PGRlZnM+PGxpbmVhckdyYWRpZW50IHgxPSI0LjA5OCUiIHkxPSI0MiUiIHgyPSI5Ni44JSIgeTI9IjU2Ljg5MiUiIGlkPSJhIj48c3RvcCBzdG9wLWNvbG9yPSIjRjZEREIxIiBvZmZzZXQ9IjAlIi8+PHN0b3Agc3RvcC1jb2xvcj0iI0UzQjc3NSIgb2Zmc2V0PSIxMDAlIi8+PC9saW5lYXJHcmFkaWVudD48cGF0aCBkPSJNMTIuMjA4LDUuODg3IEwxMi43Myw1LjA5NSBDMTAuOTEyLDQuMzkzIDkuNjI1LDMuNTY1IDguODc4LDIuNjI5IEw4LjEyMiwyLjYyOSBDNy4yMjIsMy42NDYgNS45MzUsNC40NjUgNC4yNjEsNS4wOTUgTDQuNzgzLDUuODg3IEM2LjI3Nyw1LjMyOSA3LjUxOSw0LjUzNyA4LjUsMy41MDIgQzkuMzEsNC40NDcgMTAuNTUyLDUuMjM5IDEyLjIwOCw1Ljg4NyBaIE04Ljc4OCw1Ljc1MiBMOS4zNDYsNS4xMDQgQzguOTk1LDQuNzk4IDguNjE3LDQuNTI4IDguMjIxLDQuMjk0IEw3LjYxOCw0LjgzNCBDOC4wMzIsNS4wODYgOC40MTksNS4zOTIgOC43ODgsNS43NTIgWiBNNi4zOTQsMTAuOTQ1IEw2LjM5NCwxMC42MDMgTDEwLjYxNSwxMC42MDMgTDEwLjYxNSwxMC45NDUgTDExLjUzMywxMC45NDUgTDExLjUzMyw3Ljc1OSBMMTAuMDkzLDcuNzU5IEMxMC40NjIsNy40MTcgMTAuODA0LDcuMDQ4IDExLjExLDYuNjQzIEwxMS4xMSw1LjkwNSBMNS43MjgsNS45MDUgTDUuNzI4LDYuNzMzIEw5Ljk0LDYuNzMzIEM5LjU0NCw3LjE0NyA5LjE2Niw3LjQ4OSA4Ljc5Nyw3Ljc1OSBMNS40NzYsNy43NTkgTDUuNDc2LDEwLjk0NSBMNi4zOTQsMTAuOTQ1IFogTTEwLjYxNSw5LjczOSBMNi4zOTQsOS43MzkgTDYuMzk0LDguNjIzIEwxMC42MTUsOC42MjMgTDEwLjYxNSw5LjczOSBaIE0xNS4zNzYsMTAuOTU0IEwxNS4zNzYsNC43MTcgQzE1LjY5MSw0LjE1IDE1Ljk1MiwzLjU1NiAxNi4xNSwyLjk0NCBMMTUuMjY4LDIuNTMgQzE0LjgzNiwzLjkyNSAxNC4xNjEsNS4xNCAxMy4yNTIsNi4xNjYgTDEzLjU1OCw3LjEzOCBDMTMuODczLDYuODE0IDE0LjE3LDYuNDcyIDE0LjQ0LDYuMTMgTDE0LjQ0LDEwLjk1NCBMMTUuMzc2LDEwLjk1NCBaIE0xOS4zOTksMTAuOSBDMjAuMDU2LDEwLjkgMjAuMzg5LDEwLjU1OCAyMC4zODksOS44ODMgTDIwLjM4OSw1LjM3NCBMMjEuNjEzLDUuMzc0IEwyMS42MTMsNC40NTYgTDIwLjM4OSw0LjQ1NiBMMjAuMzg5LDIuNjQ3IEwxOS40NDQsMi42NDcgTDE5LjQ0NCw0LjQ1NiBMMTYuMjIyLDQuNDU2IEwxNi4yMjIsNS4zNzQgTDE5LjQ0NCw1LjM3NCBMMTkuNDQ0LDkuNjQ5IEMxOS40NDQsOS45MSAxOS4zMTgsMTAuMDQ1IDE5LjA3NSwxMC4wNDUgQzE4LjY3OSwxMC4wNDUgMTguMjY1LDEwLjAxOCAxNy44MzMsOS45ODIgTDE4LjA0OSwxMC45IEwxOS4zOTksMTAuOSBaIE0xNy44OTYsOC43NDkgTDE4LjY5Nyw4LjE5MSBDMTguMzM3LDcuNjE1IDE3LjgzMyw2LjkzMSAxNy4xODUsNi4xNTcgTDE2LjQxMSw2LjYzNCBDMTcuMDMyLDcuNDA4IDE3LjUyNyw4LjExOSAxNy44OTYsOC43NDkgWiBNMjQuNjEsOS40ODcgTDI0LjYxLDcuNzg2IEwyOC42MjQsNy43ODYgTDI4LjYyNCw5LjQ4NyBMMjkuNTYsOS40ODcgTDI5LjU2LDYuOTU4IEwyNC41NDcsNi45NTggQzI0LjgxNyw2LjgxNCAyNS4wNDIsNi42NjEgMjUuMjIyLDYuNDkgQzI1LjM4NCw2LjMxOSAyNS41MjgsNi4xMyAyNS42NDUsNS45MTQgTDI3LjA0LDUuOTE0IEwyNy4wNCw2LjgyMyBMMjcuOTQ5LDYuODIzIEwyNy45NDksNS45MTQgTDI5LjQxNiw1LjkxNCBDMjkuNDE2LDYuMDIyIDI5LjM4OSw2LjEwMyAyOS4zNTMsNi4xNzUgQzI5LjMwOCw2LjIyOSAyOS4xNzMsNi4yNTYgMjguOTQ4LDYuMjU2IEMyOC43OTUsNi4yNTYgMjguNjMzLDYuMjQ3IDI4LjQ2Miw2LjIyOSBMMjguNjMzLDYuODY4IEMyOC43NzcsNi44NzcgMjguOTIxLDYuODg2IDI5LjA2NSw2Ljg4NiBDMjkuNTk2LDYuODc3IDI5LjkzOCw2Ljc2OSAzMC4wODIsNi41NzEgQzMwLjIyNiw2LjM3MyAzMC4zMDcsNS45MjMgMzAuMzA3LDUuMjEyIEwyNy45NDksNS4yMTIgTDI3Ljk0OSw0LjgxNiBMMjkuODIxLDQuODE2IEwyOS44MjEsMi45NjIgTDI3Ljk0OSwyLjk2MiBMMjcuOTQ5LDIuNTkzIEwyNy4wNCwyLjU5MyBMMjcuMDQsMi45NjIgTDI1Ljk0MiwyLjk2MiBMMjUuOTQyLDIuNTkzIEwyNS4wMzMsMi41OTMgTDI1LjAzMywyLjk2MiBMMjMuMDYyLDIuOTYyIEwyMy4wNjIsMy43MDkgTDI1LjAzMywzLjcwOSBMMjUuMDMzLDQuMTA1IEwyMy4zMzIsNC4xMDUgTDIyLjk3Miw1LjkxNCBMMjQuNTU2LDUuOTE0IEwyNC41MTEsNS45NTkgQzI0LjIwNSw2LjI1NiAyMy42MDIsNi41MDggMjIuNjkzLDYuNzA2IEwyMy4xNjEsNy40MzUgQzIzLjM0MSw3LjM5IDIzLjUxMiw3LjM0NSAyMy42ODMsNy4yOTEgTDIzLjY4Myw5LjQ4NyBMMjQuNjEsOS40ODcgWiBNMjcuMDQsNC4xMDUgTDI1Ljk0Miw0LjEwNSBMMjUuOTQyLDMuNzA5IEwyNy4wNCwzLjcwOSBMMjcuMDQsNC4xMDUgWiBNMjguOTQ4LDQuMTA1IEwyNy45NDksNC4xMDUgTDI3Ljk0OSwzLjcwOSBMMjguOTQ4LDMuNzA5IEwyOC45NDgsNC4xMDUgWiBNMjQuOTQzLDUuMjEyIEwyMy45ODksNS4yMTIgTDI0LjA5Nyw0LjgxNiBMMjUuMDI0LDQuODE2IEMyNS4wMDYsNC45NDIgMjQuOTc5LDUuMDc3IDI0Ljk0Myw1LjIxMiBaIE0yNy4wNCw1LjIxMiBMMjUuODc5LDUuMjEyIEMyNS44OTcsNS4wODYgMjUuOTE1LDQuOTYgMjUuOTMzLDQuODE2IEwyNy4wNCw0LjgxNiBMMjcuMDQsNS4yMTIgWiBNMjMuMDM1LDEwLjk3MiBDMjQuNzM2LDEwLjg0NiAyNS44MDcsMTAuNTU4IDI2LjI0OCwxMC4xMjYgQzI2LjY2Miw5Ljc4NCAyNi45MzIsOS4xIDI3LjA1OCw4LjA2NSBMMjYuMTIyLDcuOTc1IEMyNi4wNTksOC43MzEgMjUuODM0LDkuMjYyIDI1LjQzOCw5LjU3NyBDMjQuOTg4LDkuODgzIDI0LjA2MSwxMC4wNzIgMjIuNjU3LDEwLjEyNiBMMjMuMDM1LDEwLjk3MiBaIE0yOS44NTcsMTEuMDE3IEwzMC4zNjEsMTAuMjM0IEMyOS40MDcsOS44NTYgMjguMzQ1LDkuNTQxIDI3LjE4NCw5LjI4OSBMMjYuNzA3LDkuOTkxIEMyNy43ODcsMTAuMjQzIDI4Ljg0LDEwLjU4NSAyOS44NTcsMTEuMDE3IFoiIGlkPSJiIi8+PC9kZWZzPjxnIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+PHJlY3QgZmlsbD0idXJsKCNhKSIgd2lkdGg9IjM1IiBoZWlnaHQ9IjE0IiByeD0iMiIvPjxnIGZpbGwtcnVsZT0ibm9uemVybyI+PHVzZSBmaWxsPSIjREI4RjFDIiB4bGluazpocmVmPSIjYiIvPjx1c2UgZmlsbD0iIzc1NEEwQSIgeGxpbms6aHJlZj0iI2IiLz48L2c+PC9nPjwvc3ZnPg=="]]);function X(e){var t=e.title,n=e.text,o=e.vendorName,a=e.vendorSite,i=e.chargingType,c=e.preview;return s().createElement("div",null,s().createElement("div",{className:"tooltip-preview-title"},s().createElement("div",null,t),i&&s().createElement("img",{src:q.get(i)})),o&&s().createElement("div",{className:"tooltip-preview-supplier"},s().createElement("a",{target:"_blank",href:a,rel:"noreferrer"},r.ZP.t("来自："),o,s().createElement("img",{src:"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB3aWR0aD0iMTYiIGhlaWdodD0iMTYiIHhtbG5zOnY9Imh0dHBzOi8vdmVjdGEuaW8vbmFubyI+PGRlZnM+PHBhdGggZD0iTTYgMy44MzMgMTAuMjg2IDggNiAxMi4xNjdsLjg1Ny44MzMgNC43NzQtNC42NDJhLjUuNSAwIDAgMCAwLS43MTZMNi44NTcgMyA2IDMuODMzeiIgaWQ9IkEiLz48L2RlZnM+PHVzZSBmaWxsPSIjY2JjZGQxIiB4bGluazpocmVmPSIjQSIvPjx1c2UgZmlsbC1vcGFjaXR5PSIuMDQiIGZpbGw9IiMwMDAiIHhsaW5rOmhyZWY9IiNBIi8+PC9zdmc+"}))),s().createElement("div",{className:"tooltip-preview",style:{backgroundImage:"url("+c+")"}}),s().createElement("div",{className:"tooltip-preview-text"},n))}var K,J,$,ee,te,ne=n("../spread-sheet/src/core/utils/gray.ts"),re=n("../packages/report/src/index.ts"),oe=function(e,t,n,r){var o,s=arguments.length,a=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var i=e.length-1;i>=0;i--)(o=e[i])&&(a=(s<3?o(a):s>3?o(t,n,a):o(t,n))||a);return s>3&&a&&Object.defineProperty(t,n,a),a},se=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},ae=function(e,t){return function(n,r){t(n,r,e)}},ie=function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function a(e){try{c(r.next(e))}catch(t){s(t)}}function i(e){try{c(r.throw(e))}catch(t){s(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,i)}c((r=r.apply(e,t||[])).next())}))},ce=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(n[r[o]]=e[r[o]])}return n},de=function(){function e(e,t,r,o,s){var i=this;this.menuService=e,this.controllerService=t,this.widgetService=r,this.app=o,this.spreadsheetView=s,this.addons=[],this.clickCallbacks=new Map,this.shouldDisabledCallbacks=new Map,this.hasLoadedAddons=!1,this.getAddonsAndUpdateView=function(){return ie(i,void 0,void 0,regeneratorRuntime.mark((function e(){var t,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.hasLoadedAddons){e.next=2;break}return e.abrupt("return");case 2:return e.prev=2,e.next=5,a.os.fetchAddonList();case 5:this.addons=e.sent,(null===(t=this.addons)||void 0===t?void 0:t.length)&&(this.hasLoadedAddons=!0,this.updateAddonMenuSchema(),this.createAddonMenu()),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(2),null===(r=n.g.log)||void 0===r||r.error("插件内部存在错误",e.t0);case 12:case 13:case"end":return e.stop()}}),e,this,[[2,9]])})))},this.addonAdapter=new I(this.widgetService,this.app,this.spreadsheetView),this.initDocAddonBridge(),this.getAddonsAndUpdateView()}var t=e.prototype;return t.getHideState=function(){return!this.hasLoadedAddons||(0,ne.i)()},t.updateAddonMenuSchema=function(){var e=this.addons.map((function(e){return"addon-"+e.addonId})),t=this.menuService.updateKeySchema(N.z_.EXTEND_ADDON,e);this.menuService.setSchema(t)},t.createAddonMenu=function(){var e=this.addons.map((function(e){var t=e.menuConfiguration,n=e.addonId,o=e.icons,i=e.name,c=e.vendorName,d=e.vendorSite,u=e.shortDesc,l=e.chargingType,p=e.isOfficial,f=t,m=function(e,t,n){var r=t?Object.assign(Object.assign({},Y),t):Y,o=n||{title:"",text:""};return Object.assign(Object.assign({},r),{content:s().createElement(X,Object.assign({},o))})}(0,{placement:"right-prefer"},{title:i,text:u,preview:o.intro,vendorName:c,vendorSite:d,chargingType:l});return{name:n,content:r.ZP.t(i),icon:s().createElement("img",{src:o.small}),onClick:function(){a.os.executeMenuAction(n,f),re.ZP.tdwReport({opername:"plug_in",module:"sheet",action:"clk"})},tooltip:p?null:m}}));this.registerMenu(e)},t.registerMenu=function(e){var t=this,n=e.map((function(e){var n=e.onClick,r=e.shouldDisabled,o=e.name,s=ce(e,["onClick","shouldDisabled","name"]);return n&&t.clickCallbacks.set(o,n),r&&t.shouldDisabledCallbacks.set(o,r),Object.assign(Object.assign({},s),{name:"addon-"+o})}));(0,D.Q)({menuItems:n})(G),this.controllerService.buildController(G)},t.initDocAddonBridge=function(){var e={metaInfo:{fileId:O.q.getConfig("globalPadId"),fileType:a.Tv.SHEET,creatorId:O.q.getConfig("creatorId"),uid:O.q.getConfig("userId")},service:{config:{getLanguage:function(){return r.ZP.language}},ui:{openDialog:this.addonAdapter.openDialog,openSidebar:this.addonAdapter.openSidebar,closeDialog:this.addonAdapter.closeDialog,closeSidebar:this.addonAdapter.closeSidebar,openURL:this.addonAdapter.openURL,updateDialog:this.addonAdapter.updateDialog,updateSidebar:this.addonAdapter.updateSidebar,showSnackbar:function(e){T.default.show(e)}},editor:{getCursor:this.addonAdapter.getCursor,getSelectedDocElements:this.addonAdapter.getSelectedDocElements,insertDocElement:this.addonAdapter.insertDocElement,updateDocElement:this.addonAdapter.updateDocElement},advanced:{uploadImage:this.addonAdapter.uploadImage}}};a.os.setup(e)},e}();de=oe([(0,A.L)({adapters:[B.L]}),ae(3,f.m),ae(4,m.Z),se("design:paramtypes",["function"===typeof(K="undefined"!==typeof k.h&&k.h)?K:Object,"function"===typeof(J="undefined"!==typeof P.H&&P.H)?J:Object,"function"===typeof($="undefined"!==typeof p.i&&p.i)?$:Object,"function"===typeof(ee="undefined"!==typeof f.m&&f.m)?ee:Object,"function"===typeof(te="undefined"!==typeof m.Z&&m.Z)?te:Object])],de)},"../spread-sheet/src/external/view/ui-layer/favorite-ent/favorite-feature.ts":function(e,t,n){n.r(t),n.d(t,{FavoriteFeature:function(){return x}}),n("../node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),n("../node_modules/core-js/modules/esnext.reflect.metadata.js"),n("../node_modules/core-js/modules/es.object.assign.js");var r=n("../node_modules/@tencent/workbench/lib/esm/decorators/class/feature.js"),o=n("../packages/report/src/index.ts"),s=n("../spread-sheet/src/adapter/SpreadSheetAppAdapter.ts"),a=n("../spread-sheet/src/core/data/configService/spreadConfig.ts"),i=(n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.promise.js"),n("../node_modules/i18next/dist/esm/i18next.js")),c=n("../node_modules/qs/lib/index.js"),d=n.n(c),u=n("./node_modules/axios/index.js"),l=n.n(u),p=n("../node_modules/@tencent/dui/lib/components/Snackbar/index.js"),f=n("../packages/utils/src/safe.ts"),m=n("../spread-sheet/src/base/util/appConfig.ts"),h="//"+m.Z.getConfig("runtime.domainName")+"/cgi-bin/online_docs/doc_collect",g="//"+m.Z.getConfig("runtime.domainName")+"/cgi-bin/online_docs/doc_humtrans",v=!1;function y(e){var t=a.q.getConfig("docInfo"),n=null===t||void 0===t?void 0:t.isCollected,r=a.q.getConfig("domainId"),o=a.q.getConfig("padId");!v&&function(e){var t=d().stringify({is_cancel:e.isCollected?"1":"0",pad_id:e.padId,domain_id:e.domainId,list_type:6,xsrf:(0,f.f)()});return new Promise((function(e,n){l().post(h,t).then((function(t){var r=t.data;if(0!==(null===r||void 0===r?void 0:r.retcode))return n();e(r)})).catch((function(){n()}))}))}({isCollected:n,padId:o,domainId:r}).then((function(){var t;p.default.show({type:"success",duration:2e3,message:n?"已移除收藏":"已添加到收藏",autoClose:!0,className:"dui-m-collect"}),v=!1,null===(t=e.success)||void 0===t||t.call(e)})).catch((function(){var t;p.default.show({type:"error",message:i.ZP.t("添加收藏失败"),autoClose:!0,className:"dui-m-collect"}),v=!1,null===(t=e.fail)||void 0===t||t.call(e)})),v=!0}var w=n("../spread-sheet/src/core/utils/gray.ts"),j=function(e,t,n,r){var o,s=arguments.length,a=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var i=e.length-1;i>=0;i--)(o=e[i])&&(a=(s<3?o(a):s>3?o(t,n,a):o(t,n))||a);return s>3&&a&&Object.defineProperty(t,n,a),a},_=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},x=function(){function e(){var e=a.q.getConfig("docInfo");this.isCollected=null===e||void 0===e?void 0:e.isCollected}var t=e.prototype;return t.getIsCollected=function(){return this.isCollected},t.handleClickFavorite=function(){var e=this,t=a.q.getConfig("docInfo");(function(){var e=a.q.getConfig("docStatus"),t=a.q.getConfig("domainId"),r=a.q.getConfig("padId"),o=d().stringify({domain_id:t,pad_id:r,xsrf:(0,f.f)()});return new Promise((function(t,r){if(12!==e)return y({success:t,fail:r});l().post(g,o).then((function(){var e;null===(e=n.g.SLR)||void 0===e||e.dispatch("DOC_HUMTRANS_DONE"),y({success:t,fail:r})})).catch((function(e){p.default.show({type:"error",message:i.ZP.t("添加收藏失败"),autoClose:!0,className:"dui-m-collect"}),r(e)}))}))})().then((function(){a.q.setConfig({docInfo:Object.assign(Object.assign({},t),{isCollected:!e.isCollected})}),e.isCollected=!e.isCollected,o.ZP.tdwReport({module:"more_menu",opername:"doc_editor_topbar_pc",action:"favorite",ver5:e.isCollected?1:2})})).catch((function(e){var t;null===(t=n.g.log)||void 0===t||t.error("添加收藏错误",e)}))},t.shouldHide=function(){return(0,w.i)()},e}();x=j([(0,r.L)({name:"FavoriteFeature",adapters:[s.L]}),_("design:paramtypes",[])],x)},"../spread-sheet/src/external/view/ui-layer/file-info-panel/file-info-panel-feature-mobile.tsx":function(e,t,n){n.r(t),n.d(t,{FileInfoFeatureMobile:function(){return f}}),n("../node_modules/core-js/modules/es.object.get-own-property-descriptor.js");var r=n("../node_modules/@tencent/workbench/lib/esm/decorators/class/feature.js"),o=n("../node_modules/@tencent/docs-user-agent/dist/index.js"),s=n.n(o),a=n("../spread-sheet/src/adapter/SpreadSheetAppAdapter.ts"),i=n("../spread-sheet/src/core/data/configService/spreadConfig.ts"),c=n("../node_modules/@tencent/tencent_doc_open_url/dist/index.js"),d=n("../spread-sheet/src/external/sheet-adapter/smart-sheet-adapter/constants.ts"),u=n("../spread-sheet/src/base/util/appConfig.ts"),l=n("../spread-sheet/src/core/utils/gray.ts"),p=function(e,t,n,r){var o,s=arguments.length,a=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var i=e.length-1;i>=0;i--)(o=e[i])&&(a=(s<3?o(a):s>3?o(t,n,a):o(t,n))||a);return s>3&&a&&Object.defineProperty(t,n,a),a},f=function(){function e(){}var t=e.prototype;return t.show=function(){var e=i.q.getConfig("padId"),t="https://"+u.Z.getConfig("runtime.domainName")+"/tim/docs/components/FileInfoPanelMobile.html?fileId="+e;(0,c.tencentDocOpenUrlForAll)({url:t})},t.getShowState=function(){return!1!==u.Z.getConfig("menu.docCreateInfo")&&!(s().isWxWork&&(0,l.c)())},e}();f=p([(0,r.L)({name:"FileInfoFeatureMobile",adapters:[a.L,d.dH]})],f)},"../spread-sheet/src/external/view/ui-layer/file-info-panel/file-info-panel-feature-pc.tsx":function(e,t,n){n.r(t),n.d(t,{FileInfoFeaturePC:function(){return C}}),n("../node_modules/regenerator-runtime/runtime.js"),n("../node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),n("../node_modules/core-js/modules/esnext.reflect.metadata.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.promise.js");var r,o,s,a=n("../node_modules/@tencent/workbench/lib/esm/decorators/class/feature.js"),i=n("../spread-sheet/src/external/sheet-adapter/smart-sheet-adapter/constants.ts"),c=n("../spread-sheet/src/adapter/SpreadSheetAppAdapter.ts"),d=n("../node_modules/@babel/runtime/helpers/esm/assertThisInitialized.js"),u=n("../node_modules/@babel/runtime/helpers/esm/inheritsLoose.js"),l=n("../node_modules/@tencent/workbench/lib/esm/decorators/class/service.js"),p=n("../spread-sheet/src/core/app/SpreadsheetApp.interface.ts"),f=n("../spread-sheet/src/core/script-loader/index.ts"),m=n("../spread-sheet/src/core/workbench/common/base-drawer.tsx"),h=n("../spread-sheet/src/external/view/ui-layer/read-record/read-record-drawer.ts"),g=n("../spread-sheet/src/core/data/configService/spreadConfig.ts"),v=function(e,t,n,r){var o,s=arguments.length,a=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var i=e.length-1;i>=0;i--)(o=e[i])&&(a=(s<3?o(a):s>3?o(t,n,a):o(t,n))||a);return s>3&&a&&Object.defineProperty(t,n,a),a},y=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},w=function(e,t){return function(n,r){t(n,r,e)}},j=function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function a(e){try{c(r.next(e))}catch(t){s(t)}}function i(e){try{c(r.throw(e))}catch(t){s(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,i)}c((r=r.apply(e,t||[])).next())}))},_=function(e){function t(t,n){var r;return(r=e.call(this,t,"file-info-drawer")||this).app=t,r.readRecordDrawer=n,r.afterOpenDrawer=function(){(0,f.$y)("FileInfoPanel",(function(e){e.mount(document.getElementById(r.drawerId),{onClose:r.closeDrawer,onClickPermission:r.onClickPermission,onClickRecently:r.onClickRecently,onClickHistory:r.onClickHistory,onClickLastModify:r.onClickLastModify}),e.show({fileId:g.q.getConfig("padId")})}))},r.afterCloseDrawer=function(){(0,f.$y)("FileInfoPanel",(function(e){e.remove()}))},r.onClickPermission=function(){var e;r.closeDrawer(),null===(e=document.getElementById("header-btn-auth"))||void 0===e||e.click()},r.onClickRecently=function(){r.closeDrawer(),r.readRecordDrawer.openDrawer()},r.onClickHistory=function(){return j((0,d.Z)(r),void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.closeDrawer(),e.next=3,this.app.history.getInstance();case 3:e.sent.show(null,"version");case 4:case"end":return e.stop()}}),e,this)})))},r.onClickLastModify=function(){return j((0,d.Z)(r),void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.closeDrawer(),e.next=3,this.app.history.getInstance();case 3:e.sent.show();case 4:case"end":return e.stop()}}),e,this)})))},r}return(0,u.Z)(t,e),t}(m.Z),x=_=v([(0,l.t)(),w(0,p.m),y("design:paramtypes",["function"===typeof(r="undefined"!==typeof p.m&&p.m)?r:Object,"function"===typeof(o="undefined"!==typeof h.Z&&h.Z)?o:Object])],_),b=function(e,t,n,r){var o,s=arguments.length,a=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var i=e.length-1;i>=0;i--)(o=e[i])&&(a=(s<3?o(a):s>3?o(t,n,a):o(t,n))||a);return s>3&&a&&Object.defineProperty(t,n,a),a},R=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},S=function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function a(e){try{c(r.next(e))}catch(t){s(t)}}function i(e){try{c(r.throw(e))}catch(t){s(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,i)}c((r=r.apply(e,t||[])).next())}))},C=function(e){var t=this;this.fileInfoDrawer=e,this.show=function(){return S(t,void 0,void 0,regeneratorRuntime.mark((function e(){var t,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(null===(r=null===(t=n.g.CoreSheet)||void 0===t?void 0:t.recordChange)||void 0===r?void 0:r.isShow)&&n.g.CoreSheet.recordChange.hideRecordSide(),this.fileInfoDrawer.openDrawer();case 2:case"end":return e.stop()}}),e,this)})))}};C=b([(0,a.L)({adapters:[c.L,i.dH]}),R("design:paramtypes",["function"===typeof(s="undefined"!==typeof x&&x)?s:Object])],C)},"../spread-sheet/src/external/view/ui-layer/file/file-feature.tsx":function(e,t,n){n.r(t),n.d(t,{FileFeature:function(){return l}}),n("../node_modules/core-js/modules/es.object.get-own-property-descriptor.js");var r=n("../node_modules/i18next/dist/esm/i18next.js"),o=n("../node_modules/@tencent/workbench/lib/esm/decorators/class/feature.js"),s=n("../spread-sheet/src/core/data/configService/spreadConfig.ts"),a=n("../node_modules/@babel/runtime/helpers/esm/inheritsLoose.js"),i=n("react"),c=function(e){function t(){return e.apply(this,arguments)||this}return(0,a.Z)(t,e),t.prototype.render=function(){return i.createElement("div",{className:"offline-cache "+(this.props.hasCache?"has-cache":"no-cache")},i.createElement("img",{className:"icon",src:"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMzJweCIgaGVpZ2h0PSIzMnB4IiB2aWV3Qm94PSIwIDAgMzIgMzIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8dGl0bGU+Y2xvdWQgX3N1Y2NlZWQ8L3RpdGxlPgogICAgPGcgaWQ9Iumhtemdoi0xIiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4KICAgICAgICA8ZyBpZD0iaWNvbi90aGlyZGFyeS9vbmxpbmUiPgogICAgICAgICAgICA8ZyBpZD0i57yW57uEIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgwLjAwMDAwMCwgMC4wMDAwMDApIj4KICAgICAgICAgICAgICAgIDxwYXRoIGQ9Ik0xNiw2IEMxMy43MDk1ODcyLDYgMTEuNjI4MDMyNCw2LjkzMDU5OTcgMTAuMDc2OTgyMSw4LjQ0NTU3NTI4IEM4LjUwMDE2OTEyLDkuOTg1NzE0NDQgNy40NzAxODM3MSwxMi4xMjg0Njk1IDcuMzE1NjEyMzQsMTQuNTIxNTcxIEM3LjI5OTE2ODM4LDE0Ljc3NjE1OTQgNy4yOTI5MTQxOCwxNS4wMjkyMTI1IDcuMjk2NTExOTgsMTUuMjgwMjU4OSBDNy4wNTQzMTUxLDE1LjMxMjY5OTQgNi44MTMwNDg1MSwxNS4zNjAyNjg2IDYuNTc0MjAzNjEsMTUuNDIzNjU2IEM1LjI0ODEzMjgyLDE1Ljc3NTU4NCA0LjA5OTAxNTU4LDE2LjU4Nzk1NjEgMy4yODQ3MDY3MiwxNy42ODQxMTYzIEMyLjQ3ODE4MzY2LDE4Ljc2OTc5NTkgMiwyMC4xMzQzODM0IDIsMjEuNjE1Mzg0NiBDMiwyMy4zODM3ODYxIDIuNjgxOTk0MjksMjQuOTg2NiAzLjc5MDM1NDIzLDI2LjE0NjExNSBDNC44ODI3NTA3OSwyNy4yODg5Mjk4IDYuMzkwNjk1MDMsMjggOC4wNTg4MjM1MywyOCBMMjQuMTQ0MzAzMywyNy45OTY0ODk2IEMyNS43NjU3NjMxLDI3Ljk0MDM0MTYgMjcuMjIzMDU5OCwyNy4yMTIwMjgxIDI4LjI3NjYzMDUsMjYuMDc0OTM4MSBDMjkuMzQ1NDMxMiwyNC45MjE0MTA4IDMwLDIzLjM0Nzg5MzcgMzAsMjEuNjE1Mzg0NiBDMzAsMjAuMTM0NDM2IDI5LjUyMTg1MTksMTguNzY5ODk0IDI4LjcxNTUwNTUsMTcuNjg0MjA0NiBDMjcuOTAxMzEwNSwxNi41ODc5NDc3IDI2Ljc1MjM5NDYsMTUuNzc1NDU1MiAyNS40MjY3MjY3LDE1LjQyMzQyODIgQzI1LjE4ODExNjIsMTUuMzYwMDY1OSAyNC45NDcwNzY3LDE1LjMxMjQ5NzEgMjQuNzA0OTE5MiwxNS4yODAyODQxIEMyNC43MDgyNzU5LDE1LjAyOTIzODUgMjQuNzAxOTY3OSwxNC43NzYxNzY4IDI0LjY4NTQ3MTUsMTQuNTIxNTg0MSBDMjQuNTMwNDA2OSwxMi4xMjg0NDE5IDIzLjUwMDEwMDEsOS45ODU2MjMwOSAyMS45MjMwNTMyLDguNDQ1NDU2ODUgQzIwLjM3MTg4Niw2LjkzMDU2NTEyIDE4LjI5MDM2OTYsNiAxNiw2IFoiIGlkPSLot6/lvoQiIHN0cm9rZT0iI0FEQURBRCIgc3Ryb2tlLXdpZHRoPSIyIj48L3BhdGg+CiAgICAgICAgICAgICAgICA8cGF0aCBkPSJNMTIuNjI0NjI2MSwyMy41MDkwODI1IEwxMi42MjUyNDk1LDIzLjUwODkzMzIgTDguODA2MjQ5NSwxOS42OTA3MDU5IEwxMC4wNzkwNDE3LDE4LjQxNzkxMzcgTDEzLjg5NzI0OTUsMjIuMjM1OTMzMiBMMjAuODk3Nzc1NSwxNS4yMzU5MzMyIEwyMi4xNzA1Njc3LDE2LjUwODcyNTQgTDEzLjg5NzQxODMsMjQuNzgxODc0NyBMMTIuNjI0NjI2MSwyMy41MDkwODI1IFoiIGlkPSLlvaLnirbnu5PlkIgiIGZpbGw9IiNBREFEQUQiPjwvcGF0aD4KICAgICAgICAgICAgPC9nPgogICAgICAgIDwvZz4KICAgIDwvZz4KPC9zdmc+"}))},t}(i.Component),d=n("../spread-sheet/src/core/utils/gray.ts"),u=function(e,t,n,r){var o,s=arguments.length,a=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var i=e.length-1;i>=0;i--)(o=e[i])&&(a=(s<3?o(a):s>3?o(t,n,a):o(t,n))||a);return s>3&&a&&Object.defineProperty(t,n,a),a},l=function(){function e(){}var t=e.prototype;return t.getTitle=function(){return window.SpreadsheetApp.spreadsheet.getTitle()||""},t.createInfo=function(){var e=s.q.getConfig("docInfo")||{},t=s.q.getConfig("ownerId"),n=s.q.getConfig("uid"),o=s.q.getConfig("tinyid"),a=(0,d.c)(),i=2===e.ownerUidSource,u=t===n||t===o?r.ZP.t("我"):""+e.ownerName+(a&&i?r.ZP.t("@微信"):""),l=[r.ZP.t("创建人：{{createUserName}}",{createUserName:u}),React.createElement(c,{hasCache:!1})];return{titleTag:window.SpreadsheetApp.sheetStatus.workbookStatus.canEdit?"":r.ZP.t("只读"),tags:l}},e}();l=u([(0,o.L)({name:"FileFeature"})],l)},"../spread-sheet/src/external/view/ui-layer/find-replace/find-replace-feature.ts":function(e,t,n){n.r(t),n.d(t,{FindReplaceFeature:function(){return h}}),n("../node_modules/regenerator-runtime/runtime.js"),n("../node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),n("../node_modules/core-js/modules/esnext.reflect.metadata.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.promise.js");var r,o,s=n("../node_modules/@tencent/workbench/lib/esm/decorators/class/feature.js"),a=n("../spread-sheet/src/core/app/SpreadsheetApp.interface.ts"),i=n("../spread-sheet/src/core/app/sheetStatus/index.ts"),c=n("../packages/report/src/index.ts"),d=n("../spread-sheet/src/adapter/SpreadSheetAppAdapter.ts"),u=n("../spread-sheet/src/core/view/level-2/search-replace2/panel/pc/search-replace-modal.tsx"),l=function(e,t,n,r){var o,s=arguments.length,a=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var i=e.length-1;i>=0;i--)(o=e[i])&&(a=(s<3?o(a):s>3?o(t,n,a):o(t,n))||a);return s>3&&a&&Object.defineProperty(t,n,a),a},p=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},f=function(e,t){return function(n,r){t(n,r,e)}},m=function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function a(e){try{c(r.next(e))}catch(t){s(t)}}function i(e){try{c(r.throw(e))}catch(t){s(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,i)}c((r=r.apply(e,t||[])).next())}))},h=function(){function e(e,t){this.app=e,this.sheetStatus=t}var t=e.prototype;return t.show=function(){var e;return m(this,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:null===(e=this.app.view.canvas)||void 0===e||e.searchReplaceCenter.show(u.N.BASIC_SEARCH);case 1:case"end":return t.stop()}}),t,this)})))},t.canEdit=function(){return this.sheetStatus.canEdit},t.onMobileFind=function(){this.show(),c.ZP.tdwReport({opername:"doc_miniapp",module:"find_replace",action:"clk"})},t.onMobileReplace=function(){var e;null===(e=this.app.view.canvas)||void 0===e||e.searchReplaceCenter.show(u.N.ADVANCED_SEARCH),c.ZP.tdwReport({opername:"doc_excel_editor",module:"excel_mob_search",action:"mob_clk_find_replace"})},t.onMobileFindReplace=function(){var e,t=this.canEdit()?u.N.ADVANCED_SEARCH:u.N.BASIC_SEARCH;null===(e=this.app.view.canvas)||void 0===e||e.searchReplaceCenter.show(t)},e}();h=l([(0,s.L)({adapters:[d.L]}),f(0,a.m),f(1,i.T),p("design:paramtypes",["function"===typeof(r="undefined"!==typeof a.m&&a.m)?r:Object,"function"===typeof(o="undefined"!==typeof i.T&&i.T)?o:Object])],h)},"../spread-sheet/src/external/view/ui-layer/float-img-context-menu/float-img-context-menu-feature.ts":function(e,t,n){n.r(t),n.d(t,{FloatImgContextMenuFeature:function(){return L}}),n("../node_modules/regenerator-runtime/runtime.js"),n("../node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),n("../node_modules/core-js/modules/esnext.reflect.metadata.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.promise.js");var r,o,s,a,i,c=n("../node_modules/i18next/dist/esm/i18next.js"),d=n("../node_modules/@tencent/containerized/build/main/index.js"),u=n("../node_modules/@tencent/workbench/lib/esm/constants/service-name.js"),l=n("../node_modules/@tencent/workbench/lib/esm/decorators/class/feature.js"),p=n("../packages/report/src/index.ts"),f=n("../packages/model/src/embedded/index.ts"),m=n("../node_modules/@tencent/dui-mobile/lib/components/Modal/index.js"),h=n("../node_modules/@tencent/dui/lib/components/Modal/index.js"),g=n("../packages/model/src/range/hexRangeUtils.ts"),v=n("../spread-sheet/src/core/view/layout/interface/pc-view.ts"),y=n("../spread-sheet/src/core/behavior/api.interface.ts"),w=n("../spread-sheet/src/core/app/SpreadsheetApp.interface.ts"),j=n("../spread-sheet/src/core/app/sheetStatus/index.ts"),_=n("../spread-sheet/src/core/app/sheetStatus/ranges.ts"),x=n("../packages/model/src/spreadsheet/index.ts"),b=n("../packages/model/src/range/index.ts"),R=n("../spread-sheet/src/core/view/spreadsheet-view/utils.ts"),S=n("react"),C=n.n(S),E=n("react-dom"),I=n.n(E),M=n("../spread-sheet/src/base/util/ui.tsx"),T=C().createRef(),O=function(e){T.current&&I().unmountComponentAtNode(e)},D=n("../spread-sheet/src/adapter/SpreadSheetAppAdapter.ts"),A=function(e,t,n,r){var o,s=arguments.length,a=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var i=e.length-1;i>=0;i--)(o=e[i])&&(a=(s<3?o(a):s>3?o(t,n,a):o(t,n))||a);return s>3&&a&&Object.defineProperty(t,n,a),a},k=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},P=function(e,t){return function(n,r){t(n,r,e)}},N=function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function a(e){try{c(r.next(e))}catch(t){s(t)}}function i(e){try{c(r.throw(e))}catch(t){s(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,i)}c((r=r.apply(e,t||[])).next())}))},L=function(){function e(e,t,n,r,o){var s,a=this;this.app=e,this.view=t,this.dynamicApi=n,this.spreadsheet=r,this.sheetStatus=o,this.getRenderWidthHeight=function(e,t){var n,r,o,s,i=a.view.canvas.tableView.getCellViewAtPosition(t,e),c=null===(r=null===(n=a.spreadsheet.activeSheet.data.rowMetadata)||void 0===n?void 0:n[t])||void 0===r?void 0:r.hiddenByUser;return{width:(null===(s=null===(o=a.spreadsheet.activeSheet.data.colMetadata)||void 0===o?void 0:o[e])||void 0===s?void 0:s.hiddenByUser)?0:(0,R.o)(a.view.canvas.rowcolAccessor,i,e)*a.app.view.canvas.scale.scale,height:c?0:(0,R.E)(a.view.canvas.rowcolAccessor,i,t)*a.app.view.canvas.scale.scale}},this.domContainer=document.createElement("div"),this.domContainer.classList.add("convert-image-highlight-board"),null===(s=this.view.canvas.mainBoard)||void 0===s||s.element.appendChild(this.domContainer)}var t=e.prototype;return t.highlightCell=function(){var e=this.getRelatedCell();if(e){var t=e.colIndex,n=e.rowIndex;this.showHighlight(n,t)}},t.cancelHighlightCell=function(){this.hideHighlight()},t.cut=function(e){return N(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=this.app.feature.copyPasteBase.CopyType,t.next=3,this.app.feature.getCopyPaste();case 3:t.sent.doShapesCopy(n.cut),this.reportCut(e);case 6:case"end":return t.stop()}}),t,this)})))},t.copy=function(e){return N(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=this.app.feature.copyPasteBase.CopyType,t.next=3,this.app.feature.getCopyPaste();case 3:t.sent.doShapesCopy(n.copy),this.reportCopy(e);case 6:case"end":return t.stop()}}),t,this)})))},t.crop=function(){this.view.canvas.shapeEditCenter.shapeEdit.edit.enterCrop()},t.reset=function(e){e!==u.v.MOBILE_CONTEXT_MENU?this.app.view.canvas.shapeEditCenter.shapeEdit.edit.reset():this.view.canvas.shapeEditCenter.shapeEdit.shapeZoom.show(this.view.canvas.shapeEditCenter.shapeEdit.shapeId)},t.toCellImg=function(e){var t,n;return N(this,void 0,void 0,regeneratorRuntime.mark((function r(){var o,s,a,i;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(o=e===u.v.MOBILE_CONTEXT_MENU,s=this.getRelatedCell()){r.next=4;break}return r.abrupt("return");case 4:if(a=s.rowIndex,i=s.colIndex,!(null===(n=null===(t=this.spreadsheet.activeSheet.getCellDataAtPosition(a,i))||void 0===t?void 0:t.getEffectiveValue())||void 0===n?void 0:n.value)){r.next=8;break}return o?this.toCellImageConfirmMobile(a,i):this.toCellImageConfirmPc(),r.abrupt("return");case 8:return r.next=10,this.convertImage();case 10:o?this.selectSingleCell(a,i):this.hideHighlight();case 11:case"end":return r.stop()}}),r,this)})))},t.delete=function(e){this.view.canvas.modifyShapeBroker.deleteShape(this.view.canvas.shapeEditCenter.shapeEdit.shapeId),this.reportDelete(e),this.view.canvas.shapeEditCenter.shapeEdit.hide()},t.getToCellImgTextPc=function(){var e=this.getRelatedCell();if(!e)return c.ZP.t("转为单元格图片");var t=e.colIndex,n=e.rowIndex;return c.ZP.t("转为单元格图片({{colChar}})",{colChar:""+(0,g.colIndex2ColChar)(t)+(n+1)})},t.isFloatImageRelatedCellRangeReadOnly=function(){var e=this.getRelatedCell();if(!e)return!1;var t=this.app.spreadsheet.activeSheetId,n=e.rowIndex,r=e.colIndex,o=new b.GridRange(t,n,n,r,r);return this.sheetStatus.rangesStatus.checkRangeStatus(o)===_.BP.READ_ONLY},t.reportCut=function(e){e===u.v.CONTEXT_MENU?p.ZP.tdwReport({module:"excel_picture",opername:"doc_excel_editor",action:"picture_menu_cut"}):e===u.v.MOBILE_CONTEXT_MENU&&p.ZP.tdwReport({module:"excel_picture",opername:"doc_excel_editor",action:"mob_picture_menu_cut"})},t.reportCopy=function(e){e===u.v.CONTEXT_MENU?p.ZP.tdwReport({module:"excel_picture",opername:"doc_excel_editor",action:"picture_menu_copy"}):e===u.v.MOBILE_CONTEXT_MENU&&p.ZP.tdwReport({module:"excel_picture",opername:"doc_excel_editor",action:"mob_picture_menu_copy"}),window.isRecordPreviewShowing&&p.ZP.tdwReport({opername:"doc_excel",module:"revise",action:"upv"})},t.reportDelete=function(e){e===u.v.CONTEXT_MENU?p.ZP.tdwReport({module:"excel_picture",opername:"doc_excel_editor",action:"picture_menu_del"}):e===u.v.MOBILE_CONTEXT_MENU&&p.ZP.tdwReport({module:"excel_picture",opername:"doc_excel_editor",action:"mob_picture_menu_del"})},t.getRelatedCell=function(){var e=this.spreadsheet.activeSheet.imageManager.getImage(this.view.canvas.shapeEditCenter.shapeEdit.shapeId);return e?e.position.overlayPosition.anchorCell:null},t.toCellImageConfirmMobile=function(e,t){var n=this;m.default.confirm({title:c.ZP.t("转为单元格图片"),content:c.ZP.t("插入单元格图片将会覆盖单元格内容，继续设置吗？"),onOk:function(){n.convertImage(),setTimeout((function(){n.selectSingleCell(e,t)}),16)}})},t.toCellImageConfirmPc=function(){var e=this;h.default.confirm({title:c.ZP.t("转为单元格图片"),content:c.ZP.t("插入单元格图片将会覆盖单元格内容，继续设置吗？"),onOk:function(){e.convertImage(),e.hideHighlight()},onCancel:function(){e.hideHighlight()}})},t.convertImage=function(){var e;return N(this,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.dynamicApi.getInstance();case 2:t.sent.convertImageType(this.view.canvas.shapeEditCenter.shapeEdit.shapeId,f.EMBEDDED_OBJECT_TYPE.CELL_IMAGE),null===(e=this.view.canvas.shapeEdit)||void 0===e||e.hide(),p.ZP.tdwReport({opername:"doc_excel_editor",module:"excel_photo",action:"photo_change",ver10:"to_cell_photo"});case 6:case"end":return t.stop()}}),t,this)})))},t.selectSingleCell=function(e,t){var n=this.view.canvas,r=n.normalSelectData,o=n.selectApi;r.resetSelection();var s={xRange:[t,t],yRange:[e,e]};o.selectCells(r,s,{row:e,col:t})},t.showHighlight=function(e,t){var n=this.view.canvas.areaData.getDisplayViewLeftByCol(t),r=this.view.canvas.areaData.getDisplayViewTopByRow(e),o=this.getRenderWidthHeight(t,e),s=o.width,a=o.height,i={left:n,top:r,height:a>0?a-1:a,width:s>0?s-1:s};!function(e,t){var n,r=(null===(n=T.current)||void 0===n?void 0:n.state)||{},o=r.width,s=r.height,a=r.left,i=r.top;t.left===a&&t.top===i&&t.width===o&&t.height===s||((null===T||void 0===T?void 0:T.current)&&O(e),I().render(C().createElement(M.WW,{ref:T,left:t.left,top:t.top,width:t.width,height:t.height,style:{border:"2px solid #4b8cff",margin:"-1px 0 0 -1px"}}),e))}(this.domContainer,i),this.view.canvas.shapeEditCenter.shapeToCellHighlightPlugin.showHighlight([{x:t,y:e}])},t.hideHighlight=function(){O(this.domContainer),this.view.canvas.shapeEditCenter.shapeToCellHighlightPlugin.hideHighlight()},e}();L=A([(0,l.L)({adapters:[D.L]}),P(0,w.m),P(1,v.w),P(2,y.V),P(3,x.ISpreadsheet),P(4,j.T),k("design:paramtypes",["function"===typeof(r="undefined"!==typeof w.m&&w.m)?r:Object,"function"===typeof(o="undefined"!==typeof v.w&&v.w)?o:Object,"function"===typeof(s="undefined"!==typeof d.RU&&d.RU)?s:Object,"function"===typeof(a="undefined"!==typeof x.ISpreadsheet&&x.ISpreadsheet)?a:Object,"function"===typeof(i="undefined"!==typeof j.T&&j.T)?i:Object])],L)},"../spread-sheet/src/external/view/ui-layer/font-color/font-color-feature.tsx":function(e,t,n){n.r(t),n.d(t,{FontColorFeature:function(){return I}}),n("../node_modules/regenerator-runtime/runtime.js"),n("../node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),n("../node_modules/core-js/modules/esnext.reflect.metadata.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.promise.js");var r,o,s,a,i=n("../packages/report/src/index.ts"),c=n("react"),d=n.n(c),u=n("../node_modules/@tencent/containerized/build/main/index.js"),l=n("../node_modules/@tencent/workbench/lib/esm/constants/service-name.js"),p=n("../node_modules/@tencent/workbench/lib/esm/components/toolbar/common-dropdown/colorpicker/colorpicker.js"),f=n("../node_modules/@tencent/workbench/lib/esm/decorators/class/feature.js"),m=n("../spread-sheet/src/core/behavior/api.interface.ts"),h=n("../spread-sheet/src/external/view/ui-layer/format-style/get-text-format.ts"),g=n("../spread-sheet/src/external/view/ui-layer/font-color/config.tsx"),v=n("../spread-sheet/src/adapter/SpreadSheetAppAdapter.ts"),y=n("../spread-sheet/src/core/workbench/common/input-manager-service.ts"),w=n("../spread-sheet/src/core/app/SpreadsheetApp.interface.ts"),j=n("../spread-sheet/src/external/view/common/view-abtest.ts"),_=n("../node_modules/i18next/dist/esm/i18next.js"),x=n("../packages/model/src/cell/format/Color.ts"),b=n("../spread-sheet/src/external/check-slr/sc-lazy-loader.ts"),R=function(e,t,n,r){var o,s=arguments.length,a=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var i=e.length-1;i>=0;i--)(o=e[i])&&(a=(s<3?o(a):s>3?o(t,n,a):o(t,n))||a);return s>3&&a&&Object.defineProperty(t,n,a),a},S=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},C=function(e,t){return function(n,r){t(n,r,e)}},E=function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function a(e){try{c(r.next(e))}catch(t){s(t)}}function i(e){try{c(r.throw(e))}catch(t){s(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,i)}c((r=r.apply(e,t||[])).next())}))},I=function(){function e(e,t,n,r){this.app=e,this.dynamicApi=t,this.getTextFormatService=n,this.inputManagerService=r,this.defaultFontColor="#000000",this.toolbarFontColor=this.defaultFontColor}var t=e.prototype;return t.getFontColor=function(e){if(e===l.v.TOOLBAR)return this.toolbarFontColor;var t=this.getTextFormatService.getTextFormatForCurrentSelection();return x.Z.getColorHexCode(null===t||void 0===t?void 0:t.color,this.app.spreadsheet)||this.defaultFontColor},t.selectFontColor=function(e,t,n){return E(this,void 0,void 0,regeneratorRuntime.mark((function r(){return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(this.inputManagerService.checkInputAndFormat("foreColor",t)){r.next=3;break}return r.next=3,this.requestFontColor(t);case 3:this.toolbarFontColor=t,e===l.v.MOBILE_TOOLBAR&&i.ZP.tdwReport({opername:"doc_excel_editor",module:"excel_style",action:"mob_fontclr_"+g.nG[n].alias});case 5:case"end":return r.stop()}}),r,this)})))},t.reportShowPalette=function(){i.ZP.tdwReport({opername:"doc_excel_editor",module:"excel_style",action:"clk_fontcolor",abtest:(0,j.PA)(j.c6)})},t.reportShowEyedropper=function(){i.ZP.tdwReport({opername:"doc_excel_editor",module:"excel_style",action:"clk_font_user_get",abtest:(0,j.PA)(j.c6)})},t.reportEyedropperSelect=function(e){i.ZP.tdwReport({opername:"doc_excel_editor",module:"excel_style",action:"clk_font_user_get_color",ver5:e,abtest:(0,j.PA)(j.c6)})},t.reportSetFontColor=function(e){i.ZP.tdwReport({opername:"doc_excel_editor",module:"excel_style",action:"clk_font_key_color",ver5:e,abtest:(0,j.PA)(j.c6)})},t.reportSelectFontColor=function(e){i.ZP.tdwReport({opername:"doc_excel_editor",module:"excel_style",action:"clk_font_color",ver5:e,abtest:(0,j.PA)(j.c6)})},t.getFontColorPicker=function(e){var t=this,n=this.getFontColor(l.v.TOOLBAR);return(0,j.cp)()?d().createElement(c.Suspense,{fallback:d().createElement("div",null)},d().createElement(b.h2,{hasHeaderButton:!1,eyedropperTargetDom:this.app.view.canvas.container,showSubPalette:!0,onColorChange:function(n,r){return t.onColorChange(n,e,r)},selectedColor:n,onEyedropperVisibleChange:function(e){return t.onEyedropperVisibleChange(e)}})):d().createElement(p.z,{showSubPalette:!0,selected:n,onChange:function(n){return t.onColorChange(n,e)},customColorText:_.ZP.t("自定义颜色"),recentColorsText:_.ZP.t("最近使用")})},t.requestFontColor=function(e){return E(this,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.dynamicApi.getInstance();case 2:t.sent.setFontColor(e);case 4:case"end":return t.stop()}}),t,this)})))},t.onColorChange=function(e,t,n){return E(this,void 0,void 0,regeneratorRuntime.mark((function r(){var o;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(e){r.next=2;break}return r.abrupt("return");case 2:return r.next=4,(0,b.Tf)();case 4:o=r.sent,n===o.ColorSourceType.EYE_DROPPER?this.reportEyedropperSelect(e):this.reportSelectFontColor(e),this.selectFontColor(t,e);case 7:case"end":return r.stop()}}),r,this)})))},t.onEyedropperVisibleChange=function(e){e&&this.reportShowEyedropper()},e}();I=R([(0,f.L)({adapters:[v.L]}),C(0,w.m),C(1,m.V),S("design:paramtypes",["function"===typeof(r="undefined"!==typeof w.m&&w.m)?r:Object,"function"===typeof(o="undefined"!==typeof u.RU&&u.RU)?o:Object,"function"===typeof(s="undefined"!==typeof h.g&&h.g)?s:Object,"function"===typeof(a="undefined"!==typeof y.Z&&y.Z)?a:Object])],I)},"../spread-sheet/src/external/view/ui-layer/font-family/font-family-feature.ts":function(e,t,n){n.r(t),n.d(t,{FontFamilyFeature:function(){return j}}),n("../node_modules/regenerator-runtime/runtime.js"),n("../node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),n("../node_modules/core-js/modules/esnext.reflect.metadata.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.promise.js"),n("../node_modules/core-js/modules/web.dom-collections.for-each.js"),n("../node_modules/core-js/modules/es.regexp.exec.js"),n("../node_modules/core-js/modules/es.string.split.js");var r,o,s,a=n("../node_modules/@tencent/containerized/build/main/index.js"),i=n("../packages/report/src/index.ts"),c=n("../node_modules/@tencent/workbench/lib/esm/decorators/class/feature.js"),d=n("../spread-sheet/src/base/config/font.ts"),u=n("../spread-sheet/src/external/view/ui-layer/format-style/get-text-format.ts"),l=n("../spread-sheet/src/core/behavior/api.interface.ts"),p=n("../spread-sheet/src/core/workbench/common/input-manager-service.ts"),f=n("../spread-sheet/src/external/view/schema/toolbar-schema.ts"),m=n("../spread-sheet/src/adapter/SpreadSheetAppAdapter.ts"),h=n("../spread-sheet/src/base/helper/font-detect-engine.ts"),g=function(e,t,n,r){var o,s=arguments.length,a=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var i=e.length-1;i>=0;i--)(o=e[i])&&(a=(s<3?o(a):s>3?o(t,n,a):o(t,n))||a);return s>3&&a&&Object.defineProperty(t,n,a),a},v=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},y=function(e,t){return function(n,r){t(n,r,e)}},w=function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function a(e){try{c(r.next(e))}catch(t){s(t)}}function i(e){try{c(r.throw(e))}catch(t){s(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,i)}c((r=r.apply(e,t||[])).next())}))},j=function(){function e(e,t,n){this.dynamicApi=e,this.textFormatService=t,this.inputManagerService=n}var t=e.prototype;return t.getFontList=function(){return this.fontList},t.getFontFamilyAndName=function(){if(this.fontList||this.initFontList(),this.inputManagerService.isInputtingState()){var e=this.inputManagerService.getInputStateValue(f.HM.FONT_FAMILY);return this.updateFontFamily(e)}var t=this.textFormatService.getTextFormatForCurrentSelection();return this.updateFontFamily(null===t||void 0===t?void 0:t.fontFamily)},t.selectFont=function(e){return w(this,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.inputManagerService.checkInputAndFormat("fontName",e)){t.next=3;break}return t.next=3,this.requestFontFamily(e);case 3:case"end":return t.stop()}}),t,this)})))},t.handleTdwClick=function(){i.ZP.tdwReport({opername:"doc_excel",module:"pc_edit",action:"fontname_click",ver12:"new"})},t.initFontList=function(){var e=this;this.fontList=[],h.r.getInstance().getSupportedFontFamily().forEach((function(t){var n,r=null!==(n=d.X2[t])&&void 0!==n?n:t;e.fontList.push({id:t,content:r,style:{fontFamily:t}})}))},t.isFontFamilyNeedFormat=function(e){return!(!(null===e||void 0===e?void 0:e.indexOf(","))||e===d.em)},t.updateFontFamily=function(e){var t,n,r,o;this.isFontFamilyNeedFormat(e)&&(e=e.split(",")[0]);var s=null!==(t=d.XP[e])&&void 0!==t?t:e;return s&&h.r.getInstance().isSupportFontFamily(s)?(r=s,o=null!==(n=d.X2[s])&&void 0!==n?n:s):(r=this.fontList[0].id,o=this.fontList[0].content),[r,o]},t.requestFontFamily=function(e){return w(this,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.dynamicApi.getInstance();case 2:t.sent.setFontFamily(e===d.em?"":e);case 4:case"end":return t.stop()}}),t,this)})))},e}();j=g([(0,c.L)({adapters:[m.L]}),y(0,l.V),v("design:paramtypes",["function"===typeof(r="undefined"!==typeof a.RU&&a.RU)?r:Object,"function"===typeof(o="undefined"!==typeof u.g&&u.g)?o:Object,"function"===typeof(s="undefined"!==typeof p.Z&&p.Z)?s:Object])],j)},"../spread-sheet/src/external/view/ui-layer/font-size/font-size-feature.ts":function(e,t,n){n.r(t),n.d(t,{FontSizeFeature:function(){return y}}),n("../node_modules/regenerator-runtime/runtime.js"),n("../node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),n("../node_modules/core-js/modules/esnext.reflect.metadata.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.promise.js"),n("../node_modules/core-js/modules/es.array.map.js"),n("../node_modules/core-js/modules/es.number.constructor.js");var r,o,s,a=n("../packages/report/src/index.ts"),i=n("../node_modules/@tencent/containerized/build/main/index.js"),c=n("../node_modules/@tencent/workbench/lib/esm/decorators/class/feature.js"),d=n("../spread-sheet/src/core/behavior/api.interface.ts"),u=n("../spread-sheet/src/external/view/ui-layer/format-style/get-text-format.ts"),l=n("../spread-sheet/src/core/workbench/common/input-manager-service.ts"),p=n("../spread-sheet/src/external/view/schema/toolbar-schema.ts"),f=n("../spread-sheet/src/adapter/SpreadSheetAppAdapter.ts"),m=function(e,t,n,r){var o,s=arguments.length,a=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var i=e.length-1;i>=0;i--)(o=e[i])&&(a=(s<3?o(a):s>3?o(t,n,a):o(t,n))||a);return s>3&&a&&Object.defineProperty(t,n,a),a},h=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},g=function(e,t){return function(n,r){t(n,r,e)}},v=function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function a(e){try{c(r.next(e))}catch(t){s(t)}}function i(e){try{c(r.throw(e))}catch(t){s(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,i)}c((r=r.apply(e,t||[])).next())}))},y=function(){function e(e,t,n){this.dynamicApi=e,this.getTextFormatService=t,this.inputManagerService=n,this.fontSizeList=["8","9","10","11","12","14","16","18","20","22","24","26","28","36","42","48","72"].map((function(e){return{id:e,content:e}})),this.defaultFontSize=10}var t=e.prototype;return t.getFontSizeList=function(){return this.fontSizeList},t.getFontSize=function(){if(this.inputManagerService.isInputtingState()){var e=this.inputManagerService.getInputStateValue(p.HM.FONT_SIZE);return String(e)}var t=this.getTextFormatService.getTextFormatForCurrentSelection();return String((null===t||void 0===t?void 0:t.fontSize)||this.defaultFontSize)},t.selectFontSize=function(e){return v(this,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.inputManagerService.checkInputAndFormat("fontSize",e)){t.next=3;break}return t.next=3,this.requestFontSize(Number(e));case 3:case"end":return t.stop()}}),t,this)})))},t.handleTdwClick=function(){a.ZP.tdwReport({opername:"doc_excel",module:"pc_edit",action:"wordsize_click",ver12:"new"})},t.requestFontSize=function(e){return v(this,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.dynamicApi.getInstance();case 2:t.sent.setFontSize(e);case 4:case"end":return t.stop()}}),t,this)})))},e}();y=m([(0,c.L)({adapters:[f.L]}),g(0,d.V),h("design:paramtypes",["function"===typeof(r="undefined"!==typeof i.RU&&i.RU)?r:Object,"function"===typeof(o="undefined"!==typeof u.g&&u.g)?o:Object,"function"===typeof(s="undefined"!==typeof l.Z&&l.Z)?s:Object])],y)},"../spread-sheet/src/external/view/ui-layer/format-painter/format-painter-feature.ts":function(e,t,n){n.r(t),n.d(t,{FormatPainter:function(){return m}}),n("../node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),n("../node_modules/core-js/modules/esnext.reflect.metadata.js");var r,o,s=n("../node_modules/i18next/dist/esm/i18next.js"),a=n("../spread-sheet/src/core/app/SpreadsheetApp.interface.ts"),i=n("../node_modules/@tencent/workbench/lib/esm/decorators/class/feature.js"),c=n("../node_modules/@tencent/workbench/lib/esm/services/toolbar/toolbar-service.js"),d=n("../spread-sheet/src/adapter/SpreadSheetAppAdapter.ts"),u=n("../spread-sheet/src/external/view/ui-layer/format-painter/format-painter-feature.interface.ts"),l=function(e,t,n,r){var o,s=arguments.length,a=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var i=e.length-1;i>=0;i--)(o=e[i])&&(a=(s<3?o(a):s>3?o(t,n,a):o(t,n))||a);return s>3&&a&&Object.defineProperty(t,n,a),a},p=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},f=function(e,t){return function(n,r){t(n,r,e)}},m=function(){function e(e,t){var n=this;this.app=e,this.toolbarService=t,this.mode=u.mN.NONE,this.exitClickTime=0,this.hasInit=!1,this.exit=function(){var e,t,r;n.status&&(null===(r=null===(t=null===(e=n.app)||void 0===e?void 0:e.view)||void 0===t?void 0:t.canvas.copyFrame)||void 0===r||r.closeCopy(),n.app.requestApi.formatPainterClear(),n.editDom.classList.remove("format-now"),n.editDom.removeEventListener("touchend",n.handleClick),n.editDom.removeEventListener("mouseup",n.handleClick),n.mode=u.mN.NONE,n.status=!1,n.toolbarService.$forceUpdate())},this.handleClick=function(e){if(e.preventDefault(),n.status){var t=n.getSelection(),r=(new Date).getTime();return n.mode===u.mN.SINGLE?(n.app.requestApi.formatPainterApply(),void n.exit()):n.mode===u.mN.INFINITE&&r-n.exitClickTime<500&&t===n.lastSelect?(n.exit(),void(n.lastSelect="")):void(n.mode===u.mN.INFINITE&&(n.app.requestApi.formatPainterApply(),n.exitClickTime=r,n.lastSelect=t))}},this.app=e,this.editDom=document.querySelector("#mainEditor")}var t=e.prototype;return t.init=function(){var e,t=null===(e=this.app)||void 0===e?void 0:e.view.canvas.inputManager;null===t||void 0===t||t.emitter.on(t.EVENT.ENTER_INPUT,this.exit)},t.enter=function(e){var t,n,r;this.hasInit||(this.hasInit=!0,this.init()),this.mode=e,this.status=!0;var o=this.app.view.getSelection().rangeSelections;if(o.length>1)return alert(s.ZP.t("格式刷不支持多选区"));this.editDom.classList.add("format-now"),null===(r=null===(n=null===(t=this.app)||void 0===t?void 0:t.view)||void 0===n?void 0:n.canvas.copyFrame)||void 0===r||r.doCopy(o[0]),this.app.requestApi.formatPainterSetCache(o[0],this.app),this.editDom.addEventListener("touchend",this.handleClick),this.editDom.addEventListener("mouseup",this.handleClick),this.toolbarService.$forceUpdate()},t.getSelection=function(){var e=this.app.view.canvas.normalSelectData,t=e.activeRow;return e.activeCol+"-"+t},t.getTooltip=function(){return this.status?s.ZP.t(u.KY.CHECKED):s.ZP.t(u.KY.UN_CHECKED)},e}();m=l([(0,i.L)({name:"FormatPainterFeature",adapters:[d.L]}),f(0,a.m),p("design:paramtypes",["function"===typeof(r="undefined"!==typeof a.m&&a.m)?r:Object,"function"===typeof(o="undefined"!==typeof c.O&&c.O)?o:Object])],m)},"../spread-sheet/src/external/view/ui-layer/format-style/bold-feature.ts":function(e,t,n){n.r(t),n.d(t,{BoldFeature:function(){return w}}),n("../node_modules/regenerator-runtime/runtime.js"),n("../node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),n("../node_modules/core-js/modules/esnext.reflect.metadata.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.promise.js"),n("../node_modules/core-js/modules/es.string.bold.js");var r,o,s,a=n("../node_modules/@tencent/containerized/build/main/index.js"),i=n("../packages/report/src/index.ts"),c=n("../node_modules/@tencent/workbench/lib/esm/constants/service-name.js"),d=n("../node_modules/@tencent/workbench/lib/esm/decorators/class/feature.js"),u=n("../spread-sheet/src/core/behavior/api.interface.ts"),l=n("../spread-sheet/src/external/view/ui-layer/format-style/get-text-format.ts"),p=n("../spread-sheet/src/external/view/schema/toolbar-schema.ts"),f=n("../spread-sheet/src/adapter/SpreadSheetAppAdapter.ts"),m=n("../spread-sheet/src/core/workbench/common/input-manager-service.ts"),h=function(e,t,n,r){var o,s=arguments.length,a=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var i=e.length-1;i>=0;i--)(o=e[i])&&(a=(s<3?o(a):s>3?o(t,n,a):o(t,n))||a);return s>3&&a&&Object.defineProperty(t,n,a),a},g=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},v=function(e,t){return function(n,r){t(n,r,e)}},y=function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function a(e){try{c(r.next(e))}catch(t){s(t)}}function i(e){try{c(r.throw(e))}catch(t){s(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,i)}c((r=r.apply(e,t||[])).next())}))},w=function(){function e(e,t,n){this.dynamicApi=e,this.textFormatService=t,this.inputManagerService=n}var t=e.prototype;return t.toggleBold=function(e){return y(this,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.inputManagerService.checkInputAndFormat(p.HM.BOLD)){t.next=3;break}return t.next=3,this.toggleSelectionBold();case 3:e===c.v.TOOLBAR?i.ZP.tdwReport({opername:"doc_excel_editor",module:"excel_style",action:"clk_bold",ver12:"new"}):i.ZP.tdwReport({opername:"doc_excel_editor",module:"excel_mob_style",action:"mob_clk_bold"});case 4:case"end":return t.stop()}}),t,this)})))},t.isBold=function(){return this.inputManagerService.isInputtingState()?!!this.inputManagerService.getInputStateValue(p.HM.BOLD):this.isTextFormatBold()},t.isTextFormatBold=function(){var e=this.textFormatService.getTextFormatForCurrentSelection();return!!(null===e||void 0===e?void 0:e.bold)},t.toggleSelectionBold=function(){return y(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.dynamicApi.getInstance();case 2:e.sent.fontBold(!this.isTextFormatBold());case 4:case"end":return e.stop()}}),e,this)})))},e}();w=h([(0,d.L)({adapters:[f.L]}),v(0,u.V),g("design:paramtypes",["function"===typeof(r="undefined"!==typeof a.RU&&a.RU)?r:Object,"function"===typeof(o="undefined"!==typeof l.g&&l.g)?o:Object,"function"===typeof(s="undefined"!==typeof m.Z&&m.Z)?s:Object])],w)},"../spread-sheet/src/external/view/ui-layer/format-style/get-text-format.ts":function(e,t,n){n.d(t,{g:function(){return l}}),n("../node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),n("../node_modules/core-js/modules/esnext.reflect.metadata.js");var r,o=n("../node_modules/@tencent/workbench/lib/esm/decorators/class/feature.js"),s=n("../spread-sheet/src/core/app/SpreadsheetApp.interface.ts"),a=n("../spread-sheet/src/core/utils/cell.ts"),i=n("../spread-sheet/src/adapter/SpreadSheetAppAdapter.ts"),c=function(e,t,n,r){var o,s=arguments.length,a=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var i=e.length-1;i>=0;i--)(o=e[i])&&(a=(s<3?o(a):s>3?o(t,n,a):o(t,n))||a);return s>3&&a&&Object.defineProperty(t,n,a),a},d=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},u=function(e,t){return function(n,r){t(n,r,e)}},l=function(){function e(e){this.app=e}return e.prototype.getTextFormatForCurrentSelection=function(){return(0,a.getCellFormat)(this.app).textFormat},e}();l=c([(0,o.L)({adapters:[i.L]}),u(0,s.m),d("design:paramtypes",["function"===typeof(r="undefined"!==typeof s.m&&s.m)?r:Object])],l)},"../spread-sheet/src/external/view/ui-layer/format-style/italic-feature.ts":function(e,t,n){n.r(t),n.d(t,{ItalicFeature:function(){return w}}),n("../node_modules/regenerator-runtime/runtime.js"),n("../node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),n("../node_modules/core-js/modules/esnext.reflect.metadata.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.promise.js"),n("../node_modules/core-js/modules/es.string.italics.js");var r,o,s,a=n("../node_modules/@tencent/containerized/build/main/index.js"),i=n("../node_modules/@tencent/workbench/lib/esm/constants/service-name.js"),c=n("../node_modules/@tencent/workbench/lib/esm/decorators/class/feature.js"),d=n("../packages/report/src/index.ts"),u=n("../spread-sheet/src/core/behavior/api.interface.ts"),l=n("../spread-sheet/src/external/view/ui-layer/format-style/get-text-format.ts"),p=n("../spread-sheet/src/external/view/schema/toolbar-schema.ts"),f=n("../spread-sheet/src/adapter/SpreadSheetAppAdapter.ts"),m=n("../spread-sheet/src/core/workbench/common/input-manager-service.ts"),h=function(e,t,n,r){var o,s=arguments.length,a=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var i=e.length-1;i>=0;i--)(o=e[i])&&(a=(s<3?o(a):s>3?o(t,n,a):o(t,n))||a);return s>3&&a&&Object.defineProperty(t,n,a),a},g=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},v=function(e,t){return function(n,r){t(n,r,e)}},y=function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function a(e){try{c(r.next(e))}catch(t){s(t)}}function i(e){try{c(r.throw(e))}catch(t){s(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,i)}c((r=r.apply(e,t||[])).next())}))},w=function(){function e(e,t,n){this.dynamicApi=e,this.textFormatService=t,this.inputManagerService=n}var t=e.prototype;return t.toggleItalic=function(e){return y(this,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.inputManagerService.checkInputAndFormat(p.HM.ITALIC)){t.next=3;break}return t.next=3,this.requestItalics();case 3:e===i.v.TOOLBAR?d.ZP.tdwReport({opername:"doc_excel_editor",module:"excel_style",action:"clk_italic",ver12:"new"}):d.ZP.tdwReport({opername:"doc_excel_editor",module:"excel_mob_style",action:"mob_clk_italic"});case 4:case"end":return t.stop()}}),t,this)})))},t.isItalic=function(){return this.inputManagerService.isInputtingState()?!!this.inputManagerService.getInputStateValue(p.HM.ITALIC):this.isTextFormatBold()},t.isTextFormatBold=function(){var e=this.textFormatService.getTextFormatForCurrentSelection();return!!(null===e||void 0===e?void 0:e.italic)},t.requestItalics=function(){return y(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.dynamicApi.getInstance();case 2:e.sent.fontItalics(!this.isTextFormatBold());case 4:case"end":return e.stop()}}),e,this)})))},e}();w=h([(0,c.L)({adapters:[f.L]}),v(0,u.V),g("design:paramtypes",["function"===typeof(r="undefined"!==typeof a.RU&&a.RU)?r:Object,"function"===typeof(o="undefined"!==typeof l.g&&l.g)?o:Object,"function"===typeof(s="undefined"!==typeof m.Z&&m.Z)?s:Object])],w)},"../spread-sheet/src/external/view/ui-layer/format-style/strikethrough-feature.ts":function(e,t,n){n.r(t),n.d(t,{StrikethroughFeature:function(){return w}}),n("../node_modules/regenerator-runtime/runtime.js"),n("../node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),n("../node_modules/core-js/modules/esnext.reflect.metadata.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.promise.js");var r,o,s,a=n("../node_modules/@tencent/containerized/build/main/index.js"),i=n("../node_modules/@tencent/workbench/lib/esm/constants/service-name.js"),c=n("../node_modules/@tencent/workbench/lib/esm/decorators/class/feature.js"),d=n("../spread-sheet/src/core/behavior/api.interface.ts"),u=n("../spread-sheet/src/external/view/ui-layer/format-style/get-text-format.ts"),l=n("../packages/report/src/index.ts"),p=n("../spread-sheet/src/core/workbench/common/input-manager-service.ts"),f=n("../spread-sheet/src/external/view/schema/toolbar-schema.ts"),m=n("../spread-sheet/src/adapter/SpreadSheetAppAdapter.ts"),h=function(e,t,n,r){var o,s=arguments.length,a=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var i=e.length-1;i>=0;i--)(o=e[i])&&(a=(s<3?o(a):s>3?o(t,n,a):o(t,n))||a);return s>3&&a&&Object.defineProperty(t,n,a),a},g=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},v=function(e,t){return function(n,r){t(n,r,e)}},y=function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function a(e){try{c(r.next(e))}catch(t){s(t)}}function i(e){try{c(r.throw(e))}catch(t){s(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,i)}c((r=r.apply(e,t||[])).next())}))},w=function(){function e(e,t,n){this.dynamicApi=e,this.textFormatService=t,this.inputManagerService=n}var t=e.prototype;return t.toggleStrikethrough=function(e){return y(this,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.inputManagerService.checkInputAndFormat("strikeThrough")){t.next=3;break}return t.next=3,this.requestFontStrike();case 3:e===i.v.TOOLBAR?l.ZP.tdwReport({opername:"doc_excel_editor",module:"excel_style",action:"clk_del-line",ver12:"new"}):l.ZP.tdwReport({opername:"doc_excel_editor",module:"excel_mob_style",action:"mob_clk_del"});case 4:case"end":return t.stop()}}),t,this)})))},t.isStrikethrough=function(){return this.inputManagerService.isInputtingState()?!!this.inputManagerService.getInputStateValue(f.HM.STRIKETHROUGH):this.isTextFormatStrikeThrough()},t.isTextFormatStrikeThrough=function(){var e=this.textFormatService.getTextFormatForCurrentSelection();return!!(null===e||void 0===e?void 0:e.strikethrough)},t.requestFontStrike=function(){return y(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.dynamicApi.getInstance();case 2:e.sent.fontStrike(!this.isTextFormatStrikeThrough());case 4:case"end":return e.stop()}}),e,this)})))},e}();w=h([(0,c.L)({adapters:[m.L]}),v(0,d.V),g("design:paramtypes",["function"===typeof(r="undefined"!==typeof a.RU&&a.RU)?r:Object,"function"===typeof(o="undefined"!==typeof u.g&&u.g)?o:Object,"function"===typeof(s="undefined"!==typeof p.Z&&p.Z)?s:Object])],w)},"../spread-sheet/src/external/view/ui-layer/format-style/underline-feature.ts":function(e,t,n){n.r(t),n.d(t,{UnderlineFeature:function(){return j}}),n("../node_modules/regenerator-runtime/runtime.js"),n("../node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),n("../node_modules/core-js/modules/esnext.reflect.metadata.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.promise.js");var r,o,s,a=n("../node_modules/@tencent/containerized/build/main/index.js"),i=n("../node_modules/@tencent/workbench/lib/esm/constants/service-name.js"),c=n("../node_modules/@tencent/workbench/lib/esm/decorators/class/feature.js"),d=n("../packages/report/src/index.ts"),u=n("../spread-sheet/src/core/behavior/api.interface.ts"),l=n("../spread-sheet/src/external/view/ui-layer/format-style/get-text-format.ts"),p=n("../packages/model/src/cell/index.ts"),f=n("../spread-sheet/src/external/view/schema/toolbar-schema.ts"),m=n("../spread-sheet/src/adapter/SpreadSheetAppAdapter.ts"),h=n("../spread-sheet/src/core/workbench/common/input-manager-service.ts"),g=function(e,t,n,r){var o,s=arguments.length,a=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var i=e.length-1;i>=0;i--)(o=e[i])&&(a=(s<3?o(a):s>3?o(t,n,a):o(t,n))||a);return s>3&&a&&Object.defineProperty(t,n,a),a},v=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},y=function(e,t){return function(n,r){t(n,r,e)}},w=function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function a(e){try{c(r.next(e))}catch(t){s(t)}}function i(e){try{c(r.throw(e))}catch(t){s(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,i)}c((r=r.apply(e,t||[])).next())}))},j=function(){function e(e,t,n){this.dynamicApi=e,this.textFormatService=t,this.inputManagerService=n}var t=e.prototype;return t.toggleUnderline=function(e){return w(this,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.inputManagerService.checkInputAndFormat(f.HM.UNDERLINE)){t.next=3;break}return t.next=3,this.requestUnderline();case 3:e===i.v.TOOLBAR?d.ZP.tdwReport({opername:"doc_excel_editor",module:"excel_style",action:"clk_underline",ver12:"new"}):d.ZP.tdwReport({opername:"doc_excel_editor",module:"excel_mob_style",action:"mob_clk_underline"});case 4:case"end":return t.stop()}}),t,this)})))},t.isUnderline=function(){return this.inputManagerService.isInputtingState()?!!this.inputManagerService.getInputStateValue(f.HM.UNDERLINE):this.isTextFormatUnderline()},t.isTextFormatUnderline=function(){var e=this.textFormatService.getTextFormatForCurrentSelection();return!!(null===e||void 0===e?void 0:e.underline)},t.requestUnderline=function(){return w(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.dynamicApi.getInstance();case 2:e.sent.fontUnderLine(this.isTextFormatUnderline()?null:p.Format.UNDERLINE_TYPE.SINGLE_LINE);case 4:case"end":return e.stop()}}),e,this)})))},e}();j=g([(0,c.L)({adapters:[m.L]}),y(0,u.V),v("design:paramtypes",["function"===typeof(r="undefined"!==typeof a.RU&&a.RU)?r:Object,"function"===typeof(o="undefined"!==typeof l.g&&l.g)?o:Object,"function"===typeof(s="undefined"!==typeof h.Z&&h.Z)?s:Object])],j)},"../spread-sheet/src/external/view/ui-layer/formula/formula-feature.ts":function(e,t,n){n.r(t),n.d(t,{FormulaFeature:function(){return m}}),n("../node_modules/regenerator-runtime/runtime.js"),n("../node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),n("../node_modules/core-js/modules/esnext.reflect.metadata.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.promise.js");var r,o=n("../node_modules/@tencent/workbench/lib/esm/decorators/class/feature.js"),s=n("../spread-sheet/src/core/utils/index.ts"),a=n("../packages/report/src/index.ts"),i=n("../spread-sheet/src/core/app/SpreadsheetApp.interface.ts"),c=n("../spread-sheet/src/adapter/SpreadSheetAppAdapter.ts"),d=n("../spread-sheet/src/core/view/level-2/todo-ent/utils.ts"),u=function(e,t,n,r){var o,s=arguments.length,a=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var i=e.length-1;i>=0;i--)(o=e[i])&&(a=(s<3?o(a):s>3?o(t,n,a):o(t,n))||a);return s>3&&a&&Object.defineProperty(t,n,a),a},l=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},p=function(e,t){return function(n,r){t(n,r,e)}},f=function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function a(e){try{c(r.next(e))}catch(t){s(t)}}function i(e){try{c(r.throw(e))}catch(t){s(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,i)}c((r=r.apply(e,t||[])).next())}))},m=function(){function e(e){this.app=e}var t=e.prototype;return t.popupDialog=function(){return f(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.app.view.getFormulaEditorPanel();case 2:e.sent.show();case 3:case"end":return e.stop()}}),e,this)})))},t.applyFunction=function(e){if(!(0,d.TQ)(this.app)&&!(0,d.AE)(this.app)){if(s.Z.selection.singleRange(this.app))this.app.view.canvas.formulaUICenter.insertFormula(e);else{var t=this.app.view.getSelection().rangeSelections;s.Z.formula.FormulaInsert.init(this.app),s.Z.formula.FormulaInsert.selHandler(t,e)}a.ZP.tdwReport({opername:"doc_excel_editor",module:"excel_function",action:"clk_function_toolbar",ver12:"new"})}},t.showMobileFormulaPanel=function(){return f(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.app.view.getFormulaPanel();case 2:e.sent.show(),a.ZP.tdwReport({opername:"doc_excel_editor",module:"excel_mob_redesign",action:"type_tool_function"});case 4:case"end":return e.stop()}}),e,this)})))},e}();m=u([(0,o.L)({adapters:[c.L]}),p(0,i.m),l("design:paramtypes",["function"===typeof(r="undefined"!==typeof i.m&&i.m)?r:Object])],m)},"../spread-sheet/src/external/view/ui-layer/forward/forward-feature.ts":function(e,t,n){n.r(t),n.d(t,{ForwardFeature:function(){return f}}),n("../node_modules/core-js/modules/es.object.get-own-property-descriptor.js");var r,o,s,a=n("../spread-sheet/src/core/data/configService/spreadConfig.ts"),i=n("../packages/common-utils/src/index.ts"),c=n("../spread-sheet/src/core/feature/relateFormEnt/enterpriseStatus.ts"),d=n("../node_modules/@tencent/workbench/lib/esm/decorators/class/feature.js"),u=n("../node_modules/@tencent/docs-user-agent/dist/index.js"),l=n.n(u),p=function(e,t,n,r){var o,s=arguments.length,a=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var i=e.length-1;i>=0;i--)(o=e[i])&&(a=(s<3?o(a):s>3?o(t,n,a):o(t,n))||a);return s>3&&a&&Object.defineProperty(t,n,a),a};!function(e){e[e.Share=2]="Share"}(r||(r={})),function(e){e[e.Doc=0]="Doc",e[e.Sheet=1]="Sheet",e[e.FORM=2]="FORM",e[e.SLIDE=3]="SLIDE",e[e.MInd=4]="MInd",e[e.Flowchart=5]="Flowchart"}(o||(o={})),function(e){e[e.Mail=1]="Mail",e[e.SDK=2]="SDK",e[e.WxWork=3]="WxWork"}(s||(s={}));var f=function(){function e(){}var t=e.prototype;return t.handleForward=function(){var e;try{var t=a.q.getConfig("globalPadId"),n=a.q.getConfig("shortLink"),o=a.q.getConfig("creatorId"),d=a.q.getConfig("padTitle")||a.q.getConfig("title"),u={docId:t,mainid:"",content:"",positionX:1===window.__is_conversation_embedded||window.self!==window.top?null===(e=null===window||void 0===window?void 0:window.parent)||void 0===e?void 0:e.outerWidth:document.body.clientWidth,positionY:40,positionType:"rightTop",menuType:r.Share,creatorVid:o,title:d,docType:this.getDocType(),shareCode:(0,i.IZ)("scode"),from:"",platformType:s.WxWork,url:n||window.location.href};null===c.pq||void 0===c.pq||c.pq.quoteToDiscuss(u)}catch(l){}},t.hideForward=function(){return!l().isWxWork},t.getDocType=function(){var e=a.q.getConfig("padType");return{doc:o.Doc,sheet:o.Sheet,form:o.FORM,slide:o.SLIDE,mind:o.MInd,flowchart:o.Flowchart}[e]},e}();f=p([(0,d.L)({name:"IForwardFeature"})],f)},"../spread-sheet/src/external/view/ui-layer/freeze/freeze-feature.tsx":function(e,t,n){n.r(t),n.d(t,{FreezeFeature:function(){return b}});var r,o=n("../node_modules/@babel/runtime/helpers/esm/inheritsLoose.js"),s=(n("../node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),n("../node_modules/core-js/modules/esnext.reflect.metadata.js"),n("react")),a=n.n(s),i=n("../node_modules/i18next/dist/esm/i18next.js"),c=n("../node_modules/@tencent/workbench/lib/esm/decorators/class/feature.js"),d=n("../node_modules/@tencent/containerized/build/main/index.js"),u=n("../spread-sheet/src/core/utils/freeze.ts"),l=n("../packages/report/src/index.ts"),p=n("../node_modules/@tencent/dui/lib/components/Snackbar/index.js"),f=n("../packages/common-utils/src/index.ts"),m=n("../spread-sheet/src/core/app/SpreadsheetApp.interface.ts"),h=n("../spread-sheet/src/external/view/schema/contextmenu-key.ts"),g=n("../spread-sheet/src/external/view/schema/menu-schema.ts"),v=n("../spread-sheet/src/adapter/SpreadSheetAppAdapter.ts"),y=function(e,t,n,r){var o,s=arguments.length,a=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var i=e.length-1;i>=0;i--)(o=e[i])&&(a=(s<3?o(a):s>3?o(t,n,a):o(t,n))||a);return s>3&&a&&Object.defineProperty(t,n,a),a},w=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},j=function(e,t){return function(n,r){t(n,r,e)}},_=i.ZP.t("您不能将工作表中的所有可见行都冻结。"),x=i.ZP.t("您不能将工作表中的所有可见列都冻结。"),b=function(e){function t(t){var n,r,o,s,a,c,d;return(n=e.call(this)||this).app=t,n.throttleShowSnackbar=(0,f.P2)((function(){document.getElementsByClassName("dui-snackbar")[0]||p.default.show({message:i.ZP.t("冻结区域超出窗口，导致此表无法滑动。建议放大窗口或调整冻结区域"),type:"info",duration:5e3})}),2e3),n.checkFrozenAreaOutOfView=function(){var e,t;if(!n.app.spreadsheet.isExternalSheet()){var r=(null===(t=null===(e=n.app)||void 0===e?void 0:e.view)||void 0===t?void 0:t.canvas).areaData,o=r.getLastRowInView(),s=r.getLastColInView();(r.inFrozenRowArea(o)||r.inFrozenColArea(s))&&n.throttleShowSnackbar()}},n._register(null===(s=null===(o=null===(r=null===t||void 0===t?void 0:t.view)||void 0===r?void 0:r.canvas)||void 0===o?void 0:o.resize)||void 0===s?void 0:s.onResize(n.checkFrozenAreaOutOfView)),n._register(null===(d=null===(c=null===(a=null===t||void 0===t?void 0:t.view)||void 0===a?void 0:a.canvas)||void 0===c?void 0:c.scale)||void 0===d?void 0:d.onScale(n.checkFrozenAreaOutOfView)),n}(0,o.Z)(t,e);var n=t.prototype;return n.getTooltip=function(){var e=Boolean(this.app.spreadsheet.activeSheet.filterViewManager.getActiveFilterView()),t=a().createElement("div",{className:"freeze-tooltip-wrapper"},a().createElement("div",null,i.ZP.t("冻结")),a().createElement("div",null,i.ZP.t("ONLY_EFFECT_CURRENT_FILTER_VIEW")));return e?{content:t}:i.ZP.t("冻结")},n.getFreezeToSelectionContent=function(){return u.generateFreezeBtnText(this.app)},n.isFrozen=function(){var e=this.app.spreadsheet.activeSheet;return e.getFrozenColCount()>0||e.getFrozenRowCount()>0},n.isFirstRowFrozen=function(){return 1===this.app.spreadsheet.activeSheet.getFrozenRowCount()},n.isRowFrozen=function(){return this.app.spreadsheet.activeSheet.getFrozenRowCount()>0},n.isFirstColFrozen=function(){return 1===this.app.spreadsheet.activeSheet.getFrozenColCount()},n.isColFrozen=function(){return this.app.spreadsheet.activeSheet.getFrozenColCount()>0},n.onSelect=function(e){var t=this.getFreezeRequestOptions(e);this.checkFreezeBoundary(t)&&(this.app.requestApi.freeze(t),this.checkFrozenAreaOutOfView(),u.cancelFreezePreview(this.app))},n.onMouseEnter=function(e){switch(e){case g.z_.FREEZE_FIRST_ROW:return u.firstRowFreezePreview(this.app);case g.z_.FREEZE_FIRST_COL:return u.firstColumnFreezePreview(this.app);case g.z_.FREEZE_TO_SELECTION:return u.freezePreview(this.app);case g.z_.FREEZE_CANCEL:return u.cancelFreezePreview(this.app)}},n.onMouseLeave=function(){u.cancelFreezePreview(this.app)},n.onMobileSelect=function(e){var t=this.getMobileFreezeRequestOptions(e);this.checkFreezeBoundary(t)&&(this.app.requestApi.freeze(t),l.ZP.tdwReport({opername:"doc_excel_editor",module:"excel_mob_freeze",action:this.isFrozen()?"mob_clk_cancel_freeze":"mob_clk_freeze_freeze_panes"}))},n.getMobileFreezeText=function(e){switch(e){case g.z_.FREEZE_FIRST_ROW:return i.ZP.t("{{value}}冻结首行",{value:this.isFirstRowFrozen()?"取消":""});case g.z_.FREEZE_FIRST_COL:return i.ZP.t("{{value}}冻结首列",{value:this.isFirstColFrozen()?"取消":""});case g.z_.FREEZE_TO_SELECTION:return this.isFrozen()?i.ZP.t("取消冻结"):this.getFreezeToSelectionContent();default:return this.getFreezeToSelectionContent()}},n.shouldMobileContextMenuHide=function(){var e=this.app.view.getSelectionWithGridRanges().rangeSelections[0],t=e.startColIndex,n=e.startRowIndex;return 0!==t&&0!==n},n.getFreezeRequestOptions=function(e){switch(e){case g.z_.FREEZE_FIRST_ROW:return{row:1,column:0};case g.z_.FREEZE_FIRST_COL:return{row:0,column:1};case g.z_.FREEZE_TO_SELECTION:return u.generateFreezeRequestOption(this.app);case g.z_.FREEZE_CANCEL:default:return{row:-1,column:-1}}},n.getMobileFreezeRequestOptions=function(e){var t=u.calcFrozenRowColmn(this.app),n=t.column,r=t.row;switch(e){case g.z_.FREEZE_FIRST_ROW:return this.isFirstRowFrozen()?{row:-1}:{row:1};case g.z_.FREEZE_FIRST_COL:return this.isFirstColFrozen()?{column:-1}:{column:1};case g.z_.FREEZE_TO_SELECTION:return this.isFrozen()?{row:-1,column:-1}:u.generateFreezeRequestOption(this.app);case h.B.FREEZE_COL:return{column:n+1};case h.B.CANCEL_FREEZE_COL:return{column:-1};case h.B.FREEZE_ROW:return{row:r+1};case h.B.CANCEL_FREEZE_ROW:return{row:-1};default:return{row:-1,column:-1}}},n.checkFreezeBoundary=function(e){if((null===e||void 0===e?void 0:e.column)&&(null===e||void 0===e?void 0:e.column)>0&&this.app.spreadsheet.activeSheet.getColCount()===e.column)return this.showFailMessage(x),!1;if((null===e||void 0===e?void 0:e.row)&&(null===e||void 0===e?void 0:e.row)>0&&this.app.spreadsheet.activeSheet.getRowCount()===e.row)return this.showFailMessage(_),!1;try{u.reportFreezeApplyStatus(this.app,e)}catch(t){console.error("冻结操作上报失败")}return!0},n.showFailMessage=function(e){p.default.show({type:"info",message:e,duration:4e3})},t}(d.JT);b=y([(0,c.L)({adapters:[v.L],name:"FreezeFeature"}),j(0,m.m),w("design:paramtypes",["function"===typeof(r="undefined"!==typeof m.m&&m.m)?r:Object])],b)},"../spread-sheet/src/external/view/ui-layer/grid-lines/grid-line-feature.ts":function(e,t,n){n.r(t),n.d(t,{GridLineFeature:function(){return l}}),n("../node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),n("../node_modules/core-js/modules/esnext.reflect.metadata.js");var r,o=n("../node_modules/@tencent/workbench/lib/esm/decorators/class/feature.js"),s=n("../spread-sheet/src/core/app/SpreadsheetApp.interface.ts"),a=n("../spread-sheet/src/adapter/SpreadSheetAppAdapter.ts"),i=n("../packages/report/src/index.ts"),c=function(e,t,n,r){var o,s=arguments.length,a=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var i=e.length-1;i>=0;i--)(o=e[i])&&(a=(s<3?o(a):s>3?o(t,n,a):o(t,n))||a);return s>3&&a&&Object.defineProperty(t,n,a),a},d=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},u=function(e,t){return function(n,r){t(n,r,e)}},l=function(){function e(e){var t=this;this.app=e,this.getGridlinesDidHide=function(){var e;return null===(e=t.app.spreadsheet.activeSheet)||void 0===e?void 0:e.getHideGridlines()},this.handleReport=function(e){i.ZP.tdwReport({module:"doc_excel_editor",opername:"excel_style",action:e?"hide_grid_line":"unhide_grid_line",ver12:"new"})}}return e.prototype.changeType=function(){var e=!this.getGridlinesDidHide();this.app.requestApi.setHideGridlines(e),this.handleReport(e)},e}();l=c([(0,o.L)({name:"OtherConditionFormatFeature",adapters:[a.L]}),u(0,s.m),d("design:paramtypes",["function"===typeof(r="undefined"!==typeof s.m&&s.m)?r:Object])],l)},"../spread-sheet/src/external/view/ui-layer/help-and-feedback-mobile/help-and-feedback-feature-mobile.ts":function(e,t,n){n.r(t),n.d(t,{HelpAndFeedbackMobileFeature:function(){return R}}),n("../node_modules/regenerator-runtime/runtime.js"),n("../node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),n("../node_modules/core-js/modules/esnext.reflect.metadata.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.promise.js");var r,o=n("../node_modules/i18next/dist/esm/i18next.js"),s=n("../node_modules/@tencent/workbench/lib/esm/decorators/class/feature.js"),a=n("../spread-sheet/src/external/feedback/supportpage.ts"),i=n("../spread-sheet/src/core/view/utils/browser-func.ts"),c=n("../node_modules/@tencent/docs-user-agent/dist/index.js"),d=n.n(c),u=n("../spread-sheet/src/external/view/mobile/header/menu/feature/help.ts"),l=n("../packages/report/src/index.ts"),p=n("../spread-sheet/src/core/data/configService/spreadConfig.ts"),f=n("../spread-sheet/src/core/app/SpreadsheetApp.interface.ts"),m=n("../node_modules/@tencent/dui-mobile/lib/components/Snackbar/index.js"),h=n("../spread-sheet/src/adapter/SpreadSheetAppAdapter.ts"),g=n("../spread-sheet/src/external/sheet-adapter/smart-sheet-adapter/constants.ts"),v=n("../spread-sheet/src/core/utils/gray.ts"),y=(n("../spread-sheet/src/base/util/domain-config.ts"),n("../node_modules/@tencent/tencent_doc_open_url/dist/index.js")),w=n("../spread-sheet/src/base/util/appConfig.ts"),j=function(e,t,n,r){var o,s=arguments.length,a=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var i=e.length-1;i>=0;i--)(o=e[i])&&(a=(s<3?o(a):s>3?o(t,n,a):o(t,n))||a);return s>3&&a&&Object.defineProperty(t,n,a),a},_=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},x=function(e,t){return function(n,r){t(n,r,e)}},b=function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function a(e){try{c(r.next(e))}catch(t){s(t)}}function i(e){try{c(r.throw(e))}catch(t){s(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,i)}c((r=r.apply(e,t||[])).next())}))},R=function(){function e(e){this.app=e}var t=e.prototype;return t.openWeblogReportDialog=function(){var e,t;null===(t=null===(e=n.g.log)||void 0===e?void 0:e.loadAsset)||void 0===t||t.call(e,"WL_REPORT_DIALOG")},t.showHelpAndFeedback=function(){return!(d().isWxWork&&(0,v.c)())},t.toHelpMobile=function(){(0,i.Yo)(""+w.Z.getConfig("links.helpCenter"))},t.getFeedbackContent=function(){return o.ZP.t("反馈")},t.getFeedbackIconClass=function(){return""},t.toFeedbackMobile=function(){if(d().isTim||d().isTencentDocsApp){var e=w.Z.getConfig("links.feedback"),t=encodeURIComponent(n.g.location.href),r=e+"?nickname="+encodeURIComponent(p.q.getConfig("nick"))+"&avatar="+encodeURIComponent(p.q.getConfig("userPic"))+"&openid="+p.q.getConfig("uid")+"&clientInfo="+encodeURIComponent(n.g.navigator.userAgent)+"&customInfo="+t;(0,y.tencentDocOpenUrlForAll)({url:r})}else(0,a.nz)()},t.toAboutMobile=function(){(0,i.Yo)(w.Z.getConfig("links.featureDescription"))},t.toTemplateMobile=function(){var e;return b(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,null===(e=this.app.plugins)||void 0===e?void 0:e.getTemplateInfoService();case 2:null===(n=t.sent)||void 0===n||n.render();case 4:case"end":return t.stop()}}),t,this)})))},t.shouldShowTemplate=function(){var e=!!p.q.getConfig("isOwner"),t=2===p.q.getConfig("templateType"),n=p.q.getConfig("templateId");return e&&t&&n},t.toAppealMobile=function(){this.dataReport({opername:"doc_excel_editor",module:"excel_mob_help",action:"mob_clk_appeal"});var e=encodeURIComponent(location.href),t="https://"+w.Z.getConfig("runtime.domainName")+"/scenario/appeal.html?appealRefer="+e;n.g.location.assign(t)},t.shouldHideAppeal=function(){return!(p.q.getConfig("isOwner")&&1===p.q.getConfig("dirty"))},t.toSubscribe=function(){d().isMiniProgram?n.g.wx.miniProgram.navigateTo({url:"/pages/followOfficialAccount/followOfficialAccount"}):(0,i.Yo)("https://"+w.Z.getConfig("runtime.domainName")+"/scenario/publicguide.html")},t.toVersion=function(){var e=o.ZP.t("分支: {{globalReleaseVersion}}",{globalReleaseVersion:n.g.__globalReleaseVersion});m.Snackbar.show({message:e,duration:2e3})},t.getTitle=function(){var e="Online ";return n.g.isContainer?e="Container ":n.g.top.globalBoxEnv?e="iContainer ":n.g.__isOfflinePkg&&(e="Offline "),o.ZP.t("版本号: {{version}}",{version:""+e+n.g.__globalCodeVersion})},t.toReportMobile=function(){var e=this;(0,u.Eu)((function(t){e.dataReport({module:"report",opername:"doc_open",action:"clk_report"});var n=p.q.getConfig("userInfo").wx_openid,r=p.q.getConfig("uid")||n,o=w.Z.getConfig("links.report")+"?token="+encodeURIComponent(t)+"&scene=6002&openid="+r;d().isIPad?e.jumpIpad(o):(0,i.Yo)(o)}))},t.toComplaints=function(){(0,a.vt)()},t.jumpIpad=function(e){n.g.mqq?n.g.mqq.invoke("nav","openLinkInNewWebView",{url:e},(function(){})):n.g.location.href=e},t.dataReport=function(e){try{l.ZP.tdwReport(e)}catch(t){console.error("Get an error when tdwReport module report")}},e}();R=j([(0,s.L)({adapters:[h.L,g.dH],name:"HelpAndFeedbackMobileFeature"}),x(0,f.m),_("design:paramtypes",["function"===typeof(r="undefined"!==typeof f.m&&f.m)?r:Object])],R)},"../spread-sheet/src/external/view/ui-layer/help-and-feedback/help-and-feedback-feature.ts":function(e,t,n){n.r(t),n.d(t,{HelpAndFeedbackFeature:function(){return k}}),n("../node_modules/regenerator-runtime/runtime.js"),n("../node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),n("../node_modules/core-js/modules/esnext.reflect.metadata.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.promise.js");var r=n("./node_modules/axios/index.js"),o=n.n(r),s=n("../node_modules/i18next/dist/esm/i18next.js"),a=n("../node_modules/@tencent/docs-user-agent/dist/index.js"),i=n.n(a),c=n("../node_modules/@tencent/workbench/lib/esm/decorators/class/feature.js"),d=n("../node_modules/@tencent/tencent_doc_open_url/dist/index.js"),u=n("../spread-sheet/src/external/view/ui-layer/titlebar/components/menubar/config.ts"),l=n("../spread-sheet/src/external/feedback/supportpage.ts"),p=n("../packages/utils/src/safe.ts"),f=n("../node_modules/@tencent/dui/lib/components/Snackbar/index.js"),m=n("../node_modules/qs/lib/index.js"),h=n.n(m),g=n("../spread-sheet/src/base/util/appConfig.ts");function v(){var e=h().stringify({xsrf:(0,p.f)(),domain_id:window.clientVars.domainId,pad_id:window.clientVars.padId,dataType:"form"===window.clientVars.padType?1:0});return o().post("https://"+g.Z.getConfig("runtime.domainName")+"/cgi-bin/online_docs/support_gettoken",e).then((function(e){var t=e.data;0===t.retcode&&t.token.length>0?function(e){var t=window.clientVars.userInfo.wx_openid,n="qq"===window.clientVars.userType?window.clientVars.userInfo.uin:t,r=g.Z.getConfig("links.report")+"?",o=encodeURIComponent(e);if(r=r+"token="+o+"&scene=6001&openid="+n,!document.getElementById("supportFrame-container")){var s=document.createElement("div");s.id="supportFrame-container";var a=document.createElement("iframe");a.id="supportFrame",a.src=r,s.appendChild(a),document.body.appendChild(s);var i=document.createElement("div");i.className="support_mask",i.id="support_mask",i.style.backgroundColor="rgb(0, 0, 0)",i.style.opacity="0.2",i.style.position="fixed",i.style.left="0px",i.style.top="0px",i.style.zIndex="6007",i.style.width="100%",i.style.height="95%",document.body.appendChild(i),window.addEventListener("message",(function(e){try{var t=JSON.parse(e.data);t&&"jubao"===t.from&&"jubao_close"===t.cmd&&function(){var e=document.getElementById("supportFrame-container");e&&e.remove();var t=document.getElementById("support_mask");t&&t.remove()}()}catch(n){}}),!1)}}(t.token):f.default.show({type:"error",message:"请求失败，请稍后尝试。",autoClose:!1,closable:!0})})).catch((function(e){console.error(e),f.default.show({type:"error",message:s.ZP.t("请求失败，请稍后尝试。"),autoClose:!1,closable:!0})}))}var y,w,j,_=n("../spread-sheet/src/core/data/configService/spreadConfig.ts"),x=n("../spread-sheet/src/core/app/sheetStatus/index.ts"),b=n("../spread-sheet/src/external/view/ui-layer/report-helper.ts"),R=n("../spread-sheet/src/adapter/SpreadSheetAppAdapter.ts"),S=n("../spread-sheet/src/external/sheet-adapter/smart-sheet-adapter/constants.ts"),C=n("../spread-sheet/src/core/feature/relateFormEnt/enterpriseStatus.ts"),E=n("../packages/common-utils/src/index.ts"),I=n("../spread-sheet/src/base/util/domain-config.ts"),M=n("../spread-sheet/src/external/view/ui-layer/short-cut/short-cut-drawer.ts"),T=function(e,t,n,r){var o,s=arguments.length,a=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var i=e.length-1;i>=0;i--)(o=e[i])&&(a=(s<3?o(a):s>3?o(t,n,a):o(t,n))||a);return s>3&&a&&Object.defineProperty(t,n,a),a},O=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},D=function(e,t){return function(n,r){t(n,r,e)}},A=function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function a(e){try{c(r.next(e))}catch(t){s(t)}}function i(e){try{c(r.throw(e))}catch(t){s(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,i)}c((r=r.apply(e,t||[])).next())}))};!function(e){e.CLK_HELP="clk_help",e.CLK_FEEDBACK="clk_feedback",e.CLK_REPORT="clk_report",e.CLK_TORT="clk_tort",e.CLK_ABOUT="clk_about",e.CLK_APPEAL="clk_appeal",e.CLK_COMMUNITY_CONVENTION="clk_commutity_convention"}(j||(j={}));var k=function(){function e(e,t){this.sheetStatus=e,this.shortCutDrawer=t}var t=e.prototype;return t.toHotKey=function(){return A(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.shortCutDrawer.openDrawer();case 1:case"end":return e.stop()}}),e,this)})))},t.toHelp=function(){(0,b.r)(j.CLK_HELP),(0,d.tencentDocOpenUrl)(u.k.page.helpPage)},t.toFeedback=function(){(0,b.r)(j.CLK_FEEDBACK),(0,l.nz)()},t.getFeedbackContent=function(){return s.ZP.t("反馈")},t.toReport=function(){(0,b.r)(j.CLK_REPORT),v()},t.toInfringementGuide=function(){(0,b.r)(j.CLK_TORT),(0,d.tencentDocOpenUrl)(u.k.page.tortPage)},t.toAbout=function(){(0,b.r)(j.CLK_ABOUT),(0,d.tencentDocOpenUrl)(u.k.page.aboutPage)},t.toCommunityConvention=function(){(0,b.r)(j.CLK_COMMUNITY_CONVENTION),(0,d.tencentDocOpenUrl)(u.k.page.communityConventionPage)},t.toAppeal=function(){i().isWxMiniProgram?n.g.location.href=u.k.page.appealPage:n.g.open(u.k.page.appealPage,"_blank"),(0,b.r)(j.CLK_APPEAL)},t.notAppeal=function(){var e=this.sheetStatus.canEdit&&_.q.getConfig("isOwner"),t=1===_.q.getConfig("collab_client_vars").dirty;return!(e&&t)},t.toComplain=function(){var e,t,r,s,a;return A(this,void 0,void 0,regeneratorRuntime.mark((function c(){var u,l,p,f,m,h;return regeneratorRuntime.wrap((function(c){for(;;)switch(c.prev=c.next){case 0:return u=_.q.getConfig("padId"),l=(0,E.IZ)("scode"),(p=new FormData).append("docid",u),p.append("share_code",l),p.append("scence","wedoc"),p.append("svr_type","report"),c.prev=7,c.next=10,o().post("/doc/feedback_to_ww",p);case 10:if(f=c.sent,m=f.data,0===(null===(e=m.head)||void 0===e?void 0:e.ret)){c.next=14;break}throw new Error("request /doc/feedback_to_ww fail, params: docid:"+u+", share_code:"+l);case 14:if(h=null===m||void 0===m?void 0:m.body.return_url){c.next=18;break}throw null===(t=window.tdocs)||void 0===t||t.log({message:"[CGI FAILED]: no url provided, params: docid:"+u+", share_code:"+l,level:"error"}),new Error("request /doc/feedback_to_ww fail, no url provided");case 18:(0,C.n_)()?i().isMobile?null===(s=null===(r=n.g.tdocs)||void 0===r?void 0:r.openUrl)||void 0===s||s.call(r,{url:h,target:3}):null===(a=n.g.tdocs)||void 0===a||a.openInBrowser({url:h}):(0,d.tencentDocOpenUrlForAll)({url:h}),c.next=24;break;case 21:c.prev=21,c.t0=c.catch(7),console.error(c.t0);case 24:case"end":return c.stop()}}),c,null,[[7,21]])})))},t.hideComplian=function(){return!I.xc},e}();k=T([(0,c.L)({adapters:[R.L,S.dH],name:"HelpAndFeedbackFeature"}),D(0,x.T),O("design:paramtypes",["function"===typeof(y="undefined"!==typeof x.T&&x.T)?y:Object,"function"===typeof(w="undefined"!==typeof M.Z&&M.Z)?w:Object])],k)},"../spread-sheet/src/external/view/ui-layer/hide-row-col/hide-row-col-feature.ts":function(e,t,n){n.r(t),n.d(t,{HideRowColFeature:function(){return g}}),n("../node_modules/regenerator-runtime/runtime.js"),n("../node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),n("../node_modules/core-js/modules/esnext.reflect.metadata.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.promise.js");var r,o,s,a=n("../node_modules/@tencent/workbench/lib/esm/decorators/class/feature.js"),i=n("../node_modules/@tencent/containerized/build/main/index.js"),c=n("../spread-sheet/src/core/behavior/api.interface.ts"),d=n("../spread-sheet/src/core/view/layout/interface/pc-view.ts"),u=n("../packages/model/src/spreadsheet/index.ts"),l=n("../spread-sheet/src/adapter/SpreadSheetAppAdapter.ts"),p=function(e,t,n,r){var o,s=arguments.length,a=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var i=e.length-1;i>=0;i--)(o=e[i])&&(a=(s<3?o(a):s>3?o(t,n,a):o(t,n))||a);return s>3&&a&&Object.defineProperty(t,n,a),a},f=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},m=function(e,t){return function(n,r){t(n,r,e)}},h=function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function a(e){try{c(r.next(e))}catch(t){s(t)}}function i(e){try{c(r.throw(e))}catch(t){s(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,i)}c((r=r.apply(e,t||[])).next())}))},g=function(){function e(e,t,n){this.dynamicApi=e,this.spreadsheet=t,this.view=n}var t=e.prototype;return t.hideRow=function(){return h(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.dynamicApi.getInstance();case 2:e.sent.hideRows();case 4:case"end":return e.stop()}}),e,this)})))},t.hideCol=function(){return h(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.dynamicApi.getInstance();case 2:e.sent.hideColumns();case 4:case"end":return e.stop()}}),e,this)})))},t.showRow=function(){return h(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.dynamicApi.getInstance();case 2:e.sent.showRows();case 4:case"end":return e.stop()}}),e,this)})))},t.showCol=function(){return h(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.dynamicApi.getInstance();case 2:e.sent.showColumns();case 4:case"end":return e.stop()}}),e,this)})))},t.getShowColButtonVisiableState=function(){var e=this.view.canvas;if(!e.normalSelectData)throw new Error("未发现选区");for(var t=e.normalSelectData.select,n=t.xRange[0];n<=t.xRange[1];n++)if(this.spreadsheet.activeSheet.isColHiddenByUser(n))return!0;return!1},t.getShowRowButtonVisiableState=function(){for(var e=this.view.canvas.normalSelectData.select,t=e.yRange[0];t<=e.yRange[1];t++)if(this.spreadsheet.activeSheet.isRowHiddenByUser(t))return!0;return!1},t.getHideColButtonVisiableState=function(){for(var e=this.view.canvas.normalSelectData.selectQueue,t=0;t<e.length;t++){var n=e[t];if(n.selectAll||n.selectCell||n.selectRow)return!1}return!0},t.getHideRowButtonVisiableState=function(){for(var e=this.view.canvas.normalSelectData.selectQueue,t=0;t<e.length;t++){var n=e[t];if(n.selectAll||n.selectCell||n.selectCol)return!1}return!0},e}();g=p([(0,a.L)({adapters:[l.L]}),m(0,c.V),m(1,u.ISpreadsheet),m(2,d.w),f("design:paramtypes",["function"===typeof(r="undefined"!==typeof i.RU&&i.RU)?r:Object,"function"===typeof(o="undefined"!==typeof u.ISpreadsheet&&u.ISpreadsheet)?o:Object,"function"===typeof(s="undefined"!==typeof d.w&&d.w)?s:Object])],g)},"../spread-sheet/src/external/view/ui-layer/horizontal-align/horizontal-align-feature.ts":function(e,t,n){n.r(t),n.d(t,{HorizontalAlignFeature:function(){return w}}),n("../node_modules/regenerator-runtime/runtime.js"),n("../node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),n("../node_modules/core-js/modules/esnext.reflect.metadata.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.promise.js");var r,o,s=n("../node_modules/@tencent/containerized/build/main/index.js"),a=n("../node_modules/@tencent/workbench/lib/esm/decorators/class/feature.js"),i=n("../spread-sheet/src/core/app/SpreadsheetApp.interface.ts"),c=n("../spread-sheet/src/core/behavior/api.interface.ts"),d=n("../spread-sheet/src/core/utils/cell.ts"),u=n("../packages/report/src/index.ts"),l=n("../packages/model/src/spreadsheet/SpreadsheetProperties.ts"),p=n("../spread-sheet/src/core/utils/selection.ts"),f=n("../spread-sheet/src/core/view/spreadsheet-view/transform-table/cell.ts"),m=n("../spread-sheet/src/adapter/SpreadSheetAppAdapter.ts"),h=function(e,t,n,r){var o,s=arguments.length,a=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var i=e.length-1;i>=0;i--)(o=e[i])&&(a=(s<3?o(a):s>3?o(t,n,a):o(t,n))||a);return s>3&&a&&Object.defineProperty(t,n,a),a},g=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},v=function(e,t){return function(n,r){t(n,r,e)}},y=function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function a(e){try{c(r.next(e))}catch(t){s(t)}}function i(e){try{c(r.throw(e))}catch(t){s(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,i)}c((r=r.apply(e,t||[])).next())}))},w=function(){function e(e,t){this.app=e,this.dynamicApi=t,this.defaultHorizontalAlign=l.Z.defaultDefaultFormat.getHorizontalAlign()}var t=e.prototype;return t.setHorizontalAlign=function(e){return y(this,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.requestHorizontalAlign(e);case 2:this.reportAutoWrap();case 3:case"end":return t.stop()}}),t,this)})))},t.getHorizontalAlign=function(){var e=(0,p.getActiveCell)(this.app);return(0,d.getCellFormat)(this.app).getHorizontalAlign()||(e?(0,f.PE)(e).value:this.defaultHorizontalAlign)},t.reportAutoWrap=function(){u.ZP.tdwReport({opername:"doc_excel_editor",module:"excel_v_align",action:"clk_horizontal_align",Horizontal12:"new"})},t.requestHorizontalAlign=function(e){return y(this,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.dynamicApi.getInstance();case 2:t.sent.setHorizontalAlign(e);case 4:case"end":return t.stop()}}),t,this)})))},e}();w=h([(0,a.L)({adapters:[m.L]}),v(0,i.m),v(1,c.V),g("design:paramtypes",["function"===typeof(r="undefined"!==typeof i.m&&i.m)?r:Object,"function"===typeof(o="undefined"!==typeof s.RU&&s.RU)?o:Object])],w)},"../spread-sheet/src/external/view/ui-layer/hyperlink-icon-visibility/hyperlink-icon-visibility-feature.ts":function(e,t,n){n.r(t),n.d(t,{HyperlinkIconVisibilityFeature:function(){return v}}),n("../node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),n("../node_modules/core-js/modules/esnext.reflect.metadata.js"),n("../node_modules/core-js/modules/es.function.name.js"),n("../node_modules/core-js/modules/web.dom-collections.for-each.js");var r,o=n("../node_modules/@tencent/workbench/lib/esm/decorators/class/feature.js"),s=n("../spread-sheet/src/core/app/SpreadsheetApp.interface.ts"),a=n("../node_modules/@babel/runtime/helpers/esm/toConsumableArray.js"),i=(n("../node_modules/core-js/modules/es.array.concat.js"),function(e,t){var n=[];return e.rangeSelections.forEach((function(e){n=n.concat(t.spreadsheet.activeSheet.getCellDatasAtRange(e))})),n}),c=n("../spread-sheet/src/core/view/level-2/link-center/utils/checker.ts"),d=n("../spread-sheet/src/core/view/level-2/link-center/utils/hyperlink.ts"),u=n("../packages/model/src/cell/LinkIconType.ts"),l=n("../spread-sheet/src/external/view/schema/contextmenu-key.ts"),p=n("../spread-sheet/src/core/view/level-2/link-center/BaseLinkCenter.ts"),f=n("../spread-sheet/src/adapter/SpreadSheetAppAdapter.ts"),m=function(e,t,n,r){var o,s=arguments.length,a=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var i=e.length-1;i>=0;i--)(o=e[i])&&(a=(s<3?o(a):s>3?o(t,n,a):o(t,n))||a);return s>3&&a&&Object.defineProperty(t,n,a),a},h=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},g=function(e,t){return function(n,r){t(n,r,e)}},v=function(){function e(e){this.app=e}var t=e.prototype;return t.shouldShowHyperlinkIconVisibilityMenu=function(){for(var e=i(this.app.view.getSelection(),this.app),t=!1,n=!0,r=0;r<e.length;r++){for(var o=e[r],s=0;s<o.length;s++)if(o[s]&&null!==o[s].getEditValue()&&""!==o[s].getEditValue()&&(t=!0,!(0,c.Rw)((0,d.wI)(o[s])))){n=!1;break}if(!n)break}return!!t&&n},t.shouldCheckHyperlinkIconVisibilitySubmenu=function(e){var t=e.name,n=i(this.app.view.getSelection(),this.app),r=0,o=0;return n.forEach((function(e){e.forEach((function(e){e&&(e.getLinkIconStatus()===u.Z.PLAIN_TEXT?o+=1:r+=1)}))})),(0===o||0===r)&&(t===l.B.HYPERLINK_ICON_INVISIBLE?0!==o:t===l.B.HYPERLINK_ICON_VISIBLE&&0!==r)},t.onClickHyperlinkIconVisibilityButton=function(e){var t=e.name;return t===l.B.HYPERLINK_ICON_INVISIBLE?this.setHyperlinkIconVisibility(!1):t===l.B.HYPERLINK_ICON_VISIBLE?this.setHyperlinkIconVisibility(!0):void 0},t.setHyperlinkIconVisibility=function(e){var t=this;(function(e,t){var n=[];return e.rangeSelections.forEach((function(e){n.push.apply(n,(0,a.Z)(function(e,t){var n=[],r=t.startRowIndex,o=t.endRowIndex,s=t.startColIndex,a=t.endColIndex;t.isRow&&(s=0,a=e.getColCount()-1),t.isCol&&(r=0,o=e.getRowCount()-1);for(var i=r;i<=o;i++)for(var c=s;c<=a;c++)n.push({col:c,row:i});return n}(t.spreadsheet.activeSheet,e)))})),n})(this.app.view.getSelection(),this.app).forEach((function(n){var r=n.col,o=n.row,s=t.app.spreadsheet.activeSheet.getCellDataAtPosition(o,r);s&&(0,c.Rw)((0,d.wI)(s))&&t.app.requestApi.setHyperlinkIconVisibility({row:o,col:r,visibility:e})})),this.app.view.canvas.linkCenter.card.emitter.emit(p.Z.EVENT.LINK_HIDE_COMPONENT)},e}();v=m([(0,o.L)({adapters:[f.L],name:"HyperlinkIconVisibilityFeature"}),g(0,s.m),h("design:paramtypes",["function"===typeof(r="undefined"!==typeof s.m&&s.m)?r:Object])],v)},"../spread-sheet/src/external/view/ui-layer/import-file/import-file-feature-pc.ts":function(e,t,n){n.r(t),n.d(t,{ImportFileFeaturePC:function(){return g}}),n("../node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),n("../node_modules/core-js/modules/es.function.name.js"),n("../node_modules/core-js/modules/es.array.slice.js"),n("../node_modules/core-js/modules/es.array.iterator.js"),n("../node_modules/core-js/modules/es.array-buffer.slice.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.typed-array.uint8-array.js"),n("../node_modules/core-js/modules/es.typed-array.copy-within.js"),n("../node_modules/core-js/modules/es.typed-array.every.js"),n("../node_modules/core-js/modules/es.typed-array.fill.js"),n("../node_modules/core-js/modules/es.typed-array.filter.js"),n("../node_modules/core-js/modules/es.typed-array.find.js"),n("../node_modules/core-js/modules/es.typed-array.find-index.js"),n("../node_modules/core-js/modules/es.typed-array.for-each.js"),n("../node_modules/core-js/modules/es.typed-array.includes.js"),n("../node_modules/core-js/modules/es.typed-array.index-of.js"),n("../node_modules/core-js/modules/es.typed-array.iterator.js"),n("../node_modules/core-js/modules/es.typed-array.join.js"),n("../node_modules/core-js/modules/es.typed-array.last-index-of.js"),n("../node_modules/core-js/modules/es.typed-array.map.js"),n("../node_modules/core-js/modules/es.typed-array.reduce.js"),n("../node_modules/core-js/modules/es.typed-array.reduce-right.js"),n("../node_modules/core-js/modules/es.typed-array.reverse.js"),n("../node_modules/core-js/modules/es.typed-array.set.js"),n("../node_modules/core-js/modules/es.typed-array.slice.js"),n("../node_modules/core-js/modules/es.typed-array.some.js"),n("../node_modules/core-js/modules/es.typed-array.sort.js"),n("../node_modules/core-js/modules/es.typed-array.subarray.js"),n("../node_modules/core-js/modules/es.typed-array.to-locale-string.js"),n("../node_modules/core-js/modules/es.typed-array.to-string.js");var r,o=n("../node_modules/i18next/dist/esm/i18next.js"),s=n("../node_modules/@tencent/workbench/lib/esm/decorators/class/feature.js"),a=n("../node_modules/@tencent/docs-user-agent/dist/index.js"),i=n.n(a),c=n("../node_modules/@tencent/dui/lib/components/Snackbar/index.js"),d=n("../packages/common-utils/src/index.ts"),u=n("../spread-sheet/src/core/ui/toast/index.ts"),l=(n("../node_modules/core-js/modules/es.regexp.exec.js"),n("../packages/report/src/index.ts"));function p(e){var t={doc:"1",xls:"2",txt:"3",csv:"4"}[(/\.([^\.]{3})[^\.]*$/.exec(String(e.name).toLowerCase())||[])[1]]||null;try{l.ZP.tdwReport({opername:"doc_import",module:"import_fail",action:"count",obj2:location.href,obj3:2,ver1:0,ver2:(/\.([^\.]*)$/.exec(e.name)||[])[1]||"",ver3:"notSupport",file_type:t}),l.ZP.monitor(3474665)}catch(n){console.error(n)}}!function(e){e.NEW_IMPORT="new_inport"}(r||(r={}));var f=n("../spread-sheet/src/adapter/SpreadSheetAppAdapter.ts"),m=n("../spread-sheet/src/external/sheet-adapter/smart-sheet-adapter/constants.ts"),h=function(e,t,n,r){var o,s=arguments.length,a=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var i=e.length-1;i>=0;i--)(o=e[i])&&(a=(s<3?o(a):s>3?o(t,n,a):o(t,n))||a);return s>3&&a&&Object.defineProperty(t,n,a),a},g=function(){function e(){this.isSlideOrPDFFile=function(e){var t=!1;try{if(null===e||void 0===e?void 0:e.name){var n=e.name.lastIndexOf("."),r=e.name.substring(n).toLowerCase();".ppt"!==r&&".pptx"!==r&&".pdf"!==r||(t=!0)}}catch(o){console.error("isSlideOrPDFFile e:"+JSON.stringify(o)),t=!1}return t}}var t=e.prototype;return t.importFile=function(){var e=this,t=n.g.clientVars.userDomain;i().isTencentDocsApp?this.handleImportFile(t):this.showFileBrowser((function(n){e.getFile(n[0],t)})),l.ZP.tdwReport({opername:"doc_excel_editor",module:"excel_drop-menu",action:r.NEW_IMPORT,ver12:"new"})},t.handleImportFile=function(e){var t,r=this;null===(t=n.g.mqq)||void 0===t||t.invoke("docx","importFile",{isImportFile:!0},(function(t,n){var o=r.transFile(n);r.getFile(o,e)}))},t.showFileBrowser=function(e){var t=document.createElement("input");if(t.setAttribute("id","_importFile"),t.setAttribute("type","file"),t.setAttribute("style","display:none"),"undefined"!==typeof external&&"undefined"!==typeof external.nativeCall?t.setAttribute("accept","*.*"):this.resetFileType(t),document.body.appendChild(t),t.addEventListener("change",this.onInputChange.bind(this,e)),document.createEvent){var n=document.createEvent("MouseEvents");n.initEvent("click",!0,!1),t.dispatchEvent(n)}},t.onInputChange=function(e,t){var r=i().isTencentDocsApp?t:t.target.files[0],o=r;if(i().isIE&&n.g.ActiveXObject&&(o=this.getIEFile(r)),o&&o.name){var s=(0,d.ii)(r);if(s<=0)return this.emptyFileHandler(o);var a=this.getFileMaxSize(r);if(s/1048576>=a)return this.beyondSizeHandler(a,o);if(!/.*\.(doc|docx|xls|xlsx|txt|csv|ppt|pptx|pdf|xmind|pos|vsd|vsdx)$/i.test(o.name))return this.outOfFilesHandler(o);e(t.target.files)}},t.getFile=function(e,t){var r,o=document.getElementById("import-file-container");o?(o=document.getElementById("import-file-container"))&&(o.style.display="block"):this.createContainer(),null===(r=n.g.SLR)||void 0===r||r.load("ImportFile",(function(n){n.show(document.getElementById("import-file-container"),{file:e,userDomain:t,onClose:function(){(o=document.getElementById("import-file-container"))&&(o.style.display="none")}})}))},t.createContainer=function(){var e=document.createElement("div");return e.className="alert-bg-container",e.id="import-file-container",document.body.appendChild(e),e},t.transFile=function(e){for(var t=JSON.parse(JSON.stringify(e)),n=t.params.fileString,r=t.params.fileName,o="application/msword,application/vnd.ms-excel,application/vnd.openxmlformats-officedocument.spreadsheetml.sheet,application/vnd.openxmlformats-officedocument.wordprocessingml.document,text/plain,.xlsx,.xls,.doc,.docx,.csv,.txt",s=atob(n),a=[],i=0;i<s.length;i+=512){for(var c=s.slice(i,i+512),d=new Array(c.length),u=0;u<c.length;u++)d[u]=c.charCodeAt(u);var l=new Uint8Array(d);a.push(l)}var p=new Blob(a,{type:o});return new File([p],r,{type:o,lastModified:Date.now()})},t.resetFileType=function(e){e.setAttribute("accept","application/msword,application/vnd.ms-excel,application/vnd.ms-powerpoint,application/pdf,application/vnd.openxmlformats-officedocument.spreadsheetml.sheet,application/vnd.openxmlformats-officedocument.wordprocessingml.document,application/vnd.openxmlformats-officedocument.presentationml.presentation,text/plain,.xlsx,.xls,.doc,.docx,.ppt,.pptx,.pdf,.csv,.txt,.xmind,.pos,.vsd,.vsdx")},t.getFileMaxSize=function(e){return{".ppt":500,".pptx":500,".pdf":200,".xlsx":30,".xls":30,".docx":30,".doc":30,"":30}[this.getExtendName(e)]},t.getExtendName=function(e){var t="";try{if(null===e||void 0===e?void 0:e.name){var n=e.name.lastIndexOf(".");return t=e.name.substring(n).toLowerCase()}}catch(r){return console.error("isSlideOrPDFFile e:"+JSON.stringify(r)),t}return t},t.getIEFile=function(e){var t;try{var r=n.g.ActiveXObject;return(n.g.ActiveXObject?new r("Scripting.FileSystemObject"):{}).GetFile(e)||e}catch(o){null===(t=n.g.log)||void 0===t||t.info(o)}},t.emptyFileHandler=function(e){c.default.show({message:o.ZP.t("导入失败，不能导入空文件。"),type:"error",duration:3e3,autoClose:!0,closable:!0}),p(e)},t.beyondSizeHandler=function(e,t){(0,u.showToast)(o.ZP.t("导入失败，文件大小超过{{maxSize}}MB。",{maxSize:e}),{top:5},{toolToastCloseTime:3e3}),p(t)},t.outOfFilesHandler=function(e){(0,u.showToast)(o.ZP.t("导入失败，仅支持 {{supportFormat}} 格式的文件。",{supportFormat:"doc/docx/xls/xlsx/txt/csv/ppt/pptx/pdf/xmind/pos/vsd/vsdx"}),{top:5},{toolToastCloseTime:3e3}),p(e)},e}();g=h([(0,s.L)({adapters:[f.L,m.dH]})],g)},"../spread-sheet/src/external/view/ui-layer/insert-application-ent/insert-application-feature.ts":function(e,t,n){n.r(t),n.d(t,{InsertApplicationFeature:function(){return w}}),n("../node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),n("../node_modules/core-js/modules/esnext.reflect.metadata.js");var r,o,s,a=n("../node_modules/@tencent/docs-user-agent/dist/index.js"),i=n.n(a),c=n("../spread-sheet/src/core/utils/index.ts"),d=n("../spread-sheet/src/core/view/layout/interface/pc-view.ts"),u=n("../node_modules/@tencent/workbench/lib/esm/decorators/class/feature.js"),l=n("../spread-sheet/src/external/view/main/toolbar/defaultHook.ts"),p=n("../packages/model/src/cell/metadata/CustomDataType.ts"),f=n("../packages/model/src/spreadsheet/index.ts"),m=n("../spread-sheet/src/core/app/SpreadsheetApp.interface.ts"),h=n("../spread-sheet/src/adapter/SpreadSheetAppAdapter.ts"),g=function(e,t,n,r){var o,s=arguments.length,a=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var i=e.length-1;i>=0;i--)(o=e[i])&&(a=(s<3?o(a):s>3?o(t,n,a):o(t,n))||a);return s>3&&a&&Object.defineProperty(t,n,a),a},v=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},y=function(e,t){return function(n,r){t(n,r,e)}},w=function(){function e(e,t,n){this.app=e,this.view=t,this.spreadsheet=n}var t=e.prototype;return t.handleClick=function(){l.Z.doInsertApp(this.view)},t.shouldHide=function(){var e;return!(null===(e=n.g.tdocs)||void 0===e?void 0:e.insertApp)||i().isMac||!i().isWxWork},t.checkInsertCustomDataTypeDisable=function(){var e=p.ZP.THIRD_PARTY_APP,t=this.view.getSelection().activeCell,n=t.rowIndex,r=t.colIndex,o=this.spreadsheet.activeSheet.getCellDataAtPosition(n,r),s=null===o||void 0===o?void 0:o.getMetadata();return!(!s||s.customDataType===e)||!!(null===o||void 0===o?void 0:o.isHyperlink())||!!this.spreadsheet.activeSheet.todoManager.isTodo(n,r)||!c.Z.selection.singleRange(this.app)},e}();w=g([(0,u.L)({adapters:[h.L]}),y(0,m.m),y(1,d.w),y(2,f.ISpreadsheet),v("design:paramtypes",["function"===typeof(r="undefined"!==typeof m.m&&m.m)?r:Object,"function"===typeof(o="undefined"!==typeof d.w&&d.w)?o:Object,"function"===typeof(s="undefined"!==typeof f.ISpreadsheet&&f.ISpreadsheet)?s:Object])],w)},"../spread-sheet/src/external/view/ui-layer/insert-attachment/insert-attachment-feature.ts":function(e,t,n){n.r(t),n.d(t,{InsertAttachmentFeature:function(){return I}}),n("../node_modules/regenerator-runtime/runtime.js"),n("../node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),n("../node_modules/core-js/modules/esnext.reflect.metadata.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.promise.js"),n("../node_modules/core-js/modules/es.object.keys.js");var r,o,s,a,i,c,d=n("../node_modules/i18next/dist/esm/i18next.js"),u=n("../node_modules/@tencent/containerized/build/main/index.js"),l=n("../node_modules/@tencent/workbench/lib/esm/decorators/class/feature.js"),p=n("../node_modules/@tencent/ioc/lib/esm/index.js"),f=n("../spread-sheet/src/core/behavior/api.interface.ts"),m=n("../spread-sheet/src/core/view/layout/interface/pc-view.ts"),h=n("../packages/model/src/spreadsheet/Spreadsheet.interface.ts"),g=n("../spread-sheet/src/base/event/event.ts"),v=n("../spread-sheet/src/core/workbench/interfaces/selection-service.interface.ts"),y=n("../spread-sheet/src/core/ui/dialog/index.ts"),w=n("../spread-sheet/src/core/view/level-2/link-center/logic/attachment/index.ts"),j=n("../spread-sheet/src/core/view/level-2/link-center/logic/attachment/util.ts"),_=n("../spread-sheet/src/base/util/domain-config.ts"),x=n("../spread-sheet/src/core/app/SpreadsheetApp.interface.ts"),b=n("../spread-sheet/src/adapter/SpreadSheetAppAdapter.ts"),R=function(e,t,n,r){var o,s=arguments.length,a=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var i=e.length-1;i>=0;i--)(o=e[i])&&(a=(s<3?o(a):s>3?o(t,n,a):o(t,n))||a);return s>3&&a&&Object.defineProperty(t,n,a),a},S=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},C=function(e,t){return function(n,r){t(n,r,e)}},E=function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function a(e){try{c(r.next(e))}catch(t){s(t)}}function i(e){try{c(r.throw(e))}catch(t){s(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,i)}c((r=r.apply(e,t||[])).next())}))},I=function(){function e(e,t,n,r,o,s){this.dynamicApi=e,this.view=t,this.spreadsheet=n,this.app=r,this.event=o,this.selectionService=s}var t=e.prototype;return t.insertAttachment=function(){return E(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t,n,r,o=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.view.canvas.normalSelectData,n=t.activeRow,!((r=t.activeCol)<0||n<0)){e.next=3;break}throw new Error("选区状态异常，无法上传本地文件");case 3:if(!this.hasContent(n,r)){e.next=5;break}return e.abrupt("return",y.dialog.confirm({title:d.ZP.t("上传本地文件"),content:d.ZP.t("上传本地文件会覆盖单元格中已有的内容，确定上传吗？"),cancelText:d.ZP.t("取消"),onOk:function(){return E(o,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.confirmInsertAttachment(n,r,!0);case 1:case"end":return e.stop()}}),e,this)})))},onCancel:function(){}}));case 5:this.confirmInsertAttachment(n,r,!1);case 6:case"end":return e.stop()}}),e,this)})))},t.getInsertAttachmentDisabledState=function(){return this.shouldDisableInsertAttachment()||this.selectionService.shouldPreventInsertCellImageOrLink()},t.confirmInsertAttachment=function(e,t,r){var o,s;return E(this,void 0,void 0,regeneratorRuntime.mark((function a(){var i,c,d,u,l,p,f,m;return regeneratorRuntime.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(!this.getInsertAttachmentDisabledState()){a.next=2;break}return a.abrupt("return");case 2:if(i=null===(o=this.view.canvas.linkCenter)||void 0===o?void 0:o.attachmentUploadingManager){a.next=5;break}return a.abrupt("return");case 5:return c=this.spreadsheet.getActiveSheetId(),a.next=8,this.dynamicApi.getInstance();case 8:return d=a.sent,u=this.view.canvas.linkCenter.attachmentUploadingManager.getAttachmentExtension,l=this.event,p=this.view,f={spreadsheet:this.spreadsheet,requestApi:d,event:l,view:p,row:e,col:t,sheetId:c,hasContent:r,getAttachmentExtension:u},m=new w.P(f),a.next=15,i.addAttachment(m);case 15:try{m.upload()}catch(h){null===(s=n.g.log)||void 0===s||s.error("link-attachment",h)}case 16:case"end":return a.stop()}}),a,this)})))},t.shouldDisableInsertAttachment=function(){var e,t=this.view.canvas.normalSelectData,n=t.activeRow,r=t.activeCol;if(-1===n||-1===r)return!0;var o=this.spreadsheet.activeSheet.getCellDataAtPosition(n,r),s=null===(e=this.view.getSelectionWithGridRanges())||void 0===e?void 0:e.rangeSelections,a=null===o||void 0===o?void 0:o.getMergeReference();return s.length>1||this.isMultiCellSelected(a,s[0])},t.hideAttachment=function(){return _.xc},t.hasContent=function(e,t){var n,r,o=this.spreadsheet.activeSheet,s=this.spreadsheet.activeSheetId;return!!(null===(r=null===(n=o.getCellDataAtPosition(e,t))||void 0===n?void 0:n.getEffectiveValue())||void 0===r?void 0:r.value)||(0,j._U)(e,t,s)},t.isMultiCellSelected=function(e,t){var n=t.startRowIndex,r=t.endRowIndex,o=t.startColIndex,s=t.endColIndex;return e?this.ifOnlyMultiCellSelected(e,t):n!==r||o!==s},t.ifOnlyMultiCellSelected=function(e,t){for(var n=0,r=Object.keys(e);n<r.length;n++){var o=r[n];if(e[o]!==t[o])return!0}return!1},e}();I=R([(0,l.L)({adapters:[b.L],name:"InsertAttachmentFeature"}),C(0,f.V),C(1,m.w),C(2,h.V),C(3,x.m),C(4,g.l9),C(5,(0,p.tB)(v.X)),S("design:paramtypes",["function"===typeof(r="undefined"!==typeof u.RU&&u.RU)?r:Object,"function"===typeof(o="undefined"!==typeof m.w&&m.w)?o:Object,"function"===typeof(s="undefined"!==typeof h.V&&h.V)?s:Object,"function"===typeof(a="undefined"!==typeof x.m&&x.m)?a:Object,"function"===typeof(i="undefined"!==typeof g.l9&&g.l9)?i:Object,"function"===typeof(c="undefined"!==typeof v.X&&v.X)?c:Object])],I)},"../spread-sheet/src/external/view/ui-layer/insert-cell-img/insert-cell-img-feature.ts":function(e,t,n){n.r(t),n.d(t,{InsertCellImgFeature:function(){return T}}),n("../node_modules/regenerator-runtime/runtime.js"),n("../node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),n("../node_modules/core-js/modules/esnext.reflect.metadata.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.promise.js");var r,o,s,a,i,c,d=n("../node_modules/i18next/dist/esm/i18next.js"),u=n("../node_modules/@tencent/workbench/lib/esm/decorators/class/feature.js"),l=n("../node_modules/@tencent/ioc/lib/esm/index.js"),p=n("../node_modules/@tencent/workbench/lib/esm/services/mobile-toolbar/mobile-toolbar-service.js"),f=n("../packages/report/src/index.ts"),m=n("../node_modules/@tencent/dui/lib/components/Modal/index.js"),h=n("../spread-sheet/src/core/view/layout/interface/pc-view.ts"),g=n("../spread-sheet/src/core/workbench/interfaces/selection-service.interface.ts"),v=n("../spread-sheet/src/core/ui/loading/index.ts"),y=n("../spread-sheet/src/core/view/level-2/shape-upload/ShapeUpload.ts"),w=n("../spread-sheet/src/base/event/event.ts"),j=n("../packages/model/src/spreadsheet/Spreadsheet.interface.ts"),_=n("../spread-sheet/src/core/behavior/api.interface.ts"),x=n("../node_modules/@tencent/containerized/build/main/index.js"),b=n("../node_modules/@tencent/dui/lib/components/Loading/index.js"),R=n("../spread-sheet/src/base/util/timer.ts"),S=n("../spread-sheet/src/adapter/SpreadSheetAppAdapter.ts"),C=function(e,t,n,r){var o,s=arguments.length,a=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var i=e.length-1;i>=0;i--)(o=e[i])&&(a=(s<3?o(a):s>3?o(t,n,a):o(t,n))||a);return s>3&&a&&Object.defineProperty(t,n,a),a},E=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},I=function(e,t){return function(n,r){t(n,r,e)}},M=function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function a(e){try{c(r.next(e))}catch(t){s(t)}}function i(e){try{c(r.throw(e))}catch(t){s(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,i)}c((r=r.apply(e,t||[])).next())}))},T=function(){function e(e,t,n,r,o,s,a){var i=this;this.view=e,this.spreadsheet=t,this.event=n,this.selectionService=r,this.dynamicApi=o,this.photoLoading=s,this.mobileToolbarService=a,this.confirmInsertCellImage=function(e,t){var n=i.spreadsheet.activeSheetId,r=v.ZP.createInstance(i.event,i.view.canvas,e,t,n);try{i.view.canvas.shapeUpload.insertShape(n,e,t,{callback:function(e){switch(e){case"start":null===r||void 0===r||r.show();break;case"end":null===r||void 0===r||r.hide()}}},y.ShapeType.CELL),f.ZP.tdwReport({opername:"doc_excel_editor",module:"excel_photo",action:"insert_photo_success",ver10:"pc_cell_photo_toolbar"})}catch(o){f.ZP.tdwReport({opername:"doc_excel_editor",module:"excel_photo",action:"photo_fail"})}}}var t=e.prototype;return t.insertCellImg=function(){var e,t,n=this,r=this.view.canvas.normalSelectData,o=r.activeRow,s=r.activeCol;if(s<0||o<0)throw new Error("选区状态异常，无法加入图片");f.ZP.tdwReport({opername:"doc_excel_editor",module:"excel_photo",action:"insert_photo_click",ver10:"pc_cell_photo_toolbar"}),(null===(t=null===(e=this.spreadsheet.activeSheet.getCellDataAtPosition(o,s))||void 0===e?void 0:e.getEffectiveValue())||void 0===t?void 0:t.value)?m.default.confirm({title:d.ZP.t("上传图片"),content:d.ZP.t("上传图片会覆盖单元格中已有的内容，确定上传吗？"),onOk:function(){return n.confirmInsertCellImage(o,s)}}):this.confirmInsertCellImage(o,s)},t.checkDisabled=function(){return this.selectionService.shouldPreventInsertCellImageOrLink()},t.insertFromAlbum=function(){return M(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.dynamicApi.getInstance();case 2:e.sent.insertImage({callback:function(e){t.photoUploadCallbck(e)}});case 4:case"end":return e.stop()}}),e,this)})))},t.insertFromShooting=function(){return M(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.dynamicApi.getInstance();case 2:e.sent.insertImage({capture:!0,callback:function(e){t.photoUploadCallbck(e)}});case 4:case"end":return e.stop()}}),e,this)})))},t.photoUploadCallbck=function(e){var t=this;"start"===e?(this.mobileToolbarService.closePanel(),this.photoLoading=b.Loading.show({tip:d.ZP.t("图片上传中...")})):R.Z.wait(500).run((function(){return t.photoLoading.close()}))},e}();T=C([(0,u.L)({adapters:[S.L]}),I(0,h.w),I(1,j.V),I(2,w.l9),I(3,(0,l.tB)(g.X)),I(4,_.V),E("design:paramtypes",["function"===typeof(r="undefined"!==typeof h.w&&h.w)?r:Object,"function"===typeof(o="undefined"!==typeof j.V&&j.V)?o:Object,"function"===typeof(s="undefined"!==typeof w.l9&&w.l9)?s:Object,"function"===typeof(a="undefined"!==typeof g.X&&g.X)?a:Object,"function"===typeof(i="undefined"!==typeof x.RU&&x.RU)?i:Object,Object,"function"===typeof(c="undefined"!==typeof p.n&&p.n)?c:Object])],T)},"../spread-sheet/src/external/view/ui-layer/insert-chart/insert-chart-feature.ts":function(e,t,n){n.r(t),n.d(t,{InsertChartFeature:function(){return g}}),n("../node_modules/regenerator-runtime/runtime.js"),n("../node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),n("../node_modules/core-js/modules/esnext.reflect.metadata.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.promise.js");var r,o,s=n("../node_modules/@tencent/workbench/lib/esm/decorators/class/feature.js"),a=n("../packages/report/src/index.ts"),i=n("../spread-sheet/src/core/view/layout/interface/pc-view.ts"),c=n("../spread-sheet/src/adapter/SpreadSheetAppAdapter.ts"),d=n("../spread-sheet/src/core/view/level-2/chart/charts/chart-data-api.ts"),u=n("../spread-sheet/src/external/view/main/panel/chartPanel/util/chartUtils.ts"),l=n("../packages/model/src/spreadsheet/Spreadsheet.interface.ts"),p=function(e,t,n,r){var o,s=arguments.length,a=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var i=e.length-1;i>=0;i--)(o=e[i])&&(a=(s<3?o(a):s>3?o(t,n,a):o(t,n))||a);return s>3&&a&&Object.defineProperty(t,n,a),a},f=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},m=function(e,t){return function(n,r){t(n,r,e)}},h=function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function a(e){try{c(r.next(e))}catch(t){s(t)}}function i(e){try{c(r.throw(e))}catch(t){s(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,i)}c((r=r.apply(e,t||[])).next())}))},g=function(){function e(e,t){this.spreadSheet=e,this.view=t}return e.prototype.insertChart=function(){return h(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=(0,u.aC)(this.spreadSheet,this.view),e.next=3,d.H.add(t);case 3:if(n=e.sent){e.next=6;break}return e.abrupt("return");case 6:return e.next=8,this.view.getChartPanel();case 8:e.sent.showWithChartOptions(n,t),a.ZP.tdwReport({opername:"doc_excel_editor",module:"excel_chart",action:"clk_insert_chart",ver12:"new"});case 10:case"end":return e.stop()}}),e,this)})))},e}();g=p([(0,s.L)({adapters:[c.L]}),m(0,l.V),m(1,i.w),f("design:paramtypes",["function"===typeof(r="undefined"!==typeof l.V&&l.V)?r:Object,"function"===typeof(o="undefined"!==typeof i.w&&i.w)?o:Object])],g)},"../spread-sheet/src/external/view/ui-layer/insert-comment/insert-comment-feature.ts":function(e,t,n){n.r(t),n.d(t,{InsertCommentFeature:function(){return v}}),n("../node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),n("../node_modules/core-js/modules/esnext.reflect.metadata.js");var r,o,s=n("../packages/report/src/index.ts"),a=n("../node_modules/@tencent/workbench/lib/esm/constants/service-name.js"),i=n("../node_modules/@tencent/workbench/lib/esm/decorators/class/feature.js"),c=n("../spread-sheet/src/external/view/main/toolbar/defaultHook.ts"),d=n("../spread-sheet/src/core/utils/index.ts"),u=n("../spread-sheet/src/core/view/layout/interface/pc-view.ts"),l=n("../spread-sheet/src/core/app/SpreadsheetApp.interface.ts"),p=n("../spread-sheet/src/base/util/domain-config.ts"),f=n("../spread-sheet/src/adapter/SpreadSheetAppAdapter.ts"),m=function(e,t,n,r){var o,s=arguments.length,a=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var i=e.length-1;i>=0;i--)(o=e[i])&&(a=(s<3?o(a):s>3?o(t,n,a):o(t,n))||a);return s>3&&a&&Object.defineProperty(t,n,a),a},h=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},g=function(e,t){return function(n,r){t(n,r,e)}},v=function(){function e(e,t){this.view=e,this.app=t}var t=e.prototype;return t.insertComment=function(e){var t;this.app.sheetStatus.canComment&&d.Z.selection.singleRange(this.app)&&!d.Z.selection.selectImage(this.app)&&(null===(t=c.Z.doClickComment)||void 0===t||t.call(c.Z,this.view),this.report(e))},t.shouldHideContext=function(){return p.xc},t.getSelection=function(){return this.view.getSelectionWithGridRanges()},t.commentDisabled=function(){return!this.app.sheetStatus.canComment},t.report=function(e){e===a.v.MOBILE_TOOLBAR&&s.ZP.tdwReport({module:"excel_mob_redesign",opername:"doc_excel_editor",action:"edit_tool_annotation"})},e}();v=m([(0,i.L)({adapters:[f.L],name:"InsertCommentFeature"}),g(0,u.w),g(1,l.m),h("design:paramtypes",["function"===typeof(r="undefined"!==typeof u.w&&u.w)?r:Object,"function"===typeof(o="undefined"!==typeof l.m&&l.m)?o:Object])],v)},"../spread-sheet/src/external/view/ui-layer/insert-cut-copy-cell/insert-cut-copy-cell-feature.ts":function(e,t,n){n.r(t),n.d(t,{InsertCutCopyCellFeature:function(){return R}}),n("../node_modules/regenerator-runtime/runtime.js"),n("../node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),n("../node_modules/core-js/modules/esnext.reflect.metadata.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.promise.js");var r,o,s=n("../node_modules/i18next/dist/esm/i18next.js"),a=n("../node_modules/@tencent/workbench/lib/esm/decorators/class/feature.js"),i=n("../node_modules/@tencent/containerized/build/main/index.js"),c=n("../node_modules/@tencent/docs-user-agent/dist/index.js"),d=n.n(c),u=n("../packages/report/src/index.ts"),l=n("../packages/model/src/dimension/index.ts"),p=n("../spread-sheet/src/core/feature/copyPaste/index.ts"),f=n("../spread-sheet/src/core/app/SpreadsheetApp.interface.ts"),m=n("../spread-sheet/src/adapter/SpreadSheetAppAdapter.ts"),h=n("../spread-sheet/src/core/ui/dialog/index.ts"),g=n("../spread-sheet/src/core/ui/alert/index.ts"),v=n("../spread-sheet/src/core/feature/copyPaste/api/copyPasteAPI.common.ts"),y=n("../spread-sheet/src/core/feature/Feature.interface.ts"),w=n("../spread-sheet/src/external/view/ui-layer/insert-cut-copy-cell/insert-cut-copy-cell.interface.ts"),j=function(e,t,n,r){var o,s=arguments.length,a=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var i=e.length-1;i>=0;i--)(o=e[i])&&(a=(s<3?o(a):s>3?o(t,n,a):o(t,n))||a);return s>3&&a&&Object.defineProperty(t,n,a),a},_=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},x=function(e,t){return function(n,r){t(n,r,e)}},b=function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function a(e){try{c(r.next(e))}catch(t){s(t)}}function i(e){try{c(r.throw(e))}catch(t){s(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,i)}c((r=r.apply(e,t||[])).next())}))},R=function(){function e(e,t){this.app=e,this.feature=t,this.setCopyPaste()}var t=e.prototype;return t.handleInsertCutCellsClick=function(){(0,v.RP)(this.app,{cbSucc:function(e){u.ZP.tdwReport({module:"excel_menu",opername:"doc_excel_editor",action:e===l.DIMENSION_TYPE.ROWS?"clk_insert_cut_row":"clk_insert_cut_col"})},cbFail:function(){return(0,h.showDialog1)(s.ZP.t("提示"),s.ZP.t("无法粘贴，因为复制区域与粘贴区域大小不一致。"))}}),p.default.apiDoPaste(this.app)},t.handleInsertCopyCellsClick=function(){(0,v.d6)(this.app,{cbSucc:function(e){u.ZP.tdwReport({module:"excel_menu",opername:"doc_excel_editor",action:e===l.DIMENSION_TYPE.ROWS?"clk_insert_copy_row":"clk_insert_copy_col"})},cbFail:function(){return(0,h.showDialog1)(s.ZP.t("提示"),s.ZP.t("无法粘贴，因为复制区域与粘贴区域大小不一致。"))}})},t.handleInsertCopyCutDimensionClick=function(){return b(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t,n,r,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.app.feature.getCopyPaste();case 2:return t=e.sent,e.next=5,(0,v.s5)(this.app,t);case 5:if(n=e.sent,r=n.isCut,o={cbSucc:function(e){return C(e,r)},cbFail:S},!r){e.next=10;break}return e.abrupt("return",(0,v.RP)(this.app,o));case 10:(0,v.d6)(this.app,o);case 11:case"end":return e.stop()}}),e,this)})))},t.shouldBtnHide=function(e,t){if(!this.copyPaste)return!0;var n=(0,v.s5)(this.app,this.copyPaste),r=n.canPaste,o=n.inValid,s=n.isCut,a=n.notSingle,i=n.cacheState,c=n.isSelectPic,u=!1;return(!r||o||a||i.hasDonePaste)&&(u=!0),u=function(e,t,n){return n&&(n===l.DIMENSION_TYPE.COLUMNS&&!t.selectCol||n===l.DIMENSION_TYPE.ROWS&&!t.selectRow)||e}(u,i.select,t),u=function(e,t,n){return!!(t===w.p.CUT&&!n||t===w.p.COPY&&n)||e}(u,e,s),!t&&d().isIPad&&c&&(u=!0),u},t.setCopyPaste=function(){return b(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.feature.getInstance();case 2:return t=e.sent,e.next=5,t.getCopyPaste();case 5:this.copyPaste=e.sent;case 6:case"end":return e.stop()}}),e,this)})))},e}();function S(){(0,g.showAlert)({content:s.ZP.t("无法粘贴，因为复制区域与粘贴区域大小不一致。"),buttons:[{type:"primary",label:s.ZP.t("确定")}]})}function C(e,t){var n={module:"excel_mob_menu",opername:"doc_excel_editor",action:""},r="";e===l.DIMENSION_TYPE.ROWS&&t&&(r="mob_cut_row_insert"),e!==l.DIMENSION_TYPE.ROWS||t||(r="mob_copy_row_insert"),e===l.DIMENSION_TYPE.COLUMNS&&t&&(r="mob_cut_col_insert"),e!==l.DIMENSION_TYPE.COLUMNS||t||(r="mob_copy_col_insert"),n.action=r,u.ZP.tdwReport(n)}R=j([(0,a.L)({name:"InsertCutCopyCellFeature",adapters:[m.L]}),x(0,f.m),x(1,y._),_("design:paramtypes",["function"===typeof(r="undefined"!==typeof f.m&&f.m)?r:Object,"function"===typeof(o="undefined"!==typeof i.RU&&i.RU)?o:Object])],R)},"../spread-sheet/src/external/view/ui-layer/insert-cut-copy-cell/insert-cut-copy-cell.interface.ts":function(e,t,n){n.d(t,{i:function(){return a},p:function(){return r}}),n("../node_modules/regenerator-runtime/runtime.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.promise.js"),n("../node_modules/core-js/modules/es.symbol.js"),n("../node_modules/core-js/modules/es.symbol.description.js"),n("../node_modules/core-js/modules/es.array.iterator.js"),n("../node_modules/core-js/modules/es.string.iterator.js"),n("../node_modules/core-js/modules/web.dom-collections.iterator.js");var r,o=n("../spread-sheet/src/flow/browser/phase/workbench/merge-into-registry.ts"),s=function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function a(e){try{c(r.next(e))}catch(t){s(t)}}function i(e){try{c(r.throw(e))}catch(t){s(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,i)}c((r=r.apply(e,t||[])).next())}))};!function(e){e.CUT="cut",e.COPY="copy"}(r||(r={}));var a=Symbol.for("feature:insert-cut-copy-cell");(0,o.N)(a,(function(){return s(void 0,void 0,void 0,regeneratorRuntime.mark((function e(){var t,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([n.e("initial_chunk_part_2"),n.e("vendors-node_modules_tencent_docs-design-resources_pc_png_2x_cdn-function-export_js"),n.e("vendors-node_modules_tencent_docs-addon-sdk_lib_index_esm_js"),n.e("vendors-node_modules_tencent_docs-design-resources_pc_png_2x_cdn_js-node_modules_tencent_docs-70ebca"),n.e("vendors-node_modules_tencent_facade-config_dist_index_js"),n.e("vendors-node_modules_tencent_wedrive-component_dist_xdSaveDoc_css"),n.e("spread-sheet_src_base_util_decorator_loading-decorator_ts-spread-sheet_src_core_feature_copyP-33f189"),n.e("spread-sheet_src_core_view_level-2_condition-format-center_ui_utils_dataUtils_ts"),n.e("spread-sheet_src_core_workbench_common_base-drawer_tsx-spread-sheet_src_external_rangeAuth_ut-2939e0"),n.e("spread-sheet_src_core_view_level-2_chart_charts_chart-data-api_ts-spread-sheet_src_core_view_-9220ef"),n.e("spread-sheet_src_external_view_main_toolbar_IconBox_tsx"),n.e("spread-sheet_src_external_check-slr_sc-lazy-loader_ts-spread-sheet_src_external_templateinfo_-54b3ca"),n.e("spread-sheet_src_core_network_message-center_adapter_MessageCenterAdapter_interface_ts-spread-e88071"),n.e("spread-sheet_src_core_utils_gray_ts-spread-sheet_src_core_view_level-2_condition-format-cente-74d507"),n.e("spread-sheet_src_base_util_phone-number_ts-spread-sheet_src_core_feature_copyPaste_index_ts-s-89b53a"),n.e("spread-sheet_src_core_view_layout_pcView_ts"),n.e("spread-sheet_src_core_view_level-2_link-center_BaseLinkCenter_ts"),n.e("bundle_workbench_feature")]).then(n.bind(n,"../spread-sheet/src/external/view/ui-layer/insert-cut-copy-cell/insert-cut-copy-cell-feature.ts"));case 2:return t=e.sent,r=t.InsertCutCopyCellFeature,e.abrupt("return",r);case 5:case"end":return e.stop()}}),e)})))}))},"../spread-sheet/src/external/view/ui-layer/insert-date-reminder-ent/insert-date-reminder-feature.ts":function(e,t,n){n.r(t),n.d(t,{InsertDateReminderFeature:function(){return v}}),n("../node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),n("../node_modules/core-js/modules/esnext.reflect.metadata.js");var r,o,s,a=n("../node_modules/@tencent/workbench/lib/esm/decorators/class/feature.js"),i=n("../spread-sheet/src/core/view/layout/interface/pc-view.ts"),c=n("../spread-sheet/src/core/utils/index.ts"),d=n("../spread-sheet/src/external/view/main/toolbar/defaultHook.ts"),u=n("../packages/model/src/cell/metadata/CustomDataType.ts"),l=n("../packages/model/src/spreadsheet/index.ts"),p=n("../spread-sheet/src/core/app/SpreadsheetApp.interface.ts"),f=n("../spread-sheet/src/adapter/SpreadSheetAppAdapter.ts"),m=function(e,t,n,r){var o,s=arguments.length,a=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var i=e.length-1;i>=0;i--)(o=e[i])&&(a=(s<3?o(a):s>3?o(t,n,a):o(t,n))||a);return s>3&&a&&Object.defineProperty(t,n,a),a},h=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},g=function(e,t){return function(n,r){t(n,r,e)}},v=function(){function e(e,t,n){this.app=e,this.view=t,this.spreadsheet=n}var t=e.prototype;return t.insertDateReminder=function(){d.Z.doInsertDateReminder(this.view)},t.checkInsertCustomDataTypeDisable=function(){var e=u.ZP.DATE_REMINDER,t=this.view.getSelection().activeCell,n=t.rowIndex,r=t.colIndex,o=this.spreadsheet.activeSheet.getCellDataAtPosition(n,r),s=null===o||void 0===o?void 0:o.getMetadata();return!(!s||s.customDataType===e)||!!(null===o||void 0===o?void 0:o.isHyperlink())||!!this.spreadsheet.activeSheet.todoManager.isTodo(n,r)||!c.Z.selection.singleRange(this.app)},e}();v=m([(0,a.L)({adapters:[f.L],name:"InsertDateReminderFeature"}),g(0,p.m),g(1,i.w),g(2,l.ISpreadsheet),h("design:paramtypes",["function"===typeof(r="undefined"!==typeof p.m&&p.m)?r:Object,"function"===typeof(o="undefined"!==typeof i.w&&i.w)?o:Object,"function"===typeof(s="undefined"!==typeof l.ISpreadsheet&&l.ISpreadsheet)?s:Object])],v)},"../spread-sheet/src/external/view/ui-layer/insert-doc-ent/insert-doc-feature.ts":function(e,t,n){n.r(t),n.d(t,{InsertDocFeature:function(){return C}}),n("../node_modules/regenerator-runtime/runtime.js"),n("../node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),n("../node_modules/core-js/modules/esnext.reflect.metadata.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.promise.js"),n("../node_modules/core-js/modules/es.function.name.js");var r,o,s,a,i=n("../node_modules/i18next/dist/esm/i18next.js"),c=n("../node_modules/@tencent/workbench/lib/esm/decorators/class/feature.js"),d=n("../spread-sheet/src/core/app/sheetStatus/index.ts"),u=n("../spread-sheet/src/core/view/layout/interface/pc-view.ts"),l=n("../packages/model/src/spreadsheet/index.ts"),p=n("../node_modules/@tencent/dui/lib/components/Snackbar/index.js"),f=n("../spread-sheet/src/external/view/ui-layer/report-helper.ts"),m=n("../packages/model/src/cell/metadata/CustomDataType.ts"),h=n("../spread-sheet/src/core/feature/copyPaste/lib/parsers/automaticIdentifyLink.ts"),g=n("../packages/model/src/cell/index.ts"),v=n("../packages/model/src/cell/format/index.ts"),y=n("../spread-sheet/src/core/behavior/api.interface.ts"),w=(n("../spread-sheet/src/base/util/domain-config.ts"),n("../spread-sheet/src/core/feature/relateFormEnt/enterpriseStatus.ts"),n("../node_modules/@tencent/containerized/build/main/index.js")),j=n("../spread-sheet/src/core/utils/gray.ts"),_=n("../spread-sheet/src/adapter/SpreadSheetAppAdapter.ts"),x=function(e,t,n,r){var o,s=arguments.length,a=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var i=e.length-1;i>=0;i--)(o=e[i])&&(a=(s<3?o(a):s>3?o(t,n,a):o(t,n))||a);return s>3&&a&&Object.defineProperty(t,n,a),a},b=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},R=function(e,t){return function(n,r){t(n,r,e)}},S=function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function a(e){try{c(r.next(e))}catch(t){s(t)}}function i(e){try{c(r.throw(e))}catch(t){s(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,i)}c((r=r.apply(e,t||[])).next())}))},C=function(){function e(e,t,n,r){this.sheetStatus=e,this.spreadsheet=t,this.view=n,this.dynamicApi=r}var t=e.prototype;return t.insertDoc=function(e){if(this.sheetStatus.workbookStatus.isOnline){var t=this.spreadsheet.getActiveSheetId(),n=this.view.canvas.normalSelectData.activeRow,r=this.view.canvas.normalSelectData.activeCol;this.view.canvas.fileSelector.showAndApply(t,n,r,e),(0,f.c)("drive")}else p.default.show({message:i.ZP.t("当前已离线，请联网后重试"),type:"info",duration:3e3})},t.insertDocMobile=function(){var e;return S(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n,r,o,s,a,i,c,d;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,null===(e=window.tdocs)||void 0===e?void 0:e.chooseTencentOfficeFile();case 2:if((n=t.sent)&&n.url){t.next=5;break}return t.abrupt("return");case 5:return t.next=7,this.dynamicApi.getInstance();case 7:return r=t.sent,o=n.name,s=n.url,a=this.view.canvas.normalSelectData.activeCol,i=this.view.canvas.normalSelectData.activeRow,t.next=13,(0,h.en)({url:s});case 13:c=t.sent,d=c.hyperlinkType,r.setHyperLink(o,s,d||g.HYPERLINK_TYPE.NORMAL,i,a,v.HORIZONTAL_ALIGN.LEFT);case 16:case"end":return t.stop()}}),t,this)})))},t.hideInsertDocMobile=function(){return!0},t.hideInsertDoc=function(){return(0,j.i)()},t.disableInsertDoc=function(){var e=this.view.getSelection().activeCell,t=e.rowIndex,n=e.colIndex,r=this.spreadsheet.activeSheet;return(0,m.lv)(r,t,n)},e}();C=x([(0,c.L)({adapters:[_.L],name:"InsertDocFeature"}),R(0,d.T),R(1,l.ISpreadsheet),R(2,u.w),R(3,y.V),b("design:paramtypes",["function"===typeof(r="undefined"!==typeof d.T&&d.T)?r:Object,"function"===typeof(o="undefined"!==typeof l.ISpreadsheet&&l.ISpreadsheet)?o:Object,"function"===typeof(s="undefined"!==typeof u.w&&u.w)?s:Object,"function"===typeof(a="undefined"!==typeof w.RU&&w.RU)?a:Object])],C)},"../spread-sheet/src/external/view/ui-layer/insert-docLink/insert-docLink-feature.ts":function(e,t,n){n.r(t),n.d(t,{InsertDocLinkFeature:function(){return I}}),n("../node_modules/regenerator-runtime/runtime.js"),n("../node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),n("../node_modules/core-js/modules/esnext.reflect.metadata.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.promise.js");var r,o,s,a,i,c=n("../node_modules/i18next/dist/esm/i18next.js"),d=n("../node_modules/@tencent/workbench/lib/esm/decorators/class/feature.js"),u=n("../node_modules/@tencent/ioc/lib/esm/index.js"),l=n("../node_modules/@tencent/workbench/lib/esm/services/mobile-toolbar/mobile-toolbar-service.js"),p=n("../spread-sheet/src/core/app/SpreadsheetApp.interface.ts"),f=n("../node_modules/@tencent/dui/lib/components/Snackbar/index.js"),m=n("../packages/model/src/cell/HyperlinkType.ts"),h=n("../packages/model/src/cell/format/HorizontalAlign.ts"),g=n("../packages/report/src/index.ts"),v=n("../spread-sheet/src/core/view/layout/interface/pc-view.ts"),y=n("../spread-sheet/src/core/behavior/api.interface.ts"),w=n("../node_modules/@tencent/containerized/build/main/index.js"),j=n("../spread-sheet/src/external/check-slr/sc-lazy-loader.ts"),_=n("../spread-sheet/src/core/workbench/interfaces/selection-service.interface.ts"),x=n("../spread-sheet/src/adapter/SpreadSheetAppAdapter.ts"),b=n("../spread-sheet/src/base/util/domain-config.ts"),R=function(e,t,n,r){var o,s=arguments.length,a=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var i=e.length-1;i>=0;i--)(o=e[i])&&(a=(s<3?o(a):s>3?o(t,n,a):o(t,n))||a);return s>3&&a&&Object.defineProperty(t,n,a),a},S=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},C=function(e,t){return function(n,r){t(n,r,e)}},E=function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function a(e){try{c(r.next(e))}catch(t){s(t)}}function i(e){try{c(r.throw(e))}catch(t){s(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,i)}c((r=r.apply(e,t||[])).next())}))},I=function(){function e(e,t,n,r,o){var s=this;this.app=e,this.view=t,this.dynamicApi=n,this.mobileToolbarService=r,this.selectionService=o,this.handleReport=function(){g.ZP.monitor(35267228),g.ZP.tdwReport({opername:"insert_tdoc",module:"file_selector",action:"enter_clk"})},this.handleOffline=function(){return!!s.app.sheetStatus.workbookStatus.isOnline||(f.default.show({message:c.ZP.t("当前已离线，请联网后重试"),type:"info",duration:3e3}),!1)},this.onConfirm=function(e){return E(s,void 0,void 0,regeneratorRuntime.mark((function t(){var n,r,o,s,a,i,c,d,u;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.title,r=e.url,o=e.type,s=e.doc_policy,a=this.view.canvas.normalSelectData.activeCol,i=this.view.canvas.normalSelectData.activeRow,t.next=5,this.dynamicApi.getInstance();case 5:c=t.sent,d="DEFAULT",u=[{regex:/\.docx?$/,type:"OFFICE_WORD"},{regex:/\.xlsx?$/,type:"OFFICE_EXCEL"},{regex:/\.pptx?$/,type:"OFFICE_PPT"}],"DRIVE"===o?u.some((function(e){var t=e.regex,r=e.type;if(t.test(n))return d=r,!0})):d=o,c.setHyperLink(n,r,m.ZP[d],i,a,h.Z.LEFT),g.ZP.monitor(35267237),g.ZP.tdwReport({opername:"insert_tdoc",module:"file_selector",action:"insert_clk",ver10:0===s?1:2,ver11:o});case 12:case"end":return t.stop()}}),t,this)})))},this.close=function(){s.mobileToolbarService.showToolbar()}}var t=e.prototype;return t.insertDocLink=function(){return E(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.handleOffline()){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,(0,j.rq)();case 4:e.sent.default.show({onConfirm:this.onConfirm,changePermissonOk:function(){},changePermissonCancel:function(){},changePermissonError:function(){},close:function(){}}),this.handleReport();case 7:case"end":return e.stop()}}),e,this)})))},t.insertDocLinkMobile=function(){return E(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.handleOffline()){e.next=2;break}return e.abrupt("return");case 2:return this.mobileToolbarService.closePanel(),e.next=5,(0,j._3)();case 5:e.sent.default.show({onConfirm:this.onConfirm,changePermissonOk:function(){},changePermissonCancel:function(){},changePermissonError:function(){},close:this.close}),this.handleReport();case 8:case"end":return e.stop()}}),e,this)})))},t.getInsertDocLinkDisabledState=function(){return this.selectionService.shouldPreventInsertCellImageOrLink()},t.hideDocLinkMobile=function(){return b.xc},e}();I=R([(0,d.L)({adapters:[x.L],name:"InsertDocLinkFeature"}),C(0,p.m),C(1,v.w),C(2,y.V),C(4,(0,u.tB)(_.X)),S("design:paramtypes",["function"===typeof(r="undefined"!==typeof p.m&&p.m)?r:Object,"function"===typeof(o="undefined"!==typeof v.w&&v.w)?o:Object,"function"===typeof(s="undefined"!==typeof w.RU&&w.RU)?s:Object,"function"===typeof(a="undefined"!==typeof l.n&&l.n)?a:Object,"function"===typeof(i="undefined"!==typeof _.X&&_.X)?i:Object])],I)},"../spread-sheet/src/external/view/ui-layer/insert-file-ent/insert-file-feature.ts":function(e,t,n){n.r(t),n.d(t,{InsertFileFeature:function(){return w}}),n("../node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),n("../node_modules/core-js/modules/esnext.reflect.metadata.js");var r,o,s,a=n("../node_modules/i18next/dist/esm/i18next.js"),i=n("../node_modules/@tencent/workbench/lib/esm/decorators/class/feature.js"),c=n("../spread-sheet/src/core/app/sheetStatus/index.ts"),d=n("../spread-sheet/src/core/view/layout/interface/pc-view.ts"),u=n("../packages/model/src/spreadsheet/index.ts"),l=n("../node_modules/@tencent/dui/lib/components/Snackbar/index.js"),p=n("../spread-sheet/src/external/view/ui-layer/report-helper.ts"),f=n("../packages/model/src/cell/metadata/CustomDataType.ts"),m=n("../spread-sheet/src/core/utils/gray.ts"),h=n("../spread-sheet/src/adapter/SpreadSheetAppAdapter.ts"),g=function(e,t,n,r){var o,s=arguments.length,a=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var i=e.length-1;i>=0;i--)(o=e[i])&&(a=(s<3?o(a):s>3?o(t,n,a):o(t,n))||a);return s>3&&a&&Object.defineProperty(t,n,a),a},v=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},y=function(e,t){return function(n,r){t(n,r,e)}},w=function(){function e(e,t,n){this.sheetStatus=e,this.spreadsheet=t,this.view=n}var t=e.prototype;return t.insertWedriveFile=function(e){if(this.sheetStatus.workbookStatus.isOnline){var t=this.spreadsheet.getActiveSheetId(),n=this.view.canvas.normalSelectData.activeRow,r=this.view.canvas.normalSelectData.activeCol;this.view.canvas.fileSelector.showAndApply(t,n,r,e),(0,p.c)("drive")}else l.default.show({message:a.ZP.t("当前已离线，请联网后重试"),type:"info",duration:3e3})},t.uploadFile=function(){if(this.sheetStatus.workbookStatus.isOnline){var e=this.spreadsheet.getActiveSheetId(),t=this.view.canvas.normalSelectData.activeRow,n=this.view.canvas.normalSelectData.activeCol;this.view.canvas.fileUploader.uploadFromLocal({sheetId:e,row:t,col:n}),(0,p.c)("upload")}else l.default.show({message:a.ZP.t("当前已离线，请联网后重试"),type:"info",duration:3e3})},t.disbaleInsertFile=function(){var e=this.view.getSelection().activeCell,t=e.rowIndex,n=e.colIndex,r=this.spreadsheet.activeSheet;return(0,f.lv)(r,t,n)},t.hideInsertFile=function(){return(0,m.i)()},e}();w=g([(0,i.L)({adapters:[h.L],name:"InsertFileFeature"}),y(0,c.T),y(1,u.ISpreadsheet),y(2,d.w),v("design:paramtypes",["function"===typeof(r="undefined"!==typeof c.T&&c.T)?r:Object,"function"===typeof(o="undefined"!==typeof u.ISpreadsheet&&u.ISpreadsheet)?o:Object,"function"===typeof(s="undefined"!==typeof d.w&&d.w)?s:Object])],w)},"../spread-sheet/src/external/view/ui-layer/insert-float-img/insert-float-img-feature.ts":function(e,t,n){n.r(t),n.d(t,{InsertFloatImgFeature:function(){return f}}),n("../node_modules/regenerator-runtime/runtime.js"),n("../node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),n("../node_modules/core-js/modules/esnext.reflect.metadata.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.promise.js");var r,o=n("../node_modules/@tencent/workbench/lib/esm/decorators/class/feature.js"),s=n("../packages/report/src/index.ts"),a=n("../node_modules/@tencent/containerized/build/main/index.js"),i=n("../spread-sheet/src/core/behavior/api.interface.ts"),c=n("../spread-sheet/src/adapter/SpreadSheetAppAdapter.ts"),d=function(e,t,n,r){var o,s=arguments.length,a=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var i=e.length-1;i>=0;i--)(o=e[i])&&(a=(s<3?o(a):s>3?o(t,n,a):o(t,n))||a);return s>3&&a&&Object.defineProperty(t,n,a),a},u=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},l=function(e,t){return function(n,r){t(n,r,e)}},p=function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function a(e){try{c(r.next(e))}catch(t){s(t)}}function i(e){try{c(r.throw(e))}catch(t){s(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,i)}c((r=r.apply(e,t||[])).next())}))},f=function(){function e(e){this.dynamicApi=e}return e.prototype.insertFloatImg=function(){return p(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.dynamicApi.getInstance();case 2:e.sent.insertImage(),s.ZP.tdwReport({opername:"doc_excel_editor",module:"excel_photo",action:"clk_insert_picture",ver10:"pc_float_photo"});case 5:case"end":return e.stop()}}),e,this)})))},e}();f=d([(0,o.L)({adapters:[c.L]}),l(0,i.V),u("design:paramtypes",["function"===typeof(r="undefined"!==typeof a.RU&&a.RU)?r:Object])],f)},"../spread-sheet/src/external/view/ui-layer/insert-group-card-ent/insert-group-card-feature.ts":function(e,t,n){n.r(t),n.d(t,{InsertGroupCardFeature:function(){return v}}),n("../node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),n("../node_modules/core-js/modules/esnext.reflect.metadata.js"),n("../node_modules/@tencent/docs-user-agent/dist/index.js");var r,o,s,a=n("../node_modules/@tencent/workbench/lib/esm/decorators/class/feature.js"),i=n("../spread-sheet/src/core/view/layout/interface/pc-view.ts"),c=n("../spread-sheet/src/core/utils/index.ts"),d=n("../spread-sheet/src/external/view/main/toolbar/defaultHook.ts"),u=(n("../spread-sheet/src/base/util/domain-config.ts"),n("../packages/model/src/cell/metadata/CustomDataType.ts")),l=n("../packages/model/src/spreadsheet/index.ts"),p=n("../spread-sheet/src/core/app/SpreadsheetApp.interface.ts"),f=n("../spread-sheet/src/adapter/SpreadSheetAppAdapter.ts"),m=function(e,t,n,r){var o,s=arguments.length,a=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var i=e.length-1;i>=0;i--)(o=e[i])&&(a=(s<3?o(a):s>3?o(t,n,a):o(t,n))||a);return s>3&&a&&Object.defineProperty(t,n,a),a},h=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},g=function(e,t){return function(n,r){t(n,r,e)}},v=function(){function e(e,t,n){this.app=e,this.view=t,this.spreadsheet=n}var t=e.prototype;return t.insertGroupCard=function(){d.Z.doInsertGroupCard(this.view)},t.hideGroupCard=function(){return!0},t.checkInsertCustomDataTypeDisable=function(){var e=u.ZP.GROUP_CARD,t=this.view.getSelection().activeCell,n=t.rowIndex,r=t.colIndex,o=this.spreadsheet.activeSheet.getCellDataAtPosition(n,r),s=null===o||void 0===o?void 0:o.getMetadata();return!(!s||s.customDataType===e)||!!(null===o||void 0===o?void 0:o.isHyperlink())||!!this.spreadsheet.activeSheet.todoManager.isTodo(n,r)||!c.Z.selection.singleRange(this.app)},e}();v=m([(0,a.L)({adapters:[f.L],name:"InsertGroupCardFeature"}),g(0,p.m),g(1,i.w),g(2,l.ISpreadsheet),h("design:paramtypes",["function"===typeof(r="undefined"!==typeof p.m&&p.m)?r:Object,"function"===typeof(o="undefined"!==typeof i.w&&i.w)?o:Object,"function"===typeof(s="undefined"!==typeof l.ISpreadsheet&&l.ISpreadsheet)?s:Object])],v)},"../spread-sheet/src/external/view/ui-layer/insert-link/insert-link-feature.ts":function(e,t,n){n.r(t),n.d(t,{InsertLinkFeature:function(){return b}}),n("../node_modules/regenerator-runtime/runtime.js"),n("../node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),n("../node_modules/core-js/modules/esnext.reflect.metadata.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.promise.js");var r,o,s,a,i,c=n("../node_modules/@tencent/containerized/build/main/index.js"),d=n("../node_modules/@tencent/workbench/lib/esm/decorators/class/feature.js"),u=n("../node_modules/@tencent/ioc/lib/esm/index.js"),l=n("../packages/model/src/spreadsheet/index.ts"),p=n("../spread-sheet/src/core/behavior/api.interface.ts"),f=n("../spread-sheet/src/core/workbench/interfaces/selection-service.interface.ts"),m=n("../spread-sheet/src/core/view/layout/interface/pc-view.ts"),h=n("../spread-sheet/src/core/utils/index.ts"),g=n("../spread-sheet/src/core/app/SpreadsheetApp.interface.ts"),v=n("../node_modules/i18next/dist/esm/i18next.js"),y=(n("../spread-sheet/src/base/util/domain-config.ts"),n("../spread-sheet/src/adapter/SpreadSheetAppAdapter.ts")),w=function(e,t,n,r){var o,s=arguments.length,a=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var i=e.length-1;i>=0;i--)(o=e[i])&&(a=(s<3?o(a):s>3?o(t,n,a):o(t,n))||a);return s>3&&a&&Object.defineProperty(t,n,a),a},j=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},_=function(e,t){return function(n,r){t(n,r,e)}},x=function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function a(e){try{c(r.next(e))}catch(t){s(t)}}function i(e){try{c(r.throw(e))}catch(t){s(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,i)}c((r=r.apply(e,t||[])).next())}))},b=function(){function e(e,t,n,r,o){this.dynamicApi=e,this.spreadsheet=t,this.view=n,this.app=r,this.selectionService=o}var t=e.prototype;return t.insertLink=function(){return x(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.dynamicApi.getInstance();case 2:e.sent.insertLink();case 4:case"end":return e.stop()}}),e,this)})))},t.getInsertLinkDisabledState=function(){return this.selectionService.shouldPreventInsertCellImageOrLink()},t.getInsertLinkContent=function(){return h.Z.selection.isLinkCell(this.app)?v.ZP.t("修改链接"):v.ZP.t("链接")},t.hideInsertLink=function(){return h.Z.selection.getSelectCLs(this.app),!1},e}();b=w([(0,d.L)({adapters:[y.L],name:"InsertLinkFeature"}),_(0,p.V),_(1,l.ISpreadsheet),_(2,m.w),_(3,g.m),_(4,(0,u.tB)(f.X)),j("design:paramtypes",["function"===typeof(r="undefined"!==typeof c.RU&&c.RU)?r:Object,"function"===typeof(o="undefined"!==typeof l.ISpreadsheet&&l.ISpreadsheet)?o:Object,"function"===typeof(s="undefined"!==typeof m.w&&m.w)?s:Object,"function"===typeof(a="undefined"!==typeof g.m&&g.m)?a:Object,"function"===typeof(i="undefined"!==typeof f.X&&f.X)?i:Object])],b)},"../spread-sheet/src/external/view/ui-layer/insert-range/insert-range-feature.ts":function(e,t,n){n.r(t),n.d(t,{InsertRangeFeature:function(){return f}}),n("../node_modules/regenerator-runtime/runtime.js"),n("../node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),n("../node_modules/core-js/modules/esnext.reflect.metadata.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.promise.js"),n("../node_modules/core-js/modules/es.function.name.js");var r,o=n("../node_modules/@tencent/workbench/lib/esm/decorators/class/feature.js"),s=n("../spread-sheet/src/core/app/SpreadsheetApp.interface.ts"),a=n("../spread-sheet/src/adapter/SpreadSheetAppAdapter.ts"),i=n("../spread-sheet/src/core/behavior/request/range/common/index.ts"),c=n("../spread-sheet/src/core/behavior/request/range/config.ts"),d=function(e,t,n,r){var o,s=arguments.length,a=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var i=e.length-1;i>=0;i--)(o=e[i])&&(a=(s<3?o(a):s>3?o(t,n,a):o(t,n))||a);return s>3&&a&&Object.defineProperty(t,n,a),a},u=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},l=function(e,t){return function(n,r){t(n,r,e)}},p=function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function a(e){try{c(r.next(e))}catch(t){s(t)}}function i(e){try{c(r.throw(e))}catch(t){s(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,i)}c((r=r.apply(e,t||[])).next())}))},f=function(){function e(e){this.app=e}var t=e.prototype;return t.insertRange=function(e){return p(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n,r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=(0,i.I9)(this.app),r=this.getDirection(e),this.app.requestApi.insertRange({range:n,direction:r});case 3:case"end":return t.stop()}}),t,this)})))},t.getInsertRangeDisabled=function(e){var t=this.app,n=t.spreadsheet,r=t.view,o=t.sheetStatus;return!(0,i.N2)(n.activeSheet,r.canvas.normalSelectData,o,e,c.Us.INSERT)},t.getDirection=function(e){return/right/g.test(e.name)?c.ai.RIGHT:c.ai.DOWN},e}();f=d([(0,o.L)({name:"InsertRangeFeature",adapters:[a.L]}),l(0,s.m),u("design:paramtypes",["function"===typeof(r="undefined"!==typeof s.m&&s.m)?r:Object])],f)},"../spread-sheet/src/external/view/ui-layer/insert-row-col/insert-row-col-feature.tsx":function(e,t,n){n.r(t),n.d(t,{InsertRowColFeature:function(){return I}}),n("../node_modules/regenerator-runtime/runtime.js"),n("../node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),n("../node_modules/core-js/modules/esnext.reflect.metadata.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.promise.js");var r,o,s,a=n("../node_modules/i18next/dist/esm/i18next.js"),i=n("../node_modules/@tencent/workbench/lib/esm/decorators/class/feature.js"),c=n("../spread-sheet/src/core/view/layout/interface/pc-view.ts"),d=n("../packages/model/src/spreadsheet/Spreadsheet.interface.ts"),u=n("../packages/report/src/index.ts"),l=n("../spread-sheet/src/core/view/level-1/select-center/base/selection/RowSelection.ts"),p=n("../spread-sheet/src/core/view/level-1/select-center/base/selection/ColSelection.ts"),f=n("react"),m=n("../packages/model/src/range/index.ts"),h=n("../spread-sheet/src/core/ui/dialog/index.ts"),g=n("../packages/model/src/config/index.ts"),v=n("../spread-sheet/src/external/view/schema/contextmenu-key.ts"),y=n("../node_modules/@babel/runtime/helpers/esm/inheritsLoose.js"),w=(n("../node_modules/core-js/modules/es.number.constructor.js"),function(e){function t(t){var n;return(n=e.call(this,t)||this).onInput=function(){var e=n.inputRef.current.value;/^[0-9]+$/.test(e)||(e=void 0===e||""===e?"":String(n.props.defaultValue)||"1"),Number(e)>999&&(e="999"),n.inputRef.current.value=e},n.onChange=function(){n.props.onChange(parseInt(n.inputRef.current.value))},n.inputRef=f.createRef(),n}return(0,y.Z)(t,e),t.prototype.render=function(){var e;return f.createElement("input",{ref:this.inputRef,className:"context-menu-insert-input",style:null!==(e=this.props.style)&&void 0!==e?e:{},onInput:this.onInput,onChange:this.onChange,onClick:function(e){return e.stopPropagation()},defaultValue:this.props.defaultValue})},t}(f.Component)),j=n("../spread-sheet/src/external/view/ui-layer/insert-row-col/insert-row-col.interface.ts"),_=n("../spread-sheet/src/external/view/schema/menu-schema.ts"),x=n("../spread-sheet/src/core/workbench/common/auth-range-service.ts"),b=n("../spread-sheet/src/adapter/SpreadSheetAppAdapter.ts"),R=function(e,t,n,r){var o,s=arguments.length,a=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var i=e.length-1;i>=0;i--)(o=e[i])&&(a=(s<3?o(a):s>3?o(t,n,a):o(t,n))||a);return s>3&&a&&Object.defineProperty(t,n,a),a},S=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},C=function(e,t){return function(n,r){t(n,r,e)}},E=function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function a(e){try{c(r.next(e))}catch(t){s(t)}}function i(e){try{c(r.throw(e))}catch(t){s(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,i)}c((r=r.apply(e,t||[])).next())}))},I=function(){function e(e,t,n){var r,o=this;this.view=e,this.spreadsheet=t,this.authRangeService=n,this.cacheInsertAmount=((r={})[v.B.INSERT_ROW_ABOVE]=1,r[v.B.INSERT_ROW_BELOW]=1,r[v.B.INSERT_COL_LEFT]=1,r[v.B.INSERT_COL_RIGHT]=1,r),this.authRangeService.addRule(v.B.INSERT_ROW_ABOVE,{getRanges:function(){return[o.getInsertRowAboveAuthRange()]}}),this.authRangeService.addRule(v.B.INSERT_ROW_BELOW,{getRanges:function(){return[o.getInsertRowBelowAuthRange()]}}),this.authRangeService.addRule(v.B.INSERT_COL_LEFT,{getRanges:function(){return[o.getInsertColLeftAuthRange()]}}),this.authRangeService.addRule(v.B.INSERT_COL_RIGHT,{getRanges:function(){return[o.getInsertColRightAuthRange()]}}),this.authRangeService.addRule(_.z_.INSERT_ROW_ABOVE_IN_MENU,{getRanges:function(){return[o.getInsertRowAboveAuthRange()]}}),this.authRangeService.addRule(_.z_.INSERT_ROW_BELOW_IN_MENU,{getRanges:function(){return[o.getInsertRowBelowAuthRange()]}}),this.authRangeService.addRule(_.z_.INSERT_COL_LEFT_IN_MENU,{getRanges:function(){return[o.getInsertColLeftAuthRange()]}}),this.authRangeService.addRule(_.z_.INSERT_COL_RIGHT_IN_MENU,{getRanges:function(){return[o.getInsertColRightAuthRange()]}})}var t=e.prototype;return t.shouldHide=function(){return!this.view.canvas.normalSelectData.select},t.insertRowAbove=function(e){var t=this.getCellIndex(j.mG.ROWS,j.mG.ABOVE);t===j.pn||e<=0||isNaN(e)||((this.spreadsheet.activeSheet.getRowCount()+e)*this.spreadsheet.activeSheet.getColCount()<g.MAX_CELL_COUNT?(this.view.canvas.modifyDimensionBroker.insertRow([{index:t,amount:e}]),this.view.canvas.modifySelectionBroker.setSelection({yRange:[t,t+e-1],activation:{row:t,col:this.view.canvas.normalSelectData.activeCol}})):this.showLimitDialog())},t.insertRowBelow=function(e){var t=this.getCellIndex(j.mG.ROWS,j.mG.BELOW);t===j.pn||e<=0||isNaN(e)||((this.spreadsheet.activeSheet.getRowCount()+e)*this.spreadsheet.activeSheet.getColCount()<g.MAX_CELL_COUNT?(this.view.canvas.modifyDimensionBroker.insertRow([{index:t,amount:e}]),this.view.canvas.modifySelectionBroker.setSelection({yRange:[t,t+e-1],activation:{row:t,col:this.view.canvas.normalSelectData.activeCol}})):this.showLimitDialog())},t.insertColLeft=function(e){var t=this.getCellIndex(j.mG.COLS,j.mG.LEFT);if(!(t===j.pn||e<=0||isNaN(e))){var n=this.spreadsheet.activeSheet.getRowCount();(this.spreadsheet.activeSheet.getColCount()+e)*n<g.MAX_CELL_COUNT?(this.view.canvas.modifyDimensionBroker.insertCol([{index:t,amount:e}]),this.view.canvas.modifySelectionBroker.setSelection({xRange:[t,t+e-1],activation:{col:t,row:this.view.canvas.normalSelectData.activeRow}})):this.showLimitDialog()}},t.insertColRight=function(e){return E(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n,r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!((n=this.getCellIndex(j.mG.COLS,j.mG.RIGHT))===j.pn||e<=0||isNaN(e))){t.next=3;break}return t.abrupt("return");case 3:r=this.spreadsheet.activeSheet.getRowCount(),(this.spreadsheet.activeSheet.getColCount()+e)*r<g.MAX_CELL_COUNT?(this.view.canvas.modifyDimensionBroker.insertCol([{index:n,amount:e}]),this.view.canvas.modifySelectionBroker.setSelection({xRange:[n,n+e-1],activation:{col:n,row:this.view.canvas.normalSelectData.activeRow}})):this.showLimitDialog();case 6:case"end":return t.stop()}}),t,this)})))},t.getInsertRowAboveAuthRange=function(){var e=this.getCellIndex(j.mG.ROWS,j.mG.ABOVE);return new m.GridRange(this.spreadsheet.activeSheetId,Math.max(0,e-1),Math.max(0,e-1),m.DEFAULT_DIMENSION_INDEX,m.DEFAULT_DIMENSION_INDEX)},t.getInsertRowBelowAuthRange=function(){var e=this.getCellIndex(j.mG.ROWS,j.mG.BELOW);return new m.GridRange(this.spreadsheet.activeSheetId,e,e,m.DEFAULT_DIMENSION_INDEX,m.DEFAULT_DIMENSION_INDEX)},t.getInsertColLeftAuthRange=function(){var e=this.getCellIndex(j.mG.COLS,j.mG.LEFT);return new m.GridRange(this.spreadsheet.activeSheetId,m.DEFAULT_DIMENSION_INDEX,m.DEFAULT_DIMENSION_INDEX,Math.max(0,e-1),Math.max(0,e-1))},t.getInsertColRightAuthRange=function(){var e=this.getCellIndex(j.mG.COLS,j.mG.RIGHT);return new m.GridRange(this.spreadsheet.activeSheetId,m.DEFAULT_DIMENSION_INDEX,m.DEFAULT_DIMENSION_INDEX,e,e)},t.getSelectedRowCount=function(){var e,t,n=this.view.canvas.normalSelectData.select;if(n.selectAll||n instanceof p.Z)e=0,t=this.spreadsheet.activeSheet.getRowCount()-1;else{var r=n.yRange;e=r[0],t=r[1]}var o=function(e,t,n){for(var r=0,o=t;o<=n;o++)e.data.isRowHidden(o)||(r+=1);return r}(this.spreadsheet.activeSheet,e,t);return o},t.getSelectedColCount=function(){var e,t,n=this.view.canvas.normalSelectData.select;if(n.selectAll||n instanceof l.Z)e=0,t=this.spreadsheet.activeSheet.getColCount()-1;else{var r=n.xRange;e=r[0],t=r[1]}var o=function(e,t,n){for(var r=0,o=t;o<=n;o++)e.data.isColHidden(o)||(r+=1);return r}(this.spreadsheet.activeSheet,e,t);return o},t.getInsertInput=function(e){var t;return t=e===v.B.INSERT_ROW_ABOVE||e===v.B.INSERT_ROW_BELOW?this.getSelectedRowCount():this.getSelectedColCount(),this.cacheInsertAmount[e]=t,f.createElement(w,{defaultValue:t,onChange:this.onChange.bind(this,e)})},t.onChange=function(e,t){this.cacheInsertAmount[e]=t},t.getCellIndex=function(e,t){var n,r,o,s=null===(r=(n=this.view).getSelection)||void 0===r?void 0:r.call(n).rangeSelections[0];if(!s)return j.pn;if(e===j.mG.ROWS){var a=(o=t===j.mG.ABOVE)?s.startRowIndex:s.endRowIndex;return o?a:a+1}var i=(o=t===j.mG.LEFT)?s.startColIndex:s.endColIndex;return o?i:i+1},t.handleReport=function(e){u.ZP.tdwReport({opername:"doc_excel_editor",module:"excel_edit",action:e,ver12:"new"})},t.handleReportForContextMenu=function(e){u.ZP.tdwReport({module:"excel_menu",opername:"doc_excel_editor",action:e})},t.showLimitDialog=function(){h.dialog.confirm({title:a.ZP.t("插入行列失败"),content:a.ZP.t("已达最大行列限制，建议删除无用行列或新建一个工作表。")})},e}();I=R([(0,i.L)({adapters:[b.L],provide:j.n$}),C(0,c.w),C(1,d.V),S("design:paramtypes",["function"===typeof(r="undefined"!==typeof c.w&&c.w)?r:Object,"function"===typeof(o="undefined"!==typeof d.V&&d.V)?o:Object,"function"===typeof(s="undefined"!==typeof x.Z&&x.Z)?s:Object])],I)},"../spread-sheet/src/external/view/ui-layer/insert-staff-card-ent/insert-staff-card-feature.ts":function(e,t,n){n.r(t),n.d(t,{InsertStaffCardFeature:function(){return v}}),n("../node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),n("../node_modules/core-js/modules/esnext.reflect.metadata.js"),n("../node_modules/@tencent/docs-user-agent/dist/index.js");var r,o,s,a=n("../spread-sheet/src/core/utils/index.ts"),i=n("../node_modules/@tencent/workbench/lib/esm/decorators/class/feature.js"),c=n("../spread-sheet/src/core/view/layout/interface/pc-view.ts"),d=n("../spread-sheet/src/external/view/main/toolbar/defaultHook.ts"),u=(n("../spread-sheet/src/base/util/domain-config.ts"),n("../packages/model/src/cell/metadata/CustomDataType.ts")),l=n("../packages/model/src/spreadsheet/index.ts"),p=n("../spread-sheet/src/core/app/SpreadsheetApp.interface.ts"),f=n("../spread-sheet/src/adapter/SpreadSheetAppAdapter.ts"),m=function(e,t,n,r){var o,s=arguments.length,a=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var i=e.length-1;i>=0;i--)(o=e[i])&&(a=(s<3?o(a):s>3?o(t,n,a):o(t,n))||a);return s>3&&a&&Object.defineProperty(t,n,a),a},h=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},g=function(e,t){return function(n,r){t(n,r,e)}},v=function(){function e(e,t,n){this.app=e,this.view=t,this.spreadsheet=n}var t=e.prototype;return t.insertStaffCard=function(){d.Z.doInsertStaffCard(this.view)},t.hideStaffCard=function(){return!0},t.checkInsertCustomDataTypeDisable=function(){var e=u.ZP.STAFF_CARD,t=this.view.getSelection().activeCell,n=t.rowIndex,r=t.colIndex,o=this.spreadsheet.activeSheet.getCellDataAtPosition(n,r),s=null===o||void 0===o?void 0:o.getMetadata();return!(!s||s.customDataType===e)||!!(null===o||void 0===o?void 0:o.isHyperlink())||!!this.spreadsheet.activeSheet.todoManager.isTodo(n,r)||!a.Z.selection.singleRange(this.app)},e}();v=m([(0,i.L)({adapters:[f.L],name:"InsertMemberCardFeature"}),g(0,p.m),g(1,c.w),g(2,l.ISpreadsheet),h("design:paramtypes",["function"===typeof(r="undefined"!==typeof p.m&&p.m)?r:Object,"function"===typeof(o="undefined"!==typeof c.w&&c.w)?o:Object,"function"===typeof(s="undefined"!==typeof l.ISpreadsheet&&l.ISpreadsheet)?s:Object])],v)},"../spread-sheet/src/external/view/ui-layer/insert-todo-ent/insert-todo-feature.ts":function(e,t,n){n.r(t),n.d(t,{InsertTodoFeature:function(){return w}}),n("../node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),n("../node_modules/core-js/modules/esnext.reflect.metadata.js");var r,o,s,a,i=n("../node_modules/@tencent/workbench/lib/esm/decorators/class/feature.js"),c=n("../spread-sheet/src/core/view/layout/interface/pc-view.ts"),d=n("../spread-sheet/src/core/utils/index.ts"),u=n("../spread-sheet/src/external/view/main/toolbar/defaultHook.ts"),l=n("../packages/model/src/cell/metadata/CustomDataType.ts"),p=n("../packages/model/src/spreadsheet/index.ts"),f=n("../spread-sheet/src/core/app/SpreadsheetApp.interface.ts"),m=n("../spread-sheet/src/core/app/permissions/index.ts"),h=n("../spread-sheet/src/adapter/SpreadSheetAppAdapter.ts"),g=function(e,t,n,r){var o,s=arguments.length,a=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var i=e.length-1;i>=0;i--)(o=e[i])&&(a=(s<3?o(a):s>3?o(t,n,a):o(t,n))||a);return s>3&&a&&Object.defineProperty(t,n,a),a},v=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},y=function(e,t){return function(n,r){t(n,r,e)}},w=function(){function e(e,t,n,r){this.app=e,this.view=t,this.spreadsheet=n,this.premission=r}var t=e.prototype;return t.insertTodo=function(){u.Z.doInsertToto(this.view)},t.checkInsertCustomDataTypeDisable=function(){var e=l.ZP.TODO,t=this.view.getSelection().activeCell,n=t.rowIndex,r=t.colIndex,o=this.spreadsheet.activeSheet,s=o.getCellDataAtPosition(n,r),a=null===s||void 0===s?void 0:s.getMetadata();return!(!a||a.customDataType===e)||!!(null===s||void 0===s?void 0:s.isHyperlink())||!!this.spreadsheet.activeSheet.todoManager.isTodo(n,r)||!d.Z.selection.singleRange(this.app)||!!(0,l.lv)(o,n,r)},t.hideTodoDone=function(){var e=this.getConfigInCell();return!e||!this.premission.sheetStatus.canEdit||!!e.isDone},t.hideTodoUndone=function(){var e=this.getConfigInCell();return!e||!this.premission.sheetStatus.canEdit||!e.isDone},t.markTodoDone=function(){var e=this.getConfigInCell();if(e){var t=e.todoId,n=e.rowIndex,r=e.colIndex;this.view.canvas.todoCenter.markTodoStatus(t,n,r,!0)}},t.markTodoUndone=function(){var e=this.getConfigInCell();if(e){var t=e.todoId,n=e.rowIndex,r=e.colIndex;this.view.canvas.todoCenter.markTodoStatus(t,n,r,!1)}},t.getConfigInCell=function(){var e=this.view.getSelection().activeCell,t=e.rowIndex,n=e.colIndex,r=this.spreadsheet.activeSheet.todoManager.getTodoRange(t,n);if((null===r||void 0===r?void 0:r.todoId)&&r.rowIndex===t&&r.colIndex===n)return r},e}();w=g([(0,i.L)({adapters:[h.L],name:"InsertTodoFeature"}),y(0,f.m),y(1,c.w),y(2,p.ISpreadsheet),y(3,m.H),v("design:paramtypes",["function"===typeof(r="undefined"!==typeof f.m&&f.m)?r:Object,"function"===typeof(o="undefined"!==typeof c.w&&c.w)?o:Object,"function"===typeof(s="undefined"!==typeof p.ISpreadsheet&&p.ISpreadsheet)?s:Object,"function"===typeof(a="undefined"!==typeof m.H&&m.H)?a:Object])],w)},"../spread-sheet/src/external/view/ui-layer/insert/insert-feature.ts":function(e,t,n){n.r(t),n.d(t,{Insert:function(){return i}}),n("../node_modules/core-js/modules/es.object.get-own-property-descriptor.js");var r=n("../node_modules/@tencent/workbench/lib/esm/decorators/class/feature.js"),o=n("../spread-sheet/src/core/data/configService/spreadConfig.ts"),s=n("../spread-sheet/src/adapter/SpreadSheetAppAdapter.ts"),a=function(e,t,n,r){var o,s=arguments.length,a=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var i=e.length-1;i>=0;i--)(o=e[i])&&(a=(s<3?o(a):s>3?o(t,n,a):o(t,n))||a);return s>3&&a&&Object.defineProperty(t,n,a),a},i=function(){function e(){}return e.prototype.isLogin=function(){return!o.q.getConfig("isLogin")},e}();i=a([(0,r.L)({adapters:[s.L]})],i)},"../spread-sheet/src/external/view/ui-layer/keyboard/keyboardFeature.ts":function(e,t,n){n.r(t),n.d(t,{KeyboardFeature:function(){return g}}),n("../node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),n("../node_modules/core-js/modules/esnext.reflect.metadata.js");var r,o,s,a,i=n("../node_modules/@tencent/workbench/lib/esm/decorators/class/feature.js"),c=n("../node_modules/@tencent/workbench/lib/esm/services/mobile-toolbar/mobile-toolbar-service.js"),d=n("../spread-sheet/src/core/app/SpreadsheetApp.interface.ts"),u=n("../spread-sheet/src/adapter/SpreadSheetAppAdapter.ts"),l=n("../spread-sheet/src/core/view/layout/interface/pc-view.ts"),p=n("../spread-sheet/src/core/workbench/common/input-manager-service.ts"),f=function(e,t,n,r){var o,s=arguments.length,a=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var i=e.length-1;i>=0;i--)(o=e[i])&&(a=(s<3?o(a):s>3?o(t,n,a):o(t,n))||a);return s>3&&a&&Object.defineProperty(t,n,a),a},m=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},h=function(e,t){return function(n,r){t(n,r,e)}},g=function(){function e(e,t,n,r){this.app=e,this.view=t,this.mobileToolbarService=n,this.inputManagerService=r}var t=e.prototype;return t.onKeyboardTypeChanged=function(){this.inputManagerService.isInputtingState()?this.hideKeyboard():this.showKeyboard()},t.getKeyboardIcon=function(){return this.inputManagerService.isInputtingState()?"mobile-toolbar-container-inner-keyboard-on":"mobile-toolbar-container-inner-keyboard-off"},t.showKeyboard=function(){var e,t;this.hidePanel(),null===(t=null===(e=this.view.canvas.contextMenuCenter)||void 0===e?void 0:e.contextMenu)||void 0===t||t.hide(),this.view.canvas.inputManager.focus()},t.hideKeyboard=function(){this.hidePanel(),this.view.canvas.inputManager.blur(),this.app.event.toolBar.trigger("hideKeyboard")},t.hidePanel=function(){var e,t;null===(t=null===(e=this.view.canvas.contextMenuCenter)||void 0===e?void 0:e.contextMenu)||void 0===t||t.hide(),this.mobileToolbarService.closePanel()},e}();g=f([(0,i.L)({adapters:[u.L]}),h(0,d.m),h(1,l.w),m("design:paramtypes",["function"===typeof(r="undefined"!==typeof d.m&&d.m)?r:Object,"function"===typeof(o="undefined"!==typeof l.w&&l.w)?o:Object,"function"===typeof(s="undefined"!==typeof c.n&&c.n)?s:Object,"function"===typeof(a="undefined"!==typeof p.Z&&p.Z)?a:Object])],g)},"../spread-sheet/src/external/view/ui-layer/link-range-ent/link-range-feature.ts":function(e,t,n){n.r(t),n.d(t,{LinkRangeFeature:function(){return C}}),n("../node_modules/regenerator-runtime/runtime.js"),n("../node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),n("../node_modules/core-js/modules/esnext.reflect.metadata.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.promise.js");var r,o,s,a,i=n("../node_modules/i18next/dist/esm/i18next.js"),c=n("../node_modules/@tencent/workbench/lib/esm/decorators/class/feature.js"),d=n("../packages/model/src/spreadsheet/index.ts"),u=n("../spread-sheet/src/core/feature/copyPaste/utils/hyperlink-convert.ts"),l=n("../packages/model/src/range/index.ts"),p=(n("../spread-sheet/src/base/util/domain-config.ts"),n("../spread-sheet/src/core/app/sheetStatus/index.ts")),f=n("../packages/model/src/range/hexRangeUtils.ts"),m=n("../spread-sheet/src/external/view/main/panel/rangeSelectionPanel/util.ts"),h=n("../spread-sheet/src/core/view/layout/interface/pc-view.ts"),g=n("../spread-sheet/src/core/feature/Feature.interface.ts"),v=n("../spread-sheet/src/core/feature/copyPaste/interfaces.ts"),y=n("../node_modules/@tencent/dui/lib/components/Snackbar/index.js"),w=n("../packages/report/src/index.ts"),j=n("../node_modules/@tencent/containerized/build/main/index.js"),_=n("../spread-sheet/src/adapter/SpreadSheetAppAdapter.ts"),x=function(e,t,n,r){var o,s=arguments.length,a=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var i=e.length-1;i>=0;i--)(o=e[i])&&(a=(s<3?o(a):s>3?o(t,n,a):o(t,n))||a);return s>3&&a&&Object.defineProperty(t,n,a),a},b=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},R=function(e,t){return function(n,r){t(n,r,e)}},S=function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function a(e){try{c(r.next(e))}catch(t){s(t)}}function i(e){try{c(r.throw(e))}catch(t){s(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,i)}c((r=r.apply(e,t||[])).next())}))},C=function(){function e(e,t,n,r){this.spreadsheet=e,this.sheetStatus=t,this.view=n,this.feature=r}var t=e.prototype;return t.onClick=function(){return S(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t,n,r,o,s,a,c,d,p,h,g,j,_;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=(0,m.uQ)(this.spreadsheet,this.view,{}),n=t[0],r=this.spreadsheet.getActiveSheetId(),o=(0,f.hex2Range)(n,r),s=o.startRowIndex,a=o.endRowIndex,c=o.startColIndex,d=o.endColIndex,p=new l.GridRange({sheetId:r,startRowIndex:s,endRowIndex:a,startColIndex:c,endColIndex:d}),e.next=6,this.view.canvas.modifyLinkBroker.addLinkedRange(p);case 6:return h=e.sent,g=this.spreadsheet.sheetManager.getSheetTitleBySheetId(r),j=this.spreadsheet.getTitle(),e.next=11,(0,u.Ag)(r,h);case 11:return _=e.sent,e.next=14,this.feature.getInstance();case 14:e.sent.copyPaste.doCopyToClipboard({html:"",plain:i.ZP.t("「{{fileName}}」{{sheetName}}的{{rangeString}}区域 - ",{fileName:j,sheetName:g,rangeString:n})+_,type:v.GI.input}),y.default.show({type:"success",message:i.ZP.t("已复制分享链接（{{rangeString}}）",{rangeString:n}),autoClose:!0,closable:!0}),w.ZP.kvrOss({itemname:"xls_rangelink_obtain_rightclickmenu"});case 18:case"end":return e.stop()}}),e,this)})))},t.shouldHide=function(){return(0,m.uQ)(this.spreadsheet,this.view,{}),!0},t.getSelectedRange=function(){return(0,m.uQ)(this.spreadsheet,this.view,{})[0]},e}();C=x([(0,c.L)({adapters:[_.L]}),R(0,d.ISpreadsheet),R(1,p.T),R(2,h.w),R(3,g._),b("design:paramtypes",["function"===typeof(r="undefined"!==typeof d.ISpreadsheet&&d.ISpreadsheet)?r:Object,"function"===typeof(o="undefined"!==typeof p.T&&p.T)?o:Object,"function"===typeof(s="undefined"!==typeof h.w&&h.w)?s:Object,"function"===typeof(a="undefined"!==typeof j.RU&&j.RU)?a:Object])],C)},"../spread-sheet/src/external/view/ui-layer/mention-ent/mention-ent-feature.ts":function(e,t,n){n.r(t),n.d(t,{MentionEntFeature:function(){return h}}),n("../node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),n("../node_modules/core-js/modules/esnext.reflect.metadata.js");var r,o,s=n("../node_modules/@tencent/workbench/lib/esm/decorators/class/feature.js"),a=n("../spread-sheet/src/core/app/SpreadsheetApp.interface.ts"),i=n("../spread-sheet/src/core/view/layout/interface/pc-view.ts"),c=n("../spread-sheet/src/external/report/index.ts"),d=n("../spread-sheet/src/core/view/level-2/todo-ent/utils.ts"),u=n("../spread-sheet/src/base/util/domain-config.ts"),l=n("../spread-sheet/src/adapter/SpreadSheetAppAdapter.ts"),p=function(e,t,n,r){var o,s=arguments.length,a=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var i=e.length-1;i>=0;i--)(o=e[i])&&(a=(s<3?o(a):s>3?o(t,n,a):o(t,n))||a);return s>3&&a&&Object.defineProperty(t,n,a),a},f=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},m=function(e,t){return function(n,r){t(n,r,e)}},h=function(){function e(e,t){this.app=e,this.view=t}var t=e.prototype;return t.handleClick=function(){(0,d.TQ)(this.app)||(0,d.AE)(this.app)||(this.view.canvas.inputManager.toolbarInsertAt(),c.default.kvrOss({itemname:"xls_enterat_toolbar_pc"}))},t.hideMention=function(){return!u.xc},e}();h=p([(0,s.L)({adapters:[l.L]}),m(0,a.m),m(1,i.w),f("design:paramtypes",["function"===typeof(r="undefined"!==typeof a.m&&a.m)?r:Object,"function"===typeof(o="undefined"!==typeof i.w&&i.w)?o:Object])],h)},"../spread-sheet/src/external/view/ui-layer/merge/merge-feature.ts":function(e,t,n){n.r(t),n.d(t,{MergeFeature:function(){return m}}),n("../node_modules/regenerator-runtime/runtime.js"),n("../node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),n("../node_modules/core-js/modules/esnext.reflect.metadata.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.promise.js");var r,o,s=n("../node_modules/@tencent/workbench/lib/esm/decorators/class/feature.js"),a=n("../node_modules/@tencent/workbench/lib/esm/services/toolbar/toolbar-service.js"),i=n("../spread-sheet/src/core/utils/index.ts"),c=n("../spread-sheet/src/core/app/SpreadsheetApp.interface.ts"),d=n("../spread-sheet/src/adapter/SpreadSheetAppAdapter.ts"),u=function(e,t,n,r){var o,s=arguments.length,a=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var i=e.length-1;i>=0;i--)(o=e[i])&&(a=(s<3?o(a):s>3?o(t,n,a):o(t,n))||a);return s>3&&a&&Object.defineProperty(t,n,a),a},l=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},p=function(e,t){return function(n,r){t(n,r,e)}},f=function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function a(e){try{c(r.next(e))}catch(t){s(t)}}function i(e){try{c(r.throw(e))}catch(t){s(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,i)}c((r=r.apply(e,t||[])).next())}))},m=function(){function e(e,t){this.app=e,this.toolbarService=t}var t=e.prototype;return t.toggleMerge=function(){return f(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.isMergedCell()){e.next=5;break}return e.next=3,this.app.requestApi.unmergeCells();case 3:e.next=7;break;case 5:return e.next=7,this.app.requestApi.mergeCells();case 7:this.toolbarService.$forceUpdate();case 8:case"end":return e.stop()}}),e,this)})))},t.isMergedCell=function(){return i.Z.selection.isMergeCell(this.app)},t.hasMergedCell=function(){return i.Z.selection.hasMergeCell(this.app)},t.isMultipleCellsSelected=function(){if(i.Z.selection.isSelectedAll(this.app))return!1;var e=i.Z.selection.getSelectCLs(this.app);return e?!(1===e.cols&&1===e.rows):e},t.isSingleCellSelected=function(){return i.Z.selection.singleRange(this.app)},e}();m=u([(0,s.L)({adapters:[d.L]}),p(0,c.m),l("design:paramtypes",["function"===typeof(r="undefined"!==typeof c.m&&c.m)?r:Object,"function"===typeof(o="undefined"!==typeof a.O&&a.O)?o:Object])],m)},"../spread-sheet/src/external/view/ui-layer/mobile-cell-img/mobile-cell-img-feature.ts":function(e,t,n){n.r(t),n.d(t,{MobileCellImgFeature:function(){return y}}),n("../node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),n("../node_modules/core-js/modules/esnext.reflect.metadata.js");var r,o,s,a=n("../packages/model/src/spreadsheet/index.ts"),i=n("../spread-sheet/src/core/app/SpreadsheetApp.interface.ts"),c=n("../spread-sheet/src/adapter/SpreadSheetAppAdapter.ts"),d=n("../spread-sheet/src/core/view/level-2/link-center/utils/behavior.ts"),u=n("../spread-sheet/src/core/view/level-2/link-center/utils/checker.ts"),l=n("../spread-sheet/src/core/view/layout/interface/pc-view.ts"),p=n("../packages/model/src/embedded/index.ts"),f=n("../packages/report/src/index.ts"),m=n("../node_modules/@tencent/workbench/lib/esm/decorators/class/feature.js"),h=function(e,t,n,r){var o,s=arguments.length,a=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var i=e.length-1;i>=0;i--)(o=e[i])&&(a=(s<3?o(a):s>3?o(t,n,a):o(t,n))||a);return s>3&&a&&Object.defineProperty(t,n,a),a},g=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},v=function(e,t){return function(n,r){t(n,r,e)}},y=function(){function e(e,t,n){this.view=e,this.spreadsheet=t,this.app=n}var t=e.prototype;return t.showOriginImg=function(){var e=this.view.canvas.normalSelectData.activeRow,t=this.view.canvas.normalSelectData.activeCol;e<0||t<0||(0,d.X7)(this.spreadsheet,e,t)},t.toFloatImg=function(){var e,t,n,r,o=this.view.canvas.normalSelectData.activeCol,s=this.view.canvas.normalSelectData.activeRow;if(o<0||s<0)throw new Error("选区状态异常，无法转换浮动图片");f.ZP.tdwReport({opername:"doc_excel_editor",module:"excel_photo",action:"photo_change",ver10:"to_float_photo"});var a=null===(t=null===(e=this.spreadsheet.activeSheet.getCellDataAtPosition(s,o))||void 0===e?void 0:e.getRefIds())||void 0===t?void 0:t[0];a&&(this.app.requestApi.convertImageType(a,p.EMBEDDED_OBJECT_TYPE.IMAGE),null===(r=null===(n=this.view.canvas.shapeEditCenter)||void 0===n?void 0:n.shapeEdit)||void 0===r||r.focus(a))},t.hasImgOrImgLink=function(){var e=this.view.canvas.normalSelectData.activeRow,t=this.view.canvas.normalSelectData.activeCol;return this.hasImg()||(0,u.nu)(this.spreadsheet,e,t)},t.hasImg=function(){var e=this.view.canvas.normalSelectData.activeRow,t=this.view.canvas.normalSelectData.activeCol;return!(e<0||t<0)&&!!this.spreadsheet.activeSheet.getCellImage(e,t)},e}();y=h([(0,m.L)({adapters:[c.L]}),v(0,l.w),v(1,a.ISpreadsheet),v(2,i.m),g("design:paramtypes",["function"===typeof(r="undefined"!==typeof l.w&&l.w)?r:Object,"function"===typeof(o="undefined"!==typeof a.ISpreadsheet&&a.ISpreadsheet)?o:Object,"function"===typeof(s="undefined"!==typeof i.m&&i.m)?s:Object])],y)},"../spread-sheet/src/external/view/ui-layer/mobile-dimension-operate/mobile-dimension-operate-feature.ts":function(e,t,n){n.r(t),n.d(t,{MobileDimensionOperateFeature:function(){return f}}),n("../node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),n("../node_modules/core-js/modules/esnext.reflect.metadata.js");var r,o,s=n("../node_modules/@tencent/workbench/lib/esm/decorators/class/feature.js"),a=n("../node_modules/@tencent/workbench/lib/esm/services/mobile-toolbar/mobile-toolbar-service.js"),i=n("../spread-sheet/src/external/view/schema/mobile-toolbar-schema.ts"),c=n("../spread-sheet/src/core/view/layout/interface/pc-view.ts"),d=n("../spread-sheet/src/adapter/SpreadSheetAppAdapter.ts"),u=function(e,t,n,r){var o,s=arguments.length,a=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var i=e.length-1;i>=0;i--)(o=e[i])&&(a=(s<3?o(a):s>3?o(t,n,a):o(t,n))||a);return s>3&&a&&Object.defineProperty(t,n,a),a},l=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},p=function(e,t){return function(n,r){t(n,r,e)}},f=function(){function e(e,t){this.mobileToolbarService=e,this.view=t}var t=e.prototype;return t.openPanel=function(){this.mobileToolbarService.openPanel(i.w$.INSERT)},t.deleteRow=function(){this.view.canvas.modifyDimensionBroker.removeRow()},t.deleteCol=function(){this.view.canvas.modifyDimensionBroker.removeCol()},e}();f=u([(0,s.L)({adapters:[d.L]}),p(1,c.w),l("design:paramtypes",["function"===typeof(r="undefined"!==typeof a.n&&a.n)?r:Object,"function"===typeof(o="undefined"!==typeof c.w&&c.w)?o:Object])],f)},"../spread-sheet/src/external/view/ui-layer/move-to/move-to-feature.tsx":function(e,t,n){n.r(t),n.d(t,{MoveToFeature:function(){return g}}),n("../node_modules/regenerator-runtime/runtime.js"),n("../node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),n("../node_modules/core-js/modules/esnext.reflect.metadata.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.promise.js");var r,o=n("../node_modules/i18next/dist/esm/i18next.js"),s=n("../node_modules/@tencent/workbench/lib/esm/decorators/class/feature.js"),a=n("../spread-sheet/src/adapter/SpreadSheetAppAdapter.ts"),i=n("../spread-sheet/src/core/app/SpreadsheetApp.interface.ts"),c=n("../spread-sheet/src/external/view/mobile/header/menu/mobileMoreMenu.ts"),d=n("../spread-sheet/src/external/sheet-adapter/smart-sheet-adapter/constants.ts"),u=n("../spread-sheet/src/base/util/appConfig.ts"),l=n("../spread-sheet/src/core/utils/gray.ts"),p=function(e,t,n,r){var o,s=arguments.length,a=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var i=e.length-1;i>=0;i--)(o=e[i])&&(a=(s<3?o(a):s>3?o(t,n,a):o(t,n))||a);return s>3&&a&&Object.defineProperty(t,n,a),a},f=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},m=function(e,t){return function(n,r){t(n,r,e)}},h=function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function a(e){try{c(r.next(e))}catch(t){s(t)}}function i(e){try{c(r.throw(e))}catch(t){s(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,i)}c((r=r.apply(e,t||[])).next())}))},g=function(){function e(e){this.app=e}var t=e.prototype;return t.onMoveTo=function(){return h(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,c.k6)();case 2:e.sent.handleClick();case 4:case"end":return e.stop()}}),e)})))},t.getMoveToContent=function(){return c.Uc.isShowMove?o.ZP.t("移动到..."):o.ZP.t("添加到...")},t.getHideState=function(){return!1===u.Z.getConfig("menu.moveTo")||(0,l.c)()||(0,l.i)()},e}();g=p([(0,s.L)({name:"MoveToFeature",adapters:[a.L,d.dH]}),m(0,i.m),f("design:paramtypes",["function"===typeof(r="undefined"!==typeof i.m&&i.m)?r:Object])],g)},"../spread-sheet/src/external/view/ui-layer/new-file/new-file-service-pc.ts":function(e,t,n){n.r(t),n.d(t,{NewFileServicePC:function(){return w}}),n("../node_modules/core-js/modules/es.object.get-own-property-descriptor.js");var r=n("../node_modules/@tencent/tencent_doc_open_url/dist/index.js"),o=n("../node_modules/@tencent/docs-user-agent/dist/index.js"),s=n.n(o),a=n("../node_modules/qs/lib/index.js"),i=n.n(a),c=n("../node_modules/@tencent/workbench/lib/esm/decorators/class/service.js"),d=n("../spread-sheet/src/core/utils/url.ts"),u=n("../packages/utils/src/safe.ts"),l=n("../node_modules/lodash/isFunction.js"),p=n.n(l),f=n("../packages/report/src/index.ts"),m=n("../spread-sheet/src/external/view/ui-layer/new-file/new-file.interface.ts");function h(e){e&&f.ZP.tdwReport({opername:"doc_excel_editor",module:"excel_drop-menu",action:"new_"+m.Jz[e],ver12:"new"})}var g=n("../spread-sheet/src/base/util/appConfig.ts"),v=function(e,t,n,r){var o,s=arguments.length,a=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var i=e.length-1;i>=0;i--)(o=e[i])&&(a=(s<3?o(a):s>3?o(t,n,a):o(t,n))||a);return s>3&&a&&Object.defineProperty(t,n,a),a},y={NEW_FILE:"//"+g.Z.getConfig("runtime.domainName")+"/cgi-bin/online_docs/createdoc_new",FORM_TEMPLATE_PAGE:"//"+g.Z.getConfig("runtime.domainName")+"/mall/index/form/collect/?from_page=doc_detail_new_form",DEFAULT_TEMPLATE:"//"+g.Z.getConfig("runtime.domainName")+"/mall/index/?from_page=doc_detail_new"},w=function(){function e(){}var t=e.prototype;return t.newFile=function(e){var t=this.getNewFileUrl(e);(0,r.tencentDocOpenUrlForAll)({url:t,wxUrl:"/pages/detail/detail?url="+encodeURIComponent(t)}),h(e)},t.openTemplatePage=function(e){var t,o=this.getTemplatePageUrl(e);p()(null===(t=n.g.external)||void 0===t?void 0:t.openUrl)?n.g.external.openUrl(null,o,null,""):(0,r.tencentDocOpenUrl)(o),h(e)},t.getNewFileUrl=function(e){var t=i().stringify({doc_type:e,folder_id:"",create_type:m.Dj[e],template_id:m.J0[e],title:m.i2[e],hum:1,dont_add_recent:1,xsrf:(0,u.f)(),redirect:1,isMiniProgram:s().isMiniProgram?"1":""});return(0,d._)(y.NEW_FILE,t)},t.getTemplatePageUrl=function(e){return e===m.$e.FORM?y.FORM_TEMPLATE_PAGE:y.DEFAULT_TEMPLATE},e}();w=v([(0,c.t)({provide:m.tj})],w)},"../spread-sheet/src/external/view/ui-layer/new-line/new-line-feature.ts":function(e,t,n){n.r(t),n.d(t,{NewLineFeature:function(){return h}}),n("../node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),n("../node_modules/core-js/modules/esnext.reflect.metadata.js");var r,o,s,a=n("../node_modules/@tencent/containerized/build/main/index.js"),i=n("../node_modules/@tencent/workbench/lib/esm/decorators/class/feature.js"),c=n("../spread-sheet/src/core/behavior/api.interface.ts"),d=n("../spread-sheet/src/adapter/SpreadSheetAppAdapter.ts"),u=n("../spread-sheet/src/core/view/layout/interface/pc-view.ts"),l=n("../spread-sheet/src/core/workbench/common/input-manager-service.ts"),p=function(e,t,n,r){var o,s=arguments.length,a=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var i=e.length-1;i>=0;i--)(o=e[i])&&(a=(s<3?o(a):s>3?o(t,n,a):o(t,n))||a);return s>3&&a&&Object.defineProperty(t,n,a),a},f=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},m=function(e,t){return function(n,r){t(n,r,e)}},h=function(){function e(e,t,n){this.view=e,this.dynamicApi=t,this.inputManagerService=n}var t=e.prototype;return t.handleNewLine=function(){var e=this.view.canvas.inputManager;null===e||void 0===e||e.insertNewLine()},t.handleNewLineShouldHide=function(){return!this.inputManagerService.isInputtingState()},e}();h=p([(0,i.L)({adapters:[d.L]}),m(0,u.w),m(1,c.V),f("design:paramtypes",["function"===typeof(r="undefined"!==typeof u.w&&u.w)?r:Object,"function"===typeof(o="undefined"!==typeof a.RU&&a.RU)?o:Object,"function"===typeof(s="undefined"!==typeof l.Z&&l.Z)?s:Object])],h)},"../spread-sheet/src/external/view/ui-layer/number-format/config.tsx":function(e,t,n){n.d(t,{EL:function(){return f},OY:function(){return d},UK:function(){return p},Uk:function(){return l},_h:function(){return u}});var r,o=n("../node_modules/i18next/dist/esm/i18next.js"),s=n("../spread-sheet/src/external/view/schema/toolbar-schema.ts"),a=n("../spread-sheet/src/external/view/schema/contextmenu-key.ts"),i=n("../spread-sheet/src/external/view/schema/menu-schema.ts"),c=n("../spread-sheet/src/core/workbench/middleware/selection/selection-type.ts"),d=[{name:s.HM.NUMBER_FORMAT,tooltip:o.ZP.t("数据格式"),type:"text",hasArrow:!0,selectionMiddleware:{exclude:[c.R.SHAPE,c.R.CHART]},sheetStatusMiddleware:{isDisabledWhenCannotEdit:!0},privateFillMiddleWareConfig:{shouldCheckWhenCellIsPrivate:!0},inputStatusMiddleWareConfig:{isDisableWhenInput:!0}}],u=[{name:a.B.NUMBER_FORMAT,content:o.ZP.t("设置数据格式"),selectionMiddleware:{exclude:[c.R.SHAPE,c.R.CHART]},sheetStatusMiddleware:{isHiddenWhenCannotEditExceptRangeAuth:!0,isDisableWhenRangeCannotEdit:!0},privateFillMiddleWareConfig:{shouldCheckWhenCellIsPrivate:!0}}];!function(e){e.GENERAL="常规",e.TEXT="文本",e.NUMBER="数值",e.PERCENTAGE="百分比",e.FRACTION="分数",e.SCIENTIFIC_NOTATION="科学计数",e.CURRENCY="货币",e.RMB="人民币",e.HK_DOLLAR="港币",e.DOLLAR="美元",e.DATE="日期",e.TIME="时间",e.SPECIAL="特殊"}(r||(r={}));var l=[{name:i.z_.NUMBER_FORMAT,content:o.ZP.t("数据格式"),description:o.ZP.t("文本/日期"),selectionMiddleware:{exclude:[c.R.SHAPE,c.R.CHART]}},{name:i.z_.TOOLBAR_NUMBER_FORMAT},{name:i.z_.NUMBER_FORMAT_ITEM_0,content:o.ZP.t("常规")},{name:i.z_.NUMBER_FORMAT_ITEM_1,content:o.ZP.t("文本")},{name:i.z_.NUMBER_FORMAT_ITEM_2,content:o.ZP.t("数值"),description:"0.95"},{name:i.z_.NUMBER_FORMAT_ITEM_3,content:o.ZP.t("百分比"),description:"90.00%"},{name:i.z_.NUMBER_FORMAT_ITEM_4,content:o.ZP.t("分数"),description:"1/2"},{name:i.z_.NUMBER_FORMAT_ITEM_5,content:o.ZP.t("科学计数"),description:"9.50E-01"},{name:i.z_.NUMBER_FORMAT_ITEM_6,content:o.ZP.t("人民币"),description:"￥5.00"},{name:i.z_.NUMBER_FORMAT_ITEM_7,content:o.ZP.t("港币"),description:"HK$5.00"},{name:i.z_.NUMBER_FORMAT_ITEM_8,content:o.ZP.t("美元"),description:"$5.00"},{name:i.z_.NUMBER_FORMAT_ITEM_9,content:o.ZP.t("日期"),description:"2018/4/18"},{name:i.z_.NUMBER_FORMAT_ITEM_10,content:o.ZP.t("日期"),description:o.ZP.t("4月18日")},{name:i.z_.NUMBER_FORMAT_ITEM_11,content:o.ZP.t("日期"),description:o.ZP.t("2018年4月")},{name:i.z_.NUMBER_FORMAT_ITEM_12,content:o.ZP.t("日期"),description:o.ZP.t("2018年4月18日")},{name:i.z_.NUMBER_FORMAT_ITEM_13,content:o.ZP.t("日期"),description:"2018/4/18 14:30:30"},{name:i.z_.NUMBER_FORMAT_ITEM_14,content:o.ZP.t("时间"),description:"14:30:30"},{name:i.z_.NUMBER_FORMAT_ITEM_15,content:o.ZP.t("更多格式")}],p={auto:r.GENERAL,text:r.TEXT,number:r.NUMBER,percent:r.PERCENTAGE,fraction:r.FRACTION,scientific:r.SCIENTIFIC_NOTATION,currency:r.CURRENCY,date:r.DATE,"date-time":r.DATE,time:r.TIME,special:r.SPECIAL},f=[{name:i.z_.NUMBER_FORMAT_ITEM_0,text:o.ZP.t("常规")},{name:i.z_.NUMBER_FORMAT_ITEM_1,text:o.ZP.t("文本")},{name:i.z_.NUMBER_FORMAT_ITEM_2,text:o.ZP.t("数值")},{name:i.z_.NUMBER_FORMAT_ITEM_3,text:o.ZP.t("百分比")},{name:i.z_.NUMBER_FORMAT_ITEM_12,text:o.ZP.t("日期")},{name:i.z_.NUMBER_FORMAT_ITEM_15,text:o.ZP.t("更多")}]},"../spread-sheet/src/external/view/ui-layer/number-format/number-format-feature.ts":function(e,t,n){n.r(t),n.d(t,{NumberFormatFeature:function(){return O}}),n("../node_modules/regenerator-runtime/runtime.js"),n("../node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),n("../node_modules/core-js/modules/esnext.reflect.metadata.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.promise.js"),n("../node_modules/core-js/modules/es.function.name.js"),n("../node_modules/core-js/modules/es.array.filter.js"),n("../node_modules/core-js/modules/es.array.find.js");var r,o,s,a=n("../packages/report/src/index.ts"),i=n("../spread-sheet/src/core/utils/index.ts"),c=n("../node_modules/@tencent/tdocs-format-render/lib/index.js"),d=n("../node_modules/@tencent/containerized/build/main/index.js"),u=n("../node_modules/@tencent/workbench/lib/esm/constants/service-name.js"),l=n("../node_modules/@tencent/workbench/lib/esm/decorators/class/feature.js"),p=n("../spread-sheet/src/core/view/layout/interface/pc-view.ts"),f=n("../spread-sheet/src/core/utils/cell.ts"),m=n("../spread-sheet/src/core/app/SpreadsheetApp.interface.ts"),h=n("../spread-sheet/src/core/behavior/api.interface.ts"),g=n("../node_modules/i18next/dist/esm/i18next.js"),v=n("../spread-sheet/src/external/view/schema/menu-schema.ts"),y=v.z_.NUMBER_FORMAT_ITEM_15,w=[{id:v.z_.NUMBER_FORMAT_ITEM_16,name:"4/18/18",pattern:"m/d/yy;@",reportAction:"clk_panel-date-1"},{id:v.z_.NUMBER_FORMAT_ITEM_17,name:"Apr-18",pattern:"[$-409]mmm-yy;@",reportAction:"clk_panel-date-2"},{id:v.z_.NUMBER_FORMAT_ITEM_18,name:"4/18",pattern:"m/d;@",reportAction:"clk_panel-date-3"},{id:v.z_.NUMBER_FORMAT_ITEM_19,name:"2018-04-18",pattern:"yyyy-mm-dd;@",reportAction:"clk_panel-date-4"},{id:v.z_.NUMBER_FORMAT_ITEM_20,name:"2018/04/18",pattern:"yyyy/mm/dd;@",reportAction:"clk_panel-date-5"},{id:v.z_.NUMBER_FORMAT_ITEM_21,name:"2018/4/18 14:30",pattern:"yyyy/m/d h:mm;@",reportAction:"clk_panel-date-6"},{id:v.z_.NUMBER_FORMAT_ITEM_22,name:"14:30",pattern:"h:mm;@",reportAction:"clk_panel-date-7"},{id:v.z_.NUMBER_FORMAT_ITEM_23,name:"18/4/18",pattern:"yy/m/d;@",reportAction:"clk_panel-date-8"},{id:v.z_.NUMBER_FORMAT_ITEM_24,name:"2:30:30 PM",pattern:"[$-409]h:mm:ss AM/PM;@",reportAction:"clk_panel-date-9"}],j=[{id:v.z_.NUMBER_FORMAT_ITEM_0,type:"item",name:g.ZP.t("常规"),groupName:g.ZP.t("常规"),detail:"",selected:!0,pattern:"General",reportAction:"clk_panel-normal"},{id:v.z_.NUMBER_FORMAT_ITEM_1,type:"item",name:g.ZP.t("文本"),groupName:g.ZP.t("文本"),detail:"",selected:!1,pattern:"@",reportAction:"clk_panel-normal"},{id:v.z_.NUMBER_FORMAT_ITEM_2,type:"item",name:g.ZP.t("数值"),groupName:g.ZP.t("数值"),detail:"0.95",pattern:"#,##0.00_ ",selected:!1,reportAction:"clk_panel-number"},{id:v.z_.NUMBER_FORMAT_ITEM_3,type:"item",name:g.ZP.t("百分比"),groupName:g.ZP.t("百分比"),pattern:"0.00%",detail:"90.00%",selected:!1,reportAction:"clk_panel-percect"},{id:v.z_.NUMBER_FORMAT_ITEM_4,type:"item",name:g.ZP.t("分数"),groupName:g.ZP.t("分数"),pattern:"# ?/?",detail:"1/2",selected:!1,reportAction:"clk_panel-fraction"},{id:v.z_.NUMBER_FORMAT_ITEM_5,type:"item",name:g.ZP.t("科学记数"),groupName:g.ZP.t("科学记数"),pattern:"0.00E+00",detail:"9.50E-01",selected:!1,reportAction:"clk_panel-sctf-counting"},{id:v.z_.NUMBER_FORMAT_ITEM_6,type:"item",name:g.ZP.t("人民币"),groupName:g.ZP.t("货币"),pattern:'"¥"#,##0.00_);[Red]\\("¥"#,##0.00\\)',detail:"￥5.00",selected:!1,reportAction:"clk_panel-RMB"},{id:v.z_.NUMBER_FORMAT_ITEM_7,type:"item",name:g.ZP.t("港币"),groupName:g.ZP.t("货币"),pattern:"[$HK$-C04]#,##0.00_);[Red]\\([$HK$-C04]#,##0.00\\)",detail:"HK$5.00",selected:!1,reportAction:"clk_panel-HKD"},{id:v.z_.NUMBER_FORMAT_ITEM_8,type:"item",name:g.ZP.t("美元"),groupName:g.ZP.t("货币"),detail:"$5.00",pattern:"\\$#,##0.00_);[Red]\\(\\$#,##0.00\\)",selected:!1,reportAction:"clk_panel-USD"},{id:v.z_.NUMBER_FORMAT_ITEM_9,type:"item",name:g.ZP.t("日期"),groupName:g.ZP.t("日期"),detail:"2018/4/18",pattern:"yyyy/m/d",selected:!1,reportAction:"clk_panel-Y/M/D"},{id:v.z_.NUMBER_FORMAT_ITEM_10,type:"item",name:g.ZP.t("日期"),groupName:g.ZP.t("日期"),detail:g.ZP.t("4月18日"),pattern:g.ZP.t('m"月"d"日";@'),selected:!1,reportAction:"clk_panel-MD"},{id:v.z_.NUMBER_FORMAT_ITEM_11,type:"item",name:g.ZP.t("日期"),groupName:g.ZP.t("日期"),detail:g.ZP.t("2018年4月"),pattern:g.ZP.t('yyyy"年"m"月";@'),selected:!1,reportAction:"clk_panel-YM"},{id:v.z_.NUMBER_FORMAT_ITEM_12,type:"item",name:g.ZP.t("日期"),groupName:g.ZP.t("日期"),detail:g.ZP.t("2018年4月18日"),pattern:g.ZP.t('yyyy"年"m"月"d"日";@'),selected:!1,reportAction:"clk_panel-YMD"},{id:v.z_.NUMBER_FORMAT_ITEM_13,type:"item",name:g.ZP.t("日期"),groupName:g.ZP.t("日期"),detail:"2018/4/18 14:30:30",pattern:"yyyy/m/d h:mm:ss",selected:!1,reportAction:"clk_panel-YMDHMS"},{id:v.z_.NUMBER_FORMAT_ITEM_14,type:"item",name:g.ZP.t("时间"),groupName:g.ZP.t("时间"),detail:"14:30:30",selected:!1,pattern:"h:mm:ss;@",reportAction:"clk_panel-MS"},{id:v.z_.NUMBER_FORMAT_ITEM_15,type:"item",name:g.ZP.t("更多格式"),groupName:g.ZP.t("更多格式"),detail:"",selected:!1,pattern:y,reportAction:"clk_date",subpanel:w}],_=j[0],x=n("../spread-sheet/src/adapter/SpreadSheetAppAdapter.ts"),b=n("../spread-sheet/src/external/view/ui-layer/number-format/config.tsx"),R=n("../packages/model/src/cell/metadata/CustomDataType.ts"),S=n("../node_modules/@tencent/docs-user-agent/dist/index.js"),C=n.n(S),E=function(e,t,n,r){var o,s=arguments.length,a=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var i=e.length-1;i>=0;i--)(o=e[i])&&(a=(s<3?o(a):s>3?o(t,n,a):o(t,n))||a);return s>3&&a&&Object.defineProperty(t,n,a),a},I=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},M=function(e,t){return function(n,r){t(n,r,e)}},T=function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function a(e){try{c(r.next(e))}catch(t){s(t)}}function i(e){try{c(r.throw(e))}catch(t){s(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,i)}c((r=r.apply(e,t||[])).next())}))},O=function(){function e(e,t,n){this.app=e,this.dynamicApi=t,this.view=n,this.currentSelectedText=_.name,this.defaultNumberFormat=_}var t=e.prototype;return t.setNumberFormat=function(e){return T(this,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.getPanel();case 2:t.sent.show(),e.from===u.v.CONTEXT_MENU?a.ZP.tdwReport({module:"excel_menu",opername:"doc_excel_editor",action:"clk_menu_formatpanel"}):e.from===u.v.MENU&&a.ZP.tdwReport({opername:"doc_excel_editor",module:"excel_drop-menu",action:"format_data_format",ver12:"new"});case 4:case"end":return t.stop()}}),t,this)})))},t.getNumberFormatToolbarText=function(){var e=this.view.getSelectionWithGridRanges();if(e.isChart()||e.isShape())return this.currentSelectedText;var t=this.getNumberFormatFromSelection();if(!t)return this.currentSelectedText=this.defaultNumberFormat.name,this.currentSelectedText;var n=this.getNumberFormatSelectedText(t);return this.currentSelectedText=n||this.defaultNumberFormat.name,this.currentSelectedText},t.shouldMobileBtnChecked=function(e){var t=this.view.getSelectionWithGridRanges();if(t.isChart()||t.isShape())return!1;var n=this.getNumberFormatFromSelection();if(!n)return!1;var r=b.EL.filter((function(t){return t.name===e}));return!!r.length&&r[0].text===b.UK[n.type]},t.handleToolbarMenuItemClick=function(e){return T(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if((n=this.getNumberFormatItemById(e)).id!==y){t.next=7;break}return t.next=4,this.getPanel();case 4:t.sent.show(),t.next=12;break;case 7:return this.currentSelectedText=n.name,t.next=10,this.dynamicApi.getInstance();case 10:t.sent.numberFormat(n.pattern);case 12:a.ZP.tdwReport({opername:"doc_excel_editor",module:"excel_format",action:n.reportAction});case 13:case"end":return t.stop()}}),t,this)})))},t.updateNumberFormateAndRefreshToolbar=function(e){return T(this,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.dynamicApi.getInstance();case 2:t.sent.numberFormat(e);case 4:case"end":return t.stop()}}),t,this)})))},t.shouldDisableNumberFormat=function(){var e,t,n=this.app.view.getSelectionWithGridRanges().activeCell,r=null===(t=null===(e=this.app.spreadsheet.activeSheet.getPrimaryCellDataAtPosition(n.rowIndex,n.colIndex))||void 0===e?void 0:e.getMetadata())||void 0===t?void 0:t.customDataType;return(0,R.jb)(r)},t.shouldGeneralDiabled=function(){var e=i.Z.selection.getActiveCell(this.app),t=null===e||void 0===e?void 0:e.getEffectiveFormat();if(t){var n=t.getNumberFormat();if(n&&!(0,c.isGeneralCell)(n))return!0}return!1},t.getPanel=function(){return T(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!C().isPC){e.next=6;break}return e.next=3,this.view.getCustomFormatPanel();case 3:e.t0=e.sent,e.next=9;break;case 6:return e.next=8,this.view.getNumberFormatPanel();case 8:e.t0=e.sent;case 9:return e.abrupt("return",e.t0);case 10:case"end":return e.stop()}}),e,this)})))},t.getNumberFormatItemById=function(e){return j.find((function(t){return t.id===e}))||this.defaultNumberFormat},t.getNumberFormatFromSelection=function(){return(0,f.getCellFormat)(this.app).getNumberFormat()},t.getNumberFormatSelectedText=function(e){var t=j.find((function(t){return t.pattern===e.pattern}));return t?t.name:b.UK[e.type]||""},e}();O=E([(0,l.L)({name:"NumberFormatFeature",adapters:[x.L]}),M(0,m.m),M(1,h.V),M(2,p.w),I("design:paramtypes",["function"===typeof(r="undefined"!==typeof m.m&&m.m)?r:Object,"function"===typeof(o="undefined"!==typeof d.RU&&d.RU)?o:Object,"function"===typeof(s="undefined"!==typeof p.w&&p.w)?s:Object])],O)},"../spread-sheet/src/external/view/ui-layer/offline-edit/offline-edit-feature.ts":function(e,t,n){n.r(t),n.d(t,{OfflineEditFeature:function(){return m}}),n("../node_modules/regenerator-runtime/runtime.js"),n("../node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),n("../node_modules/core-js/modules/esnext.reflect.metadata.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.promise.js");var r,o,s=n("../node_modules/@tencent/docs-user-agent/dist/index.js"),a=n.n(s),i=n("../node_modules/@tencent/workbench/lib/esm/decorators/class/feature.js"),c=n("../node_modules/@tencent/workbench/lib/esm/services/mobile-menu/mobile-menu-service.js"),d=n("../spread-sheet/src/core/app/SpreadsheetApp.interface.ts"),u=function(e,t,n,r){var o,s=arguments.length,a=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var i=e.length-1;i>=0;i--)(o=e[i])&&(a=(s<3?o(a):s>3?o(t,n,a):o(t,n))||a);return s>3&&a&&Object.defineProperty(t,n,a),a},l=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},p=function(e,t){return function(n,r){t(n,r,e)}},f=function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function a(e){try{c(r.next(e))}catch(t){s(t)}}function i(e){try{c(r.throw(e))}catch(t){s(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,i)}c((r=r.apply(e,t||[])).next())}))},m=function(){function e(e,t){this.app=e,this.mobileMenuService=t,this.isDocCached=!1,this.refreshDocCacheStatus()}var t=e.prototype;return t.inApp=function(){return a().isTencentDocsApp},t.refreshDocCacheStatus=function(){var e;return f(this,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,null===(e=this.app.offlineOpen)||void 0===e?void 0:e.getDocCacheStatus();case 2:return t.t0=t.sent,this.isDocCached=1===t.t0,this.isDocCached&&this.mobileMenuService.isShowing()&&this.mobileMenuService.update(!0),t.abrupt("return",this.isDocCached);case 6:case"end":return t.stop()}}),t,this)})))},t.cacheDoc=function(){var e;return f(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,null===(e=this.app.offlineOpen)||void 0===e?void 0:e.handleCacheDocManualOffline();case 2:n=t.sent,this.isDocCached=n;case 4:case"end":return t.stop()}}),t,this)})))},t.clearCache=function(){var e;return f(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,null===(e=this.app.offlineOpen)||void 0===e?void 0:e.handleClearDocManualOffline();case 2:n=t.sent,this.isDocCached=!n;case 4:case"end":return t.stop()}}),t,this)})))},e}();m=u([(0,i.L)({name:"OfflineEditFeature"}),p(0,d.m),l("design:paramtypes",["function"===typeof(r="undefined"!==typeof d.m&&d.m)?r:Object,"function"===typeof(o="undefined"!==typeof c.B&&c.B)?o:Object])],m)},"../spread-sheet/src/external/view/ui-layer/paste-special/paste-special-feature.tsx":function(e,t,n){n.r(t),n.d(t,{PasteSpecialFeature:function(){return D}});var r,o,s,a=n("../node_modules/@babel/runtime/helpers/esm/createClass.js"),i=(n("../node_modules/regenerator-runtime/runtime.js"),n("../node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),n("../node_modules/core-js/modules/esnext.reflect.metadata.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.promise.js"),n("../node_modules/core-js/modules/es.function.name.js"),n("react")),c=n.n(i),d=n("../node_modules/i18next/dist/esm/i18next.js"),u=n("../node_modules/@tencent/docs-user-agent/dist/index.js"),l=n.n(u),p=n("../node_modules/@tencent/workbench/lib/esm/decorators/class/feature.js"),f=n("../spread-sheet/src/core/app/SpreadsheetApp.interface.ts"),m=n("../spread-sheet/src/adapter/SpreadSheetAppAdapter.ts"),h=n("../spread-sheet/src/core/feature/copyPaste/lib/PasteSpecial/logics/userAction.ts"),g=n("../spread-sheet/src/core/feature/copyPaste/lib/PasteSpecial/logics/pasteTypes.ts"),v=n("../spread-sheet/src/external/view/schema/contextmenu-key.ts"),y=n("../spread-sheet/src/core/ui/dialog/index.ts"),w=n("../spread-sheet/src/core/feature/copyPaste/api/copyPasteAPI.pc.ts"),j=n("../spread-sheet/src/core/feature/Feature.interface.ts"),_=n("../node_modules/@tencent/containerized/build/main/index.js"),x=function(e,t,n,r){var o,s=arguments.length,a=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var i=e.length-1;i>=0;i--)(o=e[i])&&(a=(s<3?o(a):s>3?o(t,n,a):o(t,n))||a);return s>3&&a&&Object.defineProperty(t,n,a),a},b=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},R=function(e,t){return function(n,r){t(n,r,e)}},S=function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function a(e){try{c(r.next(e))}catch(t){s(t)}}function i(e){try{c(r.throw(e))}catch(t){s(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,i)}c((r=r.apply(e,t||[])).next())}))},C=g.bX.MERGESTYLES,E=g.bX.ONLYVALUES,I=g.bX.TRANSPOSE,M=g.bX.KEEPDEFAULT,T=g.bX.CLEARAUTOPARSE,O=((r={})[v.B.KEEP_DEFAULT]=M,r[v.B.MERGE_STYLES]=C,r[v.B.ONLY_VALUES]=E,r[v.B.CLEAR_AUTO_PARSE]=T,r[v.B.TRANSPOSE]=I,r),D=function(){function e(e,t){this.app=e,this.feature=t,this.isClipboardApiDataValid=!1,this.setCopyPasteParam()}var t=e.prototype;return t.execPasteSpecial=function(e){return S(this,void 0,void 0,regeneratorRuntime.mark((function t(){var r,o;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.name!==v.B.PASTE_SPECIAL_HELP){t.next=4;break}y.dialog.confirm({title:d.ZP.t("选择性粘贴帮助"),content:k(),onOk:function(e){return e.preventDefault(),e.stopPropagation(),n.g.focus(),!0}}),t.next=16;break;case 4:return r=this.selectAreaCellRange,o=this.app.feature.copyPaste.copyPasteCache.getCacheData(),t.t0=h.z,t.t1=o,t.t2=A(e),t.t3=r,t.t4=[],t.next=13,this.app.feature.getCopyPaste();case 13:t.t5=t.sent,t.t6={pasteData:t.t1,type:t.t2,pasteRange:t.t3,smartSplitObj:t.t4,copyPaste:t.t5},(0,t.t0)(t.t6);case 16:case"end":return t.stop()}}),t,this)})))},t.getPcButtonDisabledState=function(){return!this.copyPaste||!(0,w.QN)(this.app,this.copyPaste,this.isClipboardApiDataValid).canPaste},t.setCopyPasteParam=function(){return S(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.feature.getInstance();case 2:return t=e.sent,e.next=5,t.getCopyPaste();case 5:return this.copyPaste=e.sent,e.next=8,(0,w.S2)();case 8:this.isClipboardApiDataValid=e.sent;case 9:case"end":return e.stop()}}),e,this)})))},(0,a.Z)(e,[{key:"selectAreaCellRange",get:function(){var e=this.app.view.getSelection();return{xRange:[e.rangeSelections[0].startColIndex,e.rangeSelections[0].endColIndex],yRange:[e.rangeSelections[0].startRowIndex,e.rangeSelections[0].endRowIndex]}}}]),e}();function A(e){return O[e.name]}function k(){var e=l().isMac?"⌘":"Ctrl";return c().createElement("div",{style:{maxWidth:"100%"}},c().createElement("span",null," ",d.ZP.t("若粘贴不成功，请试试快捷键"),d.ZP.t(""+e),d.ZP.t("+V，然后点击右下角")),c().createElement("img",{className:"specail-paste-error-img",src:"data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjQiIGhlaWdodD0iMjQiIHZpZXdCb3g9IjAgMCAyNCAyNCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cGF0aCBkPSJNMjAgMjFIMTB2LTJINWExIDEgMCAwIDEtMS0xVjZhMSAxIDAgMCAxIDEtMWgxdjFINXYxMmg1VjloNVY2aC0xVjVoMWExIDEgMCAwIDEgMSAxdjNoMWwzIDN2OXptLTQtMTFoLTV2MTBoOHYtN2gtM3YtM3ptMSAuNDE1VjEyaDEuNTg1TDE3IDEwLjQxNXpNMTEgM2ExIDEgMCAwIDEgMSAxdjFoMXYySDdWNWgxVjRhMSAxIDAgMCAxIDEtMWgyem0wIDFIOXYxaDJWNHoiIGZpbGw9IiM0NjRENUEiIGZpbGwtcnVsZT0ibm9uemVybyIvPjwvc3ZnPg=="}),c().createElement("span",null,d.ZP.t("，进行选择性粘贴。")))}D=x([(0,p.L)({name:"PasteSpecialFeature",adapters:[m.L]}),R(0,f.m),R(1,j._),b("design:paramtypes",["function"===typeof(o="undefined"!==typeof f.m&&f.m)?o:Object,"function"===typeof(s="undefined"!==typeof _.RU&&_.RU)?s:Object])],D)},"../spread-sheet/src/external/view/ui-layer/paste/paste-feature.ts":function(e,t,n){n.r(t),n.d(t,{PasteFeature:function(){return b}}),n("../node_modules/regenerator-runtime/runtime.js"),n("../node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),n("../node_modules/core-js/modules/esnext.reflect.metadata.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.promise.js");var r,o,s=n("../node_modules/i18next/dist/esm/i18next.js"),a=n("../node_modules/@tencent/workbench/lib/esm/decorators/class/feature.js"),i=n("../node_modules/@tencent/docs-user-agent/dist/index.js"),c=n.n(i),d=n("../node_modules/@tencent/containerized/build/main/index.js"),u=n("../spread-sheet/src/core/app/SpreadsheetApp.interface.ts"),l=n("../spread-sheet/src/adapter/SpreadSheetAppAdapter.ts"),p=n("../spread-sheet/src/core/ui/dialog/index.ts"),f=n("../spread-sheet/src/core/feature/copyPaste/index.ts"),m=n("../spread-sheet/src/core/feature/copyPaste/api/copyPasteAPI.m.ts"),h=n("../spread-sheet/src/core/feature/copyPaste/api/smartSplitAPI.ts"),g=n("../spread-sheet/src/core/feature/copyPaste/lib/smartSplit/SmartSplit.ts"),v=n("../spread-sheet/src/core/feature/Feature.interface.ts"),y=n("../spread-sheet/src/core/feature/copyPaste/api/copyPasteAPI.pc.ts"),w=function(e,t,n,r){var o,s=arguments.length,a=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var i=e.length-1;i>=0;i--)(o=e[i])&&(a=(s<3?o(a):s>3?o(t,n,a):o(t,n))||a);return s>3&&a&&Object.defineProperty(t,n,a),a},j=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},_=function(e,t){return function(n,r){t(n,r,e)}},x=function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function a(e){try{c(r.next(e))}catch(t){s(t)}}function i(e){try{c(r.throw(e))}catch(t){s(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,i)}c((r=r.apply(e,t||[])).next())}))},b=function(){function e(e,t){this.app=e,this.feature=t,this.isClipboardApiDataValid=!1,this.setCopyPasteParam()}var t=e.prototype;return t.paste=function(){return x(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.setCopyPasteParam();case 2:if(t=(0,y.QN)(this.app,this.copyPaste,this.isClipboardApiDataValid),r=t.canPaste,t.visable&&r){e.next=5;break}return e.abrupt("return",p.dialog.confirm({title:s.ZP.t("粘贴提示"),content:s.ZP.t("无法粘贴内容，请试试快捷键 {{key}}+V 。",{key:c().isMac?"⌘":"Ctrl"}),onOk:function(e){return null===e||void 0===e||e.preventDefault(),null===e||void 0===e||e.stopPropagation(),n.g.focus(),!0}}));case 5:f.default.apiDoPaste(this.app);case 6:case"end":return e.stop()}}),e,this)})))},t.pasteMobile=function(){return x(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t,n,r=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=c().isMobilePhone&&(0,h.IK)(this.app),n=!1,t&&(n=(0,h.IK)(this.app,!0)),(0,m.apiDoPasteM)(this.app,{callback:function(e){(0,g.jq)(e,r.app,n)}});case 4:case"end":return e.stop()}}),e,this)})))},t.getPcButtonHideState=function(){return!this.copyPaste||!(0,y.QN)(this.app,this.copyPaste,this.isClipboardApiDataValid).visable},t.setCopyPasteParam=function(){return x(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.feature.getInstance();case 2:return t=e.sent,e.next=5,t.getCopyPaste();case 5:return this.copyPaste=e.sent,e.next=8,(0,y.S2)(this.copyPaste);case 8:this.isClipboardApiDataValid=e.sent;case 9:case"end":return e.stop()}}),e,this)})))},e}();b=w([(0,a.L)({name:"PasteFeature",adapters:[l.L]}),_(0,u.m),_(1,v._),j("design:paramtypes",["function"===typeof(r="undefined"!==typeof u.m&&u.m)?r:Object,"function"===typeof(o="undefined"!==typeof d.RU&&d.RU)?o:Object])],b)},"../spread-sheet/src/external/view/ui-layer/privacy/privacy-feature.ts":function(e,t,n){n.r(t),n.d(t,{PrivacyFeature:function(){return d}}),n("../node_modules/core-js/modules/es.object.get-own-property-descriptor.js");var r,o=n("../node_modules/@tencent/workbench/lib/esm/decorators/class/feature.js"),s=n("../node_modules/@tencent/tencent_doc_open_url/dist/index.js"),a=n("../spread-sheet/src/external/view/ui-layer/titlebar/components/menubar/config.ts"),i=n("../spread-sheet/src/external/view/ui-layer/report-helper.ts"),c=function(e,t,n,r){var o,s=arguments.length,a=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var i=e.length-1;i>=0;i--)(o=e[i])&&(a=(s<3?o(a):s>3?o(t,n,a):o(t,n))||a);return s>3&&a&&Object.defineProperty(t,n,a),a};!function(e){e.CLK_PRIVACY="clk_privacy"}(r||(r={}));var d=function(){function e(){this.handleThirdPartySharingList=function(){(0,i.r)(r.CLK_PRIVACY),(0,s.tencentDocOpenUrl)(a.k.page.thirdPartySharedInformationList)},this.handleThirdAuthorizationManagement=function(){(0,i.r)(r.CLK_PRIVACY),(0,s.tencentDocOpenUrl)(a.k.page.thirdAuthorizationManagement)},this.handlePersonalInfoCollectionList=function(){(0,i.r)(r.CLK_PRIVACY),(0,s.tencentDocOpenUrl)(a.k.page.personalInformationCollectionList)}}return e.prototype.handlePrivacyPolicy=function(){(0,i.r)(r.CLK_PRIVACY),(0,s.tencentDocOpenUrl)(a.k.page.privacyPolicy)},e}();d=c([(0,o.L)({name:"PrivacyFeature"})],d)},"../spread-sheet/src/external/view/ui-layer/private-fill/private-fill-feature.ts":function(e,t,n){n.r(t),n.d(t,{PrivateFillFeature:function(){return p}}),n("../node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),n("../node_modules/core-js/modules/esnext.reflect.metadata.js");var r,o=n("../node_modules/@tencent/workbench/lib/esm/decorators/class/feature.js"),s=n("../spread-sheet/src/core/app/SpreadsheetApp.interface.ts"),a=n("../spread-sheet/src/adapter/SpreadSheetAppAdapter.ts"),i=n("../packages/model/src/grid/index.ts"),c=n("../spread-sheet/src/core/data/configService/spreadConfig.ts"),d=function(e,t,n,r){var o,s=arguments.length,a=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var i=e.length-1;i>=0;i--)(o=e[i])&&(a=(s<3?o(a):s>3?o(t,n,a):o(t,n))||a);return s>3&&a&&Object.defineProperty(t,n,a),a},u=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},l=function(e,t){return function(n,r){t(n,r,e)}},p=function(){function e(e){this.app=e}var t=e.prototype;return t.shouldDisablePrivateFill=function(){if(!this.app.sheetStatus.canEdit)return!0;var e=this.app.view.getSelectionWithGridRanges(),t=e.type,n=e.rangeSelections;return!c.q.getConfig("isOwner")||t!==i.SelectionType.NORMAL||!n[0].isCol},t.isPrivateFillOn=function(){return!this.shouldDisablePrivateFill()&&this.app.sheetStatus.containsPrivateRange()},t.turnOnPrivateFill=function(){this.app.requestApi.setPrivateRange()},t.turnOffPrivateFill=function(){this.app.requestApi.setPrivateRange({isUnset:!0})},e}();p=d([(0,o.L)({name:"PrivateFillFeature",adapters:[a.L]}),l(0,s.m),u("design:paramtypes",["function"===typeof(r="undefined"!==typeof s.m&&s.m)?r:Object])],p)},"../spread-sheet/src/external/view/ui-layer/quick-access-ent/quick-access-feature.ts":function(e,t,n){n.r(t),n.d(t,{QuickAccessFeature:function(){return j}}),n("../node_modules/regenerator-runtime/runtime.js"),n("../node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),n("../node_modules/core-js/modules/esnext.reflect.metadata.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.promise.js");var r,o=n("../node_modules/qs/lib/index.js"),s=n.n(o),a=n("../node_modules/i18next/dist/esm/i18next.js"),i=n("./node_modules/axios/index.js"),c=n.n(i),d=n("../node_modules/@tencent/workbench/lib/esm/decorators/class/feature.js"),u=n("../node_modules/@tencent/workbench/lib/esm/services/menu/menu-service.js"),l=n("../spread-sheet/src/core/data/configService/spreadConfig.ts"),p=n("../packages/report/src/index.ts");!function(e){e[e.kDocTopInfoAdd=1]="kDocTopInfoAdd",e[e.kDocTopInfoDel=2]="kDocTopInfoDel",e[e.kDocTopInfoGet=3]="kDocTopInfoGet"}(r||(r={}));var f,m,h=n("../node_modules/@tencent/dui/lib/components/Snackbar/index.js"),g=n("../spread-sheet/src/core/utils/gray.ts"),v=function(e,t,n,r){var o,s=arguments.length,a=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var i=e.length-1;i>=0;i--)(o=e[i])&&(a=(s<3?o(a):s>3?o(t,n,a):o(t,n))||a);return s>3&&a&&Object.defineProperty(t,n,a),a},y=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},w=function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function a(e){try{c(r.next(e))}catch(t){s(t)}}function i(e){try{c(r.throw(e))}catch(t){s(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,i)}c((r=r.apply(e,t||[])).next())}))};!function(e){e[e.kDocTopInfoAdd=1]="kDocTopInfoAdd",e[e.kDocTopInfoDel=2]="kDocTopInfoDel",e[e.kDocTopInfoGet=3]="kDocTopInfoGet"}(m||(m={}));var j=function(){function e(e){var t=this;this.menuService=e,this.isQuickAccess=!1,this.loadQuickAccessState().then((function(){t.menuService.$forceUpdate()}))}var t=e.prototype;return t.handleClickQuickAccess=function(){var e,t=this;(e=this.isQuickAccess,new Promise((function(t,n){var o=c().create(),i=e?r.kDocTopInfoDel:r.kDocTopInfoAdd;return o({method:"POST",url:"/wedoc/doctopinfo",data:s().stringify({func:i,doc_id:l.q.getConfig("padId")}),headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then((function(r){if(r.data.head&&0===r.data.head.ret){var o=e?a.ZP.t("已将此文档从快速访问移除"):a.ZP.t("已将此文档添加到快速访问");p.ZP.kvrOss({itemname:e?"xls_detailpage_pin":"xls_detailpage_unpin"}),t(o)}else n(r.data.head.ret)}))}))).then((function(e){var r,o;t.isQuickAccess=!t.isQuickAccess,null===(o=null===(r=n.g.tdocs)||void 0===r?void 0:r.updateNativeList)||void 0===o||o.call(r,{target:"toplist"}),h.default.show({type:"success",message:e,autoClose:!0,duration:3e3}),p.ZP.kvrOss({itemname:t.isQuickAccess?"xls_detailpage_pin":"xls_detailpage_unpin"}),p.ZP.tdwReport({module:"more_menu",opername:"doc_editor_topbar_pc",action:"add_to_quickaccess",ver5:t.isQuickAccess?1:2})})).catch((function(e){-36008===e?h.default.show({message:a.ZP.t("快速访问已经到达上限，请移除部分快速访问后再添加"),type:"info",autoClose:!0,duration:3e3}):h.default.show({type:"error",message:a.ZP.t("操作失败"),autoClose:!0,duration:3e3})}))},t.shouldHide=function(){return(0,g.i)()},t.getIsQuickAccessState=function(){return this.isQuickAccess},t.loadQuickAccessState=function(){return w(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t,r=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.isQuickAccess,e.abrupt("return",new Promise((function(e,o){return w(r,void 0,void 0,regeneratorRuntime.mark((function r(){var a,i,d,u;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,c()({method:"POST",url:"/wedoc/doctopinfo",data:s().stringify({func:m.kDocTopInfoGet,doc_id:l.q.getConfig("padId")}),headers:{"Content-Type":"application/x-www-form-urlencoded"}});case 3:u=r.sent,0===(null===(a=u.data.head)||void 0===a?void 0:a.ret)?(t=u.data.body.in_toplist,this.isQuickAccess=t,e(this.isQuickAccess)):o(),null===(i=n.g.log)||void 0===i||i.info("/wedoc/doctopinfo, func="+m.kDocTopInfoGet+",\n                    "+u.data.head.ret+", "+u.data.head.msg),r.next=12;break;case 8:r.prev=8,r.t0=r.catch(0),null===(d=n.g.log)||void 0===d||d.info(r.t0),o(JSON.stringify(r.t0));case 12:case"end":return r.stop()}}),r,this,[[0,8]])})))})));case 2:case"end":return e.stop()}}),e,this)})))},e}();j=v([(0,d.L)({name:"QuickAccessFeature"}),y("design:paramtypes",["function"===typeof(f="undefined"!==typeof u.h&&u.h)?f:Object])],j)},"../spread-sheet/src/external/view/ui-layer/quickfill/quick-fill-feature.ts":function(e,t,n){n.r(t),n.d(t,{QuickFillFeature:function(){return h}}),n("../node_modules/regenerator-runtime/runtime.js"),n("../node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),n("../node_modules/core-js/modules/esnext.reflect.metadata.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.promise.js");var r,o,s=n("../node_modules/i18next/dist/esm/i18next.js"),a=n("../node_modules/@tencent/workbench/lib/esm/decorators/class/feature.js"),i=n("../spread-sheet/src/core/app/SpreadsheetApp.interface.ts"),c=n("../spread-sheet/src/core/app/sheetStatus/index.ts"),d=n("../spread-sheet/src/adapter/SpreadSheetAppAdapter.ts"),u=n("../node_modules/@tencent/dui-mobile/lib/components/Snackbar/index.js"),l=function(e,t,n,r){var o,s=arguments.length,a=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var i=e.length-1;i>=0;i--)(o=e[i])&&(a=(s<3?o(a):s>3?o(t,n,a):o(t,n))||a);return s>3&&a&&Object.defineProperty(t,n,a),a},p=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},f=function(e,t){return function(n,r){t(n,r,e)}},m=function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function a(e){try{c(r.next(e))}catch(t){s(t)}}function i(e){try{c(r.throw(e))}catch(t){s(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,i)}c((r=r.apply(e,t||[])).next())}))},h=function(){function e(e,t){this.app=e,this.sheetStatus=t}var t=e.prototype;return t.openQuickFill=function(e){var t;return m(this,void 0,void 0,regeneratorRuntime.mark((function n(){var r;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(this.allowQuickFill()){n.next=3;break}return this.showQuickFillWarning(),n.abrupt("return");case 3:return n.next=5,null===(t=this.app.feature)||void 0===t?void 0:t.getQuickFill();case 5:null===(r=n.sent)||void 0===r||r.open(),r.report(e);case 8:case"end":return n.stop()}}),n,this)})))},t.allowQuickFill=function(){var e;try{if(!(null===(e=this.app.feature.relateForm)||void 0===e?void 0:e.seeker.isFillAble()))return!1}catch(o){return!1}return!0},t.showQuickFillWarning=function(){u.default.show({type:"info",autoClose:!0,duration:3e3,message:s.ZP.t("ui|quickfill.snackTips")})},e}();h=l([(0,a.L)({adapters:[d.L]}),f(0,i.m),f(1,c.T),p("design:paramtypes",["function"===typeof(r="undefined"!==typeof i.m&&i.m)?r:Object,"function"===typeof(o="undefined"!==typeof c.T&&c.T)?o:Object])],h)},"../spread-sheet/src/external/view/ui-layer/range-auth/range-auth-feature.ts":function(e,t,n){n.r(t),n.d(t,{RangeAuthFeature:function(){return g}}),n("../node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),n("../node_modules/core-js/modules/esnext.reflect.metadata.js"),n("../node_modules/core-js/modules/es.array.sort.js");var r,o,s=n("../node_modules/i18next/dist/esm/i18next.js"),a=n("../node_modules/@tencent/workbench/lib/esm/decorators/class/feature.js"),i=n("../packages/report/src/index.ts"),c=n("../spread-sheet/src/adapter/SpreadSheetAppAdapter.ts"),d=n("../spread-sheet/src/core/app/SpreadsheetApp.interface.ts"),u=n("../spread-sheet/src/core/data/configService/spreadConfig.ts"),l=n("../spread-sheet/src/external/view/ui-layer/range-auth/config.tsx"),p=n("../spread-sheet/src/core/app/sheetStatus/index.ts"),f=function(e,t,n,r){var o,s=arguments.length,a=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var i=e.length-1;i>=0;i--)(o=e[i])&&(a=(s<3?o(a):s>3?o(t,n,a):o(t,n))||a);return s>3&&a&&Object.defineProperty(t,n,a),a},m=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},h=function(e,t){return function(n,r){t(n,r,e)}},g=function(){function e(e,t){var n=this;this.app=e,this.sheetStatus=t,this.checkIfRangeProtected=function(){var e=n.app.serviceCollection.services.get(n.app.serviceCollection.CONFIG.PC_RANGE_AUTH);return(null===e||void 0===e?void 0:e.instance).rangeAuthUtil.getRangeAuthListCrossSelectArea().length>=1},this.checkIfCurrentSheetProtected=function(){var e=n.app.spreadsheet.activeSheetId,t=n.app.serviceCollection.services.get(n.app.serviceCollection.CONFIG.PC_RANGE_AUTH),r=null===t||void 0===t?void 0:t.instance;return""!==(null===r||void 0===r?void 0:r.rangeAuthUtil.getExistSheetRangeIdItem(e))}}var t=e.prototype;return t.protectRange=function(e,t){this.app.event.rangeAuthEvent.trigger(e,t),this.report(e)},t.userIsOwner=function(){return u.q.getConfig("isOwner")},t.showProtectedRange=function(e){var t=this.orderedRangeAuth()[0];this.app.event.rangeAuthEvent.trigger(l.OQ.CHECK_ALL,e,null===t||void 0===t?void 0:t.rangeId)},t.getSelectedRange=function(){var e=this.initRangeAuthInstance();if(e)return e.rangeAuthUtil.parseSelectDataForRangeAuth()},t.getRangeAuthList=function(){var e=this.initRangeAuthInstance();if(e)return e.rangeAuthUtil.getProtectedMap()},t.getRangeAuthListInSelectedRange=function(){var e=this.initRangeAuthInstance();return e?e.rangeAuthUtil.getRangeAuthListCrossSelectArea():[]},t.getFirstRangeAuthText=function(){var e=this.initRangeAuthInstance();if(!e)return"";var t=this.orderedRangeAuth()[0];return t?e.rangeAuthUtil.parseGridRangeText(t.gridRange):""},t.getContext=function(){var e=this.app.serviceCollection.services.get(this.app.serviceCollection.CONFIG.PC_RANGE_AUTH);if(void 0===e)return s.ZP.t("查看已保护范围");var t=e.instance,n=t.rangeAuthUtil.getRangeAuthListCrossSelectArea();if(this.checkIfRangeProtected()){n.sort((function(e,t){return t.modifyTime-e.modifyTime}));var r=n[0],o=t.rangeAuthUtil.parseGridRangeText(r.gridRange);return s.ZP.t("查看已保护范围{{text}}",{text:o})}return this.checkIfCurrentSheetProtected()?s.ZP.t("查看已保护范围（整表）"):s.ZP.t("查看已保护范围")},t.hideProtectRange=function(){return!this.sheetStatus.canEdit},t.orderedRangeAuth=function(){var e=this.getRangeAuthListInSelectedRange();return 0===e.length?[]:(e.sort((function(e,t){return t.modifyTime-e.modifyTime})),e)},t.initRangeAuthInstance=function(){if(this.rangeAuthInstance)return this.rangeAuthInstance;var e=this.app.serviceCollection,t=e.services.get(e.CONFIG.PC_RANGE_AUTH);return t?(this.rangeAuthInstance=t.instance,this.rangeAuthInstance):void 0},t.report=function(e){i.ZP.tdwReport({opername:"doc_excel_editor",module:"excel_rangeauth",action:l.VE[e],ver12:"new"})},e}();g=f([(0,a.L)({adapters:[c.L]}),h(0,d.m),h(1,p.T),m("design:paramtypes",["function"===typeof(r="undefined"!==typeof d.m&&d.m)?r:Object,"function"===typeof(o="undefined"!==typeof p.T&&p.T)?o:Object])],g)},"../spread-sheet/src/external/view/ui-layer/range-to-image-copy/range-to-image-copy-feature.ts":function(e,t,n){n.r(t),n.d(t,{RangeToImageCopyFeature:function(){return g}}),n("../node_modules/regenerator-runtime/runtime.js"),n("../node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),n("../node_modules/core-js/modules/esnext.reflect.metadata.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.promise.js");var r,o,s,a=n("../node_modules/@tencent/workbench/lib/esm/decorators/class/feature.js"),i=n("../spread-sheet/src/core/feature/Feature.interface.ts"),c=n("../node_modules/@tencent/containerized/build/main/index.js"),d=n("../spread-sheet/src/core/app/permissions/index.ts"),u=n("../spread-sheet/src/adapter/SpreadSheetAppAdapter.ts"),l=n("../spread-sheet/src/core/app/spreadsheet-app-worker.interface.ts"),p=function(e,t,n,r){var o,s=arguments.length,a=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var i=e.length-1;i>=0;i--)(o=e[i])&&(a=(s<3?o(a):s>3?o(t,n,a):o(t,n))||a);return s>3&&a&&Object.defineProperty(t,n,a),a},f=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},m=function(e,t){return function(n,r){t(n,r,e)}},h=function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function a(e){try{c(r.next(e))}catch(t){s(t)}}function i(e){try{c(r.throw(e))}catch(t){s(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,i)}c((r=r.apply(e,t||[])).next())}))},g=function(){function e(e,t,n){this.app=e,this.feature=t,this.permissions=n}var t=e.prototype;return t.onClick=function(){return h(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.feature.getInstance();case 2:return t=e.sent,e.next=5,t.getCopyPaste();case 5:e.sent.doRangeToImgCopy();case 6:case"end":return e.stop()}}),e,this)})))},t.shouldHide=function(){return!(this.app.sheetStatus.canCopy&&!this.app.sheetStatus.containsCanNotReadRange())},t.shouleDisabled=function(){return!this.permissions.sheetStatus.workbookStatus.canCopy},e}();g=p([(0,a.L)({adapters:[u.L]}),m(0,l.m),m(1,i._),m(2,d.H),f("design:paramtypes",["function"===typeof(r="undefined"!==typeof l.m&&l.m)?r:Object,"function"===typeof(o="undefined"!==typeof c.RU&&c.RU)?o:Object,"function"===typeof(s="undefined"!==typeof d.H&&d.H)?s:Object])],g)},"../spread-sheet/src/external/view/ui-layer/read-record/read-record-drawer.ts":function(e,t,n){var r,o=n("../node_modules/@babel/runtime/helpers/esm/inheritsLoose.js"),s=(n("../node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),n("../node_modules/core-js/modules/esnext.reflect.metadata.js"),n("../node_modules/@tencent/workbench/lib/esm/decorators/class/service.js")),a=n("../spread-sheet/src/core/workbench/common/base-drawer.tsx"),i=n("../spread-sheet/src/core/app/SpreadsheetApp.interface.ts"),c=n("../spread-sheet/src/core/script-loader/index.ts"),d=n("../spread-sheet/src/core/data/configService/spreadConfig.ts"),u=function(e,t,n,r){var o,s=arguments.length,a=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var i=e.length-1;i>=0;i--)(o=e[i])&&(a=(s<3?o(a):s>3?o(t,n,a):o(t,n))||a);return s>3&&a&&Object.defineProperty(t,n,a),a},l=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},p=function(e,t){return function(n,r){t(n,r,e)}},f=function(e){function t(t){var n;return(n=e.call(this,t,"read-record-drawer")||this).app=t,n.drawerStyle={backgroundColor:"#f8f8f8"},n.afterOpenDrawer=function(){(0,c.$y)("ReadRecord",(function(e){e.show(document.getElementById(n.drawerId),{creatorDomain:d.q.getConfig("creatorDomain"),domainId:d.q.getConfig("domainId"),padId:d.q.getConfig("padId"),userId:d.q.getConfig("uid"),onClose:n.closeDrawer})}))},n.afterCloseDrawer=function(){(0,c.$y)("ReadRecord",(function(e){e.remove()}))},n}return(0,o.Z)(t,e),t}(a.Z);f=u([(0,s.t)(),p(0,i.m),l("design:paramtypes",["function"===typeof(r="undefined"!==typeof i.m&&i.m)?r:Object])],f),t.Z="page-editor"==n.j?f:null},"../spread-sheet/src/external/view/ui-layer/read-record/read-record-feature-mobile.ts":function(e,t,n){n.r(t),n.d(t,{ReadRecordFeatureMobile:function(){return g}}),n("../node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),n("../node_modules/core-js/modules/esnext.reflect.metadata.js");var r,o=n("../node_modules/@tencent/workbench/lib/esm/decorators/class/feature.js"),s=n("../spread-sheet/src/adapter/SpreadSheetAppAdapter.ts"),a=n("../spread-sheet/src/core/data/configService/spreadConfig.ts"),i=n("../packages/report/src/index.ts"),c=n("../node_modules/@tencent/docs-user-agent/dist/index.js"),d=n.n(c),u=n("../node_modules/@tencent/tencent_doc_open_url/dist/index.js"),l=n("../spread-sheet/src/external/sheet-adapter/smart-sheet-adapter/constants.ts"),p=n("../spread-sheet/src/external/view/ui-layer/read-record/read-record-drawer.ts"),f=n("../spread-sheet/src/base/util/appConfig.ts"),m=(n("../spread-sheet/src/base/util/domain-config.ts"),function(e,t,n,r){var o,s=arguments.length,a=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var i=e.length-1;i>=0;i--)(o=e[i])&&(a=(s<3?o(a):s>3?o(t,n,a):o(t,n))||a);return s>3&&a&&Object.defineProperty(t,n,a),a}),h=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},g=function(){function e(e){this.readRecordDrawer=e}var t=e.prototype;return t.showReadRecord=function(){this.showRecord(),i.ZP.tdwReport({opername:"doc_access",module:"view_record",action:"clk_entry"})},t.getShowState=function(){var e=a.q.getConfig("isOwner");return!1!==f.Z.getConfig("menu.visitHistory")&&e},t.showRecord=function(){var e="padId="+a.q.getConfig("padId")+"&domId="+a.q.getConfig("domainId")+"&cd="+a.q.getConfig("creatorDomain");if(d().isMiniProgram)window.wx.miniProgram.navigateTo({url:"/pages/readRecord/readRecord?"+e});else{var t="https://"+f.Z.getConfig("runtime.domainName")+"/tim/docs/components/ReadRecord.html?"+e+"&_wv=3&from=desktop_m";if(d().isTencentDocsApp&&d().isIPad)return void(0,u.tencentDocOpenUrl)(t,"_blank");(0,u.tencentDocOpenUrlForAll)({url:t,style:3})}},e}();g=m([(0,o.L)({name:"ReadRecordFeature",adapters:[s.L,l.dH]}),h("design:paramtypes",["function"===typeof(r="undefined"!==typeof p.Z&&p.Z)?r:Object])],g)},"../spread-sheet/src/external/view/ui-layer/read-record/read-record-feature-pc.ts":function(e,t,n){n.r(t),n.d(t,{ReadRecordFeaturePC:function(){return m}}),n("../node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),n("../node_modules/core-js/modules/esnext.reflect.metadata.js");var r,o=n("../node_modules/i18next/dist/esm/i18next.js"),s=n("../node_modules/@tencent/workbench/lib/esm/decorators/class/feature.js"),a=n("../packages/report/src/index.ts"),i=n("../spread-sheet/src/base/util/appConfig.ts"),c=(n("../spread-sheet/src/base/util/domain-config.ts"),n("../spread-sheet/src/adapter/SpreadSheetAppAdapter.ts")),d=n("../spread-sheet/src/core/data/configService/spreadConfig.ts"),u=n("../spread-sheet/src/external/sheet-adapter/smart-sheet-adapter/constants.ts"),l=n("../spread-sheet/src/external/view/ui-layer/read-record/read-record-drawer.ts"),p=function(e,t,n,r){var o,s=arguments.length,a=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var i=e.length-1;i>=0;i--)(o=e[i])&&(a=(s<3?o(a):s>3?o(t,n,a):o(t,n))||a);return s>3&&a&&Object.defineProperty(t,n,a),a},f=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},m=function(){function e(e){var t=this;this.readRecordDrawer=e,this.closeReadRecord=function(){t.readRecordDrawer.closeDrawer()},this.handleReport=function(){a.ZP.tdwReport({opername:"doc_excel_editor",module:"excel_drop-menu",action:"clk_revision_record",ver12:"new"})}}var t=e.prototype;return t.showReadRecord=function(){this.readRecordDrawer.openDrawer(),this.handleReport()},t.getContent=function(){return o.ZP.t("浏览记录")},t.getShouldHide=function(){var e=d.q.getConfig("isOwner");return!i.Z.getConfig("menu.visitHistory")||!e},e}();m=p([(0,s.L)({name:"ReadRecordFeaturePC",adapters:[c.L,u.dH]}),f("design:paramtypes",["function"===typeof(r="undefined"!==typeof l.Z&&l.Z)?r:Object])],m)},"../spread-sheet/src/external/view/ui-layer/redo/redo-feature.ts":function(e,t,n){n.r(t),n.d(t,{RedoFeature:function(){return _}}),n("../node_modules/regenerator-runtime/runtime.js"),n("../node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),n("../node_modules/core-js/modules/esnext.reflect.metadata.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.promise.js");var r,o,s,a,i=n("../node_modules/@tencent/containerized/build/main/index.js"),c=n("../node_modules/@tencent/workbench/lib/esm/decorators/class/feature.js"),d=n("../spread-sheet/src/core/behavior/api.interface.ts"),u=n("../packages/report/src/index.ts"),l=n("../packages/undoRedoStack/src/index.ts"),p=n("../spread-sheet/src/core/app/SpreadsheetApp.interface.ts"),f=n("../spread-sheet/src/core/view/level-2/filter-center/util.ts"),m=n("../spread-sheet/src/adapter/SpreadSheetAppAdapter.ts"),h=n("../spread-sheet/src/core/workbench/common/input-manager-service.ts"),g=n("../spread-sheet/src/base/util/domain-config.ts"),v=function(e,t,n,r){var o,s=arguments.length,a=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var i=e.length-1;i>=0;i--)(o=e[i])&&(a=(s<3?o(a):s>3?o(t,n,a):o(t,n))||a);return s>3&&a&&Object.defineProperty(t,n,a),a},y=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},w=function(e,t){return function(n,r){t(n,r,e)}},j=function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function a(e){try{c(r.next(e))}catch(t){s(t)}}function i(e){try{c(r.throw(e))}catch(t){s(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,i)}c((r=r.apply(e,t||[])).next())}))},_=function(){function e(e,t,n,r){this.app=e,this.dynamicApi=t,this.undoredoStack=n,this.inputManagerService=r}var t=e.prototype;return t.redo=function(){return j(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.dynamicApi.getInstance();case 2:t=e.sent,this.inputManagerService.checkAndRedo()||t.redo(),u.ZP.tdwReport({opername:"doc_excel_editor",module:"excel_undoredo",action:"clk_redo",ver12:"new"});case 5:case"end":return e.stop()}}),e,this)})))},t.canRedo=function(){if(this.inputManagerService.isInputtingState())return this.inputManagerService.getCanRedo();var e=this.undoredoStack.redoStack;return this.app.sheetStatus.canEdit&&e.length>0||(0,f.bU)(e,this.app)},t.hideUndoMobileToolbar=function(){return!g.xc},e}();_=v([(0,c.L)({adapters:[m.L]}),w(0,p.m),w(1,d.V),w(2,l.vT),y("design:paramtypes",["function"===typeof(r="undefined"!==typeof p.m&&p.m)?r:Object,"function"===typeof(o="undefined"!==typeof i.RU&&i.RU)?o:Object,"function"===typeof(s="undefined"!==typeof l.vT&&l.vT)?s:Object,"function"===typeof(a="undefined"!==typeof h.Z&&h.Z)?a:Object])],_)},"../spread-sheet/src/external/view/ui-layer/relate-form/form-create-feature.ts":function(e,t,n){n.r(t),n.d(t,{FormCreateFeature:function(){return f}});var r,o=n("../node_modules/@babel/runtime/helpers/esm/createClass.js"),s=(n("../node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),n("../node_modules/core-js/modules/esnext.reflect.metadata.js"),n("../node_modules/@tencent/workbench/lib/esm/decorators/class/feature.js")),a=n("../spread-sheet/src/core/data/configService/spreadConfig.ts"),i=n("../spread-sheet/src/adapter/SpreadSheetAppAdapter.ts"),c=n("../spread-sheet/src/core/app/SpreadsheetApp.interface.ts"),d=n("../spread-sheet/src/base/util/appConfig.ts"),u=function(e,t,n,r){var o,s=arguments.length,a=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var i=e.length-1;i>=0;i--)(o=e[i])&&(a=(s<3?o(a):s>3?o(t,n,a):o(t,n))||a);return s>3&&a&&Object.defineProperty(t,n,a),a},l=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},p=function(e,t){return function(n,r){t(n,r,e)}},f=function(){function e(e){this.app=e}var t=e.prototype;return t.createNewForm=function(){this.app.feature.relateForm.handle("new_to_form")},t.convertToForm=function(){this.app.feature.relateForm.handle("convert_to_form")},t.shouldShowCreateNewForm=function(){return!1!==d.Z.getConfig("menu.createForm")&&!this.hasRelatedForm&&a.q.getConfig("isOwner")&&1e3!==a.q.getConfig("srcType")},(0,o.Z)(e,[{key:"hasRelatedForm",get:function(){return this.app.feature.relateForm.getRelatedNumber()>0}}]),e}();f=u([(0,s.L)({name:"FormCreateFeature",adapters:[i.L]}),p(0,c.m),l("design:paramtypes",["function"===typeof(r="undefined"!==typeof c.m&&c.m)?r:Object])],f)},"../spread-sheet/src/external/view/ui-layer/relate-form/form-operation-feature.ts":function(e,t,n){n.r(t),n.d(t,{FormOperationFeature:function(){return f}});var r,o=n("../node_modules/@babel/runtime/helpers/esm/createClass.js"),s=(n("../node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),n("../node_modules/core-js/modules/esnext.reflect.metadata.js"),n("../node_modules/@tencent/workbench/lib/esm/decorators/class/feature.js")),a=n("../spread-sheet/src/adapter/SpreadSheetAppAdapter.ts"),i=n("../spread-sheet/src/core/app/SpreadsheetApp.interface.ts"),c=n("../spread-sheet/src/external/sheet-adapter/smart-sheet-adapter/constants.ts"),d=n("../spread-sheet/src/core/data/configService/spreadConfig.ts"),u=function(e,t,n,r){var o,s=arguments.length,a=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var i=e.length-1;i>=0;i--)(o=e[i])&&(a=(s<3?o(a):s>3?o(t,n,a):o(t,n))||a);return s>3&&a&&Object.defineProperty(t,n,a),a},l=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},p=function(e,t){return function(n,r){t(n,r,e)}},f=function(){function e(e){this.app=e}var t=e.prototype;return t.checkRelatedForm=function(){this.app.feature.relateForm.handle("check_form",this.app.feature.relateForm.getRelatedSheetId())},t.shareRelatedForm=function(){this.app.feature.relateForm.handle("share_form",this.app.feature.relateForm.getRelatedSheetId())},t.checkRelatedFormResultSummary=function(){this.app.feature.relateForm.handle("result_form",this.app.feature.relateForm.getRelatedSheetId())},t.cancelRelatedForm=function(){this.app.feature.relateForm.handle("cancel_form",this.app.feature.relateForm.getRelatedSheetId())},t.shouldShowFormOperations=function(){return this.hasRelatedForm},t.shouldShowCancelForm=function(){return this.hasRelatedForm&&d.q.getConfig("isOwner")},(0,o.Z)(e,[{key:"hasRelatedForm",get:function(){return this.app.feature.relateForm.getRelatedNumber()>0}}]),e}();f=u([(0,s.L)({name:"FormOperationFeature",adapters:[a.L,c.dH]}),p(0,i.m),l("design:paramtypes",["function"===typeof(r="undefined"!==typeof i.m&&i.m)?r:Object])],f)},"../spread-sheet/src/external/view/ui-layer/rename/rename-feature.ts":function(e,t,n){n.r(t),n.d(t,{RenameFeature:function(){return p}}),n("../node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),n("../node_modules/core-js/modules/esnext.reflect.metadata.js");var r,o=n("../node_modules/@tencent/workbench/lib/esm/decorators/class/feature.js"),s=n("../spread-sheet/src/external/view/mobile/header/menu/feature/renameDocument.tsx"),a=n("../spread-sheet/src/adapter/SpreadSheetAppAdapter.ts"),i=n("../spread-sheet/src/core/app/sheetStatus/index.ts"),c=n("../spread-sheet/src/external/sheet-adapter/smart-sheet-adapter/constants.ts"),d=function(e,t,n,r){var o,s=arguments.length,a=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var i=e.length-1;i>=0;i--)(o=e[i])&&(a=(s<3?o(a):s>3?o(t,n,a):o(t,n))||a);return s>3&&a&&Object.defineProperty(t,n,a),a},u=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},l=function(e,t){return function(n,r){t(n,r,e)}},p=function(){function e(e){this.sheetStatus=e}var t=e.prototype;return t.onRename=function(){(0,s.m)(this.sheetStatus.app.spreadsheet.getTitle())},t.shouldHideRename=function(){return!this.sheetStatus.canEdit},e}();p=d([(0,o.L)({name:"RenameFeature",adapters:[a.L,c.dH]}),l(0,i.T),u("design:paramtypes",["function"===typeof(r="undefined"!==typeof i.T&&i.T)?r:Object])],p)},"../spread-sheet/src/external/view/ui-layer/report-helper.ts":function(e,t,n){n.d(t,{c:function(){return s},r:function(){return o}});var r=n("../packages/report/src/index.ts");function o(e){r.ZP.tdwReport({opername:"doc_excel_editor",module:"excel_drop-menu",action:e,ver12:"new"})}function s(e){r.ZP.kvrOss({itemname:"n_excel_insert_view",Channel1:"",Channel2:"toolbar",Extra1:"",biz:"personal"}),r.ZP.kvrOss({itemname:"n_excel_insert_click",Channel1:e,Channel2:"toolbar",Extra1:"",biz:"personal"})}},"../spread-sheet/src/external/view/ui-layer/resize-row-col/resize-row-col-feature.ts":function(e,t,n){n.r(t),n.d(t,{ResizeRowColFeature:function(){return u}}),n("../node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),n("../node_modules/core-js/modules/esnext.reflect.metadata.js");var r,o=n("../node_modules/@tencent/workbench/lib/esm/decorators/class/feature.js"),s=n("../spread-sheet/src/core/view/layout/interface/pc-view.ts"),a=n("../spread-sheet/src/adapter/SpreadSheetAppAdapter.ts"),i=function(e,t,n,r){var o,s=arguments.length,a=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var i=e.length-1;i>=0;i--)(o=e[i])&&(a=(s<3?o(a):s>3?o(t,n,a):o(t,n))||a);return s>3&&a&&Object.defineProperty(t,n,a),a},c=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},d=function(e,t){return function(n,r){t(n,r,e)}},u=function(){function e(e){this.view=e}var t=e.prototype;return t.setRowHeight=function(){this.view.canvas.modifyDimensionBroker.showDialogForRowsSetting()},t.setColWidth=function(){this.view.canvas.modifyDimensionBroker.showDialogForColsSetting()},t.getSetColWidthButtonVisiableState=function(){for(var e=this.view.canvas.normalSelectData.selectQueue,t=0;t<e.length;t++){var n=e[t];if(n.selectCell||n.selectRow)return!1}return!0},t.getSetRowHeightButtonVisiableState=function(){for(var e=this.view.canvas.normalSelectData.selectQueue,t=0;t<e.length;t++){var n=e[t];if(n.selectCell||n.selectCol)return!1}return!0},e}();u=i([(0,o.L)({adapters:[a.L]}),d(0,s.w),c("design:paramtypes",["function"===typeof(r="undefined"!==typeof s.w&&s.w)?r:Object])],u)},"../spread-sheet/src/external/view/ui-layer/row-col-dimension/rowColDimensionFeature.ts":function(e,t,n){n.r(t),n.d(t,{RowColDimensionFeature:function(){return u}}),n("../node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),n("../node_modules/core-js/modules/esnext.reflect.metadata.js"),n("../node_modules/core-js/modules/es.array.map.js");var r,o=n("../node_modules/@tencent/workbench/lib/esm/decorators/class/feature.js"),s=n("../spread-sheet/src/core/view/layout/interface/pc-view.ts"),a=n("../spread-sheet/src/adapter/SpreadSheetAppAdapter.ts"),i=function(e,t,n,r){var o,s=arguments.length,a=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var i=e.length-1;i>=0;i--)(o=e[i])&&(a=(s<3?o(a):s>3?o(t,n,a):o(t,n))||a);return s>3&&a&&Object.defineProperty(t,n,a),a},c=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},d=function(e,t){return function(n,r){t(n,r,e)}},u=function(){function e(e){this.view=e}var t=e.prototype;return t.setRowHeight=function(){this.view.canvas.modifyDimensionBroker.showDialogForRowsSetting()},t.autoSetRowHeight=function(){var e=this.view.canvas.modifyDimensionBroker,t=this.view.getSelection().rangeSelections.map((function(e){return[e.startRowIndex,e.endRowIndex]}));e.setRowHeightAutoFit(t)},t.setColWidth=function(){this.view.canvas.modifyDimensionBroker.showDialogForColsSetting()},t.resetColWidth=function(){var e=this.view.canvas.modifyDimensionBroker,t=this.view.getSelection().rangeSelections.map((function(e){return[e.startColIndex,e.endColIndex]}));e.setColWidthToDefault(t)},t.autoSetColWidth=function(){var e=this.view.canvas.modifyDimensionBroker,t=this.view.getSelection().rangeSelections.map((function(e){return[e.startColIndex,e.endColIndex]}));e.setColWidthAutoFit(t)},t.autoSetRowAndCol=function(){var e=this.view.canvas.modifyDimensionBroker,t=this.view.getSelection(),n=t.rangeSelections.map((function(e){return[e.startColIndex,e.endColIndex]})),r=t.rangeSelections.map((function(e){return[e.startRowIndex,e.endRowIndex]}));e.setRowAndColAutoFit(r,n)},e}();u=i([(0,o.L)({adapters:[a.L],name:"RowColDimensionFeature"}),d(0,s.w),c("design:paramtypes",["function"===typeof(r="undefined"!==typeof s.w&&s.w)?r:Object])],u)},"../spread-sheet/src/external/view/ui-layer/row-col-operation/row-col-operation-feature.ts":function(e,t,n){n.r(t),n.d(t,{ERROR:function(){return C},HelperKey:function(){return c},RowColOperationFeature:function(){return E}}),n("../node_modules/regenerator-runtime/runtime.js"),n("../node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),n("../node_modules/core-js/modules/esnext.reflect.metadata.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.promise.js"),n("../node_modules/core-js/modules/web.dom-collections.for-each.js"),n("../node_modules/core-js/modules/es.array.slice.js");var r,o,s,a,i,c,d=n("../node_modules/@tencent/workbench/lib/esm/decorators/class/feature.js"),u=n("../node_modules/@tencent/workbench/lib/esm/services/mobile-toolbar/mobile-toolbar-service.js"),l=n("../node_modules/@tencent/containerized/build/main/index.js"),p=n("../spread-sheet/src/core/behavior/api.interface.ts"),f=n("../packages/model/src/index.ts"),m=n("../packages/model/src/spreadsheet/Spreadsheet.interface.ts"),h=n("../spread-sheet/src/core/view/layout/interface/pc-view.ts"),g=n("../packages/report/src/index.ts"),v=n("../spread-sheet/src/adapter/SpreadSheetAppAdapter.ts"),y=n("../spread-sheet/src/external/view/schema/mobile-toolbar-schema.ts"),w=n("../spread-sheet/src/core/app/SpreadsheetApp.interface.ts"),j=n("../spread-sheet/src/base/index.ts"),_=n("../spread-sheet/src/external/view/native/native-toolbar/utils.ts"),x=function(e,t,n,r){var o,s=arguments.length,a=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var i=e.length-1;i>=0;i--)(o=e[i])&&(a=(s<3?o(a):s>3?o(t,n,a):o(t,n))||a);return s>3&&a&&Object.defineProperty(t,n,a),a},b=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},R=function(e,t){return function(n,r){t(n,r,e)}},S=function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function a(e){try{c(r.next(e))}catch(t){s(t)}}function i(e){try{c(r.throw(e))}catch(t){s(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,i)}c((r=r.apply(e,t||[])).next())}))},C=-1;!function(e){e.ROWS="rows",e.COLS="cols",e.TOP="top",e.BOTTOM="bottom",e.LEFT="left",e.RIGHT="right"}(c||(c={}));var E=function(){function e(e,t,n,r,o){this.app=e,this.dynamicApi=t,this.view=n,this.spreadsheet=r,this.mobileToolbarService=o}var t=e.prototype;return t.insertRowTop=function(){return S(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.dynamicApi.getInstance();case 2:t=e.sent,(n=this.getCellIndex(c.ROWS,c.TOP,1))!==C&&(t.insertRows([{index:n,amount:1}]),this.handleReportMobile(c.ROWS,c.TOP));case 7:case"end":return e.stop()}}),e,this)})))},t.insertRowBottom=function(){return S(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.dynamicApi.getInstance();case 2:t=e.sent,(n=this.getCellIndex(c.ROWS,c.BOTTOM,1))!==C&&(t.insertRows([{index:n,amount:1}]),this.handleReportMobile(c.ROWS,c.BOTTOM));case 7:case"end":return e.stop()}}),e,this)})))},t.insertColLeft=function(){return S(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.dynamicApi.getInstance();case 2:t=e.sent,(n=this.getCellIndex(c.COLS,c.LEFT,1))!==C&&(t.insertColumns([{index:n,amount:1}]),this.handleReportMobile(c.COLS,c.LEFT));case 7:case"end":return e.stop()}}),e,this)})))},t.insertColRight=function(){return S(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.dynamicApi.getInstance();case 2:t=e.sent,(n=this.getCellIndex(c.COLS,c.RIGHT,1))!==C&&(t.insertColumns([{index:n,amount:1}]),this.handleReportMobile(c.COLS,c.RIGHT));case 7:case"end":return e.stop()}}),e,this)})))},t.insertRowShouldDisabled=function(){var e=this.view.canvas.normalSelectData.selectQueue,t=!1;return e.forEach((function(e){e.selectCol&&(t=!0)})),t},t.insertColShouldDisabled=function(){var e=this.view.canvas.normalSelectData.selectQueue,t=!1;return e.forEach((function(e){e.selectRow&&(t=!0)})),t},t.openViewPanel=function(){var e=this;this.app.event.view.trigger(j.Z.EVENT_NAME.ENTER_INPUT_STATUS),!(0,_.KK)()||(0,_.M4)()?this.mobileToolbarService.openPanel(y.w$.CELL_PROPERTY):setTimeout((function(){return e.app.event.toolBar.trigger("openPanel",{view:2})}),200)},t.getCellIndex=function(e,t,n){var r,o,s=this.spreadsheet.activeSheet,a=[s.getRowCount(),s.getColCount()],i=a[0],d=a[1],u=null===(o=(r=this.view).getSelection)||void 0===o?void 0:o.call(r).rangeSelections[0];if(!u)return C;var l=e===c.ROWS,p=l?u.startRowIndex:u.startColIndex;if(isNaN(p))return C;var m,h=f.Config.MAX_CELL_COUNT;if(l){if(m=t===c.TOP,(i+n)*d<h)return m?p:p+n}else if(m=t===c.LEFT,(d+n)*i<h)return m?p:p+n;return C},t.handleReportMobile=function(e,t,n){void 0===n&&(n=1),g.ZP.tdwReport({opername:"doc_excel_editor",module:"excel_mob_format",action:n>1?"mob_insert_more_"+e:"mob_insert_"+e.slice(0,-1)+"_"+t})},e}();E=x([(0,d.L)({adapters:[v.L]}),R(0,w.m),R(1,p.V),R(2,h.w),R(3,m.V),b("design:paramtypes",["function"===typeof(r="undefined"!==typeof w.m&&w.m)?r:Object,"function"===typeof(o="undefined"!==typeof l.RU&&l.RU)?o:Object,"function"===typeof(s="undefined"!==typeof h.w&&h.w)?s:Object,"function"===typeof(a="undefined"!==typeof m.V&&m.V)?a:Object,"function"===typeof(i="undefined"!==typeof u.n&&u.n)?i:Object])],E)},"../spread-sheet/src/external/view/ui-layer/save-as-template/save-as-template-feature-mobile.ts":function(e,t,n){n.r(t),n.d(t,{SaveAsTemplateFeatureMobile:function(){return h}}),n("../node_modules/regenerator-runtime/runtime.js"),n("../node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),n("../node_modules/core-js/modules/esnext.reflect.metadata.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.promise.js"),n("../node_modules/core-js/modules/es.array.slice.js");var r,o=n("../node_modules/@tencent/workbench/lib/esm/decorators/class/feature.js"),s=n("../spread-sheet/src/core/app/sheetStatus/index.ts"),a=n("../spread-sheet/src/core/data/configService/spreadConfig.ts"),i=n("../spread-sheet/src/core/utils/gray.ts"),c=n("../spread-sheet/src/adapter/SpreadSheetAppAdapter.ts"),d=n("../spread-sheet/src/external/sheet-adapter/smart-sheet-adapter/constants.ts"),u=n("../spread-sheet/src/external/check-slr/sc-lazy-loader.ts"),l=function(e,t,n,r){var o,s=arguments.length,a=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var i=e.length-1;i>=0;i--)(o=e[i])&&(a=(s<3?o(a):s>3?o(t,n,a):o(t,n))||a);return s>3&&a&&Object.defineProperty(t,n,a),a},p=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},f=function(e,t){return function(n,r){t(n,r,e)}},m=function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function a(e){try{c(r.next(e))}catch(t){s(t)}}function i(e){try{c(r.throw(e))}catch(t){s(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,i)}c((r=r.apply(e,t||[])).next())}))},h=function(){function e(e){this.sheetStatus=e}var t=e.prototype;return t.saveAsTemplate=function(){return m(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t,n,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=a.q.getConfig("domainId"),n=a.q.getConfig("padId"),r=a.q.getConfig("title"),e.next=5,(0,u.iK)();case 5:e.sent.showMobileSavaTemplate({title:null===r||void 0===r?void 0:r.slice(0,128),domainId:t,padId:n,canEdit:!0});case 7:case"end":return e.stop()}}),e)})))},t.getDisabledState=function(){var e=this.sheetStatus.canEdit,t=!!a.q.getConfig("viewForbidCopyPrint");return!e&&t},t.getHiddenState=function(){return(0,i.c)()||(0,i.i)()},e}();h=l([(0,o.L)({adapters:[c.L,d.dH]}),f(0,s.T),p("design:paramtypes",["function"===typeof(r="undefined"!==typeof s.T&&s.T)?r:Object])],h)},"../spread-sheet/src/external/view/ui-layer/save-as-template/save-as-template-feature-pc.ts":function(e,t,n){n.r(t),n.d(t,{SaveAsTemplateFeaturePC:function(){return y}}),n("../node_modules/regenerator-runtime/runtime.js"),n("../node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),n("../node_modules/core-js/modules/esnext.reflect.metadata.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.promise.js"),n("../node_modules/core-js/modules/es.array.slice.js");var r,o=n("../node_modules/i18next/dist/esm/i18next.js"),s=n("../node_modules/@tencent/workbench/lib/esm/decorators/class/feature.js"),a=n("../spread-sheet/src/core/data/configService/spreadConfig.ts"),i=n("../packages/report/src/index.ts");!function(e){e.FILE_SAVE="file_save"}(r||(r={}));var c,d=n("../spread-sheet/src/core/app/sheetStatus/index.ts"),u=n("../spread-sheet/src/core/utils/gray.ts"),l=(n("../spread-sheet/src/base/util/domain-config.ts"),n("../spread-sheet/src/adapter/SpreadSheetAppAdapter.ts")),p=n("../spread-sheet/src/external/sheet-adapter/smart-sheet-adapter/constants.ts"),f=n("../spread-sheet/src/external/check-slr/sc-lazy-loader.ts"),m=function(e,t,n,r){var o,s=arguments.length,a=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var i=e.length-1;i>=0;i--)(o=e[i])&&(a=(s<3?o(a):s>3?o(t,n,a):o(t,n))||a);return s>3&&a&&Object.defineProperty(t,n,a),a},h=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},g=function(e,t){return function(n,r){t(n,r,e)}},v=function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function a(e){try{c(r.next(e))}catch(t){s(t)}}function i(e){try{c(r.throw(e))}catch(t){s(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,i)}c((r=r.apply(e,t||[])).next())}))},y=function(){function e(e){this.sheetStatus=e}var t=e.prototype;return t.saveAsTemplate=function(){return v(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t,n,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=a.q.getConfig("domainId"),n=a.q.getConfig("padId"),o=a.q.getConfig("title"),e.next=5,(0,f.iK)();case 5:e.sent.showPCSavaTemplate({title:null===o||void 0===o?void 0:o.slice(0,128),domainId:t,padId:n,canEdit:!0}),i.ZP.tdwReport({opername:"doc_excel_editor",module:"excel_drop-menu",action:r.FILE_SAVE,ver12:"new"});case 8:case"end":return e.stop()}}),e)})))},t.getContent=function(){return o.ZP.t("另存为我的模板")},t.getDisabledState=function(){var e=this.sheetStatus.canEdit,t=!!a.q.getConfig("viewForbidCopyPrint");return!e&&t},t.getHiddenState=function(){return(0,u.c)()||(0,u.i)()},e}();y=m([(0,s.L)({adapters:[l.L,p.dH]}),g(0,d.T),h("design:paramtypes",["function"===typeof(c="undefined"!==typeof d.T&&d.T)?c:Object])],y)},"../spread-sheet/src/external/view/ui-layer/schedule-ent/schedule-feature.ts":function(e,t,n){n.r(t),n.d(t,{InsertScheduleFeature:function(){return w}}),n("../node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),n("../node_modules/core-js/modules/esnext.reflect.metadata.js"),n("../node_modules/@tencent/docs-user-agent/dist/index.js");var r,o,s,a=n("../node_modules/@tencent/workbench/lib/esm/decorators/class/feature.js"),i=n("../spread-sheet/src/core/view/layout/interface/pc-view.ts"),c=n("../spread-sheet/src/external/view/main/toolbar/defaultHook.ts"),d=n("../spread-sheet/src/core/utils/index.ts"),u=n("../spread-sheet/src/core/app/SpreadsheetApp.interface.ts"),l=n("../packages/model/src/spreadsheet/index.ts"),p=n("../packages/model/src/cell/metadata/CustomDataType.ts"),f=(n("../spread-sheet/src/base/util/domain-config.ts"),n("../node_modules/@tencent/dui-mobile/lib/components/ActionSheet/index.js")),m=n("../packages/report/src/index.ts"),h=n("../spread-sheet/src/adapter/SpreadSheetAppAdapter.ts"),g=function(e,t,n,r){var o,s=arguments.length,a=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var i=e.length-1;i>=0;i--)(o=e[i])&&(a=(s<3?o(a):s>3?o(t,n,a):o(t,n))||a);return s>3&&a&&Object.defineProperty(t,n,a),a},v=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},y=function(e,t){return function(n,r){t(n,r,e)}},w=function(){function e(e,t,n){this.app=e,this.view=t,this.spreadsheet=n}var t=e.prototype;return t.insertSchedule=function(){c.Z.doInsertSchedule(this.view,!0)},t.selectSchedule=function(){c.Z.doInsertSchedule(this.view,!1)},t.hideSchedule=function(){return!0},t.checkInsertCustomDataTypeDisable=function(){var e=p.ZP.SCHEDULE,t=this.view.getSelection().activeCell,n=t.rowIndex,r=t.colIndex,o=this.spreadsheet.activeSheet.getCellDataAtPosition(n,r),s=null===o||void 0===o?void 0:o.getMetadata();return!(!s||s.customDataType===e)||!!(null===o||void 0===o?void 0:o.isHyperlink())||!!this.spreadsheet.activeSheet.todoManager.isTodo(n,r)||!d.Z.selection.singleRange(this.app)},t.showScheduleActonsheet=function(){var e=this;f.default.show({onClickAction:function(t){switch(t){case"insert_new_schedule":m.ZP.kvrOss({itemname:"wwdoc_xls_insert_calendar_new_m"}),e.insertSchedule();break;case"insert_existing_schedule":m.ZP.kvrOss({itemname:"wwdoc_xls_insert_calendar_click_m"}),e.selectSchedule()}},containerStyle:{zIndex:10002},options:[{id:"insert_new_schedule",title:"新建日程"},{id:"insert_existing_schedule",title:"从已有日程中选择"}]})},e}();w=g([(0,a.L)({adapters:[h.L]}),y(0,u.m),y(1,i.w),y(2,l.ISpreadsheet),v("design:paramtypes",["function"===typeof(r="undefined"!==typeof u.m&&u.m)?r:Object,"function"===typeof(o="undefined"!==typeof i.w&&i.w)?o:Object,"function"===typeof(s="undefined"!==typeof l.ISpreadsheet&&l.ISpreadsheet)?s:Object])],w)},"../spread-sheet/src/external/view/ui-layer/send-to-pc/send-to-pc-feature.tsx":function(e,t,n){n.r(t),n.d(t,{SendToPcFeature:function(){return C}}),n("../node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),n("../node_modules/core-js/modules/esnext.reflect.metadata.js");var r=n("../node_modules/@tencent/workbench/lib/esm/decorators/class/feature.js"),o=n("../spread-sheet/src/adapter/SpreadSheetAppAdapter.ts"),s=n("../spread-sheet/src/core/app/SpreadsheetApp.interface.ts"),a=n("../packages/report/src/index.ts"),i=(n("../node_modules/core-js/modules/es.array.concat.js"),n("../node_modules/i18next/dist/esm/i18next.js")),c=n("../node_modules/@tencent/dui/lib/components/Snackbar/index.js"),d=n("../spread-sheet/src/external/view/mobile/header/menu/feature/help.ts"),u=n("../spread-sheet/src/core/data/configService/spreadConfig.ts"),l=n("../node_modules/@tencent/docs-user-agent/dist/index.js"),p=n.n(l),f=n("../packages/common-utils/src/index.ts"),m=n("../packages/utils/src/safe.ts"),h=n("../spread-sheet/src/external/view/mobile/header/native-header/utils.ts"),g=(n("../node_modules/@tencent/tencent_doc_open_url/dist/index.js"),n("../spread-sheet/src/base/util/appConfig.ts")),v=n.g,y=!1;function w(){y||(y=!0,$.ajax({type:"get",url:"/cgi-go/common-notify/view",data:{padId:u.q.getConfig("globalPadId"),xsrf:(0,m.f)()},success:function(e){var t;if(y=!1,"string"===typeof e&&(e=JSON.parse(e)),e&&0===e.retcode){var n=(0,f.ej)("utype"),r="https://"+g.Z.getConfig("runtime.domainName")+"/scenario/notify-view.html?userType="+n,o=p().isMiniProgram?"miniProgram":p().isIPad&&p().isTencentDocsApp?"":v.open();p().isTencentDocsApp&&(p().isIPad||(0,h.W)())&&(null===(t=v.mqq)||void 0===t?void 0:t.ui)?v.mqq.ui.openUrl({url:r,target:1,style:3}):"miniProgram"===o?(0,d.Yo)(r):o?o.location=r:v.location.href=r}else c.default.show({type:"error",message:i.ZP.t("操作失败"),autoClose:!0,style:{zIndex:10004}})},error:function(){y=!1,c.default.show({type:"error",message:i.ZP.t("操作失败"),autoClose:!0,style:{zIndex:10004}})}}))}var j,_=n("../spread-sheet/src/core/utils/gray.ts"),x=n("../spread-sheet/src/external/sheet-adapter/smart-sheet-adapter/constants.ts"),b=function(e,t,n,r){var o,s=arguments.length,a=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var i=e.length-1;i>=0;i--)(o=e[i])&&(a=(s<3?o(a):s>3?o(t,n,a):o(t,n))||a);return s>3&&a&&Object.defineProperty(t,n,a),a},R=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},S=function(e,t){return function(n,r){t(n,r,e)}},C=function(){function e(e){this.app=e}var t=e.prototype;return t.onSendToPC=function(){w(),a.ZP.tdwReport({opername:"non_edit",module:"more_menu",action:"send_to_pc_clk"})},t.getHideState=function(){return(0,_.c)()||(0,_.i)()},e}();C=b([(0,r.L)({name:"SendToPCFeature",adapters:[o.L,x.dH]}),S(0,s.m),R("design:paramtypes",["function"===typeof(j="undefined"!==typeof s.m&&s.m)?j:Object])],C)},"../spread-sheet/src/external/view/ui-layer/share-ent/share-feature.ts":function(e,t,n){n.r(t),n.d(t,{ShareFeature:function(){return d}}),n("../node_modules/core-js/modules/es.object.get-own-property-descriptor.js");var r=n("../node_modules/@tencent/docs-user-agent/dist/index.js"),o=n.n(r),s=n("../node_modules/@tencent/workbench/lib/esm/decorators/class/feature.js"),a=n("../spread-sheet/src/core/utils/gray.ts"),i=n("../spread-sheet/src/external/view/ui-layer/titlebar/components/share-btn/share-manager.ts"),c=function(e,t,n,r){var o,s=arguments.length,a=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var i=e.length-1;i>=0;i--)(o=e[i])&&(a=(s<3?o(a):s>3?o(t,n,a):o(t,n))||a);return s>3&&a&&Object.defineProperty(t,n,a),a},d=function(){function e(){}var t=e.prototype;return t.handleClick=function(){(0,i.Ak)((function(){}),{})},t.shouldHide=function(){return!o().isWxWork||(0,a.i)()},e}();d=c([(0,s.L)({name:"ShareFeature"})],d)},"../spread-sheet/src/external/view/ui-layer/share-to-wechat-ent/share-to-wechat-feature.ts":function(e,t,n){n.r(t),n.d(t,{ShareToWechatFeature:function(){return a}}),n("../node_modules/core-js/modules/es.object.get-own-property-descriptor.js");var r=n("../node_modules/@tencent/workbench/lib/esm/decorators/class/feature.js"),o=n("../spread-sheet/src/core/data/configService/spreadConfig.ts"),s=function(e,t,n,r){var o,s=arguments.length,a=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var i=e.length-1;i>=0;i--)(o=e[i])&&(a=(s<3?o(a):s>3?o(t,n,a):o(t,n))||a);return s>3&&a&&Object.defineProperty(t,n,a),a},a=function(){function e(){}return e.prototype.handleClick=function(){var e;null===(e=n.g.SLR)||void 0===e||e.load("ShareToWechat",(function(e){var t,n;(null===(n=null===(t=null===e||void 0===e?void 0:e.default)||void 0===t?void 0:t.getInstance)||void 0===n?void 0:n.call(t)).share({docId:o.q.getConfig("padId"),corpId:o.q.getConfig("corpId"),corpName:o.q.getConfig("corpName"),vid:o.q.getConfig("uid")})}))},e}();a=s([(0,r.L)({name:"ShareToWechatFeature"})],a)},"../spread-sheet/src/external/view/ui-layer/share-url-ent/share-url-feature.ts":function(e,t,n){n.r(t),n.d(t,{ShareUrlFeature:function(){return x}}),n("../node_modules/regenerator-runtime/runtime.js"),n("../node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.promise.js"),n("../node_modules/core-js/modules/es.array.iterator.js"),n("../node_modules/core-js/modules/es.string.iterator.js"),n("../node_modules/core-js/modules/web.dom-collections.iterator.js");var r,o=n("../node_modules/@tencent/docs-user-agent/dist/index.js"),s=n.n(o),a=n("../node_modules/i18next/dist/esm/i18next.js"),i=n("../packages/report/src/index.ts"),c=n("../node_modules/@tencent/workbench/lib/esm/decorators/class/feature.js"),d=n("../packages/common-utils/src/index.ts"),u=n("../spread-sheet/src/core/feature/copyPaste/utils/hyperlink-convert.ts"),l=n("../spread-sheet/src/core/data/configService/spreadConfig.ts"),p=n("../node_modules/@tencent/dui/lib/components/Snackbar/index.js"),f=n("react"),m=n.n(f),h=n("../node_modules/@tencent/dui/lib/components/Button/index.js"),g=n("../spread-sheet/src/base/util/appConfig.ts");function v(e){return m().createElement("div",null,m().createElement("span",null,(0,u.cX)(e)),e&&function(){var e=l.q.getConfig("canModifyAuth"),t=l.q.getConfig("isOwner");return!!g.Z.getConfig("menu.auth")&&!(!e&&!t)}()&&m().createElement(h.default,{type:"plain",size:"small",onClick:y},a.ZP.t("权限管理")))}function y(){n.g.SLR.load("CooperationV2",(function(e){var t=l.q.getConfig("globalPadId"),n=l.q.getConfig("title"),r=l.q.getConfig("corpId"),o=l.q.getConfig("uid");e.init(function(){var e="avd-container",t=document.getElementById(e);return t||((t=document.createElement("div")).id=e,document.body.appendChild(t)),t}(),{thirdAuthPanel:{type:"enterpriseWx",options:{globalPadId:t,title:n,corpId:r,uid:o}}})})),i.ZP.tdwReport({module:"more_menu",opername:"doc_editor_topbar_pc",action:"permission"})}var w={copy:function(e){!function(e){(r=document.createElement("textArea")).value=e,document.body.appendChild(r)}(e),function(){var e,t;s().isIOS?((e=document.createRange()).selectNodeContents(r),(t=window.getSelection()).removeAllRanges(),t.addRange(e),r.setSelectionRange(0,999999)):r.select()}(),setTimeout((function(){document.execCommand("copy"),document.body.removeChild(r)}))}},j=function(e,t,n,r){var o,s=arguments.length,a=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var i=e.length-1;i>=0;i--)(o=e[i])&&(a=(s<3?o(a):s>3?o(t,n,a):o(t,n))||a);return s>3&&a&&Object.defineProperty(t,n,a),a},_=function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function a(e){try{c(r.next(e))}catch(t){s(t)}}function i(e){try{c(r.throw(e))}catch(t){s(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,i)}c((r=r.apply(e,t||[])).next())}))},x=function(){function e(){this.shareUrlClicked=!1}return e.prototype.getShareUrl=function(){return _(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t,n,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.shareUrlClicked){e.next=2;break}return e.abrupt("return");case 2:return this.shareUrlClicked=!0,e.prev=3,e.next=6,Promise.all([(0,u.O1)(l.q.getConfig("padId"),(0,d.IZ)("scode")),(0,u.U)(l.q.getConfig("padId"))]);case 6:t=e.sent,n=t[0],r=t[1],w.copy(n),p.default.show({type:"success",message:v(r),autoClose:!0,duration:3e3}),e.next=16;break;case 13:e.prev=13,e.t0=e.catch(3),p.default.show({type:"error",message:a.ZP.t("获取链接失败"),autoClose:!0,duration:3e3});case 16:i.ZP.tdwReport({module:"more_menu",opername:"doc_editor_topbar_pc",action:"get_link"}),this.shareUrlClicked=!1,i.ZP.kvrOss({itemname:"timeline_share_menu_getlink",biz:"personal",Channel1:"sheet"}),i.ZP.kvrOss({biz:"wxwork",itemname:"doc_reaction_share_success",Extra1:3===l.q.getConfig("userInfo").login_type?1:2,Extra2:1,Extra3:1,Channel1:2,Channel2:s().isMac?"mac":s().isWindows?"win":s().isAndroid?"android":"ios"});case 21:case"end":return e.stop()}}),e,this,[[3,13]])})))},e}();x=j([(0,c.L)({name:"ShareUrlFeature"})],x)},"../spread-sheet/src/external/view/ui-layer/smart-drag/smart-drag-feature.ts":function(e,t,n){n.r(t),n.d(t,{SmartDragFeature:function(){return m}}),n("../node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),n("../node_modules/core-js/modules/esnext.reflect.metadata.js");var r,o,s,a=n("../node_modules/@tencent/workbench/lib/esm/decorators/class/feature.js"),i=n("../node_modules/@tencent/workbench/lib/esm/services/mobile-toolbar/mobile-toolbar-service.js"),c=n("../packages/model/src/spreadsheet/Spreadsheet.interface.ts"),d=n("../spread-sheet/src/adapter/SpreadSheetAppAdapter.ts"),u=n("../spread-sheet/src/core/view/layout/interface/pc-view.ts"),l=function(e,t,n,r){var o,s=arguments.length,a=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var i=e.length-1;i>=0;i--)(o=e[i])&&(a=(s<3?o(a):s>3?o(t,n,a):o(t,n))||a);return s>3&&a&&Object.defineProperty(t,n,a),a},p=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},f=function(e,t){return function(n,r){t(n,r,e)}},m=function(){function e(e,t,n){this.view=e,this.spreadsheet=t,this.mobileToolbarService=n}var t=e.prototype;return t.setSmartDrag=function(){this.mobileToolbarService.closePanel(),this.view.canvas.smartDrag.show()},t.shouldBtnHide=function(){return this.isCellImage()||!this.canSmartFill()},t.shouldBtnDisabled=function(){return this.isSelectColRowAll()},t.isCellImage=function(){var e=this.view.canvas.normalSelectData,t=e.activeRow,n=e.activeCol;return!(n<0||t<0)&&!!this.spreadsheet.activeSheet.getCellImage(t,n)},t.canSmartFill=function(){var e=this.view.canvas;if(!e.normalSelectData)throw new Error("未发现选区");var t=e.normalSelectData.activeCol,n=e.normalSelectData.activeRow,r=this.spreadsheet.activeSheet.getCellDataAtPosition(n,t);return!!r&&!!r.getEffectiveValue()},t.isSelectColRowAll=function(){var e=this.view.canvas;if(!e.normalSelectData)throw new Error("未发现选区");if(1!==e.normalSelectData.selectQueue.length)return!1;var t=e.normalSelectData.selectQueue[0],n=t.selectAll,r=t.selectRow,o=t.selectCol;return n||r||o},e}();m=l([(0,a.L)({name:"SmartDragFeature",adapters:[d.L]}),f(0,u.w),f(1,c.V),p("design:paramtypes",["function"===typeof(r="undefined"!==typeof u.w&&u.w)?r:Object,"function"===typeof(o="undefined"!==typeof c.V&&c.V)?o:Object,"function"===typeof(s="undefined"!==typeof i.n&&i.n)?s:Object])],m)},"../spread-sheet/src/external/view/ui-layer/smart-split/smart-split-feature.ts":function(e,t,n){n.r(t),n.d(t,{SmartSplitFeature:function(){return Z}}),n("../node_modules/regenerator-runtime/runtime.js"),n("../node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),n("../node_modules/core-js/modules/esnext.reflect.metadata.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.promise.js"),n("../node_modules/core-js/modules/es.regexp.exec.js"),n("../node_modules/core-js/modules/es.string.split.js");var r=n("../node_modules/@tencent/workbench/lib/esm/constants/service-name.js"),o=n("../node_modules/@tencent/workbench/lib/esm/decorators/class/feature.js"),s=n("../spread-sheet/src/core/app/SpreadsheetApp.interface.ts"),a=n("../packages/report/src/index.ts"),i=(n("../node_modules/core-js/modules/es.object.assign.js"),n("../node_modules/i18next/dist/esm/i18next.js")),c=n("../spread-sheet/src/base/util/timer.ts"),d=n("./node_modules/axios/index.js"),u=n.n(d),l=n("../packages/model/src/range/index.ts"),p=n("../packages/utils/src/safe.ts"),f=n("../node_modules/@tencent/dui/lib/components/Loading/index.js"),m=(n("../node_modules/core-js/modules/es.string.replace.js"),n("../node_modules/core-js/modules/es.string.trim.js"),n("../node_modules/core-js/modules/es.regexp.constructor.js"),n("../node_modules/core-js/modules/es.regexp.to-string.js"),n("../node_modules/core-js/modules/es.array.map.js"),["[,，、]","[;；]","[|]","[/]","[ \\t\\s]+","\\s*\\.\\s+|\\s+\\.\\s*"]),h=function(e,t){for(var n=function(e,t){for(var n=t.startRowIndex,r=t.endRowIndex,o=t.startColIndex,s="",a=e.spreadsheet.activeSheet,i=n;i<=r;i++){var c=a.getCellDataAtPosition(i,o);s+=(c?c.getEditValue():"")||"",s+=i===r?"":"\n"}return(s=s.replace(/\ufeff/g,"")).replace(/^\n+(.*)?\n+$/,"$1")}(e,t),r=n.split(/\r?\n/),o=r.length,s=[],a=0,i=0;i<m.length;i++){for(var c=0;c<o;c++){var d=r[c].trim().replace(/\ueffe/,"");if(""!==d){var u=new RegExp(m[i]),l=d.split(u);if(l.length<2){s=[],a=0;break}if(0!==a&&(0===a||a!==l.length)){s=[],a=0;break}a=l.length,s.push(l.map((function(e){return e.trim()})))}}if(a>0&&s.length>0)break}return[s,s.length,a,[]]},g=n("../spread-sheet/src/core/feature/smartSplit/smart-split-convert-utils.ts"),v=n("react"),y=n.n(v),w=n("../node_modules/@tencent/dui/lib/components/Modal/index.js"),j=n("../node_modules/@tencent/docs-design-resources/pc/png@2x/cdn-function-export.js"),_={"zh-CN":j.Ov2,"en-US":j.rhN,"zh-HK":j.mbP,zh:j.Ov2,en:j.rhN};function x(){w.Modal.confirm({title:i.ZP.t("提示"),okText:i.ZP.t("我知道了"),cancelText:"",style:{width:"560px"},content:y().createElement("div",{style:{width:"100%"}},y().createElement("div",{style:{textAlign:"left"}},i.ZP.t("请选择带有姓名、电话、地址、身份证号码、空格等文本区域再进行智能分列，可用于整理接龙信息、报名统计、团购订单汇总等。")),y().createElement("div",{style:{margin:"24px 0 0 0",display:"flex",justifyContent:"center",alignItems:"center"}},y().createElement("img",{style:{maxWidth:"100%"},src:_[i.ZP.language||"zh-CN"]()})))})}var b=n("../spread-sheet/src/core/utils/index.ts"),R=n("../packages/model/src/index.ts");function S(e,t){for(var n=t.startRowIndex,r=t.endRowIndex,o=t.startColIndex,s=t.endColIndex,a=n,i=r,c=n;c<=r;c++)if(!b.Z.cell.isSingleCellBlank(e,c,o)){a=c;break}for(var d=r;d>=a;d--)if(!b.Z.cell.isSingleCellBlank(e,d,o)){i=d;break}return new l.GridRange(t.sheetId,a,i,o,s)}function C(e,t,n,r){var o=[];if(n<1||r<1)return o;var s=function(e,t,n){for(var r=e.spreadsheet.activeSheet,o=r.getRowCount()-1,s=r.getColCount()-1,a=r.getBasicFilter(),i=(null===a||void 0===a?void 0:a.getHiddenRows())||[],c=t.startRowIndex,d=t.endRowIndex,u=t.startColIndex,l=t.endColIndex,p=0;p<n;p++)for(var f=c+p,m=0;m<l-u+1;m++){var h=u+m;if(-1===i.indexOf(f)){if(f>o||h>s)return{insertRowIndex:f,insertRowNum:n-p};var g=b.Z.cell.isRangeCellBlank(e,f,h);if(f<=d&&h<=l&&(g=!0),!g)return{insertRowIndex:f,insertRowNum:n-p}}}return{insertRowIndex:c,insertRowNum:0}}(e,t,n),a=s.insertRowIndex,i=s.insertRowNum,c=function(e){for(var t=e.app,n=e.range,r=e.rowLen,o=e.colLen,s=e.insertRowIndex,a=e.insertRowNum,i=t.spreadsheet.activeSheet,c=i.getRowCount()-1,d=i.getColCount()-1,u=n.startRowIndex,l=n.startColIndex,p=o-1,f=0;f<p;f++)for(var m=l+1+f,h=0;h<r;h++){var g=u+h;if(!(a>0&&g>=s)){if(g>c||m>d)return{insertColIndex:m,insertColNum:p-f};if(!b.Z.cell.isRangeCellBlank(t,g,m))return{insertColIndex:m,insertColNum:p-f}}}return{insertColIndex:l,insertColNum:0}}({app:e,rowLen:n,colLen:r,range:t,insertRowIndex:a,insertRowNum:i}),d=c.insertColIndex,u=c.insertColNum;return i>0&&o.push({type:R.Dimension.DIMENSION_TYPE.ROWS,index:a,amount:i}),u>0&&o.push({type:R.Dimension.DIMENSION_TYPE.COLUMNS,index:d,amount:u}),o}function E(e){var t=e.view.getSelection().rangeSelections[0],n=t.startRowIndex,r=t.endRowIndex,o=t.startColIndex,s=t.endColIndex;if(o!==s)return!1;for(var a=!0,i=!0,c=n;c<=r;c++)if(a&&!b.Z.cell.isSingleCellBlank(e,c,s)&&(a=!1),i&&!b.Z.cell.getCellDataDVAtPosition(e,c,s)&&(i=!1),!a&&!i)return!0;return!1}var I,M=n("../spread-sheet/src/core/feature/copyPaste/lib/smartSplit/transformDataSP.ts"),T=n("../spread-sheet/src/base/util/appConfig.ts"),O=function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function a(e){try{c(r.next(e))}catch(t){s(t)}}function i(e){try{c(r.throw(e))}catch(t){s(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,i)}c((r=r.apply(e,t||[])).next())}))},D=function(){function e(e){this.app=e,this.isFinished=!1,this.loadingController=null}var t=e.prototype;return t.split=function(){return O(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t,n=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!E(this.app)){e.next=10;break}if(c.Z.wait(2e3).run((function(){n.isFinished||n.showLoadingMask()})),t=this.app.view.getSelection().rangeSelections[0],this.cachedRange=S(this.app,t),this.tryLocalSplit()){e.next=10;break}return e.next=8,this.tryAISplit();case 8:e.sent||this.applyFailedTips();case 10:case"end":return e.stop()}}),e,this)})))},t.tryAISplit=function(){return O(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getSmartSplitDataFromServer();case 2:if(t=e.sent){e.next=5;break}return e.abrupt("return",!1);case 5:return e.abrupt("return",this.tryParseDataAndApplyResult(t));case 6:case"end":return e.stop()}}),e,this)})))},t.tryParseDataAndApplyResult=function(e){var t=(0,g.x)(e.ssodata),n=(0,g.x)(null===t||void 0===t?void 0:t.result);if(0!==(null===t||void 0===t?void 0:t.code)||!(null===n||void 0===n?void 0:n.length))return!1;var r=n[0],o=r.startRow,s=r.endRow,a=r.startCol,i=r.endCol;if([o,s,a,i].some((function(e){return"number"!==typeof e})))return!1;var c=this.cachedRange,d=c.startRowIndex,u=c.startColIndex,p=c.sheetId,f=new l.GridRange(p,d+o,d+s,u+a,u+i);if(function(e,t){for(var n=t.startRowIndex,r=t.endRowIndex,o=t.startColIndex,s=t.endColIndex,a=n;a<=r;a++)for(var i=o;i<=s;i++)if(b.Z.cell.getCellDataDVAtPosition(e,a,i))return!0;return!1}(this.app,f))return!1;var m=(0,M.U)(n,["startRow","endRow","startCol","endCol"]),h=m[1],v=m[2];return!(h<1||v<1)&&(this.applyDataChanges(f,m),!0)},t.getSmartSplitDataFromServer=function(){return O(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t,r,o,s,a,i,c,d,l,f=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.cachedRange,r=t.startRowIndex,o=t.endRowIndex,s=t.startColIndex,a=t.endColIndex,i=(0,g.u)(t,(function(e,t){return f.app.spreadsheet.activeSheet.getCellDataAtPosition(e,t)})),(c=new FormData).append("type","textanalysis.autocolumn"),c.append("data",JSON.stringify({function:"right_click_split",docID:n.g.spreadConfig.getConfig("collabClientVars").client.upid,rowLen:o-r+1,colLen:a-s+1,table:i})),c.append("xsrf",(0,p.f)()),e.prev=7,e.next=10,u().post("//"+T.Z.getConfig("runtime.domainName")+"/cgi-bin/online_docs/ai_autocolumn",c,{withCredentials:!0});case 10:return d=e.sent,l=d.data,e.abrupt("return",l);case 15:return e.prev=15,e.t0=e.catch(7),e.abrupt("return",null);case 18:case"end":return e.stop()}}),e,this,[[7,15]])})))},t.tryLocalSplit=function(){var e=h(this.app,this.cachedRange),t=e[1],n=e[2];return!(t<1||n<1)&&(this.applyDataChanges(this.cachedRange,e),!0)},t.applyDataChanges=function(e,t){var n,r=t[1],o=t[2];if(r>0&&o>0){var s=(0,M.pd)(t),i=function(e,t){for(var n=[],r=0;r<e.length;r++){var o=e[r];if(o.amount>0){var s=o.index,a=o.index+o.amount-1,i=o.type,c=new l.DimensionRange(t,s,a,i);n.push(c)}}return n}(C(this.app,e,r,o),this.cachedRange.sheetId);i.length>0&&(s=Object.assign({infoDimension:{insertDimensionRanges:i}},s));var c={xRange:[e.startColIndex,e.endColIndex],yRange:[e.startRowIndex,e.endRowIndex]};null===(n=this.app.feature.copyPaste)||void 0===n||n.doPaste({pasteData:s,selectAreaCellRange:c,cb:function(){},envs:{clearRangeContent:e}}),a.ZP.tdwReport({opername:"doc_excel_editor",module:"excel_manual_split",action:"split_success"})}this.finishSplit()},t.applyFailedTips=function(){x(),this.finishSplit(),a.ZP.tdwReport({opername:"doc_excel_editor",module:"excel_manual_split",action:"split_fail"})},t.showLoadingMask=function(){this.app.view.canvas.inputManager.hide(),this.loadingController=f.Loading.show({tip:i.ZP.t("正在智能分列...")})},t.closeLoadingMask=function(){var e;null===(e=this.loadingController)||void 0===e||e.close(),this.loadingController=null},t.finishSplit=function(){this.isFinished=!0,this.closeLoadingMask()},e}(),A=n("../spread-sheet/src/adapter/SpreadSheetAppAdapter.ts"),k=n("../spread-sheet/src/external/view/ui-layer/report-helper.ts"),P=function(e,t,n,r){var o,s=arguments.length,a=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var i=e.length-1;i>=0;i--)(o=e[i])&&(a=(s<3?o(a):s>3?o(t,n,a):o(t,n))||a);return s>3&&a&&Object.defineProperty(t,n,a),a},N=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},L=function(e,t){return function(n,r){t(n,r,e)}},F=function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function a(e){try{c(r.next(e))}catch(t){s(t)}}function i(e){try{c(r.throw(e))}catch(t){s(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,i)}c((r=r.apply(e,t||[])).next())}))},Z=function(){function e(e){this.app=e,this.smartSplitService=new D(e)}var t=e.prototype;return t.smartSplit=function(e){return F(this,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:E(this.app)?this.smartSplitService.split():(x(),this.reportNotSplit()),this.reportSmartSplit(e.from);case 2:case"end":return t.stop()}}),t,this)})))},t.reportSmartSplit=function(e){e===r.v.MENU?(a.ZP.jank.log({moduleValue:"smartSplit",actionValue:"calc"}),(0,k.r)("smart_tool_split")):e===r.v.CONTEXT_MENU&&a.ZP.tdwReport({opername:"doc_excel_editor",module:"excel_manual_split",action:"clk_menu"})},t.reportNotSplit=function(){a.ZP.tdwReport({opername:"doc_excel_editor",module:"excel_manual_split",action:"not_split"})},e}();Z=P([(0,o.L)({name:"SmartSplitFeature",adapters:[A.L]}),L(0,s.m),N("design:paramtypes",["function"===typeof(I="undefined"!==typeof s.m&&s.m)?I:Object])],Z)},"../spread-sheet/src/external/view/ui-layer/sort/sort-feature.tsx":function(e,t,n){n.r(t),n.d(t,{SortFeature:function(){return g}}),n("../node_modules/regenerator-runtime/runtime.js"),n("../node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),n("../node_modules/core-js/modules/esnext.reflect.metadata.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.promise.js");var r,o,s=n("../node_modules/@tencent/workbench/lib/esm/decorators/class/feature.js"),a=n("../node_modules/@tencent/ioc/lib/esm/index.js"),i=n("../spread-sheet/src/core/view/layout/interface/pc-view.ts"),c=n("../spread-sheet/src/core/app/SpreadsheetApp.interface.ts"),d=n("../spread-sheet/src/core/data/configService/spreadConfig.ts"),u=n("../packages/model/src/range/index.ts"),l=n("../spread-sheet/src/adapter/SpreadSheetAppAdapter.ts"),p=function(e,t,n,r){var o,s=arguments.length,a=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var i=e.length-1;i>=0;i--)(o=e[i])&&(a=(s<3?o(a):s>3?o(t,n,a):o(t,n))||a);return s>3&&a&&Object.defineProperty(t,n,a),a},f=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},m=function(e,t){return function(n,r){t(n,r,e)}},h=function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function a(e){try{c(r.next(e))}catch(t){s(t)}}function i(e){try{c(r.throw(e))}catch(t){s(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,i)}c((r=r.apply(e,t||[])).next())}))},g=function(){function e(e,t){this.app=e,this.view=t}var t=e.prototype;return t.setSort=function(e){return h(this,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.view.getSortRangePanel();case 2:t.sent.doSort(e);case 3:case"end":return t.stop()}}),t,this)})))},t.defineRange=function(){return h(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.view.getSortRangePanel();case 2:e.sent.show({onOk:function(){}});case 3:case"end":return e.stop()}}),e,this)})))},t.getSelection=function(){return this.view.getSelection()},t.shouldDisableWhenPrivateFillArea=function(){var e=this;if(d.q.getConfig("isOwner"))return!1;var t=this.getSelection().rangeSelections,n=this.app.spreadsheet.activeSheet.getRowCount();return t.some((function(t){var r=t.sheetId,o=t.startColIndex,s=t.endColIndex,a=new u.GridRange(r,0,n,o,s);return e.app.sheetStatus.containsPrivateRange([a])}))},e}();g=p([(0,s.L)({adapters:[l.L]}),m(0,c.m),m(1,(0,a.tB)(i.w)),f("design:paramtypes",["function"===typeof(r="undefined"!==typeof c.m&&c.m)?r:Object,"function"===typeof(o="undefined"!==typeof i.w&&i.w)?o:Object])],g)},"../spread-sheet/src/external/view/ui-layer/sync-guide-ent/sync-guide-feature.ts":function(e,t,n){n.r(t),n.d(t,{SyncGuideFeature:function(){return g}});var r,o=n("../node_modules/@babel/runtime/helpers/esm/createClass.js"),s=(n("../node_modules/regenerator-runtime/runtime.js"),n("../node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),n("../node_modules/core-js/modules/esnext.reflect.metadata.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.promise.js"),n("../node_modules/i18next/dist/esm/i18next.js")),a=n("../node_modules/@tencent/workbench/lib/esm/decorators/class/feature.js"),i=n("../node_modules/@tencent/workbench/lib/esm/services/menu/menu-service.js"),c=n("../spread-sheet/src/external/view/ui-layer/sync-guide-ent/config.tsx"),d=n("../spread-sheet/src/core/data/configService/spreadConfig.ts"),u=n("../spread-sheet/src/external/sync-guide/cgi.ts"),l=n("../spread-sheet/src/external/sync-guide/common.ts"),p=n("../spread-sheet/src/core/utils/gray.ts"),f=(n("../spread-sheet/src/base/util/domain-config.ts"),function(e,t,n,r){var o,s=arguments.length,a=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var i=e.length-1;i>=0;i--)(o=e[i])&&(a=(s<3?o(a):s>3?o(t,n,a):o(t,n))||a);return s>3&&a&&Object.defineProperty(t,n,a),a}),m=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},h=function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function a(e){try{c(r.next(e))}catch(t){s(t)}}function i(e){try{c(r.throw(e))}catch(t){s(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,i)}c((r=r.apply(e,t||[])).next())}))},g=function(){function e(e){var t=this;this.menuService=e,this.getEntCommunicationToggle().then((function(e){t.syncStatus=e,t.menuService.$forceUpdate()}))}var t=e.prototype;return t.shouldHideSyncGuide=function(){return!(0,p.i)()||!d.q.getConfig("ownerIsMigrate")},t.getDescription=function(){return[c.Uk["sync-guide-all"],c.Uk["sync-guide-single"],c.Uk["sync-guide-off"]][this.syncStatus]},t.getContext=function(){return s.ZP.t("同步到企业文档列表")},t.getEntCommunicationToggle=function(){return h(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,u.Ll)({toggleType:l._S.RECENT,fileId:d.q.getConfig("padId")});case 2:return t=e.sent,e.abrupt("return",t);case 4:case"end":return e.stop()}}),e)})))},t.setEntCommunicationToggle=function(e){var t=this,n={toggleType:l._S.RECENT,toggleOn:!1,fileId:d.q.getConfig("padId")};e===l.wR.SINGLE&&(n.toggleScope=l.YQ.SINGLE,n.toggleOn=!0),e===l.wR.ALL&&(n.toggleScope=l.YQ.ALL,n.toggleOn=!0),(0,u.Qe)(n).then((function(){t.syncStatus=e}))},(0,o.Z)(e,[{key:"syncGuideStatus",get:function(){return this.syncStatus}}]),e}();g=f([(0,a.L)({name:"SyncGuideFeature"}),m("design:paramtypes",["function"===typeof(r="undefined"!==typeof i.h&&i.h)?r:Object])],g)},"../spread-sheet/src/external/view/ui-layer/titlebar/components/menubar/config.ts":function(e,t,n){n.d(t,{k:function(){return o}});var r=n("../spread-sheet/src/base/util/appConfig.ts"),o={page:{supportPage:r.Z.getConfig("links.feedback")+"?clientInfo="+encodeURIComponent(window.navigator.userAgent)+"&customInfo="+encodeURIComponent(window.location.href),helpPage:r.Z.getConfig("links.helpCenter"),aboutPage:r.Z.getConfig("links.featureDescription"),tortPage:r.Z.getConfig("links.infringementGuidelines"),appealPage:r.Z.getConfig("links.appealPage")+"?appealRefer="+encodeURIComponent(location.href),privacyPolicy:r.Z.getConfig("links.privacyPolicy"),thirdPartySharedInformationList:r.Z.getConfig("links.thirdPartySharedInfo"),thirdAuthorizationManagement:r.Z.getConfig("links.thirdPartyAuthManage"),personalInformationCollectionList:r.Z.getConfig("links.personalInfoCollectionList"),communityConventionPage:r.Z.getConfig("links.communityConvention")},wework:{helpPage:r.Z.getConfig("links.feedback")+"?clientInfo="+encodeURIComponent(window.navigator.userAgent)+"&customInfo="+encodeURIComponent(window.location.href)}}},"../spread-sheet/src/external/view/ui-layer/undo/undo-feature.ts":function(e,t,n){n.r(t),n.d(t,{UndoFeature:function(){return _}}),n("../node_modules/regenerator-runtime/runtime.js"),n("../node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),n("../node_modules/core-js/modules/esnext.reflect.metadata.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.promise.js");var r,o,s,a,i=n("../node_modules/@tencent/containerized/build/main/index.js"),c=n("../node_modules/@tencent/workbench/lib/esm/decorators/class/feature.js"),d=n("../spread-sheet/src/core/behavior/api.interface.ts"),u=n("../packages/report/src/index.ts"),l=n("../packages/undoRedoStack/src/index.ts"),p=n("../spread-sheet/src/core/app/SpreadsheetApp.interface.ts"),f=n("../spread-sheet/src/core/view/level-2/filter-center/util.ts"),m=n("../spread-sheet/src/adapter/SpreadSheetAppAdapter.ts"),h=n("../spread-sheet/src/core/workbench/common/input-manager-service.ts"),g=n("../spread-sheet/src/base/util/domain-config.ts"),v=function(e,t,n,r){var o,s=arguments.length,a=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var i=e.length-1;i>=0;i--)(o=e[i])&&(a=(s<3?o(a):s>3?o(t,n,a):o(t,n))||a);return s>3&&a&&Object.defineProperty(t,n,a),a},y=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},w=function(e,t){return function(n,r){t(n,r,e)}},j=function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function a(e){try{c(r.next(e))}catch(t){s(t)}}function i(e){try{c(r.throw(e))}catch(t){s(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,i)}c((r=r.apply(e,t||[])).next())}))},_=function(){function e(e,t,n,r){this.app=e,this.dynamicApi=t,this.undoredoStack=n,this.inputManagerService=r}var t=e.prototype;return t.undo=function(){return j(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.dynamicApi.getInstance();case 2:t=e.sent,this.inputManagerService.checkAndUndo()||t.undo(),u.ZP.tdwReport({opername:"doc_excel_editor",module:"excel_undoredo",action:"clk_undo",ver12:"new"});case 5:case"end":return e.stop()}}),e,this)})))},t.canUndo=function(){if(this.inputManagerService.isInputtingState())return this.inputManagerService.getCanUndo();var e=this.undoredoStack.undoStack;return this.app.sheetStatus.canEdit&&e.length>0||(0,f.bU)(e,this.app)},t.hideUndoMobileToolbar=function(){return!g.xc},e}();_=v([(0,c.L)({adapters:[m.L]}),w(0,p.m),w(1,d.V),w(2,l.vT),y("design:paramtypes",["function"===typeof(r="undefined"!==typeof p.m&&p.m)?r:Object,"function"===typeof(o="undefined"!==typeof i.RU&&i.RU)?o:Object,"function"===typeof(s="undefined"!==typeof l.vT&&l.vT)?s:Object,"function"===typeof(a="undefined"!==typeof h.Z&&h.Z)?a:Object])],_)},"../spread-sheet/src/external/view/ui-layer/vertical-align/vertical-align-feature.ts":function(e,t,n){n.r(t),n.d(t,{VerAlignFeature:function(){return x}}),n("../node_modules/regenerator-runtime/runtime.js"),n("../node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),n("../node_modules/core-js/modules/esnext.reflect.metadata.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.promise.js");var r,o=n("../packages/model/src/index.ts"),s=n("../node_modules/@tencent/containerized/build/main/index.js"),a=n("../node_modules/@tencent/workbench/lib/esm/decorators/class/feature.js"),i=n("../spread-sheet/src/core/behavior/api.interface.ts"),c=n("../packages/report/src/index.ts"),d=n("../spread-sheet/src/core/app/SpreadsheetApp.interface.ts"),u=n("../spread-sheet/src/core/utils/cell.ts"),l=n("../spread-sheet/src/adapter/SpreadSheetAppAdapter.ts"),p=function(e,t,n,r){var o,s=arguments.length,a=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var i=e.length-1;i>=0;i--)(o=e[i])&&(a=(s<3?o(a):s>3?o(t,n,a):o(t,n))||a);return s>3&&a&&Object.defineProperty(t,n,a),a},f=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},m=function(e,t){return function(n,r){t(n,r,e)}},h=function(){function e(e){this.app=e}return e.prototype.getVerStrategyForCurrentSelection=function(){return(0,u.getCellFormat)(this.app).getVerticalAlign()},e}();h=p([(0,a.L)({adapters:[l.L]}),m(0,d.m),f("design:paramtypes",["function"===typeof(r="undefined"!==typeof d.m&&d.m)?r:Object])],h);var g,v,y=function(e,t,n,r){var o,s=arguments.length,a=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var i=e.length-1;i>=0;i--)(o=e[i])&&(a=(s<3?o(a):s>3?o(t,n,a):o(t,n))||a);return s>3&&a&&Object.defineProperty(t,n,a),a},w=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},j=function(e,t){return function(n,r){t(n,r,e)}},_=function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function a(e){try{c(r.next(e))}catch(t){s(t)}}function i(e){try{c(r.throw(e))}catch(t){s(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,i)}c((r=r.apply(e,t||[])).next())}))},x=function(){function e(e,t){this.dynamicApi=e,this.verAlignService=t,this.defaultVerAlign=o.Cell.Format.VERTICAL_ALIGN.MIDDLE}var t=e.prototype;return t.setVerAlign=function(e){return _(this,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.requestVerAlign(e);case 2:this.reportAutoWrap();case 3:case"end":return t.stop()}}),t,this)})))},t.getVerAlign=function(){return this.getVerStragety()||this.defaultVerAlign},t.getVerStragety=function(){return this.verAlignService.getVerStrategyForCurrentSelection()},t.reportAutoWrap=function(){c.ZP.tdwReport({opername:"doc_excel_editor",module:"excel_v_align",action:"clk_vertically_align",ver12:"new"})},t.requestVerAlign=function(e){return _(this,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.dynamicApi.getInstance();case 2:t.sent.setVerticalAlign(e);case 4:case"end":return t.stop()}}),t,this)})))},e}();x=y([(0,a.L)({adapters:[l.L]}),j(0,i.V),w("design:paramtypes",["function"===typeof(g="undefined"!==typeof s.RU&&s.RU)?g:Object,"function"===typeof(v="undefined"!==typeof h&&h)?v:Object])],x)},"../spread-sheet/src/external/view/ui-layer/watermark/watermark-feature.ts":function(e,t,n){n.r(t),n.d(t,{WatermarkFeature:function(){return l}}),n("../node_modules/regenerator-runtime/runtime.js"),n("../node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.promise.js");var r=n("../node_modules/@tencent/workbench/lib/esm/decorators/class/feature.js"),o=n("../spread-sheet/src/external/waterMark/config.ts"),s=n("../spread-sheet/src/core/data/configService/spreadConfig.ts"),a=n("../spread-sheet/src/adapter/SpreadSheetAppAdapter.ts"),i=n("../spread-sheet/src/external/sheet-adapter/smart-sheet-adapter/constants.ts"),c=n("../spread-sheet/src/external/waterMark/utils.ts"),d=function(e,t,n,r){var o,s=arguments.length,a=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var i=e.length-1;i>=0;i--)(o=e[i])&&(a=(s<3?o(a):s>3?o(t,n,a):o(t,n))||a);return s>3&&a&&Object.defineProperty(t,n,a),a},u=function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function a(e){try{c(r.next(e))}catch(t){s(t)}}function i(e){try{c(r.throw(e))}catch(t){s(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,i)}c((r=r.apply(e,t||[])).next())}))},l=function(){function e(){}var t=e.prototype;return t.toggleWatermark=function(){return u(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t,n,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=s.q.getConfig("watermark"),n=s.q.getConfig("globalPadId"),r={invokeFrom:"TitleBar"},e.next=5,(0,c.iY)();case 5:e.sent.WatermarkDialogManager.showDialog(r,t,n);case 8:case"end":return e.stop()}}),e)})))},t.hasWatermark=function(){return s.q.getConfig("isOwner")&&o.a},e}();l=d([(0,r.L)({adapters:[a.L,i.dH],name:"WatermarkFeature"})],l)},"../spread-sheet/src/external/view/ui-layer/wedrive-ent/wedrive-feature.ts":function(e,t,n){n.r(t),n.d(t,{ADD_TYPE:function(){return x},WedriveFeature:function(){return Z}}),n("../node_modules/regenerator-runtime/runtime.js"),n("../node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),n("../node_modules/core-js/modules/esnext.reflect.metadata.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.promise.js"),n("../node_modules/core-js/modules/es.object.assign.js"),n("../node_modules/core-js/modules/es.function.name.js"),n("../node_modules/core-js/modules/es.array.map.js");var r=n("../node_modules/i18next/dist/esm/i18next.js"),o=n("../node_modules/@tencent/workbench/lib/esm/decorators/class/controller.js"),s=n("../node_modules/@tencent/workbench/lib/esm/decorators/class/feature.js"),a=n("../node_modules/@tencent/workbench/lib/esm/services/menu/menu-service.js"),i=n("../node_modules/@tencent/workbench/lib/esm/services/controller/controller-service.js"),c=n("../packages/common-utils/src/index.ts"),d=n("../spread-sheet/src/core/data/configService/spreadConfig.ts"),u=(n("../node_modules/core-js/modules/es.array.join.js"),n("../node_modules/core-js/modules/es.array.filter.js"),n("./node_modules/axios/index.js")),l=n.n(u),p=(n("../node_modules/qs/lib/index.js"),n("../spread-sheet/src/base/util/appConfig.ts")),f=function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function a(e){try{c(r.next(e))}catch(t){s(t)}}function i(e){try{c(r.throw(e))}catch(t){s(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,i)}c((r=r.apply(e,t||[])).next())}))};function m(){var e=this;return new Promise((function(t,n){return f(e,void 0,void 0,regeneratorRuntime.mark((function e(){var o,s,a,i,c,u,p,f;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=d.q.getConfig("padId"),i=d.q.getConfig("corpId"),c=d.q.getConfig("uid"),e.next=5,l().get("/doc/list",{params:{func:"7",corp_id:i,vid:c||"",doc_id:a}});case 5:if(u=e.sent,p=null===(o=null===u||void 0===u?void 0:u.data)||void 0===o?void 0:o.body,null===(s=null===p||void 0===p?void 0:p.doc_path_list)||void 0===s?void 0:s.items){e.next=10;break}return n(r.ZP.t("请求接口失败")),e.abrupt("return");case 10:if((f=u.data.body.doc_path_list.items).length){e.next=14;break}return n(r.ZP.t("文档所在微盘目录为空")),e.abrupt("return");case 14:t(f);case 15:case"end":return e.stop()}}),e)})))}))}function h(e){var t,r;return f(this,void 0,void 0,regeneratorRuntime.mark((function o(){var s,a,i;return regeneratorRuntime.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:s=e.fileId,a=e.topId,i=e.folderId,(null===(t=n.g.tdocs)||void 0===t?void 0:t.jumpToDrive)?null===(r=n.g.tdocs)||void 0===r||r.jumpToDrive({space_id:a,folder_id:i,file_id:s}):n.g.open(p.Z.getConfig("custom.standaloneLinks.drive_weixin_qq_com_webdisk")+"?t=home#/space/1/"+a+"/all?"+(i?"&folderid="+i:"")+(s?"&fileid="+s:""));case 2:case"end":return o.stop()}}),o)})))}function g(){return f(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m();case 2:if(null===(t=e.sent)||void 0===t?void 0:t.length){e.next=5;break}return e.abrupt("return");case 5:return e.abrupt("return",v(t));case 6:case"end":return e.stop()}}),e)})))}function v(e){return e.map((function(e){var t=e.pair_items,n=t[0].id,o=t[t.length-2].id,s=t[t.length-1].id,a=t.map((function(e){return e.name}));return{path:r.ZP.t("微盘")+(a.length>0?"/":"")+a.join("/"),info:{topId:n,folderId:o,fileId:s}}}))}var y,w,j,_,x,b=n("../spread-sheet/src/core/ark-extensions/index.ts"),R=n("../spread-sheet/src/core/ark-extensions/extensions/wedrive-file-selector.ts"),S=n("../spread-sheet/src/core/feature/relateFormEnt/enterpriseStatus.ts"),C=n("../spread-sheet/src/core/utils/gray.ts"),E=n("../spread-sheet/src/core/feature/copyPaste/lib/parsers/automaticIdentifyLink.ts"),I=n("../spread-sheet/src/core/view/layout/interface/pc-view.ts"),M=n("../packages/model/src/cell/index.ts"),T=n("../packages/model/src/cell/format/index.ts"),O=n("../spread-sheet/src/core/behavior/api.interface.ts"),D=(n("../spread-sheet/src/base/util/domain-config.ts"),n("../node_modules/@tencent/containerized/build/main/index.js")),A=n("../spread-sheet/src/external/view/schema/menu-schema.ts"),k=n("../spread-sheet/src/external/view/ui-layer/wedrive-ent/view-in-wedrive-controller.ts"),P=function(e,t,n,r){var o,s=arguments.length,a=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var i=e.length-1;i>=0;i--)(o=e[i])&&(a=(s<3?o(a):s>3?o(t,n,a):o(t,n))||a);return s>3&&a&&Object.defineProperty(t,n,a),a},N=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},L=function(e,t){return function(n,r){t(n,r,e)}},F=function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function a(e){try{c(r.next(e))}catch(t){s(t)}}function i(e){try{c(r.throw(e))}catch(t){s(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,i)}c((r=r.apply(e,t||[])).next())}))};!function(e){e[e.NEW=1]="NEW",e[e.OTHER=2]="OTHER"}(x||(x={}));var Z=function(){function e(e,t,n,o){this.view=e,this.dynamicApi=t,this.menuService=n,this.controllerService=o,this.webDriverInfo={loaded:!1,paths:[],menuVisible:!1},this.drivePath=[{path:r.ZP.t("微盘"),info:{fileId:"",topId:"",folderId:""}}],this.wedriveSwitch=!0,this.canSaveAsLink=d.q.getConfig("canSaveAsLink"),this.canMove=d.q.getConfig("canMove"),this.loadWebPaths(),this.loadWedriveSwitch()}var t=e.prototype;return t.loadWebPaths=function(){var e=this;m().then((function(t){var n=v(t);e.webDriverInfo=Object.assign(Object.assign({},e.webDriverInfo),{loaded:!0,paths:t}),e.drivePath=n,e.updateViewInDriveMenu()})).catch((function(){e.webDriverInfo=Object.assign(Object.assign({},e.webDriverInfo),{loaded:!0,paths:[]})}))},t.loadWedriveSwitch=function(){var e=this;S.JY.fetch().then((function(t){e.wedriveSwitch=t.wedrive}))},t.openWedriveFileSelector=function(e){var t,n,r,o;return void 0===e&&(e=!1),F(this,void 0,void 0,regeneratorRuntime.mark((function s(){var a,i,u,l,p,f,m,h,g,v,y,w,j,_,x;return regeneratorRuntime.wrap((function(s){for(;;)switch(s.prev=s.next){case 0:if(this.webDriverInfo.loaded){s.next=2;break}return s.abrupt("return");case 2:return s.next=4,null===(n=null===(t=null===window||void 0===window?void 0:window.tdocs)||void 0===t?void 0:t.getLoginCst)||void 0===n?void 0:n.call(t);case 4:if(s.t0=s.sent,s.t0){s.next=7;break}s.t0={};case 7:return a=s.t0,i=a.vid,u=void 0===i?"":i,l=a.cst,p=void 0===l?"":l,f=a.deviceid,m=void 0===f?"":f,h=(null===(o=null===(r=this.drivePath)||void 0===r?void 0:r[0])||void 0===o?void 0:o.info)||{},g=h.folderId,v=void 0===g?"":g,y=h.topId,w=void 0===y?"":y,j=h.fileId,_=void 0===j?"":j,s.next=17,b.default.getExtension(R._.name);case 17:null===(x=s.sent)||void 0===x||x.show({getTitle:function(){return d.q.getConfig("padTitle")},docId:d.q.getConfig("padId"),shareCode:(0,c.IZ)("scode"),getEnableMoveToWeDrive:function(){return d.q.getConfig("canMove")&&S.JY.get().wedrive},weworkType:e?6:5,show:!0,fileId:"",success:this.loadWebPaths.bind(this),fail:function(){},cancel:function(){},wwappDeviceId:m,wwappVid:u,wwappCst:p,focusSpaceId:w,focusFolderId:v,focusFileId:_});case 19:case"end":return s.stop()}}),s,this)})))},t.insertWedriveFile=function(){return F(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t,n,r,o,s,a,i,c;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,window.tdocs.chooseWeDriveFile();case 2:if((t=e.sent)&&t.url){e.next=5;break}return e.abrupt("return");case 5:return e.next=7,this.dynamicApi.getInstance();case 7:return n=e.sent,r=t.name,o=t.url,s=this.view.canvas.normalSelectData.activeCol,a=this.view.canvas.normalSelectData.activeRow,e.next=13,(0,E.en)({url:o});case 13:i=e.sent,c=i.hyperlinkType,n.setHyperLink(r,o,c||M.HYPERLINK_TYPE.NORMAL,a,s,T.HORIZONTAL_ALIGN.LEFT);case 16:case"end":return e.stop()}}),e,this)})))},t.hideMoveToWedrive=function(){var e=this.webDriverInfo,t=e.paths,n=e.loaded,r=this.canMove;return!((!n||n&&t.length>0)&&r&&this.wedriveSwitch&&!(0,C.i)())},t.hideSaveToWedrive=function(){var e=this.webDriverInfo,t=e.paths,n=e.loaded;return!((!n||n&&t.length>0)&&this.wedriveSwitch&&!(0,C.i)())},t.hideInsertWedriverFileMobile=function(){return!0},t.shouldShowViewInWedrive=function(){var e=this.webDriverInfo,t=e.loaded,n=e.paths;return(!t||t&&n.length>0)&&this.wedriveSwitch},t.updateViewInDriveMenu=function(){this.updateViewInWedriveMenuSchema(),this.createViewInWedriveMenu()},t.updateViewInWedriveMenuSchema=function(){var e=this.drivePath.map((function(e){return"wedrive-path-"+e.path})),t=this.menuService.updateKeySchema(A.z_.VIEW_IN_WEDRIVE,e);this.menuService.setSchema(t)},t.createViewInWedriveMenu=function(){var e=this,t=this.drivePath.map((function(t){return{name:"wedrive-path-"+t.path,content:t.path.length>12?t.path.substring(0,12)+"...":t.path,onClick:e.openInWedrive.bind(e,t.info)}}));(0,o.Q)({menuItems:t})(k.u),this.controllerService.buildController(k.u)},t.openInWedrive=function(e){return F(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:t.prev=0,h(e);case 2:return t.prev=2,t.next=5,g();case 5:if(n=t.sent){t.next=8;break}return t.abrupt("return");case 8:return this.drivePath=n,t.finish(2);case 10:case"end":return t.stop()}}),t,this,[[0,,2,10]])})))},e}();Z=P([(0,s.L)({name:"WedriveFeature"}),L(0,I.w),L(1,O.V),N("design:paramtypes",["function"===typeof(y="undefined"!==typeof I.w&&I.w)?y:Object,"function"===typeof(w="undefined"!==typeof D.RU&&D.RU)?w:Object,"function"===typeof(j="undefined"!==typeof a.h&&a.h)?j:Object,"function"===typeof(_="undefined"!==typeof i.H&&i.H)?_:Object])],Z)},"../spread-sheet/src/external/waterMark/config.ts":function(e,t,n){n.d(t,{a:function(){return r}});var r=!0}}]),window.jsExecEndTimeStamp=Date.now(),window.cachedPerformanceEntries||(window.cachedPerformanceEntries=[]),window.cachedPerformanceEntries.push({name:"jsExec: js/bundle_workbench_feature.687098d8cbbc21103887.js",entryType:"jsExec",startTime:window.jsExecStartTimeStamp,endTime:window.jsExecEndTimeStamp});
//# sourceMappingURL=bundle_workbench_feature.687098d8cbbc21103887.js.map