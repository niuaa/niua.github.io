self.window=self,window.jsExecStartTimeStamp=Date.now(),(self.webpackChunk_tencent_alloy_builder=self.webpackChunk_tencent_alloy_builder||[]).push([["bundle_plugin_mention"],{"../spread-sheet/src/base/util/decorator/loading-decorator.ts":function(e,n,t){t.d(n,{n:function(){return i}}),t("../node_modules/regenerator-runtime/runtime.js"),t("../node_modules/core-js/modules/es.object.to-string.js"),t("../node_modules/core-js/modules/es.promise.js"),t("../node_modules/core-js/modules/es.array.concat.js");var o=function(e,n,t,o){return new(t||(t=Promise))((function(i,r){function s(e){try{u(o.next(e))}catch(n){r(n)}}function a(e){try{u(o.throw(e))}catch(n){r(n)}}function u(e){var n;e.done?i(e.value):(n=e.value,n instanceof t?n:new t((function(e){e(n)}))).then(s,a)}u((o=o.apply(e,n||[])).next())}))};function i(){return function(e,n,i){var r=i.value;i.value=function(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];var s,a;return o(this,void 0,void 0,regeneratorRuntime.mark((function e(){var o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return null===(s=t.g.snackLoading)||void 0===s||s.show(3e3),e.next=3,r.call.apply(r,[this].concat(n));case 3:return o=e.sent,null===(a=t.g.snackLoading)||void 0===a||a.hide(),e.abrupt("return",o);case 6:case"end":return e.stop()}}),e,this)})))}}}},"../spread-sheet/src/core/view/level-2/mention/api/MentionApi.ts":function(e,n,t){t.d(n,{Z:function(){return g}});var o,i,r,s=t("../node_modules/@babel/runtime/helpers/esm/createClass.js"),a=(t("../node_modules/core-js/modules/es.regexp.exec.js"),t("../node_modules/core-js/modules/es.string.search.js"),t("../spread-sheet/src/base/event/event.ts")),u=t("../spread-sheet/src/external/mention/enum.ts"),l=t("../spread-sheet/src/external/view/mobile/toolbar/native-toolbar/index.ts"),c=t("../spread-sheet/src/base/index.ts");!function(e){e.MENTION_LIST="MENTION_LIST",e.QUICK_REMIND_MENU="QUICK_REMIND_MENU"}(o||(o={})),function(e){e.TOP="top"}(r||(r={}));var d=function(){function e(){}return e.popMentionList=function(n,i,r,s){var l;t.g.log.info("MentionApi","popMentionList - position: "+JSON.stringify(n)+", rowHeight: "+i+", sheetId: "+r),null===(l=a.ZP.mentionEvent)||void 0===l||l.trigger(u.yS.ADD_MENTION_ACTION,n,i,r,s),e.modifyMentionUIComponentDisplayStatus(o.MENTION_LIST,!0)},e.setMentionMenu=function(n,i,r){var s;if(t.g.log.debug("MentionApi","setMentionMenu - visible: "+n+", pos: "+JSON.stringify(i)+", rowHeight: "+r),i.x<0||i.y<0)return t.g.log.warn("MentionApi","setMentionMenu position is invalid, force hide mention list!"),e.hideMentionList(),void e.modifyMentionUIComponentDisplayStatus(o.MENTION_LIST,!1);null===(s=a.ZP.mentionEvent)||void 0===s||s.trigger(u.yS.SET_MENTION_MENU,n,i,r),e.modifyMentionUIComponentDisplayStatus(o.MENTION_LIST,!1)},e.search=function(n){var i;t.g.log.debug("MentionApi","search - "+n),null===(i=a.ZP.mentionEvent)||void 0===i||i.trigger(u.yS.SEARCH_MENTION,n),e.modifyMentionUIComponentDisplayStatus(o.MENTION_LIST,!0)},e.control=function(n){var i;t.g.log.debug("MentionApi","control - "+n),null===(i=a.ZP.mentionEvent)||void 0===i||i.trigger(u.yS.KEYBOARD_DOWN,n),e.modifyMentionUIComponentDisplayStatus(o.MENTION_LIST,!0)},e.hideMentionList=function(){var n;t.g.log.info("MentionApi","hideMentionList"),null===(n=a.ZP.mentionEvent)||void 0===n||n.trigger(u.yS.CANCEL_MENTION_ACTION),e.modifyMentionUIComponentDisplayStatus(o.MENTION_LIST,!1)},e.showRemindBoard=function(n,i,r,s,l){var c;t.g.log.info("MentionApi","showRemindBoard - mentionId: "+n+", position: "+JSON.stringify(i)+", visible: "+r+", rowHeight: "+s),null===(c=a.ZP.mentionEvent)||void 0===c||c.trigger(u.yS.SET_QUICKREMIND_MENU,{mentionId:n,pos:i,visible:r,rowHeight:s,userId:l}),e.modifyMentionUIComponentDisplayStatus(o.QUICK_REMIND_MENU,!0)},e.closeRemindBoard=function(){var n;t.g.log.info("MentionApi","closeRemindBoard"),null===(n=a.ZP.mentionEvent)||void 0===n||n.trigger(u.yS.HIDE_QUICKREMIND_MENU),e.modifyMentionUIComponentDisplayStatus(o.QUICK_REMIND_MENU,!1)},e.enterFullScreenMode=function(){return(0,l.KK)()?(t.g.log.info("MentionApi","enterFullScreenMode - Hide native toolbar start"),c.Z.util.timer.wait(500).run((function(){l.ZP.hideNativeToolbar(),t.g.log.info("MentionApi","enterFullScreenMode - Hide native toolbar end")})),!0):(t.g.log.debug("MentionApi","enterFullScreenMode - Does not support native toolbar"),!1)},e.modifyMentionUIComponentDisplayStatus=function(n,t){e.mentionDisplayStatus[n]=t},(0,s.Z)(e,null,[{key:"isMentionListVisible",get:function(){return e.mentionDisplayStatus[o.MENTION_LIST]}},{key:"isQuickRemindMenuVisible",get:function(){return e.mentionDisplayStatus[o.QUICK_REMIND_MENU]}}]),e}();d.mentionDisplayStatus=((i={})[o.MENTION_LIST]=!1,i[o.QUICK_REMIND_MENU]=!1,i);var g=d},"../spread-sheet/src/external/mention/enum.ts":function(e,n,t){var o,i;t.d(n,{aV:function(){return r},yS:function(){return o}}),function(e){e.ADD_MENTION_ACTION="addMentionAction",e.SET_MENTION_MENU="setMentionMenu",e.SEND_MENTION_ACTION="sendMentionAction",e.CANCEL_MENTION_ACTION="cancelMentionAction",e.DELETE_MENTION_ACTION="deleteMentionAction",e.SEARCH_MENTION="searchMention",e.SET_QUICKREMIND_MENU="setQuickRemindMenu",e.HIDE_QUICKREMIND_MENU="hideQuickRemindMenu",e.KEYBOARD_DOWN="keyboardDown",e.AUTO_CREATE_MENTION="autoCreateMention"}(o||(o={})),function(e){e.MENTION_START="mention_start",e.MENTION_END="mention_end"}(i||(i={}));var r=function(e){return e+"Success"}},"../spread-sheet/src/external/mention/mentionPlugin.ts":function(e,n,t){t.r(n),t.d(n,{default:function(){return E}});var o,i=t("../node_modules/@babel/runtime/helpers/esm/assertThisInitialized.js"),r=t("../node_modules/@babel/runtime/helpers/esm/inheritsLoose.js"),s=(t("../node_modules/regenerator-runtime/runtime.js"),t("../node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),t("../node_modules/core-js/modules/esnext.reflect.metadata.js"),t("../node_modules/core-js/modules/es.object.to-string.js"),t("../node_modules/core-js/modules/es.promise.js"),t("../node_modules/core-js/modules/es.array.map.js"),t("../node_modules/core-js/modules/es.regexp.exec.js"),t("../node_modules/core-js/modules/es.string.search.js"),t("../node_modules/core-js/modules/es.array.concat.js"),t("../node_modules/core-js/modules/web.dom-collections.for-each.js"),t("../node_modules/core-js/modules/es.function.name.js"),t("../node_modules/i18next/dist/esm/i18next.js")),a=t("../node_modules/@tencent/containerized/build/main/index.js"),u=t("../spread-sheet/src/core/ui/toast/index.ts"),l=t("../spread-sheet/src/base/event/eventName.ts"),c=t("../spread-sheet/src/base/event/event.ts"),d=t("../spread-sheet/src/external/mention/enum.ts"),g=t("../spread-sheet/src/core/view/level-2/mention/api/MentionApi.ts"),m=t("../spread-sheet/src/core/ark-extensions/index.ts"),f=t("../spread-sheet/src/core/ark-extensions/extensions/at-message-toast.ts"),h=t("../spread-sheet/src/base/util/decorator/loading-decorator.ts"),p=function(e,n,t,o){var i,r=arguments.length,s=r<3?n:null===o?o=Object.getOwnPropertyDescriptor(n,t):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(e,n,t,o);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(r<3?i(s):r>3?i(n,t,s):i(n,t))||s);return r>3&&s&&Object.defineProperty(n,t,s),s},v=function(e,n){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,n)},M=function(e,n,t,o){return new(t||(t=Promise))((function(i,r){function s(e){try{u(o.next(e))}catch(n){r(n)}}function a(e){try{u(o.throw(e))}catch(n){r(n)}}function u(e){var n;e.done?i(e.value):(n=e.value,n instanceof t?n:new t((function(e){e(n)}))).then(s,a)}u((o=o.apply(e,n||[])).next())}))},E=function(e){function n(n){var o;return(o=e.call(this)||this).onMentionListShow=function(){g.Z.isMentionListVisible||(t.g.log.debug("MentionPlugin","onShow"),o.app.event.default.trigger(l.W1.UI_SHOW,l.Xs.AT_MESSAGE))},o.onMentionListClose=function(){g.Z.isMentionListVisible&&(t.g.log.debug("MentionPlugin","onClose"),o.app.event.default.trigger(l.W1.UI_HIDE,l.Xs.AT_MESSAGE))},o.onToastClickCallback=function(e){t.g.log.debug("MentionPlugin","onToastClick - userInfo: "+JSON.stringify(e));var n=o.app.spreadsheet.getActiveSheetId(),i=e.targetId,r=e.mentionId,s=e.anchorId;null!==i&&i!==n?(t.g.log.info("MentionPlugin","onToastClick - Switch sheet from "+n+" to "+i+":"+s+":"+r),o.handleSwitchSheet(n,i,s,r,(function(){o.handleMove(s,r)}))):(t.g.log.info("MentionPlugin","switchSheet - Moving cell to "+s+":"+r),o.handleMove(s,r))},o.handleSwitchSheet=function(e,n,i,r,a){if(-1===o.app.spreadsheet.sheetManager.sheetList.map((function(e){return e.getSheetId?e.getSheetId():""})).indexOf(n))return t.g.log.error("MentionPlugin","onToastClick - Sheet "+n+" does not exist"),void(0,u.showToast)(s.ZP.t("@人所在的子表已被删除"));c.ZP.sheetsBar.trigger("switchSheet",n,e,{onSuccess:function(){t.g.log.info("MentionPlugin","switchSheet - Success, move cell to "+i+":"+r),a(i,r)},onFail:function(){t.g.log.error("MentionPlugin","switchSheet - Failed when moving cell to "+i+":"+r)}})},o.moveToRowColForMention=function(e){t.g.log.info("MentionPlugin","moveToRowColForMention");var n=o.app.spreadsheet.activeSheet.mentionManager.getMention(e);if(n){t.g.log.info("MentionPlugin","moveToRowColForMention - mention: "+n);var i=n.rowIndex,r=n.colIndex;o.app.view.canvas.scrollApi.scrollToRenderFrom({row:i,col:r}),o.app.view.canvas.selectApi.selectCells(o.app.view.canvas.normalSelectData,{xRange:[r,r],yRange:[i,i]},null)}else t.g.log.error("MentionPlugin","moveToRowColForMention - Mention ID does not found")},o.moveToRowColForAnchor=function(e,n){t.g.log.info("MentionPlugin","moveToRowColForAnchor");var i=o.app.spreadsheet.activeSheet.sheetRangeManager.getSheetRange(e);if(i){o.timer&&clearTimeout(o.timer);var r=i.gridRange.startRowIndex,s=i.gridRange.startColIndex,a=i.gridRange.endRowIndex,u=i.gridRange.endColIndex;o.app.view.canvas.scrollApi.scrollToRenderFrom({row:r,col:s}),o.app.view.canvas.selectApi.selectCells(o.app.view.canvas.normalSelectData,{xRange:[s,u],yRange:[r,a]},null),o.app.view.canvas.commentCenter.getCard().activeComment(r,s),t.g.log.info("MentionPlugin","moveToRowColForAnchor - Highlight timer begin"),o.timer=setTimeout((function(){t.g.log.info("MentionPlugin","moveToRowColForAnchor - Highlight timer end"),o.highlight(n)}),500)}},o.highlight=function(e){t.g.log.info("MentionPlugin","highlight on "+e),o.renderTimer&&clearTimeout(o.renderTimer);var n=document.getElementById(e);n?(t.g.log.info("MentionPlugin","highlight - Highlight timer begin"),n.style.backgroundColor="#FFFF84",o.renderTimer=setTimeout((function(){t.g.log.info("MentionPlugin","highlight - Highlight timer end"),n.style.backgroundColor="#FFFFFF"}),2e3)):t.g.log.error("MentionPlugin","highlight - Can not found element with mentionId: "+e)},o.initEvent=function(){c.ZP.mentionEvent.listen(d.yS.ADD_MENTION_ACTION,o.addMentionAction),c.ZP.mentionEvent.listen(d.yS.SET_MENTION_MENU,o.setMentionMenu),c.ZP.mentionEvent.listen(d.yS.SEND_MENTION_ACTION,o.sendMentionAction),c.ZP.mentionEvent.listen(d.yS.CANCEL_MENTION_ACTION,o.cancelMentionAction),c.ZP.mentionEvent.listen(d.yS.DELETE_MENTION_ACTION,o.deleteMentionAction),c.ZP.mentionEvent.listen(d.yS.SEARCH_MENTION,o.searchMention),c.ZP.mentionEvent.listen(d.yS.SET_QUICKREMIND_MENU,o.setQuickRemindMenu),c.ZP.mentionEvent.listen(d.yS.KEYBOARD_DOWN,o.keyboardDown),c.ZP.mentionEvent.listen(d.yS.HIDE_QUICKREMIND_MENU,o.hideQuickRemindMenu),c.ZP.mentionEvent.listen(d.yS.AUTO_CREATE_MENTION,o.autoCreateMention),o._register(o.app.spreadsheet.onAddMention(o.sendMentionRemote)),o._register(o.app.spreadsheet.onDeleteMention(o.deleteMentionRemote)),o._register(o.app.spreadsheet.onUpdateMention(o.debounceUpdateDocMention)),o.app.event.sheetsBar.listen("switchSheetStart",o.hideQuickRemindMenu),t.g.log.debug("MentionPlugin","initEvent")},o.addMentionAction=function(e,n,r,s){return M((0,i.Z)(o),void 0,void 0,regeneratorRuntime.mark((function o(){var i,a;return regeneratorRuntime.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,this.getAtMessage();case 2:a=o.sent,null===(i=a.addMentionAction)||void 0===i||i.call(a,{pos:e,rowHeight:n,targetId:r},s),t.g.log.debug("MentionPlugin","addMentionAction"),c.ZP.mentionEvent.trigger((0,d.aV)(d.yS.ADD_MENTION_ACTION));case 6:case"end":return o.stop()}}),o,this)})))},o.setMentionMenu=function(e,n,r){return M((0,i.Z)(o),void 0,void 0,regeneratorRuntime.mark((function o(){var i,s;return regeneratorRuntime.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,this.getAtMessage();case 2:s=o.sent,null===(i=s.setMentionMenu)||void 0===i||i.call(s,{visible:e,pos:n,rowHeight:r}),t.g.log.debug("MentionPlugin","setMentionMenu"),c.ZP.mentionEvent.trigger((0,d.aV)(d.yS.SET_MENTION_MENU));case 6:case"end":return o.stop()}}),o,this)})))},o.sendMentionAction=function(e,n){return M((0,i.Z)(o),void 0,void 0,regeneratorRuntime.mark((function o(){var i,r;return regeneratorRuntime.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,this.getAtMessage();case 2:r=o.sent,null===(i=r.sendMentionAction)||void 0===i||i.call(r,e,n),t.g.log.debug("MentionPlugin","sendMentionAction"),c.ZP.mentionEvent.trigger((0,d.aV)(d.yS.SEND_MENTION_ACTION));case 6:case"end":return o.stop()}}),o,this)})))},o.cancelMentionAction=function(){return M((0,i.Z)(o),void 0,void 0,regeneratorRuntime.mark((function e(){var n,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getAtMessage();case 2:o=e.sent,null===(n=o.cancelMentionAction)||void 0===n||n.call(o),this.hideQuickRemindMenu(),t.g.log.debug("MentionPlugin","cancelMentionAction"),c.ZP.mentionEvent.trigger((0,d.aV)(d.yS.CANCEL_MENTION_ACTION));case 7:case"end":return e.stop()}}),e,this)})))},o.deleteMentionAction=function(e,n){return M((0,i.Z)(o),void 0,void 0,regeneratorRuntime.mark((function o(){var i,r;return regeneratorRuntime.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,this.getAtMessage();case 2:r=o.sent,null===(i=r.deleteMentionAction)||void 0===i||i.call(r,e,n),t.g.log.debug("MentionPlugin","deleteMentionAction"),c.ZP.mentionEvent.trigger((0,d.aV)(d.yS.DELETE_MENTION_ACTION));case 6:case"end":return o.stop()}}),o,this)})))},o.searchMention=function(e,n){return M((0,i.Z)(o),void 0,void 0,regeneratorRuntime.mark((function o(){var i,r;return regeneratorRuntime.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,this.getAtMessage();case 2:r=o.sent,null===(i=r.search)||void 0===i||i.call(r,e,n),t.g.log.debug("MentionPlugin","searchMention"),c.ZP.mentionEvent.trigger((0,d.aV)(d.yS.SEARCH_MENTION));case 6:case"end":return o.stop()}}),o,this)})))},o.setQuickRemindMenu=function(e){return M((0,i.Z)(o),void 0,void 0,regeneratorRuntime.mark((function n(){var o,i,r;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.getAtMessage();case 2:r=n.sent,e.visible&&(t.g.log.debug("MentionPlugin","setQuickRemindMenu - Hide other quick remind menus"),null===(o=r.hideQuickRemindMenu)||void 0===o||o.call(r)),null===(i=r.setQuickRemindMenu)||void 0===i||i.call(r,e),this.isShowQuickRemindMenu=e.visible,t.g.log.debug("MentionPlugin","setQuickRemindMenu"),c.ZP.mentionEvent.trigger((0,d.aV)(d.yS.SET_QUICKREMIND_MENU));case 8:case"end":return n.stop()}}),n,this)})))},o.hideQuickRemindMenu=function(){return M((0,i.Z)(o),void 0,void 0,regeneratorRuntime.mark((function e(){var n,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.isShowQuickRemindMenu){e.next=6;break}return t.g.log.debug("MentionPlugin","hideQuickRemindMenu"),e.next=4,this.getAtMessage();case 4:o=e.sent,null===(n=o.hideQuickRemindMenu)||void 0===n||n.call(o);case 6:t.g.log.debug("MentionPlugin","hideQuickRemindMenu - Quick remind menu not shown"),this.isShowQuickRemindMenu=!1,c.ZP.mentionEvent.trigger((0,d.aV)(d.yS.HIDE_QUICKREMIND_MENU));case 9:case"end":return e.stop()}}),e,this)})))},o.keyboardDown=function(e){return M((0,i.Z)(o),void 0,void 0,regeneratorRuntime.mark((function n(){var o,i;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.getAtMessage();case 2:i=n.sent,null===(o=i.keyboardDown)||void 0===o||o.call(i,{type:e}),t.g.log.debug("MentionPlugin","keyboardDown: keyType: "+e),c.ZP.mentionEvent.trigger((0,d.aV)(d.yS.KEYBOARD_DOWN));case 6:case"end":return n.stop()}}),n,this)})))},o.autoCreateMention=function(e,n){return void 0===e&&(e={counts:0,targetId:""}),M((0,i.Z)(o),void 0,void 0,regeneratorRuntime.mark((function o(){var i,r;return regeneratorRuntime.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,this.getAtMessage();case 2:r=o.sent,null===(i=r.autoCreateMention)||void 0===i||i.call(r,e,n),t.g.log.debug("MentionPlugin","autoCreateMention: options: "+JSON.stringify(e)),c.ZP.mentionEvent.trigger((0,d.aV)(d.yS.AUTO_CREATE_MENTION));case 6:case"end":return o.stop()}}),o,this)})))},o.updateDocMention=function(){return M((0,i.Z)(o),void 0,void 0,regeneratorRuntime.mark((function e(){var n,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.g.log.debug("MentionPlugin","updateDocMention"),e.next=3,this.getAtMessage();case 3:o=e.sent,null===(n=o.updateDocMention)||void 0===n||n.call(o);case 5:case"end":return e.stop()}}),e,this)})))},o.sendMentionRemote=function(e){return M((0,i.Z)(o),void 0,void 0,regeneratorRuntime.mark((function n(){var o,i,r,a;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(t.g.log.debug("MentionPlugin","sendMentionRemote"),i=[].concat(e.actionIds),r=[],i.forEach((function(n){r.push({mentionId:n,targetId:e.sheetId})})),t.g.log.debug("MentionPlugin","sendMentionRemote - actionIds: "+JSON.stringify(i)),!(r.length>0)){n.next=11;break}return n.next=9,this.getAtMessage();case 9:a=n.sent,null===(o=a.sendMentionAction)||void 0===o||o.call(a,r,(function(e){0!==e.retcode&&(t.g.log.error("MentionPlugin","sendMentionRemote - failed: "+JSON.stringify(e)),(0,u.showToast)(s.ZP.t("远程增加@信息失败，请撤销后重试")))}));case 11:case"end":return n.stop()}}),n,this)})))},o.deleteMentionRemote=function(e){return M((0,i.Z)(o),void 0,void 0,regeneratorRuntime.mark((function n(){var o,i,r;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(t.g.log.debug("MentionPlugin","deleteMentionRemote"),this.hideQuickRemindMenu(),i=[].concat(e.actionIds),t.g.log.debug("MentionPlugin","deleteMentionRemote - sendArr: "+JSON.stringify(i)),0!==i.length){n.next=7;break}return n.abrupt("return");case 7:return n.next=9,this.getAtMessage();case 9:r=n.sent,null===(o=r.deleteMentionAction)||void 0===o||o.call(r,i,(function(e){0!==e.retcode&&(t.g.log.error("MentionPlugin","deleteMentionRemote - failed: "+JSON.stringify(e)),(0,u.showToast)(s.ZP.t("远程删除@信息失败，请撤销后重试")))}));case 11:case"end":return n.stop()}}),n,this)})))},o.debounceUpdateDocMention=function(){o.timerhandle&&(clearTimeout(o.timerhandle),o.timerhandle=null),o.timerhandle=setTimeout((function(){t.g.log.debug("MentionPlugin","debounceUpdateDocMention"),o.updateDocMention()}),500)},o.app=n,o.initEvent(),o.getAtMessageToast(),o}(0,r.Z)(n,e);var o=n.prototype;return o.getAtMessageToast=function(){return M(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.default.getExtension(f.O.name);case 2:this.AtMessageToast=e.sent,this.AtMessageToast.show({onToastClick:this.onToastClickCallback});case 4:case"end":return e.stop()}}),e,this)})))},o.getAtMessage=function(){var e=this;return new Promise((function(n){e.AtMessage?n(e.AtMessage):(t.g.log.info("MentionPlugin","getAtMessage - Loading AtMessage component begin"),window.SLR.load("AtMessage",(function(o){t.g.log.info("MentionPlugin","getAtMessage - Loading AtMessage component end");var i=document.createElement("div");i.id="mention-container",e.app.view.canvas.container.appendChild(i),o.init(i,{hideToast:!0,updateSource:function(){return[]},onShow:e.onMentionListShow,onClose:e.onMentionListClose}),e.AtMessage=o,n(e.AtMessage)})))}))},o.handleMove=function(e,n){e?this.moveToRowColForAnchor(e,n):this.moveToRowColForMention(n)},n}(a.JT);p([(0,h.n)(),v("design:type",Function),v("design:paramtypes",[]),v("design:returntype","function"===typeof(o="undefined"!==typeof Promise&&Promise)?o:Object)],E.prototype,"getAtMessage",null)},"../spread-sheet/src/external/view/mobile/toolbar/native-toolbar/index.ts":function(e,n,t){t.d(n,{ZP:function(){return a},fG:function(){return s},KK:function(){return r}});var o=t("../node_modules/@babel/runtime/helpers/esm/createClass.js"),i=(t("../node_modules/core-js/modules/es.object.assign.js"),t("../node_modules/core-js/modules/es.regexp.exec.js"),t("../node_modules/core-js/modules/es.object.to-string.js"),t("../node_modules/core-js/modules/web.dom-collections.for-each.js"),t("../node_modules/core-js/modules/es.object.keys.js"),t("../node_modules/core-js/modules/es.function.name.js"),t("../node_modules/core-js/modules/es.string.match.js"),t("../spread-sheet/src/external/view/native/native-toolbar/utils.ts")),r=function(){return(0,i.KK)()};function s(){return(0,i.fG)()}var a=new(function(){function e(){var e=this;this.callbackMap={},this.toolbarHeight=0,this.panelHeight=0,this.keyboardHeight=0,this.taskStack=[],this.initNativeToolbar=function(n){e.toolbarConfig=n,e.allPanelConfig&&e.initClientConfig()},this.updateNativeToolbar=function(n){e.appendToTaskStack("updateNativeToolbar",(function(){t.g.mqq.invoke("docx","updateToolbarConfig",{toolbar:e.convertConfigAndExtractCallback(n),key:e.uniqueKey},null)}))},this.initNativePanel=function(n){e.allPanelConfig=n,e.toolbarConfig&&e.initClientConfig()},this.updateNativePanel=function(n){e.appendToTaskStack("updateNativePanel",(function(){t.g.mqq.invoke("docx","updateStylePanelConfig",Object.assign(Object.assign({},e.convertConfigAndExtractCallback(n)),{key:e.uniqueKey}),null)}))},this.showNativeToolbar=function(){e.setNativeToolbarVisible(!0)},this.hideNativeToolbar=function(){e.setNativeToolbarVisible(!1)},this.showNativePanel=function(n){e.setNativePanelVisible(!0,n)},this.hideNativePanel=function(n){e.setNativePanelVisible(!1,n)},this.getHeightInfo=function(){return{toolbar:e.toolbarHeight,panel:e.panelHeight,keyboard:e.keyboardHeight}},this.initClientConfig=function(){e.appendToTaskStack("initClientConfig",(function(){t.g.mqq.invoke("docx","initToolbarConfig",{toolbar:e.convertConfigAndExtractCallback(e.toolbarConfig),stylepanel:e.convertConfigAndExtractCallback(e.allPanelConfig),key:e.uniqueKey},null)}))},this.setNativeToolbarVisible=function(n){e.appendToTaskStack("setNativeToolbarVisible",(function(){t.g.mqq.invoke("docx","setNativeToolbarShow",{show:n,key:e.uniqueKey},null)}))},this.setNativePanelVisible=function(n,o){e.appendToTaskStack("setNativePanelVisible",(function(){t.g.mqq.invoke("docx","setNativePanelShow",{show:n,name:o,key:e.uniqueKey},null)}))},this.bindEvents()}var n=e.prototype;return n.bindEvents=function(){var e=this;(0,i.M4)()||(window.toolbarClick=function(n,t){var o,i,r=n+"-onClick";null===(i=(o=e.callbackMap)[r])||void 0===i||i.call(o,new Event("click"),t)},window.toolbarHeightChange=function(n){e.toolbarHeight=n.toolbar,e.panelHeight=n.stylepanel,e.keyboardHeight=n.keyboard})},n.appendToTaskStack=function(e,n){var t=this;this.taskStack.length||setTimeout((function(){t.runTaskStack()}),0),this.taskStack.push({type:e,exec:n})},n.runTaskStack=function(){if(this.taskStack.length){for(var e={},n=[],t=this.taskStack.length-1;t>=0;t--){var o=this.taskStack[t];e[o.type]||(n.unshift(o.exec),e[o.type]=!0)}n.forEach((function(e){e()})),this.taskStack=[]}},n.convertConfigAndExtractCallback=function(e){var n=this;return function e(t){if("object"===typeof t){if(!t)return t;var o="[object Array]"===Object.prototype.toString.call(t)?[]:{};return Object.keys(t).forEach((function(i){"function"===typeof t[i]?n.callbackMap[t.name+"-"+i]=t[i]:o[i]=e(t[i])})),o}return t}(e)},(0,o.Z)(e,[{key:"uniqueKey",get:function(){return function(){var e=window.location.href.match("/sheet/([a-zA-Z0-9]*).*"),n="sheet";return e&&(n=e[1]),n}()}}]),e}())},"../spread-sheet/src/external/view/native/native-toolbar/utils.ts":function(e,n,t){t.d(n,{KK:function(){return s},M4:function(){return a},Rx:function(){return d},fG:function(){return l},w2:function(){return u}}),t("../node_modules/core-js/modules/es.regexp.exec.js"),t("../node_modules/core-js/modules/es.string.match.js"),t("../node_modules/core-js/modules/es.string.split.js"),t("../node_modules/core-js/modules/es.array.iterator.js"),t("../node_modules/core-js/modules/es.map.js"),t("../node_modules/core-js/modules/es.object.to-string.js"),t("../node_modules/core-js/modules/es.string.iterator.js"),t("../node_modules/core-js/modules/esnext.map.delete-all.js"),t("../node_modules/core-js/modules/esnext.map.every.js"),t("../node_modules/core-js/modules/esnext.map.filter.js"),t("../node_modules/core-js/modules/esnext.map.find.js"),t("../node_modules/core-js/modules/esnext.map.find-key.js"),t("../node_modules/core-js/modules/esnext.map.includes.js"),t("../node_modules/core-js/modules/esnext.map.key-of.js"),t("../node_modules/core-js/modules/esnext.map.map-keys.js"),t("../node_modules/core-js/modules/esnext.map.map-values.js"),t("../node_modules/core-js/modules/esnext.map.merge.js"),t("../node_modules/core-js/modules/esnext.map.reduce.js"),t("../node_modules/core-js/modules/esnext.map.some.js"),t("../node_modules/core-js/modules/esnext.map.update.js"),t("../node_modules/core-js/modules/web.dom-collections.iterator.js"),t("../node_modules/core-js/modules/es.object.entries.js");var o=t("../node_modules/@tencent/docs-user-agent/dist/index.js"),i=t.n(o),r=null,s=function(){return null===r&&(r=location.href.indexOf("nativetoolbar")>-1||!!(i().isTencentDocsApp&&window.mqq&&(i().isAndroid&&i().isTencentDocsAppVersionAboveOrEqual("2.1.8")||(i().isIOS||i().isIPad)&&i().isTencentDocsAppVersionAboveOrEqual("2.1.8")))),r};function a(){if(!s())return!1;var e=navigator.userAgent.match(/TencentDocs\/(\S*)/),n="0";return e&&e.length>1&&(n=-1!==e[1].indexOf(".tencentdocs")?e[1].split(".tencentdocs")[0]:e[1]),n>="99.99.99"}function u(){var e=window.location.href.match("/sheet/([a-zA-Z0-9]*).*"),n="sheet";return e&&(n=e[1]),n}function l(){return!!(i().isTencentDocsApp&&window.mqq&&(i().isAndroid&&i().isTencentDocsAppVersionAboveOrEqual("2.2.4")||(i().isIOS||i().isIPad)&&i().isTencentDocsAppVersionAboveOrEqual("2.2.4")))}var c=new Map(Object.entries({"quick-fill":"quick-fill-row","font-style":"font-tab","cell-property":"cell-tab",formula:"formula-tab",strikethrough:"strike-through","vertical-align-top":"verticalalign-top","vertical-align-middle":"verticalalign-middle","vertical-align-bottom":"verticalalign-bottom","horizontal-align-left":"align-left","horizontal-align-center":"align-center","horizontal-align-right":"align-right",decimal:"number-digit"}));function d(e){return c.get(e)||e}}}]),window.jsExecEndTimeStamp=Date.now(),window.cachedPerformanceEntries||(window.cachedPerformanceEntries=[]),window.cachedPerformanceEntries.push({name:"jsExec: js/bundle_plugin_mention.0407d6c056cf883911c1.js",entryType:"jsExec",startTime:window.jsExecStartTimeStamp,endTime:window.jsExecEndTimeStamp});
//# sourceMappingURL=bundle_plugin_mention.0407d6c056cf883911c1.js.map