self.window=self,window.jsExecStartTimeStamp=Date.now(),(self.webpackChunk_tencent_alloy_builder=self.webpackChunk_tencent_alloy_builder||[]).push([["spread-sheet_src_core_view_level-2_chart_charts_chart-data-api_ts-spread-sheet_src_core_view_-9220ef"],{"../spread-sheet/src/core/network/datacenter/utils/load-cross-table-data.ts":function(e,t,n){n.d(t,{A:function(){return i}}),n("../node_modules/regenerator-runtime/runtime.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.promise.js");var r=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{c(r.next(e))}catch(t){o(t)}}function a(e){try{c(r.throw(e))}catch(t){o(t)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))},i=function(e,t){return r(void 0,void 0,void 0,regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(e.sheetManager.getSheetBySheetId(t).isLoaded){n.next=5;break}return n.next=5,new Promise((function(n){e.parent.dataCenter.loadSheetData({sheetId:t,onFinished:function(){n("")}})}));case 5:case"end":return n.stop()}}),n)})))}},"../spread-sheet/src/core/view/level-2/chart/alloy-charts/chart-render/charts/BaseChart.ts":function(e,t,n){n.d(t,{Z:function(){return x}}),n("../node_modules/regenerator-runtime/runtime.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.promise.js"),n("../node_modules/core-js/modules/es.object.assign.js"),n("../node_modules/core-js/modules/es.array.fill.js"),n("../node_modules/core-js/modules/es.array.iterator.js"),n("../node_modules/core-js/modules/es.string.iterator.js"),n("../node_modules/core-js/modules/web.dom-collections.iterator.js");var r=n("../node_modules/i18next/dist/esm/i18next.js"),i=n("../node_modules/lodash/cloneDeep.js"),o=n.n(i),s=n("../spread-sheet/src/core/view/level-2/chart/alloy-charts/chart-render/configs/LegendConfigs.ts"),a=n("../spread-sheet/src/core/view/level-2/chart/alloy-charts/chart-render/configs/GridConfigs.ts"),c=n("../spread-sheet/src/core/view/level-2/chart/alloy-charts/chart-render/configs/XAxisConfigs.ts"),d=n("../spread-sheet/src/core/view/level-2/chart/alloy-charts/chart-render/configs/YAxisConfigs.ts"),l=(n("../node_modules/core-js/modules/es.number.to-fixed.js"),n("../node_modules/core-js/modules/es.number.constructor.js"),n("../spread-sheet/src/core/view/level-2/chart/alloy-charts/chart-render/configs/TitleConfigs.ts"));function u(e){var t=Number(100*e).toFixed(2);return t+="%"}var h=function(){function e(e,t,n){var r;this.margin=24,this.containerWidth=e,this.containerHeight=t,this.dependency=n,this.titleHeight=(null===(r=n.titleConfigs)||void 0===r?void 0:r.getClientHeight())||0,this.calcLegend()}var t=e.prototype;return t.getTitleDomRect=function(){return{left:this.margin,top:this.margin,width:this.containerWidth-2*this.margin,height:this.titleHeight}},t.getTitleOptionRect=function(){var e,t;return{left:(null===(t=null===(e=null===this||void 0===this?void 0:this.dependency)||void 0===e?void 0:e.titleConfigs)||void 0===t?void 0:t.position)||l.W.CENTER,top:u(this.margin/this.containerHeight)}},t.getLegendDomRect=function(){var e=2*this.margin;return{left:this.margin,top:this.getLegendTop(),width:this.containerWidth-e,height:this.legendHeight}},t.getLegendOptionRect=function(){var e=2*this.margin,t=this.containerWidth-e;return{left:"center",top:u(this.getLegendTop()/this.containerHeight),width:u(t/this.containerWidth)}},t.getLegendTop=function(){var e;switch((null===(e=this.dependency.legendConfigs)||void 0===e?void 0:e.position)||s.tV.BOTTOM){case s.tV.TOP:return this.titleHeight?this.margin+this.titleHeight:this.margin;case s.tV.BOTTOM:default:return this.containerHeight-this.legendHeight-this.margin}},t.calcLegend=function(){var e,t=(null===(e=this.dependency.legendConfigs)||void 0===e?void 0:e.position)||s.tV.BOTTOM,r=2*this.margin;switch(t){case s.tV.NONE:this.legendHeight=0,this.legendWidth=0;break;case s.tV.TOP:case s.tV.BOTTOM:this.legendHeight=14+s.qB,this.legendWidth=this.containerWidth-r;break;case s.tV.LEFT:case s.tV.RIGHT:n.g.log.error("注意：Legend 布局左右暂未实现！")}},t.getGridDomRect=function(){return{}},t.getGridOptionRect=function(){var e=2*this.margin,t=this.containerWidth-e;return{left:u(this.margin/this.containerWidth),top:u(this.getGridTop()/this.containerHeight),width:u(t/this.containerWidth),height:u(this.getGridHeight()/this.containerHeight)}},t.getGridTop=function(){var e,t=this.margin,n=(null===(e=this.dependency.legendConfigs)||void 0===e?void 0:e.position)||s.tV.BOTTOM;return this.titleHeight&&(t+=this.titleHeight),n===s.tV.TOP&&(t+=this.legendHeight),t},t.getGridHeight=function(){var e=2*this.margin,t=this.containerHeight-e;return this.titleHeight&&(t-=this.titleHeight),this.legendHeight&&(t-=this.legendHeight),t},t.getGeoLabelFontInfo=function(){var e=Math.min(this.containerWidth,this.containerHeight);return e>=400?{showLabel:!0,labelFontSize:12}:340<=e&&e<400?{showLabel:!0,labelFontSize:10}:{showLabel:!1}},t.isVisualMapShow=function(){return!(Math.min(this.containerWidth,this.containerHeight)<180)},t.getVisualMapRect=function(){var e=this.containerHeight/400;return{itemWidth:20*e>>0,itemHeight:140*e>>0}},e}(),f=(n("../node_modules/core-js/modules/es.array.slice.js"),n("../node_modules/core-js/modules/web.dom-collections.for-each.js"),n("../spread-sheet/src/core/view/spreadsheet-view/model/measurer/web/Measurer.ts")),p=n("../spread-sheet/src/core/view/spreadsheet-view/model/TextProp.ts"),g=["#1E6FFF","#FF4747","#FFAB00","#00AA5B","#A55BF5","#546DFF","#3CBFFF","#0CC1E2","#FF5E2F"],m=192,v={icon:s.ll.CIRCLE},y={stroke:"#999999",strokeWidth:1,fill:"#fff"};function b(e){var t=function(e,t,n,r){if(void 0===n&&(n=m),void 0===r&&(r=12),!n)return t.length;for(var i=0,o=t.length,s=0;s<t.length;s++)if((i+=f.Z.measureWidth(t[s],p.Z.newInstance({fontSize:r},e)))>n){o=s;break}return o}(n.g.SpreadsheetApp.spreadsheet,e,m);return t<e.length?e.slice(0,t)+"...":e}var w=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{c(r.next(e))}catch(t){o(t)}}function a(e){try{c(r.throw(e))}catch(t){o(t)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))},x=function(){function e(e){this.defaultLegend=v,this.echart=null,this.emptyLabel=null,this.parent=e,this.container=this.getContainer(),this.parent.appendChild(this.container)}var t=e.prototype;return t.initEcharts=function(){return w(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getEchart();case 2:this.echart=e.sent,this.echart||n.g.log.error("Error: echart is null!");case 4:case"end":return e.stop()}}),e,this)})))},t.drawContainer=function(e){if("undefined"!==typeof e.background)if("string"===typeof e.background)this.container.style.backgroundColor=e.background;else{var t=Object.assign(Object.assign({},y),e.background);t.strokeWidth>0?this.container.style.border=t.strokeWidth+"px solid "+t.stroke:this.container.style.border="none",this.container.style.backgroundColor=t.fill}},t.drawEmpty=function(e){void 0===e&&(e=r.ZP.t("无数据")),this.emptyLabel||(this.emptyLabel=this.getEmptyLabel()),this.emptyLabel.innerText=e,this.container.appendChild(this.emptyLabel)},t.drawEchart=function(e){this.emptyLabel&&(this.container.removeChild(this.emptyLabel),this.emptyLabel=null),this.echart&&(this.echart.resize(),this.echart.setOption(e,{notMerge:!0}))},t.deleteChart=function(){this.clearChart(),this.parent.removeChild(this.container)},t.scaleChart=function(e){this.container.style.transform="scale("+e+")"},t.updateLocation=function(e){this.container.style.left=(e.left||0)+"px",this.container.style.top=(e.top||0)+"px"},t.registerMap=function(e,t,n){return w(this,void 0,void 0,regeneratorRuntime.mark((function r(){return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,this.getMap(e);case 2:if(r.sent){r.next=8;break}return r.next=6,this.getEChartsLib();case 6:r.sent.registerMap(e,t,n);case 8:case"end":return r.stop()}}),r,this)})))},t.getMap=function(e){return w(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.getEChartsLib();case 2:return n=t.sent,t.abrupt("return",n.getMap(e));case 4:case"end":return t.stop()}}),t,this)})))},t.clearChart=function(){this.echart&&(this.echart.clear(),this.echart.dispose())},t.getContainer=function(){var e=document.createElement("div");return e.classList.add("echart-container"),e.dataset.testid="echart-container",e},t.getEmptyLabel=function(){var e=document.createElement("div");return e.classList.add("empty-label"),e.style.position="absolute",e.style.left="0",e.style.right="0",e.style.top="0",e.style.bottom="0",e.style.display="flex",e.style.alignItems="center",e.style.justifyContent="center",e.style.fontSize="24px",e.style.color="rgba(0, 0, 0, 0.4)",e.style.backgroundColor="#fff",e},t.getEchart=function(){return w(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.container){e.next=2;break}return e.abrupt("return",null);case 2:return e.next=4,this.getEChartsLib();case 4:return t=e.sent,e.abrupt("return",t.getInstanceByDom(this.container)||t.init(this.container));case 6:case"end":return e.stop()}}),e,this)})))},t.getEchartForPrint=function(){return this.echart},t.getBaseOptions=function(e){var t={};return"undefined"!==typeof e.titleConfigs&&(t.title=Object.assign(Object.assign({},this.chartLayout.getTitleOptionRect()),e.titleConfigs.toOptions())),t.color=e.color||g,void 0!==e.animation&&(t.animation=e.animation),t},t.getLegendOptions=function(e,t){var n=Object.assign(Object.assign(Object.assign({},this.defaultLegend),t),{data:e}),r=new s.ZP(n);return Object.assign(Object.assign({},this.chartLayout.getLegendOptionRect()),r.toOptions())},t.getTooltipOptions=function(e){return e?e.toOptions():{}},t.getGridOptions=function(e){return e=e||new a.Z({}),Object.assign(Object.assign({},this.chartLayout.getGridOptionRect()),e.toOptions())},t.getXAxisOptions=function(e,t){void 0===t&&(t=new c.Z({})),t.setProperties({data:e});var n=t.toOptions();return this.getXAxisOptionsWithLengthLimit(n)},t.getYAxisOptions=function(e,t){return(t=t||new d.Z({})).setProperties({data:e||[]}),t.toOptions()},t.resize=function(){var e;null===(e=this.echart)||void 0===e||e.resize()},t.draw=function(e,t,n){this.prepareBeforeDrawChart(e,t,n)},t.prepareBeforeDrawChart=function(e,t,n){this.drawContainer(n),this.chartLayout=new h(n.width,n.height,t)},t.getXAxisOptionsWithLengthLimit=function(e){var t=o()(e);t.axisLabel.formatter=b;var r=function(e,t,r){void 0===t&&(t=m),void 0===r&&(r=12);var i=0;return e.forEach((function(e){var o=Math.min(f.Z.measureWidth(e,p.Z.newInstance({fontSize:r},n.g.SpreadsheetApp.spreadsheet)),t);o>i&&(i=o)})),i}(t.data,m);return t.data&&r>this.container.clientWidth/t.data.length&&(t.axisLabel.rotate=60),t},t.getEChartsLib=function(){return w(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.e("bundle_echarts_lib").then(n.t.bind(n,"../node_modules/echarts/index.js",23));case 2:return t=e.sent,e.abrupt("return",t);case 4:case"end":return e.stop()}}),e)})))},e}()},"../spread-sheet/src/core/view/level-2/chart/alloy-charts/chart-render/charts/GeoChart.ts":function(e,t,n){n.d(t,{z:function(){return x},Z:function(){return L}});var r,i=n("../node_modules/@babel/runtime/helpers/esm/inheritsLoose.js"),o=n("../node_modules/@babel/runtime/helpers/esm/toConsumableArray.js"),s=(n("../node_modules/regenerator-runtime/runtime.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.promise.js"),n("../node_modules/core-js/modules/es.array.map.js"),n("../node_modules/core-js/modules/es.array.filter.js"),n("../node_modules/core-js/modules/es.number.is-nan.js"),n("../node_modules/core-js/modules/es.number.constructor.js"),n("../node_modules/core-js/modules/es.regexp.exec.js"),n("../node_modules/core-js/modules/es.string.replace.js"),n("../node_modules/core-js/modules/es.array.iterator.js"),n("../node_modules/core-js/modules/es.map.js"),n("../node_modules/core-js/modules/es.string.iterator.js"),n("../node_modules/core-js/modules/esnext.map.delete-all.js"),n("../node_modules/core-js/modules/esnext.map.every.js"),n("../node_modules/core-js/modules/esnext.map.filter.js"),n("../node_modules/core-js/modules/esnext.map.find.js"),n("../node_modules/core-js/modules/esnext.map.find-key.js"),n("../node_modules/core-js/modules/esnext.map.includes.js"),n("../node_modules/core-js/modules/esnext.map.key-of.js"),n("../node_modules/core-js/modules/esnext.map.map-keys.js"),n("../node_modules/core-js/modules/esnext.map.map-values.js"),n("../node_modules/core-js/modules/esnext.map.merge.js"),n("../node_modules/core-js/modules/esnext.map.reduce.js"),n("../node_modules/core-js/modules/esnext.map.some.js"),n("../node_modules/core-js/modules/esnext.map.update.js"),n("../node_modules/core-js/modules/web.dom-collections.iterator.js"),n("../node_modules/core-js/modules/web.dom-collections.for-each.js"),n("../node_modules/core-js/modules/es.string.trim.js"),n("../node_modules/core-js/modules/es.object.assign.js"),n("../node_modules/core-js/modules/es.function.name.js"),n("../spread-sheet/src/core/view/level-2/chart/alloy-charts/chart-render/charts/BaseChart.ts")),a=n("../spread-sheet/src/core/view/level-2/chart/alloy-charts/chart-render/configs/series/GeoSeriesConfigs.ts"),c=n("../spread-sheet/src/core/view/level-2/chart/alloy-charts/chart-render/configs/TooltipConfigs.ts"),d=n("../packages/model/src/new-embedded/chart/ChartType.ts"),l=n("../node_modules/i18next/dist/esm/i18next.js");!function(e){e.CONTINUOUS="continuous",e.PIECEWISE="piecewise"}(r||(r={}));var u,h=function(){function e(e){this.setProperties(e)}var t=e.prototype;return t.setProperties=function(e){"boolean"===typeof e.show&&(this.show=e.show),this.type=e.type||r.CONTINUOUS,"number"===typeof e.min&&(this.min=e.min),"number"===typeof e.max&&(this.max=e.max),"undefined"!==typeof e.text&&(this.text=e.text),"boolean"===typeof e.calculable&&(this.calculable=e.calculable),"boolean"===typeof e.realtime&&(this.realtime=e.realtime),"undefined"!==typeof e.left&&(this.left=e.left),"undefined"!==typeof e.top&&(this.top=e.top),"undefined"!==typeof e.inRange&&(this.inRange=e.inRange),"number"===typeof e.itemWidth&&(this.itemWidth=e.itemWidth),"number"===typeof e.itemHeight&&(this.itemHeight=e.itemHeight)},t.toOptions=function(){var e={show:"boolean"!==typeof this.show||this.show,type:this.type||r.CONTINUOUS};return e.min="number"===typeof this.min?this.min:0,e.max="number"===typeof this.max?this.max:100,e.text=this.text||[l.ZP.t("高"),l.ZP.t("低")],e.calculable="boolean"===typeof this.calculable&&this.calculable,e.realtime="boolean"===typeof this.realtime&&this.realtime,"undefined"!==typeof this.left?e.left=this.left:e.right=24,"undefined"!==typeof this.top?e.top=this.top:e.bottom=24,"undefined"!==typeof this.inRange&&(e.inRange=this.inRange),"number"===typeof this.itemWidth&&(e.itemWidth=this.itemWidth),"number"===typeof this.itemHeight&&(e.itemHeight=this.itemHeight),e},e}(),f=n("../spread-sheet/src/core/view/level-2/chart/alloy-charts/chart-render/configs/ProvinceConfig.ts"),p=(n("../node_modules/core-js/modules/es.array.concat.js"),function(e){var t=[];return e.forEach((function(n,r){e[r]=g(n,t)})),{coordinates:e,encodeOffsets:[t]}}),g=function(e,t){var n="",r=m(e[0][0]),i=m(e[0][1]);t[0]=r,t[1]=i;for(var o=0;o<e.length;o++){var s=e[o];n+=v(s[0],r),n+=v(s[1],i),r=m(s[0]),i=m(s[1])}return n},m=function(e){return Math.ceil(1024*e)},v=function(e,t){var n=(e=m(e))-t;return 64+(n<<1^n>>15)===8232&&(n+=1),n=n<<1^n>>15,String.fromCharCode(n+64)},y=function(e){var t,n;return(t=e.features).push.apply(t,(0,o.Z)(b())),(n=e.features).push.apply(n,(0,o.Z)(w())),e},b=function(){return[[[123.387451171875,25.681137335685307],[123.585205078125,25.681137335685307],[123.585205078125,25.809781975840405],[123.387451171875,25.809781975840405],[123.387451171875,25.681137335685307]],[[123.99169921875,25.90864446329127],[124.222412109375,25.90864446329127],[124.222412109375,26.066652138577403],[123.99169921875,26.066652138577403],[123.99169921875,25.90864446329127]],[[119.454345703125,23.52370005882413],[119.66308593749999,23.52370005882413],[119.66308593749999,23.69483472220595],[119.454345703125,23.69483472220595],[119.454345703125,23.52370005882413]],[[121.46484375,21.963424936844223],[121.66259765625001,21.963424936844223],[121.66259765625001,22.13653163760967],[121.46484375,22.13653163760967],[121.46484375,21.963424936844223]],[[115.7080078125,20.848545148787238],[115.93872070312499,20.848545148787238],[115.93872070312499,21.06399706324597],[115.7080078125,21.06399706324597],[115.7080078125,20.848545148787238]],[[115.72998046875,20.396123272467616],[115.960693359375,20.396123272467616],[115.960693359375,20.612219573881042],[115.72998046875,20.612219573881042],[115.72998046875,20.396123272467616]],[[116.5704345703125,20.555652403773365],[116.82861328125001,20.555652403773365],[116.82861328125001,20.771523019513364],[116.5704345703125,20.771523019513364],[116.5704345703125,20.555652403773365]]].map((function(e){var t=p([e]);return{type:"Feature",geometry:{type:"Polygon",coordinates:t.coordinates,encodeOffsets:t.encodeOffsets},properties:{}}}))},w=function(){for(var e=[126,25],t=[[[0,3.5],[7,11.2],[15,11.9],[30,7],[42,.7],[52,.7],[56,7.7],[59,.7],[64,.7],[64,0],[5,0],[0,3.5]],[[13,16.1],[19,14.7],[16,21.7],[11,23.1],[13,16.1]],[[12,32.2],[14,38.5],[15,38.5],[13,32.2],[12,32.2]],[[16,47.6],[12,53.2],[13,53.2],[18,47.6],[16,47.6]],[[6,64.4],[8,70],[9,70],[8,64.4],[6,64.4]],[[23,82.6],[29,79.8],[30,79.8],[25,82.6],[23,82.6]],[[37,70.7],[43,62.3],[44,62.3],[39,70.7],[37,70.7]],[[48,51.1],[51,45.5],[53,45.5],[50,51.1],[48,51.1]],[[51,35],[51,28.7],[53,28.7],[53,35],[51,35]],[[52,22.4],[55,17.5],[56,17.5],[53,22.4],[52,22.4]],[[58,12.6],[62,7],[63,7],[60,12.6],[58,12.6]],[[0,3.5],[0,93.1],[64,93.1],[64,0],[63,0],[63,92.4],[1,92.4],[1,3.5],[0,3.5]]],n=0;n<t.length;n++)for(var r=0;r<t[n].length;r++)t[n][r][0]/=10.5,t[n][r][1]/=-14,t[n][r][0]+=e[0],t[n][r][1]+=e[1];var i=(t=[].concat((0,o.Z)(t),[[[129.39,23.88],[129.46,24.11]],[[129.49,23.38],[129.49,23.61]],[[129.69,23.9],[129.88,24.01]],[[127.86,23.08],[127.86,22.81]],[[128.69,22.58],[128.69,22.81]],[[129.89,22.08],[129.96,22.41]],[[128.69,21.02],[128.68,20.98]],[[128.99,21.18],[128.99,20.98]],[[128.09,20.9],[128.09,20.7]],[[127.59,20.38],[127.59,20.29]],[[127.99,20.38],[127.99,20.21]],[[128.69,20.42],[128.69,20.21]],[[128.29,19.78],[128.29,20.01]]])).map((function(t){var n=p([t]);return{type:"Feature",geometry:{type:"Polygon",coordinates:n.coordinates,encodeOffsets:n.encodeOffsets},properties:{cp:e}}}));return i};!function(e){e.NO_DATA="NO_DATA",e.CALC_RUNING="CALC_RUNING"}(u||(u={}));var x,C=n("../packages/common-utils/src/client/safe.ts"),T=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{c(r.next(e))}catch(t){o(t)}}function a(e){try{c(r.throw(e))}catch(t){o(t)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))};!function(e){e.CHINA="china",e.CHINA_CITIES="china_cities",e.PROVINCE="province"}(x||(x={}));var j=[{layoutSize:"115%",layoutCenter:["45%","50%"]},{layoutSize:"105%",layoutCenter:["45%","53%"]},{layoutSize:"108%",layoutCenter:["45%","54%"]},{layoutSize:"102%",layoutCenter:["45%","56%"]}],O=function(e){return"string"===typeof e&&(e=parseFloat(e)),e},E=function(e,t){var n=new Map,r=[];return e.forEach((function(e,i){var o=function(e){return e.replace(/省|市|自治区|壮族|回族|维吾尔|特别|行政区|中国/gi,"")}(t[i].trim()),s=O(e);n.get(o)||!function(e){return-1!=f.P.indexOf(e)}(o)||Number.isNaN(s)||(r.push({name:o,value:s}),n.set(o,!0))})),r},_=function(e){var t={min:0,max:100};if(!e.data||0==e.data.length)return t;var n=[];e.data.forEach((function(e){void 0!=e.value&&n.push(e.value)}));var r=function(e){var t=e.map(O);return 0==(t=t.filter((function(e){return!Number.isNaN(e)}))).length?100:Math.max.apply(Math,(0,o.Z)(t))}(n),i=function(e){var t=e.map(O);return 0==(t=t.filter((function(e){return!Number.isNaN(e)}))).length?0:Math.min.apply(Math,(0,o.Z)(t))}(n);return i=(i=r==i?0:i)==r&&0==i?-100:i,Number.isNaN(i)||Number.isNaN(r)?t:{min:i-=r-i,max:r}},L=function(e){function t(t){var n;return(n=e.call(this,t)||this).type=d.Z.GEO_CHART,n.loaded=!1,n}(0,i.Z)(t,e);var r=t.prototype;return r.draw=function(t,n,r){var i,o=Object.create(null,{draw:{get:function(){return e.prototype.draw}},getMap:{get:function(){return e.prototype.getMap}}});return T(this,void 0,void 0,regeneratorRuntime.mark((function e(){var s,a,c=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=function(){if(o.draw.call(c,t,n,r),t.isEmpty())c.drawEmpty();else try{var e=c.transformToOptions(t,n);c.drawEchart(e)}catch(i){c.drawEmpty()}},a=(null===(i=null===n||void 0===n?void 0:n.seriesConfigs)||void 0===i?void 0:i.map)||x.CHINA,e.next=4,o.getMap.call(this,a);case 4:e.sent?s():this.loadOfflineMap(a,(function(){s()}));case 6:case"end":return e.stop()}}),e,this)})))},r.loadOfflineMap=function(t,r){var i=Object.create(null,{registerMap:{get:function(){return e.prototype.registerMap}}});return T(this,void 0,void 0,regeneratorRuntime.mark((function e(){var o,s;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.t0=t,e.next=e.t0===x.CHINA?3:e.t0===x.CHINA_CITIES?11:(e.t0,x.PROVINCE,16);break;case 3:return e.next=5,n.e("bundle_offline_map").then(n.t.bind(n,"../node_modules/echarts/map/json/china.json",19));case 5:return o=e.sent,o=y(o),e.next=9,i.registerMap.call(this,x.CHINA,o,{});case 9:this.loaded=!0,r();case 11:return s=n.e("bundle_offline_map").then(n.t.bind(n,"../node_modules/echarts/map/json/china-cities.json",19)),e.next=14,i.registerMap.call(this,x.CHINA_CITIES,s,{});case 14:this.loaded=!0,r();case 16:case"end":return e.stop()}}),e,this)})))},r.transformToOptions=function(e,t){var n=this,r=this.getBaseOptions(t),i=e.toSeriesDatas(),o=e.toLegendData(),s=e.toXAxisData();t.seriesConfigs=t.seriesConfigs||new a.Z({});var d=0;t.titleConfigs&&(d=(t.titleConfigs.hasTitle()?1:0)+(t.titleConfigs.hasSubtitle()?2:0));var l=[];if(i.forEach((function(e,r){var i=E(e,s),c=new a.Z({});c.setProperties(Object.assign(Object.assign({name:o[r],data:i},n.chartLayout.getGeoLabelFontInfo()),j[d]));var u=t.seriesConfigs?Object.assign(t.seriesConfigs.toOptions(),c.toOptions()):c.toOptions();l.push(u)})),r.series=l,0==l.length)throw new Error(u.NO_DATA);var f=_(l[0]),p=f.min,g=f.max,m=t.visualMap||new h({});return m.setProperties(Object.assign({show:this.chartLayout.isVisualMapShow(),inRange:{color:["#FFFFFF","#1E6FFF"]},min:p,max:g},this.chartLayout.getVisualMapRect())),r.visualMap=m.toOptions(),r.tooltip=this.getTooltipOptions(t.tooltipConfigs||new c.ZP({trigger:c.ov.ITEM,formatter:function(e){var t,n,i="";(null===(t=null===e||void 0===e?void 0:e.seriesName)||void 0===t?void 0:t.length)&&(i+=(0,c.j3)((0,C.r)(e.seriesName),c.Tc),i+="<br />"),i=(0,C.r)(null!==(n=e.name)&&void 0!==n?n:"")+"<br />";var o=r.series;return o?(o.forEach((function(t){if(!t.data)return null;t.data.forEach((function(n){n.name===e.name&&(i+=(0,c.j3)(""+(0,c.UD)(e.color||"")+(0,C.r)(t.name),c.Tc),i+=(0,c.j3)(": "+(0,C.r)(String(n.value||"-")))+"<br />")}))})),i):i}})),r},t}(s.Z)},"../spread-sheet/src/core/view/level-2/chart/alloy-charts/chart-render/configs/AxisConfigs.ts":function(e,t,n){n.d(t,{VA:function(){return s},Ye:function(){return o},mb:function(){return r},we:function(){return i}}),n("../node_modules/core-js/modules/es.function.name.js"),n("../node_modules/core-js/modules/es.object.assign.js");var r,i,o,s,a=n("../spread-sheet/src/core/view/level-2/chart/alloy-charts/chart-render/configs/base.ts");!function(e){e.TOP="top",e.BOTTOM="bottom",e.LEFT="left",e.RIGHT="right"}(r||(r={})),function(e){e.VALUE="value",e.CATEGORY="category",e.TIME="time",e.LOG="log"}(i||(i={})),function(e){e.START="start",e.CENTER="center",e.END="end"}(o||(o={})),function(e){e.IN="in",e.OUT="out",e.NONE="none"}(s||(s={}));var c=function(){function e(e){this.setProperties(e)}var t=e.prototype;return t.setProperties=function(e){"undefined"!==typeof e.type&&(this.type=e.type),"undefined"!==typeof e.name&&(this.name=e.name),"undefined"!==typeof e.nameLocation&&(this.nameLocation=e.nameLocation),"undefined"!==typeof e.nameTextStyle&&(this.nameTextStyle=e.nameTextStyle),"undefined"!==typeof e.data&&(this.data=e.data),"undefined"!==typeof e.tickPosition&&(this.tickPosition=e.tickPosition),"undefined"!==typeof e.tickTextStyle&&(this.tickTextStyle=e.tickTextStyle),"undefined"!==typeof e.tickLabelSlant&&(this.tickLabelSlant=e.tickLabelSlant),"undefined"!==typeof e.formatter&&(this.formatter=e.formatter)},t.toOptions=function(){var e={};return"undefined"!==typeof this.type&&(e.type=this.type),"undefined"!==typeof this.name&&(e.name=this.name),"undefined"!==typeof this.nameLocation&&(e.nameLocation=this.nameLocation),"undefined"!==typeof this.nameTextStyle&&(e.nameTextStyle=(0,a.P)(this.nameTextStyle)),"undefined"!==typeof this.data&&(e.data=this.data),e.axisTick=this.toAxisTick(),e.axisLabel=this.toAxisLabel(),e},t.toAxisTick=function(){return this.tickPosition===s.NONE?{show:!1}:{show:!0,inside:this.tickPosition===s.IN}},t.toAxisLabel=function(){if(this.tickPosition===s.NONE)return{show:!1};var e={show:!0,inside:this.tickPosition===s.IN,interval:0};return"undefined"!==typeof this.tickLabelSlant&&(e.rotate=this.tickLabelSlant),"undefined"!==typeof this.formatter&&(e.formatter=this.formatter),"undefined"!==typeof this.tickTextStyle&&Object.assign(e,(0,a.P)(this.tickTextStyle)),e},e}();t.ZP=c},"../spread-sheet/src/core/view/level-2/chart/alloy-charts/chart-render/configs/GridConfigs.ts":function(e,t){var n=function(){function e(e){this.setProperties(e)}var t=e.prototype;return t.setProperties=function(e){"undefined"!==typeof e.left&&(this.left=e.left),"undefined"!==typeof e.top&&(this.top=e.top),"undefined"!==typeof e.width&&(this.width=e.width),"undefined"!==typeof e.height&&(this.height=e.height),"undefined"!==typeof e.backgroundColor&&(this.backgroundColor=e.backgroundColor)},t.toOptions=function(){var e={containLabel:!0};return"undefined"!==typeof this.left&&(e.left=this.left),"undefined"!==typeof this.top&&(e.top=this.top),"undefined"!==typeof this.width&&(e.width=this.width),"undefined"!==typeof this.height&&(e.height=this.height),"undefined"!==typeof this.backgroundColor&&(e.show=!0,e.backgroundColor=this.backgroundColor),e},e}();t.Z=n},"../spread-sheet/src/core/view/level-2/chart/alloy-charts/chart-render/configs/LegendConfigs.ts":function(e,t,n){n.d(t,{ll:function(){return s},qB:function(){return c},tV:function(){return i}});var r,i,o,s,a=n("../spread-sheet/src/core/view/level-2/chart/alloy-charts/chart-render/configs/base.ts");!function(e){e.PLAIN="plain",e.SCROLL="scroll"}(r||(r={})),function(e){e.NONE="none",e.BOTTOM="bottom",e.LEFT="left",e.RIGHT="right",e.TOP="top",e.INSIDE="inside"}(i||(i={})),function(e){e.MULTIPLE="multiple",e.SINGLE="single",e.NONE="none"}(o||(o={})),function(e){e.CIRCLE="circle",e.RECT="rect",e.ROUNDRECT="roundRect",e.TRIANGLE="triangle",e.DIAMOND="diamond",e.PIN="pin",e.ARROW="arrow",e.NONE="none",e.DEFAULT=""}(s||(s={}));var c=16,d=function(){function e(e){this.setProperties(e)}var t=e.prototype;return t.setProperties=function(e){"undefined"!==typeof e.type&&(this.type=e.type),"undefined"!==typeof e.position&&(this.position=e.position),"undefined"!==typeof e.data&&(this.data=e.data),"undefined"!==typeof e.selectedMode&&(this.selectedMode=e.selectedMode),"undefined"!==typeof e.inactiveColor&&(this.inactiveColor=e.inactiveColor),"undefined"!==typeof e.selected&&(this.selected=e.selected),"undefined"!==typeof e.formatter&&(this.formatter=e.formatter),"undefined"!==typeof e.textStyle&&(this.textStyle=e.textStyle),"undefined"!==typeof e.icon&&(this.icon=e.icon)},t.toOptions=function(){if(this.position===i.NONE)return{show:!1};var e={show:!0};e.type=this.type||r.SCROLL;var t,n=this.position||i.BOTTOM;return e.padding=this._toLegendPadding(n),e.orient=this._toLegendOrient(n),"undefined"!==typeof this.data&&(e.data=this.data),t=this.selectedMode===o.MULTIPLE?"multiple":this.selectedMode===o.SINGLE&&"single",e.selectedMode=t,"undefined"!==typeof this.inactiveColor&&(e.inactiveColor=this.inactiveColor),"undefined"!==typeof this.selected&&(e.selected=this.selected),"undefined"!==typeof this.formatter&&(e.formatter=this.formatter),"undefined"!==typeof this.textStyle&&(e.textStyle=(0,a.P)(this.textStyle)),"undefined"!==typeof this.icon&&(e.icon=this.icon),e},t._toLegendOrient=function(e){switch(e){case i.LEFT:case i.RIGHT:return"vertical";case i.BOTTOM:case i.TOP:default:return"horizontal"}},t._toLegendPadding=function(e){switch(e){case i.BOTTOM:return[c,0,0,0];case i.TOP:return[0,0,c,0];default:return 0}},e}();t.ZP=d},"../spread-sheet/src/core/view/level-2/chart/alloy-charts/chart-render/configs/ProvinceConfig.ts":function(e,t,n){n.d(t,{P:function(){return i}});var r=n("../node_modules/i18next/dist/esm/i18next.js"),i=[r.ZP.t("北京"),r.ZP.t("天津"),r.ZP.t("上海"),r.ZP.t("重庆"),r.ZP.t("河北"),r.ZP.t("山西"),r.ZP.t("辽宁"),r.ZP.t("吉林"),r.ZP.t("黑龙江"),r.ZP.t("江苏"),r.ZP.t("浙江"),r.ZP.t("安徽"),r.ZP.t("福建"),r.ZP.t("江西"),r.ZP.t("山东"),r.ZP.t("河南"),r.ZP.t("湖北"),r.ZP.t("湖南"),r.ZP.t("广东"),r.ZP.t("海南"),r.ZP.t("四川"),r.ZP.t("贵州"),r.ZP.t("云南"),r.ZP.t("陕西"),r.ZP.t("甘肃"),r.ZP.t("青海"),r.ZP.t("台湾"),r.ZP.t("内蒙古"),r.ZP.t("广西"),r.ZP.t("西藏"),r.ZP.t("宁夏"),r.ZP.t("新疆"),r.ZP.t("香港"),r.ZP.t("澳门")]},"../spread-sheet/src/core/view/level-2/chart/alloy-charts/chart-render/configs/TitleConfigs.ts":function(e,t,n){n.d(t,{W:function(){return r}}),n("../node_modules/core-js/modules/es.object.assign.js");var r,i=n("../spread-sheet/src/core/view/level-2/chart/alloy-charts/chart-render/configs/base.ts");!function(e){e.LEFT="left",e.CENTER="center",e.RIGHT="right"}(r||(r={}));var o={fontSize:16,color:"rgba(0, 0, 0, 0.88)"},s={fontSize:12,color:"rgba(0, 0, 0, 0.4)"},a=function(){function e(e){this.setProperties(e)}var t=e.prototype;return t.hasTitle=function(){return"string"===typeof this.title&&0!==this.title.length},t.hasSubtitle=function(){return"string"===typeof this.subTitle&&0!==this.subTitle.length},t.getTitleLineHeight=function(){var e;return(null===(e=null===this||void 0===this?void 0:this.titleTextStyle)||void 0===e?void 0:e.fontSize)||o.fontSize},t.getSubtitleLineHeight=function(){var e;return(null===(e=null===this||void 0===this?void 0:this.subTitleTextStyle)||void 0===e?void 0:e.fontSize)||s.fontSize},t.getClientHeight=function(){return this.hasTitle()&&this.hasSubtitle()?this.getTitleLineHeight()+6+this.getSubtitleLineHeight()+16:this.hasTitle()?this.getTitleLineHeight()+16:this.hasSubtitle()?this.getSubtitleLineHeight()+16:0},t.setProperties=function(e){this.title=e.title||"",this.titleTextStyle=e.titleTextStyle||{},this.subTitle=e.subTitle||"",this.subTitleTextStyle=e.subTitleTextStyle||{},this.position=e.position||r.CENTER},t.toOptions=function(){if(("undefined"===typeof this.title||0===this.title.length)&&("undefined"===typeof this.subTitle||0===this.subTitle.length))return{show:!1};var e={show:!0,itemGap:this.hasTitle()?6:0,padding:this.hasTitle()||this.hasSubtitle()?[0,0,16,0]:0};return"undefined"!==typeof this.title&&(e.text=this.title,e.textStyle=(0,i.P)(Object.assign(Object.assign({},o),this.titleTextStyle))),"undefined"!==typeof this.subTitle&&(e.subtext=this.subTitle,e.subtextStyle=(0,i.P)(Object.assign(Object.assign({},s),this.subTitleTextStyle))),e},e}();t.Z=a},"../spread-sheet/src/core/view/level-2/chart/alloy-charts/chart-render/configs/TooltipConfigs.ts":function(e,t,n){n.d(t,{Tc:function(){return s},UD:function(){return c},j3:function(){return a},ov:function(){return r}});var r,i,o=n("../spread-sheet/src/core/view/level-2/chart/alloy-charts/chart-render/configs/base.ts");!function(e){e.ITEM="item",e.AXIS="axis",e.NONE="none"}(r||(r={})),function(e){e.TOP="top",e.BOTTOM="bottom",e.LEFT="left",e.RIGHT="right",e.INSIDE="inside"}(i||(i={}));var s=200,a=function(e,t){return void 0===t&&(t=s),'<span style="display: inline-block; width:auto; max-width:'+t+'px; overflow:hidden; white-space:nowrap; text-overflow: ellipsis;">'+e+"</span>"},c=function(e){return'<span style="display:inline-block;margin-right:5px;border-radius:10px;width:10px;height:10px;background-color: '+e+'"></span>'},d=function(){function e(e){this.setProperties(e)}var t=e.prototype;return t.setProperties=function(e){"boolean"===typeof e.show&&(this.show=e.show),this.trigger=e.trigger||r.ITEM,this.position=e.position||i.TOP,"undefined"!==typeof e.formatter&&(this.formatter=e.formatter),"undefined"!==typeof e.backgroundColor&&(this.backgroundColor=e.backgroundColor),"undefined"!==typeof e.borderColor&&(this.borderColor=e.borderColor),"undefined"!==typeof e.borderWidth&&(this.borderWidth=e.borderWidth),"undefined"!==typeof e.textStyle&&(this.textStyle=e.textStyle)},t.toOptions=function(){if("boolean"===typeof this.show&&!this.show)return{show:!1};var e={confine:!0};return e.trigger=this.trigger,e.position=this.position,"undefined"!==typeof this.formatter&&(e.formatter=this.formatter),"undefined"!==typeof this.backgroundColor&&(e.backgroundColor=this.backgroundColor),"undefined"!==typeof this.borderColor&&(e.borderColor=this.borderColor),"undefined"!==typeof this.borderWidth&&(e.borderWidth=this.borderWidth),"undefined"!==typeof this.padding&&(e.padding=this.padding),"undefined"!==typeof this.textStyle&&(e.textStyle=(0,o.P)(this.textStyle)),e},e}();t.ZP=d},"../spread-sheet/src/core/view/level-2/chart/alloy-charts/chart-render/configs/XAxisConfigs.ts":function(e,t,n){var r=n("../node_modules/@babel/runtime/helpers/esm/inheritsLoose.js"),i=n("../spread-sheet/src/core/view/level-2/chart/alloy-charts/chart-render/configs/AxisConfigs.ts"),o=function(e){function t(t){var n;return(n=e.call(this,t)||this).setProperties(t),n}(0,r.Z)(t,e);var n=t.prototype;return n.setProperties=function(t){e.prototype.setProperties.call(this,t),"undefined"!==typeof this.position&&(this.position=t.position)},n.toOptions=function(){var t=e.prototype.toOptions.call(this);return"undefined"!==typeof this.position&&(t.position=this.position),"undefined"===typeof t.type&&(t.type=i.we.CATEGORY),t},t}(i.ZP);t.Z=o},"../spread-sheet/src/core/view/level-2/chart/alloy-charts/chart-render/configs/YAxisConfigs.ts":function(e,t,n){var r=n("../node_modules/@babel/runtime/helpers/esm/inheritsLoose.js"),i=n("../spread-sheet/src/core/view/level-2/chart/alloy-charts/chart-render/configs/AxisConfigs.ts"),o=function(e){function t(t){var n;return(n=e.call(this,t)||this).setProperties(t),n}(0,r.Z)(t,e);var n=t.prototype;return n.setProperties=function(t){e.prototype.setProperties.call(this,t),"undefined"!==typeof this.position&&(this.position=t.position)},n.toOptions=function(){var t=e.prototype.toOptions.call(this);return"undefined"!==typeof this.position&&(t.position=this.position),"undefined"===typeof t.type&&(t.type=i.we.VALUE),t},t}(i.ZP);t.Z=o},"../spread-sheet/src/core/view/level-2/chart/alloy-charts/chart-render/configs/base.ts":function(e,t,n){function r(e){var t={};return"undefined"!==typeof e.color&&(t.color=e.color),"undefined"!==typeof e.fontName&&(t.fontFamily=e.fontName),"undefined"!==typeof e.fontSize&&(t.fontSize=e.fontSize),"undefined"!==typeof e.bold&&(t.fontWeight=e.bold?"bold":"normal"),"undefined"!==typeof e.italic&&(t.fontStyle=e.italic?"italic":"normal"),t}n.d(t,{P:function(){return r}}),n("../node_modules/core-js/modules/es.string.bold.js"),n("../node_modules/core-js/modules/es.string.italics.js")},"../spread-sheet/src/core/view/level-2/chart/alloy-charts/chart-render/configs/series/GeoSeriesConfigs.ts":function(e,t,n){n("../node_modules/core-js/modules/es.array.map.js"),n("../node_modules/core-js/modules/es.function.name.js");var r=n("../spread-sheet/src/core/view/level-2/chart/alloy-charts/chart-render/charts/GeoChart.ts"),i=function(){function e(e){this.map=r.z.CHINA,this.setProperties(e)}var t=e.prototype;return t.setProperties=function(e){"undefined"!==typeof e.name&&(this.name=e.name),"undefined"!==typeof e.data&&(this.data=e.data),"undefined"!==typeof e.map&&(this.map=e.map),"undefined"!==typeof e.showLabel&&(this.showLabel=e.showLabel),"undefined"!==typeof e.layoutSize&&(this.layoutSize=e.layoutSize),"undefined"!==typeof e.layoutCenter&&(this.layoutCenter=e.layoutCenter),"number"===typeof e.labelFontSize&&(this.labelFontSize=e.labelFontSize)},t.toOptions=function(){var e={type:"map",itemStyle:{color:"#F4F4F4",borderColor:"#E5E5E5"},emphasis:{itemStyle:{areaColor:"#3A6CC7"}}};return e.layoutSize=this.layoutSize||"115%",e.layoutCenter=this.layoutCenter||["45%","50%"],"undefined"!==typeof this.name&&(e.name=this.name),"undefined"!==typeof this.data&&(e.data=this.data),"undefined"!==typeof this.map&&(e.map=this.map),"boolean"!==typeof this.showLabel||this.showLabel?e.label={show:!0,color:"#333",fontSize:this.labelFontSize||10}:e.label={show:!1},e},e}();t.Z=i},"../spread-sheet/src/core/view/level-2/chart/charts/chart-data-api.ts":function(e,t,n){n.d(t,{H:function(){return l}}),n("../node_modules/regenerator-runtime/runtime.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.promise.js");var r=n("../packages/utils/src/index.ts"),i=n("../packages/model/src/new-embedded/EmbeddedObjectType.ts"),o=n("../packages/model/src/range/GridRange.ts"),s=n("../packages/model/src/range/hexRangeUtils.ts"),a=n("../spread-sheet/src/core/view/level-2/chart/charts/ChartsUtils.ts"),c=n("../spread-sheet/src/core/network/datacenter/utils/load-cross-table-data.ts"),d=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{c(r.next(e))}catch(t){o(t)}}function a(e){try{c(r.throw(e))}catch(t){o(t)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))},l=new(function(){function e(){}var t=e.prototype;return t.init=function(e){this.app=e},t.add=function(e){return d(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n,i,o,c;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=r.kk.getRandomId(),i=(0,a.YS)(this.app,n,e),o=this.app.spreadsheet.activeSheetId,c=(0,s.hex2Range)(e.range,o),t.prev=4,t.next=7,this.app.requestApi.addEmbeddedObject({range:c,objects:[i]});case 7:t.next=12;break;case 9:return t.prev=9,t.t0=t.catch(4),t.abrupt("return","");case 12:return t.abrupt("return",n);case 13:case"end":return t.stop()}}),t,this,[[4,9]])})))},t.delete=function(e){var t=this.app.spreadsheet.activeSheetId;this.app.requestApi.deleteEmbeddedObject({embeddedObjectType:i.Z.CHART,sheetId:t,objectId:e})},t.update=function(e,t){return d(this,void 0,void 0,regeneratorRuntime.mark((function n(){var r,i,d,l,u;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(r=(0,a.j0)(this.app,e,t)){n.next=3;break}return n.abrupt("return");case 3:if(i=(0,s.isRangeCrossTable)(t.range),d=this.app.spreadsheet,l=i?(0,s.getSheetIdByCrossTableRangeString)(t.range,d):d.activeSheetId,!i){n.next=9;break}return n.next=9,(0,c.A)(d,l);case 9:u=""===t.range?new o.Z(l,-1,-1,-1,-1):(0,s.hex2Range)(t.range,l),this.app.requestApi.updateEmbeddedObject({range:u,objects:[r]});case 11:case"end":return n.stop()}}),n,this)})))},t.layoutChange=function(e,t){var n=t.x,r=t.y,i=t.width,o=t.height,s=t.rowIndex,c=t.colIndex,d=(0,a.oI)(this.app.spreadsheet,e,{height:o,width:i,rowIndex:s,colIndex:c,x:n,y:r});if(!d)return null;this.app.requestApi.updateEmbeddedObject({objects:[d]})},e}())},"../spread-sheet/src/core/view/level-2/chart/charts/transform/transform-datas.ts":function(e,t,n){n.d(t,{VJ:function(){return l},ZP:function(){return s},qS:function(){return a},xP:function(){return c}}),n("../node_modules/core-js/modules/es.array.fill.js"),n("../node_modules/core-js/modules/es.array.map.js"),n("../node_modules/core-js/modules/es.object.assign.js");var r=n("../packages/model/src/cell/format/NumberFormatType.ts"),i=n("../packages/common-utils/src/index.ts"),o=n("../spread-sheet/src/core/app/sheetStatus/auth-range.ts");function s(e){var t=e.spreadsheet,s=e.range,u=e.asLegendIndexByUser,h=e.asXAxisIndexByUser,f=e.shouldTranspose;if(!s.isValid())return{renderDatas:[[]],asLegendIndex:u,asXAxisIndex:h};var p=s.clone(),g=[p.startRowIndex,p.startColIndex,p.endRowIndex,p.endColIndex],m=g[0],v=g[1],y=g[2],b=g[3];p.isCol&&(m=0),p.isRow&&(v=0);var w=t.sheetManager.getSheetBySheetId(p.sheetId);if(w){var x=w.getRowCount()-1,C=w.getColCount()-1;p.isCol&&(y=x),p.isRow&&(b=C),y=Math.min(y,x),b=Math.min(b,C)}p.startRowIndex=m,p.startColIndex=v,p.endRowIndex=y,p.endColIndex=b;var T=y-m+1,j=b-v+1,O=function(e,t){var s=[t.sheetId,t.startRowIndex,t.endRowIndex,t.startColIndex,t.endColIndex],a=s[0],c=s[1],d=s[2],l=s[3],u=s[4],h=e.sheetManager.getSheetBySheetId(a);if(!h)return n.g.log.error("图表获取渲染数据, 表格 "+a+" 不存在"),{renderDatas:[[]],cellDatas:[[]]};for(var f=u-l+1,p=function(e){var t={},n={},r=e.data,i=r.rowMetadata,o=r.colMetadata;return i&&(t=i.reduce((function(e,t,n){return t&&(t.hiddenByUser||t.hiddenByFilter)?Object.assign(Object.assign({},e),((r={})[n]=!0,r)):e;var r}),{})),o&&(n=o.reduce((function(e,t,n){return t&&(t.hiddenByUser||t.hiddenByFilter)?Object.assign(Object.assign({},e),((r={})[n]=!0,r)):e;var r}),{})),{hiddenRowMap:t,hiddenColMap:n}}(h),g=p.hiddenRowMap,m=p.hiddenColMap,v=[],y=[],b=c;b<=d;b++){var w=[],x=[];if(g[b])v.push(Array(f).fill("")),y.push(Array(f).fill(null));else{for(var C=l;C<=u;C++)if(m[C]||(0,o.tE)(e.parent,b,C,a))w.push(""),x.push(null);else{var T=h.getCellDataAtPosition(b,C);if(x.push(T),T){var j=T.getUserEnteredFormat(),O=null===j||void 0===j?void 0:j.getNumberFormat(),E=null===O||void 0===O?void 0:O.type;if(E!==r.Z.TIME)if(E!==r.Z.TEXT){var _=T.getEffectiveValue();if(_){var L=_.value;(0,i.hj)(L)||(0,i.HD)(L)?w.push(L):w.push("")}else w.push("")}else w.push(T.getEditValue()||"");else w.push("")}else w.push("")}v.push(w),y.push(x)}}return{renderDatas:v,cellDatas:y}}(t,p),E=O.renderDatas,_=O.cellDatas,L=function(e,t,n){for(var r={},o={},s=0;s<t;s++)e[s].reduce((function(e,t){return!((0,i.hj)(t)||t.length>0)&&e}),!0)||(r[s]=!0);for(var a=function(t){e.map((function(e){return e[t]})).reduce((function(e,t){return!((0,i.hj)(t)||t.length>0)&&e}),!0)||(o[t]=!0)},c=0;c<n;c++)a(c);return{renderRowMap:r,renderColMap:o}}(E,T,j),S=a({renderDatas:E,cellDatas:_,renderRowMap:L.renderRowMap,renderColMap:L.renderColMap,rowCount:T,colCount:j}),P=S.renderDatas,I=S.cellDatas;if(c(P))return{renderDatas:[[]],asLegendIndex:-1,asXAxisIndex:-1};if(f){P=d(P),I=d(I);var R=[j,T];T=R[0],j=R[1]}var k=function(e){var t=e.renderDatas,n=e.asLegendIndexByUser,r=e.asXAxisIndexByUser;return l(t[0])&&0,l(t.map((function(e){return e[0]})))&&0,{asLegendIndex:-1!==n?0:-1,asXAxisIndex:-1!==r?0:-1}}({renderDatas:P,asLegendIndexByUser:u,asXAxisIndexByUser:h}),Z=k.asLegendIndex,A=k.asXAxisIndex;return-1!==Z&&(function(e,t,n){for(var r=e,i=n,o=r[0].length,s=0;s<o;s++){var a=t[i][s];if(a){var c=a.getFormattedValue();if(c){var d=c.value;d&&(r[i][s]=d)}else{var l=a.getEffectiveValue();if(!l)continue;var u=l.value;u&&"object"===typeof u&&(r[i][s]=u.displayText||"")}}}}(P,I,Z),Z=0),-1!==A&&(function(e,t,n){for(var r=e,i=n,o=r.length,s=0;s<o;s++){var a=t[s][i];if(a){var c=a.getFormattedValue();if(c){var d=c.value;d&&(r[s][i]=d)}else{var l=a.getEffectiveValue();if(!l)continue;var u=l.value;u&&"object"===typeof u&&(r[s][i]=u.displayText||"")}}}}(P,I,A),A=0),{renderDatas:P,asLegendIndex:Z,asXAxisIndex:A}}function a(e){for(var t=e.renderDatas,n=e.cellDatas,r=e.renderRowMap,i=e.renderColMap,o=e.rowCount,s=e.colCount,a=[],c=[],d=0;d<o;d++)if(r[d]){for(var l=[],u=[],h=0;h<s;h++)i[h]&&(l.push(t[d][h]),u.push(n[d][h]));a.push(l),c.push(u)}return{renderDatas:a,cellDatas:c}}function c(e){return 0===e.length||0===e[0].length||1===e.length&&1===e[0].length}function d(e){for(var t=[],n=e.length,r=e[0].length,i=0;i<r;i++){t.push([]);for(var o=0;o<n;o++)t[i].push(e[o][i])}return t}function l(e){var t=e.reduce((function(e,t){return(0,i.hj)(t)?e+1:e}),0);return e.length-t>t}},"../spread-sheet/src/core/view/level-2/chart/charts/transform/transform.ts":function(e,t,n){n.d(t,{vs:function(){return j},eo:function(){return O},Pd:function(){return L}}),n("../node_modules/core-js/modules/es.string.bold.js"),n("../node_modules/core-js/modules/es.string.italics.js");var r=n("../packages/model/src/new-embedded/chart/ChartType.ts"),i=(n("../node_modules/core-js/modules/es.array.map.js"),n("../spread-sheet/src/core/view/level-2/chart/alloy-charts/chart-render/configs/AxisConfigs.ts")),o=n("../spread-sheet/src/core/view/level-2/chart/alloy-charts/chart-render/configs/XAxisConfigs.ts"),s=n("../spread-sheet/src/core/view/level-2/chart/alloy-charts/chart-render/configs/YAxisConfigs.ts"),a=n("../packages/model/src/new-embedded/chart/TickPosition.ts"),c=n("../packages/model/src/cell/format/HorizontalAlign.ts");function d(e){var t={},n=e.title||null;if(null===n||void 0===n?void 0:n.text){n.text&&(t.name=n.text);var r=n.style;r&&(t.nameTextStyle=L(r),t.nameLocation=function(e){switch(e){case c.Z.LEFT:return i.Ye.START;case c.Z.RIGHT:return i.Ye.END;case c.Z.CENTER:default:return i.Ye.CENTER}}(r.alignment))}return e.reversed&&(t.inverse=!0),"number"===typeof e.minValue&&(t.min=e.minValue),"number"===typeof e.maxValue&&(t.max=e.maxValue),void 0!==e.tickPosition&&(t.tickPosition=function(e){switch(e){case a.Z.IN:return i.VA.IN;case a.Z.NONE:return i.VA.NONE;case a.Z.OUT:default:return i.VA.OUT}}(e.tickPosition)),e.tickTextStyle&&(t.tickTextStyle=L(e.tickTextStyle)),"number"===typeof e.labelSlant&&(t.tickLabelSlant=e.labelSlant),t}var l=n("../spread-sheet/src/core/view/level-2/chart/alloy-charts/chart-render/configs/GridConfigs.ts"),u=n("../packages/model/src/new-embedded/chart/Unit.ts"),h=n("../packages/model/src/new-embedded/chart/RegionCode.ts"),f=n("../spread-sheet/src/core/view/level-2/chart/alloy-charts/chart-render/configs/series/GeoSeriesConfigs.ts"),p=n("../spread-sheet/src/core/view/level-2/chart/alloy-charts/chart-render/charts/GeoChart.ts");function g(e){return h.Z.China,p.z.CHINA}var m=n("../packages/model/src/new-embedded/chart/LegendPositionType.ts"),v=n("../spread-sheet/src/core/view/level-2/chart/alloy-charts/chart-render/configs/LegendConfigs.ts");function y(e){return e?new v.ZP({position:b(e.positionType),textStyle:L(e.textStyle)}):null}function b(e){switch(e){case m.Z.NONE:return v.tV.NONE;case m.Z.BOTTOM_LEGEND:return v.tV.BOTTOM;case m.Z.LEFT_LEGEND:return v.tV.LEFT;case m.Z.RIGHT_LEGEND:return v.tV.RIGHT;case m.Z.TOP_LEGEND:return v.tV.TOP;case m.Z.INSIDE_LEGEND:return v.tV.INSIDE}}var w=n("../spread-sheet/src/core/view/level-2/chart/alloy-charts/chart-render/configs/TitleConfigs.ts");function x(e,t){return e||t?new w.Z({title:(null===e||void 0===e?void 0:e.text)||"",titleTextStyle:L(null===e||void 0===e?void 0:e.style),subTitle:(null===t||void 0===t?void 0:t.text)||"",subTitleTextStyle:L(null===t||void 0===t?void 0:t.style)}):null}var C=n("../spread-sheet/src/core/view/level-2/chart/charts/transform/transform-datas.ts"),T=n("../packages/report/src/index.ts");function j(e,t,n){var i,o=t.properties.chart;if(!o)return null;var s=t.objectId,a=t.location,c=o.chartModel,d=o.headers,l=o.dataTransformation,u=e.workbookRangeManager.getChartWorkbookRangeById(o.workbookRangeId[0]);if(!u)return null;var h=null,f=u.range;if(f.isValid()){var p=O(d,null===(i=null===l||void 0===l?void 0:l.colInfo)||void 0===i?void 0:i.columnIndex),g=p.asLegendIndex,m=p.asXAxisIndex,v=!!o.transpose,y=(0,C.ZP)({spreadsheet:e,range:f,asLegendIndexByUser:g,asXAxisIndexByUser:m,shouldTranspose:v});h={asLegendIndex:y.asLegendIndex,asXAxisIndex:y.asXAxisIndex,datas:y.renderDatas}}null!==h&&0!==h.datas.length||T.ZP.tdwReport({module:"doc_charts",opername:"rightsight_board",action:"charts_type_non_charts"});var b=c.type||r.Z.COLUMN_CHART;return T.ZP.tdwReport({module:"doc_charts",opername:"rightsight_board",action:"charts_type_success",ver1:b}),{id:s,rect:_(n,a,c.commonOptions),data:{table:h,type:c.type||r.Z.COLUMN_CHART,configs:E(c)}}}function O(e,t){return void 0===e&&(e=-1),void 0===t&&(t=-1),{asLegendIndex:e,asXAxisIndex:t}}function E(e){switch(e.type){case r.Z.BAR_CHART:case r.Z.LINE_CHART:case r.Z.COLUMN_CHART:case r.Z.COMBO_CHART:case r.Z.AREA_CHART:case r.Z.SCATTER_CHART:return function(e){var t={},r=e.commonOptions,a=e.gridChartOptions,c=y(e.legendOptions);if(r){var h=x(r.title,r.subTitle);h&&(t.titleConfigs=h),r.colors&&(t.color=r.colors);var f=function(e){if(!e||!e.contentArea)return null;var t=new l.Z({}),n=e.contentArea,r=n.positionUnit===u.Z.PERCENT,i=n.sizeUnit===u.Z.PERCENT;return"number"===typeof n.left&&(t.left=r?n.left+"%":n.left),"number"===typeof n.top&&(t.top=r?n.top+"%":n.top),"number"===typeof n.width&&(t.width=i?n.width+"%":n.width),"number"===typeof n.height&&(t.height=i?n.height+"%":n.height),t}(r);if(f&&(t.gridConfigs=f),a){var p=function(e){var t=e.seriesAxes||null;if(t){var n=t.primary;if(n){var r=new o.Z(d(n));return r.setProperties({position:i.mb.BOTTOM}),r}}return null}(a);p&&(t.xAxisConfigs=p);var g=function(e){var t=e.seriesAxes||null;if(t){var r=t.secondary;if(null===r||void 0===r?void 0:r.length){var o=r.map((function(e){return new s.Z(d(e))}));if(1===r.length)return o[0].setProperties({position:i.mb.LEFT}),o[0];if(2===r.length)return o[0].setProperties({position:i.mb.LEFT}),o[1].setProperties({position:i.mb.RIGHT}),[o[0],o[1]];n.g.log.error("Error: yAxisConfigs length > 2!!!")}}return null}(a);g&&(t.yAxisConfigs=g)}}return c&&(t.legendConfigs=c),(null===a||void 0===a?void 0:a.totalAnnotations)&&(t.totalAnnotations=a.totalAnnotations),(null===a||void 0===a?void 0:a.stackingType)&&(t.stackingType=a.stackingType),t}(e);case r.Z.PIE_CHART:return function(e){var t={},n=(null===e||void 0===e?void 0:e.commonOptions)||null;if(n){var r=x(n.title,n.subTitle);r&&(t.titleConfigs=r),n.colors&&(t.color=n.colors)}var i=y(e.legendOptions);return i&&(t.legendConfigs=i),t}(e);case r.Z.GEO_CHART:return function(e){var t={},n=(null===e||void 0===e?void 0:e.commonOptions)||null;if(n){var r=x(n.title,n.subTitle);r&&(t.titleConfigs=r),n.colors&&(t.color=n.colors)}var i=(null===e||void 0===e?void 0:e.geoChartOptions)||null;return t.seriesConfigs=function(e){return void 0!==(null===e||void 0===e?void 0:e.region)?e.region:h.Z.China,new f.Z({map:g()})}(i),t}(e);default:n.g.log.error("Error: chart type is null!")}}function _(e,t,n){var r=t.position,i=r.rowIndex,o=r.colIndex,s=t.x||0,a=t.y||0,c=e.getGlobalLeftByCol(o)+s,d=e.getGlobalTopByRow(i)+a,l={};(null===n||void 0===n?void 0:n.backgroundColor)&&(l.fill=n.backgroundColor);var u=n?n.surroundingBorderStyle:null;return(null===u||void 0===u?void 0:u.width)&&(l.strokeWidth=u.width),(null===u||void 0===u?void 0:u.color)&&(l.stroke=u.color),{top:d,left:c,width:t.width||580,height:t.height||400,background:l,zIndex:t.zIndex}}function L(e){return e?{color:e.color,fontSize:e.size,fontName:e.fontFamily,bold:e.bold,italic:e.italic}:{}}}}]),window.jsExecEndTimeStamp=Date.now(),window.cachedPerformanceEntries||(window.cachedPerformanceEntries=[]),window.cachedPerformanceEntries.push({name:"jsExec: js/spread-sheet_src_core_view_level-2_chart_charts_chart-data-api_ts-spread-sheet_src_core_view_-9220ef.e8a5fd0a6c348a500882.js",entryType:"jsExec",startTime:window.jsExecStartTimeStamp,endTime:window.jsExecEndTimeStamp});
//# sourceMappingURL=spread-sheet_src_core_view_level-2_chart_charts_chart-data-api_ts-spread-sheet_src_core_view_-9220ef.e8a5fd0a6c348a500882.js.map