self.window=self,window.jsExecStartTimeStamp=Date.now(),(self.webpackChunk_tencent_alloy_builder=self.webpackChunk_tencent_alloy_builder||[]).push([["spread-sheet_src_core_network_message-center_adapter_MessageCenterAdapter_interface_ts-spread-e88071"],{"../spread-sheet/src/core/network/message-center/adapter/MessageCenterAdapter.interface.ts":function(e,t,n){n.d(t,{s:function(){return o}});var o=(0,n("../node_modules/@tencent/containerized/build/main/index.js").yh)("IMessageCenterAdapter");t.Z=o},"../spread-sheet/src/core/view/level-2/condition-format-center/ui/rulesContainer/RulesContainer.tsx":function(e,t,n){n.d(t,{k:function(){return $e},Z:function(){return nt}});var o=n("../node_modules/@babel/runtime/helpers/esm/inheritsLoose.js"),r=n("../node_modules/i18next/dist/esm/i18next.js"),s=n("react"),i=n.n(s),a=n("../spread-sheet/src/base/index.ts"),l=n("../spread-sheet/src/core/view/level-2/condition-format-center/ui/utils/dataUtils.ts"),c=(n("../node_modules/core-js/modules/web.dom-collections.for-each.js"),n("../node_modules/core-js/modules/es.object.assign.js"),function(){function e(e){this._frames=[],this._blockBoard=e.blockBoard}var t=e.prototype;return t.show=function(e){var t=this._getFrame(),n=e.left-this._blockBoard.offsetX,o=e.top-this._blockBoard.offsetY,r=e.width,s=e.height;Object.assign(t.style,{left:n+"px",top:o+"px",width:r-1+"px",height:s-1+"px",display:"block"}),this._frames.push(t),this._blockBoard.hiddenBoard.append(t)},t.hide=function(){for(var e;e=this._frames.pop();)this._blockBoard.hiddenBoard.remove(e)},t._getFrame=function(){var e=document.createElement("div");return e.classList.add("rule-range-frame-highlight"),e},e}()),d=n("../packages/model/src/range/GridRange.ts"),u=function(){function e(e){var t=this;this._show=function(e){var n=e.startRowIndex,o=e.endRowIndex,r=e.startColIndex,s=e.endColIndex,i=r===d.v?0:t._areaData.getDisplayGlobalLeftByCol(r),a=n===d.v?0:t._areaData.getDisplayGlobalTopByRow(n),l={left:i,top:a,width:s===d.v?t._areaData.col.frozen.displayTotalSize+t._areaData.col.flow.displayTotalSize:t._areaData.getDisplayGlobalRightByCol(s)-i,height:o===d.v?t._areaData.row.frozen.displayTotalSize+t._areaData.row.flow.displayTotalSize:t._areaData.getDisplayGlobalBottomByRow(o)-a};t._topLeft.show(l),t._topRight.show(l),t._bottomLeft.show(l),t._bottomRight.show(l)},this._mainBoard=e.mainBoard,this._areaData=e.areaData,this._topLeft=new c({blockBoard:this._mainBoard.top.left}),this._topRight=new c({blockBoard:this._mainBoard.top.right}),this._bottomLeft=new c({blockBoard:this._mainBoard.bottom.left}),this._bottomRight=new c({blockBoard:this._mainBoard.bottom.right})}var t=e.prototype;return t.show=function(e){e.forEach(this._show)},t.hide=function(){this._topLeft.hide(),this._topRight.hide(),this._bottomLeft.hide(),this._bottomRight.hide()},e}(),p=n("../spread-sheet/src/base/event/event.ts"),m=function(e){function t(){return e.apply(this,arguments)||this}return(0,o.Z)(t,e),t.prototype.render=function(){return s.createElement("ul",null,s.createElement("li",{className:"conditional-format-rule-none"},r.ZP.t("当前未设置任何格式规则")))},t}(s.Component),_=m,h=(n("../node_modules/core-js/modules/es.array.map.js"),n("../node_modules/core-js/modules/es.array.slice.js"),n("../node_modules/core-js/modules/es.object.keys.js"),n("../node_modules/@tencent/dui/lib/components/Tooltip/index.js")),f=(n("../node_modules/core-js/modules/es.string.bold.js"),n("../node_modules/core-js/modules/es.string.italics.js"),n("../packages/model/src/cell/format/index.ts"));function g(e,t){var n=f.Color.createColor(e),o=f.Color.getColorRGBA(n,t),r=o.red,s=o.green,i=o.blue;return 255===r&&255===s&&255===i}function v(e,t){var n=e.bold,o=e.color,r=e.bgColor,s=e.italic,a=e.strikethrough,l=e.underline,c={};return n&&(c.fontWeight="bold"),o&&(c.color=o),s&&(c.fontStyle="italic"),a&&(c.textDecoration=c.textDecoration?c.textDecoration+" line-through":"line-through"),l&&(c.textDecoration=c.textDecoration?c.textDecoration+" underline":"underline"),r?c.backgroundColor=r:c.border="solid 1px #f5f5f5",i().createElement("div",{className:"condition-preview-box",style:c},t)}function C(e,t,n,o){var s=e.minColor,a=e.maxColor,l={},c=[];if(s&&a)for(var d=f.Color.getColorRGBA(f.Color.createColor(s),o),u=d.red,p=d.green,m=d.blue,_=f.Color.getColorRGBA(f.Color.createColor(a),o),h=_.red,v=_.green,C=_.blue,b=0;b<=4;b+=1){var w=b/4,E=u*(1-w)+h*w,y=p*(1-w)+v*w,O=m*(1-w)+C*w;c.push(f.Color.getColorHexCode(f.Color.createColor({red:E,green:y,blue:O,alpha:1}),o))}else l.border="solid 1px #f5f5f5";return i().createElement("div",{className:"condition-preview-box gradient",style:l},c.map((function(e,t){var s={backgroundColor:e};return g(e,o)&&(s.border="solid 1px #ebebeb",s.borderLeft=0===t?void 0:"none",s.borderRight=t===c.length-1?void 0:"none"),i().createElement("div",{style:s,className:"gradient-item"},0===t&&n&&i().createElement("span",{className:"min-max-text"},r.ZP.t("最小")),4===t&&n&&i().createElement("span",{className:"min-max-text"},r.ZP.t("最大")))})),t&&i().createElement("div",{className:"gradient-text"},t))}function b(e,t,n,o){var s=e.negativeColor,a=e.positiveColor,l={};s&&a||(l.border="solid 1px #f5f5f5");var c=s&&a?[{color:s,title:r.ZP.t("负值")},{color:a,title:r.ZP.t("正值")}]:[];return i().createElement("div",{className:"condition-preview-box databar",style:l},c.map((function(e,t){var r=e.color,s=e.title,a={backgroundColor:r};return g(r,o)&&(a.border="solid 1px #ebebeb",a.borderLeft=0===t?void 0:"none",a.borderRight=t===c.length-1?void 0:"none"),i().createElement("div",{style:a,className:"databar-item"},n&&i().createElement("span",{className:"negative-positive-text"},s))})),t&&i().createElement("div",{className:"databar-text"},t))}var w,E=n("../node_modules/@tencent/docs-design-resources/pc/svg/cdn-function-export.js"),y=function(e){function t(t){var n;return(n=e.call(this,t)||this).stopPropagation=function(e){e.stopPropagation()},n}return(0,o.Z)(t,e),t.prototype.render=function(){var e=this.props,t=e.rule,n=e.hover,o=e.select,i=e.modifyRule,a=e.showRule,c=e.onClickRule,d=e.hideRule,u=e.deleteRule,p=e.spreadsheet,m=t.ruleId,_=t.ranges;return s.createElement("li",{className:"conditional-format-rule-item "+(n?"hover":"")+" "+(o?"select":""),onMouseEnter:function(){a(m)},onMouseLeave:function(){d()},onClick:function(){c(m)}},s.createElement("img",{src:(0,E.tzi)(),className:"data-drag"}),s.createElement("div",{className:"inner",onMouseDown:this.stopPropagation,onClick:function(e){e.stopPropagation(),i(m)}},s.createElement("div",{className:"left"},t.booleanCondition&&v(t.booleanCondition.format,"A"),t.gradientCondition&&C(t.gradientCondition,"A",!1,p),t.dataBarCondition&&b(t.dataBarCondition,"A",!1,p)),s.createElement("div",{className:"middle"},s.createElement(h.default,{title:(0,l.Eb)(t)},s.createElement("p",{className:"description"},(0,l.Eb)(t))),s.createElement(h.default,{title:_},s.createElement("p",{className:"range"},_))),s.createElement("div",{className:"right"},s.createElement(h.default,{title:r.ZP.t("修改条件")},s.createElement("img",{src:(0,E.L_)(),className:"btn edit",onClick:function(e){e.stopPropagation(),i(m)}})),s.createElement(h.default,{title:r.ZP.t("删除条件")},s.createElement("img",{src:(0,E.kP3)(),className:"btn delete",onClick:function(e){e.stopPropagation(),u(m)}})))))},t}(s.Component),O=n("../node_modules/react-draggable/dist/react-draggable.js"),x=n.n(O),S=function(e){function t(){var t;return(t=e.apply(this,arguments)||this).state={drapElementY:0,ruleIdsInSelectedCell:[],hoveringRuleIdByHover:""},t.lockClick=!1,t.draggingElement=null,t.overElement={},t.resetPositionElements={},t._getRenderList=function(){var e=t.state,n=e.drapElementY,o=e.hoveringRuleIdByHover,r=e.ruleIdsInSelectedCell,i=t.props,a=i.list,l=i.spreadsheet;return s.createElement(s.Fragment,null,a.map((function(e,i){var a=t.draggingElement&&t.draggingElement.listIndex===i?n:0,c=t.draggingElement&&t.draggingElement.listIndex===i,d=!c&&o===e.ruleId,u=!c&&-1!==r.indexOf(e.ruleId),p=t._getAnimitionClass(i);return s.createElement(s.Fragment,{key:e.ruleId},s.createElement(x(),{position:{x:0,y:a},axis:"y",onStart:t._dragStart,onDrag:t._dragOver,onStop:t._dragEnd},s.createElement("div",{className:"conditional-format-rule-drag "+p,"data-list-index":i,onMouseEnter:function(){t._onMouseEnter(e.ruleId)},onMouseLeave:t._onMouseLeave},s.createElement(y,{rule:e,hover:d,select:u,modifyRule:t.props.modifyRule,showRule:t.props.showRule,hideRule:t.props.hideRule,onClickRule:t._onClick,deleteRule:t.props.deleteRule,spreadsheet:l}))),i<t.props.list.length-1&&s.createElement("div",{className:"divider"}))})))},t._getAnimitionClass=function(e){var n="";return t.draggingElement&&t.overElement[e]&&(n=e>t.draggingElement.listIndex?"drag-up":"drag-down"),t.draggingElement&&t.resetPositionElements[e]&&(n=e>t.draggingElement.listIndex?"reset-down":"reset-up"),n},t._dragStart=function(e,n){var o=parseInt(n.node.dataset.listIndex,10);t.overElement={},t.resetPositionElements={},t.draggingElement={node:n.node,listIndex:o,ruleIndex:t.props.list[o].ruleIndex}},t._dragOver=function(e,n){var o=Object.assign({},t.overElement);if(t.overElement={},t.draggingElement){for(var r=n.y,s=Array.prototype.slice.call(document.getElementsByClassName("conditional-format-rule-drag"),0),i=r>0?1:-1,a=0,l=t.draggingElement.listIndex+i;s[l];l+=i){var c=s[l];if(c&&r*i>a+c.clientHeight/2){var d=parseInt(c.dataset.listIndex,10);t.overElement[d]={node:c,listIndex:d,ruleIndex:t.props.list[d].ruleIndex},a+=c.clientHeight}}Object.keys(o).forEach((function(e){o[e]&&!t.overElement[e]?t.resetPositionElements[e]=o[e]:delete t.resetPositionElements[e]})),t.setState({drapElementY:r})}},t._dragEnd=function(){if(t.draggingElement){var e=t.draggingElement.ruleIndex,n=t.draggingElement.ruleIndex;Object.keys(t.overElement).forEach((function(o){if(t.draggingElement){var r=t.overElement[o].ruleIndex;r>e&&r>n&&(n=r),r<e&&r<n&&(n=r)}}));var o=t.props.list[t.draggingElement.listIndex];t.props.updateRuleIndex(o.ruleId,e,n),t.setState({drapElementY:0}),t.draggingElement=null,t.overElement={},t.resetPositionElements={},e!==n&&(t.lockClick=!0,setTimeout((function(){t.lockClick=!1}),300))}},t._onMouseEnter=function(e){t.setState({hoveringRuleIdByHover:e})},t._onMouseLeave=function(){t.setState({hoveringRuleIdByHover:""})},t._onClick=function(e){t.lockClick||t.props.onClickRule(e)},t}return(0,o.Z)(t,e),t.prototype.render=function(){return s.createElement("ul",{className:"conditional-format-rule-list","data-testid":"conditional-format-rule-list"},this._getRenderList())},t}(s.Component),P=S,R=function(e){function t(){return e.apply(this,arguments)||this}return(0,o.Z)(t,e),t.prototype.render=function(){return s.createElement("div",{className:"conditional-format-split",style:{marginLeft:this.props.padding||0,marginRight:this.props.padding||0}})},t}(s.Component),T=R,I=function(e){function t(){return e.apply(this,arguments)||this}return(0,o.Z)(t,e),t.prototype.render=function(){return s.createElement("div",{className:"conditional-format-footer-line"},s.createElement("div",{className:"conditional-format-footer-btn",onClick:this.props.onClick},s.createElement("i",{className:"conditional-format-add"}),s.createElement("span",null,this.props.wording)))},t}(s.Component),j=I,k=function(e){function t(){var t;return(t=e.apply(this,arguments)||this)._updateSelection=function(){t.forceUpdate()},t}(0,o.Z)(t,e);var n=t.prototype;return n.componentDidMount=function(){this.modifySelectionDisposable=this.props.normalSelectData.onModifySelectData(this._updateSelection)},n.componentWillUnmount=function(){this.modifySelectionDisposable.dispose()},n.render=function(){return s.createElement("div",{className:"conditional-format-footer-line"},s.createElement("div",{className:"conditional-format-footer-btn",onClick:this.props.onClick},s.createElement("i",{className:"conditional-format-manage"}),s.createElement("span",null,r.ZP.t("管理条件格式"),s.createElement("span",{className:"conditional-format-rules-number"},"(",this.props.getRulesNumber(),")"))))},t}(s.Component),N=k,Z=n("../packages/report/src/index.ts"),D=function(e){function t(){var t;return(t=e.apply(this,arguments)||this)._handleSelectionChange=function(){t.props.panelState===$e.MANAGER&&t.forceUpdate()},t}(0,o.Z)(t,e);var n=t.prototype;return n.componentDidMount=function(){this.modifySelectionDisposable=this.props.normalSelectData.onModifySelectData(this._handleSelectionChange)},n.componentWillUnmount=function(){this.modifySelectionDisposable.dispose()},n.render=function(){switch(this.props.panelState){case $e.MANAGER:return this._renderManager();case $e.EDITOR:return this._renderEditor();default:return null}},n._renderManager=function(){var e=this;return s.createElement("div",{className:"conditional-format-footer"},s.createElement(j,{wording:this.props.conditionFormat.getRuleListCountWithCurrentSelection()>0?r.ZP.t("添加其他规则"):r.ZP.t("添加新规则"),onClick:function(){var t,n;null===(n=(t=e.props).addRule)||void 0===n||n.call(t)}}))},n._renderEditor=function(){var e=this;return s.createElement("div",{className:"conditional-format-footer"},s.createElement(N,{onClick:function(){var t,n;null===(n=(t=e.props).managerRule)||void 0===n||n.call(t),Z.ZP.tdwReport({module:"conditional_format",opername:"doc_excel_editor",action:"organize_format"})},getRulesNumber:function(){return e.props.conditionFormat.getRuleListCountWithCurrentSelection()},normalSelectData:this.props.normalSelectData}))},t}(s.Component),A=D,L=n("../node_modules/classnames/index.js"),M=n.n(L),F=n("../packages/model/src/range/index.ts");!function(e){e.ALL="ALL",e.SELECTION="SELECTION"}(w||(w={}));var B,U,H=function(e){function t(t){var n;(n=e.call(this,t)||this)._handleTabClick=function(e){n.setState({showType:e},(function(){n._updateRulesList()}))},n._handleSelectionChange=function(){n._updateRulesList()},n._handleDataChange=function(){n._updateRulesList()},n._showHighlight=function(e){n._hoverRuleId=e;var t=n.props.conditionFormat.getRuleById(e);t&&n._ruleRangeHighlightStage.show(t.rule.ruleRanges)},n._hideHighlight=function(){n._hoverRuleId="",n._ruleRangeHighlightStage.hide()},n._onClickRule=function(e){n._hoverRuleId=e;var t=n.props.conditionFormat.getRuleById(e);if(t){var o=n.props.spreadsheet.activeSheet,r=t.rule.ruleRanges[0],s=r.startColIndex===F.DEFAULT_DIMENSION_INDEX?0:r.startColIndex,i=r.startRowIndex===F.DEFAULT_DIMENSION_INDEX?0:r.startRowIndex,a=r.endColIndex===F.DEFAULT_DIMENSION_INDEX||r.endColIndex>=o.getColCount()?o.getColCount()-1:r.endColIndex,l=r.endRowIndex===F.DEFAULT_DIMENSION_INDEX||r.endRowIndex>=o.getRowCount()?o.getRowCount()-1:r.endRowIndex;n.props.spreadsheet.parent.view.canvas.selectApi.selectCells(n.props.spreadsheet.parent.view.canvas.normalSelectData,{xRange:[s,a],yRange:[i,l]},null),n.props.spreadsheet.parent.view.canvas.scrollApi.scrollToVisible({row:i,col:s}),Z.ZP.kvrOss({itemname:"xls_condform_panel_rule_click"})}},n._deleteRule=function(e){n.props.deleteConditionFormat(e),(0,l.V4)("rule_manage_panel_del"),Z.ZP.kvrOss({itemname:"xls_condform_panel_rule_delete"}),Z.ZP.kvrOss({itemname:"xls_condform_panel_rule_delete_done"})},n._editRule=function(e){n._hideHighlight(),n.props.editRule(e),(0,l.V4)("rule_manage_panel_edit"),Z.ZP.kvrOss({itemname:"xls_condform_panel_rule_edit"})};var o=(0,l.M3)(n.props.conditionFormat,n.props.spreadsheet.activeSheet,n.props.spreadsheet).length?w.SELECTION:w.ALL;return n.state={showType:o,ruleList:[]},n._hoverRuleId="",n._ruleRangeHighlightStage=new u({mainBoard:n.props.mainBoard,areaData:n.props.areaData}),n}(0,o.Z)(t,e);var n=t.prototype;return n.componentWillMount=function(){this._updateRulesList()},n.componentDidMount=function(){this._modifySelectionDisposable=this.props.normalSelectData.onModifySelectData(this._handleSelectionChange),this.props.mutationBehavior.emitter.on(this.props.mutationBehavior.EVENT.DATA_CHANGE,this._handleDataChange),p.ZP.spreadsheetEvent.listen(a.Z.EVENT_NAME.DATA_CHANGE,this._handleDataChange),(0,l.V4)("rule_manage_init_show")},n.componentWillUnmount=function(){this._modifySelectionDisposable.dispose(),this.props.mutationBehavior.emitter.off(this.props.mutationBehavior.EVENT.DATA_CHANGE,this._handleDataChange),p.ZP.spreadsheetEvent.remove(a.Z.EVENT_NAME.DATA_CHANGE,this._handleDataChange)},n.render=function(){var e=this,t=this.state.showType;return s.createElement(s.Fragment,null,s.createElement("div",{className:"conditional-format-tab"},s.createElement("p",{className:M()("tab-item",{active:t===w.SELECTION}),onClick:function(){return e._handleTabClick(w.SELECTION)}},r.ZP.t("选中区域")),s.createElement("p",{className:M()("tab-item",{active:t===w.ALL}),onClick:function(){return e._handleTabClick(w.ALL)}},r.ZP.t("当前工作表"))),s.createElement("div",{className:"conditional-format-manage-body mt-8"},this._renderRulesList()),s.createElement(T,{padding:16}),s.createElement("div",{className:"mb-8"}),s.createElement(A,{conditionFormat:this.props.conditionFormat,normalSelectData:this.props.normalSelectData,panelState:$e.MANAGER,addRule:this.props.addRule}))},n._updateRulesList=function(){var e=this.state.showType===w.SELECTION?(0,l.M3)(this.props.conditionFormat,this.props.spreadsheet.activeSheet,this.props.spreadsheet):(0,l.UY)(this.props.conditionFormat,this.props.spreadsheet.activeSheet,this.props.spreadsheet);this._hideHighlight(),this.setState({ruleList:e})},n._renderRulesList=function(){var e=this.state.ruleList;return e.length<1?s.createElement(_,null):s.createElement(P,{spreadsheet:this.props.spreadsheet,list:e,modifyRule:this._editRule,showRule:this._showHighlight,hideRule:this._hideHighlight,onClickRule:this._onClickRule,deleteRule:this._deleteRule,updateRuleIndex:this.props.updateConditionFormatIndex})},t}(s.Component),G=(n("../node_modules/core-js/modules/es.regexp.exec.js"),n("../node_modules/core-js/modules/es.string.split.js"),n("../node_modules/core-js/modules/es.array.find-index.js"),n("../node_modules/@tencent/dui/lib/components/Modal/index.js")),V=n("../spread-sheet/src/core/view/level-2/condition-format-center/ui/rule-datas/rule-datas.ts"),W=n("../node_modules/@tencent/dui/lib/components/Input/index.js"),z=n("../spread-sheet/src/external/view/main/panel/dataValidationPanel/style/assets.ts"),Y=n("../node_modules/@tencent/ioc/lib/esm/index.js"),X=n("../node_modules/@tencent/workbench/lib/esm/services/event-emitter/event-emitter.js"),K=n("../node_modules/@tencent/workbench/lib/esm/services/event-emitter/builtin-event.js"),q=n("../spread-sheet/src/external/view/ui-layer/condition-format/components/condition-format-drawer.tsx"),$=function(e){function t(){var t;return(t=e.apply(this,arguments)||this)._rangeInputChange=function(e){t.props.setRange(e),(0,l.V4)("rule_panel_type_area"),-1!==e.indexOf(",")&&(0,l.V4)("rule_panel_type_nonadjacent_area"),Z.ZP.kvrOss({itemname:"xls_condform_region_change"})},t._handleEnterSelectionPanel=function(){var e,o=Y.Am.get(q.Z);o.hideDrawer(),null===(e=n.g.SpreadsheetApp.view.plugins.rangeSelectionPanel)||void 0===e||e.show((function(e){t.props.setRange(e),o.showDrawer(),Z.ZP.kvrOss({itemname:"xls_condform_region_change_picker"})}),(function(){o.showDrawer()}),{defaultValue:t.props.ranges})},t}(0,o.Z)(t,e);var i=t.prototype;return i.componentDidMount=function(){var e=this;Y.Am.get(X.v).listenOnce(K.c.SurfaceSizeChanged,(function(){var t;null===(t=e._inputRangeRef)||void 0===t||t.focus()}))},i.render=function(){var e=this;return s.createElement(s.Fragment,null,s.createElement("p",{className:"conditional-format-edit-title"},r.ZP.t("应用范围")),s.createElement("div",{className:"mt-8"},s.createElement(W.default,{placeholder:r.ZP.t("在工作表中框选范围"),value:this.props.ranges,onChange:this._rangeInputChange,inputRef:function(t){e._inputRangeRef=t},icon:z.Z,onClickIcon:this._handleEnterSelectionPanel})))},t}(s.Component),Q=$,J=n("../spread-sheet/src/core/view/level-2/condition-format-center/ui/rulesContainer/rules-editor/rules-area/RulesArea.tsx"),ee=n("../node_modules/@babel/runtime/helpers/esm/toConsumableArray.js"),te=(n("../node_modules/core-js/modules/es.array.concat.js"),n("../spread-sheet/src/external/view/main/toolbar/IconBox.tsx")),ne=function(e){function t(){return e.apply(this,arguments)||this}(0,o.Z)(t,e);var n=t.prototype;return n.handleClick=function(){var e=this.props,t=e.bold;(0,e.onChange)(!t)},n.render=function(){return s.createElement(te.Z,{toolTip:r.ZP.t("加粗"),boxClickHandler:this.handleClick.bind(this),enable:!0,checked:this.props.bold,symbol:"toolbar-icon-bold"})},t}(s.PureComponent),oe=ne,re=n("../node_modules/@babel/runtime/helpers/esm/assertThisInitialized.js"),se=(n("../node_modules/regenerator-runtime/runtime.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.promise.js")," toolbar-button-wrapper-checked "),ie=n("../spread-sheet/src/external/check-slr/sc-lazy-loader.ts"),ae=n("../node_modules/@tencent/docs-user-agent/dist/index.js"),le=n.n(ae),ce=function(e,t,n,o){return new(n||(n=Promise))((function(r,s){function i(e){try{l(o.next(e))}catch(t){s(t)}}function a(e){try{l(o.throw(e))}catch(t){s(t)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,a)}l((o=o.apply(e,t||[])).next())}))},de="#333333",ue=function(e){function t(t){var n;return(n=e.call(this,t)||this).buttonRef=s.createRef(),n.handleClick=function(){n.setState({showPalette:!n.state.showPalette})},n.select=function(e,t){n.props.onChange(e),t||n.setState({showPalette:!1})},n.saveRecentColor=function(e){return ce((0,re.Z)(n),void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.setState({lastSelectColor:e}),t.next=3,(0,ie.LL)();case 3:t.sent.default.saveRecentColor(e);case 5:case"end":return t.stop()}}),t,this)})))},n.handlePaletteEnter=function(){n.setState({isOverPanel:!0})},n.handlePaletteLeave=function(){n.setState({isOverPanel:!1})},n._onDocumentClick=function(e){var t;n.state.isOverPanel||(null===(t=n.buttonRef.current)||void 0===t?void 0:t.contains(e.target))||n.setState({showPalette:!1})},n.getColor=function(){return n.props.color||de},n.state={lastSelectColor:t.color||de,showPalette:!1,isOverPanel:!1},n}(0,o.Z)(t,e);var n=t.prototype;return n.componentDidMount=function(){this.saveRecentColor(this.getColor()),le().isIPad?p.ZP.windowEvent.listen("touchend",this._onDocumentClick):p.ZP.windowEvent.listen("click",this._onDocumentClick)},n.componentWillUnmount=function(){le().isIPad?p.ZP.windowEvent.remove("touchend",this._onDocumentClick):p.ZP.windowEvent.remove("click",this._onDocumentClick)},n.componentDidUpdate=function(e){e.color!==this.props.color&&this.saveRecentColor(this.getColor())},n.render=function(){var e,t=this,n=this.state,o=n.showPalette,i=n.lastSelectColor,a=this.getColor(),l=M()(((e={"toolbar-single-container":!0,"toolbar-button-wrapper":!0,"toolbar-inline-block":!0})[se]=o,e));return s.createElement("div",{ref:this.buttonRef,className:l},s.createElement(te.Z,{toolTip:r.ZP.t("字体颜色"),containerClassName:"toolbar-menu-button-container",boxClickHandler:function(){t.select(i)},showDrop:!0,enable:!0,checked:o,showAnimate:!0,symbol:"toolbar-icon-font"},s.createElement("div",{className:"toolbar-menu-outer toolbar-inline-block toolbar-menu-button-wrapper",onClick:this.handleClick},s.createElement("div",{className:"toolbar-inline-block wedocs-icons-arrow"},s.createElement("div",{className:"toolbar-menu-button-dropdown toolbar-inline-block "}))),s.createElement("div",{className:"color-bottom-line "+("#ffffff"===a?"white-color":""),style:{backgroundColor:i}})),s.createElement("div",{className:"font-color-picker",style:{display:o?"block":"none"}},s.createElement(s.Suspense,{fallback:s.createElement("div",null)},s.createElement(ie.XT,{id:"palette-panel-id",selectColor:a,onColorChange:this.select,showSubPalette:!0,subStyle:{zIndex:9999999},onPaletteEnter:this.handlePaletteEnter.bind(this),onPaletteLeave:this.handlePaletteLeave.bind(this)}))))},t}(s.PureComponent),pe=function(e,t,n,o){return new(n||(n=Promise))((function(r,s){function i(e){try{l(o.next(e))}catch(t){s(t)}}function a(e){try{l(o.throw(e))}catch(t){s(t)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,a)}l((o=o.apply(e,t||[])).next())}))},me="#FCDEE2",_e=function(e){function t(t){var n;return(n=e.call(this,t)||this).buttonRef=s.createRef(),n.handleClick=function(){n.setState({showPalette:!n.state.showPalette})},n.select=function(e,t){n.props.onChange(e),t||n.setState({showPalette:!1})},n.saveRecentColor=function(e){return pe((0,re.Z)(n),void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.setState({lastSelectColor:e}),t.next=3,(0,ie.LL)();case 3:t.sent.default.saveRecentColor(e);case 5:case"end":return t.stop()}}),t,this)})))},n.handlePaletteEnter=function(){n.setState({isOverPanel:!0})},n.handlePaletteLeave=function(){n.setState({isOverPanel:!1})},n._onDocumentClick=function(e){var t;n.state.isOverPanel||(null===(t=n.buttonRef.current)||void 0===t?void 0:t.contains(e.target))||n.setState({showPalette:!1})},n.getColor=function(){return n.props.color||me},n.state={lastSelectColor:t.color||me,showPalette:!1,isOverPanel:!1},n}(0,o.Z)(t,e);var n=t.prototype;return n.componentDidMount=function(){this.saveRecentColor(this.getColor()),le().isIPad?p.ZP.windowEvent.listen("touchend",this._onDocumentClick):p.ZP.windowEvent.listen("click",this._onDocumentClick)},n.componentWillUnmount=function(){le().isIPad?p.ZP.windowEvent.remove("touchend",this._onDocumentClick):p.ZP.windowEvent.remove("click",this._onDocumentClick)},n.componentDidUpdate=function(e){e.color!==this.props.color&&this.saveRecentColor(this.getColor())},n.render=function(){var e,t=this,n=this.state,o=n.showPalette,i=n.lastSelectColor,a=this.getColor(),l=M()(((e={"toolbar-single-container":!0,"toolbar-button-wrapper":!0,"toolbar-inline-block":!0})[se]=o,e));return s.createElement("div",{ref:this.buttonRef,className:l},s.createElement(te.Z,{toolTip:r.ZP.t("填充颜色"),containerClassName:"toolbar-menu-button-container bg-color",boxClickHandler:function(){t.select(i)},showDrop:!0,enable:!0,checked:o,showAnimate:!0,symbol:"toolbar-colorpicker-picker-paint-brush"},s.createElement("div",{className:"toolbar-menu-outer toolbar-inline-block toolbar-menu-button-wrapper",onClick:this.handleClick},s.createElement("div",{className:"toolbar-inline-block wedocs-icons-arrow"},s.createElement("div",{className:"toolbar-menu-button-dropdown toolbar-inline-block "}))),s.createElement("div",{className:"color-bottom-line "+("#ffffff"===a?"white-color":""),style:{backgroundColor:i}})),s.createElement("div",{className:"background-color-picker",style:{display:o?"block":"none"}},s.createElement(s.Suspense,{fallback:s.createElement("div",null)},s.createElement(ie.XT,{id:"palette-panel-id",selectColor:a,onColorChange:this.select,showSubPalette:!0,subStyle:{zIndex:9999999},onPaletteEnter:this.handlePaletteEnter.bind(this),onPaletteLeave:this.handlePaletteLeave.bind(this)}))))},t}(s.PureComponent),he=function(e){function t(){return e.apply(this,arguments)||this}(0,o.Z)(t,e);var n=t.prototype;return n.handleClick=function(){var e=this.props,t=e.italic;(0,e.onChange)(!t)},n.render=function(){return s.createElement(te.Z,{toolTip:r.ZP.t("斜体"),boxClickHandler:this.handleClick.bind(this),enable:!0,checked:this.props.italic,symbol:"toolbar-icon-italic"})},t}(s.PureComponent),fe=he,ge=function(e){function t(){return e.apply(this,arguments)||this}(0,o.Z)(t,e);var n=t.prototype;return n.handleClick=function(){var e=this.props,t=e.strikethrough;(0,e.onChange)(!t)},n.render=function(){return s.createElement(te.Z,{toolTip:r.ZP.t("删除线"),boxClickHandler:this.handleClick.bind(this),enable:!0,checked:this.props.strikethrough,symbol:"toolbar-icon-strikethrough"})},t}(s.PureComponent),ve=ge,Ce=function(e){function t(){return e.apply(this,arguments)||this}(0,o.Z)(t,e);var n=t.prototype;return n.handleClick=function(){var e=this.props,t=e.underline;(0,e.onChange)(!t)},n.render=function(){return s.createElement(te.Z,{toolTip:r.ZP.t("下划线"),boxClickHandler:this.handleClick.bind(this),enable:!0,checked:!!this.props.underline,symbol:"toolbar-icon-underline"})},t}(s.PureComponent),be=Ce,we=(n("../node_modules/core-js/modules/es.regexp.to-string.js"),n("../node_modules/@tencent/dui/lib/components/Select/index.js")),Ee=function(e){function t(){var t;return(t=e.apply(this,arguments)||this)._renderOption=function(e,t){return s.createElement(we.default.Option,{value:t.toString(),style:{justifyContent:"flex-start"}},v(e,e.title))},t.onChange=function(e){var n=t.props,o=n.onChange,r=n.templates,s=parseInt(e,10);o(r[s],s)},t}return(0,o.Z)(t,e),t.prototype.render=function(){var e=this.props,t=e.templates,n=e.currentTemplateIndex;return s.createElement("div",{className:"conditional-format-editing-line condition-boolean-template conditional-format-editor-select-render-style"},s.createElement(we.default,{style:{width:"260px",height:"36px",borderRadius:"4px"},textStyle:{width:"100%",paddingRight:"10px"},value:n.toString(),onChange:this.onChange,listClassName:"boolean-template-dropdown render-styles-list"},t.map(this._renderOption)))},t}(s.PureComponent),ye=Ee,Oe=function(e){function t(t){var n;(n=e.call(this,t)||this).setBgColor=function(e){n.props.setStyle(U.BACKGROUND_COLOR,e),n.setState({customTemplate:Object.assign(Object.assign({},n.state.customTemplate),{bgColor:e})})},n.setColor=function(e){n.props.setStyle(U.FONT_COLOR,e),n.setState({customTemplate:Object.assign(Object.assign({},n.state.customTemplate),{color:e})})},n.setBold=function(e){n.props.setStyle(U.BOLD,e),n.setState({customTemplate:Object.assign(Object.assign({},n.state.customTemplate),{bold:e})})},n.setStrikethrough=function(e){n.props.setStyle(U.STRIKETHROUGH,e),n.setState({customTemplate:Object.assign(Object.assign({},n.state.customTemplate),{strikethrough:e})})},n.setUnderline=function(e){n.props.setStyle(U.UNDERLINE,e),n.setState({customTemplate:Object.assign(Object.assign({},n.state.customTemplate),{underline:e})})},n.setItalic=function(e){n.props.setStyle(U.ITALIC,e),n.setState({customTemplate:Object.assign(Object.assign({},n.state.customTemplate),{italic:e})})},n.getTemplates=function(){return[].concat((0,ee.Z)(V.lK),[n.state.customTemplate])},n.getCurrentSelectIndex=function(){var e,t,o=n.props.booleanCondition,r=V.lK.length,s=o.format;s.bgColor=null===(e=s.bgColor)||void 0===e?void 0:e.toUpperCase(),s.color=null===(t=s.color)||void 0===t?void 0:t.toUpperCase();var i=function(e,t){return!e&&!t||e===t};return V.lK.forEach((function(e,t){i(e.bgColor,s.bgColor)&&i(e.color,s.color)&&i(e.bold,s.bold)&&i(e.italic,s.italic)&&i(e.strikethrough,s.strikethrough)&&i(e.underline,s.underline)&&(r=t)})),r},n.onChangeTemplate=function(e,t){var o=n.props.setStyle;o(U.BACKGROUND_COLOR,e.bgColor||""),o(U.FONT_COLOR,e.color||""),o(U.BOLD,e.bold||!1),o(U.ITALIC,e.italic||!1),o(U.STRIKETHROUGH,e.strikethrough||!1),o(U.UNDERLINE,e.underline||!1),n.setState({isCustom:e.isCustom,currentSelectIndex:t})};var o=t.booleanCondition.format,s=n.getCurrentSelectIndex(),i=!V.lK[s];return n.state={isCustom:i,currentSelectIndex:s,customTemplate:Object.assign(Object.assign({},i?o:{}),{title:r.ZP.t("自定义格式预览"),isCustom:!0})},n}return(0,o.Z)(t,e),t.prototype.render=function(){var e=this.props.booleanCondition,t=this.state,n=t.isCustom,o=t.currentSelectIndex,r=e.format,i=r.bold,a=r.italic,l=r.strikethrough,c=r.underline,d=r.color,u=r.bgColor;return s.createElement(s.Fragment,null,s.createElement(ye,{templates:this.getTemplates(),currentTemplateIndex:o,onChange:this.onChangeTemplate}),n&&s.createElement(s.Fragment,null,s.createElement(oe,{bold:i||!1,onChange:this.setBold}),s.createElement(fe,{italic:a||!1,onChange:this.setItalic}),s.createElement(ve,{strikethrough:l||!1,onChange:this.setStrikethrough}),s.createElement(be,{underline:c?f.UNDERLINE_TYPE.SINGLE_LINE:null,onChange:this.setUnderline}),s.createElement(ue,{color:d||"",onChange:this.setColor}),s.createElement("div",{className:"condition-separator-line"}),s.createElement(_e,{color:u||"",onChange:this.setBgColor})))},t}(s.Component),xe=n("../node_modules/@tencent/dui/lib/components/Dropdown/index.js"),Se=function(e){function t(t){var n;return(n=e.call(this,t)||this).buttonRef=s.createRef(),n.renderPalette=function(){var e=n.getColor();return s.createElement(s.Suspense,{fallback:s.createElement("div",null)},s.createElement(ie.XT,{id:"palette-panel-id",selectColor:e,onColorChange:n.select,showSubPalette:!0,subStyle:{zIndex:9999999},onPaletteEnter:n.handlePaletteEnter.bind((0,re.Z)(n)),onPaletteLeave:n.handlePaletteLeave.bind((0,re.Z)(n))}))},n.select=function(e){n.props.onChange(e)},n.handlePaletteEnter=function(){n.setState({isOverPanel:!0})},n.handlePaletteLeave=function(){n.setState({isOverPanel:!1})},n.getColor=function(){return n.props.color||n.props.defaultColor},n.state={isOverPanel:!1},n}return(0,o.Z)(t,e),t.prototype.render=function(){var e=this.props,t=e.width,n=void 0===t?80:t,o=e.spreadsheet,r=this.getColor(),i=g(r,o);return s.createElement(xe.default,{dropContent:this.renderPalette(),alignment:"right"},s.createElement(we.default,{style:{width:n+"px",height:"36px"},value:r,containerClassName:"color-bar-dropdown"},s.createElement(we.default.Option,{value:r},s.createElement("div",{className:"dropdown-item",style:i?{backgroundColor:r,border:"solid 1px #ebebeb"}:{backgroundColor:r}}))))},t}(s.PureComponent),Pe=function(e){function t(){var t;return(t=e.apply(this,arguments)||this)._renderOption=function(e,n){return s.createElement(we.default.Option,{value:n.toString(),style:{justifyContent:"flex-start"}},C(e,e.title,!e.isCustom,t.props.spreadsheet))},t.onChange=function(e){var n=t.props,o=n.onChange,r=n.templates,s=parseInt(e,10);o(r[s],s)},t}return(0,o.Z)(t,e),t.prototype.render=function(){var e=this.props,t=e.templates,n=e.currentTemplateIndex;return s.createElement("div",{className:"conditional-format-editing-line condition-gradient-template conditional-format-editor-select-render-style"},s.createElement(we.default,{style:{width:"260px",height:"36px",borderRadius:"4px"},textStyle:{width:"100%",paddingRight:"10px"},value:n.toString(),onChange:this.onChange,listClassName:"gradient-template-dropdown render-styles-list"},t.map(this._renderOption)))},t}(s.PureComponent),Re=Pe,Te=n("../packages/model/src/rule/InterpolationPoint.ts"),Ie=((B={})[Te.u.MIN]=r.ZP.t("自动"),B[Te.u.MAX]=r.ZP.t("自动"),B[Te.u.NUM]=r.ZP.t("数值"),B),je=function(e){function t(){var t;return(t=e.apply(this,arguments)||this)._renderOption=function(e){return s.createElement(we.default.Option,{value:e.toString(),style:{justifyContent:"flex-start"}},s.createElement("span",{style:{whiteSpace:"nowrap"}},Ie[e]))},t.onChange=function(e){(0,t.props.onChange)(parseInt(e,10))},t}return(0,o.Z)(t,e),t.prototype.render=function(){var e=this.props,t=e.options,n=e.currentValue,o=e.style,r=void 0===o?{}:o;return s.createElement(we.default,{style:Object.assign({width:"82px",height:"36px",borderRadius:"4px",marginRight:"8px"},r),textStyle:{width:"100%",paddingRight:"10px"},value:n.toString(),onChange:this.onChange},t.map(this._renderOption))},t}(s.PureComponent),ke=je,Ne=function(e){function t(t){var n;(n=e.call(this,t)||this).onMinTypeChange=function(e){e!==n.props.gradientCondition.inputOne.type&&(n.props.setRule({gradientCondition:{inputOne:{type:e,value:""}}}),n.setState({customTemplate:Object.assign(Object.assign({},n.state.customTemplate),{inputOne:{type:e,value:""}})}))},n.onMinValueChange=function(e){n.props.setRule({gradientCondition:{inputOne:{type:n.props.gradientCondition.inputOne.type,value:e}}}),n.setState({customTemplate:Object.assign(Object.assign({},n.state.customTemplate),{inputOne:{type:n.props.gradientCondition.inputOne.type,value:e}})})},n.onMinColorChange=function(e){n.props.setStyle(U.MIN_COLOR,e),n.setState({customTemplate:Object.assign(Object.assign({},n.state.customTemplate),{minColor:e})})},n.onMaxTypeChange=function(e){e!==n.props.gradientCondition.inputTwo.type&&(n.props.setRule({gradientCondition:{inputTwo:{type:e,value:""}}}),n.setState({customTemplate:Object.assign(Object.assign({},n.state.customTemplate),{inputTwo:{type:e,value:""}})}))},n.onMaxValueChange=function(e){n.props.setRule({gradientCondition:{inputTwo:{type:n.props.gradientCondition.inputTwo.type,value:e}}}),n.setState({customTemplate:Object.assign(Object.assign({},n.state.customTemplate),{inputTwo:{type:n.props.gradientCondition.inputOne.type,value:e}})})},n.onMaxColorChange=function(e){n.props.setStyle(U.MAX_COLOR,e),n.setState({customTemplate:Object.assign(Object.assign({},n.state.customTemplate),{maxColor:e})})},n.getTemplates=function(){return[].concat((0,ee.Z)(V.c8),[n.state.customTemplate])},n.getCurrentSelectIndex=function(){var e=n.props.gradientCondition,t=V.c8.length;return V.c8.forEach((function(n,o){n.minColor===e.minColor&&n.maxColor===e.maxColor&&n.inputOne.type===e.inputOne.type&&n.inputTwo.type===e.inputTwo.type&&n.inputOne.value===e.inputOne.value&&n.inputTwo.value===e.inputTwo.value&&(t=o)})),t},n.onChangeTemplate=function(e,t){var o=n.props.setStyle;o(U.MIN_COLOR,e.minColor),o(U.MAX_COLOR,e.maxColor),n.setState({isCustom:e.isCustom,currentSelectIndex:t}),!e.isCustom||n.state.customTemplate.minColor&&n.state.customTemplate.maxColor||(o(U.MIN_COLOR,V.c8[0].minColor),o(U.MAX_COLOR,V.c8[0].maxColor),n.setState({customTemplate:Object.assign(Object.assign({},n.state.customTemplate),{minColor:V.c8[0].minColor,maxColor:V.c8[0].maxColor})}))};var o=t.gradientCondition,s=n.getCurrentSelectIndex(),i=!V.c8[s];return n.state={isCustom:i,currentSelectIndex:s,customTemplate:Object.assign(Object.assign({},i?o:{inputOne:{type:Te.u.MIN,value:""},inputTwo:{type:Te.u.MAX,value:""},minColor:"",maxColor:""}),{title:r.ZP.t("自定义最大值/最小值/格式"),isCustom:!0})},n}return(0,o.Z)(t,e),t.prototype.render=function(){var e=this.props,t=e.gradientCondition,n=e.spreadsheet,o=t.inputOne,i=t.inputTwo,a=t.minColor,l=t.maxColor,c=this.state,d=c.isCustom,u=c.currentSelectIndex;return s.createElement(s.Fragment,null,s.createElement(Re,{templates:this.getTemplates(),currentTemplateIndex:u,onChange:this.onChangeTemplate,spreadsheet:n}),d&&s.createElement(s.Fragment,null,s.createElement("div",{className:"condition-sub-title"},r.ZP.t("最小")),s.createElement("div",{className:"condition-format-line"},s.createElement(ke,{options:[Te.u.MIN,Te.u.NUM],currentValue:o.type,onChange:this.onMinTypeChange}),o.type!==Te.u.MIN&&s.createElement(W.default,{style:{width:"82px",marginRight:"8px"},placeholder:r.ZP.t("输入数值"),value:o.value||"",onChange:this.onMinValueChange}),s.createElement(Se,{spreadsheet:n,width:o.type!==Te.u.MIN?76:170,color:a,defaultColor:V.c8[0].minColor,onChange:this.onMinColorChange})),s.createElement("div",{className:"condition-sub-title"},r.ZP.t("最大")),s.createElement("div",{className:"condition-format-line"},s.createElement(ke,{options:[Te.u.MAX,Te.u.NUM],currentValue:i.type,onChange:this.onMaxTypeChange}),i.type!==Te.u.MAX&&s.createElement(W.default,{style:{width:"82px",marginRight:"8px"},placeholder:r.ZP.t("输入数值"),value:i.value||"",onChange:this.onMaxValueChange}),s.createElement(Se,{spreadsheet:n,width:i.type!==Te.u.MAX?76:170,color:l,defaultColor:V.c8[0].maxColor,onChange:this.onMaxColorChange}))))},t}(s.Component),Ze=function(e){function t(){var t;return(t=e.apply(this,arguments)||this)._renderOption=function(e,n){return s.createElement(we.default.Option,{value:n.toString(),style:{justifyContent:"flex-start"}},b(e,e.title,!e.isCustom,t.props.spreadsheet))},t.onChange=function(e){var n=t.props,o=n.onChange,r=n.templates,s=parseInt(e,10);o(r[s],s)},t}return(0,o.Z)(t,e),t.prototype.render=function(){var e=this.props,t=e.templates,n=e.currentTemplateIndex;return s.createElement("div",{className:"conditional-format-editing-line condition-databar-template conditional-format-editor-select-render-style"},s.createElement(we.default,{style:{width:"260px",height:"36px",borderRadius:"4px"},textStyle:{width:"100%",paddingRight:"10px"},value:n.toString(),onChange:this.onChange,listClassName:"databar-template-dropdown render-styles-list"},t.map(this._renderOption)))},t}(s.PureComponent),De=Ze,Ae=n("../node_modules/@tencent/dui/lib/components/Checkbox/index.js"),Le=function(e){function t(t){var n;(n=e.call(this,t)||this).renderCustom=function(){var e=n.props,t=e.dataBarCondition,o=e.spreadsheet,i=t.negativeColor,a=t.positiveColor,l=t.inputTwo,c=t.inputOne;return s.createElement(s.Fragment,null,s.createElement("div",{className:"condition-sub-title"},r.ZP.t("自定义颜色")),s.createElement("div",{className:"condition-format-line"},s.createElement("span",{className:"format-title"},r.ZP.t("负值")),s.createElement(Se,{spreadsheet:o,width:210,color:i,defaultColor:V.ny[0].negativeColor,onChange:n.onNegativeColorChange})),s.createElement("div",{className:"condition-format-line"},s.createElement("span",{className:"format-title"},r.ZP.t("正值")),s.createElement(Se,{spreadsheet:o,width:210,color:a,defaultColor:V.ny[0].positiveColor,onChange:n.onPositiveColorChange})),s.createElement("div",{className:"condition-sub-title"},r.ZP.t("自定义数据")),s.createElement("div",{className:"condition-format-line"},s.createElement("span",{className:"format-title"},r.ZP.t("最小")),s.createElement(ke,{style:{width:"100px"},options:[Te.u.MIN,Te.u.NUM],currentValue:c.type,onChange:n.onMinTypeChange}),s.createElement(W.default,{style:{width:"100px"},placeholder:r.ZP.t("输入数值"),value:c.value||"",disabled:c.type===Te.u.MIN,onChange:n.onMinValueChange})),s.createElement("div",{className:"condition-format-line"},s.createElement("span",{className:"format-title"},r.ZP.t("最大")),s.createElement(ke,{style:{width:"100px"},options:[Te.u.MAX,Te.u.NUM],currentValue:l.type,onChange:n.onMaxTypeChange}),s.createElement(W.default,{style:{width:"100px"},placeholder:r.ZP.t("输入数值"),value:l.value||"",disabled:l.type===Te.u.MAX,onChange:n.onMaxValueChange})))},n.onChangeHideData=function(e){n.props.setStyle(U.HIDE_DATA,e)},n.onMinTypeChange=function(e){e!==n.props.dataBarCondition.inputOne.type&&(n.props.setRule({dataBarCondition:{inputOne:{type:e,value:""}}}),n.setState({customTemplate:Object.assign(Object.assign({},n.state.customTemplate),{inputOne:{type:e,value:""}})}))},n.onMinValueChange=function(e){n.props.setRule({dataBarCondition:{inputOne:{type:n.props.dataBarCondition.inputOne.type,value:e}}}),n.setState({customTemplate:Object.assign(Object.assign({},n.state.customTemplate),{inputOne:{type:n.props.dataBarCondition.inputOne.type,value:e}})})},n.onNegativeColorChange=function(e){n.props.setStyle(U.NEGATIVE_COLOR,e),n.setState({customTemplate:Object.assign(Object.assign({},n.state.customTemplate),{negativeColor:e})})},n.onMaxTypeChange=function(e){e!==n.props.dataBarCondition.inputTwo.type&&(n.props.setRule({dataBarCondition:{inputTwo:{type:e,value:""}}}),n.setState({customTemplate:Object.assign(Object.assign({},n.state.customTemplate),{inputTwo:{type:e,value:""}})}))},n.onMaxValueChange=function(e){n.props.setRule({dataBarCondition:{inputTwo:{type:n.props.dataBarCondition.inputTwo.type,value:e}}}),n.setState({customTemplate:Object.assign(Object.assign({},n.state.customTemplate),{inputTwo:{type:n.props.dataBarCondition.inputOne.type,value:e}})})},n.onPositiveColorChange=function(e){n.props.setStyle(U.POSITIVE_COLOR,e),n.setState({customTemplate:Object.assign(Object.assign({},n.state.customTemplate),{positiveColor:e})})},n.getTemplates=function(){return[].concat((0,ee.Z)(V.ny),[n.state.customTemplate])},n.getCurrentSelectIndex=function(){var e=n.props.dataBarCondition,t=V.ny.length;return V.ny.forEach((function(n,o){n.negativeColor===e.negativeColor&&n.positiveColor===e.positiveColor&&n.inputOne.type===e.inputOne.type&&n.inputTwo.type===e.inputTwo.type&&n.inputOne.value===e.inputOne.value&&n.inputTwo.value===e.inputTwo.value&&(t=o)})),t},n.onChangeTemplate=function(e,t){var o=n.props.setStyle;o(U.NEGATIVE_COLOR,e.negativeColor),o(U.POSITIVE_COLOR,e.positiveColor),n.setState({isCustom:e.isCustom,currentSelectIndex:t}),!e.isCustom||n.state.customTemplate.negativeColor&&n.state.customTemplate.positiveColor||(o(U.NEGATIVE_COLOR,V.ny[0].negativeColor),o(U.POSITIVE_COLOR,V.ny[0].positiveColor),n.setState({customTemplate:Object.assign(Object.assign({},n.state.customTemplate),{negativeColor:V.ny[0].negativeColor,positiveColor:V.ny[0].positiveColor})}))};var o=t.dataBarCondition,i=n.getCurrentSelectIndex(),a=!V.ny[i];return n.state={isCustom:a,currentSelectIndex:n.getCurrentSelectIndex(),customTemplate:Object.assign(Object.assign({},a?o:{inputOne:{type:Te.u.MIN,value:""},inputTwo:{type:Te.u.MAX,value:""},negativeColor:"",positiveColor:""}),{title:r.ZP.t("自定义最大值/最小值/格式"),isCustom:!0})},n}return(0,o.Z)(t,e),t.prototype.render=function(){var e=this.props,t=e.dataBarCondition,n=e.spreadsheet,o=this.state,i=o.isCustom,a=o.currentSelectIndex,l=t.hideData;return s.createElement(s.Fragment,null,s.createElement(De,{spreadsheet:n,templates:this.getTemplates(),currentTemplateIndex:a,onChange:this.onChangeTemplate}),i&&this.renderCustom(),s.createElement(Ae.default,{style:{marginTop:"18px",fontSize:"14px"},onChange:this.onChangeHideData,defaultChecked:l},r.ZP.t("隐藏数据")))},t}(s.Component),Me=Le,Fe=function(e){function t(){return e.apply(this,arguments)||this}return(0,o.Z)(t,e),t.prototype.render=function(){var e=this.props.rule;return s.createElement("div",{className:"conditional-format-format","data-testid":"conditional-format-format"},e.booleanCondition&&s.createElement(Oe,Object.assign({},this.props,{booleanCondition:e.booleanCondition})),e.gradientCondition&&s.createElement(Ne,Object.assign({},this.props,{gradientCondition:e.gradientCondition})),e.dataBarCondition&&s.createElement(Me,Object.assign({},this.props,{dataBarCondition:e.dataBarCondition})))},t}(s.Component),Be=Fe,Ue=n("../node_modules/@tencent/dui/lib/components/Button/index.js"),He=function(e){function t(){return e.apply(this,arguments)||this}return(0,o.Z)(t,e),t.prototype.render=function(){return s.createElement("div",{className:"conditional-format-edit-buttons"},s.createElement(Ue.default,{className:"common-button",onClick:this.props.doCancel},r.ZP.t("取消")),s.createElement(Ue.default,{type:"primary",disabled:this.props.disabled,className:"common-button ml-20",onClick:this.props.doConfirm},r.ZP.t("完成")))},t}(s.Component),Ge=He,Ve=n("../spread-sheet/src/core/view/utils/base-func.ts"),We=n("../packages/model/src/rule/index.ts"),ze=n("../packages/model/src/range/hexRangeUtils.ts"),Ye=n("../spread-sheet/src/core/view/level-1/select-center/base/utils.ts"),Xe=n("../spread-sheet/src/external/rangeAuth/util/range-auth-error-util.ts"),Ke=n("../spread-sheet/src/core/view/level-2/condition-format-center/condition-type-data/ConditionTypeMap.ts"),qe=n("../packages/model/src/config/index.ts");!function(e){e[e.BACKGROUND_COLOR=0]="BACKGROUND_COLOR",e[e.FONT_COLOR=1]="FONT_COLOR",e[e.BOLD=2]="BOLD",e[e.ITALIC=3]="ITALIC",e[e.STRIKETHROUGH=4]="STRIKETHROUGH",e[e.UNDERLINE=5]="UNDERLINE",e[e.HIDE_DATA=6]="HIDE_DATA",e[e.MIN_COLOR=7]="MIN_COLOR",e[e.MAX_COLOR=8]="MAX_COLOR",e[e.NEGATIVE_COLOR=9]="NEGATIVE_COLOR",e[e.POSITIVE_COLOR=10]="POSITIVE_COLOR"}(U||(U={}));var $e,Qe=function(e){function t(){var t;return(t=e.apply(this,arguments)||this).ref=s.createRef(),t._checkEditingRuleConflict=(0,Ve.kf)((function(){t.props.ruleId&&!t.props.conditionFormat.getRuleById(t.props.ruleId)&&t.props.ruleId&&t.props.returnManagerPanel()})),t.stopPropagation=function(e){e.stopPropagation()},t._checkDisabled=function(){var e=t.state.rule,n=!1;if(e.booleanCondition){var o=e.booleanCondition,r=o.inputOne,s=o.inputTwo,i=Ke.Z[e.booleanCondition.conditionType];i.hasInputOne()&&!r&&(n=!0),i.hasInputTwo()&&!s&&(n=!0)}return n},t._setRange=function(e){t.setState({rule:Object.assign(Object.assign({},t.state.rule),{ranges:e})})},t._setRule=function(e){var n=t.state.rule,o=e.booleanCondition,r=e.gradientCondition,s=e.dataBarCondition;(n=t._applyConditionType(e)).booleanCondition&&o?t.setState({rule:Object.assign(Object.assign({},n),{booleanCondition:Object.assign(Object.assign({},n.booleanCondition),{inputOne:o.inputOne||"",inputTwo:o.inputTwo||""})})}):n.gradientCondition&&r?t.setState({rule:Object.assign(Object.assign({},n),{gradientCondition:Object.assign(Object.assign({},n.gradientCondition),r)})}):n.dataBarCondition&&s&&t.setState({rule:Object.assign(Object.assign({},n),{dataBarCondition:Object.assign(Object.assign({},n.dataBarCondition),s)})})},t._applyConditionType=function(e){var n=t.state.rule,o=(0,l.be)(n),r=(0,l.be)(e);return r!==o&&(n=Object.assign(Object.assign({},(0,l.mU)([],r)),{ranges:n.ranges,ruleId:n.ruleId,ruleIndex:n.ruleIndex})),n},t._setStyle=function(e,n){var o,r=t.state.rule,s=r.booleanCondition,i=r.gradientCondition,a=r.dataBarCondition;((o={})[U.BOLD]=function(){return s&&(s.format.bold=n)},o[U.ITALIC]=function(){return s&&(s.format.italic=n)},o[U.UNDERLINE]=function(){return s&&(s.format.underline=n)},o[U.STRIKETHROUGH]=function(){return s&&(s.format.strikethrough=n)},o[U.FONT_COLOR]=function(){return s&&(s.format.color=n)},o[U.BACKGROUND_COLOR]=function(){return s&&(s.format.bgColor=n)},o[U.MIN_COLOR]=function(){return i&&(i.minColor=n)},o[U.MAX_COLOR]=function(){return i&&(i.maxColor=n)},o[U.NEGATIVE_COLOR]=function(){return a&&(a.negativeColor=n)},o[U.POSITIVE_COLOR]=function(){return a&&(a.positiveColor=n)},o[U.HIDE_DATA]=function(){return a&&(a.hideData=n)},o)[e](),t.setState({rule:Object.assign({},r)})},t._handleSwitchSheet=function(){t.props.spreadsheet.activeSheetId!==t._sheetId&&(t.props.returnManagerPanel(),t._sheetId=t.props.spreadsheet.activeSheetId)},t._clickCancelButton=function(){var e=t.props.conditionFormat.getRuleListWithCurrentSelection();!t.props.ruleId&&e.length<1?t.props.hidePanel():(t.props.returnManagerPanel(),(0,l.V4)("rule_panel_cancel"))},t._clickConfirmButton=function(){if(!t._verifyInput())return!1;t._apply(),t.props.returnManagerPanel(),(0,l.V4)("rule_panel_done"),t._report()},t._report=function(){var e=t.state.rule;if(e.booleanCondition){var n=e.booleanCondition.conditionType;n>=We.CONDITION_TYPE.NUMBER_GREATER&&n<=We.CONDITION_TYPE.NUMBER_NOT_BETWEEN&&Z.ZP.kvrOss({itemname:"xls_condform_num"}),n>=We.CONDITION_TYPE.TEXT_CONTAINS&&n<=We.CONDITION_TYPE.NOT_BLANK&&Z.ZP.kvrOss({itemname:"xls_condform_text"}),n>=We.CONDITION_TYPE.DATE_EQ&&n<=We.CONDITION_TYPE.DATE_NOT_BETWEEN&&Z.ZP.kvrOss({itemname:"xls_condform_date"}),n>=We.CONDITION_TYPE.REPEAT&&n<=We.CONDITION_TYPE.UNIQUE&&Z.ZP.kvrOss({itemname:"xls_condform_uniq"})}else e.gradientCondition?Z.ZP.kvrOss({itemname:"xls_condform_colorrange"}):e.dataBarCondition&&Z.ZP.kvrOss({itemname:"xls_condform_databar"})},t._saveAndAddRule=function(){t.props.continueEditing(),t._setStateByRuleId("",We.CONDITION_TYPE.NUMBER_GREATER),t._flashing()},t._setConditionFormat=function(){var e=t.state.rule;t.props.setConditionFormat(e)},t._addConditionFormat=function(){var e=t.state.rule;t.props.addConditionFormat(e),Z.ZP.kvrOss({itemname:"xls_condform_rule_done"})},t}(0,o.Z)(t,e);var n=t.prototype;return n.componentWillMount=function(){this._setStateByRuleId(this.props.ruleId,this.props.initDefaultConditionType)},n.componentDidMount=function(){var e;this.props.mutationBehavior.emitter.addListener(this.props.mutationBehavior.EVENT.DATA_CHANGE,this._checkEditingRuleConflict),p.ZP.spreadsheetEvent.listen(a.Z.EVENT_NAME.DATA_CHANGE,this._checkEditingRuleConflict),p.ZP.sheetsBar.listen("switchSheet",this._handleSwitchSheet),p.ZP.sheetsBar.listen("addSheet",this._handleSwitchSheet),p.ZP.sheetsBar.listen("deleteSheet",this._handleSwitchSheet),null===(e=this.ref.current)||void 0===e||e.addEventListener("keydown",this.stopPropagation),(0,l.V4)("rule_edit_init_show")},n.componentWillUnmount=function(){var e;this.props.mutationBehavior.emitter.addListener(this.props.mutationBehavior.EVENT.DATA_CHANGE,this._checkEditingRuleConflict),p.ZP.spreadsheetEvent.listen(a.Z.EVENT_NAME.DATA_CHANGE,this._checkEditingRuleConflict),p.ZP.sheetsBar.remove("switchSheet",this._handleSwitchSheet),p.ZP.sheetsBar.remove("addSheet",this._handleSwitchSheet),p.ZP.sheetsBar.remove("deleteSheet",this._handleSwitchSheet),null===(e=this.ref.current)||void 0===e||e.removeEventListener("keydown",this.stopPropagation)},n.componentWillReceiveProps=function(e){e.initDefaultConditionType!==this.props.initDefaultConditionType&&this._setStateByRuleId(e.ruleId,e.initDefaultConditionType)},n.render=function(){var e=this.state.rule,t=e.booleanCondition,n=e.gradientCondition,o=e.dataBarCondition;return s.createElement(s.Fragment,null,s.createElement("div",{ref:this.ref,className:"conditional-format-edit-body "+(this.state.flashing?"flashing":"")},s.createElement("div",{className:"conditional-format-edit-block","data-testid":"apply-range"},s.createElement(Q,{spreadsheet:this.props.spreadsheet,normalSelectData:this.props.normalSelectData,ranges:e.ranges,setRange:this._setRange,conditionType:(0,l.be)(e)})),s.createElement("div",{className:"conditional-format-edit-block","data-testid":"rules-area"},s.createElement(J.Z,{rule:{booleanCondition:t,gradientCondition:n,dataBarCondition:o},setRule:this._setRule}),s.createElement("p",{className:"conditional-format-edit-title"},r.ZP.t("显示为")),s.createElement(Be,{spreadsheet:this.props.spreadsheet,rule:e,setRule:this._setRule,setStyle:this._setStyle})),s.createElement(Ge,{doCancel:this._clickCancelButton,doConfirm:this._clickConfirmButton,disabled:this._checkDisabled()}),s.createElement("div",{className:"clear-float"})),s.createElement(T,{padding:16}),s.createElement("div",{className:"mb-8"}),s.createElement(A,{conditionFormat:this.props.conditionFormat,normalSelectData:this.props.normalSelectData,panelState:$e.EDITOR,addRule:this._saveAndAddRule,managerRule:this.props.returnManagerPanel}))},n._setStateByRuleId=function(e,t){var n=this;if(""!==e){var o=this.props.conditionFormat.getRuleById(e);if(!o)throw new Error("编辑条件格式错误");var r=(0,l.l5)(o,this.props.spreadsheet.activeSheet,this.props.spreadsheet);if(!r)throw new Error("编辑条件格式错误");this.setState({rule:r})}else{var s=(0,Ye.fq)(this.props.spreadsheet.activeSheetId,this.props.spreadsheet.activeSheet,this.props.normalSelectData);s.forEach((function(e){e.isSheet&&(e.startRowIndex=0,e.startColIndex=0,e.endRowIndex=n.props.spreadsheet.activeSheet.getRowCount()-1,e.endColIndex=n.props.spreadsheet.activeSheet.getColCount()-1)}));var i=(0,l.mU)(s,t||We.CONDITION_TYPE.NUMBER_GREATER,this.props.spreadsheet.activeSheet);this.setState({rule:i})}},n._verifyInput=function(){var e=this,t=this.state.rule,n=this.props.spreadsheet.activeSheetId,o=(0,l.c1)(t),s=t.ranges.split(","),i=s.map((function(e){return(0,ze.hex2Range)(e,n)}));if(this._checkCrossAuthRange(i))return(0,Xe.ZO)(),Z.ZP.kvrOss({itemname:"xls_rangeprotect_range_viewer_toast"}),!1;var a=!0;return s.some((function(e){return!(0,ze.isValidHexRange)(e)}))&&(a=!1),i.some((function(t){return!e.isRangeOverMaxRowColLimit(t)}))&&(a=!1),a?!o||(this._inputInvalidAlert(o),!1):(this._inputInvalidAlert(r.ZP.t("请输入有效的应用范围，如“C7:F19”。")),!1)},n._checkCrossAuthRange=function(e){var t=this;return!(-1===e.findIndex((function(e){return!t.props.sheetStatus.getRangeCanEdit(e)})))},n.isRangeOverMaxRowColLimit=function(e){return!(e.endColIndex>qe.MAX_COL_COUNT||e.endRowIndex>qe.MAX_ROW_COUNT)},n._inputInvalidAlert=function(e){G.default.confirm({title:r.ZP.t("条件格式提示"),className:"conditional-format-error-dialog",destroyOnClose:!0,style:{width:450},content:e})},n._apply=function(){this.props.ruleId?this._setConditionFormat():this._addConditionFormat();var e=this.state.rule,t=(0,l.be)(e);(0,l.V4)((0,l.j0)(e)),e.booleanCondition&&V.Ar.indexOf(t)&&(0,l.V4)("select_num")},n._flashing=function(){var e=this;this.setState({flashing:!0}),setTimeout((function(){e.setState({flashing:!1})}),500)},t}(s.Component),Je=Qe,et=function(e){function t(){return e.apply(this,arguments)||this}return(0,o.Z)(t,e),t.prototype.render=function(){return s.createElement("div",{className:"conditional-format-title"},s.createElement("p",null,this.props.titleWording),s.createElement("button",{className:"conditional-format-close",onClick:this.props.hidePanel}))},t}(s.Component),tt=et;!function(e){e[e.MANAGER=0]="MANAGER",e[e.EDITOR=1]="EDITOR"}($e||($e={}));var nt=function(e){function t(t){var n,o;return(n=e.call(this,t)||this)._editRule=function(e){n.setState({editingRuleId:e,panelState:$e.EDITOR})},n._addRule=function(){n.setState({editingRuleId:"",panelState:$e.EDITOR}),Z.ZP.kvrOss({itemname:"xls_condform_pagel_newrule_click"})},n._openManagerPanel=function(){n.setState({panelState:$e.MANAGER})},o=t.panelState?t.panelState:t.conditionType?$e.EDITOR:$e.MANAGER,n.state={editingRuleId:"",panelState:o},n}(0,o.Z)(t,e);var n=t.prototype;return n.componentWillReceiveProps=function(e){e.panelState!==this.state.panelState&&this.setState({panelState:void 0!==e.panelState?e.panelState:$e.EDITOR})},n.render=function(){switch(this.state.panelState){case $e.MANAGER:return this._renderManager();case $e.EDITOR:return this._renderEditor();default:return null}},n._renderManager=function(){return s.createElement(s.Fragment,null,s.createElement(tt,{titleWording:r.ZP.t("管理条件格式"),hidePanel:this.props.hidePanel}),s.createElement(H,{mainBoard:this.props.mainBoard,normalSelectData:this.props.normalSelectData,mutationBehavior:this.props.mutationBehavior,areaData:this.props.areaData,tableView:this.props.tableView,spreadsheet:this.props.spreadsheet,conditionFormat:this.props.conditionFormat,editRule:this._editRule,addRule:this._addRule,deleteConditionFormat:this.props.deleteConditionFormat,updateConditionFormatIndex:this.props.updateConditionFormatIndex}))},n._renderEditor=function(){return s.createElement(s.Fragment,null,s.createElement(tt,{titleWording:r.ZP.t("添加条件格式"),hidePanel:this.props.hidePanel}),s.createElement(Je,{conditionFormat:this.props.conditionFormat,tableView:this.props.tableView,spreadsheet:this.props.spreadsheet,normalSelectData:this.props.normalSelectData,mutationBehavior:this.props.mutationBehavior,sheetStatus:this.props.sheetStatus,ruleId:this.state.editingRuleId,initDefaultConditionType:this.props.conditionType,hidePanel:this.props.hidePanel,returnManagerPanel:this._openManagerPanel,continueEditing:this._addRule,addConditionFormat:this.props.addConditionFormat,setConditionFormat:this.props.updateConditionFormat}))},t}(s.Component)},"../spread-sheet/src/core/view/level-2/condition-format-center/ui/rulesContainer/rules-editor/rules-area/RulesArea.tsx":function(e,t,n){var o=n("../node_modules/@babel/runtime/helpers/esm/createClass.js"),r=n("../node_modules/@babel/runtime/helpers/esm/inheritsLoose.js"),s=(n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.regexp.to-string.js"),n("../node_modules/core-js/modules/es.object.assign.js"),n("../node_modules/core-js/modules/es.array.splice.js"),n("../node_modules/core-js/modules/web.dom-collections.for-each.js"),n("../node_modules/core-js/modules/es.array.map.js"),n("../node_modules/core-js/modules/es.regexp.exec.js"),n("../node_modules/core-js/modules/es.string.replace.js"),n("../node_modules/i18next/dist/esm/i18next.js")),i=n("react"),a=n("../node_modules/@tencent/dui/lib/components/Input/index.js"),l=n("../node_modules/@tencent/dui/lib/components/Select/index.js"),c=n("../spread-sheet/src/core/view/level-2/condition-format-center/ui/rule-datas/rule-datas.ts"),d=n("../spread-sheet/src/core/view/level-2/condition-format-center/ui/utils/dataUtils.ts"),u=n("../spread-sheet/src/core/view/level-2/condition-format-center/condition-type-data/ConditionTypeMap.ts"),p=n("../node_modules/lodash/cloneDeep.js"),m=n.n(p),_=n("../node_modules/classnames/index.js"),h=n.n(_),f=n("../packages/model/src/rule/InterpolationPoint.ts"),g=n("../packages/model/src/filter/condition-utils.ts"),v=function(e){function t(t){var n;(n=e.call(this,t)||this).itemHeight="36px",n.conditionOptions=[{title:s.ZP.t("数值类"),options:c.Ar},{title:s.ZP.t("文本类"),options:c.Sl},{title:s.ZP.t("日期类"),options:c.mU},{title:s.ZP.t("数据条"),options:c.Rl},{title:s.ZP.t("色阶"),options:c.jZ},{title:s.ZP.t("重复值"),options:c.Nd},{title:s.ZP.t("唯一值"),options:c.XH},{title:s.ZP.t("自定义公式"),options:c.Fv}],n._conditionOptionsChange=function(e){for(var t=function(t,o){var r=n.conditionOptions[t];if(r.title===e)return n.setState({conditionTypeOption:r},(function(){r.options[0]?n._conditionTypeChange(r.options[0].toString()):n._conditionTypeChange(g.NP)})),"break"},o=0,r=n.conditionOptions.length;o<r&&"break"!==t(o);o+=1);},n._conditionTypeChange=function(e){if(e===c.lY.GRADIENT)n.props.setRule({gradientCondition:{inputOne:{type:f.u.MIN,value:""},inputTwo:{type:f.u.MAX,value:""}}});else if(e===c.lY.DATA_BAR)n.props.setRule({dataBarCondition:{inputOne:{type:f.u.MIN,value:""},inputTwo:{type:f.u.MAX,value:""}}});else{var t=parseInt(e,10);e===g.NP&&(t=e),n.props.setRule({booleanCondition:{conditionType:t,inputOne:"",inputTwo:""}})}},n.onExtraInputChange=function(e){e||(e="SHOW_INPUT"),n._inputOneChange(e)},n._inputOneChange=function(e){var t=m()(n.props.rule),o=t.booleanCondition;o&&(o.inputOne=e),n.props.setRule(t)},n._inputTwoChange=function(e){var t=m()(n.props.rule),o=t.booleanCondition;o&&(o.inputTwo=e),n.props.setRule(t)},n._selectChange=function(e){n.props.setRule({booleanCondition:Object.assign(Object.assign({},n.props.rule.booleanCondition),{inputOne:e})})},n.triggerEnterEvent=function(e){var t,o;e.stopPropagation(),"Enter"===e.key&&(null===(o=(t=n.props).triggerEnterEvent)||void 0===o||o.call(t))},t.isInFilterPanel&&(n.conditionOptions.splice(3,2),n.conditionOptions.unshift({title:s.ZP.t("无"),options:[]}));var o=n.conditionOptions[0];return n.conditionOptions.forEach((function(e){var n=(0,d.be)(t.rule);-1!==e.options.indexOf(n)&&(o=e)})),n.state={conditionTypeOption:o},n}(0,r.Z)(t,e);var n=t.prototype;return n.componentWillReceiveProps=function(e){var t,n;if((null===(t=e.rule.booleanCondition)||void 0===t?void 0:t.conditionType)!==(null===(n=this.props.rule.booleanCondition)||void 0===n?void 0:n.conditionType)){var o=this.conditionOptions[0];this.conditionOptions.forEach((function(t){var n=(0,d.be)(e.rule);-1!==t.options.indexOf(n)&&(o=t)})),this.setState({conditionTypeOption:o})}},n.render=function(){var e=this.props.isInFilterPanel,t=this.state.conditionTypeOption,n=this.props.rule,o=n.booleanCondition,r=n.gradientCondition,a=n.dataBarCondition,d="";return o&&(d=o.conditionType.toString()),r&&(d=c.lY.GRADIENT),a&&(d=c.lY.DATA_BAR),i.createElement(i.Fragment,null,!e&&i.createElement("p",{className:"conditional-format-edit-title"},s.ZP.t("符合以下条件时")),i.createElement("div",{className:"conditional-format-editing-line"},i.createElement("div",{className:"mb-8 mt-8 conditional-format-editor-select-category","data-testid":"conditional-format-editor-select-category"},i.createElement(l.default,{value:t.title,className:"common-select",onChange:this._conditionOptionsChange,listClassName:h()({"filter-condition-list":e,"category-list":!0})},this._generateTypeOption())),t.options.length>1&&i.createElement("div",{className:"mb-8 conditional-format-editor-select-options","data-testid":"conditional-format-editor-select-options"},i.createElement(l.default,{value:d,className:"common-select",listClassName:"options-list",onChange:this._conditionTypeChange},this._generateOperatorOption(t.options))),this._renderInput()))},n._renderInput=function(){var e=(0,d.be)(this.props.rule);switch((0,d._p)(e)){case d.FL.EMPTY:return this._renderEmpty();case d.FL.SINGLE_TEXT:return this._renderSingleText();case d.FL.DOUBLE_TEXT:return this._renderDoubleText();case d.FL.SINGLE_SELECT:return this._renderSingleSelect();default:return null}},n._renderEmpty=function(){return null},n._renderSingleText=function(){var e=this.props.rule.booleanCondition,t=e.inputOne,n=e.conditionType,o=u.Z[n].inputType.placeHolder;return i.createElement("div",{className:"conditional-format-inline-input",style:{height:"36px",width:this.itemWidth}},i.createElement(a.default,{placeholder:o,value:t||"",onChange:this._inputOneChange}))},n._renderDoubleText=function(){var e=this.props.rule.booleanCondition,t=e.inputOne,n=e.inputTwo,o=e.conditionType,r=u.Z[o].inputType.placeHolder;return i.createElement("div",{className:"conditional-format-inline-input flex",style:{height:this.itemHeight}},i.createElement(a.default,{style:{minWidth:"109px",width:"109px"},placeholder:r[0],value:t||"",onChange:this._inputOneChange}),i.createElement("div",{className:"ml-8 mr-8"},s.ZP.t("与")),i.createElement(a.default,{style:{minWidth:"109px",width:"109px"},placeholder:r[1],value:n||"",onChange:this._inputTwoChange}))},n._renderSingleSelect=function(){var e=this.props.rule.booleanCondition,t=e.inputOne,n=e.conditionType,o=t,r=u.Z[n].inputType,s=r.options,c=!!r.needExtraInput&&r.needExtraInput(o);return i.createElement("div",{className:"conditional-format-inline-input"},i.createElement(l.default,{value:c?"SHOW_INPUT":o,style:this.selectStyle,className:"common-select",onChange:this._selectChange},s.map((function(e){return i.createElement(l.default.Option,{value:e.value,key:e.value},e.title)}))),c&&i.createElement(a.default,{style:{width:this.itemWidth,marginTop:this.marginTop},placeholder:"2020/6/10",value:(null===t||void 0===t?void 0:t.replace("SHOW_INPUT",""))||"",onChange:this.onExtraInputChange,onKeyDown:this.triggerEnterEvent}))},n._generateTypeOption=function(){return this.conditionOptions.map((function(e){return i.createElement(l.default.Option,{value:e.title,key:e.title},e.title)}))},n._generateOperatorOption=function(e){return e.map((function(e){var t=e.toString();return i.createElement(l.default.Option,{value:t,key:t},(0,d.YQ)(e))}))},(0,o.Z)(t,[{key:"itemWidth",get:function(){return this.props.isInFilterPanel?"246px":"260px"}},{key:"selectStyle",get:function(){return{width:this.itemWidth,height:this.itemHeight}}},{key:"marginTop",get:function(){return this.props.isInFilterPanel?"16px":"8px"}}]),t}(i.Component);t.Z="page-editor"==n.j?v:null},"../spread-sheet/src/external/sync-guide/common.ts":function(e,t,n){n.d(t,{Vy:function(){return i},YQ:function(){return s},_S:function(){return r},wR:function(){return o}});var o,r,s,i="IS_SYNC_TO_C_LIST";!function(e){e[e.ALL=0]="ALL",e[e.SINGLE=1]="SINGLE",e[e.OFF=2]="OFF"}(o||(o={})),function(e){e[e.RECENT=0]="RECENT"}(r||(r={})),function(e){e[e.ALL=0]="ALL",e[e.SINGLE=1]="SINGLE"}(s||(s={}))},"../spread-sheet/src/external/view/common/components/design-guide/index.tsx":function(e,t,n){n.d(t,{F:function(){return o},M:function(){return d}}),n("../node_modules/core-js/modules/es.object.assign.js");var o,r=n("../node_modules/@babel/runtime/helpers/esm/inheritsLoose.js"),s=n("react"),i=function(e){function t(){return e.apply(this,arguments)||this}return(0,r.Z)(t,e),t.prototype.render=function(){return s.createElement("div",{className:"small-design-guide-container"},s.createElement("div",{className:"small-design-guide-container_title"},this.props.title),s.createElement("div",null,s.createElement("img",{className:"small-design-guide-container_image",src:this.props.imageUrl,alt:""})),s.createElement("div",{className:"small-design-guide-container_content"},this.props.content))},t}(s.Component),a=i,l=function(e){function t(){return e.apply(this,arguments)||this}return(0,r.Z)(t,e),t.prototype.render=function(){return s.createElement("div",{className:"medium-design-guide-container"},s.createElement("div",{className:"medium-design-guide-container_title"},this.props.title),s.createElement("div",{className:"medium-design-guide-container_content"},this.props.content),s.createElement("div",null,s.createElement("img",{className:"medium-design-guide-container_image",src:this.props.imageUrl,alt:""})))},t}(s.Component),c=l;function d(e){return e.guideSize===o.SMALL?s.createElement(a,Object.assign({},e)):s.createElement(c,Object.assign({},e))}!function(e){e.SMALL="small",e.MEDIUM="medium"}(o||(o={}))},"../spread-sheet/src/external/view/ui-layer/auth/auth-drawer.ts":function(e,t,n){var o,r=n("../node_modules/@babel/runtime/helpers/esm/inheritsLoose.js"),s=(n("../node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),n("../node_modules/core-js/modules/esnext.reflect.metadata.js"),n("../node_modules/@tencent/workbench/lib/esm/decorators/class/service.js")),i=n("../spread-sheet/src/core/app/SpreadsheetApp.interface.ts"),a=n("../spread-sheet/src/core/workbench/common/base-drawer.tsx"),l=n("../spread-sheet/src/core/script-loader/index.ts"),c=n("../spread-sheet/src/base/index.ts"),d=n("../spread-sheet/src/core/data/configService/spreadConfig.ts"),u=n("../spread-sheet/src/external/view/common/helper.ts"),p=n("../spread-sheet/src/external/view/common/rangeAuthApiForFeatureComponent/index.ts"),m=function(e,t,n,o){var r,s=arguments.length,i=s<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)i=Reflect.decorate(e,t,n,o);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(i=(s<3?r(i):s>3?r(t,n,i):r(t,n))||i);return s>3&&i&&Object.defineProperty(t,n,i),i},_=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},h=function(e,t){return function(n,o){t(n,o,e)}},f=function(e){function t(t){var n;return(n=e.call(this,t,"auth-drawer")||this).app=t,n.beforeOpenDrawer=function(){return!n.isDrawerOpen||(c.Z.event.default.trigger("CooperationV2IsShowing",!0),!1)},n.afterOpenDrawer=function(){var e=n.config,t=e.showAdvPermissions,o=e.invokeFrom,r=e.updatePolicyInfo;(0,l.$y)("CooperationV2",(function(e){e.init(document.getElementById(n.drawerId),{showAdvPermissionsCmp:t,invokeFrom:o,padId:d.q.getConfig("padId"),owner:{name:d.q.getConfig("userName"),avatar:d.q.getConfig("userPic"),type:"owner",uin:d.q.getConfig("uid")},domainId:d.q.getConfig("domainId"),creatorDomain:d.q.getConfig("creatorDomain"),shareLink:d.q.getConfig("shortLink"),importGuideInfo:{},shareDocType:d.q.getConfig("padType"),rangeAuthApi:p.Z,onAuthExpTimeUpdated:n.app.advPermissions.onUpdateAuthExpInfo,shareTitle:function(){return d.q.getConfig("title")},onAuthUpdated:n.onAuthUpdated,onShare:function(){return(0,u.e7)("permission",r)},onClose:n.onAuthModuleClose}),c.Z.event.default.trigger("CooperationV2Show",!0)}))},n.afterCloseDrawer=function(){(0,l.$y)("CooperationV2",(function(e){e.remove()}))},n.onAuthModuleClose=function(e){n.closeDrawer(),n.onAuthUpdated(e),c.Z.event.default.trigger("CooperationV2Show",!1)},n.onAuthUpdated=function(e){var t,o;e&&(null===(o=(t=n.config).updatePolicyInfo)||void 0===o||o.call(t,e.policy,e.memlist))},n}return(0,r.Z)(t,e),t}(a.Z);f=m([(0,s.t)(),h(0,i.m),_("design:paramtypes",["function"===typeof(o="undefined"!==typeof i.m&&i.m)?o:Object])],f),t.Z="page-editor"==n.j?f:null},"../spread-sheet/src/external/view/ui-layer/condition-format/components/condition-format-drawer.tsx":function(e,t,n){var o,r,s=n("../node_modules/@babel/runtime/helpers/esm/createClass.js"),i=n("../node_modules/@babel/runtime/helpers/esm/inheritsLoose.js"),a=(n("../node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),n("../node_modules/core-js/modules/esnext.reflect.metadata.js"),n("react")),l=n.n(a),c=n("../node_modules/@tencent/workbench/lib/esm/services/drawer/drawer-service.js"),d=n("../node_modules/@tencent/workbench/lib/esm/decorators/class/service.js"),u=n("../spread-sheet/src/core/app/SpreadsheetApp.interface.ts"),p=n("../spread-sheet/src/core/workbench/common/base-drawer.tsx"),m=n("../spread-sheet/src/core/view/level-2/condition-format-center/ui/rulesContainer/RulesContainer.tsx"),_=n("../spread-sheet/src/core/feature/formula/utils.ts"),h=n("../spread-sheet/src/core/feature/formula/autofix.ts"),f=n("../spread-sheet/src/core/view/spreadsheet-view/SpreadsheetView.interface.ts"),g=function(e,t,n,o){var r,s=arguments.length,i=s<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)i=Reflect.decorate(e,t,n,o);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(i=(s<3?r(i):s>3?r(t,n,i):r(t,n))||i);return s>3&&i&&Object.defineProperty(t,n,i),i},v=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},C=function(e,t){return function(n,o){t(n,o,e)}},b=function(e){function t(t,n){var o;return(o=e.call(this,t,"conditional-format-drawer")||this).app=t,o.spreadsheetView=n,o.drawerMode=c.$t.PUSH,o.drawerStyle={width:"auto"},o.beforeOpenDrawer=function(){return!!o.conditionFormat},o.getContent=function(){return l().createElement(m.Z,{panelState:o.config.panelState,conditionType:o.config.conditionType,conditionFormat:o.conditionFormat,mainBoard:o.spreadsheetView.mainBoard,areaData:o.spreadsheetView.areaData,tableView:o.spreadsheetView.tableView,normalSelectData:o.app.view.canvas.normalSelectData,mutationBehavior:o.app.mutationBehavior,sheetStatus:o.app.sheetStatus,spreadsheet:o.app.spreadsheet,hidePanel:o.closeDrawer,addConditionFormat:o.addConditionFormat,updateConditionFormat:o.updateConditionFormat,deleteConditionFormat:o.deleteConditionFormat,updateConditionFormatIndex:o.updateConditionFormatIndex})},o.addConditionFormat=function(e){o.fixFormulaInput(e),o.conditionFormat.addRule(e)},o.updateConditionFormat=function(e){o.fixFormulaInput(e),o.conditionFormat.updateRule(e.ruleId,e)},o.deleteConditionFormat=function(e){o.conditionFormat.deleteRule(e)},o.updateConditionFormatIndex=function(e,t,n){o.conditionFormat.updateRuleIndex(e,t,n)},o}(0,i.Z)(t,e);var n=t.prototype;return n.fixFormulaInput=function(e){if(e.booleanCondition){var t=e.booleanCondition,n=t.inputOne,o=t.inputTwo;n&&(e.booleanCondition.inputOne=this.parserInputIfFormula(n)),o&&(e.booleanCondition.inputTwo=this.parserInputIfFormula(o))}},n.parserInputIfFormula=function(e){if(!e)return e;if((0,_.jr)(e)){var t=this.app.spreadsheet.sheetManager.getSheetTitleList();return(0,h.wh)(e,t)}return e},(0,s.Z)(t,[{key:"conditionFormat",get:function(){var e;return null===(e=this.app.view.canvas.conditionFormatCenter)||void 0===e?void 0:e.conditionFormat}}]),t}(p.Z);b=g([(0,d.t)(),C(0,u.m),C(1,f.Z),v("design:paramtypes",["function"===typeof(o="undefined"!==typeof u.m&&u.m)?o:Object,"function"===typeof(r="undefined"!==typeof f.Z&&f.Z)?r:Object])],b),t.Z="page-editor"==n.j?b:null},"../spread-sheet/src/external/view/ui-layer/extend-addon/addon-interface.ts":function(e,t,n){n.d(t,{f:function(){return s}}),n("../node_modules/regenerator-runtime/runtime.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.promise.js"),n("../node_modules/core-js/modules/es.symbol.js"),n("../node_modules/core-js/modules/es.symbol.description.js"),n("../node_modules/core-js/modules/es.array.iterator.js"),n("../node_modules/core-js/modules/es.string.iterator.js"),n("../node_modules/core-js/modules/web.dom-collections.iterator.js");var o=n("../spread-sheet/src/flow/browser/phase/workbench/merge-into-registry.ts"),r=function(e,t,n,o){return new(n||(n=Promise))((function(r,s){function i(e){try{l(o.next(e))}catch(t){s(t)}}function a(e){try{l(o.throw(e))}catch(t){s(t)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,a)}l((o=o.apply(e,t||[])).next())}))},s=Symbol.for("feature:addon_new");(0,o.N)(s,(function(){return r(void 0,void 0,void 0,regeneratorRuntime.mark((function e(){var t,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([n.e("initial_chunk_part_2"),n.e("vendors-node_modules_tencent_docs-design-resources_pc_png_2x_cdn-function-export_js"),n.e("vendors-node_modules_tencent_docs-addon-sdk_lib_index_esm_js"),n.e("vendors-node_modules_tencent_docs-design-resources_pc_png_2x_cdn_js-node_modules_tencent_docs-70ebca"),n.e("vendors-node_modules_tencent_facade-config_dist_index_js"),n.e("vendors-node_modules_tencent_wedrive-component_dist_xdSaveDoc_css"),n.e("spread-sheet_src_base_util_decorator_loading-decorator_ts-spread-sheet_src_core_feature_copyP-33f189"),n.e("spread-sheet_src_core_view_level-2_condition-format-center_ui_utils_dataUtils_ts"),n.e("spread-sheet_src_core_workbench_common_base-drawer_tsx-spread-sheet_src_external_rangeAuth_ut-2939e0"),n.e("spread-sheet_src_core_view_level-2_chart_charts_chart-data-api_ts-spread-sheet_src_core_view_-9220ef"),n.e("spread-sheet_src_external_view_main_toolbar_IconBox_tsx"),n.e("spread-sheet_src_external_check-slr_sc-lazy-loader_ts-spread-sheet_src_external_templateinfo_-54b3ca"),n.e("spread-sheet_src_core_network_message-center_adapter_MessageCenterAdapter_interface_ts-spread-e88071"),n.e("spread-sheet_src_core_utils_gray_ts-spread-sheet_src_core_view_level-2_condition-format-cente-74d507"),n.e("spread-sheet_src_base_util_phone-number_ts-spread-sheet_src_core_feature_copyPaste_index_ts-s-89b53a"),n.e("spread-sheet_src_core_view_layout_pcView_ts"),n.e("spread-sheet_src_core_view_level-2_link-center_BaseLinkCenter_ts"),n.e("bundle_workbench_feature")]).then(n.bind(n,"../spread-sheet/src/external/view/ui-layer/extend-addon/feature.tsx"));case 2:return t=e.sent,o=t.AddonFeature,e.abrupt("return",o);case 5:case"end":return e.stop()}}),e)})))}))},"../spread-sheet/src/external/view/ui-layer/format-painter/format-painter-feature.interface.ts":function(e,t,n){n.d(t,{KY:function(){return r},mN:function(){return o},qP:function(){return a}}),n("../node_modules/regenerator-runtime/runtime.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.promise.js"),n("../node_modules/core-js/modules/es.symbol.js"),n("../node_modules/core-js/modules/es.symbol.description.js"),n("../node_modules/core-js/modules/es.array.iterator.js"),n("../node_modules/core-js/modules/es.string.iterator.js"),n("../node_modules/core-js/modules/web.dom-collections.iterator.js");var o,r,s=n("../spread-sheet/src/flow/browser/phase/workbench/merge-into-registry.ts"),i=function(e,t,n,o){return new(n||(n=Promise))((function(r,s){function i(e){try{l(o.next(e))}catch(t){s(t)}}function a(e){try{l(o.throw(e))}catch(t){s(t)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,a)}l((o=o.apply(e,t||[])).next())}))};!function(e){e.NONE="none",e.SINGLE="single",e.INFINITE="infinite"}(o||(o={})),function(e){e.CHECKED="退出格式刷(Esc)",e.UN_CHECKED="格式刷，双击可重复使用"}(r||(r={}));var a=Symbol.for("feature:format-painter");(0,s.N)(a,(function(){return i(void 0,void 0,void 0,regeneratorRuntime.mark((function e(){var t,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([n.e("initial_chunk_part_2"),n.e("vendors-node_modules_tencent_docs-design-resources_pc_png_2x_cdn-function-export_js"),n.e("vendors-node_modules_tencent_docs-addon-sdk_lib_index_esm_js"),n.e("vendors-node_modules_tencent_docs-design-resources_pc_png_2x_cdn_js-node_modules_tencent_docs-70ebca"),n.e("vendors-node_modules_tencent_facade-config_dist_index_js"),n.e("vendors-node_modules_tencent_wedrive-component_dist_xdSaveDoc_css"),n.e("spread-sheet_src_base_util_decorator_loading-decorator_ts-spread-sheet_src_core_feature_copyP-33f189"),n.e("spread-sheet_src_core_view_level-2_condition-format-center_ui_utils_dataUtils_ts"),n.e("spread-sheet_src_core_workbench_common_base-drawer_tsx-spread-sheet_src_external_rangeAuth_ut-2939e0"),n.e("spread-sheet_src_core_view_level-2_chart_charts_chart-data-api_ts-spread-sheet_src_core_view_-9220ef"),n.e("spread-sheet_src_external_view_main_toolbar_IconBox_tsx"),n.e("spread-sheet_src_external_check-slr_sc-lazy-loader_ts-spread-sheet_src_external_templateinfo_-54b3ca"),n.e("spread-sheet_src_core_network_message-center_adapter_MessageCenterAdapter_interface_ts-spread-e88071"),n.e("spread-sheet_src_core_utils_gray_ts-spread-sheet_src_core_view_level-2_condition-format-cente-74d507"),n.e("spread-sheet_src_base_util_phone-number_ts-spread-sheet_src_core_feature_copyPaste_index_ts-s-89b53a"),n.e("spread-sheet_src_core_view_layout_pcView_ts"),n.e("spread-sheet_src_core_view_level-2_link-center_BaseLinkCenter_ts"),n.e("bundle_workbench_feature")]).then(n.bind(n,"../spread-sheet/src/external/view/ui-layer/format-painter/format-painter-feature.ts"));case 2:return t=e.sent,o=t.FormatPainter,e.abrupt("return",o);case 5:case"end":return e.stop()}}),e)})))}))},"../spread-sheet/src/external/view/ui-layer/insert-row-col/insert-row-col.interface.ts":function(e,t,n){n.d(t,{mG:function(){return o},n$:function(){return l},pn:function(){return a}}),n("../node_modules/regenerator-runtime/runtime.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.promise.js"),n("../node_modules/core-js/modules/es.symbol.js"),n("../node_modules/core-js/modules/es.symbol.description.js"),n("../node_modules/core-js/modules/es.array.iterator.js"),n("../node_modules/core-js/modules/es.string.iterator.js"),n("../node_modules/core-js/modules/web.dom-collections.iterator.js");var o,r,s=n("../spread-sheet/src/flow/browser/phase/workbench/merge-into-registry.ts"),i=(n("../spread-sheet/src/external/view/schema/contextmenu-key.ts"),function(e,t,n,o){return new(n||(n=Promise))((function(r,s){function i(e){try{l(o.next(e))}catch(t){s(t)}}function a(e){try{l(o.throw(e))}catch(t){s(t)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,a)}l((o=o.apply(e,t||[])).next())}))}),a=-1;!function(e){e.ROWS="rows",e.COLS="cols",e.ABOVE="above",e.BELOW="below",e.LEFT="left",e.RIGHT="right"}(o||(o={})),function(e){e.INSERT_A1ROW="Insert_a1row",e.INSERT_B1ROW="Insert_b1row",e.INSERT_L1COL="Insert_l1column",e.INSERT_R1COL="Insert_r1column"}(r||(r={}));var l=Symbol.for("feature:insert-row-col");(0,s.N)(l,(function(){return i(void 0,void 0,void 0,regeneratorRuntime.mark((function e(){var t,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([n.e("initial_chunk_part_2"),n.e("vendors-node_modules_tencent_docs-design-resources_pc_png_2x_cdn-function-export_js"),n.e("vendors-node_modules_tencent_docs-addon-sdk_lib_index_esm_js"),n.e("vendors-node_modules_tencent_docs-design-resources_pc_png_2x_cdn_js-node_modules_tencent_docs-70ebca"),n.e("vendors-node_modules_tencent_facade-config_dist_index_js"),n.e("vendors-node_modules_tencent_wedrive-component_dist_xdSaveDoc_css"),n.e("spread-sheet_src_base_util_decorator_loading-decorator_ts-spread-sheet_src_core_feature_copyP-33f189"),n.e("spread-sheet_src_core_view_level-2_condition-format-center_ui_utils_dataUtils_ts"),n.e("spread-sheet_src_core_workbench_common_base-drawer_tsx-spread-sheet_src_external_rangeAuth_ut-2939e0"),n.e("spread-sheet_src_core_view_level-2_chart_charts_chart-data-api_ts-spread-sheet_src_core_view_-9220ef"),n.e("spread-sheet_src_external_view_main_toolbar_IconBox_tsx"),n.e("spread-sheet_src_external_check-slr_sc-lazy-loader_ts-spread-sheet_src_external_templateinfo_-54b3ca"),n.e("spread-sheet_src_core_network_message-center_adapter_MessageCenterAdapter_interface_ts-spread-e88071"),n.e("spread-sheet_src_core_utils_gray_ts-spread-sheet_src_core_view_level-2_condition-format-cente-74d507"),n.e("spread-sheet_src_base_util_phone-number_ts-spread-sheet_src_core_feature_copyPaste_index_ts-s-89b53a"),n.e("spread-sheet_src_core_view_layout_pcView_ts"),n.e("spread-sheet_src_core_view_level-2_link-center_BaseLinkCenter_ts"),n.e("bundle_workbench_feature")]).then(n.bind(n,"../spread-sheet/src/external/view/ui-layer/insert-row-col/insert-row-col-feature.tsx"));case 2:return t=e.sent,o=t.InsertRowColFeature,e.abrupt("return",o);case 5:case"end":return e.stop()}}),e)})))}))},"../spread-sheet/src/external/view/ui-layer/new-file/new-file.interface.ts":function(e,t,n){n.d(t,{$e:function(){return a},Dj:function(){return _},J0:function(){return m},Jz:function(){return u},i2:function(){return p},tj:function(){return h}}),n("../node_modules/regenerator-runtime/runtime.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.promise.js"),n("../node_modules/core-js/modules/es.symbol.js"),n("../node_modules/core-js/modules/es.symbol.description.js"),n("../node_modules/core-js/modules/es.array.iterator.js"),n("../node_modules/core-js/modules/es.string.iterator.js"),n("../node_modules/core-js/modules/web.dom-collections.iterator.js");var o,r,s,i,a,l=n("../node_modules/i18next/dist/esm/i18next.js"),c=n("../spread-sheet/src/flow/browser/phase/workbench/merge-into-registry.ts"),d=function(e,t,n,o){return new(n||(n=Promise))((function(r,s){function i(e){try{l(o.next(e))}catch(t){s(t)}}function a(e){try{l(o.throw(e))}catch(t){s(t)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,a)}l((o=o.apply(e,t||[])).next())}))};!function(e){e[e.DOC=0]="DOC",e[e.SHEET=1]="SHEET",e[e.FORM=2]="FORM",e[e.SLIDE=4]="SLIDE",e[e.PDF=6]="PDF",e[e.MIND_MAP=90]="MIND_MAP",e[e.FLOWCHART=91]="FLOWCHART"}(a||(a={}));var u=((o={})[a.DOC]="doc",o[a.SHEET]="sheet",o[a.SLIDE]="slide",o[a.MIND_MAP]="mindMap",o[a.FLOWCHART]="flowChart",o),p=((r={})[a.DOC]=l.ZP.t("无标题文档"),r[a.SHEET]=l.ZP.t("无标题表格"),r[a.SLIDE]=l.ZP.t("无标题幻灯片"),r[a.MIND_MAP]=l.ZP.t("无标题思维导图"),r[a.FLOWCHART]=l.ZP.t("无标题流程图"),r),m=((s={})[a.DOC]=31227,s[a.SHEET]=20001,s[a.SLIDE]=29e3,s),_=((i={})[a.DOC]=2,i[a.SHEET]=1,i[a.SLIDE]=2,i[a.MIND_MAP]=1,i[a.FLOWCHART]=1,i),h=Symbol.for("feature:new-file");(0,c.N)(h,(function(){return d(void 0,void 0,void 0,regeneratorRuntime.mark((function e(){var t,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([n.e("initial_chunk_part_2"),n.e("vendors-node_modules_tencent_docs-design-resources_pc_png_2x_cdn-function-export_js"),n.e("vendors-node_modules_tencent_docs-addon-sdk_lib_index_esm_js"),n.e("vendors-node_modules_tencent_docs-design-resources_pc_png_2x_cdn_js-node_modules_tencent_docs-70ebca"),n.e("vendors-node_modules_tencent_facade-config_dist_index_js"),n.e("vendors-node_modules_tencent_wedrive-component_dist_xdSaveDoc_css"),n.e("spread-sheet_src_base_util_decorator_loading-decorator_ts-spread-sheet_src_core_feature_copyP-33f189"),n.e("spread-sheet_src_core_view_level-2_condition-format-center_ui_utils_dataUtils_ts"),n.e("spread-sheet_src_core_workbench_common_base-drawer_tsx-spread-sheet_src_external_rangeAuth_ut-2939e0"),n.e("spread-sheet_src_core_view_level-2_chart_charts_chart-data-api_ts-spread-sheet_src_core_view_-9220ef"),n.e("spread-sheet_src_external_view_main_toolbar_IconBox_tsx"),n.e("spread-sheet_src_external_check-slr_sc-lazy-loader_ts-spread-sheet_src_external_templateinfo_-54b3ca"),n.e("spread-sheet_src_core_network_message-center_adapter_MessageCenterAdapter_interface_ts-spread-e88071"),n.e("spread-sheet_src_core_utils_gray_ts-spread-sheet_src_core_view_level-2_condition-format-cente-74d507"),n.e("spread-sheet_src_base_util_phone-number_ts-spread-sheet_src_core_feature_copyPaste_index_ts-s-89b53a"),n.e("spread-sheet_src_core_view_layout_pcView_ts"),n.e("spread-sheet_src_core_view_level-2_link-center_BaseLinkCenter_ts"),n.e("bundle_workbench_feature")]).then(n.bind(n,"../spread-sheet/src/external/view/ui-layer/new-file/new-file-service-pc.ts"));case 2:return t=e.sent,o=t.NewFileServicePC,e.abrupt("return",o);case 5:case"end":return e.stop()}}),e)})))}))},"../spread-sheet/src/external/view/ui-layer/print/print-feature.ts":function(e,t,n){n.r(t),n.d(t,{PrintFeature:function(){return g}}),n("../node_modules/regenerator-runtime/runtime.js"),n("../node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),n("../node_modules/core-js/modules/esnext.reflect.metadata.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.promise.js");var o,r,s=n("../node_modules/i18next/dist/esm/i18next.js"),i=n("../node_modules/@tencent/docs-user-agent/dist/index.js"),a=n.n(i),l=n("../node_modules/@tencent/workbench/lib/esm/decorators/class/feature.js"),c=n("../node_modules/@tencent/workbench/lib/esm/services/titlebar/titlebar-service.js"),d=n("../spread-sheet/src/core/app/SpreadsheetApp.interface.ts"),u=n("../spread-sheet/src/core/data/configService/spreadConfig.ts"),p=n("../spread-sheet/src/adapter/SpreadSheetAppAdapter.ts"),m=function(e,t,n,o){var r,s=arguments.length,i=s<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)i=Reflect.decorate(e,t,n,o);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(i=(s<3?r(i):s>3?r(t,n,i):r(t,n))||i);return s>3&&i&&Object.defineProperty(t,n,i),i},_=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},h=function(e,t){return function(n,o){t(n,o,e)}},f=function(e,t,n,o){return new(n||(n=Promise))((function(r,s){function i(e){try{l(o.next(e))}catch(t){s(t)}}function a(e){try{l(o.throw(e))}catch(t){s(t)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,a)}l((o=o.apply(e,t||[])).next())}))},g=function(){function e(e,t){this.app=e,this.titlebarService=t,this.shouldHideTitlebarRight=!1}var t=e.prototype;return t.getShouldHideTitlebarRight=function(){return this.shouldHideTitlebarRight},t.showPrintPanel=function(){var e;return f(this,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,null===(e=this.app.view.canvas)||void 0===e?void 0:e.getTablePrintCenter();case 2:t.sent.showPrintSettingPanel("PRINT");case 4:case"end":return t.stop()}}),t,this)})))},t.shouldDisabled=function(){return!u.q.getConfig("canPrint")||a().isMiniProgram},t.toggleTitlebarRightShow=function(e){this.shouldHideTitlebarRight=!!e,this.titlebarService.$forceUpdate()},t.getToolTip=function(){return this.shouldDisabled()?s.ZP.t("ui|print.noSupport"):""},e}();g=m([(0,l.L)({adapters:[p.L]}),h(0,d.m),_("design:paramtypes",["function"===typeof(o="undefined"!==typeof d.m&&d.m)?o:Object,"function"===typeof(r="undefined"!==typeof c.M&&c.M)?r:Object])],g)},"../spread-sheet/src/external/view/ui-layer/range-auth/config.tsx":function(e,t,n){n.d(t,{G_:function(){return E},OQ:function(){return r},VE:function(){return h},VY:function(){return s},bM:function(){return x},dg:function(){return w},eG:function(){return b},kt:function(){return O},oz:function(){return v}}),n("../node_modules/core-js/modules/es.object.assign.js");var o,r,s,i=n("../node_modules/i18next/dist/esm/i18next.js"),a=n("react"),l=n("../node_modules/@tencent/docs-design-resources/pc/png@2x/cdn.js"),c=n("../spread-sheet/src/external/view/common/components/design-guide/index.tsx"),d=n("../spread-sheet/src/external/view/schema/contextmenu-key.ts"),u=n("../spread-sheet/src/external/view/schema/menu-schema.ts"),p=n("../spread-sheet/src/external/view/schema/toolbar-schema.ts"),m=n("../spread-sheet/src/core/workbench/middleware/selection/selection-type.ts"),_=n("../spread-sheet/src/base/util/domain-config.ts");!function(e){e.PROTECT_RANGE="protectRange",e.PROTECT_SHEET="protectSheet",e.CHECK_ALL="checkAllRangeAuth"}(r||(r={})),function(e){e.TOOLBAR="toolbar",e.CONTEXT_MENU="rightclick"}(s||(s={}));var h=((o={})[r.PROTECT_RANGE]="clk_protect_range",o[r.PROTECT_SHEET]="clk_protect_sheet",o[r.CHECK_ALL]="clk_all_rangeauth",o),f="";switch(i.ZP.language){case"zh-HK":f=l.Z["toolbar_preview_l_lockcell_tc@2x"];break;case"en-US":f=l.Z["toolbar_preview_l_lockcell_en@2x"];break;default:f=l.Z["toolbar_preview_l_lockcell@2x"]}var g={content:i.ZP.t("ui|toolbar.protectDataRangeSheet"),title:i.ZP.t("保护范围与工作表"),imageUrl:f,guideSize:c.F.MEDIUM},v=[{name:p.HM.RANGE_AUTH,icon:a.createElement("div",{className:"icon-svg-toolbar_rangeauth"}),tooltip:{content:(0,c.M)(g),overlayStyle:{padding:0}},hasArrow:!0,style:{width:"auto"},type:"text",inputStatusMiddleWareConfig:{isDisableWhenInput:!0},sheetStatusMiddleware:{isDisabledWhenCannotEdit:!0}}],C={selectionMiddleware:{exclude:[m.R.SHAPE,m.R.CHART,m.R.DISCONTINUOUS_MUTLI_CELLS,m.R.DISCONTINUOUS_COLS,m.R.DISCONTINUOUS_ROWS]},sheetStatusMiddleware:{isHiddenWhenNotOwnerOfDocument:!_.xc}},b=[Object.assign({name:u.z_.RANGE_AUTH_PROTECT_RANGE,content:i.ZP.t("保护所选范围")},C),{name:u.z_.RANGE_AUTH,content:""}],w=[Object.assign({name:d.B.PROTECT_SELECTED_RANGE,content:i.ZP.t("保护所选范围")},C)],E=[Object.assign({name:u.z_.RANGE_AUTH_PROTECT_SHEET,content:i.ZP.t("保护本工作表")},C)],y={selectionMiddleware:{exclude:[m.R.SHAPE,m.R.CHART,m.R.DISCONTINUOUS_COLS,m.R.DISCONTINUOUS_ROWS]},sheetStatusMiddleware:{isHiddenWhenNotOwnerOfDocument:!0}},O=[Object.assign({name:u.z_.RANGE_AUTH_CHECK_ALL,content:i.ZP.t("查看已保护范围")},y)],x=[Object.assign({name:d.B.PROTECTED_RANGE_LIST},y)]},"../spread-sheet/src/external/view/ui-layer/short-cut/short-cut-drawer.ts":function(e,t,n){n.d(t,{Z:function(){return f}});var o,r=n("../node_modules/@babel/runtime/helpers/esm/inheritsLoose.js"),s=(n("../node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),n("../node_modules/core-js/modules/esnext.reflect.metadata.js"),n("../node_modules/@tencent/workbench/lib/esm/decorators/class/service.js")),i=n("../spread-sheet/src/core/app/SpreadsheetApp.interface.ts"),a=n("../spread-sheet/src/core/script-loader/index.ts"),l=n("../node_modules/i18next/dist/esm/i18next.js"),c=(n("../spread-sheet/src/base/util/domain-config.ts"),[{typeName:l.ZP.t("操作"),keybindings:[{description:l.ZP.t("复制"),kbOpts:{win:["Ctrl","C"],mac:["⌘","C"]}},{description:l.ZP.t("粘贴"),kbOpts:{win:["Ctrl","V"],mac:["⌘","V"]}},{description:l.ZP.t("剪切"),kbOpts:{win:["Ctrl","X"],mac:["⌘","X"]}},{description:l.ZP.t("撤销"),kbOpts:{win:["Ctrl","Z"],mac:["⌘","Z"]}},{description:l.ZP.t("重做"),kbOpts:{win:["Ctrl","Y"],mac:["⌘","Y"]}}]},{typeName:l.ZP.t("插入"),keybindings:[{description:l.ZP.t("插入批注"),kbOpts:{win:["Shift","F2"],mac:["⇧","F2"]}},{description:l.ZP.t("插入当前日期"),kbOpts:{win:["Ctrl",";"],mac:["⌃",";"]}},{description:l.ZP.t("插入当前时间"),kbOpts:{win:["Ctrl","Shift",";"],mac:["⌘","⇧",";"]}},{description:l.ZP.t("插入当前日期+时间"),kbOpts:{win:["Ctrl","Alt",";"],mac:["⌘","⌥",";"]}},{description:l.ZP.t("插入链接"),kbOpts:{win:["Ctrl","K"],mac:["⌘","K"]}}]},{typeName:l.ZP.t("功能"),keybindings:[{description:l.ZP.t("筛选"),kbOpts:{win:["Alt","Shift","L"],mac:["⌃","⇧","L"]}},{description:l.ZP.t("编辑单元格"),kbOpts:{win:["F2"],mac:["F2"]}},{description:l.ZP.t("向下填充"),kbOpts:{win:["Ctrl","D"],mac:["⌃","D"]}},{description:l.ZP.t("选区填充"),kbOpts:{win:["Ctrl","Enter"],mac:["⌘","Enter"]}},{description:l.ZP.t("关闭窗口"),kbOpts:{win:["Ctrl","W"],mac:["⌘","W"]}},{description:l.ZP.t("合并/取消合并单元格"),kbOpts:{win:["Alt","Shift","D"],mac:["⌥","⇧","D"]}}]},{typeName:l.ZP.t("格式"),keybindings:[{description:l.ZP.t("加粗"),kbOpts:{win:["Ctrl","B"],mac:["⌘","B"]}},{description:l.ZP.t("倾斜"),kbOpts:{win:["Ctrl","I"],mac:["⌘","I"]}},{description:l.ZP.t("下划线"),kbOpts:{win:["Ctrl","U"],mac:["⌘","U"]}},{description:l.ZP.t("删除线"),kbOpts:{win:["Ctrl","5"],mac:["⌃","5"]}},{description:l.ZP.t("左对齐"),kbOpts:{win:["Ctrl","L"],mac:["⌃","L"]}},{description:l.ZP.t("右对齐"),kbOpts:{win:["Ctrl","R"],mac:["⌃","R"]}},{description:l.ZP.t("居中对齐"),kbOpts:{win:["Ctrl","E"],mac:["⌃","E"]}},{description:l.ZP.t("字号变大"),kbOpts:{win:["Ctrl","Shift","."],mac:["⌘","⇧","."]}},{description:l.ZP.t("字号变小"),kbOpts:{win:["Ctrl","Shift",","],mac:["⌘","⇧",","]}}]},{typeName:l.ZP.t("行列"),keybindings:[{description:l.ZP.t("隐藏行"),kbOpts:{win:["Ctrl","Alt","9"],mac:["⌘","⌥","9"]}},{description:l.ZP.t("隐藏列"),kbOpts:{win:["Ctrl","Alt","0"],mac:["⌘","⌥","0"]}},{description:l.ZP.t("取消隐藏行"),kbOpts:{win:["Alt","Shift","9"],mac:["⌥","⇧","9"]}},{description:l.ZP.t("取消隐藏列"),kbOpts:{win:["Alt","Shift","0"],mac:["⌥","⇧","0"]}},{description:l.ZP.t("向上增加行"),kbOpts:{win:["Alt","Shift","="],mac:["⌥","⇧","="]}},{description:l.ZP.t("删除行"),kbOpts:{win:["Alt","Shift","-"],mac:["⌥","⇧","-"]}},{description:l.ZP.t("向左插入列"),kbOpts:{win:["Ctrl","Alt","="],mac:["⌘","⌥","="]}},{description:l.ZP.t("删除列"),kbOpts:{win:["Ctrl","Alt","-"],mac:["⌘","⌥","-"]}},{description:l.ZP.t("选中行"),kbOpts:{win:["Ctrl","Shift",l.ZP.t("空格")],mac:["⇧",l.ZP.t("空格")]}},{description:l.ZP.t("选中列"),kbOpts:{win:["Ctrl","Alt",l.ZP.t("空格")],mac:["⌥",l.ZP.t("空格")]}}]},{typeName:l.ZP.t("导航"),keybindings:[{description:l.ZP.t("全选"),kbOpts:{win:["Ctrl","A"],mac:["⌘","A"]}},{description:l.ZP.t("向下移动一屏"),kbOpts:{win:["PageDown"],mac:["Fn","↓"]}},{description:l.ZP.t("向上移动一屏"),kbOpts:{win:["PageUp"],mac:["Fn","↑"]}},{description:l.ZP.t("移至行首单元格"),kbOpts:{win:["Home"],mac:["Fn","←"]}},{description:l.ZP.t("移至行末单元格"),kbOpts:{win:["End"],mac:["Fn","→"]}},{description:l.ZP.t("移至上一个工作表"),kbOpts:{win:["Alt","←"],mac:["⌥","←"]}},{description:l.ZP.t("移至下一个工作表"),kbOpts:{win:["Alt","→"],mac:["⌥","→"]}},{description:l.ZP.t("移至工作表开头"),kbOpts:{win:["Ctrl","Home"],mac:["⌘","Fn","←"]}},{description:l.ZP.t("移至工作表结尾"),kbOpts:{win:["Ctrl","End"],mac:["⌘","Fn","→"]}},{description:l.ZP.t("移至当前数据区边缘"),kbOpts:{win:["Ctrl","↑/↓/←/→"],mac:["⌘","↑/↓/←/→"]}},{description:l.ZP.t("选区扩展一格"),kbOpts:{win:["Shift","↑/↓/←/→"],mac:["⇧","↑/↓/←/→"]}},{description:l.ZP.t("扩展至数据区边缘"),kbOpts:{win:["Ctrl","Shift","↑/↓/←/→"],mac:["⌘","⇧","↑/↓/←/→"]}}]},{typeName:l.ZP.t("查看"),keybindings:[{description:l.ZP.t("放大/缩小视图"),kbOpts:{win:["Ctrl",l.ZP.t("鼠标滚轮")],mac:["⌘",l.ZP.t("鼠标滚轮")]}},{description:l.ZP.t("100%视图"),kbOpts:{win:["Ctrl","0"],mac:["⌘","0"]}},{description:l.ZP.t("全屏/取消全屏"),kbOpts:{win:["F11"],mac:["⌘","⌃","F"]}},{description:l.ZP.t("左右查看表格"),kbOpts:{win:["Shift",l.ZP.t("鼠标滚轮")],mac:["⇧",l.ZP.t("鼠标滚轮")]}},{description:l.ZP.t("查找"),kbOpts:{win:["Ctrl","F"],mac:["⌘","F"]}},{description:l.ZP.t("替换"),kbOpts:{win:["Ctrl","H"],mac:["⌘","⇧","H"]}},{description:l.ZP.t("打开/关闭快捷键面板"),kbOpts:{win:["Ctrl","/"],mac:["⌘","/"]}}]}]),d=n("../spread-sheet/src/core/workbench/common/base-drawer.tsx"),u=n("../spread-sheet/src/base/event/event.ts"),p=function(e,t,n,o){var r,s=arguments.length,i=s<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)i=Reflect.decorate(e,t,n,o);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(i=(s<3?r(i):s>3?r(t,n,i):r(t,n))||i);return s>3&&i&&Object.defineProperty(t,n,i),i},m=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},_=function(e,t){return function(n,o){t(n,o,e)}},h=function(e){function t(t){var n;return(n=e.call(this,t,"short-cut-drawer")||this).app=t,n.afterOpenDrawer=function(){var e;if(n.app.spreadsheet.isExternalSheet()){var t=n.app.sheetAdapterManager.getCurrentAdapter();e=null===t||void 0===t?void 0:t.getKeybindings()}else e=c;(0,a.$y)("ShortcutPanel",(function(t){t.init(document.getElementById(n.drawerId),{shortcutKeybindings:e,close:n.closeDrawer})})),u.ZP.sheetsBar.listen("switchSheet",n.afterOpenDrawer)},n.afterCloseDrawer=function(){(0,a.$y)("ShortcutPanel",(function(e){e.remove()})),u.ZP.sheetsBar.remove("switchSheet",n.afterOpenDrawer)},n.registerListener=function(){u.ZP.keyboard.listen("toggleShortcutPanel",n.toggleDrawer)},n.registerListener(),n}return(0,r.Z)(t,e),t}(d.Z),f=h=p([(0,s.t)(),_(0,i.m),m("design:paramtypes",["function"===typeof(o="undefined"!==typeof i.m&&i.m)?o:Object])],h)},"../spread-sheet/src/external/view/ui-layer/sync-guide-ent/config.tsx":function(e,t,n){n.d(t,{Uk:function(){return a},YD:function(){return l},aU:function(){return c}});var o,r=n("../node_modules/i18next/dist/esm/i18next.js"),s=n("../spread-sheet/src/external/view/schema/menu-schema.ts"),i=n("../spread-sheet/src/external/view/schema/mobile-menu-schema.ts"),a=((o={})[s.z_.SYNC_GUIDE_OFF]=r.ZP.t("不同步"),o[s.z_.SYNC_GUIDE_SINGLE]=r.ZP.t("同步单篇"),o[s.z_.SYNC_GUIDE_ALL]=r.ZP.t("同步全部"),o),l=[{name:s.z_.SYNC_GUIDE,content:r.ZP.t("同步到腾讯文档列表"),privateFillMiddleWareConfig:{shouldCheckWhenCellIsPrivate:!0}},{name:s.z_.SYNC_GUIDE_TIPS,content:r.ZP.t("同步后，将支持快捷管理")},{name:s.z_.SYNC_GUIDE_OFF,content:a[s.z_.SYNC_GUIDE_OFF],privateFillMiddleWareConfig:{shouldCheckWhenCellIsPrivate:!0}},{name:s.z_.SYNC_GUIDE_SINGLE,content:a[s.z_.SYNC_GUIDE_SINGLE],privateFillMiddleWareConfig:{shouldCheckWhenCellIsPrivate:!0}},{name:s.z_.SYNC_GUIDE_ALL,content:a[s.z_.SYNC_GUIDE_ALL],privateFillMiddleWareConfig:{shouldCheckWhenCellIsPrivate:!0}}],c=[{name:i.d.SYNC_GUIDE,iconClass:"mobile-design-icon icon-menu-sync",content:r.ZP.t("同步到腾讯文档列表")},{name:i.d.SYNC_GUIDE_OFF,content:a[s.z_.SYNC_GUIDE_OFF]},{name:i.d.SYNC_GUIDE_SINGLE,content:a[s.z_.SYNC_GUIDE_SINGLE]},{name:i.d.SYNC_GUIDE_ALL,content:a[s.z_.SYNC_GUIDE_ALL]}]},"../spread-sheet/src/external/view/ui-layer/titlebar/components/share-btn/share-manager.ts":function(e,t,n){n.d(t,{Ak:function(){return i}}),n("../node_modules/core-js/modules/es.regexp.exec.js"),n("../node_modules/core-js/modules/es.string.split.js"),n("../node_modules/core-js/modules/es.object.assign.js");var o=n("../node_modules/i18next/dist/esm/i18next.js"),r=n("../spread-sheet/src/core/data/configService/spreadConfig.ts"),s=function(e,t,n){if(void 0===n&&(n={}),document.getElementById("doc-sharebox-container").style.display="block",e){var s=window.clientVars,i=s.padId,a=s.domainId,l=s.creatorDomain,c=s.padType,d="drive"===c?s.concretPadType:c,u=s.isCreator,p=function(){var e=window.clientVars.shortLink||window.location.href.split("#")[0];if(-1===e.indexOf("?"))return e;var t=e.split("?")[1],n=e.split("?")[0];return t?n:e}(),m={mind:o.ZP.t("禁止查看者复制、生成副本。"),flowchart:o.ZP.t("禁止查看者复制、生成副本。"),drive:o.ZP.t("禁止查看者复制、下载与生成副本。")},_=r.q.getConfig("isGrayed");window.Share.init(document.getElementById("doc-sharebox-container"),Object.assign({invokeFrom:"detail",padId:i,shareLink:p,shareTitle:function(){return r.q.getConfig("title")?r.q.getConfig("title"):r.q.getConfig("padTitle")},shareDocType:d,domainId:a,creatorDomain:l,havePermission:u,advLinkText:m[c],showTransfer:{mind:!1,flowchart:!1,drive:!1}[c],onAuthUpdated:function(e){null===t||void 0===t||t(e)},onClose:function(){document.getElementById("doc-sharebox-container").style.display="none"},isToBGrayUser:_},n))}else window.Share.show({onAuthUpdated:function(e){null===t||void 0===t||t(e)},onClose:function(){document.getElementById("doc-sharebox-container").style.display="none"}})},i=function(e,t){"undefined"!==typeof Share?s(!1,e):window.SLR.load("Share",(function(n){window.Share=n,s(!0,e,t)}))}},"../spread-sheet/src/external/view/ui-layer/toggle-titlebar/toggle-titlebar-feature.ts":function(e,t,n){n.r(t),n.d(t,{ToggleTitleFeature:function(){return u}}),n("../node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),n("../node_modules/core-js/modules/esnext.reflect.metadata.js");var o,r=n("../node_modules/@tencent/workbench/lib/esm/decorators/class/feature.js"),s=n("../packages/lib/index.ts"),i=n("../spread-sheet/src/external/view/ui-layer/toggle-titlebar/toggle-titlebar.interface.ts"),a=n("../spread-sheet/src/core/app/SpreadsheetApp.interface.ts"),l=function(e,t,n,o){var r,s=arguments.length,i=s<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)i=Reflect.decorate(e,t,n,o);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(i=(s<3?r(i):s>3?r(t,n,i):r(t,n))||i);return s>3&&i&&Object.defineProperty(t,n,i),i},c=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},d=function(e,t){return function(n,o){t(n,o,e)}},u=function(){function e(e){var t=this;this.app=e,this._onTitlebarToggle=new s.Q5,this.onTitlebarToggle=this._onTitlebarToggle.event,this.triggerToggle=function(){t._onTitlebarToggle.fire()}}return e.prototype.triggerResize=function(){var e=this;setTimeout((function(){e.app.view.canvas.resize.resize()}),300)},e}();u=l([(0,r.L)({provide:i.Y}),d(0,a.m),c("design:paramtypes",["function"===typeof(o="undefined"!==typeof a.m&&a.m)?o:Object])],u)},"../spread-sheet/src/external/view/ui-layer/toggle-titlebar/toggle-titlebar.interface.ts":function(e,t,n){n.d(t,{Y:function(){return s}}),n("../node_modules/regenerator-runtime/runtime.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.promise.js"),n("../node_modules/core-js/modules/es.symbol.js"),n("../node_modules/core-js/modules/es.symbol.description.js"),n("../node_modules/core-js/modules/es.array.iterator.js"),n("../node_modules/core-js/modules/es.string.iterator.js"),n("../node_modules/core-js/modules/web.dom-collections.iterator.js");var o=n("../spread-sheet/src/flow/browser/phase/workbench/merge-into-registry.ts"),r=function(e,t,n,o){return new(n||(n=Promise))((function(r,s){function i(e){try{l(o.next(e))}catch(t){s(t)}}function a(e){try{l(o.throw(e))}catch(t){s(t)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,a)}l((o=o.apply(e,t||[])).next())}))},s=Symbol.for("feature:toggle-titlebar");(0,o.N)(s,(function(){return r(void 0,void 0,void 0,regeneratorRuntime.mark((function e(){var t,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([n.e("initial_chunk_part_2"),n.e("vendors-node_modules_tencent_docs-design-resources_pc_png_2x_cdn-function-export_js"),n.e("vendors-node_modules_tencent_docs-addon-sdk_lib_index_esm_js"),n.e("vendors-node_modules_tencent_docs-design-resources_pc_png_2x_cdn_js-node_modules_tencent_docs-70ebca"),n.e("vendors-node_modules_tencent_facade-config_dist_index_js"),n.e("vendors-node_modules_tencent_wedrive-component_dist_xdSaveDoc_css"),n.e("spread-sheet_src_base_util_decorator_loading-decorator_ts-spread-sheet_src_core_feature_copyP-33f189"),n.e("spread-sheet_src_core_view_level-2_condition-format-center_ui_utils_dataUtils_ts"),n.e("spread-sheet_src_core_workbench_common_base-drawer_tsx-spread-sheet_src_external_rangeAuth_ut-2939e0"),n.e("spread-sheet_src_core_view_level-2_chart_charts_chart-data-api_ts-spread-sheet_src_core_view_-9220ef"),n.e("spread-sheet_src_external_view_main_toolbar_IconBox_tsx"),n.e("spread-sheet_src_external_check-slr_sc-lazy-loader_ts-spread-sheet_src_external_templateinfo_-54b3ca"),n.e("spread-sheet_src_core_network_message-center_adapter_MessageCenterAdapter_interface_ts-spread-e88071"),n.e("spread-sheet_src_core_utils_gray_ts-spread-sheet_src_core_view_level-2_condition-format-cente-74d507"),n.e("spread-sheet_src_base_util_phone-number_ts-spread-sheet_src_core_feature_copyPaste_index_ts-s-89b53a"),n.e("spread-sheet_src_core_view_layout_pcView_ts"),n.e("spread-sheet_src_core_view_level-2_link-center_BaseLinkCenter_ts"),n.e("bundle_workbench_feature")]).then(n.bind(n,"../spread-sheet/src/external/view/ui-layer/toggle-titlebar/toggle-titlebar-feature.ts"));case 2:return t=e.sent,o=t.ToggleTitleFeature,e.abrupt("return",o);case 5:case"end":return e.stop()}}),e)})))}))},"../spread-sheet/src/external/view/ui-layer/wedrive-ent/config.ts":function(e,t,n){n.d(t,{Pf:function(){return i},Vq:function(){return a},Zv:function(){return l},xt:function(){return c}});var o=n("../node_modules/i18next/dist/esm/i18next.js"),r=n("../spread-sheet/src/external/view/schema/menu-schema.ts"),s=n("../spread-sheet/src/external/view/schema/mobile-toolbar-schema.ts"),i=[{name:r.z_.SAVE_TO_WEDRIVE,content:o.ZP.t("添加快捷方式到...")}],a=[{name:r.z_.MOVE_TO_WEDRIVE,content:o.ZP.t("移动到...")}],l=[{name:r.z_.VIEW_IN_WEDRIVE,content:o.ZP.t("查看所在位置")}],c=[{name:s.cx.INSERT_WEDRIVE_FILE,iconClass:"ui-icon-insert-wedrivelink",type:"square",text:o.ZP.t("微盘文件"),privateFillMiddleWareConfig:{shouldCheckWhenCellIsPrivate:!0}}]},"../spread-sheet/src/external/view/ui-layer/wedrive-ent/view-in-wedrive-controller.ts":function(e,t,n){n.d(t,{u:function(){return h}});var o,r=n("../node_modules/@babel/runtime/helpers/esm/createClass.js"),s=(n("../node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),n("../node_modules/core-js/modules/esnext.reflect.metadata.js"),n("../node_modules/@tencent/workbench/lib/esm/decorators/method/menu.js")),i=n("../node_modules/@tencent/workbench/lib/esm/decorators/class/controller.js"),a=n("../node_modules/@tencent/ioc/lib/esm/index.js"),l=n("../node_modules/@tencent/workbench/lib/esm/index.js"),c=n("../spread-sheet/src/external/view/schema/menu-schema.ts"),d=n("../spread-sheet/src/external/view/ui-layer/wedrive-ent/config.ts"),u=n("../spread-sheet/src/external/view/ui-layer/wedrive-ent/wedrive.interface.ts"),p=function(e,t,n,o){var r,s=arguments.length,i=s<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)i=Reflect.decorate(e,t,n,o);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(i=(s<3?r(i):s>3?r(t,n,i):r(t,n))||i);return s>3&&i&&Object.defineProperty(t,n,i),i},m=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},_=function(e,t){return function(n,o){t(n,o,e)}},h=function(){function e(e){this.loader=e}return e.prototype.shouldHideViewInWedrive=function(){return!this.wedriveFeature.shouldShowViewInWedrive()},(0,r.Z)(e,[{key:"wedriveFeature",get:function(){return this.loader.instance}}]),e}();p([(0,s.v)(c.z_.VIEW_IN_WEDRIVE,"shouldHide"),m("design:type",Function),m("design:paramtypes",[]),m("design:returntype",void 0)],h.prototype,"shouldHideViewInWedrive",null),h=p([(0,i.Q)({menuItems:d.Zv}),_(0,(0,a.aN)(u.G)),m("design:paramtypes",["function"===typeof(o="undefined"!==typeof l.IDynamicLoader&&l.IDynamicLoader)?o:Object])],h)},"../spread-sheet/src/external/view/ui-layer/wedrive-ent/wedrive.interface.ts":function(e,t,n){n.d(t,{G:function(){return s}}),n("../node_modules/regenerator-runtime/runtime.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.promise.js"),n("../node_modules/core-js/modules/es.symbol.js"),n("../node_modules/core-js/modules/es.symbol.description.js"),n("../node_modules/core-js/modules/es.array.iterator.js"),n("../node_modules/core-js/modules/es.string.iterator.js"),n("../node_modules/core-js/modules/web.dom-collections.iterator.js");var o=n("../spread-sheet/src/flow/browser/phase/workbench/merge-into-registry.ts"),r=function(e,t,n,o){return new(n||(n=Promise))((function(r,s){function i(e){try{l(o.next(e))}catch(t){s(t)}}function a(e){try{l(o.throw(e))}catch(t){s(t)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,a)}l((o=o.apply(e,t||[])).next())}))},s=Symbol.for("feature:wedrive");(0,o.N)(s,(function(){return r(void 0,void 0,void 0,regeneratorRuntime.mark((function e(){var t,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([n.e("initial_chunk_part_2"),n.e("vendors-node_modules_tencent_docs-design-resources_pc_png_2x_cdn-function-export_js"),n.e("vendors-node_modules_tencent_docs-addon-sdk_lib_index_esm_js"),n.e("vendors-node_modules_tencent_docs-design-resources_pc_png_2x_cdn_js-node_modules_tencent_docs-70ebca"),n.e("vendors-node_modules_tencent_facade-config_dist_index_js"),n.e("vendors-node_modules_tencent_wedrive-component_dist_xdSaveDoc_css"),n.e("spread-sheet_src_base_util_decorator_loading-decorator_ts-spread-sheet_src_core_feature_copyP-33f189"),n.e("spread-sheet_src_core_view_level-2_condition-format-center_ui_utils_dataUtils_ts"),n.e("spread-sheet_src_core_workbench_common_base-drawer_tsx-spread-sheet_src_external_rangeAuth_ut-2939e0"),n.e("spread-sheet_src_core_view_level-2_chart_charts_chart-data-api_ts-spread-sheet_src_core_view_-9220ef"),n.e("spread-sheet_src_external_view_main_toolbar_IconBox_tsx"),n.e("spread-sheet_src_external_check-slr_sc-lazy-loader_ts-spread-sheet_src_external_templateinfo_-54b3ca"),n.e("spread-sheet_src_core_network_message-center_adapter_MessageCenterAdapter_interface_ts-spread-e88071"),n.e("spread-sheet_src_core_utils_gray_ts-spread-sheet_src_core_view_level-2_condition-format-cente-74d507"),n.e("spread-sheet_src_base_util_phone-number_ts-spread-sheet_src_core_feature_copyPaste_index_ts-s-89b53a"),n.e("spread-sheet_src_core_view_layout_pcView_ts"),n.e("spread-sheet_src_core_view_level-2_link-center_BaseLinkCenter_ts"),n.e("bundle_workbench_feature")]).then(n.bind(n,"../spread-sheet/src/external/view/ui-layer/wedrive-ent/wedrive-feature.ts"));case 2:return t=e.sent,o=t.WedriveFeature,e.abrupt("return",o);case 5:case"end":return e.stop()}}),e)})))}))}}]),window.jsExecEndTimeStamp=Date.now(),window.cachedPerformanceEntries||(window.cachedPerformanceEntries=[]),window.cachedPerformanceEntries.push({name:"jsExec: js/spread-sheet_src_core_network_message-center_adapter_MessageCenterAdapter_interface_ts-spread-e88071.97214219c7cc00ab315e.js",entryType:"jsExec",startTime:window.jsExecStartTimeStamp,endTime:window.jsExecEndTimeStamp});
//# sourceMappingURL=spread-sheet_src_core_network_message-center_adapter_MessageCenterAdapter_interface_ts-spread-e88071.97214219c7cc00ab315e.js.map