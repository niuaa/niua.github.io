self.window=self,window.jsExecStartTimeStamp=Date.now(),(self.webpackChunk_tencent_alloy_builder=self.webpackChunk_tencent_alloy_builder||[]).push([["spread-sheet_src_core_view_level-2_link-center_BaseLinkCenter_ts"],{"../spread-sheet/src/core/view/level-2/link-center/BaseLinkCenter.ts":function(e,t,n){n.d(t,{Z:function(){return V}});var r=n("../node_modules/@babel/runtime/helpers/esm/toConsumableArray.js"),o=n("../node_modules/@babel/runtime/helpers/esm/createClass.js"),s=(n("../node_modules/regenerator-runtime/runtime.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.promise.js"),n("../node_modules/core-js/modules/es.array.concat.js"),n("../node_modules/core-js/modules/es.array.filter.js"),n("../node_modules/core-js/modules/es.array.iterator.js"),n("../node_modules/core-js/modules/es.string.iterator.js"),n("../node_modules/core-js/modules/web.dom-collections.iterator.js"),n("../node_modules/core-js/modules/web.dom-collections.for-each.js"),n("../node_modules/@tencent/docs-user-agent/dist/index.js")),i=n.n(s),a=n("../spread-sheet/src/base/index.ts"),c=n("../spread-sheet/src/base/util/url.ts"),l=n("../spread-sheet/src/core/view/utils/browser-func.ts"),d=n("../node_modules/i18next/dist/esm/i18next.js"),u=n("../node_modules/@tencent/dui/lib/components/Snackbar/index.js"),h=n("../node_modules/@tencent/dui-mobile/lib/components/Snackbar/index.js");function m(e){var t=i().isMobile?h.default:u.default;e.duration||(e.duration=3e3),t.show(e)}var f=n("../packages/report/src/index.ts"),p=n("../packages/model/src/range/index.ts"),v=n("../spread-sheet/src/core/utils/linkedRange.ts"),g=n("../packages/model/src/dimension/index.ts"),_=n("../packages/model/src/cell/HyperlinkType.ts"),w=n("../packages/model/src/range/dimensionRangeUtils.ts"),I=n("../spread-sheet/src/core/data/configService/spreadConfig.ts"),x=n("../spread-sheet/src/core/view/level-2/link-center/constant.ts"),k=n("../spread-sheet/src/core/view/level-2/link-center/enum.ts"),R=(n("../node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),n("../node_modules/core-js/modules/esnext.reflect.metadata.js"),n("../node_modules/core-js/modules/es.array.find-index.js"),n("../node_modules/core-js/modules/es.array.splice.js"),n("../node_modules/core-js/modules/es.function.name.js"),n("../node_modules/core-js/modules/es.object.assign.js"),n("../node_modules/core-js/modules/es.array.slice.js"),n("../node_modules/core-js/modules/es.array.from.js"),n("../node_modules/core-js/modules/es.symbol.js"),n("../node_modules/core-js/modules/es.symbol.description.js"),n("../node_modules/core-js/modules/es.symbol.iterator.js"),n("../spread-sheet/src/core/view/level-2/link-center/logic/attachment/interface.ts")),E=n("../spread-sheet/src/core/ark-extensions/index.ts"),b=n("../spread-sheet/src/core/ui/loading/index.ts"),y=n("../spread-sheet/src/core/ark-extensions/extensions/attachment.ts"),S=n("../spread-sheet/src/base/util/decorator/loading-decorator.ts");function C(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){if(e){if("string"===typeof e)return j(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?j(e,t):void 0}}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0;return function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function j(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var N,L,D=function(e,t,n,r){var o,s=arguments.length,i=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)i=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(i=(s<3?o(i):s>3?o(t,n,i):o(t,n))||i);return s>3&&i&&Object.defineProperty(t,n,i),i},A=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},P=function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function i(e){try{c(r.next(e))}catch(t){s(t)}}function a(e){try{c(r.throw(e))}catch(t){s(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,a)}c((r=r.apply(e,t||[])).next())}))};!function(e){e.BY_ID="BY_ID",e.BY_POSITION="BY_POSITION"}(L||(L={}));var T=function(){function e(e){var t=this;this.hasAttachmentExtensionLoaded=!1,this.getAttachmentExtension=function(){return P(t,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.mountAndRegisterAttachment();case 2:return e.abrupt("return",this.attachmentExtension);case 3:case"end":return e.stop()}}),e,this)})))},this.normalSelectData=e.normalSelectData,this.sheetReference=e.sheetReference,this.padId=e.padId,this.maxUploadNumber=e.maxUploadNumber,this.isMultiple=e.isMultiple,this.attachmentDb=[]}var t=e.prototype;return t.getAttachment=function(e,t){return e===L.BY_ID?this.getAttachmentById(t):this.getAttachmentByPosition(t)},t.addAttachment=function(e){return P(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=e.getPosition(),this.attachmentDb.push({position:n,instance:e});case 2:case"end":return t.stop()}}),t,this)})))},t.registerCallback=function(e){var t=e.options,n=this.sheetReference.activeSheetId,r=this.normalSelectData,o={row:r.activeRow,col:r.activeCol,sheetId:n};switch(e.statusName){case R.cn.FILEREAD:this.handleFileRead(t,o);break;case R.cn.PROCESS:this.handleProcess(t);break;case R.cn.SUCCESS:this.handleSuccess(t);break;default:this.handleFailure(t)}},t.deleteAttachment=function(e){var t,r=this.attachmentDb.findIndex((function(t){return t.id===e}));return r<0?(null===(t=n.g.log)||void 0===t||t.warn("link-attachment","=== id: "+e+" not found."),null):this.attachmentDb.splice(r,1)},t.getIdFromPosition=function(e){for(var t,n=C(this.attachmentDb);!(t=n()).done;){var r=t.value;if(this.positionShallowEqual(r.position,e))return r.id}},t.handleCancelUpload=function(e){return P(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n,r,o,s,i;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=this.getAttachmentByPosition(e)){t.next=3;break}return t.abrupt("return");case 3:r=this.getIdFromPosition(e),n.getUploadStatus()===R.VC.ERROR?(o=e.row,s=e.col,i=e.sheetId,b.ZP.removeInstance(o,s,i)):n.abort(r),n.remove(r),n.destroy(),this.deleteAttachment(r);case 9:case"end":return t.stop()}}),t,this)})))},t.shouldPreventEnterInput=function(e,t){var n=this.sheetReference.activeSheetId;return void 0!==b.ZP.getInstance(e,t,n)},t.mountAndRegisterAttachment=function(){var e;return P(this,void 0,void 0,regeneratorRuntime.mark((function t(){var r,o,s,i=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.hasAttachmentExtensionLoaded){t.next=2;break}return t.abrupt("return");case 2:return r=this.padId,o=this.maxUploadNumber,s=this.isMultiple,t.next=5,this.getDcAttachment();case 5:this.attachmentExtension=t.sent,this.attachmentExtension.mount({padId:r,maxUploadNumber:o,multiple:s}),this.attachmentExtension.onStatusChange((function(e){i.registerCallback(e)})),this.hasAttachmentExtensionLoaded=!0,null===(e=n.g.log)||void 0===e||e.log("link-attachment","=== mount and register finish");case 10:case"end":return t.stop()}}),t,this)})))},t.getDcAttachment=function(){return P(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,E.default.getExtension(y.m.name);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))},t.handleFileRead=function(e,t){var n=this;if(0!==e.length){var r=this.getAttachment(L.BY_POSITION,t),o=e[0].id;this.attachmentDb.forEach((function(e){n.positionShallowEqual(e.position,t)&&Object.assign(e,{id:o})})),r.onFileRead(e)}},t.handleProcess=function(e){var t=e.id,n=this.getAttachment(L.BY_ID,t);null===n||void 0===n||n.onProcess(e)},t.handleSuccess=function(e){var t=e.id,n=this.getAttachment(L.BY_ID,t);null===n||void 0===n||n.onSuccess(e),null===n||void 0===n||n.destroy(),this.deleteAttachment(t)},t.handleFailure=function(e){var t=e.id,n=this.getAttachment(L.BY_ID,t);null===n||void 0===n||n.onFailure(e)},t.positionShallowEqual=function(e,t){return e.sheetId===t.sheetId&&e.row===t.row&&e.col===t.col},t.getAttachmentById=function(e){var t=null;return this.attachmentDb.forEach((function(n){t||n.id===e&&(t=n.instance)})),t},t.getAttachmentByPosition=function(e){var t=this,n=null;return this.attachmentDb.forEach((function(r){if(!n){var o=r.position;t.positionShallowEqual(o,e)&&(n=r.instance)}})),n},e}();D([(0,S.n)(),A("design:type",Function),A("design:paramtypes",[]),A("design:returntype","function"===typeof(N="undefined"!==typeof Promise&&Promise)?N:Object)],T.prototype,"getDcAttachment",null);var M=T,O=n("../spread-sheet/src/core/view/level-2/link-center/utils/behavior.ts"),B=n("../spread-sheet/src/external/rangeAuth/loader/RangeAuthManager.ts"),H=function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function i(e){try{c(r.next(e))}catch(t){s(t)}}function a(e){try{c(r.throw(e))}catch(t){s(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,a)}c((r=r.apply(e,t||[])).next())}))},U=function(e,t){return H(void 0,void 0,void 0,regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,B.d.instance.isSheetRangeCanEdit(e).catch((function(e){return console.error(e),!1}));case 2:return n=t.sent,t.abrupt("return",n);case 4:case"end":return t.stop()}}),t)})))},Z=n("../spread-sheet/src/core/view/level-2/link-center/utils/range.ts"),F=(n("../packages/model/src/cell/metadata/CustomDataType.ts"),n("../spread-sheet/src/base/util/domain-config.ts"),5),K=!1,Y=function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function i(e){try{c(r.next(e))}catch(t){s(t)}}function a(e){try{c(r.throw(e))}catch(t){s(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,a)}c((r=r.apply(e,t||[])).next())}))},q=function(){function e(e){var t=this;this.selectCell=function(e,n){t.selectRanges(new p.GridRange(t._spreadsheet.activeSheetId,e,e,n,n))},this.showSheet=function(e,n){return Y(t,void 0,void 0,regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,U(n,this.sheetStatus);case 2:return r=t.sent,t.abrupt("return",new Promise((function(t,o){m({message:d.ZP.t("链接的工作表已隐藏，暂无法打开链接。"),type:"info",autoClose:i().isMobile,closable:!0,action:r?d.ZP.t("取消隐藏"):"",onClickAction:function(){e.parent.requestApi.showSheet({sheetId:n,hidden:!1}).then(t).catch(o)}})})));case 4:case"end":return t.stop()}}),t,this)})))},this._spreadsheet=e.spreadsheet,this._modifyLinkBroker=e.modifyLinkBroker,this._scrollApi=e.scrollApi,this._normalSelectData=e.normalSelectData,this._selectApi=e.selectApi,this.sheetStatus=e.sheetStatus,this.attachmentUploadingManager=new M({normalSelectData:this._normalSelectData,sheetReference:this._spreadsheet,padId:I.q.getConfig("padId"),maxUploadNumber:F,isMultiple:K})}var t=e.prototype;return t.addLink=function(e,t){var n,r;null===(r=null===(n=this._card)||void 0===n?void 0:n.showModifyBox)||void 0===r||r.call(n,e,t)},t.setHyperlinkIconVisibility=function(e){var t=e.row,n=e.col,r=e.visibility;this._modifyLinkBroker.setHyperlinkIconVisibility({row:t,col:n,visibility:r})},t._getCellLink=function(e,t){var n=this._spreadsheet,r=n.activeSheet.getCellDataAtPosition(e,t);if(!r)return null;var o=r.getHyperlinkRuns(),s=(0,v.XI)(n,o);if(s)return{text:r.getEditValue()||s,url:s,type:k.B.CELL_LINK};var i=r.getHyperlink();if(!i)return null;var a=this.getCellLinkType(r,i);return{text:r.getEditValue()||"",url:i,type:a}},t.getCellLinkType=function(e,t){return x.tO.test(t)?k.B.ATTACHMENT:this.getCellLinkTypeFromHyperLinkType(e)},t.getCellLinkTypeFromHyperLinkType=function(e){var t;switch(e.getHyperlinkType()){case _.ZP.SHEET_LINK:t=k.B.SHEET_LINK;break;case _.ZP.PHONE_NUMBER_LINK:t=k.B.PHONE_NUMBER_LINK;break;case _.ZP.EMAIL_LINK:t=k.B.EMAIL_LINK;break;default:t=k.B.URL}return t},t._cancelLink=function(e,t){e<0||t<0||this._modifyLinkBroker.cancelLink(e,t)},t._insertLink=function(e,t,n,r){if(!(t<0||e<0)){this._modifyLinkBroker.insertLink(e,t,r,n);var o="",s="",i=this._spreadsheet.activeSheet.getCellDataAtPosition(e,t);i&&(o=i.getEditValue()||"",s=i.getHyperlink()||""),n!==o&&f.ZP.tdwReport({opername:"doc_excel_editor",module:"excel_link",action:"edit_url_text"}),r!==s&&f.ZP.tdwReport({opername:"doc_excel_editor",module:"excel_link",action:"edit_url"})}},t._insertHyperLink=function(e,t,n,r,o,s){if(!(t<0||e<0)){this._modifyLinkBroker.insertHyperLink(e,t,r,n,o,s);var i="",a="",c=this._spreadsheet.activeSheet.getCellDataAtPosition(e,t);c&&(i=c.getEditValue()||"",a=c.getHyperlink()||""),n!==i&&f.ZP.tdwReport({opername:"doc_excel_editor",module:"excel_link",action:"edit_url_text"}),r!==a&&f.ZP.tdwReport({opername:"doc_excel_editor",module:"excel_link",action:"edit_url"})}},t.setHyperlinkRuns=function(e){var t=e.row,n=e.col,r=e.linkValue,o=e.range;n<0||t<0||!o.isValid()||this._modifyLinkBroker.setHyperlinkRuns({row:t,col:n,linkValue:r,range:o})},t._openUrl=function(e){var t=(0,c.nx)(e);null!==t&&((0,l.Yo)(t),f.ZP.tdwReport({opername:"doc_excel_editor",module:"excel_link",action:"excel_link_set_click",ver10:"web"}))},t._openSheetUrl=function(e){var t=(0,v.Tu)(this._spreadsheet,e);t&&(this.switchSheet({sheetId:t.sheetId}).catch((function(e){})),f.ZP.tdwReport({opername:"doc_excel_editor",module:"excel_link",action:"excel_link_set_click",ver10:"sheet"}))},t.jumpToAndSelectCell=function(e){var t=this,n=e.gridRange;n.isSheet||(0,O.Xq)(this._spreadsheet.parent,this._scrollApi,n,(function(){t.selectRanges(n)}))},t.selectRanges=function(e){var t=e.startRowIndex,n=e.endRowIndex,r=e.startColIndex,o=e.endColIndex;if(e.isCol)this._selectApi.selectCols(this._normalSelectData,[r,o],null);else if(e.isRow)this._selectApi.selectRows(this._normalSelectData,[t,n],null);else{var s=(0,Z.Ew)(e,this._spreadsheet);this._selectApi.selectCells(this._normalSelectData,{xRange:[s.startColIndex,s.endColIndex],yRange:[s.startRowIndex,s.endRowIndex]},{row:s.startRowIndex,col:s.startColIndex})}},t._openCellLinkUrl=function(e,t){var n=this,r=this._spreadsheet,o=r.activeSheet.getCellDataAtPosition(e,t);if(!o)return Promise.resolve();var s=o.getHyperlinkRuns(),i=(0,v.$q)(r,s);if(i){var a=i.range,c=a.startColIndex,l=a.startRowIndex,d=a.endColIndex,u=a.endRowIndex,h=a.sheetId;return this.switchSheet({sheetId:h}).then((function(){if(!a.isValid())throw new Error("linkedRange range is not valid")})).then((function(){return n.checkHidden({startColIndex:c,startRowIndex:l,endColIndex:d,endRowIndex:u,sheetId:h})})).then((function(){return n.jumpToAndSelectCell({gridRange:a})})).catch((function(e){}))}return f.ZP.tdwReport({opername:"doc_excel_editor",module:"excel_link",action:"excel_link_set_click",ver10:"cell"}),Promise.resolve()},t.switchSheet=function(e){var t=this,n=e.sheetId,r=this._spreadsheet,o=r.activeSheetId;if(!n||n===o)return Promise.resolve();var s=r.sheetManager.getSheetBySheetId(n);return s&&!s.getDisplayHidden()?this.triggerSwitchSheet(r,n,o):(null===s||void 0===s?void 0:s.getDisplayHidden())?this.showSheet(r,n).then((function(){return t.triggerSwitchSheet(r,n,o)})):(s||m({message:d.ZP.t("引用的工作表已被删除，无法打开链接。"),type:"info",autoClose:i().isMobile,closable:!0}),Promise.reject("sheetId not exist"))},t.getDimensionRangeByFullHidden=function(e){var t=e.startColIndex,n=e.startRowIndex,o=e.endColIndex,s=e.endRowIndex,i=e.sheetId,a=e.sheet.data,c=a.colMetadata,l=a.rowMetadata,d=new p.DimensionRange(i,n,s,g.DIMENSION_TYPE.ROWS),u=new p.DimensionRange(i,t,o,g.DIMENSION_TYPE.COLUMNS);return[].concat((0,r.Z)((0,w.Gu)([d],l).filter((function(e){return e.startIndex===d.startIndex&&e.endIndex===d.endIndex}))),(0,r.Z)((0,w.Gu)([u],c).filter((function(e){return e.startIndex===u.startIndex&&e.endIndex===u.endIndex}))))},t.showRowAndCols=function(e){var t=e.dimensionRangeByHidden,n=e.spreadsheet,r=e.showCols,o=e.showRows,s=(0,Z.i)(t,this.sheetStatus);return new Promise((function(e,a){m({message:d.ZP.t("链接的范围已隐藏，暂无法打开链接。"),type:"info",autoClose:i().isMobile,closable:!0,action:s?d.ZP.t("取消隐藏"):"",onClickAction:function(){var s=n.parent;return Promise.all([o?s.requestApi.showRows(t.filter((function(e){return e.dimension===g.DIMENSION_TYPE.ROWS}))):null,r?s.requestApi.showColumns(t.filter((function(e){return e.dimension===g.DIMENSION_TYPE.COLUMNS}))):null].filter((function(e){return null!==e}))).then(e).catch(a)}})}))},t.checkHidden=function(e){var t=e.startColIndex,n=e.startRowIndex,r=e.endColIndex,o=e.endRowIndex,s=e.sheetId,a=this._spreadsheet,c=a.sheetManager.getSheetBySheetId(s),l=this.getDimensionRangeByFullHidden({sheet:c,startColIndex:t,startRowIndex:n,endColIndex:r,endRowIndex:o,sheetId:s}),u=!1,h=!1;if(l.length)return l.forEach((function(e){e.dimension===g.DIMENSION_TYPE.COLUMNS&&(u=!0),e.dimension===g.DIMENSION_TYPE.ROWS&&(h=!0)})),this.showRowAndCols({dimensionRangeByHidden:l,spreadsheet:a,showRows:h,showCols:u});var f=new p.DimensionRange(s,n,o,g.DIMENSION_TYPE.ROWS),v=c.getBasicFilter(),_=(0,w.ic)([f],v);if(0===_.length)return m({message:d.ZP.t("链接的范围已被筛选，暂无法全部展示范围。"),type:"info",autoClose:i().isMobile,closable:!0});var I=_[0],x=I.startIndex,k=I.endIndex;return x!==n||k!==o?m({message:d.ZP.t("链接的范围已被筛选，无法全部打开链接范围。"),type:"info",autoClose:i().isMobile,closable:!0}):void 0},t.triggerSwitchSheet=function(e,t,n){var r=i().isMobile||i().isIPad||i().isAndroidPad;r&&(0,O._c)(this._spreadsheet.parent);var o=e.parent;return new Promise((function(e,s){o.event.sheetsBar.trigger("switchSheet",t,n,{onSuccess:function(){r&&a.Z.event.sheetsBar.trigger("focusMobileActivedSheet",t,n),e(!0)},onFail:function(){o.event.sheetsBar.trigger("switchSheet",n),s(new Error("switch sheet error"))}})}))},(0,o.Z)(e,[{key:"card",get:function(){return this._card}}]),e}();q.EVENT={LINK_HIDE_COMPONENT:"LINK_HIDE_COMPONENT"};var V=q},"../spread-sheet/src/core/view/level-2/link-center/enum.ts":function(e,t,n){var r;n.d(t,{B:function(){return r}}),function(e){e.URL="URL",e.CELL_LINK="CELL_LINK",e.SHEET_LINK="SHEET_LINK",e.ATTACHMENT="ATTACHMENT",e.EMAIL_LINK="EMAIL_LINK",e.PHONE_NUMBER_LINK="PHONE_NUMBER_LINK"}(r||(r={}))},"../spread-sheet/src/core/view/level-2/link-center/report/hover-component.ts":function(e,t,n){n.d(t,{Xv:function(){return l},_L:function(){return c},me:function(){return i},vY:function(){return a}});var r,o=n("../spread-sheet/src/core/view/level-2/link-center/utils/checker.ts"),s=n("../packages/report/src/index.ts");!function(e){e[e.DEFAULT=0]="DEFAULT",e[e.TENCENT_DOCS_LINK=1]="TENCENT_DOCS_LINK"}(r||(r={}));var i=function(e){return u("click",h(e))},a=function(e){return u("click",h(e))},c=function(){d("excel_photo_download")},l=function(){d("excel_photo_delete")},d=function(e){s.ZP.tdwReport({opername:"doc_excel_editor",module:"excel_photo_link",action:e})},u=function(e,t){s.ZP.tdwReport({opername:"doc_excel_editor",module:"excel_link",action:e,ver10:t})},h=function(e){var t=r.DEFAULT;return(0,o.Rw)(e)&&(t=r.TENCENT_DOCS_LINK),t}},"../spread-sheet/src/core/view/level-2/link-center/utils/behavior.ts":function(e,t,n){n.d(t,{$4:function(){return p},GN:function(){return h},X7:function(){return f},Xq:function(){return d},_c:function(){return u}}),n("../node_modules/core-js/modules/es.regexp.exec.js"),n("../node_modules/core-js/modules/es.string.split.js"),n("../node_modules/core-js/modules/esnext.global-this.js"),n("../node_modules/core-js/modules/es.array.iterator.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.string.iterator.js"),n("../node_modules/core-js/modules/web.dom-collections.iterator.js"),n("../node_modules/core-js/modules/web.url.js"),n("../node_modules/core-js/modules/web.url-search-params.js");var r=n("../node_modules/@tencent/docs-user-agent/dist/index.js"),o=n.n(r),s=n("../spread-sheet/src/base/index.ts"),i=n("../spread-sheet/src/core/view/level-2/link-center/constant.ts"),a=n("../spread-sheet/src/core/view/level-2/link-center/report/hover-component.ts"),c=n("../spread-sheet/src/core/view/level-2/link-center/utils/checker.ts"),l=n("../spread-sheet/src/core/view/level-2/link-center/utils/range.ts"),d=function(e,t,n,r){return(0,l.ZH)(e,n)?r():t.scrollToDistanceAnchor({row:n.startRowIndex,col:n.startColIndex,left:i.Sj,top:i.Sj},!0,{onAnimationEnd:r})},u=function(e){var t,n,r;e.view.canvas.normalSelectData.resetSelection(),e.view.canvas.inputManager.hide(),null===(t=e.view.canvas.contextMenu)||void 0===t||t.hide(),e.view.canvas.smartDrag.showing&&e.view.canvas.smartDrag.close(),o().isIPad||e.view.canvas.mobileStageStates.enterNormal(),null===(n=e.view.header)||void 0===n||n.showHeader(),null===(r=e.view.mobileToolBar)||void 0===r||r.hide(),s.Z.event.toolBar.trigger("quickPanelHide")},h=function(e,t){m(e,t),(0,a._L)()},m=function(e,t){var n=e+(e.indexOf("?")>-1?"&":"?")+"timestamp="+Date.now(),r=new XMLHttpRequest;r.open("GET",n,!0),r.responseType="blob";var o=3;r.onload=function(){if((200===r.status||304===r.status)&&r.response){var e="."+r.response.type.split("/")[1],n=t+e;if(globalThis.navigator.msSaveBlob)return void globalThis.navigator.msSaveBlob(r.response,n);var o=globalThis.URL.createObjectURL(r.response),i=document.createElement("a");document.body.appendChild(i),i.style.display="none",i.href=o,i.download=n,i.click(),s.Z.util.timer.wait(1e3).run((function(){document.body.removeChild(i),globalThis.URL.revokeObjectURL(o)}))}},r.onerror=function(){r.open("GET",n,!0),0===(o-=1)&&r.send()},r.send()},f=function(e,t,n){var r,o;((0,c.nu)(e,t,n)||(0,c.fd)(e,t,n))&&(null===(o=null===(r=e.parent.view.canvas.shapeEditCenter)||void 0===r?void 0:r.shapeEdit)||void 0===o||o.shapeZoom.show({row:t,col:n}))},p=function(){if("function"===typeof globalThis.Event){var e=new MouseEvent("mouseup",{});document.dispatchEvent(e)}}},"../spread-sheet/src/core/view/level-2/link-center/utils/range.ts":function(e,t,n){n.d(t,{Ew:function(){return i},ZH:function(){return a},i:function(){return s}}),n("../node_modules/core-js/modules/web.dom-collections.for-each.js");var r=n("../packages/model/src/range/index.ts"),o=n("../packages/model/src/dimension/index.ts"),s=function(e,t){for(var n=e.length,s=!0,i=0;i<n;i++){var a=e[i],c=a.sheetId,l=a.startIndex,d=a.endIndex,u=a.dimension===o.DIMENSION_TYPE.COLUMNS?new r.GridRange({sheetId:c,startRowIndex:r.DEFAULT_DIMENSION_INDEX,endRowIndex:r.DEFAULT_DIMENSION_INDEX,startColIndex:l,endColIndex:d}):new r.GridRange({sheetId:c,startRowIndex:l,endRowIndex:d,startColIndex:r.DEFAULT_DIMENSION_INDEX,endColIndex:r.DEFAULT_DIMENSION_INDEX});if(!t.getRangeCanEdit(u)){s=!1;break}}return s},i=function(e,t){var n=e.clone();return t.activeSheet.mergeManager.mergeList.forEach((function(e){e.isCross(n)&&(n.startColIndex=Math.min(n.startColIndex,e.startColIndex),n.startRowIndex=Math.min(n.startRowIndex,e.startRowIndex),n.endColIndex=Math.max(n.endColIndex,e.endColIndex),n.endRowIndex=Math.max(n.endRowIndex,e.endRowIndex))})),n},a=function(e,t){var n=t.startColIndex,r=t.endColIndex,o=t.startRowIndex,s=t.endRowIndex,i=e.view.canvas.areaData.row.flow,a=i.renderFrom,c=i.renderTo,l=e.view.canvas.areaData.col.flow,d=l.renderFrom,u=l.renderTo;return o>=a&&s<=c&&n>=d&&r<=u}},"../spread-sheet/src/core/view/utils/browser-func.ts":function(e,t,n){n.d(t,{Yo:function(){return d}}),n("../node_modules/core-js/modules/es.regexp.exec.js"),n("../node_modules/core-js/modules/es.string.replace.js"),n("../node_modules/core-js/modules/es.regexp.constructor.js"),n("../node_modules/core-js/modules/es.regexp.to-string.js");var r=n("../node_modules/@tencent/tencent_doc_open_url/dist/index.js"),o=n("../spread-sheet/src/base/util/url.ts"),s=n("../spread-sheet/src/core/data/configService/spreadConfig.ts"),i=n("../node_modules/@tencent/docs-user-agent/dist/index.js"),a=n.n(i),c=n("../spread-sheet/src/base/util/appConfig.ts");function l(e){var t,n=e;return/^(mailto:(\/\/)?)?([a-z\u00a1-\uffff0-9_\-.])+@([a-z\u00a1-\uffff0-9_\-.])+\.([a-z]{2,})$/i.test(e)?n=e.replace(/^(mailto:(\/\/)?)?/i,"mailto:"):/^(https?|ftp|file):\/\//i.test(e)||(n=new RegExp("^"+(0,o.Fb)(),"i").test(e)?"https://"+e:"http://"+e),t=function(e){var t=c.Z.getConfig("runtime.domainName"),n=c.Z.getConfig("runtime.domainName");return/\.qq\.com/.test(e)&&!new RegExp(t).test(e)&&!new RegExp(n).test(e)}(e)&&a().isMiniProgram?"https://"+c.Z.getConfig("runtime.domainName")+"/scenario/link.html?url="+encodeURIComponent(n)+"&pid="+s.q.getConfig("globalPadId")+"&cid="+s.q.getConfig("creatorId"):n,t}function d(e){(0,r.tencentDocOpenUrlForAll)({url:l(e)})}}}]),window.jsExecEndTimeStamp=Date.now(),window.cachedPerformanceEntries||(window.cachedPerformanceEntries=[]),window.cachedPerformanceEntries.push({name:"jsExec: js/spread-sheet_src_core_view_level-2_link-center_BaseLinkCenter_ts.b651cc7c62936bf78716.js",entryType:"jsExec",startTime:window.jsExecStartTimeStamp,endTime:window.jsExecEndTimeStamp});
//# sourceMappingURL=spread-sheet_src_core_view_level-2_link-center_BaseLinkCenter_ts.b651cc7c62936bf78716.js.map