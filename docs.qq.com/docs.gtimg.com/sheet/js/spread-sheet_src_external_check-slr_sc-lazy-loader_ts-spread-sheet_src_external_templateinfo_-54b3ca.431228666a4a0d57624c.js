self.window=self,window.jsExecStartTimeStamp=Date.now(),(self.webpackChunk_tencent_alloy_builder=self.webpackChunk_tencent_alloy_builder||[]).push([["spread-sheet_src_external_check-slr_sc-lazy-loader_ts-spread-sheet_src_external_templateinfo_-54b3ca"],{"../spread-sheet/src/external/check-slr/sc-lazy-loader.ts":function(e,t,n){n.d(t,{FU:function(){return h},Hz:function(){return m},LL:function(){return y},Tf:function(){return w},XT:function(){return d},_3:function(){return f},e_:function(){return v},f_:function(){return p},h2:function(){return l},iK:function(){return b},rq:function(){return g},uo:function(){return _},wQ:function(){return x}}),n("../node_modules/regenerator-runtime/runtime.js"),n("../node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),n("../node_modules/core-js/modules/esnext.reflect.metadata.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.promise.js"),n("../node_modules/core-js/modules/es.array.iterator.js"),n("../node_modules/core-js/modules/es.string.iterator.js"),n("../node_modules/core-js/modules/web.dom-collections.iterator.js");var r=n("react"),o=n("../spread-sheet/src/base/util/decorator/loading-decorator.ts"),a=function(e,t,n,r){var o,a=arguments.length,i=a<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)i=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(i=(a<3?o(i):a>3?o(t,n,i):o(t,n))||i);return a>3&&i&&Object.defineProperty(t,n,i),i},i=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},s=function(e,t,n,r){return new(n||(n=Promise))((function(o,a){function i(e){try{c(r.next(e))}catch(t){a(t)}}function s(e){try{c(r.throw(e))}catch(t){a(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,s)}c((r=r.apply(e,t||[])).next())}))},c=function(){function e(){}var t=e.prototype;return t.getSCMobileInput=function(){return s(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([n.e("initial_vendors_tencent_dui"),n.e("sc-mobile-input-dialog")]).then(n.t.bind(n,"../node_modules/@tencent/docs-scenario-components-mobile-input-dialog/dist/index.js",23));case 2:return t=e.sent,e.abrupt("return",t);case 4:case"end":return e.stop()}}),e)})))},t.getSCMobileFileSelector=function(){return s(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.e("sc-mobile-file-selector").then(n.t.bind(n,"../node_modules/@tencent/docs-scenario-components-mobile-file-selector/dist/index.js",23));case 2:return t=e.sent,e.abrupt("return",t);case 4:case"end":return e.stop()}}),e)})))},t.getSCPcFileSelector=function(){return s(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.e("sc-pc-file-selector").then(n.t.bind(n,"../node_modules/@tencent/docs-scenario-components-pc-file-selector/dist/index.js",23));case 2:return t=e.sent,e.abrupt("return",t);case 4:case"end":return e.stop()}}),e)})))},t.getSCPaletteOld=function(){return s(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.e("sc-palette-old").then(n.t.bind(n,"../node_modules/@tencent/docs-scenario-components-palette-old/dist/index.js",23));case 2:return t=e.sent,e.abrupt("return",t);case 4:case"end":return e.stop()}}),e)})))},t.getSCPaletteNew=function(){return s(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.e("sc-palette-new").then(n.t.bind(n,"../node_modules/@tencent/docs-scenario-components-pc-palette/dist/index.js",23));case 2:return t=e.sent,e.abrupt("return",t);case 4:case"end":return e.stop()}}),e)})))},t.getSCMobileMenu=function(){return s(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([n.e("initial_vendors_tencent_4"),n.e("sc-mobile-menu")]).then(n.t.bind(n,"../node_modules/@tencent/docs-scenario-components-mobile-menu/dist/index.js",23));case 2:return t=e.sent,e.abrupt("return",t);case 4:case"end":return e.stop()}}),e)})))},t.getSCMobileCamera=function(){return s(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.resolve().then(n.t.bind(n,"../node_modules/@tencent/docs-scenario-components-mobile-camera/dist/index.js",23));case 2:return t=e.sent,e.abrupt("return",t);case 4:case"end":return e.stop()}}),e)})))},t.getSCSaveTemplate=function(){return s(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([n.e("initial_vendors_tencent_dui"),n.e("sc-save-template")]).then(n.t.bind(n,"../node_modules/@tencent/docs-scenario-components-save-template/dist/index.js",23));case 2:return t=e.sent,e.abrupt("return",t);case 4:case"end":return e.stop()}}),e)})))},t.getScMobileMenuMoveFile=function(){return s(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([n.e("initial_vendors_tencent_4"),n.e("sc-mobile-menu-move-file")]).then(n.t.bind(n,"../node_modules/@tencent/docs-scenario-components-mobile-menu-move-file/dist/index.js",23));case 2:return t=e.sent,e.abrupt("return",t);case 4:case"end":return e.stop()}}),e)})))},t.getScMobileTipButton=function(){return s(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.e("sc-mobile-tip-button").then(n.t.bind(n,"../node_modules/@tencent/docs-scenario-components-mobile-tip-button/dist/index.js",23));case 2:return t=e.sent,e.abrupt("return",t);case 4:case"end":return e.stop()}}),e)})))},e}();a([(0,o.n)(),i("design:type",Function),i("design:paramtypes",[]),i("design:returntype",Promise)],c.prototype,"getSCMobileInput",null),a([(0,o.n)(),i("design:type",Function),i("design:paramtypes",[]),i("design:returntype",Promise)],c.prototype,"getSCMobileFileSelector",null),a([(0,o.n)(),i("design:type",Function),i("design:paramtypes",[]),i("design:returntype",Promise)],c.prototype,"getSCPcFileSelector",null),a([(0,o.n)(),i("design:type",Function),i("design:paramtypes",[]),i("design:returntype",Promise)],c.prototype,"getSCPaletteOld",null),a([(0,o.n)(),i("design:type",Function),i("design:paramtypes",[]),i("design:returntype",Promise)],c.prototype,"getSCPaletteNew",null),a([(0,o.n)(),i("design:type",Function),i("design:paramtypes",[]),i("design:returntype",Promise)],c.prototype,"getSCMobileMenu",null),a([(0,o.n)(),i("design:type",Function),i("design:paramtypes",[]),i("design:returntype",Promise)],c.prototype,"getSCMobileCamera",null),a([(0,o.n)(),i("design:type",Function),i("design:paramtypes",[]),i("design:returntype",Promise)],c.prototype,"getSCSaveTemplate",null),a([(0,o.n)(),i("design:type",Function),i("design:paramtypes",[]),i("design:returntype",Promise)],c.prototype,"getScMobileMenuMoveFile",null),a([(0,o.n)(),i("design:type",Function),i("design:paramtypes",[]),i("design:returntype",Promise)],c.prototype,"getScMobileTipButton",null);var u=new c,d="page-editor"==n.j?(0,r.lazy)((function(){return n.e("sc-palette-old").then(n.t.bind(n,"../node_modules/@tencent/docs-scenario-components-palette-old/dist/index.js",23))})):null,l="page-editor"==n.j?(0,r.lazy)((function(){return n.e("sc-palette-new").then(n.t.bind(n,"../node_modules/@tencent/docs-scenario-components-pc-palette/dist/index.js",23))})):null,p="page-editor"==n.j?(0,r.lazy)((function(){return n.e("sc-pc-menu-file-info").then(n.t.bind(n,"../node_modules/@tencent/docs-scenario-components-pc-menu-file-info/dist/index.js",23))})):null,m=u.getSCMobileInput,f=u.getSCMobileFileSelector,g=u.getSCPcFileSelector,h=u.getSCMobileMenu,v=u.getSCMobileCamera,b=u.getSCSaveTemplate,x=u.getScMobileMenuMoveFile,y=u.getSCPaletteOld,w=u.getSCPaletteNew,_=u.getScMobileTipButton},"../spread-sheet/src/external/templateinfo/sync-template.ts":function(e,t,n){n.d(t,{D:function(){return c}}),n("../node_modules/regenerator-runtime/runtime.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.promise.js");var r=n("./node_modules/axios/index.js"),o=n.n(r),a=n("../spread-sheet/src/core/data/configService/spreadConfig.ts"),i=n("../packages/utils/src/safe.ts"),s=function(e,t,n,r){return new(n||(n=Promise))((function(o,a){function i(e){try{c(r.next(e))}catch(t){a(t)}}function s(e){try{c(r.throw(e))}catch(t){a(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,s)}c((r=r.apply(e,t||[])).next())}))};function c(){var e;return s(this,void 0,void 0,regeneratorRuntime.mark((function t(){var r,s;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(12!==a.q.getConfig("docStatus")){t.next=17;break}return a.q.setConfig({docStatus:0}),t.prev=2,(s=new FormData).append("domain_id",a.q.getConfig("domainId")),s.append("pad_id",a.q.getConfig("padId")),s.append("xsrf",(0,i.f)()),t.next=9,o()({method:"post",url:"/cgi-bin/online_docs/doc_humtrans",data:s,headers:{"Content-Type":"multipart/form-data"}});case 9:r=t.sent,t.next=15;break;case 12:t.prev=12,t.t0=t.catch(2),console.error(t.t0);case 15:return 0===(null===r||void 0===r?void 0:r.data.retcode)&&(null===(e=n.g.SLR)||void 0===e||e.dispatch("DOC_HUMTRANS_DONE")),t.abrupt("return",0===(null===r||void 0===r?void 0:r.data.retcode));case 17:return t.abrupt("return",!0);case 18:case"end":return t.stop()}}),t,null,[[2,12]])})))}},"../spread-sheet/src/external/view/common/helper.ts":function(e,t,n){n.d(t,{e7:function(){return d}}),n("../node_modules/regenerator-runtime/runtime.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.promise.js"),n("../node_modules/@tencent/tencent_doc_open_url/dist/index.js");var r=n("../spread-sheet/src/base/index.ts"),o=n("../packages/common-utils/src/index.ts"),a=n("../packages/report/src/index.ts"),i=n("../spread-sheet/src/core/script-loader/index.ts"),s=n("../spread-sheet/src/external/view/common/rangeAuthApiForFeatureComponent/index.ts"),c=n("../spread-sheet/src/core/data/configService/spreadConfig.ts");n("./node_modules/axios/index.js"),n("../node_modules/qs/lib/index.js"),n("../spread-sheet/src/base/util/domain-config.ts"),n("../spread-sheet/src/base/util/appConfig.ts");var u=function(e,t,n,r){return new(n||(n=Promise))((function(o,a){function i(e){try{c(r.next(e))}catch(t){a(t)}}function s(e){try{c(r.throw(e))}catch(t){a(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,s)}c((r=r.apply(e,t||[])).next())}))};function d(e,t){var n=this;if(a.ZP.tdwReport({opername:"doc_share",module:"share",action:"clk",ver6:e}),r.Z.event.default.trigger("enableAll"),r.Z.event.default.trigger("record-hide-side"),$("#doc-sharebox-container").length)$("#doc-sharebox-container").show();else{var o=$('<div id="doc-sharebox-container" class="alert-bg-container"></div>');$("body").append(o),$("#doc-sharebox-container").show()}var d=4&c.q.getConfig("rightFlag"),p=c.q.getConfig("domainId");(0,i.$y)("Share",(function(r){return u(n,void 0,void 0,regeneratorRuntime.mark((function n(){var o;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if($("#doc-sharebox-container .main-share").length){n.next=12;break}n.next=7;break;case 4:n.t0=n.sent,n.next=8;break;case 7:n.t0=l();case 8:o=n.t0,r.init(document.getElementById("doc-sharebox-container"),{invokeFrom:e,padId:c.q.getConfig("padId"),shareLink:function(){return o},shareTitle:function(){return c.q.getConfig("title")},shareDocType:c.q.getConfig("docType"),domainId:p,creatorDomain:c.q.getConfig("creatorDomain"),havePermission:d,onAuthUpdated:function(e){t&&t(e.policy,e.memlist)},onClose:function(){$("#doc-sharebox-container").hide()},rangeAuthApi:s.Z}),n.next=13;break;case 12:r.show({onClose:function(){$("#doc-sharebox-container").hide()}});case 13:case"end":return n.stop()}}),n)})))}))}function l(e){var t="";if(e){var n=(0,o.IZ)("tab"),r=(0,o.IZ)("c"),a=e.sheetManager.sheetList[0];if(a){var i=a.getSheetId();i&&n&&i!==n&&(t="?tab="+(0,o.IZ)("tab")),r&&(t.indexOf("tab")>-1?t+="&c="+r:t+="?c="+r)}}return location.origin+location.pathname+t}},"../spread-sheet/src/external/view/common/rangeAuthApiForFeatureComponent/index.ts":function(e,t,n){n.d(t,{Z:function(){return q}}),n("../node_modules/core-js/modules/es.array.iterator.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/web.dom-collections.iterator.js"),n("../node_modules/core-js/modules/es.array.slice.js"),n("../node_modules/core-js/modules/es.function.name.js"),n("../node_modules/core-js/modules/es.array.from.js"),n("../node_modules/core-js/modules/es.string.iterator.js"),n("../node_modules/core-js/modules/es.symbol.js"),n("../node_modules/core-js/modules/es.symbol.description.js"),n("../node_modules/core-js/modules/es.symbol.iterator.js");var r=n("../node_modules/i18next/dist/esm/i18next.js"),o=2,a=(r.ZP.t("可编辑"),r.ZP.t("删除"),r.ZP.t("仅我可编辑"),r.ZP.t("指定人可编辑"),r.ZP.t("取消保护"),3),i=0,s=1,c=2,u=3,d=n("../spread-sheet/src/external/rangeAuth/constants/range-auth-event.ts");function l(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){if(e){if("string"===typeof e)return p(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?p(e,t):void 0}}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0;return function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function p(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function m(){return n.g.SpreadsheetApp.spreadsheet.workbookRangeManager.protectedRangeMap}function f(){for(var e,t=[],n=l(m().entries());!(e=n()).done;){var r=e.value[0];t.push(r)}return t}function g(){var e=f();return n.g.SpreadsheetApp.requestApi.deleteProtectionRange({workbookRangeIds:e})}function h(){return n.g.SpreadsheetApp.spreadsheet.activeSheetId}function v(e){var t="",r=m().get(e);if(!r)return t;var o=r.range.sheetId;return o&&(t=n.g.SpreadsheetApp.spreadsheet.sheetManager.getSheetBySheetId(o).getTitle()),t}function b(e){for(var t="";e>=0;)t=String.fromCharCode(e%26+65)+t,e=Math.floor(e/26)-1;return t}function x(e){var t="",n=m().get(e);if(!n)return t;var o=n.range;return o.isSheet?t:t=o.isRow?o.startRowIndex===o.endRowIndex?r.ZP.t("第{{value}}行",{value:o.startRowIndex}):r.ZP.t("第{{value0}}至{{value1}}行",{value0:o.startRowIndex,value1:o.endRowIndex}):o.isCol?o.startColIndex===o.endColIndex?r.ZP.t("第{{value}}列",{value:b(o.startColIndex)}):r.ZP.t("第{{value0}}至{{value1}}列",{value0:b(o.startColIndex),value1:b(o.endColIndex)}):""+b(o.startColIndex)+(o.startRowIndex+1)+":"+b(o.endColIndex)+(o.endRowIndex+1)}n("../node_modules/regenerator-runtime/runtime.js"),n("../node_modules/core-js/modules/es.promise.js"),n("../node_modules/core-js/modules/es.array.concat.js");var y=n("../node_modules/@tencent/dui/lib/components/Modal/index.js"),w=n("../node_modules/@tencent/dui-mobile/lib/components/Modal/index.js"),_=n("../node_modules/@tencent/dui/lib/components/Snackbar/index.js"),j=(n("../node_modules/core-js/modules/web.dom-collections.for-each.js"),n("../node_modules/core-js/modules/es.array.map.js"),n("../node_modules/core-js/modules/es.object.assign.js"),n("../node_modules/core-js/modules/es.array.filter.js"),n("../spread-sheet/src/external/rangeAuth/util/range-auth-request-util.ts")),A={user:0,auth_group_user:1,group:2,discus:3,auth_group:4,department:5},S=n("../spread-sheet/src/external/view/main/panel/rangeAuthPanel/utils/request-utils.ts");function P(e,t,n){var r=[];return Array.isArray(n)&&"object"==typeof n[0]&&(n.forEach((function(e){r.push(e.id)})),n=r),0==n.length?Promise.resolve({data:{protectedRangeList:[{rangePolicy:0,memlist:[]}]}}):(0,j.ng)(n)}function C(e,t,n){if(void 0===n&&(n=[]),!Array.isArray(n))return Promise.reject({msg:r.ZP.t("参数错误，请重试")});var o,a=function(e){void 0===e&&(e=[]);var t=[],n="",r=!1;return e.forEach((function(e){var o=[];e.addmemlist&&(o=e.addmemlist.map((function(e){return e.corp_id&&(n=e.corp_id),{uin:""+e.uin,rangePrivilegeType:e.rangePrivilegeType,isNew:e.isNew,workId:e.work_id||"",uintype:e.uintype||A[e.type]||0,corpId:e.corp_id||""}})));var a=[];e.submemlist&&(a=e.submemlist.map((function(e){return e.corp_id&&(n=e.corp_id),{uin:""+e.uin,uintype:e.uintype||A[e.type]||0}}))),t.push({rangeId:e.rangeId,rangePolicy:e.rangePolicy||0,addmemlist:o,submemlist:a,clear:e.clear}),e.clear&&(r=!0)})),{filteredSubAuthList:t,corpId:n,isDeleteRangeAuth:r}}(n),i=a.filteredSubAuthList,d=a.isDeleteRangeAuth,p=h(),f=function(e){for(var t,n="",r=l(m().entries());!(t=r()).done;){var o=t.value,a=o[0],i=o[1];if(i.range.isSheet&&i.range.sheetId===e){n=a;break}}return n}(p);o=f?d?c:u:s;var g=n.map((function(e){return e.rangeId})),v={rangeSeq:(0,j.Fs)(),rangeAction:{rangeIdList:g,rangeId:f,sheetId:p,rangeActionType:o}};try{"undefined"===typeof window.clientVars&&(window.clientVars={}),"undefined"===typeof window.clientVars.msgFilterData&&(window.clientVars.msgFilterData={}),window.clientVars.msgFilterData[v.rangeSeq]=v.rangeAction}catch(b){}return(0,j.Sh)(i,v).then((function(e){return Promise.resolve(e)}))}var I=n("../spread-sheet/src/core/view/level-2/collab-center-ent/utils.ts");function k(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){if(e){if("string"===typeof e)return R(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?R(e,t):void 0}}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0;return function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function R(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var M=function(e,t,n,r){return new(n||(n=Promise))((function(o,a){function i(e){try{c(r.next(e))}catch(t){a(t)}}function s(e){try{c(r.throw(e))}catch(t){a(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,s)}c((r=r.apply(e,t||[])).next())}))},E=r.ZP.t("你之前将某些工作表独立保护，是否保留设置？"),T={CHANGE_PRIVATE:{title:r.ZP.t("更改为仅自己可见"),text:r.ZP.t("更改为仅自己可见后，其他人将无法再查看该文档。")},CHANGE_ASSIGNER:{title:r.ZP.t("更改为指定人可查看/编辑"),text:E},CHANGE_CAN_READ:{title:r.ZP.t("更改为获得链接可查看"),text:E},CHANGE_CAN_EDIT:{title:r.ZP.t("更改为获得链接可编辑"),text:E}},Z=[[{},T.CHANGE_ASSIGNER,{},T.CHANGE_CAN_EDIT],[{},{},{},T.CHANGE_CAN_EDIT],[{},T.CHANGE_ASSIGNER,{},T.CHANGE_CAN_EDIT],[{},T.CHANGE_ASSIGNER,{},{}]],N=[[{},{},{},{}],[{},{},T.CHANGE_CAN_READ,T.CHANGE_CAN_EDIT],[{},T.CHANGE_ASSIGNER,{},T.CHANGE_CAN_EDIT],[{},T.CHANGE_ASSIGNER,T.CHANGE_CAN_READ,{}]];function D(){var e=n.g.navigator.userAgent.toLowerCase(),t=/(ipad)/i.test(e);return/(mobile)/i.test(e)&&!t}var F=D()?w.default:y.default;function L(e){void 0===e&&(e=[]);var t=!1,n=!1,r=[];r=r.concat(e);for(var o=0;o<r.length;o++){var a=r[o];if(1===a.rangePolicy&&(t=!0),2===a.rangePolicy){n=!0;break}}return n?2:t?1:null}function G(e,t,n){if(t===n)return{changed:!1};var r={},o={};switch(e){case 1:r={changed:!!(o=Z[t][n]).title,tipTitle:o.title||"",tipText:o.text||""};break;case 2:r={changed:!!(o=N[t][n]).title,tipTitle:o.title||"",tipText:o.text||""}}return r}var H=function(e){return function(t,n,o,a){return M(void 0,void 0,void 0,regeneratorRuntime.mark((function t(){var n,i,s,c,u,d,l,p,m,g,h,v,b,x,y,w;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=f(),t.next=3,P(0,0,n);case 3:i=t.sent,s=[],c=i.data.protectedRangeList||[],u=k(c);case 7:if((d=u()).done){t.next=27;break}l=d.value,p=l.rangeId||"",m=l.rangePolicy,g=l.memlist||[],h=k(g);case 13:if((v=h()).done){t.next=25;break}b=v.value,x=k(o);case 16:if((y=x()).done){t.next=23;break}if(w=y.value,!(0,S.iE)(w,b)){t.next=21;break}return s.push({rangeId:p,rangePolicy:m,submemlist:[b]}),t.abrupt("break",23);case 21:t.next=16;break;case 23:t.next=13;break;case 25:t.next=7;break;case 27:s.length>0?F.confirm({mask:!0,title:r.ZP.t("权限确认"),content:e,okText:r.ZP.t("确定"),cancelText:r.ZP.t("取消"),zIndex:10005,onOk:function(){C(0,0,s).then((function(){a()})).catch((function(e){_.default.show({message:e.msg||r.ZP.t("清除"+I.PJ+"区域权限失败")})}))}}):a();case 28:case"end":return t.stop()}}),t)})))}},O=H(r.ZP.t("这些"+I.PJ+"在受保护工作表中有编辑权限，是否确定删除？")),q={navigateToAuthListComponent:function(){n.g.SpreadsheetApp.event.rangeAuthEvent.trigger(d.k.SHOW_RANGE_AUTH,{clickType:a})},getAllRangeAuthIdList:f,getActiveSheetId:h,getCanEditSheetTextListByUser:function(e,t){void 0===t&&(t=[]);var n=[];if(0===t.length)return n;for(var a=0;a<t.length;a++){var i=t[a],s=i.memlist||[],c=i.rangeId;if(2==i.rangePolicy)for(var u=0;u<s.length;u++){var d=s[u];if((0,S.Iw)(e,d)&&d.rangePrivilege==o){var l=x(c);l.length?n.push(r.ZP.t("工作表「{{value0}}」的{{rangeText}}",{value0:v(c),rangeText:l})):n.push(r.ZP.t("工作表「{{value}}」",{value:v(c)}))}}}return n},getAllRangeAuthList:function(e,t){var n;return M(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=f(),r=[],!(t.length>0)){e.next=6;break}return e.next=5,P(0,0,t);case 5:r=e.sent;case 6:return e.abrupt("return",(null===(n=r.data)||void 0===n?void 0:n.protectedRangeList)||[]);case 7:case"end":return e.stop()}}),e)})))},canViewSheetMemberWithCheck:function(e,t,n,o){return M(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t,a,i,s,c,u,d,l,p,m,g;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=f(),e.next=3,P(0,0,t);case 3:a=e.sent,i=[],s=a.data.protectedRangeList||[],c=0;case 7:if(!(c<s.length)){e.next=24;break}u=s[c],d=u.rangeId||"",l=u.rangePolicy,p=u.memlist||[],m=0;case 13:if(!(m<p.length)){e.next=21;break}if(g=p[m],!(0,S.Iw)(n,g)){e.next=18;break}return i.push({rangeId:d,rangePolicy:l,submemlist:[g]}),e.abrupt("break",21);case 18:m++,e.next=13;break;case 21:c++,e.next=7;break;case 24:i.length>0?F.confirm({mask:!0,title:r.ZP.t("权限确认"),content:r.ZP.t("此"+I.PJ+"在受保护工作表中有编辑权限，是否确定变更为可查看？"),okText:r.ZP.t("确定"),cancelText:r.ZP.t("取消"),zIndex:10005,onOk:function(){C(0,0,i).then((function(){o()})).catch((function(e){_.default.show({message:e.msg||r.ZP.t("清除"+I.PJ+"区域权限失败")})}))}}):o();case 25:case"end":return e.stop()}}),e)})))},canViewSheetMemberListWithCheck:H(r.ZP.t("这些"+I.PJ+"在受保护工作表中有编辑权限，是否确定变更为可查看？")),removeSheetMemberWithCheck:function(e,t,n,o){return M(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t,a,i,s,c,u,d,l,p,m,g;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=f(),e.next=3,P(0,0,t);case 3:a=e.sent,i=[],s=a.data.protectedRangeList||[],c=0;case 7:if(!(c<s.length)){e.next=24;break}u=s[c],d=u.rangeId||"",l=u.rangePolicy,p=u.memlist||[],m=0;case 13:if(!(m<p.length)){e.next=21;break}if(g=p[m],!(0,S.Iw)(n,g)){e.next=18;break}return i.push({rangeId:d,rangePolicy:l,submemlist:[g]}),e.abrupt("break",21);case 18:m++,e.next=13;break;case 21:c++,e.next=7;break;case 24:i.length>0?F.confirm({mask:!0,title:r.ZP.t("权限确认"),content:r.ZP.t("此"+I.PJ+"在受保护工作表中有编辑权限，是否确定删除？"),okText:r.ZP.t("确定"),cancelText:r.ZP.t("取消"),zIndex:10005,onOk:function(){C(0,0,i).then((function(){o()})).catch((function(e){_.default.show({message:e.msg||r.ZP.t("清除"+I.PJ+"区域权限失败")})}))}}):o();case 25:case"end":return e.stop()}}),e)})))},removeSheetMemberListWithCheck:O,handleWorkbookRangeAuthChange:function(e,t,n,o,a){return M(this,void 0,void 0,regeneratorRuntime.mark((function n(){var o,s,c,u;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if((o=f())&&Array.isArray(o)&&0!==o.length){n.next=4;break}return a(!0),n.abrupt("return");case 4:return n.next=6,P(0,0,o);case 6:s=n.sent,c=L(s.data.protectedRangeList),t===i?g().then((function(){a(!0)})).catch((function(){_.default.show({message:r.ZP.t("清除子表区域权限失败"),type:"info"})})):(u=G(c,e,t)).changed?F.confirm({mask:!0,title:u.tipTitle,content:u.tipText,okText:r.ZP.t("是"),onOk:function(){a(!0)},cancelText:r.ZP.t("否"),zIndex:10005,onCancel:function(){g().then((function(){a(!0)})).catch((function(){_.default.show({message:r.ZP.t("清除子表区域权限失败"),type:"info"})}))},onClose:function(){a(!1)}}):a(!0);case 9:case"end":return n.stop()}}),n)})))},getRangeAuthPolicy:function(e,t){return M(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t,n,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((t=f())&&Array.isArray(t)&&0!==t.length){e.next=3;break}return e.abrupt("return",null);case 3:return e.next=5,P(0,0,t);case 5:return n=e.sent,r=L(n.data.protectedRangeList),e.abrupt("return",r);case 8:case"end":return e.stop()}}),e)})))},hasRangeAuth:function(){var e=f();return!(!e||!Array.isArray(e)||0===e.length)},clearAllRangeAuthAndSheetRangeAuthPromise:function(){return g().then((function(){return Promise.resolve()})).catch((function(){return _.default.show({message:r.ZP.t("清除子表区域权限失败"),type:"info"}),Promise.reject()}))}}},"../spread-sheet/src/external/view/main/panel/dataValidationPanel/style/assets.ts":function(e,t,n){n.d(t,{Z:function(){return r}});var r="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTYiIGhlaWdodD0iMTYiIHZpZXdCb3g9IjAgMCAxNiAxNiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cGF0aCBkPSJNMiAxNWExIDEgMCAwIDEtMS0xVjJhMSAxIDAgMCAxIDEtMWgxMmExIDEgMCAwIDEgMSAxdjEyYTEgMSAwIDAgMS0xIDFIMnptNS40LTYuNEgyLjJ2NS4yaDUuMlY4LjZ6bTYuNCAwSDguNnY1LjJoNS4yVjguNnpNNy40IDIuMkgyLjJ2NS4yaDUuMlYyLjJ6bTYuNCAwSDguNnY1LjJoNS4yVjIuMnoiIGZpbGw9IiM4MTg2OEYiIGZpbGwtcnVsZT0iZXZlbm9kZCIvPjwvc3ZnPg=="}}]),window.jsExecEndTimeStamp=Date.now(),window.cachedPerformanceEntries||(window.cachedPerformanceEntries=[]),window.cachedPerformanceEntries.push({name:"jsExec: js/spread-sheet_src_external_check-slr_sc-lazy-loader_ts-spread-sheet_src_external_templateinfo_-54b3ca.431228666a4a0d57624c.js",entryType:"jsExec",startTime:window.jsExecStartTimeStamp,endTime:window.jsExecEndTimeStamp});
//# sourceMappingURL=spread-sheet_src_external_check-slr_sc-lazy-loader_ts-spread-sheet_src_external_templateinfo_-54b3ca.431228666a4a0d57624c.js.map