self.window=self,window.jsExecStartTimeStamp=Date.now(),(self.webpackChunk_tencent_alloy_builder=self.webpackChunk_tencent_alloy_builder||[]).push([["bundle_view_level2_edit_lazy_module1"],{"../spread-sheet/src/core/feature/dataValidation/DVInterface.ts":function(e,t,o){o.d(t,{Bb:function(){return i},Ju:function(){return d},UD:function(){return l},c1:function(){return c},h6:function(){return n.h6},ob:function(){return n.ob},y3:function(){return r}}),o("../node_modules/core-js/modules/es.array.iterator.js"),o("../node_modules/core-js/modules/es.map.js"),o("../node_modules/core-js/modules/es.object.to-string.js"),o("../node_modules/core-js/modules/es.string.iterator.js"),o("../node_modules/core-js/modules/esnext.map.delete-all.js"),o("../node_modules/core-js/modules/esnext.map.every.js"),o("../node_modules/core-js/modules/esnext.map.filter.js"),o("../node_modules/core-js/modules/esnext.map.find.js"),o("../node_modules/core-js/modules/esnext.map.find-key.js"),o("../node_modules/core-js/modules/esnext.map.includes.js"),o("../node_modules/core-js/modules/esnext.map.key-of.js"),o("../node_modules/core-js/modules/esnext.map.map-keys.js"),o("../node_modules/core-js/modules/esnext.map.map-values.js"),o("../node_modules/core-js/modules/esnext.map.merge.js"),o("../node_modules/core-js/modules/esnext.map.reduce.js"),o("../node_modules/core-js/modules/esnext.map.some.js"),o("../node_modules/core-js/modules/esnext.map.update.js"),o("../node_modules/core-js/modules/web.dom-collections.iterator.js");var s=o("../node_modules/i18next/dist/esm/i18next.js"),a=o("../packages/model/src/index.ts"),n=o("../spread-sheet/src/core/feature/dataValidation/type.ts"),r=new Map([[a.Cell.DATA_VALIDATION_CONDITION_TYPE.BETWEEN,s.ZP.t("介于")],[a.Cell.DATA_VALIDATION_CONDITION_TYPE.NOT_BETWEEN,s.ZP.t("不介于")],[a.Cell.DATA_VALIDATION_CONDITION_TYPE.EQUAL,s.ZP.t("等于")],[a.Cell.DATA_VALIDATION_CONDITION_TYPE.NOT_EQUAL,s.ZP.t("不等于")],[a.Cell.DATA_VALIDATION_CONDITION_TYPE.LESS,s.ZP.t("早于")],[a.Cell.DATA_VALIDATION_CONDITION_TYPE.LESS_EQUAL,s.ZP.t("不晚于")],[a.Cell.DATA_VALIDATION_CONDITION_TYPE.GREAT,s.ZP.t("晚于")],[a.Cell.DATA_VALIDATION_CONDITION_TYPE.GREAT_EQUAL,s.ZP.t("不早于")]]),i=new Map([[a.Cell.DATA_VALIDATION_CONDITION_TYPE.BETWEEN,s.ZP.t("介于")],[a.Cell.DATA_VALIDATION_CONDITION_TYPE.NOT_BETWEEN,s.ZP.t("不介于")],[a.Cell.DATA_VALIDATION_CONDITION_TYPE.EQUAL,s.ZP.t("等于")],[a.Cell.DATA_VALIDATION_CONDITION_TYPE.NOT_EQUAL,s.ZP.t("不等于")],[a.Cell.DATA_VALIDATION_CONDITION_TYPE.LESS,s.ZP.t("小于")],[a.Cell.DATA_VALIDATION_CONDITION_TYPE.LESS_EQUAL,s.ZP.t("小于或等于")],[a.Cell.DATA_VALIDATION_CONDITION_TYPE.GREAT,s.ZP.t("大于")],[a.Cell.DATA_VALIDATION_CONDITION_TYPE.GREAT_EQUAL,s.ZP.t("大于或等于")],[a.Cell.DATA_VALIDATION_CONDITION_TYPE.INCLUDE,s.ZP.t("包括")],[a.Cell.DATA_VALIDATION_CONDITION_TYPE.NOT_INCLUDE,s.ZP.t("不包括")]]),l=new Map([[a.Cell.DATA_VALIDATION_CONDITION_TYPE.BETWEEN,s.ZP.t("介于")],[a.Cell.DATA_VALIDATION_CONDITION_TYPE.NOT_BETWEEN,s.ZP.t("不介于")],[a.Cell.DATA_VALIDATION_CONDITION_TYPE.EQUAL,s.ZP.t("等于")],[a.Cell.DATA_VALIDATION_CONDITION_TYPE.NOT_EQUAL,s.ZP.t("不等于")],[a.Cell.DATA_VALIDATION_CONDITION_TYPE.LESS,s.ZP.t("小于")],[a.Cell.DATA_VALIDATION_CONDITION_TYPE.LESS_EQUAL,s.ZP.t("小于或等于")],[a.Cell.DATA_VALIDATION_CONDITION_TYPE.GREAT,s.ZP.t("大于")],[a.Cell.DATA_VALIDATION_CONDITION_TYPE.GREAT_EQUAL,s.ZP.t("大于或等于")]]),d=new Map([[n.h6.NONE,s.ZP.t("数值")],[n.h6.INT,s.ZP.t("整数")],[n.h6.FLOAT,s.ZP.t("小数")]]),c=new Map([[n.h6.ID_CARD,s.ZP.t("身份证号")],[n.h6.MAIL,s.ZP.t("邮箱")],[n.h6.PHONE,s.ZP.t("手机号")],[n.h6.TELEPHONE,s.ZP.t("电话号码")]])},"../spread-sheet/src/core/feature/dataValidation/api/DataValidationConfig.ts":function(e,t,o){o.d(t,{N:function(){return l}}),o("../node_modules/core-js/modules/es.array.map.js"),o("../node_modules/core-js/modules/es.array.filter.js");var s=o("../packages/model/src/cell/data-validation/data-validation-utils.ts"),a=o("../packages/model/src/cell/data-validation/data-validation-rule-type.ts"),n=o("../spread-sheet/src/core/feature/formula/utils.ts"),r=o("../packages/model/src/range/hexRangeUtils.ts"),i=o("../spread-sheet/src/core/feature/dataValidation/DVInterface.ts");function l(e,t){var o,l=function(e){var t=e.validType,o=e.dataType;switch(t){case i.ob.LIST:return a.Z.LIST;case i.ob.NUMBER:switch(o){case i.h6.FLOAT:return a.Z.CUSTOM_MUST_FLOAT;case i.h6.INT:return a.Z.NUMBER_INT;case i.h6.NONE:return a.Z.NUMBER_FLOAT_AND_INT;case i.h6.TEMPERATURE:return a.Z.CUSTOM_NUMBER_TEMPERATURE;case i.h6.PROGRESS:return a.Z.CUSTOM_PROGRESS}break;case i.ob.TEXT:switch(o){case i.h6.CONTENT:return a.Z.CUSTOM_TEXT_CONTAINS;case i.h6.LENGTH:default:return a.Z.TEXT_LENGTH}case i.ob.DATE:return a.Z.DATE;case i.ob.AVAILABLE:switch(o){case i.h6.ID_CARD:return a.Z.CUSTOM_ID_CARD;case i.h6.PHONE:return a.Z.CUSTOM_NUM_PHONE;case i.h6.TELEPHONE:return a.Z.CUSTOM_NUM_TEL;case i.h6.MAIL:return a.Z.CUSTOM_TEXT_MAIL}break;case i.ob.CHECKBOX:return a.Z.CUSTOM_CHECKBOX;case i.ob.STAR:return a.Z.CUSTOM_STAR;case i.ob.ATTACHMENT:return a.Z.CUSTOM_ATTACHMENT;case i.ob.CONTACT:return a.Z.CUSTOM_CONTACT}return console.warn("数据验证：传入数据不符合规则"),a.Z.CUSTOM}({validType:e.validType,dataType:e.dataType}),d=(null===(o=e.argTokens)||void 0===o?void 0:o.filter((function(e){return Boolean(e.userEnteredValue)})).map((function(o){var i=o.userEnteredValue,d=e.selection;if(d&&l===a.Z.LIST&&(0,n.jr)(i)){var c=(0,r.getRangeInfoFormHexRange)(t,i),u=c.rangeString,h={sheetId:c.sheetId,rowIndex:d.startRowIndex,colIndex:d.startColIndex};return(0,s.G8)("="+u,{ruleType:l,positionInfo:h})}return(0,s.G8)(i)})))||null;return{ruleType:l,inputMessage:e.inputMessage||null,isStrict:e.isStrict||!1,showDropDown:e.showDropDown||!1,operator:e.operator,argTokens:d}}},"../spread-sheet/src/core/feature/dataValidation/api/DataValidationUtils.ts":function(e,t,o){o.d(t,{AJ:function(){return O},Dq:function(){return U},Ex:function(){return D},JU:function(){return Z},KN:function(){return N},Np:function(){return B},Sc:function(){return w.Sc},Sv:function(){return b},Wj:function(){return L},ZK:function(){return x},aW:function(){return w.aW},gZ:function(){return V},jY:function(){return C},ko:function(){return R},uU:function(){return H},v1:function(){return P},zk:function(){return I}}),o("../node_modules/regenerator-runtime/runtime.js"),o("../node_modules/core-js/modules/es.object.to-string.js"),o("../node_modules/core-js/modules/es.promise.js"),o("../node_modules/core-js/modules/es.array.join.js"),o("../node_modules/core-js/modules/es.regexp.exec.js"),o("../node_modules/core-js/modules/es.string.split.js"),o("../node_modules/core-js/modules/es.array.map.js"),o("../node_modules/core-js/modules/es.string.trim.js"),o("../node_modules/core-js/modules/es.array.filter.js"),o("../node_modules/core-js/modules/es.array.from.js"),o("../node_modules/core-js/modules/es.string.iterator.js"),o("../node_modules/core-js/modules/es.array.iterator.js"),o("../node_modules/core-js/modules/es.set.js"),o("../node_modules/core-js/modules/esnext.set.add-all.js"),o("../node_modules/core-js/modules/esnext.set.delete-all.js"),o("../node_modules/core-js/modules/esnext.set.difference.js"),o("../node_modules/core-js/modules/esnext.set.every.js"),o("../node_modules/core-js/modules/esnext.set.filter.js"),o("../node_modules/core-js/modules/esnext.set.find.js"),o("../node_modules/core-js/modules/esnext.set.intersection.js"),o("../node_modules/core-js/modules/esnext.set.is-disjoint-from.js"),o("../node_modules/core-js/modules/esnext.set.is-subset-of.js"),o("../node_modules/core-js/modules/esnext.set.is-superset-of.js"),o("../node_modules/core-js/modules/esnext.set.join.js"),o("../node_modules/core-js/modules/esnext.set.map.js"),o("../node_modules/core-js/modules/esnext.set.reduce.js"),o("../node_modules/core-js/modules/esnext.set.some.js"),o("../node_modules/core-js/modules/esnext.set.symmetric-difference.js"),o("../node_modules/core-js/modules/esnext.set.union.js"),o("../node_modules/core-js/modules/web.dom-collections.iterator.js"),o("../node_modules/core-js/modules/web.dom-collections.for-each.js"),o("../node_modules/core-js/modules/es.string.match.js"),o("../node_modules/core-js/modules/es.string.ends-with.js");var s,a=o("../node_modules/i18next/dist/esm/i18next.js"),n=o("../packages/model/src/index.ts"),r=o("../node_modules/@tencent/txdoc_dayjs/dayjs.min.js"),i=o.n(r),l=o("../spread-sheet/src/core/utils/cell.ts"),d=o("../spread-sheet/src/core/utils/formula.ts"),c=o("../spread-sheet/src/core/utils/numberFromat.ts"),u=o("../packages/model/src/range/hexRangeUtils.ts"),h=o("../packages/model/src/cell/data-validation/data-validation-rule-type.ts"),_=o("../packages/model/src/rule/index.ts"),p=o("../packages/model/src/cell/data-validation/data-validation-utils.ts"),m=o("../spread-sheet/src/core/feature/formula/utils.ts"),g=o("../node_modules/@tencent/sheet-formula-sdk/lib/index.js"),f=o("../packages/model/src/cell/metadata/CustomDataType.ts"),w=o("../spread-sheet/src/core/feature/dataValidation/api/DataValidationUIUtils.ts"),v=o("../packages/model/src/cell/format/NumberFormatType.ts"),y=(o("../spread-sheet/src/core/feature/dataValidation/api/DataValidationConfig.ts"),function(e,t,o,s){return new(o||(o=Promise))((function(a,n){function r(e){try{l(s.next(e))}catch(t){n(t)}}function i(e){try{l(s.throw(e))}catch(t){n(t)}}function l(e){var t;e.done?a(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(r,i)}l((s=s.apply(e,t||[])).next())}))}),R=function(e,t,o){return e?e.split(t).join(o):""},C=function(e){switch(e.ruleType){case h.Z.LIST:case h.Z.NUMBER_INT:case h.Z.NUMBER_FLOAT_AND_INT:case h.Z.CUSTOM_MUST_FLOAT:case h.Z.CUSTOM_NUMBER_TEMPERATURE:case h.Z.TEXT_LENGTH:case h.Z.DATE:return!0}return!1},D=function(e,t,o){return R(e,"$SLOT",g.Pz.toCellId(t,o))},I=function(e){var t;return t=(t=(t=e.split(",")).map((function(e){return e.trim()}))).filter((function(e){return e})),Array.from(new Set(t))};function A(e){var t,o=null===(t=null===e||void 0===e?void 0:e.argTokens)||void 0===t?void 0:t[0];if(!o)return!0;var s=o.type,a=o.formula,n=o.userEnteredValue;if(s===_.ARG_TOKEN_TYPE.VALUE_TOKEN&&null===n)return!0;if(s===_.ARG_TOKEN_TYPE.FORMULA_TOKEN){if(null===a)return!0;if(!0===(null===a||void 0===a?void 0:a.hasReferenceError))return!0}return!1}function T(e){return null!=e&&null!=e.argTokens&&e.ruleType===h.Z.LIST||(console.warn("数据验证：类型不为list或者用户输入为空，不能获取下拉列表信息"),!1)}function j(e,t,a,n){var r,i,l;return y(this,void 0,void 0,regeneratorRuntime.mark((function d(){var c,h,_,m,g,f,w,v,y,R;return regeneratorRuntime.wrap((function(d){for(;;)switch(d.prev=d.next){case 0:if(c=E(t),h=t.argTokens[0],c!==s.RANGE_LIST){d.next=16;break}if(_=(0,p.o5)(h,{rowIndex:a,colIndex:n,options:e.spreadsheet.sheetManager}),m=(0,u.getRangeInfoFormHexRange)(e.spreadsheet,_),g=m.sheetId,f=m.rangeString,w=g||e.spreadsheet.getActiveSheetId(),null===(l=null===(i=null===(r=e.spreadsheet)||void 0===r?void 0:r.sheetManager)||void 0===i?void 0:i.getSheetBySheetId(w))||void 0===l?void 0:l.isLoaded){d.next=10;break}return d.next=10,new Promise((function(t){e.dataCenter.loadSheetData({sheetId:g,ignoreChunk:!0,onFinished:function(){t(!0)},onFail:function(e){var s;t(!1),null===(s=o.g.log)||void 0===s||s.error("获取数据验证引用子表("+g+")失败",e)}})}));case 10:if(v=M(e,f,g),null!==(y=S(e,v))){d.next=14;break}return d.abrupt("return",[]);case 14:return y=y.filter((function(e){return e})),d.abrupt("return",Array.from(new Set(y)));case 16:if(R=h.userEnteredValue,c!==s.ITEM_LIST||null===R){d.next=19;break}return d.abrupt("return",I(R));case 19:return d.abrupt("return",null);case 20:case"end":return d.stop()}}),d)})))}function x(e,t,o){return y(this,void 0,void 0,regeneratorRuntime.mark((function s(){var a,n;return regeneratorRuntime.wrap((function(s){for(;;)switch(s.prev=s.next){case 0:if(s.prev=0,T(a=(0,w.Ii)(e.spreadsheet.activeSheet,t,o))&&!A(a)){s.next=5;break}return s.abrupt("return",null);case 5:return s.next=7,j(e,a,t,o);case 7:return n=s.sent,s.abrupt("return",n);case 11:return s.prev=11,s.t0=s.catch(0),console.warn("数据验证获取下拉列表错误",s.t0),s.abrupt("return",null);case 15:case"end":return s.stop()}}),s,null,[[0,11]])})))}function E(e){var t,o;if(e.ruleType!==h.Z.LIST)return"";var a=null===(t=null===e||void 0===e?void 0:e.argTokens)||void 0===t?void 0:t[0].type;if(a===_.ARG_TOKEN_TYPE.FORMULA_TOKEN)return s.RANGE_LIST;var n=null===(o=null===e||void 0===e?void 0:e.argTokens)||void 0===o?void 0:o[0].userEnteredValue;return n&&a===_.ARG_TOKEN_TYPE.VALUE_TOKEN&&0!==n.length?s.ITEM_LIST:""}function S(e,t){if(null==t)return null;var o=t.sheetId,s=e.spreadsheet.sheetManager.getSheetBySheetId(o),a=[];if(s){var n=s.data.getCellDatasAtRange(t);null===n||void 0===n||n.forEach((function(e){return e.forEach((function(e){null!=e&&a.push((0,l.getMergedValue)(e))}))}))}return a}!function(e){e.RANGE_LIST="range-list",e.ITEM_LIST="item-list"}(s||(s={}));var M=function(e,t,o){if(!t)return null;if(!o&&e){o=e.spreadsheet.activeSheetId;var s=(0,d.moveEqualChar)(t).split("!")[0];'"'===s[0]&&'"'===s[s.length-1]&&(s=s.substring(1,s.length-1));var a=e.spreadsheet.sheetManager.getSheetBySheetTitle(s);a&&a.getSheetId()!==o&&(o=a.getSheetId())}return o?(0,u.hex2Range)(t,o):null},b=function(e){return-1===["between","notBetween","equal","notEqual","lessThan","lessThanOrEqual","greaterThan","greaterThanOrEqual"].indexOf(e)},L=function(e){return-1===["contains","notContains","equal"].indexOf(e)};function O(e,t,o){void 0===t&&(t="YYYY-MM-DD"),void 0===o&&(o="date");var s=i()(e).format(t);return"date"==o&&(s+="T00:00:00"),n.Utils.numberFormatUtils.formatParseEngine.datetime2Numeric(s)}var N=function(e){if(e){var t=n.Utils.numberFormatUtils.formatParseEngine.parseValueWithStyle(e);return null==t?e:t.value}return e},B=function(e){var t,o=(0,m.jr)(e);if("string"===typeof e)if('""'===e)t=e;else{if(o)return(0,d.moveEqualChar)(e);t='"'+e+'"'}else{if("number"===typeof e||"boolean"===typeof e)return t=""+e;t='""'}return t},V=function(e,t,o){for(var s=t,a=t.sheetId,n=e.sheetManager.getSheetBySheetId(t.sheetId),r=s.isCol?0:s.startRowIndex,i=s.isCol?n.getRowCount()-1:s.endRowIndex,l=s.isRow?0:s.startColIndex,d=s.isRow?n.getColCount()-1:s.endColIndex,c=r;c<=i;c++)for(var u=l;u<=d;u++)o(c,u,a)},P=function(e){var t=e.view.getSelection();if(!t)return!1;var o=t.activeCell,s=o.rowIndex,a=o.colIndex;return!!(0,w.Sc)(e.spreadsheet.activeSheet,s,a)};function Z(e,t,o,s){var r=(void 0===s?{}:s).fractionFirst,i=void 0!==r&&r,l=e.inputOne,u=e.inputTwo,h=e.operate;if(!e.inputTwoShow)return null;if(h!==n.Cell.DATA_VALIDATION_CONDITION_TYPE.BETWEEN&&h!==n.Cell.DATA_VALIDATION_CONDITION_TYPE.NOT_BETWEEN)return null;if(""===l.trim()||""===u.trim())return null;if((0,d.isFormulaString)(l)||(0,d.isFormulaString)(u))return null;var _=(0,c.stringToNumber)(l,{fractionFirst:i}),p=(0,c.stringToNumber)(u,{fractionFirst:i});if(!_||!p)return null;var m=_.numericValue,g=p.numericValue;return"number"!==typeof m||"number"!==typeof g?null:g-m<0?1===t?{inputOneIsError:!0,inputOneErrorTip:a.ZP.t("请输入小于最大值的{{inputType}}",{inputType:o}),inputTwoIsError:!1}:{inputOneIsError:!1,inputTwoIsError:!0,inputTwoErrorTip:a.ZP.t("请输入大于最小值的{{inputType}}",{inputType:o})}:null}var k=function(e){var t=n.Utils.numberFormatUtils.formatParseEngine.parseValue(e,"");return(null===t||void 0===t?void 0:t.type)===v.Z.DATE_TIME||(null===t||void 0===t?void 0:t.type)===v.Z.DATE||(null===t||void 0===t?void 0:t.type)===v.Z.TIME},H=function(e,t){switch(t.ruleType){case h.Z.DATE:return k(e);case h.Z.NUMBER_INT:case h.Z.CUSTOM_MUST_FLOAT:case h.Z.NUMBER_FLOAT_AND_INT:return!k(e)}return!0};function U(e,t,o){var s;return o&&!o.endsWith("%")||(null===(s=null===t||void 0===t?void 0:t.getMetadata())||void 0===s?void 0:s.customDataType)!==f.ZP.PROGRESS?e:"("+e+" * 100)"}},"../spread-sheet/src/core/feature/smartSelection/constant.ts":function(e,t,o){var s,a,n,r;o.d(t,{eG:function(){return a},gl:function(){return s},q:function(){return n},qG:function(){return r}}),function(e){e.COPY="copy",e.ORDER="order",e.FORMAT="format",e.NO_FORMAT="no-format"}(s||(s={})),function(e){e.LEFT="left",e.RIGHT="right",e.TOP="top",e.BOTTOM="bottom"}(a||(a={})),function(e){e.FILL_SERIES="fill_series",e.FILL_COPY="fill_copy",e.FILL_OPTION_COPY="fill_option_copy",e.FILL_OPTION_SERIES="fill_option_series",e.FILL_FORMAT="fill_format",e.FILL_WITHOUT_FORMAT="fill_without_format",e.MOBILE_FILL_SERIES="mobile_fill_series",e.MOBILE_FILL_COPY="mobile_fill_copy",e.CLK_FILL_SUCCESS="clk_fill_success"}(n||(n={})),function(e){e.EXCEL_FILL="excel_fill",e.EXCEL_FILL_MOBILE="excel_fill_mobile"}(r||(r={}))},"../spread-sheet/src/core/view/level-1/orientation-operate/utils.ts":function(e,t,o){function s(e){return void 0===e&&(e=screen.orientation?screen.orientation.angle:Number(window.orientation)),!(90!==e&&-90!==e)}o.d(t,{m:function(){return s}}),o("../node_modules/core-js/modules/es.number.constructor.js")},"../spread-sheet/src/core/view/level-2/area-overlay/AreaOverlay.ts":function(e,t,o){o.r(t),o("../node_modules/core-js/modules/es.object.assign.js");var s=function(){function e(e){this._overlay=document.createElement("div"),this._areaData=e.areaData,this._mainBoard=e.mainBoard,this._overlay.classList.add("area-overlay"),this._mainBoard.element.appendChild(this._overlay)}var t=e.prototype;return t.show=function(e){var t=e.xRange,o=e.yRange,s=this._areaData.getDisplayViewLeftByCol(t[0]),a=this._areaData.getDisplayViewRightByCol(t[1])-s,n=this._areaData.getDisplayViewTopByRow(o[0]),r=this._areaData.getDisplayViewBottomByRow(o[1])-n;Object.assign(this._overlay.style,{left:s+"px",top:n+"px",width:a+"px",height:r+"px",display:"block"})},t.hide=function(){this._overlay.style.display="none"},e}();t.default=s},"../spread-sheet/src/core/view/level-2/chart/charts/ChartRangeRenderPlugin.ts":function(e,t,o){o.r(t);var s=o("../node_modules/@babel/runtime/helpers/esm/assertThisInitialized.js"),a=o("../node_modules/@babel/runtime/helpers/esm/inheritsLoose.js"),n=(o("../node_modules/core-js/modules/es.object.assign.js"),o("../spread-sheet/src/core/view/level-2/render-plugin/BaseRenderPlugin.ts")),r=o("../packages/model/src/range/GridRange.ts"),i=o("../spread-sheet/src/core/view/spreadsheet-view/render-manager/alloy-excel/utils.ts"),l=o("../spread-sheet/src/core/view/spreadsheet-view/model/Color.ts"),d=o("../node_modules/lodash/set.js"),c=o.n(d),u=l.Z.newInstanceByHex("#4892FE"),h=l.Z.newInstanceByHex("#FF5E2F"),_=l.Z.newInstanceByHex("#A55BF5"),p={width:i.v.THIN,style:i.j.MEDIUM,color:u},m=function(e){function t(t){var o;return(o=e.call(this,t)||this).gridRange=null,o.asLegendOrXAxisRowIndex=-1,o.asXAxisOrLegendColIndex=-1,o.shouldTranspose=!1,o.dwtRecordChartRange=window.__DWT__recordChartRange,o.renderAfterArea=function(e){var t;if((null===(t=o.gridRange)||void 0===t?void 0:t.sheetId)===o.spreadsheet.activeSheetId){var s=o.gridRange,a=s.startRowIndex,n=s.startColIndex,i=e.fromRow,l=e.toRow,d=e.fromCol,c=e.toCol;if(!(a>l||n>c)){var u=new r.Z(o.spreadsheet.activeSheetId,i,l,d,c),h={borderRange:o.gridRange,visualRange:u,shouldDrawTopBorder:!0,shouldDrawRightBorder:!0,shouldDrawBottomBorder:!0,shouldDrawLeftBorder:!0};o.drawLegendOrXAxisRowRange(h),o.drawXAxisOrLegendColRange(h),o.drawDataRange(h)}}},o._hide=function(){o.gridRange=null,o.renderApi.renderNextTick()},o.drawLegendOrXAxisRowRange=function(e){var t=e.borderRange,s=t.startRowIndex,a=t.startColIndex,n=t.endColIndex;if(!(o.asLegendOrXAxisRowIndex<0||a===n&&o.asXAxisOrLegendColIndex>-1&&o.asLegendOrXAxisRowIndex>-1)){var i=new r.Z(e.borderRange.sheetId,s,s,a+o.asXAxisOrLegendColIndex+1,n),l=Object.assign(Object.assign({},e),{borderRange:i}),d=Object.assign(Object.assign({},p),{color:o.shouldTranspose?_:h});o.drawRange(l,d),o.dwtRecordChartRange&&c()(window,["chartRangeConfigs",s,s,a+o.asXAxisOrLegendColIndex+1,n],d)}},o.drawXAxisOrLegendColRange=function(e){var t=e.borderRange,s=t.startRowIndex,a=t.endRowIndex,n=t.startColIndex;if(!(o.asXAxisOrLegendColIndex<0||s===a&&o.asLegendOrXAxisRowIndex>-1&&o.asXAxisOrLegendColIndex>-1)){var i=new r.Z(e.borderRange.sheetId,s+o.asLegendOrXAxisRowIndex+1,a,n,n),l=Object.assign(Object.assign({},e),{borderRange:i}),d=Object.assign(Object.assign({},p),{color:o.shouldTranspose?h:_});o.drawRange(l,d),o.dwtRecordChartRange&&c()(window,["chartRangeConfigs",s+o.asLegendOrXAxisRowIndex+1,a,n,n],d)}},o.drawDataRange=function(e){var t=e.borderRange,s=t.startRowIndex,a=t.endRowIndex,n=t.startColIndex,i=t.endColIndex;if(!(o.asXAxisOrLegendColIndex>-1&&i-n===0||o.asLegendOrXAxisRowIndex>-1&&a-s===0)){var l=new r.Z(e.borderRange.sheetId,s+o.asLegendOrXAxisRowIndex+1,a,n+o.asXAxisOrLegendColIndex+1,i),d=Object.assign(Object.assign({},e),{borderRange:l,shouldDrawTopBorder:o.asLegendOrXAxisRowIndex<0,shouldDrawLeftBorder:o.asXAxisOrLegendColIndex<0});o.drawRange(d),o.dwtRecordChartRange&&c()(window,["chartRangeConfigs",s+o.asLegendOrXAxisRowIndex+1,a,n+o.asXAxisOrLegendColIndex+1,i],p)}},o.drawRange=function(e,t){void 0===t&&(t={width:i.v.THIN,style:i.j.MEDIUM,color:u});var s=o.headSize,a=s.rowHeadWidth,n=s.colHeadHeight,r=e.borderRange,l=r.startRowIndex,d=r.endRowIndex,c=r.startColIndex,h=r.endColIndex,_=e.visualRange,p=_.startRowIndex,m=_.endRowIndex,g=_.startColIndex,f=_.endColIndex,w=e.shouldDrawTopBorder,v=e.shouldDrawRightBorder,y=e.shouldDrawBottomBorder,R=e.shouldDrawLeftBorder,C=o.areaData.getViewLeftByCol(c)+a,D=o.areaData.getViewTopByRow(l)+n,I=o.areaData.getViewRightByCol(h)+a,A=o.areaData.getViewBottomByRow(d)+n;w&&l>=p&&o.chartRangeCollector.collect({line:[C,D,I,D],lineProp:t}),v&&h<=f&&o.chartRangeCollector.collect({line:[I,D,I,A],lineProp:t}),y&&d<=m&&o.chartRangeCollector.collect({line:[C,A,I,A],lineProp:t}),R&&c>=g&&o.chartRangeCollector.collect({line:[C,D,C,A],lineProp:t})},Object.assign((0,s.Z)(o),t),o._alloyExcel.onAfterAreaRender(o.renderAfterArea),o}(0,a.Z)(t,e);var o=t.prototype;return o.show=function(e,t,o,s){this.gridRange=e.clone(),this.asLegendOrXAxisRowIndex=t,this.asXAxisOrLegendColIndex=o,this.shouldTranspose=s,this.renderApi.renderNextTick()},o.hide=function(){this._hide()},t}(n.Z);t.default=m},"../spread-sheet/src/core/view/level-2/condition-format-center/ConditionFormatCenter.pc.ts":function(e,t,o){o.r(t),o.d(t,{default:function(){return C}});var s=o("../node_modules/@babel/runtime/helpers/esm/createClass.js"),a=(o("../node_modules/core-js/modules/es.object.assign.js"),o("../node_modules/core-js/modules/es.array.map.js"),o("../node_modules/core-js/modules/es.regexp.exec.js"),o("../node_modules/core-js/modules/es.string.split.js"),o("../node_modules/core-js/modules/es.object.values.js"),o("../node_modules/core-js/modules/es.string.search.js"),o("../node_modules/core-js/modules/es.array.from.js"),o("../node_modules/core-js/modules/es.string.iterator.js"),o("../node_modules/core-js/modules/es.array.iterator.js"),o("../node_modules/core-js/modules/es.object.to-string.js"),o("../node_modules/core-js/modules/es.set.js"),o("../node_modules/core-js/modules/esnext.set.add-all.js"),o("../node_modules/core-js/modules/esnext.set.delete-all.js"),o("../node_modules/core-js/modules/esnext.set.difference.js"),o("../node_modules/core-js/modules/esnext.set.every.js"),o("../node_modules/core-js/modules/esnext.set.filter.js"),o("../node_modules/core-js/modules/esnext.set.find.js"),o("../node_modules/core-js/modules/esnext.set.intersection.js"),o("../node_modules/core-js/modules/esnext.set.is-disjoint-from.js"),o("../node_modules/core-js/modules/esnext.set.is-subset-of.js"),o("../node_modules/core-js/modules/esnext.set.is-superset-of.js"),o("../node_modules/core-js/modules/esnext.set.join.js"),o("../node_modules/core-js/modules/esnext.set.map.js"),o("../node_modules/core-js/modules/esnext.set.reduce.js"),o("../node_modules/core-js/modules/esnext.set.some.js"),o("../node_modules/core-js/modules/esnext.set.symmetric-difference.js"),o("../node_modules/core-js/modules/esnext.set.union.js"),o("../node_modules/core-js/modules/web.dom-collections.iterator.js"),o("../packages/model/src/index.ts")),n=o("../spread-sheet/src/core/data/configService/spreadConfig.ts"),r=o("../spread-sheet/src/core/view/level-1/select-center/base/utils.ts"),i=o("../packages/model/src/range/hexRangeUtils.ts"),l=o("../packages/model/src/rule/index.ts"),d=o("../packages/model/src/rule/InterpolationPoint.ts"),c=o("../packages/model/src/cell/format/index.ts"),u=o("../packages/model/src/rule/DataBarConditionalFormat.ts"),h=function(){function e(e){this._requestApi=e.requestApi,this._spreadsheet=e.spreadsheet,this._normalSelectData=e.normalSelectData}var t=e.prototype;return t.addRule=function(e){var t=n.q.getConfig("tinyid")||null,o=this._uiRule2RequestRule(t,e);o&&this._requestApi.addConditionFormat({rule:Object.assign({},o)})},t.deleteRule=function(e){var t=this.getRuleIndexByRuleId(e);this._requestApi.deleteConditionFormat({ruleIndex:t})},t.updateRule=function(e,t){var o=this.getRuleIndexByRuleId(e),s=this._spreadsheet.activeSheet.conditionalFormatRuleManager.getConditionalFormatRuleByRuleId(e);if(s){var a=s.uid,n=this._uiRule2RequestRule(a,t);n&&this._requestApi.updateConditionFormat({ruleIndex:o,rule:Object.assign({},n)})}},t.updateRuleIndex=function(e,t,o){var s=this._spreadsheet.activeSheet.conditionalFormatRuleManager.getConditionalFormatRuleByRuleId(e);s&&this._requestApi.updateConditionFormatIndex({from:t,to:o,rule:s.clone()})},t.getRuleList=function(){return this._spreadsheet.activeSheet.conditionalFormatRuleManager.rules},t.getRuleManager=function(){return this._spreadsheet.activeSheet.conditionalFormatRuleManager},t.getRuleListCount=function(){return this.getRuleList().length},t.getRuleListWithCurrentSelection=function(){var e=(0,r.fq)(this._spreadsheet.activeSheetId,this._spreadsheet.activeSheet,this._normalSelectData);return e[0]?this._getRuleListAtRange(e[0]):[]},t.getRuleListCountWithCurrentSelection=function(){return this.getRuleListWithCurrentSelection().length},t.getRuleListAtPosition=function(e,t){var o=this._spreadsheet.activeSheetId,s=new a.Range.GridRange(o,e,e,t,t);return this._getRuleListAtRange(s)},t.isSelectedRangeConditionalFormatBGColorEffect=function(){var e=this;return(0,r.fq)(this._spreadsheet.activeSheetId,this._spreadsheet.activeSheet,this._normalSelectData)[0].some((function(t,o){return e._whatCellFormatsDependOnConditionalFormat(t,o).bgColor}),this._spreadsheet.activeSheet)},t.getRuleById=function(e){return this._spreadsheet.activeSheet.conditionalFormatRuleManager.getRuleByRuleId(e)},t.getRuleIndexByRuleId=function(e){var t=this.getRuleById(e);return t?t.index:-1},t._whatCellFormatsDependOnConditionalFormat=function(e,t){var o={bgColor:!1},s=this._spreadsheet.activeSheet.getCellDataAtPosition(e,t),a=null===s||void 0===s?void 0:s.getConditionalFormatResult();return(null===a||void 0===a?void 0:a.getBackgroundColor())&&(o.bgColor=!0),o},t._uiRule2RequestRule=function(e,t){return this._uiBooleanRule2RequestRule(e,t)||this._uiGradientRule2RequestRule(e,t)||this._uiDataBarRule2RequestRule(e,t)},t._uiBooleanRule2RequestRule=function(e,t){var o=this,s=t.booleanCondition,n=t.ranges.split(",").map((function(e){return(0,i.hex2Range)(e,o._spreadsheet.activeSheetId)}));if(s){var r=s.conditionType,l=s.inputOne,d=s.inputTwo,c=s.format;if(-1===Object.values(a.Rule.CONDITION_TYPE).indexOf(r))return;return{ruleRanges:n,booleanConditionalFormat:{condition:{conditionType:r,userInputOne:l,userInputTwo:d},format:c},userId:e}}},t._uiGradientRule2RequestRule=function(e,t){var o=this,s=t.gradientCondition,a=t.ranges.split(",").map((function(e){return(0,i.hex2Range)(e,o._spreadsheet.activeSheetId)}));if(s){var n=s.inputOne,r=s.inputTwo,u=s.minColor,h=s.maxColor;return{ruleRanges:a,userId:e,gradientConditionalFormat:new l.GradientConditionalFormat({interpolationPoints:[new d.H({pointType:n.type,pointValue:n.type!==d.u.MIN&&n.type!==d.u.MAX?new l.ConditionValue({userEnteredValue:n.value}):void 0,color:c.Color.createColor(u)}),new d.H({pointType:r.type,pointValue:r.type!==d.u.MIN&&r.type!==d.u.MAX?new l.ConditionValue({userEnteredValue:r.value}):void 0,color:c.Color.createColor(h)})]})}}},t._uiDataBarRule2RequestRule=function(e,t){var o=this,s=t.dataBarCondition,a=t.ranges.split(",").map((function(e){return(0,i.hex2Range)(e,o._spreadsheet.activeSheetId)}));if(s){var n=s.inputOne,r=s.inputTwo,h=s.negativeColor,_=s.positiveColor,p=s.hideData;return{ruleRanges:a,userId:e,dataBarConditionalFormat:new u.Z({interpolationPoints:[new d.H({pointType:n.type,pointValue:n.type!==d.u.MIN&&n.type!==d.u.MAX?new l.ConditionValue({userEnteredValue:n.value}):void 0,color:c.Color.createColor(h)}),new d.H({pointType:r.type,pointValue:r.type!==d.u.MIN&&r.type!==d.u.MAX?new l.ConditionValue({userEnteredValue:r.value}):void 0,color:c.Color.createColor(_)})],hideData:p})}}},t._getRuleListAtRange=function(e){var t=e.getAbsolutePosition(),o=t.startRow,s=t.endRow,a=t.endCol,n=t.startCol,r=this.getRuleManager().ruleTree.search({minX:n,maxX:a,minY:o,maxY:s}).map((function(e){return e.rule}));return Array.from(new Set(r))},e}(),_=o("../node_modules/@tencent/jank-sdk/lib/index.js"),p=o("../packages/report/src/index.ts"),m=(0,_.Hr)((function(e){for(var t,o=e.activeSheet.conditionalFormatRuleManager.rules,s=!1,a=0;a<o.length;a++)if(null===(t=o[a].rule.booleanConditionalFormat)||void 0===t?void 0:t.condition){s=!0;break}s&&p.ZP.tdwReport({opername:"doc_excel_editor",module:"conditional_format",action:"format_activedoc"})}),"checkPageConditionPv"),g=o("../node_modules/@babel/runtime/helpers/esm/inheritsLoose.js"),f=(o("../node_modules/core-js/modules/es.array.concat.js"),o("../node_modules/core-js/modules/web.dom-collections.for-each.js"),o("../spread-sheet/src/core/view/level-2/render-plugin/BaseRenderPlugin.ts")),w=o("../spread-sheet/src/core/view/spreadsheet-view/utils.ts"),v=o("../spread-sheet/src/core/view/spreadsheet-view/render-manager/alloy-excel/canvas/renderer/BaseRenderer.ts"),y=o("../packages/model/src/rule/DataBarProps.ts"),R=function(e){function t(t){var o;return(o=e.call(this,t)||this).renderAfterCell=function(e){var t,s=e.x,a=e.y,n=e.row,r=e.col,i=null===(t=o.spreadsheet.activeSheet.getCellDataAtPosition(n,r))||void 0===t?void 0:t.getDataBar();if(i){var l=o.tableView.getCellViewAtPosition(n,r),d=i.direction,c=i.zeroPoint,u=i.length,h=i.negativeColor,_=i.positiveColor,p=(0,w.o)(o.rowcolAccessor,l,r),m=(0,w.E)(o.rowcolAccessor,l,n),g=p*u,f=s+p*c,v=[].concat([f,a],[f+g*d,a],[f+g*d,a+m],[f,a+m]),R=o._fixPath(v,s,s+p);o.dataBarCollector.collect({color:d===y.N.Negative?h:_,graphicsInfo:{path:R}})}},o.spreadsheet=t.spreadsheet,o.rowcolAccessor=t.rowcolAccessor,o.tableView=t.tableView,o.dataBarCollector=o._addDataBarCollector(),o._alloyExcel.onAfterCellRender(o.renderAfterCell),o}(0,g.Z)(t,e);var o=t.prototype;return o._fixPath=function(e,t,o){var s=[];return e.forEach((function(e,a){s[a]=e,a%2===0&&(e<t&&(s[a]=t),e>o&&(s[a]=o))})),s},o._addDataBarCollector=function(){var e=this._alloyExcel.collectEngine.generateCollector(v.g4.GraphicsRender,v.DF.DataBar);return this._alloyExcel.collectEngine.add("data_bar",e),e},t}(f.Z),C=function(){function e(e){this._conditionFormat=new h(e),this.renderPlugin=new R(e),m(e.spreadsheetApp.spreadsheet)}return(0,s.Z)(e,[{key:"conditionFormat",get:function(){return this._conditionFormat}}]),e}()},"../spread-sheet/src/core/view/level-2/data-validation-center/DataValidationCenter.pc.ts":function(e,t,o){o.r(t),o.d(t,{default:function(){return V}}),o("../node_modules/core-js/modules/es.object.assign.js");var s=o("../node_modules/@babel/runtime/helpers/esm/assertThisInitialized.js"),a=o("../node_modules/@babel/runtime/helpers/esm/inheritsLoose.js"),n=o("../spread-sheet/src/core/view/level-2/render-plugin/BaseRenderPlugin.ts"),r=o("../spread-sheet/src/core/view/level-2/render-plugin/utils.ts"),i=function(){function e(){}return e.Base64ToImage=function(){e.NORMAL.img.src=e.NORMAL.base64,e.HOVER.img.src=e.HOVER.base64,e.ACTIVE.img.src=e.ACTIVE.base64},e}();i.WIDTH=9,i.HEIGHT=6,i.RADIUS=2,i.NORMAL={base64:"data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAiIGhlaWdodD0iMjAiIHZpZXdCb3g9IjAgMCAyMCAyMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48ZyBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPjxwYXRoIGQ9Ik0xIDBoMThhMSAxIDAgMCAxIDEgMXYxOGExIDEgMCAwIDEtMSAxSDFhMSAxIDAgMCAxLTEtMVYxYTEgMSAwIDAgMSAxLTF6IiBmaWxsPSIjRkZGIi8+PHBhdGggZD0iTTEwLjIzNCAxMi43MDdsMy4zNzYtNC4yMkEuMy4zIDAgMCAwIDEzLjM3NiA4SDYuNjI0YS4zLjMgMCAwIDAtLjIzNC40ODdsMy4zNzYgNC4yMmEuMy4zIDAgMCAwIC40NjggMHoiIGZpbGw9IiM0NjRENUEiLz48L2c+PC9zdmc+",img:new Image},i.HOVER={base64:"data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAiIGhlaWdodD0iMjAiIHZpZXdCb3g9IjAgMCAyMCAyMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48ZyBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPjxwYXRoIGQ9Ik0xIDBoMThhMSAxIDAgMCAxIDEgMXYxOGExIDEgMCAwIDEtMSAxSDFhMSAxIDAgMCAxLTEtMVYxYTEgMSAwIDAgMSAxLTF6IiBmaWxsPSIjRjVGNUY1Ii8+PHBhdGggZD0iTTEwLjIzNCAxMi43MDdsMy4zNzYtNC4yMkEuMy4zIDAgMCAwIDEzLjM3NiA4SDYuNjI0YS4zLjMgMCAwIDAtLjIzNC40ODdsMy4zNzYgNC4yMmEuMy4zIDAgMCAwIC40NjggMHoiIGZpbGw9IiM0NjRENUEiLz48L2c+PC9zdmc+",img:new Image},i.ACTIVE={base64:"data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAiIGhlaWdodD0iMjAiIHZpZXdCb3g9IjAgMCAyMCAyMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48ZyBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPjxwYXRoIGQ9Ik0xIDBoMThhMSAxIDAgMCAxIDEgMXYxOGExIDEgMCAwIDEtMSAxSDFhMSAxIDAgMCAxLTEtMVYxYTEgMSAwIDAgMSAxLTF6IiBmaWxsPSIjRUJFQkVCIi8+PHBhdGggZD0iTTEwLjIzNCAxMi43MDdsMy4zNzYtNC4yMkEuMy4zIDAgMCAwIDEzLjM3NiA4SDYuNjI0YS4zLjMgMCAwIDAtLjIzNC40ODdsMy4zNzYgNC4yMmEuMy4zIDAgMCAwIC40NjggMHoiIGZpbGw9IiM0NjRENUEiLz48L2c+PC9zdmc+",img:new Image},i.Base64ToImage();var l=i,d=o("../spread-sheet/src/core/view/level-1/orientation-operate/utils.ts"),c=o("../node_modules/@tencent/docs-user-agent/dist/index.js"),u=o.n(c),h=o("../spread-sheet/src/core/view/spreadsheet-view/utils.ts"),_=o("../spread-sheet/src/core/view/spreadsheet-view/model/CellPadding.ts"),p=o("../spread-sheet/src/core/view/spreadsheet-view/table-view/utils.ts"),m=o("../packages/model/src/cell/metadata/CustomDataType.ts"),g=o("../spread-sheet/src/core/view/lib/mutex-management/MutexManagement.ts"),f=o("../packages/lib/index.ts"),w=o("../spread-sheet/src/core/view/spreadsheet-view/render-manager/alloy-excel/canvas/CollectEngine.ts"),v=o("../spread-sheet/src/core/app/sheetStatus/auth-range.ts"),y=function(e){function t(o){var a;(a=e.call(this,o)||this)._active=!1,a._lastActiveCell={row:-1,col:-1},a._lastHoverCell={row:-1,col:-1},a._buttonSize=20,a.renderAfterCell=function(e){var t=e.x,o=e.y,s=e.row,n=e.col;if(a._normalSelectData.activeRow===s&&a._normalSelectData.activeCol===n&&(0,p.Tk)(a._spreadsheet.activeSheet,s,n)){if((0,v.I1)(a._spreadsheet.parent,s,n))return;var i=a._spreadsheetView.tableView.getCellViewAtPosition(s,n),d=(0,h.o)(a._spreadsheetView.rowcolAccessor,i,n),c=(0,h.E)(a._spreadsheetView.rowcolAccessor,i,s),u=(0,r.t9)(a._spreadsheetView.tableView,s,n,c,a._buttonSize),m={dx:t+d-_.i.TEXT-a._buttonSize,dy:o+u,dWidth:a._buttonSize,dHeight:a._buttonSize};if(m.img=l.NORMAL.img,a._active?m.img=l.ACTIVE.img:a._isHoverCellValidationListHeader(s,n)&&(m.img=l.HOVER.img),!m.img)return;a._alloyExcel.collectEngine.bitmapCollector.collect(m,w.h.VALIDATION_HEADER)}},a._handleMove=function(){if(a._operateData.isHoverCell()){var e=a._operateData.currRow,t=a._operateData.currCol;(0,p.Tk)(a._spreadsheet.activeSheet,e,t)&&a._isHoverCellValidationListHeader(e,t)?(e===a._lastHoverCell.row&&t===a._lastHoverCell.col||-1!==a._lastHoverCell.row&&-1!==a._lastHoverCell.col&&a._spreadsheetView.renderManager.renderApi.renderRowCells(a._lastHoverCell.row),a._spreadsheetView.renderManager.renderApi.renderNextTick(),a._lastHoverCell.row=e,a._lastHoverCell.col=t):a._lastHoverCell.row>=0&&a._lastHoverCell.col>=0&&(a._spreadsheetView.renderManager.renderApi.renderNextTick(),a._lastHoverCell.row=-1,a._lastHoverCell.col=-1)}},a._handleDown=function(){var e;if((!u().isMobilePhone||!(0,d.m)())&&a._operateData.isHoverCell()){var o=a._operateData.currRow,s=a._operateData.currCol,n=a._spreadsheet.activeSheet.getCellDataAtPosition(o,s),r=null===n||void 0===n?void 0:n.getMergeReference();if(r&&(o=r.startRowIndex,s=r.startColIndex),a._normalSelectData.activeRow===o&&a._normalSelectData.activeCol===s&&(0,p.Tk)(a._spreadsheet.activeSheet,o,s)&&a._isHoverCellValidationListHeader(o,s)){if(!a._sheetStatus.canEdit||(0,v.I1)(a._spreadsheet.parent,o,s))return;a._operateData.stopPropagation=!0,a._active=!0;var i=null===(e=null===n||void 0===n?void 0:n.getMetadata())||void 0===e?void 0:e.customDataType,l=null===n||void 0===n?void 0:n.getDataValidation(),c={row:o,col:s,isFromMetadata:i===m.ZP.SELECT&&!(0,m.J$)(i,l)};a.emitter.emit(t.EVENT.FOCUS_ICON,c),a._lastActiveCell.row=o,a._lastActiveCell.col=s,a._onceModifySelection((function(){a._normalSelectData.activeCol===a._lastActiveCell.col&&a._normalSelectData.activeRow===a._lastActiveCell.row||(a._active=!1)}))}}},a._spreadsheet=o.spreadsheet,a._spreadsheetView=o.spreadsheetView,a._operateData=o.operateData,a._sheetStatus=o.sheetStatus,a._normalSelectData=o.normalSelectData,a._onceModifySelection=f.ju.once(a._normalSelectData.onModifySelectData);var n=o.mouseOperate;n&&(a._mouseOperate=n,n.onMousemove(a._handleMove),n.onMousedown(a._handleDown));var i=o.touchOperate;return i&&(a._touchOperate=i,i.onTap(a._handleDown)),o.mutexManagement.addMutexComponent(g.d.VALIDATION_LIST_HEADER,(0,s.Z)(a)),a._alloyExcel.onAfterCellRender(a.renderAfterCell),a}(0,a.Z)(t,e);var o=t.prototype;return o.mutexHide=function(){this._active=!1},o._isHoverCellValidationListHeader=function(e,t){var o=this._spreadsheet.activeSheet.getCellDataAtPosition(e,t);if(!o)return!1;var s=o.getMergeReference();s&&(e=s.startRowIndex,t=s.startColIndex);var a=this._spreadsheetView.areaData.getViewLeftByCol(t),n=this._spreadsheetView.areaData.getViewTopByRow(e),i=this._operateData.currX-a-this._spreadsheetView.headSize.rowHeadWidth,l=this._operateData.currY-n-this._spreadsheetView.headSize.colHeadHeight,d=this._spreadsheetView.tableView.getCellViewAtPosition(e,t),c=(0,h.o)(this._spreadsheetView.rowcolAccessor,d,t),p=(0,h.E)(this._spreadsheetView.rowcolAccessor,d,e),m=(0,r.t9)(this._spreadsheetView.tableView,e,t,p,this._buttonSize),g=u().isMobile?5:0;return i>c-_.i.TEXT-this._buttonSize-g&&i<c-_.i.TEXT+g&&l>m-g&&l<m+this._buttonSize+g},t}(n.Z);y.EVENT={FOCUS_ICON:"focus_icon"};var R,C=y,D=o("../node_modules/@babel/runtime/helpers/esm/toConsumableArray.js"),I=o("../node_modules/@babel/runtime/helpers/esm/createClass.js"),A=(o("../node_modules/regenerator-runtime/runtime.js"),o("../node_modules/core-js/modules/es.object.to-string.js"),o("../node_modules/core-js/modules/es.promise.js"),o("react")),T=o.n(A),j=o("react-dom"),x=(o("../node_modules/core-js/modules/es.array.map.js"),o("../node_modules/i18next/dist/esm/i18next.js")),E=o("../node_modules/@tencent/dui/lib/components/Menu/index.js"),S=function(e){function t(t){var o;return(o=e.call(this,t)||this).handleSelect=function(e){var t,s;null===(s=(t=o.props).selectCb)||void 0===s||s.call(t,e)},o.items=o.props.items,o}(0,a.Z)(t,e);var o=t.prototype;return o.componentDidMount=function(){this.props.moundedCb()},o.componentWillUnmount=function(){this.props.unmoundedCb()},o.render=function(){var e=this.props,t=e.height,o=e.isLoading;return T().createElement("div",null,T().createElement(E.default,{onClick:this.handleSelect,style:{maxHeight:Math.min(t,375),overflowY:"auto"}},T().createElement("div",{className:"validation-list-tip"},x.ZP.t("单选")),o?T().createElement("div",{className:"validation-list-loading"},x.ZP.t("正在加载...")):this.items.map((function(e){return T().createElement(E.default.Item,{id:e,key:e},T().createElement("div",{className:"validation-list-item"},e))}))))},t}(T().Component);!function(e){e[e.CLICK_HEADER=1]="CLICK_HEADER",e[e.ENTER_EDIT=2]="ENTER_EDIT"}(R||(R={}));var M=o("../spread-sheet/src/core/feature/dataValidation/api/DataValidationUtils.ts"),b=o("../spread-sheet/src/core/view/utils/base-func.ts"),L=o("../packages/report/src/index.ts"),O=function(e,t,o,s){return new(o||(o=Promise))((function(a,n){function r(e){try{l(s.next(e))}catch(t){n(t)}}function i(e){try{l(s.throw(e))}catch(t){n(t)}}function l(e){var t;e.done?a(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(r,i)}l((s=s.apply(e,t||[])).next())}))},N=function(){function e(e){var t=this;this._card=document.createElement("div"),this._showing=!1,this._height=375,this._translateX=0,this._translateY=0,this.handleScroll=function(){t._hide()},this._handleModifySelection=function(){t._normalSelectData.activeCol===t._xIndex&&t._normalSelectData.activeRow===t._yIndex||t._hide()},this._bindEvent=function(){var e;null===(e=t._inputManager)||void 0===e||e.alloyRTE.on(t._inputManager.alloyRTE.EVENT.VALUE_CHANGE,t._handleInputChange),t._areaDataUpdateOffsetDispose=t._areaData.onUpdateOffset(t._updatePosition),t._modifySelectionDispose=t._normalSelectData.onModifySelectData(t._handleModifySelection)},this._unbindEvent=function(){var e;null===(e=t._inputManager)||void 0===e||e.alloyRTE.off(t._inputManager.alloyRTE.EVENT.VALUE_CHANGE,t._handleInputChange),t._areaDataUpdateOffsetDispose.dispose(),t._modifySelectionDispose.dispose()},this._handleSelect=function(e){var o;(null===(o=t._inputManager)||void 0===o?void 0:o.isInputtingState())?(t._inputManager.setText(e),t._inputManager.handleExitInput()):t._spreadsheetApp.requestApi.userEnter({text:e,colIndex:t._xIndex,rowIndex:t._yIndex}),t._hide(),L.ZP.kvrOss({itemname:"xls_dropdown_value_choose"})},this._sortAndFilterItems=function(e){if(""!==e){for(var o=[],s=t._originItems,a=s.length,n=e.toLowerCase(),r=0;r<a;r++){var i=s[r];-1!==i.toLowerCase().indexOf(n)&&o.push(i)}t._items=o}else t._items=t._originItems},this._handleInputChange=function(){t._sortAndFilterItems(t._inputManager.alloyRTE.getText()),t._render()},this._updatePosition=function(){var e=t._areaData.getDisplayViewLeftByCol(t._xIndex),o=t._areaData.getDisplayViewTopByRow(t._yIndex);t._card.style.transform="translate("+(e-t._translateX)+"px, "+(o-t._translateY)+"px)"},this._hide=function(){t._showing&&(t._xIndex=-1,t._yIndex=-1,t._showing=!1,t.isLoading=!0,t._card.style.transform="translate(0px, 0px)",t.disposeHandleScroll.dispose(),j.unmountComponentAtNode(t._card))},this._handleEnterInput=function(){var e=t._inputManager.cellData,o=e.row,s=e.col;(0,p.Tk)(t._spreadsheetApp.spreadsheet.activeSheet,o,s)&&t.show(o,s,R.ENTER_EDIT)},this._spreadsheetApp=e.spreadsheetApp,this._areaData=e.areaData,this._clientRect=e.clientRect,this._mainBoard=e.mainBoard,this._headSize=e.headSize,this._normalSelectData=e.normalSelectData,this._inputManager=e.inputManager,this._mutexManagement=e.mutexManagement,this._showing=!1,this.isLoading=!0,this._card.classList.add("validation-list-container"),this._card.addEventListener("wheel",b.UW),this._mainBoard.element.appendChild(this._card),this._inputManager&&this._inputManager.emitter.on(this._inputManager.EVENT.ENTER_INPUT,this._handleEnterInput),this._mutexManagement.addMutexComponent(g.d.VALIDATION_LIST,this),this._spreadsheetApp.view.canvas.scale.onScale((function(){t.showing&&t._setStyle()}))}var t=e.prototype;return t.show=function(e,t,o){return void 0===o&&(o=R.CLICK_HEADER),O(this,void 0,void 0,regeneratorRuntime.mark((function s(){var a,n;return regeneratorRuntime.wrap((function(s){for(;;)switch(s.prev=s.next){case 0:if(a=this._spreadsheetApp.spreadsheet.activeSheet.getCellDataAtPosition(e,t),(n=null===a||void 0===a?void 0:a.getMergeReference())&&(e=n.startRowIndex,t=n.startColIndex),this._xIndex!==t||this._yIndex!==e){s.next=5;break}return s.abrupt("return");case 5:return this._items=[],this._xIndex=t,this._yIndex=e,this._showing=!0,this._triggerBy=o,s.next=12,this._setData(e,t);case 12:this._setStyle(),this._mutexManagement.mutexShow(g.d.VALIDATION_LIST),this._render();case 15:case"end":return s.stop()}}),s,this)})))},t.mutexHide=function(){this._hide()},t.hide=function(){this._hide()},t._setData=function(e,t){var o=this;return this.isLoading=!0,(0,M.ZK)(this._spreadsheetApp,e,t).then((function(s){var a=o._normalSelectData,n=a.activeCol,r=a.activeRow;n===t&&r===e&&(o._items=s||[],o._originItems=(0,D.Z)(o._items),o.isLoading=!1,o._showing=!0,o._setStyle(),j.unmountComponentAtNode(o._card),o._render())}))},t._setStyle=function(){var e=this._areaData.getDisplayViewLeftByCol(this._xIndex),t=this._yIndex,o=this._yIndex,s=this._spreadsheetApp.spreadsheet.activeSheet.getCellDataAtPosition(this._yIndex,this._xIndex),a=null===s||void 0===s?void 0:s.getMergeReference();a&&(t=a.startRowIndex,o=a.endRowIndex);var n=this._areaData.getDisplayViewTopByRow(t),r=this._areaData.getDisplayViewBottomByRow(o),i=Math.min(375,50*this._items.length);if(this._height=375,this._clientRect.height-r<n)this._card.style.top="",this._card.style.bottom=this._clientRect.height-this._headSize.displayColHeadHeight-n+"px",i>n&&(this._height=n);else{this._card.style.top=r+"px",this._card.style.bottom="";var l=this._clientRect.height-r-this._headSize.displayColHeadHeight;i>l&&(this._height=l)}this._card.style.left=e+"px",this._translateX=this._areaData.getDisplayViewLeftByCol(this._xIndex),this._translateY=this._areaData.getDisplayViewTopByRow(this._yIndex)},t._render=function(){var e=this,t=(new Date).getTime();this.disposeHandleScroll=this._spreadsheetApp.view.canvas.wheelOperate.onScroll(this.handleScroll),j.render(T().createElement(S,{items:this._items,height:this._height,isLoading:this.isLoading,moundedCb:function(){e._bindEvent()},unmoundedCb:function(){e._unbindEvent()},selectCb:this._handleSelect,key:t}),this._card)},(0,I.Z)(e,[{key:"showing",get:function(){return this._showing}}]),e}(),B=function(e){var t=this;this._show=function(e){var o=e.col,s=e.row,a=e.isFromMetadata;o<0||s<0||a||t._validationListCard.show(s,o)},this._validationListHeaderRender=e.validationListHeaderRender,this._validationListCard=e.validationListCard,this._validationListHeaderRender.emitter.on(C.EVENT.FOCUS_ICON,this._show)},V=function(){function e(e){this.validationList=new C(e),this.validationListCard=new N(e),this.validationPanel=new B(Object.assign(Object.assign({},e),{validationListHeaderRender:this.validationList,validationListCard:this.validationListCard}))}return e.prototype.refresh=function(){this.validationListCard.hide()},e}()},"../spread-sheet/src/core/view/level-2/freeze-preview/FreezePreview.ts":function(e,t,o){o.r(t);var s=function(){function e(e){this._areaData=e.areaData,this._mainBoard=e.mainBoard,this._rowcolAccessor=e.rowcolAccessor,this._renderApi=e.renderApi}var t=e.prototype;return t.preview=function(e){void 0===e.row&&(e.row=0),this._areaData.row.set(this._rowcolAccessor,e.row,this._rowcolAccessor.getRowCount()),this._mainBoard.top.left.element.classList.add("freeze-preview"),this._mainBoard.top.right.element.classList.add("freeze-preview"),void 0===e.column&&(e.column=0),this._areaData.col.set(this._rowcolAccessor,e.column,this._rowcolAccessor.getColCount()),this._mainBoard.top.left.element.classList.add("freeze-preview"),this._mainBoard.bottom.left.element.classList.add("freeze-preview"),this._renderApi.renderNextTick()},t.cancelPreview=function(){this._areaData.row.set(this._rowcolAccessor,this._rowcolAccessor.getFrozenRowCount(),this._rowcolAccessor.getRowCount()),this._areaData.col.set(this._rowcolAccessor,this._rowcolAccessor.getFrozenColCount(),this._rowcolAccessor.getColCount()),this._mainBoard.top.left.element.classList.remove("freeze-preview"),this._mainBoard.top.right.element.classList.remove("freeze-preview"),this._mainBoard.bottom.left.element.classList.remove("freeze-preview"),this._renderApi.renderNextTick()},e}();t.default=s},"../spread-sheet/src/core/view/level-2/range-move/RangeMoveBoard.ts":function(e,t,o){o.r(t),o.d(t,{default:function(){return r}}),o("../node_modules/core-js/modules/es.array.iterator.js"),o("../node_modules/core-js/modules/es.array-buffer.slice.js"),o("../node_modules/core-js/modules/es.object.to-string.js"),o("../node_modules/core-js/modules/es.typed-array.uint32-array.js"),o("../node_modules/core-js/modules/es.typed-array.copy-within.js"),o("../node_modules/core-js/modules/es.typed-array.every.js"),o("../node_modules/core-js/modules/es.typed-array.fill.js"),o("../node_modules/core-js/modules/es.typed-array.filter.js"),o("../node_modules/core-js/modules/es.typed-array.find.js"),o("../node_modules/core-js/modules/es.typed-array.find-index.js"),o("../node_modules/core-js/modules/es.typed-array.for-each.js"),o("../node_modules/core-js/modules/es.typed-array.includes.js"),o("../node_modules/core-js/modules/es.typed-array.index-of.js"),o("../node_modules/core-js/modules/es.typed-array.iterator.js"),o("../node_modules/core-js/modules/es.typed-array.join.js"),o("../node_modules/core-js/modules/es.typed-array.last-index-of.js"),o("../node_modules/core-js/modules/es.typed-array.map.js"),o("../node_modules/core-js/modules/es.typed-array.reduce.js"),o("../node_modules/core-js/modules/es.typed-array.reduce-right.js"),o("../node_modules/core-js/modules/es.typed-array.reverse.js"),o("../node_modules/core-js/modules/es.typed-array.set.js"),o("../node_modules/core-js/modules/es.typed-array.slice.js"),o("../node_modules/core-js/modules/es.typed-array.some.js"),o("../node_modules/core-js/modules/es.typed-array.sort.js"),o("../node_modules/core-js/modules/es.typed-array.subarray.js"),o("../node_modules/core-js/modules/es.typed-array.to-locale-string.js"),o("../node_modules/core-js/modules/es.typed-array.to-string.js"),o("../node_modules/core-js/modules/es.object.assign.js"),o("../node_modules/core-js/modules/web.dom-collections.for-each.js");var s=function(){function e(e,t){this.left=0,this.top=0,this.width=0,this.height=0,this.display=!1,this.rangeMoveSelectionElement=document.createElement("div"),Object.assign(this,t),this.rangeMoveSelectionElement.classList.add("range-move-selection"),Object.assign(this.rangeMoveSelectionElement.style,{left:this.left+"px",top:this.top+"px",width:this.width+1+"px",height:this.height+1+"px",display:this.display?"block":"none"}),e.appendChild(this.rangeMoveSelectionElement)}return e.prototype.setProps=function(e){var t=this;["display","left","top","width","height"].forEach((function(o){void 0!==e[o]&&(t[o]=e[o])})),Object.assign(this.rangeMoveSelectionElement.style,{left:this.left+"px",top:this.top+"px",width:this.width+1+"px",height:this.height+1+"px",display:this.display?"block":"none"})},e}(),a=o("../spread-sheet/src/core/view/level-1/auto-scroll/AutoScroll.ts"),n=o("../spread-sheet/src/core/view/level-1/select-center/base/utils.ts"),r=function(){function e(e){var t=this;this.rangeMoveSelectionData={left:0,top:0,width:0,height:0,display:!1},this.board=document.createElement("div"),this.showing=!1,this.hasMoved=!1,this.colRange=new Uint32Array([0,0]),this.rowRange=new Uint32Array([0,0]),this.handleDown=function(){var e=t.selectData.select,o=t.rowcolAccessor.getColCount(),s=t.rowcolAccessor.getRowCount();if(e){var n=e.selectAll,r=e.selectRow,i=e.selectCol,l=e.selectCell;t.fromSelection=e,t.showing=!0;var d=0,c=0,u=0,h=0;n||(r?(d=t.areaData.getDisplayViewLeftByCol(0),c=t.areaData.getDisplayViewTopByRow(e.yRange[0]),u=t.areaData.getDisplayViewRightByCol(o-1),h=t.areaData.getDisplayViewBottomByRow(e.yRange[1])-c):i?(d=t.areaData.getDisplayViewLeftByCol(e.xRange[0]),c=t.areaData.getDisplayViewTopByRow(0),u=t.areaData.getDisplayViewRightByCol(e.xRange[1])-d,h=t.areaData.getDisplayViewBottomByRow(s-1)):l&&(d=t.areaData.getDisplayViewLeftByCol(e.xRange[0]),c=t.areaData.getDisplayViewTopByRow(e.yRange[0]),u=t.areaData.getDisplayViewRightByCol(e.xRange[1])-d,h=t.areaData.getDisplayViewBottomByRow(e.yRange[1])-c),Object.assign(t.rangeMoveSelectionData,{left:d,top:c,width:u,height:h,display:!0}),t.rangeMoveSelection.setProps(t.rangeMoveSelectionData),t.autoScroll.ready(a.OD.ALL),document.addEventListener("mousemove",t.handleMove),document.addEventListener("mouseup",t.handleUp))}},this.handleMove=function(){var e=t.fromSelection,o=e.selectRow,s=e.selectCol,a=e.selectCell,n=t.rowcolAccessor.getRowCount()-1,r=t.rowcolAccessor.getColCount()-1,i=0,l=0,d=0,c=0;if(t.hasMoved=!0,o){var u=t.getCalcTopAndBottomRow(e),h=u[0],_=u[1];i=t.areaData.getDisplayViewLeftByCol(0),l=t.areaData.getDisplayViewTopByRow(h),d=t.areaData.getDisplayViewRightByCol(r),c=t.areaData.getDisplayViewBottomByRow(_)-l,t.rowRange[0]=h,t.rowRange[1]=_}else if(s){var p=t.getCalcLeftAndRightCol(e),m=p[0],g=p[1];i=t.areaData.getDisplayViewLeftByCol(m),l=t.areaData.getDisplayViewTopByRow(0),d=t.areaData.getDisplayViewRightByCol(g)-i,c=t.areaData.getDisplayViewBottomByRow(n),t.colRange[0]=m,t.colRange[1]=g}else if(a){var f=t.getCalcTopAndBottomRow(e),w=f[0],v=f[1],y=t.getCalcLeftAndRightCol(e),R=y[0],C=y[1];i=t.areaData.getDisplayViewLeftByCol(R),l=t.areaData.getDisplayViewTopByRow(w),d=t.areaData.getDisplayViewRightByCol(C)-i,c=t.areaData.getDisplayViewBottomByRow(v)-l,t.rowRange[0]=w,t.rowRange[1]=v,t.colRange[0]=R,t.colRange[1]=C}Object.assign(t.rangeMoveSelectionData,{left:i,top:l,width:d,height:c}),t.rangeMoveSelection.setProps(t.rangeMoveSelectionData)},this.getCalcLeftAndRightCol=function(e){var o=t.operateData.currCol,s=t.getStartCol(e),a=e.xRange,n=a[1]-a[0],r=Math.abs(s-o),i=t.rowcolAccessor.getColCount()-1,l=t.isMoveToLeft(s,o)?Math.max(a[0]-r,0):Math.min(a[0]+r,i-n);return[l,l+n]},this.getStartCol=function(e){var o=e.xRange,s=t.operateData.startCol;return s<=o[1]&&s>=o[0]?s:Math.abs(s-o[0])>=Math.abs(s-o[1])?o[1]:o[0]},this.getCalcTopAndBottomRow=function(e){var o=t.operateData.currRow,s=t.getStartRow(e),a=t.isMoveToUp(s,o),n=e.yRange,r=n[1]-n[0],i=Math.abs(s-o),l=t.rowcolAccessor.getRowCount()-1,d=a?Math.max(n[0]-i,0):Math.min(n[0]+i,l-r);return[d,d+r]},this.getStartRow=function(e){var o=e.yRange,s=t.operateData.startRow;return s<=o[1]&&s>=o[0]?s:Math.abs(s-o[0])>=Math.abs(s-o[1])?o[1]:o[0]},this.handleUp=function(){var e=t.fromSelection,s=t.spreadsheetApp,a=t.rowcolAccessor,r=e.selectRow,i=e.selectCol,l=s.spreadsheet.activeSheet.getSheetId(),d=(0,n.UN)(l,a,[e])[0];if(document.removeEventListener("mousemove",t.handleMove),document.removeEventListener("mouseup",t.handleUp),t.rangeMoveSelectionData.display=!1,t.rangeMoveSelection.setProps(t.rangeMoveSelectionData),!t.hasMoved)return t.resetRange(),void(t.showing=!1);t.hasMoved=!1,t.updatedSelection(),t.resetRange(),t.toSelection=t.selectData.select,t.showing=!1;var c=(0,n.UN)(l,a,[t.toSelection])[0];d.equal(c)||s.requestApi.moveRange({fromRange:d,toRange:c,isSelectCell:!(i||r),sheetId:l}).catch((function(e){return o.g.log.error("MOVE_RANGE",e)}))},this.updatedSelection=function(){var e,o=t.fromSelection,s=o.selectAll,a=o.selectRow,n=o.selectCol,r=o.selectCell;s||(a?e={activation:{row:t.rowRange[0],col:0},yRange:[t.rowRange[0],t.rowRange[1]]}:n?e={activation:{row:0,col:t.colRange[0]},xRange:[t.colRange[0],t.colRange[1]]}:r&&(e={activation:{row:t.rowRange[0],col:t.colRange[0]},xRange:[t.colRange[0],t.colRange[1]],yRange:[t.rowRange[0],t.rowRange[1]]}),t.selectData.updateSelection(t.selectData.currentSelectIndex,e))},this.resetRange=function(){t.colRange[0]=0,t.colRange[1]=0,t.rowRange[0]=0,t.rowRange[1]=0},this.isMoveToUp=function(e,t){return t-e<0},this.isMoveToLeft=function(e,t){return t-e<0},Object.assign(this,e),this.board.classList.add("range-move-board"),this.mainBoard.element.appendChild(this.board),this.rangeMoveSelection=new s(this.board,this.rangeMoveSelectionData);var r=this.selectionStage;[r.topLeft,r.topRight,r.bottomLeft,r.bottomRight].forEach((function(e){e.singleSelectionApi.rangeMoveDragger.onMouseDown(t.handleDown)}))}return e.prototype.getShowing=function(){return this.showing},e}()},"../spread-sheet/src/core/view/level-2/render-plugin/BaseRenderPlugin.ts":function(e,t,o){var s=o("../packages/lib/EventEmitter.ts");t.Z=function(e){this.emitter=new s.Z,this._alloyExcel=e.alloyExcel}},"../spread-sheet/src/core/view/level-2/render-plugin/utils.ts":function(e,t,o){o.d(t,{VD:function(){return i},Xf:function(){return n},jG:function(){return l},qp:function(){return d},t9:function(){return r}}),o("../node_modules/core-js/modules/es.regexp.exec.js"),o("../node_modules/core-js/modules/es.string.replace.js");var s=o("../spread-sheet/src/core/view/spreadsheet-view/model/VerticalAlign.ts"),a=o("../spread-sheet/src/core/view/config/default.ts"),n=2;function r(e,t,o,a,r){var i=e.getCellViewAtPosition(t,o);if(null===i)throw new Error("获取单元格异常");var l=0;switch(i.style.verticalAlign.value){case s.o.MIDDLE:l=(a-r)/2;break;case s.o.TOP:l=n;break;case s.o.BOTTOM:l=a-n-r}return l}function i(e,t){return t[0]<=e[0]&&e[0]<=t[0]+t[2]&&t[1]<=e[1]&&e[1]<=t[1]+t[3]}function l(e,t){return void 0===t&&(t=.8),t*((e||a.n5)/a.n5)}function d(e,t,o,a,n){if(!e)throw new Error("获取单元格异常");var r=n.width,i=n.height,l=(e.paddingLeft-r)/2,d=0;switch(e.style.verticalAlign.value){case s.o.MIDDLE:d=(t-i)/2;break;case s.o.TOP:d+i>t&&(d=1);break;case s.o.BOTTOM:d=t-i-1;break;default:console.error("Error")}return[o+l,a+d]}},"../spread-sheet/src/core/view/level-2/smart-drag/SmartDragBoard.pc.ts":function(e,t,o){o.r(t),o.d(t,{default:function(){return j}});var s=o("../node_modules/@babel/runtime/helpers/esm/createClass.js"),a=o("../node_modules/@babel/runtime/helpers/esm/assertThisInitialized.js"),n=o("../node_modules/@babel/runtime/helpers/esm/inheritsLoose.js"),r=(o("../node_modules/core-js/modules/es.object.assign.js"),o("../node_modules/core-js/modules/es.array.iterator.js"),o("../node_modules/core-js/modules/es.array-buffer.slice.js"),o("../node_modules/core-js/modules/es.object.to-string.js"),o("../node_modules/core-js/modules/es.typed-array.uint32-array.js"),o("../node_modules/core-js/modules/es.typed-array.copy-within.js"),o("../node_modules/core-js/modules/es.typed-array.every.js"),o("../node_modules/core-js/modules/es.typed-array.fill.js"),o("../node_modules/core-js/modules/es.typed-array.filter.js"),o("../node_modules/core-js/modules/es.typed-array.find.js"),o("../node_modules/core-js/modules/es.typed-array.find-index.js"),o("../node_modules/core-js/modules/es.typed-array.for-each.js"),o("../node_modules/core-js/modules/es.typed-array.includes.js"),o("../node_modules/core-js/modules/es.typed-array.index-of.js"),o("../node_modules/core-js/modules/es.typed-array.iterator.js"),o("../node_modules/core-js/modules/es.typed-array.join.js"),o("../node_modules/core-js/modules/es.typed-array.last-index-of.js"),o("../node_modules/core-js/modules/es.typed-array.map.js"),o("../node_modules/core-js/modules/es.typed-array.reduce.js"),o("../node_modules/core-js/modules/es.typed-array.reduce-right.js"),o("../node_modules/core-js/modules/es.typed-array.reverse.js"),o("../node_modules/core-js/modules/es.typed-array.set.js"),o("../node_modules/core-js/modules/es.typed-array.slice.js"),o("../node_modules/core-js/modules/es.typed-array.some.js"),o("../node_modules/core-js/modules/es.typed-array.sort.js"),o("../node_modules/core-js/modules/es.typed-array.subarray.js"),o("../node_modules/core-js/modules/es.typed-array.to-locale-string.js"),o("../node_modules/core-js/modules/es.typed-array.to-string.js"),o("../node_modules/core-js/modules/es.number.min-safe-integer.js"),o("../node_modules/core-js/modules/es.number.constructor.js"),o("../node_modules/core-js/modules/es.number.max-safe-integer.js"),o("../spread-sheet/src/core/view/level-1/select-center/base/utils.ts")),i=o("../packages/model/src/range/GridRange.ts"),l=o("../spread-sheet/src/core/utils/selection.ts"),d=o("../spread-sheet/src/core/behavior/index.ts"),c=o("../spread-sheet/src/core/feature/smartSelection/constant.ts"),u=function(){function e(e){this._colRange=new Uint32Array([0,0]),this._rowRange=new Uint32Array([0,0]),this._board=document.createElement("div"),this._selectionData={left:0,top:0,width:0,height:0,display:!1},this._minRow=0,this._minCol=0,this._maxRow=0,this._maxCol=0,this._spreadsheetApp=e.spreadsheetApp,this._mainBoard=e.mainBoard,this._areaData=e.areaData,this._selectData=e.selectData,this._rowcolAccessor=e.rowcolAccessor,this._modifySmartSelectionBroker=e.modifySmartSelectionBroker,this._operateData=e.operateData,this._board.classList.add("smart-selection-board"),this._mainBoard.element.appendChild(this._board)}var t=e.prototype;return t._down=function(e,t){this._rowRange[0]=t[0],this._minRow=t[0],this._colRange[0]=e[0],this._minCol=e[0],this._rowRange[1]=t[1],this._maxRow=t[1],this._colRange[1]=e[1],this._maxCol=e[1],this._selectionData.left=this._areaData.getDisplayViewLeftByCol(this._minCol),this._selectionData.top=this._areaData.getDisplayViewTopByRow(this._minRow),this._selectionData.width=this._areaData.getDisplayViewRightByCol(this._maxCol)-this._selectionData.left,this._selectionData.height=this._areaData.getDisplayViewBottomByRow(this._maxRow)-this._selectionData.top,this._selectionData.display=!0,this._selection.setProps(this._selectionData)},t._move=function(){var e=this._operateData.currRow,t=this._operateData.currCol;e===Number.MIN_SAFE_INTEGER||-1===e?e=this._areaData.getFirstRowInView():e===Number.MAX_SAFE_INTEGER&&(e=this._areaData.getLastRowInView()),t===Number.MIN_SAFE_INTEGER||-1===t?t=this._areaData.getFirstColInView():t===Number.MAX_SAFE_INTEGER&&(t=this._areaData.getLastColInView()),this._colRange[0]=Math.min(this._minCol,t),this._colRange[1]=Math.max(this._maxCol,t),this._rowRange[0]=Math.min(this._minRow,e),this._rowRange[1]=Math.max(this._maxRow,e),this._rowRange[1]-this._rowRange[0]-(this._maxRow-this._minRow)>=this._colRange[1]-this._colRange[0]-(this._maxCol-this._minCol)?(this._colRange[0]=this._minCol,this._colRange[1]=this._maxCol):(this._rowRange[0]=this._minRow,this._rowRange[1]=this._maxRow),this._selectionData.left=this._areaData.getDisplayViewLeftByCol(this._colRange[0]),this._selectionData.top=this._areaData.getDisplayViewTopByRow(this._rowRange[0]),this._selectionData.width=this._areaData.getDisplayViewRightByCol(this._colRange[1])-this._selectionData.left,this._selectionData.height=this._areaData.getDisplayViewBottomByRow(this._rowRange[1])-this._selectionData.top,this._selection.setProps(this._selectionData)},t._up=function(){var e;this._selectionData.display=!1,this._selection.setProps(this._selectionData);var t=this._getDirection();if(t){this._modifySmartSelectionBroker.calc({direction:t,oldCells:this._getOldCells(),newCells:this._getNewCells(),isCtrl:this._operateData.e.metaKey});try{this._selectData.updateSelection(this._selectData.currentSelectIndex,{xRange:[this._colRange[0],this._colRange[1]],yRange:[this._rowRange[0],this._rowRange[1]]})}catch(s){null===(e=o.g.log)||void 0===e||e.error("BaseSmartDragBoard Error",s)}}},t._update=function(){this._selectionData.left=this._areaData.getDisplayViewLeftByCol(this._colRange[0]),this._selectionData.top=this._areaData.getDisplayViewTopByRow(this._rowRange[0]),this._selectionData.width=this._areaData.getDisplayViewRightByCol(this._colRange[1])-this._selectionData.left,this._selectionData.height=this._areaData.getDisplayViewBottomByRow(this._rowRange[1])-this._selectionData.top,this._selection.setProps(this._selectionData)},t._smartFill=function(){var e,t,s,a=this._spreadsheetApp.spreadsheet.activeSheet,n=this._spreadsheetApp.spreadsheet.activeSheetId,r=new i.Z({sheetId:n,startColIndex:this._minCol,endColIndex:this._maxCol,startRowIndex:this._minRow,endRowIndex:this._maxRow});if(!(0,l.allBlank)(this._spreadsheetApp,r)){this._selectionData.display=!1,this._selection.setProps(this._selectionData);var u=d.Z.Utils.searchCloseDataArea(a,r).endRowIndex,h=(0,l.isRangeCellBlank)(this._spreadsheetApp,this._maxRow+1,this._minCol);e:for(var _=this._maxRow+1;_<=u;_++)for(var p=this._minCol;p<=this._maxCol;p++)if((0,l.isRangeCellBlank)(this._spreadsheetApp,_,p)!==h){u=_-1;break e}if(!(u<=this._maxRow)){this._colRange[0]=this._minCol,this._colRange[1]=this._maxCol,this._rowRange[0]=this._minRow,this._rowRange[1]=u,this._modifySmartSelectionBroker.calc({direction:c.eG.BOTTOM,oldCells:this._getOldCells(),newCells:this._getNewCells(),isCtrl:null!==(t=null===(e=this._operateData.e)||void 0===e?void 0:e.metaKey)&&void 0!==t&&t});try{this._selectData.updateSelection(this._selectData.currentSelectIndex,{xRange:[this._colRange[0],this._colRange[1]],yRange:[this._rowRange[0],this._rowRange[1]]})}catch(m){null===(s=o.g.log)||void 0===s||s.error("BaseSmartDragBoard Error",m)}}}},t._getDirection=function(){return this._colRange[0]<this._minCol?c.eG.LEFT:this._colRange[1]>this._maxCol?c.eG.RIGHT:this._rowRange[0]<this._minRow?c.eG.TOP:this._rowRange[1]>this._maxRow?c.eG.BOTTOM:""},t._getOldCells=function(){var e=[],t=this._selectData.select;if(!t)throw new Error("智能拖拽选区异常");for(var o=(0,r.yW)(this._rowcolAccessor,[t])[0],s=o.xRange,a=o.yRange,n=a[0];n<=a[1];n++)for(var i=s[0];i<=s[1];i++)e.push([i,n]);return e},t._getNewCells=function(){var e=this._selectData.select;if(!e)throw new Error("智能拖拽选区异常");var t=(0,r.yW)(this._rowcolAccessor,[e])[0],o=[],s=[this._colRange[0],this._colRange[1]],a=[this._rowRange[0],this._rowRange[1]];switch(this._getDirection()){case"left":s[1]=t.xRange[0]-1;break;case"right":s[0]=t.xRange[1]+1;break;case"top":a[1]=t.yRange[0]-1;break;case"bottom":a[0]=t.yRange[1]+1;break;default:throw new Error("智能拖拽选区异常")}for(var n=a[0];n<=a[1];n++)for(var i=s[0];i<=s[1];i++)o.push([i,n]);return o},e}(),h=function(e){function t(){return e.apply(this,arguments)||this}return(0,n.Z)(t,e),t}(function(){function e(e,t){this._propLeft=0,this._propTop=0,this._propWidth=0,this._propHeight=0,this._propDisplay=!1,this._element=document.createElement("div"),this._propLeft=t.left,this._propTop=t.top,this._propWidth=t.width,this._propHeight=t.height,this._propDisplay=t.display,this._element.classList.add("smart-selection"),Object.assign(this._element.style,{left:this._propLeft+"px",top:this._propTop+"px",width:this._propWidth+1+"px",height:this._propHeight+1+"px",display:this._propDisplay?"block":"none"}),e.appendChild(this._element)}return e.prototype.setProps=function(e){void 0!==e.display&&(this._propDisplay=e.display),void 0!==e.left&&(this._propLeft=e.left),void 0!==e.top&&(this._propTop=e.top),void 0!==e.width&&(this._propWidth=e.width),void 0!==e.height&&(this._propHeight=e.height),Object.assign(this._element.style,{left:this._propLeft+"px",top:this._propTop+"px",width:this._propWidth+1+"px",height:this._propHeight+1+"px",display:this._propDisplay?"block":"none"})},e}()),_=h,p=(o("../node_modules/core-js/modules/es.array.map.js"),o("../node_modules/regenerator-runtime/runtime.js"),o("../node_modules/core-js/modules/es.promise.js"),o("../node_modules/core-js/modules/es.function.name.js"),o("../spread-sheet/src/core/view/utils/base-func.ts")),m=o("../node_modules/@tencent/containerized/build/main/index.js"),g=o("../packages/lib/dom.ts"),f=function(e,t,o,s){return new(o||(o=Promise))((function(a,n){function r(e){try{l(s.next(e))}catch(t){n(t)}}function i(e){try{l(s.throw(e))}catch(t){n(t)}}function l(e){var t;e.done?a(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(r,i)}l((s=s.apply(e,t||[])).next())}))},w=function(e){function t(t){var o;return(o=e.call(this)||this)._board=document.createElement("div"),o._container=t.container,o._board.setAttribute("tabindex","4"),o._board.classList.add("smart-context-menu"),o._board.dataset.testid="smart-context-menu",o._register((0,g.L)(o._board,"wheel",p.UW)),o}(0,n.Z)(t,e);var o=t.prototype;return o.show=function(e,t,o){this._show(o),Object.assign(this._board.style,{left:e+"px",top:t+"px"}),this._container.contains(this._board)||this._container.appendChild(this._board)},o.hide=function(){this._hide(),this._container.contains(this._board)&&this._container.removeChild(this._board),this._clickDisposable&&this._clickDisposable.dispose(),this._board.onblur=null},o.dispose=function(){e.prototype.dispose.call(this),this.hide()},o._getBox=function(e){var t=this,o=document.createElement("div");return o.classList.add("smart-menu-item"),o.innerText=e.name,this._clickDisposable.add((0,g.L)(o,"click",(function(){return f(t,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.callback();case 2:this.hide();case 3:case"end":return t.stop()}}),t,this)})))}))),o},o._show=function(e){this._clickDisposable=new m.SL,this._board.innerHTML="";for(var t=0;t<e.length;t++){var o=e[t];this._board.appendChild(this._getBox(o))}},o._hide=function(){},t}(m.JT),v=o("../spread-sheet/src/core/view/spreadsheet-view/utils.ts"),y=function(e){function t(t){var o;return(o=e.call(this)||this)._menus=[],o._menuShowing=!1,o._board=document.createElement("div"),o._hide=function(){o._menus=[],o._smartMenu.hide()},o._showMenu=function(){o._menuShowing||(o._modifySelectionDisposable=o._normalSelectData.onModifySelectData(o._hideMenu)),o._menuUpdate(),o._menuShowing=!0},o._menuUpdate=function(){var e=o.getMenuPosition(),t=e.left,s=e.top;o._smartMenu.show(t,s,o._menus)},o.getMenuPosition=function(){var e=o._board.getBoundingClientRect(),t=32*o._menus.length+12,s=o._clientRect.height-o._headSize.displayColHeadHeight-(o._top+e.height)>t?o._top+e.height:o._top-t;return{left:o._left+140-o._container.offsetWidth>0?o._left-140+36:o._left,top:s}},o._hideMenu=function(){o._menuShowing&&(o._smartMenu.hide(),o._menuShowing=!1,o._modifySelectionDisposable.dispose())},o._update=function(e,t){var s=o._calcPosition(e,t),a=s[0],n=s[1],r=s[2],i=s[3];o._board.style.left=a+5+r+"px",o._board.style.top=n+5+i+"px",o._left=a+5+r,o._top=n+5+i},o._container=t.container,o._inputManager=t.inputManager,o._areaData=t.areaData,o._rowcolAccessor=t.rowcolAccessor,o._scale=t.scale,o._tableView=t.tableView,o._clientRect=t.clientRect,o._headSize=t.headSize,o._normalSelectData=t.normalSelectData,o._smartMenu=o._register(new w({container:o._container})),o._board.classList.add("smart-btn"),o._board.dataset.testid="smart-btn",o._container.appendChild(o._board),o._register((0,m.OF)((function(){o._container.removeChild(o._board)}),"remove SmartBtn")),o._register((0,g.L)(o._board,"mousedown",(function(e){e.stopPropagation(),o._menuShowing?o._hideMenu():o._showMenu()}))),o._register((0,g.L)(o._board,"touchstart",(function(e){e.stopPropagation(),e.preventDefault(),o._menuShowing?o._hideMenu():o._showMenu()}))),o}(0,n.Z)(t,e);var o=t.prototype;return o.show=function(e,t,o,s){var a=this;this._show(e,t),this._menus=o.map((function(e){return Object.assign(Object.assign({},e),{callback:function(){e.callback(),a._menuShowing=!1}})})),s&&this._register(s)},o.hide=function(){this._hide()},o.refresh=function(){this._hide()},o._show=function(e,t){var o=this;this._update(e,t),this._board.style.display="block",this._register((0,m.OF)((function(){o._hide()})))},o._calcPosition=function(e,t){var o=this._areaData.getDisplayViewLeftByCol(t),s=this._areaData.getDisplayViewTopByRow(e),a=(0,v.o)(this._rowcolAccessor,this._tableView.getCellViewAtPosition(e,t),t)*this._scale.scale,n=(0,v.E)(this._rowcolAccessor,this._tableView.getCellViewAtPosition(e,t),e)*this._scale.scale,r=s+n+28+5>this._clientRect.height-this._headSize.displayColHeadHeight,i=o+a+36+5>this._container.offsetWidth;return r&&i?[o-(46+a),s-38,a,n]:r?[o,s-38,a,n]:i?[o-46,s,a,n]:[o,s,a,n]},t}(m.Cv),R=o("../packages/report/src/index.ts"),C=o("../spread-sheet/src/core/utils/index.ts"),D=o("../node_modules/i18next/dist/esm/i18next.js"),I=o("../node_modules/@tencent/dui/lib/components/Snackbar/index.js"),A=o("../spread-sheet/src/core/view/level-1/auto-scroll/AutoScroll.ts"),T=o("../packages/lib/index.ts"),j=function(e){function t(t){var o;(o=e.call(this,t)||this)._showing=!1,o.hideButton=function(){var e;o._button&&(null===(e=o._button)||void 0===e||e.dispose(),o._button=null)},o._handleDown=function(t){t.stopPropagation();var s=o._selectData.select;if(!s||s.selectAll)throw new Error("智能拖拽异常");if(s.selectCell||!C.Z.selection.selectionHasCrossMergeCell(o._spreadsheetApp)){o._showing=!0;var n=o._spreadsheetApp.view.getSheetLocation(),r=s.xRange,i=s.yRange;s.selectRow&&(r=n.xRange),s.selectCol&&(i=n.yRange),e.prototype._down.call((0,a.Z)(o),r,i),o._autoScroll.ready(A.OD.ALL),document.addEventListener("mousemove",o._handleMove),document.addEventListener("mouseup",o._handleUp),R.ZP.tdwReport({module:"doc_excel_editor",opername:"excel_fill",action:"fill_option"})}else I.default.show({type:"info",message:D.ZP.t("您要自动填充的范围不能与合并单元格局部重叠"),duration:3e3,zIndex:99999})},o._handleMove=function(){e.prototype._move.call((0,a.Z)(o))},o._handleUp=function(){document.removeEventListener("mousemove",o._handleMove),document.removeEventListener("mouseup",o._handleUp),o._showing=!1,e.prototype._up.call((0,a.Z)(o))},o._handleDblClick=function(){e.prototype._smartFill.call((0,a.Z)(o))},o._dependcy=t,o._selection=new _(o._board,o._selectionData),o._selectionStage=t.selectionStage,o._autoScroll=t.autoScroll;for(var s=0,n=[o._selectionStage.topLeft,o._selectionStage.topRight,o._selectionStage.bottomLeft,o._selectionStage.bottomRight];s<n.length;s++){var r=n[s];r.singleSelectionApi.getSmartCorner().onClick(o._handleDown),r.singleSelectionApi.getSmartCorner().onDoubleClick(o._handleDblClick)}return o}(0,n.Z)(t,e);var o=t.prototype;return o.showButton=function(e,t,o){if(this._button&&this.hideButton(),!this._button){this._button=new y(Object.assign(Object.assign({},this._dependcy),{container:this._mainBoard.element,normalSelectData:this._dependcy.selectData}));var s=this.addHideButtonListener();this._button.show(e,t,o,s)}},o.close=function(){},o.refresh=function(){var e;null===(e=this._button)||void 0===e||e.refresh()},o.addHideButtonListener=function(){var e,t=this,o=this._dependcy,s=o.inputManager,a=o.selectData;return T.ju.once(a.onModifySelectData)((function(){e=a.onModifySelectData(t.hideButton)})),s.emitter.on(s.EVENT.ENTER_INPUT,this.hideButton),(0,m.OF)((function(){null===e||void 0===e||e.dispose(),s.emitter.off(s.EVENT.ENTER_INPUT,t.hideButton)}),"addHideButtonListener")},(0,s.Z)(t,[{key:"showing",get:function(){return this._showing}}]),t}(u)},"../spread-sheet/src/core/view/level-2/temp/InputSmartSplit.pc.ts":function(e,t,o){o.r(t);var s=o("../packages/report/src/index.ts");t.default=function(e){var t=this;this._handleInputPaste=function(e){if(!t.isFeatureNotLoad()){var o=t._spreadsheetApp.feature.copyPasteBase;if(null===o||void 0===o?void 0:o.needCheckSmartSplit(t._spreadsheetApp)){var a=o.needCheckSmartSplit(t._spreadsheetApp,!0);o.getResultSP(e,(function(e){o.showToastSP(t._spreadsheetApp,(function(){t._spreadsheetApp.view.canvas.inputManager.handleExitInput(),o.doSmartSplit(e,t._spreadsheetApp),a&&s.ZP.tdwReport({opername:"doc_excel_editor",module:"excel_paste_split",action:"new_sheet_trigger"})}))})),s.ZP.tdwReport({opername:"doc_excel_editor",module:"excel_paste_split",action:"input_trigger"})}}},this.isFeatureNotLoad=function(){return!t._spreadsheetApp.feature&&(o.g.snackLoading.showWithAutoHide(1e3),!0)},this._spreadsheetApp=e.spreadsheetApp,this._spreadsheetApp.view.canvas.inputManager.alloyRTE.emitter.on(this._spreadsheetApp.view.canvas.inputManager.alloyRTE.EVENT.ON_PASTE,this._handleInputPaste)}}}]),window.jsExecEndTimeStamp=Date.now(),window.cachedPerformanceEntries||(window.cachedPerformanceEntries=[]),window.cachedPerformanceEntries.push({name:"jsExec: js/bundle_view_level2_edit_lazy_module1.233bcd2c0c32f3701143.js",entryType:"jsExec",startTime:window.jsExecStartTimeStamp,endTime:window.jsExecEndTimeStamp});
//# sourceMappingURL=bundle_view_level2_edit_lazy_module1.233bcd2c0c32f3701143.js.map