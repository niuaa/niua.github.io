self.window=self,window.jsExecStartTimeStamp=Date.now(),(self.webpackChunk_tencent_alloy_builder=self.webpackChunk_tencent_alloy_builder||[]).push([["spread-sheet_src_core_workbench_common_base-drawer_tsx-spread-sheet_src_external_rangeAuth_ut-2939e0"],{"../spread-sheet/src/core/network/message-center/utils/report.ts":function(e,t,o){o.d(t,{CL:function(){return l},ND:function(){return r},qB:function(){return i}}),o("../node_modules/core-js/modules/es.object.assign.js");var a=o("../packages/report/src/index.ts"),n=o("../spread-sheet/src/base/config/report.ts"),i={101:33612294,102:33612295,103:33612296,104:33612297,105:33612298,106:33612299,1e4:33612314,10001:33612323,4e4:33612311,40001:33612312,40002:33612315,40003:33612316,40004:35508627,40005:33612317,40006:33712774,40020:33612313,40021:33612318,40022:33612319,40023:33612320,40024:33688491,40025:33688492,40026:33688493,40027:33713210,40028:33688494,40029:34872598,40030:34872599,40031:35508628,40032:35508629,40033:35508630,40034:34786084,40035:34642726,40036:34846274,40037:34884339,40100:34872600,40203:35183585,41001:33612321,41002:33612322,40200:35508632,40204:35508633,40205:35508634,60007:33612290,60018:33612308,60019:33612309,60020:33612310,6e4:33712329,60002:33612280,60003:33612286,60004:33612281,60005:33612282,60006:33713563,60008:33612287,60010:33686978,60011:33612283,60013:33612284,60014:33612285,60015:33612291,60016:33612288,60017:33612289,60021:33631110,60022:33631111,60030:35454579,60031:35463395,60032:35463396,60033:35463397},r=Object.assign(Object.assign({},i),{40203:35183586}),l={socketShutdown:function(e){60010!==e&&"INACTIVE"!==e&&a.ZP.zzsStatus({attrid:n.ZZS_REPORT_ATTR.SOCKET_SHUTDOWN,status:1,dimensions:e})}}},"../spread-sheet/src/core/workbench/common/base-drawer.tsx":function(e,t,o){o("../node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),o("../node_modules/core-js/modules/esnext.reflect.metadata.js"),o("../node_modules/core-js/modules/es.object.assign.js");var a,n,i,r,l=o("react"),s=o.n(l),u=o("../node_modules/@tencent/workbench/lib/esm/services/drawer/drawer-service.js"),d=o("../node_modules/@tencent/workbench/lib/esm/services/store/builtin-state.js"),c=o("../node_modules/@tencent/ioc/lib/esm/index.js"),_=o("../node_modules/@tencent/workbench/lib/esm/services/store/state-manager.js"),E=o("../node_modules/@tencent/workbench/lib/esm/services/event-emitter/event-emitter.js"),T=o("../spread-sheet/src/base/event/event.ts"),p=(o("../spread-sheet/src/core/view/config/default.ts"),o("../spread-sheet/src/core/app/SpreadsheetApp.interface.ts")),m=function(e,t,o,a){var n,i=arguments.length,r=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,o):a;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,o,a);else for(var l=e.length-1;l>=0;l--)(n=e[l])&&(r=(i<3?n(r):i>3?n(t,o,r):n(t,o))||r);return i>3&&r&&Object.defineProperty(t,o,r),r},R=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},f=function(e,t){return function(o,a){t(o,a,e)}},O=function(e,t){var o=this;this.app=e,this.drawerId=t,this.drawerMode=u.$t.FLOAT,this.drawerStyle={},this.openDrawer=function(e){o.beforeOpenDrawer()&&(e&&(o.config=e),T.ZP.default.trigger("showWorkbenchSidePanel"),o.drawerService.showRightDrawer({type:"transparent",animation:"fadeIn",content:s().createElement("div",{id:o.drawerId,style:{height:"100%"},"data-testid":o.drawerId},o.getContent()),style:o.getDrawerStyle(),onOpen:function(){o.isDrawerOpen=!0,o.afterOpenDrawer(),o.drawerService.setRightDrawerMode(o.drawerMode)},onClose:function(){o.isDrawerOpen=!1,o.afterCloseDrawer()}}),o.drawerService.updateRightDrawerStyle({zIndex:1501}))},this.closeDrawer=function(){o.beforeCloseDrawer()&&o.drawerService.closeRightDrawer()},this.toggleDrawer=function(e){return o.isDrawerOpen?o.closeDrawer():o.openDrawer(e)},this.showDrawer=function(){o.isDrawerOpen&&(o.drawerService.updateRightDrawerStyle({display:"block",zIndex:1501}),o.stateManager.update(d.j.RightDrawerOpened,!0))},this.hideDrawer=function(){o.isDrawerOpen&&(o.drawerService.updateRightDrawerStyle({display:"none"}),o.stateManager.update(d.j.RightDrawerOpened,!1),o.stateManager.update(d.j.EditorZoneMarginRight,0),o.eventEmitter.emit("$editorZoneResize"))},this.getContent=function(){return null},this.beforeOpenDrawer=function(){return!0},this.beforeCloseDrawer=function(){return!0},this.afterOpenDrawer=function(){},this.afterCloseDrawer=function(){},this.getDrawerStyle=function(){return Object.assign({paddingTop:0,borderLeft:"1px solid rgba(0, 0, 0, 0.06)",backgroundColor:"#ffffff",width:"280px",top:0},o.drawerStyle)}};m([(0,c.tB)(),R("design:type","function"===typeof(a="undefined"!==typeof _.O&&_.O)?a:Object)],O.prototype,"stateManager",void 0),m([(0,c.tB)(),R("design:type","function"===typeof(n="undefined"!==typeof u.zv&&u.zv)?n:Object)],O.prototype,"drawerService",void 0),m([(0,c.tB)(),R("design:type","function"===typeof(i="undefined"!==typeof E.v&&E.v)?i:Object)],O.prototype,"eventEmitter",void 0),O=m([f(0,p.m),R("design:paramtypes",["function"===typeof(r="undefined"!==typeof p.m&&p.m)?r:Object,String])],O),t.Z=O},"../spread-sheet/src/external/rangeAuth/config/auth-constant.ts":function(e,t,o){o.d(t,{M:function(){return n},N7:function(){return r},Zx:function(){return s},jV:function(){return l},mA:function(){return i},mP:function(){return d},oI:function(){return a},q9:function(){return u}}),o("../spread-sheet/src/base/util/domain-config.ts");var a,n,i,r,l,s=[[],[!1,!1,!1],[!1,!1,!0]],u=[[],[!1,!0,!0],[!1,!0,!0]];!function(e){e[e.ONLY_I_CAN_EDIT=1]="ONLY_I_CAN_EDIT",e[e.SOME_CAN_EDIT=2]="SOME_CAN_EDIT"}(a||(a={})),function(e){e[e.NO_SET=0]="NO_SET",e[e.CAN_READ=1]="CAN_READ",e[e.CAN_EDIT=2]="CAN_EDIT"}(n||(n={})),function(e){e[e.CAN_VIEW=1]="CAN_VIEW",e[e.CAN_NOT_VIEW=2]="CAN_NOT_VIEW"}(i||(i={})),function(e){e[e.ONLY_RANGE_AUTH=1]="ONLY_RANGE_AUTH",e[e.SHEET_AUTH_AND_RANGE_AUTH=2]="SHEET_AUTH_AND_RANGE_AUTH"}(r||(r={})),function(e){e[e.SELF=0]="SELF",e[e.COOPERATION=1]="COOPERATION",e[e.VIEWABLE=2]="VIEWABLE",e[e.EDITBLE=3]="EDITBLE"}(l||(l={}));var d={USER_ONLY_VIEW:1,USER_CAN_EDIT:2}},"../spread-sheet/src/external/rangeAuth/util/range-auth-error-util.ts":function(e,t,o){o.d(t,{J3:function(){return u},ZO:function(){return d},f$:function(){return c}}),o("../node_modules/regenerator-runtime/runtime.js"),o("../node_modules/core-js/modules/es.object.to-string.js"),o("../node_modules/core-js/modules/es.promise.js"),o("../node_modules/core-js/modules/es.array.iterator.js"),o("../node_modules/core-js/modules/es.string.iterator.js"),o("../node_modules/core-js/modules/web.dom-collections.iterator.js");var a=o("../node_modules/i18next/dist/esm/i18next.js"),n=o("../node_modules/lodash/throttle.js"),i=o.n(n),r=o("../packages/report/src/index.ts"),l=function(e,t,o,a){return new(o||(o=Promise))((function(n,i){function r(e){try{s(a.next(e))}catch(t){i(t)}}function l(e){try{s(a.throw(e))}catch(t){i(t)}}function s(e){var t;e.done?n(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(r,l)}s((a=a.apply(e,t||[])).next())}))},s=function(){return l(void 0,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=3,Promise.resolve().then(o.bind(o,"../node_modules/@tencent/dui/lib/components/Snackbar/index.js"));case 3:case 6:return e.abrupt("return",e.sent);case 4:return e.next=6,Promise.resolve().then(o.bind(o,"../node_modules/@tencent/dui-mobile/lib/components/Snackbar/index.js"));case 7:case"end":return e.stop()}}),e)})))};function u(e){return l(this,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,s();case 2:t.sent.default.show({type:"error",message:e,autoClose:!0,style:{zIndex:10004}});case 4:case"end":return t.stop()}}),t)})))}var d=i()((function(){return l(void 0,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,l(void 0,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=3,Promise.resolve().then(o.bind(o,"../node_modules/@tencent/dui/lib/components/Modal/index.js"));case 3:case 6:return e.abrupt("return",e.sent);case 4:return e.next=6,Promise.resolve().then(o.bind(o,"../node_modules/@tencent/dui-mobile/lib/components/Modal/index.js"));case 7:case"end":return e.stop()}}),e)})));case 2:e.sent.default.confirm({title:a.ZP.t("保护范围提示"),content:a.ZP.t("此范围已被保护。如需编辑，请联系创建者「{{value}}」授予权限。",{value:window.clientVars.ownerNick}),cancelText:null,okText:a.ZP.t("确定")}),r.ZP.kvrOss({itemname:"xls_rangeprotect_range_viewer_toast"});case 5:case"end":return e.stop()}}),e)})))}),300,{leading:!0,trailing:!1}),c=i()((function(e){return l(void 0,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,s();case 2:t.sent.default.show({type:"info",message:e,autoClose:!0,style:{zIndex:10004}});case 4:case"end":return t.stop()}}),t)})))}),300,{leading:!0,trailing:!1})},"../spread-sheet/src/external/rangeAuth/util/range-auth-request-util.ts":function(e,t,o){o.d(t,{MQ:function(){return u},r2:function(){return R},ng:function(){return _},Fs:function(){return d},Vu:function(){return p},Sh:function(){return T},QQ:function(){return m}}),o("../node_modules/core-js/modules/es.regexp.exec.js"),o("../node_modules/core-js/modules/es.string.replace.js"),o("../node_modules/core-js/modules/es.object.to-string.js"),o("../node_modules/core-js/modules/es.regexp.to-string.js"),o("../node_modules/core-js/modules/es.promise.js"),o("../node_modules/core-js/modules/es.array.map.js");var a=o("../node_modules/i18next/dist/esm/i18next.js"),n=o("../spread-sheet/src/core/app/tool.ts"),i=o("../spread-sheet/src/external/rangeAuth/config/auth-constant.ts");o("../node_modules/core-js/modules/web.dom-collections.for-each.js");var r=o("../spread-sheet/src/base/util/object.ts"),l=o("../spread-sheet/src/core/data/configService/spreadConfig.ts"),s=o("../spread-sheet/src/base/util/appConfig.ts");function u(){return l.q.getConfig("domainId")}function d(){var e=(new Date).getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(t){var o=(e+16*Math.random())%16|0;return e=Math.floor(e/16),("x"===t?o:3&o|8).toString(16)}))}function c(e){var t,a;if("string"===typeof e)try{a=JSON.parse(e)}catch(n){null===(t=o.g.log)||void 0===t||t.error("rangeAuthRequestUtil.transitionData",null===n||void 0===n?void 0:n.stack),a={}}else a=e;return a}function _(e,t){return void 0===t&&(t=i.N7.ONLY_RANGE_AUTH),0===e.length?Promise.resolve({retcode:0,msg:"none",data:{localPadId:"",domain:"",padPolicy:i.jV.EDITBLE,protectedRangeList:[{rangePolicy:i.oI.ONLY_I_CAN_EDIT,rangeId:"0",setUid:"",setName:"",memlist:[]}]}}):new Promise((function(o,a){$.ajax({url:"//"+s.Z.getConfig("runtime.domainName")+"/cgi-go/range_priv/get_range_privilege",type:"POST",xhrFields:{withCredentials:!0},data:{localPadId:n.Z.window.clientVars.padId,type:t,domain:u(),rangeIdList:JSON.stringify(e),xsrf:n.Z.getXsrf()},success:function(e){var t;(t="string"===typeof e?JSON.parse(e):e).data.protectedRangeList&&0!==t.data.protectedRangeList.length||(t.data.protectedRangeList=[{rangePolicy:0,memlist:[]}]),o(t)},error:function(e){a(e)}})}))}var E=!1;function T(e,t){if(void 0===e&&(e=[]),!Array.isArray(e))return Promise.reject({msg:a.ZP.t("参数错误，请重试")});if(E)return Promise.reject({msg:a.ZP.t("正在设置中，请稍后～")});E=!0;var o=function(e){void 0===e&&(e=[]);var t=[],o="";return e.forEach((function(e){var a=[];e.addmemlist&&(a=e.addmemlist.map((function(e){return e.corp_id&&(o=e.corp_id),{uin:""+e.uin,rangePrivilegeType:e.rangePrivilegeType,isNew:e.isNew,workId:e.work_id||"",uintype:e.uintype||0,corpId:e.corp_id||""}})));var n=[];e.submemlist&&(n=e.submemlist.map((function(e){return e.corp_id&&(o=e.corp_id),{uin:""+e.uin,uintype:e.uintype||0}}))),t.push({rangeId:e.rangeId,rangePolicy:e.rangePolicy||0,rangeOtherPrivilegeType:e.rangeOtherPrivilegeType,addmemlist:a,submemlist:n,clear:e.clear})})),{filteredList:t,corpId:o}}(e),i=o.filteredList,l=o.corpId,_=e.map((function(e){return e.rangeId})),T={rangeSeq:d(),rangeAction:{rangeIdList:_}};return new Promise((function(e,o){$.ajax({url:"//"+s.Z.getConfig("runtime.domainName")+"/cgi-go/range_priv/set_range_privilege",type:"POST",xhrFields:{withCredentials:!0},data:{localPadId:n.Z.window.clientVars.padId,data:JSON.stringify(i),corpId:l,domain:u(),message:t?JSON.stringify(t):JSON.stringify(T),xsrf:n.Z.getXsrf()},success:function(t){var a=c(t);0===a.retcode?e(a):o(a),E=!1},error:function(e){var t=(0,r.deepClone)(e);E=!1;var n="";switch(t.retcode){case 10013:case 10018:n=a.ZP.t("添加的人不是好友");break;case 10014:n=a.ZP.t("成员列表超过限制数量");break;case 10015:n=a.ZP.t("单次添加的成员数量超过限制");break;case 10016:n=a.ZP.t("大表成员列表超过限制")}t.msg||(t.msg=n),o(t)}})}))}function p(){return new Promise((function(e,t){$.ajax({url:"//"+s.Z.getConfig("runtime.domainName")+"/cgi-bin/online_docs/auth_info/get",type:"POST",xhrFields:{withCredentials:!0},data:{localPadId:n.Z.window.clientVars.padId,domain:u(),type:1,ver:2,folderId:"",dataType:"",xsrf:n.Z.getXsrf()},success:function(o){var a=c(o);0===a.retcode?e(a):t(a)},error:function(e){t(e)}})}))}function m(e,t,a){var i;void 0===t&&(t=[]),void 0===a&&(a=[]);var r={seq:d(),action:1};try{"undefined"===typeof window.clientVars&&(window.clientVars={}),"undefined"===typeof window.clientVars.msgFilterData&&(window.clientVars.msgFilterData={}),window.clientVars.msgFilterData[r.seq]=r.action}catch(l){null===(i=o.g.log)||void 0===i||i.error("rangeAuthRequestUtil.setWorkbookAuth",null===l||void 0===l?void 0:l.stack)}return new Promise((function(o,i){$.ajax({url:"//"+s.Z.getConfig("runtime.domainName")+"/v2/privilege/set_user?xsrf="+n.Z.getXsrf(),type:"POST",xhrFields:{withCredentials:!0},contentType:"application/json",data:JSON.stringify({obj:{id:n.Z.window.clientVars.padId,type:2},policy:e,message:encodeURIComponent(JSON.stringify(r)),add:t,sub:a,xsrf:n.Z.getXsrf()}),success:function(e){var t=c(e);0===t.retcode?o(t):i(t)},error:function(e){i(e)}})}))}function R(e){if(n.Z.window.clientVars.ownerNick&&e)e(n.Z.window.clientVars.ownerNick);else{var t=l.q.getConfig("docInfo");(null===t||void 0===t?void 0:t.ownerName)&&(n.Z.window.clientVars.ownerNick=null===t||void 0===t?void 0:t.ownerName,n.Z.window.clientVars.ownerAvatar=null===t||void 0===t?void 0:t.ownerAvatar),null===e||void 0===e||e(null===t||void 0===t?void 0:t.ownerName)}}},"../spread-sheet/src/external/report/index.ts":function(e,t,o){o.r(t),o.d(t,{default:function(){return de},setCorpInfoToClientVars:function(){return se}});var a,n=o("../spread-sheet/src/base/index.ts"),i=o("../node_modules/@tencent/tencent-doc-report/libs/tencent-doc-report.es.js"),r=o("../node_modules/@tencent/jank-sdk/lib/index.js"),l=(o("../spread-sheet/src/base/util/domain-config.ts"),o("../node_modules/@babel/runtime/helpers/esm/toConsumableArray.js")),s=(o("../node_modules/core-js/modules/es.object.assign.js"),o("../node_modules/core-js/modules/es.object.to-string.js"),o("../node_modules/core-js/modules/es.regexp.to-string.js"),o("../node_modules/core-js/modules/es.string.starts-with.js"),o("../node_modules/core-js/modules/es.array.includes.js"),o("../node_modules/core-js/modules/es.number.constructor.js"),o("../node_modules/core-js/modules/es.array.concat.js"),o("../node_modules/core-js/modules/es.function.name.js"),o("../node_modules/core-js/modules/es.array.map.js"),o("../node_modules/core-js/modules/web.dom-collections.for-each.js"),o("../node_modules/core-js/modules/es.array.iterator.js"),o("../node_modules/core-js/modules/web.dom-collections.iterator.js"),o("../spread-sheet/src/core/behavior/index.ts")),u=o("../packages/report/src/index.ts"),d=o("../spread-sheet/src/external/report/alloyreport.ts"),c=o("../spread-sheet/src/core/data/configService/spreadConfig.ts"),_=o("../node_modules/@tencent/docs-user-agent/dist/index.js"),E=o.n(_),T=o("../packages/common-utils/src/index.ts"),p=o("../spread-sheet/src/core/network/message-center/utils/report.ts"),m=o("../spread-sheet/src/base/config/report.ts"),R=((a={})[m.CONFIG.MUTATION_JANK_NUMBER_FORMAT]=function(){return(0,d.ji)({level:d.y8.DEBUG,moduleValue:"mutation",actionValue:"numberFormatJank"})},a),f={SHEETS_BAR_JANK_SWITCH_SHEET:function(){return(0,d.ji)({level:d.y8.DEBUG,moduleValue:"sheetbar",actionValue:"switchSheetJank"})}},O=o("../spread-sheet/src/core/app/sheetSize.ts"),A=o("../spread-sheet/src/core/network/datacenter/utils/report.ts"),I=o("../spread-sheet/src/base/log/production-log.ts"),v=u.ZP.tdwReport;function g(e){var t=E().isMobilePhone||E().isAndroidPad?E().isAndroid?"Android":"IOS":"PC";e[t]&&N(e[t])}var S,N=u.ZP.monitor,P=u.ZP.tdwReport,D=u.ZP.resetDefaultTdwData,h=u.ZP.zzsStatus,V=Object.assign(Object.assign(Object.assign(Object.assign({},R),f),A.Nr),{CHECK_MUTATION_ERROR:function(e,t,o){var a=(0,m.getTdwObj3Value)(m.TDW_MODULE.MUTATION,e);(0,d.ji)({level:d.y8.DEBUG,moduleValue:m.TDW_MODULE.MUTATION,actionValue:m.TDW_ACTION.CHECK_MUTATION+"_"+m.TDW_VER5_VALUE.CHECK_MUTATION_ERROR,obj3Value:a,ver5Value:String(e.operationType),detail:[o,e,t,null===t||void 0===t?void 0:t.stack]}),(0,d.mC)({errorType:m.SENTRY_ERROR_TYPE.CHECK_MUTATION_ERROR,message:[o,e],error:t})},CHECK_MUTATION_RESULT_ERROR:function(e,t){var o,a=(0,m.getTdwObj3Value)(m.TDW_MODULE.MUTATION,e);switch(e.operationType){case s.Z.Mutation.MUTATION_OPERATION_TYPE.HISTORY:o=m.MONITOR_POINTS.CHECK_HISTORY_MUTATION_FAIL_MAP[e.id];break;case s.Z.Mutation.MUTATION_OPERATION_TYPE.LOCAL:o=m.MONITOR_POINTS.CHECK_LOCAL_MUTATION_FAIL_MAP[e.id];break;case s.Z.Mutation.MUTATION_OPERATION_TYPE.UNDO:o=m.MONITOR_POINTS.CHECK_UNDO_MUTATION_FAIL_MAP[e.id];break;case s.Z.Mutation.MUTATION_OPERATION_TYPE.REDO:o=m.MONITOR_POINTS.CHECK_REDO_MUTATION_FAIL_MAP[e.id];break;case s.Z.Mutation.MUTATION_OPERATION_TYPE.COLLAB:o=m.MONITOR_POINTS.CHECK_COLLAB_MUTATION_FAIL_MAP[e.id];break;default:o=35308327}N(o),N(m.MONITOR_POINTS.CHECK_MUTATION_FAIL_MAP[e.operationType]);var n,i=m.TDW_ACTION.CHECK_MUTATION+"-"+e.operationType;n=e.operationType===s.Z.Mutation.MUTATION_OPERATION_TYPE.HISTORY?void 0!==e.id?e.id.toString():"-1":void 0!==e.requestId?e.requestId.toString():"-1",(0,d.ji)({level:d.y8.DEBUG,moduleValue:m.TDW_MODULE.MUTATION,actionValue:i,obj3Value:a,ver5Value:n,detail:[t,e]}),e.operationType!==s.Z.Mutation.MUTATION_OPERATION_TYPE.HISTORY&&(0,d.mC)({errorType:m.SENTRY_ERROR_TYPE.CHECK_MUTATION_ERROR,message:[t,e]})},MERGE_GRID_RANGE_ERROR:function(e){N(m.MONITOR_POINTS.MERGE_GRID_RANGE_ERROR),(0,d.ji)({level:d.y8.DEBUG,moduleValue:m.TDW_MODULE.OPERATION,actionValue:m.TDW_ACTION.MERGE_GRID_RANGE_ERROR,detail:e})},RUN_MUTATION_ERROR:function(e,t){var o=(0,m.getTdwObj3Value)(m.TDW_MODULE.MUTATION,t);if(null===e||void 0===e?void 0:e.message.startsWith("ApiCheckError")){var a=d.y8.DEBUG,n=t.operationType===s.Z.Mutation.MUTATION_OPERATION_TYPE.HISTORY&&-1!==e.message.indexOf("合并单元格已经存在");n&&(a=d.y8.INFO),n||N(m.MONITOR_POINTS.CHECK_MUTATION_FAIL_MAP[t.operationType]),(0,d.ji)({level:a,moduleValue:m.TDW_MODULE.MUTATION,actionValue:m.TDW_ACTION.CHECK_MUTATION+"_"+m.TDW_VER5_VALUE.CHECK_MUTATION_FAIL,obj3Value:o,ver5Value:String(t.operationType),detail:[t,e,null===e||void 0===e?void 0:e.stack]}),n||t.operationType!==s.Z.Mutation.MUTATION_OPERATION_TYPE.HISTORY&&(0,d.mC)({errorType:m.SENTRY_ERROR_TYPE.CHECK_MUTATION_ERROR,message:t,error:e})}else N(m.MONITOR_POINTS.RUN_MUTATION_ERROR_MAP[t.operationType]),(0,d.ji)({level:d.y8.DEBUG,moduleValue:m.TDW_MODULE.MUTATION,actionValue:m.TDW_ACTION.RUN_MUTATION+"_"+m.TDW_VER5_VALUE.RUN_MUTATION_ERROR,obj3Value:o,ver5Value:String(t.operationType),detail:[t,e,null===e||void 0===e?void 0:e.stack]}),t.operationType!==s.Z.Mutation.MUTATION_OPERATION_TYPE.HISTORY&&(0,d.mC)({errorType:m.SENTRY_ERROR_TYPE.RUN_MUTATION_ERROR,message:t,error:e})},AFTER_MUTATION_RUN_CATCH_ERROR:function(e,t){var o=(0,m.getTdwObj3Value)(m.TDW_MODULE.MUTATION,t);N(33660169),(0,d.mC)({errorType:"afterMutationRunError",error:e}),(0,d.ji)({level:d.y8.DEBUG,moduleValue:"mutation",actionValue:"afterMutationRun",obj3Value:o,ver5Value:"1",detail:[t]})},AFTER_MUTATION_RUN_DATA_CHANGE_CATCH_ERROR:function(e,t){var o=(0,m.getTdwObj3Value)(m.TDW_MODULE.MUTATION,t);N(33660170),(0,d.ji)({level:d.y8.IMPORTANT,moduleValue:"mutation",actionValue:"afterMutationRunDataChange",obj3Value:o,ver5Value:"1",detail:[t,null===e||void 0===e?void 0:e.stack]})},COMMIT_EMPTY_MUTATION:function(e){(0,d.ji)({level:d.y8.INFO,moduleValue:"mutation",actionValue:"commitEmptyMutation",detail:e})},DO_BEHAVIOR_AFTER_SHUTDOWN:function(){N(34280469),(0,d.ji)({level:d.y8.DEBUG,moduleValue:"messageCenter",actionValue:"doBehaviorAfterShutDown",ver5Value:"1"})},COMMIT_MUTATION_CATCH_ERROR:function(e,t){(0,d.ji)({level:d.y8.IMPORTANT,moduleValue:"mutation",actionValue:"commitMutation",ver5Value:"1",detail:e}),(0,d.mC)({errorType:"SerializeMutationError",error:t})},COMMIT_MUTATION:function(e){N(33659447),(0,d.ji)({level:d.y8.IMPORTANT,moduleValue:"mutation",actionValue:"commitMutation",ver5Value:"2",detail:e})},CACHE_DATA_FLOW_COMMIT_MUTATION:function(e){N(33637651),(0,d.fV)({level:d.y8.IMPORTANT,moduleValue:"mutation",actionValue:"commitMutation",ver5Value:"0",detail:e})},PAGE_LOAD:function(e){N(33631971),P({module:"init",opername:"excel_dataflow",action:"pageLoaded",ver5:e})},DUPLICATE_SHEET_ID:function(e){N(33955439),(0,d.ji)({level:d.y8.DEBUG,moduleValue:"init",actionValue:"duplicateSheetId",ver5Value:"1",detail:e})},SERIALIZE_MUTATION:function(e,t){N(33611128),(0,d.mC)({errorType:"serializeMutationError",error:t}),(0,d.ji)({level:d.y8.DEBUG,moduleValue:"mutation",actionValue:"serializeMutation",ver5Value:"1",detail:e})},GET_COLLAB_MUTATIONS:function(e){N(33614885),(0,d.ji)({level:d.y8.DEBUG,moduleValue:"mutation",actionValue:"getCollabMutations",ver5Value:"1",detail:e})},CREATE_ZIPKETFRAME:function(e){(0,d.ji)({level:d.y8.DEBUG,moduleValue:"keyframe",actionValue:"createZipKeyframe",ver5Value:"1",detail:e})},APPLY_NEW_CHANGES_ERROR:function(e){(0,d.ji)({level:d.y8.DEBUG,moduleValue:"messageCenter",actionValue:"applyNewChangesError",detail:e})},LOAD_REQUEST:function(e){(0,d.ji)({level:d.y8.INFO,moduleValue:"loadRequest",actionValue:"local",detail:e})},APPLY_BEHAVIOR_ERROR:function(e,t){console.error(t),(0,d.mC)({errorType:"loadRequestError",message:"loadRequestError",error:t}),(0,d.ji)({level:d.y8.IMPORTANT,moduleValue:"applyBehavior",actionValue:"local",ver5Value:"1",detail:e})},APPLY_BEHAVIOR_CATCH_SCRIPT_ERROR:function(e,t,o){console.error(t),(0,d.mC)({errorType:"applyBehaviorScriptError",message:t.message,error:t}),(0,d.ji)({level:d.y8.IMPORTANT,moduleValue:"applyBehaviorScriptError",actionValue:o,ver5Value:"1",detail:e})},APPLY_BEHAVIOR_NOT_LOADED:function(e){(0,d.ji)({level:d.y8.IMPORTANT,moduleValue:"applyBehavior",actionValue:"local",ver5Value:"2",detail:e})},APPLY_BEHAVIOR_LEVEL_INFO:function(e){(0,d.ji)({level:d.y8.INFO,moduleValue:"applyBehavior",actionValue:"local",ver5Value:"3",detail:e})},APPLY_BEHAVIOR_LEVEL_IMPORTANT:function(e,t){void 0===t&&(t="4"),(0,d.ji)({level:d.y8.IMPORTANT,moduleValue:"applyBehavior",actionValue:"local",ver5Value:t,detail:e})},APPLY_BEHAVIOR_LEVEL_IMPORTANT_MONITOR:function(){N(33686607)},REQUEST_SIZE_OVER_LIMIT:function(e){(0,d.ji)({level:d.y8.INFO,moduleValue:"applyLocal",actionValue:"requestSizeOverLimit",detail:e})},FOLLOW_REQUEST_MUTATIONS:function(e){N(33641617),(0,d.ji)({level:d.y8.DEBUG,moduleValue:"mutation",actionValue:"followRequestMutations",ver5Value:"1",detail:e})},DESERIALIZE_MUTATION_FAIL:function(e){N(m.MONITOR_POINTS.DESERIALIZE_MUTATION_FAIL),(0,d.ji)({level:d.y8.DEBUG,moduleValue:m.TDW_MODULE.MUTATION,actionValue:m.TDW_ACTION.DESERIALIZE_MUTATION_FAIL,ver5Value:m.TDW_VER5_VALUE.DESERIALIZE_MUTATION_FAIL,detail:e})},DESERIALIZE_MUTATION_FAIL_OLD:function(e){N(m.MONITOR_POINTS.DESERIALIZE_MUTATION_FAIL_OLD),(0,d.ji)({level:d.y8.DEBUG,moduleValue:m.TDW_MODULE.MUTATION,actionValue:m.TDW_ACTION.DESERIALIZE_MUTATION_FAIL,ver5Value:m.TDW_VER5_VALUE.DESERIALIZE_MUTATION_FAIL_OLD,detail:e})},DESERIALIZE_MUTATION_CATCH_ERROR:function(e,t){console.error("Deserialize mutation error: ",e,t),N(m.MONITOR_POINTS.DESERIALIZE_MUTATION_ERROR),(0,d.ji)({level:d.y8.DEBUG,moduleValue:m.TDW_MODULE.MUTATION,actionValue:m.TDW_ACTION.DESERIALIZE_MUTATION_ERROR,ver5Value:m.TDW_VER5_VALUE.DESERIALIZE_MUTATION_ERROR,detail:e}),(0,d.mC)({errorType:m.SENTRY_ERROR_TYPE.DESERIALIZE_MUTATION_ERROR,message:e,error:t})},DESERIALIZE_MUTATION_CATCH_ERROR_OLD:function(e,t){N(m.MONITOR_POINTS.DESERIALIZE_MUTATION_ERROR_OLD),(0,d.ji)({level:d.y8.DEBUG,moduleValue:m.TDW_MODULE.MUTATION,actionValue:m.TDW_ACTION.DESERIALIZE_MUTATION_ERROR,ver5Value:m.TDW_VER5_VALUE.DESERIALIZE_MUTATION_ERROR_OLD,detail:e}),(0,d.mC)({errorType:m.SENTRY_ERROR_TYPE.DESERIALIZE_MUTATION_ERROR_OLD,message:e,error:t})},PASTE_DATA_GENERATE_MUTATION_1:function(){(0,d.ji)({level:d.y8.DEBUG,moduleValue:m.TDW_MODULE.MUTATION,actionValue:m.TDW_ACTION.PASTE_DATA_GENERATE_MUTATION,ver5Value:m.TDW_VER5_VALUE.PASTE_DATA_GENERATE_MUTATION_INSERT_ERROR_NO_OPTION,detail:["no opt"]})},PASTE_DATA_GENERATE_MUTATION_2:function(e){(0,d.ji)({level:d.y8.DEBUG,moduleValue:m.TDW_MODULE.MUTATION,actionValue:m.TDW_ACTION.PASTE_DATA_GENERATE_MUTATION,ver5Value:m.TDW_VER5_VALUE.PASTE_DATA_GENERATE_MUTATION_INSERT_ERROR_NO_EXPANSION,detail:e})},PASTE_DATA_GENERATE_MUTATION_3:function(e){(0,d.ji)({level:d.y8.DEBUG,moduleValue:m.TDW_MODULE.MUTATION,actionValue:m.TDW_ACTION.PASTE_DATA_GENERATE_MUTATION,ver5Value:m.TDW_VER5_VALUE.PASTE_DATA_GENERATE_MUTATION_SETRANGE_ERROR_NO_GRIDRANGE,detail:e})},DO_KEYFRAME_CATCH_ERROR_1:function(e,t){!o.g.isCloseAlloyReport&&N(33614378),(0,d.ji)({level:d.y8.IMPORTANT,moduleValue:"keyframe",actionValue:"doKeyframeError1",ver5Value:"1",detail:e}),(0,d.mC)({errorType:"doKeyframeErrorVersion3",error:t})},DO_KEYFRAME_CATCH_ERROR_2:function(e){!o.g.isCloseAlloyReport&&N(33614380),(0,d.ji)({level:d.y8.IMPORTANT,moduleValue:"keyframe",actionValue:"doKeyframeError2",ver5Value:"2",detail:e})},DO_KEYFRAME_CATCH_ERROR_3:function(e){!o.g.isCloseAlloyReport&&N(33614379),!o.g.isCloseAlloyReport&&N(33955111),(0,d.ji)({level:d.y8.IMPORTANT,moduleValue:"keyframe",actionValue:"doKeyframeError3",ver5Value:"3",detail:[e,null===e||void 0===e?void 0:e.stack]}),(0,d.mC)({errorType:"doKeyframeErrorNoVersion",error:e})},DO_KEYFRAME:function(e){N(33637702),(0,d.ji)({level:d.y8.IMPORTANT,moduleValue:"keyframe",actionValue:"doKeyframe0",ver5Value:"0",detail:e})},DO_MUTATIONS:function(e){N(33614886),(0,d.ji)({level:d.y8.DEBUG,moduleValue:"mutation",actionValue:"doMutations",ver5Value:"1"}),(0,d.mC)({errorType:"doMutationsError",message:e})},ZIP_KEYFRAME:function(){N(34364018),(0,d.ji)({level:d.y8.DEBUG,moduleValue:"keyframe",actionValue:"zip",ver5Value:"1"})},ZIP_KEYFRAME_CATCH_ERROR:function(e){N(34364008),(0,d.ji)({level:d.y8.DEBUG,moduleValue:"keyframe",actionValue:"zip",ver5Value:"2",detail:e})},COPY_PASTE:function(){(0,d.ji)({level:d.y8.INFO,moduleValue:"copyPaste",actionValue:"onPaste"})},CHOOSE_FORMAT_ERROR:function(e,t){console.warn(t),N(3437448),(0,d.ji)({level:d.y8.DEBUG,moduleValue:"numberFormat",actionValue:"chooseFormatError",detail:e})},PARSE_FORMAT_ERROR:function(e,t){console.warn(t),N(3437447),(0,d.ji)({level:d.y8.DEBUG,moduleValue:"numberFormat",actionValue:"parseFormatError",detail:e})},RETRY_SENDMESSAGE:function(e){(0,d.ji)({level:d.y8.INFO,moduleValue:"messageCenter",actionValue:"retrySendMessage",detail:e})},MOVE_MESSAGEINFO_COMMITING_QUEUE:function(e){(0,d.ji)({level:d.y8.INFO,moduleValue:"messageCenter",actionValue:"moveMessageIntoCommitingQueue",detail:e})},RETRY_COMMIT:function(e){(0,d.ji)({level:d.y8.INFO,moduleValue:"messageCenter",actionValue:"retryCommit",detail:e})},SEND_USERCHANGE:function(e,t){(0,d.ji)({level:d.y8.IMPORTANT,moduleValue:"messageCenter",actionValue:"sendUserChange",ver5Value:"1",obj3Value:String(null!==t&&void 0!==t?t:""),detail:e})},SEND_USERCHANGE_1:function(e,t){N(33639350),(0,d.fV)({level:d.y8.IMPORTANT,moduleValue:"messageCenter",actionValue:"sendUserChange",ver5Value:"0",obj3Value:String(null!==t&&void 0!==t?t:""),detail:e})},ACCEPT_COMMIT:function(e){N(33639758),(0,d.ji)({level:d.y8.IMPORTANT,moduleValue:"messageCenter",actionValue:"acceptCommit",ver5Value:"1",detail:e})},HANDLE_COMMIT_ERROR:function(e,t,o){[40001,40004,40021,40027,40024,40025,52003,60008,60010,60030,60031,60032,60033,60008,60015].includes(Number(t))||(h({attrid:m.ZZS_REPORT_ATTR.SOCKET_COMMIT_ERROR,status:1,dimensions:[o?"offlineMsg":"onlineMsg",t]}),I.$.report("SOCKET_COMMIT_ERROR"));var a=o?p.ND:p.qB;a[t]?(N(a[t]),(0,d.ji)({level:d.y8.IMPORTANT,moduleValue:"messageCenter",actionValue:"handleCommitError",ver5Value:t.toString(),detail:[].concat((0,l.Z)(e),[t.toString(),o])})):(N(33698546),(0,d.ji)({level:d.y8.IMPORTANT,moduleValue:"messageCenter",actionValue:"handleCommitError",ver5Value:"unKnownError",detail:[].concat((0,l.Z)(e),[t.toString()])}))},HANDLE_TASK_DUPLICATE:function(e){N(33612330),(0,d.ji)({level:d.y8.IMPORTANT,moduleValue:"messageCenter",actionValue:"handleTaskDuplicate",detail:e})},TASK_DUPLICATE_VERSION_TOO_LOW:function(e){N(34884808),(0,d.ji)({level:d.y8.IMPORTANT,moduleValue:"messageCenter",actionValue:"handleTaskDuplicateVersionTooLow",detail:e})},HANDLE_NEW_CHANGES:function(e){(0,d.ji)({level:d.y8.INFO,moduleValue:"messageCenter",actionValue:"handleNewChanges",detail:e})},COMMITING_QUEUE_BLOCK:function(e){N(33714439),(0,d.ji)({level:d.y8.DEBUG,moduleValue:"messageCenter",actionValue:"commitingQueueBlock",detail:e})},APPLY_NEWCHANGES_VERROR:function(e,t){var o={collab:"1",missing:"2"};o[t]&&(0,d.ji)({level:d.y8.DEBUG,moduleValue:"messageCenter",actionValue:"applyNewChangesVError",ver5Value:o[t],detail:e});var a={collab:33685595,missing:33685596};a[t]&&N(a[t])},DUPLICATE_MESSAGE:function(e){N(33629759),(0,d.ji)({level:d.y8.DEBUG,moduleValue:"messageCenter",actionValue:"DuplicateMessage",detail:e})},APPLY_NEWCHANGES_CATCH_ERROR:function(e){h({attrid:m.ZZS_REPORT_ATTR.APPLY_NEW_CHANGES_ERROR,status:1}),(0,d.ji)({level:d.y8.IMPORTANT,moduleValue:"messageCenter",actionValue:"applyNewChanges",ver5Value:"1",detail:e})},APPLY_NEWCHANGES:function(e){N(33638469),(0,d.ji)({level:d.y8.IMPORTANT,moduleValue:"messageCenter",actionValue:"applyNewChanges",ver5Value:"0",detail:e})},APPLY_NEWCHANGES_VERROR2:function(e){(0,d.ji)({level:d.y8.DEBUG,moduleValue:"messageCenter",actionValue:"applyNewChangesVError",ver5Value:"4",detail:e}),N(33707992)},APPLY_NEWCHANGES_VERROR5:function(e){(0,d.ji)({level:d.y8.INFO,moduleValue:"messageCenter",actionValue:"applyNewChangesVError",ver5Value:"5",detail:e}),N(33707990)},APPLY_NEWCHANGES_VERROR6:function(e){(0,d.ji)({level:d.y8.INFO,moduleValue:"messageCenter",actionValue:"applyNewChangesVError",ver5Value:"6",detail:e}),N(33707991)},SWITCH_CHANEL_STATUS:function(e){(0,d.ji)({level:d.y8.INFO,moduleValue:"messageCenter",actionValue:"switchChanelStatus",detail:e})},HANDLE_FETCH_RESULT:function(e){(0,d.ji)({level:d.y8.INFO,moduleValue:"messageCenter",actionValue:"handleFetchResult",detail:e})},FETCH_USERCHANGES_ERROR:function(e){(0,d.ji)({level:d.y8.DEBUG,moduleValue:"messageCenter",actionValue:"fetchUserChangesError",detail:e}),N(33633746)},FETCH_AND_APPLY_MISSCHANGES:function(e){(0,d.ji)({level:d.y8.INFO,moduleValue:"messageCenter",actionValue:"fetchAndApplyMisschanges",detail:e})},EMPTY_KEYFRAME_BY_AUTOEXPAND:function(e){(0,d.ji)({level:d.y8.DEBUG,moduleValue:"messageCenter",actionValue:"emptyKeyframeByAutoExpand",detail:e})},ADD_USER_CHANGE:function(e){(0,d.ji)({level:d.y8.INFO,moduleValue:"messageCenter",actionValue:"addUserChange",detail:e})},CLEAR_OFFLINE_DATA_SIZE:function(e,t){(0,d.ji)({level:d.y8.DEBUG,moduleValue:"messageCenter",actionValue:"clearOfflineStoreSize",ver5Value:""+e,detail:t})},UPDATE_BASEVERSION:function(e){(0,d.ji)({level:d.y8.INFO,moduleValue:"messageCenter",actionValue:"updateBaseVersion",detail:e})},UPDATE_BASEVERSION_ERROR:function(e){N(34860419),(0,d.ji)({level:d.y8.DEBUG,moduleValue:"messageCenter",actionValue:"updateBaseVersionError",detail:e})},ACCEPT_COMMIT_2:function(e,t){h({attrid:m.ZZS_REPORT_ATTR.SOCKET_COMMIT_ERROR,status:0,dimensions:"acceptOfflineCommit"===t?"offlineMsg":"onlineMsg"}),(0,d.fV)({level:d.y8.IMPORTANT,moduleValue:"messageCenter",actionValue:t,ver5Value:"0",detail:e}),E().isMiniProgram&&u.ZP.kvrOss({itemname:"minidoc_edit_xls"})},FETCH_USERCHANGE_ARGUMENT:function(e){N(33612380),(0,d.ji)({level:d.y8.DEBUG,moduleValue:"messageCenter",actionValue:"fetchUserChangesArgument",ver5Value:"1",detail:e})},FETCH_USERCHANGES:function(e){(0,d.ji)({level:d.y8.INFO,moduleValue:"messageCenter",actionValue:"fetchUserChanges",detail:e})},FETCH_USERCHANGES_3:function(e){N(33612438),(0,d.ji)({level:d.y8.INFO,moduleValue:"messageCenter",actionValue:"fetchUserChanges",ver5Value:"1",detail:e})},INIT_DATA_ERROR:function(e){(0,d.ji)({level:d.y8.DEBUG,moduleValue:"userchange",actionValue:"initDataError",ver5Value:"1",detail:e})},STORE_DATA_ERROR:function(e){(0,d.ji)({level:d.y8.DEBUG,moduleValue:"userchange",actionValue:"storeDataError",ver5Value:"1",detail:e})},NOT_SUPPORT_INDEXEDDB:function(){N(33639031),(0,d.ji)({level:d.y8.DEBUG,moduleValue:"indexeddb",actionValue:"notSupportIndexedDB",detail:["indexedDB is no supported."]})},OPEN_INDEXED_DB_FAIL:function(e,t){var o=t.message,a=t.name,n=t.stack;(0,d.ji)({level:d.y8.DEBUG,moduleValue:"indexeddb",actionValue:"openIndexedDB",ver5Value:e,detail:["indexedDB open failed.",o,a,n]})},UPDATE_INDEXED_DB:function(e){(0,d.ji)({level:d.y8.DEBUG,moduleValue:"indexeddb",actionValue:"updateIndexedDB",detail:e})},STORE_UNVALIABLE_WHEN_SET:function(e){N(33624016),(0,d.ji)({level:d.y8.DEBUG,moduleValue:"indexeddb",actionValue:"storeUnvaliableWhenSet",detail:e})},INDEXDB_SET_VALUE:function(e){N(33624019),(0,d.ji)({level:d.y8.INFO,moduleValue:"indexeddb",actionValue:"setValue",ver5Value:"0",detail:e})},INDEXDB_SET_VALUE_ONERROR:function(e){N(33624017),(0,d.ji)({level:d.y8.DEBUG,moduleValue:"indexeddb",actionValue:"setValue",ver5Value:"1",detail:e})},CHANGE_DATAKEY:function(e){N(33692488),(0,d.ji)({level:d.y8.DEBUG,moduleValue:"indexeddb",actionValue:"changeDataKey",detail:e})},STORE_UNVALIABLE_WHEN_UPDATE:function(e){N(33624030),(0,d.ji)({level:d.y8.DEBUG,moduleValue:"indexeddb",actionValue:"storeUnvaliableWhenUpdate",detail:e})},INDEXEDDB_UPDATE_VALUE:function(e){N(33648382),(0,d.ji)({level:d.y8.DEBUG,moduleValue:"indexeddb",actionValue:"updateValue",ver5Value:"2",detail:e})},INDEXEDDB_UPDATE_VALUE_2:function(e){N(33624031),(0,d.ji)({level:d.y8.INFO,moduleValue:"indexeddb",actionValue:"updateValue",ver5Value:"0",detail:e})},INDEXEDDB_UPDATE_VALUE_3:function(e){N(33624032),(0,d.ji)({level:d.y8.DEBUG,moduleValue:"indexeddb",actionValue:"updateValue",ver5Value:"1",detail:e})},INDEXEDDB_UPDATE_VALUE_4:function(e){N(33624033),(0,d.ji)({level:d.y8.DEBUG,moduleValue:"indexeddb",actionValue:"updateValue",ver5Value:"3",detail:e})},DELETE_DATA_ERROR:function(e){N(33624034),(0,d.ji)({level:d.y8.DEBUG,moduleValue:"indexeddb",actionValue:"deleteDataError",detail:e})},DELETE_VALUE:function(e){N(33624036),(0,d.ji)({level:d.y8.DEBUG,moduleValue:"indexeddb",actionValue:"deleteValue",ver5Value:"1",detail:e})},DELETE_VALUE_2:function(e){N(33624035),(0,d.ji)({level:d.y8.INFO,moduleValue:"indexeddb",actionValue:"deleteValue",ver5Value:"0",detail:e})},CLEAR_DATA_ERROR:function(e){N(33624037),(0,d.ji)({level:d.y8.DEBUG,moduleValue:"indexeddb",actionValue:"clearDataError",detail:e})},CLEAR_DATA:function(e){N(33624039),(0,d.ji)({level:d.y8.DEBUG,moduleValue:"indexeddb",actionValue:"clearData",ver5Value:"1",detail:e})},CLEAR_DATA_2:function(e){N(33624038),(0,d.ji)({level:d.y8.INFO,moduleValue:"indexeddb",actionValue:"clearData",ver5Value:"0",detail:e})},GET_DATA_ERROR:function(e){N(33624047),(0,d.ji)({level:d.y8.DEBUG,moduleValue:"indexeddb",actionValue:"getDataError",detail:e})},GET_DATA:function(e){(0,d.ji)({level:d.y8.DEBUG,moduleValue:"indexeddb",actionValue:"getData",ver5Value:"2",detail:e})},GET_DATA_ERROR_2:function(e){N(33624049),(0,d.ji)({level:d.y8.DEBUG,moduleValue:"indexeddb",actionValue:"getData",ver5Value:"1",detail:e})},GET_DATA_SUCC:function(e){N(33624048),(0,d.ji)({level:d.y8.INFO,moduleValue:"indexeddb",actionValue:"getData",ver5Value:"0",detail:e})},NETWORK_ERROR:function(){(0,d.ji)({level:d.y8.DEBUG,moduleValue:"socket",actionValue:"networkError",ver5Value:"90sNoSocket"})},WEBSOCKET_CLOSE:function(e){(0,d.ji)({level:d.y8.IMPORTANT,moduleValue:"socket",actionValue:"close",ver5Value:"1",detail:e})},LONG_TIME_HIDDEN_1:function(){N(34813929),(0,d.ji)({level:d.y8.DEBUG,moduleValue:"socket",actionValue:"roomstatechange",ver5Value:"LONG_TIME_HIDDEN_1"})},LONG_TIME_HIDDEN_2:function(){N(34813930),(0,d.ji)({level:d.y8.DEBUG,moduleValue:"socket",actionValue:"roomstatechange",ver5Value:"LONG_TIME_HIDDEN_2"})},ACCEPT_MESSAGE:function(e){(0,d.ji)({level:d.y8.INFO,moduleValue:"socket",actionValue:"message",detail:e})},ROOM_STATE_CHANGE:function(e,t){(0,d.ji)({level:d.y8.INFO,moduleValue:"socket",actionValue:"roomstatechange",ver5Value:t.valueOf(),detail:e})},HANDLE_SHUTDOWN:function(e){(0,d.ji)({level:d.y8.DEBUG,moduleValue:"socket",actionValue:"handleShutDown",ver5Value:e})},RELOAD_TIP:function(e){(0,d.ji)({level:d.y8.INFO,moduleValue:"messageCenter",actionValue:"reloadTip",ver5Value:e,detail:[e]})},RELOAD_TIP_DEBUG:function(e){(0,d.ji)({level:d.y8.DEBUG,moduleValue:"messageCenter",actionValue:"reloadTip",ver5Value:e,detail:[e]})},SWITCH_SHEET_IN_PREVIEW:function(e){(0,d.ji)({level:d.y8.INFO,moduleValue:"sheetbar",actionValue:"switchSheetInPreview",detail:e})},PREVIEW_SERVER_SHEET_DATA:function(e){(0,d.ji)({level:d.y8.INFO,moduleValue:"sheetbar",actionValue:"previewServerSheetData",detail:e})},PREVIEW_SERVER_SHEET_DATA_ON_RESPONSE:function(e){(0,d.ji)({level:d.y8.INFO,moduleValue:"sheetbar",actionValue:"previewServerSheetDataOnResponse",detail:e})},SWITCH_SHEET_ON_SUCCESS:function(e){(0,d.ji)({level:d.y8.INFO,moduleValue:"sheetbar",actionValue:"switchSheetOnSuccess",ver5Value:"1",detail:e})},SWITCH_SHEET_ON_FAIL:function(e){(0,d.ji)({level:d.y8.INFO,moduleValue:"sheetbar",actionValue:"switchSheetOnFail",ver5Value:"1",detail:e})},DUPLICATE_SHEET_ID_2:function(e){N(33955440),(0,d.ji)({level:d.y8.DEBUG,moduleValue:"sheetsbar",actionValue:"duplicateSheetId",ver5Value:"1",detail:e})},DUPLICATE_SHEET_ID_3:function(e){N(34098881),(0,d.ji)({level:d.y8.DEBUG,moduleValue:"sheetsbar",actionValue:"duplicateSheetId",ver5Value:"2",detail:e})},FETCH_DATA_ERROR:function(e){h({attrid:m.ZZS_REPORT_ATTR.FULL_MEMBER_FETCH_DATA_FAIL,status:1}),(0,d.ji)({level:d.y8.INFO,moduleValue:"fullMember",actionValue:"fetchDataError",ver5Value:"1",detail:e})},FETCH_DATA_ERROR_2:function(e,t,o){h({attrid:m.ZZS_REPORT_ATTR.FULL_MEMBER_FETCH_DATA_FAIL,status:1});var a={1e5:33711861,100002:33711862,100003:33711863,200105:33711864,200200:33711865,200011:33715032};N(t&&a[o]?a[o]:33711866),(0,d.ji)({level:d.y8.INFO,moduleValue:"fullMember",actionValue:"fetchDataError",ver5Value:"2",detail:e})},K2S_CONVERTER:function(e){(0,d.ji)({level:d.y8.INFO,moduleValue:"fullMember",actionValue:"k2sConverter",detail:e})},OFFLINE_DATABASE_ERROR:function(e){N(34924089),(0,d.ji)({level:d.y8.DEBUG,moduleValue:"offlineEdit",actionValue:"offlineDatabaseError",detail:e})},INIT_OFFLINE_STORE_ERROR:function(e){(0,d.ji)({level:d.y8.DEBUG,moduleValue:"indexeddb",actionValue:"initOfflineStore",ver5Value:"1",detail:e})},GET_OFFLINE_DATA:function(e){(0,d.ji)({level:d.y8.INFO,moduleValue:"messageCenter",actionValue:"getOfflineData",ver5Value:"OfflineData",detail:e})},CHANGEDATAKEY_CATCH_ERROR:function(e){(0,d.ji)({level:d.y8.IMPORTANT,moduleValue:"indexeddb",actionValue:"changeDataKeyCatchError",ver5Value:"1",detail:e}),N(33782646)},SETDATA_CATCH_ERROR:function(e){(0,d.ji)({level:d.y8.IMPORTANT,moduleValue:"indexeddb",actionValue:"setDataCatchError",ver5Value:"1",detail:e}),N(33782647)},UPDATEDATA_CATCH_ERROR:function(e){(0,d.ji)({level:d.y8.IMPORTANT,moduleValue:"indexeddb",actionValue:"updateDataCatchError",ver5Value:"1",detail:e}),N(33782648)},DELETEDATA_CATCH_ERROR:function(e){(0,d.ji)({level:d.y8.IMPORTANT,moduleValue:"indexeddb",actionValue:"deleteDataCatchError",ver5Value:"1",detail:e}),N(33782654)},CLEARDATA_CATCH_ERROR:function(e){(0,d.ji)({level:d.y8.IMPORTANT,moduleValue:"indexeddb",actionValue:"clearDataCatchError",ver5Value:"1",detail:e}),N(33782655)},GETDATA_CATCH_ERROR:function(e){(0,d.ji)({level:d.y8.IMPORTANT,moduleValue:"indexeddb",actionValue:"getDataCatchError",ver5Value:"1",detail:e}),N(33782678)},SWITCH_SHEET_SERVER_FAIL:function(e){(0,d.ji)({level:d.y8.DEBUG,moduleValue:"switchSheet",actionValue:"serverFail",detail:e}),N(33701441)},SWITCH_SHEET_FRONT_FAIL:function(e){(0,d.ji)({level:d.y8.DEBUG,moduleValue:"switchSheet",actionValue:"frontFail",detail:e}),N(33701442)},PARSE_KEYFRAME_ERROR:function(e){(0,d.ji)({level:d.y8.IMPORTANT,moduleValue:"keyframe",actionValue:"parse",ver5Value:"1",detail:e}),N(33639871)},UNZIP_KEYFRAME_ERROR:function(e,t){(0,d.ji)({level:d.y8.IMPORTANT,moduleValue:"keyframe",actionValue:"unzip",ver5Value:"1",detail:e}),N(33639872),(0,d.mC)({errorType:"keyframeUnzipError",error:t})},PARSE_KEYFRAME_ERROR_2:function(e){(0,d.ji)({level:d.y8.IMPORTANT,moduleValue:"keyframe",actionValue:"parse",ver5Value:"1",detail:e}),N(33639871)},UNZIP_KEYFRAME:function(e,t){(0,d.ji)({level:d.y8.IMPORTANT,moduleValue:"keyframe",actionValue:"unzip",ver5Value:"1",detail:e}),N(33639872),(0,d.mC)({errorType:"keyframeUnzipError",error:t})},MESSAGECENTER_DATA_ERROR_TIP:function(e,t){(0,d.ji)({level:d.y8.INFO,moduleValue:"messageCenter",actionValue:"dataErrorTip",ver5Value:t,detail:e})},NET_OFFLINE_ERROR_TIP:function(){(0,d.ji)({level:d.y8.INFO,moduleValue:"messageCenter",actionValue:"netOfflineErrorTip"}),N(33697418)},MESSAGECENTER_DATA_ERROR_TIP_IMPORTANT:function(e,t){(0,d.ji)({level:d.y8.IMPORTANT,moduleValue:"messageCenter",actionValue:e,ver5Value:t})},APPLY_BEHAVIOR_UNDO:function(e){(0,d.fV)({level:d.y8.IMPORTANT,moduleValue:"applyBehavior",actionValue:"undo",ver5Value:"0",detail:e})},APPLY_BEHAVIOR_REDO:function(e){(0,d.fV)({level:d.y8.IMPORTANT,moduleValue:"applyBehavior",actionValue:"redo",ver5Value:"0",detail:e})},APPLY_BEHAVIOR_LOCAL:function(e){(0,d.fV)({level:d.y8.IMPORTANT,moduleValue:"applyBehavior",actionValue:"local",ver5Value:"0",detail:e})},CREATE_WORKER_ERROR:function(e){(0,d.mC)({error:e,errorType:"web-worker",message:"创建worker失败"})},UPDATE_SMART_SELECTION_ERROR:function(e,t){(0,d.mC)({errorType:"UpdateSmartSelectionError",message:e,error:t})},INVERT_MUTATION_ERROR:function(e,t){(0,d.mC)({errorType:"InvertMutationError",message:e,error:t})},FILL_DRAG:function(){v({module:"doc_excel_editor",opername:"excel_fill",action:"fill_drag"})},FILL_SERIES:function(){v({module:"doc_excel_editor",opername:"excel_fill",action:"fill_series"})},FILL_COPY:function(){v({module:"doc_excel_editor",opername:"excel_fill",action:"fill_copy"})},FILL_OPTION:function(){v({module:"doc_excel_editor",opername:"excel_fill",action:"fill_option"})},FILL_OPTION_COPY:function(){v({module:"doc_excel_editor",opername:"excel_fill",action:"fill_option_copy"})},FILL_OPTION_SERIES:function(){v({module:"doc_excel_editor",opername:"excel_fill",action:"fill_option_series"})},FILL_FORMAT:function(){v({module:"doc_excel_editor",opername:"excel_fill",action:"fill_format"})},FILL_WITHOUT_FORMAT:function(){v({module:"doc_excel_editor",opername:"excel_fill",action:"fill_without_format"})},MOBILE_FILL_SERIES:function(){v({module:"doc_excel_editor",opername:"excel_fill_mobile",action:"mobile_fill_series"})},MOBILE_FILL_COP:function(){v({module:"doc_excel_editor",opername:"excel_fill_mobile",action:"mobile_fill_copy"})},CLK_FILL_SUCCESS:function(){v({module:"doc_excel_editor",opername:"excel_fill_mobile",action:"clk_fill_success"})},SWITCH_SHEET_SUCC:function(e){N({success:{PC:33556930,Android:33557619,IOS:33557620},fail:{PC:33560365,Android:33560689,IOS:33560690}}[e][E().isMobilePhone||E().isAndroidPad?E().isAndroid?"Android":"IOS":"PC"])},REPORT_FOR_PLATFORM:function(e){g(e)},REPORT_FILES_TIMES:function(){var e=function(){if(!performance||!performance.getEntries)return null;var e;try{e=performance.getEntries()}catch(o){return null}var t=[];return e.map((function(e){e.name&&e.duration&&(-1===e.name.indexOf("js/spread-sheet")&&-1===e.name.indexOf("js/bundle-vendors")&&-1===e.name.indexOf("js/bundle-core")&&-1===e.name.indexOf("js/core-sheet")||t.push({name:e.name,duration:e.duration}))})),t}();v({opername:"excel_performance",module:"files",action:"load_time",obj1:JSON.stringify(e)})},REPORT_FOR_QUICK_LOOK:function(e){var t;t="success"===e?{PC:33986901,Mobile:33986902,IOS:33986903,Android:33986904,All:33986900}:{PC:33987060,Mobile:33987061,IOS:33987062,Android:33987063,All:33987059};try{var o;E().isMobilePhone||E().isAndroidPad?(N(t[o="Mobile"]),E().isAndroid?o="Android":E().isIOS&&(o="IOS")):o="PC",N(t[o]),N(t.All),v("success"===e?{opername:"doc_core",module:"visit",action:"quick_look_succ"}:{opername:"doc_core",module:"visit",action:"quick_look_fail"})}catch(a){console.error(a)}},SHEET_STATUS_REPORT:function(e){if(e){e.getBasicFilter()&&v({opername:"doc_excel_editor",module:"excel_filter",action:"excel_contain_filter"});var t=e.mergeManager.mergeList,o=!1,a=[];if(t.forEach((function(e){0===e.startRowIndex&&(o=!0),a.push([e.startRowIndex,e.startColIndex])})),o&&v({opername:"doc_excel_editor",module:"excel_merge",action:"top_row_merge"}),a.length>0){var n=0,i=0,r=0,l=0,s=0,u=0;a.forEach((function(t){var o=t[0],a=t[1],d=e.data.rowData[o]&&e.data.rowData[o].values[a];if(d){var c=d.getUserEnteredFormat();if(c){var _=c.getHorizontalAlign(),E=c.getVerticalAlign();_&&"left"!==_||(n+=1),"center"===_&&(i+=1),"right"===_&&(r+=1),"top"===E&&(l+=1),E&&"middle"!==E||(s+=1),"bottom"===E&&(u+=1)}}})),v({opername:"doc_excel_editor",module:"excel_merge",action:"merge_align",ver5:"h_align_left:"+n+",h_align_center:"+i+",h_align_right:"+r+",v_align_top:"+l+",v_align_middle:"+s+",v_align_bottom:"+u})}var d=e.properties.gridProperties;if(d){var c=d.frozenColCount,_=d.frozenRowCount;1===c&&v({opername:"doc_excel_editor",module:"excel_freeze",action:"include_first_column_freeze"}),1===_&&v({opername:"doc_excel_editor",module:"excel_freeze",action:"include_first_row_freeze"}),(_>1||c>1)&&v({opername:"doc_excel_editor",module:"excel_freeze",action:"include_freeze_range"})}}},REPORT_FOR_QL_PV:function(){try{var e,t={PC:34024799,Mobile:34024802,IOS:34024801,Android:34024800,All:34024798};E().isMobilePhone||E().isAndroidPad?(N(t[e="Mobile"]),E().isAndroid?e="Android":E().isIOS&&(e="IOS")):e="PC",N(t[e]),N(t.All);var o=(0,T.IZ)("tdsourcetag");o||(o=localStorage.getItem("tdsourcetag")),o&&((0,T.d8)("adtag",o),localStorage.setItem("tdsourcetag",o)),v({opername:"doc_core",module:"visit",action:"detail_page_quicklook",source3:o||""})}catch(a){N(3410984)}},REPORT_FOR_SSR:function(){if(o.g.ssrReport)try{var e,t={PC:35298637,Mobile:35298652,IOS:35298639,Android:35298638,All:35298651};E().isMobilePhone||E().isAndroidPad?(N(t[e="Mobile"]),E().isAndroid?e="Android":E().isIOS&&(e="IOS")):e="PC",N(t[e]),N(t.All);var a=(0,O.F)(o.g.SpreadsheetApp.spreadsheet.getActiveSheetId()),n=JSON.stringify(a);v({opername:"doc_core",module:"visit",action:"detail_page_ssr",ver3:n})}catch(i){console.error(i),N(3410984)}},REPORT_FOR_JSONP:function(){try{var e,t={PC:35404917,Mobile:35404918,IOS:35404919,Android:35404920,All:35404921};E().isMobilePhone||E().isAndroidPad?(N(t[e="Mobile"]),E().isAndroid?e="Android":E().isIOS&&(e="IOS")):e="PC",N(t[e]),N(t.All),v({opername:"doc_core",module:"visit",action:"detail_page_jsonp"})}catch(o){console.error(o),N(3410984)}},REPORT_FOR_PV:function(){h({attrid:m.ZZS_REPORT_ATTR.PV,status:0}),E().isMiniProgram&&u.ZP.kvrOss({itemname:"minidoc_view_xls"});var e=u.ZP.monitor;try{var t,o={sheet:{PC:3410973,Mobile:3410974,IOS:3410975,Android:3410976,All:3410982},All:3410983},a={PC:[291727,50],Mobile:[291727,51],All:[291727,52]},n=o.sheet;E().isMobilePhone||E().isAndroidPad?(e(n[t="Mobile"]),u.ZP.idkey(a.Mobile[0],a.Mobile[1]),E().isAndroid?t="Android":E().isIOS&&(t="IOS")):(t="PC",u.ZP.idkey(a.PC[0],a.PC[1])),e(n[t]),e(n.All),e(o.All),u.ZP.idkey(a.All[0],a.All[1]),c.q.getConfig("isPreview")&&v({opername:"doc_pcview",module:"open",action:"pre_req"}),v({opername:"doc_core",module:"visit",action:"detail_page",ver5:window.__globalReleaseVersion,ver10:c.q.getConfig("isPreview")?"qqpreview":""},{immediate:!0}),e(33635051),e(33635108)}catch(i){e(3410984)}},RESET_DEFAULT_TDW_DATA:function(){D()},INVER_MUTATION_ERROR:function(e,t){(0,d.mC)({errorType:"InvertMutationError",message:e,error:t})},PARSE_PUSH_MESSAGE_ERROR:function(e){(0,d.ji)({level:d.y8.DEBUG,moduleValue:"socket",actionValue:"parsePushMessageError",ver5Value:"1",detail:e})},MUTATION_QUEUE_MAX_SIZE:function(e){N(33906029),(0,d.ji)({level:d.y8.DEBUG,moduleValue:"mutationQueue",actionValue:"maxSize",detail:e})},MUTATION_QUEUE_COMPLETE_TIMEOUT:function(e){N(33906250),(0,d.ji)({level:d.y8.DEBUG,moduleValue:"mutationQueue",actionValue:"completeTimeout",detail:e})},VIEW_ERROR_INPUT:function(e){(0,d.ji)({level:d.y8.IMPORTANT,moduleValue:"viewInput",actionValue:"viewUserEnterCatchError",detail:e})},VIEW_GET_DIMENSION_OVERFLOW:function(e){(0,d.ji)({level:d.y8.IMPORTANT,moduleValue:"viewAreaData",actionValue:"viewGetDimensionOverflow",detail:e})}}),y=function(){},C=(o("../node_modules/core-js/modules/es.promise.js"),o("../node_modules/core-js/modules/es.string.iterator.js"),o("../node_modules/core-js/modules/es.map.js"),o("../node_modules/core-js/modules/esnext.map.delete-all.js"),o("../node_modules/core-js/modules/esnext.map.every.js"),o("../node_modules/core-js/modules/esnext.map.filter.js"),o("../node_modules/core-js/modules/esnext.map.find.js"),o("../node_modules/core-js/modules/esnext.map.find-key.js"),o("../node_modules/core-js/modules/esnext.map.includes.js"),o("../node_modules/core-js/modules/esnext.map.key-of.js"),o("../node_modules/core-js/modules/esnext.map.map-keys.js"),o("../node_modules/core-js/modules/esnext.map.map-values.js"),o("../node_modules/core-js/modules/esnext.map.merge.js"),o("../node_modules/core-js/modules/esnext.map.reduce.js"),o("../node_modules/core-js/modules/esnext.map.some.js"),o("../node_modules/core-js/modules/esnext.map.update.js"),o("../spread-sheet/src/base/report/flowlog.js")),M=o("../node_modules/lodash/isFunction.js"),j=o.n(M),w=o("../spread-sheet/src/base/util/appConfig.ts"),L=o("../spread-sheet/src/core/app/doc-performance.ts");!function(e){e.CREATE_TS="createTS",e.TEMPLATE_ID="templateId",e.CSID="csid",e.CLICK_START="clickStart",e.CLIENT_SIDE_RENDER_END="clientSideRenderEnd",e.NEW_EMPTY_DOC="newEmptyDoc"}(S||(S={}));var U,b,k,x=new(function(){function e(){var e=this;this.checkIfCanReport=function(){if(o.g.SpreadsheetAppInitComplete)e.pagePerformanceReport();else{var t=o.g.SpreadsheetApp;e.listenAppEvents([t.EVENT.SPREAD_SHEET_ALL_CHUNK_READY],e.pagePerformanceReport,t.emitter)}},this.pagePerformanceReport=function(){e.pagePerformanceReportFlag||(e.pagePerformanceReportFlag=!0,e.prepareSpeedReportData(),e.markPerformance(),e.doSpeedReport(),e.nativeOpenPageReport(),o.g.history.replaceState({},"",(0,T.oW)(o.g.location.href,[S.CREATE_TS,S.TEMPLATE_ID,S.CSID,S.CLICK_START,S.CLIENT_SIDE_RENDER_END,S.NEW_EMPTY_DOC])))},this.destroy=function(){e.init()},this.listenAppEvents=function(e,t,o){var a=e.map((function(e){return new Promise((function(t){o.once(e,t)}))}));Promise.all(a).then((function(){t()}))},this.init(),this.initListeners()}var t=e.prototype;return t.init=function(){var e=o.g.performance||o.g.webkitPerformance||o.g.msPerformance||{};this.timing=e.timing,this.performanceData=o.g.performanceData||{},this.speedReportData=new Map,this.pagePerformanceReportFlag=!1},t.initListeners=function(){var e=o.g.SpreadsheetApp;this.listenAppEvents([e.EVENT.PAGE_LOAD_FINISHED],this.checkIfCanReport,e.emitter),e.emitter.on(e.EVENT.START_DESTROY,this.destroy)},t.hasDonePagePerformanceReport=function(){return this.pagePerformanceReportFlag},t.markPerformance=function(){var e,t,a=o.g.tDocsPerformance.timing,n=null!==(t=null!==(e=a.clientSideRenderEnd)&&void 0!==e?e:a.serverSideRenderEnd)&&void 0!==t?t:a.firstRealRenderEnd;o.g.tDocsPerformance.markLifeCycle(L.hX.LCP,{startTime:n}),o.g.tDocsPerformance.markLifeCycle(L.hX.TTI,{startTime:a.firstRealRenderEnd}),o.g.tDocsPerformance.markLifeCycle(L.hX.TTE,{startTime:a.documentEditable})},t.prepareSpeedReportData=function(){var e,t,a,n=this.timing,i=this.performanceData,r=this.speedReportData,l=i.startPoint||n.requestStart;if(o.g.tDocsPerformance.mark("clickStart",{startTime:(0,T.DC)(S.CLICK_START)}),o.g.tDocsPerformance.mark("navigationStart",{startTime:n.navigationStart}),o.g.tDocsPerformance.mark("clientSideRenderEnd",{startTime:(0,T.DC)(S.CLIENT_SIDE_RENDER_END)}),o.g.tDocsPerformance.mark("serverSideRenderEnd",{startTime:o.g.ssrRenderEnd}),o.g.tDocsPerformance.mark("firstRealRenderEnd",{startTime:i.afterFirstRender}),o.g.tDocsPerformance.mark("documentEditable",{startTime:i.partInteractable}),o.g.tDocsPerformance.measure("html-ttfb",{startTime:l,endTime:n.responseStart}),o.g.tDocsPerformance.measure("html",{startTime:l,endTime:n.responseEnd}),r.set(m.SPEED_REPORT_POINTS.NAVIGATION_TO_FETCH,n.fetchStart-n.navigationStart),r.set(m.SPEED_REPORT_POINTS.DNS,n.domainLookupEnd-n.domainLookupStart),r.set(m.SPEED_REPORT_POINTS.CONNECT,n.connectEnd-n.connectStart),r.set(m.SPEED_REPORT_POINTS.HTML_TTFB,n.responseStart-l),r.set(m.SPEED_REPORT_POINTS.HTML_LOAD,n.responseEnd-n.responseStart),r.set(m.SPEED_REPORT_POINTS.WHITESCREEN,o.g.isContainer?0:i.jsStartRun-l),r.set(m.SPEED_REPORT_POINTS.SYNC_JS_RUN,n.domContentLoadedEventEnd-i.jsStartRun),r.set(m.SPEED_REPORT_POINTS.DOM_CONTENT_LOAD,n.domContentLoadedEventEnd-l),o.g.htmlBottomToLoadedTimeReport&&r.set(m.SPEED_REPORT_POINTS.HTML_BOTTOM_TO_LOADED,o.g.htmlBottomToLoadedTimeReport),o.g.ssrReport&&o.g.ssrRenderEnd?(r.set(m.SPEED_REPORT_POINTS.FIRST_SCREEN_SSR,o.g.ssrRenderEnd-l),r.set(m.SPEED_REPORT_POINTS.FIRST_SCREEN,o.g.ssrRenderEnd-l)):(r.set(m.SPEED_REPORT_POINTS.FIRST_SCREEN_NO_SSR,i.afterFirstRender-l),r.set(m.SPEED_REPORT_POINTS.FIRST_SCREEN,i.afterFirstRender-l)),r.set(m.SPEED_REPORT_POINTS.PART_INTERACTABLE,i.partInteractable-l),r.set(m.SPEED_REPORT_POINTS.AFTER_ALL_RENDER,i.afterAllRender-l),r.set(m.SPEED_REPORT_POINTS.REAL_PART_INTERACTABLE,i.realPartInteractable-l),o.g.log.info("ENTIRE_INTERACTABLE-speed 中初始化"),r.set(m.SPEED_REPORT_POINTS.ENTIRE_INTERACTABLE,i.entireInteractable-l),r.set(m.SPEED_REPORT_POINTS.REQUEST_API_READY,i.requestApiReady-l),j()(null===(t=o.g.performance)||void 0===t?void 0:t.getEntriesByType)){var s=performance.getEntriesByType("resource");o.g.tDocsPerformance.measureResource(s);for(var u=0,d=s.length;u<d;u++){var c=s[u];0===c.name.indexOf("https://"+w.Z.getConfig("runtime.domainName")+"/dop-api/opendoc")&&(r.set(m.SPEED_REPORT_POINTS.LOAD_CGI_DATA_TIME,c.responseEnd-c.fetchStart),r.set(m.SPEED_REPORT_POINTS.LOAD_CGI_DATA_SERVER_COST_TIME,c.responseStart-c.connectEnd))}}null===(a=o.g.cachedPerformanceEntries)||void 0===a||a.forEach((function(e){var t=e.name,a=e.entryType,n=e.startTime,i=e.endTime;o.g.tDocsPerformance.measure(t,{entryType:a,startTime:n,endTime:i})})),o.g.speedData=((e={})[m.SPEED_REPORT_POINTS.WHITESCREEN]=r.get(m.SPEED_REPORT_POINTS.WHITESCREEN),e[m.SPEED_REPORT_POINTS.FIRST_SCREEN]=r.get(m.SPEED_REPORT_POINTS.FIRST_SCREEN),e[m.SPEED_REPORT_POINTS.PART_INTERACTABLE]=r.get(m.SPEED_REPORT_POINTS.PART_INTERACTABLE),e[m.SPEED_REPORT_POINTS.REAL_PART_INTERACTABLE]=r.get(m.SPEED_REPORT_POINTS.REAL_PART_INTERACTABLE),e[m.SPEED_REPORT_POINTS.REQUEST_API_READY]=r.get(m.SPEED_REPORT_POINTS.REQUEST_API_READY),e[m.SPEED_REPORT_POINTS.ENTIRE_INTERACTABLE]=r.get(m.SPEED_REPORT_POINTS.ENTIRE_INTERACTABLE),e)},t.doSpeedReport=function(){var e=this,t=(0,O.F)(o.g.SpreadsheetApp.spreadsheet.getActiveSheetId()),a=""+u.ZP.getSource1(),n=JSON.stringify(t),i=JSON.stringify({container:o.g.isContainer?1:0,offline_package:o.g.__isOfflinePkg?1:0});if(u.ZP.tdwReport({opername:"quality_doc",module:"excel_detail",action:"open_time_cost",ver5:this.speedReportData.get(m.SPEED_REPORT_POINTS.WHITESCREEN)||0,ver6:this.speedReportData.get(m.SPEED_REPORT_POINTS.FIRST_SCREEN)||0,ver7:this.speedReportData.get(m.SPEED_REPORT_POINTS.PART_INTERACTABLE)||0,ver8:n,ver9:i,ver10:this.speedReportData.get(m.SPEED_REPORT_POINTS.REAL_PART_INTERACTABLE)||0,ver11:this.speedReportData.get(m.SPEED_REPORT_POINTS.REQUEST_API_READY)||0,ver12:this.speedReportData.get(m.SPEED_REPORT_POINTS.ENTIRE_INTERACTABLE)||0}),E().isMiniProgram){var r=+(0,T.IZ)("miniapp_ts");r&&u.ZP.tdwReport({opername:"miniapp_performance",module:"detail",action:"navagationStart",ver5:this.timing.navigationStart-r})}var l=this.speedReportData.get(m.SPEED_REPORT_POINTS.FIRST_SCREEN)||0;l>1e5&&(l=1e4,o.g.log.log("global.ssrRenderEnd",o.g.ssrRenderEnd),o.g.log.log("this.timing",this.timing),o.g.log.log("this.performanceData",this.performanceData),o.g.log.report("first_screen_wrong_number"));var s=o.g.tDocsPerformance.getElapsedTimes().TTI;o.g.log.log("tti首屏可见时间",s),u.ZP.zzsValue({attrid:m.ZZS_REPORT_ATTR.FIRST_SCREEN_TIME,value:l}),u.ZP.zzsValue({attrid:m.ZZS_REPORT_ATTR.INTERACTABLE_TIME,value:this.speedReportData.get(m.SPEED_REPORT_POINTS.PART_INTERACTABLE)||0}),u.ZP.zzsStatus({attrid:m.ZZS_REPORT_ATTR.FIRST_SCREEN_TIME_IN_5S,status:Number(!(s<=5e3))}),s>5e3&&I.$.report("FIRST_SCREEN_TIME_IN_5S"),this.speedReportData.forEach((function(t,o){if(u.ZP.tdwReport({opername:"excel_performance",module:"start",action:o,ver5:t,ver8:n,ver9:i}),u.ZP.tam.reportT({name:o,duration:t,ext1:n,ext2:i,ext3:a}),m.SPEED_REPORT_LOG[o]){var r=m.SPEED_REPORT_LOG[o]+": "+t;C.Z.info(r),console.warn("%c"+r,"color: green; font-size: 14px;")}e.speedReportData.delete(o)})),C.Z.info("耗时数据："+o.g.tDocsPerformance.timing)},t.runReport=function(e,t,a,n){var i=a-t,r=this.speedReportData.get(e)||0;if(this.speedReportData.set(e,r+i),!n){var l=(0,O.F)(o.g.SpreadsheetApp.spreadsheet.getActiveSheetId()),s=this.speedReportData.get(e)||0,d=""+u.ZP.getSource1(),c=JSON.stringify(l),_=JSON.stringify({container:o.g.isContainer?1:0,offline_package:o.g.__isOfflinePkg?1:0});if(u.ZP.tdwReport({opername:"excel_performance",module:"start",action:e,ver5:s,ver8:c,ver9:_}),u.ZP.tam.reportT({name:e,duration:s,ext1:c,ext2:_,ext3:d}),m.SPEED_REPORT_LOG[e]){var E=m.SPEED_REPORT_LOG[e]+": "+s;C.Z.info(E),console.warn("%c"+E,"color: green; font-size: 14px;")}this.speedReportData.delete(e)}},t.nativeOpenPageReport=function(){var e,t=this,a=(0,T.IZ)(S.CREATE_TS),n=(0,T.IZ)(S.TEMPLATE_ID),i=(0,T.IZ)(S.CSID),r=o.g.isContainer?this.performanceData.startPoint:this.timing.requestStart;a?this.doOpenPageReport({isCreate:!0,clickTime:+a,templateId:n,appStatus:{},metrics:{}}):i&&(null===(e=o.g.mqq)||void 0===e||e.invoke("docx","getMetric",{csid:i},(function(e){var a;if(e&&e.data){var l=e.data.doc_item_click_timestamp,s=e.data.doc_loadurl_timestamp,u=s-l,d=r-s;t.doOpenPageReport({isCreate:!1,clickTime:l,templateId:n,appStatus:{clickToLoadCost:u,loadToStartCost:d},metrics:e.data})}else null===(a=o.g.log)||void 0===a||a.error("getMetric for "+i+" failed.",e)})))},t.doOpenPageReport=function(e){var t=JSON.stringify(Object.assign({clickToEditCost:this.performanceData.partInteractable-e.clickTime,clickToShowCost:this.performanceData.afterFirstRender-e.clickTime},e.appStatus||{})),a=e.isCreate?"1":"0",n=JSON.stringify(Object.assign({container:o.g.isContainer?1:0,offline_package:o.g.__isOfflinePkg?1:0},e.metrics)),i={opername:"doc_core",module:"open",action:"open_web",obj3:t,ver5:a,ver6:e.templateId,ver9:n};u.ZP.tdwReport(i)},e}()),F=(o("../node_modules/core-js/modules/es.string.includes.js"),o("../node_modules/i18next/dist/esm/i18next.js")),G=o("../node_modules/@tencent/dui/lib/components/Snackbar/index.js"),Z=o("../node_modules/@tencent/tencent_doc_open_url/dist/index.js");!function(e){e.REPORT="report",e.MONITOR="monitor",e.CLOSE="close"}(U||(U={})),function(e){e[e.STOP=0]="STOP",e[e.WAIT=1]="WAIT",e[e.RUN=2]="RUN"}(b||(b={})),function(e){e.ERROR="error"}(k||(k={}));var B={moduleValue:"jank",actionValue:"heartbeat"};function H(e,t,o,a){var n={opername:e,module:t,action:o,obj3:a,ver3:(0,O.F)(window.SpreadsheetApp.spreadsheet.activeSheetId).isLarge};u.ZP.tdwSingleReport(n)}var W,Q,Y={permission_click:34206089,share_click:34206090,smartSplit_calc:34206079,record_enter:34206073,search_traverse:34206078,fullScreen_click:34206091,sheetbar_addSheet:34206084,sheetbar_removeSheet:34206085,keyframeMutation_copySheet:34206077,sheetbar_switchSheet:34206074,sheetbar_moveSheet:34206086,applyMutation_undo:34206083,applyMutation_redo:34206082,applyMutation_local_0:34206032,applyMutation_local_1:34206033,applyMutation_local_2:34206034,applyMutation_local_3:34206035,applyMutation_local_4:34206036,applyMutation_local_5:34206037,applyMutation_local_6:34206038,applyMutation_local_7:34206039,applyMutation_local_8:34206040,applyMutation_local_9:34206041,applyMutation_local_10:34206042,applyMutation_local_11:34206043,applyMutation_local_12:34206044,applyMutation_local_13:34206045,applyMutation_local_14:34206046,applyMutation_local_15:34206047,applyMutation_local_16:34206048,applyMutation_local_17:34206049,applyMutation_local_18:34206050,applyMutation_local_19:34206051,applyMutation_local_20:34206052,applyMutation_local_21:34206053,applyMutation_local_22:34206054,applyMutation_local_23:34206055,applyMutation_local_24:34206056,applyMutation_local_25:34206057,applyMutation_local_26:34206058,applyMutation_local_27:34206059,applyMutation_local_28:34206060,applyMutation_local_29:34206061,applyMutation_local_30:34206062,applyMutation_local_31:34206063,applyMutation_local_32:34206064,applyMutation_local_33:34206065,applyMutation_local_34:34206066,applyMutation_local_35:34206067,applyMutation_local_36:34206068,applyMutation_local_37:34206069,applyMutation_local_38:34206070,applyMutation_local_39:34206071,keyframe_export:34206072,keyframe_createKeyframe:34206080,keyframeMutation_switchRecordSheet:34206075,copy_analysis:34206076,quickOpen_init:34206093,quickOpen_snapshot:34206094,view_collaborator:34206088,view_scale:34206087,view_resize:34206092,unknown_module_unknown_action:34206106,jank_heartbeat:34206133,"applyMutation_collab_-1":34206191,applyMutation_collab_0:34206151,applyMutation_collab_1:34206152,applyMutation_collab_2:34206153,applyMutation_collab_3:34206154,applyMutation_collab_4:34206155,applyMutation_collab_5:34206156,applyMutation_collab_6:34206157,applyMutation_collab_7:34206158,applyMutation_collab_8:34206159,applyMutation_collab_9:34206160,applyMutation_collab_10:34206161,applyMutation_collab_11:34206162,applyMutation_collab_12:34206163,applyMutation_collab_13:34206164,applyMutation_collab_14:34206165,applyMutation_collab_15:34206166,applyMutation_collab_16:34206167,applyMutation_collab_17:34206168,applyMutation_collab_18:34206169,applyMutation_collab_19:34206170,applyMutation_collab_20:34206171,applyMutation_collab_21:34206172,applyMutation_collab_22:34206173,applyMutation_collab_23:34206174,applyMutation_collab_24:34206175,applyMutation_collab_25:34206176,applyMutation_collab_26:34206177,applyMutation_collab_27:34206178,applyMutation_collab_28:34206179,applyMutation_collab_29:34206180,applyMutation_collab_30:34206181,applyMutation_collab_31:34206182,applyMutation_collab_32:34206183,applyMutation_collab_33:34206184,applyMutation_collab_34:34206185,applyMutation_collab_35:34206186,applyMutation_collab_36:34206187,applyMutation_collab_37:34206188,applyMutation_collab_38:34206189,applyMutation_collab_39:34206190,messageOfflineStore_apply:34206135,messageOfflineStore_followAndApply:34206136,messageCenter_fetchAndApplyCollabNewChanges:34206206,page_refresh:34206195},K={2:35357765,3:33580565,4:33580566,5:33581294,6:33581295,7:33581296,8:33581297,9:33581298,10:33580569},z={2:35357755,3:33580552,4:33580553,5:33580554,6:33580555,7:33580556,8:33580557,9:33580558,10:33580559},J={2:35357768,3:33580573,4:33580574,5:33580575,6:33580576,7:33580577,8:33580578,9:33580579,10:33580580},q=34462711,$=34462712,X=34462713,ee=34462710,te=34462784;W=E().isIOS?K:E().isAndroid?z:J,Q=E().isMac?q:E().isMobilePhone||E().isAndroidPad?$:E().isIPad?X:E().isPC?ee:te;var oe=JSON.parse('{"HeartbeatConfig":{"jankLimit":1000,"TriggerLimit":10,"StopOnPageHidden":true},"PageActiveConfig":{"Limit":80000}}'),ae=1e3,ne=!1,ie=10,re=1,le=function(){function e(){var e=this;this._stack=[],this._status=U.CLOSE,this._jankKey="",this._isJankKeyLocked=!1,this._reportedTimes=0,this._jankKeysForProactiveReport=[m.CONFIG.SHEETS_BAR_JANK_SWITCH_SHEET,m.CONFIG.MUTATION_JANK_NUMBER_FORMAT],this._handleHeart=function(){e._stack=[],e._isJankKeyLocked=!1,e.log(B),e._stop===b.WAIT&&(e._stop=b.RUN)},this._handleJank=function(t){e._reportedTimes=e._reportedTimes+1,e._report(t)&&t>6e3&&re&&(function(){var e;u.ZP.monitor(34861173);var t={message:F.ZP.t("为了有更好的体验，建议关闭不常用的软件或网页。"),style:{zIndex:10003},autoClose:!0,closable:!1,duration:5e3};E().isPCTencentDocsClient?E().isTencentDocsAppVersionAboveOrEqual("1")||(t.message=F.ZP.t("为了有更好的体验，推荐更新到最新版腾讯文档客户端。"),Object.assign(t,{action:F.ZP.t("立即下载"),onClickAction:function(){(0,Z.tencentDocOpenUrlForAll)({url:"https://"+w.Z.getConfig("runtime.domainName")+"/download.html",replace:!1})}})):E().isChromeVersionAboveOrEqual("79")||E().isWxWork||(t.message=F.ZP.t("为了有更好的体验，推荐使用最新版Chrome浏览器。")),null===(e=G.default.show)||void 0===e||e.call(G.default,t)}(),re-=1),e._stop===b.WAIT&&(e._stop=b.RUN),e.closeMonitor(),e.startMonitor()},this._handlePageVisiableChange=function(t){"hidden"===t?e.closeMonitor():e.restartReport()},this._handleOverTask=function(){var t=e._sdk.traceStack.task;if(t[0]&&t[0].time>ae){ie-=1;try{window.log&&window.log.error(F.ZP.t("[卡顿]"),JSON.stringify(t[0]))}catch(o){}H("excel_jank_trace","trace",t[0].id,t[0].time),ie<=0&&e._sdk.traceStack.removeEventListener("overTask",e._handleOverTask)}},this._sdk=new r.ZP(oe),this._sdk.heartbeatMonitor.addEventListener("jank",this._handleJank),this._sdk.heartbeatMonitor.addEventListener("heart",this._handleHeart),this._sdk.heartbeatMonitor.addEventListener("pageVisiableChange",this._handlePageVisiableChange),this._sdk.traceStack.addEventListener("overTask",this._handleOverTask)}var t=e.prototype;return t.log=function(e){var t;if(this._status===U.MONITOR){this._stack.length>500&&this._stack.shift();var o=window.SpreadsheetApp&&(null===(t=window.SpreadsheetApp.messageCenter)||void 0===t?void 0:t.versionManager.getCurrentVersion())||-1,a=window.SpreadsheetApp&&window.SpreadsheetApp.spreadsheet&&window.SpreadsheetApp.spreadsheet.getActiveSheetId()||"unknown";e.baseVersion=o,e.activeSheetId=a,this._stack.push({jankLogOptions:e,time:(new Date).getTime()}),this._isJankKeyLocked||(e.lockJankKey?(this._jankKey=e.moduleValue+"_"+e.actionValue,this._isJankKeyLocked=!0):this._jankKey=e.moduleValue+"_"+e.actionValue)}},t.startMonitor=function(){this._status=U.MONITOR,this._stack=[],this._isJankKeyLocked=!1,this.log(B),this._sdk.heartbeatMonitor.start(),this._sdk.pageActiveMonitor.start()},t.closeMonitor=function(){this._sdk.heartbeatMonitor.stop(),this._sdk.pageActiveMonitor.stop(),this._stack=[],this._status=U.CLOSE,this._isJankKeyLocked=!1},t.stopReport=function(){this._stop=b.STOP},t.restartReport=function(){this._stop=b.WAIT},t._report=function(e){return!!u.ZP.monitor&&!!d.iV&&(this._jankKeysForProactiveReport.includes(this._jankKey)&&this._reportToWeblog(),this.reportStuttersToTAM(e),this._handleMonitor(e),Date.now()-this._sdk.pageActiveMonitor.lastActive()>1e5?(u.ZP.monitor(Q),!0):(this._reportMonitorByTime(e),this._reportMonitorByKey(),this._reportTDW({jankTime:e,action:this.isNormalJank(e)?"crash_count":"crash_count_stutters"}),this.reportZZS(),this._stop!=b.RUN?(e<1e4?u.ZP.monitor(34026365):u.ZP.monitor(34026364),!0):window.SpreadsheetApp.sheetStatus.canEdit?"page_refresh"!==this._jankKey&&(ne||(ne=!0,this._reportTDW({jankTime:e,action:this.isNormalJank(e)?"crash_default":"crash_stutters"}),u.ZP.monitor(34813221)),!0):(e<1e4?u.ZP.monitor(34026367):u.ZP.monitor(34026366),!0)))},t._reportToWeblog=function(){u.ZP.run(this._jankKey)},t._reportMonitorByTime=function(e){e>=2e3&&e<3e3&&u.ZP.monitor(W[2]),e>=3e3&&e<4e3&&u.ZP.monitor(W[3]),e>=4e3&&e<5e3&&u.ZP.monitor(W[4]),e>=5e3&&e<6e3&&u.ZP.monitor(W[5]),e>=6e3&&e<7e3&&u.ZP.monitor(W[6]),e>=7e3&&e<8e3&&u.ZP.monitor(W[7]),e>=8e3&&e<9e3&&u.ZP.monitor(W[8]),e>=9e3&&e<1e4&&u.ZP.monitor(W[9]),e>=1e3&&u.ZP.monitor(W[10])},t._reportMonitorByKey=function(){this._jankKey&&Y[this._jankKey]?u.ZP.monitor(Y[this._jankKey]):u.ZP.monitor(34206107)},t.isNormalJank=function(e){return e>ae&&e<=1e4},t._reportTDW=function(e){var t=e.jankTime,a={action:e.action,opername:"excel_crash_4",module:"crash",obj3:t,ver5:this._jankKey,ver6:o.g.SpreadsheetApp.spreadsheet.spreadsheetId},n=(0,O.F)(o.g.SpreadsheetApp.spreadsheet.activeSheetId);return a.ver3=JSON.stringify(n),u.ZP.tdwReport(a),!0},t.reportZZS=function(){var e,t,a,n,i,r,l;if(!ne){var s={attrid:m.ZZS_REPORT_ATTR.STUTTERS,status:1};if(null===(a=null===(t=null===(e=o.g.SpreadsheetApp)||void 0===e?void 0:e.spreadsheet)||void 0===t?void 0:t.isExternalSheet)||void 0===a?void 0:a.call(t))return s.project=(null===(l=null===(r=null===(i=null===(n=o.g.SpreadsheetApp)||void 0===n?void 0:n.spreadsheet)||void 0===i?void 0:i.activeSheet)||void 0===r?void 0:r.getSheetType)||void 0===l?void 0:l.call(r))||"smartsheet",void u.ZP.zzsStatus(s,!0);u.ZP.zzsStatus(s)}},t.reportStuttersToTAM=function(e){if(e>1e3){var t=(0,O.F)(o.g.SpreadsheetApp.spreadsheet.getActiveSheetId());u.ZP.tam.reportT({name:"stutters_cost",duration:e,ext1:JSON.stringify(t),ext2:JSON.stringify({container:o.g.isContainer?1:0,offline_package:o.g.__isOfflinePkg?1:0}),ext3:""+u.ZP.getSource1()})}},t._handleMonitor=function(e){if(this._status===U.MONITOR)try{this.log({moduleValue:"jank",actionValue:"heartbeat",level:k.ERROR}),window.log&&window.log.info(F.ZP.t("卡顿日志开始_{{VERSION_SUFFIX}}============",{VERSION_SUFFIX:"V2"}));var t=this._calcJankPosition();window.log&&window.log.info(F.ZP.t("卡顿日志结束=================")),t||(t=this._stack[this._stack.length-2]);var o=(null===t||void 0===t?void 0:t.jankLogOptions.moduleValue)||"unknown_module",a=(null===t||void 0===t?void 0:t.jankLogOptions.actionValue)||"unknown_action";this._isJankKeyLocked||(this._jankKey=o+"_"+a),window.log&&window.log.info(F.ZP.t("卡顿，"),this._jankKey,e),this._jankKey,H("excel_jank_type",o,a,e),window.log&&window.log.report("jank_V2_"+this._jankKey)}catch(n){console.error("jank report error",n)}},t._calcJankPosition=function(){for(var e,t=this._stack,o=0;o<t.length;o++){var a=t[o],n=t[o+1];if(a.jankLogOptions.level===k.ERROR?window.log&&window.log.error(new Date(a.time)+(0,d.az)(a.jankLogOptions)):window.log&&window.log.info(new Date(a.time)+(0,d.az)(a.jankLogOptions)),o===t.length-1)break;n.time-a.time>ae&&(e=a)}return e},e}();function se(){var e=c.q.getConfig("corpId"),t=c.q.getConfig("corpName");c.q.setConfig({userLoginCorpId:e||"",userLoginCorpName:t||""})}var ue=function(){},de={run:function(e){if(V[e]){for(var t=arguments.length,o=new Array(t>1?t-1:0),a=1;a<t;a++)o[a-1]=arguments[a];V[e].apply(V,o)}},CONFIG:n.Z.config.report.CONFIG,speed:x,tam:window.aegis||{reportTime:y,reportEvent:y,reportT:y},jank:new le,tdwReport:(0,r.Hr)(i.tdw,"tdwReport"),tdwSingleReport:(0,r.Hr)(i.tdwSingle,"tdwSingleReport"),monitor:i.monitor,huatuo:i.huatuo,retcode:i.retcode,zzsStatus:i.zzsStatus,zzsValue:i.zzsValue,tipReport:i.tipReport,resetDefaultTdwData:i.resetDefaultTdwData,getSource1:i.getSource1,kvrOss:ue,idkey:ue}},"../spread-sheet/src/external/view/main/panel/rangeAuthPanel/utils/request-utils.ts":function(e,t,o){o.d(t,{DR:function(){return _},I4:function(){return f},Iw:function(){return m},Vj:function(){return c},b6:function(){return u},iE:function(){return p},oc:function(){return d}}),o("../node_modules/core-js/modules/es.array.iterator.js"),o("../node_modules/core-js/modules/es.map.js"),o("../node_modules/core-js/modules/es.object.to-string.js"),o("../node_modules/core-js/modules/es.string.iterator.js"),o("../node_modules/core-js/modules/esnext.map.delete-all.js"),o("../node_modules/core-js/modules/esnext.map.every.js"),o("../node_modules/core-js/modules/esnext.map.filter.js"),o("../node_modules/core-js/modules/esnext.map.find.js"),o("../node_modules/core-js/modules/esnext.map.find-key.js"),o("../node_modules/core-js/modules/esnext.map.includes.js"),o("../node_modules/core-js/modules/esnext.map.key-of.js"),o("../node_modules/core-js/modules/esnext.map.map-keys.js"),o("../node_modules/core-js/modules/esnext.map.map-values.js"),o("../node_modules/core-js/modules/esnext.map.merge.js"),o("../node_modules/core-js/modules/esnext.map.reduce.js"),o("../node_modules/core-js/modules/esnext.map.some.js"),o("../node_modules/core-js/modules/esnext.map.update.js"),o("../node_modules/core-js/modules/web.dom-collections.iterator.js"),o("../node_modules/core-js/modules/es.object.assign.js"),o("../node_modules/core-js/modules/web.dom-collections.for-each.js");var a,n,i,r=o("../node_modules/i18next/dist/esm/i18next.js"),l=o("../node_modules/@tencent/dui/lib/components/Snackbar/index.js"),s=o("../spread-sheet/src/external/rangeAuth/config/auth-constant.ts");function u(){l.default.show({type:"error",message:r.ZP.t("拉取权限失败，请重试"),autoClose:!0,style:{zIndex:10004}})}function d(){l.default.show({type:"success",message:r.ZP.t("设置成功"),autoClose:!0,style:{zIndex:10004}})}function c(){l.default.show({type:"error",message:r.ZP.t("设置失败，请重试"),autoClose:!0,style:{zIndex:10004}})}function _(){l.default.show({type:"success",message:r.ZP.t("取消保护成功"),autoClose:!0,style:{zIndex:10004}})}!function(e){e[e.QQ=1]="QQ",e[e.WeChat=2]="WeChat",e[e.WeWork=3]="WeWork",e[e.Email=4]="Email",e[e.Phone=8]="Phone",e[e.WeWorkCombination=9]="WeWorkCombination",e[e.Tower=10]="Tower",e[e.Rebot=11]="Rebot",e[e.QFYF=12]="QFYF",e[e.MinGroup=100]="MinGroup",e[e.QQGroup=102]="QQGroup",e[e.QQDiscGroup=103]="QQDiscGroup",e[e.TDocGroup=104]="TDocGroup",e[e.WeWorkDpt=105]="WeWorkDpt",e[e.QFYFDpt=106]="QFYFDpt"}(a||(a={})),function(e){e[e.QQ=1]="QQ",e[e.QQUid=2]="QQUid",e[e.WeChat=3]="WeChat",e[e.WeWork=4]="WeWork",e[e.QFYF=5]="QFYF",e[e.QQGroup=6]="QQGroup",e[e.QQDiscGroup=7]="QQDiscGroup",e[e.TDocGroup=8]="TDocGroup",e[e.WeWorkDpt=9]="WeWorkDpt",e[e.QFYFDpt=10]="QFYFDpt"}(n||(n={})),function(e){e[e.QQ=0]="QQ",e[e.QQUid=1]="QQUid",e[e.QQGroup=2]="QQGroup",e[e.QQDiscGroup=3]="QQDiscGroup",e[e.TDocGroup=4]="TDocGroup",e[e.WeWorkDpt=5]="WeWorkDpt",e[e.OpenPlatform=6]="OpenPlatform",e[e.QFYFDpt=7]="QFYFDpt"}(i||(i={}));var E=function(e,t){var o;return null!==(o=new Map([[i.QQ,n.QQ],[i.QQUid,n.QQUid],[65535,n.QQUid]]).get(t))&&void 0!==o?o:e};function T(e){var t=String(e);return e?t:e}function p(e,t){var o=T(e.qquin||e.uin),a=T(e.uinSrc),n=T(t.qquin||t.uin),i=T(t.uinSrc);return e.uidSource===t.uidSource&&(3===e.uidSource?function(e,t){return e.corp_id===t.corp_id&&e.work_id===t.work_id}(e,t):function(e){return 104===e.uidSource||2===e.uidSource}(e)?e.uin===t.uin:function(e,t,o,a){return!(!e||e!==t)||!(!e||e!==a)||!(!o||o!==t)}(o,n,a,i))}function m(e,t){if(!function(e,t){return""!==e.uid&&""!==t.uid&&e.uid===t.uid}(e,t))return!1;if(function(e,t){return e.uidSource!==t.uidSource&&e.nick===t.nick}(e,t)){var o=(i=t.uidSource,r=t.uintype,new Map([[a.QQ,E(i,r)],[a.WeChat,n.WeChat],[a.WeWork,n.WeWork],[a.QFYF,n.QFYF],[a.QQGroup,n.QQGroup],[a.QQDiscGroup,n.QQDiscGroup],[a.TDocGroup,n.TDocGroup],[a.WeWorkDpt,n.WeWorkDpt],[a.QFYFDpt,n.QFYFDpt]]).get(i));return e.uidSource===o}var i,r;return!1}function R(e,t){if(void 0===t&&(t=[]),!Array.isArray(t))return!1;for(var o=!1,a=0;a<t.length;a++)if(p(e,t[a])){o=!0;break}return o}function f(e,t){void 0===e&&(e=[]),void 0===t&&(t=[]);var o=[],a=[];return e.forEach((function(e){var a;R(e,t)||o.push((a=e,Object.assign(Object.assign({},a),{rangePrivilegeType:s.M.CAN_EDIT})))})),t.forEach((function(t){R(t,e)||a.push(Object.assign({},t))})),{addmemlist:o,submemlist:a}}},"../spread-sheet/src/external/view/workbench/service/notification.ts":function(e,t,o){o.d(t,{Q2:function(){return s},c0:function(){return r},yK:function(){return l}});var a=o("../spread-sheet/src/base/index.ts"),n=o("../spread-sheet/src/core/script-loader/index.ts"),i=!1;function r(){(0,n.$y)("Notifications",(function(e,t){var n;if(t){var r=document.createElement("div");r.setAttribute("id","notification-container"),$(document.body).append(r),$("#notification-container").addClass("notification-container-hide"),$("#notification-container").addClass("notification-container-slide-animation");var s=$("#headerTop").outerHeight()+$("#headerBottom").outerHeight(),u=parseInt($("#mainContainer").css("top"),10)+parseInt($("#headerBottom").css("top"),10),d=parseInt($(".sheet-bottom-pc").css("height"),10);$("#notification-container").css({top:s+u+1+"px",height:"calc(100% - "+(s+u+d)+"px"});var c={from:"core-doc"};window.spreadConfig.getConfig("isCreator")&&(c.domainId=window.spreadConfig.getConfig("domainId"),c.localPadId=window.spreadConfig.getConfig("padId")),e.showNotification(r,c),setTimeout((function(){$("#notification-container").removeClass("notification-container-hide"),$("#notification-container").addClass("notification-container-show")}),1),null===(n=o.g.SLR)||void 0===n||n.listen("NOTIFICATION-CLOSE",(function(){l()}))}i||(i=!0,$("#notification-container").removeClass("notification-container-hide"),$("#notification-container").addClass("notification-container-show"),window.SLR.dispatch("NOTIFICATION_WND_DID_SHOW")),a.Z.event.default.trigger("notificationShow",!0)}))}function l(){if(i){i=!1,$("#notification-container").removeClass("notification-container-show"),$("#notification-container").addClass("notification-container-hide");var e=new CustomEvent("notification-reset-current-edit");document.dispatchEvent(e),window.SLR.dispatch("NOTIFICATION_WND_WILL_HIDEN"),a.Z.event.default.trigger("notificationShow",!1)}}function s(){return i}}}]),window.jsExecEndTimeStamp=Date.now(),window.cachedPerformanceEntries||(window.cachedPerformanceEntries=[]),window.cachedPerformanceEntries.push({name:"jsExec: js/spread-sheet_src_core_workbench_common_base-drawer_tsx-spread-sheet_src_external_rangeAuth_ut-2939e0.024d7708a39c54713bd7.js",entryType:"jsExec",startTime:window.jsExecStartTimeStamp,endTime:window.jsExecEndTimeStamp});
//# sourceMappingURL=spread-sheet_src_core_workbench_common_base-drawer_tsx-spread-sheet_src_external_rangeAuth_ut-2939e0.024d7708a39c54713bd7.js.map