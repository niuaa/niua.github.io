self.window=self,window.jsExecStartTimeStamp=Date.now(),(self.webpackChunk_tencent_alloy_builder=self.webpackChunk_tencent_alloy_builder||[]).push([["bundle_workbench_pc","spread-sheet_src_core_view_level-2_condition-format-center_ui_utils_dataUtils_ts"],{"../spread-sheet/src/base/util/decorator/loading-decorator.ts":function(e,t,n){n.d(t,{n:function(){return o}}),n("../node_modules/regenerator-runtime/runtime.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.promise.js"),n("../node_modules/core-js/modules/es.array.concat.js");var r=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function s(e){try{c(r.next(e))}catch(t){i(t)}}function a(e){try{c(r.throw(e))}catch(t){i(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))};function o(){return function(e,t,o){var i=o.value;o.value=function(){for(var e=arguments.length,t=new Array(e),o=0;o<e;o++)t[o]=arguments[o];var s,a;return r(this,void 0,void 0,regeneratorRuntime.mark((function e(){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return null===(s=n.g.snackLoading)||void 0===s||s.show(3e3),e.next=3,i.call.apply(i,[this].concat(t));case 3:return r=e.sent,null===(a=n.g.snackLoading)||void 0===a||a.hide(),e.abrupt("return",r);case 6:case"end":return e.stop()}}),e,this)})))}}}},"../spread-sheet/src/core/view/level-2/condition-format-center/condition-type-data/ConditionTypeInterface.ts":function(e,t,n){var r;n.d(t,{P:function(){return r}}),function(e){e[e.INPUT=0]="INPUT",e[e.DOUBLE_INPUT=1]="DOUBLE_INPUT",e[e.SELECT=2]="SELECT"}(r||(r={}))},"../spread-sheet/src/core/view/level-2/condition-format-center/condition-type-data/ConditionTypeMap.ts":function(e,t,n){n.d(t,{Z:function(){return M}});var r,o=n("../packages/model/src/rule/index.ts"),i=n("../node_modules/i18next/dist/esm/i18next.js"),s=n("../spread-sheet/src/core/view/level-2/condition-format-center/condition-type-data/ConditionTypeInterface.ts"),a=n("../spread-sheet/src/core/utils/numberFromat.ts"),c=n("../spread-sheet/src/core/view/level-2/condition-format-center/condition-type-data/check-utils.ts"),d=function(){function e(){this.inputType={type:s.P.INPUT,placeHolder:i.ZP.t("数值")},this.reportKey="num_greater"}var t=e.prototype;return t.getTitle=function(){return i.ZP.t("大于")},t.getDescription=function(e){return i.ZP.t("大于{{inputOne}}",{inputOne:e})},t.checkInputValid=function(e){return null===e?c.tG:(0,a.isLeagalNumber)(e)?null:c.tG},t.hasInputOne=function(){return!0},t.hasInputTwo=function(){return!1},e}(),l=function(){function e(){this.inputType={type:s.P.INPUT,placeHolder:i.ZP.t("数值")},this.reportKey="num_greater_equal"}var t=e.prototype;return t.getTitle=function(){return i.ZP.t("大于或等于")},t.getDescription=function(e){return i.ZP.t("大于或等于{{inputOne}}",{inputOne:e})},t.checkInputValid=function(e){return null===e?c.tG:(0,a.isLeagalNumber)(e)?null:c.tG},t.hasInputOne=function(){return!0},t.hasInputTwo=function(){return!1},e}(),u=function(){function e(){this.inputType={type:s.P.INPUT,placeHolder:i.ZP.t("数值")},this.reportKey="num_less"}var t=e.prototype;return t.getTitle=function(){return i.ZP.t("小于")},t.getDescription=function(e){return i.ZP.t("小于{{inputOne}}",{inputOne:e})},t.checkInputValid=function(e){return null===e?c.tG:(0,a.isLeagalNumber)(e)?null:c.tG},t.hasInputOne=function(){return!0},t.hasInputTwo=function(){return!1},e}(),_=function(){function e(){this.inputType={type:s.P.INPUT,placeHolder:i.ZP.t("数值")},this.reportKey="num_less_equal"}var t=e.prototype;return t.getTitle=function(){return i.ZP.t("小于或等于")},t.getDescription=function(e){return i.ZP.t("小于或等于{{inputOne}}",{inputOne:e})},t.checkInputValid=function(e){return null===e?c.tG:(0,a.isLeagalNumber)(e)?null:c.tG},t.hasInputOne=function(){return!0},t.hasInputTwo=function(){return!1},e}(),p=function(){function e(){this.inputType={type:s.P.INPUT,placeHolder:i.ZP.t("数值")},this.reportKey="num_equal"}var t=e.prototype;return t.getTitle=function(){return i.ZP.t("等于")},t.getDescription=function(e){return i.ZP.t("等于{{inputOne}}",{inputOne:e})},t.checkInputValid=function(e){return null===e?c.tG:(0,a.isLeagalNumber)(e)?null:c.tG},t.hasInputOne=function(){return!0},t.hasInputTwo=function(){return!1},e}(),f=function(){function e(){this.inputType={type:s.P.INPUT,placeHolder:i.ZP.t("数值")},this.reportKey="num_not_equal"}var t=e.prototype;return t.getTitle=function(){return i.ZP.t("不等于")},t.getDescription=function(e){return i.ZP.t("不等于{{inputOne}}",{inputOne:e})},t.checkInputValid=function(e){return null===e?c.tG:(0,a.isLeagalNumber)(e)?null:c.tG},t.hasInputOne=function(){return!0},t.hasInputTwo=function(){return!1},e}(),h=n("../spread-sheet/src/core/view/level-2/condition-format-center/data/custom-formula/condition-number-rules.ts"),m=function(){function e(){this.inputType={type:s.P.DOUBLE_INPUT,placeHolder:[i.ZP.t("数值"),i.ZP.t("数值")]},this.reportKey="num_between"}var t=e.prototype;return t.getTitle=function(){return i.ZP.t("介于")},t.getDescription=function(e,t){return i.ZP.t("介于{{inputOne}}和{{inputTwo}}",{inputOne:e,inputTwo:t})},t.checkInputValid=function(e,t){return null===e||null===t?c.tG:(0,a.isLeagalNumber)(e)&&(0,a.isLeagalNumber)(t)?(0,h.p3)(e)>(0,h.p3)(t)?c.tG:null:c.tG},t.hasInputOne=function(){return!0},t.hasInputTwo=function(){return!0},e}(),v=function(){function e(){this.inputType={type:s.P.DOUBLE_INPUT,placeHolder:[i.ZP.t("数值"),i.ZP.t("数值")]},this.reportKey="num_not_between"}var t=e.prototype;return t.getTitle=function(){return i.ZP.t("不介于")},t.getDescription=function(e,t){return i.ZP.t("不介于{{inputOne}}和{{inputTwo}}",{inputOne:e,inputTwo:t})},t.checkInputValid=function(e,t){return null===e||null===t?c.tG:(0,a.isLeagalNumber)(e)&&(0,a.isLeagalNumber)(t)?(0,h.p3)(e)>(0,h.p3)(t)?c.tG:null:c.tG},t.hasInputOne=function(){return!0},t.hasInputTwo=function(){return!0},e}(),y=function(){function e(){this.inputType={type:s.P.INPUT,placeHolder:i.ZP.t("文本、数值或公式")},this.reportKey="text_contain"}var t=e.prototype;return t.getTitle=function(){return i.ZP.t("文本包含")},t.getDescription=function(e){return i.ZP.t("文本包含{{inputOne}}",{inputOne:e})},t.checkInputValid=function(e){return null===e||""===e?c.cl:null},t.hasInputOne=function(){return!0},t.hasInputTwo=function(){return!1},e}(),g=function(){function e(){this.inputType={type:s.P.INPUT,placeHolder:i.ZP.t("文本、数值或公式")},this.reportKey="text_not_contain"}var t=e.prototype;return t.getTitle=function(){return i.ZP.t("文本不包含")},t.getDescription=function(e){return i.ZP.t("文本不包含{{inputOne}}",{inputOne:e})},t.checkInputValid=function(e){return null===e||""===e?c.cl:null},t.hasInputOne=function(){return!0},t.hasInputTwo=function(){return!1},e}(),E=function(){function e(){this.inputType={type:s.P.INPUT,placeHolder:i.ZP.t("文本、数值或公式")},this.reportKey="text_start_with"}var t=e.prototype;return t.getTitle=function(){return i.ZP.t("文本开头为")},t.getDescription=function(e){return i.ZP.t("文本开头为{{inputOne}}",{inputOne:e})},t.checkInputValid=function(e){return null===e||""===e?c.cl:null},t.hasInputOne=function(){return!0},t.hasInputTwo=function(){return!1},e}(),w=function(){function e(){this.inputType={type:s.P.INPUT,placeHolder:i.ZP.t("文本、数值或公式")},this.reportKey="text_end_with"}var t=e.prototype;return t.getTitle=function(){return i.ZP.t("文本结尾为")},t.getDescription=function(e){return i.ZP.t("文本结尾为{{inputOne}}",{inputOne:e})},t.checkInputValid=function(e){return null===e||""===e?c.cl:null},t.hasInputOne=function(){return!0},t.hasInputTwo=function(){return!1},e}(),b=function(){function e(){this.inputType={type:s.P.INPUT,placeHolder:i.ZP.t("文本、数值或公式")},this.reportKey="text_equal"}var t=e.prototype;return t.getTitle=function(){return i.ZP.t("文本等于")},t.getDescription=function(e){return i.ZP.t("文本等于{{inputOne}}",{inputOne:e})},t.checkInputValid=function(e){return null===e||""===e?c.cl:null},t.hasInputOne=function(){return!0},t.hasInputTwo=function(){return!1},e}(),T=function(){function e(){this.inputType=null,this.reportKey="text_blank"}var t=e.prototype;return t.getTitle=function(){return i.ZP.t("单元格为空")},t.getDescription=function(){return i.ZP.t("单元格为空")},t.checkInputValid=function(){return null},t.hasInputOne=function(){return!1},t.hasInputTwo=function(){return!1},e}(),R=function(){function e(){this.inputType=null,this.reportKey="text_not_blank"}var t=e.prototype;return t.getTitle=function(){return i.ZP.t("单元格有内容")},t.getDescription=function(){return i.ZP.t("单元格有内容")},t.checkInputValid=function(){return null},t.hasInputOne=function(){return!1},t.hasInputTwo=function(){return!1},e}(),I=function(){function e(){this.inputType=null,this.reportKey="error"}var t=e.prototype;return t.getTitle=function(){return i.ZP.t("错误")},t.getDescription=function(){return i.ZP.t("错误")},t.checkInputValid=function(){return null},t.hasInputOne=function(){return!1},t.hasInputTwo=function(){return!1},e}(),C=function(){function e(){this.inputType=null,this.reportKey="error_not"}var t=e.prototype;return t.getTitle=function(){return i.ZP.t("无错误")},t.getDescription=function(){return i.ZP.t("无错误")},t.checkInputValid=function(){return null},t.hasInputOne=function(){return!1},t.hasInputTwo=function(){return!1},e}(),A=function(){function e(){this.inputType=null,this.reportKey="num_repetition"}var t=e.prototype;return t.getTitle=function(){return i.ZP.t("重复值")},t.getDescription=function(){return i.ZP.t("重复值")},t.checkInputValid=function(){return null},t.hasInputOne=function(){return!1},t.hasInputTwo=function(){return!1},e}(),x=function(){function e(){var e=this;this.inputType={type:s.P.SELECT,options:[{title:i.ZP.t("昨天"),value:"=TODAY()-1|=TODAY()-1"},{title:i.ZP.t("今天"),value:"=TODAY()|=TODAY()"},{title:i.ZP.t("明天"),value:"=TODAY()+1|=TODAY()+1"},{title:i.ZP.t("最近 7 天"),value:"=TODAY()-6|=TODAY()"},{title:i.ZP.t("上周"),value:"=TODAY()-WEEKDAY(TODAY()-1)-7|=TODAY()-WEEKDAY(TODAY()-1)-1"},{title:i.ZP.t("本周"),value:"=TODAY()-WEEKDAY(TODAY()-1)|=TODAY()-WEEKDAY(TODAY()-1)+6"},{title:i.ZP.t("下周"),value:"=TODAY()-WEEKDAY(TODAY()-1)+7|=TODAY()-WEEKDAY(TODAY()-1)+13"},{title:i.ZP.t("上月"),value:"=EOMONTH(TODAY(),-2)+1|=EOMONTH(TODAY(),-1)"},{title:i.ZP.t("本月"),value:"=EOMONTH(TODAY(),-1)+1|=EOMONTH(TODAY(),0)"},{title:i.ZP.t("下月"),value:"=EOMONTH(TODAY(),0)+1|=EOMONTH(TODAY(),1)"},{title:i.ZP.t("具体日期"),value:"SHOW_INPUT"}],needExtraInput:function(t){if(""===t)return!1;if("SHOW_INPUT"===t)return!0;for(var n=e.inputType.options,r=0;r<n.length;r++)if(n[r].value===t)return!1;return!0}},this.reportKey="date_equal"}var t=e.prototype;return t.getTitle=function(){return i.ZP.t("日期为")},t.getDescription=function(e){for(var t="",n=this.inputType.options,r=0;r<n.length;r++)if(n[r].value===e){t=n[r].title;break}return i.ZP.t("日期为{{value}}",{value:t||e})},t.checkInputValid=function(e){return this.inputType.needExtraInput(e)?(0,c.jP)(e):(0,c.mr)(this.inputType.options,e)?null:c.cl},t.hasInputOne=function(){return!0},t.hasInputTwo=function(){return!1},e}(),O=function(){function e(){var e=this;this.inputType={type:s.P.SELECT,options:[{title:i.ZP.t("昨天"),value:"=TODAY()-1"},{title:i.ZP.t("今天"),value:"=TODAY()"},{title:i.ZP.t("明天"),value:"=TODAY()+1"},{title:i.ZP.t("具体日期"),value:"SHOW_INPUT"}],needExtraInput:function(t){if(""===t)return!1;if("SHOW_INPUT"===t)return!0;for(var n=e.inputType.options,r=0;r<n.length;r++)if(n[r].value===t)return!1;return!0}},this.reportKey="date_before"}var t=e.prototype;return t.getTitle=function(){return i.ZP.t("日期早于")},t.getDescription=function(e){for(var t="",n=this.inputType.options,r=0;r<n.length;r++)if(n[r].value===e){t=n[r].title;break}return i.ZP.t("日期早于{{value}}",{value:t||e})},t.checkInputValid=function(e){return this.inputType.needExtraInput(e)?(0,c.jP)(e):(0,c.mr)(this.inputType.options,e)?null:c.cl},t.hasInputOne=function(){return!0},t.hasInputTwo=function(){return!1},e}(),N=function(){function e(){var e=this;this.inputType={type:s.P.SELECT,options:[{title:i.ZP.t("昨天"),value:"=TODAY()-1"},{title:i.ZP.t("今天"),value:"=TODAY()"},{title:i.ZP.t("明天"),value:"=TODAY()+1"},{title:i.ZP.t("具体日期"),value:"SHOW_INPUT"}],needExtraInput:function(t){if(""===t)return!1;if("SHOW_INPUT"===t)return!0;for(var n=e.inputType.options,r=0;r<n.length;r++)if(n[r].value===t)return!1;return!0}},this.reportKey="date_after"}var t=e.prototype;return t.getTitle=function(){return i.ZP.t("日期晚于")},t.getDescription=function(e){for(var t="",n=this.inputType.options,r=0;r<n.length;r++)if(n[r].value===e){t=n[r].title;break}return i.ZP.t("日期晚于{{value}}",{value:t||e})},t.checkInputValid=function(e){return this.inputType.needExtraInput(e)?(0,c.jP)(e):(0,c.mr)(this.inputType.options,e)?null:c.cl},t.hasInputOne=function(){return!0},t.hasInputTwo=function(){return!1},e}(),S=function(){function e(){this.inputType={type:s.P.DOUBLE_INPUT,placeHolder:["2020/6/1","2020/6/30"]},this.reportKey="date_between"}var t=e.prototype;return t.getTitle=function(){return i.ZP.t("日期介于")},t.getDescription=function(e,t){return i.ZP.t("日期介于{{inputOne}}和{{inputTwo}}",{inputOne:e,inputTwo:t})},t.checkInputValid=function(e,t){return(0,c.M_)(e,t)},t.hasInputOne=function(){return!0},t.hasInputTwo=function(){return!0},e}(),k=function(){function e(){this.inputType={type:s.P.DOUBLE_INPUT,placeHolder:["2020/6/1","2020/6/30"]},this.reportKey="date_not_between"}var t=e.prototype;return t.getTitle=function(){return i.ZP.t("日期不介于")},t.getDescription=function(e,t){return i.ZP.t("日期不介于{{inputOne}}和{{inputTwo}}",{inputOne:e,inputTwo:t})},t.checkInputValid=function(e,t){return(0,c.M_)(e,t)},t.hasInputOne=function(){return!0},t.hasInputTwo=function(){return!0},e}(),P=function(){function e(){this.inputType=null,this.reportKey="num_unique"}var t=e.prototype;return t.getTitle=function(){return i.ZP.t("唯一值")},t.getDescription=function(){return i.ZP.t("唯一值")},t.checkInputValid=function(){return null},t.hasInputOne=function(){return!1},t.hasInputTwo=function(){return!1},e}(),D=n("../spread-sheet/src/core/utils/formula.ts"),L=function(){function e(){this.inputType={type:s.P.INPUT,placeHolder:i.ZP.t("公式")},this.reportKey="custom_formula"}var t=e.prototype;return t.getTitle=function(){return i.ZP.t("自定义公式")},t.getDescription=function(e){return i.ZP.t("公式为 {{inputOne}}",{inputOne:e})},t.checkInputValid=function(e){return e&&(0,D.isFormulaString)(e)&&(0,D.isLegalFormula)(e)?null:c.cl},t.hasInputOne=function(){return!0},t.hasInputTwo=function(){return!1},e}(),M=((r={})[o.CONDITION_TYPE.NUMBER_GREATER]=new d,r[o.CONDITION_TYPE.NUMBER_GREATER_THAN_EQ]=new l,r[o.CONDITION_TYPE.NUMBER_LESS]=new u,r[o.CONDITION_TYPE.NUMBER_LESS_THAN_EQ]=new _,r[o.CONDITION_TYPE.NUMBER_EQ]=new p,r[o.CONDITION_TYPE.NUMBER_NOT_EQ]=new f,r[o.CONDITION_TYPE.NUMBER_BETWEEN]=new m,r[o.CONDITION_TYPE.NUMBER_NOT_BETWEEN]=new v,r[o.CONDITION_TYPE.TEXT_CONTAINS]=new y,r[o.CONDITION_TYPE.TEXT_NOT_CONTAINS]=new g,r[o.CONDITION_TYPE.TEXT_STARTS_WITH]=new E,r[o.CONDITION_TYPE.TEXT_ENDS_WITH]=new w,r[o.CONDITION_TYPE.TEXT_EQ]=new b,r[o.CONDITION_TYPE.DATE_EQ]=new x,r[o.CONDITION_TYPE.DATE_BEFORE]=new O,r[o.CONDITION_TYPE.DATE_AFTER]=new N,r[o.CONDITION_TYPE.DATE_BETWEEN]=new S,r[o.CONDITION_TYPE.DATE_NOT_BETWEEN]=new k,r[o.CONDITION_TYPE.BLANK]=new T,r[o.CONDITION_TYPE.NOT_BLANK]=new R,r[o.CONDITION_TYPE.CUSTOM_FORMULA]=new L,r[o.CONDITION_TYPE.ERROR]=new I,r[o.CONDITION_TYPE.NOT_ERROR]=new C,r[o.CONDITION_TYPE.REPEAT]=new A,r[o.CONDITION_TYPE.UNIQUE]=new P,r)},"../spread-sheet/src/core/view/level-2/condition-format-center/condition-type-data/check-utils.ts":function(e,t,n){n.d(t,{M_:function(){return l},cl:function(){return i},jP:function(){return d},mr:function(){return c},tG:function(){return s}});var r=n("../node_modules/i18next/dist/esm/i18next.js"),o=n("../packages/model/src/utils/numberFormat/FormatParseEngine.ts"),i=r.ZP.t("请输入有效的参数。"),s=r.ZP.t("请输入有效的数值。"),a=r.ZP.t("请输入有效的日期。");function c(e,t){if(null===t)return!1;for(var n=0;n<e.length;n++)if(e[n].value===t)return!0;return!1}function d(e){return null===e?a:(0,o.parseDate)(e)?null:a}function l(e,t){if(null===e||null===t)return a;var n=(0,o.parseDate)(e),r=(0,o.parseDate)(t);return n&&r?n.numericValue>r.numericValue?a:null:a}r.ZP.t("前面的日期要小于后面的日期。")},"../spread-sheet/src/core/view/level-2/condition-format-center/ui/rule-datas/rule-datas.ts":function(e,t,n){n.d(t,{Ar:function(){return a},Fv:function(){return f},Nd:function(){return _},Rl:function(){return l},Sl:function(){return c},XH:function(){return p},c8:function(){return v},jZ:function(){return u},lK:function(){return h},lY:function(){return r},mU:function(){return d},ny:function(){return y}}),n("../node_modules/core-js/modules/es.object.assign.js");var r,o=n("../node_modules/i18next/dist/esm/i18next.js"),i=n("../packages/model/src/rule/index.ts"),s=n("../packages/model/src/rule/InterpolationPoint.ts");!function(e){e.GRADIENT="GRADIENT",e.DATA_BAR="DATA_BAR"}(r||(r={}));var a=[i.CONDITION_TYPE.NUMBER_GREATER,i.CONDITION_TYPE.NUMBER_LESS,i.CONDITION_TYPE.NUMBER_BETWEEN,i.CONDITION_TYPE.NUMBER_NOT_BETWEEN,i.CONDITION_TYPE.NUMBER_EQ,i.CONDITION_TYPE.NUMBER_NOT_EQ,i.CONDITION_TYPE.NUMBER_GREATER_THAN_EQ,i.CONDITION_TYPE.NUMBER_LESS_THAN_EQ],c=[i.CONDITION_TYPE.TEXT_CONTAINS,i.CONDITION_TYPE.TEXT_NOT_CONTAINS,i.CONDITION_TYPE.TEXT_EQ,i.CONDITION_TYPE.BLANK,i.CONDITION_TYPE.NOT_BLANK,i.CONDITION_TYPE.TEXT_STARTS_WITH,i.CONDITION_TYPE.TEXT_ENDS_WITH,i.CONDITION_TYPE.ERROR,i.CONDITION_TYPE.NOT_ERROR],d=[i.CONDITION_TYPE.DATE_EQ,i.CONDITION_TYPE.DATE_BEFORE,i.CONDITION_TYPE.DATE_AFTER,i.CONDITION_TYPE.DATE_BETWEEN,i.CONDITION_TYPE.DATE_NOT_BETWEEN],l=[r.DATA_BAR],u=[r.GRADIENT],_=[i.CONDITION_TYPE.REPEAT],p=[i.CONDITION_TYPE.UNIQUE],f=[i.CONDITION_TYPE.CUSTOM_FORMULA],h=[{color:"#DE322C",bgColor:"#FFE9E8",title:o.ZP.t("浅红色填充+深红色文本"),isCustom:!1},{color:"#BF711D",bgColor:"#FEFBC6",title:o.ZP.t("浅黄色填充+深黄色文本"),isCustom:!1},{color:"#00AA5B",bgColor:"#EEFCDE",title:o.ZP.t("浅绿色填充+深绿色文本"),isCustom:!1},{color:"#C2C2C2",bgColor:"#F5F5F5",title:o.ZP.t("浅灰色填充+浅灰色文本"),isCustom:!1},{color:"#DE322C",title:o.ZP.t("红色文本"),isCustom:!1},{color:"#C2C2C2",strikethrough:!0,title:o.ZP.t("灰色文本+删除线"),isCustom:!1}],m=function(){return{inputOne:{type:s.u.MIN,value:""},inputTwo:{type:s.u.MAX,value:""},title:"",isCustom:!1}},v=[Object.assign(Object.assign({},m()),{minColor:"#E0EAFF",maxColor:"#2F77F7"}),Object.assign(Object.assign({},m()),{minColor:"#EEFCDE",maxColor:"#83D12A"}),Object.assign(Object.assign({},m()),{minColor:"#FFE9E8",maxColor:"#DE322C"}),Object.assign(Object.assign({},m()),{minColor:"#FFEFD6",maxColor:"#F5971D"})],y=[Object.assign(Object.assign({},m()),{negativeColor:"#BED4FA",positiveColor:"#FACAC8"}),Object.assign(Object.assign({},m()),{negativeColor:"#BBEBFC",positiveColor:"#FCE0B6"}),Object.assign(Object.assign({},m()),{negativeColor:"#BAF5DF",positiveColor:"#F7F19E"}),Object.assign(Object.assign({},m()),{negativeColor:"#2F77F7",positiveColor:"#DE322C"}),Object.assign(Object.assign({},m()),{negativeColor:"#22BDF5",positiveColor:"#F5971D"}),Object.assign(Object.assign({},m()),{negativeColor:"#31CC93",positiveColor:"#F5D505"})]},"../spread-sheet/src/core/view/level-2/condition-format-center/ui/utils/dataUtils.ts":function(e,t,n){n.d(t,{Eb:function(){return A},FL:function(){return r},M3:function(){return b},UY:function(){return T},V4:function(){return R},YQ:function(){return C},_p:function(){return m},be:function(){return I},c1:function(){return O},j0:function(){return x},l5:function(){return v},mU:function(){return w}}),n("../node_modules/core-js/modules/es.array.join.js"),n("../node_modules/core-js/modules/es.array.map.js"),n("../node_modules/core-js/modules/es.array.iterator.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/web.dom-collections.iterator.js"),n("../node_modules/core-js/modules/es.string.italics.js"),n("../node_modules/core-js/modules/es.string.bold.js"),n("../node_modules/core-js/modules/es.array.sort.js"),n("../node_modules/core-js/modules/es.array.filter.js"),n("../node_modules/core-js/modules/es.regexp.to-string.js");var r,o=n("../node_modules/i18next/dist/esm/i18next.js"),i=n("../packages/model/src/range/index.ts"),s=n("../spread-sheet/src/core/view/level-2/condition-format-center/condition-type-data/ConditionTypeMap.ts"),a=n("../packages/report/src/index.ts"),c=n("../spread-sheet/src/core/view/level-2/condition-format-center/condition-type-data/ConditionTypeInterface.ts"),d=n("../packages/model/src/range/hexRangeUtils.ts"),l=(n("../spread-sheet/src/core/view/level-1/select-center/base/utils.ts"),n("../spread-sheet/src/core/view/level-2/condition-format-center/ui/rule-datas/rule-datas.ts")),u=n("../packages/model/src/rule/InterpolationPoint.ts"),_=n("../spread-sheet/src/core/view/level-2/condition-format-center/condition-type-data/check-utils.ts"),p=n("../packages/model/src/rule/ArgTokenType.ts"),f=n("../packages/model/src/cell/format/Color.ts"),h=n("../spread-sheet/src/core/utils/numberFromat.ts");function m(e){var t=s.Z[e];if(!t||null===t.inputType)return r.EMPTY;var n=s.Z[e]&&function(e){return s.Z[e].hasInputTwo()}(e);switch(t.inputType.type){case c.P.INPUT:return r.SINGLE_TEXT;case c.P.DOUBLE_INPUT:return r.DOUBLE_TEXT;case c.P.SELECT:return n?r.DOUBLE_SELECT:r.SINGLE_SELECT}}function v(e,t,n){return{ruleIndex:e.index,ruleId:e.id,ranges:e.rule.ruleRanges.map((function(e){return(0,d.range2RelativeHex)(e,t)})).join(","),booleanCondition:y(e,n),gradientCondition:g(e,n),dataBarCondition:E(e,n)}}function y(e,t){var n=e.rule,r=n.booleanConditionalFormat,o=n.ruleRanges;if(r){var i=r.condition,s=r.format,a=i.values,c=a[0]?N(a[0],o,t):"",d=a[1]?N(a[1],o,t):"";return{conditionType:i.type,inputOne:c,inputTwo:d,format:{bgColor:f.Z.getColorHexCode(s.getBackgroundColor(),t),color:f.Z.getColorHexCode(s.getColor(),t),underline:!!s.getUnderline(),strikethrough:!!s.getStrikethrough(),bold:!!s.getBold(),italic:!!s.getItalic()}}}}function g(e,t){var n,r,o=e.rule.gradientConditionalFormat;if(o){var i=o.interpolationPoints;return{inputOne:{type:i[0].pointType,value:(null===(n=i[0].pointValue)||void 0===n?void 0:n.userEnteredValue)||""},inputTwo:{type:i[1].pointType,value:(null===(r=i[1].pointValue)||void 0===r?void 0:r.userEnteredValue)||""},minColor:f.Z.getColorHexCode(i[0].color,t),maxColor:f.Z.getColorHexCode(i[1].color,t)}}}function E(e,t){var n,r,o=e.rule.dataBarConditionalFormat;if(o){var i=o.interpolationPoints,s=o.hideData;return{inputOne:{type:i[0].pointType,value:(null===(n=i[0].pointValue)||void 0===n?void 0:n.userEnteredValue)||""},inputTwo:{type:i[1].pointType,value:(null===(r=i[1].pointValue)||void 0===r?void 0:r.userEnteredValue)||""},negativeColor:f.Z.getColorHexCode(i[0].color,t),positiveColor:f.Z.getColorHexCode(i[1].color,t),hideData:s}}}function w(e,t,n){var r=void 0,o=void 0,i=void 0,s=n?e.map((function(e){return(0,d.range2RelativeHex)(e,n)})).join(","):"";return t===l.lY.GRADIENT?o={inputOne:{type:u.u.MIN,value:""},inputTwo:{type:u.u.MAX,value:""},minColor:l.c8[0].minColor,maxColor:l.c8[0].maxColor}:t===l.lY.DATA_BAR?i={inputOne:{type:u.u.MIN,value:""},inputTwo:{type:u.u.MAX,value:""},negativeColor:l.ny[0].negativeColor,positiveColor:l.ny[0].positiveColor,hideData:!1}:r={conditionType:t,inputOne:"",inputTwo:"",format:{bgColor:l.lK[0].bgColor,color:l.lK[0].color,italic:l.lK[0].italic,bold:l.lK[0].bold,strikethrough:l.lK[0].strikethrough,underline:l.lK[0].underline}},{ruleIndex:0,ruleId:"",ranges:s,booleanCondition:r,gradientCondition:o,dataBarCondition:i}}function b(e,t,n){var r=e.getRuleListWithCurrentSelection();return r.sort((function(e,t){return e.index-t.index})),r.map((function(e){return v(e,t,n)})).filter((function(e){return null!==e}))}function T(e,t,n){var r=e.getRuleList();return r.sort((function(e,t){return e.index-t.index})),r.map((function(e){return v(e,t,n)})).filter((function(e){return null!==e}))}function R(e){a.ZP.tdwReport({opername:"doc_excel_editor",module:"excel_con_format",action:e})}function I(e){var t=e.booleanCondition,n=e.gradientCondition;return t?t.conditionType:n?l.lY.GRADIENT:l.lY.DATA_BAR}function C(e){return e===l.lY.GRADIENT?o.ZP.t("色阶"):e===l.lY.DATA_BAR?o.ZP.t("数据条"):s.Z[e].getTitle()}function A(e){if(e.booleanCondition){var t=e.booleanCondition,n=t.conditionType,r=t.inputOne,i=t.inputTwo;return s.Z[n].getDescription(r,i)}return e.gradientCondition?o.ZP.t("色阶"):o.ZP.t("数据条")}function x(e){if(e.booleanCondition){var t=e.booleanCondition.conditionType;return s.Z[t].reportKey}return e.gradientCondition?"gradient":"data_bar"}function O(e){if(e.booleanCondition){var t=e.booleanCondition,n=t.conditionType,r=t.inputOne,o=t.inputTwo;return s.Z[n].checkInputValid(r,o)}var i=e.gradientCondition||e.dataBarCondition;return function(e,t){var n,r,o=null===(n=(0,h.stringToNumber)(e.value,{fractionFirst:!0}))||void 0===n?void 0:n.numericValue,i=null===(r=(0,h.stringToNumber)(t.value,{fractionFirst:!0}))||void 0===r?void 0:r.numericValue,s=!1;return e.type!==u.u.MIN&&void 0===o&&(s=!0),t.type!==u.u.MAX&&void 0===i&&(s=!0),!s&&o&&i&&o>i&&(s=!0),s?_.cl:null}(i.inputOne,i.inputTwo)}function N(e,t,n){var r;switch(e.type){case p.Z.FORMULA_TOKEN:var o=t[0].startRowIndex===i.DEFAULT_DIMENSION_INDEX?0:t[0].startRowIndex,s=t[0].startColIndex===i.DEFAULT_DIMENSION_INDEX?0:t[0].startColIndex;return(null===(r=e.formula)||void 0===r?void 0:r.toString(o,s,{getSheetTitleBySheetId:function(e){return n.sheetManager.getSheetTitleBySheetId(e)}}))||"";case p.Z.VALUE_TOKEN:return e.userEnteredValue||""}return""}!function(e){e[e.EMPTY=0]="EMPTY",e[e.SINGLE_TEXT=1]="SINGLE_TEXT",e[e.DOUBLE_TEXT=2]="DOUBLE_TEXT",e[e.SINGLE_SELECT=3]="SINGLE_SELECT",e[e.DOUBLE_SELECT=4]="DOUBLE_SELECT"}(r||(r={}))},"../spread-sheet/src/core/workbench/common/auto-resize-feature.ts":function(e,t,n){n("../node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),n("../node_modules/core-js/modules/esnext.reflect.metadata.js");var r,o,i=n("../node_modules/@tencent/workbench/lib/esm/services/event-emitter/builtin-event.js"),s=n("../node_modules/@tencent/workbench/lib/esm/decorators/class/feature.js"),a=n("../node_modules/@tencent/workbench/lib/esm/services/event-emitter/event-emitter.js"),c=n("../spread-sheet/src/adapter/SpreadSheetAppAdapter.ts"),d=n("../spread-sheet/src/external/sheet-adapter/smart-sheet-adapter/constants.ts"),l=n("../spread-sheet/src/core/app/SpreadsheetApp.interface.ts"),u=function(e,t,n,r){var o,i=arguments.length,s=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},_=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},p=function(e,t){return function(n,r){t(n,r,e)}},f=function(){function e(e,t){var n=this;this.app=e,this.eventEmitter=t,this.resizeCallback=function(){n.app.viewManager.resize()}}var t=e.prototype;return t.$onEditorOpen=function(){this.listener||(this.listener=this.eventEmitter.listen(i.c.SurfaceSizeChanged,this.resizeCallback))},t.$onEditorClose=function(){var e;null===(e=this.listener)||void 0===e||e.unsubscribe(),this.listener=void 0},e}();f=u([(0,s.L)({adapters:[c.L,d.dH]}),p(0,l.m),_("design:paramtypes",["function"===typeof(r="undefined"!==typeof l.m&&l.m)?r:Object,"function"===typeof(o="undefined"!==typeof a.v&&a.v)?o:Object])],f),t.Z=f},"../spread-sheet/src/core/workbench/initialization/workbenchInitServicePc.ts":function(e,t,n){n.r(t),n.d(t,{WorkbenchInitService:function(){return fm.b},bindWorkBenchPc:function(){return vm}});var r,o=n("../spread-sheet/src/core/workbench/initialization/workbenchService.interface.ts"),i=n("../spread-sheet/src/core/workbench/loader/workbenchLoader.interface.ts"),s=n("../node_modules/@babel/runtime/helpers/esm/inheritsLoose.js"),a=(n("../node_modules/regenerator-runtime/runtime.js"),n("../node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),n("../node_modules/core-js/modules/esnext.reflect.metadata.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.promise.js"),n("../node_modules/@tencent/workbench/lib/esm/services/contextmenu/context-menu-service.js")),c=n("../node_modules/@tencent/workbench/lib/esm/services/titlebar/titlebar-service.js"),d=n("../node_modules/@tencent/workbench/lib/esm/services/menu/menu-service.js"),l=n("../node_modules/@tencent/workbench/lib/esm/services/toolbar/toolbar-service.js"),u=n("../node_modules/@tencent/workbench/lib/esm/controllers/workbench/workbench-loader.js"),_=n("../node_modules/@tencent/workbench/lib/esm/decorators/class/workbench-settings.js"),p=n("../node_modules/@tencent/workbench/lib/esm/services/middleware/middleware-service.js"),f=n("../spread-sheet/src/core/workbench/common/openEditorService.ts"),h=n("../node_modules/@babel/runtime/helpers/esm/toConsumableArray.js"),m=(n("../node_modules/core-js/modules/es.array.concat.js"),n("../spread-sheet/src/external/view/schema/toolbar-schema.ts")),v=n("../spread-sheet/src/external/view/schema/menu-schema.ts"),y=n("../spread-sheet/src/external/view/schema/data-validation-schema.ts"),g=[{key:v.z_.FILE,items:[v.z_.FILE_INFO,v.z_.DIVIDER,v.z_.ADD_MEMBER,v.z_.FORWARD,v.z_.SHARE_TO_WECHAT,v.z_.GET_SHARE_URL,v.z_.AUTH_MANAGER,v.z_.DIVIDER,v.z_.QUICK_ACCESSS,v.z_.SAVE_TO_WEDRIVE,v.z_.MOVE_TO_WEDRIVE,{key:v.z_.VIEW_IN_WEDRIVE,items:[]},v.z_.FAVORITE,v.z_.DIVIDER,{key:v.z_.EDIT_MENU,items:[{key:v.z_.INSERT_ROW_COL_IN_EDIT_MENU,items:[v.z_.INSERT_ROW_ABOVE_IN_MENU,v.z_.INSERT_ROW_BELOW_IN_MENU,v.z_.DIVIDER,v.z_.INSERT_COL_LEFT_IN_MENU,v.z_.INSERT_COL_RIGHT_IN_MENU]},{key:v.z_.INSERT_RANGE_IN_EDIT_MENU,items:[v.z_.INSERT_RANGE_RIGHT_IN_EDIT_MENU,v.z_.INSERT_RANGE_DOWN_IN_EDIT_MENU]},v.z_.DIVIDER,v.z_.DATA_VALIDATION_EDIT,v.z_.NUMBER_FORMAT,v.z_.CONDITION_FORMAT,v.z_.DIVIDER,v.z_.RANGE_AUTH_PROTECT_RANGE,v.z_.RANGE_AUTH_PROTECT_SHEET,v.z_.RANGE_AUTH_CHECK_ALL,v.z_.DIVIDER,v.z_.GRID_LINE,v.z_.WATERMARK,{key:v.z_.ROW_COL_DIMENSION,items:[v.z_.SET_ROW_HEIGHT,v.z_.AUTO_SET_ROWANDCOL,v.z_.DIVIDER,v.z_.SET_COL_WIDTH,v.z_.RESET_COL_WIDTH,v.z_.AUTO_SET_COLWIDTH,v.z_.DIVIDER,v.z_.AUTO_SET_DIMENSION]},{key:v.z_.CLEAR,items:[v.z_.CLEAR_FORMAT,v.z_.CLEAR_CONTENT]},v.z_.DIVIDER,v.z_.SMART_SPLIT,{key:v.z_.FORM_CREATE,items:[v.z_.FORM_CONVERT_TO,v.z_.FORM_CREATE_NEW]},{key:v.z_.FORM_OPERATION,items:[v.z_.FORM_CHECK,v.z_.FORM_SHARE,v.z_.FORM_RESULT_SUMMARY,v.z_.FORM_CANCEL]},v.z_.DIVIDER,v.z_.FIND_REPLACE]},v.z_.EDIT_HISTORY,v.z_.READ_RECORD,v.z_.DIVIDER,v.z_.CREATE_COPY,v.z_.SAVE_AS_TEMPLATE,{key:v.z_.EXPORT_FILE,items:[v.z_.EXPORT_LOCAL,v.z_.EXPORT_CSV,v.z_.EXPORT_URL]},v.z_.PRINT,v.z_.DIVIDER,v.z_.OPEN_IN_BROWSER,v.z_.ACCESSIBILITY,v.z_.DIVIDER,{key:v.z_.HELP_AND_FEEDBACK,items:[v.z_.FEEDBACK,v.z_.HOT_KEY,v.z_.DIVIDER,v.z_.COMPLAIN]},v.z_.DIVIDER,v.z_.EXIT_COLLAB,v.z_.DELETE_DOC,{key:v.z_.SYNC_GUIDE,items:[v.z_.SYNC_GUIDE_TIPS,v.z_.SYNC_GUIDE_OFF,v.z_.SYNC_GUIDE_SINGLE,v.z_.SYNC_GUIDE_ALL]}]},{key:v.z_.EDIT,items:[{key:v.z_.INSERT_ROW_COL_IN_EDIT_MENU,items:[v.z_.INSERT_ROW_ABOVE_IN_MENU,v.z_.INSERT_ROW_BELOW_IN_MENU,v.z_.DIVIDER,v.z_.INSERT_COL_LEFT_IN_MENU,v.z_.INSERT_COL_RIGHT_IN_MENU]},{key:v.z_.INSERT_RANGE_IN_EDIT_MENU,items:[v.z_.INSERT_RANGE_RIGHT_IN_EDIT_MENU,v.z_.INSERT_RANGE_DOWN_IN_EDIT_MENU]},v.z_.DIVIDER,v.z_.DATA_VALIDATION_EDIT,v.z_.NUMBER_FORMAT,v.z_.CONDITION_FORMAT,v.z_.DIVIDER,v.z_.RANGE_AUTH_PROTECT_RANGE,v.z_.RANGE_AUTH_PROTECT_SHEET,v.z_.RANGE_AUTH_CHECK_ALL,v.z_.DIVIDER,v.z_.GRID_LINE,v.z_.WATERMARK,{key:v.z_.ROW_COL_DIMENSION,items:[v.z_.SET_ROW_HEIGHT,v.z_.AUTO_SET_ROWANDCOL,v.z_.DIVIDER,v.z_.SET_COL_WIDTH,v.z_.RESET_COL_WIDTH,v.z_.AUTO_SET_COLWIDTH,v.z_.DIVIDER,v.z_.AUTO_SET_DIMENSION]},{key:v.z_.CLEAR,items:[v.z_.CLEAR_FORMAT,v.z_.CLEAR_CONTENT]},v.z_.DIVIDER,v.z_.SMART_SPLIT,{key:v.z_.FORM_CREATE,items:[v.z_.FORM_CONVERT_TO,v.z_.FORM_CREATE_NEW]},{key:v.z_.FORM_OPERATION,items:[v.z_.FORM_CHECK,v.z_.FORM_SHARE,v.z_.FORM_RESULT_SUMMARY,v.z_.FORM_CANCEL]},v.z_.DIVIDER,v.z_.FIND_REPLACE]},{key:v.z_.INSERT,items:[v.z_.INSERT_CELL_IMG,v.z_.INSERT_FLOAT_IMG,v.z_.INSERT_CHART,v.z_.INSERT_LINK,v.z_.DIVIDER,{key:v.z_.INSERT_ROW_COL_IN_INSERT_MENU,items:[v.z_.INSERT_ROW_ABOVE_IN_MENU,v.z_.INSERT_ROW_BELOW_IN_MENU,v.z_.DIVIDER,v.z_.INSERT_COL_LEFT_IN_MENU,v.z_.INSERT_COL_RIGHT_IN_MENU]},{key:v.z_.INSERT_RANGE_IN_INSERT_MENU,items:[v.z_.INSERT_RANGE_RIGHT_IN_INSERT_MENU,v.z_.INSERT_RANGE_DOWN_IN_INSERT_MENU]},v.z_.DIVIDER,v.z_.INSERT_COMMENT,v.z_.INSERT_STAFF_CARD,v.z_.INSERT_GROUP_CARD,v.z_.DIVIDER,v.z_.INSERT_DOC,{key:v.z_.INSERT_FILE,items:[v.z_.INSERT_WEDRIVE_FILE,v.z_.UPLOAD_FILE]},{key:v.z_.SCHEDULE,items:[v.z_.INSERT_SCHEDULE,v.z_.SELECT_SCHEDULE]},v.z_.INSERT_APPLICATION,v.z_.INSERT_TODO,v.z_.INSERT_DATE_REMINDER]},{key:v.z_.DATA,items:[{key:v.z_.DATA_VALIDATION_EDIT,items:(0,h.Z)(y.Ej)},v.z_.DIVIDER,v.z_.HIGHLIGHT_REPEAT,v.z_.OTHER_CONDITION_FORMAT,v.z_.SMART_SPLIT]},{key:v.z_.TOOLBAR_NUMBER_FORMAT,items:[v.z_.NUMBER_FORMAT_ITEM_0,v.z_.NUMBER_FORMAT_ITEM_1,v.z_.DIVIDER,v.z_.NUMBER_FORMAT_ITEM_2,v.z_.NUMBER_FORMAT_ITEM_3,v.z_.NUMBER_FORMAT_ITEM_4,v.z_.NUMBER_FORMAT_ITEM_5,v.z_.DIVIDER,v.z_.NUMBER_FORMAT_ITEM_6,v.z_.NUMBER_FORMAT_ITEM_7,v.z_.NUMBER_FORMAT_ITEM_8,v.z_.DIVIDER,v.z_.NUMBER_FORMAT_ITEM_9,v.z_.NUMBER_FORMAT_ITEM_10,v.z_.NUMBER_FORMAT_ITEM_11,v.z_.NUMBER_FORMAT_ITEM_12,v.z_.NUMBER_FORMAT_ITEM_13,v.z_.NUMBER_FORMAT_ITEM_14,v.z_.DIVIDER,v.z_.NUMBER_FORMAT_ITEM_15]},{key:v.z_.FREEZE,items:[v.z_.FREEZE_FIRST_ROW,v.z_.FREEZE_FIRST_COL,v.z_.FREEZE_TO_SELECTION,v.z_.DIVIDER,v.z_.FREEZE_CANCEL]},{key:v.z_.RANGE_AUTH,items:[v.z_.RANGE_AUTH_PROTECT_RANGE,v.z_.RANGE_AUTH_PROTECT_SHEET,v.z_.RANGE_AUTH_CHECK_ALL]},{key:v.z_.COMMENT_ENT,items:[v.z_.INSERT_COMMENT_ENT,v.z_.ALL_COMMENTS_ENT]},{key:v.z_.EXTEND_ADDON,items:[]},{key:v.z_.FILTER_VIEW,items:[v.z_.FILTER_VIEW_CREATE_FILTER_DATA,v.z_.FILTER_VIEW_CREATE_FILTER_VIEW]},{key:v.z_.PAGE_SETTING,items:[v.z_.GRID_LINE,v.z_.WATERMARK,{key:v.z_.ROW_COL_DIMENSION,items:[v.z_.SET_ROW_HEIGHT,v.z_.AUTO_SET_ROWANDCOL,v.z_.DIVIDER,v.z_.SET_COL_WIDTH,v.z_.RESET_COL_WIDTH,v.z_.AUTO_SET_COLWIDTH,v.z_.DIVIDER,v.z_.AUTO_SET_DIMENSION]}]},{key:v.z_.TOOLBAR_MODE,items:[v.z_.SINGLE_LINE_TOOLBAR,v.z_.DOUBLE_LINE_TOOLBAR,v.z_.DIVIDER,v.z_.HIDE_TOOLBAR]}];!function(e){e.AUTH="auth",e.HOME="logo",e.TITLE="title",e.TITLE_BADGE="title_badge",e.SUBSCRIPTION_NOTIFICATION="subscription-notification",e.READONLY_TIPS="readOnly",e.BADGE="badge",e.COLLECT="collect",e.MOVE="move",e.COLLABORATION="collaborators",e.QQ_GROUP_AIO="qq-group-aio",e.SAVE_TIPS="saveTip",e.ADD_MEMBER="add_member",e.ALL_MEMBERS="all_members",e.DISCUSSION="discussion",e.FILE_MENU="fileMenu",e.EDIT_MENU="collapseMenu",e.RELATE_MENU="relate-menu",e.RELATE_FORM_MENU="relateFormMenu",e.SHARE="share",e.ACCOUNT_AVATAR="account",e.LOGIN="login",e.MASK="mask",e.TOOLBAR_MODE="toobar-mode",e.DIVIDER="divider"}(r||(r={}));var E,w=[r.HOME,r.DIVIDER,r.TITLE,r.TITLE_BADGE,r.READONLY_TIPS,r.BADGE,r.SAVE_TIPS,"pusher",r.COLLABORATION,r.QQ_GROUP_AIO,r.RELATE_FORM_MENU,r.FILE_MENU,r.EDIT_MENU,r.RELATE_MENU,r.AUTH,r.LOGIN,r.SHARE,r.DIVIDER,r.ACCOUNT_AVATAR,r.TOOLBAR_MODE];!function(e){e.HOME="logo",e.TITLE="title",e.TITLE_BADGE="title_badge",e.COLLECT="collect",e.MOVE="move",e.SUBSCRIPTION_NOTIFICATION="subscription-notification",e.RELATE_FORM_MENU="relateFormMenu",e.ADD_MEMBER="add_member",e.DISCUSSION="discussion",e.FILE_MENU="fileMenu",e.EDIT_MENU="collapseMenu",e.SHARE="share",e.DIVIDER="divider",e.ACCOUNT_AVATAR="account"}(E||(E={}));var b,T=[E.HOME,E.DIVIDER,E.TITLE,E.TITLE_BADGE,E.COLLECT,E.MOVE,E.SUBSCRIPTION_NOTIFICATION,"pusher",E.RELATE_FORM_MENU,E.ADD_MEMBER,E.DISCUSSION,E.FILE_MENU,E.EDIT_MENU,E.SHARE,E.DIVIDER,E.ACCOUNT_AVATAR],R=n("../spread-sheet/src/core/workbench/common/commonService.ts"),I=n("../node_modules/@tencent/workbench/lib/esm/decorators/method/titlebar.js"),C=n("../node_modules/@tencent/workbench/lib/esm/decorators/class/controller.js"),A=n("react"),x=n.n(A),O=n("../node_modules/i18next/dist/esm/i18next.js"),N=n("../node_modules/@tencent/dui/lib/components/Tooltip/index.js"),S=n("../node_modules/@tencent/ioc/lib/esm/index.js"),k=n("./node_modules/axios/index.js"),P=n.n(k),D=n("../node_modules/@tencent/workbench/lib/esm/decorators/class/feature.js"),L=n("../packages/utils/src/url.ts"),M=n("../packages/utils/src/safe.ts"),F=n("../spread-sheet/src/core/data/configService/spreadConfig.ts"),j=n("../packages/lib/index.ts"),H=n("../spread-sheet/src/external/view/ui-layer/auth/auth-drawer.ts"),Z=n("../spread-sheet/src/adapter/SpreadSheetAppAdapter.ts"),B=n("../spread-sheet/src/external/sheet-adapter/smart-sheet-adapter/constants.ts"),z=n("../spread-sheet/src/base/util/appConfig.ts"),U=function(e,t,n,r){var o,i=arguments.length,s=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},V=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},W=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function s(e){try{c(r.next(e))}catch(t){i(t)}}function a(e){try{c(r.throw(e))}catch(t){i(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))},G=function(){function e(e){var t=this;this.authDrawer=e,this._onPolicyInfoChange=new j.Q5,this.onPolicyInfoChange=this._onPolicyInfoChange.event,this.updatePolicyInfo=function(e,n){F.q.setConfig({policyType:e}),t.updatePolicyAndMemberList(e,n)},this.registerListener=function(){window.SLR.listen("TX-AUTH-UPDATED",t.refreshPolicy),window.addEventListener("changePermission",t.handleChangePermission),window.addEventListener("changeAdvPermission",t.handleChangeAdvPermission)},this.unregisterListener=function(){window.removeEventListener("changePermission",t.handleChangePermission),window.removeEventListener("changeAdvPermission",t.handleChangeAdvPermission)},this.handleChangePermission=function(){var e;null===(e=n.g.SLR)||void 0===e||e.load("Share",(function(e){return W(t,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.hide(),this.authDrawer.openDrawer({showAdvPermissions:!1,updatePolicyInfo:this.updatePolicyInfo,invokeFrom:"Share"});case 2:case"end":return t.stop()}}),t,this)})))}))},this.handleChangeAdvPermission=function(){var e;null===(e=window.SLR)||void 0===e||e.load("Share",(function(e){return W(t,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.hide(),this.authDrawer.openDrawer({showAdvPermissions:!1,updatePolicyInfo:this.updatePolicyInfo,invokeFrom:"Share"});case 2:case"end":return t.stop()}}),t,this)})))}))},this.refreshPolicy=function(){var e=n.g.clientVars,r=e.creatorDomain,o=e.padId,i="//"+z.Z.getConfig("runtime.domainName")+"/cgi-bin/redirect/"+r+"/ep/api/getpadinfo?localPadId="+o+"&type=1&ver=2&xsrf="+(0,M.f)();P().get((0,L.q)(i),{withCredentials:!0}).then((function(e){var n=e.data;if(0===n.retcode){var r=n.policy,o=n.memlist;t.updatePolicyAndMemberList(r,o),F.q.setConfig({policy:r})}})).catch((function(e){console.error(e)}))},this.policy=n.g.clientVars.policy,this.memberList=[],this.registerListener(),this.initCollaboratorTip()}var t=e.prototype;return t.getPolicyAndMemberList=function(){return{policy:this.policy,memberList:this.memberList}},t.initCollaboratorTip=function(){var e=this,t=n.g.clientVars,r=t.creatorDomain,o=t.padId,i="//"+z.Z.getConfig("runtime.domainName")+"/cgi-bin/redirect/"+r+"/ep/api/getpadinfo?localPadId="+o+"&type=1&ver=2&xsrf="+(0,M.f)();P().get(i).then((function(t){var n=t.data;if(0===n.retcode){var r=n.policy,o=n.memlist;e.updatePolicyAndMemberList(r,o)}})).catch((function(e){console.error(e)}))},t.updatePolicyAndMemberList=function(e,t){this.policy=e,this.memberList=t,this._onPolicyInfoChange.fire({policy:e,memberList:t})},e}();G=U([(0,D.L)({adapters:[Z.L,B.dH]}),V("design:paramtypes",["function"===typeof(b="undefined"!==typeof H.Z&&H.Z)?b:Object])],G);var Y,K=n("../node_modules/@tencent/netcheck/lib/index.js"),X=n("../spread-sheet/src/external/constants/auth-type.ts"),q=function(e){function t(t){var n;(n=e.call(this,t)||this).networkChange=function(e){"online"===e?!n.state.online&&n.setState({online:!0}):n.state.online&&n.setState({online:!1})},n.updatePolicyInfo=function(e,t){n.setState({policy:e,memberList:t})},n.getAuthIcon=function(){var e="tip-lock",t=n.state.policy;return t===X.G.Self?e="tip-lock":t===X.G.Cooperation?e="tip-cooperation":t===X.G.Viewable?e="tip-eye":t===X.G.Editable&&(e="tip-edit"),e},n.getAuthHoverText=function(){var e="";switch(n.state.policy){case X.G.Self:e=O.ZP.t("ui|titlebar.invite");break;case X.G.Cooperation:e=n.getSummary();break;case X.G.Viewable:e=O.ZP.t("ui|titlebar.view");break;case X.G.Editable:e=O.ZP.t("所有人可编辑");break;default:return""}return e},n.getSummary=function(){var e=O.ZP.t("ui|titlebar.uninvite");try{var t=n.state.memberList;if((null===t||void 0===t?void 0:t.length)>0){var r=t[0].nick||"";r.length>8&&(r=r.substr(0,8),r+="..."),e=t.length>1?O.ZP.t("ui|titlebar.collaborate  {{number}}  {{memNames}}",{memNames:r,number:t.length}):O.ZP.t("ui|titlebar.collaborate  {{memNames}}",{memNames:r})}}catch(o){console.error("getSummary",o)}finally{return e}};var r=S.Am.get(G);n.policyInfoChange=r.onPolicyInfoChange((function(e){var t=e.policy,r=e.memberList;n.updatePolicyInfo(t,r)}));var o=r.getPolicyAndMemberList(),i=o.policy,s=o.memberList;return n.state={online:K.network.isOnline,policy:i,memberList:s},n}(0,s.Z)(t,e);var n=t.prototype;return n.componentDidMount=function(){K.network.changeEnd(this.networkChange)},n.componentWillUnmount=function(){this.policyInfoChange.dispose(),K.network.remove(this.networkChange)},n.render=function(){var e=this.getAuthIcon(),t=this.getAuthHoverText();return A.createElement(N.default,{placement:"bottom",title:t},A.createElement("button",{disabled:!1===this.state.online,id:"header-btn-auth",className:"auth-btn btn-normal"},A.createElement("div",{className:e})))},t}(A.Component),Q=(n("../node_modules/core-js/modules/es.regexp.exec.js"),n("../node_modules/core-js/modules/es.string.replace.js"),n("../node_modules/@tencent/dui/lib/components/Snackbar/index.js")),J="//"+z.Z.getConfig("runtime.domainName")+"/",ee=((Y={}).SET_AUTH_INFO=J+"cgi-bin/online_docs/doc_changetitle",Y.GET_AUTH_APPLY_CHECK=J+"cgi-bin/online_docs/auth_apply/check",Y.GET_USER_AVATAR_MARKNAME=J+"sdc/getusermarkname",Y);function te(e,t,n){return P().post(ee.SET_AUTH_INFO+"?pad_id="+n+"&type=1&ver=2&domain_id="+t+"&xsrf="+(0,M.f)()+"&version=2&auto_change=0&title="+encodeURIComponent(e))}function ne(e,t){return P().get(ee.GET_AUTH_APPLY_CHECK+"?domainId="+e+"&localPadId="+t+"&xsrf="+(0,M.f)()+"&bkn="+(0,M.G)())}var re,oe=n("../packages/report/src/index.ts"),ie=n("../spread-sheet/src/core/app/SpreadsheetApp.interface.ts"),se=function(e,t,n,r){var o,i=arguments.length,s=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},ae=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},ce=function(e,t){return function(n,r){t(n,r,e)}},de=function(e){var t=this;this.app=e,this._onTitleChange=new j.Q5,this.onTitleChange=this._onTitleChange.event,this.handleTitleUpdate=function(e){t.handleTitleChange(e.title),oe.ZP.tdwReport({module:"title",opername:"doc_menubar",action:"modify",ver12:"new"})},this.registerListener=function(){t.app.event.default.listen("title-update-pc",t.handleTitleUpdate)},this.unregisterListener=function(){t.app.event.default.remove("title-update-pc",t.handleTitleUpdate)},this.handleTitleChange=function(e){document.title=e,n.g.clientVars&&F.q.setConfig({isUserChangeTitle:1,title:e}),t._onTitleChange.fire(e),oe.ZP.tdwReport({opername:"doc_menubar",module:"title",action:"modify"})},this.registerListener()};de=se([(0,D.L)({adapters:[Z.L,B.dH]}),ce(0,ie.m),ae("design:paramtypes",["function"===typeof(re="undefined"!==typeof ie.m&&ie.m)?re:Object])],de);var le=n("../spread-sheet/src/base/index.ts"),ue=function(e,t,n,r){var o,i=arguments.length,s=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},_e=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},pe=function(){var e=this;this._onShowSaveTips=new j.Q5,this.onShowSaveTips=this._onShowSaveTips.event,this.showSaveStateTips=function(){e._onShowSaveTips.fire()},this.registerListener=function(){le.Z.event.network.listen("commitSuccess",e.showSaveStateTips),le.Z.event.spreadsheetEvent.listen("title_change_local",e.handleHistoryChange)},this.unregisterListener=function(){le.Z.event.network.remove("commitSuccess",e.handleHistoryChange),le.Z.event.spreadsheetEvent.remove("title_change_local",e.handleHistoryChange)},this.handleHistoryChange=function(){le.Z.util.timer.wait(10).run((function(){e.showSaveStateTips()}))},this.registerListener()};pe=ue([(0,D.L)({adapters:[Z.L,B.dH]}),_e("design:paramtypes",[])],pe);var fe=function(e){function t(t){var r;return(r=e.call(this,t)||this).networkChange=function(e){if("online"===e){!r.state.online&&r.setState({online:!0});var t=document.title;r.offlineTitle&&te(r.offlineTitle,n.g.clientVars.domainId,n.g.clientVars.padId).then((function(e){0===e.data.retcode&&0===e.data.cgicode?(document.title=r.offlineTitle,n.g.clientVars&&F.q.setConfig({isUserChangeTitle:1,title:r.offlineTitle}),r.offlineTitle=null,r.handleHistoryLink()):12e3===e.data.retcode||12e3===e.data.cgicode?(r.setTitleImplement(t),Q.default.show({message:"标题不合规，请重新命名。",type:"info",autoClose:!0})):r.offlineTitle=null})).catch((function(){r.offlineTitle=null}))}else r.state.online&&r.setState({online:!1})},r.getTitleWidth=function(){return r.refDom.getBoundingClientRect().width},r.getInputWidth=function(){return r.inputRef.getBoundingClientRect().width},r.handleChange=function(){var e=/[\\\/:*?"<>|]/g,t=r.inputRef.value;e.test(t)?(Q.default.show({message:O.ZP.t("文档名不能包含下列任何字符：")+'\\ / : * ? " < > |',type:"error",autoClose:!0}),t=t.replace(e,"")):t.length>128&&(Q.default.show({message:O.ZP.t("文档名不能超过128个字。"),type:"error",autoClose:!0}),t=t.substr(0,127)),r.setTitleImplement(t)},r.handleBlur=function(e){if(!e.target.hasAttribute("readonly")){r.getTitleWidth()>r.getInputWidth()||r.getTitleWidth()>=200?r.setState({showToolTips:!0}):r.setState({showToolTips:!1});var t=e.target.value,o=document.title;n.g.clientVars&&n.g.clientVars.padTitle==t||(0==t.length&&(t=r.props.emptyTitle||"",r.setState({value:t},(function(){var e=r.getTitleWidth();r.setState({titleWidth:e})}))),te(t,n.g.clientVars.domainId,n.g.clientVars.padId).then((function(e){0===e.data.retcode&&0===e.data.cgicode?(document.title=t,n.g.clientVars&&F.q.setConfig({isUserChangeTitle:1,title:t}),r.handleHistoryLink(),oe.ZP.tdwReport({opername:"doc_menubar",module:"title",action:"modify"})):12e3!==e.data.retcode&&12e3!==e.data.cgicode||(r.setTitleImplement(o),Q.default.show({message:"标题不合规，请重新命名。",type:"info",autoClose:!0}))})).catch((function(){})))}},r.handleHistoryLink=function(){S.Am.get(pe).showSaveStateTips()},r.handleTitleFocus=function(){oe.ZP.tdwReport({opername:"doc_menubar",module:"title_box",action:"click"}),r.setState({showToolTips:!1}),oe.ZP.tdwReport({module:"title_box",opername:"doc_menubar",action:"click",ver12:"new"})},r.handlekeyDown=function(e){27===e.keyCode?(r.setTitleImplement(n.g.clientVars.padTitle),setTimeout((function(){r.inputRef.blur()}),100)):13===e.keyCode&&r.inputRef.blur()},r.state={value:"",titleWidth:0,titleEditEnable:!1,showToolTips:!0,online:K.network.isOnline,isMaxWidthReady:!1},r.offlineTitle=null,r.refDom=null,r.saveRef=function(e){r.refDom=e},r}(0,s.Z)(t,e);var r=t.prototype;return r.componentDidMount=function(){var e=this,t=this.props.emptyTitle||"",r=!1;n.g.clientVars&&(t=n.g.clientVars.padTitle,r=n.g.clientVars.privilegeAttribute.can_edit_title),document.title=t,this.setState({value:t,titleEditEnable:r},(function(){var t=e.getTitleWidth(),n=e.getInputWidth();e.setState({titleWidth:t,isMaxWidthReady:!0}),t>n||t>0?e.setState({showToolTips:!0}):e.setState({showToolTips:!1})})),K.network.changeEnd(this.networkChange);var o=S.Am.get(de);this.titleChange=o.onTitleChange((function(t){e.setTitleImplement(t)}))},r.componentWillUnmount=function(){this.titleChange.dispose(),K.network.remove(this.networkChange)},r.render=function(){var e=this,t=this.state,n=t.value,r=t.titleEditEnable,o=t.isMaxWidthReady,i=t.titleWidth,s=t.online,a=t.showToolTips;return A.createElement(A.Fragment,null,A.createElement(N.default,{className:"pc-header-title",placement:"bottom",title:n,style:{whiteSpace:"nowrap",maxWidth:"100%"},overlayClassName:"pc-header-tooltip-content",disabled:!r||!a},A.createElement("div",{className:"title-container"},A.createElement("input",{className:o?"input-title input-title-max-width":"input-title",ref:function(t){e.inputRef=t},disabled:!r||!s,maxLength:129,value:n,onChange:this.handleChange,onBlur:this.handleBlur,onFocus:this.handleTitleFocus,onKeyDown:this.handlekeyDown,style:{width:i},autoComplete:"off"}),A.createElement("span",{className:"fake-title",ref:this.saveRef},n))))},r.setTitleImplement=function(e){var t=this;this.state.online||(this.offlineTitle=e),this.setState({value:e},(function(){var n=t.getTitleWidth();0===e.length&&(n=95),t.setState({titleWidth:n})}))},t}(A.Component),he=(n("../node_modules/core-js/modules/es.string.split.js"),n("../node_modules/core-js/modules/es.array.slice.js"),n("../node_modules/@tencent/dui/lib/components/Modal/index.js")),me=n("../node_modules/@tencent/dui/lib/components/Avatar/index.js");function ve(e,t,n){void 0===n&&(n="..");for(var r=e.length,o="",i=0,s=0;s<r;){var a=e.charCodeAt(s),c=e[s];if(o+=a>=55296&&a<=56319?c+e[s+=1]:c,s+=1,(i+=1)>=t)break}return s<r&&(o+=n),o}var ye,ge=function(e){function t(t){var n;return(n=e.call(this,t)||this).copyIfFirstTime=function(){if(n.props.showModal){var e=O.ZP.t("请帮我开通《{{title}}》的{{editValue}}权限 {{docUrl}}",{title:n.docInfo.title,editValue:n.isEdit?"编辑":"查看",docUrl:n.docInfo.docUrl});n.copyText(e)}},n.initDocInfo=function(){var e=z.Z.getConfig("runtime.domainName");n.docInfo={ownerNick:n.props.ownerInfo.ownerNick,ownerAvatar:n.props.ownerInfo.ownerAvatar,avatar:window.clientVars.userPic,userName:window.clientVars.userName,title:window.clientVars.padTitle,docUrl:"//"+e+"/tim/docs/components/NotificationDetail.html?id="+n.props.notificationId+"&from=4"};var t=window.clientVars.padType,r=window.location.href;if("form"!==t){var o,i=r.split("/"+t+"/")[1].indexOf("?");o=-1===i?r.split("/"+t+"/")[1]:r.split("/"+t+"/")[1].slice(0,i),n.docInfo.docUrl+="&isFollowUp=true&padType="+t+"&padHash="+o}},n.toggleCopyDiv=function(){var e=document.querySelector(".copy-ok");e.style.visibility="hidden",setTimeout((function(){e.style.visibility="visible"}),40),n.setState({showSnackbar:!0}),setTimeout((function(){return n.setState({showSnackbar:!1})}),2e3)},n.copyText=function(e){var t,r;if("string"===typeof e?r=e:(r=O.ZP.t("请帮我开通《{{title}}》的{{editValue}}权限 {{docUrl}}",{title:n.docInfo.title,editValue:n.isEdit?"编辑":"查看",docUrl:n.docInfo.docUrl}),n.toggleCopyDiv()),"undefined"!==typeof window.clipboardData)window.clipboardData.setData("Text",r);else if("undefined"!==typeof window.getSelection){var o=document.createElement("input");o.value=r,o.setAttribute("copy-flag","no-editor-copy"),document.body.appendChild(o);try{o.select(),o.focus(),(null===(t=window.navigator)||void 0===t?void 0:t.clipboard)?window.navigator.clipboard.writeText(r).then((function(){})).catch((function(e){console.error("无法复制此文本：",e),document.execCommand("copy")})):document.execCommand("copy")}catch(i){}document.body.removeChild(o)}},n.getContent=function(){var e=n.docInfo,t=e.ownerNick,r=e.ownerAvatar;return x().createElement("div",{className:"follow-up-container"},x().createElement("div",{className:"avatar"},x().createElement(me.default,{src:r,size:48,radius:"4px"}),x().createElement("div",{className:"owner-name"},O.ZP.t("创建人")," ",x().createElement("span",{style:{fontWeight:"bold"}},t)," ")),x().createElement("div",{className:"copy-doc-link-wrapper"},x().createElement("div",{className:"copy-icon",onClick:n.copyText}),x().createElement("span",{className:"copy-doc-link-text"},O.ZP.t("请帮我开通《{{title}}》的{{editValue}}权限",{title:ve(n.docInfo.title,7),editValue:n.isEdit?"编辑":"查看"}),x().createElement("br",null),n.docInfo.docUrl)),x().createElement("div",{className:"copy-ok"},x().createElement("div",{className:"copy-ok-btn"}),x().createElement("div",{className:"copy-ok-text"},O.ZP.t("已复制提醒信息，去粘贴给创建人"))),x().createElement(Q.default,{type:"success",visible:n.state.showSnackbar},O.ZP.t("已复制")))},n.showModal=function(e){e.stopPropagation();var t=O.ZP.t("请帮我开通《{{title}}》的{{editValue}}权限 {{docUrl}}",{title:n.docInfo.title,editValue:n.isEdit?"编辑":"查看",docUrl:n.docInfo.docUrl});n.copyText(t)},n.state={visible:!1,copyTextAtFirstTime:!1,showSnackbar:!1,showModal:!1},n.isEdit="edit"===t.requestPermitType,n.initDocInfo(),n}return(0,s.Z)(t,e),t.prototype.render=function(){this.copyIfFirstTime();var e=this.getContent();return x().createElement("div",null,x().createElement(he.default,{className:"follow-up-modal",title:O.ZP.t("提醒创建人处理申请"),visible:this.props.showModal,footer:null,onCancel:this.props.hideModal,onClose:this.props.hideModal,style:{width:"402px",height:"356px",margin:"9px 97px 89px",padding:"21px 24px 36px",boxShadow:"0 4px 24px 4px rgba(68, 73, 77, 0.16)"}},e))},t}(x().Component),Ee=function(e){function t(t){var r;return(r=e.call(this,t)||this).networkChange=function(e){"online"===e?!r.state.online&&r.setState({online:!0}):r.state.online&&r.setState({online:!1})},r.showReadOnlyTip=function(){ne(n.g.clientVars.domainId,n.g.clientVars.padId).then((function(e){var t=e.data,n=null;n=!t||10003!==t.retcode&&10004!==t.retcode?r.getReadOnlyTip(!1,!1,!1,!1):"0"==t.pass?r.getReadOnlyTip(!0,!0,!1,!1):"1"==t.pass?r.getReadOnlyTip(!0,!1,!0,!1):r.getReadOnlyTip(10003!==t.retcode,!1,!1,!1),r.setState({authButtonTip:n,notificationId:t.seqID})})).catch((function(){})),r.docInfo.ownerNick=F.q.getConfig("ownerNick"),r.docInfo.ownerAvatar=F.q.getConfig("ownerAvatar")},r.getReadOnlyTip=function(e,t,o,i){var s,a=O.ZP.t("当前文档权限为“只能查看”，"),c=!1,d=O.ZP.t("当前文档权限为“只能查看”，点击申请编辑权限。"),l=n.g.clientVars;if(F.q.getConfig("isLogin")){var u=r.state.ownerNick;!e||t||o?e&&t?d=a=O.ZP.t("权限申请未通过，“只能查看”文档。"):(a=i?O.ZP.t("文档权限为“只能查看”。"):(null===(s=null===l||void 0===l?void 0:l.privilegeAttribute)||void 0===s?void 0:s.can_copy)?O.ZP.t("ui|titlebar.equest for edit or copy permission {{ownerNick}}",{ownerNick:u?ve(u,7):""}):O.ZP.t("ui|titlebar.equest for edit permission {{ownerNick}}",{ownerNick:u?ve(u,7):""}),c=!0,d=O.ZP.t("文档当前状态")):(d=O.ZP.t("已申请编辑权限，请等待创建人 {{ownerNick}} 审核。",{ownerNick:ve(u||r.docInfo.ownerNick,7)}),a=O.ZP.t('已申请编辑权限，请等待创建人 <span style="font-weight:bold">{{ownerNick}}</span> 审核。',{ownerNick:ve(u||r.docInfo.ownerNick,7)}),r.showFollowUp=!0),r.props.isReadableDoc&&(a=O.ZP.t("当前文档权限为“只能查看”。"),d=O.ZP.t("当前文档权限为“只能查看”。"),c=!1)}else a=O.ZP.t("你只能查看此文档。若要编辑文档，请登录后编辑。"),d=O.ZP.t("文档当前状态"),r.props.isReadableDoc&&(a=O.ZP.t("你只能查看此文档, 登录后获得更多操作权限。"));return{tip:a,isNeedApplyAuth:c,hoverTip:d}},r.readonlyTipsButtonClick=function(){var e;if(oe.ZP.tdwReport({opername:"doc_menubar",module:"only_view_button",action:"click"}),F.q.getConfig("isLogin")){if(r.state.authButtonTip.isNeedApplyAuth){var t=n.g.clientVars;(null===(e=null===t||void 0===t?void 0:t.privilegeAttribute)||void 0===e?void 0:e.can_copy)?oe.ZP.tdwReport({opername:"doc_author",module:"edit",action:"readonly_edit_tip_exp_pc"}):oe.ZP.tdwReport({opername:"doc_author",module:"edit",action:"readonly_apply_tip_exp_pc"})}r.showPermissionTips()}else oe.ZP.tdwReport({opername:"doc_login",module:"readonly",action:"try_edit_toast_login_exp_pc"});if(!r.showFollowUp||r.state.notificationId)r.setState({showApplyEditAuthDialog:!r.state.showApplyEditAuthDialog});else{var o=n.g.clientVars;ne(o.domainId,o.padId).then((function(e){var t=e.data,n=null;!t||10003!==t.retcode&&10004!==t.retcode?n=r.getReadOnlyTip(!1,!1,!1,!1):(n="0"==t.pass?r.getReadOnlyTip(!0,!0,!1,!1):"1"==t.pass?r.getReadOnlyTip(!0,!1,!0,!1):r.getReadOnlyTip(10003!==t.retcode,!1,!1,!1),t.seqID||(r.showFollowUp=!1)),r.setState({authButtonTip:n,notificationId:t.seqID,showApplyEditAuthDialog:!r.state.showApplyEditAuthDialog})})).catch((function(){}))}},r.showAuthApply=function(){var e,t,o;oe.ZP.tdwReport({opername:"doc_menubar",module:"request_access_button",action:"click"}),r.setState({showApplyEditAuthDialog:!1});var i=function(){var e=r.getReadOnlyTip(!0,!1,!1,!1);r.setState({authButtonTip:e})},s=n.g.clientVars;"undefined"!==typeof window.PermitApply?window.PermitApply.permitApply(s.padType,null,i):(null===(e=window.speedReport)||void 0===e||e.markStart(null===(t=window.speedReport)||void 0===t?void 0:t.reportId.applyEdit),n.g.SLR.load("PermitApply",(function(e){var t,n;window.PermitApply=e,window.PermitApply.permitApply(s.padType,null,i),null===(t=window.speedReport)||void 0===t||t.markEnd(null===(n=window.speedReport)||void 0===n?void 0:n.reportId.applyEdit)}))),(null===(o=null===s||void 0===s?void 0:s.privilegeAttribute)||void 0===o?void 0:o.can_copy)?oe.ZP.tdwReport({opername:"doc_author",module:"edit",action:"clk_tip"}):oe.ZP.tdwReport({opername:"doc_author",module:"edit",action:"readonly_apply_tip_clk_pc"})},r.showLoginInTips=function(){oe.ZP.tdwReport({opername:"doc_login",module:"readonly",action:"try_edit_toast_login_clk_pc"}),r.showLogin()},r.showLogin=function(){oe.ZP.tdwReport({opername:"doc_login",module:"readonly",action:"login_exp_pc"}),r.state.showApplyEditAuthDialog&&r.setState({showApplyEditAuthDialog:!1}),n.g.SLR.dispatch("TX-LOGIN-SHOW",{})},r.showModal=function(){r.setState({showModal:!0})},r.hideModal=function(){r.setState({showModal:!1}),setTimeout((function(){r.setState({showApplyEditAuthDialog:!1})}),0)},r.renderFollowUpController=function(e){var t=r.docInfo,n={ownerNick:t.ownerNick,ownerAvatar:t.ownerAvatar};return x().createElement(ge,{showModal:e,hideModal:r.hideModal,notificationId:r.state.notificationId,ownerInfo:n,requestPermitType:"edit"})},r.showPermissionTips=function(){var e=n.g.clientVars.privilegeAttribute;(null===e||void 0===e?void 0:e.can_apply_edit)||Q.default.show({type:"info",message:O.ZP.t("ui|titlebar.permission"),autoClose:!0})},r.state={online:K.network.isOnline,authButtonTip:{hoverTip:O.ZP.t("文档当前状态"),isNeedApplyAuth:!0,tip:O.ZP.t("你只能查看此文档，要更改权限，请向文档创建者发起申请。")},showApplyEditAuthDialog:!1,showReadOnlyTips:z.Z.getConfig("titlebar.readOnly"),notificationId:null,showModal:!1,ownerNick:""},r.showFollowUp=!1,r.docInfo={},r}(0,s.Z)(t,e);var r=t.prototype;return r.componentDidMount=function(){var e=this;K.network.changeEnd(this.networkChange),document.body.addEventListener("click",(function(t){(F.q.getConfig("isLogin")?e.state.showApplyEditAuthDialog&&-1===["readonly-popup-apply-auth","readonly-popup-push"].indexOf(t.target.id):e.state.showApplyEditAuthDialog&&"readonly-popup-login"!==t.target.id)&&e.setState({showApplyEditAuthDialog:!1})})),this.showReadOnlyTip(),this.getOwnerNick((function(){e.showReadOnlyTip()}))},r.componentWillUnmount=function(){K.network.remove(this.networkChange)},r.render=function(){var e=this,t=n.g.clientVars.privilegeAttribute,r=!!(null===t||void 0===t?void 0:t.can_apply_edit);return x().createElement(N.default,{style:{display:this.state.showReadOnlyTips?"block":"none"},placement:"bottom",title:r?this.state.authButtonTip.hoverTip:"",overlayStyle:{whiteSpace:"pre-line",padding:"4px 8px",display:r?"block":"none"},disabled:this.state.showApplyEditAuthDialog||!1===this.state.online},x().createElement("div",{className:"readonly-container",ref:function(t){e.readOnlyTips=t}},x().createElement("button",{type:"button",className:"readonly-button",onClick:this.readonlyTipsButtonClick,disabled:!1===this.state.online},x().createElement("div",{className:"readonly-text "+(r?"":"readonly-button_center")},O.ZP.t("ui|titlebar.view only")),r&&x().createElement("div",{className:"readonly-arrow"})),this.renderFollowUpController(this.state.showModal),this.state.showApplyEditAuthDialog&&r?x().createElement("div",{className:this.props.isReadableDoc?"readonly-popup readonly-popup-small-width":"readonly-popup",style:{display:this.state.showModal?"none":"block"}},x().createElement("div",{className:"readonly-popup-main"},x().createElement("div",{dangerouslySetInnerHTML:{__html:this.state.authButtonTip.tip}})),this.showFollowUp&&this.state.notificationId&&x().createElement("div",{style:{float:"right"}},x().createElement(N.default,{title:O.ZP.t("ui|titlebar.copy Link and send"),containerOffsetY:25,trigger:"hover"},x().createElement("div",{id:"readonly-popup-push",className:"pc-header-push",onClick:this.showModal},O.ZP.t("ui|titlebar.urge a rush")))),F.q.getConfig("isLogin")?this.state.authButtonTip.isNeedApplyAuth?x().createElement("div",{id:"readonly-popup-apply-auth",className:"readonly-popup-btn",onClick:this.showAuthApply},(null===t||void 0===t?void 0:t.can_copy)?O.ZP.t("ui|titlebar.edit document"):O.ZP.t("申请编辑权限")):null:x().createElement("div",{id:"readonly-popup-login",className:"readonly-popup-btn",onClick:this.showLoginInTips},O.ZP.t("立即登录"))):null))},r.getOwnerNick=function(e){var t=this;if(this.state.ownerNick)null===e||void 0===e||e(this.state.ownerNick);else{var n="//"+z.Z.getConfig("runtime.domainName")+"/cgi-bin/online_docs/doc_info",r={domainId:F.q.getConfig("domainId"),localPadId:F.q.getConfig("padId"),xsrf:(0,M.f)()};P().get(n,{params:r,withCredentials:!0}).then((function(n){var r=n.data;if(0===r.retcode){var o=r.owner_nick;t.setState({ownerNick:o}),F.q.setConfig({ownerNick:o}),null===e||void 0===e||e(o)}})).catch((function(n){console.error(n),null===e||void 0===e||e(t.state.ownerNick)}))}},t}(x().Component),we=n("../node_modules/@tencent/docs-scenario-components-pc-header-badge/dist/index.js"),be=n.n(we),Te=n("../spread-sheet/src/core/utils/gray.ts"),Re=n("../spread-sheet/src/external/templateinfo/sync-template.ts"),Ie=function(e){function t(){var t;return(t=e.apply(this,arguments)||this).humtransDoc=function(){(0,Re.D)()},t.doLogin=function(){n.g.SLR.dispatch("TX-LOGIN-SHOW",{})},t}(0,s.Z)(t,e);var r=t.prototype;return r.componentDidMount=function(){this.initEvent()},r.initEvent=function(){12===F.q.getConfig("docStatus")&&(SpreadsheetApp.event.network.one("commitSuccess",this.humtransDoc),j.ju.once(SpreadsheetApp.spreadsheet.onUpdateTitle)(this.humtransDoc))},r.render=function(){var e=n.g.clientVars,t=e.domainId,r=e.localPadId,o=e.isCreator,i=e.padType,s=e.padTitle,a=e.userInfo,c=e.isOwner,d=F.q.getConfig("isLogin");return x().createElement("div",{className:"badge-container"},x().createElement(be(),{domainId:t,localPadId:r,isCreator:o,padType:i,padTitle:s,isLogin:d,isOwner:c,doLogin:this.doLogin,user:a,isToBUser:(0,Te.c)()}))},t}(x().Component),Ce=(n("../node_modules/core-js/modules/es.function.name.js"),n("../spread-sheet/src/core/ark-extensions/extensions/collaboration.ts")),Ae=n("../spread-sheet/src/core/ark-extensions/index.ts"),xe=n("../spread-sheet/src/external/check-slr/check-script-loader.ts"),Oe=n("../spread-sheet/src/base/util/decorator/loading-decorator.ts"),Ne=function(e,t,n,r){var o,i=arguments.length,s=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},Se=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},ke=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function s(e){try{c(r.next(e))}catch(t){i(t)}}function a(e){try{c(r.throw(e))}catch(t){i(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))},Pe=function(){function e(e){var t=this;this.policyInfoFeature=e,this.init=function(){var e=document.getElementById("otherusersComponent"),n=document.getElementById("otherusersDivider");e&&n&&(t.container=e,t.divider=n,t.initCollaboration(),t.initEvent())},this.fixWidth=function(e){var n,r;null===(n=t.collabListInterfaces)||void 0===n||n.fixWidth(e),null===(r=t.collabListInterfaces)||void 0===r||r.hideMore()},this.initEvent=function(){var e;null===(e=t.policyInfoFeature)||void 0===e||e.onPolicyInfoChange((function(){t.initCollaboration()}))},this.initCollaboration=function(){return ke(t,void 0,void 0,regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.isInit&&(0,xe.g)()){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,this.getCollaborationExtension();case 4:(t=e.sent).show({container:this.container,getClientVars:function(){return n.g.clientVars},onRenderContent:this.onRenderContent,onDestroyContent:this.onDestroyContent,getInterfaces:this.getCollabListInterfaces,eventNotice:this.eventNotice}),this.isInit=!!t;case 7:case"end":return e.stop()}}),e,this)})))},this.onRenderContent=function(){t.divider&&(t.divider.style.display="inline-block")},this.onDestroyContent=function(){t.divider&&(t.divider.style.display="none")},this.getCollabListInterfaces=function(e){t.collabListInterfaces=e,t.containerShow(),t.bindEvent()}}var t=e.prototype;return t.getCollaborationExtension=function(){return ke(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ae.default.getExtension(Ce.M.name);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))},t.containerShow=function(){this.container&&(this.container.style.display="inline-block")},t.bindEvent=function(){var e=this;window.addEventListener("resize",(function(){var t;null===(t=e.collabListInterfaces)||void 0===t||t.hideMore()}))},t.eventNotice=function(){},e}();Ne([(0,Oe.n)(),Se("design:type",Function),Se("design:paramtypes",[]),Se("design:returntype",Promise)],Pe.prototype,"getCollaborationExtension",null),Pe=Ne([(0,D.L)({adapters:[Z.L,B.dH]}),Se("design:paramtypes",["function"===typeof(ye="undefined"!==typeof G&&G)?ye:Object])],Pe);var De=n("../node_modules/@tencent/dui/lib/index.js"),Le=function(e){function t(){return e.apply(this,arguments)||this}(0,s.Z)(t,e);var n=t.prototype;return n.componentDidMount=function(){this.userLineFeature=S.Am.get(Pe),this.userLineFeature.init()},n.render=function(){return x().createElement("div",{style:{display:"flex",justifyContent:"center",alignItems:"center"}},x().createElement("div",{style:{marginRight:8},id:"otherusersComponent"}),x().createElement("div",{id:"otherusersDivider",style:{display:"none"}},x().createElement(De.Divider,{style:{margin:"0px 4px",height:"24px",width:"1px",opacity:.06,borderRight:"1px solid rgb(0, 0, 0)",verticalAlign:"top",display:"inline-block"}})))},t}(x().Component),Me=n("../node_modules/@babel/runtime/helpers/esm/objectDestructuringEmpty.js"),Fe=n("../node_modules/@tencent/dui/lib/components/Divider/index.js"),je=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function s(e){try{c(r.next(e))}catch(t){i(t)}}function a(e){try{c(r.throw(e))}catch(t){i(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))},He=function(e){function t(t){var n;return(0,Me.Z)(t),(n=e.call(this,{})||this).state={online:!1,isShow:!1},n}(0,s.Z)(t,e);var n=t.prototype;return n.componentDidMount=function(){var e=this;xe.e.load("GroupTips",(function(t){return je(e,void 0,void 0,regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((n=document.getElementById("titlebar-qqgroup-info"))&&t){e.next=3;break}return e.abrupt("return");case 3:return e.t0=this,e.next=6,t.show(n);case 6:e.t1=e.sent,e.t2={isShow:e.t1},e.t0.setState.call(e.t0,e.t2);case 9:case"end":return e.stop()}}),e,this)})))}))},n.render=function(){return x().createElement("div",{style:{display:"flex",alignItems:"center",justifyContent:"center"}},x().createElement("span",{style:{width:8,display:this.state.isShow?"flex":"none"}}),x().createElement("div",{id:"titlebar-qqgroup-info",className:"goto-group-aio"}),x().createElement("div",{style:{display:this.state.isShow?"flex":"none"},id:"qqgroup-info-divider"},x().createElement(Fe.default,{style:{margin:"6px 4px 6px 12px",height:"24px",width:"1px",opacity:.06,borderRight:"1px solid rgb(0, 0, 0)",verticalAlign:"top",display:"inline-block"}})))},t}(x().Component),Ze=n("../node_modules/lottie-web/build/player/lottie.js"),Be=n.n(Ze);function ze(e){if(e instanceof Date)return[e.getFullYear(),"年",e.getMonth()+1,"月",e.getDate(),"日 ",e.getHours()>9?e.getHours():"0"+e.getHours(),":",e.getMinutes()>9?e.getMinutes():"0"+e.getMinutes(),":",e.getSeconds()>9?e.getSeconds():"0"+e.getSeconds()].join("")}function Ue(e){if(e instanceof Date)return[e.getFullYear(),"年",e.getMonth()+1,"月"].join("")}function Ve(e){if(e instanceof Date)return[e.getMonth()+1,"月",e.getDate(),"日"].join("")}function We(e){if(e instanceof Date)return[e.getHours()>9?e.getHours():"0"+e.getHours(),":",e.getMinutes()>9?e.getMinutes():"0"+e.getMinutes()].join("")}n("../node_modules/core-js/modules/es.array.join.js");var Ge,Ye=n("../node_modules/@tencent/containerized/build/main/index.js"),Ke=n("../spread-sheet/src/external/history/pc/History.interface.ts"),Xe=function(e,t,n,r){var o,i=arguments.length,s=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},qe=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},Qe=function(e,t){return function(n,r){t(n,r,e)}},$e=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function s(e){try{c(r.next(e))}catch(t){i(t)}}function a(e){try{c(r.throw(e))}catch(t){i(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))},Je=function(e){var t=this;this.history=e,this.showHistory=function(){return $e(t,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.history.getInstance();case 2:e.sent.show(),oe.ZP.tdwReport({module:"autosave_hyperlinks",opername:"doc_menubar",action:"click",ver12:"new"});case 4:case"end":return e.stop()}}),e,this)})))}};Je=Xe([(0,D.L)({adapters:[Z.L,B.dH]}),Qe(0,Ke.z),qe("design:paramtypes",["function"===typeof(Ge="undefined"!==typeof Ye.RU&&Ye.RU)?Ge:Object])],Je);var et,tt=function(e){function t(t){var r;return(r=e.call(this,t)||this).showSaveStateTips=function(){r.playLoadingAnimate(!1),r.state.hasEdit=!0,r.saveTipsCache=(new Date).getTime();var e=x().createElement("div",{className:"header-tips"},x().createElement("span",null,O.ZP.t("所有编辑内容都会自动保存到云端")));r.setState({saveTips:O.ZP.t("保存成功"),saveIconToolTips:e}),setTimeout((function(){r.setState({saveTips:O.ZP.t("最近保存 ")+We(new Date)})}),3e3)},r.networkChange=function(e){if("online"===e){if(r.state.online)return;r.setSaveTips(),r.setState({online:!0}),r.playLoadingAnimate(!0)}else r.state.online&&r.setState(r.getOfflineState())},r.getOfflineState=function(){var e=n.g.clientVars;r.loadingInstance=null;var t=e.privilegeAttribute.can_edit?x().createElement("div",{className:"header-tips"},O.ZP.t("网络断开，内容已保存到本地，网络通畅时同步到云端")):O.ZP.t("正在离线查看");return{online:!1,saveTips:r.props.isReadableDoc?O.ZP.t("正在离线编辑"):O.ZP.t("网络断开，内容已保存到本地，网络通畅时同步到云端"),saveIconToolTips:t}},r.setSaveTips=function(){var e=n.g.clientVars,t=F.q.getConfig("userId"),o=e.lastModifyUser,i=e.lastModifyTime,s=F.q.getConfig("metaCreateTime");if(i&&i-s>3e3&&o){if(r.props.isReadableDoc)return void r.setState({saveTips:O.ZP.t("最近保存 ")+ze(new Date(i))});var a="";t!==o?function(e,t,n,r){for(var o="[",i=0;i<e.length;i++){var s=e.length==i+1?"":",";o=o+e[i]+s}o+="]";var a=ee.GET_USER_AVATAR_MARKNAME+"?tag="+r+"&bkn="+(0,M.G)()+"&domainId="+n+"&localPadId="+r+"&uids="+encodeURIComponent(o)+"&xsrf="+(0,M.f)();P().get(a,{responseType:"json",withCredentials:!0}).then((function(e){var n=e.data;0===n.retcode?t&&t(n.result):t&&t(!1),null===t||void 0===t||t()})).catch((function(){null===t||void 0===t||t(!1)}))}([o.split(".")[1]],(function(e){(null===e||void 0===e?void 0:e.rsp)&&(a=e.rsp[0].markName).length>7&&(a=a.substr(0,7)+".."),r.setSaveTipsWithNickName(a)}),e.domainId,e.padId):r.setSaveTipsWithNickName(a)}else r.setState({saveTips:r.props.isReadableDoc?O.ZP.t("所有编辑内容都会自动保存到云端"):r.defaultSaveTips,saveIconToolTips:x().createElement("div",{className:"header-tips"},x().createElement("span",null,O.ZP.t("所有编辑内容都会自动保存到云端")))})},r.setSaveTipsWithNickName=function(e){var t,o="",i=n.g.clientVars.lastModifyTime,s=r.saveTipsCache?((new Date).getTime()-r.saveTipsCache)/1e3:((new Date).getTime()-i)/1e3;o=s<60?O.ZP.t("上次修改是{{userStr}}在刚刚进行的",{userStr:e}):s<3600?O.ZP.t("上次修改是{{userStr}}在{{time}}分钟前进行的",{userStr:e,time:Math.floor(s/60)}):s<86400?O.ZP.t("上次修改是{{userStr}}在{{time}}小时前进行的",{userStr:e,time:Math.floor(s/3600)}):s<604800?O.ZP.t("上次修改是{{userStr}}在{{time}}天前进行的",{userStr:e,time:Math.floor(s/86400)}):new Date(i).getFullYear()==(new Date).getFullYear()?O.ZP.t("上次修改是{{userStr}}在{{time}}进行的",{userStr:e,time:Ve(new Date(i))}):O.ZP.t("上次修改是{{userStr}}在{{time}}进行的",{userStr:e,time:Ue(new Date(i))}),t=x().createElement("div",{className:"header-tips"},x().createElement("span",null,O.ZP.t("所有编辑内容都会自动保存到云端"))),r.setState({saveTips:o,saveIconToolTips:t})},r.playLoadingAnimate=function(e){if(document.getElementById("save-state-icon-container")){var t=r.getLoadingInstance();t.show(),e?t.goToAndStop(t.totalFrames,!0):(t.goToAndStop(1,!0),t.play())}},r.getLoadingInstance=function(){return r.loadingInstance||(r.loadingInstance=Be().loadAnimation({container:document.getElementById("save-state-icon-container"),autoplay:!1,renderer:"svg",loop:!1,animationData:r.loadingAnimateJson})),r.loadingInstance},r.showHistory=function(){r.props.isReadableDoc||(oe.ZP.tdwReport({opername:"doc_menubar",module:"autosave_hyperlinks",action:"click"}),S.Am.get(Je).showHistory())},r.state={saveIconToolTips:"",saveTips:"",hideSaveStateText:!1,online:K.network.isOnline,hasEdit:!1,showSaveState:z.Z.getConfig("titlebar.saveState")},r.saveTipsCache=null,r.loadingAnimateJson={v:"4.11.1",fr:24,ip:0,op:32,w:16,h:16,nm:"1120 save",ddd:0,assets:[],layers:[{ddd:0,ind:1,ty:4,nm:"save - 2",sr:1,ks:{o:{a:0,k:100,ix:11},r:{a:0,k:0,ix:10},p:{a:0,k:[8.239,7.954,0],ix:2},a:{a:0,k:[6.077,4.744,0],ix:1},s:{a:0,k:[100,100,100],ix:6}},ao:0,shapes:[{ty:"gr",it:[{ind:0,ty:"sh",ix:1,ks:{a:0,k:{i:[[0,0],[0,0],[0,0]],o:[[0,0],[0,0],[0,0]],v:[[3.577,-2.244],[-.911,2.244],[-3.577,-.423]],c:!1},ix:2},nm:"Path 1",mn:"ADBE Vector Shape - Group",hd:!1},{ty:"st",c:{a:0,k:[.5058823529411764,.5254901960784314,.5607843137254902,1],ix:3},o:{a:0,k:100,ix:4},w:{a:0,k:1,ix:5},lc:1,lj:1,ml:10,nm:"Stroke 1",mn:"ADBE Vector Graphic - Stroke",hd:!1},{ty:"tr",p:{a:0,k:[6.077,4.744],ix:2},a:{a:0,k:[0,0],ix:1},s:{a:0,k:[100,100],ix:3},r:{a:0,k:0,ix:6},o:{a:0,k:100,ix:7},sk:{a:0,k:0,ix:4},sa:{a:0,k:0,ix:5},nm:"Transform"}],nm:"Group 1",np:2,cix:2,ix:1,mn:"ADBE Vector Group",hd:!1},{ty:"tm",s:{a:1,k:[{i:{x:[.712],y:[1]},o:{x:[1],y:[0]},n:["0p712_1_1_0"],t:12,s:[100],e:[0]},{t:21}],ix:1},e:{a:0,k:100,ix:2},o:{a:0,k:0,ix:3},m:1,ix:2,nm:"Trim Paths 1",mn:"ADBE Vector Filter - Trim",hd:!1}],ip:0,op:48,st:0,bm:0},{ddd:0,ind:2,ty:4,nm:"save - 1",sr:1,ks:{o:{a:0,k:100,ix:11},r:{a:0,k:0,ix:10},p:{a:0,k:[8.016,8.016,0],ix:2},a:{a:0,k:[9,9,0],ix:1},s:{a:0,k:[100,100,100],ix:6}},ao:0,shapes:[{ty:"gr",it:[{ind:0,ty:"sh",ix:1,ks:{a:0,k:{i:[[0,-3.59],[3.59,0],[0,3.59],[-3.59,0]],o:[[0,3.59],[-3.59,0],[0,-3.59],[3.59,0]],v:[[6.5,0],[0,6.5],[-6.5,0],[0,-6.5]],c:!0},ix:2},nm:"Path 1",mn:"ADBE Vector Shape - Group",hd:!1},{ty:"st",c:{a:0,k:[.5058823529411764,.5254901960784314,.5607843137254902,1],ix:3},o:{a:0,k:100,ix:4},w:{a:0,k:1,ix:5},lc:1,lj:1,ml:10,nm:"Stroke 1",mn:"ADBE Vector Graphic - Stroke",hd:!1},{ty:"tr",p:{a:0,k:[9,9],ix:2},a:{a:0,k:[0,0],ix:1},s:{a:0,k:[100,100],ix:3},r:{a:0,k:0,ix:6},o:{a:0,k:100,ix:7},sk:{a:0,k:0,ix:4},sa:{a:0,k:0,ix:5},nm:"Transform"}],nm:"Group 1",np:2,cix:2,ix:1,mn:"ADBE Vector Group",hd:!1},{ty:"tm",s:{a:1,k:[{i:{x:[.245],y:[1]},o:{x:[.333],y:[0]},n:["0p245_1_0p333_0"],t:4,s:[100],e:[0]},{t:11}],ix:1},e:{a:0,k:100,ix:2},o:{a:0,k:-90,ix:3},m:1,ix:2,nm:"Trim Paths 1",mn:"ADBE Vector Filter - Trim",hd:!1}],ip:0,op:48,st:0,bm:0}]},r.offlineIcon='<svg width="16px" height="16px" viewBox="0 0 16 16" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><g id="_图标/Icon/离线状态" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><path d="M8,2 C9.47581065,2 10.7856902,2.71043533 11.606301,3.80796827 L12.7664447,2.6473072 L13.4735515,3.35441398 L2.15984297,14.6681225 L1.45273619,13.9610157 L2.165,13.248 L1.99239967,13.1165777 C1.08229441,12.3833763 0.5,11.2596892 0.5,10 C0.5,8.13052949 1.78248717,6.56059992 3.5156492,6.12202358 C3.70762181,3.8136169 5.64201444,2 8,2 Z M12.4457089,5.79890732 C12.4623717,5.90542037 12.4752984,6.01317188 12.4843508,6.12202358 C14.2175128,6.56059992 15.5,8.13052949 15.5,10 C15.5,12.209139 13.709139,14 11.5,14 L4.5,14 C4.41674526,14 4.33408459,13.9974565 4.25209146,13.9924429 L5.243,13 L11.5,13 C13.1568542,13 14.5,11.6568542 14.5,10 C14.5,8.61884025 13.558374,7.42532529 12.2390335,7.09146641 L11.5469557,6.91633625 L11.529,6.714 L12.4457089,5.79890732 Z M8,3 C6.176633,3 4.66227734,4.40037857 4.51220905,6.20489987 L4.4530443,6.91633625 L3.76096654,7.09146641 C2.44162603,7.42532529 1.5,8.61884025 1.5,10 C1.5,11.0625268 2.05237534,11.9960393 2.88562806,12.5290398 L10.889,4.524 L10.7669564,4.35587347 C10.1247582,3.52907442 9.12075258,3 8,3 Z" id="形状结合" fill="#FE6C6C" fill-rule="nonzero"></path></g></svg>',r.defaultSaveTips=O.ZP.t("所有编辑内容都会自动保存到云端"),r.saveStateTextContainer=x().createRef(),r.saveStateTextContainerOffline=x().createRef(),r}(0,s.Z)(t,e);var r=t.prototype;return r.componentDidMount=function(){var e=this;this.props.customizedSaveTips&&(this.defaultSaveTips=this.props.customizedSaveTips),this.setSaveTips(),this.playLoadingAnimate(!0),K.network.changeEnd(this.networkChange);var t=S.Am.get(pe);this.showSaveTips=t.onShowSaveTips((function(){e.showSaveStateTips()}))},r.componentWillUnmount=function(){this.showSaveTips.dispose(),K.network.remove(this.networkChange)},r.render=function(){var e=this.props.forceOffline?this.getOfflineState():this.state,t=e.online,n=e.saveTips,r=e.saveIconToolTips;return x().createElement("div",{className:"save-state-container",style:{display:this.state.showSaveState?"block":"none"}},x().createElement(N.default,{className:"save-state-tooltip",containerOffsetY:-7,placement:"bottom",title:r,style:{whiteSpace:"nowrap",maxWidth:"100%"},disabled:this.props.saveTipsDisabled||this.props.isReadableDoc},t?x().createElement("span",{id:"save-state-icon-container"}):x().createElement("div",{id:"save-state-icon-container-offline",dangerouslySetInnerHTML:{__html:this.offlineIcon}}),t&&!this.state.hideSaveStateText?x().createElement("span",{id:this.props.isReadableDoc?"save-state-text-container-readOnly":"save-state-text-container",ref:this.saveStateTextContainer,onClick:this.showHistory},n):null,t||this.state.hideSaveStateText?null:x().createElement("span",{id:"save-state-text-container-offline",ref:this.saveStateTextContainerOffline},n)))},t}(x().Component),nt=n("../node_modules/@tencent/docs-user-agent/dist/index.js"),rt=n.n(nt),ot=n("../node_modules/@tencent/dui/lib/components/Button/index.js"),it=n("../spread-sheet/src/external/view/ui-layer/titlebar/components/share-btn/share-manager.ts"),st=n("../spread-sheet/src/external/view/common/rangeAuthApiForFeatureComponent/index.ts"),at=n("../spread-sheet/src/base/util/domain-config.ts"),ct=n("../node_modules/classnames/index.js"),dt=n.n(ct),lt=function(e){function t(t){var n;return(n=e.call(this,t)||this).networkChange=function(e){"online"===e?!n.state.online&&n.setState({online:!0}):n.state.online&&n.setState({online:!1})},n.handleShare=function(){var e;if(oe.ZP.tdwReport({opername:"doc_share",module:"share",action:"clk",ver6:"detail"}),window.document.activeElement.blur(),rt().isMiniProgram){var t="/pages/sharePanel/sharePanel?url="+encodeURIComponent(location.origin+location.pathname);null===(e=window.wx)||void 0===e||e.miniProgram.navigateTo({url:t})}else(0,it.Ak)((function(){}),{rangeAuthApi:st.Z})},n.state={online:K.network.isOnline},n}(0,s.Z)(t,e);var n=t.prototype;return n.componentDidMount=function(){K.network.changeEnd(this.networkChange)},n.componentWillUnmount=function(){K.network.remove(this.networkChange)},n.render=function(){var e=this;return dt()({"titlebar-btn-container":!0}),dt()({"titlebar-icon":!0,"titlebar-icon-wework-share":at.xc}),x().createElement(x().Fragment,null,x().createElement(ot.default,{type:"primary",disabled:!1===this.state.online,className:"share-button",onClick:function(){e.handleShare()}},O.ZP.t("分享")))},t}(x().Component),ut=n("../node_modules/lodash/get.js"),_t=n.n(ut),pt=n("../packages/common-utils/src/index.ts"),ft=(n("../node_modules/core-js/modules/es.object.assign.js"),n("../spread-sheet/src/external/auth/base/ApplyService.ts"));!function(e){e.NEED_LOGIN="NEED_LOGIN",e.NEED_APPLY="NEED_APPLY",e.APPLIED="APPLIED",e.APPLY_SUCCES="APPLY_SUCCES",e.APPLY_FAIL="APPLY_FAIL",e.OTHER="OTHER"}(et||(et={}));var ht=n("../spread-sheet/src/core/ui/toast/toast.tsx"),mt=n("../spread-sheet/src/core/login/index.ts"),vt=function(e){function t(t){var n;return(n=e.call(this,t)||this).handleClick=function(){n.canEditExceptWorkbookStatus()&&!n.isPreviewOrDynamicStatus()&&n.sheetStatus.highWaterStatus.isCurrSelectionCanEdit&&n.isTimeDuringAllow()&&n.showToast()},n.canCopy=function(){return 1===F.q.getConfig("canCopy")},n.getSnackBarParam=function(e,t){var r=n.getReadOnlyTip(!0);r=n.updateTipIfRangeAuth(r);var o=n.initSnackbarParam(e,r);return n.isTobOrNotShowAction(t)?o:(oe.ZP.tdwReport({opername:"doc_author",module:"edit",action:"clk_apply_toast"}),r.tipStatus===et.NEED_LOGIN?o=n.setExtendParamIfNeedLogin(o):r.tipStatus===et.APPLY_SUCCES?o=n.setExtendParamIfApplySuccess(o):o)},n.initSnackbarParam=function(e,t){var n={type:"info",autoClose:!0,duration:5e3,style:{zIndex:20001}};return n.message=(e||t.tip).replace(/<[^>]+>/g," "),n},n.setExtendParamIfApplySuccess=function(e){var t=e;return t.action=O.ZP.t("申请编辑权限"),t.onClickAction=function(){n.doAuthApply()},t},n.setExtendParamIfNeedLogin=function(e){var t=e;return t.action=O.ZP.t("立即登录"),t.onClickAction=function(){mt.Z.showLoginModal(),oe.ZP.tdwReport({opername:"doc_login",module:"readonly",action:"try_edit_toast_login_pc"})},oe.ZP.tdwReport({opername:"doc_login",module:"readonly",action:"try_edit_toast_exp_pc"}),t},n.updateTipIfRangeAuth=function(e){var t,r=e;return(null===(t=n.sheetStatus.getActiveSheetStatus())||void 0===t?void 0:t.canEdit)||(r.tip=r.tip.replace(O.ZP.t("无权限编辑该文档"),O.ZP.t("无权限编辑该工作表")),oe.ZP.tdwReport({opername:"doc_excel_editor",module:"excel_authority",action:"authority_toast"})),r},n.isTimeDuringAllow=function(){var e=Date.now(),t=e-n.lastClickTime>500;return n.lastClickTime=e,t},n.init(),n}(0,s.Z)(t,e);var r=t.prototype;return r.bindClickEvent=function(){var e=this,t=document.getElementById("mainContainer");null===t||void 0===t||t.addEventListener("dblclick",(function(){e.handleClick()}))},r.doAuthApply=function(){n.g.SLR.load("PermitApply",(function(e){e.permitApply(),oe.ZP.tdwReport({opername:"doc_author",module:"edit",action:"clk_apply"})}))},r.getReadOnlyTip=function(e){var t=this.applyAuthStatus,n=!F.q.getConfig("isLogin"),r=!1,o=O.ZP.t("无权限编辑该文档，\n点击申请编辑权限。");if(n){var i=O.ZP.t("当前仅能查看，请登录后再操作。");return o=O.ZP.t("无权限编辑该文档，\n登录后获得更多操作权限。"),{tip:i,isNeedApplyAuth:r,isNeedLogin:n,tipStatus:et.NEED_LOGIN,hoverTip:o}}if(this.isApplyAndUnpass(t)){var s=O.ZP.t('权限申请已提交，请等待创建者<span id="readonlyTipOwnerNick">{{value}}</span>审核。',{value:(0,pt.nE)(F.q.getConfig("ownerNick"),7)});return o=O.ZP.t("权限申请已提交。"),{tip:s,isNeedApplyAuth:r,isNeedLogin:n,tipStatus:et.APPLIED,hoverTip:o}}if(this.isApplyAndNopass(t)){var a=O.ZP.t("权限申请未通过，“只能查看”文档。");return o=a,{tip:a,isNeedApplyAuth:r,isNeedLogin:n,tipStatus:et.APPLY_FAIL,hoverTip:o}}var c=this.noApplyGetTip(e);return Object.assign(Object.assign({},c),{isNeedLogin:n})},r.init=function(){this.checkIsApplyIn24H(),this.bindClickEvent(),this.bindGuidePermit()},r.noApplyGetTip=function(e){var t=this.canCopy(),n=et.APPLY_SUCCES,r=O.ZP.t("无权限编辑该文档，\n点击申请编辑权限{{value}}。",{value:t?O.ZP.t("或生成副本"):""}),o=O.ZP.t("无权限编辑该文档。");return e||(o=O.ZP.t('你只能查看此文档。若要编辑文档，请向文档创建者<span id="readonlyTipOwnerNick">{{value0}}</span>申请编辑权限{{value1}}进行编辑。',{value0:(0,pt.nE)(F.q.getConfig("ownerNick"),7),value1:t?O.ZP.t("或生成副本"):""})),{isNeedApplyAuth:!0,tipStatus:n,hoverTip:r,tip:o}},r.showToast=function(e,t,n){if(void 0===e&&(e="default"),void 0===t&&(t=""),void 0===n&&(n=!0),(0,ht.hideToast)(),this.isShowToastByCount(e)){var r=this.getSnackBarParam(t,n);Q.default.show(r),oe.ZP.tdwReport({opername:"doc_author",module:"edit",action:"exp_toast"})}},r.isTobOrNotShowAction=function(e){var t=F.q.getConfig("canApplyEdit");return!e||!t},r.isShowToastByCount=function(e){return void 0===this.applyToastShowTimes[e]&&(this.applyToastShowTimes[e]=0),this.applyToastShowTimes[e]<1&&(this.applyToastShowTimes[e]+=1,!0)},t}(ft.Z),yt=vt,gt=n("../spread-sheet/src/core/feature/formula/utils.ts"),Et=function(){function e(){this.applicationUnreadNumber=0,this.init()}var t=e.prototype;return t.checkHasRedpoint=function(){var e=this;P().get("/cgi-bin/online_docs/notify_getnum",{withCredentials:!0,params:{bkn:(0,M.G)()}}).then((function(t){var n;0===(null===(n=t.data)||void 0===n?void 0:n.cgicode)&&((0,gt.o8)(t.data.unread_sum_count)?e.clearUnreadNotificationNumber():e.setUnreadNotificationNumber(t.data.unread_sum_count))})).catch((function(e){n.g.log.log("checkHasRedpoint",e)}))},t.clearUnreadNotificationNumber=function(){this.applicationUnreadNumber=0,this.setOutSideRedPoint();var e=new CustomEvent("setUnreadNotificationNumberNoti",{detail:{number:0}});document.dispatchEvent(e)},t.listenNotificationMessage=function(){var e=this;document.addEventListener("resetOuterUnreadNumberNoti",(function(t){e.setUnreadNotificationNumber(t.detail.number)}))},t.init=function(){this.listenNotificationMessage()},t.setUnreadNotificationNumber=function(e){this.applicationUnreadNumber=0,this.addUnreadNotificationNumber(e)},t.addUnreadNotificationNumber=function(e){void 0===e&&(e=0),this.applicationUnreadNumber+=e,this.setOutSideRedPoint();var t=new CustomEvent("setUnreadNotificationNumberNoti",{detail:{number:this.applicationUnreadNumber}});document.dispatchEvent(t)},t.setOutSideRedPoint=function(){var e=this.applicationUnreadNumber;window.SLR.load("AccountAvatar",(function(t){t.updateRedPoint(e)})),e&&oe.ZP.tdwReport({opername:"doc_author",module:"notice",action:"exp_red_notice"})},e}(),wt=function(e){function t(){return e.apply(this,arguments)||this}return(0,s.Z)(t,e),t}(Et),bt=wt,Tt=function(e,t,n,r){var o,i=arguments.length,s=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},Rt=function(){var e=this;this.initRedPointerService=function(){e.redPointerService=new bt},this.getRedPointService=function(){return e.redPointerService}};Rt=Tt([(0,D.L)({adapters:[Z.L,B.dH]})],Rt);var It,Ct,At=function(e,t,n,r){var o,i=arguments.length,s=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},xt=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},Ot=function(){function e(e,t){var n=this;this.redPointFeature=e,this.titlebarService=t,this.loadAccountAvatar=function(e){n.avatarDomId=e,n.updateAccountAvatar(e)},this.handleAvatarShow=function(){n.initAccountModule(),oe.ZP.tdwReport({module:"avatar_button",opername:"doc_menubar",action:"click",ver12:"new"})},this.handleTitleFocus=function(){oe.ZP.tdwReport({module:"title_box",opername:"doc_menubar",action:"click",ver12:"new"})},this.handleAvatarChange=function(e){var t=document.getElementById(n.avatarDomId);t&&(t.style.position=e.position,t.style.top=e.top,t.style.right=e.right,t.style.left=e.left)},this.initAccountAvatar=function(){n.updateAccountAvatar(n.avatarDomId)}}var t=e.prototype;return t.initAccountModule=function(){var e,t=this;null===(e=n.g.SLR)||void 0===e||e.load("Account",(function(e){try{var n=document.getElementById("accountContainer");n||((n=document.createElement("div")).id="accountContainer",document.body.appendChild(n));var r=document.getElementById("account-avatar-container"),o=null===r||void 0===r?void 0:r.getBoundingClientRect(),i=document.body.clientWidth-(o?o.right:19),s={top:o?o.bottom:54,right:i,logoutRefresh:!1,padId:"",domainId:"",userInfo:{}};null===e||void 0===e||e.show(n,s),t.titlebarService.setHoverActive(!1),window.SLR.dispatch("TXDOC-ACCOUNT-SHOW",{})}catch(a){console.error(a)}}))},t.updateAccountAvatar=function(e){var t,r=document.getElementById(e);r&&window.SLR?null===(t=n.g.SLR)||void 0===t||t.load("AccountAvatar",this.handleAccountAvatarInit.bind(this,r)):console.error("Avatar container or SLR is load fail!")},t.handleAccountAvatarInit=function(e,t){var n;null===t||void 0===t||t.init({container:e,userPic:F.q.getConfig("userPic"),isSquare:!0,userType:(0,pt.ej)("utype"),uin:F.q.getConfig("uin"),nick:F.q.getConfig("nick")}),null===(n=this.redPointFeature.getRedPointService())||void 0===n||n.checkHasRedpoint()},e}();Ot=At([(0,D.L)({adapters:[Z.L,B.dH]}),xt("design:paramtypes",["function"===typeof(It="undefined"!==typeof Rt&&Rt)?It:Object,"function"===typeof(Ct="undefined"!==typeof c.M&&c.M)?Ct:Object])],Ot);var Nt,St,kt=function(e){function t(t){var n;return(n=e.call(this,t)||this).networkChange=function(e){"online"===e?!n.state.online&&n.setState({online:!0},(function(){window.AccountAvatar&&(window.AccountAvatar.accountAvatar.inited=!1),n.avatarFeature.loadAccountAvatar("self-info")})):n.state.online&&n.setState({online:!1})},n.state={online:K.network.isOnline},n.avatarFeature=S.Am.get(Ot),n}(0,s.Z)(t,e);var n=t.prototype;return n.componentDidMount=function(){var e=this;this.props.isNotListenOnline||K.network.changeEnd(this.networkChange),this.avatarFeature.loadAccountAvatar("self-info"),null===window||void 0===window||window.SLR.listen("SL-INIT",(function(){e.avatarFeature.initAccountAvatar()}))},n.componentWillUnmount=function(){K.network.remove(this.networkChange)},n.render=function(){var e=this.state.online,t=_t()(this.props,"initData.userInfo.userPic"),n=t?{backgroundImage:"url("+t+")",backgroundSize:"28px 28px"}:{},r=dt()({"user-info-wrap":!at.xc,"user-info-ent-warp":at.xc});return x().createElement(x().Fragment,null,e&&x().createElement("div",{className:r},x().createElement("div",{className:"user-info-border"}),x().createElement("div",{className:"user-info-fake",style:n},x().createElement("div",{className:"user-info-container",onClick:this.avatarFeature.handleAvatarShow,id:"self-info"}))))},t}(x().Component),Pt=function(e){function t(t){var n;return(n=e.call(this,t)||this).networkChange=function(e){"online"===e?!n.state.online&&n.setState({online:!0}):n.state.online&&n.setState({online:!1})},n.handleLogin=function(){window.SLR.dispatch("TX-LOGIN-SHOW",{})},n.state={online:K.network.isOnline},n}(0,s.Z)(t,e);var n=t.prototype;return n.componentDidMount=function(){K.network.changeEnd(this.networkChange)},n.componentWillUnmount=function(){K.network.remove(this.networkChange)},n.render=function(){return x().createElement(x().Fragment,null,x().createElement(ot.default,{type:"primary",disabled:!1===this.state.online,id:"header-login-btn",className:"header-login-button",onClick:this.handleLogin},O.ZP.t("登录腾讯文档")))},t}(x().Component),Dt=n("../spread-sheet/src/core/ark-extensions/extensions/collect.ts"),Lt=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function s(e){try{c(r.next(e))}catch(t){i(t)}}function a(e){try{c(r.throw(e))}catch(t){i(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))},Mt=function(e){function t(){return e.apply(this,arguments)||this}(0,s.Z)(t,e);var n=t.prototype;return n.componentDidMount=function(){return Lt(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(0,Ae.updateDomainClientVars)(),e.next=3,Ae.default.getExtension(Dt.T.name);case 3:null===(t=e.sent)||void 0===t||t.show({container:document.getElementById("pc-header-collect"),isEntAccount:!this.props.isToCUser});case 5:case"end":return e.stop()}}),e,this)})))},n.render=function(){return x().createElement("div",{id:"pc-header-collect"})},t}(A.Component),Ft=n("../spread-sheet/src/core/ark-extensions/extensions/wedrive-file-selector.ts"),jt=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function s(e){try{c(r.next(e))}catch(t){i(t)}}function a(e){try{c(r.throw(e))}catch(t){i(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))},Ht=function(e){function t(){return e.apply(this,arguments)||this}(0,s.Z)(t,e);var n=t.prototype;return n.componentDidMount=function(){return jt(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=22,e.next=3,Ae.default.getExtension(Ft._.name);case 3:null===(n=e.sent)||void 0===n||n.show({container:document.getElementById("pc-header-move"),fileId:"",show:!0,docId:F.q.getConfig("padId"),shareCode:(0,pt.IZ)("scode"),getEnableMoveToWeDrive:function(){return(window.clientVars.wecom_allow_op||[]).indexOf(t)>-1},getTitle:function(){return F.q.getConfig("padTitle")}});case 5:case"end":return e.stop()}}),e)})))},n.render=function(){return x().createElement("div",{id:"pc-header-move"})},t}(A.Component),Zt=n("../node_modules/@babel/runtime/helpers/esm/assertThisInitialized.js"),Bt=n("../spread-sheet/src/core/ark-extensions/extensions/mini-list.ts"),zt=function(e,t,n,r){var o,i=arguments.length,s=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},Ut=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},Vt=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function s(e){try{c(r.next(e))}catch(t){i(t)}}function a(e){try{c(r.throw(e))}catch(t){i(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))};!function(e){e[e.LIST_VISIBILITY_CHANGE=0]="LIST_VISIBILITY_CHANGE"}(St||(St={}));var Wt=function(e){function t(){var t;return(t=e.apply(this,arguments)||this).initMiniList=function(){return Vt((0,Zt.Z)(t),void 0,void 0,regeneratorRuntime.mark((function e(){var t,n,r=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.props.isToC,e.next=3,this.getMiniListExtension();case 3:return(n=e.sent).show({container:document.getElementById("pc-header-mini-list"),show:!0,isToC:t,weworkTimelineGray:F.q.getConfig("weworkTimelineGray")}),n.onListVisibilityChange((function(e){e.currentVisibility?r.titlebarService.setHoverActive(!1):r.titlebarService.setHoverActive(!0)})),e.abrupt("return",n);case 7:case"end":return e.stop()}}),e,this)})))},t.handleMouseEnterHomeIcon=function(){return Vt((0,Zt.Z)(t),void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.miniListExtension){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,this.initMiniList();case 4:this.miniListExtension=e.sent;case 5:case"end":return e.stop()}}),e,this)})))},t.handleMouseEnterArrow=function(){return Vt((0,Zt.Z)(t),void 0,void 0,regeneratorRuntime.mark((function e(){var t=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.miniListExtension){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,this.initMiniList();case 4:this.miniListExtension=e.sent,setTimeout((function(){var e,n;null===(n=null===(e=t.miniListExtension)||void 0===e?void 0:e.showMiniList)||void 0===n||n.call(e)}),1e3);case 6:case"end":return e.stop()}}),e,this)})))},t}(0,s.Z)(t,e);var n=t.prototype;return n.render=function(){return x().createElement(x().Fragment,null,x().createElement("div",null,x().createElement("div",{id:"pc-header-mini-list"},x().createElement("div",{className:"pc-header-home",onMouseEnter:this.handleMouseEnterHomeIcon}),x().createElement("div",{className:"pc-header-home-arrow",onMouseEnter:this.handleMouseEnterArrow}))))},n.getMiniListExtension=function(){return Vt(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ae.default.getExtension(Bt.h.name);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))},t}(A.Component);zt([(0,S.tB)(c.M),Ut("design:type","function"===typeof(Nt="undefined"!==typeof c.M&&c.M)?Nt:Object)],Wt.prototype,"titlebarService",void 0),zt([(0,Oe.n)(),Ut("design:type",Function),Ut("design:paramtypes",[]),Ut("design:returntype",Promise)],Wt.prototype,"getMiniListExtension",null);var Gt={PERSON:O.ZP.t("ui|titlebar.personal"),CORP:O.ZP.t("企业"),OUTTER:O.ZP.t("外部")},Yt=function(e){function t(t){var n;return(n=e.call(this,t)||this).state={},n}return(0,s.Z)(t,e),t.prototype.render=function(){return A.createElement("div",{className:"titlebar_title-badge"},Gt.PERSON)},t}(A.Component),Kt=n("../spread-sheet/src/core/ark-extensions/extensions/subscription-notification.ts"),Xt=(n("../node_modules/core-js/modules/web.dom-collections.for-each.js"),n("../node_modules/core-js/modules/es.object.keys.js"),n("../node_modules/core-js/modules/es.array.from.js"),n("../node_modules/core-js/modules/es.string.iterator.js"),n("../node_modules/core-js/modules/es.symbol.js"),n("../node_modules/core-js/modules/es.symbol.description.js"),n("../node_modules/core-js/modules/es.symbol.iterator.js"),n("../node_modules/core-js/modules/es.array.iterator.js"),n("../node_modules/core-js/modules/web.dom-collections.iterator.js"),n("../packages/model/src/dimension/index.ts")),qt=n("../packages/model/src/range/index.ts"),Qt=n("../packages/model/src/workbookRange/index.ts"),$t=n("../packages/mutation/src/index.ts"),Jt=n("../packages/mutation/src/MutationId.ts"),en=(n("../node_modules/core-js/modules/es.array.map.js"),function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function s(e){try{c(r.next(e))}catch(t){i(t)}}function a(e){try{c(r.throw(e))}catch(t){i(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))});function tn(e){var t=[];return Object.keys(e).map((function(n){var r=e[n];r instanceof Array?r.forEach((function(e){t.push(encodeURIComponent(n)+"="+encodeURIComponent(e))})):void 0!==r&&t.push(encodeURIComponent(n)+"="+encodeURIComponent(r))})),t.join("&")}var nn=function(){function e(e){this.docId=e}var t=e.prototype;return t.requestEditNotify=function(e){var t,n;return en(this,void 0,void 0,regeneratorRuntime.mark((function r(){var o,i,s;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return o=tn({to_all:e.toAll,to_vids:e.toVids,docid:this.docId,note:e.note,begin_rev:e.beginRev,end_rev:e.endRev,notify_rangeid:e.notify_rangeid}),r.prev=1,r.next=4,P().post("/wedoc/editnotify",o);case 4:if(i=r.sent,s=i.data,0===(null===(t=s.head)||void 0===t?void 0:t.ret)){r.next=8;break}throw new Error("request /wedoc/editnotify fail, params: "+o+", return: "+(null===(n=s.head)||void 0===n?void 0:n.msg));case 8:r.next=14;break;case 10:return r.prev=10,r.t0=r.catch(1),console.error(r.t0),r.abrupt("return",!1);case 14:return r.abrupt("return",!0);case 15:case"end":return r.stop()}}),r,this,[[1,10]])})))},t.requestNotifySelf=function(){var e,t;return en(this,void 0,void 0,regeneratorRuntime.mark((function n(){var r,o,i;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r=tn({docId:this.docId,func:2}),n.prev=1,n.next=4,P().post("/wedoc/editnotify",r);case 4:if(o=n.sent,i=o.data,0===(null===(e=i.head)||void 0===e?void 0:e.ret)){n.next=8;break}throw new Error("request /wedoc/editnotify fail, params: "+r+", return: "+(null===(t=i.head)||void 0===t?void 0:t.msg));case 8:n.next=14;break;case 10:return n.prev=10,n.t0=n.catch(1),console.error(n.t0),n.abrupt("return",!1);case 14:return n.abrupt("return",!0);case 15:case"end":return n.stop()}}),n,this,[[1,10]])})))},e}();function rn(){var e=navigator.userAgent;return"string"===typeof e?e.slice(0,1024).replace(/,/g,"_"):""}function on(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){if(e){if("string"===typeof e)return sn(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?sn(e,t):void 0}}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0;return function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function sn(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var an,cn,dn,ln,un,_n=function(){function e(e){this.lastReportTime=0,this.openTimestamp=+new Date,this.onceCheckFlag=!1,this.app=e.app,this.showEditNotify=e.showEditNotify,this.registEvent()}var t=e.prototype;return t.getEditInfo=function(){var e=this.getLatestEditRange();if(e){var t=this.app,n=t.spreadsheet,r=t.requestApi,o=n.workbookRangeManager.hasContainNotifyRange(e);if(o)return{begin_rev:0,end_rev:0,editMsg:"",notify_rangeid:o};var i=n.workbookRangeManager.generateWorkbookRangeId();return r.addNotifyRange(i,e),{begin_rev:0,end_rev:0,editMsg:"",notify_rangeid:i}}return{begin_rev:0,end_rev:0,editMsg:"",notify_rangeid:""}},t.getLatestEditRange=function(){var e=this.app.undoredoStack.undoStack;if(!e.length)return null;for(var t,n=on(e);!(t=n()).done;){var r=t.value;if(!r.isLocal||!r.redoMutations.length)break;for(var o,i=on(r.redoMutations);!(o=i()).done;){var s=o.value;if(s instanceof $t.mm){var a=this.analyzeMutation(s);if(a)return a}}}return null},t.analyzeMutation=function(e){switch(e.id){case Jt.ZP.SET_RANGE_MUTATION:case Jt.ZP.SET_CELL_PROPERTIES_MUTATION:return e.gridRange;case Jt.ZP.INSERT_DIMENSION_MUTATION:return this.toDimensionRange(e);default:return null}},t.toDimensionRange=function(e){var t=e.sheetId,n=e.index,r=e.amount;return e.type===Xt.DIMENSION_TYPE.ROWS?new qt.GridRange(t,n,n+r-1,qt.DEFAULT_DIMENSION_INDEX,qt.DEFAULT_DIMENSION_INDEX):new qt.GridRange(t,qt.DEFAULT_DIMENSION_INDEX,qt.DEFAULT_DIMENSION_INDEX,n,n+r-1)},t.registEvent=function(){var e=this;this.app.messageCenterAdapter.sendMessageCenterAdapter.onUserChangeNew((function(t){var n,r,o=t.userChange,i=o.isWorkbook,s=o.mutations;if(i){var a=null===(n=null===s||void 0===s?void 0:s[0])||void 0===n?void 0:n[0];if(a&&a.id===Jt.ZP.DEFINE_WORKBOOK_RANGE_MUTATION&&a.workbookRangeType===Qt.WORKBOOK_RANGE_TYPE.NOTIFY_RANGE)return}if(e.getLatestEditRange()&&(null===(r=e.showEditNotify)||void 0===r||r.call(e),e.reportUserChange(),!e.onceCheckFlag)){e.onceCheckFlag=!0;var c=+new Date;e.checkNeedNotifySelf(c)&&e.notifySelf(c)}}))},t.reportUserChange=function(){var e=Date.now();e-this.lastReportTime<72e5||(this.lastReportTime=e,oe.ZP.kvrOss({itemname:"timeline_user_edit",Channel1:"sheet",Channel2:rt().isWxWork?rt().isMobile?"m":"client":rt().isWeChat?"wechat":"browser",Extra1:rn(),biz:"personal"}))},t.notifySelf=function(e){var t=this.app.spreadsheet.getSpreadsheetId();this.requestNotifySelf(t),this.saveNotifySelfFlag(t,e)},t.checkNeedNotifySelf=function(e){var t=36e5;if(void 0===this.latestNotifySelfTimestamp){var n=this.app.spreadsheet.getSpreadsheetId();this.latestNotifySelfTimestamp=this.getLatestNotifySelfTimestamp(n)}return e-this.latestNotifySelfTimestamp>t&&e-this.openTimestamp<t},t.getLatestNotifySelfTimestamp=function(e){try{var t=localStorage.getItem("edit_notify_self");return t&&(JSON.parse(t)||{})[e]||0}catch(n){return 0}},t.requestNotifySelf=function(e){new nn(e).requestNotifySelf()},t.saveNotifySelfFlag=function(e,t){try{var n=localStorage.getItem("edit_notify_self"),r={};n&&(r=JSON.parse(n)||{}),Object.keys(r).forEach((function(e){t-(r[e]||0)>36e5&&delete r[e]})),r[e]=t,localStorage.setItem("edit_notify_self",JSON.stringify(r))}catch(o){console.error("保存标记报错",o)}},e}(),pn=_n,fn=n("../packages/model/src/cell/index.ts"),hn=n("../packages/model/src/range/hexRangeUtils.ts"),mn=n("../spread-sheet/src/core/view/level-2/discussion-ent/utils.ts"),vn=function(){function e(){this.isMoreThanOne=!1}var t=e.prototype;return t.analyzeMutation=function(e){var t=this;switch(e.id){case Jt.ZP.SET_RANGE_MUTATION:return e.cellDataDeltaAtPositions.some((function(e){return t.fromDelta({startRowIndex:e.rowIndex,endRowIndex:e.rowIndex,startColIndex:e.colIndex,endColIndex:e.colIndex},e.cellDataDelta)}));case Jt.ZP.SET_CELL_PROPERTIES_MUTATION:return this.fromDelta(e.gridRange,e.cellDataDelta);case Jt.ZP.DELETE_DIMENSION_MUTATION:return this.fromDimension(e.index,e.amount,e.type)}return!1},t.update=function(e){-1===this.from&&(this.from=e),this.to=e},t.clear=function(){this.editType=null,this.isMoreThanOne=!1,this.from=-1},t.generateMessage=function(){if(!this.editType)return{begin_rev:"",end_rev:"",editMsg:""};if((0,mn.e)())return{begin_rev:""+this.from,end_rev:""+this.to,editMsg:O.ZP.t("文档内有有更新，请各位关注。")};var e=[];return"edit"===this.editType?(e.push(O.ZP.t("修改了「{{value}}」",{value:this.editInfo})),this.isMoreThanOne&&e.push(O.ZP.t("等多处"))):"deleteCell"===this.editType?(e.push(O.ZP.t("删除了「{{value}}」",{value:this.editInfo})),this.isMoreThanOne&&e.push(O.ZP.t("等多处"))):(e.push(O.ZP.t("删除了")),this.editInfo[0]===this.editInfo[1]?e.push(O.ZP.t("第{{value}}列",{value:this.editInfo[0]})):e.push(O.ZP.t("{{value0}}到{{value1}}列",{value0:this.editInfo[0],value1:this.editInfo[1]}))),{begin_rev:""+this.from,end_rev:""+this.to,editMsg:e.join("")}},t.fromDelta=function(e,t){var n;if(this.isMoreThanOne)return!0;var r=!1;if((t.clearSlots&1<<fn.CELL_DATA_SLOT.SLOT_EFFIECTIVE_VALUE)>0&&(r=this.saveContent(""+(0,hn.colIndex2ColChar)(e.startColIndex)+(e.startRowIndex+1),"deleteCell")),(t.setSlots&1<<fn.CELL_DATA_SLOT.SLOT_EFFIECTIVE_VALUE)>0){var o=null===(n=t.delta.effectiveValue)||void 0===n?void 0:n.value;"number"===typeof o&&(r=this.saveContent(""+o,"edit")),"string"===typeof o&&o&&(r=this.saveContent(""+(0,hn.colIndex2ColChar)(e.startColIndex)+(e.startRowIndex+1),"edit"))}return!this.editType||e.startColIndex===e.endColIndex&&e.startRowIndex===e.endRowIndex||(this.isMoreThanOne=!0,r=!0),r},t.fromDimension=function(e,t,n){if(this.isMoreThanOne)return!0;var r=(0,hn.colIndex2ColChar)(e),o=(0,hn.colIndex2ColChar)(e+t),i=n===Xt.DIMENSION_TYPE.ROWS?"deleteRow":"deleteCol";return this.saveContent([r,o],i)},t.saveContent=function(e,t){return this.editType?(this.isMoreThanOne=!0,this.generateMessage(),!0):(this.editType=t,this.editInfo=e,this.generateMessage(),!1)},e}(),yn=n("../spread-sheet/src/external/editNotify/VisitedVersionStore.ts"),gn=function(){function e(e){var t=this;this.clear=function(){t.editUserchangeHelper.clear()},this.handleAcceptCommit=function(e){var n,r=e.userChange;t.store.setVersion(e.newVersion),t.editUserchangeHelper.update(e.newVersion),r.mutations.some((function(e){return e.some((function(e){return t.editUserchangeHelper.analyzeMutation(e)}))})),t.editUserchangeHelper.editType&&(null===(n=t.showEditNotify)||void 0===n||n.call(t))},this.handleAfterApplyNewChanges=function(e){t.store.setVersion(e.changeInfo.newVersion)},this.spreadsheet=e.spreadsheet,this.messageCenter=e.messageCenter,this.showEditNotify=e.showEditNotify,this.store=new yn.g(this.spreadsheet.getSpreadsheetId()),this.editUserchangeHelper=new vn,this.listenEditEvent()}var t=e.prototype;return t.getEditInfo=function(){return this.editUserchangeHelper.generateMessage()},t.listenEditEvent=function(){this.messageCenter.sendMessageCenterAdapter.onShutDown(this.clear),this.messageCenter.sendMessageCenterAdapter.onAcceptCommit(this.handleAcceptCommit),this.messageCenter.sendMessageCenterAdapter.onAfterApplyNewChanges(this.handleAfterApplyNewChanges)},e}(),En=n("../packages/model/src/spreadsheet/index.ts"),wn=n("../spread-sheet/src/core/network/message-center/adapter/MessageCenterAdapter.interface.ts"),bn=n("../packages/common-utils/src/time/timer.ts"),Tn=n("../spread-sheet/src/external/report/index.ts"),Rn=function(e,t,n,r){var o,i=arguments.length,s=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},In=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},Cn=function(e,t){return function(n,r){t(n,r,e)}},An=function(){function e(e,t,n,r,o,i){var s=this;void 0===o&&(o=new j.Q5),void 0===i&&(i=o.event),this.app=e,this.spreadsheet=t,this.messageCenterAdapter=n,this.saveTipsFeature=r,this._onEnableNotify=o,this.onEnableNotify=i,this.getEditedRecord=function(){return s.editNotifyCenter.getEditInfo()},this.sendNoticeSuccess=function(){(0,mn.e)()||(s.editNotifyCenter.clear(),Tn.default.kvrOss({itemname:"timeline_click_send_notif",biz:"personal",Channel1:"sheet",Channel2:rt().isWxWork?"pc":"browser"}))},(0,mn.e)()?this.editNotifyCenter=new pn({app:this.app,showEditNotify:this.handleHistroyChange.bind(this)}):this.editNotifyCenter=new gn({spreadsheet:this.spreadsheet,messageCenter:this.messageCenterAdapter,showEditNotify:this.handleHistroyChange})}return e.prototype.handleHistroyChange=function(){var e=this;bn.Z.wait(10).run((function(){e.saveTipsFeature.showSaveStateTips()}))},e}();An=Rn([(0,D.L)(),Cn(0,ie.m),Cn(1,En.ISpreadsheet),Cn(2,wn.Z),In("design:paramtypes",["function"===typeof(an="undefined"!==typeof ie.m&&ie.m)?an:Object,"function"===typeof(cn="undefined"!==typeof En.ISpreadsheet&&En.ISpreadsheet)?cn:Object,"function"===typeof(dn="undefined"!==typeof wn.Z&&wn.Z)?dn:Object,"function"===typeof(ln="undefined"!==typeof pe&&pe)?ln:Object,Object,"function"===typeof(un="undefined"!==typeof j.ju&&j.ju)?un:Object])],An);var xn,On=n("../spread-sheet/src/core/view/layout/interface/pc-view.ts"),Nn=function(e,t,n,r){var o,i=arguments.length,s=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},Sn=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},kn=function(e,t){return function(n,r){t(n,r,e)}},Pn=function(e){var t=this;this.view=e,this.onAddCollab=function(e){var n;null===(n=t.view.canvas.collabCenter)||void 0===n||n.onAddCollab(e)},this.getCollabs=function(){var e,n;return null===(n=null===(e=t.view.canvas)||void 0===e?void 0:e.collabCenter)||void 0===n?void 0:n.getCollabs()},this.getCollabsCount=function(){var e,n;return null===(n=null===(e=t.view.canvas)||void 0===e?void 0:e.collabCenter)||void 0===n?void 0:n.getCollabCount()},this.isCollabMoreThanThreshold=function(){var e,n;return null===(n=null===(e=t.view.canvas)||void 0===e?void 0:e.collabCenter)||void 0===n?void 0:n.isCollabMoreThanThreshold()},this.onCollabUpdate=function(e){le.Z.event.collabEvent.listen("updateCollab",(function(){e(t.isCollabMoreThanThreshold())}))}};Pn=Nn([(0,D.L)(),kn(0,On.w),Sn("design:paramtypes",["function"===typeof(xn="undefined"!==typeof On.w&&On.w)?xn:Object])],Pn);var Dn=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function s(e){try{c(r.next(e))}catch(t){i(t)}}function a(e){try{c(r.throw(e))}catch(t){i(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))},Ln=function(e){function t(t){var n;return(n=e.call(this,t)||this).networkChange=function(e){n.online!==("online"===e)&&(n.online="online"===e,n.handleVisible())},n.setEdit=function(){n.setState({isEdit:!0})},n.containerRef=(0,A.createRef)(),n.state={isEdit:!1},n.online=navigator.onLine,n.collabExceed=!1,n}(0,s.Z)(t,e);var n=t.prototype;return n.componentDidMount=function(){var e;return Dn(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n,r,o=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return K.network.changeEnd(this.networkChange),(n=S.Am.get(An)).onEnableNotify(this.setEdit.bind(this)),r=S.Am.get(Pn),t.next=6,Ae.default.getExtension(Kt.a.name);case 6:t.sent.show({container:null===(e=this.containerRef)||void 0===e?void 0:e.current,getEditedRecord:n.getEditedRecord,timelineGray:!0,onAddCollab:r.onAddCollab,getCollabs:r.getCollabs,listenSubscribe:function(){},sendNoticeSuccess:function(){o.setState({isEdit:!1}),n.sendNoticeSuccess()}}),this.hanldeCollabsUpdate(r.isCollabMoreThanThreshold()),r.onCollabUpdate(this.hanldeCollabsUpdate.bind(this));case 10:case"end":return t.stop()}}),t,this)})))},n.componentDidUpdate=function(e,t){return Dn(this,void 0,void 0,regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.isEdit===this.state.isEdit){e.next=5;break}return e.next=3,Ae.default.getExtension(Kt.a.name);case 3:null===(n=e.sent)||void 0===n||n.modifyHasEdit(this.state.isEdit);case 5:case"end":return e.stop()}}),e,this)})))},n.componentWillUnmount=function(){K.network.remove(this.networkChange)},n.render=function(){return x().createElement("div",{id:"pc-header-notification",ref:this.containerRef})},n.hanldeCollabsUpdate=function(e){this.collabExceed!==e&&(this.collabExceed=e,this.handleVisible())},n.handleVisible=function(){var e,t=this.online&&!this.collabExceed;(null===(e=this.containerRef)||void 0===e?void 0:e.current)&&(this.containerRef.current.style.display=t?"block":"none")},t}(x().Component),Mn=n("../spread-sheet/src/core/app/permissions/index.ts"),Fn=function(e,t,n,r){var o,i=arguments.length,s=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},jn=function(){var e=this;this._onDisableMaskChange=new j.Q5,this.onDisableMaskChange=this._onDisableMaskChange.event,this.setDisableMask=function(t){e.showDisableMask=t,e._onDisableMaskChange.fire(t)},this.isDisableMaskShow=function(){return e.showDisableMask}};jn=Fn([(0,D.L)({adapters:[Z.L,B.dH]})],jn);var Hn,Zn,Bn,zn,Un=function(e,t,n,r){var o,i=arguments.length,s=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},Vn=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},Wn=function(e,t){return function(n,r){t(n,r,e)}};!function(e){e.ADD_MEMBER="ADD_MEMBER",e.ALL_MEMBER="ALL_MEMBER",e.DISCUSSION="DISCUSSION",e.FILE="FILE",e.EDIT="EDIT",e.RELATE="RELATE",e.RELATE_FORM="RELATE_FORM"}(zn||(zn={}));var Gn=function(){function e(e,t,n){var r=this;this.app=e,this.permissions=t,this.maskFeature=n,this._onActiveMenuChange=new j.Q5,this.onActiveMenuChange=this._onActiveMenuChange.event,this.getApp=function(){return r.app},this.getPermissions=function(){return r.permissions},this.updateActiveMenu=function(e){r.activeMenu=e,r._onActiveMenuChange.fire(e)},this.getActiveMenu=function(){return r.activeMenu},this.mouseEnter=function(e){r.isAutoExpandDropdown&&r.updateActiveMenu(e)},this.registerListener=function(){r.app.event.default.listen("pc-header-enable",r.disableAllDropdown)},this.unregisterListener=function(){r.app.event.default.remove("pc-header-enable",r.disableAllDropdown)},this.disableAllDropdown=function(e){r.maskFeature.setDisableMask(e)},this.registerListener()}return e.prototype.toggleAutoExpandDropdownStatus=function(e){this.isAutoExpandDropdown=e},e}();Gn=Un([(0,D.L)({adapters:[Z.L,B.dH]}),Wn(0,ie.m),Wn(1,Mn.H),Vn("design:paramtypes",["function"===typeof(Hn="undefined"!==typeof ie.m&&ie.m)?Hn:Object,"function"===typeof(Zn="undefined"!==typeof Mn.H&&Mn.H)?Zn:Object,"function"===typeof(Bn="undefined"!==typeof jn&&jn)?Bn:Object])],Gn);var Yn,Kn,Xn=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function s(e){try{c(r.next(e))}catch(t){i(t)}}function a(e){try{c(r.throw(e))}catch(t){i(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))},qn=function(e){function t(t){var n;return(n=e.call(this,t)||this).handleSheetStatusChange=function(){n.forceUpdate()},n.initInjectService=function(){var e=S.Am.get(Gn);n.sheetStatus=e.getPermissions().sheetStatus,n.menuBarFeature=e},n.handleClick=function(){n.menuBarFeature.getApp().view.canvas.commentCenter.toggleCommentPanel(!0)},n.initInjectService(),n.state={activeMenu:void 0},n.discussMenuBtn=x().createRef(),n}(0,s.Z)(t,e);var n=t.prototype;return n.componentDidMount=function(){return Xn(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.sheetStatus.change(this.handleSheetStatusChange),this.onActiveMenuChange=this.menuBarFeature.onActiveMenuChange((function(e){t.setState({activeMenu:e})}));case 2:case"end":return e.stop()}}),e,this)})))},n.componentWillUnmount=function(){this.sheetStatus.offChange(this.handleSheetStatusChange),this.onActiveMenuChange.dispose()},n.render=function(){return x().createElement("div",{className:"menubar-component"},this.getDiscussMenuBtn())},n.getDiscussMenuBtn=function(){var e=this.state.activeMenu===zn.DISCUSSION,t=dt()({"titlebar-btn-container":!0,"titlebar-active":e}),n=dt()({"titlebar-icon":!0,"titlebar-icon-discussion":at.xc});return x().createElement("div",{className:t,onClick:this.handleClick},x().createElement(N.default,{disabled:e,title:O.ZP.t("文档动态"),trigger:"hover"},x().createElement("div",{className:n})))},t}(x().Component),Qn=n("../node_modules/@tencent/workbench/lib/esm/components/menu/menu.js"),$n=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function s(e){try{c(r.next(e))}catch(t){i(t)}}function a(e){try{c(r.throw(e))}catch(t){i(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))},Jn=function(e){function t(t){var n;return(n=e.call(this,t)||this).handleSheetStatusChange=function(){n.forceUpdate()},n.initInjectService=function(){var e=S.Am.get(Gn);n.sheetStatus=e.getPermissions().sheetStatus,n.menuBarFeature=e},n.catchClick=function(e){e.stopPropagation(),e.nativeEvent.stopImmediatePropagation()},n.getFileBtn=function(){var e=n.state.activeMenu===zn.FILE,t=dt()({"titlebar-btn-container":!0}),r=dt()({"titlebar-icon":!0,"titlebar-icon-more":!at.xc,"titlebar-icon-wework-more":at.xc});return x().createElement("div",{className:t,ref:n.fileBtn},x().createElement(Qn.l,{align:"right",name:"file",animated:!1,show:e,onClick:function(){n.menuBarFeature.toggleAutoExpandDropdownStatus(!0),n.menuBarFeature.updateActiveMenu(zn.FILE)},onMouseEnter:function(){n.menuBarFeature.mouseEnter(zn.FILE)},onDropdownClose:function(){n.menuBarFeature.toggleAutoExpandDropdownStatus(!1),n.menuBarFeature.updateActiveMenu(void 0)}},x().createElement(N.default,{disabled:e,title:O.ZP.t("文档操作"),trigger:"hover"},x().createElement("div",{className:r}))))},n.initInjectService(),n.state={activeMenu:void 0},n.fileBtn=x().createRef(),n}(0,s.Z)(t,e);var n=t.prototype;return n.componentDidMount=function(){return $n(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.sheetStatus.change(this.handleSheetStatusChange),this.onActiveMenuChange=this.menuBarFeature.onActiveMenuChange((function(e){t.setState({activeMenu:e})}));case 2:case"end":return e.stop()}}),e,this)})))},n.componentWillUnmount=function(){this.sheetStatus.offChange(this.handleSheetStatusChange),this.onActiveMenuChange.dispose()},n.render=function(){return x().createElement("div",{className:"menubar-component"},this.getFileBtn())},t}(x().Component),er=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function s(e){try{c(r.next(e))}catch(t){i(t)}}function a(e){try{c(r.throw(e))}catch(t){i(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))},tr=function(e){function t(t){var n;return(n=e.call(this,t)||this).handleSheetStatusChange=function(){n.forceUpdate()},n.initInjectService=function(){var e=S.Am.get(Gn);n.sheetStatus=e.getPermissions().sheetStatus,n.menuBarFeature=e},n.catchClick=function(e){e.stopPropagation(),e.nativeEvent.stopImmediatePropagation()},n.getMoreBtn=function(){if(!n.isShowEditBtn())return null;var e=n.state.activeMenu===zn.EDIT,t=dt()({"titlebar-btn-container":!0}),r=dt()({"titlebar-icon":!0,"titlebar-icon-edit":!at.xc,"titlebar-icon-wework-edit":at.xc});return x().createElement("div",{className:t,ref:n.moreBtn},x().createElement(Qn.l,{align:"right",name:v.z_.EDIT,style:{margin:"0 8px"},animated:!1,show:e,onClick:function(){n.menuBarFeature.toggleAutoExpandDropdownStatus(!0),n.menuBarFeature.updateActiveMenu(zn.EDIT)},onMouseEnter:function(){n.menuBarFeature.mouseEnter(zn.EDIT)},onDropdownClose:function(){n.menuBarFeature.toggleAutoExpandDropdownStatus(!1),n.menuBarFeature.updateActiveMenu(void 0)}},x().createElement(N.default,{disabled:e,title:O.ZP.t("编辑功能"),trigger:"hover"},x().createElement("div",{className:r}))))},n.isShowEditBtn=function(){return n.sheetStatus.canEdit||n.sheetStatus.tempStatus.status.isHistory},n.initInjectService(),n.state={activeMenu:void 0},n.moreBtn=x().createRef(),n}(0,s.Z)(t,e);var n=t.prototype;return n.componentDidMount=function(){return er(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.sheetStatus.change(this.handleSheetStatusChange),this.onActiveMenuChange=this.menuBarFeature.onActiveMenuChange((function(e){t.setState({activeMenu:e})}));case 2:case"end":return e.stop()}}),e,this)})))},n.componentWillUnmount=function(){this.sheetStatus.offChange(this.handleSheetStatusChange),this.onActiveMenuChange.dispose()},n.render=function(){return x().createElement("div",{className:"menubar-component"},this.getMoreBtn())},t}(x().Component),nr=n("../node_modules/@tencent/workbench/lib/esm/services/drawer/drawer-service.js"),rr=n("../node_modules/@tencent/workbench/lib/esm/decorators/class/service.js"),or=n("../spread-sheet/src/core/workbench/common/base-drawer.tsx"),ir=n("../node_modules/@tencent/dui/lib/components/Dropdown/index.js"),sr=n("../node_modules/@tencent/dui/lib/components/Menu/index.js"),ar=n("../node_modules/@tencent/wedocs-icons/esm/components/cross-12.js"),cr=n("../node_modules/@tencent/wedocs-icons/esm/components/loading-spinner.js"),dr=n("../node_modules/@tencent/dui/lib/components/Notetip/index.js"),lr=n("../node_modules/@tencent/wedocs-icons/esm/components/tdoc-desktop-sheet-chain.js"),ur=n("../node_modules/@tencent/wedocs-icons/esm/components/tdoc-desktop-share.js"),_r=n("../node_modules/@tencent/wedocs-icons/esm/components/tdoc-desktop-ellipse.js");!function(e){e[e.RESET=0]="RESET",e[e.UPDATE=1]="UPDATE"}(Yn||(Yn={})),function(e){e[e.NEW_FORM=0]="NEW_FORM",e[e.CONVERT_FORM=1]="CONVERT_FORM",e[e.GET_FORMS_USER=2]="GET_FORMS_USER",e[e.CHECK_RESULT=3]="CHECK_RESULT",e[e.UNLINK_FORM=4]="UNLINK_FORM",e[e.PANEL_HIDE=5]="PANEL_HIDE",e[e.WXWORK_SEND=6]="WXWORK_SEND",e[e.COPY_LINK=7]="COPY_LINK",e[e.QR_CODE=8]="QR_CODE",e[e.EXPORT_FORM=9]="EXPORT_FORM"}(Kn||(Kn={})),n("../spread-sheet/src/core/feature/relateFormEnt/index.tsx");var pr,fr,hr=n("../spread-sheet/src/base/event/event.ts"),mr=function(e){function t(t){var n;return(n=e.call(this,t)||this).generateBlock=function(e,t,r,o){return x().createElement("div",{className:"info-block",onClick:function(){n.openUrl(o)}},x().createElement("div",{className:"info-value",style:{color:r}},t),x().createElement("div",{className:"info-name"},e))},n.lostSheetConfirm=function(){var e=n.props,t=e.callback,r=e.syncId;he.Modal.confirm({title:O.ZP.t("提示"),content:O.ZP.t("关联已失效，请尝试取消关联后再重新关联至此表格"),okText:O.ZP.t("取消关联"),cancelText:O.ZP.t("保留"),onOk:function(){t(Kn.UNLINK_FORM,{sheetId:r,formId:r})}})},n.handleChangeMenu=function(e){"share"===e&&n.setState({showShareMenu:!n.state.showShareMenu}),"operate"===e&&n.setState({showOperateMenu:!n.state.showOperateMenu})},n.handleExportForm=function(){var e=n.props,t=e.callback,r=e.formId,o=e.formDomainId+"$"+r;t(Kn.EXPORT_FORM,{formGlobalPadId:o})},n.state={showShareMenu:!1,showOperateMenu:!1},n.bindEvent(),n}(0,s.Z)(t,e);var r=t.prototype;return r.render=function(){var e,t=this,r=this.props,o=r.app,i=r.owner,s=r.title,a=r.fillNum,c=r.fillRes,d=r.unfill,l=r.isExpired,u=r.linkSheetId,_=r.syncLimit,p=o.sheetStatus.canEdit,f=(null===(e=null===n.g||void 0===n.g?void 0:n.g.tdocs)||void 0===e||e.forwardFormsToWXWork,u?o.spreadsheet.sheetManager.getSheetTitleBySheetId(u):null),h=this.state.showShareMenu?"card-setting-btn-active":"",m=this.state.showOperateMenu?"card-setting-btn-active":"",v="#1E6FFF",y="rgba(0, 0, 0, 0.35)",g=F.q.getConfig("userName")===i&&c>=_;return x().createElement("div",{className:"form-card-outer-container"},g&&x().createElement("div",{className:"form-card-export-container"},x().createElement(dr.Notetip,null,O.ZP.t("RELATE_FORM_EXPORT_TIP_PART_ONE",{count:_}),x().createElement("span",{className:"form-card-export-link",onClick:this.handleExportForm},O.ZP.t("RELATE_FORM_EXPORT_TIP_PART_TWO"),O.ZP.t("。")))),x().createElement("div",{className:"form-card-content-container"},x().createElement("div",{className:"card-setting"},x().createElement("div",{className:"card-setting-btn  card-setting-btn-enable",onClick:function(){t.handleSwitchSheet(u)}},x().createElement(N.Tooltip,{title:x().createElement("div",null,x().createElement("div",{className:"main-text"},O.ZP.t("查看关联工作表")),x().createElement("div",{className:"sub-text"},f||O.ZP.t("已失效"))),arrowClassName:"form-card-tooltip-arrow",containerClassName:"form-card-tooltip",placement:"top"},x().createElement(lr.Z,null))),x().createElement("div",{className:"card-setting-btn menu-share card-setting-btn-enable "+h},this.generateMenu(ur.Z,[{value:O.ZP.t("复制链接"),cbType:Kn.COPY_LINK,disable:!1},{value:O.ZP.t("获取二维码"),cbType:Kn.QR_CODE,disable:!1}],"share"),!1),x().createElement("div",{className:"card-setting-btn menu-operate card-setting-btn-enable "+m},this.generateMenu(_r.Z,[{value:O.ZP.t("打开收集表"),cbType:Kn.CHECK_RESULT,disable:!1},{value:O.ZP.t("取消关联"),cbType:Kn.UNLINK_FORM,disable:!p}],"operate"),!1)),x().createElement("div",{className:"card-title",onClick:function(){t.openUrl("count")}},x().createElement("div",{className:"card-title-text"},s),l?x().createElement("span",{className:"expired-tag"},O.ZP.t("已结束")):null),x().createElement("div",{className:"card-subtitle"},O.ZP.t("{{owner}} 创建",{owner:i})),x().createElement("div",{className:"fill-info"},this.generateBlock(O.ZP.t("填写人数"),a,l?y:v,"filled"),this.generateBlock(O.ZP.t("填写结果"),c,l?y:v,"detail"),d>0&&this.generateBlock(O.ZP.t("未填人数"),d,l?y:"#F27F4E","unfilled"))))},r.bindEvent=function(){hr.ZP.windowEvent.listen("mouseup",this.hideMenu.bind(this))},r.hideMenu=function(){this.setState({showOperateMenu:!1,showShareMenu:!1})},r.handleSwitchSheet=function(e){if(e){var t=this.props.app.spreadsheet.activeSheetId;if(t===e)(0,ht.showToast)(O.ZP.t("您已打开当前文档"),void 0,{toolToastCloseTime:2e3});else{var n=this.props.app.spreadsheet.sheetManager.getSheetBySheetId(e);(null===n||void 0===n?void 0:n.properties.hidden)?(0,ht.showToast)(O.ZP.t("无法跳转到隐藏的工作表"),void 0,{toolToastCloseTime:2e3}):hr.ZP.sheetsBar.trigger("switchSheet",e,t,1)}}else this.lostSheetConfirm()},r.openUrl=function(e){var t=this.props,n=t.syncId;(0,t.callback)(Kn.CHECK_RESULT,{sheetId:n,formId:n,activeArea:e})},r.generateMenu=function(e,t,n){var r=this,o=this.props,i=o.callback,s=o.syncId,a=x().createElement(sr.Menu,{style:{width:"160px"},itemStyle:{height:"18px"}},t.map((function(e){return x().createElement(sr.Menu.Item,{onClick:function(){i(e.cbType,{sheetId:s,formId:s})},disabled:e.disable},x().createElement("div",null,e.value))})));return x().createElement("div",{className:"menu-button"},x().createElement(ir.Dropdown,{dropContent:a,dropContentClassName:"form-settings-dropdown",animated:!1,disabled:!1,onVisibleChange:function(){r.handleChangeMenu(n)},alignment:"right"},x().createElement(e,null)))},t}(x().Component),vr=function(e){function t(){return e.apply(this,arguments)||this}return(0,s.Z)(t,e),t.prototype.render=function(){var e=this,t=this.props.forms;return A.createElement("div",{className:"form-list"},t.map((function(t){return A.createElement(A.Fragment,null,A.createElement(mr,Object.assign({},e.props,t)))})))},t}(A.Component),yr=n("../spread-sheet/src/core/feature/relateFormEnt/enterpriseStatus.ts"),gr=n("../spread-sheet/src/core/feature/relateForm/helper.ts"),Er=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function s(e){try{c(r.next(e))}catch(t){i(t)}}function a(e){try{c(r.throw(e))}catch(t){i(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))},wr=function(e){function t(t){var n;return(n=e.call(this,t)||this).state={showMenu:!1,formSwitch:!0},n}(0,s.Z)(t,e);var n=t.prototype;return n.render=function(){var e=this.props,t=e.app,n=e.callback,r=e.isExternalSheet,o=t.sheetStatus.canEdit,i=(this.state.formSwitch,o&&!(0,gr.A)()),s=A.createElement(sr.Menu,{style:{width:"180px"},itemStyle:{height:"18px"}},A.createElement(sr.Menu.Item,{onClick:function(){n(Kn.CONVERT_FORM)},disabled:r},O.ZP.t("从表头新建")),A.createElement(sr.Menu.Item,{onClick:function(){n(Kn.NEW_FORM)},disabled:!1},O.ZP.t("空白新建")));return A.createElement("div",{className:"empty-container"},A.createElement("div",{className:"content"},A.createElement("div",{className:"big-icon"},A.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"100",height:"100",viewBox:"0 0 100 100",fill:"none"},A.createElement("path",{d:"M64 76H89V96H64V76Z",fill:"#4892FE","fill-opacity":"0.3"}),A.createElement("path",{d:"M64 82.5C64 82.2239 64.2239 82 64.5 82H70V76.5C70 76.2239 70.2239 76 70.5 76C70.7761 76 71 76.2239 71 76.5V82H84.5C84.7761 82 85 82.2239 85 82.5C85 82.7761 84.7761 83 84.5 83H71V91.5C71 91.7761 70.7761 92 70.5 92C70.2239 92 70 91.7761 70 91.5V83H64.5C64.2239 83 64 82.7761 64 82.5Z",fill:"#4892FE"}),A.createElement("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M62.109 74.546C62 74.7599 62 75.0399 62 75.6V92.4C62 92.9601 62 93.2401 62.109 93.454C62.2049 93.6422 62.3578 93.7951 62.546 93.891C62.7599 94 63.0399 94 63.6 94H85.4C85.9601 94 86.2401 94 86.454 93.891C86.6422 93.7951 86.7951 93.6422 86.891 93.454C87 93.2401 87 92.9601 87 92.4V75.6C87 75.0399 87 74.7599 86.891 74.546C86.7951 74.3578 86.6422 74.2049 86.454 74.109C86.2401 74 85.9601 74 85.4 74H63.6C63.0399 74 62.7599 74 62.546 74.109C62.3578 74.2049 62.2049 74.3578 62.109 74.546ZM85.4 75H63.6C63.3035 75 63.1412 75.0008 63.0246 75.0103L63.0114 75.0115L63.0103 75.0246C63.0008 75.1412 63 75.3035 63 75.6V92.4C63 92.6965 63.0008 92.8588 63.0103 92.9754L63.0115 92.9886L63.0246 92.9897C63.1412 92.9992 63.3035 93 63.6 93H85.4C85.6965 93 85.8588 92.9992 85.9754 92.9897L85.9886 92.9885L85.9897 92.9754C85.9992 92.8588 86 92.6965 86 92.4V75.6C86 75.3035 85.9992 75.1412 85.9897 75.0246L85.9885 75.0114L85.9754 75.0103C85.8588 75.0008 85.6965 75 85.4 75Z",fill:"#4892FE"}),A.createElement("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M80.9102 35C80.9688 35.1288 81 35.2699 81 35.4142V72H80V36H56C55.4477 36 55 35.5523 55 35V11H21C20.4477 11 20 11.4477 20 12V88C20 88.5523 20.4477 89 21 89H60V90H21C19.8954 90 19 89.1046 19 88V12C19 10.8954 19.8954 10 21 10H55.5858C55.7301 10 55.8712 10.0312 56 10.0898C56.108 10.139 56.2074 10.2074 56.2929 10.2929L80.7071 34.7071C80.7926 34.7926 80.861 34.892 80.9102 35ZM56 11.4142L79.5858 35H56V11.4142ZM65.0805 45.4749C65.2942 45.6498 65.3257 45.9648 65.1508 46.1785L47.4674 67.7916C47.251 68.056 46.9358 68.2204 46.5951 68.2464C46.2543 68.2724 45.9178 68.1577 45.6638 67.9291L36.0354 59.2636C35.8302 59.0789 35.8135 58.7627 35.9983 58.5575L37.0017 57.4425C37.1864 57.2373 37.5026 57.2206 37.7078 57.4054L45.9727 64.8437C46.1848 65.0347 46.5134 65.0096 46.6942 64.7887L63.2159 44.5954C63.3908 44.3817 63.7058 44.3502 63.9195 44.5251L65.0805 45.4749Z",fill:"#4892FE"}))),A.createElement("div",{className:"main-text"},O.ZP.t("还没有关联的收集表")),A.createElement("div",{className:"sub-text"},O.ZP.t("将多个收集表关联到这个表格"),A.createElement("br",null),O.ZP.t("统一查看和管理统计结果")),i&&A.createElement("div",{className:"button-group"},A.createElement("div",{className:"button-link"},A.createElement("button",{id:"button-link-owner-form",className:o?"desktop-cta-button type-primary size-m":"desktop-cta-button type-disable size-m",onClick:function(){o&&n(Kn.GET_FORMS_USER)}},O.ZP.t("关联已创建收集表"))),A.createElement("div",{className:"new-form"},A.createElement(ir.Dropdown,{dropContent:s,dropContentClassName:"form-new-form-dropdown",animated:!1,disabled:!o,alignment:"right"},A.createElement("button",{id:"button-new-form",className:o?"desktop-cta-button type-gray size-m":"desktop-cta-button type-disable size-m"},O.ZP.t("新建收集表")))))))},n.fetchSwitch=function(){return Er(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,yr.JY.fetch();case 2:t=e.sent,n=t.relateform,this.setState({formSwitch:n});case 5:case"end":return e.stop()}}),e,this)})))},t}(A.Component),br=n("../node_modules/lodash/debounce.js"),Tr=n.n(br),Rr=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function s(e){try{c(r.next(e))}catch(t){i(t)}}function a(e){try{c(r.throw(e))}catch(t){i(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))},Ir=function(e){function t(t){var n;return(n=e.call(this,t)||this).getFormInfos=Tr()((function(){n.changeLoadingStatus(!1),n.app.feature.relateForm.handle("get_form_details","",(function(e){e instanceof Array?(n.setState({forms:e.map((function(e){var t,n,r,o;return{owner:e.creatorNickName||"",title:e.title||"",fillNum:e.fillUserCount||0,fillRes:e.fillAnswerCount||0,unfill:e.unFillUserCount||0,isExpired:e.isClosed,formId:(null===(t=e.docId)||void 0===t?void 0:t.pad_id)||"",formDomainId:(null===(n=e.docId)||void 0===n?void 0:n.domain_id)||3e8,linkSheetId:(null===(r=e.relatedSheet)||void 0===r?void 0:r.subId)||"",syncId:(null===(o=e.relatedSheet)||void 0===o?void 0:o.subId)||"",syncLimit:e.syncLimit}}))}),n.changeLoadingStatus(!0)):n.changeLoadingStatus(!0)}))}),1e3),n.changeLoadingStatus=function(e){n.setState({isLoaded:e})},n.getBtnGroup=function(){var e=n.props.callback,t=n.state,r=t.forms,o=t.isExternalSheet,i=n.props.app.sheetStatus.canEdit;if(!(!i||r.length<1||(0,gr.A)())){n.state.formSwitch;var s=A.createElement(sr.default,null,A.createElement(sr.default.Item,{onClick:function(){e(Kn.CONVERT_FORM)},disabled:o},O.ZP.t("从表头新建")),A.createElement(sr.default.Item,{onClick:function(){e(Kn.NEW_FORM)}},O.ZP.t("空白新建")));return A.createElement("div",{className:"form-btn-group-wrapper"},A.createElement("button",{id:"title-link-owner-form",className:"desktop-cta-button size-m type-gray",onClick:function(){i&&e(Kn.GET_FORMS_USER)}},A.createElement("div",{className:"btn-container"},O.ZP.t("关联已创建收集表"))),A.createElement(ir.default,{dropContent:s,dropContentClassName:"title-btn-dropdown",animated:!1,disabled:!i,alignment:"right",matchWidth:!0},A.createElement("button",{id:"title-new-form",className:"desktop-cta-button size-m type-primary"},A.createElement("div",{className:"btn-container"},O.ZP.t("新建收集表")))))}},n.handleSwitchSheet=function(e){var t=n.props.app.spreadsheet.isExternalSheet(e);t!==n.state.isExternalSheet&&n.setState({isExternalSheet:t})},n.app=t.app,n.state={forms:[],isLoaded:!1,isExternalSheet:t.app.spreadsheet.isExternalSheet(),formSwitch:!0},n.getFormInfos(),n}(0,s.Z)(t,e);var n=t.prototype;return n.componentDidMount=function(){hr.ZP.formRelationEvent.listen("formRelationChange",this.getFormInfos),hr.ZP.sheetsBar.listen("switchActiveSheetEnd",this.handleSwitchSheet)},n.componentWillUnmount=function(){hr.ZP.formRelationEvent.remove("formRelationChange",this.getFormInfos),hr.ZP.sheetsBar.remove("switchActiveSheetEnd",this.handleSwitchSheet)},n.render=function(){var e=this.props.callback,t=this.state,n=t.forms,r=t.isLoaded,o=t.isExternalSheet,i=this.props.app.sheetStatus.canEdit;return A.createElement("div",{className:dt()("form-panel-container",{"has-edit-perm":i})},A.createElement("div",{className:"form-title"},A.createElement("div",{className:"form-title-text"},A.createElement("p",{className:"form-title-maintext"},O.ZP.t("关联的收集表")),r&&(n.length>0?A.createElement("p",{className:"form-title-subtext"},O.ZP.t("此表格已关联{{value}}个收集表",{value:n.length})):null)),A.createElement("div",{className:"form-title-operate"},A.createElement("div",{className:"form-close",onClick:function(){return e(Kn.PANEL_HIDE)}},A.createElement(ar.Z,null)))),r&&A.createElement(A.Fragment,null,n.length>0?A.createElement(vr,Object.assign({},this.props,{forms:n})):A.createElement(wr,Object.assign({},this.props,{isExternalSheet:o})),A.createElement("div",{className:"form-button-group"},this.getBtnGroup())),!r&&A.createElement("div",{style:{padding:"200px 50px",fontSize:"50px"}}," ",A.createElement(cr.Z,null)," "))},n.fetchSwitch=function(){return Rr(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,yr.JY.fetch();case 2:t=e.sent,n=t.relateform,this.setState({formSwitch:n});case 5:case"end":return e.stop()}}),e,this)})))},t}(A.Component),Cr=function(e,t,n,r){var o,i=arguments.length,s=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},Ar=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},xr=function(e,t){return function(n,r){t(n,r,e)}},Or=function(e){function t(t){var n;return(n=e.call(this,t,"relate-form-drawer")||this).app=t,n.drawerMode=nr.$t.PUSH,n.drawerStyle={width:"400px"},n.getContent=function(){return x().createElement(Ir,{app:n.app,callback:n.handleCallBack})},n.beforeOpenDrawer=function(){return n.closeGuide(),!n.isDrawerOpen||(hr.ZP.toolBar.trigger("formPanelShowWhenIsShowing"),!1)},n.afterOpenDrawer=function(){hr.ZP.toolBar.trigger("formSidePanelShow"),n.app.spreadsheet.sheetManager.sheetCount},n.afterCloseDrawer=function(){hr.ZP.toolBar.trigger("formSidePanelHide")},n.handleCallBack=function(e,t){switch(e){case Kn.CHECK_RESULT:n.relateFormApi("check_form",void 0,void 0,t);break;case Kn.UNLINK_FORM:n.relateFormApi("cancel_form",void 0,void 0,t);break;case Kn.GET_FORMS_USER:n.relateFormApi("get_form_by_user");break;case Kn.NEW_FORM:n.relateFormApi("new_to_form");break;case Kn.CONVERT_FORM:n.relateFormApi("convert_to_form");break;case Kn.COPY_LINK:n.relateFormApi("copy_form_link",void 0,void 0,t);break;case Kn.QR_CODE:n.relateFormApi("show_form_qrcode",void 0,void 0,t);break;case Kn.WXWORK_SEND:n.relateFormApi("wedoc_send_wxwork",void 0,void 0,t);break;case Kn.PANEL_HIDE:n.closeDrawer();break;case Kn.EXPORT_FORM:n.relateFormApi("export_form",void 0,void 0,t)}},n.relateFormApi=function(e,t,r,o){n.app.feature.relateForm.handle(e,t,r,!1,o)},n}return(0,s.Z)(t,e),t.prototype.closeGuide=function(){var e=document.getElementById("relateform-guide-container");e&&(e.style.display="none")},t}(or.Z),Nr=Or=Cr([(0,rr.t)(),xr(0,ie.m),Ar("design:paramtypes",["function"===typeof(pr="undefined"!==typeof ie.m&&ie.m)?pr:Object])],Or),Sr=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function s(e){try{c(r.next(e))}catch(t){i(t)}}function a(e){try{c(r.throw(e))}catch(t){i(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))},kr=function(e){function t(t){var n;return(n=e.call(this,t)||this).handleSheetStatusChange=function(){n.forceUpdate()},n.initInjectService=function(){var e=S.Am.get(Gn);n.sheetStatus=e.getPermissions().sheetStatus,n.menuBarFeature=e,n.relateFormDrawer=S.Am.get(Nr)},n.catchClick=function(e){e.stopPropagation(),e.nativeEvent.stopImmediatePropagation()},n.getRelateFormBtn=function(){var e=n.state.activeMenu===zn.RELATE_FORM,t=dt()({"titlebar-btn-container":!0,"titlebar-active":e}),r=dt()({"titlebar-icon":!0,"titlebar-icon-relate-form":!at.xc,"titlebar-icon-wework-relate-form":at.xc});return x().createElement("div",{className:t,ref:n.relateFormBtn,onClick:function(){e?(n.relateFormDrawer.closeDrawer(),n.menuBarFeature.updateActiveMenu(void 0)):(n.relateFormDrawer.openDrawer(),n.menuBarFeature.updateActiveMenu(zn.RELATE_FORM))}},x().createElement(N.default,{disabled:e,title:O.ZP.t("关联收集表"),trigger:"hover"},x().createElement("div",{className:r})))},n.initInjectService(),n.state={activeMenu:void 0},n.relateFormBtn=x().createRef(),n}(0,s.Z)(t,e);var n=t.prototype;return n.componentDidMount=function(){return Sr(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.sheetStatus.change(this.handleSheetStatusChange),this.onActiveMenuChange=this.menuBarFeature.onActiveMenuChange((function(e){t.setState({activeMenu:e})})),le.Z.event.toolBar.listen("formSidePanelHide",(function(){t.setState({activeMenu:void 0})}));case 3:case"end":return e.stop()}}),e,this)})))},n.componentWillUnmount=function(){this.sheetStatus.offChange(this.handleSheetStatusChange),this.onActiveMenuChange.dispose()},n.render=function(){return x().createElement("div",{className:"menubar-component"},this.getRelateFormBtn())},t}(x().Component),Pr=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function s(e){try{c(r.next(e))}catch(t){i(t)}}function a(e){try{c(r.throw(e))}catch(t){i(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))},Dr=function(e){function t(t){var n;return(n=e.call(this,t)||this).handleSheetStatusChange=function(){n.forceUpdate()},n.initInjectService=function(){var e=S.Am.get(Gn);n.sheetStatus=e.getPermissions().sheetStatus,n.menuBarFeature=e},n.initInjectService(),n.state={activeMenu:void 0},n}(0,s.Z)(t,e);var n=t.prototype;return n.render=function(){return x().createElement("div",{className:"menubar-component"},this.getAddMemberMenuBtn())},n.componentDidMount=function(){return Pr(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.sheetStatus.change(this.handleSheetStatusChange),this.onActiveMenuChange=this.menuBarFeature.onActiveMenuChange((function(e){t.setState({activeMenu:e})}));case 2:case"end":return e.stop()}}),e,this)})))},n.componentWillUnmount=function(){this.sheetStatus.offChange(this.handleSheetStatusChange),this.onActiveMenuChange.dispose()},n.getAddMemberMenuBtn=function(){var e=this.state.activeMenu===zn.ADD_MEMBER,t=dt()({"titlebar-btn-container":!0,"titlebar-active":e}),n=dt()({"titlebar-icon":!0,"titlebar-icon-add-member":at.xc});return x().createElement("div",{id:"timeline-collab-container",className:t},x().createElement("div",{className:n}))},t}(x().Component),Lr=n("../node_modules/@tencent/workbench/lib/esm/components/transition/transition.js"),Mr=n("../node_modules/@tencent/workbench/lib/esm/services/transition/transition-service.js"),Fr=n("../spread-sheet/src/external/tencentMeeting/utils.ts"),jr=function(e,t,n,r){var o,i=arguments.length,s=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},Hr=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},Zr=function(e){function t(t){var n;(n=e.call(this,t)||this).isShowDivider=F.q.getConfig("isLogin")&&!(0,Fr.isFromTencentMeetingSharing)();var r=n.isShowDivider?48:40;return n.transitionService.register("titlebar-unfold",{duration:350,entered:{width:r,visibility:"visible",transition:"width 0.35s ease-out"},entering:{width:r,visibility:"visible",transition:"width 0.35s ease-out"},exited:{width:"0px",visibility:"hidden",transition:"width 0.35s ease-out"},exiting:{width:"0px",visibility:"hidden",transition:"width 0.35s ease-out"}}),n}return(0,s.Z)(t,e),t.prototype.render=function(){var e=x().createElement(Qn.l,{align:"left",name:v.z_.TOOLBAR_MODE,mode:"menu"});return x().createElement(ir.default,{dropContent:e,placement:"bottom"},x().createElement(N.default,{title:O.ZP.t("ui|toolbar.toolbarDisplayOptions"),alignment:"end",placement:"bottom"},x().createElement(Lr.K,{name:"titlebar-unfold",simulateSpaceChange:!0},x().createElement("div",{className:"titlebar-unfold"},this.isShowDivider&&x().createElement(Fe.default,{className:"titlbar-unfold-divider",orientation:"vertical"}),x().createElement("div",{className:"titlebar-toolbar-mode-wrap"},x().createElement("div",{className:"titlebar-toolbar-mode"},x().createElement("div",{className:"icon-svg-toolbar_fold"})))))))},t}(x().PureComponent);jr([(0,S.tB)(),Hr("design:type","function"===typeof(fr="undefined"!==typeof Mr.Z&&Mr.Z)?fr:Object)],Zr.prototype,"transitionService",void 0);var Br,zr,Ur,Vr,Wr=[{name:v.z_.EDIT,content:""},{name:v.z_.FILE,content:""}],Gr=[{name:r.HOME,content:x().createElement(Wt,{isToC:!at.xc}),preventHide:!0,shouldDisableWhenPrinting:!1},{name:r.TITLE,content:x().createElement(fe,{emptyTitle:O.ZP.t("无标题表格")}),shrinkable:"continuous",preventHide:!0,priority:2,shouldDisableWhenPrinting:!1,style:{marginRight:0,fontSize:0}},{name:r.TITLE_BADGE,content:x().createElement(Yt,null),preventHide:!0,shouldDisableWhenPrinting:!1,style:{marginRight:0}},{name:r.READONLY_TIPS,content:x().createElement(Ee,null),preventHide:!0,shouldDisableWhenPrinting:!1,style:{marginRight:0}},{name:r.BADGE,content:x().createElement(Ie,null),preventHide:!0,shouldDisableWhenPrinting:!1},{name:r.COLLECT,content:x().createElement(Mt,null),preventHide:!0,shouldDisableWhenPrinting:!1},{name:r.MOVE,content:x().createElement(Ht,null),preventHide:!0,shouldDisableWhenPrinting:!1},{name:r.SUBSCRIPTION_NOTIFICATION,content:x().createElement(Ln,null),preventHide:!0,shouldDisableWhenPrinting:!1},{name:r.SAVE_TIPS,content:x().createElement(tt,null),preventHide:!0,shrinkable:"continuous",widthRange:[38,350],priority:1,shouldDisableWhenPrinting:!1,style:{marginLeft:0}},{name:r.COLLABORATION,content:x().createElement(Le,null),preventHide:!0,shouldDisableWhenPrinting:!0,style:{marginLeft:0,marginRight:0}},{name:r.QQ_GROUP_AIO,content:x().createElement(He,null),preventHide:!0,shouldDisableWhenPrinting:!0,style:{marginLeft:0,marginRight:0}},{name:r.ADD_MEMBER,content:null,preventHide:!0,shouldDisableWhenPrinting:!0},{name:r.DISCUSSION,content:null,preventHide:!0,shouldDisableWhenPrinting:!0},{name:r.FILE_MENU,content:x().createElement("div",{className:"menu-bar"},x().createElement(Jn,null)),preventHide:!0,shouldDisableWhenPrinting:!0},{name:r.EDIT_MENU,content:x().createElement("div",{className:"menu-bar"},x().createElement(tr,null)),preventHide:!0,shouldDisableWhenPrinting:!0},{name:r.RELATE_FORM_MENU,content:x().createElement("div",{className:"menu-bar"},x().createElement(kr,null)),preventHide:!0,shouldDisableWhenPrinting:!0},{name:r.AUTH,content:x().createElement(q,null),preventHide:!0,shouldDisableWhenPrinting:!0,style:{fontSize:0}},{name:r.SHARE,content:x().createElement(lt,null),preventHide:!0,shouldDisableWhenPrinting:!0,style:{marginLeft:4}},{name:r.ACCOUNT_AVATAR,content:x().createElement(kt,null),preventHide:!0,shouldDisableWhenPrinting:!0,style:{marginRight:12}},{name:r.LOGIN,content:x().createElement(Pt,null),preventHide:!0,shouldDisableWhenPrinting:!0,style:{marginRight:12}},{name:r.TOOLBAR_MODE,content:x().createElement(Zr,null),preventHide:!0,shouldDisableWhenPrinting:!0,style:{marginLeft:0,marginRight:0}}],Yr=n("../spread-sheet/src/external/view/workbench/service/notification.ts"),Kr=function(e,t,n,r){var o,i=arguments.length,s=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},Xr=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},qr=function(e,t){return function(n,r){t(n,r,e)}},Qr=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function s(e){try{c(r.next(e))}catch(t){i(t)}}function a(e){try{c(r.throw(e))}catch(t){i(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))},$r=function(){function e(e,t,n,r){var o=this;this.permissions=e,this.policyInfoFeature=t,this.redPointFeature=n,this.authDrawer=r,this.handleAuthShow=function(){return Qr(o,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(0,Yr.Q2)()&&(0,Yr.yK)(),this.authDrawer.openDrawer({showAdvPermissions:!1,updatePolicyInfo:this.policyInfoFeature.updatePolicyInfo}),oe.ZP.tdwReport({module:"cooperation_button",opername:"doc_menubar",action:"click",ver12:"new"});case 4:case"end":return e.stop()}}),e,this)})))},this.initAuth=function(){o.applyService=new yt({sheetStatus:o.permissions.sheetStatus}),o.redPointFeature.initRedPointerService()},this.registerListener=function(){le.Z.event.default.listen("CooperationV2Hide",o.handleAuthHide),le.Z.event.default.listen("showCooperationV2",o.handleAuthShow)},this.unregisterListener=function(){le.Z.event.default.remove("CooperationV2Hide",o.handleAuthHide),le.Z.event.default.remove("showCooperationV2",o.handleAuthShow)},this.handleAuthHide=function(){o.authDrawer.closeDrawer(),oe.ZP.tdwReport({module:"cooperation_button",opername:"doc_menubar",action:"click",ver12:"new"})},this.initAuth(),this.registerListener()}return e.prototype.isAuthBtnShow=function(){var e=n.g.clientVars,t=e.rightFlag,r=e.isOwner;return 4294967295===t||2048===t||r},e}();$r=Kr([(0,D.L)({adapters:[Z.L,B.dH]}),qr(0,Mn.H),Xr("design:paramtypes",["function"===typeof(Br="undefined"!==typeof Mn.H&&Mn.H)?Br:Object,"function"===typeof(zr="undefined"!==typeof G&&G)?zr:Object,"function"===typeof(Ur="undefined"!==typeof Rt&&Rt)?Ur:Object,"function"===typeof(Vr="undefined"!==typeof H.Z&&H.Z)?Vr:Object])],$r);var Jr,eo,to,no=n("../spread-sheet/src/external/view/ui-layer/toolbar-mode/toolbar-mode-feature.tsx"),ro=n("../spread-sheet/src/external/view/ui-layer/toolbar-mode/config.tsx"),oo=function(e,t,n,r){var o,i=arguments.length,s=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},io=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},so=function(){function e(e,t,n){this.toolbarModeFeature=e,this.authBtnFeature=t,this.maskFeature=n}var t=e.prototype;return t.hideReadonlyTips=function(){return!(F.q.getConfig("canRead")&&!F.q.getConfig("canEdit"))},t.hideTitleBadge=function(){return!(!F.q.getConfig("creatorCorpId")&&(0,Te.c)())},t.hideBadge=function(){var e;return!!(null===(e=window.clientVars)||void 0===e?void 0:e.appInfoConfig)},t.hideUserLine=function(){return!n.g.clientVars},t.hideSaveTips=function(){return F.q.getConfig("canRead")&&!F.q.getConfig("canEdit")},t.hideFileMenuBar=function(){return!F.q.getConfig("isLogin")},t.hideMoreMenuBar=function(){return!F.q.getConfig("isLogin")||!F.q.getConfig("canEdit")},t.hideRelateMenuBar=function(){return!F.q.getConfig("isLogin")},t.hideRelateFormMenuBar=function(){return!F.q.getConfig("isLogin")},t.toggleAuthPanel=function(){this.authBtnFeature.handleAuthShow()},t.hideAuthBtn=function(){var e;return!F.q.getConfig("isLogin")||!(null===(e=this.authBtnFeature)||void 0===e?void 0:e.isAuthBtnShow())||at.xc},t.hideShareBtn=function(){return!F.q.getConfig("isLogin")},t.hideAvatar=function(){return!F.q.getConfig("isLogin")},t.hideLoginBtn=function(){return F.q.getConfig("isLogin")},t.hideMask=function(){var e;return!F.q.getConfig("isLogin")||(null===(e=this.maskFeature)||void 0===e?void 0:e.isDisableMaskShow())},t.hideToolbarMode=function(){return this.toolbarModeFeature.getUserToolbarMode()!==ro.ToolbarModeOrders.HIDE_TOOLBAR},e}();oo([(0,I.b)(r.READONLY_TIPS,"shouldHide"),io("design:type",Function),io("design:paramtypes",[]),io("design:returntype",void 0)],so.prototype,"hideReadonlyTips",null),oo([(0,I.b)(r.TITLE_BADGE,"shouldHide"),io("design:type",Function),io("design:paramtypes",[]),io("design:returntype",void 0)],so.prototype,"hideTitleBadge",null),oo([(0,I.b)(r.BADGE,"shouldHide"),io("design:type",Function),io("design:paramtypes",[]),io("design:returntype",void 0)],so.prototype,"hideBadge",null),oo([(0,I.b)(r.COLLABORATION,"shouldHide"),io("design:type",Function),io("design:paramtypes",[]),io("design:returntype",void 0)],so.prototype,"hideUserLine",null),oo([(0,I.b)(r.SAVE_TIPS,"shouldHide"),io("design:type",Function),io("design:paramtypes",[]),io("design:returntype",void 0)],so.prototype,"hideSaveTips",null),oo([(0,I.b)(r.FILE_MENU,"shouldHide"),io("design:type",Function),io("design:paramtypes",[]),io("design:returntype",void 0)],so.prototype,"hideFileMenuBar",null),oo([(0,I.b)(r.EDIT_MENU,"shouldHide"),io("design:type",Function),io("design:paramtypes",[]),io("design:returntype",void 0)],so.prototype,"hideMoreMenuBar",null),oo([(0,I.b)(r.RELATE_MENU,"shouldHide"),io("design:type",Function),io("design:paramtypes",[]),io("design:returntype",void 0)],so.prototype,"hideRelateMenuBar",null),oo([(0,I.b)(r.RELATE_FORM_MENU,"shouldHide"),io("design:type",Function),io("design:paramtypes",[]),io("design:returntype",void 0)],so.prototype,"hideRelateFormMenuBar",null),oo([(0,I.b)(r.AUTH,"onClick"),io("design:type",Function),io("design:paramtypes",[]),io("design:returntype",void 0)],so.prototype,"toggleAuthPanel",null),oo([(0,I.b)(r.AUTH,"shouldHide"),io("design:type",Function),io("design:paramtypes",[]),io("design:returntype",void 0)],so.prototype,"hideAuthBtn",null),oo([(0,I.b)(r.SHARE,"shouldHide"),io("design:type",Function),io("design:paramtypes",[]),io("design:returntype",void 0)],so.prototype,"hideShareBtn",null),oo([(0,I.b)(r.ACCOUNT_AVATAR,"shouldHide"),io("design:type",Function),io("design:paramtypes",[]),io("design:returntype",void 0)],so.prototype,"hideAvatar",null),oo([(0,I.b)(r.LOGIN,"shouldHide"),io("design:type",Function),io("design:paramtypes",[]),io("design:returntype",void 0)],so.prototype,"hideLoginBtn",null),oo([(0,I.b)(r.MASK,"shouldHide"),io("design:type",Function),io("design:paramtypes",[]),io("design:returntype",void 0)],so.prototype,"hideMask",null),oo([(0,I.b)(r.TOOLBAR_MODE,"shouldHide"),io("design:type",Function),io("design:paramtypes",[]),io("design:returntype",void 0)],so.prototype,"hideToolbarMode",null),so=oo([(0,C.Q)({adapters:[Z.L,B.dH],titlebarItems:Gr,menuItems:Wr}),io("design:paramtypes",["function"===typeof(Jr="undefined"!==typeof no.ToolbarModeFeature&&no.ToolbarModeFeature)?Jr:Object,"function"===typeof(eo="undefined"!==typeof $r&&$r)?eo:Object,"function"===typeof(to="undefined"!==typeof jn&&jn)?to:Object])],so);var ao=[{name:v.z_.EDIT,content:""},{name:v.z_.FILE,content:""}],co=[{name:E.HOME,content:x().createElement(Wt,{isToC:!1}),preventHide:!0,shouldDisableWhenPrinting:!1},{name:E.TITLE,content:x().createElement(fe,{emptyTitle:O.ZP.t("无标题表格")}),shrinkable:"continuous",preventHide:!0,priority:2,shouldDisableWhenPrinting:!1,style:{marginRight:0,fontSize:0}},{name:E.TITLE_BADGE,content:x().createElement(Yt,null),preventHide:!0,shouldDisableWhenPrinting:!1,style:{marginRight:0}},{name:E.COLLECT,content:x().createElement(Mt,null),preventHide:!0,shouldDisableWhenPrinting:!1},{name:E.MOVE,content:x().createElement(Ht,null),preventHide:!0,shouldDisableWhenPrinting:!1},{name:E.SUBSCRIPTION_NOTIFICATION,content:x().createElement(Ln,null),preventHide:!0,shouldDisableWhenPrinting:!1},{name:E.RELATE_FORM_MENU,content:x().createElement("div",{className:"menu-bar"},x().createElement(kr,null)),preventHide:!0,shouldDisableWhenPrinting:!0},{name:E.ADD_MEMBER,content:x().createElement("div",{className:"menu-bar"},x().createElement(Dr,null)),preventHide:!0,shouldDisableWhenPrinting:!0},{name:E.DISCUSSION,content:x().createElement("div",{className:"menu-bar"},x().createElement(qn,null)),preventHide:!0,shouldDisableWhenPrinting:!0},{name:E.FILE_MENU,content:x().createElement("div",{className:"menu-bar"},x().createElement(Jn,null)),preventHide:!0,shouldDisableWhenPrinting:!0},{name:E.EDIT_MENU,content:x().createElement("div",{className:"menu-bar"},x().createElement(tr,null)),preventHide:!0,shouldDisableWhenPrinting:!0},{name:E.SHARE,content:x().createElement(lt,null),preventHide:!0,shouldDisableWhenPrinting:!0,style:{marginLeft:4}},{name:E.ACCOUNT_AVATAR,content:x().createElement(kt,null),preventHide:!0,shouldDisableWhenPrinting:!0,style:{marginRight:12}}],lo=function(e,t,n,r){var o,i=arguments.length,s=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},uo=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},_o=function(){function e(){}var t=e.prototype;return t.hideHome=function(){return(0,at.P8)()},t.hideTitleBadge=function(){return!F.q.getConfig("useByExternal")},t.hideCollect=function(){return rt().isWxWork},t.hideMove=function(){return rt().isWxWork||!this.isEntAccount()},t.hideNotification=function(){return!this.isEntAccount()},t.hideRelateFormMenuBar=function(){return!F.q.getConfig("isLogin")},t.hideFileMenuBar=function(){return!F.q.getConfig("isLogin")},t.hideMoreMenuBar=function(){return rt().isWxWork||!F.q.getConfig("isLogin")||!F.q.getConfig("canEdit")},t.hideShareBtn=function(){return rt().isWxWork||!F.q.getConfig("isLogin")},t.hideAvatar=function(){return!F.q.getConfig("isLogin")||rt().isWxWork},t.isEntAccount=function(){var e,t,n,r;return!window.clientVars&&!window.basicClientVars||!!(null===(t=null===(e=window.clientVars)||void 0===e?void 0:e.userInfo)||void 0===t?void 0:t.corp_id)||!!(null===(r=null===(n=null===window||void 0===window?void 0:window.basicClientVars)||void 0===n?void 0:n.userInfo)||void 0===r?void 0:r.corpId)},e}();lo([(0,I.b)(E.HOME,"shouldHide"),uo("design:type",Function),uo("design:paramtypes",[]),uo("design:returntype",void 0)],_o.prototype,"hideHome",null),lo([(0,I.b)(E.TITLE_BADGE,"shouldHide"),uo("design:type",Function),uo("design:paramtypes",[]),uo("design:returntype",void 0)],_o.prototype,"hideTitleBadge",null),lo([(0,I.b)(E.COLLECT,"shouldHide"),uo("design:type",Function),uo("design:paramtypes",[]),uo("design:returntype",void 0)],_o.prototype,"hideCollect",null),lo([(0,I.b)(E.MOVE,"shouldHide"),uo("design:type",Function),uo("design:paramtypes",[]),uo("design:returntype",void 0)],_o.prototype,"hideMove",null),lo([(0,I.b)(E.SUBSCRIPTION_NOTIFICATION,"shouldHide"),uo("design:type",Function),uo("design:paramtypes",[]),uo("design:returntype",void 0)],_o.prototype,"hideNotification",null),lo([(0,I.b)(E.RELATE_FORM_MENU,"shouldHide"),uo("design:type",Function),uo("design:paramtypes",[]),uo("design:returntype",void 0)],_o.prototype,"hideRelateFormMenuBar",null),lo([(0,I.b)(E.FILE_MENU,"shouldHide"),uo("design:type",Function),uo("design:paramtypes",[]),uo("design:returntype",void 0)],_o.prototype,"hideFileMenuBar",null),lo([(0,I.b)(E.EDIT_MENU,"shouldHide"),uo("design:type",Function),uo("design:paramtypes",[]),uo("design:returntype",void 0)],_o.prototype,"hideMoreMenuBar",null),lo([(0,I.b)(E.SHARE,"shouldHide"),uo("design:type",Function),uo("design:paramtypes",[]),uo("design:returntype",void 0)],_o.prototype,"hideShareBtn",null),lo([(0,I.b)(E.ACCOUNT_AVATAR,"shouldHide"),uo("design:type",Function),uo("design:paramtypes",[]),uo("design:returntype",void 0)],_o.prototype,"hideAvatar",null),_o=lo([(0,C.Q)({titlebarItems:co,menuItems:ao})],_o);var po,fo,ho=n("../spread-sheet/src/external/view/schema/contextmenu-key.ts"),mo=[ho.B.CUT,ho.B.COPY,ho.B.RANGE_TO_IMAGE_COPY,ho.B.PASTE,ho.B.INSERT_CUT_CELLS,ho.B.INSERT_COPY_CELLS,{key:ho.B.PASTE_SPECIAL,items:[ho.B.KEEP_DEFAULT,ho.B.MERGE_STYLES,ho.B.ONLY_VALUES,ho.B.CLEAR_AUTO_PARSE,ho.B.DIVIDER,ho.B.TRANSPOSE,ho.B.DIVIDER,ho.B.PASTE_SPECIAL_HELP]},ho.B.DIVIDER,ho.B.INSERT_ROW_ABOVE,ho.B.INSERT_ROW_BELOW,ho.B.HIDE_ROW,ho.B.CANCEL_HIDE_ROW,ho.B.SET_ROW_HEIGHT,ho.B.DELETE_ROW,ho.B.DIVIDER,ho.B.INSERT_COL_LEFT,ho.B.INSERT_COL_RIGHT,ho.B.HIDE_COL,ho.B.CANCEL_HIDE_COL,ho.B.SET_COL_WIDTH,ho.B.DELETE_COL,ho.B.DIVIDER,ho.B.MERGE_CELLS,ho.B.UNMERGE_CELLS,{key:ho.B.INSERT_RANGE,items:[ho.B.INSERT_RANGE_RIGHT,ho.B.INSERT_RANGE_DOWN]},{key:ho.B.DELETE_RANGE,items:[ho.B.DELETE_RANGE_LEFT,ho.B.DELETE_RANGE_UP]},ho.B.DIVIDER,ho.B.INSERT_COMMENT_ENT,ho.B.DIVIDER,{key:ho.B.INSERT,items:[ho.B.INSERT_LINK,ho.B.INSERT_COMMENT,ho.B.INSERT_CELL_PICTURE,ho.B.INSERT_ATTACHMENT]},{key:ho.B.CLEAR,items:[ho.B.CLEAR_FORMAT,ho.B.CLEAR_CONTENT]},ho.B.DIVIDER,{key:ho.B.DATA_VALIDATION,items:(0,h.Z)(y.n2)},ho.B.SMART_SPLIT,ho.B.NUMBER_FORMAT,ho.B.DIVIDER,{key:ho.B.HYPERLINK_ICON_VISIBILITY,items:[ho.B.HYPERLINK_ICON_INVISIBLE,ho.B.HYPERLINK_ICON_VISIBLE]},ho.B.DIVIDER,{key:ho.B.CONVERT_IMAGE,items:[ho.B.CONVERT_CELL_IMAGE,ho.B.CONVERT_FLOAT_IMAGE]},ho.B.DIVIDER,ho.B.EXPORT_FILE,ho.B.DIVIDER,ho.B.LINK_RANGE,ho.B.DIVIDER,ho.B.PROTECT_SELECTED_RANGE,ho.B.PROTECTED_RANGE_LIST,ho.B.DIVIDER,ho.B.CONVERT_TO_SMART_SHEET],vo=n("../node_modules/@tencent/workbench/lib/esm/services/widget/widget-service.js"),yo=n("../spread-sheet/src/external/view/ui-layer/short-cut/short-cut-drawer.ts"),go=function(e,t,n,r){var o,i=arguments.length,s=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},Eo=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},wo="help-center",bo=function(){function e(e,t){var r=this;this.widgetService=e,this.shortCutDrawer=t,this.initHelpCenter=function(){var e;(null===z.Z||void 0===z.Z?void 0:z.Z.getConfig("widget.helpCenter"))&&(null===(e=n.g.SLR)||void 0===e||e.load("HelpCenter",(function(e){try{var t="workbench_helpcenter_wrapper";if(document.getElementById(t))return;var n=x().createElement("div",{id:t});r.open(n);var o=document.getElementById(t);e.show(o,{from:"excel",showShortcutPanel:r.shortCutDrawer.openDrawer,clientVars:window.clientVars})}catch(i){console.error(i)}})))},this.open=function(e){r.widgetService.float({name:wo,component:e,styles:{zIndex:2,position:"relative"}})},this.close=function(){r.widgetService.remove(wo,"float")},this.registerListener=function(){hr.ZP.default.listen("sidePanelShow",r.hide),hr.ZP.default.listen("sidePanelHide",r.show)},this.show=function(){r.widgetService.changeFloatWidgetVisbility(wo,!0)},this.hide=function(){r.widgetService.changeFloatWidgetVisbility(wo,!1)},null===window||void 0===window||window.SLR.listen("SL-INIT",(function(){r.initHelpCenterAfterPluginsEnd()})),this.initHelpCenterAfterPluginsEnd(),this.registerListener()}return e.prototype.initHelpCenterAfterPluginsEnd=function(){var e=this;n.g.SpreadsheetApp.emitter.once(n.g.SpreadsheetApp.EVENT.SPREAD_SHEET_PLUGINS_END,(function(){e.initHelpCenter()}))},e}();bo=go([(0,D.L)({adapters:[Z.L,B.dH]}),Eo("design:paramtypes",["function"===typeof(po="undefined"!==typeof vo.i&&vo.i)?po:Object,"function"===typeof(fo="undefined"!==typeof yo.Z&&yo.Z)?fo:Object])],bo),n("../node_modules/core-js/modules/es.array.find.js");var To,Ro=function(e,t,n,r){var o,i=arguments.length,s=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},Io=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},Co=function(){function e(e){this.redPointFeature=e,this.initNotification()}return e.prototype.initNotification=function(){var e=this;$(document).on("click","#notification-dropdown-line",(function(){if(!$(".toolbar-notification-btn").hasClass("toolbar-notification-btn-disabled")){if((0,Yr.Q2)()?(0,Yr.yK)():(0,Yr.c0)(),$("#notification-dropdown-line").find(".redpoint").length>0){var t={};F.q.getConfig("isCreator")&&(t={detail:{localPadID:F.q.getConfig("padId"),domainID:F.q.getConfig("domainId")}});var n=new CustomEvent("notification-update-list",t);document.dispatchEvent(n)}F.q.getConfig("isCreator")||e.redPointFeature.getRedPointService().clearUnreadNotificationNumber()}})),$(window).on("networkOnline",(function(){var e=new CustomEvent("notification-list-online");document.dispatchEvent(e)})),$(window).on("networkOffline",(function(){var e=new CustomEvent("notification-list-offline");document.dispatchEvent(e)}))},e}();Co=Ro([(0,D.L)({adapters:[Z.L,B.dH]}),Io("design:paramtypes",["function"===typeof(To="undefined"!==typeof Rt&&Rt)?To:Object])],Co);var Ao,xo,Oo=n("../node_modules/@babel/runtime/helpers/esm/createClass.js"),No=n("../node_modules/@tencent/workbench/lib/esm/index.js"),So=n("../node_modules/@tencent/workbench/lib/esm/decorators/method/toolbar.js"),ko=n("../node_modules/@tencent/workbench/lib/esm/decorators/method/dynamic-loader/await-load.js"),Po=n("../spread-sheet/src/external/view/ui-layer/toggle-titlebar/toggle-titlebar-feature.ts"),Do=function(e){function t(t){var n;return(n=e.call(this,t)||this).updateRotate=function(){var e=S.Am.get(c.M).isShowing();e!==n.state.isTitlebarShow&&n.setState({isTitlebarShow:e})},n.state={isTitlebarShow:!(0,Fr.isFromTencentMeetingSharing)()},S.Am.get(Po.ToggleTitleFeature).onTitlebarToggle(n.updateRotate),n}return(0,s.Z)(t,e),t.prototype.render=function(){var e=this.state.isTitlebarShow;return A.createElement("div",{className:e?"pc-slide":"pc-slide pc-slide-rotate"})},t}(A.Component),Lo=[{name:m.HM.TOGGLE_TITLEBAR,icon:A.createElement(Do,null),type:"icon"}],Mo=n("../spread-sheet/src/external/view/ui-layer/toggle-titlebar/toggle-titlebar.interface.ts"),Fo=function(e,t,n,r){var o,i=arguments.length,s=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},jo=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},Ho=function(e,t){return function(n,r){t(n,r,e)}},Zo=function(){function e(e,t){this.titlebarService=e,this.loader=t}return e.prototype.toggleTitleBar=function(){this.titlebarService.toggle(),this.toggleTitleFeature.triggerToggle(),this.toggleTitleFeature.triggerResize()},(0,Oo.Z)(e,[{key:"toggleTitleFeature",get:function(){return this.loader.instance}}]),e}();Fo([(0,So.o)(m.HM.TOGGLE_TITLEBAR,"onClick"),(0,ko.k)(),jo("design:type",Function),jo("design:paramtypes",[]),jo("design:returntype",void 0)],Zo.prototype,"toggleTitleBar",null),Zo=Fo([(0,C.Q)({toolbarItems:Lo}),Ho(1,(0,S.aN)(Mo.Y)),jo("design:paramtypes",["function"===typeof(Ao="undefined"!==typeof c.M&&c.M)?Ao:Object,"function"===typeof(xo="undefined"!==typeof No.IDynamicLoader&&No.IDynamicLoader)?xo:Object])],Zo);var Bo=[ho.B.FLOAT_IMG_CUT,ho.B.FLOAT_IMG_COPY,ho.B.FLOAT_IMG_CROP,ho.B.FLOAT_IMG_RESET,ho.B.FLOAT_IMG_TO_CELL_IMG,ho.B.FLOAT_IMG_DELETE],zo=[ho.B.CHART_DELETE,ho.B.CHART_EDIT,ho.B.CHART_TO_IMAGE],Uo=n("../spread-sheet/src/core/workbench/middleware/selection/selection-service.ts"),Vo=n("../spread-sheet/src/external/view/ui-layer/template-recommendation/template-recommendation-service.tsx"),Wo=n("../spread-sheet/src/external/view/ui-layer/filter/filter-feature.tsx"),Go=n("../spread-sheet/src/external/view/ui-layer/format-style/bold-controller.ts"),Yo=n("../spread-sheet/src/external/view/ui-layer/insert/insert-controller-pc.tsx"),Ko=n("../node_modules/@tencent/workbench/lib/esm/decorators/method/menu.js"),Xo=[{name:v.z_.ROW_COL_DIMENSION,content:O.ZP.t("行高列宽")},{name:v.z_.SET_ROW_HEIGHT,content:O.ZP.t("设置行高")},{name:v.z_.AUTO_SET_ROWANDCOL,content:O.ZP.t("自动调整行高")},{name:v.z_.SET_COL_WIDTH,content:O.ZP.t("设置列宽")},{name:v.z_.RESET_COL_WIDTH,content:O.ZP.t("恢复默认列宽")},{name:v.z_.AUTO_SET_COLWIDTH,content:O.ZP.t("自动调整列宽")},{name:v.z_.AUTO_SET_DIMENSION,content:O.ZP.t("自动调整行高列宽")}],qo=n("../spread-sheet/src/flow/browser/phase/workbench/merge-into-registry.ts"),Qo=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function s(e){try{c(r.next(e))}catch(t){i(t)}}function a(e){try{c(r.throw(e))}catch(t){i(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))},$o=Symbol.for("feature:rowColDimension");(0,qo.N)($o,(function(){return Qo(void 0,void 0,void 0,regeneratorRuntime.mark((function e(){var t,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([n.e("initial_chunk_part_2"),n.e("vendors-node_modules_tencent_docs-design-resources_pc_png_2x_cdn-function-export_js"),n.e("vendors-node_modules_tencent_docs-addon-sdk_lib_index_esm_js"),n.e("vendors-node_modules_tencent_docs-design-resources_pc_png_2x_cdn_js-node_modules_tencent_docs-70ebca"),n.e("vendors-node_modules_tencent_facade-config_dist_index_js"),n.e("vendors-node_modules_tencent_wedrive-component_dist_xdSaveDoc_css"),n.e("spread-sheet_src_base_util_decorator_loading-decorator_ts-spread-sheet_src_core_feature_copyP-33f189"),n.e("spread-sheet_src_core_view_level-2_condition-format-center_ui_utils_dataUtils_ts"),n.e("spread-sheet_src_core_workbench_common_base-drawer_tsx-spread-sheet_src_external_rangeAuth_ut-2939e0"),n.e("spread-sheet_src_core_view_level-2_chart_charts_chart-data-api_ts-spread-sheet_src_core_view_-9220ef"),n.e("spread-sheet_src_external_view_main_toolbar_IconBox_tsx"),n.e("spread-sheet_src_external_check-slr_sc-lazy-loader_ts-spread-sheet_src_external_templateinfo_-54b3ca"),n.e("spread-sheet_src_core_network_message-center_adapter_MessageCenterAdapter_interface_ts-spread-e88071"),n.e("spread-sheet_src_core_utils_gray_ts-spread-sheet_src_core_view_level-2_condition-format-cente-74d507"),n.e("spread-sheet_src_base_util_phone-number_ts-spread-sheet_src_core_feature_copyPaste_index_ts-s-89b53a"),n.e("spread-sheet_src_core_view_layout_pcView_ts"),n.e("spread-sheet_src_core_view_level-2_link-center_BaseLinkCenter_ts"),n.e("bundle_workbench_feature")]).then(n.bind(n,"../spread-sheet/src/external/view/ui-layer/row-col-dimension/rowColDimensionFeature.ts"));case 2:return t=e.sent,r=t.RowColDimensionFeature,e.abrupt("return",r);case 5:case"end":return e.stop()}}),e)})))}));var Jo,ei=function(e,t,n,r){var o,i=arguments.length,s=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},ti=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},ni=function(e,t){return function(n,r){t(n,r,e)}},ri=function(){function e(e){this.loader=e}var t=e.prototype;return t.setRowHeight=function(){this.rowColDimensionFeature.setRowHeight(),oe.ZP.tdwReport({module:"excel_dimension",opername:"doc_excel_editor",action:"clk_menu_row_size",ver12:"new"})},t.autoSetRowHeight=function(){this.rowColDimensionFeature.autoSetRowHeight(),oe.ZP.tdwReport({module:"excel_dimension",opername:"doc_excel_editor",action:"clk_menu_row_autosize",ver12:"new"})},t.setColWidth=function(){this.rowColDimensionFeature.setColWidth(),oe.ZP.tdwReport({module:"excel_dimension",opername:"doc_excel_editor",action:"clk_menu_col_size",ver12:"new"})},t.resetColWidth=function(){this.rowColDimensionFeature.resetColWidth(),oe.ZP.tdwReport({module:"excel_dimension",opername:"doc_excel_editor",action:"clk_menu_col_resize",ver12:"new"})},t.autoSetColWidth=function(){this.rowColDimensionFeature.autoSetColWidth(),oe.ZP.tdwReport({module:"excel_dimension",opername:"doc_excel_editor",action:"clk_menu_col_autosize",ver12:"new"})},t.autoSetRowAndCol=function(){this.rowColDimensionFeature.autoSetRowAndCol(),oe.ZP.tdwReport({module:"excel_dimension",opername:"doc_excel_editor",action:"clk_menu_cr_autosize",ver12:"new"})},(0,Oo.Z)(e,[{key:"rowColDimensionFeature",get:function(){return this.loader.instance}}]),e}();ei([(0,Ko.v)(v.z_.SET_ROW_HEIGHT,"onClick"),(0,ko.k)(),ti("design:type",Function),ti("design:paramtypes",[]),ti("design:returntype",void 0)],ri.prototype,"setRowHeight",null),ei([(0,Ko.v)(v.z_.AUTO_SET_ROWANDCOL,"onClick"),(0,ko.k)(),ti("design:type",Function),ti("design:paramtypes",[]),ti("design:returntype",void 0)],ri.prototype,"autoSetRowHeight",null),ei([(0,Ko.v)(v.z_.SET_COL_WIDTH,"onClick"),(0,ko.k)(),ti("design:type",Function),ti("design:paramtypes",[]),ti("design:returntype",void 0)],ri.prototype,"setColWidth",null),ei([(0,Ko.v)(v.z_.RESET_COL_WIDTH,"onClick"),(0,ko.k)(),ti("design:type",Function),ti("design:paramtypes",[]),ti("design:returntype",void 0)],ri.prototype,"resetColWidth",null),ei([(0,Ko.v)(v.z_.AUTO_SET_COLWIDTH,"onClick"),(0,ko.k)(),ti("design:type",Function),ti("design:paramtypes",[]),ti("design:returntype",void 0)],ri.prototype,"autoSetColWidth",null),ei([(0,Ko.v)(v.z_.AUTO_SET_DIMENSION,"onClick"),(0,ko.k)(),ti("design:type",Function),ti("design:paramtypes",[]),ti("design:returntype",void 0)],ri.prototype,"autoSetRowAndCol",null),ri=ei([(0,C.Q)({adapters:[Z.L],menuItems:Xo}),ni(0,(0,S.aN)($o)),ti("design:paramtypes",["function"===typeof(Jo="undefined"!==typeof No.IDynamicLoader&&No.IDynamicLoader)?Jo:Object])],ri);var oi=n("../node_modules/@tencent/workbench/lib/esm/decorators/method/contextmenu.js"),ii=n("../node_modules/@tencent/workbench/lib/esm/decorators/method/dynamic-loader/skip-with-default.js"),si=n("../spread-sheet/src/external/view/ui-layer/common.ts"),ai=n("../spread-sheet/src/core/workbench/middleware/selection/selection-type.ts"),ci=[{name:v.z_.INSERT_LINK,content:O.ZP.t("链接"),icon:A.createElement("div",{className:"icon-svg-toolbar-add-link"}),description:O.ZP.t("单元格/工作表"),respectOffline:!0,privateFillMiddleWareConfig:{shouldCheckWhenCellIsPrivate:!0}}],di=[{name:ho.B.INSERT,content:O.ZP.t("插入"),selectionMiddleware:{exclude:[ai.R.SHAPE,ai.R.CHART]},sheetStatusMiddleware:{isDisabledWhenCannotEdit:at.xc}},{name:ho.B.INSERT_LINK,shortcut:{win:"Ctrl+K",mac:"⌘+K"},style:si.u,respectOffline:!0,selectionMiddleware:{exclude:[ai.R.SHAPE,ai.R.CHART]},sheetStatusMiddleware:{isHiddenWhenCannotEdit:!0},privateFillMiddleWareConfig:{shouldCheckWhenCellIsPrivate:!0}},{name:ho.B.INSERT_CELL_PICTURE,content:O.ZP.t("单元格图片"),style:si.u,selectionMiddleware:{exclude:[ai.R.SHAPE,ai.R.CHART]},sheetStatusMiddleware:{isHiddenWhenCannotEdit:!0},privateFillMiddleWareConfig:{shouldCheckWhenCellIsPrivate:!0}},{name:ho.B.INSERT_ATTACHMENT,content:O.ZP.t("本地文件"),style:si.u,selectionMiddleware:{exclude:[ai.R.SHAPE,ai.R.CHART]},sheetStatusMiddleware:{isHiddenWhenCannotEdit:!0},privateFillMiddleWareConfig:{shouldCheckWhenCellIsPrivate:!0}}],li=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function s(e){try{c(r.next(e))}catch(t){i(t)}}function a(e){try{c(r.throw(e))}catch(t){i(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))},ui=Symbol.for("feature:insert-link");(0,qo.N)(ui,(function(){return li(void 0,void 0,void 0,regeneratorRuntime.mark((function e(){var t,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([n.e("initial_chunk_part_2"),n.e("vendors-node_modules_tencent_docs-design-resources_pc_png_2x_cdn-function-export_js"),n.e("vendors-node_modules_tencent_docs-addon-sdk_lib_index_esm_js"),n.e("vendors-node_modules_tencent_docs-design-resources_pc_png_2x_cdn_js-node_modules_tencent_docs-70ebca"),n.e("vendors-node_modules_tencent_facade-config_dist_index_js"),n.e("vendors-node_modules_tencent_wedrive-component_dist_xdSaveDoc_css"),n.e("spread-sheet_src_base_util_decorator_loading-decorator_ts-spread-sheet_src_core_feature_copyP-33f189"),n.e("spread-sheet_src_core_view_level-2_condition-format-center_ui_utils_dataUtils_ts"),n.e("spread-sheet_src_core_workbench_common_base-drawer_tsx-spread-sheet_src_external_rangeAuth_ut-2939e0"),n.e("spread-sheet_src_core_view_level-2_chart_charts_chart-data-api_ts-spread-sheet_src_core_view_-9220ef"),n.e("spread-sheet_src_external_view_main_toolbar_IconBox_tsx"),n.e("spread-sheet_src_external_check-slr_sc-lazy-loader_ts-spread-sheet_src_external_templateinfo_-54b3ca"),n.e("spread-sheet_src_core_network_message-center_adapter_MessageCenterAdapter_interface_ts-spread-e88071"),n.e("spread-sheet_src_core_utils_gray_ts-spread-sheet_src_core_view_level-2_condition-format-cente-74d507"),n.e("spread-sheet_src_base_util_phone-number_ts-spread-sheet_src_core_feature_copyPaste_index_ts-s-89b53a"),n.e("spread-sheet_src_core_view_layout_pcView_ts"),n.e("spread-sheet_src_core_view_level-2_link-center_BaseLinkCenter_ts"),n.e("bundle_workbench_feature")]).then(n.bind(n,"../spread-sheet/src/external/view/ui-layer/insert-link/insert-link-feature.ts"));case 2:return t=e.sent,r=t.InsertLinkFeature,e.abrupt("return",r);case 5:case"end":return e.stop()}}),e)})))}));var _i,pi=function(e,t,n,r){var o,i=arguments.length,s=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},fi=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},hi=function(e,t){return function(n,r){t(n,r,e)}},mi=function(){function e(e){this.loader=e}var t=e.prototype;return t.insertLink=function(){this.insertLinkFeature.insertLink(),oe.ZP.tdwReport({opername:"doc_excel_editor",module:"excel_link",action:"clk_insert_url",ver12:"new"})},t.getInsertLinkDisabledState=function(){return this.insertLinkFeature.getInsertLinkDisabledState()},t.hideInsertLink=function(){return this.insertLinkFeature.hideInsertLink()},t.getInsertLinkContent=function(){return this.insertLinkFeature.getInsertLinkContent()},(0,Oo.Z)(e,[{key:"insertLinkFeature",get:function(){return this.loader.instance}}]),e}();pi([(0,Ko.v)(v.z_.INSERT_LINK,"onClick"),(0,oi.x)(ho.B.INSERT_LINK,"onClick"),(0,ko.k)(),fi("design:type",Function),fi("design:paramtypes",[]),fi("design:returntype",void 0)],mi.prototype,"insertLink",null),pi([(0,Ko.v)(v.z_.INSERT_LINK,"shouldDisabled"),(0,oi.x)(ho.B.INSERT_LINK,"shouldDisabled"),(0,ii.z)(!1),fi("design:type",Function),fi("design:paramtypes",[]),fi("design:returntype",void 0)],mi.prototype,"getInsertLinkDisabledState",null),pi([(0,oi.x)(ho.B.INSERT_LINK,"shouldHide"),fi("design:type",Function),fi("design:paramtypes",[]),fi("design:returntype",void 0)],mi.prototype,"hideInsertLink",null),pi([(0,oi.x)(ho.B.INSERT_LINK,"content"),(0,ii.z)(O.ZP.t("链接")),fi("design:type",Function),fi("design:paramtypes",[]),fi("design:returntype",void 0)],mi.prototype,"getInsertLinkContent",null),mi=pi([(0,C.Q)({adapters:[Z.L],menuItems:ci,contextMenuItems:di}),hi(0,(0,S.aN)(ui)),fi("design:paramtypes",["function"===typeof(_i="undefined"!==typeof No.IDynamicLoader&&No.IDynamicLoader)?_i:Object])],mi);var vi,yi=n("../spread-sheet/src/external/view/ui-layer/insert-docLink/insert-docLink-controller.ts"),gi=[{name:v.z_.NEW_FILE,content:O.ZP.t("新建")},{name:v.z_.NEW_DOC,content:O.ZP.t("在线文档")},{name:v.z_.NEW_SHEET,content:O.ZP.t("在线表格")},{name:v.z_.NEW_SLIDE,content:O.ZP.t("在线幻灯片")},{name:v.z_.NEW_FORM,content:O.ZP.t("在线收集表")},{name:v.z_.NEW_MORE_TYPE,content:O.ZP.t("更多类型")},{name:v.z_.NEW_MIND_MAP,content:O.ZP.t("在线思维导图")},{name:v.z_.NEW_FLOWCHART,content:O.ZP.t("在线流程图")},{name:v.z_.NEW_BY_TEMPLATE,content:O.ZP.t("通过模板新建")}],Ei=n("../spread-sheet/src/external/view/ui-layer/new-file/new-file.interface.ts"),wi=function(e,t,n,r){var o,i=arguments.length,s=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},bi=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},Ti=function(e,t){return function(n,r){t(n,r,e)}},Ri=function(){function e(e){this.loader=e}var t=e.prototype;return t.newDoc=function(){this.newFileServicePC.newFile(Ei.$e.DOC)},t.newSheet=function(){this.newFileServicePC.newFile(Ei.$e.SHEET)},t.newSlide=function(){this.newFileServicePC.newFile(Ei.$e.SLIDE)},t.newFrom=function(){this.newFileServicePC.openTemplatePage(Ei.$e.FORM)},t.newMindMap=function(){this.newFileServicePC.newFile(Ei.$e.MIND_MAP)},t.newFlowchart=function(){this.newFileServicePC.newFile(Ei.$e.FLOWCHART)},t.newByTemplate=function(){this.newFileServicePC.openTemplatePage()},(0,Oo.Z)(e,[{key:"newFileServicePC",get:function(){return this.loader.instance}}]),e}();wi([(0,Ko.v)(v.z_.NEW_DOC,"onClick"),(0,ko.k)(),bi("design:type",Function),bi("design:paramtypes",[]),bi("design:returntype",void 0)],Ri.prototype,"newDoc",null),wi([(0,Ko.v)(v.z_.NEW_SHEET,"onClick"),(0,ko.k)(),bi("design:type",Function),bi("design:paramtypes",[]),bi("design:returntype",void 0)],Ri.prototype,"newSheet",null),wi([(0,Ko.v)(v.z_.NEW_SLIDE,"onClick"),(0,ko.k)(),bi("design:type",Function),bi("design:paramtypes",[]),bi("design:returntype",void 0)],Ri.prototype,"newSlide",null),wi([(0,Ko.v)(v.z_.NEW_FORM,"onClick"),(0,ko.k)(),bi("design:type",Function),bi("design:paramtypes",[]),bi("design:returntype",void 0)],Ri.prototype,"newFrom",null),wi([(0,Ko.v)(v.z_.NEW_MIND_MAP,"onClick"),(0,ko.k)(),bi("design:type",Function),bi("design:paramtypes",[]),bi("design:returntype",void 0)],Ri.prototype,"newMindMap",null),wi([(0,Ko.v)(v.z_.NEW_FLOWCHART,"onClick"),(0,ko.k)(),bi("design:type",Function),bi("design:paramtypes",[]),bi("design:returntype",void 0)],Ri.prototype,"newFlowchart",null),wi([(0,Ko.v)(v.z_.NEW_BY_TEMPLATE,"onClick"),(0,ko.k)(),bi("design:type",Function),bi("design:paramtypes",[]),bi("design:returntype",void 0)],Ri.prototype,"newByTemplate",null),Ri=wi([(0,C.Q)({adapters:[Z.L,B.dH],menuItems:gi}),Ti(0,(0,S.aN)(Ei.tj)),bi("design:paramtypes",["function"===typeof(vi="undefined"!==typeof No.IDynamicLoader&&No.IDynamicLoader)?vi:Object])],Ri);var Ii=[{name:v.z_.WATERMARK,content:O.ZP.t("设置水印"),sheetStatusMiddleware:{isHiddenWhenNotOwnerOfDocument:!0}}],Ci=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function s(e){try{c(r.next(e))}catch(t){i(t)}}function a(e){try{c(r.throw(e))}catch(t){i(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))},Ai=Symbol.for("feature:watermark");(0,qo.N)(Ai,(function(){return Ci(void 0,void 0,void 0,regeneratorRuntime.mark((function e(){var t,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([n.e("initial_chunk_part_2"),n.e("vendors-node_modules_tencent_docs-design-resources_pc_png_2x_cdn-function-export_js"),n.e("vendors-node_modules_tencent_docs-addon-sdk_lib_index_esm_js"),n.e("vendors-node_modules_tencent_docs-design-resources_pc_png_2x_cdn_js-node_modules_tencent_docs-70ebca"),n.e("vendors-node_modules_tencent_facade-config_dist_index_js"),n.e("vendors-node_modules_tencent_wedrive-component_dist_xdSaveDoc_css"),n.e("spread-sheet_src_base_util_decorator_loading-decorator_ts-spread-sheet_src_core_feature_copyP-33f189"),n.e("spread-sheet_src_core_view_level-2_condition-format-center_ui_utils_dataUtils_ts"),n.e("spread-sheet_src_core_workbench_common_base-drawer_tsx-spread-sheet_src_external_rangeAuth_ut-2939e0"),n.e("spread-sheet_src_core_view_level-2_chart_charts_chart-data-api_ts-spread-sheet_src_core_view_-9220ef"),n.e("spread-sheet_src_external_view_main_toolbar_IconBox_tsx"),n.e("spread-sheet_src_external_check-slr_sc-lazy-loader_ts-spread-sheet_src_external_templateinfo_-54b3ca"),n.e("spread-sheet_src_core_network_message-center_adapter_MessageCenterAdapter_interface_ts-spread-e88071"),n.e("spread-sheet_src_core_utils_gray_ts-spread-sheet_src_core_view_level-2_condition-format-cente-74d507"),n.e("spread-sheet_src_base_util_phone-number_ts-spread-sheet_src_core_feature_copyPaste_index_ts-s-89b53a"),n.e("spread-sheet_src_core_view_layout_pcView_ts"),n.e("spread-sheet_src_core_view_level-2_link-center_BaseLinkCenter_ts"),n.e("bundle_workbench_feature")]).then(n.bind(n,"../spread-sheet/src/external/view/ui-layer/watermark/watermark-feature.ts"));case 2:return t=e.sent,r=t.WatermarkFeature,e.abrupt("return",r);case 5:case"end":return e.stop()}}),e)})))}));var xi,Oi=function(e,t,n,r){var o,i=arguments.length,s=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},Ni=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},Si=function(e,t){return function(n,r){t(n,r,e)}},ki=function(){function e(e){this.loader=e}var t=e.prototype;return t.setWatermark=function(){this.watermarkFeature.toggleWatermark()},t.hideWatermark=function(){return!this.watermarkFeature.hasWatermark()},(0,Oo.Z)(e,[{key:"watermarkFeature",get:function(){return this.loader.instance}}]),e}();Oi([(0,Ko.v)(v.z_.WATERMARK,"onClick"),(0,ko.k)(),Ni("design:type",Function),Ni("design:paramtypes",[]),Ni("design:returntype",void 0)],ki.prototype,"setWatermark",null),Oi([(0,Ko.v)(v.z_.WATERMARK,"shouldHide"),(0,ii.z)(!1),Ni("design:type",Function),Ni("design:paramtypes",[]),Ni("design:returntype",void 0)],ki.prototype,"hideWatermark",null),ki=Oi([(0,C.Q)({adapters:[Z.L,B.dH],menuItems:Ii}),Si(0,(0,S.aN)(Ai)),Ni("design:paramtypes",["function"===typeof(xi="undefined"!==typeof No.IDynamicLoader&&No.IDynamicLoader)?xi:Object])],ki);var Pi=[{name:v.z_.ACCESSIBILITY,shortcut:{win:"Ctrl+~",mac:"⌃+~"}}],Di=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function s(e){try{c(r.next(e))}catch(t){i(t)}}function a(e){try{c(r.throw(e))}catch(t){i(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))},Li=Symbol.for("feature:Accessibility");(0,qo.N)(Li,(function(){return Di(void 0,void 0,void 0,regeneratorRuntime.mark((function e(){var t,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([n.e("initial_chunk_part_2"),n.e("vendors-node_modules_tencent_docs-design-resources_pc_png_2x_cdn-function-export_js"),n.e("vendors-node_modules_tencent_docs-addon-sdk_lib_index_esm_js"),n.e("vendors-node_modules_tencent_docs-design-resources_pc_png_2x_cdn_js-node_modules_tencent_docs-70ebca"),n.e("vendors-node_modules_tencent_facade-config_dist_index_js"),n.e("vendors-node_modules_tencent_wedrive-component_dist_xdSaveDoc_css"),n.e("spread-sheet_src_base_util_decorator_loading-decorator_ts-spread-sheet_src_core_feature_copyP-33f189"),n.e("spread-sheet_src_core_view_level-2_condition-format-center_ui_utils_dataUtils_ts"),n.e("spread-sheet_src_core_workbench_common_base-drawer_tsx-spread-sheet_src_external_rangeAuth_ut-2939e0"),n.e("spread-sheet_src_core_view_level-2_chart_charts_chart-data-api_ts-spread-sheet_src_core_view_-9220ef"),n.e("spread-sheet_src_external_view_main_toolbar_IconBox_tsx"),n.e("spread-sheet_src_external_check-slr_sc-lazy-loader_ts-spread-sheet_src_external_templateinfo_-54b3ca"),n.e("spread-sheet_src_core_network_message-center_adapter_MessageCenterAdapter_interface_ts-spread-e88071"),n.e("spread-sheet_src_core_utils_gray_ts-spread-sheet_src_core_view_level-2_condition-format-cente-74d507"),n.e("spread-sheet_src_base_util_phone-number_ts-spread-sheet_src_core_feature_copyPaste_index_ts-s-89b53a"),n.e("spread-sheet_src_core_view_layout_pcView_ts"),n.e("spread-sheet_src_core_view_level-2_link-center_BaseLinkCenter_ts"),n.e("bundle_workbench_feature")]).then(n.bind(n,"../spread-sheet/src/external/view/ui-layer/accessibility/accessibility-feature.ts"));case 2:return t=e.sent,r=t.AccessibilityFeature,e.abrupt("return",r);case 5:case"end":return e.stop()}}),e)})))}));var Mi,Fi=function(e,t,n,r){var o,i=arguments.length,s=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},ji=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},Hi=function(e,t){return function(n,r){t(n,r,e)}},Zi=function(){function e(e){this.loader=e}var t=e.prototype;return t.setAccessibility=function(){this.accessibilityFeature.handleClick()},t.getContent=function(){return this.accessibilityFeature.getContent()},(0,Oo.Z)(e,[{key:"accessibilityFeature",get:function(){return this.loader.instance}}]),e}();Fi([(0,Ko.v)(v.z_.ACCESSIBILITY,"onClick"),(0,ko.k)(),ji("design:type",Function),ji("design:paramtypes",[]),ji("design:returntype",void 0)],Zi.prototype,"setAccessibility",null),Fi([(0,Ko.v)(v.z_.ACCESSIBILITY,"content"),(0,ko.k)(),ji("design:type",Function),ji("design:paramtypes",[]),ji("design:returntype",void 0)],Zi.prototype,"getContent",null),Zi=Fi([(0,C.Q)({adapters:[Z.L],menuItems:Pi}),Hi(0,(0,S.aN)(Li)),ji("design:paramtypes",["function"===typeof(Mi="undefined"!==typeof No.IDynamicLoader&&No.IDynamicLoader)?Mi:Object])],Zi);var Bi=[{name:v.z_.HELP_AND_FEEDBACK,content:O.ZP.t("帮助与反馈"),preventDismiss:!0},{name:v.z_.HOT_KEY,content:O.ZP.t("快捷键")},{name:v.z_.HELP,content:O.ZP.t("帮助中心")},{name:v.z_.FEEDBACK,content:O.ZP.t("反馈")},{name:v.z_.REPORT,content:O.ZP.t("举报")},{name:v.z_.INFRINGEMENT_GUIDE,content:O.ZP.t("侵权指引")},{name:v.z_.ABOUT,content:O.ZP.t("功能介绍")},{name:v.z_.COMMUNITY_CONVENTION,content:O.ZP.t("平台公约")},{name:v.z_.APPEAL,content:O.ZP.t("受限文档申诉")},{name:v.z_.COMPLAIN,content:O.ZP.t("投诉")}],zi=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function s(e){try{c(r.next(e))}catch(t){i(t)}}function a(e){try{c(r.throw(e))}catch(t){i(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))},Ui=Symbol.for("feature:help-and-feedback");(0,qo.N)(Ui,(function(){return zi(void 0,void 0,void 0,regeneratorRuntime.mark((function e(){var t,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([n.e("initial_chunk_part_2"),n.e("vendors-node_modules_tencent_docs-design-resources_pc_png_2x_cdn-function-export_js"),n.e("vendors-node_modules_tencent_docs-addon-sdk_lib_index_esm_js"),n.e("vendors-node_modules_tencent_docs-design-resources_pc_png_2x_cdn_js-node_modules_tencent_docs-70ebca"),n.e("vendors-node_modules_tencent_facade-config_dist_index_js"),n.e("vendors-node_modules_tencent_wedrive-component_dist_xdSaveDoc_css"),n.e("spread-sheet_src_base_util_decorator_loading-decorator_ts-spread-sheet_src_core_feature_copyP-33f189"),n.e("spread-sheet_src_core_view_level-2_condition-format-center_ui_utils_dataUtils_ts"),n.e("spread-sheet_src_core_workbench_common_base-drawer_tsx-spread-sheet_src_external_rangeAuth_ut-2939e0"),n.e("spread-sheet_src_core_view_level-2_chart_charts_chart-data-api_ts-spread-sheet_src_core_view_-9220ef"),n.e("spread-sheet_src_external_view_main_toolbar_IconBox_tsx"),n.e("spread-sheet_src_external_check-slr_sc-lazy-loader_ts-spread-sheet_src_external_templateinfo_-54b3ca"),n.e("spread-sheet_src_core_network_message-center_adapter_MessageCenterAdapter_interface_ts-spread-e88071"),n.e("spread-sheet_src_core_utils_gray_ts-spread-sheet_src_core_view_level-2_condition-format-cente-74d507"),n.e("spread-sheet_src_base_util_phone-number_ts-spread-sheet_src_core_feature_copyPaste_index_ts-s-89b53a"),n.e("spread-sheet_src_core_view_layout_pcView_ts"),n.e("spread-sheet_src_core_view_level-2_link-center_BaseLinkCenter_ts"),n.e("bundle_workbench_feature")]).then(n.bind(n,"../spread-sheet/src/external/view/ui-layer/help-and-feedback/help-and-feedback-feature.ts"));case 2:return t=e.sent,r=t.HelpAndFeedbackFeature,e.abrupt("return",r);case 5:case"end":return e.stop()}}),e)})))}));var Vi,Wi=function(e,t,n,r){var o,i=arguments.length,s=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},Gi=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},Yi=function(e,t){return function(n,r){t(n,r,e)}},Ki=function(){function e(e){this.loader=e}var t=e.prototype;return t.handleClickHotKey=function(){this.helpAndFeedbackFeature.toHotKey()},t.handleClickHelp=function(){this.helpAndFeedbackFeature.toHelp()},t.getFeedbackContent=function(){return this.helpAndFeedbackFeature.getFeedbackContent()},t.handleClickFeedback=function(){this.helpAndFeedbackFeature.toFeedback()},t.handleClickReport=function(){this.helpAndFeedbackFeature.toReport()},t.handleClickInf=function(){this.helpAndFeedbackFeature.toInfringementGuide()},t.handleClickAbout=function(){this.helpAndFeedbackFeature.toAbout()},t.handleClickCommunityConvention=function(){this.helpAndFeedbackFeature.toCommunityConvention()},t.handleClick=function(){this.helpAndFeedbackFeature.toAppeal()},t.hideAppeal=function(){return this.helpAndFeedbackFeature.notAppeal()},t.handleClickComplain=function(){this.helpAndFeedbackFeature.toComplain()},t.hideComplain=function(){return this.helpAndFeedbackFeature.hideComplian()},(0,Oo.Z)(e,[{key:"helpAndFeedbackFeature",get:function(){return this.loader.instance}}]),e}();Wi([(0,Ko.v)(v.z_.HOT_KEY,"onClick"),Gi("design:type",Function),Gi("design:paramtypes",[]),Gi("design:returntype",void 0)],Ki.prototype,"handleClickHotKey",null),Wi([(0,Ko.v)(v.z_.HELP,"onClick"),(0,ko.k)(),Gi("design:type",Function),Gi("design:paramtypes",[]),Gi("design:returntype",void 0)],Ki.prototype,"handleClickHelp",null),Wi([(0,Ko.v)(v.z_.FEEDBACK,"content"),Gi("design:type",Function),Gi("design:paramtypes",[]),Gi("design:returntype",void 0)],Ki.prototype,"getFeedbackContent",null),Wi([(0,Ko.v)(v.z_.FEEDBACK,"onClick"),(0,ko.k)(),Gi("design:type",Function),Gi("design:paramtypes",[]),Gi("design:returntype",void 0)],Ki.prototype,"handleClickFeedback",null),Wi([(0,Ko.v)(v.z_.REPORT,"onClick"),(0,ko.k)(),Gi("design:type",Function),Gi("design:paramtypes",[]),Gi("design:returntype",void 0)],Ki.prototype,"handleClickReport",null),Wi([(0,Ko.v)(v.z_.INFRINGEMENT_GUIDE,"onClick"),(0,ko.k)(),Gi("design:type",Function),Gi("design:paramtypes",[]),Gi("design:returntype",void 0)],Ki.prototype,"handleClickInf",null),Wi([(0,Ko.v)(v.z_.ABOUT,"onClick"),(0,ko.k)(),Gi("design:type",Function),Gi("design:paramtypes",[]),Gi("design:returntype",void 0)],Ki.prototype,"handleClickAbout",null),Wi([(0,Ko.v)(v.z_.COMMUNITY_CONVENTION,"onClick"),(0,ko.k)(),Gi("design:type",Function),Gi("design:paramtypes",[]),Gi("design:returntype",void 0)],Ki.prototype,"handleClickCommunityConvention",null),Wi([(0,Ko.v)(v.z_.APPEAL,"onClick"),(0,ko.k)(),Gi("design:type",Function),Gi("design:paramtypes",[]),Gi("design:returntype",void 0)],Ki.prototype,"handleClick",null),Wi([(0,Ko.v)(v.z_.APPEAL,"shouldHide"),(0,ii.z)(!0),Gi("design:type",Function),Gi("design:paramtypes",[]),Gi("design:returntype",void 0)],Ki.prototype,"hideAppeal",null),Wi([(0,Ko.v)(v.z_.COMPLAIN,"onClick"),(0,ko.k)(),Gi("design:type",Function),Gi("design:paramtypes",[]),Gi("design:returntype",void 0)],Ki.prototype,"handleClickComplain",null),Wi([(0,Ko.v)(v.z_.COMPLAIN,"shouldHide"),(0,ii.z)(!0),Gi("design:type",Function),Gi("design:paramtypes",[]),Gi("design:returntype",void 0)],Ki.prototype,"hideComplain",null),Ki=Wi([(0,C.Q)({adapters:[Z.L,B.dH],menuItems:Bi}),Yi(0,(0,S.aN)(Ui)),Gi("design:paramtypes",["function"===typeof(Vi="undefined"!==typeof No.IDynamicLoader&&No.IDynamicLoader)?Vi:Object])],Ki);var Xi,qi,Qi=n("../node_modules/@tencent/workbench/lib/esm/decorators/param/action-point-info.js"),$i=n("../node_modules/@tencent/workbench/lib/esm/decorators/method/keymap.js"),Ji=n("../node_modules/@tencent/docs-keymap/lib/esm/index.js"),es=n("../spread-sheet/src/external/view/schema/key-map-schema.ts"),ts=[{name:m.HM.FORMAT_PAINTER,icon:A.createElement("div",{className:"icon-svg-toolbar_matchprop"}),sheetStatusMiddleware:{isDisabledWhenCannotEdit:!0},inputStatusMiddleWareConfig:{isDisableWhenInput:!0}}],ns=[{name:es.U.FORMAT_PAINTER_ESC,keyBindings:{win:[Ji.VD.ESCAPE],mac:[Ji.VD.ESCAPE]},shouldPreventDefault:!0}],rs=n("../spread-sheet/src/external/view/ui-layer/format-painter/format-painter-feature.interface.ts"),os=function(e,t,n,r){var o,i=arguments.length,s=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},is=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},ss=function(e,t){return function(n,r){t(n,r,e)}},as=function(){function e(e){this.loader=e}var t=e.prototype;return t.setFormatPainter=function(e){if(this.formatPainterFeature.status)this.formatPainterFeature.exit();else{var t="onClick"===e.trigger?rs.mN.SINGLE:rs.mN.INFINITE;this.formatPainterFeature.enter(t)}this.report()},t.exitFormatPainter=function(){this.formatPainterFeature.exit()},t.getFormatPainterTooltip=function(){return this.formatPainterFeature.getTooltip()},t.getFormatPainterIsChecked=function(){return this.formatPainterFeature.status},t.report=function(){oe.ZP.tdwReport({opername:"doc_excel_editor",module:"excel_tool",action:"clk_brush",ver12:"new"})},(0,Oo.Z)(e,[{key:"formatPainterFeature",get:function(){return this.loader.instance}}]),e}();os([(0,So.o)(m.HM.FORMAT_PAINTER,"onClick"),(0,So.o)(m.HM.FORMAT_PAINTER,"onDoubleClick"),(0,ko.k)(),ss(0,(0,Qi.g)()),is("design:type",Function),is("design:paramtypes",["function"===typeof(Xi="undefined"!==typeof No.IActionPointInfo&&No.IActionPointInfo)?Xi:Object]),is("design:returntype",void 0)],as.prototype,"setFormatPainter",null),os([(0,$i.N)(es.U.FORMAT_PAINTER_ESC,"onPress"),(0,ko.k)(),is("design:type",Function),is("design:paramtypes",[]),is("design:returntype",void 0)],as.prototype,"exitFormatPainter",null),os([(0,So.o)(m.HM.FORMAT_PAINTER,"tooltip"),(0,ii.z)(O.ZP.t("格式刷，双击可重复使用")),is("design:type",Function),is("design:paramtypes",[]),is("design:returntype",void 0)],as.prototype,"getFormatPainterTooltip",null),os([(0,So.o)(m.HM.FORMAT_PAINTER,"shouldCheck"),(0,ii.z)(!1),is("design:type",Function),is("design:paramtypes",[]),is("design:returntype",void 0)],as.prototype,"getFormatPainterIsChecked",null),as=os([(0,C.Q)({adapters:[Z.L],toolbarItems:ts,keymapConfigs:ns}),ss(0,(0,S.aN)(rs.qP)),is("design:paramtypes",["function"===typeof(qi="undefined"!==typeof No.IDynamicLoader&&No.IDynamicLoader)?qi:Object])],as);var cs=n("../spread-sheet/src/external/view/ui-layer/clear/clear-controller.ts"),ds=n("../node_modules/@tencent/docs-design-resources/pc/png@2x/cdn.js"),ls=n("../spread-sheet/src/external/view/common/components/design-guide/index.tsx"),us={content:O.ZP.t("ui|smart split for view"),title:O.ZP.t("智能分列"),imageUrl:ds.Z["toolbar_preview_smartsorting@2x"],guideSize:ls.F.MEDIUM},_s=[{name:v.z_.SMART_SPLIT,content:x().createElement(N.default,{trigger:"hover",overlayStyle:{padding:0},placement:"left",containerOffsetY:120,containerOffsetX:-10,title:(0,ls.M)(us)},x().createElement("div",null,O.ZP.t("智能分列"))),selectionMiddleware:{exclude:[ai.R.SHAPE,ai.R.CHART]}}],ps=[{name:ho.B.SMART_SPLIT,content:O.ZP.t("智能分列"),selectionMiddleware:{exclude:[ai.R.SHAPE,ai.R.CHART]},sheetStatusMiddleware:{isHiddenWhenCannotEdit:!0},privateFillMiddleWareConfig:{shouldCheckWhenCellIsPrivate:!0}}],fs=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function s(e){try{c(r.next(e))}catch(t){i(t)}}function a(e){try{c(r.throw(e))}catch(t){i(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))},hs=Symbol.for("feature:smart-split");(0,qo.N)(hs,(function(){return fs(void 0,void 0,void 0,regeneratorRuntime.mark((function e(){var t,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([n.e("initial_chunk_part_2"),n.e("vendors-node_modules_tencent_docs-design-resources_pc_png_2x_cdn-function-export_js"),n.e("vendors-node_modules_tencent_docs-addon-sdk_lib_index_esm_js"),n.e("vendors-node_modules_tencent_docs-design-resources_pc_png_2x_cdn_js-node_modules_tencent_docs-70ebca"),n.e("vendors-node_modules_tencent_facade-config_dist_index_js"),n.e("vendors-node_modules_tencent_wedrive-component_dist_xdSaveDoc_css"),n.e("spread-sheet_src_base_util_decorator_loading-decorator_ts-spread-sheet_src_core_feature_copyP-33f189"),n.e("spread-sheet_src_core_view_level-2_condition-format-center_ui_utils_dataUtils_ts"),n.e("spread-sheet_src_core_workbench_common_base-drawer_tsx-spread-sheet_src_external_rangeAuth_ut-2939e0"),n.e("spread-sheet_src_core_view_level-2_chart_charts_chart-data-api_ts-spread-sheet_src_core_view_-9220ef"),n.e("spread-sheet_src_external_view_main_toolbar_IconBox_tsx"),n.e("spread-sheet_src_external_check-slr_sc-lazy-loader_ts-spread-sheet_src_external_templateinfo_-54b3ca"),n.e("spread-sheet_src_core_network_message-center_adapter_MessageCenterAdapter_interface_ts-spread-e88071"),n.e("spread-sheet_src_core_utils_gray_ts-spread-sheet_src_core_view_level-2_condition-format-cente-74d507"),n.e("spread-sheet_src_base_util_phone-number_ts-spread-sheet_src_core_feature_copyPaste_index_ts-s-89b53a"),n.e("spread-sheet_src_core_view_layout_pcView_ts"),n.e("spread-sheet_src_core_view_level-2_link-center_BaseLinkCenter_ts"),n.e("bundle_workbench_feature")]).then(n.bind(n,"../spread-sheet/src/external/view/ui-layer/smart-split/smart-split-feature.ts"));case 2:return t=e.sent,r=t.SmartSplitFeature,e.abrupt("return",r);case 5:case"end":return e.stop()}}),e)})))}));var ms,vs,ys=function(e,t,n,r){var o,i=arguments.length,s=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},gs=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},Es=function(e,t){return function(n,r){t(n,r,e)}},ws=function(){function e(e){this.loader=e}return e.prototype.handleSmartSplit=function(e){this.smartSplitFeature.smartSplit(e)},(0,Oo.Z)(e,[{key:"smartSplitFeature",get:function(){return this.loader.instance}}]),e}();ys([(0,oi.x)(ho.B.SMART_SPLIT,"onClick"),(0,Ko.v)(v.z_.SMART_SPLIT,"onClick"),(0,ko.k)(),Es(0,(0,Qi.g)()),gs("design:type",Function),gs("design:paramtypes",["function"===typeof(ms="undefined"!==typeof No.IActionPointInfo&&No.IActionPointInfo)?ms:Object]),gs("design:returntype",void 0)],ws.prototype,"handleSmartSplit",null),ws=ys([(0,C.Q)({adapters:[Z.L],contextMenuItems:ps,menuItems:_s}),Es(0,(0,S.aN)(hs)),gs("design:paramtypes",["function"===typeof(vs="undefined"!==typeof No.IDynamicLoader&&No.IDynamicLoader)?vs:Object])],ws);var bs,Ts=[{name:v.z_.DATA,content:""}],Rs=[{name:m.HM.DATA,icon:A.createElement("div",{className:"icon-svg-toolbar-data-validation"}),text:O.ZP.t("数据"),tooltip:O.ZP.t("数据"),type:"text",style:{width:"auto"},sheetStatusMiddleware:{isDisabledWhenCannotEdit:!0},inputStatusMiddleWareConfig:{isDisableWhenInput:!0},privateFillMiddleWareConfig:{shouldCheckWhenCellIsPrivate:!0}},{name:m.HM.DATA_GROUP,hasArrow:!0,type:"text",icon:A.createElement("div",{className:"icon-svg-toolbar-data-validation"}),text:O.ZP.t("数据"),tooltip:O.ZP.t("数据"),shouldVerticallyArrange:!0,dropdownAlignment:"left"}],Is=function(e,t,n,r){var o,i=arguments.length,s=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},Cs=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},As=function(){function e(e){this.toolbarModeFeature=e}var t=e.prototype;return t.dataDropdown=function(){return A.createElement(Qn.l,{align:"left",name:v.z_.DATA,mode:"menu",itemStyle:{width:166}})},t.shouldVerticallyArrange=function(){return this.toolbarModeFeature.getToolbarMode()===ro.ToolbarModeOrders.DOUBLE_LINE_TOOLBAR},e}();Is([(0,So.o)(m.HM.DATA,"dropdownContent"),Cs("design:type",Function),Cs("design:paramtypes",[]),Cs("design:returntype",void 0)],As.prototype,"dataDropdown",null),Is([(0,So.o)(m.HM.DATA,"shouldVerticallyArrange"),Cs("design:type",Function),Cs("design:paramtypes",[]),Cs("design:returntype",void 0)],As.prototype,"shouldVerticallyArrange",null),As=Is([(0,C.Q)({adapters:[Z.L],toolbarItems:Rs,menuItems:Ts}),Cs("design:paramtypes",["function"===typeof(bs="undefined"!==typeof no.ToolbarModeFeature&&no.ToolbarModeFeature)?bs:Object])],As);var xs=n("../spread-sheet/src/core/view/level-2/condition-format-center/ui/rulesContainer/RulesContainer.tsx"),Os=[{name:v.z_.CONDITION_FORMAT,content:O.ZP.t("条件格式"),description:O.ZP.t("重复值")},{name:v.z_.OTHER_CONDITION_FORMAT,content:O.ZP.t("其他条件格式")},{name:v.z_.MANAGE_CONDITION_FORMAT,content:O.ZP.t("管理条件格式")},{name:v.z_.HIGHLIGHT_REPEAT,content:O.ZP.t("高亮重复值")}],Ns=n("../packages/model/src/rule/index.ts"),Ss=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function s(e){try{c(r.next(e))}catch(t){i(t)}}function a(e){try{c(r.throw(e))}catch(t){i(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))},ks=Symbol.for("feature:condition-format");(0,qo.N)(ks,(function(){return Ss(void 0,void 0,void 0,regeneratorRuntime.mark((function e(){var t,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([n.e("initial_chunk_part_2"),n.e("vendors-node_modules_tencent_docs-design-resources_pc_png_2x_cdn-function-export_js"),n.e("vendors-node_modules_tencent_docs-addon-sdk_lib_index_esm_js"),n.e("vendors-node_modules_tencent_docs-design-resources_pc_png_2x_cdn_js-node_modules_tencent_docs-70ebca"),n.e("vendors-node_modules_tencent_facade-config_dist_index_js"),n.e("vendors-node_modules_tencent_wedrive-component_dist_xdSaveDoc_css"),n.e("spread-sheet_src_base_util_decorator_loading-decorator_ts-spread-sheet_src_core_feature_copyP-33f189"),n.e("spread-sheet_src_core_view_level-2_condition-format-center_ui_utils_dataUtils_ts"),n.e("spread-sheet_src_core_workbench_common_base-drawer_tsx-spread-sheet_src_external_rangeAuth_ut-2939e0"),n.e("spread-sheet_src_core_view_level-2_chart_charts_chart-data-api_ts-spread-sheet_src_core_view_-9220ef"),n.e("spread-sheet_src_external_view_main_toolbar_IconBox_tsx"),n.e("spread-sheet_src_external_check-slr_sc-lazy-loader_ts-spread-sheet_src_external_templateinfo_-54b3ca"),n.e("spread-sheet_src_core_network_message-center_adapter_MessageCenterAdapter_interface_ts-spread-e88071"),n.e("spread-sheet_src_core_utils_gray_ts-spread-sheet_src_core_view_level-2_condition-format-cente-74d507"),n.e("spread-sheet_src_base_util_phone-number_ts-spread-sheet_src_core_feature_copyPaste_index_ts-s-89b53a"),n.e("spread-sheet_src_core_view_layout_pcView_ts"),n.e("spread-sheet_src_core_view_level-2_link-center_BaseLinkCenter_ts"),n.e("bundle_workbench_feature")]).then(n.bind(n,"../spread-sheet/src/external/view/ui-layer/condition-format/condition-format-feature.ts"));case 2:return t=e.sent,r=t.ConditionFormatFeature,e.abrupt("return",r);case 5:case"end":return e.stop()}}),e)})))}));var Ps,Ds=function(e,t,n,r){var o,i=arguments.length,s=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},Ls=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},Ms=function(e,t){return function(n,r){t(n,r,e)}},Fs=function(){function e(e){this.loader=e}var t=e.prototype;return t.handleConditionFormat=function(){this.conditionFormatFeature.showPanel({conditionType:Ns.CONDITION_TYPE.REPEAT})},t.handleOtherConditionFormat=function(){this.conditionFormatFeature.showPanel({conditionType:Ns.CONDITION_TYPE.NUMBER_GREATER})},t.handleManageConditionFormat=function(){this.conditionFormatFeature.showPanel({panelState:xs.k.MANAGER})},t.handleHighlightRepeat=function(){this.conditionFormatFeature.showPanel({conditionType:Ns.CONDITION_TYPE.REPEAT})},(0,Oo.Z)(e,[{key:"conditionFormatFeature",get:function(){return this.loader.instance}}]),e}();Ds([(0,Ko.v)(v.z_.CONDITION_FORMAT,"onClick"),(0,ko.k)(),Ls("design:type",Function),Ls("design:paramtypes",[]),Ls("design:returntype",void 0)],Fs.prototype,"handleConditionFormat",null),Ds([(0,Ko.v)(v.z_.OTHER_CONDITION_FORMAT,"onClick"),(0,ko.k)(),Ls("design:type",Function),Ls("design:paramtypes",[]),Ls("design:returntype",void 0)],Fs.prototype,"handleOtherConditionFormat",null),Ds([(0,Ko.v)(v.z_.MANAGE_CONDITION_FORMAT,"onClick"),(0,ko.k)(),Ls("design:type",Function),Ls("design:paramtypes",[]),Ls("design:returntype",void 0)],Fs.prototype,"handleManageConditionFormat",null),Ds([(0,Ko.v)(v.z_.HIGHLIGHT_REPEAT,"onClick"),(0,ko.k)(),Ls("design:type",Function),Ls("design:paramtypes",[]),Ls("design:returntype",void 0)],Fs.prototype,"handleHighlightRepeat",null),Fs=Ds([(0,C.Q)({adapters:[Z.L],menuItems:Os}),Ms(0,(0,S.aN)(ks)),Ls("design:paramtypes",["function"===typeof(Ps="undefined"!==typeof No.IDynamicLoader&&No.IDynamicLoader)?Ps:Object])],Fs);var js=n("../spread-sheet/src/external/view/ui-layer/range-auth/config.tsx"),Hs=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function s(e){try{c(r.next(e))}catch(t){i(t)}}function a(e){try{c(r.throw(e))}catch(t){i(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))},Zs=Symbol.for("feature:range-auth");(0,qo.N)(Zs,(function(){return Hs(void 0,void 0,void 0,regeneratorRuntime.mark((function e(){var t,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([n.e("initial_chunk_part_2"),n.e("vendors-node_modules_tencent_docs-design-resources_pc_png_2x_cdn-function-export_js"),n.e("vendors-node_modules_tencent_docs-addon-sdk_lib_index_esm_js"),n.e("vendors-node_modules_tencent_docs-design-resources_pc_png_2x_cdn_js-node_modules_tencent_docs-70ebca"),n.e("vendors-node_modules_tencent_facade-config_dist_index_js"),n.e("vendors-node_modules_tencent_wedrive-component_dist_xdSaveDoc_css"),n.e("spread-sheet_src_base_util_decorator_loading-decorator_ts-spread-sheet_src_core_feature_copyP-33f189"),n.e("spread-sheet_src_core_view_level-2_condition-format-center_ui_utils_dataUtils_ts"),n.e("spread-sheet_src_core_workbench_common_base-drawer_tsx-spread-sheet_src_external_rangeAuth_ut-2939e0"),n.e("spread-sheet_src_core_view_level-2_chart_charts_chart-data-api_ts-spread-sheet_src_core_view_-9220ef"),n.e("spread-sheet_src_external_view_main_toolbar_IconBox_tsx"),n.e("spread-sheet_src_external_check-slr_sc-lazy-loader_ts-spread-sheet_src_external_templateinfo_-54b3ca"),n.e("spread-sheet_src_core_network_message-center_adapter_MessageCenterAdapter_interface_ts-spread-e88071"),n.e("spread-sheet_src_core_utils_gray_ts-spread-sheet_src_core_view_level-2_condition-format-cente-74d507"),n.e("spread-sheet_src_base_util_phone-number_ts-spread-sheet_src_core_feature_copyPaste_index_ts-s-89b53a"),n.e("spread-sheet_src_core_view_layout_pcView_ts"),n.e("spread-sheet_src_core_view_level-2_link-center_BaseLinkCenter_ts"),n.e("bundle_workbench_feature")]).then(n.bind(n,"../spread-sheet/src/external/view/ui-layer/range-auth/range-auth-feature.ts"));case 2:return t=e.sent,r=t.RangeAuthFeature,e.abrupt("return",r);case 5:case"end":return e.stop()}}),e)})))}));var Bs,zs=function(e,t,n,r){var o,i=arguments.length,s=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},Us=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},Vs=function(e,t){return function(n,r){t(n,r,e)}},Ws=function(){function e(e){this.loader=e}var t=e.prototype;return t.listRangeAuth=function(){return this.rangeAuthFeature.getContext()},t.shouldHideListRangeAuthAll=function(){return!this.rangeAuthFeature.userIsOwner()},t.shouldHideRangeAuth=function(){return!this.rangeAuthFeature.userIsOwner()||!this.rangeAuthFeature.checkIfRangeProtected()&&!this.rangeAuthFeature.checkIfCurrentSheetProtected()},t.shouldDisabledListRangeAuthAll=function(){var e=this.rangeAuthFeature.getRangeAuthList();return!e||0===e.size},t.showRangeAuthListAll=function(){this.rangeAuthFeature.showProtectedRange(js.VY.TOOLBAR)},t.showRangeAuthList=function(){this.rangeAuthFeature.showProtectedRange(js.VY.CONTEXT_MENU)},(0,Oo.Z)(e,[{key:"rangeAuthFeature",get:function(){return this.loader.instance}}]),e}();zs([(0,oi.x)(ho.B.PROTECTED_RANGE_LIST,"content"),(0,ii.z)(O.ZP.t("查看已保护范围")),Us("design:type",Function),Us("design:paramtypes",[]),Us("design:returntype",void 0)],Ws.prototype,"listRangeAuth",null),zs([(0,Ko.v)(v.z_.RANGE_AUTH_CHECK_ALL,"shouldHide"),(0,ii.z)(!1),Us("design:type",Function),Us("design:paramtypes",[]),Us("design:returntype",void 0)],Ws.prototype,"shouldHideListRangeAuthAll",null),zs([(0,oi.x)(ho.B.PROTECTED_RANGE_LIST,"shouldHide"),(0,ii.z)(!0),Us("design:type",Function),Us("design:paramtypes",[]),Us("design:returntype",void 0)],Ws.prototype,"shouldHideRangeAuth",null),zs([(0,Ko.v)(v.z_.RANGE_AUTH_CHECK_ALL,"shouldDisabled"),(0,ii.z)(!0),Us("design:type",Function),Us("design:paramtypes",[]),Us("design:returntype",void 0)],Ws.prototype,"shouldDisabledListRangeAuthAll",null),zs([(0,Ko.v)(v.z_.RANGE_AUTH_CHECK_ALL,"onClick"),(0,ko.k)(),Us("design:type",Function),Us("design:paramtypes",[]),Us("design:returntype",void 0)],Ws.prototype,"showRangeAuthListAll",null),zs([(0,oi.x)(ho.B.PROTECTED_RANGE_LIST,"onClick"),(0,ko.k)(),Us("design:type",Function),Us("design:paramtypes",[]),Us("design:returntype",void 0)],Ws.prototype,"showRangeAuthList",null),Ws=zs([(0,C.Q)({adapters:[Z.L],menuItems:js.kt,contextMenuItems:js.bM}),Vs(0,(0,S.aN)(Zs)),Us("design:paramtypes",["function"===typeof(Bs="undefined"!==typeof No.IDynamicLoader&&No.IDynamicLoader)?Bs:Object])],Ws);var Gs,Ys,Ks,Xs=n("../node_modules/@tencent/workbench/lib/esm/constants/service-name.js"),qs=n("../spread-sheet/src/external/view/ui-layer/common-loading.tsx"),Qs=function(e,t,n,r){var o,i=arguments.length,s=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},$s=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},Js=function(e,t){return function(n,r){t(n,r,e)}},ea=function(){function e(e,t){this.toolbarModeFeature=e,this.loader=t}var t=e.prototype;return t.protectSelectedRangeContent=function(){var e=this.rangeAuthFeature.getSelectedRange();return e?O.ZP.t("保护所选范围{{value}}",{value:""+(e.text||O.ZP.t("范围"))}):""},t.protectRangeAll=function(e){var t=e.from===Xs.v.MENU?js.VY.TOOLBAR:js.VY.CONTEXT_MENU;this.rangeAuthFeature.protectRange(js.OQ.PROTECT_RANGE,t)},t.renderSelectList=function(){return x().createElement(Qn.l,{align:"left",name:v.z_.RANGE_AUTH,mode:"menu"})},t.shouldHide=function(){return!this.rangeAuthFeature.userIsOwner()},t.shouldDisabledWhenNotOwner=function(){return!F.q.getConfig("isOwner")},t.shouldVerticallyArrange=function(){return this.toolbarModeFeature.getToolbarMode()===ro.ToolbarModeOrders.DOUBLE_LINE_TOOLBAR},t.text=function(){return this.toolbarModeFeature.getToolbarMode()===ro.ToolbarModeOrders.DOUBLE_LINE_TOOLBAR?O.ZP.t("ui|toolbar.protect"):""},(0,Oo.Z)(e,[{key:"rangeAuthFeature",get:function(){return this.loader.instance}}]),e}();Qs([(0,Ko.v)(v.z_.RANGE_AUTH_PROTECT_RANGE,"content"),(0,oi.x)(ho.B.PROTECT_SELECTED_RANGE,"content"),(0,ii.z)(O.ZP.t("保护所选范围")),$s("design:type",Function),$s("design:paramtypes",[]),$s("design:returntype",void 0)],ea.prototype,"protectSelectedRangeContent",null),Qs([(0,Ko.v)(v.z_.RANGE_AUTH_PROTECT_RANGE,"onClick"),(0,oi.x)(ho.B.PROTECT_SELECTED_RANGE,"onClick"),(0,ko.k)(),Js(0,(0,Qi.g)()),$s("design:type",Function),$s("design:paramtypes",["function"===typeof(Gs="undefined"!==typeof No.IActionPointInfo&&No.IActionPointInfo)?Gs:Object]),$s("design:returntype",void 0)],ea.prototype,"protectRangeAll",null),Qs([(0,So.o)(m.HM.RANGE_AUTH,"dropdownContent"),(0,ko.k)(qs.P),$s("design:type",Function),$s("design:paramtypes",[]),$s("design:returntype",void 0)],ea.prototype,"renderSelectList",null),Qs([(0,Ko.v)(v.z_.RANGE_AUTH_PROTECT_RANGE,"shouldHide"),(0,oi.x)(ho.B.PROTECT_SELECTED_RANGE,"shouldHide"),(0,ii.z)(!1),$s("design:type",Function),$s("design:paramtypes",[]),$s("design:returntype",void 0)],ea.prototype,"shouldHide",null),Qs([(0,So.o)(m.HM.RANGE_AUTH,"shouldDisabled"),$s("design:type",Function),$s("design:paramtypes",[]),$s("design:returntype",void 0)],ea.prototype,"shouldDisabledWhenNotOwner",null),Qs([(0,So.o)(m.HM.RANGE_AUTH,"shouldVerticallyArrange"),$s("design:type",Function),$s("design:paramtypes",[]),$s("design:returntype",void 0)],ea.prototype,"shouldVerticallyArrange",null),Qs([(0,So.o)(m.HM.RANGE_AUTH,"text"),$s("design:type",Function),$s("design:paramtypes",[]),$s("design:returntype",void 0)],ea.prototype,"text",null),ea=Qs([(0,C.Q)({adapters:[Z.L],menuItems:js.eG,contextMenuItems:js.dg,toolbarItems:js.oz}),Js(1,(0,S.aN)(Zs)),$s("design:paramtypes",["function"===typeof(Ys="undefined"!==typeof no.ToolbarModeFeature&&no.ToolbarModeFeature)?Ys:Object,"function"===typeof(Ks="undefined"!==typeof No.IDynamicLoader&&No.IDynamicLoader)?Ks:Object])],ea);var ta,na=function(e,t,n,r){var o,i=arguments.length,s=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},ra=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},oa=function(e,t){return function(n,r){t(n,r,e)}},ia=function(){function e(e){this.loader=e}var t=e.prototype;return t.protectSheet=function(){this.rangeAuthFeature.protectRange(js.OQ.PROTECT_SHEET,js.VY.TOOLBAR)},t.shouldHideProtectSheet=function(){return!this.rangeAuthFeature.userIsOwner()},(0,Oo.Z)(e,[{key:"rangeAuthFeature",get:function(){return this.loader.instance}}]),e}();na([(0,Ko.v)(v.z_.RANGE_AUTH_PROTECT_SHEET,"onClick"),(0,ko.k)(),ra("design:type",Function),ra("design:paramtypes",[]),ra("design:returntype",void 0)],ia.prototype,"protectSheet",null),na([(0,Ko.v)(v.z_.RANGE_AUTH_PROTECT_SHEET,"shouldHide"),(0,ii.z)(!1),ra("design:type",Function),ra("design:paramtypes",[]),ra("design:returntype",void 0)],ia.prototype,"shouldHideProtectSheet",null),ia=na([(0,C.Q)({adapters:[Z.L],menuItems:js.G_}),oa(0,(0,S.aN)(Zs)),ra("design:paramtypes",["function"===typeof(ta="undefined"!==typeof No.IDynamicLoader&&No.IDynamicLoader)?ta:Object])],ia);var sa=n("../spread-sheet/src/external/view/ui-layer/find-replace/find-replace-controller.ts"),aa=n("../spread-sheet/src/external/view/ui-layer/decimal/decimal-controller.tsx"),ca=[{name:v.z_.CREATE_COPY,content:O.ZP.t("生成副本")}],da=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function s(e){try{c(r.next(e))}catch(t){i(t)}}function a(e){try{c(r.throw(e))}catch(t){i(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))},la=Symbol.for("feature:create-copy-pc");(0,qo.N)(la,(function(){return da(void 0,void 0,void 0,regeneratorRuntime.mark((function e(){var t,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([n.e("initial_chunk_part_2"),n.e("vendors-node_modules_tencent_docs-design-resources_pc_png_2x_cdn-function-export_js"),n.e("vendors-node_modules_tencent_docs-addon-sdk_lib_index_esm_js"),n.e("vendors-node_modules_tencent_docs-design-resources_pc_png_2x_cdn_js-node_modules_tencent_docs-70ebca"),n.e("vendors-node_modules_tencent_facade-config_dist_index_js"),n.e("vendors-node_modules_tencent_wedrive-component_dist_xdSaveDoc_css"),n.e("spread-sheet_src_base_util_decorator_loading-decorator_ts-spread-sheet_src_core_feature_copyP-33f189"),n.e("spread-sheet_src_core_view_level-2_condition-format-center_ui_utils_dataUtils_ts"),n.e("spread-sheet_src_core_workbench_common_base-drawer_tsx-spread-sheet_src_external_rangeAuth_ut-2939e0"),n.e("spread-sheet_src_core_view_level-2_chart_charts_chart-data-api_ts-spread-sheet_src_core_view_-9220ef"),n.e("spread-sheet_src_external_view_main_toolbar_IconBox_tsx"),n.e("spread-sheet_src_external_check-slr_sc-lazy-loader_ts-spread-sheet_src_external_templateinfo_-54b3ca"),n.e("spread-sheet_src_core_network_message-center_adapter_MessageCenterAdapter_interface_ts-spread-e88071"),n.e("spread-sheet_src_core_utils_gray_ts-spread-sheet_src_core_view_level-2_condition-format-cente-74d507"),n.e("spread-sheet_src_base_util_phone-number_ts-spread-sheet_src_core_feature_copyPaste_index_ts-s-89b53a"),n.e("spread-sheet_src_core_view_layout_pcView_ts"),n.e("spread-sheet_src_core_view_level-2_link-center_BaseLinkCenter_ts"),n.e("bundle_workbench_feature")]).then(n.bind(n,"../spread-sheet/src/external/view/ui-layer/create-copy/create-copy-feature-pc.ts"));case 2:return t=e.sent,r=t.CreateCopyFeature,e.abrupt("return",r);case 5:case"end":return e.stop()}}),e)})))}));var ua,_a=function(e,t,n,r){var o,i=arguments.length,s=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},pa=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},fa=function(e,t){return function(n,r){t(n,r,e)}},ha=function(){function e(e){this.loader=e}var t=e.prototype;return t.createCopy=function(){this.createCopyFeature.createCopy()},t.getDisabledState=function(){return this.createCopyFeature.getDisabledState()},(0,Oo.Z)(e,[{key:"createCopyFeature",get:function(){return this.loader.instance}}]),e}();_a([(0,Ko.v)(v.z_.CREATE_COPY,"onClick"),(0,ko.k)(),pa("design:type",Function),pa("design:paramtypes",[]),pa("design:returntype",void 0)],ha.prototype,"createCopy",null),_a([(0,Ko.v)(v.z_.CREATE_COPY,"shouldDisabled"),(0,ii.z)(!1),pa("design:type",Function),pa("design:paramtypes",[]),pa("design:returntype",void 0)],ha.prototype,"getDisabledState",null),ha=_a([(0,C.Q)({adapters:[Z.L,B.dH],menuItems:ca}),fa(0,(0,S.aN)(la)),pa("design:paramtypes",["function"===typeof(ua="undefined"!==typeof No.IDynamicLoader&&No.IDynamicLoader)?ua:Object])],ha);var ma=n("../spread-sheet/src/external/view/ui-layer/insert-row-col/insert-row-col-controller.tsx"),va=[{name:ho.B.DELETE_ROW,content:O.ZP.t("删除所在行"),selectionMiddleware:{include:[ai.R.ROW,ai.R.DISCONTINUOUS_ROWS,ai.R.SINGLE_CELL,ai.R.MERGED_CELL,ai.R.CONTINUOUS_MUTLI_CELLS,ai.R.DISCONTINUOUS_MUTLI_CELLS]},sheetStatusMiddleware:{isHiddenWhenCannotEditExceptRangeAuth:!0,isHiddenWhenCannotEdit:!0},privateFillMiddleWareConfig:{shouldCheckWhenCellIsPrivate:!0}},{name:ho.B.DELETE_COL,content:O.ZP.t("删除所在列"),selectionMiddleware:{include:[ai.R.COL,ai.R.DISCONTINUOUS_COLS,ai.R.SINGLE_CELL,ai.R.MERGED_CELL,ai.R.CONTINUOUS_MUTLI_CELLS,ai.R.DISCONTINUOUS_MUTLI_CELLS]},sheetStatusMiddleware:{isHiddenWhenCannotEditExceptRangeAuth:!0,isHiddenWhenCannotEdit:!0},privateFillMiddleWareConfig:{shouldCheckWhenCellIsPrivate:!0}}],ya=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function s(e){try{c(r.next(e))}catch(t){i(t)}}function a(e){try{c(r.throw(e))}catch(t){i(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))},ga=Symbol.for("feature:delete-row-col");(0,qo.N)(ga,(function(){return ya(void 0,void 0,void 0,regeneratorRuntime.mark((function e(){var t,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([n.e("initial_chunk_part_2"),n.e("vendors-node_modules_tencent_docs-design-resources_pc_png_2x_cdn-function-export_js"),n.e("vendors-node_modules_tencent_docs-addon-sdk_lib_index_esm_js"),n.e("vendors-node_modules_tencent_docs-design-resources_pc_png_2x_cdn_js-node_modules_tencent_docs-70ebca"),n.e("vendors-node_modules_tencent_facade-config_dist_index_js"),n.e("vendors-node_modules_tencent_wedrive-component_dist_xdSaveDoc_css"),n.e("spread-sheet_src_base_util_decorator_loading-decorator_ts-spread-sheet_src_core_feature_copyP-33f189"),n.e("spread-sheet_src_core_view_level-2_condition-format-center_ui_utils_dataUtils_ts"),n.e("spread-sheet_src_core_workbench_common_base-drawer_tsx-spread-sheet_src_external_rangeAuth_ut-2939e0"),n.e("spread-sheet_src_core_view_level-2_chart_charts_chart-data-api_ts-spread-sheet_src_core_view_-9220ef"),n.e("spread-sheet_src_external_view_main_toolbar_IconBox_tsx"),n.e("spread-sheet_src_external_check-slr_sc-lazy-loader_ts-spread-sheet_src_external_templateinfo_-54b3ca"),n.e("spread-sheet_src_core_network_message-center_adapter_MessageCenterAdapter_interface_ts-spread-e88071"),n.e("spread-sheet_src_core_utils_gray_ts-spread-sheet_src_core_view_level-2_condition-format-cente-74d507"),n.e("spread-sheet_src_base_util_phone-number_ts-spread-sheet_src_core_feature_copyPaste_index_ts-s-89b53a"),n.e("spread-sheet_src_core_view_layout_pcView_ts"),n.e("spread-sheet_src_core_view_level-2_link-center_BaseLinkCenter_ts"),n.e("bundle_workbench_feature")]).then(n.bind(n,"../spread-sheet/src/external/view/ui-layer/delete-row-col/delete-row-col-feature.ts"));case 2:return t=e.sent,r=t.DeleteRowColFeature,e.abrupt("return",r);case 5:case"end":return e.stop()}}),e)})))}));var Ea,wa=function(e,t,n,r){var o,i=arguments.length,s=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},ba=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},Ta=function(e,t){return function(n,r){t(n,r,e)}},Ra=function(){function e(e){this.loader=e}var t=e.prototype;return t.deleteRow=function(){this.deleteRowColFeature.deleteRow()},t.deleteCol=function(){this.deleteRowColFeature.deleteCol()},(0,Oo.Z)(e,[{key:"deleteRowColFeature",get:function(){return this.loader.instance}}]),e}();wa([(0,oi.x)(ho.B.DELETE_ROW,"onClick"),(0,ko.k)(),ba("design:type",Function),ba("design:paramtypes",[]),ba("design:returntype",void 0)],Ra.prototype,"deleteRow",null),wa([(0,oi.x)(ho.B.DELETE_COL,"onClick"),(0,ko.k)(),ba("design:type",Function),ba("design:paramtypes",[]),ba("design:returntype",void 0)],Ra.prototype,"deleteCol",null),Ra=wa([(0,C.Q)({adapters:[Z.L],contextMenuItems:va}),Ta(0,(0,S.aN)(ga)),ba("design:paramtypes",["function"===typeof(Ea="undefined"!==typeof No.IDynamicLoader&&No.IDynamicLoader)?Ea:Object])],Ra);var Ia=n("../spread-sheet/src/external/view/ui-layer/undo/undo-controller.ts"),Ca=n("../spread-sheet/src/external/view/ui-layer/redo/redo-controller.ts"),Aa=[{name:v.z_.IMPORT_FILE,content:O.ZP.t("导入本地文件")}],xa=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function s(e){try{c(r.next(e))}catch(t){i(t)}}function a(e){try{c(r.throw(e))}catch(t){i(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))},Oa=Symbol.for("feature:import-file");(0,qo.N)(Oa,(function(){return xa(void 0,void 0,void 0,regeneratorRuntime.mark((function e(){var t,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([n.e("initial_chunk_part_2"),n.e("vendors-node_modules_tencent_docs-design-resources_pc_png_2x_cdn-function-export_js"),n.e("vendors-node_modules_tencent_docs-addon-sdk_lib_index_esm_js"),n.e("vendors-node_modules_tencent_docs-design-resources_pc_png_2x_cdn_js-node_modules_tencent_docs-70ebca"),n.e("vendors-node_modules_tencent_facade-config_dist_index_js"),n.e("vendors-node_modules_tencent_wedrive-component_dist_xdSaveDoc_css"),n.e("spread-sheet_src_base_util_decorator_loading-decorator_ts-spread-sheet_src_core_feature_copyP-33f189"),n.e("spread-sheet_src_core_view_level-2_condition-format-center_ui_utils_dataUtils_ts"),n.e("spread-sheet_src_core_workbench_common_base-drawer_tsx-spread-sheet_src_external_rangeAuth_ut-2939e0"),n.e("spread-sheet_src_core_view_level-2_chart_charts_chart-data-api_ts-spread-sheet_src_core_view_-9220ef"),n.e("spread-sheet_src_external_view_main_toolbar_IconBox_tsx"),n.e("spread-sheet_src_external_check-slr_sc-lazy-loader_ts-spread-sheet_src_external_templateinfo_-54b3ca"),n.e("spread-sheet_src_core_network_message-center_adapter_MessageCenterAdapter_interface_ts-spread-e88071"),n.e("spread-sheet_src_core_utils_gray_ts-spread-sheet_src_core_view_level-2_condition-format-cente-74d507"),n.e("spread-sheet_src_base_util_phone-number_ts-spread-sheet_src_core_feature_copyPaste_index_ts-s-89b53a"),n.e("spread-sheet_src_core_view_layout_pcView_ts"),n.e("spread-sheet_src_core_view_level-2_link-center_BaseLinkCenter_ts"),n.e("bundle_workbench_feature")]).then(n.bind(n,"../spread-sheet/src/external/view/ui-layer/import-file/import-file-feature-pc.ts"));case 2:return t=e.sent,r=t.ImportFileFeaturePC,e.abrupt("return",r);case 5:case"end":return e.stop()}}),e)})))}));var Na,Sa=function(e,t,n,r){var o,i=arguments.length,s=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},ka=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},Pa=function(e,t){return function(n,r){t(n,r,e)}},Da=function(){function e(e){this.loader=e}return e.prototype.importFile=function(){this.importFileFeaturePC.importFile()},(0,Oo.Z)(e,[{key:"importFileFeaturePC",get:function(){return this.loader.instance}}]),e}();Sa([(0,Ko.v)(v.z_.IMPORT_FILE,"onClick"),(0,ko.k)(),ka("design:type",Function),ka("design:paramtypes",[]),ka("design:returntype",void 0)],Da.prototype,"importFile",null),Da=Sa([(0,C.Q)({adapters:[Z.L,B.dH],menuItems:Aa}),Pa(0,(0,S.aN)(Oa)),ka("design:paramtypes",["function"===typeof(Na="undefined"!==typeof No.IDynamicLoader&&No.IDynamicLoader)?Na:Object])],Da);var La=[{name:v.z_.SAVE_AS_TEMPLATE,content:O.ZP.t("另存为我的模板")}],Ma=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function s(e){try{c(r.next(e))}catch(t){i(t)}}function a(e){try{c(r.throw(e))}catch(t){i(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))},Fa=Symbol.for("feature:save-as-template-pc");(0,qo.N)(Fa,(function(){return Ma(void 0,void 0,void 0,regeneratorRuntime.mark((function e(){var t,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([n.e("initial_chunk_part_2"),n.e("vendors-node_modules_tencent_docs-design-resources_pc_png_2x_cdn-function-export_js"),n.e("vendors-node_modules_tencent_docs-addon-sdk_lib_index_esm_js"),n.e("vendors-node_modules_tencent_docs-design-resources_pc_png_2x_cdn_js-node_modules_tencent_docs-70ebca"),n.e("vendors-node_modules_tencent_facade-config_dist_index_js"),n.e("vendors-node_modules_tencent_wedrive-component_dist_xdSaveDoc_css"),n.e("spread-sheet_src_base_util_decorator_loading-decorator_ts-spread-sheet_src_core_feature_copyP-33f189"),n.e("spread-sheet_src_core_view_level-2_condition-format-center_ui_utils_dataUtils_ts"),n.e("spread-sheet_src_core_workbench_common_base-drawer_tsx-spread-sheet_src_external_rangeAuth_ut-2939e0"),n.e("spread-sheet_src_core_view_level-2_chart_charts_chart-data-api_ts-spread-sheet_src_core_view_-9220ef"),n.e("spread-sheet_src_external_view_main_toolbar_IconBox_tsx"),n.e("spread-sheet_src_external_check-slr_sc-lazy-loader_ts-spread-sheet_src_external_templateinfo_-54b3ca"),n.e("spread-sheet_src_core_network_message-center_adapter_MessageCenterAdapter_interface_ts-spread-e88071"),n.e("spread-sheet_src_core_utils_gray_ts-spread-sheet_src_core_view_level-2_condition-format-cente-74d507"),n.e("spread-sheet_src_base_util_phone-number_ts-spread-sheet_src_core_feature_copyPaste_index_ts-s-89b53a"),n.e("spread-sheet_src_core_view_layout_pcView_ts"),n.e("spread-sheet_src_core_view_level-2_link-center_BaseLinkCenter_ts"),n.e("bundle_workbench_feature")]).then(n.bind(n,"../spread-sheet/src/external/view/ui-layer/save-as-template/save-as-template-feature-pc.ts"));case 2:return t=e.sent,r=t.SaveAsTemplateFeaturePC,e.abrupt("return",r);case 5:case"end":return e.stop()}}),e)})))}));var ja,Ha=function(e,t,n,r){var o,i=arguments.length,s=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},Za=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},Ba=function(e,t){return function(n,r){t(n,r,e)}},za=function(){function e(e){this.loader=e}var t=e.prototype;return t.saveAsTemplate=function(){this.saveAsTemplateFeaturePC.saveAsTemplate()},t.getContent=function(){return this.saveAsTemplateFeaturePC.getContent()},t.getDisabledState=function(){return this.saveAsTemplateFeaturePC.getDisabledState()},t.getHiddenState=function(){return this.saveAsTemplateFeaturePC.getHiddenState()},(0,Oo.Z)(e,[{key:"saveAsTemplateFeaturePC",get:function(){return this.loader.instance}}]),e}();Ha([(0,Ko.v)(v.z_.SAVE_AS_TEMPLATE,"onClick"),(0,ko.k)(),Za("design:type",Function),Za("design:paramtypes",[]),Za("design:returntype",void 0)],za.prototype,"saveAsTemplate",null),Ha([(0,Ko.v)(v.z_.SAVE_AS_TEMPLATE,"content"),(0,ii.z)(O.ZP.t("另存为我的模板")),Za("design:type",Function),Za("design:paramtypes",[]),Za("design:returntype",void 0)],za.prototype,"getContent",null),Ha([(0,Ko.v)(v.z_.SAVE_AS_TEMPLATE,"shouldDisabled"),(0,ii.z)(!1),Za("design:type",Function),Za("design:paramtypes",[]),Za("design:returntype",void 0)],za.prototype,"getDisabledState",null),Ha([(0,Ko.v)(v.z_.SAVE_AS_TEMPLATE,"shouldHide"),(0,ii.z)(!1),Za("design:type",Function),Za("design:paramtypes",[]),Za("design:returntype",void 0)],za.prototype,"getHiddenState",null),za=Ha([(0,C.Q)({adapters:[Z.L,B.dH],menuItems:La}),Ba(0,(0,S.aN)(Fa)),Za("design:paramtypes",["function"===typeof(ja="undefined"!==typeof No.IDynamicLoader&&No.IDynamicLoader)?ja:Object])],za);var Ua=[{name:v.z_.INSERT_CHART,content:O.ZP.t("图表"),icon:A.createElement("div",{className:"icon-svg-toolbar-add-chart"}),description:O.ZP.t("柱状图/地图"),sheetStatusMiddleware:{isDisabledWhenCannotEdit:!0}}],Va=[{name:v.z_.INSERT_CHART,content:O.ZP.t("图表"),sheetStatusMiddleware:{isDisabledWhenCannotEdit:!0}}],Wa=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function s(e){try{c(r.next(e))}catch(t){i(t)}}function a(e){try{c(r.throw(e))}catch(t){i(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))},Ga=Symbol.for("feature:insert-chart");(0,qo.N)(Ga,(function(){return Wa(void 0,void 0,void 0,regeneratorRuntime.mark((function e(){var t,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([n.e("initial_chunk_part_2"),n.e("vendors-node_modules_tencent_docs-design-resources_pc_png_2x_cdn-function-export_js"),n.e("vendors-node_modules_tencent_docs-addon-sdk_lib_index_esm_js"),n.e("vendors-node_modules_tencent_docs-design-resources_pc_png_2x_cdn_js-node_modules_tencent_docs-70ebca"),n.e("vendors-node_modules_tencent_facade-config_dist_index_js"),n.e("vendors-node_modules_tencent_wedrive-component_dist_xdSaveDoc_css"),n.e("spread-sheet_src_base_util_decorator_loading-decorator_ts-spread-sheet_src_core_feature_copyP-33f189"),n.e("spread-sheet_src_core_view_level-2_condition-format-center_ui_utils_dataUtils_ts"),n.e("spread-sheet_src_core_workbench_common_base-drawer_tsx-spread-sheet_src_external_rangeAuth_ut-2939e0"),n.e("spread-sheet_src_core_view_level-2_chart_charts_chart-data-api_ts-spread-sheet_src_core_view_-9220ef"),n.e("spread-sheet_src_external_view_main_toolbar_IconBox_tsx"),n.e("spread-sheet_src_external_check-slr_sc-lazy-loader_ts-spread-sheet_src_external_templateinfo_-54b3ca"),n.e("spread-sheet_src_core_network_message-center_adapter_MessageCenterAdapter_interface_ts-spread-e88071"),n.e("spread-sheet_src_core_utils_gray_ts-spread-sheet_src_core_view_level-2_condition-format-cente-74d507"),n.e("spread-sheet_src_base_util_phone-number_ts-spread-sheet_src_core_feature_copyPaste_index_ts-s-89b53a"),n.e("spread-sheet_src_core_view_layout_pcView_ts"),n.e("spread-sheet_src_core_view_level-2_link-center_BaseLinkCenter_ts"),n.e("bundle_workbench_feature")]).then(n.bind(n,"../spread-sheet/src/external/view/ui-layer/insert-chart/insert-chart-feature.ts"));case 2:return t=e.sent,r=t.InsertChartFeature,e.abrupt("return",r);case 5:case"end":return e.stop()}}),e)})))}));var Ya,Ka=function(e,t,n,r){var o,i=arguments.length,s=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},Xa=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},qa=function(e,t){return function(n,r){t(n,r,e)}},Qa=function(){function e(e){this.loader=e}return e.prototype.insertChart=function(){this.insertChartFeature.insertChart()},(0,Oo.Z)(e,[{key:"insertChartFeature",get:function(){return this.loader.instance}}]),e}();Ka([(0,Ko.v)(v.z_.INSERT_CHART,"onClick"),(0,ko.k)(),Xa("design:type",Function),Xa("design:paramtypes",[]),Xa("design:returntype",void 0)],Qa.prototype,"insertChart",null),Qa=Ka([(0,C.Q)({adapters:[Z.L],menuItems:Ua,contextMenuItems:Va}),qa(0,(0,S.aN)(Ga)),Xa("design:paramtypes",["function"===typeof(Ya="undefined"!==typeof No.IDynamicLoader&&No.IDynamicLoader)?Ya:Object])],Qa);var $a=n("../spread-sheet/src/external/view/ui-layer/number-format/number-format-controller.tsx"),Ja=[{name:ho.B.DELETE_RANGE,content:O.ZP.t("删除单元格"),preventDismiss:!0,selectionMiddleware:{include:[ai.R.SINGLE_CELL,ai.R.MERGED_CELL,ai.R.CONTINUOUS_MUTLI_CELLS]},sheetStatusMiddleware:{isHiddenWhenCannotEdit:!0},privateFillMiddleWareConfig:{shouldCheckWhenCellIsPrivate:!0}},{name:ho.B.DELETE_RANGE_LEFT,content:O.ZP.t("现有单元格左移"),style:si.u,selectionMiddleware:{include:[ai.R.SINGLE_CELL,ai.R.MERGED_CELL,ai.R.CONTINUOUS_MUTLI_CELLS]}},{name:ho.B.DELETE_RANGE_UP,content:O.ZP.t("现有单元格上移"),style:si.u,selectionMiddleware:{include:[ai.R.SINGLE_CELL,ai.R.MERGED_CELL,ai.R.CONTINUOUS_MUTLI_CELLS]}}],ec=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function s(e){try{c(r.next(e))}catch(t){i(t)}}function a(e){try{c(r.throw(e))}catch(t){i(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))},tc=Symbol.for("feature:delete-range");(0,qo.N)(tc,(function(){return ec(void 0,void 0,void 0,regeneratorRuntime.mark((function e(){var t,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([n.e("initial_chunk_part_2"),n.e("vendors-node_modules_tencent_docs-design-resources_pc_png_2x_cdn-function-export_js"),n.e("vendors-node_modules_tencent_docs-addon-sdk_lib_index_esm_js"),n.e("vendors-node_modules_tencent_docs-design-resources_pc_png_2x_cdn_js-node_modules_tencent_docs-70ebca"),n.e("vendors-node_modules_tencent_facade-config_dist_index_js"),n.e("vendors-node_modules_tencent_wedrive-component_dist_xdSaveDoc_css"),n.e("spread-sheet_src_base_util_decorator_loading-decorator_ts-spread-sheet_src_core_feature_copyP-33f189"),n.e("spread-sheet_src_core_view_level-2_condition-format-center_ui_utils_dataUtils_ts"),n.e("spread-sheet_src_core_workbench_common_base-drawer_tsx-spread-sheet_src_external_rangeAuth_ut-2939e0"),n.e("spread-sheet_src_core_view_level-2_chart_charts_chart-data-api_ts-spread-sheet_src_core_view_-9220ef"),n.e("spread-sheet_src_external_view_main_toolbar_IconBox_tsx"),n.e("spread-sheet_src_external_check-slr_sc-lazy-loader_ts-spread-sheet_src_external_templateinfo_-54b3ca"),n.e("spread-sheet_src_core_network_message-center_adapter_MessageCenterAdapter_interface_ts-spread-e88071"),n.e("spread-sheet_src_core_utils_gray_ts-spread-sheet_src_core_view_level-2_condition-format-cente-74d507"),n.e("spread-sheet_src_base_util_phone-number_ts-spread-sheet_src_core_feature_copyPaste_index_ts-s-89b53a"),n.e("spread-sheet_src_core_view_layout_pcView_ts"),n.e("spread-sheet_src_core_view_level-2_link-center_BaseLinkCenter_ts"),n.e("bundle_workbench_feature")]).then(n.bind(n,"../spread-sheet/src/external/view/ui-layer/delete-range/delete-range-feature.ts"));case 2:return t=e.sent,r=t.DeleteRangeFeature,e.abrupt("return",r);case 5:case"end":return e.stop()}}),e)})))}));var nc,rc,oc=n("../spread-sheet/src/core/behavior/request/range/config.ts"),ic=function(e,t,n,r){var o,i=arguments.length,s=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},sc=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},ac=function(e,t){return function(n,r){t(n,r,e)}},cc=function(){function e(e){this.loader=e}var t=e.prototype;return t.shouldDeleteRangeLeftDisabled=function(){return this.deleteRangeFeature.getDeleteRangeDisabled(oc._z.LEFT)},t.shouldDeleteRangeUpDisabled=function(){return this.deleteRangeFeature.getDeleteRangeDisabled(oc._z.UP)},t.deleteRange=function(e){this.deleteRangeFeature.deleteRange(e),oe.ZP.tdwReport({opername:"doc_excel_editor",module:"cell_edit",action:"cell_click",ver10:"rightside_click",ver11:"delete_cell"})},(0,Oo.Z)(e,[{key:"deleteRangeFeature",get:function(){return this.loader.instance}}]),e}();ic([(0,oi.x)(ho.B.DELETE_RANGE_LEFT,"shouldDisabled"),(0,ii.z)(!1),sc("design:type",Function),sc("design:paramtypes",[]),sc("design:returntype",void 0)],cc.prototype,"shouldDeleteRangeLeftDisabled",null),ic([(0,oi.x)(ho.B.DELETE_RANGE_UP,"shouldDisabled"),(0,ii.z)(!1),sc("design:type",Function),sc("design:paramtypes",[]),sc("design:returntype",void 0)],cc.prototype,"shouldDeleteRangeUpDisabled",null),ic([(0,oi.x)(ho.B.DELETE_RANGE_LEFT,"onClick"),(0,oi.x)(ho.B.DELETE_RANGE_UP,"onClick"),(0,ko.k)(),ac(0,(0,Qi.g)()),sc("design:type",Function),sc("design:paramtypes",["function"===typeof(nc="undefined"!==typeof No.IActionPointInfo&&No.IActionPointInfo)?nc:Object]),sc("design:returntype",void 0)],cc.prototype,"deleteRange",null),cc=ic([(0,C.Q)({adapters:[Z.L],contextMenuItems:Ja}),ac(0,(0,S.aN)(tc)),sc("design:paramtypes",["function"===typeof(rc="undefined"!==typeof No.IDynamicLoader&&No.IDynamicLoader)?rc:Object])],cc);var dc={selectionMiddleware:{include:[ai.R.SINGLE_CELL,ai.R.MERGED_CELL,ai.R.CONTINUOUS_MUTLI_CELLS]},sheetStatusMiddleware:{isDisabledWhenCannotEdit:!0}},lc=[Object.assign({name:v.z_.INSERT_RANGE_IN_INSERT_MENU,content:O.ZP.t("插入单元格"),preventDismiss:!0,icon:x().createElement("div",{className:"icon-svg-toolbar-add-cell"})},dc),Object.assign({name:v.z_.INSERT_RANGE_RIGHT_IN_INSERT_MENU,content:O.ZP.t("现有单元格右移")},dc),Object.assign({name:v.z_.INSERT_RANGE_DOWN_IN_INSERT_MENU,content:O.ZP.t("现有单元格下移")},dc),Object.assign({name:v.z_.INSERT_RANGE_IN_EDIT_MENU,content:O.ZP.t("插入单元格"),preventDismiss:!0},dc),Object.assign({name:v.z_.INSERT_RANGE_RIGHT_IN_EDIT_MENU,content:O.ZP.t("现有单元格右移")},dc),Object.assign({name:v.z_.INSERT_RANGE_DOWN_IN_EDIT_MENU,content:O.ZP.t("现有单元格下移")},dc)],uc=[{name:ho.B.INSERT_RANGE,content:O.ZP.t("插入单元格"),preventDismiss:!0,selectionMiddleware:{include:[ai.R.SINGLE_CELL,ai.R.MERGED_CELL,ai.R.CONTINUOUS_MUTLI_CELLS]},sheetStatusMiddleware:{isHiddenWhenCannotEdit:!0}},Object.assign({name:ho.B.INSERT_RANGE_RIGHT,content:O.ZP.t("现有单元格右移"),style:si.u},dc),Object.assign({name:ho.B.INSERT_RANGE_DOWN,content:O.ZP.t("现有单元格下移"),style:si.u},dc)],_c=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function s(e){try{c(r.next(e))}catch(t){i(t)}}function a(e){try{c(r.throw(e))}catch(t){i(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))},pc=Symbol.for("feature:insert-range");(0,qo.N)(pc,(function(){return _c(void 0,void 0,void 0,regeneratorRuntime.mark((function e(){var t,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([n.e("initial_chunk_part_2"),n.e("vendors-node_modules_tencent_docs-design-resources_pc_png_2x_cdn-function-export_js"),n.e("vendors-node_modules_tencent_docs-addon-sdk_lib_index_esm_js"),n.e("vendors-node_modules_tencent_docs-design-resources_pc_png_2x_cdn_js-node_modules_tencent_docs-70ebca"),n.e("vendors-node_modules_tencent_facade-config_dist_index_js"),n.e("vendors-node_modules_tencent_wedrive-component_dist_xdSaveDoc_css"),n.e("spread-sheet_src_base_util_decorator_loading-decorator_ts-spread-sheet_src_core_feature_copyP-33f189"),n.e("spread-sheet_src_core_view_level-2_condition-format-center_ui_utils_dataUtils_ts"),n.e("spread-sheet_src_core_workbench_common_base-drawer_tsx-spread-sheet_src_external_rangeAuth_ut-2939e0"),n.e("spread-sheet_src_core_view_level-2_chart_charts_chart-data-api_ts-spread-sheet_src_core_view_-9220ef"),n.e("spread-sheet_src_external_view_main_toolbar_IconBox_tsx"),n.e("spread-sheet_src_external_check-slr_sc-lazy-loader_ts-spread-sheet_src_external_templateinfo_-54b3ca"),n.e("spread-sheet_src_core_network_message-center_adapter_MessageCenterAdapter_interface_ts-spread-e88071"),n.e("spread-sheet_src_core_utils_gray_ts-spread-sheet_src_core_view_level-2_condition-format-cente-74d507"),n.e("spread-sheet_src_base_util_phone-number_ts-spread-sheet_src_core_feature_copyPaste_index_ts-s-89b53a"),n.e("spread-sheet_src_core_view_layout_pcView_ts"),n.e("spread-sheet_src_core_view_level-2_link-center_BaseLinkCenter_ts"),n.e("bundle_workbench_feature")]).then(n.bind(n,"../spread-sheet/src/external/view/ui-layer/insert-range/insert-range-feature.ts"));case 2:return t=e.sent,r=t.InsertRangeFeature,e.abrupt("return",r);case 5:case"end":return e.stop()}}),e)})))}));var fc,hc,mc=function(e,t,n,r){var o,i=arguments.length,s=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},vc=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},yc=function(e,t){return function(n,r){t(n,r,e)}},gc=function(){function e(e){this.loader=e}var t=e.prototype;return t.shouldInsertRangeRightDisabled=function(){return this.insertRangeFeature.getInsertRangeDisabled(oc.ai.RIGHT)},t.shouldInsertRangeDownDisabled=function(){return this.insertRangeFeature.getInsertRangeDisabled(oc.ai.DOWN)},t.insertRange=function(e){this.insertRangeFeature.insertRange(e),this.reportClick(e)},t.reportClick=function(e){e.from===Xs.v.CONTEXT_MENU?oe.ZP.tdwReport({opername:"doc_excel_editor",module:"cell_edit",action:"cell_click",ver10:"rightside_click",ver11:"insert_cell"}):e.name===v.z_.INSERT_RANGE_RIGHT_IN_EDIT_MENU||e.name===v.z_.INSERT_RANGE_DOWN_IN_EDIT_MENU?oe.ZP.tdwReport({opername:"doc_excel_editor",module:"cell_edit",action:"cell_click",ver10:"menu",ver11:"insert_cell"}):e.name!==v.z_.INSERT_RANGE_RIGHT_IN_INSERT_MENU&&e.name!==v.z_.INSERT_RANGE_DOWN_IN_INSERT_MENU||oe.ZP.tdwReport({opername:"doc_excel_editor",module:"cell_edit",action:"cell_click",ver10:"toolbar",ver11:"insert_cell"})},(0,Oo.Z)(e,[{key:"insertRangeFeature",get:function(){return this.loader.instance}}]),e}();mc([(0,Ko.v)(v.z_.INSERT_RANGE_RIGHT_IN_EDIT_MENU,"shouldDisabled"),(0,Ko.v)(v.z_.INSERT_RANGE_RIGHT_IN_INSERT_MENU,"shouldDisabled"),(0,oi.x)(ho.B.INSERT_RANGE_RIGHT,"shouldDisabled"),(0,ii.z)(!1),vc("design:type",Function),vc("design:paramtypes",[]),vc("design:returntype",void 0)],gc.prototype,"shouldInsertRangeRightDisabled",null),mc([(0,Ko.v)(v.z_.INSERT_RANGE_DOWN_IN_EDIT_MENU,"shouldDisabled"),(0,Ko.v)(v.z_.INSERT_RANGE_DOWN_IN_INSERT_MENU,"shouldDisabled"),(0,oi.x)(ho.B.INSERT_RANGE_DOWN,"shouldDisabled"),(0,ii.z)(!1),vc("design:type",Function),vc("design:paramtypes",[]),vc("design:returntype",void 0)],gc.prototype,"shouldInsertRangeDownDisabled",null),mc([(0,Ko.v)(v.z_.INSERT_RANGE_RIGHT_IN_EDIT_MENU,"onClick"),(0,Ko.v)(v.z_.INSERT_RANGE_DOWN_IN_EDIT_MENU,"onClick"),(0,Ko.v)(v.z_.INSERT_RANGE_RIGHT_IN_INSERT_MENU,"onClick"),(0,Ko.v)(v.z_.INSERT_RANGE_DOWN_IN_INSERT_MENU,"onClick"),(0,oi.x)(ho.B.INSERT_RANGE_RIGHT,"onClick"),(0,oi.x)(ho.B.INSERT_RANGE_DOWN,"onClick"),(0,ko.k)(),yc(0,(0,Qi.g)()),vc("design:type",Function),vc("design:paramtypes",["function"===typeof(fc="undefined"!==typeof No.IActionPointInfo&&No.IActionPointInfo)?fc:Object]),vc("design:returntype",void 0)],gc.prototype,"insertRange",null),gc=mc([(0,C.Q)({adapters:[Z.L],menuItems:lc,contextMenuItems:uc}),yc(0,(0,S.aN)(pc)),vc("design:paramtypes",["function"===typeof(hc="undefined"!==typeof No.IDynamicLoader&&No.IDynamicLoader)?hc:Object])],gc);var Ec=n("../spread-sheet/src/external/view/ui-layer/insert-cell-img/insert-cell-img-controller.ts"),wc=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function s(e){try{c(r.next(e))}catch(t){i(t)}}function a(e){try{c(r.throw(e))}catch(t){i(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))},bc=Symbol.for("feature:export-file-feature-pc");(0,qo.N)(bc,(function(){return wc(void 0,void 0,void 0,regeneratorRuntime.mark((function e(){var t,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([n.e("initial_chunk_part_2"),n.e("vendors-node_modules_tencent_docs-design-resources_pc_png_2x_cdn-function-export_js"),n.e("vendors-node_modules_tencent_docs-addon-sdk_lib_index_esm_js"),n.e("vendors-node_modules_tencent_docs-design-resources_pc_png_2x_cdn_js-node_modules_tencent_docs-70ebca"),n.e("vendors-node_modules_tencent_facade-config_dist_index_js"),n.e("vendors-node_modules_tencent_wedrive-component_dist_xdSaveDoc_css"),n.e("spread-sheet_src_base_util_decorator_loading-decorator_ts-spread-sheet_src_core_feature_copyP-33f189"),n.e("spread-sheet_src_core_view_level-2_condition-format-center_ui_utils_dataUtils_ts"),n.e("spread-sheet_src_core_workbench_common_base-drawer_tsx-spread-sheet_src_external_rangeAuth_ut-2939e0"),n.e("spread-sheet_src_core_view_level-2_chart_charts_chart-data-api_ts-spread-sheet_src_core_view_-9220ef"),n.e("spread-sheet_src_external_view_main_toolbar_IconBox_tsx"),n.e("spread-sheet_src_external_check-slr_sc-lazy-loader_ts-spread-sheet_src_external_templateinfo_-54b3ca"),n.e("spread-sheet_src_core_network_message-center_adapter_MessageCenterAdapter_interface_ts-spread-e88071"),n.e("spread-sheet_src_core_utils_gray_ts-spread-sheet_src_core_view_level-2_condition-format-cente-74d507"),n.e("spread-sheet_src_base_util_phone-number_ts-spread-sheet_src_core_feature_copyPaste_index_ts-s-89b53a"),n.e("spread-sheet_src_core_view_layout_pcView_ts"),n.e("spread-sheet_src_core_view_level-2_link-center_BaseLinkCenter_ts"),n.e("bundle_workbench_feature")]).then(n.bind(n,"../spread-sheet/src/external/view/ui-layer/export-file/export-file-feature-pc.ts"));case 2:return t=e.sent,r=t.ExportFileFeaturePC,e.abrupt("return",r);case 5:case"end":return e.stop()}}),e)})))}));var Tc,Rc=[{name:v.z_.EXPORT_FILE,content:O.ZP.t("导出为")},{name:v.z_.EXPORT_LOCAL,content:O.ZP.t("本地Excel表格 (.xlsx)")},{name:v.z_.EXPORT_CSV,content:O.ZP.t("本地CSV文件（.csv，当前工作表）")},{name:v.z_.EXPORT_URL,content:O.ZP.t("生成本地快捷方式")}],Ic=function(e,t,n,r){var o,i=arguments.length,s=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},Cc=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},Ac=function(e,t){return function(n,r){t(n,r,e)}},xc=function(){function e(e){this.loader=e}var t=e.prototype;return t.popupStyle=function(){return{width:"220px"}},t.exportLocal=function(){this.exportFileFeaturePC.exportToLocalFile()},t.exportCSV=function(){this.exportFileFeaturePC.exportToLocalCsv()},t.exportUrl=function(){this.exportFileFeaturePC.exportToLocalShortcut()},t.getDisabledState=function(){return this.exportFileFeaturePC.getDisabledState()},t.getExportCSVDisabledState=function(){return!(!rt().isPC||!rt().isWxMiniProgram)||this.exportFileFeaturePC.getExportCSVDisabledState()},(0,Oo.Z)(e,[{key:"exportFileFeaturePC",get:function(){return this.loader.instance}}]),e}();Ic([(0,Ko.v)(v.z_.EXPORT_FILE,"popUpStyle"),Cc("design:type",Function),Cc("design:paramtypes",[]),Cc("design:returntype",void 0)],xc.prototype,"popupStyle",null),Ic([(0,Ko.v)(v.z_.EXPORT_LOCAL,"onClick"),(0,ko.k)(),Cc("design:type",Function),Cc("design:paramtypes",[]),Cc("design:returntype",void 0)],xc.prototype,"exportLocal",null),Ic([(0,Ko.v)(v.z_.EXPORT_CSV,"onClick"),(0,ko.k)(),Cc("design:type",Function),Cc("design:paramtypes",[]),Cc("design:returntype",void 0)],xc.prototype,"exportCSV",null),Ic([(0,Ko.v)(v.z_.EXPORT_URL,"onClick"),(0,ko.k)(),Cc("design:type",Function),Cc("design:paramtypes",[]),Cc("design:returntype",void 0)],xc.prototype,"exportUrl",null),Ic([(0,Ko.v)(v.z_.EXPORT_LOCAL,"shouldDisabled"),(0,Ko.v)(v.z_.EXPORT_CSV,"shouldDisabled"),(0,ii.z)(!1),Cc("design:type",Function),Cc("design:paramtypes",[]),Cc("design:returntype",void 0)],xc.prototype,"getDisabledState",null),Ic([(0,Ko.v)(v.z_.EXPORT_CSV,"shouldHide"),(0,Ko.v)(v.z_.EXPORT_URL,"shouldHide"),(0,ii.z)(!1),Cc("design:type",Function),Cc("design:paramtypes",[]),Cc("design:returntype",void 0)],xc.prototype,"getExportCSVDisabledState",null),xc=Ic([(0,C.Q)({adapters:[Z.L,B.dH],menuItems:Rc}),Ac(0,(0,S.aN)(bc)),Cc("design:paramtypes",["function"===typeof(Tc="undefined"!==typeof No.IDynamicLoader&&No.IDynamicLoader)?Tc:Object])],xc);var Oc=n("../node_modules/@tencent/workbench/lib/esm/components/toolbar/common-dropdown/select-list/select-list.js"),Nc=n("../node_modules/@tencent/workbench/lib/esm/services/toolbar/toolbar-config.interface.js"),Sc=n("../spread-sheet/src/base/config/font.ts"),kc=[{name:m.HM.FONT_FAMILY,type:"text",tooltip:O.ZP.t("字体"),sheetStatusMiddleware:{isDisabledWhenCannotEdit:!0},privateFillMiddleWareConfig:{shouldCheckWhenCellIsPrivate:!0}},{name:m.HM.FONT,hasArrow:!0,type:"text",icon:x().createElement("div",{className:"icon-svg-toolbar_font_setting"}),text:O.ZP.t("字体"),tooltip:O.ZP.t("字体"),shouldVerticallyArrange:!0,style:{width:"55px"},dropdownAlignment:"left"}],Pc=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function s(e){try{c(r.next(e))}catch(t){i(t)}}function a(e){try{c(r.throw(e))}catch(t){i(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))},Dc=Symbol.for("feature:font-family");(0,qo.N)(Dc,(function(){return Pc(void 0,void 0,void 0,regeneratorRuntime.mark((function e(){var t,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([n.e("initial_chunk_part_2"),n.e("vendors-node_modules_tencent_docs-design-resources_pc_png_2x_cdn-function-export_js"),n.e("vendors-node_modules_tencent_docs-addon-sdk_lib_index_esm_js"),n.e("vendors-node_modules_tencent_docs-design-resources_pc_png_2x_cdn_js-node_modules_tencent_docs-70ebca"),n.e("vendors-node_modules_tencent_facade-config_dist_index_js"),n.e("vendors-node_modules_tencent_wedrive-component_dist_xdSaveDoc_css"),n.e("spread-sheet_src_base_util_decorator_loading-decorator_ts-spread-sheet_src_core_feature_copyP-33f189"),n.e("spread-sheet_src_core_view_level-2_condition-format-center_ui_utils_dataUtils_ts"),n.e("spread-sheet_src_core_workbench_common_base-drawer_tsx-spread-sheet_src_external_rangeAuth_ut-2939e0"),n.e("spread-sheet_src_core_view_level-2_chart_charts_chart-data-api_ts-spread-sheet_src_core_view_-9220ef"),n.e("spread-sheet_src_external_view_main_toolbar_IconBox_tsx"),n.e("spread-sheet_src_external_check-slr_sc-lazy-loader_ts-spread-sheet_src_external_templateinfo_-54b3ca"),n.e("spread-sheet_src_core_network_message-center_adapter_MessageCenterAdapter_interface_ts-spread-e88071"),n.e("spread-sheet_src_core_utils_gray_ts-spread-sheet_src_core_view_level-2_condition-format-cente-74d507"),n.e("spread-sheet_src_base_util_phone-number_ts-spread-sheet_src_core_feature_copyPaste_index_ts-s-89b53a"),n.e("spread-sheet_src_core_view_layout_pcView_ts"),n.e("spread-sheet_src_core_view_level-2_link-center_BaseLinkCenter_ts"),n.e("bundle_workbench_feature")]).then(n.bind(n,"../spread-sheet/src/external/view/ui-layer/font-family/font-family-feature.ts"));case 2:return t=e.sent,r=t.FontFamilyFeature,e.abrupt("return",r);case 5:case"end":return e.stop()}}),e)})))}));var Lc,Mc,Fc=function(e,t,n,r){var o,i=arguments.length,s=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},jc=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},Hc=function(e,t){return function(n,r){t(n,r,e)}},Zc=function(){function e(e,t){this.toolbarModeFeature=e,this.loader=t}var t=e.prototype;return t.getFontName=function(){return this.fontFamilyFeature.getFontFamilyAndName()[1]},t.handleTdwClick=function(){this.fontFamilyFeature.handleTdwClick()},t.getFontStyle=function(){return this.fontFamilyFeature.getFontFamilyAndName()[0]},t.getStyle=function(){var e=this.getFontStyle();return this.toolbarModeFeature.getToolbarMode()===ro.ToolbarModeOrders.DOUBLE_LINE_TOOLBAR?{display:"inline-block","text-align":"left",textOverflow:"ellipsis",fontFamily:e,width:"107px","line-height":"23px"}:{textOverflow:"ellipsis",fontFamily:e,width:"61px",marginLeft:"6px"}},t.renderSelectList=function(){var e=this,t=this.fontFamilyFeature.getFontList(),n=this.fontFamilyFeature.getFontFamilyAndName()[0];return x().createElement(Oc.E,{selected:n,items:t,onChange:function(t){return e.fontFamilyFeature.selectFont(t)},className:"select-list-font-family"})},t.getoOutlineType=function(){return this.toolbarModeFeature.getToolbarMode()===ro.ToolbarModeOrders.DOUBLE_LINE_TOOLBAR?Nc.Vi.INPUT:Nc.Vi.DEFAULT},(0,Oo.Z)(e,[{key:"fontFamilyFeature",get:function(){return this.loader.instance}}]),e}();Fc([(0,So.o)(m.HM.FONT_FAMILY,"text"),(0,ii.z)(O.ZP.t("默认字体")),jc("design:type",Function),jc("design:paramtypes",[]),jc("design:returntype",void 0)],Zc.prototype,"getFontName",null),Fc([(0,So.o)(m.HM.FONT_FAMILY,"onClick"),(0,ko.k)(),jc("design:type",Function),jc("design:paramtypes",[]),jc("design:returntype",void 0)],Zc.prototype,"handleTdwClick",null),Fc([(0,ii.z)(Sc.em),jc("design:type",Function),jc("design:paramtypes",[]),jc("design:returntype",void 0)],Zc.prototype,"getFontStyle",null),Fc([(0,So.o)(m.HM.FONT_FAMILY,"style"),jc("design:type",Function),jc("design:paramtypes",[]),jc("design:returntype",void 0)],Zc.prototype,"getStyle",null),Fc([(0,So.o)(m.HM.FONT_FAMILY,"dropdownContent"),(0,ko.k)(qs.P),jc("design:type",Function),jc("design:paramtypes",[]),jc("design:returntype",void 0)],Zc.prototype,"renderSelectList",null),Fc([(0,So.o)(m.HM.FONT_FAMILY,"outlineType"),jc("design:type",Function),jc("design:paramtypes",[]),jc("design:returntype",void 0)],Zc.prototype,"getoOutlineType",null),Zc=Fc([(0,C.Q)({adapters:[Z.L],toolbarItems:kc}),Hc(1,(0,S.aN)(Dc)),jc("design:paramtypes",["function"===typeof(Lc="undefined"!==typeof no.ToolbarModeFeature&&no.ToolbarModeFeature)?Lc:Object,"function"===typeof(Mc="undefined"!==typeof No.IDynamicLoader&&No.IDynamicLoader)?Mc:Object])],Zc);var Bc,zc,Uc=n("../spread-sheet/src/external/view/ui-layer/font-size/config.ts"),Vc=n("../spread-sheet/src/external/view/ui-layer/font-size/font-size.interface.ts"),Wc=function(e,t,n,r){var o,i=arguments.length,s=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},Gc=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},Yc=function(e,t){return function(n,r){t(n,r,e)}},Kc=function(){function e(e,t){this.toolbarModeFeature=e,this.loader=t}var t=e.prototype;return t.getFontSize=function(){return this.fontSizeFeature.getFontSize()},t.renderSelectList=function(){var e=this,t=this.fontSizeFeature.getFontSizeList(),n=this.fontSizeFeature.getFontSize();return x().createElement(Oc.E,{selected:n,style:{width:78},items:t,onChange:function(t){return e.fontSizeFeature.selectFontSize(t)},className:"select-list-font-size"})},t.getoOutlineType=function(){return this.toolbarModeFeature.getToolbarMode()===ro.ToolbarModeOrders.DOUBLE_LINE_TOOLBAR?Nc.Vi.INPUT:Nc.Vi.DEFAULT},(0,Oo.Z)(e,[{key:"fontSizeFeature",get:function(){return this.loader.instance}}]),e}();Wc([(0,So.o)(m.HM.FONT_SIZE,"text"),(0,ii.z)("10"),Gc("design:type",Function),Gc("design:paramtypes",[]),Gc("design:returntype",void 0)],Kc.prototype,"getFontSize",null),Wc([(0,So.o)(m.HM.FONT_SIZE,"dropdownContent"),(0,ko.k)(qs.P),Gc("design:type",Function),Gc("design:paramtypes",[]),Gc("design:returntype",void 0)],Kc.prototype,"renderSelectList",null),Wc([(0,So.o)(m.HM.FONT_SIZE,"outlineType"),Gc("design:type",Function),Gc("design:paramtypes",[]),Gc("design:returntype",void 0)],Kc.prototype,"getoOutlineType",null),Kc=Wc([(0,C.Q)({adapters:[Z.L],toolbarItems:Uc.O}),Yc(1,(0,S.aN)(Vc.E)),Gc("design:paramtypes",["function"===typeof(Bc="undefined"!==typeof no.ToolbarModeFeature&&no.ToolbarModeFeature)?Bc:Object,"function"===typeof(zc="undefined"!==typeof No.IDynamicLoader&&No.IDynamicLoader)?zc:Object])],Kc);var Xc,qc,Qc,$c=n("../spread-sheet/src/external/view/ui-layer/format-style/italic-controller.ts"),Jc=n("../spread-sheet/src/external/view/ui-layer/format-style/underline-controller.ts"),ed=n("../spread-sheet/src/external/view/ui-layer/format-style/strikethrough-controller.ts"),td=n("../spread-sheet/src/external/view/ui-layer/font-color/config.tsx"),nd=n("../spread-sheet/src/external/view/ui-layer/font-color/font-color.interface.ts"),rd=function(e,t,n,r){var o,i=arguments.length,s=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},od=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},id=function(e,t){return function(n,r){t(n,r,e)}},sd=function(){function e(e){this.loader=e}var t=e.prototype;return t.getFontColor=function(e){var t=e.from;return this.fontColorFeature.getFontColor(t)},t.handleSelectColor=function(){var e=this.fontColorFeature.getFontColor(Xs.v.TOOLBAR);this.fontColorFeature.reportSetFontColor(e),this.fontColorFeature.selectFontColor(Xs.v.TOOLBAR,e)},t.handleTdwClick=function(){this.fontColorFeature.reportShowPalette()},t.renderFontColorPicker=function(e){var t=e.from;return this.fontColorFeature.getFontColorPicker(t)},(0,Oo.Z)(e,[{key:"fontColorFeature",get:function(){return this.loader.instance}}]),e}();rd([(0,So.o)(m.HM.FONT_COLOR,"color"),(0,ii.z)("#000000"),id(0,(0,Qi.g)()),od("design:type",Function),od("design:paramtypes",["function"===typeof(Xc="undefined"!==typeof No.IActionPointInfo&&No.IActionPointInfo)?Xc:Object]),od("design:returntype",void 0)],sd.prototype,"getFontColor",null),rd([(0,So.o)(m.HM.FONT_COLOR,"onClick"),(0,ko.k)(),od("design:type",Function),od("design:paramtypes",[]),od("design:returntype",void 0)],sd.prototype,"handleSelectColor",null),rd([(0,So.o)(m.HM.FONT_COLOR,"onArrowClick"),(0,ko.k)(),od("design:type",Function),od("design:paramtypes",[]),od("design:returntype",void 0)],sd.prototype,"handleTdwClick",null),rd([(0,So.o)(m.HM.FONT_COLOR,"dropdownContent"),(0,ko.k)(qs.P),id(0,(0,Qi.g)()),od("design:type",Function),od("design:paramtypes",["function"===typeof(qc="undefined"!==typeof No.IActionPointInfo&&No.IActionPointInfo)?qc:Object]),od("design:returntype",void 0)],sd.prototype,"renderFontColorPicker",null),sd=rd([(0,C.Q)({adapters:[Z.L],toolbarItems:td.Jz}),id(0,(0,S.aN)(nd.B)),od("design:paramtypes",["function"===typeof(Qc="undefined"!==typeof No.IDynamicLoader&&No.IDynamicLoader)?Qc:Object])],sd);var ad=n("../spread-sheet/src/external/view/ui-layer/cut/cut-controller.ts"),cd=n("../spread-sheet/src/external/view/ui-layer/copy/copy-controller.ts"),dd=n("../spread-sheet/src/external/view/ui-layer/paste/paste-controller.ts"),ld=n("../spread-sheet/src/external/view/ui-layer/paste-special/paste-special-controller.ts"),ud=n("../spread-sheet/src/external/view/ui-layer/insert-cut-copy-cell/insert-cut-copy-cell-controller.ts"),_d=[{name:v.z_.INSERT_FLOAT_IMG,content:O.ZP.t("浮动图片"),icon:A.createElement("div",{className:"icon-svg-toolbar-add-photo"}),sheetStatusMiddleware:{isDisabledWhenCannotEdit:!0}}],pd=[{name:v.z_.INSERT_FLOAT_IMG,content:O.ZP.t("浮动图片"),sheetStatusMiddleware:{isDisabledWhenCannotEdit:!0}}],fd=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function s(e){try{c(r.next(e))}catch(t){i(t)}}function a(e){try{c(r.throw(e))}catch(t){i(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))},hd=Symbol.for("feature:insert-float-img");(0,qo.N)(hd,(function(){return fd(void 0,void 0,void 0,regeneratorRuntime.mark((function e(){var t,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([n.e("initial_chunk_part_2"),n.e("vendors-node_modules_tencent_docs-design-resources_pc_png_2x_cdn-function-export_js"),n.e("vendors-node_modules_tencent_docs-addon-sdk_lib_index_esm_js"),n.e("vendors-node_modules_tencent_docs-design-resources_pc_png_2x_cdn_js-node_modules_tencent_docs-70ebca"),n.e("vendors-node_modules_tencent_facade-config_dist_index_js"),n.e("vendors-node_modules_tencent_wedrive-component_dist_xdSaveDoc_css"),n.e("spread-sheet_src_base_util_decorator_loading-decorator_ts-spread-sheet_src_core_feature_copyP-33f189"),n.e("spread-sheet_src_core_view_level-2_condition-format-center_ui_utils_dataUtils_ts"),n.e("spread-sheet_src_core_workbench_common_base-drawer_tsx-spread-sheet_src_external_rangeAuth_ut-2939e0"),n.e("spread-sheet_src_core_view_level-2_chart_charts_chart-data-api_ts-spread-sheet_src_core_view_-9220ef"),n.e("spread-sheet_src_external_view_main_toolbar_IconBox_tsx"),n.e("spread-sheet_src_external_check-slr_sc-lazy-loader_ts-spread-sheet_src_external_templateinfo_-54b3ca"),n.e("spread-sheet_src_core_network_message-center_adapter_MessageCenterAdapter_interface_ts-spread-e88071"),n.e("spread-sheet_src_core_utils_gray_ts-spread-sheet_src_core_view_level-2_condition-format-cente-74d507"),n.e("spread-sheet_src_base_util_phone-number_ts-spread-sheet_src_core_feature_copyPaste_index_ts-s-89b53a"),n.e("spread-sheet_src_core_view_layout_pcView_ts"),n.e("spread-sheet_src_core_view_level-2_link-center_BaseLinkCenter_ts"),n.e("bundle_workbench_feature")]).then(n.bind(n,"../spread-sheet/src/external/view/ui-layer/insert-float-img/insert-float-img-feature.ts"));case 2:return t=e.sent,r=t.InsertFloatImgFeature,e.abrupt("return",r);case 5:case"end":return e.stop()}}),e)})))}));var md,vd=function(e,t,n,r){var o,i=arguments.length,s=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},yd=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},gd=function(e,t){return function(n,r){t(n,r,e)}},Ed=function(){function e(e){this.loader=e}return e.prototype.insertFloatImg=function(){this.insertFloatImgFeature.insertFloatImg()},(0,Oo.Z)(e,[{key:"insertFloatImgFeature",get:function(){return this.loader.instance}}]),e}();vd([(0,Ko.v)(v.z_.INSERT_FLOAT_IMG,"onClick"),(0,ko.k)(),yd("design:type",Function),yd("design:paramtypes",[]),yd("design:returntype",void 0)],Ed.prototype,"insertFloatImg",null),Ed=vd([(0,C.Q)({adapters:[Z.L],menuItems:_d,contextMenuItems:pd}),gd(0,(0,S.aN)(hd)),yd("design:paramtypes",["function"===typeof(md="undefined"!==typeof No.IDynamicLoader&&No.IDynamicLoader)?md:Object])],Ed);var wd,bd,Td=n("../spread-sheet/src/external/view/ui-layer/auto-wrap/auto-wrap-controller.ts"),Rd=n("../spread-sheet/src/external/view/ui-layer/formula/formula-controller.tsx"),Id=n("../spread-sheet/src/external/view/ui-layer/filter/filter-controller.tsx"),Cd=n("../node_modules/@tencent/workbench/lib/esm/decorators/method/mobile-toolbar.js"),Ad=n("../node_modules/@tencent/workbench/lib/esm/decorators/param/custom-args.js");!function(e){e.ASC_BY_RANGE="ascbyrange",e.DESC_BY_RANGE="desbyrange",e.DEFINE_RANGE="definerange"}(bd||(bd={}));var xd=[{name:m.HM.SORT,icon:A.createElement("div",{className:"icon-svg-toolbar_sort"}),hasArrow:!0,tooltip:O.ZP.t("排序"),type:"text",sheetStatusMiddleware:{isDisabledWhenCannotEdit:!0},inputStatusMiddleWareConfig:{isDisableWhenInput:!0},privateFillMiddleWareConfig:{shouldCheckWhenCellIsPrivate:!0}}],Od=((wd={})[bd.ASC_BY_RANGE]={content:O.ZP.t("升序")},wd[bd.DESC_BY_RANGE]={content:O.ZP.t("降序")},wd[bd.DEFINE_RANGE]={content:O.ZP.t("自定义排序"),tooltips:O.ZP.t("按指定列排序")},wd),Nd=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function s(e){try{c(r.next(e))}catch(t){i(t)}}function a(e){try{c(r.throw(e))}catch(t){i(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))},Sd=Symbol.for("feature:sort");(0,qo.N)(Sd,(function(){return Nd(void 0,void 0,void 0,regeneratorRuntime.mark((function e(){var t,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([n.e("initial_chunk_part_2"),n.e("vendors-node_modules_tencent_docs-design-resources_pc_png_2x_cdn-function-export_js"),n.e("vendors-node_modules_tencent_docs-addon-sdk_lib_index_esm_js"),n.e("vendors-node_modules_tencent_docs-design-resources_pc_png_2x_cdn_js-node_modules_tencent_docs-70ebca"),n.e("vendors-node_modules_tencent_facade-config_dist_index_js"),n.e("vendors-node_modules_tencent_wedrive-component_dist_xdSaveDoc_css"),n.e("spread-sheet_src_base_util_decorator_loading-decorator_ts-spread-sheet_src_core_feature_copyP-33f189"),n.e("spread-sheet_src_core_view_level-2_condition-format-center_ui_utils_dataUtils_ts"),n.e("spread-sheet_src_core_workbench_common_base-drawer_tsx-spread-sheet_src_external_rangeAuth_ut-2939e0"),n.e("spread-sheet_src_core_view_level-2_chart_charts_chart-data-api_ts-spread-sheet_src_core_view_-9220ef"),n.e("spread-sheet_src_external_view_main_toolbar_IconBox_tsx"),n.e("spread-sheet_src_external_check-slr_sc-lazy-loader_ts-spread-sheet_src_external_templateinfo_-54b3ca"),n.e("spread-sheet_src_core_network_message-center_adapter_MessageCenterAdapter_interface_ts-spread-e88071"),n.e("spread-sheet_src_core_utils_gray_ts-spread-sheet_src_core_view_level-2_condition-format-cente-74d507"),n.e("spread-sheet_src_base_util_phone-number_ts-spread-sheet_src_core_feature_copyPaste_index_ts-s-89b53a"),n.e("spread-sheet_src_core_view_layout_pcView_ts"),n.e("spread-sheet_src_core_view_level-2_link-center_BaseLinkCenter_ts"),n.e("bundle_workbench_feature")]).then(n.bind(n,"../spread-sheet/src/external/view/ui-layer/sort/sort-feature.tsx"));case 2:return t=e.sent,r=t.SortFeature,e.abrupt("return",r);case 5:case"end":return e.stop()}}),e)})))}));var kd,Pd,Dd=function(e,t,n,r){var o,i=arguments.length,s=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},Ld=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},Md=function(e,t){return function(n,r){t(n,r,e)}},Fd=function(){function e(e,t){this.toolbarModeFeature=e,this.loader=t}var t=e.prototype;return t.shouldSortDisabled=function(){return this.sortFeature.shouldDisableWhenPrivateFillArea()},t.sortDropdown=function(){var e=this;return A.createElement(Oc.E,{style:{width:120},items:this.getMenuItems(),type:Oc.R.Text,onChange:function(t){return e.setSort({sortBy:t})},className:"select-list-sort"})},t.shouldVerticallyArrange=function(){return this.toolbarModeFeature.getToolbarMode()===ro.ToolbarModeOrders.DOUBLE_LINE_TOOLBAR},t.text=function(){return this.toolbarModeFeature.getToolbarMode()===ro.ToolbarModeOrders.DOUBLE_LINE_TOOLBAR?O.ZP.t("排序"):""},t.setSort=function(e){this.sortFeature.setSort(e.sortBy)},t.defineRange=function(){this.sortFeature.defineRange()},t.getMenuItems=function(){var e=this.sortFeature.getSelection().activeCell.colIndex,t=(0,hn.colIndex2ColChar)(e);return[bd.ASC_BY_RANGE,bd.DESC_BY_RANGE].forEach((function(e){var n=Od[e].content;Od[e].tooltips=O.ZP.t("按照 {{selectedColumnName}} 列 {{content}}",{selectedColumnName:t,content:n})})),Object.keys(Od).map((function(e){return Object.assign({id:e},Od[e])}))},(0,Oo.Z)(e,[{key:"sortFeature",get:function(){return this.loader.instance}}]),e}();Dd([(0,So.o)(m.HM.SORT,"shouldDisabled"),(0,ii.z)(!1),Ld("design:type",Function),Ld("design:paramtypes",[]),Ld("design:returntype",void 0)],Fd.prototype,"shouldSortDisabled",null),Dd([(0,So.o)(m.HM.SORT,"dropdownContent"),(0,ko.k)(qs.P),Ld("design:type",Function),Ld("design:paramtypes",[]),Ld("design:returntype",void 0)],Fd.prototype,"sortDropdown",null),Dd([(0,So.o)(m.HM.SORT,"shouldVerticallyArrange"),Ld("design:type",Function),Ld("design:paramtypes",[]),Ld("design:returntype",void 0)],Fd.prototype,"shouldVerticallyArrange",null),Dd([(0,So.o)(m.HM.SORT,"text"),Ld("design:type",Function),Ld("design:paramtypes",[]),Ld("design:returntype",void 0)],Fd.prototype,"text",null),Dd([(0,Cd.n)(bd.ASC_BY_RANGE,"onClick",{horizontal:bd.ASC_BY_RANGE}),(0,Cd.n)(bd.DESC_BY_RANGE,"onClick",{horizontal:bd.DESC_BY_RANGE}),(0,ko.k)(),Md(0,(0,Ad.T)()),Ld("design:type",Function),Ld("design:paramtypes",[Object]),Ld("design:returntype",void 0)],Fd.prototype,"setSort",null),Dd([(0,Cd.n)(bd.DEFINE_RANGE,"onClick",{horizontal:bd.DEFINE_RANGE}),(0,ko.k)(),Ld("design:type",Function),Ld("design:paramtypes",[]),Ld("design:returntype",void 0)],Fd.prototype,"defineRange",null),Fd=Dd([(0,C.Q)({adapters:[Z.L],toolbarItems:xd}),Md(1,(0,S.aN)(Sd)),Ld("design:paramtypes",["function"===typeof(kd="undefined"!==typeof no.ToolbarModeFeature&&no.ToolbarModeFeature)?kd:Object,"function"===typeof(Pd="undefined"!==typeof No.IDynamicLoader&&No.IDynamicLoader)?Pd:Object])],Fd);var jd=n("../spread-sheet/src/external/view/ui-layer/background-color/background-color-controller.tsx"),Hd=n("../spread-sheet/src/external/view/ui-layer/float-img-context-menu/float-img-context-menu-controller.ts"),Zd=n("../spread-sheet/src/external/view/ui-layer/relate-form/form-create-controller.ts"),Bd=n("../spread-sheet/src/external/view/ui-layer/relate-form/form-operation-controller.ts"),zd=n("../spread-sheet/src/external/view/ui-layer/cell-border/controller.tsx"),Ud=n("../spread-sheet/src/external/view/ui-layer/merge/merge-controller.ts"),Vd=n("../spread-sheet/src/external/view/ui-layer/freeze/freeze-controller.tsx"),Wd=n("../spread-sheet/src/external/view/ui-layer/horizontal-align/horizontal-align-controller.tsx"),Gd=n("../spread-sheet/src/external/view/ui-layer/vertical-align/vertical-align-controller.tsx"),Yd=[{name:ho.B.CHART_DELETE,content:O.ZP.t("删除"),style:si.u,selectionMiddleware:{include:[ai.R.CHART]},sheetStatusMiddleware:{isHiddenWhenCannotEdit:!0}},{name:ho.B.CHART_EDIT,content:O.ZP.t("编辑图表类型与样式"),style:si.u,selectionMiddleware:{include:[ai.R.CHART]},sheetStatusMiddleware:{isHiddenWhenCannotEdit:!0}},{name:ho.B.CHART_TO_IMAGE,content:O.ZP.t("复制为图片"),style:si.u,selectionMiddleware:{include:[ai.R.CHART]}}],Kd=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function s(e){try{c(r.next(e))}catch(t){i(t)}}function a(e){try{c(r.throw(e))}catch(t){i(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))},Xd=Symbol.for("feature:chart-context-menu");(0,qo.N)(Xd,(function(){return Kd(void 0,void 0,void 0,regeneratorRuntime.mark((function e(){var t,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([n.e("initial_chunk_part_2"),n.e("vendors-node_modules_tencent_docs-design-resources_pc_png_2x_cdn-function-export_js"),n.e("vendors-node_modules_tencent_docs-addon-sdk_lib_index_esm_js"),n.e("vendors-node_modules_tencent_docs-design-resources_pc_png_2x_cdn_js-node_modules_tencent_docs-70ebca"),n.e("vendors-node_modules_tencent_facade-config_dist_index_js"),n.e("vendors-node_modules_tencent_wedrive-component_dist_xdSaveDoc_css"),n.e("spread-sheet_src_base_util_decorator_loading-decorator_ts-spread-sheet_src_core_feature_copyP-33f189"),n.e("spread-sheet_src_core_view_level-2_condition-format-center_ui_utils_dataUtils_ts"),n.e("spread-sheet_src_core_workbench_common_base-drawer_tsx-spread-sheet_src_external_rangeAuth_ut-2939e0"),n.e("spread-sheet_src_core_view_level-2_chart_charts_chart-data-api_ts-spread-sheet_src_core_view_-9220ef"),n.e("spread-sheet_src_external_view_main_toolbar_IconBox_tsx"),n.e("spread-sheet_src_external_check-slr_sc-lazy-loader_ts-spread-sheet_src_external_templateinfo_-54b3ca"),n.e("spread-sheet_src_core_network_message-center_adapter_MessageCenterAdapter_interface_ts-spread-e88071"),n.e("spread-sheet_src_core_utils_gray_ts-spread-sheet_src_core_view_level-2_condition-format-cente-74d507"),n.e("spread-sheet_src_base_util_phone-number_ts-spread-sheet_src_core_feature_copyPaste_index_ts-s-89b53a"),n.e("spread-sheet_src_core_view_layout_pcView_ts"),n.e("spread-sheet_src_core_view_level-2_link-center_BaseLinkCenter_ts"),n.e("bundle_workbench_feature")]).then(n.bind(n,"../spread-sheet/src/external/view/ui-layer/chart-context-menu/chart-context-menu-feature.ts"));case 2:return t=e.sent,r=t.ChartContextMenuFeature,e.abrupt("return",r);case 5:case"end":return e.stop()}}),e)})))}));var qd,Qd=function(e,t,n,r){var o,i=arguments.length,s=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},$d=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},Jd=function(e,t){return function(n,r){t(n,r,e)}},el=function(){function e(e){this.loader=e}var t=e.prototype;return t.delete=function(){this.chartContextMenuFeature.delete()},t.editChart=function(){this.chartContextMenuFeature.editChart()},t.toImage=function(){this.chartContextMenuFeature.toImage()},(0,Oo.Z)(e,[{key:"chartContextMenuFeature",get:function(){return this.loader.instance}}]),e}();Qd([(0,oi.x)(ho.B.CHART_DELETE,"onClick"),(0,ko.k)(),$d("design:type",Function),$d("design:paramtypes",[]),$d("design:returntype",void 0)],el.prototype,"delete",null),Qd([(0,oi.x)(ho.B.CHART_EDIT,"onClick"),(0,ko.k)(),$d("design:type",Function),$d("design:paramtypes",[]),$d("design:returntype",void 0)],el.prototype,"editChart",null),Qd([(0,oi.x)(ho.B.CHART_TO_IMAGE,"onClick"),(0,ko.k)(),$d("design:type",Function),$d("design:paramtypes",[]),$d("design:returntype",void 0)],el.prototype,"toImage",null),el=Qd([(0,C.Q)({adapters:[Z.L],contextMenuItems:Yd}),Jd(0,(0,S.aN)(Xd)),$d("design:paramtypes",["function"===typeof(qd="undefined"!==typeof No.IDynamicLoader&&No.IDynamicLoader)?qd:Object])],el);var tl=[{name:v.z_.EDIT_HISTORY,content:O.ZP.t("修订记录")}],nl=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function s(e){try{c(r.next(e))}catch(t){i(t)}}function a(e){try{c(r.throw(e))}catch(t){i(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))},rl=Symbol.for("feature:edit-history");(0,qo.N)(rl,(function(){return nl(void 0,void 0,void 0,regeneratorRuntime.mark((function e(){var t,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([n.e("initial_chunk_part_2"),n.e("vendors-node_modules_tencent_docs-design-resources_pc_png_2x_cdn-function-export_js"),n.e("vendors-node_modules_tencent_docs-addon-sdk_lib_index_esm_js"),n.e("vendors-node_modules_tencent_docs-design-resources_pc_png_2x_cdn_js-node_modules_tencent_docs-70ebca"),n.e("vendors-node_modules_tencent_facade-config_dist_index_js"),n.e("vendors-node_modules_tencent_wedrive-component_dist_xdSaveDoc_css"),n.e("spread-sheet_src_base_util_decorator_loading-decorator_ts-spread-sheet_src_core_feature_copyP-33f189"),n.e("spread-sheet_src_core_view_level-2_condition-format-center_ui_utils_dataUtils_ts"),n.e("spread-sheet_src_core_workbench_common_base-drawer_tsx-spread-sheet_src_external_rangeAuth_ut-2939e0"),n.e("spread-sheet_src_core_view_level-2_chart_charts_chart-data-api_ts-spread-sheet_src_core_view_-9220ef"),n.e("spread-sheet_src_external_view_main_toolbar_IconBox_tsx"),n.e("spread-sheet_src_external_check-slr_sc-lazy-loader_ts-spread-sheet_src_external_templateinfo_-54b3ca"),n.e("spread-sheet_src_core_network_message-center_adapter_MessageCenterAdapter_interface_ts-spread-e88071"),n.e("spread-sheet_src_core_utils_gray_ts-spread-sheet_src_core_view_level-2_condition-format-cente-74d507"),n.e("spread-sheet_src_base_util_phone-number_ts-spread-sheet_src_core_feature_copyPaste_index_ts-s-89b53a"),n.e("spread-sheet_src_core_view_layout_pcView_ts"),n.e("spread-sheet_src_core_view_level-2_link-center_BaseLinkCenter_ts"),n.e("bundle_workbench_feature")]).then(n.bind(n,"../spread-sheet/src/external/view/ui-layer/edit-history/edit-history-feature-pc.ts"));case 2:return t=e.sent,r=t.EditHistoryFeature,e.abrupt("return",r);case 5:case"end":return e.stop()}}),e)})))}));var ol,il=function(e,t,n,r){var o,i=arguments.length,s=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},sl=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},al=function(e,t){return function(n,r){t(n,r,e)}},cl=function(){function e(e){this.loader=e}var t=e.prototype;return t.showEditHistory=function(){this.feature.showEditHistory()},t.getContent=function(){return this.feature.getContent()},t.getDisabledState=function(){return this.feature.getDisabledState()},(0,Oo.Z)(e,[{key:"feature",get:function(){return this.loader.instance}}]),e}();il([(0,Ko.v)(v.z_.EDIT_HISTORY,"onClick"),(0,ko.k)(),sl("design:type",Function),sl("design:paramtypes",[]),sl("design:returntype",void 0)],cl.prototype,"showEditHistory",null),il([(0,Ko.v)(v.z_.EDIT_HISTORY,"content"),sl("design:type",Function),sl("design:paramtypes",[]),sl("design:returntype",void 0)],cl.prototype,"getContent",null),il([(0,Ko.v)(v.z_.EDIT_HISTORY,"shouldDisabled"),(0,ii.z)(!1),sl("design:type",Function),sl("design:paramtypes",[]),sl("design:returntype",void 0)],cl.prototype,"getDisabledState",null),cl=il([(0,C.Q)({adapters:[Z.L,B.dH],menuItems:tl}),al(0,(0,S.aN)(rl)),sl("design:paramtypes",["function"===typeof(ol="undefined"!==typeof No.IDynamicLoader&&No.IDynamicLoader)?ol:Object])],cl);var dl=[{name:v.z_.PRINT,content:O.ZP.t("打印"),description:(rt().isMac?"⌘":"Ctrl")+"+P"}],ll=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function s(e){try{c(r.next(e))}catch(t){i(t)}}function a(e){try{c(r.throw(e))}catch(t){i(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))},ul=Symbol.for("feature:print");(0,qo.N)(ul,(function(){return ll(void 0,void 0,void 0,regeneratorRuntime.mark((function e(){var t,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([n.e("initial_chunk_part_2"),n.e("vendors-node_modules_tencent_docs-design-resources_pc_png_2x_cdn-function-export_js"),n.e("vendors-node_modules_tencent_docs-addon-sdk_lib_index_esm_js"),n.e("vendors-node_modules_tencent_docs-design-resources_pc_png_2x_cdn_js-node_modules_tencent_docs-70ebca"),n.e("vendors-node_modules_tencent_facade-config_dist_index_js"),n.e("vendors-node_modules_tencent_wedrive-component_dist_xdSaveDoc_css"),n.e("spread-sheet_src_base_util_decorator_loading-decorator_ts-spread-sheet_src_core_feature_copyP-33f189"),n.e("spread-sheet_src_core_view_level-2_condition-format-center_ui_utils_dataUtils_ts"),n.e("spread-sheet_src_core_workbench_common_base-drawer_tsx-spread-sheet_src_external_rangeAuth_ut-2939e0"),n.e("spread-sheet_src_core_view_level-2_chart_charts_chart-data-api_ts-spread-sheet_src_core_view_-9220ef"),n.e("spread-sheet_src_external_view_main_toolbar_IconBox_tsx"),n.e("spread-sheet_src_external_check-slr_sc-lazy-loader_ts-spread-sheet_src_external_templateinfo_-54b3ca"),n.e("spread-sheet_src_core_network_message-center_adapter_MessageCenterAdapter_interface_ts-spread-e88071"),n.e("spread-sheet_src_core_utils_gray_ts-spread-sheet_src_core_view_level-2_condition-format-cente-74d507"),n.e("spread-sheet_src_base_util_phone-number_ts-spread-sheet_src_core_feature_copyPaste_index_ts-s-89b53a"),n.e("spread-sheet_src_core_view_layout_pcView_ts"),n.e("spread-sheet_src_core_view_level-2_link-center_BaseLinkCenter_ts"),n.e("bundle_workbench_feature")]).then(n.bind(n,"../spread-sheet/src/external/view/ui-layer/print/print-feature.ts"));case 2:return t=e.sent,r=t.PrintFeature,e.abrupt("return",r);case 5:case"end":return e.stop()}}),e)})))}));var _l,pl=function(e,t,n,r){var o,i=arguments.length,s=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},fl=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},hl=function(e,t){return function(n,r){t(n,r,e)}},ml=function(){function e(e){this.loader=e}var t=e.prototype;return t.showPrintPanel=function(){this.printFeature.showPrintPanel()},t.shouldDisabled=function(){return this.printFeature.shouldDisabled()},t.getToolTip=function(){return this.printFeature.getToolTip()},(0,Oo.Z)(e,[{key:"printFeature",get:function(){return this.loader.instance}}]),e}();pl([(0,Ko.v)(v.z_.PRINT,"onClick"),(0,ko.k)(),fl("design:type",Function),fl("design:paramtypes",[]),fl("design:returntype",void 0)],ml.prototype,"showPrintPanel",null),pl([(0,Ko.v)(v.z_.PRINT,"shouldDisabled"),(0,ii.z)(!1),fl("design:type",Function),fl("design:paramtypes",[]),fl("design:returntype",void 0)],ml.prototype,"shouldDisabled",null),pl([(0,Ko.v)(v.z_.PRINT,"tooltip"),(0,ii.z)(""),fl("design:type",Function),fl("design:paramtypes",[]),fl("design:returntype",void 0)],ml.prototype,"getToolTip",null),ml=pl([(0,C.Q)({adapters:[Z.L],menuItems:dl}),hl(0,(0,S.aN)(ul)),fl("design:paramtypes",["function"===typeof(_l="undefined"!==typeof No.IDynamicLoader&&No.IDynamicLoader)?_l:Object])],ml);var vl=[{name:v.z_.READ_RECORD,content:O.ZP.t("浏览记录")}],yl=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function s(e){try{c(r.next(e))}catch(t){i(t)}}function a(e){try{c(r.throw(e))}catch(t){i(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))},gl=Symbol.for("feature:read-record-pc");(0,qo.N)(gl,(function(){return yl(void 0,void 0,void 0,regeneratorRuntime.mark((function e(){var t,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([n.e("initial_chunk_part_2"),n.e("vendors-node_modules_tencent_docs-design-resources_pc_png_2x_cdn-function-export_js"),n.e("vendors-node_modules_tencent_docs-addon-sdk_lib_index_esm_js"),n.e("vendors-node_modules_tencent_docs-design-resources_pc_png_2x_cdn_js-node_modules_tencent_docs-70ebca"),n.e("vendors-node_modules_tencent_facade-config_dist_index_js"),n.e("vendors-node_modules_tencent_wedrive-component_dist_xdSaveDoc_css"),n.e("spread-sheet_src_base_util_decorator_loading-decorator_ts-spread-sheet_src_core_feature_copyP-33f189"),n.e("spread-sheet_src_core_view_level-2_condition-format-center_ui_utils_dataUtils_ts"),n.e("spread-sheet_src_core_workbench_common_base-drawer_tsx-spread-sheet_src_external_rangeAuth_ut-2939e0"),n.e("spread-sheet_src_core_view_level-2_chart_charts_chart-data-api_ts-spread-sheet_src_core_view_-9220ef"),n.e("spread-sheet_src_external_view_main_toolbar_IconBox_tsx"),n.e("spread-sheet_src_external_check-slr_sc-lazy-loader_ts-spread-sheet_src_external_templateinfo_-54b3ca"),n.e("spread-sheet_src_core_network_message-center_adapter_MessageCenterAdapter_interface_ts-spread-e88071"),n.e("spread-sheet_src_core_utils_gray_ts-spread-sheet_src_core_view_level-2_condition-format-cente-74d507"),n.e("spread-sheet_src_base_util_phone-number_ts-spread-sheet_src_core_feature_copyPaste_index_ts-s-89b53a"),n.e("spread-sheet_src_core_view_layout_pcView_ts"),n.e("spread-sheet_src_core_view_level-2_link-center_BaseLinkCenter_ts"),n.e("bundle_workbench_feature")]).then(n.bind(n,"../spread-sheet/src/external/view/ui-layer/read-record/read-record-feature-pc.ts"));case 2:return t=e.sent,r=t.ReadRecordFeaturePC,e.abrupt("return",r);case 5:case"end":return e.stop()}}),e)})))}));var El,wl=function(e,t,n,r){var o,i=arguments.length,s=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},bl=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},Tl=function(e,t){return function(n,r){t(n,r,e)}},Rl=function(){function e(e){this.loader=e}var t=e.prototype;return t.showReadRecord=function(){this.readRecordFeaturePC.showReadRecord()},t.getContent=function(){return this.readRecordFeaturePC.getContent()},t.getShouldHide=function(){return this.readRecordFeaturePC.getShouldHide()},(0,Oo.Z)(e,[{key:"readRecordFeaturePC",get:function(){return this.loader.instance}}]),e}();wl([(0,Ko.v)(v.z_.READ_RECORD,"onClick"),(0,ko.k)(),bl("design:type",Function),bl("design:paramtypes",[]),bl("design:returntype",void 0)],Rl.prototype,"showReadRecord",null),wl([(0,Ko.v)(v.z_.READ_RECORD,"content"),bl("design:type",Function),bl("design:paramtypes",[]),bl("design:returntype",void 0)],Rl.prototype,"getContent",null),wl([(0,Ko.v)(v.z_.READ_RECORD,"shouldHide"),(0,ii.z)(!1),bl("design:type",Function),bl("design:paramtypes",[]),bl("design:returntype",void 0)],Rl.prototype,"getShouldHide",null),Rl=wl([(0,C.Q)({adapters:[Z.L,B.dH],menuItems:vl}),Tl(0,(0,S.aN)(gl)),bl("design:paramtypes",["function"===typeof(El="undefined"!==typeof No.IDynamicLoader&&No.IDynamicLoader)?El:Object])],Rl),n("../node_modules/core-js/modules/es.array.includes.js"),n("../node_modules/core-js/modules/es.string.includes.js");var Il=n("../spread-sheet/src/external/view/main/toolbar/Icon.tsx"),Cl=n("../spread-sheet/src/core/feature/dataValidation/constant.ts"),Al=[{name:v.z_.DATA_VALIDATION_EDIT,content:O.ZP.t("数据验证")},{name:y.ZH.DATA_VALIDATION_SELECT,icon:x().createElement("div",{className:"icon-svg-menu-dv-dropdown"}),content:Cl.rX[Cl.cM.SELECT].text},{name:y.ZH.DATA_VALIDATION_CHECKBOX,icon:x().createElement("div",{className:"icon-svg-menu-dv-checkbox"}),content:Cl.rX[Cl.cM.CHECKBOX].text},{name:y.ZH.DATA_VALIDATION_STAR,icon:x().createElement("div",{className:"icon-svg-menu-dv-star"}),content:Cl.rX[Cl.cM.STAR].text},{name:y.ZH.DATA_VALIDATION_PROGRESS,icon:x().createElement("div",{className:"icon-svg-menu-dv-progress"}),content:Cl.rX[Cl.cM.PROGRESS].text},{name:y.ZH.DATA_VALIDATION_ID,icon:x().createElement("div",{className:"icon-svg-menu-dv-idcard"}),content:Cl.rX[Cl.cM.ID_CARD].text},{name:y.ZH.DATA_VALIDATION_PHONE,icon:x().createElement("div",{className:"icon-svg-menu-dv-phonenumber"}),content:Cl.rX[Cl.cM.PHONE_NUMBER].text},{name:y.ZH.DATA_VALIDATION_TELEPHONE,icon:x().createElement("div",{className:"icon-svg-menu-dv-telephonenumber"}),content:Cl.rX[Cl.cM.TELEPHONE_NUMBER].text},{name:y.ZH.DATA_VALIDATION_EMAIL,icon:x().createElement("div",{className:"icon-svg-menu-dv-email"}),content:Cl.rX[Cl.cM.EMAIL].text},{name:y.ZH.DATA_VALIDATION_NUMBER,icon:x().createElement("div",{className:"icon-svg-menu-dv-number"}),content:Cl.rX[Cl.cM.NUMBER].text},{name:y.ZH.DATA_VALIDATION_TEXT,icon:x().createElement("div",{className:"icon-svg-menu-dv-text"}),content:Cl.rX[Cl.cM.TEXT].text},{name:y.ZH.DATA_VALIDATION_DATE,icon:x().createElement("div",{className:"icon-svg-menu-dv-datetime"}),content:Cl.rX[Cl.cM.DATE_TIME].text},{name:y.ZH.DATA_VALIDATION_TEMPERATURE,icon:x().createElement("div",{className:"icon-svg-menu-dv-temperature"}),content:Cl.rX[Cl.cM.TEMPERATURE].text}],xl=[{name:ho.B.DATA_VALIDATION,content:O.ZP.t("数据验证"),selectionMiddleware:{exclude:[ai.R.SHAPE,ai.R.CHART]},sheetStatusMiddleware:{isHiddenWhenCannotEditExceptRangeAuth:!0,isDisableWhenRangeCannotEdit:!0},privateFillMiddleWareConfig:{shouldCheckWhenCellIsPrivate:!0}},{name:y.ZH.DATA_VALIDATION_SELECT,icon:x().createElement(Il.Z,{symbol:Cl.rX[Cl.cM.SELECT].iconName,showAnimate:!1,useDesignSVG:!0}),content:Cl.rX[Cl.cM.SELECT].text,style:si.u},{name:y.ZH.DATA_VALIDATION_CHECKBOX,icon:x().createElement(Il.Z,{symbol:Cl.rX[Cl.cM.CHECKBOX].iconName,showAnimate:!1,useDesignSVG:!0}),content:Cl.rX[Cl.cM.CHECKBOX].text,style:si.u},{name:y.ZH.DATA_VALIDATION_STAR,icon:x().createElement(Il.Z,{symbol:Cl.rX[Cl.cM.STAR].iconName,showAnimate:!1,useDesignSVG:!0}),content:Cl.rX[Cl.cM.STAR].text,style:si.u},{name:y.ZH.DATA_VALIDATION_PROGRESS,icon:x().createElement(Il.Z,{symbol:Cl.rX[Cl.cM.PROGRESS].iconName,showAnimate:!1,useDesignSVG:!0}),content:Cl.rX[Cl.cM.PROGRESS].text,style:si.u},{name:y.ZH.DATA_VALIDATION_ID,icon:x().createElement(Il.Z,{symbol:Cl.rX[Cl.cM.ID_CARD].iconName,showAnimate:!1,useDesignSVG:!0}),content:Cl.rX[Cl.cM.ID_CARD].text,style:si.u},{name:y.ZH.DATA_VALIDATION_PHONE,icon:x().createElement(Il.Z,{symbol:Cl.rX[Cl.cM.PHONE_NUMBER].iconName,showAnimate:!1,useDesignSVG:!0}),content:Cl.rX[Cl.cM.PHONE_NUMBER].text,style:si.u},{name:y.ZH.DATA_VALIDATION_TELEPHONE,icon:x().createElement(Il.Z,{symbol:Cl.rX[Cl.cM.TELEPHONE_NUMBER].iconName,showAnimate:!1,useDesignSVG:!0}),content:Cl.rX[Cl.cM.TELEPHONE_NUMBER].text,style:si.u},{name:y.ZH.DATA_VALIDATION_EMAIL,icon:x().createElement(Il.Z,{symbol:Cl.rX[Cl.cM.EMAIL].iconName,showAnimate:!1,useDesignSVG:!0}),content:Cl.rX[Cl.cM.EMAIL].text,style:si.u},{name:y.ZH.DATA_VALIDATION_NUMBER,icon:x().createElement(Il.Z,{symbol:Cl.rX[Cl.cM.NUMBER].iconName,showAnimate:!1,useDesignSVG:!0}),content:Cl.rX[Cl.cM.NUMBER].text,style:si.u},{name:y.ZH.DATA_VALIDATION_TEXT,icon:x().createElement(Il.Z,{symbol:Cl.rX[Cl.cM.TEXT].iconName,showAnimate:!1,useDesignSVG:!0}),content:Cl.rX[Cl.cM.TEXT].text,style:si.u},{name:y.ZH.DATA_VALIDATION_DATE,icon:x().createElement(Il.Z,{symbol:Cl.rX[Cl.cM.DATE_TIME].iconName,showAnimate:!1,useDesignSVG:!0}),content:Cl.rX[Cl.cM.DATE_TIME].text,style:si.u},{name:y.ZH.DATA_VALIDATION_TEMPERATURE,icon:x().createElement(Il.Z,{symbol:Cl.rX[Cl.cM.TEMPERATURE].iconName,showAnimate:!1,useDesignSVG:!0}),content:Cl.rX[Cl.cM.TEMPERATURE].text,style:si.u}],Ol=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function s(e){try{c(r.next(e))}catch(t){i(t)}}function a(e){try{c(r.throw(e))}catch(t){i(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))},Nl=Symbol.for("feature:data-validation");(0,qo.N)(Nl,(function(){return Ol(void 0,void 0,void 0,regeneratorRuntime.mark((function e(){var t,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([n.e("initial_chunk_part_2"),n.e("vendors-node_modules_tencent_docs-design-resources_pc_png_2x_cdn-function-export_js"),n.e("vendors-node_modules_tencent_docs-addon-sdk_lib_index_esm_js"),n.e("vendors-node_modules_tencent_docs-design-resources_pc_png_2x_cdn_js-node_modules_tencent_docs-70ebca"),n.e("vendors-node_modules_tencent_facade-config_dist_index_js"),n.e("vendors-node_modules_tencent_wedrive-component_dist_xdSaveDoc_css"),n.e("spread-sheet_src_base_util_decorator_loading-decorator_ts-spread-sheet_src_core_feature_copyP-33f189"),n.e("spread-sheet_src_core_view_level-2_condition-format-center_ui_utils_dataUtils_ts"),n.e("spread-sheet_src_core_workbench_common_base-drawer_tsx-spread-sheet_src_external_rangeAuth_ut-2939e0"),n.e("spread-sheet_src_core_view_level-2_chart_charts_chart-data-api_ts-spread-sheet_src_core_view_-9220ef"),n.e("spread-sheet_src_external_view_main_toolbar_IconBox_tsx"),n.e("spread-sheet_src_external_check-slr_sc-lazy-loader_ts-spread-sheet_src_external_templateinfo_-54b3ca"),n.e("spread-sheet_src_core_network_message-center_adapter_MessageCenterAdapter_interface_ts-spread-e88071"),n.e("spread-sheet_src_core_utils_gray_ts-spread-sheet_src_core_view_level-2_condition-format-cente-74d507"),n.e("spread-sheet_src_base_util_phone-number_ts-spread-sheet_src_core_feature_copyPaste_index_ts-s-89b53a"),n.e("spread-sheet_src_core_view_layout_pcView_ts"),n.e("spread-sheet_src_core_view_level-2_link-center_BaseLinkCenter_ts"),n.e("bundle_workbench_feature")]).then(n.bind(n,"../spread-sheet/src/external/view/ui-layer/data-validation/data-validation-feature.ts"));case 2:return t=e.sent,r=t.DataValidationFeature,e.abrupt("return",r);case 5:case"end":return e.stop()}}),e)})))}));var Sl,kl,Pl,Dl,Ll,Ml=function(e,t,n,r){var o,i=arguments.length,s=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},Fl=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},jl=function(e,t){return function(n,r){t(n,r,e)}},Hl=function(){function e(e){this.loader=e}var t=e.prototype;return t.handleDVClick=function(e){(e.path.includes(v.z_.EDIT)||this.dataValidationFeature.getActiveCellCustomUIType())&&this.dataValidationFeature.showDVPanel()},t.getSelectDataValidationDescriptionUp=function(e){if(e.path.includes(v.z_.EDIT))return this.dataValidationFeature.getActiveCellCustomUIType()?O.ZP.t("已开启"):O.ZP.t("下拉列表");var t=this.dataValidationFeature.getActiveCellCustomUIType();return t?Cl.rX[t].text:O.ZP.t("点击修改")},t.handleDVSubMenuClick=function(e){this.dataValidationFeature.handleDVSubMenuClick(e)},t.getSelectDataValidationHide=function(){return!!this.dataValidationFeature.getActiveCellCustomUIType()},(0,Oo.Z)(e,[{key:"dataValidationFeature",get:function(){return this.loader.instance}}]),e}();Ml([(0,oi.x)(ho.B.DATA_VALIDATION,"onClick"),(0,Ko.v)(v.z_.DATA_VALIDATION_EDIT,"onClick"),jl(0,(0,Qi.g)()),Fl("design:type",Function),Fl("design:paramtypes",["function"===typeof(Sl="undefined"!==typeof No.IActionPointInfo&&No.IActionPointInfo)?Sl:Object]),Fl("design:returntype",void 0)],Hl.prototype,"handleDVClick",null),Ml([(0,oi.x)(ho.B.DATA_VALIDATION,"description"),(0,Ko.v)(v.z_.DATA_VALIDATION_EDIT,"description"),jl(0,(0,Qi.g)()),Fl("design:type",Function),Fl("design:paramtypes",["function"===typeof(kl="undefined"!==typeof No.IActionPointInfo&&No.IActionPointInfo)?kl:Object]),Fl("design:returntype","function"===typeof(Pl="undefined"!==typeof A.ReactNode&&A.ReactNode)?Pl:Object)],Hl.prototype,"getSelectDataValidationDescriptionUp",null),Ml([(0,oi.x)(y.ZH.DATA_VALIDATION_SELECT,"onClick"),(0,oi.x)(y.ZH.DATA_VALIDATION_CHECKBOX,"onClick"),(0,oi.x)(y.ZH.DATA_VALIDATION_STAR,"onClick"),(0,oi.x)(y.ZH.DATA_VALIDATION_PROGRESS,"onClick"),(0,oi.x)(y.ZH.DATA_VALIDATION_ID,"onClick"),(0,oi.x)(y.ZH.DATA_VALIDATION_TELEPHONE,"onClick"),(0,oi.x)(y.ZH.DATA_VALIDATION_PHONE,"onClick"),(0,oi.x)(y.ZH.DATA_VALIDATION_EMAIL,"onClick"),(0,oi.x)(y.ZH.DATA_VALIDATION_DATE,"onClick"),(0,oi.x)(y.ZH.DATA_VALIDATION_TEXT,"onClick"),(0,oi.x)(y.ZH.DATA_VALIDATION_NUMBER,"onClick"),(0,oi.x)(y.ZH.DATA_VALIDATION_TEMPERATURE,"onClick"),(0,Ko.v)(y.ZH.DATA_VALIDATION_TEMPERATURE,"onClick"),(0,Ko.v)(y.ZH.DATA_VALIDATION_DATE,"onClick"),(0,Ko.v)(y.ZH.DATA_VALIDATION_EMAIL,"onClick"),(0,Ko.v)(y.ZH.DATA_VALIDATION_PHONE,"onClick"),(0,Ko.v)(y.ZH.DATA_VALIDATION_TELEPHONE,"onClick"),(0,Ko.v)(y.ZH.DATA_VALIDATION_ID,"onClick"),(0,Ko.v)(y.ZH.DATA_VALIDATION_PROGRESS,"onClick"),(0,Ko.v)(y.ZH.DATA_VALIDATION_STAR,"onClick"),(0,Ko.v)(y.ZH.DATA_VALIDATION_CHECKBOX,"onClick"),(0,Ko.v)(y.ZH.DATA_VALIDATION_SELECT,"onClick"),(0,Ko.v)(y.ZH.DATA_VALIDATION_TEXT,"onClick"),(0,Ko.v)(y.ZH.DATA_VALIDATION_NUMBER,"onClick"),(0,ko.k)(),jl(0,(0,Qi.g)()),Fl("design:type",Function),Fl("design:paramtypes",["function"===typeof(Dl="undefined"!==typeof No.IActionPointInfo&&No.IActionPointInfo)?Dl:Object]),Fl("design:returntype",void 0)],Hl.prototype,"handleDVSubMenuClick",null),Ml([(0,oi.x)(y.ZH.DATA_VALIDATION_SELECT,"shouldHide"),(0,oi.x)(y.ZH.DATA_VALIDATION_CHECKBOX,"shouldHide"),(0,oi.x)(y.ZH.DATA_VALIDATION_STAR,"shouldHide"),(0,oi.x)(y.ZH.DATA_VALIDATION_PROGRESS,"shouldHide"),(0,oi.x)(y.ZH.DATA_VALIDATION_ID,"shouldHide"),(0,oi.x)(y.ZH.DATA_VALIDATION_TELEPHONE,"shouldHide"),(0,oi.x)(y.ZH.DATA_VALIDATION_PHONE,"shouldHide"),(0,oi.x)(y.ZH.DATA_VALIDATION_EMAIL,"shouldHide"),(0,oi.x)(y.ZH.DATA_VALIDATION_DATE,"shouldHide"),(0,oi.x)(y.ZH.DATA_VALIDATION_TEXT,"shouldHide"),(0,oi.x)(y.ZH.DATA_VALIDATION_NUMBER,"shouldHide"),(0,oi.x)(y.ZH.DATA_VALIDATION_TEMPERATURE,"shouldHide"),(0,Ko.v)(y.ZH.DATA_VALIDATION_SELECT,"shouldHide"),(0,Ko.v)(y.ZH.DATA_VALIDATION_CHECKBOX,"shouldHide"),(0,Ko.v)(y.ZH.DATA_VALIDATION_STAR,"shouldHide"),(0,Ko.v)(y.ZH.DATA_VALIDATION_PROGRESS,"shouldHide"),(0,Ko.v)(y.ZH.DATA_VALIDATION_ID,"shouldHide"),(0,Ko.v)(y.ZH.DATA_VALIDATION_TELEPHONE,"shouldHide"),(0,Ko.v)(y.ZH.DATA_VALIDATION_PHONE,"shouldHide"),(0,Ko.v)(y.ZH.DATA_VALIDATION_EMAIL,"shouldHide"),(0,Ko.v)(y.ZH.DATA_VALIDATION_DATE,"shouldHide"),(0,Ko.v)(y.ZH.DATA_VALIDATION_TEXT,"shouldHide"),(0,Ko.v)(y.ZH.DATA_VALIDATION_NUMBER,"shouldHide"),(0,Ko.v)(y.ZH.DATA_VALIDATION_TEMPERATURE,"shouldHide"),Fl("design:type",Function),Fl("design:paramtypes",[]),Fl("design:returntype",void 0)],Hl.prototype,"getSelectDataValidationHide",null),Hl=Ml([(0,C.Q)({adapters:[Z.L],contextMenuItems:xl,menuItems:Al}),jl(0,(0,S.aN)(Nl)),Fl("design:paramtypes",["function"===typeof(Ll="undefined"!==typeof No.IDynamicLoader&&No.IDynamicLoader)?Ll:Object])],Hl);var Zl={width:168},Bl=[{name:ho.B.HYPERLINK_ICON_VISIBILITY,content:O.ZP.t("更改链接样式"),preventDismiss:!0,sheetStatusMiddleware:{isHiddenWhenCannotEditExceptRangeAuth:!0,isDisableWhenRangeCannotEdit:!0}},{name:ho.B.HYPERLINK_ICON_INVISIBLE,content:O.ZP.t("文字链"),icon:A.createElement("div",{className:"workbench-icon-hyperlink hyperlink-icon-invisible"}),style:Zl},{name:ho.B.HYPERLINK_ICON_VISIBLE,content:O.ZP.t("图标+文字链"),icon:A.createElement("div",{className:"workbench-icon-hyperlink hyperlink-icon-visible"}),style:Zl}],zl=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function s(e){try{c(r.next(e))}catch(t){i(t)}}function a(e){try{c(r.throw(e))}catch(t){i(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))},Ul=Symbol.for("feature:hyperlink-icon-visibility");(0,qo.N)(Ul,(function(){return zl(void 0,void 0,void 0,regeneratorRuntime.mark((function e(){var t,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([n.e("initial_chunk_part_2"),n.e("vendors-node_modules_tencent_docs-design-resources_pc_png_2x_cdn-function-export_js"),n.e("vendors-node_modules_tencent_docs-addon-sdk_lib_index_esm_js"),n.e("vendors-node_modules_tencent_docs-design-resources_pc_png_2x_cdn_js-node_modules_tencent_docs-70ebca"),n.e("vendors-node_modules_tencent_facade-config_dist_index_js"),n.e("vendors-node_modules_tencent_wedrive-component_dist_xdSaveDoc_css"),n.e("spread-sheet_src_base_util_decorator_loading-decorator_ts-spread-sheet_src_core_feature_copyP-33f189"),n.e("spread-sheet_src_core_view_level-2_condition-format-center_ui_utils_dataUtils_ts"),n.e("spread-sheet_src_core_workbench_common_base-drawer_tsx-spread-sheet_src_external_rangeAuth_ut-2939e0"),n.e("spread-sheet_src_core_view_level-2_chart_charts_chart-data-api_ts-spread-sheet_src_core_view_-9220ef"),n.e("spread-sheet_src_external_view_main_toolbar_IconBox_tsx"),n.e("spread-sheet_src_external_check-slr_sc-lazy-loader_ts-spread-sheet_src_external_templateinfo_-54b3ca"),n.e("spread-sheet_src_core_network_message-center_adapter_MessageCenterAdapter_interface_ts-spread-e88071"),n.e("spread-sheet_src_core_utils_gray_ts-spread-sheet_src_core_view_level-2_condition-format-cente-74d507"),n.e("spread-sheet_src_base_util_phone-number_ts-spread-sheet_src_core_feature_copyPaste_index_ts-s-89b53a"),n.e("spread-sheet_src_core_view_layout_pcView_ts"),n.e("spread-sheet_src_core_view_level-2_link-center_BaseLinkCenter_ts"),n.e("bundle_workbench_feature")]).then(n.bind(n,"../spread-sheet/src/external/view/ui-layer/hyperlink-icon-visibility/hyperlink-icon-visibility-feature.ts"));case 2:return t=e.sent,r=t.HyperlinkIconVisibilityFeature,e.abrupt("return",r);case 5:case"end":return e.stop()}}),e)})))}));var Vl,Wl,Gl,Yl=function(e,t,n,r){var o,i=arguments.length,s=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},Kl=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},Xl=function(e,t){return function(n,r){t(n,r,e)}},ql=function(){function e(e){this.loader=e}var t=e.prototype;return t.shouldHide=function(){return!this.hyperlinkIconVisibilityFeature.shouldShowHyperlinkIconVisibilityMenu()},t.shouldCheck=function(e){return this.hyperlinkIconVisibilityFeature.shouldCheckHyperlinkIconVisibilitySubmenu(e)},t.handleClick=function(e){this.hyperlinkIconVisibilityFeature.onClickHyperlinkIconVisibilityButton(e)},(0,Oo.Z)(e,[{key:"hyperlinkIconVisibilityFeature",get:function(){return this.loader.instance}}]),e}();Yl([(0,oi.x)(ho.B.HYPERLINK_ICON_VISIBILITY,"shouldHide"),(0,ii.z)(!0),Kl("design:type",Function),Kl("design:paramtypes",[]),Kl("design:returntype",Boolean)],ql.prototype,"shouldHide",null),Yl([(0,oi.x)(ho.B.HYPERLINK_ICON_INVISIBLE,"shouldCheck"),(0,oi.x)(ho.B.HYPERLINK_ICON_VISIBLE,"shouldCheck"),(0,ii.z)(!1),Xl(0,(0,Qi.g)()),Kl("design:type",Function),Kl("design:paramtypes",["function"===typeof(Vl="undefined"!==typeof No.IActionPointInfo&&No.IActionPointInfo)?Vl:Object]),Kl("design:returntype",Boolean)],ql.prototype,"shouldCheck",null),Yl([(0,oi.x)(ho.B.HYPERLINK_ICON_INVISIBLE,"onClick"),(0,oi.x)(ho.B.HYPERLINK_ICON_VISIBLE,"onClick"),(0,ko.k)(),Xl(0,(0,Qi.g)()),Kl("design:type",Function),Kl("design:paramtypes",["function"===typeof(Wl="undefined"!==typeof No.IActionPointInfo&&No.IActionPointInfo)?Wl:Object]),Kl("design:returntype",void 0)],ql.prototype,"handleClick",null),ql=Yl([(0,C.Q)({adapters:[Z.L],contextMenuItems:Bl}),Xl(0,(0,S.aN)(Ul)),Kl("design:paramtypes",["function"===typeof(Gl="undefined"!==typeof No.IDynamicLoader&&No.IDynamicLoader)?Gl:Object])],ql);var Ql=[{name:v.z_.FILE_INFO,preventHighlight:!0,style:{width:"auto",height:"auto",padding:"0px",background:"none",cursor:"normal"}}],$l=n("../spread-sheet/src/external/check-slr/sc-lazy-loader.ts"),Jl=function(e){function t(t){var n;return(n=e.call(this,t)||this).onPanelClick=function(e){e&&n.props.show()},n}return(0,s.Z)(t,e),t.prototype.render=function(){return x().createElement(A.Suspense,{fallback:x().createElement("div",null)},x().createElement($l.f_,{onPanelClick:this.onPanelClick,style:{paddingLeft:16,width:142},showInfoButton:!at.xc}))},t}(x().Component),eu=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function s(e){try{c(r.next(e))}catch(t){i(t)}}function a(e){try{c(r.throw(e))}catch(t){i(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))},tu=Symbol.for("feature:file-info-panel-pc");(0,qo.N)(tu,(function(){return eu(void 0,void 0,void 0,regeneratorRuntime.mark((function e(){var t,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([n.e("initial_chunk_part_2"),n.e("vendors-node_modules_tencent_docs-design-resources_pc_png_2x_cdn-function-export_js"),n.e("vendors-node_modules_tencent_docs-addon-sdk_lib_index_esm_js"),n.e("vendors-node_modules_tencent_docs-design-resources_pc_png_2x_cdn_js-node_modules_tencent_docs-70ebca"),n.e("vendors-node_modules_tencent_facade-config_dist_index_js"),n.e("vendors-node_modules_tencent_wedrive-component_dist_xdSaveDoc_css"),n.e("spread-sheet_src_base_util_decorator_loading-decorator_ts-spread-sheet_src_core_feature_copyP-33f189"),n.e("spread-sheet_src_core_view_level-2_condition-format-center_ui_utils_dataUtils_ts"),n.e("spread-sheet_src_core_workbench_common_base-drawer_tsx-spread-sheet_src_external_rangeAuth_ut-2939e0"),n.e("spread-sheet_src_core_view_level-2_chart_charts_chart-data-api_ts-spread-sheet_src_core_view_-9220ef"),n.e("spread-sheet_src_external_view_main_toolbar_IconBox_tsx"),n.e("spread-sheet_src_external_check-slr_sc-lazy-loader_ts-spread-sheet_src_external_templateinfo_-54b3ca"),n.e("spread-sheet_src_core_network_message-center_adapter_MessageCenterAdapter_interface_ts-spread-e88071"),n.e("spread-sheet_src_core_utils_gray_ts-spread-sheet_src_core_view_level-2_condition-format-cente-74d507"),n.e("spread-sheet_src_base_util_phone-number_ts-spread-sheet_src_core_feature_copyPaste_index_ts-s-89b53a"),n.e("spread-sheet_src_core_view_layout_pcView_ts"),n.e("spread-sheet_src_core_view_level-2_link-center_BaseLinkCenter_ts"),n.e("bundle_workbench_feature")]).then(n.bind(n,"../spread-sheet/src/external/view/ui-layer/file-info-panel/file-info-panel-feature-pc.tsx"));case 2:return t=e.sent,r=t.FileInfoFeaturePC,e.abrupt("return",r);case 5:case"end":return e.stop()}}),e)})))}));var nu,ru=function(e,t,n,r){var o,i=arguments.length,s=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},ou=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},iu=function(e,t){return function(n,r){t(n,r,e)}},su=function(){function e(e){this.loader=e}return e.prototype.panelContent=function(){return x().createElement(Jl,{show:this.feature.show})},(0,Oo.Z)(e,[{key:"feature",get:function(){return this.loader.instance}}]),e}();ru([(0,Ko.v)(v.z_.FILE_INFO,"content"),(0,ii.z)(x().createElement("div",null)),ou("design:type",Function),ou("design:paramtypes",[]),ou("design:returntype",void 0)],su.prototype,"panelContent",null),su=ru([(0,C.Q)({adapters:[Z.L,B.dH],menuItems:Ql}),iu(0,(0,S.aN)(tu)),ou("design:paramtypes",["function"===typeof(nu="undefined"!==typeof No.IDynamicLoader&&No.IDynamicLoader)?nu:Object])],su);var au=[{name:v.z_.GRID_LINE,content:O.ZP.t("隐藏网格线")}],cu=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function s(e){try{c(r.next(e))}catch(t){i(t)}}function a(e){try{c(r.throw(e))}catch(t){i(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))},du=Symbol.for("feature:grid-line");(0,qo.N)(du,(function(){return cu(void 0,void 0,void 0,regeneratorRuntime.mark((function e(){var t,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([n.e("initial_chunk_part_2"),n.e("vendors-node_modules_tencent_docs-design-resources_pc_png_2x_cdn-function-export_js"),n.e("vendors-node_modules_tencent_docs-addon-sdk_lib_index_esm_js"),n.e("vendors-node_modules_tencent_docs-design-resources_pc_png_2x_cdn_js-node_modules_tencent_docs-70ebca"),n.e("vendors-node_modules_tencent_facade-config_dist_index_js"),n.e("vendors-node_modules_tencent_wedrive-component_dist_xdSaveDoc_css"),n.e("spread-sheet_src_base_util_decorator_loading-decorator_ts-spread-sheet_src_core_feature_copyP-33f189"),n.e("spread-sheet_src_core_view_level-2_condition-format-center_ui_utils_dataUtils_ts"),n.e("spread-sheet_src_core_workbench_common_base-drawer_tsx-spread-sheet_src_external_rangeAuth_ut-2939e0"),n.e("spread-sheet_src_core_view_level-2_chart_charts_chart-data-api_ts-spread-sheet_src_core_view_-9220ef"),n.e("spread-sheet_src_external_view_main_toolbar_IconBox_tsx"),n.e("spread-sheet_src_external_check-slr_sc-lazy-loader_ts-spread-sheet_src_external_templateinfo_-54b3ca"),n.e("spread-sheet_src_core_network_message-center_adapter_MessageCenterAdapter_interface_ts-spread-e88071"),n.e("spread-sheet_src_core_utils_gray_ts-spread-sheet_src_core_view_level-2_condition-format-cente-74d507"),n.e("spread-sheet_src_base_util_phone-number_ts-spread-sheet_src_core_feature_copyPaste_index_ts-s-89b53a"),n.e("spread-sheet_src_core_view_layout_pcView_ts"),n.e("spread-sheet_src_core_view_level-2_link-center_BaseLinkCenter_ts"),n.e("bundle_workbench_feature")]).then(n.bind(n,"../spread-sheet/src/external/view/ui-layer/grid-lines/grid-line-feature.ts"));case 2:return t=e.sent,r=t.GridLineFeature,e.abrupt("return",r);case 5:case"end":return e.stop()}}),e)})))}));var lu,uu=function(e,t,n,r){var o,i=arguments.length,s=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},_u=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},pu=function(e,t){return function(n,r){t(n,r,e)}},fu=function(){function e(e){this.loader=e}var t=e.prototype;return t.handleGridLineChangeType=function(){this.gridLineFeature.changeType()},t.handleGridLineContentText=function(){return this.gridLineFeature.getGridlinesDidHide()?O.ZP.t("显示网格线"):O.ZP.t("隐藏网格线")},(0,Oo.Z)(e,[{key:"gridLineFeature",get:function(){return this.loader.instance}}]),e}();uu([(0,Ko.v)(v.z_.GRID_LINE,"onClick"),(0,ko.k)(),_u("design:type",Function),_u("design:paramtypes",[]),_u("design:returntype",void 0)],fu.prototype,"handleGridLineChangeType",null),uu([(0,Ko.v)(v.z_.GRID_LINE,"content"),(0,ii.z)(O.ZP.t("隐藏网格线")),_u("design:type",Function),_u("design:paramtypes",[]),_u("design:returntype",void 0)],fu.prototype,"handleGridLineContentText",null),fu=uu([(0,C.Q)({adapters:[Z.L],menuItems:au}),pu(0,(0,S.aN)(du)),_u("design:paramtypes",["function"===typeof(lu="undefined"!==typeof No.IDynamicLoader&&No.IDynamicLoader)?lu:Object])],fu);var hu=[{name:v.z_.DOC_AUTH,content:O.ZP.t("权限设置"),preventDismiss:!0,sheetStatusMiddleware:{isHiddenWhenNotOwnerOfDocument:!0}},{name:v.z_.AUTH_SETTING,content:O.ZP.t("文档权限"),sheetStatusMiddleware:{isHiddenWhenNotOwnerOfDocument:!0}},{name:v.z_.ADV_PERMISSION,content:O.ZP.t("高级权限"),sheetStatusMiddleware:{isHiddenWhenNotOwnerOfDocument:!0}},{name:v.z_.TRANSFER_AUTH,content:O.ZP.t("转让文档所有权"),sheetStatusMiddleware:{isHiddenWhenNotOwnerOfDocument:!0}}],mu=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function s(e){try{c(r.next(e))}catch(t){i(t)}}function a(e){try{c(r.throw(e))}catch(t){i(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))},vu=Symbol.for("feature:auth-pc");(0,qo.N)(vu,(function(){return mu(void 0,void 0,void 0,regeneratorRuntime.mark((function e(){var t,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([n.e("initial_chunk_part_2"),n.e("vendors-node_modules_tencent_docs-design-resources_pc_png_2x_cdn-function-export_js"),n.e("vendors-node_modules_tencent_docs-addon-sdk_lib_index_esm_js"),n.e("vendors-node_modules_tencent_docs-design-resources_pc_png_2x_cdn_js-node_modules_tencent_docs-70ebca"),n.e("vendors-node_modules_tencent_facade-config_dist_index_js"),n.e("vendors-node_modules_tencent_wedrive-component_dist_xdSaveDoc_css"),n.e("spread-sheet_src_base_util_decorator_loading-decorator_ts-spread-sheet_src_core_feature_copyP-33f189"),n.e("spread-sheet_src_core_view_level-2_condition-format-center_ui_utils_dataUtils_ts"),n.e("spread-sheet_src_core_workbench_common_base-drawer_tsx-spread-sheet_src_external_rangeAuth_ut-2939e0"),n.e("spread-sheet_src_core_view_level-2_chart_charts_chart-data-api_ts-spread-sheet_src_core_view_-9220ef"),n.e("spread-sheet_src_external_view_main_toolbar_IconBox_tsx"),n.e("spread-sheet_src_external_check-slr_sc-lazy-loader_ts-spread-sheet_src_external_templateinfo_-54b3ca"),n.e("spread-sheet_src_core_network_message-center_adapter_MessageCenterAdapter_interface_ts-spread-e88071"),n.e("spread-sheet_src_core_utils_gray_ts-spread-sheet_src_core_view_level-2_condition-format-cente-74d507"),n.e("spread-sheet_src_base_util_phone-number_ts-spread-sheet_src_core_feature_copyPaste_index_ts-s-89b53a"),n.e("spread-sheet_src_core_view_layout_pcView_ts"),n.e("spread-sheet_src_core_view_level-2_link-center_BaseLinkCenter_ts"),n.e("bundle_workbench_feature")]).then(n.bind(n,"../spread-sheet/src/external/view/ui-layer/auth/auth-feature-pc.ts"));case 2:return t=e.sent,r=t.AuthFeaturePC,e.abrupt("return",r);case 5:case"end":return e.stop()}}),e)})))}));var yu,gu=function(e,t,n,r){var o,i=arguments.length,s=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},Eu=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},wu=function(e,t){return function(n,r){t(n,r,e)}},bu=function(){function e(e){this.loader=e}var t=e.prototype;return t.handleAuthSetting=function(){this.authFeature.handleAuthSetting()},t.handleADVPermission=function(){this.authFeature.handleADVPermission()},t.handleTransferAuth=function(){this.authFeature.handleTransferAuth()},(0,Oo.Z)(e,[{key:"authFeature",get:function(){return this.loader.instance}}]),e}();gu([(0,Ko.v)(v.z_.AUTH_SETTING,"onClick"),(0,ko.k)(),Eu("design:type",Function),Eu("design:paramtypes",[]),Eu("design:returntype",void 0)],bu.prototype,"handleAuthSetting",null),gu([(0,Ko.v)(v.z_.ADV_PERMISSION,"onClick"),(0,ko.k)(),Eu("design:type",Function),Eu("design:paramtypes",[]),Eu("design:returntype",void 0)],bu.prototype,"handleADVPermission",null),gu([(0,Ko.v)(v.z_.TRANSFER_AUTH,"onClick"),(0,ko.k)(),Eu("design:type",Function),Eu("design:paramtypes",[]),Eu("design:returntype",void 0)],bu.prototype,"handleTransferAuth",null),bu=gu([(0,C.Q)({adapters:[Z.L,B.dH],menuItems:hu}),wu(0,(0,S.aN)(vu)),Eu("design:paramtypes",["function"===typeof(yu="undefined"!==typeof No.IDynamicLoader&&No.IDynamicLoader)?yu:Object])],bu);var Tu=n("../spread-sheet/src/external/view/ui-layer/hide-row-col/hide-row-col-controller.ts"),Ru=[{name:ho.B.SET_ROW_HEIGHT,content:O.ZP.t("设置行高"),selectionMiddleware:{include:[ai.R.ROW,ai.R.DISCONTINUOUS_ROWS,ai.R.ALL]},sheetStatusMiddleware:{isHiddenWhenCannotEditExceptRangeAuth:!0,isDisableWhenRangeCannotEdit:!0}},{name:ho.B.SET_COL_WIDTH,content:O.ZP.t("设置列宽"),selectionMiddleware:{include:[ai.R.COL,ai.R.DISCONTINUOUS_COLS,ai.R.ALL]},sheetStatusMiddleware:{isHiddenWhenCannotEditExceptRangeAuth:!0,isDisableWhenRangeCannotEdit:!0}}],Iu=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function s(e){try{c(r.next(e))}catch(t){i(t)}}function a(e){try{c(r.throw(e))}catch(t){i(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))},Cu=Symbol.for("feature:resize-row-col");(0,qo.N)(Cu,(function(){return Iu(void 0,void 0,void 0,regeneratorRuntime.mark((function e(){var t,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([n.e("initial_chunk_part_2"),n.e("vendors-node_modules_tencent_docs-design-resources_pc_png_2x_cdn-function-export_js"),n.e("vendors-node_modules_tencent_docs-addon-sdk_lib_index_esm_js"),n.e("vendors-node_modules_tencent_docs-design-resources_pc_png_2x_cdn_js-node_modules_tencent_docs-70ebca"),n.e("vendors-node_modules_tencent_facade-config_dist_index_js"),n.e("vendors-node_modules_tencent_wedrive-component_dist_xdSaveDoc_css"),n.e("spread-sheet_src_base_util_decorator_loading-decorator_ts-spread-sheet_src_core_feature_copyP-33f189"),n.e("spread-sheet_src_core_view_level-2_condition-format-center_ui_utils_dataUtils_ts"),n.e("spread-sheet_src_core_workbench_common_base-drawer_tsx-spread-sheet_src_external_rangeAuth_ut-2939e0"),n.e("spread-sheet_src_core_view_level-2_chart_charts_chart-data-api_ts-spread-sheet_src_core_view_-9220ef"),n.e("spread-sheet_src_external_view_main_toolbar_IconBox_tsx"),n.e("spread-sheet_src_external_check-slr_sc-lazy-loader_ts-spread-sheet_src_external_templateinfo_-54b3ca"),n.e("spread-sheet_src_core_network_message-center_adapter_MessageCenterAdapter_interface_ts-spread-e88071"),n.e("spread-sheet_src_core_utils_gray_ts-spread-sheet_src_core_view_level-2_condition-format-cente-74d507"),n.e("spread-sheet_src_base_util_phone-number_ts-spread-sheet_src_core_feature_copyPaste_index_ts-s-89b53a"),n.e("spread-sheet_src_core_view_layout_pcView_ts"),n.e("spread-sheet_src_core_view_level-2_link-center_BaseLinkCenter_ts"),n.e("bundle_workbench_feature")]).then(n.bind(n,"../spread-sheet/src/external/view/ui-layer/resize-row-col/resize-row-col-feature.ts"));case 2:return t=e.sent,r=t.ResizeRowColFeature,e.abrupt("return",r);case 5:case"end":return e.stop()}}),e)})))}));var Au,xu=function(e,t,n,r){var o,i=arguments.length,s=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},Ou=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},Nu=function(e,t){return function(n,r){t(n,r,e)}},Su=function(){function e(e){this.loader=e}var t=e.prototype;return t.setRowHeight=function(){this.resizeRowColFeature.setRowHeight()},t.setColWidth=function(){this.resizeRowColFeature.setColWidth()},t.getHideRowButtonHideState=function(){return!this.resizeRowColFeature.getSetRowHeightButtonVisiableState()},t.getHideColButtonHideState=function(){return!this.resizeRowColFeature.getSetColWidthButtonVisiableState()},(0,Oo.Z)(e,[{key:"resizeRowColFeature",get:function(){return this.loader.instance}}]),e}();xu([(0,oi.x)(ho.B.SET_ROW_HEIGHT,"onClick"),(0,ko.k)(),Ou("design:type",Function),Ou("design:paramtypes",[]),Ou("design:returntype",void 0)],Su.prototype,"setRowHeight",null),xu([(0,oi.x)(ho.B.SET_COL_WIDTH,"onClick"),(0,ko.k)(),Ou("design:type",Function),Ou("design:paramtypes",[]),Ou("design:returntype",void 0)],Su.prototype,"setColWidth",null),xu([(0,oi.x)(ho.B.SET_ROW_HEIGHT,"shouldHide"),(0,ii.z)(!1),Ou("design:type",Function),Ou("design:paramtypes",[]),Ou("design:returntype",void 0)],Su.prototype,"getHideRowButtonHideState",null),xu([(0,oi.x)(ho.B.SET_COL_WIDTH,"shouldHide"),(0,ii.z)(!1),Ou("design:type",Function),Ou("design:paramtypes",[]),Ou("design:returntype",void 0)],Su.prototype,"getHideColButtonHideState",null),Su=xu([(0,C.Q)({adapters:[Z.L],contextMenuItems:Ru}),Nu(0,(0,S.aN)(Cu)),Ou("design:paramtypes",["function"===typeof(Au="undefined"!==typeof No.IDynamicLoader&&No.IDynamicLoader)?Au:Object])],Su);var ku=[{name:ho.B.EXPORT_FILE,content:O.ZP.t("导出附件"),selectionMiddleware:{exclude:[ai.R.SHAPE,ai.R.CHART]},sheetStatusMiddleware:{isHiddenWhenCannotCopy:!0}}],Pu=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function s(e){try{c(r.next(e))}catch(t){i(t)}}function a(e){try{c(r.throw(e))}catch(t){i(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))},Du=Symbol.for("feature:download-file");(0,qo.N)(Du,(function(){return Pu(void 0,void 0,void 0,regeneratorRuntime.mark((function e(){var t,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([n.e("initial_chunk_part_2"),n.e("vendors-node_modules_tencent_docs-design-resources_pc_png_2x_cdn-function-export_js"),n.e("vendors-node_modules_tencent_docs-addon-sdk_lib_index_esm_js"),n.e("vendors-node_modules_tencent_docs-design-resources_pc_png_2x_cdn_js-node_modules_tencent_docs-70ebca"),n.e("vendors-node_modules_tencent_facade-config_dist_index_js"),n.e("vendors-node_modules_tencent_wedrive-component_dist_xdSaveDoc_css"),n.e("spread-sheet_src_base_util_decorator_loading-decorator_ts-spread-sheet_src_core_feature_copyP-33f189"),n.e("spread-sheet_src_core_view_level-2_condition-format-center_ui_utils_dataUtils_ts"),n.e("spread-sheet_src_core_workbench_common_base-drawer_tsx-spread-sheet_src_external_rangeAuth_ut-2939e0"),n.e("spread-sheet_src_core_view_level-2_chart_charts_chart-data-api_ts-spread-sheet_src_core_view_-9220ef"),n.e("spread-sheet_src_external_view_main_toolbar_IconBox_tsx"),n.e("spread-sheet_src_external_check-slr_sc-lazy-loader_ts-spread-sheet_src_external_templateinfo_-54b3ca"),n.e("spread-sheet_src_core_network_message-center_adapter_MessageCenterAdapter_interface_ts-spread-e88071"),n.e("spread-sheet_src_core_utils_gray_ts-spread-sheet_src_core_view_level-2_condition-format-cente-74d507"),n.e("spread-sheet_src_base_util_phone-number_ts-spread-sheet_src_core_feature_copyPaste_index_ts-s-89b53a"),n.e("spread-sheet_src_core_view_layout_pcView_ts"),n.e("spread-sheet_src_core_view_level-2_link-center_BaseLinkCenter_ts"),n.e("bundle_workbench_feature")]).then(n.bind(n,"../spread-sheet/src/external/view/ui-layer/download-file/download-file-feature.ts"));case 2:return t=e.sent,r=t.DownloadFileFeature,e.abrupt("return",r);case 5:case"end":return e.stop()}}),e)})))}));var Lu,Mu=function(e,t,n,r){var o,i=arguments.length,s=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},Fu=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},ju=function(e,t){return function(n,r){t(n,r,e)}},Hu=function(){function e(e){this.loader=e}var t=e.prototype;return t.getHideState=function(){return!!(!this.downloadFileFeature.hasFile()||rt().isPC&&rt().isWxMiniProgram)||(this.downloadFileFeature.reportDownloadPhotos("view"),!1)},t.downloadFile=function(){this.downloadFileFeature.startDownloadTask(),this.downloadFileFeature.reportDownloadPhotos("click")},(0,Oo.Z)(e,[{key:"downloadFileFeature",get:function(){return this.loader.instance}}]),e}();Mu([(0,oi.x)(ho.B.EXPORT_FILE,"shouldHide"),(0,ii.z)(!0),Fu("design:type",Function),Fu("design:paramtypes",[]),Fu("design:returntype",void 0)],Hu.prototype,"getHideState",null),Mu([(0,oi.x)(ho.B.EXPORT_FILE,"onClick"),(0,ko.k)(),Fu("design:type",Function),Fu("design:paramtypes",[]),Fu("design:returntype",void 0)],Hu.prototype,"downloadFile",null),Hu=Mu([(0,C.Q)({adapters:[Z.L],contextMenuItems:ku}),ju(0,(0,S.aN)(Du)),Fu("design:paramtypes",["function"===typeof(Lu="undefined"!==typeof No.IDynamicLoader&&No.IDynamicLoader)?Lu:Object])],Hu);var Zu=[{name:ho.B.CONVERT_IMAGE,content:O.ZP.t("转换图片"),selectionMiddleware:{exclude:[ai.R.SHAPE,ai.R.CHART]},sheetStatusMiddleware:{isHiddenWhenCannotEditExceptRangeAuth:!0,isDisableWhenRangeCannotEdit:!0}},{name:ho.B.CONVERT_CELL_IMAGE,content:O.ZP.t("转为单元格图片"),selectionMiddleware:{exclude:[ai.R.SHAPE,ai.R.CHART]}},{name:ho.B.CONVERT_FLOAT_IMAGE,content:O.ZP.t("转为浮动图片"),selectionMiddleware:{exclude:[ai.R.SHAPE,ai.R.CHART]},sheetStatusMiddleware:{isHiddenWhenCannotEdit:!0}}],Bu=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function s(e){try{c(r.next(e))}catch(t){i(t)}}function a(e){try{c(r.throw(e))}catch(t){i(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))},zu=Symbol.for("feature:convert-to-image");(0,qo.N)(zu,(function(){return Bu(void 0,void 0,void 0,regeneratorRuntime.mark((function e(){var t,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([n.e("initial_chunk_part_2"),n.e("vendors-node_modules_tencent_docs-design-resources_pc_png_2x_cdn-function-export_js"),n.e("vendors-node_modules_tencent_docs-addon-sdk_lib_index_esm_js"),n.e("vendors-node_modules_tencent_docs-design-resources_pc_png_2x_cdn_js-node_modules_tencent_docs-70ebca"),n.e("vendors-node_modules_tencent_facade-config_dist_index_js"),n.e("vendors-node_modules_tencent_wedrive-component_dist_xdSaveDoc_css"),n.e("spread-sheet_src_base_util_decorator_loading-decorator_ts-spread-sheet_src_core_feature_copyP-33f189"),n.e("spread-sheet_src_core_view_level-2_condition-format-center_ui_utils_dataUtils_ts"),n.e("spread-sheet_src_core_workbench_common_base-drawer_tsx-spread-sheet_src_external_rangeAuth_ut-2939e0"),n.e("spread-sheet_src_core_view_level-2_chart_charts_chart-data-api_ts-spread-sheet_src_core_view_-9220ef"),n.e("spread-sheet_src_external_view_main_toolbar_IconBox_tsx"),n.e("spread-sheet_src_external_check-slr_sc-lazy-loader_ts-spread-sheet_src_external_templateinfo_-54b3ca"),n.e("spread-sheet_src_core_network_message-center_adapter_MessageCenterAdapter_interface_ts-spread-e88071"),n.e("spread-sheet_src_core_utils_gray_ts-spread-sheet_src_core_view_level-2_condition-format-cente-74d507"),n.e("spread-sheet_src_base_util_phone-number_ts-spread-sheet_src_core_feature_copyPaste_index_ts-s-89b53a"),n.e("spread-sheet_src_core_view_layout_pcView_ts"),n.e("spread-sheet_src_core_view_level-2_link-center_BaseLinkCenter_ts"),n.e("bundle_workbench_feature")]).then(n.bind(n,"../spread-sheet/src/external/view/ui-layer/convert-image/convert-to-image-feature.tsx"));case 2:return t=e.sent,r=t.ConvertToImageFeature,e.abrupt("return",r);case 5:case"end":return e.stop()}}),e)})))}));var Uu,Vu=function(e,t,n,r){var o,i=arguments.length,s=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},Wu=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},Gu=function(e,t){return function(n,r){t(n,r,e)}},Yu=function(){function e(e){this.loader=e}var t=e.prototype;return t.convertCellImages=function(){this.convertToImageFeature.convertCellImages()},t.convertFloatImages=function(){this.convertToImageFeature.convertFloatImages()},t.convertImageShouldHide=function(){return!this.convertToImageFeature.hasCellImage()&&!this.convertToImageFeature.hasFloatImage()},t.convertCellImageShouldHide=function(){return!this.convertToImageFeature.hasFloatImage()},t.convertFloatImageShouldHide=function(){return!this.convertToImageFeature.hasCellImage()},(0,Oo.Z)(e,[{key:"convertToImageFeature",get:function(){return this.loader.instance}}]),e}();Vu([(0,oi.x)(ho.B.CONVERT_CELL_IMAGE,"onClick"),(0,ko.k)(),Wu("design:type",Function),Wu("design:paramtypes",[]),Wu("design:returntype",void 0)],Yu.prototype,"convertCellImages",null),Vu([(0,oi.x)(ho.B.CONVERT_FLOAT_IMAGE,"onClick"),(0,ko.k)(),Wu("design:type",Function),Wu("design:paramtypes",[]),Wu("design:returntype",void 0)],Yu.prototype,"convertFloatImages",null),Vu([(0,oi.x)(ho.B.CONVERT_IMAGE,"shouldHide"),(0,ii.z)(!0),Wu("design:type",Function),Wu("design:paramtypes",[]),Wu("design:returntype",void 0)],Yu.prototype,"convertImageShouldHide",null),Vu([(0,oi.x)(ho.B.CONVERT_CELL_IMAGE,"shouldHide"),(0,ii.z)(!0),Wu("design:type",Function),Wu("design:paramtypes",[]),Wu("design:returntype",void 0)],Yu.prototype,"convertCellImageShouldHide",null),Vu([(0,oi.x)(ho.B.CONVERT_FLOAT_IMAGE,"shouldHide"),(0,ii.z)(!0),Wu("design:type",Function),Wu("design:paramtypes",[]),Wu("design:returntype",void 0)],Yu.prototype,"convertFloatImageShouldHide",null),Yu=Vu([(0,C.Q)({adapters:[Z.L],contextMenuItems:Zu}),Gu(0,(0,S.aN)(zu)),Wu("design:paramtypes",["function"===typeof(Uu="undefined"!==typeof No.IDynamicLoader&&No.IDynamicLoader)?Uu:Object])],Yu);var Ku,Xu=n("../spread-sheet/src/external/view/ui-layer/toolbar-mode/report.ts"),qu=function(e,t,n,r){var o,i=arguments.length,s=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},Qu=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},$u=function(e){function t(){var t;return(t=e.apply(this,arguments)||this).handleMouseMouse=function(e){e.nativeEvent.stopImmediatePropagation()},t.handleClick=function(){(0,Xu.I3)(),t.toolbarModeFeature.selectToolbarMode()},t}return(0,s.Z)(t,e),t.prototype.render=function(){return x().createElement("div",{className:"immersive-button",style:Object.assign({},this.props.style),onClick:this.handleClick,onMouseMove:this.handleMouseMouse},x().createElement(N.default,{title:O.ZP.t("ui|toolbar.showToolbar")+"("+(rt().isMac?"⌘+F1":"Ctrl+F1")+")",alignment:"end",placement:"bottom"},x().createElement("div",{className:"icon-svg-immersive-button"})))},t}(x().Component);qu([(0,S.tB)(),Qu("design:type","function"===typeof(Ku="undefined"!==typeof no.ToolbarModeFeature&&no.ToolbarModeFeature)?Ku:Object)],$u.prototype,"toolbarModeFeature",void 0);var Ju,e_,t_,n_=function(e,t,n,r){var o,i=arguments.length,s=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},r_=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},o_=function(){function e(e,t,n){this.toolbarModeFeature=e,n.register("unfold",{duration:350,entered:{top:-26,opacity:0,transitionTimingFunction:"cubic-bezier(0.42, 0, 0.58, 1), cubic-bezier(0.25, 0.1, 0.25, 1)",transitionProperty:"top, opacity",transitionDuration:"0.35s, 0.35s"},entering:{top:0,opacity:1,transitionTimingFunction:"cubic-bezier(0.42, 0, 0.58, 1), cubic-bezier(0.25, 0.1, 0.25, 1)",transitionProperty:"top, opacity",transitionDuration:"0.35s, 0.35s"},exited:{top:0,opacity:1,transitionTimingFunction:"cubic-bezier(0.42, 0, 0.58, 1)",transitionProperty:"top, opacity",transitionDuration:"0.35s"},exiting:{top:-26,opacity:0,transitionTimingFunction:"cubic-bezier(0.42, 0, 0.58, 1)",transitionProperty:"top, opacity",transitionDuration:"0.35s"}}),t.float({name:"unfold",layer:"lower",component:x().createElement(Lr.K,{name:"unfold"},x().createElement($u,null))})}var t=e.prototype;return t.renderMenu=function(){var e={align:"left",name:v.z_.TOOLBAR_MODE,mode:"menu"};return x().createElement(Qn.l,Object.assign({},e))},t.reportDropdown=function(){this.toolbarModeFeature.handleReportOpen()},t.shouldCheckSingl=function(){return this.toolbarModeFeature.getUserToolbarMode()===ro.ToolbarModeOrders.SINGLE_LINE_TOOLBAR},t.shouldCheckDouble=function(){return this.toolbarModeFeature.getUserToolbarMode()===ro.ToolbarModeOrders.DOUBLE_LINE_TOOLBAR},t.shouldCheckImmersive=function(){return this.toolbarModeFeature.getUserToolbarMode()===ro.ToolbarModeOrders.HIDE_TOOLBAR},t.shouldHideToolbarMode=function(){return this.toolbarModeFeature.shouldHideToolbarMode()},t.handleSingleClick=function(){this.toolbarModeFeature.handeleReportChange(ro.ToolbarModeOrders.SINGLE_LINE_TOOLBAR),this.toolbarModeFeature.selectToolbarMode(ro.ToolbarModeOrders.SINGLE_LINE_TOOLBAR)},t.handleDoubleLineClick=function(){this.toolbarModeFeature.handeleReportChange(ro.ToolbarModeOrders.DOUBLE_LINE_TOOLBAR),this.toolbarModeFeature.selectToolbarMode(ro.ToolbarModeOrders.DOUBLE_LINE_TOOLBAR)},t.handleImmersiveClick=function(){this.toolbarModeFeature.handeleReportChange(ro.ToolbarModeOrders.HIDE_TOOLBAR),this.toolbarModeFeature.selectToolbarMode(ro.ToolbarModeOrders.HIDE_TOOLBAR)},t.shouldHideDouble=function(){return this.toolbarModeFeature.shouldHideDouble()},e}();n_([(0,So.o)(v.z_.TOOLBAR_MODE,"dropdownContent"),r_("design:type",Function),r_("design:paramtypes",[]),r_("design:returntype",void 0)],o_.prototype,"renderMenu",null),n_([(0,So.o)(v.z_.TOOLBAR_MODE,"onClick"),r_("design:type",Function),r_("design:paramtypes",[]),r_("design:returntype",void 0)],o_.prototype,"reportDropdown",null),n_([(0,Ko.v)(v.z_.SINGLE_LINE_TOOLBAR,"shouldCheck"),r_("design:type",Function),r_("design:paramtypes",[]),r_("design:returntype",void 0)],o_.prototype,"shouldCheckSingl",null),n_([(0,Ko.v)(v.z_.DOUBLE_LINE_TOOLBAR,"shouldCheck"),r_("design:type",Function),r_("design:paramtypes",[]),r_("design:returntype",void 0)],o_.prototype,"shouldCheckDouble",null),n_([(0,Ko.v)(v.z_.HIDE_TOOLBAR,"shouldCheck"),r_("design:type",Function),r_("design:paramtypes",[]),r_("design:returntype",void 0)],o_.prototype,"shouldCheckImmersive",null),n_([(0,Ko.v)(v.z_.HIDE_TOOLBAR,"shouldHide"),r_("design:type",Function),r_("design:paramtypes",[]),r_("design:returntype",void 0)],o_.prototype,"shouldHideToolbarMode",null),n_([(0,Ko.v)(v.z_.SINGLE_LINE_TOOLBAR,"onClick"),r_("design:type",Function),r_("design:paramtypes",[]),r_("design:returntype",void 0)],o_.prototype,"handleSingleClick",null),n_([(0,Ko.v)(v.z_.DOUBLE_LINE_TOOLBAR,"onClick"),r_("design:type",Function),r_("design:paramtypes",[]),r_("design:returntype",void 0)],o_.prototype,"handleDoubleLineClick",null),n_([(0,Ko.v)(v.z_.HIDE_TOOLBAR,"onClick"),r_("design:type",Function),r_("design:paramtypes",[]),r_("design:returntype",void 0)],o_.prototype,"handleImmersiveClick",null),n_([(0,Ko.v)(v.z_.DOUBLE_LINE_TOOLBAR,"shouldHide"),r_("design:type",Function),r_("design:paramtypes",[]),r_("design:returntype",void 0)],o_.prototype,"shouldHideDouble",null),o_=n_([(0,C.Q)({adapters:[Z.L,B.dH],toolbarItems:ro.TOOLBAR_ITEMS,menuItems:ro.MENU_ITEMS}),r_("design:paramtypes",["function"===typeof(Ju="undefined"!==typeof no.ToolbarModeFeature&&no.ToolbarModeFeature)?Ju:Object,"function"===typeof(e_="undefined"!==typeof vo.i&&vo.i)?e_:Object,"function"===typeof(t_="undefined"!==typeof Mr.Z&&Mr.Z)?t_:Object])],o_);var i_,s_=[{name:v.z_.PAGE_SETTING,content:""}],a_=[{name:m.HM.PAGE_SETTING,icon:A.createElement("div",{className:"icon-svg-toolbar_pagesettings"}),tooltip:O.ZP.t("ui|toolbar.pageSettings"),type:"text",style:{width:"auto"},sheetStatusMiddleware:{isDisabledWhenCannotEdit:!0},inputStatusMiddleWareConfig:{isDisableWhenInput:!1}}],c_=function(e,t,n,r){var o,i=arguments.length,s=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},d_=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},l_=function(){function e(e){this.toolbarModeFeature=e}var t=e.prototype;return t.insertDropdown=function(){return A.createElement(Qn.l,{align:"left",name:v.z_.PAGE_SETTING,mode:"menu"})},t.shouldVerticallyArrange=function(){return this.toolbarModeFeature.getToolbarMode()===ro.ToolbarModeOrders.DOUBLE_LINE_TOOLBAR},t.text=function(){return this.toolbarModeFeature.getToolbarMode()===ro.ToolbarModeOrders.DOUBLE_LINE_TOOLBAR?O.ZP.t("ui|toolbar.pageSettings"):""},e}();c_([(0,So.o)(m.HM.PAGE_SETTING,"dropdownContent"),d_("design:type",Function),d_("design:paramtypes",[]),d_("design:returntype",void 0)],l_.prototype,"insertDropdown",null),c_([(0,So.o)(m.HM.PAGE_SETTING,"shouldVerticallyArrange"),d_("design:type",Function),d_("design:paramtypes",[]),d_("design:returntype",void 0)],l_.prototype,"shouldVerticallyArrange",null),c_([(0,So.o)(m.HM.PAGE_SETTING,"text"),d_("design:type",Function),d_("design:paramtypes",[]),d_("design:returntype",void 0)],l_.prototype,"text",null),l_=c_([(0,C.Q)({adapters:[Z.L],toolbarItems:a_,menuItems:s_}),d_("design:paramtypes",["function"===typeof(i_="undefined"!==typeof no.ToolbarModeFeature&&no.ToolbarModeFeature)?i_:Object])],l_);var u_=n("../spread-sheet/src/external/view/ui-layer/insert-attachment/insert-attachment-controller.ts"),__=n("../spread-sheet/src/external/view/ui-layer/insert-comment/insert-comment-controller.ts"),p_=(n("../spread-sheet/src/external/view/ui-layer/comment-ent/comment-ent-controller.tsx"),[{name:v.z_.PRIVATE_FILL,content:O.ZP.t("column-type|开启列填写内容隐藏")}]),f_=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function s(e){try{c(r.next(e))}catch(t){i(t)}}function a(e){try{c(r.throw(e))}catch(t){i(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))},h_=Symbol.for("feature:private-fill");(0,qo.N)(h_,(function(){return f_(void 0,void 0,void 0,regeneratorRuntime.mark((function e(){var t,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([n.e("initial_chunk_part_2"),n.e("vendors-node_modules_tencent_docs-design-resources_pc_png_2x_cdn-function-export_js"),n.e("vendors-node_modules_tencent_docs-addon-sdk_lib_index_esm_js"),n.e("vendors-node_modules_tencent_docs-design-resources_pc_png_2x_cdn_js-node_modules_tencent_docs-70ebca"),n.e("vendors-node_modules_tencent_facade-config_dist_index_js"),n.e("vendors-node_modules_tencent_wedrive-component_dist_xdSaveDoc_css"),n.e("spread-sheet_src_base_util_decorator_loading-decorator_ts-spread-sheet_src_core_feature_copyP-33f189"),n.e("spread-sheet_src_core_view_level-2_condition-format-center_ui_utils_dataUtils_ts"),n.e("spread-sheet_src_core_workbench_common_base-drawer_tsx-spread-sheet_src_external_rangeAuth_ut-2939e0"),n.e("spread-sheet_src_core_view_level-2_chart_charts_chart-data-api_ts-spread-sheet_src_core_view_-9220ef"),n.e("spread-sheet_src_external_view_main_toolbar_IconBox_tsx"),n.e("spread-sheet_src_external_check-slr_sc-lazy-loader_ts-spread-sheet_src_external_templateinfo_-54b3ca"),n.e("spread-sheet_src_core_network_message-center_adapter_MessageCenterAdapter_interface_ts-spread-e88071"),n.e("spread-sheet_src_core_utils_gray_ts-spread-sheet_src_core_view_level-2_condition-format-cente-74d507"),n.e("spread-sheet_src_base_util_phone-number_ts-spread-sheet_src_core_feature_copyPaste_index_ts-s-89b53a"),n.e("spread-sheet_src_core_view_layout_pcView_ts"),n.e("spread-sheet_src_core_view_level-2_link-center_BaseLinkCenter_ts"),n.e("bundle_workbench_feature")]).then(n.bind(n,"../spread-sheet/src/external/view/ui-layer/private-fill/private-fill-feature.ts"));case 2:return t=e.sent,r=t.PrivateFillFeature,e.abrupt("return",r);case 5:case"end":return e.stop()}}),e)})))}));var m_,v_=function(e,t,n,r){var o,i=arguments.length,s=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},y_=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},g_=function(e,t){return function(n,r){t(n,r,e)}},E_=function(){function e(e){this.loader=e}var t=e.prototype;return t.handlePrivateFill=function(){if(this.privateFillFeature.isPrivateFillOn())return oe.ZP.tdwReport({opername:"doc_excel",module:"privacy_fill",action:"clk_tb_close"}),void this.privateFillFeature.turnOffPrivateFill();oe.ZP.tdwReport({opername:"doc_excel",module:"privacy_fill",action:"clk_tb"}),this.privateFillFeature.turnOnPrivateFill()},t.handlePrivateFillContent=function(){return this.privateFillFeature.isPrivateFillOn()?(oe.ZP.tdwReport({opername:"doc_excel",module:"privacy_fill",action:"view_tb_close",ver6:F.q.getConfig("isOwner")?1:2}),O.ZP.t("关闭列填写内容隐藏")):(oe.ZP.tdwReport({opername:"doc_excel",module:"privacy_fill",action:"view_tb",ver6:F.q.getConfig("isOwner")?1:2}),O.ZP.t("column-type|开启列填写内容隐藏"))},t.handlePrivateFillDisabled=function(){return this.privateFillFeature.shouldDisablePrivateFill()},(0,Oo.Z)(e,[{key:"privateFillFeature",get:function(){return this.loader.instance}}]),e}();v_([(0,Ko.v)(v.z_.PRIVATE_FILL,"onClick"),(0,ko.k)(),y_("design:type",Function),y_("design:paramtypes",[]),y_("design:returntype",void 0)],E_.prototype,"handlePrivateFill",null),v_([(0,Ko.v)(v.z_.PRIVATE_FILL,"content"),(0,ii.z)(O.ZP.t("开启列隐私保护")),y_("design:type",Function),y_("design:paramtypes",[]),y_("design:returntype",void 0)],E_.prototype,"handlePrivateFillContent",null),v_([(0,Ko.v)(v.z_.PRIVATE_FILL,"shouldDisabled"),(0,ii.z)(!1),y_("design:type",Function),y_("design:paramtypes",[]),y_("design:returntype",void 0)],E_.prototype,"handlePrivateFillDisabled",null),E_=v_([(0,C.Q)({adapters:[Z.L],menuItems:p_}),g_(0,(0,S.aN)(h_)),y_("design:paramtypes",["function"===typeof(m_="undefined"!==typeof No.IDynamicLoader&&No.IDynamicLoader)?m_:Object])],E_);var w_=[{name:v.z_.PRIVACY,content:O.ZP.t("隐私")},{name:v.z_.PRIVACY_POLICY,content:O.ZP.t("隐私政策")},{name:v.z_.THIRD_PARTY_SHARING_LIST,content:O.ZP.t("第三方共享信息清单")},{name:v.z_.THIRD_AUTHORIZATION_MANAGEMENT,content:O.ZP.t("第三方应用授权管理")},{name:v.z_.PERSONAL_INFO_COLLECTION_LIST,content:O.ZP.t("个人信息收集清单")}],b_=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function s(e){try{c(r.next(e))}catch(t){i(t)}}function a(e){try{c(r.throw(e))}catch(t){i(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))},T_=Symbol.for("feature:privacy");(0,qo.N)(T_,(function(){return b_(void 0,void 0,void 0,regeneratorRuntime.mark((function e(){var t,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([n.e("initial_chunk_part_2"),n.e("vendors-node_modules_tencent_docs-design-resources_pc_png_2x_cdn-function-export_js"),n.e("vendors-node_modules_tencent_docs-addon-sdk_lib_index_esm_js"),n.e("vendors-node_modules_tencent_docs-design-resources_pc_png_2x_cdn_js-node_modules_tencent_docs-70ebca"),n.e("vendors-node_modules_tencent_facade-config_dist_index_js"),n.e("vendors-node_modules_tencent_wedrive-component_dist_xdSaveDoc_css"),n.e("spread-sheet_src_base_util_decorator_loading-decorator_ts-spread-sheet_src_core_feature_copyP-33f189"),n.e("spread-sheet_src_core_view_level-2_condition-format-center_ui_utils_dataUtils_ts"),n.e("spread-sheet_src_core_workbench_common_base-drawer_tsx-spread-sheet_src_external_rangeAuth_ut-2939e0"),n.e("spread-sheet_src_core_view_level-2_chart_charts_chart-data-api_ts-spread-sheet_src_core_view_-9220ef"),n.e("spread-sheet_src_external_view_main_toolbar_IconBox_tsx"),n.e("spread-sheet_src_external_check-slr_sc-lazy-loader_ts-spread-sheet_src_external_templateinfo_-54b3ca"),n.e("spread-sheet_src_core_network_message-center_adapter_MessageCenterAdapter_interface_ts-spread-e88071"),n.e("spread-sheet_src_core_utils_gray_ts-spread-sheet_src_core_view_level-2_condition-format-cente-74d507"),n.e("spread-sheet_src_base_util_phone-number_ts-spread-sheet_src_core_feature_copyPaste_index_ts-s-89b53a"),n.e("spread-sheet_src_core_view_layout_pcView_ts"),n.e("spread-sheet_src_core_view_level-2_link-center_BaseLinkCenter_ts"),n.e("bundle_workbench_feature")]).then(n.bind(n,"../spread-sheet/src/external/view/ui-layer/privacy/privacy-feature.ts"));case 2:return t=e.sent,r=t.PrivacyFeature,e.abrupt("return",r);case 5:case"end":return e.stop()}}),e)})))}));var R_,I_=function(e,t,n,r){var o,i=arguments.length,s=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},C_=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},A_=function(e,t){return function(n,r){t(n,r,e)}},x_=function(){function e(e){this.loader=e}var t=e.prototype;return t.toPrivacyPolicy=function(){this.printFeature.handlePrivacyPolicy()},t.toThirdPartySharingList=function(){return this.printFeature.handleThirdPartySharingList()},t.toThirdAuthorizationManagement=function(){return this.printFeature.handleThirdAuthorizationManagement()},t.toPersonalInfoCollectionList=function(){return this.printFeature.handlePersonalInfoCollectionList()},(0,Oo.Z)(e,[{key:"printFeature",get:function(){return this.loader.instance}}]),e}();I_([(0,Ko.v)(v.z_.PRIVACY_POLICY,"onClick"),(0,ko.k)(),C_("design:type",Function),C_("design:paramtypes",[]),C_("design:returntype",void 0)],x_.prototype,"toPrivacyPolicy",null),I_([(0,Ko.v)(v.z_.THIRD_PARTY_SHARING_LIST,"onClick"),(0,ko.k)(),C_("design:type",Function),C_("design:paramtypes",[]),C_("design:returntype",void 0)],x_.prototype,"toThirdPartySharingList",null),I_([(0,Ko.v)(v.z_.THIRD_AUTHORIZATION_MANAGEMENT,"onClick"),(0,ko.k)(),C_("design:type",Function),C_("design:paramtypes",[]),C_("design:returntype",void 0)],x_.prototype,"toThirdAuthorizationManagement",null),I_([(0,Ko.v)(v.z_.PERSONAL_INFO_COLLECTION_LIST,"onClick"),(0,ko.k)(),C_("design:type",Function),C_("design:paramtypes",[]),C_("design:returntype",void 0)],x_.prototype,"toPersonalInfoCollectionList",null),x_=I_([(0,C.Q)({menuItems:w_}),A_(0,(0,S.aN)(T_)),C_("design:paramtypes",["function"===typeof(R_="undefined"!==typeof No.IDynamicLoader&&No.IDynamicLoader)?R_:Object])],x_);var O_=[{name:v.z_.ADD_MEMBER,content:O.ZP.t("添加成员")}],N_=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function s(e){try{c(r.next(e))}catch(t){i(t)}}function a(e){try{c(r.throw(e))}catch(t){i(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))},S_=Symbol.for("feature.addmember");(0,qo.N)(S_,(function(){return N_(void 0,void 0,void 0,regeneratorRuntime.mark((function e(){var t,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([n.e("initial_chunk_part_2"),n.e("vendors-node_modules_tencent_docs-design-resources_pc_png_2x_cdn-function-export_js"),n.e("vendors-node_modules_tencent_docs-addon-sdk_lib_index_esm_js"),n.e("vendors-node_modules_tencent_docs-design-resources_pc_png_2x_cdn_js-node_modules_tencent_docs-70ebca"),n.e("vendors-node_modules_tencent_facade-config_dist_index_js"),n.e("vendors-node_modules_tencent_wedrive-component_dist_xdSaveDoc_css"),n.e("spread-sheet_src_base_util_decorator_loading-decorator_ts-spread-sheet_src_core_feature_copyP-33f189"),n.e("spread-sheet_src_core_view_level-2_condition-format-center_ui_utils_dataUtils_ts"),n.e("spread-sheet_src_core_workbench_common_base-drawer_tsx-spread-sheet_src_external_rangeAuth_ut-2939e0"),n.e("spread-sheet_src_core_view_level-2_chart_charts_chart-data-api_ts-spread-sheet_src_core_view_-9220ef"),n.e("spread-sheet_src_external_view_main_toolbar_IconBox_tsx"),n.e("spread-sheet_src_external_check-slr_sc-lazy-loader_ts-spread-sheet_src_external_templateinfo_-54b3ca"),n.e("spread-sheet_src_core_network_message-center_adapter_MessageCenterAdapter_interface_ts-spread-e88071"),n.e("spread-sheet_src_core_utils_gray_ts-spread-sheet_src_core_view_level-2_condition-format-cente-74d507"),n.e("spread-sheet_src_base_util_phone-number_ts-spread-sheet_src_core_feature_copyPaste_index_ts-s-89b53a"),n.e("spread-sheet_src_core_view_layout_pcView_ts"),n.e("spread-sheet_src_core_view_level-2_link-center_BaseLinkCenter_ts"),n.e("bundle_workbench_feature")]).then(n.bind(n,"../spread-sheet/src/external/view/ui-layer/add-member-ent/add-member-feature.ts"));case 2:return t=e.sent,r=t.AddMemberFeature,e.abrupt("return",r);case 5:case"end":return e.stop()}}),e)})))}));var k_,P_=function(e,t,n,r){var o,i=arguments.length,s=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},D_=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},L_=function(e,t){return function(n,r){t(n,r,e)}},M_=function(){function e(e){this.loader=e}var t=e.prototype;return t.handleAddMember=function(){this.addMemberFeature.addMember()},t.shouldHide=function(){return this.addMemberFeature.hideAddMember()},(0,Oo.Z)(e,[{key:"addMemberFeature",get:function(){return this.loader.instance}}]),e}();P_([(0,Ko.v)(v.z_.ADD_MEMBER,"onClick"),D_("design:type",Function),D_("design:paramtypes",[]),D_("design:returntype",void 0)],M_.prototype,"handleAddMember",null),P_([(0,Ko.v)(v.z_.ADD_MEMBER,"shouldHide"),D_("design:type",Function),D_("design:paramtypes",[]),D_("design:returntype",void 0)],M_.prototype,"shouldHide",null),M_=P_([(0,C.Q)({menuItems:O_}),L_(0,(0,S.aN)(S_)),D_("design:paramtypes",["function"===typeof(k_="undefined"!==typeof No.IDynamicLoader&&No.IDynamicLoader)?k_:Object])],M_);var F_=[{name:v.z_.SHARE,content:O.ZP.t("分享")}],j_=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function s(e){try{c(r.next(e))}catch(t){i(t)}}function a(e){try{c(r.throw(e))}catch(t){i(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))},H_=Symbol.for("feature:share");(0,qo.N)(H_,(function(){return j_(void 0,void 0,void 0,regeneratorRuntime.mark((function e(){var t,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([n.e("initial_chunk_part_2"),n.e("vendors-node_modules_tencent_docs-design-resources_pc_png_2x_cdn-function-export_js"),n.e("vendors-node_modules_tencent_docs-addon-sdk_lib_index_esm_js"),n.e("vendors-node_modules_tencent_docs-design-resources_pc_png_2x_cdn_js-node_modules_tencent_docs-70ebca"),n.e("vendors-node_modules_tencent_facade-config_dist_index_js"),n.e("vendors-node_modules_tencent_wedrive-component_dist_xdSaveDoc_css"),n.e("spread-sheet_src_base_util_decorator_loading-decorator_ts-spread-sheet_src_core_feature_copyP-33f189"),n.e("spread-sheet_src_core_view_level-2_condition-format-center_ui_utils_dataUtils_ts"),n.e("spread-sheet_src_core_workbench_common_base-drawer_tsx-spread-sheet_src_external_rangeAuth_ut-2939e0"),n.e("spread-sheet_src_core_view_level-2_chart_charts_chart-data-api_ts-spread-sheet_src_core_view_-9220ef"),n.e("spread-sheet_src_external_view_main_toolbar_IconBox_tsx"),n.e("spread-sheet_src_external_check-slr_sc-lazy-loader_ts-spread-sheet_src_external_templateinfo_-54b3ca"),n.e("spread-sheet_src_core_network_message-center_adapter_MessageCenterAdapter_interface_ts-spread-e88071"),n.e("spread-sheet_src_core_utils_gray_ts-spread-sheet_src_core_view_level-2_condition-format-cente-74d507"),n.e("spread-sheet_src_base_util_phone-number_ts-spread-sheet_src_core_feature_copyPaste_index_ts-s-89b53a"),n.e("spread-sheet_src_core_view_layout_pcView_ts"),n.e("spread-sheet_src_core_view_level-2_link-center_BaseLinkCenter_ts"),n.e("bundle_workbench_feature")]).then(n.bind(n,"../spread-sheet/src/external/view/ui-layer/share-ent/share-feature.ts"));case 2:return t=e.sent,r=t.ShareFeature,e.abrupt("return",r);case 5:case"end":return e.stop()}}),e)})))}));var Z_,B_=function(e,t,n,r){var o,i=arguments.length,s=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},z_=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},U_=function(e,t){return function(n,r){t(n,r,e)}},V_=function(){function e(e){this.loader=e}var t=e.prototype;return t.hideShare=function(){return this.shareFeature.shouldHide()},t.handleShare=function(){this.shareFeature.handleClick()},t.getContent=function(){return rt().isWxWork?O.ZP.t("转发"):O.ZP.t("分享")},(0,Oo.Z)(e,[{key:"shareFeature",get:function(){return this.loader.instance}}]),e}();B_([(0,Ko.v)(v.z_.SHARE,"shouldHide"),(0,ii.z)(!1),z_("design:type",Function),z_("design:paramtypes",[]),z_("design:returntype",void 0)],V_.prototype,"hideShare",null),B_([(0,Ko.v)(v.z_.SHARE,"onClick"),(0,ko.k)(),z_("design:type",Function),z_("design:paramtypes",[]),z_("design:returntype",void 0)],V_.prototype,"handleShare",null),B_([(0,Ko.v)(v.z_.SHARE,"content"),(0,ii.z)("分享"),z_("design:type",Function),z_("design:paramtypes",[]),z_("design:returntype",void 0)],V_.prototype,"getContent",null),V_=B_([(0,C.Q)({menuItems:F_}),U_(0,(0,S.aN)(H_)),z_("design:paramtypes",["function"===typeof(Z_="undefined"!==typeof No.IDynamicLoader&&No.IDynamicLoader)?Z_:Object])],V_);var W_=[{name:v.z_.GET_SHARE_URL,content:O.ZP.t("获取分享链接")}],G_=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function s(e){try{c(r.next(e))}catch(t){i(t)}}function a(e){try{c(r.throw(e))}catch(t){i(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))},Y_=Symbol.for("feature:shareurl");(0,qo.N)(Y_,(function(){return G_(void 0,void 0,void 0,regeneratorRuntime.mark((function e(){var t,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([n.e("initial_chunk_part_2"),n.e("vendors-node_modules_tencent_docs-design-resources_pc_png_2x_cdn-function-export_js"),n.e("vendors-node_modules_tencent_docs-addon-sdk_lib_index_esm_js"),n.e("vendors-node_modules_tencent_docs-design-resources_pc_png_2x_cdn_js-node_modules_tencent_docs-70ebca"),n.e("vendors-node_modules_tencent_facade-config_dist_index_js"),n.e("vendors-node_modules_tencent_wedrive-component_dist_xdSaveDoc_css"),n.e("spread-sheet_src_base_util_decorator_loading-decorator_ts-spread-sheet_src_core_feature_copyP-33f189"),n.e("spread-sheet_src_core_view_level-2_condition-format-center_ui_utils_dataUtils_ts"),n.e("spread-sheet_src_core_workbench_common_base-drawer_tsx-spread-sheet_src_external_rangeAuth_ut-2939e0"),n.e("spread-sheet_src_core_view_level-2_chart_charts_chart-data-api_ts-spread-sheet_src_core_view_-9220ef"),n.e("spread-sheet_src_external_view_main_toolbar_IconBox_tsx"),n.e("spread-sheet_src_external_check-slr_sc-lazy-loader_ts-spread-sheet_src_external_templateinfo_-54b3ca"),n.e("spread-sheet_src_core_network_message-center_adapter_MessageCenterAdapter_interface_ts-spread-e88071"),n.e("spread-sheet_src_core_utils_gray_ts-spread-sheet_src_core_view_level-2_condition-format-cente-74d507"),n.e("spread-sheet_src_base_util_phone-number_ts-spread-sheet_src_core_feature_copyPaste_index_ts-s-89b53a"),n.e("spread-sheet_src_core_view_layout_pcView_ts"),n.e("spread-sheet_src_core_view_level-2_link-center_BaseLinkCenter_ts"),n.e("bundle_workbench_feature")]).then(n.bind(n,"../spread-sheet/src/external/view/ui-layer/share-url-ent/share-url-feature.ts"));case 2:return t=e.sent,r=t.ShareUrlFeature,e.abrupt("return",r);case 5:case"end":return e.stop()}}),e)})))}));var K_,X_=function(e,t,n,r){var o,i=arguments.length,s=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},q_=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},Q_=function(e,t){return function(n,r){t(n,r,e)}},$_=function(){function e(e){this.loader=e}return e.prototype.handleClickGetShareUrl=function(){this.shareUrlFeature.getShareUrl()},(0,Oo.Z)(e,[{key:"shareUrlFeature",get:function(){return this.loader.instance}}]),e}();X_([(0,Ko.v)(v.z_.GET_SHARE_URL,"onClick"),q_("design:type",Function),q_("design:paramtypes",[]),q_("design:returntype",void 0)],$_.prototype,"handleClickGetShareUrl",null),$_=X_([(0,C.Q)({menuItems:W_}),Q_(0,(0,S.aN)(Y_)),q_("design:paramtypes",["function"===typeof(K_="undefined"!==typeof No.IDynamicLoader&&No.IDynamicLoader)?K_:Object])],$_);var J_=[{name:v.z_.AUTH_MANAGER,content:O.ZP.t("权限管理")}],ep=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function s(e){try{c(r.next(e))}catch(t){i(t)}}function a(e){try{c(r.throw(e))}catch(t){i(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))},tp=Symbol.for("feature:auth-manager");(0,qo.N)(tp,(function(){return ep(void 0,void 0,void 0,regeneratorRuntime.mark((function e(){var t,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([n.e("initial_chunk_part_2"),n.e("vendors-node_modules_tencent_docs-design-resources_pc_png_2x_cdn-function-export_js"),n.e("vendors-node_modules_tencent_docs-addon-sdk_lib_index_esm_js"),n.e("vendors-node_modules_tencent_docs-design-resources_pc_png_2x_cdn_js-node_modules_tencent_docs-70ebca"),n.e("vendors-node_modules_tencent_facade-config_dist_index_js"),n.e("vendors-node_modules_tencent_wedrive-component_dist_xdSaveDoc_css"),n.e("spread-sheet_src_base_util_decorator_loading-decorator_ts-spread-sheet_src_core_feature_copyP-33f189"),n.e("spread-sheet_src_core_view_level-2_condition-format-center_ui_utils_dataUtils_ts"),n.e("spread-sheet_src_core_workbench_common_base-drawer_tsx-spread-sheet_src_external_rangeAuth_ut-2939e0"),n.e("spread-sheet_src_core_view_level-2_chart_charts_chart-data-api_ts-spread-sheet_src_core_view_-9220ef"),n.e("spread-sheet_src_external_view_main_toolbar_IconBox_tsx"),n.e("spread-sheet_src_external_check-slr_sc-lazy-loader_ts-spread-sheet_src_external_templateinfo_-54b3ca"),n.e("spread-sheet_src_core_network_message-center_adapter_MessageCenterAdapter_interface_ts-spread-e88071"),n.e("spread-sheet_src_core_utils_gray_ts-spread-sheet_src_core_view_level-2_condition-format-cente-74d507"),n.e("spread-sheet_src_base_util_phone-number_ts-spread-sheet_src_core_feature_copyPaste_index_ts-s-89b53a"),n.e("spread-sheet_src_core_view_layout_pcView_ts"),n.e("spread-sheet_src_core_view_level-2_link-center_BaseLinkCenter_ts"),n.e("bundle_workbench_feature")]).then(n.bind(n,"../spread-sheet/src/external/view/ui-layer/auth-manager-ent/auth-manager-feature.ts"));case 2:return t=e.sent,r=t.AuthManagerFeature,e.abrupt("return",r);case 5:case"end":return e.stop()}}),e)})))}));var np,rp=function(e,t,n,r){var o,i=arguments.length,s=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},op=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},ip=function(e,t){return function(n,r){t(n,r,e)}},sp=function(){function e(e){this.loader=e}var t=e.prototype;return t.handleAuthManager=function(){this.authManagerFeature.showEnterpriseEnvAuthDialog()},t.hideAuthManager=function(){return!this.authManagerFeature.canManageAuth()},(0,Oo.Z)(e,[{key:"authManagerFeature",get:function(){return this.loader.instance}}]),e}();rp([(0,Ko.v)(v.z_.AUTH_MANAGER,"onClick"),op("design:type",Function),op("design:paramtypes",[]),op("design:returntype",void 0)],sp.prototype,"handleAuthManager",null),rp([(0,Ko.v)(v.z_.AUTH_MANAGER,"shouldHide"),op("design:type",Function),op("design:paramtypes",[]),op("design:returntype",void 0)],sp.prototype,"hideAuthManager",null),sp=rp([(0,C.Q)({menuItems:J_}),ip(0,(0,S.aN)(tp)),op("design:paramtypes",["function"===typeof(np="undefined"!==typeof No.IDynamicLoader&&No.IDynamicLoader)?np:Object])],sp);var ap=[{name:v.z_.QUICK_ACCESSS,content:O.ZP.t("添加到快速访问")}],cp=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function s(e){try{c(r.next(e))}catch(t){i(t)}}function a(e){try{c(r.throw(e))}catch(t){i(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))},dp=Symbol.for("feature.quickaccess");(0,qo.N)(dp,(function(){return cp(void 0,void 0,void 0,regeneratorRuntime.mark((function e(){var t,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([n.e("initial_chunk_part_2"),n.e("vendors-node_modules_tencent_docs-design-resources_pc_png_2x_cdn-function-export_js"),n.e("vendors-node_modules_tencent_docs-addon-sdk_lib_index_esm_js"),n.e("vendors-node_modules_tencent_docs-design-resources_pc_png_2x_cdn_js-node_modules_tencent_docs-70ebca"),n.e("vendors-node_modules_tencent_facade-config_dist_index_js"),n.e("vendors-node_modules_tencent_wedrive-component_dist_xdSaveDoc_css"),n.e("spread-sheet_src_base_util_decorator_loading-decorator_ts-spread-sheet_src_core_feature_copyP-33f189"),n.e("spread-sheet_src_core_view_level-2_condition-format-center_ui_utils_dataUtils_ts"),n.e("spread-sheet_src_core_workbench_common_base-drawer_tsx-spread-sheet_src_external_rangeAuth_ut-2939e0"),n.e("spread-sheet_src_core_view_level-2_chart_charts_chart-data-api_ts-spread-sheet_src_core_view_-9220ef"),n.e("spread-sheet_src_external_view_main_toolbar_IconBox_tsx"),n.e("spread-sheet_src_external_check-slr_sc-lazy-loader_ts-spread-sheet_src_external_templateinfo_-54b3ca"),n.e("spread-sheet_src_core_network_message-center_adapter_MessageCenterAdapter_interface_ts-spread-e88071"),n.e("spread-sheet_src_core_utils_gray_ts-spread-sheet_src_core_view_level-2_condition-format-cente-74d507"),n.e("spread-sheet_src_base_util_phone-number_ts-spread-sheet_src_core_feature_copyPaste_index_ts-s-89b53a"),n.e("spread-sheet_src_core_view_layout_pcView_ts"),n.e("spread-sheet_src_core_view_level-2_link-center_BaseLinkCenter_ts"),n.e("bundle_workbench_feature")]).then(n.bind(n,"../spread-sheet/src/external/view/ui-layer/quick-access-ent/quick-access-feature.ts"));case 2:return t=e.sent,r=t.QuickAccessFeature,e.abrupt("return",r);case 5:case"end":return e.stop()}}),e)})))}));var lp,up=function(e,t,n,r){var o,i=arguments.length,s=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},_p=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},pp=function(e,t){return function(n,r){t(n,r,e)}},fp=function(){function e(e){this.loader=e}var t=e.prototype;return t.handleQuickAccess=function(){this.quickAccessFeature.handleClickQuickAccess()},t.getContent=function(){return this.quickAccessFeature.getIsQuickAccessState()?O.ZP.t("从快速访问移除"):O.ZP.t("添加到快速访问")},t.hideQuickAccess=function(){return this.quickAccessFeature.shouldHide()},(0,Oo.Z)(e,[{key:"quickAccessFeature",get:function(){return this.loader.instance}}]),e}();up([(0,Ko.v)(v.z_.QUICK_ACCESSS,"onClick"),(0,ko.k)(),_p("design:type",Function),_p("design:paramtypes",[]),_p("design:returntype",void 0)],fp.prototype,"handleQuickAccess",null),up([(0,Ko.v)(v.z_.QUICK_ACCESSS,"content"),(0,ii.z)(O.ZP.t("添加到快速访问")),_p("design:type",Function),_p("design:paramtypes",[]),_p("design:returntype",void 0)],fp.prototype,"getContent",null),up([(0,Ko.v)(v.z_.QUICK_ACCESSS,"shouldHide"),(0,ii.z)(!1),_p("design:type",Function),_p("design:paramtypes",[]),_p("design:returntype",void 0)],fp.prototype,"hideQuickAccess",null),fp=up([(0,C.Q)({menuItems:ap}),pp(0,(0,S.aN)(dp)),_p("design:paramtypes",["function"===typeof(lp="undefined"!==typeof No.IDynamicLoader&&No.IDynamicLoader)?lp:Object])],fp),n("../spread-sheet/src/external/view/ui-layer/wedrive-ent/save-to-wedrive-controller.ts");var hp=[{name:v.z_.EDIT_MENU,content:O.ZP.t("编辑功能")}],mp=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function s(e){try{c(r.next(e))}catch(t){i(t)}}function a(e){try{c(r.throw(e))}catch(t){i(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))},vp=Symbol.for("feature:edit-menu");(0,qo.N)(vp,(function(){return mp(void 0,void 0,void 0,regeneratorRuntime.mark((function e(){var t,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([n.e("initial_chunk_part_2"),n.e("vendors-node_modules_tencent_docs-design-resources_pc_png_2x_cdn-function-export_js"),n.e("vendors-node_modules_tencent_docs-addon-sdk_lib_index_esm_js"),n.e("vendors-node_modules_tencent_docs-design-resources_pc_png_2x_cdn_js-node_modules_tencent_docs-70ebca"),n.e("vendors-node_modules_tencent_facade-config_dist_index_js"),n.e("vendors-node_modules_tencent_wedrive-component_dist_xdSaveDoc_css"),n.e("spread-sheet_src_base_util_decorator_loading-decorator_ts-spread-sheet_src_core_feature_copyP-33f189"),n.e("spread-sheet_src_core_view_level-2_condition-format-center_ui_utils_dataUtils_ts"),n.e("spread-sheet_src_core_workbench_common_base-drawer_tsx-spread-sheet_src_external_rangeAuth_ut-2939e0"),n.e("spread-sheet_src_core_view_level-2_chart_charts_chart-data-api_ts-spread-sheet_src_core_view_-9220ef"),n.e("spread-sheet_src_external_view_main_toolbar_IconBox_tsx"),n.e("spread-sheet_src_external_check-slr_sc-lazy-loader_ts-spread-sheet_src_external_templateinfo_-54b3ca"),n.e("spread-sheet_src_core_network_message-center_adapter_MessageCenterAdapter_interface_ts-spread-e88071"),n.e("spread-sheet_src_core_utils_gray_ts-spread-sheet_src_core_view_level-2_condition-format-cente-74d507"),n.e("spread-sheet_src_base_util_phone-number_ts-spread-sheet_src_core_feature_copyPaste_index_ts-s-89b53a"),n.e("spread-sheet_src_core_view_layout_pcView_ts"),n.e("spread-sheet_src_core_view_level-2_link-center_BaseLinkCenter_ts"),n.e("bundle_workbench_feature")]).then(n.bind(n,"../spread-sheet/src/external/view/ui-layer/edit-menu-ent/edit-menu-feature.ts"));case 2:return t=e.sent,r=t.EditMenuFeature,e.abrupt("return",r);case 5:case"end":return e.stop()}}),e)})))}));var yp,gp=function(e,t,n,r){var o,i=arguments.length,s=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},Ep=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},wp=function(e,t){return function(n,r){t(n,r,e)}},bp=function(){function e(e){this.loader=e}var t=e.prototype;return t.handleClickEditMenu=function(){this.editMenuFeature.handleClick()},t.shouldHide=function(){return this.editMenuFeature.hideEditMenu()},(0,Oo.Z)(e,[{key:"editMenuFeature",get:function(){return this.loader.instance}}]),e}();gp([(0,Ko.v)(v.z_.EDIT_MENU,"onClick"),Ep("design:type",Function),Ep("design:paramtypes",[]),Ep("design:returntype",void 0)],bp.prototype,"handleClickEditMenu",null),gp([(0,Ko.v)(v.z_.EDIT_MENU,"shouldHide"),Ep("design:type",Function),Ep("design:paramtypes",[]),Ep("design:returntype",void 0)],bp.prototype,"shouldHide",null),bp=gp([(0,C.Q)({menuItems:hp}),wp(0,(0,S.aN)(vp)),Ep("design:paramtypes",["function"===typeof(yp="undefined"!==typeof No.IDynamicLoader&&No.IDynamicLoader)?yp:Object])],bp);var Tp=[{name:v.z_.FAVORITE,content:O.ZP.t("收藏")}],Rp=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function s(e){try{c(r.next(e))}catch(t){i(t)}}function a(e){try{c(r.throw(e))}catch(t){i(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))},Ip=Symbol.for("feature:favorite");(0,qo.N)(Ip,(function(){return Rp(void 0,void 0,void 0,regeneratorRuntime.mark((function e(){var t,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([n.e("initial_chunk_part_2"),n.e("vendors-node_modules_tencent_docs-design-resources_pc_png_2x_cdn-function-export_js"),n.e("vendors-node_modules_tencent_docs-addon-sdk_lib_index_esm_js"),n.e("vendors-node_modules_tencent_docs-design-resources_pc_png_2x_cdn_js-node_modules_tencent_docs-70ebca"),n.e("vendors-node_modules_tencent_facade-config_dist_index_js"),n.e("vendors-node_modules_tencent_wedrive-component_dist_xdSaveDoc_css"),n.e("spread-sheet_src_base_util_decorator_loading-decorator_ts-spread-sheet_src_core_feature_copyP-33f189"),n.e("spread-sheet_src_core_view_level-2_condition-format-center_ui_utils_dataUtils_ts"),n.e("spread-sheet_src_core_workbench_common_base-drawer_tsx-spread-sheet_src_external_rangeAuth_ut-2939e0"),n.e("spread-sheet_src_core_view_level-2_chart_charts_chart-data-api_ts-spread-sheet_src_core_view_-9220ef"),n.e("spread-sheet_src_external_view_main_toolbar_IconBox_tsx"),n.e("spread-sheet_src_external_check-slr_sc-lazy-loader_ts-spread-sheet_src_external_templateinfo_-54b3ca"),n.e("spread-sheet_src_core_network_message-center_adapter_MessageCenterAdapter_interface_ts-spread-e88071"),n.e("spread-sheet_src_core_utils_gray_ts-spread-sheet_src_core_view_level-2_condition-format-cente-74d507"),n.e("spread-sheet_src_base_util_phone-number_ts-spread-sheet_src_core_feature_copyPaste_index_ts-s-89b53a"),n.e("spread-sheet_src_core_view_layout_pcView_ts"),n.e("spread-sheet_src_core_view_level-2_link-center_BaseLinkCenter_ts"),n.e("bundle_workbench_feature")]).then(n.bind(n,"../spread-sheet/src/external/view/ui-layer/favorite-ent/favorite-feature.ts"));case 2:return t=e.sent,r=t.FavoriteFeature,e.abrupt("return",r);case 5:case"end":return e.stop()}}),e)})))}));var Cp,Ap=function(e,t,n,r){var o,i=arguments.length,s=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},xp=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},Op=function(e,t){return function(n,r){t(n,r,e)}},Np=function(){function e(e){this.loader=e}var t=e.prototype;return t.handleFavorite=function(){this.favoriteFeature.handleClickFavorite()},t.getContent=function(){return this.favoriteFeature.getIsCollected()?O.ZP.t("取消收藏"):O.ZP.t("收藏")},t.hideFavorite=function(){return this.favoriteFeature.shouldHide()},(0,Oo.Z)(e,[{key:"favoriteFeature",get:function(){return this.loader.instance}}]),e}();Ap([(0,Ko.v)(v.z_.FAVORITE,"onClick"),xp("design:type",Function),xp("design:paramtypes",[]),xp("design:returntype",void 0)],Np.prototype,"handleFavorite",null),Ap([(0,Ko.v)(v.z_.FAVORITE,"content"),xp("design:type",Function),xp("design:paramtypes",[]),xp("design:returntype",void 0)],Np.prototype,"getContent",null),Ap([(0,Ko.v)(v.z_.FAVORITE,"shouldHide"),xp("design:type",Function),xp("design:paramtypes",[]),xp("design:returntype",void 0)],Np.prototype,"hideFavorite",null),Np=Ap([(0,C.Q)({menuItems:Tp}),Op(0,(0,S.aN)(Ip)),xp("design:paramtypes",["function"===typeof(Cp="undefined"!==typeof No.IDynamicLoader&&No.IDynamicLoader)?Cp:Object])],Np);var Sp=[{name:v.z_.EXIT_COLLAB,content:O.ZP.t("退出文档")}],kp=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function s(e){try{c(r.next(e))}catch(t){i(t)}}function a(e){try{c(r.throw(e))}catch(t){i(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))},Pp=Symbol.for("feature:exit-collab");(0,qo.N)(Pp,(function(){return kp(void 0,void 0,void 0,regeneratorRuntime.mark((function e(){var t,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([n.e("initial_chunk_part_2"),n.e("vendors-node_modules_tencent_docs-design-resources_pc_png_2x_cdn-function-export_js"),n.e("vendors-node_modules_tencent_docs-addon-sdk_lib_index_esm_js"),n.e("vendors-node_modules_tencent_docs-design-resources_pc_png_2x_cdn_js-node_modules_tencent_docs-70ebca"),n.e("vendors-node_modules_tencent_facade-config_dist_index_js"),n.e("vendors-node_modules_tencent_wedrive-component_dist_xdSaveDoc_css"),n.e("spread-sheet_src_base_util_decorator_loading-decorator_ts-spread-sheet_src_core_feature_copyP-33f189"),n.e("spread-sheet_src_core_view_level-2_condition-format-center_ui_utils_dataUtils_ts"),n.e("spread-sheet_src_core_workbench_common_base-drawer_tsx-spread-sheet_src_external_rangeAuth_ut-2939e0"),n.e("spread-sheet_src_core_view_level-2_chart_charts_chart-data-api_ts-spread-sheet_src_core_view_-9220ef"),n.e("spread-sheet_src_external_view_main_toolbar_IconBox_tsx"),n.e("spread-sheet_src_external_check-slr_sc-lazy-loader_ts-spread-sheet_src_external_templateinfo_-54b3ca"),n.e("spread-sheet_src_core_network_message-center_adapter_MessageCenterAdapter_interface_ts-spread-e88071"),n.e("spread-sheet_src_core_utils_gray_ts-spread-sheet_src_core_view_level-2_condition-format-cente-74d507"),n.e("spread-sheet_src_base_util_phone-number_ts-spread-sheet_src_core_feature_copyPaste_index_ts-s-89b53a"),n.e("spread-sheet_src_core_view_layout_pcView_ts"),n.e("spread-sheet_src_core_view_level-2_link-center_BaseLinkCenter_ts"),n.e("bundle_workbench_feature")]).then(n.bind(n,"../spread-sheet/src/external/view/ui-layer/exit-collab-ent/exit-collab-feature.ts"));case 2:return t=e.sent,r=t.ExitCollabFeature,e.abrupt("return",r);case 5:case"end":return e.stop()}}),e)})))}));var Dp,Lp=function(e,t,n,r){var o,i=arguments.length,s=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},Mp=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},Fp=function(e,t){return function(n,r){t(n,r,e)}},jp=function(){function e(e){this.loader=e}var t=e.prototype;return t.handleExitCollab=function(){this.exitCollabFeature.handleClick()},t.hideExitCollab=function(){return this.exitCollabFeature.getHiddenState()},(0,Oo.Z)(e,[{key:"exitCollabFeature",get:function(){return this.loader.instance}}]),e}();Lp([(0,Ko.v)(v.z_.EXIT_COLLAB,"onClick"),Mp("design:type",Function),Mp("design:paramtypes",[]),Mp("design:returntype",void 0)],jp.prototype,"handleExitCollab",null),Lp([(0,Ko.v)(v.z_.EXIT_COLLAB,"shouldHide"),Mp("design:type",Function),Mp("design:paramtypes",[]),Mp("design:returntype",void 0)],jp.prototype,"hideExitCollab",null),jp=Lp([(0,C.Q)({menuItems:Sp}),Fp(0,(0,S.aN)(Pp)),Mp("design:paramtypes",["function"===typeof(Dp="undefined"!==typeof No.IDynamicLoader&&No.IDynamicLoader)?Dp:Object])],jp);var Hp=[{name:v.z_.DELETE_DOC,content:O.ZP.t("删除")}],Zp=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function s(e){try{c(r.next(e))}catch(t){i(t)}}function a(e){try{c(r.throw(e))}catch(t){i(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))},Bp=Symbol.for("feature:delete-doc");(0,qo.N)(Bp,(function(){return Zp(void 0,void 0,void 0,regeneratorRuntime.mark((function e(){var t,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([n.e("initial_chunk_part_2"),n.e("vendors-node_modules_tencent_docs-design-resources_pc_png_2x_cdn-function-export_js"),n.e("vendors-node_modules_tencent_docs-addon-sdk_lib_index_esm_js"),n.e("vendors-node_modules_tencent_docs-design-resources_pc_png_2x_cdn_js-node_modules_tencent_docs-70ebca"),n.e("vendors-node_modules_tencent_facade-config_dist_index_js"),n.e("vendors-node_modules_tencent_wedrive-component_dist_xdSaveDoc_css"),n.e("spread-sheet_src_base_util_decorator_loading-decorator_ts-spread-sheet_src_core_feature_copyP-33f189"),n.e("spread-sheet_src_core_view_level-2_condition-format-center_ui_utils_dataUtils_ts"),n.e("spread-sheet_src_core_workbench_common_base-drawer_tsx-spread-sheet_src_external_rangeAuth_ut-2939e0"),n.e("spread-sheet_src_core_view_level-2_chart_charts_chart-data-api_ts-spread-sheet_src_core_view_-9220ef"),n.e("spread-sheet_src_external_view_main_toolbar_IconBox_tsx"),n.e("spread-sheet_src_external_check-slr_sc-lazy-loader_ts-spread-sheet_src_external_templateinfo_-54b3ca"),n.e("spread-sheet_src_core_network_message-center_adapter_MessageCenterAdapter_interface_ts-spread-e88071"),n.e("spread-sheet_src_core_utils_gray_ts-spread-sheet_src_core_view_level-2_condition-format-cente-74d507"),n.e("spread-sheet_src_base_util_phone-number_ts-spread-sheet_src_core_feature_copyPaste_index_ts-s-89b53a"),n.e("spread-sheet_src_core_view_layout_pcView_ts"),n.e("spread-sheet_src_core_view_level-2_link-center_BaseLinkCenter_ts"),n.e("bundle_workbench_feature")]).then(n.bind(n,"../spread-sheet/src/external/view/ui-layer/delete-doc-ent/delete-doc-feature.ts"));case 2:return e.next=4,e.sent;case 4:return t=e.sent,r=t.DeleteDocFeature,e.abrupt("return",r);case 7:case"end":return e.stop()}}),e)})))}));var zp,Up=function(e,t,n,r){var o,i=arguments.length,s=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},Vp=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},Wp=function(e,t){return function(n,r){t(n,r,e)}},Gp=function(){function e(e){this.loader=e}var t=e.prototype;return t.handleDeleteDoc=function(){this.deleteDocFeature.handleClick()},t.getHideState=function(){return this.deleteDocFeature.getHideState()},(0,Oo.Z)(e,[{key:"deleteDocFeature",get:function(){return this.loader.instance}}]),e}();Up([(0,Ko.v)(v.z_.DELETE_DOC,"onClick"),Vp("design:type",Function),Vp("design:paramtypes",[]),Vp("design:returntype",void 0)],Gp.prototype,"handleDeleteDoc",null),Up([(0,Ko.v)(v.z_.DELETE_DOC,"shouldHide"),Vp("design:type",Function),Vp("design:paramtypes",[]),Vp("design:returntype",void 0)],Gp.prototype,"getHideState",null),Gp=Up([(0,C.Q)({menuItems:Hp}),Wp(0,(0,S.aN)(Bp)),Vp("design:paramtypes",["function"===typeof(zp="undefined"!==typeof No.IDynamicLoader&&No.IDynamicLoader)?zp:Object])],Gp);var Yp=[{name:v.z_.SHARE_TO_WECHAT,content:O.ZP.t("转发到微信")}],Kp=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function s(e){try{c(r.next(e))}catch(t){i(t)}}function a(e){try{c(r.throw(e))}catch(t){i(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))},Xp=Symbol.for("feature:share-to-wechat");(0,qo.N)(Xp,(function(){return Kp(void 0,void 0,void 0,regeneratorRuntime.mark((function e(){var t,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([n.e("initial_chunk_part_2"),n.e("vendors-node_modules_tencent_docs-design-resources_pc_png_2x_cdn-function-export_js"),n.e("vendors-node_modules_tencent_docs-addon-sdk_lib_index_esm_js"),n.e("vendors-node_modules_tencent_docs-design-resources_pc_png_2x_cdn_js-node_modules_tencent_docs-70ebca"),n.e("vendors-node_modules_tencent_facade-config_dist_index_js"),n.e("vendors-node_modules_tencent_wedrive-component_dist_xdSaveDoc_css"),n.e("spread-sheet_src_base_util_decorator_loading-decorator_ts-spread-sheet_src_core_feature_copyP-33f189"),n.e("spread-sheet_src_core_view_level-2_condition-format-center_ui_utils_dataUtils_ts"),n.e("spread-sheet_src_core_workbench_common_base-drawer_tsx-spread-sheet_src_external_rangeAuth_ut-2939e0"),n.e("spread-sheet_src_core_view_level-2_chart_charts_chart-data-api_ts-spread-sheet_src_core_view_-9220ef"),n.e("spread-sheet_src_external_view_main_toolbar_IconBox_tsx"),n.e("spread-sheet_src_external_check-slr_sc-lazy-loader_ts-spread-sheet_src_external_templateinfo_-54b3ca"),n.e("spread-sheet_src_core_network_message-center_adapter_MessageCenterAdapter_interface_ts-spread-e88071"),n.e("spread-sheet_src_core_utils_gray_ts-spread-sheet_src_core_view_level-2_condition-format-cente-74d507"),n.e("spread-sheet_src_base_util_phone-number_ts-spread-sheet_src_core_feature_copyPaste_index_ts-s-89b53a"),n.e("spread-sheet_src_core_view_layout_pcView_ts"),n.e("spread-sheet_src_core_view_level-2_link-center_BaseLinkCenter_ts"),n.e("bundle_workbench_feature")]).then(n.bind(n,"../spread-sheet/src/external/view/ui-layer/share-to-wechat-ent/share-to-wechat-feature.ts"));case 2:return t=e.sent,r=t.ShareToWechatFeature,e.abrupt("return",r);case 5:case"end":return e.stop()}}),e)})))}));var qp,Qp=function(e,t,n,r){var o,i=arguments.length,s=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},$p=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},Jp=function(e,t){return function(n,r){t(n,r,e)}},ef=function(){function e(e){this.loader=e}return e.prototype.handleClickShareToWechat=function(){var e;null===(e=this.shareToWechatFeature)||void 0===e||e.handleClick()},(0,Oo.Z)(e,[{key:"shareToWechatFeature",get:function(){return this.loader.instance}}]),e}();Qp([(0,Ko.v)(v.z_.SHARE_TO_WECHAT,"onClick"),$p("design:type",Function),$p("design:paramtypes",[]),$p("design:returntype",void 0)],ef.prototype,"handleClickShareToWechat",null),ef=Qp([(0,C.Q)({menuItems:Yp}),Jp(0,(0,S.aN)(Xp)),$p("design:paramtypes",["function"===typeof(qp="undefined"!==typeof No.IDynamicLoader&&No.IDynamicLoader)?qp:Object])],ef),n("../spread-sheet/src/external/view/ui-layer/insert-doc-ent/insert-doc-controller.ts");var tf=[{name:v.z_.INSERT_FILE,content:O.ZP.t("文件"),icon:A.createElement("div",{className:"icon-svg-toolbar-insert-filelink toolbar-menu-icon"}),privateFillMiddleWareConfig:{shouldCheckWhenCellIsPrivate:!0}},{name:v.z_.INSERT_WEDRIVE_FILE,content:O.ZP.t("微盘文件"),icon:A.createElement("div",{className:"icon-svg-toolbar-wedrive-file toolbar-menu-icon"}),privateFillMiddleWareConfig:{shouldCheckWhenCellIsPrivate:!0}},{name:v.z_.UPLOAD_FILE,content:O.ZP.t("本地文件"),icon:A.createElement("div",{className:"icon-svg-toolbar-upload-file toolbar-menu-icon"}),privateFillMiddleWareConfig:{shouldCheckWhenCellIsPrivate:!0}}],nf=n("../spread-sheet/src/core/view/level-2/ent-link-center/constant/file-type.ts"),rf=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function s(e){try{c(r.next(e))}catch(t){i(t)}}function a(e){try{c(r.throw(e))}catch(t){i(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))},of=Symbol.for("feature:insert-file");(0,qo.N)(of,(function(){return rf(void 0,void 0,void 0,regeneratorRuntime.mark((function e(){var t,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([n.e("initial_chunk_part_2"),n.e("vendors-node_modules_tencent_docs-design-resources_pc_png_2x_cdn-function-export_js"),n.e("vendors-node_modules_tencent_docs-addon-sdk_lib_index_esm_js"),n.e("vendors-node_modules_tencent_docs-design-resources_pc_png_2x_cdn_js-node_modules_tencent_docs-70ebca"),n.e("vendors-node_modules_tencent_facade-config_dist_index_js"),n.e("vendors-node_modules_tencent_wedrive-component_dist_xdSaveDoc_css"),n.e("spread-sheet_src_base_util_decorator_loading-decorator_ts-spread-sheet_src_core_feature_copyP-33f189"),n.e("spread-sheet_src_core_view_level-2_condition-format-center_ui_utils_dataUtils_ts"),n.e("spread-sheet_src_core_workbench_common_base-drawer_tsx-spread-sheet_src_external_rangeAuth_ut-2939e0"),n.e("spread-sheet_src_core_view_level-2_chart_charts_chart-data-api_ts-spread-sheet_src_core_view_-9220ef"),n.e("spread-sheet_src_external_view_main_toolbar_IconBox_tsx"),n.e("spread-sheet_src_external_check-slr_sc-lazy-loader_ts-spread-sheet_src_external_templateinfo_-54b3ca"),n.e("spread-sheet_src_core_network_message-center_adapter_MessageCenterAdapter_interface_ts-spread-e88071"),n.e("spread-sheet_src_core_utils_gray_ts-spread-sheet_src_core_view_level-2_condition-format-cente-74d507"),n.e("spread-sheet_src_base_util_phone-number_ts-spread-sheet_src_core_feature_copyPaste_index_ts-s-89b53a"),n.e("spread-sheet_src_core_view_layout_pcView_ts"),n.e("spread-sheet_src_core_view_level-2_link-center_BaseLinkCenter_ts"),n.e("bundle_workbench_feature")]).then(n.bind(n,"../spread-sheet/src/external/view/ui-layer/insert-file-ent/insert-file-feature.ts"));case 2:return t=e.sent,r=t.InsertFileFeature,e.abrupt("return",r);case 5:case"end":return e.stop()}}),e)})))}));var sf,af=function(e,t,n,r){var o,i=arguments.length,s=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},cf=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},df=function(e,t){return function(n,r){t(n,r,e)}},lf=function(){function e(e){this.loader=e}var t=e.prototype;return t.getInsertFileDisableState=function(){return this.insertFileFeature.disbaleInsertFile()},t.hideInsertFile=function(){return this.insertFileFeature.hideInsertFile()},t.insertWedriveFile=function(){this.insertFileFeature.insertWedriveFile(nf.G.WEDRIVE_AND_WEDOCS)},t.updateFile=function(){this.insertFileFeature.uploadFile()},(0,Oo.Z)(e,[{key:"insertFileFeature",get:function(){return this.loader.instance}}]),e}();af([(0,Ko.v)(v.z_.INSERT_FILE,"shouldDisabled"),cf("design:type",Function),cf("design:paramtypes",[]),cf("design:returntype",void 0)],lf.prototype,"getInsertFileDisableState",null),af([(0,Ko.v)(v.z_.INSERT_FILE,"shouldHide"),cf("design:type",Function),cf("design:paramtypes",[]),cf("design:returntype",void 0)],lf.prototype,"hideInsertFile",null),af([(0,Ko.v)(v.z_.INSERT_WEDRIVE_FILE,"onClick"),cf("design:type",Function),cf("design:paramtypes",[]),cf("design:returntype",void 0)],lf.prototype,"insertWedriveFile",null),af([(0,Ko.v)(v.z_.UPLOAD_FILE,"onClick"),cf("design:type",Function),cf("design:paramtypes",[]),cf("design:returntype",void 0)],lf.prototype,"updateFile",null),lf=af([(0,C.Q)({adapters:[Z.L],menuItems:tf}),df(0,(0,S.aN)(of)),cf("design:paramtypes",["function"===typeof(sf="undefined"!==typeof No.IDynamicLoader&&No.IDynamicLoader)?sf:Object])],lf),n("../spread-sheet/src/external/view/ui-layer/insert-todo-ent/insert-todo-controller.ts"),n("../spread-sheet/src/external/view/ui-layer/insert-staff-card-ent/insert-staff-card-controller.ts"),n("../spread-sheet/src/external/view/ui-layer/insert-group-card-ent/insert-group-card-controller.ts");var uf=[{name:v.z_.INSERT_DATE_REMINDER,content:O.ZP.t("定时提醒"),icon:A.createElement("div",{className:"icon-svg-toolbar-add-date-reminder toolbar-menu-icon"}),privateFillMiddleWareConfig:{shouldCheckWhenCellIsPrivate:!0}}],_f=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function s(e){try{c(r.next(e))}catch(t){i(t)}}function a(e){try{c(r.throw(e))}catch(t){i(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))},pf=Symbol.for("feature:insert-date-reminder");(0,qo.N)(pf,(function(){return _f(void 0,void 0,void 0,regeneratorRuntime.mark((function e(){var t,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([n.e("initial_chunk_part_2"),n.e("vendors-node_modules_tencent_docs-design-resources_pc_png_2x_cdn-function-export_js"),n.e("vendors-node_modules_tencent_docs-addon-sdk_lib_index_esm_js"),n.e("vendors-node_modules_tencent_docs-design-resources_pc_png_2x_cdn_js-node_modules_tencent_docs-70ebca"),n.e("vendors-node_modules_tencent_facade-config_dist_index_js"),n.e("vendors-node_modules_tencent_wedrive-component_dist_xdSaveDoc_css"),n.e("spread-sheet_src_base_util_decorator_loading-decorator_ts-spread-sheet_src_core_feature_copyP-33f189"),n.e("spread-sheet_src_core_view_level-2_condition-format-center_ui_utils_dataUtils_ts"),n.e("spread-sheet_src_core_workbench_common_base-drawer_tsx-spread-sheet_src_external_rangeAuth_ut-2939e0"),n.e("spread-sheet_src_core_view_level-2_chart_charts_chart-data-api_ts-spread-sheet_src_core_view_-9220ef"),n.e("spread-sheet_src_external_view_main_toolbar_IconBox_tsx"),n.e("spread-sheet_src_external_check-slr_sc-lazy-loader_ts-spread-sheet_src_external_templateinfo_-54b3ca"),n.e("spread-sheet_src_core_network_message-center_adapter_MessageCenterAdapter_interface_ts-spread-e88071"),n.e("spread-sheet_src_core_utils_gray_ts-spread-sheet_src_core_view_level-2_condition-format-cente-74d507"),n.e("spread-sheet_src_base_util_phone-number_ts-spread-sheet_src_core_feature_copyPaste_index_ts-s-89b53a"),n.e("spread-sheet_src_core_view_layout_pcView_ts"),n.e("spread-sheet_src_core_view_level-2_link-center_BaseLinkCenter_ts"),n.e("bundle_workbench_feature")]).then(n.bind(n,"../spread-sheet/src/external/view/ui-layer/insert-date-reminder-ent/insert-date-reminder-feature.ts"));case 2:return t=e.sent,r=t.InsertDateReminderFeature,e.abrupt("return",r);case 5:case"end":return e.stop()}}),e)})))}));var ff,hf=function(e,t,n,r){var o,i=arguments.length,s=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},mf=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},vf=function(e,t){return function(n,r){t(n,r,e)}},yf=function(){function e(e){this.loader=e}var t=e.prototype;return t.insertDateReminder=function(){this.insertDateReminderFeature.insertDateReminder()},t.getInsertDateReminderDisabledState=function(){return this.insertDateReminderFeature.checkInsertCustomDataTypeDisable()},(0,Oo.Z)(e,[{key:"insertDateReminderFeature",get:function(){return this.loader.instance}}]),e}();hf([(0,Ko.v)(v.z_.INSERT_DATE_REMINDER,"onClick"),(0,ko.k)(),mf("design:type",Function),mf("design:paramtypes",[]),mf("design:returntype",void 0)],yf.prototype,"insertDateReminder",null),hf([(0,Ko.v)(v.z_.INSERT_DATE_REMINDER,"shouldDisabled"),(0,ii.z)(!1),mf("design:type",Function),mf("design:paramtypes",[]),mf("design:returntype",void 0)],yf.prototype,"getInsertDateReminderDisabledState",null),yf=hf([(0,C.Q)({adapters:[Z.L],menuItems:uf}),vf(0,(0,S.aN)(pf)),mf("design:paramtypes",["function"===typeof(ff="undefined"!==typeof No.IDynamicLoader&&No.IDynamicLoader)?ff:Object])],yf),n("../spread-sheet/src/external/view/ui-layer/schedule-ent/schedule-controller.ts");var gf,Ef=[{name:v.z_.COPY_LINK,content:O.ZP.t("ui|copy link")}],wf=n("../spread-sheet/src/external/view/ui-layer/copy-link/copy-utils.js"),bf=function(e,t,n,r){var o,i=arguments.length,s=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},Tf=function(){function e(){}return e.prototype.copyLink=function(){var e=n.g.SpreadsheetApp.spreadsheet.getTitle(),t=""+n.g.location.origin+n.g.location.pathname,r=""+O.ZP.t("【腾讯文档】")+(e||"")+"\n"+(t||"");(0,wf.z)(r),Q.default.show({message:O.ZP.t("链接已复制"),type:"success"})},e}(),Rf=Tf=bf([(0,D.L)()],Tf),If=function(e,t,n,r){var o,i=arguments.length,s=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},Cf=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},Af=function(){function e(e){this.copyLinkFeaturePC=e}return e.prototype.copyLink=function(){this.copyLinkFeaturePC.copyLink()},e}();If([(0,Ko.v)(v.z_.COPY_LINK,"onClick"),Cf("design:type",Function),Cf("design:paramtypes",[]),Cf("design:returntype",void 0)],Af.prototype,"copyLink",null),Af=If([(0,C.Q)({menuItems:Ef}),Cf("design:paramtypes",["function"===typeof(gf="undefined"!==typeof Rf&&Rf)?gf:Object])],Af);var xf,Of,Nf=n("../node_modules/@tencent/workbench/lib/esm/decorators/method/use-after.js"),Sf=n("../spread-sheet/src/external/view/ui-layer/extend-addon/addon-interface.ts"),kf=[{name:m.HM.EXTEND_ADDON,icon:A.createElement("div",{className:"icon-svg-toolbar-plugin"}),hasArrow:!0,type:"text",style:{width:"auto"},tooltip:O.ZP.t("扩展插件"),inputStatusMiddleWareConfig:{isDisableWhenInput:!0},sheetStatusMiddleware:{isDisabledWhenCannotEdit:!0}}],Pf=[{name:v.z_.EXTEND_ADDON,content:""}],Df=n("../node_modules/@tencent/workbench/lib/esm/decorators/class/middleware.js"),Lf=function(e,t,n,r){var o,i=arguments.length,s=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},Mf=function(){function e(){}return e.prototype.use=function(){oe.ZP.tdwReport({opername:"plug_in",module:"sheet",action:"tool"})},e}(),Ff=Mf=Lf([(0,Df.d)({adapters:[Z.L]})],Mf),jf=function(e,t,n,r){var o,i=arguments.length,s=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},Hf=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},Zf=function(e,t){return function(n,r){t(n,r,e)}},Bf=function(){function e(e,t){this.toolbarModeFeature=e,this.loader=t}var t=e.prototype;return t.renderList=function(){return x().createElement(Qn.l,{align:"left",name:v.z_.EXTEND_ADDON,mode:"menu"})},t.getHideState=function(){return this.addonFeature.getHideState()},t.shouldVerticallyArrange=function(){return this.toolbarModeFeature.getToolbarMode()===ro.ToolbarModeOrders.DOUBLE_LINE_TOOLBAR},t.getText=function(){return this.toolbarModeFeature.getToolbarMode()===ro.ToolbarModeOrders.DOUBLE_LINE_TOOLBAR?O.ZP.t("ui|toolbar.addons"):""},(0,Oo.Z)(e,[{key:"addonFeature",get:function(){return this.loader.instance}}]),e}();jf([(0,So.o)(m.HM.EXTEND_ADDON,"dropdownContent"),(0,Nf.A)(Ff),Hf("design:type",Function),Hf("design:paramtypes",[]),Hf("design:returntype",void 0)],Bf.prototype,"renderList",null),jf([(0,Ko.v)(v.z_.EXTEND_ADDON,"shouldHide"),(0,So.o)(m.HM.EXTEND_ADDON,"shouldHide"),(0,ii.z)(!0),Hf("design:type",Function),Hf("design:paramtypes",[]),Hf("design:returntype",void 0)],Bf.prototype,"getHideState",null),jf([(0,So.o)(m.HM.EXTEND_ADDON,"shouldVerticallyArrange"),Hf("design:type",Function),Hf("design:paramtypes",[]),Hf("design:returntype",void 0)],Bf.prototype,"shouldVerticallyArrange",null),jf([(0,So.o)(m.HM.EXTEND_ADDON,"text"),Hf("design:type",Function),Hf("design:paramtypes",[]),Hf("design:returntype",void 0)],Bf.prototype,"getText",null),Bf=jf([(0,C.Q)({adapters:[Z.L],toolbarItems:kf,menuItems:Pf}),Zf(1,(0,S.aN)(Sf.f)),Hf("design:paramtypes",["function"===typeof(xf="undefined"!==typeof no.ToolbarModeFeature&&no.ToolbarModeFeature)?xf:Object,"function"===typeof(Of="undefined"!==typeof No.IDynamicLoader&&No.IDynamicLoader)?Of:Object])],Bf);var zf=[{name:ho.B.RANGE_TO_IMAGE_COPY,content:O.ZP.t("复制为图片"),selectionMiddleware:{exclude:[ai.R.CHART,ai.R.SHAPE]},sheetStatusMiddleware:{isHiddenWhenCannotCopy:!0}}],Uf=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function s(e){try{c(r.next(e))}catch(t){i(t)}}function a(e){try{c(r.throw(e))}catch(t){i(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))},Vf=Symbol.for("feature:range-to-image-copy");(0,qo.N)(Vf,(function(){return Uf(void 0,void 0,void 0,regeneratorRuntime.mark((function e(){var t,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([n.e("initial_chunk_part_2"),n.e("vendors-node_modules_tencent_docs-design-resources_pc_png_2x_cdn-function-export_js"),n.e("vendors-node_modules_tencent_docs-addon-sdk_lib_index_esm_js"),n.e("vendors-node_modules_tencent_docs-design-resources_pc_png_2x_cdn_js-node_modules_tencent_docs-70ebca"),n.e("vendors-node_modules_tencent_facade-config_dist_index_js"),n.e("vendors-node_modules_tencent_wedrive-component_dist_xdSaveDoc_css"),n.e("spread-sheet_src_base_util_decorator_loading-decorator_ts-spread-sheet_src_core_feature_copyP-33f189"),n.e("spread-sheet_src_core_view_level-2_condition-format-center_ui_utils_dataUtils_ts"),n.e("spread-sheet_src_core_workbench_common_base-drawer_tsx-spread-sheet_src_external_rangeAuth_ut-2939e0"),n.e("spread-sheet_src_core_view_level-2_chart_charts_chart-data-api_ts-spread-sheet_src_core_view_-9220ef"),n.e("spread-sheet_src_external_view_main_toolbar_IconBox_tsx"),n.e("spread-sheet_src_external_check-slr_sc-lazy-loader_ts-spread-sheet_src_external_templateinfo_-54b3ca"),n.e("spread-sheet_src_core_network_message-center_adapter_MessageCenterAdapter_interface_ts-spread-e88071"),n.e("spread-sheet_src_core_utils_gray_ts-spread-sheet_src_core_view_level-2_condition-format-cente-74d507"),n.e("spread-sheet_src_base_util_phone-number_ts-spread-sheet_src_core_feature_copyPaste_index_ts-s-89b53a"),n.e("spread-sheet_src_core_view_layout_pcView_ts"),n.e("spread-sheet_src_core_view_level-2_link-center_BaseLinkCenter_ts"),n.e("bundle_workbench_feature")]).then(n.bind(n,"../spread-sheet/src/external/view/ui-layer/range-to-image-copy/range-to-image-copy-feature.ts"));case 2:return t=e.sent,r=t.RangeToImageCopyFeature,e.abrupt("return",r);case 5:case"end":return e.stop()}}),e)})))}));var Wf,Gf=function(e,t,n,r){var o,i=arguments.length,s=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},Yf=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},Kf=function(e,t){return function(n,r){t(n,r,e)}},Xf=function(){function e(e){this.loader=e}var t=e.prototype;return t.handleRangeToImageCopy=function(){this.rangeToImageFeature.onClick()},t.hideRangeToImageCopy=function(){return this.rangeToImageFeature.shouldHide()},t.disabledRangeToImageCopy=function(){return this.rangeToImageFeature.shouleDisabled()},(0,Oo.Z)(e,[{key:"rangeToImageFeature",get:function(){return this.loader.instance}}]),e}();Gf([(0,oi.x)(ho.B.RANGE_TO_IMAGE_COPY,"onClick"),Yf("design:type",Function),Yf("design:paramtypes",[]),Yf("design:returntype",void 0)],Xf.prototype,"handleRangeToImageCopy",null),Gf([(0,oi.x)(ho.B.RANGE_TO_IMAGE_COPY,"shouldHide"),Yf("design:type",Function),Yf("design:paramtypes",[]),Yf("design:returntype",void 0)],Xf.prototype,"hideRangeToImageCopy",null),Gf([(0,oi.x)(ho.B.RANGE_TO_IMAGE_COPY,"shouldDisabled"),Yf("design:type",Function),Yf("design:paramtypes",[]),Yf("design:returntype",void 0)],Xf.prototype,"disabledRangeToImageCopy",null),Xf=Gf([(0,C.Q)({adapters:[Z.L],contextMenuItems:zf}),Kf(0,(0,S.aN)(Vf)),Yf("design:paramtypes",["function"===typeof(Wf="undefined"!==typeof No.IDynamicLoader&&No.IDynamicLoader)?Wf:Object])],Xf);var qf=[{name:ho.B.LINK_RANGE,content:O.ZP.t("获取指向此范围的链接"),selectionMiddleware:{exclude:[ai.R.CHART,ai.R.SHAPE]}}],Qf=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function s(e){try{c(r.next(e))}catch(t){i(t)}}function a(e){try{c(r.throw(e))}catch(t){i(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))},$f=Symbol.for("feature:link-range");(0,qo.N)($f,(function(){return Qf(void 0,void 0,void 0,regeneratorRuntime.mark((function e(){var t,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([n.e("initial_chunk_part_2"),n.e("vendors-node_modules_tencent_docs-design-resources_pc_png_2x_cdn-function-export_js"),n.e("vendors-node_modules_tencent_docs-addon-sdk_lib_index_esm_js"),n.e("vendors-node_modules_tencent_docs-design-resources_pc_png_2x_cdn_js-node_modules_tencent_docs-70ebca"),n.e("vendors-node_modules_tencent_facade-config_dist_index_js"),n.e("vendors-node_modules_tencent_wedrive-component_dist_xdSaveDoc_css"),n.e("spread-sheet_src_base_util_decorator_loading-decorator_ts-spread-sheet_src_core_feature_copyP-33f189"),n.e("spread-sheet_src_core_view_level-2_condition-format-center_ui_utils_dataUtils_ts"),n.e("spread-sheet_src_core_workbench_common_base-drawer_tsx-spread-sheet_src_external_rangeAuth_ut-2939e0"),n.e("spread-sheet_src_core_view_level-2_chart_charts_chart-data-api_ts-spread-sheet_src_core_view_-9220ef"),n.e("spread-sheet_src_external_view_main_toolbar_IconBox_tsx"),n.e("spread-sheet_src_external_check-slr_sc-lazy-loader_ts-spread-sheet_src_external_templateinfo_-54b3ca"),n.e("spread-sheet_src_core_network_message-center_adapter_MessageCenterAdapter_interface_ts-spread-e88071"),n.e("spread-sheet_src_core_utils_gray_ts-spread-sheet_src_core_view_level-2_condition-format-cente-74d507"),n.e("spread-sheet_src_base_util_phone-number_ts-spread-sheet_src_core_feature_copyPaste_index_ts-s-89b53a"),n.e("spread-sheet_src_core_view_layout_pcView_ts"),n.e("spread-sheet_src_core_view_level-2_link-center_BaseLinkCenter_ts"),n.e("bundle_workbench_feature")]).then(n.bind(n,"../spread-sheet/src/external/view/ui-layer/link-range-ent/link-range-feature.ts"));case 2:return t=e.sent,r=t.LinkRangeFeature,e.abrupt("return",r);case 5:case"end":return e.stop()}}),e)})))}));var Jf,eh=function(e,t,n,r){var o,i=arguments.length,s=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},th=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},nh=function(e,t){return function(n,r){t(n,r,e)}},rh=function(){function e(e){this.loader=e}var t=e.prototype;return t.handleLinkRange=function(){this.linkRangeFeature.onClick()},t.hideLinkRange=function(){return this.linkRangeFeature.shouldHide()},t.linkRangeContext=function(){var e=this.linkRangeFeature.getSelectedRange();return e?O.ZP.t("获取指向此范围的链接（{{value}}）",{value:""+(e||O.ZP.t("范围"))}):"获取指向此范围的链接"},(0,Oo.Z)(e,[{key:"linkRangeFeature",get:function(){return this.loader.instance}}]),e}();eh([(0,oi.x)(ho.B.LINK_RANGE,"onClick"),th("design:type",Function),th("design:paramtypes",[]),th("design:returntype",void 0)],rh.prototype,"handleLinkRange",null),eh([(0,oi.x)(ho.B.LINK_RANGE,"shouldHide"),th("design:type",Function),th("design:paramtypes",[]),th("design:returntype",void 0)],rh.prototype,"hideLinkRange",null),eh([(0,oi.x)(ho.B.LINK_RANGE,"content"),th("design:type",Function),th("design:paramtypes",[]),th("design:returntype",void 0)],rh.prototype,"linkRangeContext",null),rh=eh([(0,C.Q)({adapters:[Z.L],contextMenuItems:qf}),nh(0,(0,S.aN)($f)),th("design:paramtypes",["function"===typeof(Jf="undefined"!==typeof No.IDynamicLoader&&No.IDynamicLoader)?Jf:Object])],rh);var oh,ih=n("../spread-sheet/src/external/view/ui-layer/wedrive-ent/config.ts"),sh=n("../spread-sheet/src/external/view/ui-layer/wedrive-ent/wedrive.interface.ts"),ah=function(e,t,n,r){var o,i=arguments.length,s=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},ch=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},dh=function(e,t){return function(n,r){t(n,r,e)}},lh=function(){function e(e){this.loader=e}var t=e.prototype;return t.handleMoveToWedrive=function(){this.wedriveFeature.openWedriveFileSelector(!0)},t.hideMoveToWedrive=function(){return this.wedriveFeature.hideMoveToWedrive()},(0,Oo.Z)(e,[{key:"wedriveFeature",get:function(){return this.loader.instance}}]),e}();ah([(0,Ko.v)(v.z_.MOVE_TO_WEDRIVE,"onClick"),ch("design:type",Function),ch("design:paramtypes",[]),ch("design:returntype",void 0)],lh.prototype,"handleMoveToWedrive",null),ah([(0,Ko.v)(v.z_.MOVE_TO_WEDRIVE,"shouldHide"),ch("design:type",Function),ch("design:paramtypes",[]),ch("design:returntype",void 0)],lh.prototype,"hideMoveToWedrive",null),lh=ah([(0,C.Q)({menuItems:ih.Vq}),dh(0,(0,S.aN)(sh.G)),ch("design:paramtypes",["function"===typeof(oh="undefined"!==typeof No.IDynamicLoader&&No.IDynamicLoader)?oh:Object])],lh),n("../spread-sheet/src/external/view/ui-layer/mention-ent/mention-ent-controller.ts");var uh=[{name:ho.B.CONVERT_TO_SMART_SHEET,content:O.ZP.t("用所选数据新建智能表"),selectionMiddleware:{exclude:[ai.R.DISCONTINUOUS_MUTLI_CELLS,ai.R.CHART,ai.R.SHAPE]},sheetStatusMiddleware:{isHiddenWhenCannotEditExceptRangeAuth:!0}}],_h=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function s(e){try{c(r.next(e))}catch(t){i(t)}}function a(e){try{c(r.throw(e))}catch(t){i(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))},ph=Symbol.for("feature:convert-to-smart-sheet");(0,qo.N)(ph,(function(){return _h(void 0,void 0,void 0,regeneratorRuntime.mark((function e(){var t,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([n.e("initial_chunk_part_2"),n.e("vendors-node_modules_tencent_docs-design-resources_pc_png_2x_cdn-function-export_js"),n.e("vendors-node_modules_tencent_docs-addon-sdk_lib_index_esm_js"),n.e("vendors-node_modules_tencent_docs-design-resources_pc_png_2x_cdn_js-node_modules_tencent_docs-70ebca"),n.e("vendors-node_modules_tencent_facade-config_dist_index_js"),n.e("vendors-node_modules_tencent_wedrive-component_dist_xdSaveDoc_css"),n.e("spread-sheet_src_base_util_decorator_loading-decorator_ts-spread-sheet_src_core_feature_copyP-33f189"),n.e("spread-sheet_src_core_view_level-2_condition-format-center_ui_utils_dataUtils_ts"),n.e("spread-sheet_src_core_workbench_common_base-drawer_tsx-spread-sheet_src_external_rangeAuth_ut-2939e0"),n.e("spread-sheet_src_core_view_level-2_chart_charts_chart-data-api_ts-spread-sheet_src_core_view_-9220ef"),n.e("spread-sheet_src_external_view_main_toolbar_IconBox_tsx"),n.e("spread-sheet_src_external_check-slr_sc-lazy-loader_ts-spread-sheet_src_external_templateinfo_-54b3ca"),n.e("spread-sheet_src_core_network_message-center_adapter_MessageCenterAdapter_interface_ts-spread-e88071"),n.e("spread-sheet_src_core_utils_gray_ts-spread-sheet_src_core_view_level-2_condition-format-cente-74d507"),n.e("spread-sheet_src_base_util_phone-number_ts-spread-sheet_src_core_feature_copyPaste_index_ts-s-89b53a"),n.e("spread-sheet_src_core_view_layout_pcView_ts"),n.e("spread-sheet_src_core_view_level-2_link-center_BaseLinkCenter_ts"),n.e("bundle_workbench_feature")]).then(n.bind(n,"../spread-sheet/src/external/view/ui-layer/convert-to-smart-sheet/convert-to-smart-sheet-feature.tsx"));case 2:return t=e.sent,r=t.ConvertToSmartSheetFeature,e.abrupt("return",r);case 5:case"end":return e.stop()}}),e)})))}));var fh,hh=function(e,t,n,r){var o,i=arguments.length,s=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},mh=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},vh=function(e,t){return function(n,r){t(n,r,e)}},yh=function(){function e(e){this.loader=e}var t=e.prototype;return t.convertToSmartSheet=function(){this.convertToSmartSheetFeature.convertToSmartSheet(),oe.ZP.tdwReport({opername:"doc_smartsheet_editor",module:"convert_from_sheet",action:"clk_convert",file_type:13})},t.shouldHide=function(){return this.convertToSmartSheetFeature.shouldHide()},(0,Oo.Z)(e,[{key:"convertToSmartSheetFeature",get:function(){return this.loader.instance}}]),e}();hh([(0,oi.x)(ho.B.CONVERT_TO_SMART_SHEET,"onClick"),(0,ko.k)(),mh("design:type",Function),mh("design:paramtypes",[]),mh("design:returntype",void 0)],yh.prototype,"convertToSmartSheet",null),hh([(0,oi.x)(ho.B.CONVERT_TO_SMART_SHEET,"shouldHide"),(0,ii.z)(!0),mh("design:type",Function),mh("design:paramtypes",[]),mh("design:returntype",void 0)],yh.prototype,"shouldHide",null),yh=hh([(0,C.Q)({adapters:[Z.L],contextMenuItems:uh}),vh(0,(0,S.aN)(ph)),mh("design:paramtypes",["function"===typeof(fh="undefined"!==typeof No.IDynamicLoader&&No.IDynamicLoader)?fh:Object])],yh);var gh=[{name:v.z_.FORWARD,content:O.ZP.t("转发")}],Eh=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function s(e){try{c(r.next(e))}catch(t){i(t)}}function a(e){try{c(r.throw(e))}catch(t){i(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))},wh=Symbol.for("feature:forward");(0,qo.N)(wh,(function(){return Eh(void 0,void 0,void 0,regeneratorRuntime.mark((function e(){var t,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([n.e("initial_chunk_part_2"),n.e("vendors-node_modules_tencent_docs-design-resources_pc_png_2x_cdn-function-export_js"),n.e("vendors-node_modules_tencent_docs-addon-sdk_lib_index_esm_js"),n.e("vendors-node_modules_tencent_docs-design-resources_pc_png_2x_cdn_js-node_modules_tencent_docs-70ebca"),n.e("vendors-node_modules_tencent_facade-config_dist_index_js"),n.e("vendors-node_modules_tencent_wedrive-component_dist_xdSaveDoc_css"),n.e("spread-sheet_src_base_util_decorator_loading-decorator_ts-spread-sheet_src_core_feature_copyP-33f189"),n.e("spread-sheet_src_core_view_level-2_condition-format-center_ui_utils_dataUtils_ts"),n.e("spread-sheet_src_core_workbench_common_base-drawer_tsx-spread-sheet_src_external_rangeAuth_ut-2939e0"),n.e("spread-sheet_src_core_view_level-2_chart_charts_chart-data-api_ts-spread-sheet_src_core_view_-9220ef"),n.e("spread-sheet_src_external_view_main_toolbar_IconBox_tsx"),n.e("spread-sheet_src_external_check-slr_sc-lazy-loader_ts-spread-sheet_src_external_templateinfo_-54b3ca"),n.e("spread-sheet_src_core_network_message-center_adapter_MessageCenterAdapter_interface_ts-spread-e88071"),n.e("spread-sheet_src_core_utils_gray_ts-spread-sheet_src_core_view_level-2_condition-format-cente-74d507"),n.e("spread-sheet_src_base_util_phone-number_ts-spread-sheet_src_core_feature_copyPaste_index_ts-s-89b53a"),n.e("spread-sheet_src_core_view_layout_pcView_ts"),n.e("spread-sheet_src_core_view_level-2_link-center_BaseLinkCenter_ts"),n.e("bundle_workbench_feature")]).then(n.bind(n,"../spread-sheet/src/external/view/ui-layer/forward/forward-feature.ts"));case 2:return t=e.sent,r=t.ForwardFeature,e.abrupt("return",r);case 5:case"end":return e.stop()}}),e)})))}));var bh,Th=function(e,t,n,r){var o,i=arguments.length,s=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},Rh=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},Ih=function(e,t){return function(n,r){t(n,r,e)}},Ch=function(){function e(e){this.loader=e}var t=e.prototype;return t.hideForward=function(){return this.forwardFeature.hideForward()},t.handleForward=function(){this.forwardFeature.handleForward()},(0,Oo.Z)(e,[{key:"forwardFeature",get:function(){return this.loader.instance}}]),e}();Th([(0,Ko.v)(v.z_.FORWARD,"shouldHide"),(0,ii.z)(!1),Rh("design:type",Function),Rh("design:paramtypes",[]),Rh("design:returntype",void 0)],Ch.prototype,"hideForward",null),Th([(0,Ko.v)(v.z_.FORWARD,"onClick"),Rh("design:type",Function),Rh("design:paramtypes",[]),Rh("design:returntype",void 0)],Ch.prototype,"handleForward",null),Ch=Th([(0,C.Q)({adapters:[Z.L,B.dH],menuItems:gh}),Ih(0,(0,S.aN)(wh)),Rh("design:paramtypes",["function"===typeof(bh="undefined"!==typeof No.IDynamicLoader&&No.IDynamicLoader)?bh:Object])],Ch),n("../spread-sheet/src/external/view/ui-layer/wedrive-ent/view-in-wedrive-controller.ts"),n("../spread-sheet/src/external/view/ui-layer/insert-application-ent/insert-application-controller.ts"),n("../spread-sheet/src/external/view/ui-layer/sync-guide-ent/sync-guide-controller.ts");var Ah,xh,Oh,Nh,Sh=function(){function e(){}return e.getControllerExceptTitlebar=function(){return[Go.o,Yo.z,gc,ri,mi,u_.z,yi.A,__.a,Ri,Da,xc,ha,cl,ml,Rl,bu,su,fu,za,ki,Zi,Ki,as,cs.Y,As,Fs,Ws,ea,ia,sa.l,ws,aa.U,ma.f,Ra,Ia.E,Ca.f,$a.X,Qa,Vd.Z,cc,Ec.A,Zc,Kc,$c.i,Jc.T,ed.j,sd,ad.G,cd.C,dd.Z,ld.J,ud.X,Ed,Td.y,Rd.h,Id.g,Fd,jd.B,Hd.P,Wd.V,Gd.g,el,Zd.p,Bd.G,zd.i,Ud.o,Hl,ql,Tu.E,Su,Hu,Yu,Af,o_,l_,Bf,E_,Zo,x_,yh,Xf].concat((0,h.Z)([]))},e}(),kh=n("../spread-sheet/src/core/workbench/common/auto-resize-feature.ts"),Ph=n("../node_modules/@tencent/smartsheet-sdk/es/schema/menu.js"),Dh=n("../node_modules/@tencent/smartsheet-sdk/es/schema/contextmenu.js"),Lh={wecom:g,toc:v.ZP},Mh={wecom:T,toc:w},Fh=function(){function e(){}return e.getInitialSchema=function(){var e,t,n,r=z.Z.getConfig("domain")||"toc";return{menuSchema:[].concat((0,h.Z)(Lh[r]),(0,h.Z)(Ph.J)),toolbarSchema:"double"===(null===(n=null===(t=null===(e=null===window||void 0===window?void 0:window.basicClientVars)||void 0===e?void 0:e.userInfo)||void 0===t?void 0:t.settings)||void 0===n?void 0:n.toolbarMode)?m.pQ:m.Z6,titlebarSchema:(0,h.Z)(Mh[r]),contextMenuSchema:[].concat((0,h.Z)(mo),(0,h.Z)(Bo),(0,h.Z)(zo),(0,h.Z)(Dh.nq))}},e.getController=function(){return[].concat((0,h.Z)(Sh.getControllerExceptTitlebar()),(0,h.Z)(this.getTitlebarController()))},e.getTitlebarController=function(){return[so,Zo]},e.getFeatures=function(){var e=[kh.Z,Co,Wo.FilterFeature];return[].concat(e,[bo])},e.getServices=function(){return[].concat((0,h.Z)((0,R.b)()),[Uo.Z,Vo.Z])},e}(),jh=n("../spread-sheet/src/core/workbench/middleware/sheet-status/sheet-status-middleware.ts"),Hh=n("../node_modules/@tencent/workbench/lib/esm/decorators/param/stop-action.js"),Zh=n("../node_modules/@tencent/workbench/lib/esm/decorators/param/ui-config.js"),Bh=n("../spread-sheet/src/core/workbench/constants/tirgger-type.ts"),zh=function(e,t,n,r){var o,i=arguments.length,s=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},Uh=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},Vh=function(e,t){return function(n,r){t(n,r,e)}},Wh=function(){function e(e){this.view=e}var t=e.prototype;return t.use=function(e,t,n){if("divider"!==e.name&&n.inputStatusMiddleWareConfig&&e.trigger===Bh.z.SHOULD_DISABLED&&this.checkDisabled(n.inputStatusMiddleWareConfig))return t(),!0},t.checkDisabled=function(e){return!!e.isDisableWhenInput&&this.view.canvas.inputManager.isInputtingState()},e}();zh([Vh(0,(0,Qi.g)()),Vh(1,(0,Hh.o)()),Vh(2,(0,Zh.z)()),Uh("design:type",Function),Uh("design:paramtypes",["function"===typeof(Ah="undefined"!==typeof No.IActionPointInfo&&No.IActionPointInfo)?Ah:Object,"function"===typeof(xh="undefined"!==typeof No.IStopAction&&No.IStopAction)?xh:Object,"function"===typeof(Oh="undefined"!==typeof No.WorkbenchUIConfig&&No.WorkbenchUIConfig)?Oh:Object]),Uh("design:returntype",void 0)],Wh.prototype,"use",null),Wh=zh([(0,Df.d)({adapters:[Z.L]}),Vh(0,On.w),Uh("design:paramtypes",["function"===typeof(Nh="undefined"!==typeof On.w&&On.w)?Nh:Object])],Wh);var Gh,Yh,Kh,Xh,qh=n("../spread-sheet/src/core/workbench/middleware/selection/selection-middleware.ts"),Qh=n("../spread-sheet/src/flow/browser/phase/workbench/workbench-state.interface.ts"),$h=n("../spread-sheet/src/external/view/ui-layer/print/print-feature.ts"),Jh=function(e,t,n,r){var o,i=arguments.length,s=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},em=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},tm=function(e,t){return function(n,r){t(n,r,e)}},nm=function(){function e(e){this.printFeature=e}return e.prototype.use=function(e,t,n){var r=e.trigger;if("shouldDisabled"===r||"shouldHide"===r){var o=n.shouldDisableWhenPrinting&&this.printFeature.getShouldHideTitlebarRight();if(o)return t(),o}},e}();Jh([tm(0,(0,Qi.g)()),tm(1,(0,Hh.o)()),tm(2,(0,Zh.z)()),em("design:type",Function),em("design:paramtypes",["function"===typeof(Gh="undefined"!==typeof No.IActionPointInfo&&No.IActionPointInfo)?Gh:Object,"function"===typeof(Yh="undefined"!==typeof No.IStopAction&&No.IStopAction)?Yh:Object,"function"===typeof(Kh="undefined"!==typeof No.ITitlebarConfig&&No.ITitlebarConfig)?Kh:Object]),em("design:returntype",void 0)],nm.prototype,"use",null);var rm,om,im,sm=nm=Jh([(0,Df.d)({adapters:[Z.L]}),em("design:paramtypes",["function"===typeof(Xh="undefined"!==typeof $h.PrintFeature&&$h.PrintFeature)?Xh:Object])],nm),am=n("../spread-sheet/src/core/workbench/middleware/private-fill/private-fill-middleware.ts"),cm=function(e,t,n,r){var o,i=arguments.length,s=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},dm=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},lm=function(e,t){return function(n,r){t(n,r,e)}},um=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function s(e){try{c(r.next(e))}catch(t){i(t)}}function a(e){try{c(r.throw(e))}catch(t){i(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))},_m=function(){function e(){}return e.prototype.getLoader=function(){return pm},e}(),pm=function(e){function t(t,n,r){var o;return(o=e.call(this)||this).openEditorService=t,o.middlewareService=n,o.workbenchState=r,o}(0,s.Z)(t,e);var r=t.prototype;return r.$onInit=function(){this.initSelectionMiddlewares(),this.initSheetStatusMiddleware(),this.initInputStatusMiddleware(),this.initPrivateFillMiddleware(),this.settings.set("namespace",F.q.getConfig("uid"))},r.$onReady=function(){return um(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n.g.dispatchEvent(new Event("resize")),hr.ZP.default.trigger("sheet_workbench_ready"),this.workbenchState.onReady();case 3:case"end":return e.stop()}}),e,this)})))},r.$afterControllersInit=function(){return um(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.openEditorService.open();case 2:case"end":return e.stop()}}),e,this)})))},r.$onWorkbenchInitError=function(e){var t;null===(t=n.g.log)||void 0===t||t.error("workbench",e)},r.initSelectionMiddlewares=function(){this.middlewareService.use(qh.Y,{on:a.L,callbackNames:["shouldHide"]}),this.middlewareService.use(sm,{on:c.M,callbackNames:["shouldHide"]}),this.middlewareService.use(qh.Y,{on:d.h,callbackNames:["shouldDisabled"]}),this.middlewareService.use(qh.Y,{on:l.O,callbackNames:["shouldDisabled"]})},r.initSheetStatusMiddleware=function(){this.middlewareService.use(jh.C,{on:l.O,callbackNames:["shouldDisabled","shouldHide"]}),this.middlewareService.use(jh.C,{on:a.L,callbackNames:["shouldDisabled","shouldHide"]}),this.middlewareService.use(jh.C,{on:d.h,callbackNames:["shouldDisabled","shouldHide"]})},r.initInputStatusMiddleware=function(){this.middlewareService.use(Wh,{on:l.O,callbackNames:["shouldDisabled"]})},r.initPrivateFillMiddleware=function(){this.middlewareService.use(am.r,{on:l.O,callbackNames:["shouldDisabled"]}),this.middlewareService.use(am.r,{on:a.L,callbackNames:["shouldDisabled"]}),this.middlewareService.use(am.r,{on:d.h,callbackNames:["shouldDisabled"]})},t}(u.g);pm=cm([(0,_.I)({platform:"pc",menu:{schema:Fh.getInitialSchema().menuSchema},toolbar:{schema:Fh.getInitialSchema().toolbarSchema,schemaAnimation:!0},contextMenu:{schema:Fh.getInitialSchema().contextMenuSchema,hasOverlay:!1},titlebar:{schema:Fh.getInitialSchema().titlebarSchema,height:(0,at.P8)()?60:56,hoverable:{takeUpSpace:!0,takeUpSpaceHeight:8},contentDefaultStyle:(0,at.P8)()?{paddingTop:16}:{}},statusbar:{disabled:!0},accessibility:{dropdownAutoFocus:!1},mount:{controllers:Fh.getController(),services:Fh.getServices(),features:Fh.getFeatures()},selectionThrottleTime:0,modelThrottleTime:10}),lm(2,Qh.i),dm("design:paramtypes",["function"===typeof(rm="undefined"!==typeof f.Z&&f.Z)?rm:Object,"function"===typeof(om="undefined"!==typeof p.K&&p.K)?om:Object,"function"===typeof(im="undefined"!==typeof Qh.i&&Qh.i)?im:Object])],pm);var fm=n("../spread-sheet/src/flow/browser/phase/services/workbenchInitService.ts"),hm=n("../node_modules/@tencent/workbench/lib/esm/controllers/workbench/workbench-pc.js"),mm=function(){function e(){}var t=e.prototype;return t.getWorkbench=function(){return hm.G},t.bind=function(e){(0,R.K)(e),this.pcBinding(e)},t.pcBinding=function(e){},e}();function vm(e){e.addService(o.e,new Ye.Mj(mm)),e.addService(i.V,new Ye.Mj(_m))}},"../spread-sheet/src/external/auth/base/ApplyService.ts":function(e,t,n){n("../node_modules/regenerator-runtime/runtime.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.promise.js");var r=n("./node_modules/axios/index.js"),o=n.n(r),i=n("../packages/utils/src/safe.ts"),s=n("../spread-sheet/src/core/data/configService/spreadConfig.ts"),a=n("../spread-sheet/src/external/check-slr/check-script-loader.ts"),c=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function s(e){try{c(r.next(e))}catch(t){i(t)}}function a(e){try{c(r.throw(e))}catch(t){i(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))},d=function(){function e(e){var t=this;this.canEditExceptWorkbookStatus=function(){return t.sheetStatus.canEditExceptWorkbookStatus},this.isPreviewOrDynamicStatus=function(){return t.sheetStatus.canEditExceptRangeStatus||s.q.getConfig("isFormPreview")||s.q.getConfig("isPreview")},this.applyAuthStatus={apply:!1},this.lastClickTime=0,this.applyToastShowTimes={},this.sheetStatus=e.sheetStatus,this.view=e.view}var t=e.prototype;return t.checkIsApplyIn24H=function(){return c(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t,n,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o().get("/cgi-bin/online_docs/auth_apply/check",{withCredentials:!0,params:{bkn:(0,i.G)(),domainId:s.q.getConfig("domainId"),localPadId:s.q.getConfig("padId"),xsrf:(0,i.f)()}});case 2:if(500!==(t=e.sent).status){e.next=5;break}return e.abrupt("return",{apply:!1});case 5:return n=t.data,r={apply:!1},10003!==(null===n||void 0===n?void 0:n.retcode)&&10004!==n.retcode||(r="0"===n.pass?{apply:!0,noPass:!0}:"1"===n.pass?{apply:!0,pass:!0}:{apply:10003!==n.retcode}),this.applyAuthStatus=r,e.abrupt("return",r);case 10:case"end":return e.stop()}}),e,this)})))},t.bindGuidePermit=function(){var e=this;a.e.load("GuidePermitApply",(function(t){return c(e,void 0,void 0,regeneratorRuntime.mark((function e(){var n,r,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=s.q.getConfig("docType"),r=s.q.getConfig("padId"),o=s.q.getConfig("domainId"),t.init(n,r,o,(function(){}));case 4:case"end":return e.stop()}}),e)})))}))},t.isApplyAndUnpass=function(e){return(null===e||void 0===e?void 0:e.apply)&&!e.noPass&&!e.pass},t.isApplyAndNopass=function(e){return(null===e||void 0===e?void 0:e.apply)&&e.noPass},e}();t.Z=d},"../spread-sheet/src/external/check-slr/check-script-loader.ts":function(e,t,n){n.d(t,{e:function(){return d},g:function(){return a}}),n("../node_modules/regenerator-runtime/runtime.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.promise.js");var r=n("../packages/common-utils/src/index.ts"),o=n("../spread-sheet/src/core/data/configService/spreadConfig.ts"),i=n("../spread-sheet/src/external/constants/auth-type.ts"),s=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function s(e){try{c(r.next(e))}catch(t){i(t)}}function a(e){try{c(r.throw(e))}catch(t){i(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))};function a(){return o.q.getConfig("policy")!==i.G.Self}var c={GroupTips:function(){var e=(0,r.IZ)("groupUin")||(0,r.IZ)("group_code"),t=(0,r.IZ)("friendUin");return!!e||!!t},GuidePermitApply:function(){var e=o.q.getConfig("canEdit"),t=o.q.getConfig("creatorCorpId");return!e&&t}},d=new(function(){function e(){}var t=e.prototype;return t.load=function(e,t){var r;return s(this,void 0,void 0,regeneratorRuntime.mark((function o(){var i;return regeneratorRuntime.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,this.checkIfNeedLoad(e);case 2:return(i=o.sent)&&(null===(r=n.g.SLR)||void 0===r||r.load(e,t)),o.abrupt("return",i);case 5:case"end":return o.stop()}}),o,this)})))},t.checkIfNeedLoad=function(e){return s(this,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!c[e]){t.next=4;break}return t.next=3,c[e]();case 3:return t.abrupt("return",t.sent);case 4:return t.abrupt("return",!0);case 5:case"end":return t.stop()}}),t)})))},e}())},"../spread-sheet/src/external/constants/auth-type.ts":function(e,t,n){n.d(t,{G:function(){return r}});var r={Self:0,Cooperation:1,Viewable:2,Editable:3}},"../spread-sheet/src/external/editNotify/VisitedVersionStore.ts":function(e,t,n){n.d(t,{g:function(){return r}}),n("../node_modules/core-js/modules/es.array.slice.js"),n("../node_modules/core-js/modules/es.array.find-index.js"),n("../node_modules/core-js/modules/es.array.splice.js");var r=function(){function e(e){this.STORE_KEY_PREFIX="SHEET_READED_VERSION",this.MAX_STORE_ITEM=20,this.docId=e}var t=e.prototype;return t.setVersion=function(e){var t=this.getVersionItems();t[0][1]=e,n.g.localStorage.setItem(this.STORE_KEY_PREFIX,JSON.stringify(t.slice(0,this.MAX_STORE_ITEM)))},t.getVersion=function(){return this.getVersionItems()[0][1]},t.getVersionItems=function(){var e=this,t=n.g.localStorage.getItem(this.STORE_KEY_PREFIX);try{if(t){var r,o=JSON.parse(t),i=o.findIndex((function(t){return t[0]===e.docId}));return r=i>=0?o.splice(i,1)[0]:[this.docId,0],o.unshift(r),o}}catch(s){}return[[this.docId,0]]},e}()},"../spread-sheet/src/external/view/common/constants/template-report.ts":function(e,t,n){var r,o;n.d(t,{W:function(){return r},k:function(){return o}}),function(e){e[e.All=0]="All",e[e.Mall=1]="Mall",e[e.Custom=2]="Custom"}(r||(r={})),function(e){e.FROM_BOTTOM="doc_excel_bottom_reco",e.FROM_NEW_SHEET="doc_excel_newsheet_reco"}(o||(o={}))},"../spread-sheet/src/external/view/main/footer/common/utils.ts":function(e,t,n){n.d(t,{Ls:function(){return d},eq:function(){return s},h0:function(){return a},jd:function(){return c}}),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.regexp.to-string.js"),n("../node_modules/core-js/modules/web.dom-collections.for-each.js"),n("../node_modules/core-js/modules/es.regexp.constructor.js"),n("../node_modules/core-js/modules/es.regexp.exec.js"),n("../node_modules/core-js/modules/es.string.match.js"),n("../node_modules/core-js/modules/es.number.constructor.js"),n("../node_modules/core-js/modules/es.array.map.js"),n("../node_modules/core-js/modules/es.array.find-index.js"),n("../node_modules/core-js/modules/es.object.assign.js");var r=n("../node_modules/i18next/dist/esm/i18next.js"),o=n("../packages/model/src/sheet/SheetType.ts"),i=n("../packages/model/src/sheet/sheetUtils.ts");function s(e){for(var t=Math.random().toString(36).substr(2,6),n=!1;!n;)e&&e.indexOf(t)>-1?t=Math.random().toString(36).substr(2,6):n=!0;return t}function a(e,t){void 0===t&&(t=o.ZP.GRID);var n=o.BG[t],r=[];return e.forEach((function(e){if(e.indexOf(n)>-1){var t=parseInt(e.substring(n.length));isNaN(t)||r.push(t)}})),r.length||r.push(0),""+(n+(Math.max.apply(null,r)+1))}function c(e,t){var n=new RegExp(r.ZP.t("(.*)\\(副本(\\d*)\\)")),o=0,i="";if(n.test(t)){var s=t.match(n);s&&(i=s[1])}else i=t;return e.forEach((function(e){var t=e.match(n);if(t&&i===t[1]){var r=t[2];if(r){var s=Number(r);s>=o&&(o=s+1)}else o=o||1}})),o?r.ZP.t("{{sheetName}}(副本{{lastIndex}})",{sheetName:i,lastIndex:o}):r.ZP.t("{{name}}(副本)",{name:t})}function d(e,t,n){if(1===t.length){var r=(0,i.formatRegStr)(n),o=RegExp("^"+r+"(?:（(\\d+)）)?$"),s=-1;return e.forEach((function(e){o.test(e)&&(s=Math.max(s,Number(RegExp.$1)))})),[(0,i.removeStartOrEndWithSingleQuotes)(n+(-1!==s?"（"+(s+1)+"）":""))]}var a={},c=t.map((function(e){var t=0|a[e];return a[e]=t+1,e+(t>0?"（"+t+"）":"")})),d=-1;c.forEach((function(t){var n=(0,i.formatRegStr)(t),r=RegExp("^"+n+"(?:（(\\d+)）)?$");e.forEach((function(e){r.test(e)&&(d=Math.max(d,Number(RegExp.$1)))}))}));var l=-1!==d?"（"+(d+1)+"）":"";return c.map((function(e){return(0,i.removeStartOrEndWithSingleQuotes)(""+e+l)}))}},"../spread-sheet/src/external/view/main/footer/logic/addLogic.ts":function(e,t,n){n.d(t,{U:function(){return _},h:function(){return p}}),n("../node_modules/regenerator-runtime/runtime.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.promise.js"),n("../node_modules/core-js/modules/web.dom-collections.for-each.js"),n("../node_modules/core-js/modules/es.array.flat.js"),n("../node_modules/core-js/modules/es.array.iterator.js"),n("../node_modules/core-js/modules/es.string.iterator.js"),n("../node_modules/core-js/modules/web.dom-collections.iterator.js"),n("../node_modules/core-js/modules/es.array.map.js"),n("../node_modules/core-js/modules/es.function.name.js");var r=n("../node_modules/i18next/dist/esm/i18next.js"),o=n("../spread-sheet/src/base/event/event.ts"),i=n("../spread-sheet/src/external/view/main/footer/common/utils.ts"),s=n("./node_modules/axios/index.js"),a=n.n(s),c=n("../node_modules/@tencent/dui/lib/components/Snackbar/index.js"),d=n("../node_modules/@tencent/dui/lib/components/Modal/index.js"),l=n("../packages/model/src/utils/index.ts"),u=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function s(e){try{c(r.next(e))}catch(t){i(t)}}function a(e){try{c(r.throw(e))}catch(t){i(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))},_=function e(t,n){return u(void 0,void 0,void 0,regeneratorRuntime.mark((function r(){var o,i,s,a,c,d,u;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(o=n.sheetType,i=n.viewType,s=n.callback,!(0,l.getIsExternalSheetBySheetType)(o)){r.next=13;break}if((c=t.sheetAdapterManager.getAdapterBySheetType(o)).isInitialized()){r.next=12;break}return d=v(),r.next=7,c.init();case 7:if(u=r.sent,d.close(),u){r.next=12;break}return y((function(){e(t,n)})),r.abrupt("return");case 12:i&&(a=c.getTableJSONByViewType(i));case 13:m({autoSwitch:!0,sheetType:o,tableJSON:a,callback:s});case 14:case"end":return r.stop()}}),r)})))},p=function e(t,r){return u(void 0,void 0,void 0,regeneratorRuntime.mark((function s(){var a,c,d,l,u,_,p,h,b,T,R,I;return regeneratorRuntime.wrap((function(s){for(;;)switch(s.prev=s.next){case 0:return a=r.templateId,c=r.isCustom,d=r.isApplyToCurSheet,l=r.templateTitle,u=v(),_=function(){e(t,r)},s.next=5,g(a,c);case 5:if(p=s.sent){s.next=11;break}return n.g.log.error("addSheetsFromTemplateLogic 获取模板数据失败"),u.close(),y(_),s.abrupt("return");case 11:return s.prev=11,s.next=14,E(t,p);case 14:s.next=21;break;case 16:return s.prev=16,s.t0=s.catch(11),u.close(),y(_),s.abrupt("return");case 21:h=t.spreadsheet,b=h.activeSheet,T=h.activeSheetId,R=b.getIndex(),I=(0,i.Ls)(t.spreadsheet.sheetManager.getSheetTitleList(),w(p),l),p.forEach((function(e,r){var i=e.sheetType,s=e.mutation,a=I[r],c=[];try{c=JSON.parse(s).flat()}catch(l){return n.g.log.error("addSheetsFromTemplateLogic 格式化模板数据异常: ",l),u.close(),void y(_)}d&&0===r?b.getSheetType()===i?f(t,{sheetType:i,sheetName:a,mutations:c}):m({autoSwitch:!0,sheetType:i,sheetIndex:R,mutations:c,sheetName:a,callback:function(){var e;e=T,o.ZP.sheetsBar.trigger("deleteSheet",e)}}):m({autoSwitch:0===r,sheetType:i,sheetIndex:R+=1,mutations:c,sheetName:a})})),u.close();case 26:case"end":return s.stop()}}),s,null,[[11,16]])})))};function f(e,t){var n=t.sheetType,i=t.sheetName,s=t.mutations,a=e.spreadsheet,c=a.activeSheet,u=a.activeSheetId;(function(e,t){o.ZP.sheetsBar.trigger("renameDone",e,t)})(u,i),(0,l.getIsExternalSheetBySheetType)(n)?e.sheetAdapterManager.getAdapterBySheetType(n).coverTableByTemplateMutations(u,s):c.data.isEmpty()?h(e,u,s):d.default.confirm({type:"basic",title:r.ZP.t("提示"),content:r.ZP.t("该工作表已有人编辑，使用模板将会覆盖对方的内容，是否继续？"),okText:r.ZP.t("仍然使用模板"),onOk:function(){h(e,u,s)}})}function h(e,t,n){e.requestApi.coverSheet({sheetId:t,mutations:n}).then((function(){e.dataCenter.updateSheetData(t)}))}function m(e){o.ZP.sheetsBar.trigger("addSheet",e)}function v(){return c.default.show({autoClose:!1,type:"loading",message:r.ZP.t("正在创建中...")})}function y(e){c.default.show({message:r.ZP.t("创建失败"),type:"error",closable:!0,action:r.ZP.t("重试"),onClickAction:e})}function g(e,t){var r;return u(this,void 0,void 0,regeneratorRuntime.mark((function o(){var i,s;return regeneratorRuntime.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return o.prev=0,o.next=3,a()({method:"POST",url:"/v2/mall/sheet/mutation",data:{id:e,is_custom:t}});case 3:if(i=o.sent,0===(null===(s=i.data)||void 0===s?void 0:s.cgicode)&&0===(null===s||void 0===s?void 0:s.retcode)){o.next=8;break}return n.g.log.error("getTemplateInfos 获取模板数据失败",null===s||void 0===s?void 0:s.msg),o.abrupt("return");case 8:return o.abrupt("return",null===(r=null===s||void 0===s?void 0:s.result)||void 0===r?void 0:r.mutations);case 11:return o.prev=11,o.t0=o.catch(0),n.g.log.error("getTemplateInfos 获取模板数据失败",o.t0),o.abrupt("return");case 15:case"end":return o.stop()}}),o,null,[[0,11]])})))}function E(e,t){return u(this,void 0,void 0,regeneratorRuntime.mark((function n(){var r,o,i=this;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r=[],o=[],t.forEach((function(t){return u(i,void 0,void 0,regeneratorRuntime.mark((function n(){var i,s,a=this;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:i=t.sheetType,(0,l.getIsExternalSheetBySheetType)(i)&&-1===o.indexOf(i)&&(o.push(i),s=e.sheetAdapterManager.getAdapterBySheetType(i),r.push(new Promise((function(e,t){return u(a,void 0,void 0,regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,s.init();case 2:if(!n.sent){n.next=6;break}e(),n.next=7;break;case 6:t();case 7:case"end":return n.stop()}}),n)})))}))));case 2:case"end":return n.stop()}}),n)})))})),n.next=5,Promise.all(r);case 5:case"end":return n.stop()}}),n)})))}function w(e){return e.map((function(e){return e.name}))}},"../spread-sheet/src/external/view/ui-layer/insert-row-col/insert-row-col-controller.tsx":function(e,t,n){n.d(t,{f:function(){return D}});var r,o,i,s,a,c,d,l=n("../node_modules/@babel/runtime/helpers/esm/createClass.js"),u=(n("../node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),n("../node_modules/core-js/modules/esnext.reflect.metadata.js"),n("../node_modules/core-js/modules/es.function.name.js"),n("react")),_=n("../node_modules/i18next/dist/esm/i18next.js"),p=n("../node_modules/@tencent/workbench/lib/esm/index.js"),f=n("../node_modules/@tencent/workbench/lib/esm/constants/service-name.js"),h=n("../node_modules/@tencent/workbench/lib/esm/decorators/method/menu.js"),m=n("../node_modules/@tencent/workbench/lib/esm/decorators/method/dynamic-loader/skip-with-default.js"),v=n("../node_modules/@tencent/workbench/lib/esm/decorators/param/action-point-info.js"),y=n("../node_modules/@tencent/workbench/lib/esm/decorators/method/contextmenu.js"),g=n("../node_modules/@tencent/workbench/lib/esm/decorators/method/mobile-context-menu.js"),E=n("../node_modules/@tencent/workbench/lib/esm/decorators/method/dynamic-loader/await-load.js"),w=n("../node_modules/@tencent/workbench/lib/esm/decorators/class/controller.js"),b=n("../node_modules/@tencent/ioc/lib/esm/index.js"),T=n("../spread-sheet/src/external/view/schema/menu-schema.ts"),R=n("../spread-sheet/src/external/view/schema/contextmenu-key.ts"),I=n("../spread-sheet/src/adapter/SpreadSheetAppAdapter.ts"),C=n("../spread-sheet/src/core/workbench/middleware/selection/selection-type.ts"),A=[{name:T.z_.INSERT_ROW_COL_IN_INSERT_MENU,content:_.ZP.t("插入行列"),preventDismiss:!0,icon:u.createElement("div",{className:"icon-svg-toolbar-add-insert-rh"}),sheetStatusMiddleware:{isDisableWhenCannotEditExceptRangeAuth:!0}},{name:T.z_.INSERT_ROW_COL_IN_EDIT_MENU,content:_.ZP.t("插入行列"),preventDismiss:!0},{name:T.z_.INSERT_ROW_ABOVE_IN_MENU,content:_.ZP.t("在上方插入1行"),selectionMiddleware:{include:[C.R.ROW,C.R.SINGLE_CELL,C.R.MERGED_CELL,C.R.CONTINUOUS_MUTLI_CELLS,C.R.ALL]},sheetStatusMiddleware:{isHiddenWhenCannotEditExceptRangeAuth:!0,isDisableWhenRangeCannotEdit:!0}},{name:T.z_.INSERT_ROW_BELOW_IN_MENU,content:_.ZP.t("在下方插入1行"),selectionMiddleware:{include:[C.R.ROW,C.R.SINGLE_CELL,C.R.MERGED_CELL,C.R.CONTINUOUS_MUTLI_CELLS,C.R.ALL]},sheetStatusMiddleware:{isHiddenWhenCannotEditExceptRangeAuth:!0,isDisableWhenRangeCannotEdit:!0}},{name:T.z_.INSERT_COL_LEFT_IN_MENU,content:_.ZP.t("在左侧插入1列"),selectionMiddleware:{include:[C.R.COL,C.R.SINGLE_CELL,C.R.MERGED_CELL,C.R.CONTINUOUS_MUTLI_CELLS,C.R.ALL]},sheetStatusMiddleware:{isHiddenWhenCannotEditExceptRangeAuth:!0,isDisableWhenRangeCannotEdit:!0}},{name:T.z_.INSERT_COL_RIGHT_IN_MENU,content:_.ZP.t("在右侧插入1列"),selectionMiddleware:{include:[C.R.COL,C.R.SINGLE_CELL,C.R.MERGED_CELL,C.R.CONTINUOUS_MUTLI_CELLS,C.R.ALL]},sheetStatusMiddleware:{isHiddenWhenCannotEditExceptRangeAuth:!0,isDisableWhenRangeCannotEdit:!0}}],x=[{name:R.B.INSERT_ROW_ABOVE,content:_.ZP.t("在上方插入"),selectionMiddleware:{include:[C.R.ROW,C.R.SINGLE_CELL,C.R.MERGED_CELL,C.R.CONTINUOUS_MUTLI_CELLS,C.R.ALL]},sheetStatusMiddleware:{isHiddenWhenCannotEditExceptRangeAuth:!0,isDisableWhenRangeCannotEdit:!0}},{name:R.B.INSERT_ROW_BELOW,content:_.ZP.t("在下方插入"),selectionMiddleware:{include:[C.R.ROW,C.R.SINGLE_CELL,C.R.MERGED_CELL,C.R.CONTINUOUS_MUTLI_CELLS,C.R.ALL]},sheetStatusMiddleware:{isHiddenWhenCannotEditExceptRangeAuth:!0,isDisableWhenRangeCannotEdit:!0}},{name:R.B.INSERT_COL_LEFT,content:_.ZP.t("在左侧插入"),selectionMiddleware:{include:[C.R.COL,C.R.SINGLE_CELL,C.R.MERGED_CELL,C.R.CONTINUOUS_MUTLI_CELLS,C.R.ALL]},sheetStatusMiddleware:{isHiddenWhenCannotEditExceptRangeAuth:!0,isDisableWhenRangeCannotEdit:!0}},{name:R.B.INSERT_COL_RIGHT,selectionMiddleware:{include:[C.R.COL,C.R.SINGLE_CELL,C.R.MERGED_CELL,C.R.CONTINUOUS_MUTLI_CELLS,C.R.ALL]},sheetStatusMiddleware:{isHiddenWhenCannotEditExceptRangeAuth:!0,isDisableWhenRangeCannotEdit:!0},content:_.ZP.t("在右侧插入")}],O=[{name:R.B.INSERT_ROW_ABOVE,icon:u.createElement("div",{className:"workbench-context-menu-icon mobile-design-icon longpress_addup"}),content:_.ZP.t("在上方插入"),selectionMiddleware:{include:[C.R.ROW]},sheetStatusMiddleware:{isHiddenWhenCannotEdit:!0}},{name:R.B.INSERT_ROW_BELOW,icon:u.createElement("div",{className:"workbench-context-menu-icon mobile-design-icon longpress_adddown"}),content:_.ZP.t("在下方插入"),selectionMiddleware:{include:[C.R.ROW]},sheetStatusMiddleware:{isHiddenWhenCannotEdit:!0}},{name:R.B.INSERT_COL_LEFT,icon:u.createElement("div",{className:"workbench-context-menu-icon mobile-design-icon longpress_addleft"}),content:_.ZP.t("在左侧插入"),selectionMiddleware:{include:[C.R.COL]},sheetStatusMiddleware:{isHiddenWhenCannotEdit:!0}},{name:R.B.INSERT_COL_RIGHT,icon:u.createElement("div",{className:"workbench-context-menu-icon mobile-design-icon longpress_addright"}),content:_.ZP.t("在右侧插入"),selectionMiddleware:{include:[C.R.COL]},sheetStatusMiddleware:{isHiddenWhenCannotEdit:!0}}],N=n("../spread-sheet/src/external/view/ui-layer/insert-row-col/insert-row-col.interface.ts"),S=function(e,t,n,r){var o,i=arguments.length,s=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},k=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},P=function(e,t){return function(n,r){t(n,r,e)}},D=function(){function e(e){this.loader=e}var t=e.prototype;return t.shouldHide=function(){return this.insertRowColFeature.shouldHide()},t.insertMenuContent=function(e){var t=this.insertRowColFeature.getSelectedRowCount(),n=this.insertRowColFeature.getSelectedColCount();switch(e.name){case T.z_.INSERT_ROW_ABOVE_IN_MENU:return _.ZP.t("在上方插入{{rows}}行",{rows:t});case T.z_.INSERT_ROW_BELOW_IN_MENU:return _.ZP.t("在下方插入{{rows}}行",{rows:t});case T.z_.INSERT_COL_LEFT_IN_MENU:return _.ZP.t("在左侧插入{{cols}}列",{cols:n});case T.z_.INSERT_COL_RIGHT_IN_MENU:return _.ZP.t("在右侧插入{{cols}}列",{cols:n});default:return _.ZP.t("插入")}},t.insertRowAbove=function(e){var t=1;t=e.from===f.v.CONTEXT_MENU?this.insertRowColFeature.cacheInsertAmount[R.B.INSERT_ROW_ABOVE]:this.insertRowColFeature.getSelectedRowCount(),this.insertRowColFeature.insertRowAbove(t)},t.insertRowBelow=function(e){var t=1;t=e.from===f.v.CONTEXT_MENU?this.insertRowColFeature.cacheInsertAmount[R.B.INSERT_ROW_BELOW]:this.insertRowColFeature.getSelectedRowCount(),this.insertRowColFeature.insertRowBelow(t)},t.insertColLeft=function(e){var t=1;t=e.from===f.v.CONTEXT_MENU?this.insertRowColFeature.cacheInsertAmount[R.B.INSERT_COL_LEFT]:this.insertRowColFeature.getSelectedColCount(),this.insertRowColFeature.insertColLeft(t)},t.insertColRight=function(e){var t=1;t=e.from===f.v.CONTEXT_MENU?this.insertRowColFeature.cacheInsertAmount[R.B.INSERT_COL_RIGHT]:this.insertRowColFeature.getSelectedColCount(),this.insertRowColFeature.insertColRight(t)},t.getInsertDescription=function(e){var t;return t=e.name===R.B.INSERT_ROW_ABOVE||e.name===R.B.INSERT_ROW_BELOW?e.name===R.B.INSERT_ROW_ABOVE?_.ZP.t("INSERT_ROW_ABOVE"):_.ZP.t("INSERT_ROW_BELOW"):e.name===R.B.INSERT_COL_LEFT?_.ZP.t("INSERT_COL_LEFT"):_.ZP.t("INSERT_COL_RIGHT"),u.createElement(u.Fragment,null,this.insertRowColFeature.getInsertInput(e.name),u.createElement("span",{style:{color:"rgba(0, 0, 0, 0.88)"}},t))},(0,l.Z)(e,[{key:"insertRowColFeature",get:function(){return this.loader.instance}}]),e}();S([(0,h.v)(T.z_.INSERT_ROW_COL_IN_INSERT_MENU,"shouldHide"),(0,h.v)(T.z_.INSERT_ROW_COL_IN_EDIT_MENU,"shouldHide"),(0,m.z)(!1),k("design:type",Function),k("design:paramtypes",[]),k("design:returntype",Boolean)],D.prototype,"shouldHide",null),S([(0,h.v)(T.z_.INSERT_ROW_ABOVE_IN_MENU,"content"),(0,h.v)(T.z_.INSERT_ROW_BELOW_IN_MENU,"content"),(0,h.v)(T.z_.INSERT_COL_LEFT_IN_MENU,"content"),(0,h.v)(T.z_.INSERT_COL_RIGHT_IN_MENU,"content"),(0,m.z)(_.ZP.t("插入")),P(0,(0,v.g)()),k("design:type",Function),k("design:paramtypes",["function"===typeof(r="undefined"!==typeof p.IActionPointInfo&&p.IActionPointInfo)?r:Object]),k("design:returntype",void 0)],D.prototype,"insertMenuContent",null),S([(0,y.x)(R.B.INSERT_ROW_ABOVE,"onClick"),(0,h.v)(T.z_.INSERT_ROW_ABOVE_IN_MENU,"onClick"),(0,g.w)(R.B.INSERT_ROW_ABOVE,"onClick"),(0,E.k)(),P(0,(0,v.g)()),k("design:type",Function),k("design:paramtypes",["function"===typeof(o="undefined"!==typeof p.IActionPointInfo&&p.IActionPointInfo)?o:Object]),k("design:returntype",void 0)],D.prototype,"insertRowAbove",null),S([(0,y.x)(R.B.INSERT_ROW_BELOW,"onClick"),(0,h.v)(T.z_.INSERT_ROW_BELOW_IN_MENU,"onClick"),(0,g.w)(R.B.INSERT_ROW_BELOW,"onClick"),(0,E.k)(),P(0,(0,v.g)()),k("design:type",Function),k("design:paramtypes",["function"===typeof(i="undefined"!==typeof p.IActionPointInfo&&p.IActionPointInfo)?i:Object]),k("design:returntype",void 0)],D.prototype,"insertRowBelow",null),S([(0,y.x)(R.B.INSERT_COL_LEFT,"onClick"),(0,h.v)(T.z_.INSERT_COL_LEFT_IN_MENU,"onClick"),(0,g.w)(R.B.INSERT_COL_LEFT,"onClick"),(0,E.k)(),P(0,(0,v.g)()),k("design:type",Function),k("design:paramtypes",["function"===typeof(s="undefined"!==typeof p.IActionPointInfo&&p.IActionPointInfo)?s:Object]),k("design:returntype",void 0)],D.prototype,"insertColLeft",null),S([(0,y.x)(R.B.INSERT_COL_RIGHT,"onClick"),(0,h.v)(T.z_.INSERT_COL_RIGHT_IN_MENU,"onClick"),(0,g.w)(R.B.INSERT_COL_RIGHT,"onClick"),(0,E.k)(),P(0,(0,v.g)()),k("design:type",Function),k("design:paramtypes",["function"===typeof(a="undefined"!==typeof p.IActionPointInfo&&p.IActionPointInfo)?a:Object]),k("design:returntype",void 0)],D.prototype,"insertColRight",null),S([(0,y.x)(R.B.INSERT_ROW_ABOVE,"description"),(0,y.x)(R.B.INSERT_ROW_BELOW,"description"),(0,y.x)(R.B.INSERT_COL_LEFT,"description"),(0,y.x)(R.B.INSERT_COL_RIGHT,"description"),(0,m.z)(u.createElement("div",null)),P(0,(0,v.g)()),k("design:type",Function),k("design:paramtypes",["function"===typeof(c="undefined"!==typeof p.IActionPointInfo&&p.IActionPointInfo)?c:Object]),k("design:returntype",void 0)],D.prototype,"getInsertDescription",null),D=S([(0,w.Q)({adapters:[I.L],menuItems:A,contextMenuItems:x,mobileContextMenuItems:O}),P(0,(0,b.aN)(N.n$)),k("design:paramtypes",["function"===typeof(d="undefined"!==typeof p.IDynamicLoader&&p.IDynamicLoader)?d:Object])],D)},"../spread-sheet/src/external/view/ui-layer/template-recommendation/config.ts":function(e,t,n){n.d(t,{h:function(){return g},G:function(){return y}}),n("../node_modules/core-js/modules/es.array.iterator.js"),n("../node_modules/core-js/modules/es.map.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.string.iterator.js"),n("../node_modules/core-js/modules/esnext.map.delete-all.js"),n("../node_modules/core-js/modules/esnext.map.every.js"),n("../node_modules/core-js/modules/esnext.map.filter.js"),n("../node_modules/core-js/modules/esnext.map.find.js"),n("../node_modules/core-js/modules/esnext.map.find-key.js"),n("../node_modules/core-js/modules/esnext.map.includes.js"),n("../node_modules/core-js/modules/esnext.map.key-of.js"),n("../node_modules/core-js/modules/esnext.map.map-keys.js"),n("../node_modules/core-js/modules/esnext.map.map-values.js"),n("../node_modules/core-js/modules/esnext.map.merge.js"),n("../node_modules/core-js/modules/esnext.map.reduce.js"),n("../node_modules/core-js/modules/esnext.map.some.js"),n("../node_modules/core-js/modules/esnext.map.update.js"),n("../node_modules/core-js/modules/web.dom-collections.iterator.js"),n("../node_modules/core-js/modules/es.array.includes.js"),n("../node_modules/core-js/modules/es.string.includes.js"),n("../node_modules/core-js/modules/es.array.slice.js"),n("../node_modules/core-js/modules/es.function.name.js"),n("../node_modules/core-js/modules/es.array.from.js"),n("../node_modules/core-js/modules/es.symbol.js"),n("../node_modules/core-js/modules/es.symbol.description.js"),n("../node_modules/core-js/modules/es.symbol.iterator.js");var r,o=n("../node_modules/i18next/dist/esm/i18next.js");function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}!function(e){e[e.ZH_CN=0]="ZH_CN",e[e.ZH_HK=1]="ZH_HK",e[e.EN=2]="EN"}(r||(r={}));for(var s,a=new Map([[r.ZH_CN,["zh","zh-CN"]],[r.ZH_HK,["zh-HK"]],[r.EN,["en","en-US"]]]),c=r.ZH_CN,d=function(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){if(e){if("string"===typeof e)return i(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?i(e,t):void 0}}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0;return function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(a);!(s=d()).done;){var l=s.value,u=l[0],_=l[1];if(o.ZP.language&&_.includes(o.ZP.language)){c=u;break}}var p,f,h=c,m=(n("../spread-sheet/src/base/util/domain-config.ts"),n("../spread-sheet/src/core/utils/gray.ts")),v=((p={})[r.ZH_CN]={newDoc:"47yooia97prt5qykseopgx8h9o",newNormalSheet:"t4qoofic4td6fmyokrr7hmukye",newSmartSheet:"g6zryb8dk7n73ews5xw5mjjeuh"},p[r.ZH_HK]={newDoc:"if7w56yrp7d45cb3ca7enwyfxa",newNormalSheet:"qn35eowg4trc9ydnhs1n5xxw3o",newSmartSheet:"afmc34814by6uetcbwnqfuodfw"},p[r.EN]={newDoc:"yrkdf93gojg7bghbx7tmi4zgqh",newNormalSheet:"xprgous91jribgqa7oo3o55kba",newSmartSheet:"netufss6jpdp3bexx6pezw6oda"},p),y=((f={})[r.ZH_CN]={newDoc:"t56gcftmn7nxtdm1q5c8eu71yc",newNormalSheet:"5ny3rzr9qfbadgozs4y5zs94cc",newSmartSheet:"uqtdngjuhbn8bqbzpek6amzr4a"},f[r.ZH_HK]={newDoc:"9p1r1s3gjprkjr84f9qzqtzosr",newNormalSheet:"7sbwf5oa4jn3pebf1tk1ppkzxa",newSmartSheet:"w9nj93g1tjyexdnr1rmjgwbzwa"},f[r.EN]={newDoc:"xjkkucckc7b75epkw3esn85bqy",newNormalSheet:"emi6uex8wiye5rgktoeya6n1ba",newSmartSheet:"tp93zp4gdpbi9nnsxbdzf86tba"},v[h]),g=!(0,m.c)()&&!(0,m.i)()},"../spread-sheet/src/external/view/ui-layer/template-recommendation/template-recommendation-service.tsx":function(e,t,n){n.d(t,{Z:function(){return N}}),n("../node_modules/regenerator-runtime/runtime.js"),n("../node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),n("../node_modules/core-js/modules/esnext.reflect.metadata.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.promise.js"),n("../node_modules/core-js/modules/es.array.iterator.js"),n("../node_modules/core-js/modules/es.map.js"),n("../node_modules/core-js/modules/es.string.iterator.js"),n("../node_modules/core-js/modules/esnext.map.delete-all.js"),n("../node_modules/core-js/modules/esnext.map.every.js"),n("../node_modules/core-js/modules/esnext.map.filter.js"),n("../node_modules/core-js/modules/esnext.map.find.js"),n("../node_modules/core-js/modules/esnext.map.find-key.js"),n("../node_modules/core-js/modules/esnext.map.includes.js"),n("../node_modules/core-js/modules/esnext.map.key-of.js"),n("../node_modules/core-js/modules/esnext.map.map-keys.js"),n("../node_modules/core-js/modules/esnext.map.map-values.js"),n("../node_modules/core-js/modules/esnext.map.merge.js"),n("../node_modules/core-js/modules/esnext.map.reduce.js"),n("../node_modules/core-js/modules/esnext.map.some.js"),n("../node_modules/core-js/modules/esnext.map.update.js"),n("../node_modules/core-js/modules/web.dom-collections.iterator.js");var r,o,i=n("react"),s=n.n(i),a=n("../node_modules/@tencent/workbench/lib/esm/decorators/class/service.js"),c=n("../node_modules/@tencent/workbench/lib/esm/services/widget/widget-service.js"),d=n("../node_modules/@babel/runtime/helpers/esm/assertThisInitialized.js"),l=n("../node_modules/@babel/runtime/helpers/esm/inheritsLoose.js"),u=n("react-dom"),_=n.n(u),p=n("../spread-sheet/src/external/view/main/footer/logic/addLogic.ts"),f=n("../spread-sheet/src/external/view/common/constants/template-report.ts"),h=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function s(e){try{c(r.next(e))}catch(t){i(t)}}function a(e){try{c(r.throw(e))}catch(t){i(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))},m=s().lazy((function(){return n.e("node_modules_tencent_docs-tmall-recommendation_dist_index_js").then(n.t.bind(n,"../node_modules/@tencent/docs-tmall-recommendation/dist/index.js",23))})),v=function(e){function t(t){var n;return(n=e.call(this,t)||this).containerId="template-recommendation-container",n.renderTMallRecommendation=function(){var e=n.props,t=e.templateThemeId,r=e.close,o=document.getElementById(n.containerId),a=document.querySelector("#footerContainer"),c=(null===a||void 0===a?void 0:a.clientHeight)||36;_().render(s().createElement(i.Suspense,{fallback:null},s().createElement(m,{type:"sheet",fromPage:f.k.FROM_BOTTOM,className:"template-recommendation",id:t,visibility:!0,onClickTemplate:n.onClickTemplate,onClose:r,closeText:"",container:o||void 0,mask:!0,maskStyle:{bottom:c}})),document.getElementById(n.containerId))},n.onClickTemplate=function(e){return h((0,d.Z)(n),void 0,void 0,regeneratorRuntime.mark((function t(){var n,r,o,i,s,a;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this.props.close(),s=!!e.marketingId,(a=null===(r=null===(n=null===window||void 0===window?void 0:window.discussionExt)||void 0===n?void 0:n.getTemplateSourceKey)||void 0===r?void 0:r.call(n))&&localStorage.setItem(a,s?"2":"1"),null===(i=null===(o=null===window||void 0===window?void 0:window.discussionExt)||void 0===o?void 0:o.setTemplateId)||void 0===i||i.call(o,e.id),(0,p.h)(this.props.app,{templateId:e.id,isCustom:e.source===f.W.Custom,isApplyToCurSheet:!0,templateTitle:e.title});case 6:case"end":return t.stop()}}),t,this)})))},n}(0,l.Z)(t,e);var n=t.prototype;return n.render=function(){return s().createElement("div",{id:this.containerId})},n.componentDidMount=function(){this.renderTMallRecommendation()},n.componentDidUpdate=function(){this.renderTMallRecommendation()},t}(s().Component),y=n("../spread-sheet/src/core/app/SpreadsheetApp.interface.ts"),g=n("../spread-sheet/src/external/view/ui-layer/template-recommendation/config.ts"),E=n("../spread-sheet/src/core/data/configService/spreadConfig.ts"),w=n("../spread-sheet/src/core/app/utils.ts"),b=n("../spread-sheet/src/base/event/event.ts"),T=n("../packages/mutation/src/index.ts"),R=n("../packages/mutation/src/MutationId.ts"),I=function(e,t,n,r){var o,i=arguments.length,s=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},C=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},A=function(e,t){return function(n,r){t(n,r,e)}},x=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function s(e){try{c(r.next(e))}catch(t){i(t)}}function a(e){try{c(r.throw(e))}catch(t){i(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))},O=function(e,t){var n=this;this.app=e,this.widgetService=t,this.widgetName="template-recommendation",this.sheetMap=new Map,this.show=function(e,t){n.sheetMap.size||n.addEvent(),n.curSheetId=e,n.sheetMap.set(e,t),n.widgetService.float({name:n.widgetName,component:i.createElement(v,{app:n.app,templateThemeId:t,close:n.close}),styles:{zIndex:1,position:"relative"}})},this.close=function(){n.curSheetId&&(n.sheetMap.delete(n.curSheetId),n.hide(),n.sheetMap.size||n.removeEvent())},this.hide=function(){n.curSheetId&&(n.curSheetId=void 0,n.widgetService.remove(n.widgetName,"float"))},this.addEvent=function(){b.ZP.sheetsBar.listen("switchActiveSheetEnd",n.handleSwitchSheet),n.app.mutationBehavior.emitter.addListener(n.app.mutationBehavior.EVENT.AFTER_MUTATION_RUN,n.handleAfterMutation);var e=n.app.view.canvas.inputManager;e.emitter.addListener(e.EVENT.ENTER_INPUT,n.close),b.ZP.default.listen("smartSheetFirstEdit",n.handleAfterSmartSheetFirstEdit)},this.removeEvent=function(){b.ZP.sheetsBar.remove("switchActiveSheetEnd",n.handleSwitchSheet),n.app.mutationBehavior.emitter.removeListener(n.app.mutationBehavior.EVENT.AFTER_MUTATION_RUN,n.handleAfterMutation);var e=n.app.view.canvas.inputManager;e.emitter.removeListener(e.EVENT.ENTER_INPUT,n.close),b.ZP.default.remove("smartSheetFirstEdit",n.handleAfterSmartSheetFirstEdit)},this.handleSwitchSheet=function(e){n.curSheetId&&n.hide();var t=n.sheetMap.get(e);t&&n.show(e,t)},this.handleAfterMutation=function(e){var t,r=e.sheetId,o=e.mutation,i=o.id;o.operationType!==T.g8.HISTORY&&("WORKBOOK"===r&&i===R.ZP.DEFINE_WORKBOOK_RANGE_MUTATION&&(r=null===(t=null===o||void 0===o?void 0:o.gridRange)||void 0===t?void 0:t.sheetId),r===n.curSheetId&&n.close())},this.handleAfterSmartSheetFirstEdit=function(e){e===n.curSheetId&&n.close()},this.init=function(){return x(n,void 0,void 0,regeneratorRuntime.mark((function e(){var t,n,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=E.q.getConfig("ownerId"),n=E.q.getConfig("tinyid"),r=E.q.getConfig("uid"),t!==n&&t!==r||!(0,w.x5)(this.app.spreadsheet)||this.show(this.app.spreadsheet.activeSheetId,g.G.newDoc);case 5:case"end":return e.stop()}}),e,this)})))},this.init()},N=O=I([(0,a.t)(),A(0,y.m),C("design:paramtypes",["function"===typeof(r="undefined"!==typeof y.m&&y.m)?r:Object,"function"===typeof(o="undefined"!==typeof c.i&&c.i)?o:Object])],O)}}]),window.jsExecEndTimeStamp=Date.now(),window.cachedPerformanceEntries||(window.cachedPerformanceEntries=[]),window.cachedPerformanceEntries.push({name:"jsExec: js/bundle_workbench_pc.a294197d9bb143eb15f0.js",entryType:"jsExec",startTime:window.jsExecStartTimeStamp,endTime:window.jsExecEndTimeStamp});
//# sourceMappingURL=bundle_workbench_pc.a294197d9bb143eb15f0.js.map