self.window=self,window.jsExecStartTimeStamp=Date.now(),(self.webpackChunk_tencent_alloy_builder=self.webpackChunk_tencent_alloy_builder||[]).push([["spread-sheet_src_core_feature_dataValidation_api_DataValidationError_ts-spread-sheet_src_core-860e25"],{"../spread-sheet/src/core/feature/dataValidation/DVInterface.ts":function(e,t,r){r.d(t,{Bb:function(){return u},Ju:function(){return i},UD:function(){return l},c1:function(){return d},h6:function(){return o.h6},ob:function(){return o.ob},y3:function(){return s}}),r("../node_modules/core-js/modules/es.array.iterator.js"),r("../node_modules/core-js/modules/es.map.js"),r("../node_modules/core-js/modules/es.object.to-string.js"),r("../node_modules/core-js/modules/es.string.iterator.js"),r("../node_modules/core-js/modules/esnext.map.delete-all.js"),r("../node_modules/core-js/modules/esnext.map.every.js"),r("../node_modules/core-js/modules/esnext.map.filter.js"),r("../node_modules/core-js/modules/esnext.map.find.js"),r("../node_modules/core-js/modules/esnext.map.find-key.js"),r("../node_modules/core-js/modules/esnext.map.includes.js"),r("../node_modules/core-js/modules/esnext.map.key-of.js"),r("../node_modules/core-js/modules/esnext.map.map-keys.js"),r("../node_modules/core-js/modules/esnext.map.map-values.js"),r("../node_modules/core-js/modules/esnext.map.merge.js"),r("../node_modules/core-js/modules/esnext.map.reduce.js"),r("../node_modules/core-js/modules/esnext.map.some.js"),r("../node_modules/core-js/modules/esnext.map.update.js"),r("../node_modules/core-js/modules/web.dom-collections.iterator.js");var n=r("../node_modules/i18next/dist/esm/i18next.js"),a=r("../packages/model/src/index.ts"),o=r("../spread-sheet/src/core/feature/dataValidation/type.ts"),s=new Map([[a.Cell.DATA_VALIDATION_CONDITION_TYPE.BETWEEN,n.ZP.t("介于")],[a.Cell.DATA_VALIDATION_CONDITION_TYPE.NOT_BETWEEN,n.ZP.t("不介于")],[a.Cell.DATA_VALIDATION_CONDITION_TYPE.EQUAL,n.ZP.t("等于")],[a.Cell.DATA_VALIDATION_CONDITION_TYPE.NOT_EQUAL,n.ZP.t("不等于")],[a.Cell.DATA_VALIDATION_CONDITION_TYPE.LESS,n.ZP.t("早于")],[a.Cell.DATA_VALIDATION_CONDITION_TYPE.LESS_EQUAL,n.ZP.t("不晚于")],[a.Cell.DATA_VALIDATION_CONDITION_TYPE.GREAT,n.ZP.t("晚于")],[a.Cell.DATA_VALIDATION_CONDITION_TYPE.GREAT_EQUAL,n.ZP.t("不早于")]]),u=new Map([[a.Cell.DATA_VALIDATION_CONDITION_TYPE.BETWEEN,n.ZP.t("介于")],[a.Cell.DATA_VALIDATION_CONDITION_TYPE.NOT_BETWEEN,n.ZP.t("不介于")],[a.Cell.DATA_VALIDATION_CONDITION_TYPE.EQUAL,n.ZP.t("等于")],[a.Cell.DATA_VALIDATION_CONDITION_TYPE.NOT_EQUAL,n.ZP.t("不等于")],[a.Cell.DATA_VALIDATION_CONDITION_TYPE.LESS,n.ZP.t("小于")],[a.Cell.DATA_VALIDATION_CONDITION_TYPE.LESS_EQUAL,n.ZP.t("小于或等于")],[a.Cell.DATA_VALIDATION_CONDITION_TYPE.GREAT,n.ZP.t("大于")],[a.Cell.DATA_VALIDATION_CONDITION_TYPE.GREAT_EQUAL,n.ZP.t("大于或等于")],[a.Cell.DATA_VALIDATION_CONDITION_TYPE.INCLUDE,n.ZP.t("包括")],[a.Cell.DATA_VALIDATION_CONDITION_TYPE.NOT_INCLUDE,n.ZP.t("不包括")]]),l=new Map([[a.Cell.DATA_VALIDATION_CONDITION_TYPE.BETWEEN,n.ZP.t("介于")],[a.Cell.DATA_VALIDATION_CONDITION_TYPE.NOT_BETWEEN,n.ZP.t("不介于")],[a.Cell.DATA_VALIDATION_CONDITION_TYPE.EQUAL,n.ZP.t("等于")],[a.Cell.DATA_VALIDATION_CONDITION_TYPE.NOT_EQUAL,n.ZP.t("不等于")],[a.Cell.DATA_VALIDATION_CONDITION_TYPE.LESS,n.ZP.t("小于")],[a.Cell.DATA_VALIDATION_CONDITION_TYPE.LESS_EQUAL,n.ZP.t("小于或等于")],[a.Cell.DATA_VALIDATION_CONDITION_TYPE.GREAT,n.ZP.t("大于")],[a.Cell.DATA_VALIDATION_CONDITION_TYPE.GREAT_EQUAL,n.ZP.t("大于或等于")]]),i=new Map([[o.h6.NONE,n.ZP.t("数值")],[o.h6.INT,n.ZP.t("整数")],[o.h6.FLOAT,n.ZP.t("小数")]]),d=new Map([[o.h6.ID_CARD,n.ZP.t("身份证号")],[o.h6.MAIL,n.ZP.t("邮箱")],[o.h6.PHONE,n.ZP.t("手机号")],[o.h6.TELEPHONE,n.ZP.t("电话号码")]])},"../spread-sheet/src/core/feature/dataValidation/api/DataValidationConfig.ts":function(e,t,r){r.d(t,{N:function(){return l}}),r("../node_modules/core-js/modules/es.array.map.js"),r("../node_modules/core-js/modules/es.array.filter.js");var n=r("../packages/model/src/cell/data-validation/data-validation-utils.ts"),a=r("../packages/model/src/cell/data-validation/data-validation-rule-type.ts"),o=r("../spread-sheet/src/core/feature/formula/utils.ts"),s=r("../packages/model/src/range/hexRangeUtils.ts"),u=r("../spread-sheet/src/core/feature/dataValidation/DVInterface.ts");function l(e,t){var r,l=function(e){var t=e.validType,r=e.dataType;switch(t){case u.ob.LIST:return a.Z.LIST;case u.ob.NUMBER:switch(r){case u.h6.FLOAT:return a.Z.CUSTOM_MUST_FLOAT;case u.h6.INT:return a.Z.NUMBER_INT;case u.h6.NONE:return a.Z.NUMBER_FLOAT_AND_INT;case u.h6.TEMPERATURE:return a.Z.CUSTOM_NUMBER_TEMPERATURE;case u.h6.PROGRESS:return a.Z.CUSTOM_PROGRESS}break;case u.ob.TEXT:switch(r){case u.h6.CONTENT:return a.Z.CUSTOM_TEXT_CONTAINS;case u.h6.LENGTH:default:return a.Z.TEXT_LENGTH}case u.ob.DATE:return a.Z.DATE;case u.ob.AVAILABLE:switch(r){case u.h6.ID_CARD:return a.Z.CUSTOM_ID_CARD;case u.h6.PHONE:return a.Z.CUSTOM_NUM_PHONE;case u.h6.TELEPHONE:return a.Z.CUSTOM_NUM_TEL;case u.h6.MAIL:return a.Z.CUSTOM_TEXT_MAIL}break;case u.ob.CHECKBOX:return a.Z.CUSTOM_CHECKBOX;case u.ob.STAR:return a.Z.CUSTOM_STAR;case u.ob.ATTACHMENT:return a.Z.CUSTOM_ATTACHMENT;case u.ob.CONTACT:return a.Z.CUSTOM_CONTACT}return console.warn("数据验证：传入数据不符合规则"),a.Z.CUSTOM}({validType:e.validType,dataType:e.dataType}),i=(null===(r=e.argTokens)||void 0===r?void 0:r.filter((function(e){return Boolean(e.userEnteredValue)})).map((function(r){var u=r.userEnteredValue,i=e.selection;if(i&&l===a.Z.LIST&&(0,o.jr)(u)){var d=(0,s.getRangeInfoFormHexRange)(t,u),c=d.rangeString,T={sheetId:d.sheetId,rowIndex:i.startRowIndex,colIndex:i.startColIndex};return(0,n.G8)("="+c,{ruleType:l,positionInfo:T})}return(0,n.G8)(u)})))||null;return{ruleType:l,inputMessage:e.inputMessage||null,isStrict:e.isStrict||!1,showDropDown:e.showDropDown||!1,operator:e.operator,argTokens:i}}},"../spread-sheet/src/core/feature/dataValidation/api/DataValidationError.ts":function(e,t,r){r.r(t),r.d(t,{getAvailableErrorMessage:function(){return c},getDataValidationError:function(){return p},getDataValidationErrorMessage:function(){return N},getDateErrorMessage:function(){return _},getErrorMessage:function(){return A},getListErrormessage:function(){return d},getNumberErrorMessage:function(){return T},getTextErrorMessage:function(){return E}});var n=r("../node_modules/i18next/dist/esm/i18next.js"),a=r("../packages/model/src/index.ts"),o=r("../packages/model/src/cell/data-validation/data-validation-utils.ts"),s=r("../spread-sheet/src/core/utils/formula.ts"),u=r("../spread-sheet/src/core/feature/dataValidation/DVInterface.ts"),l=r("../spread-sheet/src/core/feature/dataValidation/api/DataValidationUtils.ts"),i=r("../packages/common-utils/src/common/string.ts");function d(){return n.ZP.t("请输入已有的选项。")}function c(e){var t=e.dataType;return t?n.ZP.t("请输入有效的{{value}}。",{value:u.c1.get(t)}):""}function T(e){var t=e.dataType,r=e.operate;if(t===u.h6.TEMPERATURE)return n.ZP.t("请输入有效的温度。");var o=e.inputOne,l=e.inputTwo,i=n.ZP.t("无效的输入");return r&&t?(o=o||" ",l=l||" ",(0,s.isFormulaAndError)(o)||(0,s.isFormulaAndError)(l)?n.ZP.t("校验条件中存在非法公式"):i=r===a.Cell.DATA_VALIDATION_CONDITION_TYPE.BETWEEN||r===a.Cell.DATA_VALIDATION_CONDITION_TYPE.NOT_BETWEEN?n.ZP.t("请输入{{value0}}{{inputOne}}到{{inputTwo}}之间的{{value3}}。",{inputOne:o,inputTwo:l,value0:u.UD.get(r),value3:u.Ju.get(t)||n.ZP.t("数值")}):n.ZP.t("请输入{{value0}}{{inputOne}}的{{value2}}。",{inputOne:o,value0:u.UD.get(r),value2:u.Ju.get(t)||n.ZP.t("数值")})):i}function E(e){var t=e.dataType,r=e.operate,o=e.inputOne,l=e.inputTwo,d=n.ZP.t("无效的输入");return r&&t?(o=o||" ",l=l||" ",(0,s.isFormulaAndError)(o)||(0,s.isFormulaAndError)(l)?n.ZP.t("校验条件中存在非法公式"):d=t===u.h6.CONTENT?n.ZP.t("请输入内容{{value0}}{{inputOne}}的文本。",{value0:u.Bb.get(r),inputOne:i.n(o,200,"...")}):r===a.Cell.DATA_VALIDATION_CONDITION_TYPE.BETWEEN||r===a.Cell.DATA_VALIDATION_CONDITION_TYPE.NOT_BETWEEN?n.ZP.t("请输入长度{{value0}}{{inputOne}}和{{inputTwo}}之间的文本。",{value0:u.Bb.get(r),inputOne:o,inputTwo:l}):n.ZP.t("请输入长度{{value0}}{{inputOne}}的文本。",{value0:u.Bb.get(r),inputOne:o})):d}function _(e){var t=e.operate,r=e.inputOne,o=e.inputTwo,l=n.ZP.t("无效的输入");return t?(r=r||" ",o=o||" ",(0,s.isFormulaAndError)(r)||(0,s.isFormulaAndError)(o)?n.ZP.t("校验条件中存在非法公式"):l=t===a.Cell.DATA_VALIDATION_CONDITION_TYPE.BETWEEN||t===a.Cell.DATA_VALIDATION_CONDITION_TYPE.NOT_BETWEEN?n.ZP.t("请输入{{value0}}{{inputOne}}和{{inputTwo}}之间的日期。",{inputOne:r,inputTwo:o,value0:u.y3.get(t),interpolation:{escapeValue:!1}}):n.ZP.t("请输入{{value0}}{{inputOne}}的日期。",{value0:u.y3.get(t),inputOne:r,interpolation:{escapeValue:!1}})):l}function A(e,t,r){var n=(0,l.Sc)(e.spreadsheet.activeSheet,t,r);if(!n)return null;var a=n.validType,s=n.dataType,i=n.operator,A=n.argTokens,N={rowIndex:t,colIndex:r,options:e.spreadsheet.sheetManager},p={dataType:s||null,operate:i||null,inputOne:(0,o.o5)(null===A||void 0===A?void 0:A[0],N)||null,inputTwo:(0,o.o5)(null===A||void 0===A?void 0:A[1],N)||null};switch(a){case u.ob.LIST:return d();case u.ob.NUMBER:return T(p);case u.ob.TEXT:return E(p);case u.ob.DATE:return _(p);case u.ob.AVAILABLE:return c(p);default:return null}}function N(e,t){var r,n;if(null==e)return null;var a=(0,l.aW)(e.ruleType);if(null===a)return null;var s={dataType:null===a||void 0===a?void 0:a.dataType,operate:e.operator,inputOne:(0,o.o5)(null===(r=e.argTokens)||void 0===r?void 0:r[0],t),inputTwo:(0,o.o5)(null===(n=e.argTokens)||void 0===n?void 0:n[1],t)};switch(a.validType){case u.ob.LIST:return d();case u.ob.NUMBER:return T(s);case u.ob.TEXT:return E(s);case u.ob.DATE:return _(s);case u.ob.AVAILABLE:return c(s)}}function p(e,t){var r=e.getIsDataValid(),o=e.getEffectiveValue(),s=e.getEditValue(),u=e.getDataValidation();return u&&!1===(r=0!=(r=r&&(0,l.uU)(s,u)))&&u&&null!=o&&""!==o.value?new a.Cell.ErrorValue({title:n.ZP.t("失效"),message:N(u,t)}):null}},"../spread-sheet/src/core/feature/dataValidation/api/DataValidationRule.ts":function(e,t,r){r.d(t,{Jh:function(){return i},ZU:function(){return _},n3:function(){return A}}),r("../node_modules/core-js/modules/es.array.join.js"),r("../node_modules/core-js/modules/es.object.values.js"),r("../node_modules/core-js/modules/web.dom-collections.for-each.js");var n=r("../packages/model/src/cell/data-validation/data-validation-utils.ts"),a=r("../packages/model/src/cell/data-validation/data-validation-rule-type.ts"),o=r("../spread-sheet/src/core/utils/formula.ts"),s=r("../spread-sheet/src/core/feature/dataValidation/api/DataValidationUtils.ts"),u=r("../spread-sheet/src/core/feature/dataValidation/type.ts"),l=r("../spread-sheet/src/base/util/phone-number.ts"),i=function(e,t){var r=d(e);if(r)return r;switch(e.ruleType){case a.Z.NUMBER_FLOAT_AND_INT:return T(e,u.sS.NONE);case a.Z.CUSTOM_MUST_FLOAT:return T(e,u.sS.FLOAT);case a.Z.NUMBER_INT:return T(e,u.sS.INT);case a.Z.DATE:return T(e,u.sS.NONE);case a.Z.TEXT_LENGTH:return T(e,u.sS.LENGTH);case a.Z.LIST:return E(e,t);default:return null}},d=function(e){switch(e.ruleType){case a.Z.CUSTOM_TEXT_CONTAINS:return c(e);case a.Z.CUSTOM_ID_CARD:return _();case a.Z.CUSTOM_TEXT_MAIL:case a.Z.CUSTOM_NUM_PHONE:case a.Z.CUSTOM_NUM_TEL:return A(e);case a.Z.CUSTOM_NUMBER_TEMPERATURE:case a.Z.CUSTOM_PROGRESS:return T(e,u.sS.NONE);default:return null}},c=function(e){var t=e.operator,r=e.argTokens;return(0,s.Wj)(t)||!(null===r||void 0===r?void 0:r.length)?null:'=DATA_VALID_TEXT("'+t+'", '+(0,s.Np)(r[0].userEnteredValue)+", $SLOT)"},T=function(e,t,r){var n,a,o=e.operator,u=e.argTokens;if(o&&(0,s.Sv)(o))return null;var l=r||"$SLOT";return'=DATA_VALID_NUMBER("'+(o||"")+'", '+t+", "+(0,s.Np)((0,s.KN)((null===(n=null===u||void 0===u?void 0:u[0])||void 0===n?void 0:n.userEnteredValue)||null))+", "+(0,s.Np)((0,s.KN)((null===(a=null===u||void 0===u?void 0:u[1])||void 0===a?void 0:a.userEnteredValue)||null))+", "+l+")"},E=function(e,t){var r=e.argTokens;if(!r||!r[0]||!(null===r||void 0===r?void 0:r.length))return null;var a=r[0];if((0,n.$U)(a)){var u=(0,n.o5)(a,t);return"DATA_VALID_LIST("+(0,o.moveEqualChar)(u)+", $SLOT)"}var l=a.userEnteredValue;return'DATA_VALID_LIST("'+(0,s.zk)(l).join(",")+'", $SLOT)'},_=function(){return"OR(ISNUMBER(ID($SLOT,0)),ID_FOR_HK($SLOT,0))"},A=function(e){var t=[];return e.ruleType===a.Z.CUSTOM_TEXT_MAIL&&t.push('REGEXMATCH($SLOT,"'+N+'",FALSE)'),e.ruleType===a.Z.CUSTOM_NUM_PHONE&&Object.values(l.Iq).forEach((function(e){t.push('REGEXMATCH($SLOT,"'+e+'",FALSE)')})),e.ruleType===a.Z.CUSTOM_NUM_TEL&&t.push('REGEXMATCH($SLOT,"'+p+'",FALSE)'),"OR("+t.join(",")+")"},N="^[a-zA-Z0-9_-]+@[a-zA-Z0-9_-]+(\\.[a-zA-Z0-9_-]+)+$",p="^(0\\d{2,3}-)?\\d{7,8}(-\\d{1,6})?$"},"../spread-sheet/src/core/feature/dataValidation/api/DataValidationUtils.ts":function(e,t,r){r.d(t,{AJ:function(){return R},Dq:function(){return B},Ex:function(){return D},JU:function(){return b},KN:function(){return V},Np:function(){return y},Sc:function(){return m.Sc},Sv:function(){return P},Wj:function(){return M},ZK:function(){return j},aW:function(){return m.aW},gZ:function(){return w},jY:function(){return v},ko:function(){return I},uU:function(){return F},v1:function(){return x},zk:function(){return S}}),r("../node_modules/regenerator-runtime/runtime.js"),r("../node_modules/core-js/modules/es.object.to-string.js"),r("../node_modules/core-js/modules/es.promise.js"),r("../node_modules/core-js/modules/es.array.join.js"),r("../node_modules/core-js/modules/es.regexp.exec.js"),r("../node_modules/core-js/modules/es.string.split.js"),r("../node_modules/core-js/modules/es.array.map.js"),r("../node_modules/core-js/modules/es.string.trim.js"),r("../node_modules/core-js/modules/es.array.filter.js"),r("../node_modules/core-js/modules/es.array.from.js"),r("../node_modules/core-js/modules/es.string.iterator.js"),r("../node_modules/core-js/modules/es.array.iterator.js"),r("../node_modules/core-js/modules/es.set.js"),r("../node_modules/core-js/modules/esnext.set.add-all.js"),r("../node_modules/core-js/modules/esnext.set.delete-all.js"),r("../node_modules/core-js/modules/esnext.set.difference.js"),r("../node_modules/core-js/modules/esnext.set.every.js"),r("../node_modules/core-js/modules/esnext.set.filter.js"),r("../node_modules/core-js/modules/esnext.set.find.js"),r("../node_modules/core-js/modules/esnext.set.intersection.js"),r("../node_modules/core-js/modules/esnext.set.is-disjoint-from.js"),r("../node_modules/core-js/modules/esnext.set.is-subset-of.js"),r("../node_modules/core-js/modules/esnext.set.is-superset-of.js"),r("../node_modules/core-js/modules/esnext.set.join.js"),r("../node_modules/core-js/modules/esnext.set.map.js"),r("../node_modules/core-js/modules/esnext.set.reduce.js"),r("../node_modules/core-js/modules/esnext.set.some.js"),r("../node_modules/core-js/modules/esnext.set.symmetric-difference.js"),r("../node_modules/core-js/modules/esnext.set.union.js"),r("../node_modules/core-js/modules/web.dom-collections.iterator.js"),r("../node_modules/core-js/modules/web.dom-collections.for-each.js"),r("../node_modules/core-js/modules/es.string.match.js"),r("../node_modules/core-js/modules/es.string.ends-with.js");var n,a=r("../node_modules/i18next/dist/esm/i18next.js"),o=r("../packages/model/src/index.ts"),s=r("../node_modules/@tencent/txdoc_dayjs/dayjs.min.js"),u=r.n(s),l=r("../spread-sheet/src/core/utils/cell.ts"),i=r("../spread-sheet/src/core/utils/formula.ts"),d=r("../spread-sheet/src/core/utils/numberFromat.ts"),c=r("../packages/model/src/range/hexRangeUtils.ts"),T=r("../packages/model/src/cell/data-validation/data-validation-rule-type.ts"),E=r("../packages/model/src/rule/index.ts"),_=r("../packages/model/src/cell/data-validation/data-validation-utils.ts"),A=r("../spread-sheet/src/core/feature/formula/utils.ts"),N=r("../node_modules/@tencent/sheet-formula-sdk/lib/index.js"),p=r("../packages/model/src/cell/metadata/CustomDataType.ts"),m=r("../spread-sheet/src/core/feature/dataValidation/api/DataValidationUIUtils.ts"),O=r("../packages/model/src/cell/format/NumberFormatType.ts"),f=(r("../spread-sheet/src/core/feature/dataValidation/api/DataValidationConfig.ts"),function(e,t,r,n){return new(r||(r=Promise))((function(a,o){function s(e){try{l(n.next(e))}catch(t){o(t)}}function u(e){try{l(n.throw(e))}catch(t){o(t)}}function l(e){var t;e.done?a(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,u)}l((n=n.apply(e,t||[])).next())}))}),I=function(e,t,r){return e?e.split(t).join(r):""},v=function(e){switch(e.ruleType){case T.Z.LIST:case T.Z.NUMBER_INT:case T.Z.NUMBER_FLOAT_AND_INT:case T.Z.CUSTOM_MUST_FLOAT:case T.Z.CUSTOM_NUMBER_TEMPERATURE:case T.Z.TEXT_LENGTH:case T.Z.DATE:return!0}return!1},D=function(e,t,r){return I(e,"$SLOT",N.Pz.toCellId(t,r))},S=function(e){var t;return t=(t=(t=e.split(",")).map((function(e){return e.trim()}))).filter((function(e){return e})),Array.from(new Set(t))};function h(e){var t,r=null===(t=null===e||void 0===e?void 0:e.argTokens)||void 0===t?void 0:t[0];if(!r)return!0;var n=r.type,a=r.formula,o=r.userEnteredValue;if(n===E.ARG_TOKEN_TYPE.VALUE_TOKEN&&null===o)return!0;if(n===E.ARG_TOKEN_TYPE.FORMULA_TOKEN){if(null===a)return!0;if(!0===(null===a||void 0===a?void 0:a.hasReferenceError))return!0}return!1}function L(e){return null!=e&&null!=e.argTokens&&e.ruleType===T.Z.LIST||(console.warn("数据验证：类型不为list或者用户输入为空，不能获取下拉列表信息"),!1)}function C(e,t,a,o){var s,u,l;return f(this,void 0,void 0,regeneratorRuntime.mark((function i(){var d,T,E,A,N,p,m,O,f,I;return regeneratorRuntime.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:if(d=g(t),T=t.argTokens[0],d!==n.RANGE_LIST){i.next=16;break}if(E=(0,_.o5)(T,{rowIndex:a,colIndex:o,options:e.spreadsheet.sheetManager}),A=(0,c.getRangeInfoFormHexRange)(e.spreadsheet,E),N=A.sheetId,p=A.rangeString,m=N||e.spreadsheet.getActiveSheetId(),null===(l=null===(u=null===(s=e.spreadsheet)||void 0===s?void 0:s.sheetManager)||void 0===u?void 0:u.getSheetBySheetId(m))||void 0===l?void 0:l.isLoaded){i.next=10;break}return i.next=10,new Promise((function(t){e.dataCenter.loadSheetData({sheetId:N,ignoreChunk:!0,onFinished:function(){t(!0)},onFail:function(e){var n;t(!1),null===(n=r.g.log)||void 0===n||n.error("获取数据验证引用子表("+N+")失败",e)}})}));case 10:if(O=U(e,p,N),null!==(f=Z(e,O))){i.next=14;break}return i.abrupt("return",[]);case 14:return f=f.filter((function(e){return e})),i.abrupt("return",Array.from(new Set(f)));case 16:if(I=T.userEnteredValue,d!==n.ITEM_LIST||null===I){i.next=19;break}return i.abrupt("return",S(I));case 19:return i.abrupt("return",null);case 20:case"end":return i.stop()}}),i)})))}function j(e,t,r){return f(this,void 0,void 0,regeneratorRuntime.mark((function n(){var a,o;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(n.prev=0,L(a=(0,m.Ii)(e.spreadsheet.activeSheet,t,r))&&!h(a)){n.next=5;break}return n.abrupt("return",null);case 5:return n.next=7,C(e,a,t,r);case 7:return o=n.sent,n.abrupt("return",o);case 11:return n.prev=11,n.t0=n.catch(0),console.warn("数据验证获取下拉列表错误",n.t0),n.abrupt("return",null);case 15:case"end":return n.stop()}}),n,null,[[0,11]])})))}function g(e){var t,r;if(e.ruleType!==T.Z.LIST)return"";var a=null===(t=null===e||void 0===e?void 0:e.argTokens)||void 0===t?void 0:t[0].type;if(a===E.ARG_TOKEN_TYPE.FORMULA_TOKEN)return n.RANGE_LIST;var o=null===(r=null===e||void 0===e?void 0:e.argTokens)||void 0===r?void 0:r[0].userEnteredValue;return o&&a===E.ARG_TOKEN_TYPE.VALUE_TOKEN&&0!==o.length?n.ITEM_LIST:""}function Z(e,t){if(null==t)return null;var r=t.sheetId,n=e.spreadsheet.sheetManager.getSheetBySheetId(r),a=[];if(n){var o=n.data.getCellDatasAtRange(t);null===o||void 0===o||o.forEach((function(e){return e.forEach((function(e){null!=e&&a.push((0,l.getMergedValue)(e))}))}))}return a}!function(e){e.RANGE_LIST="range-list",e.ITEM_LIST="item-list"}(n||(n={}));var U=function(e,t,r){if(!t)return null;if(!r&&e){r=e.spreadsheet.activeSheetId;var n=(0,i.moveEqualChar)(t).split("!")[0];'"'===n[0]&&'"'===n[n.length-1]&&(n=n.substring(1,n.length-1));var a=e.spreadsheet.sheetManager.getSheetBySheetTitle(n);a&&a.getSheetId()!==r&&(r=a.getSheetId())}return r?(0,c.hex2Range)(t,r):null},P=function(e){return-1===["between","notBetween","equal","notEqual","lessThan","lessThanOrEqual","greaterThan","greaterThanOrEqual"].indexOf(e)},M=function(e){return-1===["contains","notContains","equal"].indexOf(e)};function R(e,t,r){void 0===t&&(t="YYYY-MM-DD"),void 0===r&&(r="date");var n=u()(e).format(t);return"date"==r&&(n+="T00:00:00"),o.Utils.numberFormatUtils.formatParseEngine.datetime2Numeric(n)}var V=function(e){if(e){var t=o.Utils.numberFormatUtils.formatParseEngine.parseValueWithStyle(e);return null==t?e:t.value}return e},y=function(e){var t,r=(0,A.jr)(e);if("string"===typeof e)if('""'===e)t=e;else{if(r)return(0,i.moveEqualChar)(e);t='"'+e+'"'}else{if("number"===typeof e||"boolean"===typeof e)return t=""+e;t='""'}return t},w=function(e,t,r){for(var n=t,a=t.sheetId,o=e.sheetManager.getSheetBySheetId(t.sheetId),s=n.isCol?0:n.startRowIndex,u=n.isCol?o.getRowCount()-1:n.endRowIndex,l=n.isRow?0:n.startColIndex,i=n.isRow?o.getColCount()-1:n.endColIndex,d=s;d<=u;d++)for(var c=l;c<=i;c++)r(d,c,a)},x=function(e){var t=e.view.getSelection();if(!t)return!1;var r=t.activeCell,n=r.rowIndex,a=r.colIndex;return!!(0,m.Sc)(e.spreadsheet.activeSheet,n,a)};function b(e,t,r,n){var s=(void 0===n?{}:n).fractionFirst,u=void 0!==s&&s,l=e.inputOne,c=e.inputTwo,T=e.operate;if(!e.inputTwoShow)return null;if(T!==o.Cell.DATA_VALIDATION_CONDITION_TYPE.BETWEEN&&T!==o.Cell.DATA_VALIDATION_CONDITION_TYPE.NOT_BETWEEN)return null;if(""===l.trim()||""===c.trim())return null;if((0,i.isFormulaString)(l)||(0,i.isFormulaString)(c))return null;var E=(0,d.stringToNumber)(l,{fractionFirst:u}),_=(0,d.stringToNumber)(c,{fractionFirst:u});if(!E||!_)return null;var A=E.numericValue,N=_.numericValue;return"number"!==typeof A||"number"!==typeof N?null:N-A<0?1===t?{inputOneIsError:!0,inputOneErrorTip:a.ZP.t("请输入小于最大值的{{inputType}}",{inputType:r}),inputTwoIsError:!1}:{inputOneIsError:!1,inputTwoIsError:!0,inputTwoErrorTip:a.ZP.t("请输入大于最小值的{{inputType}}",{inputType:r})}:null}var k=function(e){var t=o.Utils.numberFormatUtils.formatParseEngine.parseValue(e,"");return(null===t||void 0===t?void 0:t.type)===O.Z.DATE_TIME||(null===t||void 0===t?void 0:t.type)===O.Z.DATE||(null===t||void 0===t?void 0:t.type)===O.Z.TIME},F=function(e,t){switch(t.ruleType){case T.Z.DATE:return k(e);case T.Z.NUMBER_INT:case T.Z.CUSTOM_MUST_FLOAT:case T.Z.NUMBER_FLOAT_AND_INT:return!k(e)}return!0};function B(e,t,r){var n;return r&&!r.endsWith("%")||(null===(n=null===t||void 0===t?void 0:t.getMetadata())||void 0===n?void 0:n.customDataType)!==p.ZP.PROGRESS?e:"("+e+" * 100)"}},"../spread-sheet/src/core/feature/dataValidation/custom-formula/convert.ts":function(e,t,r){r.d(t,{f:function(){return g}}),r("../node_modules/core-js/modules/es.array.map.js"),r("../node_modules/core-js/modules/es.array.join.js");var n,a,o=r("../packages/model/src/index.ts"),s=r("../packages/model/src/cell/data-validation/data-validation-condition-type.ts"),u=r("../packages/model/src/cell/data-validation/data-validation-rule-type.ts"),l=r("../node_modules/@tencent/tdocs-format-render/lib/index.js"),i=r("../packages/model/src/rule/index.ts"),d=r("../packages/model/src/cell/data-validation/data-validation-utils.ts"),c=r("../spread-sheet/src/core/utils/formula.ts"),T=r("../spread-sheet/src/core/feature/dataValidation/api/DataValidationUtils.ts"),E=r("../spread-sheet/src/core/feature/dataValidation/api/DataValidationRule.ts"),_=r("../spread-sheet/src/core/feature/dataValidation/type.ts"),A=u.Z.NUMBER_FLOAT_AND_INT,N=u.Z.CUSTOM_MUST_FLOAT,p=u.Z.NUMBER_INT,m=u.Z.DATE,O=u.Z.TEXT_LENGTH,f=u.Z.LIST,I=u.Z.CUSTOM_TEXT_CONTAINS,v=u.Z.CUSTOM_ID_CARD,D=u.Z.CUSTOM_TEXT_MAIL,S=u.Z.CUSTOM_NUM_PHONE,h=u.Z.CUSTOM_NUM_TEL,L=u.Z.CUSTOM_NUMBER_TEMPERATURE,C=u.Z.CUSTOM_PROGRESS,j=((n={})[A]=function(e){return P(e,_.sS.NONE)},n[N]=function(e){return P(e,_.sS.FLOAT)},n[p]=function(e){return P(e,_.sS.INT)},n[m]=function(e){return P(e,_.sS.NONE)},n[O]=function(e){return P(e,_.sS.LENGTH,"LEN($SLOT)")},n[f]=function(e,t){return V(e,t)},n[I]=function(e){return Z(e)},n[v]=function(){return(0,E.ZU)()},n[D]=function(e){return(0,E.n3)(e)},n[S]=function(e){return(0,E.n3)(e)},n[h]=function(e){return(0,E.n3)(e)},n[L]=function(e){return P(e,_.sS.NONE)},n[C]=function(e){return P(e,_.sS.NONE)},n),g=function(e,t){var r=e.ruleType?j[e.ruleType]:null;return r?r(e,t):null},Z=function(e){var t=e.operator,r=e.argTokens;if((0,T.Wj)(t)||!(null===r||void 0===r?void 0:r.length))return null;var n=(0,T.Np)(r[0].userEnteredValue),a="";switch(t){case s.Z.INCLUDE:a="NOT(ISERROR(FIND("+n+",$SLOT)))";break;case s.Z.NOT_INCLUDE:a="ISERROR(FIND("+n+",$SLOT))";break;case s.Z.EQUAL:a="AND(NOT(ISERROR(FIND("+n+",$SLOT))),LEN($SLOT)=LEN("+n+"))"}return a},U=((a={})[_.sS.INT]=function(e,t){return"AND("+e+",MOD("+t+",1)=0)"},a[_.sS.FLOAT]=function(e,t){return"AND("+e+",MOD("+t+",1)<>0)"},a[_.sS.DATE]=function(e,t){return"AND("+e+", IFERROR(YEAR("+t+")<>1900,FALSE)<>FALSE)"},a),P=function(e,t,r){var n,a,o=e.ruleType,s=e.operator,l=e.argTokens;if(!(null===l||void 0===l?void 0:l.length)&&o===u.Z.DATE)return null;if(s&&(0,T.Sv)(s))return null;var i=r||"$SLOT",d=(0,T.Np)((0,T.KN)((null===(n=null===l||void 0===l?void 0:l[0])||void 0===n?void 0:n.userEnteredValue)||null)),c=(0,T.Np)((0,T.KN)((null===(a=null===l||void 0===l?void 0:l[1])||void 0===a?void 0:a.userEnteredValue)||null)),E=M(s,i,d,c),_=U[t];return _?_(E,i):E},M=function(e,t,r,n){var a="TRUE";switch(e){case s.Z.BETWEEN:a="AND("+t+">="+r+","+t+"<="+n+")";break;case s.Z.NOT_BETWEEN:a="NOT(AND("+t+">="+r+","+t+"<="+n+"))";break;case s.Z.EQUAL:a=t+"="+r;break;case s.Z.NOT_EQUAL:a=t+"<>"+r;break;case s.Z.LESS:a=t+"<"+r;break;case s.Z.LESS_EQUAL:a=t+"<="+r;break;case s.Z.GREAT:a=r+"<"+t;break;case s.Z.GREAT_EQUAL:a=t+">="+r}return a="AND(ISNUMBER("+t+"),"+a+")"},R={},V=function(e,t){var r=e.argTokens;if(!(null===r||void 0===r?void 0:r.length))return null;if(r[0].type===i.ARG_TOKEN_TYPE.FORMULA_TOKEN){var n=(0,d.o5)(r[0],t);return"IF(COUNTIF("+(0,c.moveEqualChar)(n)+", $SLOT)>0,TRUE,FALSE)"}var a,s=r[0].userEnteredValue;return R[s]?a=R[s]:(a=(0,T.zk)(r[0].userEnteredValue).map((function(e){var t=o.Utils.numberFormatUtils.formatParseEngine.parseValueWithStyle(e).value;return(0,l.isNumeric)(t)?"EXACT($SLOT,"+t+')+EXACT($SLOT,"'+e+'")':'EXACT($SLOT,"'+e+'")'})).join("+"),R[s]=a),"0+"+a+">0"}}}]),window.jsExecEndTimeStamp=Date.now(),window.cachedPerformanceEntries||(window.cachedPerformanceEntries=[]),window.cachedPerformanceEntries.push({name:"jsExec: js/spread-sheet_src_core_feature_dataValidation_api_DataValidationError_ts-spread-sheet_src_core-860e25.ce0882ff0bdc005a8070.js",entryType:"jsExec",startTime:window.jsExecStartTimeStamp,endTime:window.jsExecEndTimeStamp});
//# sourceMappingURL=spread-sheet_src_core_feature_dataValidation_api_DataValidationError_ts-spread-sheet_src_core-860e25.ce0882ff0bdc005a8070.js.map