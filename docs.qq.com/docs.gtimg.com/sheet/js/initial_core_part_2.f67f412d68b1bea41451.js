self.window=self,window.jsExecStartTimeStamp=Date.now(),(self.webpackChunk_tencent_alloy_builder=self.webpackChunk_tencent_alloy_builder||[]).push([["initial_core_part_2"],{"../spread-sheet/src/core/view/spreadsheet-view/SpreadsheetView.browser.ts":function(e,t,r){r.d(t,{Z:function(){return kr}});var i=r("../node_modules/@babel/runtime/helpers/esm/inheritsLoose.js"),o=(r("../node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),r("../node_modules/core-js/modules/esnext.reflect.metadata.js"),r("../node_modules/@babel/runtime/helpers/esm/createClass.js")),n=(r("../node_modules/core-js/modules/es.array.fill.js"),r("../node_modules/core-js/modules/es.array.splice.js"),r("../node_modules/core-js/modules/es.array.concat.js"),r("../spread-sheet/src/core/view/config/default.ts")),s=r("../spread-sheet/src/core/view/spreadsheet-view/transform-table/cell.ts"),a=r("../spread-sheet/src/core/view/spreadsheet-view/model/CellPadding.ts"),l=function(){function e(e,t,r,i){this._background=e,this._horizontalAlign=t,this._verticalAlign=r,this._wrapStrategy=i}return e.getKey=function(e,t,r,i){return e.hex+","+t.value+","+r.value+","+i.value},e.newInstance=function(t){var r=t.background,i=t.horizontalAlign,o=t.verticalAlign,n=t.wrapStrategy,s=e.getKey(r,i,o,n),a=e.pools[s];return a||(e.pools[s]=new e(r,i,o,n))},e.newInstanceByOther=function(t,r){var i={background:r.background||t._background,horizontalAlign:r.horizontalAlign||t._horizontalAlign,verticalAlign:r.verticalAlign||t._verticalAlign,wrapStrategy:r.wrapStrategy||t._wrapStrategy};return e.newInstance(i)},(0,o.Z)(e,[{key:"background",get:function(){return this._background}},{key:"horizontalAlign",get:function(){return this._horizontalAlign}},{key:"verticalAlign",get:function(){return this._verticalAlign}},{key:"wrapStrategy",get:function(){return this._wrapStrategy}}]),e}();l.pools={};var c=l,d=function(){function e(e,t,r,i){this.content="",this.style=c.newInstance({background:n._4,horizontalAlign:n.YH,verticalAlign:n.OC,wrapStrategy:n.mK}),this.innerHTML=null,this._padding=n.J9,null!==e&&i&&(this.content=(0,s.nv)(e),this.style=c.newInstance({background:(0,s.z1)(e,i),horizontalAlign:(0,s.PE)(e),verticalAlign:(0,s.YW)(e),wrapStrategy:(0,s.fs)(e)}),e.getMergeReference()&&(this.mergeData=(0,s.fl)(e,t,r),this.mergeParent=(0,s.PF)(e,t,r)))}e.defaultCellView=function(){return new e(null,-1,-1)};var t=e.prototype;return t.isEmpty=function(){return!this.content.length},t.isAutoWrap=function(){return"normal"===this.style.wrapStrategy.value},(0,o.Z)(e,[{key:"paddingLeft",get:function(){return this._padding.left},set:function(e){this._padding=a.Z.newInstance(this._padding.top,this._padding.right,this._padding.bottom,e)}},{key:"paddingRight",get:function(){return this._padding.right},set:function(e){this._padding=a.Z.newInstance(this._padding.top,e,this._padding.bottom,this._padding.left)}},{key:"paddingTop",get:function(){return this._padding.top}},{key:"paddingBottom",get:function(){return this._padding.bottom},set:function(e){this._padding=a.Z.newInstance(this._padding.top,this._padding.right,e,this._padding.left)}}]),e}(),h=d.defaultCellView(),u=d,f=r("../spread-sheet/src/core/view/spreadsheet-view/table-view/utils.ts"),g=r("../node_modules/@tencent/containerized/build/main/index.js"),p=r("../packages/model/src/cell/index.ts"),_=r("../spread-sheet/src/core/app/sheetStatus/private-range.ts"),v=r("../spread-sheet/src/core/app/sheetStatus/auth-range.ts"),w=r("../spread-sheet/src/core/view/spreadsheet-view/model/HorizontalAlign.ts"),m=r("../spread-sheet/src/core/view/spreadsheet-view/model/Color.ts"),C=function(){function e(e,t,r,i){this.content="",this.style=c.newInstance({background:m.Z.newInstanceByHex("#ffcccc"),horizontalAlign:w.Z.newInstance(w.O.LEFT),verticalAlign:n.OC,wrapStrategy:n.mK}),this.innerHTML=null,this._padding=n.J9,null!==e&&i&&(this.content=(0,s.nv)(e,!0),this.style=c.newInstance({background:(0,s.z1)(e,i),horizontalAlign:this.style.horizontalAlign,verticalAlign:(0,s.YW)(e),wrapStrategy:(0,s.fs)(e)}),e.getMergeReference()&&(this.mergeData=(0,s.fl)(e,t,r),this.mergeParent=(0,s.PF)(e,t,r)))}e.defaultCellView=function(){return new e(null,-1,-1)};var t=e.prototype;return t.isEmpty=function(){return!this.content.length},t.isAutoWrap=function(){return"normal"===this.style.wrapStrategy.value},(0,o.Z)(e,[{key:"paddingLeft",get:function(){return this._padding.left},set:function(e){this._padding=a.Z.newInstance(this._padding.top,this._padding.right,this._padding.bottom,e)}},{key:"paddingRight",get:function(){return this._padding.right},set:function(e){this._padding=a.Z.newInstance(this._padding.top,e,this._padding.bottom,this._padding.left)}},{key:"paddingTop",get:function(){return this._padding.top}},{key:"paddingBottom",get:function(){return this._padding.bottom},set:function(e){this._padding=a.Z.newInstance(this._padding.top,this._padding.right,e,this._padding.left)}}]),e}(),y=C,R=r("../packages/model/src/cell/LinkIconType.ts"),x=r("../packages/model/src/cell/metadata/CustomDataType.ts"),D=function(e){function t(t){var r;return(r=e.call(this)||this).tableCellViews={},r._cellViews=[],r.cellDataToCellView=function(e,t,i,o,n,s){for(var a=n||r._spreadsheet.activeSheetId,l=e;l<=t;l++)for(var c=i;c<=o;c++)r.setCellViewAtPosition(l,c,a,s)},r.addRow=function(e){var t=e.index,i=e.amount,o=e.sheetId,n=r.getTargetSheet(o);if(n)for(var s=n.getColCount(),a=0;a<i;a++){var l=new Array(s);l.fill(h),r.tableCellViews[o].splice(t,0,l)}},r.addCol=function(e){var t=e.index,i=e.amount,o=e.sheetId,n=r.getTargetSheet(o);if(n)for(var s=n.getRowCount(),a=0;a<s;a++){var l,c=new Array(i);c.fill(h),(l=r.tableCellViews[o][a]).splice.apply(l,[t,0].concat(c))}},r.deleteRow=function(e){var t=e.index,i=e.amount,o=e.sheetId,n=r.getTargetSheet(o);if(n){for(var s=n.getColCount(),a=0;a<s;a++)for(var l=0;l<i;l++){var c=t+l,d=r.tableCellViews[o][c][a];if(d.mergeParent){var h=r.tableCellViews[o][c+d.mergeParent.y][a];(0,f.u_)(h)}}r.tableCellViews[o].splice(t,i)}},r.deleteCol=function(e){var t=e.index,i=e.amount,o=e.sheetId,n=r.getTargetSheet(o);if(n)for(var s=n.getRowCount(),a=0;a<s;a++){for(var l=0;l<i;l++){var c=t+l,d=r.tableCellViews[o][a][c];if(d.mergeParent){var h=r.tableCellViews[o][a][c+d.mergeParent.x];(0,f.$x)(h)}}r.tableCellViews[o][a].splice(t,i)}},r._spreadsheet=t.spreadsheet,r._dataCallView=t.dataCallView,r._register(r._dataCallView.onInsertRow(r.addRow)),r._register(r._dataCallView.onInsertCol(r.addCol)),r._register(r._dataCallView.onDeleteRow(r.deleteRow)),r._register(r._dataCallView.onDeleteCol(r.deleteCol)),r._register(r._dataCallView.onUpdateCells((function(e){r.cellDataToCellView(e.startRow,e.endRow,e.startCol,e.endCol,e.sheetId,null===e||void 0===e?void 0:e.showCellFormual)}))),r}(0,i.Z)(t,e);var n=t.prototype;return n.init=function(e){this.tableCellViews[e]=[];var t=this.getTargetSheet(e);t&&this.cellDataToCellView(0,t.getRowCount()-1,0,t.getColCount()-1,e)},n.refresh=function(e){!e||this.tableCellViews[e]&&0!==this.tableCellViews[e].length||this.init(e)},n.setCellViewAtPosition=function(e,t,r,i){this.tableCellViews[r]||(this.tableCellViews[r]=[]),this.tableCellViews[r][e]||(this.tableCellViews[r][e]=[]),this.tableCellViews[r].length<=e&&(this.tableCellViews[r][e]=[]);var o=this.getTargetSheet(r);if(o)if(e>o.highWaterMark.getMark())this.tableCellViews[r][e][t]=h;else{var n,s=o.getCellDataAtPosition(e,t);if(s){n=i&&s.getFormula()?new y(s,e,t,this._spreadsheet):new u(s,e,t,this._spreadsheet);var a=this._calcPadding(e,t,r),l=a.paddingLeft,c=a.paddingRight;n.paddingLeft=l,n.paddingRight=c}else n=h;this.tableCellViews[r][e][t]=n}},n.getCellViewAtPosition=function(e,t,r){var i=r||this._spreadsheet.activeSheetId;return this.tableCellViews[i]||(this.tableCellViews[i]=[]),this.tableCellViews[i][e]||(this.tableCellViews[i][e]=[]),e>=this.tableCellViews[i].length||e<0||t>=this.tableCellViews[i][e].length||t<0?null:this.tableCellViews[i][e][t]||null},n.getSelectQueue=function(){var e=this._spreadsheet.parent.view.getSelection().selectQueue;return e&&e.length>0?e:null},n.getCellMetadata=function(e,t){var r;return(null===(r=this._spreadsheet.activeSheet.getCellDataAtPosition(e,t))||void 0===r?void 0:r.getMetadata())||null},n.getCellImage=function(e,t){return this._spreadsheet.activeSheet.getCellImage(e,t)},n.getIsDataValid=function(e,t){var r,i;return null===(i=null===(r=this._spreadsheet.activeSheet.getCellDataAtPosition(e,t))||void 0===r?void 0:r.getIsDataValid())||void 0===i||i},n.getDataBar=function(e,t){var r;return(null===(r=this._spreadsheet.activeSheet.getCellDataAtPosition(e,t))||void 0===r?void 0:r.getDataBar())||null},n.getCellHyperlinkType=function(e,t){var r=this._spreadsheet.activeSheet.getCellDataAtPosition(e,t);return(null===r||void 0===r?void 0:r.getLinkIconStatus())===R.Z.PLAIN_TEXT?null:(null===r||void 0===r?void 0:r.getHyperlinkRuns())?p.HYPERLINK_TYPE.SHEET_LINK:(null===r||void 0===r?void 0:r.getHyperlinkType())||null},n.getCellHyperlink=function(e,t){var r;return(null===(r=this._spreadsheet.activeSheet.getCellDataAtPosition(e,t))||void 0===r?void 0:r.getHyperlink())||null},n.getIsCellPrivate=function(e,t){return(0,_.xy)(this._spreadsheet,e,t)},n.getWeworkCardIcon=function(e,t){var r=this._spreadsheet.activeSheet.getCellDataAtPosition(e,t),i=null===r||void 0===r?void 0:r.getCellType(),o=null===r||void 0===r?void 0:r.getWeworkComponent();return i===x.ZP.STAFF_CARD&&o||i===x.ZP.GROUP_CARD&&o?o.iconUrl||null:i===x.ZP.THIRD_PARTY_APP&&o&&o.iconUrl||null},n.getTodoRange=function(e,t){return this._spreadsheet.activeSheet.todoManager.getTodoRange(e,t)},n.getIsCellCanNotRead=function(e,t){return(0,v.tE)(this._spreadsheet.parent,e,t)},n._calcPadding=function(e,t,r){var i=this.getTargetSheet(r);if(!i)return{paddingLeft:0,paddingRight:0};var o=(0,s.jl)(i,e,t);return{paddingLeft:o.paddingLeft,paddingRight:o.paddingRight}},n.getTargetSheet=function(e){var t=this._spreadsheet.sheetManager.getSheetBySheetId(e);return t||(r.g.log.error("TableView getTargetSheet: sheetId is invalid"),null)},(0,o.Z)(t,[{key:"cellViews",get:function(){var e=this._spreadsheet.activeSheetId;return this.tableCellViews[e]||(this.tableCellViews[e]=[]),this.tableCellViews[e]}}]),t}(g.JT),E=D,S=(r("../node_modules/core-js/modules/es.number.max-safe-integer.js"),r("../node_modules/core-js/modules/es.number.constructor.js"),r("../packages/lib/index.ts"));function I(e,t,i){var o=e*r.g.devicePixelRatio,n=t-i,s=Math.abs(n),a=Math.ceil(s*o)/o;return n>0?i+a:i-a}function b(e){for(var t=e.length-1;t>0;t--)if(e[t-1]<e[t])return t-1;return t}var T=r("../spread-sheet/src/core/view/spreadsheet-view/area-data/AreaData.interface.ts"),A=function(){function e(e){this._renderFrom=0,this._renderTo=0,this._from=0,this._to=0,this._areaTop=[],this._offsetSize=0,this._viewSize=0,this._contentSize=0,this._displaySafeDistance=0,this._displayPadding=0,this.updateOffsetEmitter=new S.Q5,this.updateViewSizeEmitter=new S.Q5,this.updateTotalSizeEmitter=new S.Q5,this.updatePaddingEmitter=new S.Q5,this._scale=e.scale,this.onUpdateOffset=this.updateOffsetEmitter.event,this.onUpdateViewSize=this.updateViewSizeEmitter.event,this.onUpdateTotalSize=this.updateTotalSizeEmitter.event,this.onUpdatePadding=this.updatePaddingEmitter.event}var t=e.prototype;return t.set=function(e,t,r,i){void 0===i&&(i=0);var o=0;this._areaTop.length=0;for(var n=t;n<=r;n++)this._areaTop.push(o),e.isRowHidden(n)||(o+=e.getRowDisplayHeight(n));this._areaTop.push(o),o>0&&(o+=i),this._from=t,this._to=r,this._contentSize=o,this._checkOffset(),this._calcFromTo(),this.updateTotalSizeEmitter.fire(this._contentSize)},t.setViewSize=function(e){e<0&&(e=0),this._viewSize!==e&&(this._viewSize=e,this._checkOffset(),this._calcFromTo(),this.updateViewSizeEmitter.fire(this._viewSize))},t.setOffsetSize=function(e,t){void 0===t&&(t=T.oz.SLIENT),e=I(this._scale.scale,e,this._offsetSize);var r=this._maxOffsetSize;e<0?e=0:e>r&&(e=r),this._offsetSize!==e?(this.offsetDiff=e-this._offsetSize,this._offsetSize=e,this._calcFromTo(),this.updateOffsetEmitter.fire({offsetSize:this._offsetSize,source:t})):this.offsetDiff=0},t.setDisplayPadding=function(e){this._displayPadding=e,this._checkOffset(),this._calcFromTo(),this.updatePaddingEmitter.fire(this._padding)},t.setDisplaySafeDistance=function(e){this._displaySafeDistance=e,this._checkOffset(),this._calcFromTo(),this.updateTotalSizeEmitter.fire(this._contentSize)},t.getAreaTop=function(e){return this._areaTop[e]},t.isValid=function(){return this._totalSize>0},t.getLastRowInView=function(){return this._renderFrom+b(this._areaTop)},t.refresh=function(){this._offsetSize=0,this._contentSize=0,this._viewSize=0,this._renderFrom=0,this._renderTo=0},t._calcFromTo=function(){var e,t=this._to-this._from;for(this._renderFrom=this._from,e=1;e<t+1;e++)if(this._offsetSize<this._areaTop[e]){this._renderFrom=this._from+e-1;break}for(var r=this._viewSize-this._padding;e<=t;e++)if(this._offsetSize+r<=this._areaTop[e])return void(this._renderTo=this._from+e-1);this._renderTo=this._to},t._checkOffset=function(){this._offsetSize>this._maxOffsetSize&&(this._offsetSize=this._maxOffsetSize,this.updateOffsetEmitter.fire({offsetSize:this._offsetSize}))},(0,o.Z)(e,[{key:"_totalSize",get:function(){return this._contentSize+this._safeDistance}},{key:"_maxOffsetSize",get:function(){return Math.max(0,this._totalSize+this._padding-this._viewSize)}},{key:"_padding",get:function(){return this._displayPadding/this._scale.scale}},{key:"_safeDistance",get:function(){return this._displaySafeDistance/this._scale.scale}},{key:"from",get:function(){return this._from}},{key:"to",get:function(){return this._to}},{key:"renderFrom",get:function(){return this._renderFrom}},{key:"renderTo",get:function(){return this._renderTo}},{key:"viewSize",get:function(){return this._viewSize}},{key:"displayViewSize",get:function(){return this._viewSize*this._scale.scale}},{key:"contentSize",get:function(){return this._contentSize}},{key:"totalSize",get:function(){return this._totalSize}},{key:"displayTotalSize",get:function(){return this._totalSize*this._scale.scale}},{key:"offsetSize",get:function(){return this._offsetSize}},{key:"displayOffsetSize",get:function(){return this._offsetSize*this._scale.scale}},{key:"padding",get:function(){return this._padding}},{key:"displayPadding",get:function(){return this._displayPadding}},{key:"safeDistance",get:function(){return this._safeDistance}},{key:"displaySafeDistance",get:function(){return this._displaySafeDistance}},{key:"maxOffsetSize",get:function(){return this._maxOffsetSize}},{key:"areaTop",get:function(){return this._areaTop}}]),e}(),H=function(e){function t(t){var r;return(r=e.call(this)||this)._maxFrozenViewSize=null,r._maxHeight=0,r._scale=t.scale,r._frozen=new A({scale:r._scale}),r._flow=new A({scale:r._scale}),r}(0,i.Z)(t,e);var r=t.prototype;return r.updateMaxHeight=function(e){e/=this._scale.scale,this._maxHeight!==e&&(this._maxHeight=e,this._updateViewSize())},r.updateOffsetSize=function(e){this._flow.setOffsetSize(e)},r.set=function(e,t,r){this._frozen.set(e,0,t-1,t>0?n.kW:0),this._flow.set(e,t,r-1),this._updateViewSize()},r.getMaxHeight=function(){return this._maxHeight},r.setMaxFrozenViewSize=function(e){this._maxFrozenViewSize=e,this._updateViewSize()},r.refresh=function(){this._frozen.refresh(),this._flow.refresh()},r._updateViewSize=function(){var e=this._maxHeight,t=0;this._frozen.totalSize>0&&(t=null===this._maxFrozenViewSize?this._frozen.totalSize:Math.min(this._frozen.totalSize,this._maxFrozenViewSize)),this._frozen.setViewSize(t),e-=t,this._flow.setViewSize(e)},(0,o.Z)(t,[{key:"frozen",get:function(){return this._frozen}},{key:"flow",get:function(){return this._flow}}]),t}(g.JT),z=function(){function e(e){this._renderFrom=0,this._renderTo=0,this._from=0,this._to=0,this._areaLeft=[],this._offsetSize=0,this._viewSize=0,this._contentSize=0,this._displaySafeDistance=0,this._displayPadding=0,this.updateOffsetEmitter=new S.Q5,this.updateViewSizeEmitter=new S.Q5,this.updateTotalSizeEmitter=new S.Q5,this.updatePaddingEmitter=new S.Q5,this._scale=e.scale,this.onUpdateOffset=this.updateOffsetEmitter.event,this.onUpdateViewSize=this.updateViewSizeEmitter.event,this.onUpdateTotalSize=this.updateTotalSizeEmitter.event,this.onUpdatePadding=this.updatePaddingEmitter.event}var t=e.prototype;return t.set=function(e,t,r,i){void 0===i&&(i=0);var o=0;this._areaLeft.length=0;for(var n=t;n<=r;n++)this._areaLeft.push(o),e.isColHidden(n)||(o+=e.getColSetWidth(n));this._areaLeft.push(o),o>0&&(o+=i),this._from=t,this._to=r,this._contentSize=o,this._checkOffset(),this._calcFromTo(),this.updateTotalSizeEmitter.fire(this._contentSize)},t.setViewSize=function(e){e<0&&(e=0),this._viewSize!==e&&(this._viewSize=e,this._checkOffset(),this._calcFromTo(),this.updateViewSizeEmitter.fire(this._viewSize))},t.setOffsetSize=function(e,t){void 0===t&&(t=T.oz.SLIENT),e=I(this._scale.scale,e,this._offsetSize);var r=this._maxOffsetSize;e<0?e=0:e>r&&(e=r),this._offsetSize!==e?(this.offsetDiff=e-this._offsetSize,this._offsetSize=e,this._calcFromTo(),this.updateOffsetEmitter.fire({offsetSize:this._offsetSize,source:t})):this.offsetDiff=0},t.setDisplayPadding=function(e){this._displayPadding=e,this._checkOffset(),this._calcFromTo(),this.updatePaddingEmitter.fire(this._padding)},t.setDisplaySafeDistance=function(e){this._displaySafeDistance=e,this._checkOffset(),this._calcFromTo(),this.updateTotalSizeEmitter.fire(this._contentSize)},t.getAreaLeft=function(e){return this._areaLeft[e]},t.isValid=function(){return this._totalSize>0},t.getLastColInView=function(){return this._renderFrom+b(this._areaLeft)},t.refresh=function(){this._offsetSize=0,this._contentSize=0,this._viewSize=0,this._renderFrom=0,this._renderTo=0},t._calcFromTo=function(){var e,t=this._to-this._from;for(this._renderFrom=this._from,e=1;e<t+1;e++)if(this._offsetSize<this._areaLeft[e]){this._renderFrom=this._from+e-1;break}for(var r=this._viewSize-this._padding;e<=t;e++)if(this._offsetSize+r<=this._areaLeft[e])return void(this._renderTo=this._from+e-1);this._renderTo=this._to},t._checkOffset=function(){this._offsetSize>this._maxOffsetSize&&(this._offsetSize=this._maxOffsetSize,this.updateOffsetEmitter.fire({offsetSize:this._offsetSize}))},(0,o.Z)(e,[{key:"_totalSize",get:function(){return this._contentSize+this._safeDistance}},{key:"_maxOffsetSize",get:function(){return Math.max(0,this._totalSize+this._padding-this._viewSize)}},{key:"_padding",get:function(){return this._displayPadding/this._scale.scale}},{key:"_safeDistance",get:function(){return this._displaySafeDistance/this._scale.scale}},{key:"from",get:function(){return this._from}},{key:"to",get:function(){return this._to}},{key:"renderFrom",get:function(){return this._renderFrom}},{key:"renderTo",get:function(){return this._renderTo}},{key:"viewSize",get:function(){return this._viewSize}},{key:"displayViewSize",get:function(){return this._viewSize*this._scale.scale}},{key:"contentSize",get:function(){return this._contentSize}},{key:"totalSize",get:function(){return this._totalSize}},{key:"displayTotalSize",get:function(){return this._totalSize*this._scale.scale}},{key:"offsetSize",get:function(){return this._offsetSize}},{key:"displayOffsetSize",get:function(){return this._offsetSize*this._scale.scale}},{key:"padding",get:function(){return this._padding}},{key:"displayPadding",get:function(){return this._displayPadding}},{key:"safeDistance",get:function(){return this._safeDistance}},{key:"displaySafeDistance",get:function(){return this._displaySafeDistance}},{key:"maxOffsetSize",get:function(){return this._maxOffsetSize}},{key:"areaLeft",get:function(){return this._areaLeft}}]),e}(),O=function(e){function t(t){var r;return(r=e.call(this)||this)._maxFrozenViewSize=null,r._maxWidth=0,r._scale=t.scale,r._frozen=new z({scale:r._scale}),r._flow=new z({scale:r._scale}),r}(0,i.Z)(t,e);var r=t.prototype;return r.updateMaxWidth=function(e){e/=this._scale.scale,this._maxWidth!==e&&(this._maxWidth=e,this._updateViewSize())},r.updateOffsetSize=function(e){this._flow.setOffsetSize(e)},r.set=function(e,t,r){this._frozen.set(e,0,t-1,t>0?n.kW:0),this._flow.set(e,t,r-1),this._updateViewSize()},r.getMaxWidth=function(){return this._maxWidth},r.setMaxFrozenViewSize=function(e){this._maxFrozenViewSize=e,this._updateViewSize()},r.refresh=function(){this._frozen.refresh(),this._flow.refresh()},r._updateViewSize=function(){var e=this._maxWidth,t=0;this._frozen.totalSize>0&&(t=null===this._maxFrozenViewSize?this._frozen.totalSize:Math.min(this._frozen.totalSize,this._maxFrozenViewSize)),this._frozen.setViewSize(t),e-=t,this._flow.setViewSize(e)},(0,o.Z)(t,[{key:"frozen",get:function(){return this._frozen}},{key:"flow",get:function(){return this._flow}}]),t}(g.JT),L=r("../spread-sheet/src/core/view/utils/base-func.ts"),B=function(e){function t(t){var r;return(r=e.call(this)||this).updateOffsetEmitter=new S.Q5,r._updateOffsetHandler=(0,L.ad)((function(e){r.updateOffsetEmitter.fire(e)})),r._updateFreeze=function(e){r.isCurrentSheet({sheetId:e})&&(r._refreshRow(),r._refreshCol(),r._col.frozen.setOffsetSize(r._col.frozen.totalSize),r._row.frozen.setOffsetSize(r._row.frozen.totalSize))},r._refreshRow=function(e){e&&!r.isCurrentSheet(e)||r._row.set(r._rowcolAccessor,r._rowcolAccessor.getFrozenRowCount(),r._rowcolAccessor.getRowCount())},r._refreshCol=function(e){e&&!r.isCurrentSheet(e)||r._col.set(r._rowcolAccessor,r._rowcolAccessor.getFrozenColCount(),r._rowcolAccessor.getColCount())},r._refreshMaxSize=function(){r._row.updateMaxHeight(r._clientRect.height-r._headSize.displayColHeadHeight),r._col.updateMaxWidth(r._clientRect.width-r._headSize.displayRowHeadWidth)},r._spreadsheet=t.spreadsheet,r._clientRect=t.clientRect,r._rowcolAccessor=t.rowcolAccessor,r._headSize=t.headSize,r._dataCallView=t.dataCallView,r._resize=t.resize,r._scale=t.scale,r.onUpdateOffset=r.updateOffsetEmitter.event,r._row=r._register(new H({scale:r._scale})),r._col=r._register(new O({scale:r._scale})),r._refreshRow(),r._refreshCol(),"undefined"!==typeof window&&r._refreshMaxSize(),"undefined"!==typeof window&&(r._register(r._resize.onResize(r._refreshMaxSize)),r._register(r._scale.onScale((function(){r._refreshRow(),r._refreshCol(),r._refreshMaxSize(),r._col.updateOffsetSize(r._col.flow.offsetSize),r._row.updateOffsetSize(r._row.flow.offsetSize)})))),r._register(r._row.frozen.onUpdateOffset(r._updateOffsetHandler)),r._register(r._row.flow.onUpdateOffset(r._updateOffsetHandler)),r._register(r._col.frozen.onUpdateOffset(r._updateOffsetHandler)),r._register(r._col.flow.onUpdateOffset(r._updateOffsetHandler)),r._register(r._dataCallView.onInsertRow((0,L.ad)(r._refreshRow))),r._register(r._dataCallView.onDeleteRow((0,L.ad)(r._refreshRow))),r._register(r._dataCallView.onSetRowHeight((0,L.ad)(r._refreshRow))),r._register(r._dataCallView.onSetRowVisible((0,L.ad)(r._refreshRow))),r._register(r._dataCallView.onInsertCol((0,L.ad)(r._refreshCol))),r._register(r._dataCallView.onDeleteCol((0,L.ad)(r._refreshCol))),r._register(r._dataCallView.onSetColWidth((0,L.ad)(r._refreshCol))),r._register(r._dataCallView.onSetColVisible((0,L.ad)(r._refreshCol))),r._register(r._dataCallView.onUpdateFreeze(r._updateFreeze)),r}(0,i.Z)(t,e);var r=t.prototype;return r.refresh=function(){this._row.refresh(),this._col.refresh(),this._refreshRow(),this._refreshCol()},r.getAreaTopByRow=function(e){return e<=this._row.frozen.to?this._row.frozen.getAreaTop(e):this._row.flow.getAreaTop(e-(this._row.frozen.to-this._row.frozen.from+1))},r.getAreaLeftByCol=function(e){return e<=this._col.frozen.to?this._col.frozen.getAreaLeft(e):this._col.flow.getAreaLeft(e-(this._col.frozen.to-this._row.frozen.from+1))},r.getDisplayGlobalTopByRow=function(e){return this.getGlobalTopByRow(e)*this._scale.scale},r.getGlobalTopByRow=function(e){return e<=this._row.frozen.to?this._row.frozen.getAreaTop(e):(this._col.frozen.to,0+this._row.flow.getAreaTop(e-(this._row.frozen.to-this._row.frozen.from+1))+this._row.frozen.totalSize)},r.getDisplayGlobalBottomByRow=function(e){return this.getGlobalBottomByRow(e)*this._scale.scale},r.getGlobalBottomByRow=function(e){var t=this.getGlobalTopByRow(e+1);return e===this._row.frozen.to&&(t-=n.kW),t},r.getDisplayGlobalLeftByCol=function(e){return this.getGlobalLeftByCol(e)*this._scale.scale},r.getGlobalLeftByCol=function(e){return e<=this._col.frozen.to?this._col.frozen.getAreaLeft(e):(this._col.frozen.to,0+this._col.flow.getAreaLeft(e-(this._col.frozen.to-this._row.frozen.from+1))+this._col.frozen.totalSize)},r.getDisplayGlobalRightByCol=function(e){return this.getGlobalRightByCol(e)*this._scale.scale},r.getGlobalRightByCol=function(e){var t=this.getGlobalLeftByCol(e+1);return e===this._col.frozen.to&&(t-=n.kW),t},r.getDisplayViewTopByRow=function(e){return this.getViewTopByRow(e)*this._scale.scale},r.getViewTopByRow=function(e){var t=this.getAreaTopByRow(e);return e<=this._row.frozen.to?t-this._row.frozen.offsetSize:t-this._row.flow.offsetSize+this._row.frozen.viewSize},r.getDisplayViewBottomByRow=function(e){return this.getViewBottomByRow(e)*this._scale.scale},r.getFrozenRowInView=function(){return this.row.frozen,{fromFrozenRow:0,toFrozenRow:this.computeRowInView()}},r.getFrozenColInView=function(){return this.col.frozen,{fromFrozenCol:0,toFrozenCol:this.computeColInView()}},r.getViewBottomByRow=function(e){return e===this._row.frozen.to?this._row.frozen.viewSize:this.getViewTopByRow(e+1)},r.getDisplayViewLeftByCol=function(e){return this.getViewLeftByCol(e)*this._scale.scale},r.getViewLeftByCol=function(e){var t=this.getAreaLeftByCol(e);return e<=this._col.frozen.to?t-this._col.frozen.offsetSize:t-this._col.flow.offsetSize+this._col.frozen.viewSize},r.getDisplayViewRightByCol=function(e){return this.getViewRightByCol(e)*this._scale.scale},r.getViewRightByCol=function(e){return e===this._col.frozen.to?this._col.frozen.viewSize:this.getViewLeftByCol(e+1)},r.getRowByDisplayViewTop=function(e){return e/=this._scale.scale,this.getRowByViewTop(e)},r.getRowByViewTop=function(e){var t;if(e>=0&&e<this._row.frozen.viewSize){for(e+=this._row.frozen.offsetSize,t=this._row.frozen.renderFrom+1;t<=this._row.frozen.to;){if(e<this._row.frozen.getAreaTop(t))return t-1;t+=1}return t-1}if((e=e-this._row.frozen.viewSize+this._row.flow.offsetSize)<this._row.flow.contentSize){for(t=this._row.flow.renderFrom+1;t<=this._row.flow.to;){if(e<this._row.flow.getAreaTop(t-(this._row.frozen.to-this._row.frozen.from+1)))return t-1;t+=1}return t-1}return Number.MAX_SAFE_INTEGER},r.getColByDisplayViewLeft=function(e){return e/=this._scale.scale,this.getColByViewLeft(e)},r.getColByViewLeft=function(e){var t;if(e>=0&&e<this._col.frozen.viewSize){for(e+=this._col.frozen.offsetSize,t=this._col.frozen.renderFrom+1;t<=this._col.frozen.to;){if(e<this._col.frozen.getAreaLeft(t))return t-1;t+=1}return t-1}if((e=e-this._col.frozen.viewSize+this._col.flow.offsetSize)<this._col.flow.contentSize){for(t=this._col.flow.renderFrom+1;t<=this._col.flow.to;){if(e<this._col.flow.getAreaLeft(t-(this._col.frozen.to-this._col.frozen.from+1)))return t-1;t+=1}return t-1}return Number.MAX_SAFE_INTEGER},r.getFirstRowInView=function(){return this._row.frozen.viewSize>0?this._row.frozen.renderFrom:this._row.flow.renderFrom},r.getLastRowInView=function(){return this._row.flow.viewSize>0?this._row.flow.renderTo:this._row.frozen.renderTo},r.getFirstColInView=function(){return this._col.frozen.viewSize>0?this._col.frozen.renderFrom:this._col.flow.renderFrom},r.getLastColInView=function(){return this._col.flow.viewSize>0?this._col.flow.renderTo:this._col.frozen.renderTo},r.inFrozenRowArea=function(e){return this._row.frozen.from<=e&&e<=this._row.frozen.to},r.inFlowRowArea=function(e){return this._row.flow.from<=e&&e<=this._row.flow.to},r.inFrozenColArea=function(e){return this._col.frozen.from<=e&&e<=this._col.frozen.to},r.inFlowColArea=function(e){return this._col.flow.from<=e&&e<=this._col.flow.to},r.isCellVisiable=function(e,t){var r=this.inFrozenRowArea(e)?this._row.frozen:this._row.flow,i=this.inFrozenColArea(t)?this._col.frozen:this._col.flow;return e>=r.renderFrom&&e<=r.renderTo&&t>=i.renderFrom&&t<=i.renderTo},r.isCurrentSheet=function(e){return e.sheetId===this._spreadsheet.activeSheetId},r.computeRowInView=function(){var e,t=this.row.frozen.areaTop,r=this.row.getMaxHeight(),i=t.length-1;for(e=1;e<i+1&&!(t[e]>=r);e++);return e-1},r.computeColInView=function(){var e,t=this.col.frozen.areaLeft,r=this.col.getMaxWidth(),i=t.length-1;for(e=1;e<i+1&&!(t[e]>=r);e++);return e-1},(0,o.Z)(t,[{key:"row",get:function(){return this._row}},{key:"col",get:function(){return this._col}}]),t}(g.JT),P=(r("../node_modules/core-js/modules/es.object.assign.js"),function(e){function t(t,i){var o;return(o=e.call(this)||this).wrapper=t,o.resize=i,o.refresh=function(){var e=document.querySelector("#footerContainer"),t=(null===e||void 0===e?void 0:e.clientHeight)||0,i=o.wrapper.getBoundingClientRect().top;o.wrapper.style.height=r.g.innerHeight-i-t+"px";var n=o.container.getBoundingClientRect(),s=n.left,a=n.top,l=n.width,c=n.height;o.distanceX=s,o.distanceY=a,o.width=l,o.height=c},o.initContainer(),o.refresh(),o._register(o.resize.onResize(o.refresh)),o}return(0,i.Z)(t,e),t.prototype.initContainer=function(){this.container=document.createElement("div"),this.container.className="excel-container",this.container.setAttribute("tabIndex","3"),Object.assign(this.container.style,{width:"100%",height:"calc(100% - 1px)",transform:"scale(1)",overflow:"hidden","-webkit-transform":"scale(1)","transform-origin":"left top","-webkit-transform-origin":"left top","user-select":"none","-webkit-user-select":"none","background-color":"#f3f5f7","box-sizing":"border-box"}),this.wrapper.appendChild(this.container)},t}(g.JT)),j=function(){function e(e){this._rowHeadWidth=n.vf,this._colHeadHeight=n.gU,this._scale=e.scale}return(0,o.Z)(e,[{key:"displayRowHeadWidth",get:function(){return this._rowHeadWidth*this._scale.scale>>0}},{key:"displayColHeadHeight",get:function(){return this._colHeadHeight*this._scale.scale>>0}},{key:"rowHeadWidth",get:function(){return this._rowHeadWidth}},{key:"colHeadHeight",get:function(){return this._colHeadHeight}}]),e}(),M=r("../node_modules/@tencent/docs-user-agent/dist/index.js"),k=r.n(M),F=function(e){function t(){var t;if((t=e.call(this)||this).preInnerWidth=r.g.innerWidth,t.preInnerHeight=r.g.innerHeight,t.resize=function(){t.handleResize()},t.onPixelRatioChange=function(){t.devicePixelRatio!==r.g.devicePixelRatio&&(t.devicePixelRatio=r.g.devicePixelRatio,t.resize())},t.handleResize=function(){"visible"===r.g.document.visibilityState&&t.onResizeEmitter.fire()},t.onResizeEmitter=new S.Q5,t.onResize=t.onResizeEmitter.event,t.devicePixelRatio=r.g.devicePixelRatio,t.throttleHandleResize=(0,L.Ic)((function(){t.checkWindowResize()&&t.handleResize()}),3e3),"undefined"!==typeof r.g.window){r.g.addEventListener("resize",t.throttleHandleResize),r.g.document.addEventListener("visibilitychange",t.handleResize);var i="(resolution: "+r.g.devicePixelRatio+"dppx)";window.matchMedia(i).addListener(t.onPixelRatioChange),k().isTencentDocsApp&&k().isIPad&&t.throttleHandleResize()}return t}(0,i.Z)(t,e);var o=t.prototype;return o.dispose=function(){if(e.prototype.dispose.call(this),"undefined"!==typeof r.g.window){r.g.removeEventListener("resize",this.throttleHandleResize),r.g.document.removeEventListener("visibilitychange",this.handleResize);var t="(resolution: "+r.g.devicePixelRatio+"dppx)";r.g.matchMedia(t).removeListener(this.onPixelRatioChange)}},o.checkWindowResize=function(){return(this.preInnerHeight!==r.g.innerHeight||this.preInnerWidth!==r.g.innerWidth)&&(this.preInnerWidth=r.g.innerWidth,this.preInnerHeight=r.g.innerHeight,!0)},t}(g.JT),V=(r("../node_modules/regenerator-runtime/runtime.js"),r("../node_modules/core-js/modules/es.object.to-string.js"),r("../node_modules/core-js/modules/es.promise.js"),r("../spread-sheet/src/core/view/lib/matrix/Matrix.ts"));function N(e,t,r,i,o){if(e!==t){var n=t-e>0?r:-r,s=1.5*r,a=e;!function e(){if(n>0&&Math.abs(a)>Math.abs(t)-s||n<0&&Math.abs(a)<Math.abs(t)-s)return i(t-a),void(null===o||void 0===o||o());a+=n,i(n),requestAnimationFrame(e)}()}}var Z,U=function(e,t,r,i){return new(r||(r=Promise))((function(o,n){function s(e){try{l(i.next(e))}catch(t){n(t)}}function a(e){try{l(i.throw(e))}catch(t){n(t)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}l((i=i.apply(e,t||[])).next())}))},W=function(){function e(){this._onScale=new S.Q5,this._matrix=new V.Z,this._scale=1,this.onScale=this._onScale.event}var t=e.prototype;return t.scaleTo=function(e,t){return void 0===t&&(t={}),U(this,void 0,void 0,regeneratorRuntime.mark((function r(){var i,o,n,s,a,l,c,d,h,u,f=this;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return o=(i=t).immediately,n=void 0===o||o,s=i.step,a=void 0===s?.08:s,l=i.frameCb,c=void 0===l?function(){}:l,d=i.endCb,h=void 0===d?function(){}:d,u=function(e){e(),h()},r.abrupt("return",new Promise((function(t){return f._scale===e?t():n?(c(),f._handleScale(e),void u(t)):void N(f._scale,e,a,(function(e){c(),f._handleScale(f._scale+e)}),u.bind(f,t))})).catch((function(){})));case 3:case"end":return r.stop()}}),r)})))},t._handleScale=function(e){this._matrix.scale(e/this._scale,e/this._scale),this._scale=e,this._onScale.fire(this._scale)},(0,o.Z)(e,[{key:"scale",get:function(){return this._scale}},{key:"matrix",get:function(){return this._matrix}}]),e}(),G=r("../spread-sheet/src/core/view/spreadsheet-view/row-col-accessor/RowcolAccessor.ts"),Y=(r("../node_modules/core-js/modules/es.object.keys.js"),r("../spread-sheet/src/core/view/spreadsheet-view/accessor/BaseRowAccessor.ts")),X=function(e){function t(t){var r;return(r=e.call(this)||this).handleColChange=function(e){for(var t=r.rowcolAccessor.getRowCount(e.sheetId),i=0;i<t;i++)r.calcFunc(i,e.sheetId)},r.handleCellsChange=function(e){for(var t=e.startRow,i=e.endRow,o=e.sheetId,n=t;n<=i;n++)r.calcFunc(n,o)},r.dataCallView=t.dataCallView,r.rowcolAccessor=t.rowcolAccessor,r.calcFunc=t.calc,r._register(r.dataCallView.onInsertCol(r.handleColChange)),r._register(r.dataCallView.onDeleteCol(r.handleColChange)),r._register(r.dataCallView.onSetColVisible(r.handleColChange)),r._register(r.dataCallView.onSetColWidth(r.handleColChange)),r._register(r.dataCallView.onUpdateCells(r.handleCellsChange)),r}return(0,i.Z)(t,e),t}(g.JT),K=r("../spread-sheet/src/core/view/spreadsheet-view/row-cover-accessor/utils.ts"),J=r("../spread-sheet/src/core/view/spreadsheet-view/paragraph-accessor/utils.ts"),Q=function(e){function t(t){var i;return(i=e.call(this,t)||this).inputCoverData=[],i.inputCoverParent=[],i._calcRowCoverInfo=function(e,t){i._rowData[t]||i.init(t);var o=i._spreadsheet.sheetManager.getSheetBySheetId(t);if(o){i._resetRow(e,t);for(var n=i._rowcolAccessor.getColCount(t)-1,s=0;s<n;s++){var a=i.getCellDataAtPosition(e,s,o);if(a){var l=i._calcCellViewCover(a,e,s,t);l&&i._setCoverInfo(l,t)}}}else r.g.log.error("RowCoverAccessor _calcRowCoverInfo: sheetId is invalid")},i.getCellDataAtPosition=function(e,t,r){return i.shouldUseInputCellData(e,t)?i.inputCellData:r.getCellDataAtPosition(e,t)},i.shouldUseInputCellData=function(e,t){return i.inputCellData&&e===i.inputRow&&t===i.inputCol},i.shouldUseInputRowData=function(e){return i.inputCellData&&e===i.inputRow},i._paragraphAccessor=t.paragraphAccessor,i._rowcolAccessor=t.rowcolAccessor,i._recalculateListener=i._register(new X({dataCallView:i._dataCallView,rowcolAccessor:i._rowcolAccessor,calc:i._calcRowCoverInfo})),i.init(i._spreadsheet.activeSheetId),i}(0,i.Z)(t,e);var o=t.prototype;return o.refresh=function(e){this._rowData[e]&&0!==Object.keys(this._rowData[e]).length||this.init(e)},o.getCoverOffset=function(e,t,r){var i;if(this.shouldUseInputRowData(e)&&(null===(i=this.inputCoverData[e])||void 0===i?void 0:i[t]))return this._fromValue(this.inputCoverData[e][t]);var o=r||this._spreadsheet.activeSheetId;if(!this._rowData[o]||!this._rowData[o].cover_data[e])return null;var n=this._rowData[o].cover_data[e][t];return n?this._fromValue(n):null},o.getHiddenOffset=function(e,t,r){var i;if(this.shouldUseInputRowData(e)&&(null===(i=this.inputCoverParent[e])||void 0===i?void 0:i[t]))return this._fromValue(this.inputCoverParent[e][t]);if(!this._rowData[r]||!this._rowData[r].cover_parent[e])return null;var o=this._rowData[r].cover_parent[e][t];return o?this._fromValue(o):null},o.isCoverCell=function(e,t,r){var i;if(this.shouldUseInputRowData(e))return!!(null===(i=this.inputCoverData[e])||void 0===i?void 0:i[t]);var o=r||this._spreadsheet.activeSheetId;return!(!this._rowData[o]||!this._rowData[o].cover_data[e])&&!!this._rowData[o].cover_data[e][t]},o.isHiddenCell=function(e,t,r){var i;return this.shouldUseInputRowData(e)?!!(null===(i=this.inputCoverParent[e])||void 0===i?void 0:i[t]):!(!this._rowData[r]||!this._rowData[r].cover_parent[e])&&!!this._rowData[r].cover_parent[e][t]},o.getHiddenCellParents=function(e,t,r){var i,o,n,s=r||this._spreadsheet.activeSheetId;if(!this.isHiddenCell(e,t,s))return null;var a=[];if(!(n=this.shouldUseInputRowData(e)&&(null===(i=this.inputCoverParent[e])||void 0===i?void 0:i[t])?this.inputCoverParent[e][t]:null===(o=this._rowData[s].cover_parent[e])||void 0===o?void 0:o[t]))return null;var l=this._fromValue(n);return l.leftOffset&&a.push({rowIndex:e,colIndex:t-l.leftOffset}),l.rightOffset&&a.push({rowIndex:e,colIndex:t+l.rightOffset}),a.length?a:null},o.setInputCellData=function(e,t,r){if(r){this.inputRow=e,this.inputCol=t,this.inputCellData=r;var i=this._spreadsheet.activeSheetId;this._resetRow(e,i);for(var o=this._rowcolAccessor.getColCount(i)-1,n=0;n<o;n++){var s=this.getCellDataAtPosition(e,n,this._spreadsheet.activeSheet);if(s){var a=this._calcCellViewCover(s,e,n,i);if(a){var l=a.coverPos,c=a.offset;this.inputCoverData[l.rowIndex]||(this.inputCoverData[l.rowIndex]={}),this.inputCoverData[l.rowIndex][l.colIndex]=this._toVale(c),this.setInputCellCoverData(c,l)}}}}else this.inputCellData=null},o.clearInputCellData=function(){this.inputRow=-1,this.inputCol=-1,this.inputCellData=null,this.inputCoverData=[],this.inputCoverParent=[]},o.init=function(e){var t;r.g.log.info("RowCoverAccessor init",e);var i=this.getTargetSheet(e);if(i){this._rowData[e]=((t={}).cover_data=[],t.cover_parent=[],t);for(var o=i.highWaterMark.getMark(),n=0;n<=o;n++)this._calcRowCoverInfo(n,e)}else r.g.log.error("RowCoverAccessor _init: sheetId is invalid",e)},o.setInputCellCoverData=function(e,t){var r;if(e.leftOffset)for(r=t.colIndex-e.leftOffset;r<t.colIndex;r++)if(this.inputCoverParent[t.rowIndex]){var i=this.inputCoverParent[t.rowIndex][r];this.inputCoverParent[t.rowIndex][r]=this._toVale({leftOffset:(i||0)>>16,rightOffset:t.colIndex-r})}else this.inputCoverParent[t.rowIndex]={},this.inputCoverParent[t.rowIndex][r]=this._toVale({leftOffset:0,rightOffset:t.colIndex-r});if(e.rightOffset)for(r=t.colIndex+1;r<=t.colIndex+e.rightOffset;r++)if(this.inputCoverParent[t.rowIndex]){var o=this.inputCoverParent[t.rowIndex][r];this.inputCoverParent[t.rowIndex][r]=this._toVale({leftOffset:r-t.colIndex,rightOffset:o||0})}else this.inputCoverParent[t.rowIndex]={},this.inputCoverParent[t.rowIndex][r]=this._toVale({leftOffset:r-t.colIndex,rightOffset:0})},o._resetRow=function(e,t){this.inputCoverData[e]&&(this.inputCoverData[e]={}),this.inputCoverParent[e]&&(this.inputCoverParent[e]={}),this._rowData[t].cover_data[e]&&(this._rowData[t].cover_data[e]={}),this._rowData[t].cover_parent[e]&&(this._rowData[t].cover_parent[e]={})},o._toVale=function(e){return(e.leftOffset<<16)+e.rightOffset},o._fromValue=function(e){return{leftOffset:e>>16,rightOffset:65535&e}},o._setCoverInfo=function(e,t){var r,i=e.coverPos,o=e.offset;if(this._rowData[t].cover_data[i.rowIndex]||(this._rowData[t].cover_data[i.rowIndex]={}),this._rowData[t].cover_data[i.rowIndex][i.colIndex]=this._toVale(o),o.leftOffset)for(r=i.colIndex-o.leftOffset;r<i.colIndex;r++)if(this._rowData[t].cover_parent[i.rowIndex]){var n=this._rowData[t].cover_parent[i.rowIndex][r];this._rowData[t].cover_parent[i.rowIndex][r]=this._toVale({leftOffset:(n||0)>>16,rightOffset:i.colIndex-r})}else this._rowData[t].cover_parent[i.rowIndex]={},this._rowData[t].cover_parent[i.rowIndex][r]=this._toVale({leftOffset:0,rightOffset:i.colIndex-r});if(o.rightOffset)for(r=i.colIndex+1;r<=i.colIndex+o.rightOffset;r++)if(this._rowData[t].cover_parent[i.rowIndex]){var s=this._rowData[t].cover_parent[i.rowIndex][r];this._rowData[t].cover_parent[i.rowIndex][r]=this._toVale({leftOffset:r-i.colIndex,rightOffset:s||0})}else this._rowData[t].cover_parent[i.rowIndex]={},this._rowData[t].cover_parent[i.rowIndex][r]=this._toVale({leftOffset:r-i.colIndex,rightOffset:0})},o._calcCellViewCover=function(e,t,i,o){var n=this._spreadsheet.sheetManager.getSheetBySheetId(o);if(n){var a=this._paragraphAccessor.getParagraph(t,i,o);if(a&&!(e.getMergeReference()||(0,J.l)(e)||this._rowcolAccessor.isColHidden(i,o))){var l,c=(0,s.jl)(n,t,i),d=(0,s.PE)(e).value;l=d===w.O.LEFT?c.paddingLeft:d===w.O.RIGHT?c.paddingRight:0;var h=a.width+l,u=(0,K.bE)(this._rowcolAccessor,e,i,o);if(!(h<u)){var f=this._calcOffset(d,h,u,t,i,o);return{coverPos:{rowIndex:t,colIndex:i},offset:{leftOffset:f.leftOffset,rightOffset:f.rightOffset}}}}}else r.g.log.error("RowCoverAccessor _calcCellViewCover: sheetId is invalid")},o._calcOffset=function(e,t,r,i,o,n){var s=0,a=0,l=(t-r)/2;switch(e){case w.O.LEFT:a=this._extendCoverToRight(t-r,o,i,n);break;case w.O.RIGHT:s=this._extendCoverToLeft(t-r,o,i,n);break;case w.O.CENTER:s=this._extendCoverToLeft(l,o,i,n),a=this._extendCoverToRight(l,o,i,n)}return{leftOffset:s,rightOffset:a}},o._extendCoverToRight=function(e,t,i,o){var n=e,s=this._rowcolAccessor.getColCount(o),a=this._spreadsheet.sheetManager.getSheetBySheetId(o);if(!a)return r.g.log.error("RowCoverAccessor _extendCoverToRight: sheetId is invalid"),0;for(var l=1,c=t+l,d=this.getCellDataAtPosition(i,c,a);c<s&&n>0&&((0,K.NZ)(d)||this._rowcolAccessor.isColHidden(c,o))&&!(0,K.$G)(d);)n-=this._rowcolAccessor.isColHidden(c,o)?0:this._rowcolAccessor.getColSetWidth(c,o),c=t+(l+=1),d=this.getCellDataAtPosition(i,c,a);return l-=1},o._extendCoverToLeft=function(e,t,i,o){var n=e,s=this._spreadsheet.sheetManager.getSheetBySheetId(o);if(!s)return r.g.log.error("RowCoverAccessor _extendCoverToLeft: sheetId is invalid"),0;for(var a=1,l=t-a,c=this.getCellDataAtPosition(i,l,s);l>=0&&n>0&&((0,K.NZ)(c)||this._rowcolAccessor.isColHidden(l,o))&&!(0,K.$G)(c);)n-=this._rowcolAccessor.isColHidden(l,o)?0:this._rowcolAccessor.getColSetWidth(l,o),l=t-(a+=1),c=this.getCellDataAtPosition(i,l,s);return a-=1},t}(Y.Z),$=Q,q=r("../spread-sheet/src/core/view/spreadsheet-view/paragraph-accessor/ParagraphAccessor.ts"),ee=r("../packages/model/src/cell/format/BorderStyle.ts"),te=r("../packages/model/src/cell/format/colorUtils.ts"),re=((Z={})[ee.Z.NONE]=0,Z[ee.Z.HAIR]=1,Z[ee.Z.DASH_DOT]=2,Z[ee.Z.DASH_DOT_DOT]=3,Z[ee.Z.DOTTED]=4,Z[ee.Z.DASHED]=5,Z[ee.Z.THIN]=6,Z[ee.Z.MEDIUM_DASH_DOT_DOT]=7,Z[ee.Z.SLANTED_DASH_DOT]=8,Z[ee.Z.MEDIUM_DASH_DOT]=9,Z[ee.Z.MEDIUM_DASHED]=10,Z[ee.Z.MEDIUM]=11,Z[ee.Z.THICK]=12,Z[ee.Z.DOUBLE]=13,Z);function ie(e,t,r){if(!t||null===t.style)return 1;if(!e||null===e.style)return-1;var i=function(e,t){return t.style?e.style?re[e.style]-re[t.style]:-1:1}(e,t);return 0===i?function(e,t,r){return t?e?(0,te.compareColorByBrightness)(e.color,t.color,r):-1:1}(e,t,r):i}var oe=r("../spread-sheet/src/core/view/spreadsheet-view/transform-table/utils.ts"),ne=r("../spread-sheet/src/core/view/level-2/dimension-edit/hide-show-head/utils.ts"),se=function(e){function t(t){var i;return(i=e.call(this)||this)._calcRows=function(e){var t=e.index,o=e.amount,n=e.sheetId,s=i.getTargetSheet(n);s?i._calc(Math.max(0,t-1),t+o,0,s.getColCount()-1,n):r.g.log.error("RecalculateListener _calcRows: sheetId is invalid")},i._calcCols=function(e){var t=e.index,o=e.amount,n=e.sheetId,s=i.getTargetSheet(n);s?i._calc(0,s.getRowCount()-1,Math.max(0,t-1),t+o,n):r.g.log.error("RecalculateListener _calcCols: sheetId is invalid")},i._calcRowsByRange=function(e){var t=e.ranges,o=e.sheetId,n=i.getTargetSheet(o);if(n)for(var s=0;s<t.length;s++){var a=t[s];i._calc(Math.max(0,a.startIndex-1),a.endIndex+1,0,n.getColCount()-1,o)}else r.g.log.error("RecalculateListener _calcRowsByRange: sheetId is invalid")},i._calcColsByRange=function(e){var t=i.getTargetSheet(e.sheetId);t?i._calc(0,t.getRowCount()-1,0,t.getColCount()-1,e.sheetId):r.g.log.error("RecalculateListener _calcColsByRange: sheetId is invalid")},i._calcCells=function(e){var t=e.startRow,o=e.endRow,n=e.sheetId,s=i.getTargetSheet(n);s?i._calc(t-1,o+1,0,s.getColCount()-1,n):r.g.log.error("RecalculateListener _calcCells: sheetId is invalid")},i.getTargetSheet=function(e){return i._spreadsheet.sheetManager.getSheetBySheetId(e)},i._dataCallView=t.dataCallView,i._spreadsheet=t.spreadsheet,i._calc=t.calc,i._checkGridlines=t.checkGridlines,i._register(i._dataCallView.onUpdateHideGridLines((function(e){i._checkGridlines(e)}))),i._register(i._dataCallView.onInsertRow(i._calcRows)),i._register(i._dataCallView.onInsertCol(i._calcCols)),i._register(i._dataCallView.onDeleteRow(i._calcRows)),i._register(i._dataCallView.onDeleteCol(i._calcCols)),i._register(i._dataCallView.onSetRowVisible(i._calcRowsByRange)),i._register(i._dataCallView.onSetColVisible(i._calcColsByRange)),i._register(i._dataCallView.onSetColWidth(i._calcColsByRange)),i._register(i._dataCallView.onUpdateCells(i._calcCells)),i}return(0,i.Z)(t,e),t}(g.JT),ae=se,le=r("../spread-sheet/src/core/view/spreadsheet-view/accessor/BaseCellAccessor.ts"),ce=function(e){function t(t){var i;return(i=e.call(this,t)||this).calcRangeBorder=function(e,t,r,o,n){i._rowData[n]||i.init(n);for(var s=Math.max(0,e),a=Math.min(t,i.rowcolAccessor.getRowCount(n)-1),l=Math.max(0,r),c=Math.min(o,i.rowcolAccessor.getColCount(n)-1),d=s;d<=a;d++)if(!i.rowcolAccessor.isRowHidden(d,n))for(var h=l;h<=c;h++){var u=i.calcCellBorder(d,h,n);u&&(i._rowData[n].border_show_data[d]||(i._rowData[n].border_show_data[d]=[]),i._rowData[n].border_show_data[d][h]=u)}},i.checkGridlines=function(e){i._rowData[e]||i.init(e);var t=i._spreadsheet.sheetManager.getSheetBySheetId(e);t?t.getHideGridlines()?n.t1.style=0:n.t1.style=3:r.g.log.error("BorderAccessor checkGridlines: sheetId is invalid")},i.rowCoverAccessor=t.rowCoverAccessor,i.rowcolAccessor=t.rowcolAccessor,i._spreadsheet=t.spreadsheet,i.recalculateListener=i._register(new ae({dataCallView:i._dataCallView,spreadsheet:i._spreadsheet,calc:i.calcRangeBorder,checkGridlines:function(e){return i.checkGridlines(e)}})),i.init(i._spreadsheet.activeSheetId),i}(0,i.Z)(t,e);var o=t.prototype;return o.getBorder=function(e,t,r){var i=r||this._spreadsheet.activeSheetId;if(this._rowData[i]&&this._rowData[i].border_show_data[e])return this._rowData[i].border_show_data[e][t]},o.refresh=function(e){this._rowData[e]&&0!==Object.keys(this._rowData[e]).length?this.checkGridlines(e):this.init(e)},o.init=function(e){var t;r.g.log.info("BorderAccessor init",e),this._rowData[e]=((t={}).border_show_data=[],t);var i=this._spreadsheet.sheetManager.getSheetBySheetId(e);if(i){this.checkGridlines(e);var o=i.getRowCount()-1,n=i.getColCount()-1;this.calcRangeBorder(0,o,0,n,e)}else r.g.log.error("BorderAccessor init: sheetId is invalid")},o.calcCellBorder=function(e,t,i){var o=this._spreadsheet.sheetManager.getSheetBySheetId(i);if(o){var n=o.getCellDataAtPosition(e,t),s=this.transformBottom(o,n,e,t),a=function(e){if(!e)return null;var t=e.getUserEnteredFormat();return t?t.getBorderDiagUp():null}(n),l=function(e){if(!e)return null;var t=e.getUserEnteredFormat();return t?t.getBorderDiagDown():null}(n);return{right:this.isRightBorderHiddenByCoverCell(e,t,i)||this.isRightBorderHiddenInHiddenCell(e,t,i)?null:this.transformRight(o,n,e,t),bottom:s,diagUp:a,diagDown:l}}r.g.log.error("BorderAccessor calcCellBorder: sheetId is invalid")},o.isRightBorderHiddenByCoverCell=function(e,t,r){var i=this.rowCoverAccessor.getCoverOffset(e,t,r);if(!i)return!1;if(i.rightOffset)for(var o=i.rightOffset,n=t;o;){if(n+=1,!this.rowcolAccessor.isColHidden(n,r))return!0;o-=1}return!1},o.isRightBorderHiddenInHiddenCell=function(e,t,r){var i=this.rowCoverAccessor.getHiddenOffset(e,t,r);if(!i)return!1;if(i.rightOffset)return!0;if(i.leftOffset){var o=this.rowCoverAccessor.getCoverOffset(e,t-i.leftOffset,r);if(!o)return!1;if(i.leftOffset<o.rightOffset)return!0}return!1},o.transformRight=function(e,t,r,i){var o,s,a,l=null===t||void 0===t?void 0:t.getMergeReference();return l&&i<l.endColIndex&&(0,ne.mt)(e,i,1)<=l.endColIndex?a=null:(o=function(e){if(!e)return null;var t=e.getUserEnteredFormat();return t?t.getBorderRight():null}(t),s=function(e){if(!e)return null;var t=e.getUserEnteredFormat();return t?t.getBorderLeft():null}((0,oe.Iv)(e,i,r)),a=ie(o,s,this._spreadsheet)>=0?(null===o||void 0===o?void 0:o.style)?o:n.t1:(null===s||void 0===s?void 0:s.style)?s:n.t1),a},o.transformBottom=function(e,t,r,i){var o,s,a,l=null===t||void 0===t?void 0:t.getMergeReference();return l&&r<l.endRowIndex&&(0,ne.kI)(e,r,1)<=l.endRowIndex?a=null:(o=function(e){if(!e)return null;var t=e.getUserEnteredFormat();return t?t.getBorderBottom():null}(t),s=function(e){if(!e)return null;var t=e.getUserEnteredFormat();return t?t.getBorderTop():null}((0,oe.F5)(e,i,r)),a=ie(o,s,this._spreadsheet)>=0?(null===o||void 0===o?void 0:o.style)?o:n.t1:(null===s||void 0===s?void 0:s.style)?s:n.t1),a},t}(le.Z),de=r("../packages/model/src/spreadsheet/index.ts"),he=r("../spread-sheet/src/core/view/data-call-view/DataCallView.interface.ts"),ue=r("../spread-sheet/src/core/view/spreadsheet-view/transform-table/head.ts"),fe=(r("../node_modules/core-js/modules/web.dom-collections.for-each.js"),r("../node_modules/core-js/modules/es.array.join.js"),r("../spread-sheet/src/core/view/spreadsheet-view/render-manager/alloy-excel/interface.ts")),ge=(r("../node_modules/core-js/modules/es.array.iterator.js"),r("../node_modules/core-js/modules/es.map.js"),r("../node_modules/core-js/modules/es.string.iterator.js"),r("../node_modules/core-js/modules/esnext.map.delete-all.js"),r("../node_modules/core-js/modules/esnext.map.every.js"),r("../node_modules/core-js/modules/esnext.map.filter.js"),r("../node_modules/core-js/modules/esnext.map.find.js"),r("../node_modules/core-js/modules/esnext.map.find-key.js"),r("../node_modules/core-js/modules/esnext.map.includes.js"),r("../node_modules/core-js/modules/esnext.map.key-of.js"),r("../node_modules/core-js/modules/esnext.map.map-keys.js"),r("../node_modules/core-js/modules/esnext.map.map-values.js"),r("../node_modules/core-js/modules/esnext.map.merge.js"),r("../node_modules/core-js/modules/esnext.map.reduce.js"),r("../node_modules/core-js/modules/esnext.map.some.js"),r("../node_modules/core-js/modules/esnext.map.update.js"),r("../node_modules/core-js/modules/web.dom-collections.iterator.js"),r("../node_modules/core-js/modules/es.regexp.exec.js"),r("../node_modules/core-js/modules/es.string.split.js"),new Map),pe=[],_e=new Map,ve=new Map;function we(e){var t="";return"s"+me(t=function(e,t){var r=e;if(t){var i="text-decoration:"+t+";\n",o=ge.get(i);if(!o&&0!==o){var n=ge.size;ge.set(i,n),pe[n]=i,o=n}r+=o}return""+r}(t=function(e,t){var r=e;if(t){var i="font-size:"+t+"pt;\n",o=ge.get(i);if(!o&&0!==o){var n=ge.size;ge.set(i,n),pe[n]=i,o=n}r+=o}return r+","}(t=function(e,t){var r=e;if(t){var i="font-family:"+t+";\n",o=ge.get(i);if(!o&&0!==o){var n=ge.size;ge.set(i,n),pe[n]=i,o=n}r+=o}return r+","}(t=function(e,t){var r=e;if(t){var i="font-style:"+t+";\n",o=ge.get(i);if(!o&&0!==o){var n=ge.size;ge.set(i,n),pe[n]=i,o=n}r+=o}return r+","}(t=function(e,t){var r=e;if(t){var i="font-weight:"+t+";\n",o=ge.get(i);if(!o&&0!==o){var n=ge.size;ge.set(i,n),pe[n]=i,o=n}r+=o}return r+","}(t=Ce(t,e.color),e.fontWeight),e.fontStyle),e.fontFamily),e.fontSize),e.textDecoration))}function me(e){var t=ve.get(e),r="";if(!t&&0!==t){e.split(",").forEach((function(e){e&&(r+=""+pe[+e])}));var i=ve.size;ve.set(e,i),_e.set(i,r),t=i}return t}function Ce(e,t){var r=e;if(t){var i="color:"+t+";\n",o=ge.get(i);if(!o&&0!==o){var n=ge.size;ge.set(i,n),pe[n]=i,o=n}r+=o}return r+","}var ye=r("../packages/common-utils/src/index.ts"),Re=function(){function e(e){this.borderTop=null,this.borderRight=null,this.borderBottom=null,this.borderLeft=null,this.borderDiagUp=null,this.borderDiagDown=null,this.isCover=!1,this.coverParents=null,this.metadata=null,this.image=null,this.isDataValid=!0,this.isPrivate=!1,this.isCanNotRead=!1,this._cell=null,this._cell=e,this.background=e.style.background}e.newInstance=function(t){var r=e._instance;return void 0===r?r=new e(t):(r._reset(),r._cell=t,r.background=t.style.background),e._instance=r,r};var t=e.prototype;return t.getInnerHTML=function(e,t,r){if(null===this._cell.innerHTML){var i=function(e,t){var r="";return t&&t.forEach((function(e){var t="",i=e.segments,o=[];i&&(i.forEach((function(e){var t=e.text,r={};e.textProp[fe.M.BOLD]&&(r.fontWeight="bold"),e.textProp[fe.M.ITALIC]&&(r.fontStyle="italic"),e.textProp[fe.M.FONT_FAMILY]&&(r.fontFamily=e.textProp[fe.M.FONT_FAMILY]),e.textProp[fe.M.COLOR]&&(r.color=e.textProp[fe.M.COLOR]),e.textProp[fe.M.FONT_SIZE]&&(r.fontSize=""+(e.textProp[fe.M.FONT_SIZE]||12));var i=[];e.textProp[fe.M.UNDERLINE]&&i.push("underline"),e.textProp[fe.M.STRIKETHROUGH]&&i.push("line-through"),r.textDecoration=i.join(" ")||null;var n=we(r);o.push('<span class="'+n+'">'+(0,ye.r)(t)+"</span>")})),t=o.join("")),t&&(r=r+"<div>"+t+"</div>")})),r||null}(this._cell,this.lines);this._cell.innerHTML=i}return this._cell.innerHTML},t._reset=function(){this._cell=null,this.borderTop=null,this.borderRight=null,this.borderBottom=null,this.borderLeft=null,this.borderDiagUp=null,this.borderDiagDown=null,this.isCover=!1,this.coverParents=null,this.metadata=null,this.image=null,this.isDataValid=!0,this.isPrivate=!1,this.isCanNotRead=!1},(0,o.Z)(e,[{key:"cell",get:function(){return this._cell}},{key:"wrapStrategy",get:function(){return this._cell.style.wrapStrategy}},{key:"mergeData",get:function(){if(this._cell.mergeData)return this._cell.mergeData}},{key:"mergeParent",get:function(){if(this._cell.mergeParent)return this._cell.mergeParent}},{key:"horizontalAlign",get:function(){return this._cell.style.horizontalAlign}},{key:"verticalAlign",get:function(){return this._cell.style.verticalAlign}}]),e}(),xe=Re,De=r("../spread-sheet/src/core/view/spreadsheet-view/transform-table/DimensionMeta.ts"),Ee=r("../spread-sheet/src/core/view/spreadsheet-view/transform-table/segment.ts"),Se=r("../spread-sheet/src/core/view/spreadsheet-view/utils.ts"),Ie=r("../spread-sheet/src/core/view/spreadsheet-view/render-manager/alloy-excel/utils.ts"),be=r("../packages/model/src/range/hexRangeUtils.ts"),Te=r("../packages/model/src/cell/format/index.ts"),Ae=function(){function e(e){var t=this;this._onCalcRowHeadStatus=new S.Q5,this.onCalcRowHeadStatus=this._onCalcRowHeadStatus.event,this._onCalcColHeadStatus=new S.Q5,this.onCalcColHeadStatus=this._onCalcColHeadStatus.event,this._dimensionMeta=new De.Z,this.getNormalClipInfo=function(e,r,i,o,n,s){var a=null;if(e){for(var l=0,c=0,d=1;d<=e.leftOffset;d++)l+=t.getColWidth(o-d);for(var h=1;h<=e.rightOffset;h++)c+=t.getColWidth(o+h);a=[r-l,i,l+n+c,s]}else a=[r,i,n,s];return a},this.isMergeCellNeedClip=function(e,t,r,i,o){return e.mergeData&&(t.width+i>r||t.height>o)},this.shouldUseInputCellData=function(e,r){return t.inputCellData&&e===t.inputRow&&r===t.inputCol},this.isNeedShowRightFilterBorder=function(e,t,r,i){var o=i.startRowIndex,n=i.endRowIndex,s=i.startColIndex,a=i.endColIndex;return e.right&&(r===s||r===a)&&t>o&&t<=n},this.isNeedShowBottomFilterBorder=function(e,t,r,i){var o=i.startRowIndex,n=i.endRowIndex,s=i.startColIndex,a=i.endColIndex;return e.bottom&&(t===o||t===n)&&r>s&&r<=a},this._tableView=e.tableView,this._rowcolAccessor=e.rowcolAccessor,this._rowCoverAccessor=e.rowCoverAccessor,this._paragraphAccessor=e.paragraphAccessor,this._borderAccessor=e.borderAccessor,this.spreadsheet=e.spreadsheet}var t=e.prototype;return t.getCellDataAtPosition=function(e,t){var r,i,o,n;if(this.shouldUseInputCellData(e,t))return this.getInputTransformCell(e,t);var s=this._tableView.getCellViewAtPosition(e,t);null===s&&(s=h);var a=xe.newInstance(s),l=this._tableView.getIsCellPrivate(e,t);a.isPrivate=l;var c=this._tableView.getIsCellCanNotRead(e,t);a.isCanNotRead=c;var d=this._paragraphAccessor.getParagraph(e,t);a.lines=(0,Ee.r)(s,d,this._rowcolAccessor,e,t,l,c,this.spreadsheet);var u=this.getBorder(e,t);if(u&&(u.right&&(a.borderRight=u.right),u.bottom&&(a.borderBottom=u.bottom),u.diagUp&&(a.borderDiagUp=u.diagUp),u.diagDown&&(a.borderDiagDown=u.diagDown)),0===e){var f=this.spreadsheet.activeSheet.getCellDataAtPosition(e,t),g=null===(i=null===(r=null===f||void 0===f?void 0:f.getUserEnteredFormat())||void 0===r?void 0:r.borders)||void 0===i?void 0:i.top;g&&(a.borderTop=g)}if(0===t){var p=this.spreadsheet.activeSheet.getCellDataAtPosition(e,t),_=null===(n=null===(o=null===p||void 0===p?void 0:p.getUserEnteredFormat())||void 0===o?void 0:o.borders)||void 0===n?void 0:n.left;_&&(a.borderLeft=_)}return a.isCover=this._rowCoverAccessor.isCoverCell(e,t),a.coverParents=this._rowCoverAccessor.getHiddenCellParents(e,t),a.metadata=this._tableView.getCellMetadata(e,t),a.image=this._tableView.getCellImage(e,t),a.isDataValid=this._tableView.getIsDataValid(e,t),a.dataBar=this._tableView.getDataBar(e,t),a.hyperlinkType=this._tableView.getCellHyperlinkType(e,t),a.hyperlink=this._tableView.getCellHyperlink(e,t),a.weworkCardIcon=this._tableView.getWeworkCardIcon(e,t),a.todoRange=this._tableView.getTodoRange(e,t),a},t.getRowContent=function(e){return String(e+1)},t.getColContent=function(e){return(0,be.colIndex2ColChar)(e)},t.getRowMeta=function(e){return this._dimensionMeta.resize(e),this._onCalcRowHeadStatus.fire(this._dimensionMeta),(0,ue.Lg)(e,this._rowcolAccessor,this._dimensionMeta)},t.getColMeta=function(e){return this._dimensionMeta.resize(e),this._onCalcColHeadStatus.fire(this._dimensionMeta),(0,ue.Go)(e,this._rowcolAccessor,this._dimensionMeta)},t.getRowHeight=function(e){return this.isRowHidden(e)?0:this._rowcolAccessor.getRowDisplayHeight(e)},t.getColWidth=function(e){return this.isColHidden(e)?0:this._rowcolAccessor.getColSetWidth(e)},t.isRowHidden=function(e){return this._rowcolAccessor.isRowHidden(e)},t.isColHidden=function(e){return this._rowcolAccessor.isColHidden(e)},t.getRowCount=function(){return this._tableView.cellViews.length},t.getColCount=function(){return void 0===this._tableView.cellViews[0]?0:this._tableView.cellViews[0].length},t.getCellBackgroundWidth=function(e,t){return(0,Se.o)(this._rowcolAccessor,this._tableView.getCellViewAtPosition(e,t),t)},t.getCellBackgroundHeight=function(e,t){return(0,Se.E)(this._rowcolAccessor,this._tableView.getCellViewAtPosition(e,t),e)},t.getClipInfo=function(e,t,r,i,o,n){var s=null,a=this.getCellDataAtPosition(e,t),l=this._paragraphAccessor.getParagraph(e,t);if(!l)return s;var c=this._rowCoverAccessor.getCoverOffset(e,t),d=this.getCellOffset(a);return this.isMergeCellNeedClip(a,l,o,d,n)?s=[r,i,o,n]:(l.height>n||l.width+d>o||c)&&(s=this.getNormalClipInfo(c,r,i,t,o,n)),s},t.getVerticalBorderStyle=function(e,t){var r=this.getBorder(t,e);return(null===r||void 0===r?void 0:r.right)&&r.right.style||Ie.j.NONE},t.getHorizontalBorderStyle=function(e,t){var r=this.getBorder(e,t);return(null===r||void 0===r?void 0:r.bottom)&&r.bottom.style||Ie.j.NONE},t.getDiagBorderStyle=function(e,t,r){var i=this.getBorder(e,t);return r&&(null===i||void 0===i?void 0:i.diagUp)?i.diagUp.style||Ie.j.NONE:!r&&(null===i||void 0===i?void 0:i.diagDown)&&i.diagDown.style||Ie.j.NONE},t.getBorder=function(e,t){var r,i=this._borderAccessor.getBorder(e,t);if(i){var o=this.getFilterVisibleBorderRange();if(o){var s=o.isFilterSync,a=null===(r=this.spreadsheet.activeSheet.getBasicFilter())||void 0===r?void 0:r.getIsLocalView(),l=a||!a&&!s?n.e6:n.ey;this.isNeedShowRightFilterBorder(i,e,t,o)&&(i.right=l),this.isNeedShowBottomFilterBorder(i,e,t,o)&&(i.bottom=l)}return i}},t.refreshFilterVisibleBorderRange=function(){var e,t=this.spreadsheet,r=t.isFilterSync,i=t.activeSheet,o=null===(e=i.getBasicFilter())||void 0===e?void 0:e.range;if(o){var n=o.startRowIndex,s=o.startColIndex,a=o.endRowIndex,l=o.endColIndex;do{n-=1}while(n>=0&&i.isRowHidden(n));do{s-=1}while(n>=0&&i.isColHidden(s));for(;a>n&&i.isRowHidden(a);)a-=1;for(;l>s&&i.isColHidden(l);)l-=1;this.filterVisibleBorderRange={startRowIndex:n,endRowIndex:a,startColIndex:s,endColIndex:l,isFilterSync:r}}else this.filterVisibleBorderRange=null},t.setInputCellData=function(e,t,r){r?(this._paragraphAccessor.setInputCellData(e,t,r),this._rowCoverAccessor.setInputCellData(e,t,r),this._rowcolAccessor.setInputCellData(e,t,r),this.inputRow=e,this.inputCol=t,this.inputCellData=r):this.inputCellData=null},t.clearInputCellData=function(){this._paragraphAccessor.clearInputCellData(),this._rowCoverAccessor.clearInputCellData(),this._rowcolAccessor.clearInputCellData(),this.inputCellData=null},t.getInputTransformCell=function(e,t){var r,i=this._tableView._spreadsheet;r=this.inputCellData.getFormula()?new y(this.inputCellData,e,t,i):new u(this.inputCellData,e,t,i);var o=xe.newInstance(r),n=this._paragraphAccessor.getParagraph(e,t);o.lines=(0,Ee.r)(r,n,this._rowcolAccessor,e,t,!1,!1,this._tableView._spreadsheet);var s=this.getBorder(e,t);return s&&(s.right&&(o.borderRight=s.right),s.bottom&&(o.borderBottom=s.bottom),s.diagUp&&(o.borderDiagUp=s.diagUp),s.diagDown&&(o.borderDiagDown=s.diagDown)),o.isCover=this._rowCoverAccessor.isCoverCell(e,t),o.coverParents=this._rowCoverAccessor.getHiddenCellParents(e,t),o.metadata=this.inputCellData.getMetadata()||null,o.isDataValid=!!this.inputCellData.getIsDataValid(),o.dataBar=this.inputCellData.getDataBar(),o.hyperlinkType=this.inputCellData.getHyperlinkType(),o.hyperlink=this.inputCellData.getHyperlink(),o},t.getFilterVisibleBorderRange=function(){return this.filterVisibleBorderRange},t.getCellOffset=function(e){var t,r,i=null===(r=null===(t=e.lines)||void 0===t?void 0:t[0])||void 0===r?void 0:r.offsetX;if(!i)return i=0;if(i<0){if(e.horizontalAlign.value===Te.HORIZONTAL_ALIGN.RIGHT)return Math.abs(i);i=0}return i},(0,o.Z)(e,[{key:"rowHeadWidth",get:function(){return n.vf}},{key:"colHeadHeight",get:function(){return n.gU}}]),e}(),He=Ae,ze=r("../node_modules/@babel/runtime/helpers/esm/toConsumableArray.js"),Oe=function(e){this.api=e};function Le(e,t,r,i,o,n,s){var a,l,c=r?t:e,d=r?e:t,h=i.getDiagBorderStyle(n,o,!0),u=i.getDiagBorderStyle(n,o,!1),f=i.getDiagBorderStyle(n+1,o,!0),g=i.getDiagBorderStyle(n+1,o,!1);return r?(a=i.getVerticalBorderStyle(o-1,n-1),l=i.getVerticalBorderStyle(o-1,n)):(a=i.getVerticalBorderStyle(o-1,n),l=i.getVerticalBorderStyle(o-1,n+1)),function(e,t,r,i,o,n,s,a){a||((e&&r===Ie.j.DOUBLE||!e&&t===Ie.j.DOUBLE)&&(n.x+=2),(e&&i===Ie.j.DOUBLE||!e&&o===Ie.j.DOUBLE)&&(s.x+=2))}(r,h,u,f,g,c,d,s),a===Ie.j.DOUBLE&&l===Ie.j.DOUBLE?(c.x+=1,d.x+=1):a===Ie.j.DOUBLE||l===Ie.j.DOUBLE?function(e,t,r,i,o){t!==Ie.j.DOUBLE&&r===Ie.j.DOUBLE?e?(i.x+=1,o.x-=1):(i.x-=1,o.x+=1):t===Ie.j.DOUBLE&&r!==Ie.j.DOUBLE&&(e?(i.x-=1,o.x+=1):(i.x+=1,o.x-=1))}(r,a,l,c,d):a===Ie.j.NONE&&l===Ie.j.NONE||(c.x+=1,d.x+=1),{innerLineStartPoint:c,outerLineStartPoint:d}}function Be(e,t,r,i,o,n,s){var a,l,c=r?t:e,d=r?e:t,h=i.getDiagBorderStyle(n,o,!0),u=i.getDiagBorderStyle(n,o,!1),f=i.getDiagBorderStyle(n+1,o,!0),g=i.getDiagBorderStyle(n+1,o,!1);return r?(a=i.getVerticalBorderStyle(o,n-1),l=i.getVerticalBorderStyle(o,n)):(a=i.getVerticalBorderStyle(o,n),l=i.getVerticalBorderStyle(o,n+1)),function(e,t,r,i,o,n,s,a){a||((e&&t===Ie.j.DOUBLE||!e&&r===Ie.j.DOUBLE)&&(n.x-=2),(e&&o===Ie.j.DOUBLE||!e&&i===Ie.j.DOUBLE)&&(s.x-=2))}(r,h,u,f,g,c,d,s),a===Ie.j.DOUBLE&&l===Ie.j.DOUBLE?(c.x-=1,d.x-=1):a!==Ie.j.DOUBLE&&l!==Ie.j.DOUBLE||function(e,t,r,i,o){t!==Ie.j.DOUBLE&&r===Ie.j.DOUBLE?e?(i.x-=1,o.x+=1):(i.x+=1,o.x-=1):t===Ie.j.DOUBLE&&r!==Ie.j.DOUBLE&&(e?(i.x+=1,o.x-=1):(i.x-=1,o.x+=1))}(r,a,l,c,d),{innerLineEndPoint:c,outerLineEndPoint:d}}function Pe(e,t,r,i,o,n,s,a,l){a+=1;var c=function(e,t,r,i,o,n){var s,a,l,c={x:e,y:t};r?(s=i.getHorizontalBorderStyle(n-1,o-1),a=i.getVerticalBorderStyle(o-1,n-1),l=i.getVerticalBorderStyle(o-1,n)):(s=i.getHorizontalBorderStyle(n,o-1),a=i.getVerticalBorderStyle(o-1,n),l=i.getVerticalBorderStyle(o-1,n+1));var d=0;return s===Ie.j.DOUBLE&&(d+=1),a===Ie.j.DOUBLE&&(d+=1),l===Ie.j.DOUBLE&&(d+=1),a!==Ie.j.DOUBLE&&l!==Ie.j.DOUBLE||1!==d?d>1&&(c.x+=1):c.x-=1,c}(i-=.5,o,t,r,n,s),d=function(e,t,r,i,o,n){var s,a,l,c={x:e,y:t};r?(s=i.getHorizontalBorderStyle(n-1,o+1),a=i.getVerticalBorderStyle(o,n-1),l=i.getVerticalBorderStyle(o,n)):(s=i.getHorizontalBorderStyle(n,o+1),a=i.getVerticalBorderStyle(o,n),l=i.getVerticalBorderStyle(o,n+1));var d=0;return s===Ie.j.DOUBLE&&(d+=1),a===Ie.j.DOUBLE&&(d+=1),l===Ie.j.DOUBLE&&(d+=1),a!==Ie.j.DOUBLE&&l!==Ie.j.DOUBLE||1!==d?d>1&&(c.x-=1):c.x+=1,c}(i+a,o,t,r,n,s);e.lineCollector.collect({lineProp:l,line:[c.x,c.y,d.x,d.y]})}function je(e,t,r,i,o,n,s){var a,l,c=r?t:e,d=r?e:t,h=i.getDiagBorderStyle(n,o,!0),u=i.getDiagBorderStyle(n,o,!1),f=i.getDiagBorderStyle(n,o-1,!0),g=i.getDiagBorderStyle(n,o+1,!1);return r?(a=i.getHorizontalBorderStyle(n-1,o-1),l=i.getHorizontalBorderStyle(n-1,o)):(a=i.getHorizontalBorderStyle(n-1,o),l=i.getHorizontalBorderStyle(n-1,o+1)),function(e,t,r,i,o,n,s,a){a||((e&&r===Ie.j.DOUBLE||!e&&t===Ie.j.DOUBLE)&&(n.y+=3),(e&&i===Ie.j.DOUBLE||!e&&o===Ie.j.DOUBLE)&&(s.y+=3))}(r,h,u,f,g,c,d,s),a===Ie.j.DOUBLE&&l===Ie.j.DOUBLE?(c.y+=1,d.y+=1):a!==Ie.j.DOUBLE&&l!==Ie.j.DOUBLE||function(e,t,r,i,o){t!==Ie.j.DOUBLE&&r===Ie.j.DOUBLE?e?(i.y+=1,o.y-=1):(i.y-=1,o.y+=1):t===Ie.j.DOUBLE&&r!==Ie.j.DOUBLE&&(e?(i.y-=1,o.y+=1):(i.y+=1,o.y-=1))}(r,a,l,c,d),{innerLineStartPoint:c,outerLineStartPoint:d}}function Me(e,t,r,i,o,n,s){var a,l,c=r?t:e,d=r?e:t,h=i.getDiagBorderStyle(n,o,!0),u=i.getDiagBorderStyle(n,o,!1),f=i.getDiagBorderStyle(n,o-1,!1),g=i.getDiagBorderStyle(n,o+1,!0);return r?(a=i.getHorizontalBorderStyle(n,o-1),l=i.getHorizontalBorderStyle(n,o)):(a=i.getHorizontalBorderStyle(n,o),l=i.getHorizontalBorderStyle(n,o+1)),function(e,t,r,i,o,n,s,a){a||((e&&t===Ie.j.DOUBLE||!e&&r===Ie.j.DOUBLE)&&(n.y-=3),(e&&i===Ie.j.DOUBLE||!e&&o===Ie.j.DOUBLE)&&(s.y-=3))}(r,h,u,f,g,c,d,s),a===Ie.j.DOUBLE&&l===Ie.j.DOUBLE?(c.y-=1,d.y-=1):a===Ie.j.DOUBLE&&l===Ie.j.DOUBLE?function(e,t,r,i,o){t!==Ie.j.DOUBLE&&r===Ie.j.DOUBLE?e?(i.y-=1,o.y+=1):(i.y+=1,o.y-=1):t===Ie.j.DOUBLE&&r!==Ie.j.DOUBLE&&(e?(i.y+=1,o.y-=1):(i.y-=1,o.y+=1))}(r,a,l,c,d):a===Ie.j.NONE&&l===Ie.j.NONE||(c.y-=1,d.y-=1),{innerLineEndPoint:c,outerLineEndPoint:d}}function ke(e,t,r,i,o,n,s,a,l){a+=1;var c=function(e,t,r,i,o,n){var s,a,l,c={x:e,y:t};r?(s=i.getVerticalBorderStyle(o-1,n-1),a=i.getHorizontalBorderStyle(n-1,o-1),l=i.getHorizontalBorderStyle(n-1,o)):(s=i.getVerticalBorderStyle(o,n-1),a=i.getHorizontalBorderStyle(n-1,o),l=i.getHorizontalBorderStyle(n-1,o+1));var d=0;return s===Ie.j.DOUBLE&&(d+=1),a===Ie.j.DOUBLE&&(d+=1),l===Ie.j.DOUBLE&&(d+=1),a!==Ie.j.DOUBLE&&l!==Ie.j.DOUBLE||1!==d?d>1&&(c.y+=1):c.y-=1,c}(i,o-=.5,t,r,n,s),d=function(e,t,r,i,o,n){var s,a,l,c={x:e,y:t};r?(s=i.getVerticalBorderStyle(o-1,n+1),a=i.getHorizontalBorderStyle(n,o-1),l=i.getHorizontalBorderStyle(n,o)):(s=i.getVerticalBorderStyle(o,n+1),a=i.getHorizontalBorderStyle(n,o),l=i.getHorizontalBorderStyle(n,o+1));var d=0;return s===Ie.j.DOUBLE&&(d+=1),a===Ie.j.DOUBLE&&(d+=1),l===Ie.j.DOUBLE&&(d+=1),a!==Ie.j.DOUBLE&&l!==Ie.j.DOUBLE||1!==d?d>1&&(c.y-=1):c.y+=1,c}(i,o+a,t,r,n,s);e.lineCollector.collect({lineProp:l,line:[c.x,c.y,d.x,d.y]})}function Fe(e,t,r,i,o,n,s,a,l,c){var d=t?{x:i+a,y:o}:{x:i+a,y:o+l},h=function(e,t,r,i,o){var n,s=e.x,a=e.y;return t?(n=r.getVerticalBorderStyle(o,i-1),r.getHorizontalBorderStyle(i,o)===Ie.j.DOUBLE&&(a-=1),n===Ie.j.DOUBLE&&(s+=1)):(n=r.getVerticalBorderStyle(o,i-1),r.getHorizontalBorderStyle(i,o-1)===Ie.j.DOUBLE&&(a+=1),n===Ie.j.DOUBLE&&(s+=1)),{x:s,y:a}}(t?{x:i,y:o+l}:{x:i,y:o},t,r,n,s),u=function(e,t,r,i,o){var n,s=e.x,a=e.y;return t?(n=r.getVerticalBorderStyle(o,i),r.getHorizontalBorderStyle(i,o-1)===Ie.j.DOUBLE&&(a+=1),n===Ie.j.DOUBLE&&(s-=1)):(n=r.getVerticalBorderStyle(o,i),r.getHorizontalBorderStyle(i,o)===Ie.j.DOUBLE&&(a-=1),n===Ie.j.DOUBLE&&(s-=1)),{x:s,y:a}}(d,t,r,n,s);e.lineCollector.collect({lineProp:c,line:[h.x,h.y,u.x,u.y]})}function Ve(e,t,r,i,o,n,s,a,l,c,d){var h=t?{x:i+a-2,y:o}:{x:i+a,y:o+l-2},u=t?{x:i+a,y:o+2}:{x:i+a-2,y:o+l},f=function(e,t,r,i,o,n){var s,a={x:e.x,y:e.y},l={x:t.x,y:t.y};return r?(s=i.getVerticalBorderStyle(o-1,n),i.getHorizontalBorderStyle(n,o)===Ie.j.DOUBLE&&(l.x+=1.5,l.y-=1),s===Ie.j.DOUBLE&&(a.x+=1,a.y-=1)):(s=i.getVerticalBorderStyle(o-1,n),i.getHorizontalBorderStyle(n-1,o)===Ie.j.DOUBLE&&(a.x+=1.5,a.y+=1),s===Ie.j.DOUBLE&&(l.x+=1,l.y+=1)),{upperStartPoint:a,lowerStartPoint:l}}(t?{x:i,y:o+l-2}:{x:i+2,y:o},t?{x:i+2,y:o+l}:{x:i,y:o+2},t,r,n,s),g=f.upperStartPoint,p=f.lowerStartPoint,_=function(e,t,r,i,o,n){var s,a={x:e.x,y:e.y},l={x:t.x,y:t.y};return r?(s=i.getVerticalBorderStyle(o,n),i.getHorizontalBorderStyle(n-1,o)===Ie.j.DOUBLE&&(a.x-=1.5,a.y+=1),s===Ie.j.DOUBLE&&(l.x-=1,l.y+=1)):(s=i.getVerticalBorderStyle(o,n),i.getHorizontalBorderStyle(n,o)===Ie.j.DOUBLE&&(l.x-=1.5,l.y-=1),s===Ie.j.DOUBLE&&(a.x-=1,a.y-=1)),{upperEndPoint:a,lowerEndPoint:l}}(h,u,t,r,n,s),v=_.upperEndPoint,w=_.lowerEndPoint;if(d){var m={x:(g.x+v.x)/2-1.5,y:t?(v.y+g.y)/2+1:(v.y+g.y)/2-1},C={x:(g.x+v.x)/2+1.5,y:t?(v.y+g.y)/2-1:(v.y+g.y)/2+1},y={x:(p.x+w.x)/2-1.5,y:t?(p.y+w.y)/2+1:(w.y+p.y)/2-1},R={x:(p.x+w.x)/2+1.5,y:t?(w.y+p.y)/2-1:(w.y+p.y)/2+1};e.lineCollector.collect({lineProp:c,line:[g.x,g.y,m.x,m.y]}),e.lineCollector.collect({lineProp:c,line:[C.x,C.y,v.x,v.y]}),e.lineCollector.collect({lineProp:c,line:[p.x,p.y,y.x,y.y]}),e.lineCollector.collect({lineProp:c,line:[R.x,R.y,w.x,w.y]})}else e.lineCollector.collect({lineProp:c,line:[g.x,g.y,v.x,v.y]}),e.lineCollector.collect({lineProp:c,line:[p.x,p.y,w.x,w.y]})}function Ne(e,t,r,i,o,n,s,a,l){a.style===Ie.j.DOUBLE?function(e,t,r,i,o,n,s,a,l,c){var d={x:(i-=.5)+(a+=1),y:o-1},h={x:i+a,y:o+1},u=Le({x:i,y:o-1},{x:i,y:o+1},t,r,n,s,c),f=u.innerLineStartPoint,g=u.outerLineStartPoint,p=Be(d,h,t,r,n,s,c),_=p.innerLineEndPoint,v=p.outerLineEndPoint;e.lineCollector.collect({lineProp:l,line:[f.x,f.y,_.x,_.y]}),e.lineCollector.collect({lineProp:l,line:[g.x,g.y,v.x,v.y]})}(e,!1,t,r,i,o,n,s,a,l):Pe(e,!1,t,r,i,o,n,s,a)}function Ze(e,t,r,i,o,n,s,a,l){a.style===Ie.j.DOUBLE?function(e,t,r,i,o,n,s,a,l,c){var d={x:i-1,y:(o-=.5)+(a+=1)},h={x:i+1,y:o+a},u=je({x:i-1,y:o},{x:i+1,y:o},t,r,n,s,c),f=u.innerLineStartPoint,g=u.outerLineStartPoint,p=Me(d,h,t,r,n,s,c),_=p.innerLineEndPoint,v=p.outerLineEndPoint;e.lineCollector.collect({lineProp:l,line:[f.x,f.y,_.x,_.y]}),e.lineCollector.collect({lineProp:l,line:[g.x,g.y,v.x,v.y]})}(e,!1,t,r,i,o,n,s,a,l):ke(e,!1,t,r,i,o,n,s,a)}var Ue=r("../spread-sheet/src/core/view/spreadsheet-view/render-manager/alloy-excel/table/body/cell-renders/impl/image-cell-render.ts"),We=r("../spread-sheet/src/core/view/spreadsheet-view/render-manager/alloy-excel/table/body/cell-renders/base-cell-render.ts"),Ge=r("../spread-sheet/src/core/view/spreadsheet-view/model/line/segment/TagSegment.ts"),Ye=r("../packages/model/src/cell/format/Color.ts"),Xe=function(e){function t(t,r){var i;return(i=e.call(this,t)||this).transformTable=t,r&&(i.spreadsheet=r),i}(0,i.Z)(t,e);var r=t.prototype;return r.renderText=function(e,t){var r=this,i=t.transformCell,o=t.x,n=t.y,s=t.cellWidth,a=t.cellHeight,l=i.lines,c=void 0===l?[]:l,d=i.cell,h=[o,n,s-d.paddingRight,a];c.forEach((function(t){var i=t.offsetX,l=t.offsetY,c=0;t.segments.forEach((function(t){var d,u,f=t.size,g=t.text,p=t.bgColor,_=t.textProp,v=f.width,w=f.height,m=c+o+i,C=n+l,y=Ge.Gy.MARGIN,R=Ge.Gy.PADDING_X,x=Ge.Gy.RADIUS,D=C-.75*w+y,E={fillColor:Ye.Z.getColorHexCode(p,r.spreadsheet)||""};if("#ffffff"===Ye.Z.getColorHexCode(p,r.spreadsheet)&&(E.borderWidth=1,E.strokeColor="rgba(0,0,0,0.08)"),_[fe.M.STRIKETHROUGH]){var S=Math.round(w/4);d=[m+1+R,C-S,m+v-1-R,C-S]}_[fe.M.UNDERLINE]&&(u=[m+1+R,C+2,m+v-1-R,C+2]),e.roundRectCollector.collect({roundRectInfo:{rect:[m+y,D,v-2*y,w-2*y],radius:x,clipInfo:h||[o,n,s,a]},roundRectProp:E}),e.textCollector.collect({textInfo:{pos:[m+y+R,D+.75*(w-2*y)],text:g,clipInfo:h||void 0,strikethroughInfo:d,underlineInfo:u},textPropHash:_.hash}),c+=v}))}))},r.renderTextCheck=function(e){return e.metadataConfig.withColor},t}(We.Z),Ke=Xe,Je=r("../spread-sheet/src/core/view/spreadsheet-view/render-manager/alloy-excel/table/body/cell-renders/util.ts"),Qe=new Image;Qe.src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgaGVpZ2h0PSIxNiIgZmlsbC1ydWxlPSJldmVub2RkIj48cmVjdCBmaWxsPSIjMWU2ZmZmIiB4PSIuNSIgeT0iLjUiIHdpZHRoPSIxNSIgaGVpZ2h0PSIxNSIgcng9IjIiIHN0cm9rZT0iIzFlNmZmZiIvPjxwYXRoIGQ9Ik02LjY0IDkuNkwxMS45IDQgMTMgNS4xNjggNi41NyAxMiAzIDguMjA0bDEuMTctMS4yNDJ6IiBmaWxsPSIjZmZmIi8+PC9zdmc+";var $e=new Image;$e.src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgaGVpZ2h0PSIxNiI+PHJlY3QgeD0iLjUiIHk9Ii41IiB3aWR0aD0iMTUiIGhlaWdodD0iMTUiIHJ4PSIyIiBmaWxsPSIjZmZmIiBzdHJva2U9IiMwMDAiIGZpbGwtcnVsZT0iZXZlbm9kZCIgc3Ryb2tlLW9wYWNpdHk9Ii4xNiIvPjwvc3ZnPg==";var qe=function(e){function t(){return e.apply(this,arguments)||this}(0,i.Z)(t,e);var r=t.prototype;return r.renderText=function(e,t){var r=t.x,i=t.y,o=t.cellWidth,n=t.cellHeight,s=t.transformCell,a=s.horizontalAlign,l=s.verticalAlign,c=s.cell,d=o-1,h=n-1,u=e.bitmapCollector,f=x.K,g=f,p=(0,Je.F)({cellWidth:d,cellHeight:h,dWidth:f,dHeight:g,horizontalAlign:a,verticalAlign:l,marginX:x.Kw,marginY:x.Kw}),_=p.dx,v=p.dy;u.collect({dx:r+_,dy:i+v,dWidth:f,dHeight:g,img:(null===c||void 0===c?void 0:c.content)===x.Nf?Qe:$e,clipInfo:[r,i,d,h]})},r.renderTextCheck=function(e){var t,r=null===(t=e.transformCell.cell)||void 0===t?void 0:t.content;return r===x.$$||r===x.Nf},t}(We.Z),et=qe,tt=(r("../node_modules/core-js/modules/es.regexp.constructor.js"),r("../node_modules/core-js/modules/es.regexp.to-string.js"),r("../node_modules/@tencent/docs-design-resources/mobile/svg/star-unfill-48.svg")),rt=r("../node_modules/@tencent/docs-design-resources/mobile/svg/star-fill-48.svg"),it=new Image;it.src=rt;var ot=new Image;ot.src=tt;var nt=new RegExp("^["+x.KH+x.E+"]+$"),st=function(e){function t(){return e.apply(this,arguments)||this}(0,i.Z)(t,e);var r=t.prototype;return r.renderText=function(e,t){var r=t.x,i=t.y,o=t.cellWidth,n=t.cellHeight,s=t.transformCell,a=s.horizontalAlign,l=s.verticalAlign,c=s.cell,d=null===c||void 0===c?void 0:c.content;if(d){var h=o-1,u=n-1,f=e.bitmapCollector,g=x.gb+2*x.$S,p=g*d.length,_=g,v=(0,Je.F)({cellWidth:h,cellHeight:u,dWidth:p,dHeight:_,horizontalAlign:a,verticalAlign:l,marginX:x.L6,marginY:x.L6}),w=v.dx,m=v.dy,C=[r,i,h,u];Array.prototype.forEach.call(d,(function(e,t){f.collect({dx:r+w+x.$S*(2*t+1)+x.gb*t,dy:i+m+x.$S,dWidth:x.gb,dHeight:x.gb,img:e===x.KH?it:ot,clipInfo:C})}))}},r.renderTextCheck=function(e){var t;return nt.test((null===(t=e.transformCell.cell)||void 0===t?void 0:t.content)||"")},t}(We.Z),at=function(e){function t(){return e.apply(this,arguments)||this}(0,i.Z)(t,e);var r=t.prototype;return r.renderBackground=function(e,t){var r,i,o=t.x,s=t.y,a=t.cellWidth,l=t.cellHeight,c=t.transformCell,d=c.cell,h=c.background,u=c.verticalAlign,f=c.horizontalAlign;if(d&&d.content){var g=(0,Je.G)(d.content||""),p=a-1,_=l-1,v=[o,s,p-d.paddingRight,_],w=null!==(r=d.paddingLeft)&&void 0!==r?r:n.J9.left,m=p-w-(null!==(i=d.paddingRight)&&void 0!==i?i:n.J9.right),C=x.$O,y=Math.max(m*g/100,2*C),R=o+w,D=(0,Je.F)({cellWidth:p,cellHeight:_,dWidth:y,dHeight:x.E8,horizontalAlign:f,verticalAlign:u,marginX:w,marginY:2}).dy;e.roundRectCollector.collect({roundRectInfo:{rect:[R,s+D,y,x.E8],radius:C,clipInfo:v},roundRectProp:{fillColor:"#00c29c"}}),e.graphicsCollector.collect({color:h.hex,graphicsInfo:{path:[o,s,o+p,s,o+p,s+_,o,s+_]}})}},r.renderBackgroundCheck=function(e){return this.checkRenderValid(e)},r.checkRenderValid=function(e){var t,r=e.transformCell,i=(null===(t=r.cell)||void 0===t?void 0:t.content)||"";return!(!(0,Je.G)(i)||!r.isDataValid)},t}(We.Z),lt=function(){function e(e,t){var r;this.cellRenders=((r={})[x.ZP.CHECKBOX]=new et(e),r[x.ZP.SELECT]=new Ke(e,t),r[x.ZP.IMAGE]=new Ue.ZP(e),r[x.ZP.STAR]=new st(e),r[x.ZP.PROGRESS]=new at(e),r)}return e.prototype.getRender=function(e){return this.cellRenders[e]},e}(),ct=lt,dt=r("../spread-sheet/src/core/view/spreadsheet-view/render-manager/alloy-excel/table/body/customize-textprop/customize-textprop.ts"),ht=function(){function e(e,t,r){this._afterCellRenderData={row:0,col:0,y:0,x:0},this._renderedMergeCells=[],this._renderedCoverCells=[],this._table=e,this._onAfterCellRender=t,this.spreadsheet=r,this.cellRenderManager=new ct(e.api,r)}var t=e.prototype;return t.collect=function(e,t,r,i,o,n){this._table.ctx.textBaseline="alphabetic",this._table.ctx.textAlign="left",this._renderedMergeCells=[],this._renderedCoverCells=[];var s,a,l=this._table.api.rowHeadWidth+n,c=this._table.api.colHeadHeight+o,d=l,h=c;for(this._table.api.refreshFilterVisibleBorderRange(),s=e;s<=t;s++)if(d=l,!this._table.api.isRowHidden(s)){for(a=r;a<=i;a++)this._table.api.isColHidden(a)||(this._collectCell(d,h,s,a),d+=this._table.api.getColWidth(a));h+=this._table.api.getRowHeight(s)}return[l,c,d-l,h-c]},t.clearRect=function(e){var t;(t=this._table.ctx).clearRect.apply(t,(0,ze.Z)(e))},t._collectCell=function(e,t,r,i){var o=this._table.api.getCellDataAtPosition(r,i),n=this._table.api.getColWidth(i),s=this._table.api.getRowHeight(r),a=this._table.api.getCellBackgroundWidth(r,i),l=this._table.api.getCellBackgroundHeight(r,i);if(o.mergeData){if(this._hasRenderedMergeCell(r,i))return;this._addRenderedMergeCell(r,i)}else{if(o.mergeParent)return void this._renderMergeCellViceCell(e,t,r,i,o.mergeParent);if(o.coverParents)return this._renderBackground(o,e,t,a,l),this.renderBorder(r,i,o,e,t,n,s,!0,!0),this._renderHiddenCell(e,t,r,i,o.coverParents),this._afterCellRenderData.row=r,this._afterCellRenderData.col=i,this._afterCellRenderData.y=t,this._afterCellRenderData.x=e,void this._onAfterCellRender.fire(this._afterCellRenderData);if(o.isCover){if(this._hasRenderedCoverCell(r,i))return;this._addRenderedCoverCell(r,i)}}var c=o.metadata,d=o.isPrivate,h=o.isCanNotRead,u=c&&this.cellRenderManager.getRender(c.customDataType),f={row:r,col:i,transformCell:o,x:e,y:t,cellWidth:a,cellHeight:l,metadataConfig:null===c||void 0===c?void 0:c.config};d||h||!(null===u||void 0===u?void 0:u.renderTextCheck(f))?this._renderText(r,i,o,e,t,a,l):u.renderText(this._table.collectEngine,f),d||h||!(null===u||void 0===u?void 0:u.renderBackgroundCheck(f))?this._renderBackground(o,e,t,a,l):u.renderBackground(this._table.collectEngine,f),o.mergeData?this.renderMergeCellBorder(e,t,r,i,o.mergeData):this.renderBorder(r,i,o,e,t,n,s,!0,!0),this._afterCellRenderData.row=r,this._afterCellRenderData.col=i,this._afterCellRenderData.y=t,this._afterCellRenderData.x=e,this._onAfterCellRender.fire(this._afterCellRenderData)},t._hasRenderedMergeCell=function(e,t){return this._renderedMergeCells.indexOf(e+":"+t)>=0},t._addRenderedMergeCell=function(e,t){this._renderedMergeCells.push(e+":"+t)},t._hasRenderedCoverCell=function(e,t){return this._renderedCoverCells.indexOf(e+":"+t)>=0},t._addRenderedCoverCell=function(e,t){this._renderedCoverCells.push(e+":"+t)},t._renderMergeCellViceCell=function(e,t,r,i,o){var n=r+o.y,s=i+o.x;if(!this._hasRenderedMergeCell(n,s)){for(var a=e,l=t,c=r-1;c>=n;c--)this._table.api.isRowHidden(c)||(l-=this._table.api.getRowHeight(c));for(var d=i-1;d>=s;d--)this._table.api.isColHidden(d)||(a-=this._table.api.getColWidth(d));this._collectCell(a,l,n,s),this._addRenderedMergeCell(n,s)}},t._renderHiddenCell=function(e,t,r,i,o){for(var n=0;n<o.length;n++){var s=o[n];if(this._hasRenderedCoverCell(s.rowIndex,s.colIndex))break;if(this._table.api.isColHidden(s.colIndex))return;var a=e;if(i<s.colIndex)for(var l=i;l<s.colIndex;l++)a+=this._table.api.getColWidth(l);else for(var c=i-1;c>=s.colIndex;c--)a-=this._table.api.getColWidth(c);this._collectCell(a,t,s.rowIndex,s.colIndex),this._addRenderedCoverCell(s.rowIndex,s.colIndex)}},t.renderMergeCellBorder=function(e,t,r,i,o){var n,s,a,l=e,c=t,d=this._table.api.getRowHeight(r),h=this._table.api.getColWidth(i);for(a=r;a<r+o.rowCount;a++)if(!this._table.api.isRowHidden(a)){for(h=this._table.api.getRowHeight(a),l=e,s=i;s<i+o.colCount;s++)this._table.api.isColHidden(s)||(d=this._table.api.getColWidth(s),r<a&&a<r+o.rowCount-1&&s!==i&&s!==i+o.colCount-1||(n=this._table.api.getCellDataAtPosition(a,s),this.renderBorder(a,s,n,l,c,d,h,!1,!0)),l+=d);c+=h}n=this._table.api.getCellDataAtPosition(r,i),this.renderBorder(r,i,n,e,t,l-e,c-t,!0,!0)},t.renderBorder=function(e,t,r,i,o,n,s,a,l){var c,d,h,u,f,g;(null===(c=r.borderRight)||void 0===c?void 0:c.style)&&Ze(this._table.collectEngine,this._table.api,i+n,o,t,e,s,r.borderRight,l),(null===(d=r.borderBottom)||void 0===d?void 0:d.style)&&Ne(this._table.collectEngine,this._table.api,i,o+s,t,e,n,r.borderBottom,l),a&&(null===(h=r.borderDiagDown)||void 0===h?void 0:h.style)&&function(e,t,r,i,o,n,s,a,l,c){l.style===Ie.j.DOUBLE?Ve(e,!1,t,r,i,o,n,s,a,l,c):Fe(e,!1,t,r,i,o,n,s,a,l)}(this._table.collectEngine,this._table.api,i,o,t,e,n,s,r.borderDiagDown,(null===(u=r.borderDiagUp)||void 0===u?void 0:u.style)===Ie.j.DOUBLE),a&&(null===(f=r.borderDiagUp)||void 0===f?void 0:f.style)&&function(e,t,r,i,o,n,s,a,l,c){l.style===Ie.j.DOUBLE?Ve(e,!0,t,r,i,o,n,s,a,l,c):Fe(e,!0,t,r,i,o,n,s,a,l)}(this._table.collectEngine,this._table.api,i,o,t,e,n,s,r.borderDiagUp,(null===(g=r.borderDiagDown)||void 0===g?void 0:g.style)===Ie.j.DOUBLE)},t._renderBackground=function(e,t,r,i,o){this._table.collectEngine.graphicsCollector.collect({color:e.background.hex,graphicsInfo:{path:[t,r,t+i,r,t+i,r+o,t,r+o]}})},t._renderText=function(e,t,r,i,o,n,s){var a=r.lines,l=r.dataBar,c=r.metadata;if(a&&a.length&&!(null===l||void 0===l?void 0:l.hideData)&&(null===c||void 0===c?void 0:c.customDataType)!==x.ZP.DATE_REMINDER)for(var d=this._table.api.getClipInfo(e,t,i,o,n,s),h=0;h<a.length;h++){var u=a[h],f=i+u.offsetX,g=o+u.offsetY;if(!(g-3*u.height/4>>0<o+s))break;for(var p=0;p<u.segments.length;p++){var _=u.segments[p],v=_.size.width;if(_.customRender)_.customRender(r,f,g,d,this._table.collectEngine);else{var w={pos:[f,g],text:_.text};d&&(w.clipInfo=d);var m=_.size.height,C=(0,dt.d)(r,_.textProp,this.spreadsheet),y=C.hash,R=C.underline;if(C.strikethrough&&_.textProp[fe.M.STRIKETHROUGH]){var D=Math.round(m/4);w.strikethroughInfo=[f,g-D,f+v,g-D]}R&&_.textProp[fe.M.UNDERLINE]&&(w.underlineInfo=[f,g+2,f+v,g+2]),this._table.collectEngine.textCollector.collect({textInfo:w,textPropHash:y})}f+=v}}},e}(),ut=ht,ft=r("../spread-sheet/src/core/view/spreadsheet-view/render-manager/alloy-excel/Default.ts"),gt=r("../spread-sheet/src/core/view/spreadsheet-view/model/TextProp.ts"),pt=r("../spread-sheet/src/base/config/font.ts"),_t=function(){function e(e,t,r){this._temp=[0,0,0,0],this._endX=0,this._afterColHeadRenderData={col:0,x:0},this._table=e,this._onAfterColRender=t,this.spreadsheet=r}var t=e.prototype;return t.collect=function(e,t,r){var i=this._table.api.rowHeadWidth+r;this._collectColHead(e,t,i),this._table.ctx.clearRect(Math.max(0,i),0,this._endX-Math.max(0,i),this._table.api.colHeadHeight)},t._setTemp=function(e,t,r,i){this._temp[0]=e,this._temp[1]=t,this._temp[2]=r,this._temp[3]=i},t._collectColHead=function(e,t,r){var i,o,n=this._table.api.colHeadHeight;for(this._setTemp(0,0,this._table.width,0),this._table.collectEngine.lineCollector.collect({lineProp:ft.Z.LINE,line:this._temp}),i=e;i<t;i++)if(!this._table.api.isColHidden(i)){if(this._afterColHeadRenderData.col=i,this._afterColHeadRenderData.x=r,(o=this._table.api.getColMeta(i)).borderLeft&&(this._setTemp(r,0,r,n),this._table.collectEngine.lineCollector.collect({lineProp:o.borderLeft,line:this._temp})),o.borderBottom){var s=o.fitLineExpand||0;this._setTemp(r-s,n-o.borderBottom.width+1,r+o.width+s,n-o.borderBottom.width+1),this._table.collectEngine.lineCollector.collect({lineProp:o.borderBottom,line:this._temp})}this._setTemp(r,0,o.width,n),this._table.collectEngine.graphicsCollector.collect({color:o.background.hex,graphicsInfo:{path:[r,0,r+o.width,0,r+o.width,n,r,n]}}),this._table.collectEngine.textCollector.collect({textPropHash:gt.Z.newInstance({fontFamily:pt.em,fontSize:ft.Z.DIMENSION_FONT_SIZE,color:m.Z.newInstanceByHex(o.color.hex)},this.spreadsheet).hash,textInfo:{text:this._table.api.getColContent(i),pos:[r+o.width/2,n/2]}}),r+=o.width,o.borderRight&&(this._setTemp(r,0,r,n),this._table.collectEngine.lineCollector.collect({lineProp:o.borderRight,line:this._temp})),this._onAfterColRender.fire(this._afterColHeadRenderData)}this._endX=r,this._setTemp(0,n,this._endX,n),this._table.collectEngine.lineCollector.collect({lineProp:ft.Z.LINE,line:this._temp})},e}(),vt=_t,wt=function(){function e(e,t,r){this._temp=[0,0,0,0],this._endY=0,this._afterRowHeadRenderData={row:0,y:0},this._table=e,this._onAfterRowRender=t,this.spreadsheet=r}var t=e.prototype;return t.collect=function(e,t,r){var i=this._table.api.colHeadHeight+r;this._collectRowHead(e,t,i),this._table.ctx.clearRect(0,Math.max(0,i),this._table.api.rowHeadWidth,this._endY-Math.max(0,i))},t._setTemp=function(e,t,r,i){this._temp[0]=e,this._temp[1]=t,this._temp[2]=r,this._temp[3]=i},t._collectRowHead=function(e,t,r){var i,o,n=this._table.api.rowHeadWidth;for(this._setTemp(0,0,0,this._table.height),this._table.collectEngine.lineCollector.collect({lineProp:ft.Z.LINE,line:this._temp}),i=e;i<t;i++)if(!this._table.api.isRowHidden(i)){if(this._afterRowHeadRenderData.row=i,this._afterRowHeadRenderData.y=r,(o=this._table.api.getRowMeta(i)).borderTop&&(this._setTemp(0,r,n,r),this._table.collectEngine.lineCollector.collect({lineProp:o.borderTop,line:this._temp})),o.borderRight){var s=o.fitLineExpand||0;this._setTemp(n-o.borderRight.width+1,r-s,n-o.borderRight.width+1,r+o.height+s),this._table.collectEngine.lineCollector.collect({lineProp:o.borderRight,line:this._temp})}this._table.collectEngine.graphicsCollector.collect({color:o.background.hex,graphicsInfo:{path:[0,r,n,r,n,r+o.height,0,r+o.height]}}),this._table.collectEngine.textCollector.collect({textPropHash:gt.Z.newInstance({fontFamily:pt.em,fontSize:ft.Z.DIMENSION_FONT_SIZE,color:m.Z.newInstanceByHex(o.color.hex)},this.spreadsheet).hash,textInfo:{text:this._table.api.getRowContent(i),pos:[n/2,r+o.height/2]}}),r+=o.height,o.borderBottom&&(this._setTemp(0,r,n,r),this._table.collectEngine.lineCollector.collect({lineProp:o.borderBottom,line:this._temp})),this._onAfterRowRender.fire(this._afterRowHeadRenderData)}this._endY=r,this._setTemp(n,0,n,this._endY),this._table.collectEngine.lineCollector.collect({lineProp:ft.Z.LINE,line:this._temp})},e}(),mt=wt,Ct=r("../spread-sheet/src/core/view/spreadsheet-view/render-manager/alloy-excel/table/corner/utils/render-path.ts"),yt=r("../spread-sheet/src/core/view/spreadsheet-view/render-manager/alloy-excel/table/corner/utils/render-color.ts"),Rt=function(){function e(e,t){this._temp=[0,0,0,0],this._table=e,this._onAfterCornerRender=t}var t=e.prototype;return t.collect=function(){this._collectBackground(),this._collectLine(),this.collectTriangle(),this._table.ctx.clearRect(0,0,this._table.api.rowHeadWidth,this._table.api.colHeadHeight),this._onAfterCornerRender.fire()},t._setTemp=function(e,t,r,i){this._temp[0]=e,this._temp[1]=t,this._temp[2]=r,this._temp[3]=i},t._collectLine=function(){var e=this._table.api,t=e.colHeadHeight,r=e.rowHeadWidth;this._setTemp(r,0,r,t),this._table.collectEngine.lineCollector.collect({lineProp:ft.Z.LINE,line:this._temp}),this._setTemp(r,t,0,t),this._table.collectEngine.lineCollector.collect({lineProp:ft.Z.LINE,line:this._temp})},t._collectBackground=function(){var e=this._table.api,t=e.rowHeadWidth,r=e.colHeadHeight;this._table.collectEngine.graphicsCollector.collect({color:yt.Et.hex,graphicsInfo:{path:(0,Ct.au)(t,r)}})},t.collectTriangle=function(){var e=this._table.api,t=e.rowHeadWidth,r=e.colHeadHeight,i=(0,Ct.ns)(t,r);this._table.collectEngine.graphicsCollector.collect({color:yt.a8.hex,graphicsInfo:{path:i}})},e}(),xt=Rt,Dt=(r("../node_modules/core-js/modules/es.array.sort.js"),r("../spread-sheet/src/core/view/spreadsheet-view/render-manager/alloy-excel/canvas/renderer/BaseRenderer.ts")),Et=(r("../node_modules/core-js/modules/es.string.replace.js"),function(){function e(){}return e.compare=function(t,r){void 0===e._colorLevel[t]&&(e._colorLevel[t]=e._getLevel(t)),void 0===e._colorLevel[r]&&(e._colorLevel[r]=e._getLevel(r));var i=e._colorLevel[t],o=e._colorLevel[r];return i>o?-1:i===o?0:1},e._getLevel=function(e){var t=function(e){e.indexOf("#")>-1&&(e=e.replace("#",""));var t=1;3===e.length?e=e[0]+e[0]+e[1]+e[1]+e[2]+e[2]:4===e.length?(t=parseInt(e[3]+e[3],16)/255,e=e[0]+e[0]+e[1]+e[1]+e[2]+e[2]):8===e.length&&(t=parseInt(e[6]+e[7],16)/255,e=e.substring(0,6));var r=parseInt(e,16);return{red:r>>16,green:r>>8&255,blue:255&r,alpha:t}}(e);return 299*t.red+587*t.green+114*t.blue},e}());Et._colorLevel={};var St=Et,It=function(){function e(e,t,r){this._width=e,this._style=t,this._color=r}e.newInstance=function(t){var r,i=t.split("-"),o=Number(i[0]),n=Number(i[1]),s=i[2];return(r=this._pool.shift())?(r._width=n,r._style=o,r._color=s):r=new e(n,o,s),r},e.destroyInstance=function(e){this._pool.push(e)};var t=e.prototype;return t.getDashSegments=function(){var e;switch(this._style){case Ie.j.HAIR:e=[1,1];break;case Ie.j.DOTTED:e=[2,2];break;case Ie.j.DASH_DOT_DOT:case Ie.j.MEDIUM_DASH_DOT_DOT:e=[3,3,3,3,9,3];break;case Ie.j.DASH_DOT:case Ie.j.MEDIUM_DASH_DOT:case Ie.j.SLANTED_DASH_DOT:e=[3,3,9,3];break;case Ie.j.DASHED:e=[3,3];break;case Ie.j.MEDIUM_DASHED:e=[9,3];break;case Ie.j.NONE:case Ie.j.THIN:case Ie.j.MEDIUM:case Ie.j.THICK:case Ie.j.DOUBLE:default:e=[]}return e},t.getStyle=function(){return this._style},t.getWidth=function(){var e=Ie.v.NONE;switch(this._style){case Ie.j.THIN:case Ie.j.DASH_DOT:case Ie.j.DASH_DOT_DOT:case Ie.j.DASHED:case Ie.j.DOTTED:case Ie.j.HAIR:case Ie.j.DOUBLE:e=Ie.v.THIN;break;case Ie.j.MEDIUM:case Ie.j.MEDIUM_DASHED:case Ie.j.MEDIUM_DASH_DOT:case Ie.j.MEDIUM_DASH_DOT_DOT:case Ie.j.SLANTED_DASH_DOT:e=Ie.v.MEDIUM;break;case Ie.j.THICK:e=Ie.v.THICK;break;case Ie.j.NONE:default:e=Ie.v.NONE}return e},t.getColor=function(){return this._color},t.compare=function(e){var t=this._compareStylePriority(e);return 0===t?this._compareColorPriority(e):t},t._compareStylePriority=function(e){return re[this._style]-re[e._style]},t._compareColorPriority=function(e){return St.compare(this._color,e.getColor())},e}();It._pool=[];var bt=It,Tt=function(e){function t(){return e.apply(this,arguments)||this}(0,i.Z)(t,e);var r=t.prototype;return r.render=function(e,t){this._ctx=t;var r=e.renderInfos,i=Object.keys(r);if(i&&i.length){var o,n;this._ctx.translate(-.5,-.5),i.sort(this._sortFunc);for(var s=0;s<i.length;s++)o=i[s],n=bt.newInstance(o),this._prepareRenderContext(n),this._renderLine(r[o]),bt.destroyInstance(n);this._ctx.setLineDash([]),this._ctx.translate(.5,.5)}},r._prepareRenderContext=function(e){this._ctx.strokeStyle=e.getColor(),this._ctx.lineWidth=e.getWidth(),this._ctx.setLineDash(e.getDashSegments())},r._renderLine=function(e){this._ctx.beginPath();for(var t=0,r=0;r<e.length;++r){var i=e[r];this._ctx.moveTo(i[0],i[1]);for(var o=2;o<i.length;o+=2)this._ctx.lineTo(i[o],i[o+1]);t>1e3?(t=0,this._ctx.stroke(),this._ctx.beginPath()):t+=1}this._ctx.stroke()},r._sortFunc=function(e,t){var r=bt.newInstance(e),i=bt.newInstance(t),o=r.compare(i);return bt.destroyInstance(r),bt.destroyInstance(i),o},t}(Dt.ZP),At=Tt,Ht=function(e){function t(){return e.apply(this,arguments)||this}(0,i.Z)(t,e);var r=t.prototype;return r.render=function(e,t){this._ctx=t;for(var r,i,o,n=e.renderInfos,s=Object.keys(n),a=0;a<s.length;a++){r=s[a],this._prepareRenderContext(r),i=n[r];for(var l=0;l<i.length;l++)(o=i[l]).clipInfo&&(this._ctx.save(),this._ctx.beginPath(),this._ctx.rect(o.clipInfo[0],o.clipInfo[1],o.clipInfo[2],o.clipInfo[3]),this._ctx.clip()),this._renderText(o),this._renderUnderlineAndStrikethrough(o),o.clipInfo&&this._ctx.restore()}},r._prepareRenderContext=function(e){var t=e.split(gt.L),r=t[0],i=t[1],o=Number(t[2])||0;r&&(this._ctx.font=r),i&&(this._ctx.fillStyle=i,this._ctx.strokeStyle=i),o&&(this._ctx.lineWidth=Math.max(1,o))},r._renderText=function(e){this._ctx.beginPath(),this._ctx.fillText(e.text,e.pos[0],e.pos[1]),this._ctx.closePath()},r._renderUnderlineAndStrikethrough=function(e){e.underlineInfo&&this._renderLine(e.underlineInfo),e.strikethroughInfo&&this._renderLine(e.strikethroughInfo)},r._renderLine=function(e){this._ctx.beginPath(),this._ctx.moveTo(e[0],e[1]),this._ctx.lineTo(e[2],e[3]),this._ctx.stroke()},t}(Dt.ZP),zt=Ht,Ot=function(e){function t(){return e.apply(this,arguments)||this}(0,i.Z)(t,e);var r=t.prototype;return r.render=function(e,t){var r=this;this._ctx=t;var i=e.renderInfos;i.canvasPatternInfo.forEach((function(e){r._ctx.fillStyle=e.canvasPattern,r._renderGraphics({path:e.path,clipInfo:e.clipInfo})}));var o=Object.keys(i.colorInfo);if(o&&o.length)for(var n,s,a=0;a<o.length;a++)if(s=o[a],null===(n=i.colorInfo[s])||void 0===n?void 0:n.length){this._ctx.fillStyle=s;for(var l=0;l<n.length;l++)this._renderGraphics(n[l])}},r._renderGraphics=function(e){var t;e.clipInfo&&(this._ctx.save(),this._ctx.beginPath(),(t=this._ctx).rect.apply(t,(0,ze.Z)(e.clipInfo)),this._ctx.clip());var r=e.path;this._ctx.beginPath(),this._ctx.moveTo(r[0],r[1]);for(var i=2;i<r.length;i+=2)this._ctx.lineTo(r[i],r[i+1]);this._ctx.closePath(),this._ctx.fill(),e.clipInfo&&this._ctx.restore()},t}(Dt.ZP),Lt=Ot,Bt=function(e){function t(){return e.apply(this,arguments)||this}(0,i.Z)(t,e);var o=t.prototype;return o.render=function(e,t){var r=this;this._ctx=t,e.renderInfos.forEach((function(e){return r.renderBitmap(e)}))},o.renderBitmap=function(e){var t,i=e.clipInfo,o=e.sx,n=e.sy,s=e.sWidth,a=e.sHeight,l=e.dWidth,c=e.dHeight,d=e.img,h=e.dx,u=e.dy;if(d&&this._ctx){i&&(this._ctx.save(),this._ctx.beginPath(),this._ctx.rect(i[0],i[1],i[2],i[3]),this._ctx.clip());try{void 0!==o&&void 0!==n&&void 0!==s&&void 0!==a&&void 0!==l&&void 0!==c?this._ctx.drawImage(d,o,n,s,a,h,u,l,c):void 0!==l&&void 0!==c?this._ctx.drawImage(d,h,u,l,c):this._ctx.drawImage(d,h,u)}catch(f){null===(t=r.g.log)||void 0===t||t.info(f)}i&&this._ctx.restore()}},t}(Dt.ZP),Pt=Bt,jt=function(e){function t(){return e.apply(this,arguments)||this}(0,i.Z)(t,e);var r=t.prototype;return r.render=function(e,t){this._ctx=t;for(var r=e.renderInfos,i=0;i<r.length;i++){var o=r[i].roundRectProp,n=r[i].roundRectInfo;this._prepareRenderContext(o),this._drawSingleRoundRect(o,n)}},r._prepareRenderContext=function(e){this._ctx.lineWidth=e.borderWidth||1,e.fillColor&&(this._ctx.fillStyle=e.fillColor),e.strokeColor&&(this._ctx.strokeStyle=e.strokeColor)},r._drawSingleRoundRect=function(e,t){var r,i=t.rect,o=t.radius,n=t.clipInfo;n&&(this._ctx.save(),this._ctx.beginPath(),(r=this._ctx).rect.apply(r,(0,ze.Z)(n)),this._ctx.clip());var s=[i[0]+o,i[1]],a=[i[0]+i[2],i[1]],l=[i[0]+i[2],i[1]+i[3]],c=[i[0],i[1]+i[3]],d=[i[0],i[1]];this._ctx.beginPath(),this._ctx.moveTo(s[0],s[1]),this._ctx.arcTo(a[0],a[1],l[0],l[1],o),this._ctx.arcTo(l[0],l[1],c[0],c[1],o),this._ctx.arcTo(c[0],c[1],d[0],d[1],o),this._ctx.arcTo(d[0],d[1],s[0],s[1],o),e.strokeColor&&this._ctx.stroke(),e.shadowInfo&&(e.shadowInfo.shadowColor&&(this._ctx.shadowColor=e.shadowInfo.shadowColor),e.shadowInfo.shadowOffsetX&&(this._ctx.shadowOffsetX=e.shadowInfo.shadowOffsetX),e.shadowInfo.shadowOffsetY&&(this._ctx.shadowOffsetY=e.shadowInfo.shadowOffsetY),e.shadowInfo.shadowBlur&&(this._ctx.shadowBlur=e.shadowInfo.shadowBlur),this._ctx.stroke(),this._ctx.shadowColor="",this._ctx.shadowOffsetX=0,this._ctx.shadowOffsetY=0,this._ctx.shadowBlur=0),e.fillColor&&this._ctx.fill(),n&&this._ctx.restore()},t}(Dt.ZP),Mt=jt,kt=function(e){function t(){return e.apply(this,arguments)||this}(0,i.Z)(t,e);var r=t.prototype;return r.render=function(e,t){var r=this;this._ctx=t;var i=e.renderInfos;Object.keys(i).forEach((function(e){r.renderPath2d(i[e])}))},r.renderPath2d=function(e){var t=this,r=null;e.forEach((function(e){r||(r=new Path2D(e.path2d)),t.beforeFillPath(e),t._ctx.fill(r,e.fillRule||"evenodd"),t.afterFillPath(e)}))},r.beforeFillPath=function(e){var t,r,i,o=e.fillStyle,n=e.translate,s=e.scale,a=e.clipInfo;this._ctx.fillStyle=o,a&&(this._ctx.save(),this._ctx.beginPath(),(t=this._ctx).rect.apply(t,(0,ze.Z)(a)),this._ctx.clip()),(n||s)&&this._ctx.save(),n&&(r=this._ctx).translate.apply(r,(0,ze.Z)(n)),s&&(i=this._ctx).scale.apply(i,(0,ze.Z)(s))},r.afterFillPath=function(e){var t=e.translate,r=e.scale,i=e.clipInfo;(t||r)&&this._ctx.restore(),i&&this._ctx.restore()},t}(Dt.ZP),Ft=kt,Vt=r("../spread-sheet/src/core/view/spreadsheet-view/render-manager/alloy-excel/canvas/collector/BitmapCollector.ts"),Nt=r("../spread-sheet/src/core/view/spreadsheet-view/render-manager/alloy-excel/canvas/collector/GraphicsCollector.ts"),Zt=r("../spread-sheet/src/core/view/spreadsheet-view/render-manager/alloy-excel/canvas/collector/LineCollector.ts"),Ut=r("../spread-sheet/src/core/view/spreadsheet-view/render-manager/alloy-excel/canvas/collector/TextCollector.ts"),Wt=r("../spread-sheet/src/core/view/spreadsheet-view/render-manager/alloy-excel/canvas/collector/RoundRectCollector.ts"),Gt=r("../spread-sheet/src/core/view/spreadsheet-view/render-manager/alloy-excel/canvas/collector/Path2dCollector.ts"),Yt=function(){function e(e){this._ctx=e,this._lineRenderer=new At,this._textRenderer=new zt,this._graphicsRender=new Lt,this._bitmapRenderer=new Pt,this._roundRectRenderer=new Mt,this._path2dRenderer=new Ft}return e.prototype.render=function(e,t){var r=this;e.collectors.forEach((function(e){switch(e.constructor){case Vt.Z:r._bitmapRenderer.render(e,t);break;case Nt.Z:r._graphicsRender.render(e,t);break;case Zt.Z:r._lineRenderer.render(e,t);break;case Ut.Z:r._textRenderer.render(e,t);break;case Wt.Z:r._roundRectRenderer.render(e,t);break;case Gt.Z:r._path2dRenderer.render(e,t);break;default:return}}))},e}(),Xt=r("../spread-sheet/src/core/view/spreadsheet-view/render-manager/alloy-excel/canvas/CollectEngine.ts"),Kt=function(e){function t(t,r,i,o){var n;return(n=e.call(this,r)||this).onAfterCellRenderEmitter=new S.Q5,n.onAfterAreaRenderEmitter=new S.Q5,n.onAfterRowHeadRenderEmitter=new S.Q5,n.onAfterColHeadRenderEmitter=new S.Q5,n.onAfterCornerRenderEmitter=new S.Q5,n._afterAreaRenderEventData={fromRow:0,toRow:0,fromCol:0,toCol:0,offsetX:0,offsetY:0},n.onAfterAreaRender=n.onAfterAreaRenderEmitter.event,n.onAfterCellRender=n.onAfterCellRenderEmitter.event,n.onAfterRowHeadRender=n.onAfterRowHeadRenderEmitter.event,n.onAfterColHeadRender=n.onAfterColHeadRenderEmitter.event,n.onAfterCornerRender=n.onAfterCornerRenderEmitter.event,n.spreadsheet=o,n._matrix=i,n._initStage(t),n._initRenderEngine(),n._initCollectEngine(),n._initContent(),n}(0,i.Z)(t,e);var r=t.prototype;return r.resize=function(){var e=this._container.offsetWidth,t=this._container.offsetHeight;this._width=e,this._height=t,Jt(this._canvas,e,t);var r=this._matrix;this._ctx.setTransform(r.a*window.devicePixelRatio,r.b*window.devicePixelRatio,r.c*window.devicePixelRatio,r.d*window.devicePixelRatio,r.e*window.devicePixelRatio,r.f*window.devicePixelRatio)},r.clear=function(){this._ctx.clearRect(0,0,this.canvas.width/Math.min(1,this._matrix.a),this.canvas.height/Math.min(1,this._matrix.d))},r.applyMatrixToCanvas=function(e){this._matrix=e,this._ctx.setTransform(e.a*window.devicePixelRatio,e.b*window.devicePixelRatio,e.c*window.devicePixelRatio,e.d*window.devicePixelRatio,e.e*window.devicePixelRatio,e.f*window.devicePixelRatio)},r.renderRowHead=function(e,t,r){void 0===r&&(r=0),this._ctx.save(),this._ctx.textBaseline="middle",this._ctx.textAlign="center",this._rowHead.collect(e,t,r),this.renderEngine.render(this._collectEngine,this._ctx),this._ctx.restore(),this._collectEngine.clear()},r.renderColHead=function(e,t,r){void 0===r&&(r=0),this._ctx.save(),this._ctx.textBaseline="middle",this._ctx.textAlign="center",this._colHead.collect(e,t,r),this._renderEngine.render(this._collectEngine,this._ctx),this._ctx.restore(),this._collectEngine.clear()},r.renderCorner=function(){this._corner.collect(),this.renderEngine.render(this._collectEngine,this._ctx),this._collectEngine.clear()},r.renderCells=function(e,t,r,i,o,n,s,a){void 0===o&&(o=0),void 0===n&&(n=0);var l=a||{},c=l.ctx,d=l.collectOption;if(c){this.switchCtx(c);var h=this._matrix;c.setTransform(h.a*window.devicePixelRatio,h.b*window.devicePixelRatio,h.c*window.devicePixelRatio,h.d*window.devicePixelRatio,h.e*window.devicePixelRatio,h.f*window.devicePixelRatio)}d&&this._collectEngine.setCollectOption(d);var u=this._body.collect(e,t,r,i,o,n);this._body.clearRect(u),this._afterAreaRenderEventData.fromRow=e,this._afterAreaRenderEventData.toRow=t,this._afterAreaRenderEventData.fromCol=r,this._afterAreaRenderEventData.toCol=i,this._afterAreaRenderEventData.offsetY=o,this._afterAreaRenderEventData.offsetX=n,this.onAfterAreaRenderEmitter.fire(this._afterAreaRenderEventData),this.renderEngine.render(this._collectEngine,this._ctx),this.switchCtx(this._ctx_default),this._collectEngine.clear()},r.scrollRenderCells=function(e,t,r,i,o,n,s,a){var l;void 0===o&&(o=0),void 0===n&&(n=0);var c=a||{},d=c.ctx,h=c.collectOption;d&&this.switchCtx(d),h&&this._collectEngine.setCollectOption(h);var u=this._body.collect(e,t,r,i,o,n);this._ctx.save(),this._ctx.beginPath(),(l=this._ctx).rect.apply(l,(0,ze.Z)(s)),this._ctx.clip(),this._ctx.closePath(),this._body.clearRect(u),this._afterAreaRenderEventData.fromRow=e,this._afterAreaRenderEventData.toRow=t,this._afterAreaRenderEventData.fromCol=r,this._afterAreaRenderEventData.toCol=i,this._afterAreaRenderEventData.offsetY=o,this._afterAreaRenderEventData.offsetX=n,this.onAfterAreaRenderEmitter.fire(this._afterAreaRenderEventData),this.renderEngine.render(this._collectEngine,this._ctx),this.switchCtx(this._ctx_default),this._collectEngine.clear(),this._ctx.restore()},r._initStage=function(e){var t=document.createElement("canvas"),r=t.getContext("2d"),i=e.offsetWidth,o=e.offsetHeight;this._width=i,this._height=o,Jt(t,i,o),e.appendChild(t),this._container=e,this._canvas=t,this._ctx=r,this._ctx_default=r,this._setupCanvasMatrix()},r._initContent=function(){this._corner=new xt(this,this.onAfterCornerRenderEmitter),this._body=new ut(this,this.onAfterCellRenderEmitter,this.spreadsheet),this._colHead=new vt(this,this.onAfterColHeadRenderEmitter,this.spreadsheet),this._rowHead=new mt(this,this.onAfterRowHeadRenderEmitter,this.spreadsheet)},r._setupCanvasMatrix=function(){this._matrix.reset(),this.applyMatrixToCanvas(this._matrix)},r._initRenderEngine=function(){this._renderEngine=new Yt(this.ctx)},r._initCollectEngine=function(){this._collectEngine=new Xt.Z(this.spreadsheet)},r.switchCtx=function(e){this._ctx=e||this._ctx_default},(0,o.Z)(t,[{key:"canvas",get:function(){return this._canvas}},{key:"ctx",get:function(){return this._ctx}},{key:"width",get:function(){return this._width}},{key:"height",get:function(){return this._height}},{key:"container",get:function(){return this._container}},{key:"renderEngine",get:function(){return this._renderEngine}},{key:"collectEngine",get:function(){return this._collectEngine}}]),t}(Oe);function Jt(e,t,r){var i=window.devicePixelRatio||1,o=Math.round(t*i),n=Math.round(r*i);e.setAttribute("width",String(o)),e.setAttribute("height",String(n)),e.style.width=o/i+"px",e.style.height=n/i+"px"}var Qt,$t=Kt;function qt(e,t,r,i){var o=r.row.frozen.viewSize,n=r.row.flow.viewSize,s=r.col.frozen.viewSize,a=r.col.flow.viewSize;return[i.rowHeadWidth+(t===Qt.FROZEN?0:s),i.colHeadHeight+(e===Qt.FROZEN?0:o),t===Qt.FROZEN?s:a,e===Qt.FROZEN?o:n]}function er(e){if(function(e){return e%1===0}(e))return e;var t=Math.floor(e),r=e-t,i=Math.floor(100*r);return i<=20?t:i>=70?t+1:t+.5}r("../node_modules/core-js/modules/es.number.is-integer.js"),function(e){e[e.FROZEN=0]="FROZEN",e[e.FLOW=1]="FLOW"}(Qt||(Qt={}));var tr,rr=r("../spread-sheet/src/base/util/mobile.ts"),ir=r("../spread-sheet/src/external/report/alloyreport.ts"),or=k().isFirefox,nr=function(){function e(e){var t=this;this.scrollRender=function(){if(t.isNeedRepaint())return{isNeedRepaint:!0};var e=t.alloyExcel.ctx;e.save(),e.setTransform(1,0,0,1,0,0);var r=t.scrollRowsRender(),i=r.repaintY,o=r.repaintHeight,n=t.scrollColsRender(),s=n.repaintX,a=n.repaintWidth;return e.restore(),t.renderScrollMultipleRows(i,o),t.renderScrollMultipleCols(s,a),t.clearRectBottomArea(),t.clearRectRightArea(),t.areaData.row.flow.offsetDiff=0,t.areaData.col.flow.offsetDiff=0,{isNeedRepaint:!1}},this.scrollRowsRender=function(){var e={repaintY:0,repaintHeight:0},r=t.areaData.row.flow.offsetDiff;if(0===(r*=t.scrollRenderRatio))return e;var i=t.transformTable.colHeadHeight*t.scrollRenderRatio,o=t.alloyExcel.canvas.width-0,n=r<0&&t.areaData.row.flow.padding>0,s=t.areaData.row.flow.viewSize*t.scrollRenderRatio-Math.abs(r)-(n?0:t.areaData.row.flow.padding*t.scrollRenderRatio),a=o,l=s,c=i,d=i;return r<0?(d=(c+=t.areaData.row.frozen.viewSize*t.scrollRenderRatio+2*t.scrollRenderRatio)-r,e.repaintY=c-2*t.scrollRenderRatio,e.repaintHeight=d-e.repaintY+2*t.scrollRenderRatio):r>0&&(c=(d+=t.areaData.row.frozen.viewSize*t.scrollRenderRatio)+r,e.repaintY=d+l-2*t.scrollRenderRatio,e.repaintHeight=t.alloyExcel.canvas.height-e.repaintY),t.drawCanvasImage(0,c,o,s,0,d,a,l),e.repaintY=e.repaintY/t.scrollRenderRatio,e.repaintHeight=e.repaintHeight/t.scrollRenderRatio,e},this.scrollColsRender=function(){var e={repaintX:0,repaintWidth:0},r=t.areaData.col.flow.offsetDiff;if(0===(r*=t.scrollRenderRatio))return e;var i=t.transformTable.rowHeadWidth*t.scrollRenderRatio,o=t.areaData.col.flow.viewSize*t.scrollRenderRatio-Math.abs(r),n=t.alloyExcel.canvas.height-0,s=o,a=n,l=i,c=i;return r<0?(c=(l+=t.areaData.col.frozen.viewSize*t.scrollRenderRatio+2*t.scrollRenderRatio)-r,e.repaintX=l-2*t.scrollRenderRatio,e.repaintWidth=c-e.repaintX+2*t.scrollRenderRatio):r>0&&(l+=t.areaData.col.frozen.viewSize*t.scrollRenderRatio+r,c+=t.areaData.col.frozen.viewSize*t.scrollRenderRatio,e.repaintX=c+s-2*t.scrollRenderRatio,e.repaintWidth=Math.abs(r)+2*t.scrollRenderRatio),t.drawCanvasImage(l,0,o,n,c,0,s,a),e.repaintX=e.repaintX/t.scrollRenderRatio,e.repaintWidth=e.repaintWidth/t.scrollRenderRatio,e},this.drawCanvasImage=function(e,r,i,o,n,s,a,l){e=er(e),r=er(r),i=er(i),o=er(o),n=er(n),s=er(s),a=er(a),l=er(l);var c=t.alloyExcel.ctx,d=e+i-c.canvas.width,h=r+o-c.canvas.height;(d>2||h>2)&&(0,ir.ji)({level:ir.y8.INFO,moduleValue:"scrollrender",actionValue:"canvasCalcError",detail:[e,i,c.canvas.width,r,o,c.canvas.height]}),d>0&&(a=i=c.canvas.width-e),h>0&&(l=o=c.canvas.height-r),c.drawImage(t.alloyExcel.canvas,e,r,i,o,n,s,a,l)},this.renderScrollMultipleRows=function(e,r){if(!(e<0||r<0)&&(0!==e||0!==r)){var i=function(e,t,r,i){for(var o=r.row.frozen,n=o.viewSize,s=o.to,a=r.row.flow,l=a.offsetSize,c=a.from,d={fromRow:s,toRow:s},h=e+l-n-i.colHeadHeight,u=h+t,f=r.row.flow.areaTop,g=f.length,p=0;p<g;p+=1){var _=f[p];if(_<=h&&(d.fromRow+=1),_>=u)break;d.toRow+=1}return d.fromRow=-1===d.fromRow?0:d.fromRow,d.toRow=-1===d.toRow?0:d.toRow,d.fromRow=d.fromRow<c?c:d.fromRow,d.toRow=d.toRow<c?c:d.toRow,d}(e,r,t.areaData,t.transformTable),o=i.fromRow,n=i.toRow,s=t.areaData,a=s.row,l=s.col;if(!(a.frozen.renderTo>=o&&a.frozen.renderFrom<=n)){var c=t.areaData.getViewTopByRow(o),d=t.areaData.row.flow.viewSize;if(t.areaData.row.flow.offsetDiff>0){e=t.areaData.getViewTopByRow(o)+t.headSize.colHeadHeight;var h=t.areaData.row.frozen.viewSize+t.headSize.colHeadHeight;e=Math.max(h,e)}else d=t.areaData.getViewBottomByRow(n)+t.headSize.colHeadHeight-e;if(l.flow.to>=l.flow.from){var u=l.flow.renderFrom,f=Math.min(t.transformTable.getColCount()-1,l.flow.renderTo),g=t.areaData.getViewLeftByCol(u),p=qt(Qt.FLOW,Qt.FLOW,t.areaData,t.transformTable),_=[p[0],e,p[2],d];t.alloyExcel.scrollRenderCells(o,n,u,f,c,g,_)}if(l.frozen.to>=l.frozen.from){var v=l.frozen.renderFrom,w=Math.min(t.transformTable.getColCount()-1,l.frozen.renderTo),m=t.areaData.getViewLeftByCol(v),C=qt(Qt.FLOW,Qt.FROZEN,t.areaData,t.transformTable),y=[C[0],e,C[2],d];t.alloyExcel.scrollRenderCells(o,n,v,w,c,m,y)}}}},this.renderScrollMultipleCols=function(e,r){if(!(e<0||r<0)&&(0!==e||0!==r)){var i=function(e,t,r,i){for(var o=r.col.frozen,n=o.viewSize,s=o.to,a=r.col.flow,l=a.offsetSize,c=a.from,d={fromCol:s,toCol:s},h=e+l-n-i.rowHeadWidth,u=h+t,f=r.col.flow.areaLeft,g=f.length,p=0;p<g;p+=1){var _=f[p];if(_<=h&&(d.fromCol+=1),_>=u)break;d.toCol+=1}return d.fromCol=-1===d.fromCol?0:d.fromCol,d.toCol=-1===d.toCol?0:d.toCol,d.fromCol=d.fromCol<c?c:d.fromCol,d.toCol=d.toCol<c?c:d.toCol,d}(e,r,t.areaData,t.transformTable),o=i.fromCol,n=i.toCol,s=t.areaData,a=s.row,l=s.col;if(!(l.frozen.renderTo>=o&&l.frozen.renderFrom<=n)){var c=t.areaData.getViewLeftByCol(o),d=t.areaData.col.flow.viewSize;if(t.areaData.col.flow.offsetDiff>0){e=t.areaData.getViewLeftByCol(o)+t.headSize.rowHeadWidth;var h=t.areaData.col.frozen.viewSize+t.headSize.rowHeadWidth;e=Math.max(h,e)}else d=t.areaData.getViewRightByCol(n)+t.headSize.rowHeadWidth-e;if(a.flow.to>=a.flow.from){var u=a.flow.renderFrom,f=Math.min(t.transformTable.getRowCount()-1,a.flow.renderTo),g=t.areaData.getViewTopByRow(u),p=qt(Qt.FLOW,Qt.FLOW,t.areaData,t.transformTable),_=[e,p[1],d,p[3]];t.alloyExcel.scrollRenderCells(u,f,o,n,g,c,_)}if(a.frozen.to>=a.frozen.from){var v=a.frozen.renderFrom,w=Math.min(t.transformTable.getRowCount()-1,a.frozen.renderTo),m=t.areaData.getViewTopByRow(v),C=qt(Qt.FROZEN,Qt.FLOW,t.areaData,t.transformTable),y=[e,C[1],d,C[3]];t.alloyExcel.scrollRenderCells(v,w,o,n,m,c,y)}}}},this.isNeedRepaint=function(){return!!t.disableScrollRender||!!k().isMiniProgram||!(!or&&!rr.x9)||!(!k().isPC||!t.isPcNeedRepaint())||!(!k().isMobilePhone||!t.isMobileNeedRepaint())||t.commonCheck()},this.isPcNeedRepaint=function(){return!1},this.isMobileNeedRepaint=function(){if(0!==t.areaData.col.flow.offsetDiff)return!0;var e=t.areaData.row.flow.padding;if(t.mobileRowPadding!==e)return t.mobileRowPadding=e,!0;var r=t.scale.scale;return.85!==r&&.65!==r||!(0,ye.gr)()},this.commonCheck=function(){return!t.spreadsheet.activeSheet.isLoaded||(t.isFirstTimeRender?(t.isFirstTimeRender=!1,!0):!!t.isScaleOrPixelRatioChange()||t.isScrollTooMuch())},this.isScaleOrPixelRatioChange=function(){var e=t.scale.scale;return!(!k().isPC||1===e)||(t.currentScale!==e?(t.currentScale=e,!0):t.devicePixelRatio!==r.g.devicePixelRatio&&(t.devicePixelRatio=r.g.devicePixelRatio,!0))},this.isScrollTooMuch=function(){var e=t.areaData.row.flow.padding,r=t.areaData.row.flow,i=r.offsetDiff,o=r.viewSize;if(Math.abs(i)+2+e>=o)return!0;var n=t.areaData.col.flow,s=n.offsetDiff,a=n.viewSize;return Math.abs(s)+2>=a},this.alloyExcel=e.alloyExcel,this.areaData=e.areaData,this.transformTable=e.transformTable,this.scale=e.scale,this.mobileRowPadding=this.areaData.row.flow.padding,this.currentScale=this.scale.scale,this.spreadsheet=e.spreadsheet,this.isFirstTimeRender=!0,this.disableScrollRender=""!==(0,ye.IZ)("disableScrollRender"),this.devicePixelRatio=r.g.devicePixelRatio,this.headSize=e.headSize}var t=e.prototype;return t.clearRectBottomArea=function(){k().isPC?this.clearPcRectBottomArea():(k().isAndroidPad||k().isIPad)&&this.clearPadRectBottomArea()},t.clearPcRectBottomArea=function(){if(this.areaData.row.flow.offsetDiff>0){var e=this.areaData.row.flow.offsetSize-this.areaData.row.flow.maxOffsetSize+this.areaData.row.flow.safeDistance;if(e>0){var t=this.areaData.row.flow.viewSize+this.areaData.row.frozen.viewSize+this.transformTable.colHeadHeight-e,r=this.areaData.col.flow.viewSize+this.areaData.col.frozen.viewSize+this.transformTable.rowHeadWidth,i=e;this.alloyExcel.ctx.clearRect(0,t,r,i)}}},t.clearPadRectBottomArea=function(){var e=this.areaData.row.flow,t=e.padding,r=e.renderTo,i=e.areaTop,o=e.offsetSize;if(t>0){var n=this.areaData.row.flow.viewSize+this.areaData.row.frozen.viewSize+this.transformTable.colHeadHeight,s=this.areaData.col.flow.viewSize+this.areaData.col.frozen.viewSize+this.transformTable.rowHeadWidth,a=i[r+1]+this.areaData.row.frozen.viewSize+this.transformTable.colHeadHeight-o,l=a,c=s,d=n-a;this.alloyExcel.ctx.clearRect(0,l,c,d)}},t.clearRectRightArea=function(){if(this.areaData.col.flow.offsetDiff>0){var e=this.areaData.col.flow.offsetSize-this.areaData.col.flow.maxOffsetSize+this.areaData.col.flow.safeDistance;if(e>0){var t=this.areaData.row.flow.viewSize+this.areaData.row.frozen.viewSize+this.transformTable.colHeadHeight,r=this.areaData.col.flow.viewSize+this.areaData.col.frozen.viewSize+this.transformTable.rowHeadWidth-e,i=e,o=t;this.alloyExcel.ctx.clearRect(r,0,i,o)}}},(0,o.Z)(e,[{key:"scrollRenderRatio",get:function(){return this.scale.scale*this.devicePixelRatio}}]),e}();!function(e){e[e.FROZEN=0]="FROZEN",e[e.FLOW=1]="FLOW"}(tr||(tr={}));var sr,ar,lr=function(e){function t(t){var r;return(r=e.call(this)||this)._onAfterRender=new S.Q5,r.renderTable=function(){r._alloyExcel.clear(),r._renderBody(),r._renderRowHead(),r._renderColHead(),r._renderCorner(),r._onAfterRender.fire()},r.renderNextTick=(0,L.kf)(r.renderTable,0),r.renderCellsOuter=function(e,t,i,o,n,s,a,l){void 0===n&&(n=0),void 0===s&&(s=0),s-=r._alloyExcel.api.rowHeadWidth,n-=r._alloyExcel.api.colHeadHeight,r._alloyExcel.renderCells(e,t,i,o,n,s,void 0,{ctx:a,collectOption:l})},r.renderRowCells=function(e){var t,i=r._areaData.row,o=r._areaData.col;if(i.frozen.renderFrom<=e&&e<=i.frozen.renderTo)t=tr.FROZEN;else{if(!(i.flow.renderFrom<=e&&e<=i.flow.renderTo))return;t=tr.FLOW}var n=r._areaData.getViewTopByRow(e);if(o.flow.to>=o.flow.from){var s=o.flow.renderFrom,a=Math.min(r._transformTable.getColCount()-1,o.flow.renderTo),l=r._areaData.getViewLeftByCol(s);r._clipBodyArea(t,tr.FLOW,(function(){r._alloyExcel.renderCells(e,e,s,a,n,l)}))}if(o.frozen.to>=o.frozen.from){var c=o.frozen.renderFrom,d=Math.min(r._transformTable.getColCount()-1,o.frozen.renderTo),h=r._areaData.getViewLeftByCol(c);r._clipBodyArea(t,tr.FROZEN,(function(){r._alloyExcel.renderCells(e,e,c,d,n,h)}))}r._renderRowHead(),r._renderColHead(),r._renderCorner(),r._onAfterRender.fire()},r.onAfterRender=r._onAfterRender.event,r._alloyExcel=t.alloyExcel,r._areaData=t.areaData,r._transformTable=t.transformTable,r._headSize=t.headSize,r._scrollRenderApi=new nr(t),r}(0,i.Z)(t,e);var r=t.prototype;return r.scrollCanvasRender=function(){this._scrollRenderApi.scrollRender().isNeedRepaint&&(this._alloyExcel.clear(),this._renderBody()),this._renderRowHead(),this._renderColHead(),this._renderCorner(),this._onAfterRender.fire()},r.renderRowHead=function(){this._alloyExcel.ctx.clearRect(0,0,this._headSize.rowHeadWidth,Number.MAX_SAFE_INTEGER),this._renderRowHead(),this._renderCorner(),this._onAfterRender.fire()},r.renderColHead=function(){this._alloyExcel.ctx.clearRect(0,0,Number.MAX_SAFE_INTEGER,this._headSize.colHeadHeight),this._renderColHead(),this._renderCorner(),this._onAfterRender.fire()},r._renderBody=function(){var e=this._areaData.row,t=this._areaData.col;e.flow.to>=e.flow.from&&(this._renderBodyArea(tr.FLOW,tr.FLOW),t.frozen.to>=t.frozen.from&&this._renderBodyArea(tr.FLOW,tr.FROZEN)),e.frozen.to>=e.frozen.from&&(this._renderBodyArea(tr.FROZEN,tr.FLOW),t.frozen.to>=t.frozen.from&&this._renderBodyArea(tr.FROZEN,tr.FROZEN))},r._renderCorner=function(){this._alloyExcel.renderCorner()},r._renderRowHead=function(){var e=this._areaData.row;this._renderRowArea(tr.FLOW),e.frozen.to>=e.frozen.from&&this._renderRowArea(tr.FROZEN)},r._renderColHead=function(){var e=this._areaData.col;this._renderColArea(tr.FLOW),e.frozen.to>=e.frozen.from&&this._renderColArea(tr.FROZEN)},r._renderBodyArea=function(e,t){var r=this,i=e===tr.FROZEN,o=t===tr.FROZEN,n=this._areaData.row[e===tr.FROZEN?"frozen":"flow"],s=this._areaData.col[t===tr.FROZEN?"frozen":"flow"],a=n.renderFrom,l=Math.min(n.to,n.renderTo),c=this._areaData.getViewTopByRow(a),d=s.renderFrom,h=Math.min(s.to,s.renderTo),u=this._areaData.getViewLeftByCol(d);if(i){var f=this._areaData.getFrozenRowInView(),g=f.fromFrozenRow,p=f.toFrozenRow;a=g,l=p}if(o){var _=this._areaData.getFrozenColInView(),v=_.fromFrozenCol,w=_.toFrozenCol;d=v,h=w}e===tr.FROZEN||t===tr.FROZEN?this._clipBodyArea(e,t,(function(){r._alloyExcel.renderCells(a,l,d,h,c,u)})):this._alloyExcel.renderCells(a,l,d,h,c,u)},r._clipBodyArea=function(e,t,r){var i,o=this._getFrozenAreaClipRect(e,t);this._alloyExcel.ctx.save(),this._alloyExcel.ctx.beginPath(),(i=this._alloyExcel.ctx).rect.apply(i,(0,ze.Z)(o)),this._alloyExcel.ctx.clip(),this._alloyExcel.ctx.closePath(),r(),this._alloyExcel.ctx.restore()},r._getFrozenAreaClipRect=function(e,t){return qt(e,t,this._areaData,this._transformTable)},r._renderRowArea=function(e){var t=this._areaData.row[e===tr.FROZEN?"frozen":"flow"],r=this._areaData.getViewTopByRow(t.renderFrom);this._alloyExcel.renderRowHead(t.renderFrom,t.renderTo+1,r)},r._renderColArea=function(e){var t=this._areaData.col[e===tr.FROZEN?"frozen":"flow"],r=this._areaData.getViewLeftByCol(t.renderFrom);this._alloyExcel.renderColHead(t.renderFrom,t.renderTo+1,r)},t}(g.JT),cr=r("../spread-sheet/src/base/event/event.ts"),dr=function(e){function t(t){var r;return(r=e.call(this)||this)._handleResize=function(){r.alloyExcel.resize(),r.renderApi.renderTable()},r._handleScale=function(){r.alloyExcel.applyMatrixToCanvas(r.scale.matrix),r.renderApi.renderNextTick()},r.container=t.container,r.resize=t.resize,r.scale=t.scale,r.transformTable=t.transformTable,r.areaData=t.areaData,r.headSize=t.headSize,r.alloyExcel=new $t(r.container,r.transformTable,r.scale.matrix,t.spreadsheet),r.renderApi=new lr({alloyExcel:r.alloyExcel,areaData:r.areaData,transformTable:r.transformTable,headSize:r.headSize,scale:r.scale,spreadsheet:t.spreadsheet}),r._register(r.resize.onResize(r._handleResize)),r._register(r.scale.onScale(r._handleScale)),r._register(r.areaData.onUpdateOffset((0,L.ad)(r.renderApi.scrollCanvasRender.bind(r.renderApi)))),cr.ZP.spreadsheetEvent.listen("renderAfterMutationRun",r.renderApi.renderNextTick),r}return(0,i.Z)(t,e),t.prototype.dispose=function(){e.prototype.dispose.call(this),cr.ZP.spreadsheetEvent.remove("renderAfterMutationRun",this.renderApi.renderNextTick)},t}(g.JT),hr=function(e){function t(t){var r;(r=e.call(this)||this)._areaData=t.areaData,r._headSize=t.headSize,r._renderManager=t.renderManager;var i=r._renderManager,o=i.renderApi,s=i.alloyExcel;return r._register(o.onAfterRender((function(){0!==r._areaData.col.frozen.displayViewSize&&(s.ctx.beginPath(),s.ctx.fillStyle="#d6d6d6",s.ctx.rect(r._headSize.rowHeadWidth+r._areaData.col.frozen.viewSize-n.kW,0,n.kW,r._headSize.colHeadHeight+r._areaData.getViewBottomByRow(r._areaData.getLastRowInView())),s.ctx.fill(),s.ctx.closePath()),0!==r._areaData.row.frozen.displayViewSize&&(s.ctx.beginPath(),s.ctx.fillStyle="#d6d6d6",s.ctx.rect(0,r._headSize.colHeadHeight+r._areaData.row.frozen.viewSize-n.kW,r._headSize.rowHeadWidth+r._areaData.getViewRightByCol(r._areaData.getLastColInView()),n.kW),s.ctx.fill(),s.ctx.closePath())}))),r}return(0,i.Z)(t,e),t}(g.JT),ur=function(e){function t(t){var r;return(r=e.call(this)||this).board=document.createElement("div"),r._container=t.container,r.board.classList.add("operate-board"),r.board.setAttribute("aria-hidden","true"),r.board.setAttribute("tabIndex","3"),r._container.appendChild(r.board),r}return(0,i.Z)(t,e),t.prototype.dispose=function(){e.prototype.dispose.call(this),this._container.removeChild(this.board)},t}(g.JT),fr=(r("../node_modules/core-js/modules/es.number.min-safe-integer.js"),r("../spread-sheet/src/core/view/spreadsheet-view/operate-context/operate-data/FingerData.ts")),gr=function(){function e(e){this.customInfo=new Map,this.startX=0,this.startY=0,this.startCol=0,this.startRow=0,this.currX=0,this.currY=0,this.currCol=0,this.currRow=0,this.diffX=0,this.diffY=0,this.startTime=0,this.endTime=0,this.fingerData=new fr.Z,this.down=!1,this._stopPropagation=!1,this.isMovingRowOrCol=!1,this.preventAutoTapFocus=!1,this._scale=e.scale}var t=e.prototype;return t.mouseDown=function(e,t,r,i,o){this._start(e,t,r,i),this.e=o},t.mouseMove=function(e,t,r,i,o){this._move(e,t,r,i),this.e=o},t.mouseUp=function(e,t,r,i,o){this._end(e,t,r,i),this.e=o},t.touchStart=function(e,t,r,i,o){this._start(e,t,r,i),this.fingerData.startFirstFinger(e,t),this.e=o},t.touchSecondFingerStart=function(e,t){this.fingerData.startSecondFinger(e,t)},t.touchMove=function(e,t,r,i,o){this._move(e,t,r,i),this.fingerData.moveFirstFinger(e,t),this.e=o},t.touchSecondFingerMove=function(e,t){this.fingerData.moveSecondFinger(e,t)},t.touchEnd=function(e,t,r,i,o){this._end(e,t,r,i),this.fingerData.endUpdateFinger(o),this.e=o},t.isHoverCell=function(){return-1!==this.currCol&&this.currCol!==Number.MAX_SAFE_INTEGER&&this.currCol!==Number.MIN_SAFE_INTEGER&&-1!==this.currRow&&this.currRow!==Number.MAX_SAFE_INTEGER&&this.currRow!==Number.MIN_SAFE_INTEGER},t.isHoverCol=function(){return-1===this.currRow&&-1!==this.currCol},t.isHoverRow=function(){return-1===this.currCol&&-1!==this.currRow},t.isOverTable=function(){return this.currCol===Number.MAX_SAFE_INTEGER||this.currCol===Number.MIN_SAFE_INTEGER||this.currRow===Number.MAX_SAFE_INTEGER||this.currRow===Number.MIN_SAFE_INTEGER},t.toString=function(){var e=this.startRow,t=this.startCol,r=this.currRow,i=this.currCol;return JSON.stringify({startRow:e,startCol:t,currRow:r,currCol:i})},t._start=function(e,t,r,i){this.stopPropagation=!1,this.customInfo.clear(),this.currX=e,this.startX=e,this.currY=t,this.startY=t,this.currCol=r,this.startCol=r,this.currRow=i,this.startRow=i,this.down=!0,this.preventAutoTapFocus=!1,this.startTime=Date.now()},t._move=function(e,t,r,i){this.diffX=e-this.currX,this.diffY=t-this.currY,this.currX=e,this.currY=t,this.currCol=r,this.currRow=i},t._end=function(e,t,r,i){this.currX=e,this.currY=t,this.currCol=r,this.currRow=i,this.down=!1,this.isMovingRowOrCol=!1,this.endTime=Date.now()},(0,o.Z)(e,[{key:"displayStartX",get:function(){return this.startX*this._scale.scale}},{key:"displayStartY",get:function(){return this.startY*this._scale.scale}},{key:"displayCurrX",get:function(){return this.currX*this._scale.scale}},{key:"displayCurrY",get:function(){return this.currY*this._scale.scale}},{key:"stopPropagation",get:function(){return this._stopPropagation},set:function(e){this._stopPropagation=e}}]),e}();!function(e){e[e.DOWN=0]="DOWN",e[e.MOVE=1]="MOVE",e[e.UP=2]="UP"}(sr||(sr={})),function(e){e[e.START=0]="START",e[e.MOVE=1]="MOVE",e[e.END=2]="END"}(ar||(ar={}));var pr=new(function(){function e(){var e=this;this.mouseHandlers=new Map,this.touchHandlers=new Map,this._handleMousedown=function(t){var r=e.mouseHandlers.get(sr.DOWN);null===r||void 0===r||r.forEach((function(e){e(t)}))},this._handleMousemove=function(t){var r=e.mouseHandlers.get(sr.MOVE);null===r||void 0===r||r.forEach((function(e){e(t)}))},this._handleMouseup=function(t){var r=e.mouseHandlers.get(sr.UP);null===r||void 0===r||r.forEach((function(e){e(t)}))},this._handleTouchstart=function(t){var r=e.touchHandlers.get(ar.START);null===r||void 0===r||r.forEach((function(e){e(t)}))},this._handleTouchmove=function(t){var r=e.touchHandlers.get(ar.MOVE);null===r||void 0===r||r.forEach((function(e){e(t)}))},this._handleTouchend=function(t){var r=e.touchHandlers.get(ar.END);null===r||void 0===r||r.forEach((function(e){e(t)}))},document.addEventListener("mousedown",this._handleMousedown,!0),document.addEventListener("mousemove",this._handleMousemove,!0),document.addEventListener("mouseup",this._handleMouseup,!0),document.addEventListener("touchstart",this._handleTouchstart,!0),document.addEventListener("touchmove",this._handleTouchmove,!0),document.addEventListener("touchend",this._handleTouchend,!0)}var t=e.prototype;return t.addMousedownHandler=function(e){this._addMouseHandler(sr.DOWN,e)},t.removeMousedownHandler=function(e){this._removeMouseHandler(sr.DOWN,e)},t.addMousemoveHandler=function(e){this._addMouseHandler(sr.MOVE,e)},t.removeMousemoveHandler=function(e){this._removeMouseHandler(sr.MOVE,e)},t.addMouseupHandler=function(e){this._addMouseHandler(sr.UP,e)},t.removeMouseupHandler=function(e){this._removeMouseHandler(sr.UP,e)},t.addTouchstartHandler=function(e){this._addTouchHandler(ar.START,e)},t.removeTouchstartHandler=function(e){this._removeTouchHandler(ar.START,e)},t.addTouchmoveHandler=function(e){this._addTouchHandler(ar.MOVE,e)},t.removeTouchmoveHandler=function(e){this._removeTouchHandler(ar.MOVE,e)},t.addTouchendHandler=function(e){this._addTouchHandler(ar.END,e)},t.removeTouchendHandler=function(e){this._removeTouchHandler(ar.END,e)},t._addMouseHandler=function(e,t){this.mouseHandlers.has(e)||this.mouseHandlers.set(e,[]),this.mouseHandlers.get(e).push(t)},t._removeMouseHandler=function(e,t){var r=this.mouseHandlers.get(e);if(r){var i=r.indexOf(t);i>=0?r.splice(i,1):console.warn("尝试移除没有绑定的 MouseHandler")}else console.warn("尝试移除没有绑定的 MouseHandler")},t._addTouchHandler=function(e,t){this.touchHandlers.has(e)||this.touchHandlers.set(e,[]),this.touchHandlers.get(e).push(t)},t._removeTouchHandler=function(e,t){var r=this.touchHandlers.get(e);if(r){var i=r.indexOf(t);i>=0?r.splice(i,1):console.warn("尝试移除没有绑定的 MouseHandler")}else console.warn("尝试移除没有绑定的 MouseHandler")},e}()),_r=function(e){function t(t){var r;return(r=e.call(this)||this)._cacheHoverData={x:0,y:0,col:0,row:0},r._handleMousedown=function(e){var t;(null===(t=r.spreadsheet)||void 0===t?void 0:t.isExternalSheet())||(r._updateHoverData(e.clientX,e.clientY),r._operateData.mouseDown(r._cacheHoverData.x,r._cacheHoverData.y,r._cacheHoverData.col,r._cacheHoverData.row,e))},r._handleMousemove=function(e){var t;(null===(t=r.spreadsheet)||void 0===t?void 0:t.isExternalSheet())||(r._updateHoverData(e.clientX,e.clientY),r._operateData.mouseMove(r._cacheHoverData.x,r._cacheHoverData.y,r._cacheHoverData.col,r._cacheHoverData.row,e))},r._handleMouseup=function(e){var t;(null===(t=r.spreadsheet)||void 0===t?void 0:t.isExternalSheet())||(r._updateHoverData(e.clientX,e.clientY),r._operateData.mouseUp(r._cacheHoverData.x,r._cacheHoverData.y,r._cacheHoverData.col,r._cacheHoverData.row,e))},r._clientRect=t.clientRect,r._headSize=t.headSize,r._areaData=t.areaData,r._scale=t.scale,r._operateData=t.operateData,r.spreadsheet=t.spreadsheet,pr.addMousedownHandler(r._handleMousedown),pr.addMousemoveHandler(r._handleMousemove),pr.addMouseupHandler(r._handleMouseup),r}(0,i.Z)(t,e);var r=t.prototype;return r.dispose=function(){e.prototype.dispose.call(this),pr.removeMousedownHandler(this._handleMousedown),pr.removeMousemoveHandler(this._handleMousemove),pr.removeMouseupHandler(this._handleMouseup)},r.calcHoverData=function(e,t){var r,i;e>this._clientRect.width?r=Number.MAX_SAFE_INTEGER:e<this._clientRect.distanceX?r=Number.MIN_SAFE_INTEGER:e<this._clientRect.distanceX+this._headSize.displayRowHeadWidth&&(r=-1),t>this._clientRect.distanceY+this._clientRect.height?i=Number.MAX_SAFE_INTEGER:t<this._clientRect.distanceY?i=Number.MIN_SAFE_INTEGER:t<this._clientRect.distanceY+this._headSize.displayColHeadHeight&&(i=-1);var o=this._scale.scale,n=t-this._clientRect.distanceY-this._headSize.displayColHeadHeight,s=e-this._clientRect.distanceX-this._headSize.displayRowHeadWidth;return isNaN(Number(r))&&isNaN(Number(i))?(i=this._areaData.getRowByDisplayViewTop(n),r=this._areaData.getColByDisplayViewLeft(s)):isNaN(Number(i))?i=this._areaData.getRowByDisplayViewTop(n):isNaN(Number(r))&&(r=this._areaData.getColByDisplayViewLeft(s)),{col:r,row:i,x:(e-this._clientRect.distanceX)/o,y:(t-this._clientRect.distanceY)/o}},r._updateHoverData=function(e,t){var r=this.calcHoverData(e,t),i=r.x,o=r.y,n=r.row,s=r.col;this._cacheHoverData.x=i,this._cacheHoverData.y=o,this._cacheHoverData.col=s,this._cacheHoverData.row=n},t}(g.JT),vr=_r,wr=function(e){function t(t){var r;return(r=e.call(this)||this)._cacheHoverData={x:0,y:0,col:0,row:0},r._handleTouchstart=function(e){var t;(null===(t=r.spreadsheet)||void 0===t?void 0:t.isExternalSheet())||(r._updateHoverData(e.touches[0].clientX,e.touches[0].clientY),r._operateData.touchStart(r._cacheHoverData.x,r._cacheHoverData.y,r._cacheHoverData.col,r._cacheHoverData.row,e),e.touches.length>1&&(r._updateHoverData(e.touches[1].clientX,e.touches[1].clientY),r._operateData.touchSecondFingerStart(r._cacheHoverData.x,r._cacheHoverData.y)))},r._handleTouchmove=function(e){var t;(null===(t=r.spreadsheet)||void 0===t?void 0:t.isExternalSheet())||(r._updateHoverData(e.touches[0].clientX,e.touches[0].clientY),r._operateData.touchMove(r._cacheHoverData.x,r._cacheHoverData.y,r._cacheHoverData.col,r._cacheHoverData.row,e),e.touches.length>1&&(r._updateHoverData(e.touches[1].clientX,e.touches[1].clientY),r._operateData.touchSecondFingerMove(r._cacheHoverData.x,r._cacheHoverData.y)))},r._handleTouchend=function(e){var t;(null===(t=r.spreadsheet)||void 0===t?void 0:t.isExternalSheet())||(r._updateHoverData(e.changedTouches[0].clientX,e.changedTouches[0].clientY),1===e.touches.length?r._updateHoverData(e.touches[0].clientX,e.touches[0].clientY):r._updateHoverData(e.changedTouches[0].clientX,e.changedTouches[0].clientY),r._operateData.touchEnd(r._cacheHoverData.x,r._cacheHoverData.y,r._cacheHoverData.col,r._cacheHoverData.row,e))},r._clientRect=t.clientRect,r._headSize=t.headSize,r._areaData=t.areaData,r._scale=t.scale,r._operateData=t.operateData,r.spreadsheet=t.spreadsheet,pr.addTouchstartHandler(r._handleTouchstart),pr.addTouchmoveHandler(r._handleTouchmove),pr.addTouchendHandler(r._handleTouchend),r}(0,i.Z)(t,e);var r=t.prototype;return r.dispose=function(){e.prototype.dispose.call(this),pr.removeTouchstartHandler(this._handleTouchstart),pr.removeTouchmoveHandler(this._handleTouchmove),pr.removeTouchendHandler(this._handleTouchend)},r._updateHoverData=function(e,t){var r,i;e>this._clientRect.width?r=Number.MAX_SAFE_INTEGER:e<this._clientRect.distanceX?r=Number.MIN_SAFE_INTEGER:e<this._clientRect.distanceX+this._headSize.displayRowHeadWidth&&(r=-1),t>this._clientRect.distanceY+this._clientRect.height?i=Number.MAX_SAFE_INTEGER:t<this._clientRect.distanceY?i=Number.MIN_SAFE_INTEGER:t<this._clientRect.distanceY+this._headSize.displayColHeadHeight&&(i=-1);var o=this._scale.scale,n=t-this._clientRect.distanceY-this._headSize.displayColHeadHeight,s=e-this._clientRect.distanceX-this._headSize.displayRowHeadWidth;isNaN(Number(r))&&isNaN(Number(i))?(i=this._areaData.getRowByDisplayViewTop(n),r=this._areaData.getColByDisplayViewLeft(s)):isNaN(Number(i))?i=this._areaData.getRowByDisplayViewTop(n):isNaN(Number(r))&&(r=this._areaData.getColByDisplayViewLeft(s)),this._cacheHoverData.x=(e-this._clientRect.distanceX)/o,this._cacheHoverData.y=(t-this._clientRect.distanceY)/o,this._cacheHoverData.col=r,this._cacheHoverData.row=i},t}(g.JT),mr=wr,Cr=function(e){function t(t){var i;return(i=e.call(this)||this).onMousedownEmitter=new S.Q5,i.onMousemoveEmitter=new S.Q5,i.onMouseupEmitter=new S.Q5,i.onContextMenuEmitter=new S.Q5,i.onDblClickEmitter=new S.Q5,i.onClickEmitter=new S.Q5,i.handleMousedown=function(){var e,t;(null===(e=i.spreadsheet)||void 0===e?void 0:e.isExternalSheet())||(null===(t=r.g.log)||void 0===t||t.info("view canvas mousedown: "+i.operateData.toString()),i.onMousedownEmitter.fire(i.operateData))},i.handleMousemove=function(){var e;(null===(e=i.spreadsheet)||void 0===e?void 0:e.isExternalSheet())||i.onMousemoveEmitter.fire(i.operateData)},i.handleMouseup=function(){var e;(null===(e=i.spreadsheet)||void 0===e?void 0:e.isExternalSheet())||i.onMouseupEmitter.fire(i.operateData)},i.handleContextMenu=function(e){var t;(null===(t=i.spreadsheet)||void 0===t?void 0:t.isExternalSheet())||(e.preventDefault(),i.onContextMenuEmitter.fire(i.operateData))},i.handleDblClick=function(e){var t,o;(null===(t=i.spreadsheet)||void 0===t?void 0:t.isExternalSheet())||(null===(o=r.g.log)||void 0===o||o.info("view canvas dblclick: "+i.operateData.toString()),e.preventDefault(),i.onDblClickEmitter.fire(i.operateData))},i.handleClick=function(){var e;(null===(e=i.spreadsheet)||void 0===e?void 0:e.isExternalSheet())||i.onClickEmitter.fire(i.operateData)},i.onMousedown=i.onMousedownEmitter.event,i.onMousemove=i.onMousemoveEmitter.event,i.onMouseup=i.onMouseupEmitter.event,i.onContextMenu=i.onContextMenuEmitter.event,i.onDblClick=i.onDblClickEmitter.event,i.onClick=i.onClickEmitter.event,i.board=t.board,i.operateData=t.operateData,i.spreadsheet=t.spreadsheet,i.addEvent(),i}(0,i.Z)(t,e);var o=t.prototype;return o.addEvent=function(){this.board.addEventListener("mousedown",this.handleMousedown),document.addEventListener("mousemove",this.handleMousemove),document.addEventListener("mouseup",this.handleMouseup),this.board.addEventListener("contextmenu",this.handleContextMenu),this.board.addEventListener("dblclick",this.handleDblClick),this.board.addEventListener("click",this.handleClick)},o.removeEvent=function(){this.board.removeEventListener("mousedown",this.handleMousedown),document.removeEventListener("mousemove",this.handleMousemove),document.removeEventListener("mouseup",this.handleMouseup),this.board.removeEventListener("contextmenu",this.handleContextMenu),this.board.removeEventListener("dblclick",this.handleDblClick),this.board.removeEventListener("click",this.handleClick)},o.dispose=function(){e.prototype.dispose.call(this),this.removeEvent()},t}(g.JT),yr=Cr,Rr=r("../spread-sheet/src/core/view/lib/tap-support.ts"),xr=function(e){function t(t){var i;return(i=e.call(this)||this).onTouchstartEvent=new S.Q5,i.onTouchmoveEvent=new S.Q5,i.onTouchendEvent=new S.Q5,i.onTapEvent=new S.Q5,i.onLongTapEvent=new S.Q5,i._handleTouchstart=function(e){var t,o;(null===(t=i.spreadsheet)||void 0===t?void 0:t.isExternalSheet())||(null===(o=r.g.log)||void 0===o||o.info("view canvas touchstart: "+i._operateData.toString()),e.preventDefault(),i.onTouchstartEvent.fire(i._operateData))},i._handleTouchmove=function(){var e;(null===(e=i.spreadsheet)||void 0===e?void 0:e.isExternalSheet())||i.onTouchmoveEvent.fire(i._operateData)},i._handleTouchend=function(){var e;(null===(e=i.spreadsheet)||void 0===e?void 0:e.isExternalSheet())||i.onTouchendEvent.fire(i._operateData)},i._handleTap=function(){var e;(null===(e=i.spreadsheet)||void 0===e?void 0:e.isExternalSheet())||(i.onTapEvent.fire(i._operateData),!k().isIPad||i._operateData.preventAutoTapFocus||i._board.contains(document.activeElement)||i._board.focus())},i._handleLongTap=function(){var e,t;(null===(e=i.spreadsheet)||void 0===e?void 0:e.isExternalSheet())||(null===(t=r.g.log)||void 0===t||t.info("view canvas longTap: "+i._operateData.toString()),i.onLongTapEvent.fire(i._operateData))},i.onTouchstart=i.onTouchstartEvent.event,i.onTouchmove=i.onTouchmoveEvent.event,i.onTouchend=i.onTouchendEvent.event,i.onLongTap=i.onLongTapEvent.event,i.onTap=i.onTapEvent.event,i._board=t.board,i._operateData=t.operateData,i.spreadsheet=t.spreadsheet,i._board.addEventListener("contextmenu",L.PF),(0,Rr.C)(i._board),i.addEvent(),i}(0,i.Z)(t,e);var n=t.prototype;return n.addEvent=function(){this._board.addEventListener("touchstart",this._handleTouchstart),document.addEventListener("touchmove",this._handleTouchmove,!1),document.addEventListener("touchend",this._handleTouchend,!1),this._board.addEventListener("tap",this._handleTap),this._board.addEventListener("longTap",this._handleLongTap)},n.removeEvent=function(){this._board.removeEventListener("touchstart",this._handleTouchstart),document.removeEventListener("touchmove",this._handleTouchmove,!1),document.removeEventListener("touchend",this._handleTouchend,!1),this._board.removeEventListener("tap",this._handleTap),this._board.removeEventListener("longTap",this._handleLongTap)},(0,o.Z)(t,[{key:"board",get:function(){return this._board}}]),t}(g.JT),Dr=xr,Er=function(e){function t(t){var r;return(r=e.call(this)||this).operateBoard=r._register(new ur({container:t.container})),r.operateData=new gr({scale:t.scale}),r.mousePrepare=r._register(new vr(Object.assign(Object.assign({},t),{operateData:r.operateData,spreadsheet:t.spreadsheet}))),r.touchPrepare=r._register(new mr(Object.assign(Object.assign({},t),{operateData:r.operateData,spreadsheet:t.spreadsheet}))),r.mouseOperate=r._register(new yr({board:r.operateBoard.board,operateData:r.operateData,spreadsheet:t.spreadsheet})),r.touchOperate=r._register(new Dr({board:r.operateBoard.board,operateData:r.operateData,spreadsheet:t.spreadsheet})),r}return(0,i.Z)(t,e),t.prototype.calcHoverData=function(e,t){return this.mousePrepare.calcHoverData(e,t)},t}(g.JT),Sr=function(e){function t(t){var r;return(r=e.call(this)||this).board=document.createElement("div"),r._tx=0,r._ty=0,r.board.classList.add("feature-board"),t.appendChild(r.board),r}(0,i.Z)(t,e);var r=t.prototype;return r.translateX=function(e){e!==this._tx&&(this._tx=e,this.board.style.transform="translate3d("+this._tx+"px, "+this._ty+"px, 0px)")},r.translateY=function(e){e!==this._ty&&(this._ty=e,this.board.style.transform="translate3d("+this._tx+"px, "+this._ty+"px, 0px)")},r.dispose=function(){this.board.remove()},t}(g.JT),Ir=function(e){function t(t){var r;return(r=e.call(this,t)||this)._board.classList.add("hidden-board"),r}return(0,i.Z)(t,e),t}(function(e){function t(t){var r;return(r=e.call(this)||this)._board=document.createElement("div"),r._board.classList.add("wrap-board"),r.featureBoard=r._register(new Sr(r._board)),t.appendChild(r._board),r}(0,i.Z)(t,e);var r=t.prototype;return r.append=function(e){this.featureBoard.board.appendChild(e)},r.remove=function(e){this.featureBoard.board.contains(e)&&this.featureBoard.board.removeChild(e)},r.dispose=function(){e.prototype.dispose.call(this),this._board.remove()},t}(g.JT));function br(e,t){if(e.left<=0&&e.width<=0||e.top<=0&&e.height<=0)return!1;var r=t.left-e.left,i=t.top-e.top;return!(r>e.width||i>e.height||r+t.width<0||i+t.height<0)}var Tr,Ar,Hr,zr=function(e){function t(t,r,i){var o;return(o=e.call(this)||this)._offsetX=0,o._offsetY=0,o._globalOffsetX=0,o._globalOffsetY=0,o._refresh=function(){var e=o._colArea.displayViewSize;Object.assign(o._board.style,{display:0===e?"none":"inline-block",width:e+"px"})},o._container=t,o._rowArea=r,o._colArea=i,o._init(),o}(0,i.Z)(t,e);var r=t.prototype;return r.refresh=function(){this._refresh()},r.setOffset=function(e,t,r,i){this._offsetX=e,this._offsetY=t,this._globalOffsetX=r,this._globalOffsetY=i},r.dispose=function(){e.prototype.dispose.call(this),this._container.removeChild(this._board)},r.isInBoard=function(e){return br({left:this.offsetX,top:this.offsetY,width:this.totalWidth,height:this.totalHeight},e)},r.isInBoardVisibleArea=function(e,t){return void 0===t&&(t=0),!(this.visibleWidth<=0||this.visibleHeight<=0)&&br({left:this._globalOffsetX+this._colArea.displayOffsetSize-t,top:this._globalOffsetY+this._rowArea.displayOffsetSize-t,width:this.visibleWidth+2*t,height:this.visibleHeight+2*t},e)},r._init=function(){this._board=document.createElement("div"),this._board.classList.add("block-board"),this._container.appendChild(this._board),this._hiddenBoard=this._register(new Ir(this._board)),this._register(this._colArea.onUpdateViewSize(this._refresh))},(0,o.Z)(t,[{key:"element",get:function(){return this._board}},{key:"hiddenBoard",get:function(){return this._hiddenBoard}},{key:"offsetX",get:function(){return this._offsetX}},{key:"offsetY",get:function(){return this._offsetY}},{key:"globalOffsetX",get:function(){return this._globalOffsetX}},{key:"globalOffsetY",get:function(){return this._globalOffsetY}},{key:"totalWidth",get:function(){return this._colArea.displayTotalSize}},{key:"totalHeight",get:function(){return this._rowArea.displayTotalSize}},{key:"visibleWidth",get:function(){return this._colArea.displayViewSize}},{key:"visibleHeight",get:function(){return this._rowArea.displayViewSize}}]),t}(g.JT),Or=function(e){function t(t,r,i){var o;return(o=e.call(this)||this)._refresh=function(){var e=o._area.displayViewSize;Object.assign(o._board.style,{display:0===e?"none":"block",height:e+"px"}),o._left.refresh(),o._right.refresh()},o._container=t,o._area=r,o._areaDataCol=i,o._init(),o}(0,i.Z)(t,e);var r=t.prototype;return r.refresh=function(){this._refresh()},r.dispose=function(){e.prototype.dispose.call(this),this._container.removeChild(this._board)},r._init=function(){this._board=document.createElement("div"),this._board.classList.add("line-board"),this._container.appendChild(this._board),this._left=this._register(new zr(this._board,this._area,this._areaDataCol.frozen)),this._right=this._register(new zr(this._board,this._area,this._areaDataCol.flow)),this._register(this._area.onUpdateViewSize(this._refresh))},(0,o.Z)(t,[{key:"left",get:function(){return this._left}},{key:"right",get:function(){return this._right}}]),t}(g.JT),Lr=function(e){function t(t){var r;return(r=e.call(this)||this).registerAfterAreaRenderOnce=function(){S.ju.once(r.renderManager.alloyExcel.onAfterAreaRender)((function(){r._handleScale()}))},r._updateAreaOffset=function(){var e=r._areaData.getDisplayGlobalLeftByCol(r._areaData.col.flow.from),t=r._areaData.getDisplayGlobalTopByRow(r._areaData.row.flow.from),i=-r._areaData.getDisplayViewLeftByCol(0),o=-r._areaData.getDisplayViewTopByRow(0);r._topLine.left.setOffset(i,o,0,0),r._topLine.right.setOffset(e,o,e,0),r._bottomLine.left.setOffset(i,t,0,t),r._bottomLine.right.setOffset(e,t,e,t)},r._refresh=function(){Object.assign(r._board.style,{top:r._headSize.displayColHeadHeight+"px",left:r._headSize.displayRowHeadWidth+"px"}),r._topLine.refresh(),r._bottomLine.refresh(),r._updateAreaOffset(),r.updateFeatureBoardTranslate()},r.updateFeatureBoardTranslate=function(){var e=-r._areaData.row.flow.displayOffsetSize;r._bottomLine.left.hiddenBoard.featureBoard.translateY(e),r._bottomLine.right.hiddenBoard.featureBoard.translateY(e);var t=-r._areaData.row.frozen.displayOffsetSize;r._topLine.left.hiddenBoard.featureBoard.translateY(t),r._topLine.right.hiddenBoard.featureBoard.translateY(t);var i=-r._areaData.col.flow.displayOffsetSize;r._topLine.right.hiddenBoard.featureBoard.translateX(i),r._bottomLine.right.hiddenBoard.featureBoard.translateX(i);var o=-r._areaData.col.frozen.displayOffsetSize;r._topLine.left.hiddenBoard.featureBoard.translateX(o),r._bottomLine.left.hiddenBoard.featureBoard.translateX(o)},r._handleScale=function(){r._refresh()},r._container=t.container,r._headSize=t.headSize,r._areaData=t.areaData,r._scale=t.scale,r.renderManager=t.renderManager,r._init(),r}(0,i.Z)(t,e);var r=t.prototype;return r.refresh=function(){this._refresh()},r.dispose=function(){e.prototype.dispose.call(this),this._container.removeChild(this._board)},r._init=function(){this._board=document.createElement("div"),this._board.classList.add("main-board"),this._container.appendChild(this._board),this._topLine=this._register(new Or(this._board,this._areaData.row.frozen,this._areaData.col)),this._bottomLine=this._register(new Or(this._board,this._areaData.row.flow,this._areaData.col)),this._register(this._scale.onScale(this.registerAfterAreaRenderOnce)),this._register(this._areaData.row.frozen.onUpdateViewSize(this._updateAreaOffset)),this._register(this._areaData.col.frozen.onUpdateViewSize(this._updateAreaOffset)),this._register(this._areaData.row.frozen.onUpdateOffset(this._updateAreaOffset)),this._register(this._areaData.col.frozen.onUpdateOffset(this._updateAreaOffset)),this._register(this._areaData.row.flow.onUpdateOffset(this.updateFeatureBoardTranslate)),this._register(this._areaData.col.flow.onUpdateOffset(this.updateFeatureBoardTranslate)),this._register(this._areaData.row.frozen.onUpdateOffset(this.updateFeatureBoardTranslate)),this._register(this._areaData.col.frozen.onUpdateOffset(this.updateFeatureBoardTranslate)),this._refresh()},(0,o.Z)(t,[{key:"element",get:function(){return this._board}},{key:"top",get:function(){return this._topLine}},{key:"bottom",get:function(){return this._bottomLine}}]),t}(g.JT),Br=function(e,t,r,i){var o,n=arguments.length,s=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,r):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(e,t,r,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(n<3?o(s):n>3?o(t,r,s):o(t,r))||s);return n>3&&s&&Object.defineProperty(t,r,s),s},Pr=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},jr=function(e,t){return function(r,i){t(r,i,e)}},Mr=function(e){function t(t,r,i){var o;return(o=e.call(this)||this).wrap=t,o.spreadsheet=r,o.dataCallView=i,o.init(),o}(0,i.Z)(t,e);var r=t.prototype;return r.getActiveSheetId=function(){return this.spreadsheet.activeSheetId},r.init=function(){this.initScale(),this.initResize(),this.initHeadSize(),this.initClientRect(),this.initParagraphAccessor(),this.initRowcolAccessor(),this.initRowCoverAccessor(),this.initBorderAccessor(),this.initTableView(),this.initAreaData(),this.initTransformTable(),this.initRenderManager(),this.initFreezeLine(),this.initMainBoard(),this.initOperateContext()},r.dispose=function(){e.prototype.dispose.call(this),this.wrap.removeChild(this.container)},r.initScale=function(){this.scale=new W},r.initResize=function(){this.resize=this._register(new F)},r.initHeadSize=function(){this.headSize=new j({scale:this.scale})},r.initClientRect=function(){this.clientRect=this._register(new P(this.wrap,this.resize)),this.container=this.clientRect.container},r.initParagraphAccessor=function(){this.paragraphAccessor=this._register(new q.Z({dataCallView:this.dataCallView,spreadsheet:this.spreadsheet}))},r.initRowcolAccessor=function(){this.rowcolAccessor=this._register(new G.Z({paragraphAccessor:this.paragraphAccessor,spreadsheet:this.spreadsheet,dataCallView:this.dataCallView}))},r.initRowCoverAccessor=function(){this.rowCoverAccessor=this._register(new $({dataCallView:this.dataCallView,paragraphAccessor:this.paragraphAccessor,rowcolAccessor:this.rowcolAccessor,spreadsheet:this.spreadsheet}))},r.initBorderAccessor=function(){this.borderAccessor=this._register(new ce({spreadsheet:this.spreadsheet,dataCallView:this.dataCallView,rowCoverAccessor:this.rowCoverAccessor,rowcolAccessor:this.rowcolAccessor}))},r.initTableView=function(){this.tableView=this._register(new E({spreadsheet:this.spreadsheet,dataCallView:this.dataCallView}))},r.initAreaData=function(){this.areaData=this._register(new B({clientRect:this.clientRect,rowcolAccessor:this.rowcolAccessor,headSize:this.headSize,dataCallView:this.dataCallView,resize:this.resize,scale:this.scale,spreadsheet:this.spreadsheet}))},r.initTransformTable=function(){this.transformTable=new He({tableView:this.tableView,rowcolAccessor:this.rowcolAccessor,rowCoverAccessor:this.rowCoverAccessor,borderAccessor:this.borderAccessor,paragraphAccessor:this.paragraphAccessor,spreadsheet:this.spreadsheet})},r.initRenderManager=function(){this.renderManager=this._register(new dr({container:this.container,areaData:this.areaData,resize:this.resize,scale:this.scale,headSize:this.headSize,transformTable:this.transformTable,spreadsheet:this.spreadsheet}))},r.initFreezeLine=function(){this.freezeLine=this._register(new hr({areaData:this.areaData,headSize:this.headSize,renderManager:this.renderManager}))},r.initOperateContext=function(){this.operateContext=this._register(new Er({container:this.container,scale:this.scale,clientRect:this.clientRect,headSize:this.headSize,areaData:this.areaData,spreadsheet:this.spreadsheet}))},r.initMainBoard=function(){this.mainBoard=this._register(new Lr({container:this.container,headSize:this.headSize,areaData:this.areaData,scale:this.scale,renderManager:this.renderManager}))},t}(g.JT),kr=Mr=Br([jr(1,de.ISpreadsheet),jr(2,he.Z),Pr("design:paramtypes",["function"===typeof(Tr="undefined"!==typeof HTMLDivElement&&HTMLDivElement)?Tr:Object,"function"===typeof(Ar="undefined"!==typeof de.ISpreadsheet&&de.ISpreadsheet)?Ar:Object,"function"===typeof(Hr="undefined"!==typeof he.Z&&he.Z)?Hr:Object])],Mr)},"../spread-sheet/src/core/view/spreadsheet-view/SpreadsheetView.interface.ts":function(e,t,r){r.d(t,{N:function(){return i}});var i=(0,r("../node_modules/@tencent/containerized/build/main/index.js").yh)("ISpreadsheetView");t.Z=i},"../spread-sheet/src/core/view/spreadsheet-view/accessor/BaseCellAccessor.ts":function(e,t,r){var i=r("../node_modules/@babel/runtime/helpers/esm/toConsumableArray.js"),o=r("../node_modules/@babel/runtime/helpers/esm/inheritsLoose.js"),n=(r("../node_modules/core-js/modules/es.object.keys.js"),r("../node_modules/core-js/modules/es.array.splice.js"),r("../node_modules/core-js/modules/es.array.concat.js"),function(e){function t(t){var r;return(r=e.call(this,t)||this)._handleInsertCol=function(e){var t=r._rowData[e.sheetId];if(t)for(var o=Object.keys(t),n=0;n<o.length;n++)for(var s=o[n],a=r._rowData[e.sheetId][s],l=0;l<a.length;l++){var c;a[l]&&(e.index>=a[l].length?a[l].length=e.index+e.amount:(c=a[l]).splice.apply(c,[e.index,0].concat((0,i.Z)(new Array(e.amount)))))}},r._handleDeleteCol=function(e){var t=r._rowData[e.sheetId];if(t)for(var i=Object.keys(t),o=0;o<i.length;o++)for(var n=i[o],s=r._rowData[e.sheetId][n],a=0;a<s.length;a++)s[a]&&(e.index>=s[a].length?s[a].length=e.index+e.amount:s[a].splice(e.index,e.amount))},r._dataCallView=t.dataCallView,r._register(r._dataCallView.onInsertCol(r._handleInsertCol)),r._register(r._dataCallView.onDeleteCol(r._handleDeleteCol)),r}return(0,o.Z)(t,e),t}(r("../spread-sheet/src/core/view/spreadsheet-view/accessor/BaseRowAccessor.ts").Z));t.Z=n},"../spread-sheet/src/core/view/spreadsheet-view/accessor/BaseRowAccessor.ts":function(e,t,r){var i=r("../node_modules/@babel/runtime/helpers/esm/toConsumableArray.js"),o=r("../node_modules/@babel/runtime/helpers/esm/inheritsLoose.js"),n=(r("../node_modules/core-js/modules/es.object.keys.js"),r("../node_modules/core-js/modules/es.array.splice.js"),r("../node_modules/core-js/modules/es.array.concat.js"),function(e){function t(t){var r;return(r=e.call(this)||this)._rowData={},r._handleInsertRow=function(e){var t=e.sheetId,o=r._rowData[t];if(o)for(var n,s=Object.keys(o),a=0;a<s.length;a++){var l;if(n=s[a],e.index>=o[n].length)return void(o[n].length=e.index+e.amount);(l=o[n]).splice.apply(l,[e.index,0].concat((0,i.Z)(new Array(e.amount))))}},r._handleDeleteRow=function(e){var t=e.sheetId,i=r._rowData[t];if(i)for(var o,n=Object.keys(i),s=0;s<n.length;s++){if(o=n[s],e.index>=i[o].length)return;i[o].splice(e.index,e.amount)}},r._spreadsheet=t.spreadsheet,r._dataCallView=t.dataCallView,r._register(r._dataCallView.onInsertRow(r._handleInsertRow)),r._register(r._dataCallView.onDeleteRow(r._handleDeleteRow)),r}return(0,o.Z)(t,e),t.prototype.getTargetSheet=function(e){return this._spreadsheet.sheetManager.getSheetBySheetId(e)},t}(r("../node_modules/@tencent/containerized/build/main/index.js").JT));t.Z=n},"../spread-sheet/src/core/view/spreadsheet-view/area-data/AreaData.interface.ts":function(e,t,r){r.d(t,{oz:function(){return i}});var i,o=r("../node_modules/@tencent/containerized/build/main/index.js");!function(e){e.USER="user",e.API="api",e.SLIENT="slient"}(i||(i={}));var n=(0,o.yh)("IAreaData");t.ZP=n},"../spread-sheet/src/core/view/spreadsheet-view/model/CellPadding.ts":function(e,t,r){var i;r.d(t,{i:function(){return i}}),function(e){e[e.EMPTY=0]="EMPTY",e[e.TEXT=4]="TEXT",e[e.ICON=26]="ICON"}(i||(i={}));var o=function(){function e(t,r,i,o,n){this.top=t,this.right=r,this.bottom=i,this.left=o,e.pools[n]=this}return e.newInstance=function(t,r,i,o){var n=t+":"+r+":"+i+":"+o,s=e.pools[n];return s||new e(t,r,i,o,n)},e}();o.pools={},t.Z=o},"../spread-sheet/src/core/view/spreadsheet-view/model/Color.ts":function(e,t,r){var i=r("../packages/model/src/cell/format/colorUtils.ts"),o=function(){function e(t,r,i,o,n){this.red=t,this.green=r,this.blue=i,this.alpha=o,this.hex=n,e.pools[n]=this}return e.newInstanceByRGB=function(t,r,o,n){void 0===n&&(n=1);var s=function(e,t,r,o){return(0,i.rgba2hex)(e,t,r,o)}(t,r,o,n);return e.pools[s]?e.pools[s]:new e(t,r,o,n,s)},e.newInstanceByHex=function(t){var r=t.toLowerCase(),o=e.pools[r];if(o)return o;var n=function(e){return(0,i.hex2rgba)(e)}(r);return new e(n.red,n.green,n.blue,n.alpha,r)},e}();o.pools={},t.Z=o},"../spread-sheet/src/core/view/spreadsheet-view/model/HorizontalAlign.ts":function(e,t,r){r.d(t,{O:function(){return o.Z}});var i=r("../node_modules/@babel/runtime/helpers/esm/createClass.js"),o=r("../packages/model/src/cell/format/HorizontalAlign.ts"),n=function(){function e(e){this._value=e}return e.newInstance=function(t){var r=e.pools[t];return r||(e.pools[t]=new e(t))},(0,i.Z)(e,[{key:"value",get:function(){return this._value}}]),e}();n.pools={},t.Z=n},"../spread-sheet/src/core/view/spreadsheet-view/model/TextProp.ts":function(e,t,r){r.d(t,{L:function(){return d}});var i=r("../node_modules/@babel/runtime/helpers/esm/createClass.js"),o=(r("../node_modules/core-js/modules/es.string.bold.js"),r("../node_modules/core-js/modules/es.string.italics.js"),r("../node_modules/core-js/modules/es.regexp.exec.js"),r("../node_modules/core-js/modules/es.string.replace.js"),r("../node_modules/core-js/modules/es.string.trim.js"),r("../packages/model/src/cell/format/Color.ts")),n=r("../spread-sheet/src/core/view/config/default.ts"),s=r("../spread-sheet/src/core/view/spreadsheet-view/render-manager/alloy-excel/interface.ts"),a=r("../spread-sheet/src/base/helper/font-polyfill.ts"),l=r("../spread-sheet/src/base/config/font.ts"),c=r("../packages/model/src/cell/format/ThemeColor.ts"),d=":",h=function(){function e(e){void 0!==e[s.M.COLOR]&&(this[s.M.COLOR]=e[s.M.COLOR]),void 0!==e[s.M.FONT_SIZE]&&(this[s.M.FONT_SIZE]=e[s.M.FONT_SIZE]),void 0!==e[s.M.FONT_FAMILY]&&(this[s.M.FONT_FAMILY]=e[s.M.FONT_FAMILY]),void 0!==e[s.M.BOLD]&&(this[s.M.BOLD]=e[s.M.BOLD]),void 0!==e[s.M.ITALIC]&&(this[s.M.ITALIC]=e[s.M.ITALIC]),void 0!==e[s.M.UNDERLINE]&&(this[s.M.UNDERLINE]=e[s.M.UNDERLINE]),void 0!==e[s.M.STRIKETHROUGH]&&(this[s.M.STRIKETHROUGH]=e[s.M.STRIKETHROUGH])}return e.toRGBA=function(e){return"rgba("+e.red+","+e.green+","+e.blue+","+e.alpha+")"},e.toKey=function(t){var r=t.color,i="";return r&&(i=c.ZP.isTargetType(r)?r.serialize():e.toRGBA(r)),"{"+i+","+(null!=t.fontFamily?t.fontFamily:"")+","+(null!=t.fontSize?t.fontSize:"")+","+(t.bold?"1":"")+","+(t.italic?"1":"")+","+(t.strikethrough?"1":"")+","+(t.underline?"1":"")+"}"},e.newInstance=function(t,r){var i=e.toKey(t),n=e.pools[i];if(!n){var a=Object.create(null);if(t.color){var l=t.color;c.ZP.isTargetType(l)&&(l=o.Z.getColorRGBA(l,r)),a[s.M.COLOR]=e.toRGBA(l)}return t.fontSize&&(a[s.M.FONT_SIZE]=t.fontSize),t.fontFamily&&(a[s.M.FONT_FAMILY]=e.polyfillFontFamilyIfNeed(t.fontFamily)),t.bold&&(a[s.M.BOLD]=1),t.italic&&(a[s.M.ITALIC]=1),t.underline&&(a[s.M.UNDERLINE]=1),t.strikethrough&&(a[s.M.STRIKETHROUGH]=1),e.pools[i]=new e(a)}return n},e.polyfillFontFamilyIfNeed=function(e){return(null===e||void 0===e?void 0:e.replace)&&(e=e.replace(/[（|()].*?[）|)]/g,"")),(e=(0,a.A)(e)).trim()},e.prototype._getLineWidth=function(e){return e?Math.round(e/15):0},(0,i.Z)(e,[{key:"hash",get:function(){return""+this.font+d+this.color+d+this._getLineWidth(this.fontSize)}},{key:"font",get:function(){var e="";return this[s.M.ITALIC]&&(e="italic"),this[s.M.BOLD]&&(e+=" bold"),(e=e+" "+this.fontSize+"pt "+this.fontFamily).trim()}},{key:"color",get:function(){return this[s.M.COLOR]||e.toRGBA(n.xw)}},{key:"fontSize",get:function(){return this[s.M.FONT_SIZE]||n.n5}},{key:"fontFamily",get:function(){return this[s.M.FONT_FAMILY]||l.em}},{key:"underline",get:function(){return Boolean(this[s.M.UNDERLINE])}},{key:"strikethrough",get:function(){return Boolean(this[s.M.STRIKETHROUGH])}},{key:"bold",get:function(){return!!this[s.M.BOLD]||!1}},{key:"italic",get:function(){return!!this[s.M.ITALIC]||!1}},{key:"hasColor",get:function(){return"undefined"!==typeof this[s.M.COLOR]}}]),e}();s.M.COLOR,s.M.FONT_SIZE,s.M.FONT_FAMILY,s.M.BOLD,s.M.ITALIC,s.M.UNDERLINE,s.M.STRIKETHROUGH,h.pools={},t.Z=h},"../spread-sheet/src/core/view/spreadsheet-view/model/VerticalAlign.ts":function(e,t,r){r.d(t,{o:function(){return i}});var i,o=r("../node_modules/@babel/runtime/helpers/esm/createClass.js"),n=function(){function e(e){this._value=e}return e.newInstance=function(t){var r=e.pools[t];return r||(e.pools[t]=new e(t))},(0,o.Z)(e,[{key:"value",get:function(){return this._value}}]),e}();n.pools={},function(e){e.TOP="top",e.MIDDLE="middle",e.BOTTOM="bottom"}(i||(i={})),t.Z=n},"../spread-sheet/src/core/view/spreadsheet-view/model/WrapStrategy.ts":function(e,t,r){r.d(t,{J:function(){return i}});var i,o=r("../node_modules/@babel/runtime/helpers/esm/createClass.js"),n=function(){function e(e){this._value=e}return e.newInstance=function(t){var r=e.pools[t];return r||(e.pools[t]=new e(t))},(0,o.Z)(e,[{key:"value",get:function(){return this._value}}]),e}();n.pools={},function(e){e.NOWRAP="nowrap",e.NORMAL="normal"}(i||(i={})),t.Z=n},"../spread-sheet/src/core/view/spreadsheet-view/model/line-engine/cutBinary.ts":function(e,t,r){r.d(t,{C:function(){return n}});var i=r("../spread-sheet/src/core/view/spreadsheet-view/model/measurer/web/Measurer.ts"),o=r("../spread-sheet/src/core/view/spreadsheet-view/model/line-engine/split.ts");function n(e,t,r,s,a){var l=e.substr(0,s),c=i.Z.measureWidth(l instanceof o.eE?l.basicString:l,t,!0);if(0===c||c<=a&&s>=e.length||c>a&&1===l.length)return{text:"string"===typeof l?l:l.basicString,width:c};var d=c/l.length*5;if(c<=a&&a-c<d){for(var h=s+1;h<e.length;h++){var u=e.substr(0,h),f=i.Z.measureWidth("string"===typeof u?u:u.basicString,t);if(f>a)break;l=u,c=f}return{text:"string"===typeof l?l:l.basicString,width:c}}return c>a?n(e,t,r,Math.floor((r+s)/2),a):n(e,t,s,Math.floor((s+e.length)/2),a)}t.Z=n},"../spread-sheet/src/core/view/spreadsheet-view/model/line-engine/split.ts":function(e,t,r){r.d(t,{Am:function(){return d},eE:function(){return f},uc:function(){return u}}),r("../node_modules/core-js/modules/es.array.slice.js"),r("../node_modules/core-js/modules/es.object.to-string.js"),r("../node_modules/core-js/modules/es.function.name.js"),r("../node_modules/core-js/modules/es.array.from.js"),r("../node_modules/core-js/modules/es.string.iterator.js"),r("../node_modules/core-js/modules/es.symbol.js"),r("../node_modules/core-js/modules/es.symbol.description.js"),r("../node_modules/core-js/modules/es.symbol.iterator.js"),r("../node_modules/core-js/modules/es.array.iterator.js"),r("../node_modules/core-js/modules/web.dom-collections.iterator.js");var i=r("../spread-sheet/src/core/view/spreadsheet-view/model/line-engine/cutBinary.ts"),o=r("../spread-sheet/src/core/view/spreadsheet-view/model/line-engine/utils.ts"),n=r("../spread-sheet/src/base/index.ts"),s=r("../node_modules/emojicharstring/dist/EmojiCharString.min.js"),a=r.n(s);function l(e,t){var r="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(r)return(r=r.call(e)).next.bind(r);if(Array.isArray(e)||(r=function(e,t){if(e){if("string"===typeof e)return c(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?c(e,t):void 0}}(e))||t&&e&&"number"===typeof e.length){r&&(e=r);var i=0;return function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function c(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,i=new Array(t);r<t;r++)i[r]=e[r];return i}function d(e,t){var i,o=[],n=0,s=0;o[n]=[];for(var a=e.shift();a;){if(0===(null===(i=o[n-1])||void 0===i?void 0:i.length))return r.g.log.error("LineEngine splitLineByWidth error - empty split result:"+a.text),o;if(g(s+=a.size.width,t,a)){if(!p(t,a)){s=0,o[n+=1]=[];continue}var c=h(s,t,a);if(c.frontSegment&&!c.frontSegment.isEmpty()&&o[n].push(c.frontSegment),c.backSegments.length>0)for(var d,u=l(c.backSegments);!(d=u()).done;){var f=d.value;o[n+=1]=[],s=f.size.width,o[n].push(f)}else o[n+=1]=[],s=0}else o[n].push(a);a=e.shift()}return o}function h(e,t,r){var i=e===r.size.width?t:t-(e-r.size.width);return r.splitSegment(i,t)}function u(e,t,r){var o;if(n.Z.util.string.hasEmojiCharacter(t.text)){var s=new f(t.text);o=(0,i.Z)(s,e,0,s.length,r)}else o=(0,i.Z)(t.text,e,0,t.text.length,r);return[o,{text:t.text.slice(o.text.length,t.text.length),width:t.width-o.width}]}var f=function(){function e(e){this._emojiString=new(a())(e),this.length=this._emojiString.length,this.basicString=e}return e.prototype.substr=function(t,r){return new e(this._emojiString.substr(t,r))},e}();function g(e,t,r){return e>t||(0,o.N6)(r.text)}function p(e,t){return t.size.width>e||t.size.width<=e&&t.canSplit()}},"../spread-sheet/src/core/view/spreadsheet-view/model/line-engine/transform.ts":function(e,t,r){r.d(t,{iF:function(){return v},ll:function(){return _}}),r("../node_modules/core-js/modules/es.array.filter.js"),r("../node_modules/core-js/modules/es.array.map.js"),r("../node_modules/core-js/modules/es.array.find.js"),r("../node_modules/core-js/modules/es.object.assign.js"),r("../node_modules/core-js/modules/es.string.bold.js"),r("../node_modules/core-js/modules/es.string.italics.js"),r("../node_modules/core-js/modules/es.object.values.js"),r("../node_modules/core-js/modules/es.array.sort.js"),r("../node_modules/core-js/modules/es.array.slice.js"),r("../node_modules/core-js/modules/es.object.to-string.js"),r("../node_modules/core-js/modules/es.function.name.js"),r("../node_modules/core-js/modules/es.array.from.js"),r("../node_modules/core-js/modules/es.string.iterator.js"),r("../node_modules/core-js/modules/es.symbol.js"),r("../node_modules/core-js/modules/es.symbol.description.js"),r("../node_modules/core-js/modules/es.symbol.iterator.js"),r("../node_modules/core-js/modules/es.array.iterator.js"),r("../node_modules/core-js/modules/web.dom-collections.iterator.js");var i=r("../spread-sheet/src/core/view/config/default.ts"),o=r("../packages/model/src/cell/format/TextFormat.ts"),n=r("../spread-sheet/src/core/view/spreadsheet-view/model/line/segment/MentionSegment.ts"),s=r("../spread-sheet/src/core/view/spreadsheet-view/model/line/segment/TagSegment.ts"),a=r("../spread-sheet/src/core/view/spreadsheet-view/model/TextProp.ts"),l=r("../spread-sheet/src/core/view/spreadsheet-view/model/measurer/web/Measurer.ts"),c=r("../spread-sheet/src/core/view/spreadsheet-view/model/line/segment/TextSegment.ts"),d=r("../packages/model/src/cell/metadata/CustomDataType.ts"),h=r("../spread-sheet/src/core/utils/cell.ts"),u=r("../packages/model/src/cell/TextFormatRun.ts"),f=r("../packages/model/src/cell/format/Color.ts");function g(e,t){var r="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(r)return(r=r.call(e)).next.bind(r);if(Array.isArray(e)||(r=function(e,t){if(e){if("string"===typeof e)return p(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?p(e,t):void 0}}(e))||t&&e&&"number"===typeof e.length){r&&(e=r);var i=0;return function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function p(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,i=new Array(t);r<t;r++)i[r]=e[r];return i}function _(e,t){var r=function(e,t){var r=e.cellData,i=r.getMetadata();if(!i)return null;if(i.customDataType===d.ZP.SELECT){if(!i.config.withColor)return null;var o=r.getRefIds();if(o&&o.length>0){var n=i.config.options;return o.map((function(e){return n.find((function(t){return t.id===e}))})).filter((function(e){return e})).map((function(e){var i,o=e.textColor,n=e.text,c=e.bgColor,d=Object.assign(Object.assign({},null===(i=r.getUserEnteredFormat())||void 0===i?void 0:i.textFormat),{color:o}),h=a.Z.newInstance(d,t);return s.ZP.createInstance({text:n,textProp:h,size:{width:l.Z.measureWidth(n,h,!0),height:l.Z.measureHeight(h)},bgColor:c})}))}}return null}(e,t);return r||function(e,t){var r=e.cellText,i=e.textFormatRuns,o=e.cellData.getMentionDetails(),s=o&&Object.values(o)||[];s.length&&(s=s.sort((function(e,t){return e.pos[0]-t.pos[0]})));for(var d=[],h=i.length,u=0;u<h;u++)for(var f,p=i[u],_=u+1<h?i[u+1]:null,v=p.format,C=void 0,y=g(w([p.startIndex,_?_.startIndex:r.length],s));!(f=y()).done;){C=f.value;var R=r.substring(C.pos[0],C.pos[1]);if(C.mention){var x=m(v,t),D=l.Z.measureWidth(R,x,!0),E=l.Z.measureHeight(x);d.push(n.Z.createInstance({text:R,textProp:x,size:{width:D,height:E},mention:C.mention,spreadsheet:t}))}else{var S=a.Z.newInstance(v,t),I=l.Z.measureWidth(R,S,!0),b=l.Z.measureHeight(S);d.push(c.Z.createInstance({text:R,textProp:S,size:{width:I,height:b}}))}}return d}(e,t)}function v(e,t){void 0===t&&(t=!1);var r=e.getTextFormatRuns(),i=e.getConditionalFormatResult(),n=function(){return o.Z.createInstance({color:(0,h.getMergedFormatValue)(e,"getColor",t),fontFamily:(0,h.getMergedFormatValue)(e,"getFontFamily",t),fontSize:(0,h.getMergedFormatValue)(e,"getFontSize",t),bold:(0,h.getMergedFormatValue)(e,"getBold",t),italic:(0,h.getMergedFormatValue)(e,"getItalic",t),strikethrough:(0,h.getMergedFormatValue)(e,"getStrikethrough",t),underline:(0,h.getMergedFormatValue)(e,"getUnderline",t)})},s=function(e){var t,r,n,s,a,l,c;return o.Z.createInstance({color:(null===i||void 0===i?void 0:i.getColor())||(null===(t=e.format)||void 0===t?void 0:t.color),fontFamily:(null===i||void 0===i?void 0:i.getFontFamily())||(null===(r=e.format)||void 0===r?void 0:r.fontFamily),fontSize:(null===i||void 0===i?void 0:i.getFontSize())||(null===(n=e.format)||void 0===n?void 0:n.fontSize),bold:(null===i||void 0===i?void 0:i.getBold())||(null===(s=e.format)||void 0===s?void 0:s.bold),italic:(null===i||void 0===i?void 0:i.getItalic())||(null===(a=e.format)||void 0===a?void 0:a.italic),strikethrough:(null===i||void 0===i?void 0:i.getStrikethrough())||(null===(l=e.format)||void 0===l?void 0:l.strikethrough),underline:(null===i||void 0===i?void 0:i.getUnderline())||(null===(c=e.format)||void 0===c?void 0:c.underline)})};return(null===r||void 0===r?void 0:r.length)?r.map((function(e){return u.Z.createInstance({startIndex:e.startIndex,format:e.format?t?e.format.clone():s(e):n()})})):r=[u.Z.createInstance({startIndex:0,format:n()})]}function w(e,t){if(!t.length)return[{pos:e}];var r=[],i=t.filter((function(t){return e[0]<=t.pos[0]&&t.pos[1]<=e[1]}));if(i.length>0){for(var o,n,s=e[0],a=g(i);!(n=a()).done;)s<(o=n.value).pos[0]&&r.push({pos:[s,o.pos[0]]}),r.push({pos:[o.pos[0],o.pos[1]],mention:o}),s=o.pos[1];return s<e[1]&&r.push({pos:[s,e[1]]}),r}return[{pos:e}]}function m(e,t){var r;if(null===e.color||f.Z.getColorHexCode(e.color,t)!==i.GB.TextColor){var n=o.Z.createInstance(Object.assign(Object.assign({},e),{color:"#0188fb"}));r=a.Z.newInstance(n,t)}else r=a.Z.newInstance(e,t);return r}},"../spread-sheet/src/core/view/spreadsheet-view/model/line-engine/utils.ts":function(e,t,r){r.d(t,{N6:function(){return s},Pp:function(){return l},Tm:function(){return n},Wd:function(){return a}}),r("../node_modules/core-js/modules/es.regexp.exec.js"),r("../node_modules/core-js/modules/es.string.replace.js"),r("../node_modules/core-js/modules/es.string.code-point-at.js");var i,o=r("../node_modules/@tencent/unitool/dist/unitool.esm.js");function n(e){return s(e)?e.replace(/\n/g," "):e}function s(e){return e&&/\n/.test(e)}function a(e){if(0===e.length)return!1;for(var t=0;t<e.length;t++){var r=e.codePointAt(t);if(!(0,o.FD)(r))return!1}return!0}function l(e){var t=e.charCodeAt(e.length-1);return 10===t||13===t}!function(e){e[e.ZH=1]="ZH",e[e.COMBINATION=2]="COMBINATION",e[e.SPACE=3]="SPACE",e[e.OTHER=4]="OTHER"}(i||(i={}))},"../spread-sheet/src/core/view/spreadsheet-view/model/line/Line.ts":function(e,t,r){var i=r("../node_modules/@babel/runtime/helpers/esm/toConsumableArray.js");t.Z=function(e){var t;void 0===e&&(e=[]),this.segments=[],(t=this.segments).push.apply(t,(0,i.Z)(e));for(var r=0,o=0,n=0;n<e.length;n++)r+=e[n].size.width,o=Math.max(o,e[n].size.height);this.width=r,this.height=o}},"../spread-sheet/src/core/view/spreadsheet-view/model/line/RichParagraph.ts":function(e,t){t.Z=function(e){void 0===e&&(e=[]),this.lines=[];for(var t=0,r=0,i=0;i<e.length;i++)t=Math.max(e[i].width,t),r+=e[i].height;this.lines=e,this.width=t,this.height=r}},"../spread-sheet/src/core/view/spreadsheet-view/model/line/SimpleParagraph.ts":function(e,t,r){var i=r("../packages/flyweight/Factory.ts"),o=function(){function e(e,t){this.key=t,this.segment=e,this.width=this.segment.size.width,this.height=this.segment.size.height}return e.generateKey=function(e){return e.key},e}();o.factory=new i.Z(o),t.Z=o.factory},"../spread-sheet/src/core/view/spreadsheet-view/model/line/constant.ts":function(e,t,r){r.d(t,{U:function(){return l},i:function(){return a}});var i=r("../spread-sheet/src/core/view/spreadsheet-view/model/measurer/web/Measurer.ts"),o=r("../spread-sheet/src/core/view/spreadsheet-view/model/TextProp.ts"),n=r("../spread-sheet/src/core/view/spreadsheet-view/model/line/Line.ts"),s=r("../spread-sheet/src/core/view/spreadsheet-view/model/line/segment/TextSegment.ts"),a="••••••••",l=function(e){var t=o.Z.newInstance({fontSize:12},e),r=i.Z.measureWidth(a,t,!0),l=i.Z.measureHeight(t),c=s.Z.createInstance({text:a,textProp:t,size:{width:r,height:l}});return new n.Z([c])}},"../spread-sheet/src/core/view/spreadsheet-view/model/line/segment/MentionSegment.ts":function(e,t,r){var i,o=r("../node_modules/@babel/runtime/helpers/esm/inheritsLoose.js"),n=(r("../node_modules/core-js/modules/es.array.map.js"),r("../spread-sheet/src/core/view/config/default.ts")),s=r("../spread-sheet/src/core/view/spreadsheet-view/model/line/segment/Segment.ts"),a=r("../packages/flyweight/Factory.ts"),l=(r("../spread-sheet/src/base/util/domain-config.ts"),r("../spread-sheet/src/core/view/spreadsheet-view/render-manager/alloy-excel/table/body/customize-textprop/customize-textprop.ts"));!function(e){e[e.NORMAL=0]="NORMAL",e[e.HOVER=1]="HOVER",e[e.HIGHTLIGHT=2]="HIGHTLIGHT"}(i||(i={}));var c=function(e){function t(t,r){var i;(i=e.call(this,t,r)||this).key=r,i.focusing=!1,i.highlight=!1;var o=t.mention,s=t.size,a=t.spreadsheet;return i.mention=o,i.spreadsheet=a,i.size.width=2*n.li.OuterPadding+2*n.li.InnerLeftRightPadding+s.width+n.li.LabelAndTrianglePadding+n.li.TriangleWidth,i.size.height=2*n.li.OuterPadding+n.li.Height,i}(0,o.Z)(t,e),t.generateKey=function(e){return e.mention.mentionId};var r=t.prototype;return r.focus=function(){this.focusing=!0},r.unfocus=function(){this.focusing=!1},r.canSplit=function(){return!1},r.splitSegment=function(e,t){var r=null,i=[];return e===t?r=this.size.width>t?this.segmentHardSplit(t):this:(r=null,i=[this]),{frontSegment:r,backSegments:i}},r.customRender=function(e,t,r,i,o){this.customRenderToC(t,r,i,o)},r.customRenderToB=function(e,t,r,i,o){var s={pos:[t+n.li.OuterPadding+n.li.InnerLeftRightPaddingEnt,r],text:this.text};i&&(s.clipInfo=i);var a=(0,l.d)(e,this.textProp,this.spreadsheet).hash;o.textCollector.collect({textInfo:s,textPropHash:a})},r.customRenderToC=function(e,t,r,i){var o,s={pos:[e+n.li.OuterPadding+n.li.InnerLeftRightPadding,t-n.li.OuterPadding],text:this.text};r&&(s.clipInfo=r),i.textCollector.collect({textInfo:s,textPropHash:this.textProp.hash});var a=Math.round(t-.75*this.size.height)+n.li.OuterPadding,l={radius:n.li.Radius,rect:[n.li.OuterPadding+e,a,this.size.width-2*n.li.OuterPadding,this.size.height-2*n.li.OuterPadding]};r&&(l.clipInfo=r),i.roundRectCollector.collect({roundRectProp:this.getRoundRectRenderProp(),roundRectInfo:l});var c=a-n.li.OuterPadding+(this.size.height-n.li.TriangleHeight)/2,d=[e+this.size.width-n.li.OuterPadding-n.li.InnerLeftRightPadding-n.li.TriangleWidth,c],h={path:this.getTriangleCoordinate(d)};r&&(h.clipInfo=r),null===(o=i.get("mention-triangle"))||void 0===o||o.collect({color:n.GB.TriangleColor,graphicsInfo:h})},r.getRoundRectRenderProp=function(){return this.focusing?n.I1:this.highlight?n.kp:n.et},r.segmentHardSplit=function(e){var r=this.castToWidth(e),i=r.text,o=r.textProp,n=r.size;return t.factory.createInstance({text:i,textProp:o,size:n,mention:this.mention,spreadsheet:this.spreadsheet})},r.getTriangleCoordinate=function(e){return n.Co.map((function(t,r){return t+e[r%2]}))},t}(s.Z);c.factory=new a.Z(c),t.Z=c.factory},"../spread-sheet/src/core/view/spreadsheet-view/model/line/segment/Segment.ts":function(e,t,r){var i=r("../spread-sheet/src/core/view/spreadsheet-view/model/line-engine/cutBinary.ts"),o=r("../spread-sheet/src/core/view/spreadsheet-view/model/measurer/web/Measurer.ts"),n=function(){function e(e,t){this.key=t,this.text=e.text,this.textProp=e.textProp,this.size=e.size}var t=e.prototype;return t.isEmpty=function(){return!this.text},t.castToWidth=function(e){var t=(0,i.C)(this.text,this.textProp,0,this.text.length,e),r=o.Z.measureWidth(t.text,this.textProp),n=o.Z.measureHeight(this.textProp);return{text:t.text,textProp:this.textProp,size:{width:r,height:n}}},e}();t.Z=n},"../spread-sheet/src/core/view/spreadsheet-view/model/line/segment/TagSegment.ts":function(e,t,r){r.d(t,{Gy:function(){return d}});var i=r("../node_modules/@babel/runtime/helpers/esm/inheritsLoose.js"),o=r("../spread-sheet/src/core/view/spreadsheet-view/model/line/segment/Segment.ts"),n=r("../packages/flyweight/Factory.ts"),s=r("../spread-sheet/src/core/view/spreadsheet-view/model/TextProp.ts"),a=r("../packages/model/src/cell/format/index.ts"),l=r("../spread-sheet/src/core/view/spreadsheet-view/render-manager/alloy-excel/interface.ts"),c=function(e){function t(t,r){var i;(i=e.call(this,t,r)||this).key=r;var o=t.bgColor,n=t.size;return i.bgColor=o,i.setSize(n),i}(0,i.Z)(t,e),t.generateKey=function(e){var t=e.text,r=e.bgColor,i=e.textProp,o=e.size,n="";if(i){var c=i.fontFamily,d=i.fontSize,h=i.underline,u=i.strikethrough,f=i.color,g=!!i[l.M.BOLD],p=!!i[l.M.ITALIC];n=s.Z.toKey({fontFamily:c,fontSize:d,color:a.Color.createColor(f),underline:h,strikethrough:u,bold:g,italic:p})}return t+","+(r&&r.serialize())+","+n+","+o.width+","+o.height};var r=t.prototype;return r.clone=function(){return t.factory.createInstance({text:this.text,textProp:this.textProp,size:this.size,bgColor:this.bgColor})},r.setSize=function(e){this.size.width=2*t.MARGIN+2*t.PADDING_X+e.width,this.size.height=2*t.MARGIN+2*t.PADDING_Y+e.height},r.canSplit=function(){return!1},r.splitSegment=function(e,t){var r=null,i=[];return e===t?r=this.size.width>t?this.segmentHardSplit(t):this:(r=null,i=[this]),{frontSegment:r,backSegments:i}},r.segmentHardSplit=function(e){var r=e-2*(t.MARGIN+t.PADDING_X),i=this.castToWidth(r),o=i.text,n=i.textProp,s=i.size;return t.factory.createInstance({text:o,textProp:n,size:s,bgColor:this.bgColor})},t}(o.Z);c.factory=new n.Z(c),c.MARGIN=1,c.PADDING_X=8,c.PADDING_Y=1,c.RADIUS=2,t.ZP=c.factory;var d={MARGIN:c.MARGIN,PADDING_X:c.PADDING_X,PADDING_Y:c.PADDING_Y,RADIUS:c.RADIUS}},"../spread-sheet/src/core/view/spreadsheet-view/model/line/segment/TextSegment.ts":function(e,t,r){r.d(t,{Z:function(){return v}});var i=r("../node_modules/@babel/runtime/helpers/esm/inheritsLoose.js"),o=(r("../node_modules/core-js/modules/es.array.slice.js"),r("../node_modules/core-js/modules/web.dom-collections.for-each.js"),r("../node_modules/core-js/modules/es.array.from.js"),r("../node_modules/core-js/modules/es.string.iterator.js"),r("../node_modules/core-js/modules/es.array.iterator.js"),r("../node_modules/core-js/modules/es.object.to-string.js"),r("../node_modules/core-js/modules/web.dom-collections.iterator.js"),r("../node_modules/core-js/modules/es.function.name.js"),r("../node_modules/core-js/modules/es.symbol.js"),r("../node_modules/core-js/modules/es.symbol.description.js"),r("../node_modules/core-js/modules/es.symbol.iterator.js"),r("../spread-sheet/src/core/view/spreadsheet-view/model/line/segment/Segment.ts")),n=r("../packages/flyweight/Factory.ts"),s=r("../spread-sheet/src/core/view/spreadsheet-view/render-manager/alloy-excel/interface.ts"),a=r("../node_modules/@tencent/unitool/dist/unitool.esm.js"),l=r("../spread-sheet/src/core/view/spreadsheet-view/model/measurer/web/Measurer.ts"),c=r("../spread-sheet/src/core/view/spreadsheet-view/model/line-engine/split.ts"),d=r("../spread-sheet/src/core/view/spreadsheet-view/model/line-engine/utils.ts"),h=function(){function e(e,t){this.text=e,this.textProp=t,this.splitPoints=[],this.lineBreaker=new a.bk(e,{lineBreak:a.zJ.Normal,wordBreak:a.H4.Normal})}e.isBreakable=function(e){return(0,a.KJ)(e)!==e.length};var t=e.prototype;return t.breakLine=function(t){for(var r=t.lineWidth,i=t.limitWidth,o=i===r,n=0,s="",a=0,l=this.next();l;){var h=l.position-n,u=this.getWord(n,h),f=u.currentWord,g=u.currentWordWidth,p=(0,d.Wd)(f);if(a+g<=i)n=l.position,(0,d.Pp)(f)?(this.insertSplitPoint(n,a+g),s="",a=0,i=r,o=!0):(s+=f,a+=g,o=!1);else if(p)n=l.position,s+=f,a+=g,o=!1;else{var _=i-a,v=e.isBreakable(f);if(""!==s||!o){this.insertSplitPoint(n,a),s="",a=0,i=r,o=!0;continue}if(v){var w=(0,c.uc)(this.textProp,{text:f,width:g},_);s+=w[0].text,n+=w[0].text.length,this.insertSplitPoint(n,a+w[0].width),s="",a=0,i=r;continue}n=l.position,this.insertSplitPoint(n,a),s="",a=0,i=r}l=this.next()}return this.insertSplitPoint(n,a),this.splitPoints},t.next=function(){var e=null;return(e=this.containsSpace()?{position:this.currentBreakPoint.position+1,required:!0}:this.lineBreaker.next(!0))&&(this.currentBreakPoint=e),e},t.insertSplitPoint=function(e,t){this.splitPoints.push({position:e,width:t})},t.getWord=function(e,t){var r,i=this.text.substr(e,t);return r=(0,d.Pp)(i)?l.Z.measureWidth(i.substr(0,i.length-1),this.textProp):l.Z.measureWidth(i,this.textProp),{currentWord:i,currentWordWidth:r}},t.containsSpace=function(){if(!this.currentBreakPoint)return!1;var e=this.currentBreakPoint.position,t=this.text.charAt(e),r=this.text.charAt(e+1);return!((0,d.Wd)(t)||!(0,d.Wd)(r))},e}();function u(e,t){var r="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(r)return(r=r.call(e)).next.bind(r);if(Array.isArray(e)||(r=function(e,t){if(e){if("string"===typeof e)return f(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?f(e,t):void 0}}(e))||t&&e&&"number"===typeof e.length){r&&(e=r);var i=0;return function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function f(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,i=new Array(t);r<t;r++)i[r]=e[r];return i}function g(e,t,r){void 0===t&&(t=0),void 0===r&&(r=1e3);var i=t*r,o=i+r,n=e.slice(i,o);requestAnimationFrame((function(){n.forEach((function(e){e.splitSegmentCache=void 0})),e[o+1]&&g(e,t+1)}))}var p=function(e){function t(){return e.apply(this,arguments)||this}return(0,i.Z)(t,e),t.prototype.releasePools=function(){g(Array.from(this.pools.values())),e.prototype.releasePools.call(this)},t}(n.Z),_=function(e){function t(){return e.apply(this,arguments)||this}(0,i.Z)(t,e),t.generateKey=function(e){var t=e.text,r=e.textProp;return t+","+r.hash+","+r[s.M.BOLD]+","+r[s.M.ITALIC]+","+r[s.M.UNDERLINE]+","+r[s.M.STRIKETHROUGH]};var r=t.prototype;return r.canSplit=function(){return!0},r.splitSegment=function(e,t){var r=""+e+String(e===t),i=this.getSegmentCache(r);if(i)return i;var o=new h(this.text,this.textProp).breakLine({limitWidth:e,lineWidth:t}),n=this.splitSegmentByBreakPoints(o);return this.setSegmentCache(r,n)},r.splitSegmentByBreakPoints=function(e){for(var r,i=[],o=0,n=u(e);!(r=n()).done;){var s=r.value,a=s.position-o,l=s.width,c=this.text.substr(o,a);i.push(t.factory.createInstance({text:c,textProp:this.textProp,size:{width:l,height:this.size.height}})),o=s.position}return i},r.getSegmentCache=function(e){this.splitSegmentCache||(this.splitSegmentCache={});var t=this.splitSegmentCache[e];return t?{frontSegment:t.segments[0],backSegments:t.segments.slice(1)}:null},r.setSegmentCache=function(e,t){return this.splitSegmentCache||(this.splitSegmentCache={}),this.splitSegmentCache[e]={segments:t},{frontSegment:t[0],backSegments:t.slice(1)}},t}(o.Z);_.factory=new p(_);var v=_.factory},"../spread-sheet/src/core/view/spreadsheet-view/model/measurer/web/Measurer.ts":function(e,t,r){r.d(t,{Z:function(){return n}}),r("../node_modules/core-js/modules/es.string.code-point-at.js");var i=r("../node_modules/@tencent/unitool/dist/unitool.esm.js");function o(e){return"number"!==typeof e?(console.error("x is not a number"),0):Math.round(100*e)/100}r("../node_modules/core-js/modules/es.regexp.exec.js"),r("../node_modules/core-js/modules/es.string.match.js"),r("../node_modules/core-js/modules/es.array.join.js");var n=new(function(){function e(){this.measureCtx=function(){if("undefined"!==typeof window){var e=document.createElement("canvas");return e.width=1,e.height=500,e.dir="ltr",e.getContext("2d")}return null}(),this.wordCache={},this.charCache={},this.measureCtx||r.g.log.error("Measurer - cannot get measureCtx!")}var t=e.prototype;return t.measureWidth=function(e,t,r){return void 0===r&&(r=!1),o(this.getTextWidthByTextProp(e,t,r))},t.measureHeight=function(e){return o(4*Math.max(2.25,e.fontSize)/3*1.4)},t.getTextWidthByTextProp=function(e,t,r){var o=(0,i.iM)(e.codePointAt(0)||0);return 1===e.length&&"Han"===o?this.getCharWidthByTextProp(e,t,!0):this.getWordWidthByTextProp(e,t,r)},t.getWordWidthByTextProp=function(e,t,r){var i=0,o=t.font;return void 0===this.wordCache[o]&&(this.wordCache[o]={}),void 0===this.wordCache[o][e]?(i=this.calcTextWidthByTextProp(e,t),r&&(this.wordCache[o][e]=i)):i=this.wordCache[o][e],i},t.getCharWidthByTextProp=function(e,t,r){var i=0,o=t.font;return void 0===this.charCache[o]?(i=this.calcTextWidthByTextProp(e,t),r&&(this.charCache[o]=i)):i=this.charCache[o],i},t.calcTextWidthByTextProp=function(e,t){var i=0;return this.measureCtx?(this.measureCtx.font!==t.font&&(this.measureCtx.font=t.font),i=this.measureCtx.measureText(e).width):r.g.log.error("Measurer - cannot find measureCtx!"),o(i)},e}())},"../spread-sheet/src/core/view/spreadsheet-view/operate-context/operate-data/FingerData.ts":function(e,t,r){var i;r.d(t,{w:function(){return i}}),function(e){e[e.IDLE=0]="IDLE",e[e.MOVE=1]="MOVE",e[e.SCALE=2]="SCALE"}(i||(i={}));var o=function(){function e(){this.firstFinger={x:0,y:0},this.secondFinger={x:0,y:0},this.center={x:0,y:0}}var t=e.prototype;return t.startFirstFinger=function(e,t){this.mode=i.MOVE,this.firstFinger.x=e,this.firstFinger.y=t},t.startSecondFinger=function(e,t){this.mode=i.SCALE;var r=this.firstFinger.x,o=this.firstFinger.y,n=e;this.secondFinger.x=e;var s=t;this.secondFinger.y=t,this.center.x=(r+n)/2,this.center.y=(o+s)/2,this.fingersDis=Math.sqrt((n-r)*(n-r)+(s-o)*(s-o))},t.moveFirstFinger=function(e,t){this.firstFinger.x=e,this.firstFinger.y=t},t.moveSecondFinger=function(e,t){var r=this.firstFinger.x,i=this.firstFinger.y,o=e;this.secondFinger.x=e;var n=t;this.secondFinger.y=t;var s=Math.sqrt((o-r)*(o-r)+(n-i)*(n-i));this.zoom=s/this.fingersDis},t.endUpdateFinger=function(e){this.mode=e.touches.length>1?i.SCALE:i.MOVE,e.touches.length>1?this.mode=i.SCALE:1===e.touches.length?this.mode=i.MOVE:this.mode=i.IDLE},t.end=function(){this.firstFinger.x=0,this.secondFinger.x=0,this.center.x=0,this.center.y=0,this.fingersDis=0},e}();t.Z=o},"../spread-sheet/src/core/view/spreadsheet-view/paragraph-accessor/ParagraphAccessor.ts":function(e,t,r){r.d(t,{F:function(){return y},Z:function(){return R}});var i=r("../node_modules/@babel/runtime/helpers/esm/inheritsLoose.js"),o=(r("../node_modules/core-js/modules/es.object.keys.js"),r("../spread-sheet/src/core/view/spreadsheet-view/accessor/BaseCellAccessor.ts")),n=function(e){function t(t){var i;return(i=e.call(this)||this)._handleCellsChange=function(e){for(var t=e.startRow,r=e.endRow,o=e.startCol,n=e.endCol,s=t;s<=r;s++)for(var a=o;a<=n;a++)i.calcFunc(s,a,e.sheetId)},i._handleColChange=function(e){var t=i.spreadsheet.sheetManager.getSheetBySheetId(e.sheetId);if(t)for(var o=0;o<t.getRowCount();o++)for(var n=e.ranges,s=e.sheetId,a=0;a<n.length;a++)for(var l=n[a],c=l.startIndex;c<=l.endIndex;c++)i.calcFunc(o,c,s);else r.g.log.error("RecalculateListener _handleColChange: sheetId is invalid")},i.dataCallView=t.dataCallView,i.spreadsheet=t.spreadsheet,i.calcFunc=t.calc,i._register(i.dataCallView.onUpdateCells(i._handleCellsChange)),i._register(i.dataCallView.onSetColWidth(i._handleColChange)),i._register(i.dataCallView.onSetColVisible(i._handleColChange)),i}return(0,i.Z)(t,e),t}(r("../node_modules/@tencent/containerized/build/main/index.js").JT),s=r("../spread-sheet/src/core/view/utils/base-func.ts"),a=r("../spread-sheet/src/core/view/spreadsheet-view/model/line/segment/TextSegment.ts"),l=r("../spread-sheet/src/core/view/spreadsheet-view/paragraph-accessor/utils.ts"),c=r("../spread-sheet/src/core/view/spreadsheet-view/transform-table/cell.ts"),d=r("../spread-sheet/src/core/view/spreadsheet-view/model/line/segment/TagSegment.ts"),h=(r("../node_modules/core-js/modules/es.array.slice.js"),r("../node_modules/core-js/modules/es.object.to-string.js"),r("../node_modules/core-js/modules/es.function.name.js"),r("../node_modules/core-js/modules/es.array.from.js"),r("../node_modules/core-js/modules/es.string.iterator.js"),r("../node_modules/core-js/modules/es.symbol.js"),r("../node_modules/core-js/modules/es.symbol.description.js"),r("../node_modules/core-js/modules/es.symbol.iterator.js"),r("../node_modules/core-js/modules/es.array.iterator.js"),r("../node_modules/core-js/modules/web.dom-collections.iterator.js"),r("../spread-sheet/src/core/view/spreadsheet-view/model/line-engine/utils.ts")),u=r("../spread-sheet/src/core/view/spreadsheet-view/model/line/SimpleParagraph.ts"),f=r("../spread-sheet/src/core/view/spreadsheet-view/model/line/Line.ts"),g=r("../spread-sheet/src/core/view/spreadsheet-view/model/line/RichParagraph.ts"),p=r("../spread-sheet/src/core/view/spreadsheet-view/model/line-engine/split.ts"),_=r("../spread-sheet/src/core/view/spreadsheet-view/model/line-engine/transform.ts");function v(e,t){var r="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(r)return(r=r.call(e)).next.bind(r);if(Array.isArray(e)||(r=function(e,t){if(e){if("string"===typeof e)return w(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?w(e,t):void 0}}(e))||t&&e&&"number"===typeof e.length){r&&(e=r);var i=0;return function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function w(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,i=new Array(t);r<t;r++)i[r]=e[r];return i}function m(e,t,r){var i=(0,_.iF)(t),o=(0,h.Tm)((0,c.nv)(t,r));if(!o)return null;var n=(0,_.ll)({cellText:o,textFormatRuns:i,cellData:t},e);if(1===n.length)return u.Z.createInstance(n[0]);var s=new f.Z(n);return new g.Z([s])}function C(e,t,r,i){var o=(0,_.iF)(t),n=(0,c.nv)(t,i);if(!n||r<=0)return null;n=n.substr(0,5e4);var s=(0,_.ll)({cellText:n,textFormatRuns:o,cellData:t},e);return function(e){if(1===e.length&&1===e[0].length)return u.Z.createInstance(e[0][0]);for(var t,r=[],i=v(e);!(t=i()).done;){var o=t.value;r.push(new f.Z(o))}return new g.Z(r)}((0,p.Am)(s,r))}function y(e,t,r,i){var o=t,n=r,s=e.getCellDataAtPosition(o,n),a=null===s||void 0===s?void 0:s.getMergeReference();if(a&&(o=a.startRowIndex,n=a.startColIndex,s=e.getCellDataAtPosition(o,n)),!s)return{row:o,col:n,paragraph:null};var d=(0,c.jl)(e,o,n),h=d.paddingLeft,u=d.paddingRight,f=(0,l.D)(e,s,n)-h-u;return{row:o,col:n,paragraph:(0,l.l)(s)?C(e.spreadsheetReference,s,f,!!i):m(e.spreadsheetReference,s,!!i)}}var R=function(e){function t(t){var i;return(i=e.call(this,t)||this).formulaDisplay=!1,i._cancelSegmentFlyweight=(0,s.kf)((function(){a.Z.releasePools(),d.ZP.releasePools()}),10),i.init=function(e){var t,o=i._spreadsheet.sheetManager.getSheetBySheetId(e);if(o){i._rowData[e]=((t={}).PARAGRAPH_DATA=[],t);var n=o.highWaterMark.getMark(),s=o.getColCount()-1;r.g.log.info("RecalculateListener init, endRow:"+n+" endCol:"+s);for(var a=0;a<=n;a++)for(var l=0;l<=s;l++)i._calc(a,l,e)}else r.g.log.error("RecalculateListener init: sheetId is invalid",e,i._spreadsheet.sheetManager.sheetList)},i.shouldUseInputCellData=function(e,t){return i.inputCellData&&e===i.inputRow&&t===i.inputCol},i._calc=function(e,t,o){i._rowData[o]||i.init(o);var n=i._spreadsheet.sheetManager.getSheetBySheetId(o);if(n){var s=y(n,e,t,i.formulaDisplay),a=s.paragraph,l=s.row,c=s.col;null!==a?(i._rowData[o].PARAGRAPH_DATA[l]||(i._rowData[o].PARAGRAPH_DATA[l]=[]),i._rowData[o].PARAGRAPH_DATA[l][c]=a,i._cancelSegmentFlyweight()):i._rowData[o].PARAGRAPH_DATA[l]&&(i._rowData[o].PARAGRAPH_DATA[l][c]=void 0)}else r.g.log.error("RecalculateListener _calc: sheetId is invalid")},i._recalculateListener=i._register(new n({dataCallView:i._dataCallView,spreadsheet:i._spreadsheet,calc:i._calc})),i.init(t.spreadsheet.activeSheetId),i}(0,i.Z)(t,e);var o=t.prototype;return o.getParagraph=function(e,t,r){if(this.shouldUseInputCellData(e,t))return this.inputCellLineData;var i=r||this._spreadsheet.activeSheetId;return this._rowData[i]&&this._rowData[i].PARAGRAPH_DATA[e]?this._rowData[i].PARAGRAPH_DATA[e][t]:void 0},o.refresh=function(e){this._rowData[e]&&0!==Object.keys(this._rowData[e]).length||this.init(e)},o.setInputCellData=function(e,t,r){this.inputRow=e,this.inputCol=t,this.inputCellData=r;var i,o=this._spreadsheet.activeSheet,n=(0,c.jl)(o,e,t),s=n.paddingLeft,a=n.paddingRight,d=(0,l.D)(o,this.inputCellData,t)-s-a,h=!!this.inputCellData.getFormula();i=(0,l.l)(this.inputCellData)?C(o.spreadsheetReference,this.inputCellData,d,h):m(o.spreadsheetReference,this.inputCellData,h),this.inputCellLineData=i},o.clearInputCellData=function(){this.inputRow=-1,this.inputCol=-1,this.inputCellData=null,this.inputCellLineData=null},t}(o.Z)},"../spread-sheet/src/core/view/spreadsheet-view/paragraph-accessor/utils.ts":function(e,t,r){r.d(t,{D:function(){return l},l:function(){return a}});var i=r("../packages/model/src/cell/format/index.ts"),o=r("../packages/model/src/cell/metadata/CustomDataType.ts"),n=r("../packages/model/src/config/index.ts"),s=r("../spread-sheet/src/core/utils/cell.ts");function a(e){var t;return(null===(t=e.getMetadata())||void 0===t?void 0:t.customDataType)===o.ZP.SELECT||(0,s.getMergedFormatValue)(e,"getWrapStrategy")===i.WRAP_STRATEGY.WRAP}function l(e,t,r){if(!t)return n.DEFAULT_COL_WIDTH;var i=0,o=t.getMergeReference();if(!o)return e.isColHidden(r)?0:e.getColWidth(r);for(var s=o.startColIndex;s<=o.endColIndex;s++)e.isColHidden(s)||(i+=e.getColWidth(s));return i}},"../spread-sheet/src/core/view/spreadsheet-view/render-manager/alloy-excel/Default.ts":function(e,t,r){var i=r("../spread-sheet/src/core/view/spreadsheet-view/render-manager/alloy-excel/utils.ts"),o=function(){function e(){}return e.reset=function(t){void 0!==t.lineWidth&&(e.LINE_WIDTH=t.lineWidth,e.LINE.width=e.LINE_WIDTH),void 0!==t.lineColor&&(e.LINE_COLOR=t.lineColor,e.LINE.color=e.LINE_COLOR),void 0!==t.lineStyle&&(e.LINE_STYLE=t.lineStyle,e.LINE.style=e.LINE_STYLE),void 0!==t.color&&(e.COLOR=t.color,e.FONT_STYLE.color=e.COLOR),void 0!==t.fontFamily&&(e.FONT_FAMILY=t.fontFamily,e.FONT_STYLE.fontFamily=e.FONT_FAMILY),void 0!==t.fontSize&&(e.FONT_SIZE=t.fontSize,e.FONT_STYLE.fontSize=e.FONT_SIZE),void 0!==t.backgroundColor&&(e.BACKGROUND_COLOR=t.backgroundColor)},e}();o.LINE_WIDTH=1,o.LINE_COLOR={red:220,green:220,blue:220,alpha:1,hex:"#e2e4e8"},o.LINE_STYLE=i.j.THIN,o.LINE={width:o.LINE_WIDTH,style:o.LINE_STYLE,color:o.LINE_COLOR},o.COLOR={red:0,green:0,blue:0,alpha:1,hex:"#000000"},o.FONT_FAMILY="",o.FONT_SIZE=10,o.DIMENSION_FONT_SIZE=9,o.FONT_STYLE={color:o.COLOR,fontFamily:o.FONT_FAMILY,fontSize:o.FONT_SIZE,bold:!1,italic:!1,strikethrough:!1,underline:!1},o.BACKGROUND_COLOR={red:0,green:0,blue:0,alpha:1,hex:"#ffffff"},t.Z=o},"../spread-sheet/src/core/view/spreadsheet-view/render-manager/alloy-excel/canvas/CollectEngine.ts":function(e,t,r){r.d(t,{h:function(){return i}});var i,o=r("../node_modules/@babel/runtime/helpers/esm/createClass.js"),n=(r("../node_modules/core-js/modules/es.array.iterator.js"),r("../node_modules/core-js/modules/es.map.js"),r("../node_modules/core-js/modules/es.object.to-string.js"),r("../node_modules/core-js/modules/es.string.iterator.js"),r("../node_modules/core-js/modules/esnext.map.delete-all.js"),r("../node_modules/core-js/modules/esnext.map.every.js"),r("../node_modules/core-js/modules/esnext.map.filter.js"),r("../node_modules/core-js/modules/esnext.map.find.js"),r("../node_modules/core-js/modules/esnext.map.find-key.js"),r("../node_modules/core-js/modules/esnext.map.includes.js"),r("../node_modules/core-js/modules/esnext.map.key-of.js"),r("../node_modules/core-js/modules/esnext.map.map-keys.js"),r("../node_modules/core-js/modules/esnext.map.map-values.js"),r("../node_modules/core-js/modules/esnext.map.merge.js"),r("../node_modules/core-js/modules/esnext.map.reduce.js"),r("../node_modules/core-js/modules/esnext.map.some.js"),r("../node_modules/core-js/modules/esnext.map.update.js"),r("../node_modules/core-js/modules/web.dom-collections.iterator.js"),r("../node_modules/core-js/modules/web.dom-collections.for-each.js"),r("../node_modules/core-js/modules/es.array.sort.js"),r("../spread-sheet/src/core/view/spreadsheet-view/render-manager/alloy-excel/canvas/renderer/BaseRenderer.ts")),s=r("../spread-sheet/src/core/view/spreadsheet-view/render-manager/alloy-excel/canvas/collector/TextCollector.ts"),a=r("../spread-sheet/src/core/view/spreadsheet-view/render-manager/alloy-excel/canvas/collector/LineCollector.ts"),l=r("../spread-sheet/src/core/view/spreadsheet-view/render-manager/alloy-excel/canvas/collector/GraphicsCollector.ts"),c=r("../spread-sheet/src/core/view/spreadsheet-view/render-manager/alloy-excel/canvas/collector/BitmapCollector.ts"),d=r("../spread-sheet/src/core/view/spreadsheet-view/render-manager/alloy-excel/canvas/collector/RoundRectCollector.ts"),h=r("../spread-sheet/src/core/view/spreadsheet-view/render-manager/alloy-excel/canvas/collector/Path2dCollector.ts");!function(e){e[e.COPY_FRAME=1]="COPY_FRAME",e[e.WATER_MARK=2]="WATER_MARK",e[e.RANGTH_AUTH_BACKGROUND=3]="RANGTH_AUTH_BACKGROUND",e[e.RANGTH_AUTH_HIGHLIGHT=4]="RANGTH_AUTH_HIGHLIGHT",e[e.CHART_RANGE=5]="CHART_RANGE",e[e.FILTER_RANGE=6]="FILTER_RANGE",e[e.FILTER_HEADER=7]="FILTER_HEADER",e[e.COVER_BACKGROUND=8]="COVER_BACKGROUND",e[e.CELL_CORNER=9]="CELL_CORNER",e[e.COLLAB_CELL_CURSOR=10]="COLLAB_CELL_CURSOR",e[e.COMMENT_HIGHLIGHT=11]="COMMENT_HIGHLIGHT",e[e.COMMENT=12]="COMMENT",e[e.DATA_BAR=13]="DATA_BAR",e[e.VALIDATION_HEADER=14]="VALIDATION_HEADER",e[e.DATE_REMINDER=15]="DATE_REMINDER",e[e.FORMULA_LOADING=16]="FORMULA_LOADING",e[e.MENTION=17]="MENTION",e[e.PREVIEW_IMAGE=18]="PREVIEW_IMAGE",e[e.AREA_HIGHLIGHT=19]="AREA_HIGHLIGHT",e[e.SEARCH_HIGHLIGHT=20]="SEARCH_HIGHLIGHT",e[e.IMAGE_CELL=21]="IMAGE_CELL",e[e.SELECT_ROW_COL_HIGHLIGHT=22]="SELECT_ROW_COL_HIGHLIGHT",e[e.CELL_MASK=23]="CELL_MASK",e[e.CORNER_TRIANGLE=24]="CORNER_TRIANGLE"}(i||(i={}));var u=function(){function e(e){this._collectorVector=[],this._collectorMap=new Map,this._textCollector=new s.Z(n.hy[n.g4.TextRenderer],this),this._lineCollector=new a.Z(n.hy[n.g4.LineRenderer],this,e),this._graphicsCollector=new l.Z(n.hy[n.g4.GraphicsRender],this),this._bitmapCollector=new c.Z(n.hy[n.g4.BitmapRenderer],this),this._roundRectCollector=new d.Z(n.hy[n.g4.RoundRectRenderer],this),this._path2dCollector=new h.Z(n.hy[n.g4.Path2dRenderer],this),this.spreadsheet=e,this._collectorVector=[this._textCollector,this._lineCollector,this._graphicsCollector,this._bitmapCollector,this._roundRectCollector,this._path2dCollector],this._sort(),this._collectorMap.set("DefaultText",this._textCollector),this._collectorMap.set("DefaultLine",this._lineCollector),this._collectorMap.set("DefaultGraphics",this._graphicsCollector),this._collectorMap.set("DefaultBitmap",this._bitmapCollector),this._collectorMap.set("DefaultRoundRect",this._roundRectCollector),this._collectorMap.set("DefaultPath2d",this._path2dCollector)}var t=e.prototype;return t.add=function(e,t){if(this._collectorMap.has(e))throw new Error("收集器重名，请检查");this._collectorMap.set(e,t),this._collectorVector.push(t),this._sort()},t.get=function(e){return this._collectorMap.get(e)},t.clear=function(){this._collectorVector.forEach((function(e){e.clear()})),this.clearCollectOption()},t.generateCollector=function(e,t){switch(e){case n.g4.LineRenderer:return new a.Z(t,this,this.spreadsheet);case n.g4.TextRenderer:return new s.Z(t,this);case n.g4.BitmapRenderer:return new c.Z(t,this);case n.g4.GraphicsRender:return new l.Z(t,this);case n.g4.RoundRectRenderer:return new d.Z(t,this);case n.g4.Path2dRenderer:return new h.Z(t,this);default:throw new Error("Error-RenderCollector: generateCollector")}},t.setCollectOption=function(e){this._collectOption=e},t.clearCollectOption=function(){this._collectOption=null},t._sort=function(){this._collectorVector.sort((function(e,t){return e.compare(t)}))},(0,o.Z)(e,[{key:"textCollector",get:function(){return this._textCollector}},{key:"lineCollector",get:function(){return this._lineCollector}},{key:"graphicsCollector",get:function(){return this._graphicsCollector}},{key:"bitmapCollector",get:function(){return this._bitmapCollector}},{key:"roundRectCollector",get:function(){return this._roundRectCollector}},{key:"path2dCollector",get:function(){return this._path2dCollector}},{key:"collectors",get:function(){return this._collectorVector}},{key:"collectOption",get:function(){return this._collectOption}}]),e}();t.Z=u},"../spread-sheet/src/core/view/spreadsheet-view/render-manager/alloy-excel/canvas/collector/BaseCollector.ts":function(e,t,r){r.d(t,{Z:function(){return i}});var i=function(){function e(e,t){this.level=e,this.collectorEngine=t}return e.prototype.compare=function(e){return this.level>e.level?1:-1},e}()},"../spread-sheet/src/core/view/spreadsheet-view/render-manager/alloy-excel/canvas/collector/BitmapCollector.ts":function(e,t,r){var i=r("../node_modules/@babel/runtime/helpers/esm/createClass.js"),o=r("../node_modules/@babel/runtime/helpers/esm/inheritsLoose.js"),n=(r("../node_modules/core-js/modules/es.array.includes.js"),r("../node_modules/core-js/modules/es.string.includes.js"),function(e){function t(){var t;return(t=e.apply(this,arguments)||this)._renderInfos=[],t}(0,o.Z)(t,e);var r=t.prototype;return r.collect=function(e,t){var r,i;t&&(null===(i=null===(r=this.collectorEngine.collectOption)||void 0===r?void 0:r.exclude)||void 0===i?void 0:i.includes(t))||this._renderInfos.push(e)},r.clear=function(){this._renderInfos=[]},(0,i.Z)(t,[{key:"renderInfos",get:function(){return this._renderInfos}}]),t}(r("../spread-sheet/src/core/view/spreadsheet-view/render-manager/alloy-excel/canvas/collector/BaseCollector.ts").Z));t.Z=n},"../spread-sheet/src/core/view/spreadsheet-view/render-manager/alloy-excel/canvas/collector/GraphicsCollector.ts":function(e,t,r){var i=r("../node_modules/@babel/runtime/helpers/esm/createClass.js"),o=r("../node_modules/@babel/runtime/helpers/esm/inheritsLoose.js"),n=(r("../node_modules/core-js/modules/es.array.includes.js"),r("../node_modules/core-js/modules/es.string.includes.js"),function(e){function t(){var t;return(t=e.apply(this,arguments)||this)._renderInfos={colorInfo:{},canvasPatternInfo:[]},t}(0,o.Z)(t,e);var r=t.prototype;return r.collect=function(e,t){var r,i;t&&(null===(i=null===(r=this.collectorEngine.collectOption)||void 0===r?void 0:r.exclude)||void 0===i?void 0:i.includes(t))||(void 0===e.canvasPattern?(Object.prototype.hasOwnProperty.call(this._renderInfos.colorInfo,e.color)||(this._renderInfos.colorInfo[e.color]=[]),this._renderInfos.colorInfo[e.color].push(e.graphicsInfo)):this._renderInfos.canvasPatternInfo.push({path:e.graphicsInfo.path,clipInfo:e.graphicsInfo.clipInfo,canvasPattern:e.canvasPattern}))},r.clear=function(){this._renderInfos={colorInfo:{},canvasPatternInfo:[]}},(0,i.Z)(t,[{key:"renderInfos",get:function(){return this._renderInfos}}]),t}(r("../spread-sheet/src/core/view/spreadsheet-view/render-manager/alloy-excel/canvas/collector/BaseCollector.ts").Z));t.Z=n},"../spread-sheet/src/core/view/spreadsheet-view/render-manager/alloy-excel/canvas/collector/LineCollector.ts":function(e,t,r){var i=r("../node_modules/@babel/runtime/helpers/esm/toConsumableArray.js"),o=r("../node_modules/@babel/runtime/helpers/esm/createClass.js"),n=r("../node_modules/@babel/runtime/helpers/esm/inheritsLoose.js"),s=(r("../node_modules/core-js/modules/es.array.includes.js"),r("../node_modules/core-js/modules/es.string.includes.js"),r("../packages/model/src/cell/format/Color.ts")),a=r("../spread-sheet/src/core/view/spreadsheet-view/render-manager/alloy-excel/canvas/collector/BaseCollector.ts"),l=r("../spread-sheet/src/core/view/config/default.ts"),c=r("../spread-sheet/src/core/view/spreadsheet-view/render-manager/alloy-excel/utils.ts"),d=function(e){function t(t,r,i){var o;return(o=e.call(this,t,r)||this)._renderInfos={},o.spreadsheet=i,o}(0,n.Z)(t,e);var r=t.prototype;return r.collect=function(e,t){var r,o;if((!t||!(null===(o=null===(r=this.collectorEngine.collectOption)||void 0===r?void 0:r.exclude)||void 0===o?void 0:o.includes(t)))&&e.lineProp.style!==c.j.NONE){var n=this._toHash(e.lineProp);this._renderInfos[n]||(this._renderInfos[n]=[]),this._renderInfos[n].push((0,i.Z)(e.line))}},r.clear=function(){this._renderInfos={}},r._toHash=function(e){var t=l.ws.hex;return e.color&&(t=s.Z.isTargetType(e.color)?s.Z.getColorHexCode(e.color,this.spreadsheet):e.color.hex),e.style+"-"+e.width+"-"+t},(0,o.Z)(t,[{key:"renderInfos",get:function(){return this._renderInfos}}]),t}(a.Z);t.Z=d},"../spread-sheet/src/core/view/spreadsheet-view/render-manager/alloy-excel/canvas/collector/Path2dCollector.ts":function(e,t,r){var i,o=r("../node_modules/@babel/runtime/helpers/esm/createClass.js"),n=r("../node_modules/@babel/runtime/helpers/esm/inheritsLoose.js"),s=(r("../node_modules/core-js/modules/es.array.includes.js"),r("../node_modules/core-js/modules/es.string.includes.js"),r("../spread-sheet/src/core/view/spreadsheet-view/render-manager/alloy-excel/canvas/collector/BaseCollector.ts"));!function(e){e.NONZERO="nonzero",e.EVENODD="evenodd"}(i||(i={}));var a=function(e){function t(){var t;return(t=e.apply(this,arguments)||this)._renderInfos={},t}(0,n.Z)(t,e);var r=t.prototype;return r.collect=function(e,t){var r,i;if(!t||!(null===(i=null===(r=this.collectorEngine.collectOption)||void 0===r?void 0:r.exclude)||void 0===i?void 0:i.includes(t))){var o=e.type;this._renderInfos[o]||(this._renderInfos[o]=[]),this._renderInfos[o].push(e)}},r.clear=function(){this._renderInfos={}},(0,o.Z)(t,[{key:"renderInfos",get:function(){return this._renderInfos}}]),t}(s.Z);t.Z=a},"../spread-sheet/src/core/view/spreadsheet-view/render-manager/alloy-excel/canvas/collector/RoundRectCollector.ts":function(e,t,r){var i=r("../node_modules/@babel/runtime/helpers/esm/createClass.js"),o=r("../node_modules/@babel/runtime/helpers/esm/inheritsLoose.js"),n=(r("../node_modules/core-js/modules/es.array.includes.js"),r("../node_modules/core-js/modules/es.string.includes.js"),function(e){function t(t,r){var i;return(i=e.call(this,t,r)||this)._renderInfos=[],i}(0,o.Z)(t,e);var r=t.prototype;return r.collect=function(e,t){var r,i;t&&(null===(i=null===(r=this.collectorEngine.collectOption)||void 0===r?void 0:r.exclude)||void 0===i?void 0:i.includes(t))||this._renderInfos.push({roundRectProp:e.roundRectProp,roundRectInfo:e.roundRectInfo})},r.clear=function(){this._renderInfos.length=0},(0,i.Z)(t,[{key:"renderInfos",get:function(){return this._renderInfos}}]),t}(r("../spread-sheet/src/core/view/spreadsheet-view/render-manager/alloy-excel/canvas/collector/BaseCollector.ts").Z));t.Z=n},"../spread-sheet/src/core/view/spreadsheet-view/render-manager/alloy-excel/canvas/collector/TextCollector.ts":function(e,t,r){var i=r("../node_modules/@babel/runtime/helpers/esm/createClass.js"),o=r("../node_modules/@babel/runtime/helpers/esm/inheritsLoose.js"),n=function(e){function t(){var t;return(t=e.apply(this,arguments)||this)._renderInfos={},t}(0,o.Z)(t,e);var r=t.prototype;return r.collect=function(e){var t=e.textPropHash;Object.prototype.hasOwnProperty.call(this._renderInfos,t)||(this._renderInfos[t]=[]),this._renderInfos[t].push(e.textInfo)},r.clear=function(){this._renderInfos={}},(0,i.Z)(t,[{key:"renderInfos",get:function(){return this._renderInfos}}]),t}(r("../spread-sheet/src/core/view/spreadsheet-view/render-manager/alloy-excel/canvas/collector/BaseCollector.ts").Z);t.Z=n},"../spread-sheet/src/core/view/spreadsheet-view/render-manager/alloy-excel/canvas/renderer/BaseRenderer.ts":function(e,t,r){var i;r.d(t,{DF:function(){return l},ZP:function(){return n},g4:function(){return o},hy:function(){return a}});var o,n=function(){function e(){}return e.prototype.setCtx=function(e){this._ctx=e},e}();!function(e){e[e.GraphicsRender=0]="GraphicsRender",e[e.RoundRectRenderer=1]="RoundRectRenderer",e[e.LineRenderer=2]="LineRenderer",e[e.TextRenderer=3]="TextRenderer",e[e.BitmapRenderer=4]="BitmapRenderer",e[e.Path2dRenderer=5]="Path2dRenderer"}(o||(o={}));var s,a=((i={})[o.GraphicsRender]=0,i[o.RoundRectRenderer]=10,i[o.TextRenderer]=20,i[o.LineRenderer]=30,i[o.BitmapRenderer]=40,i[o.Path2dRenderer]=40,i),l={CommentHighlight:a[o.GraphicsRender]+3,RangeAuthLine:a[o.GraphicsRender]+2,RangeAuthBackground:a[o.GraphicsRender]+2,CoverBackground:a[o.GraphicsRender]+2,RowColTriangle:a[o.GraphicsRender]+3,HighlightAnimate:a[o.GraphicsRender]+3,MentionTriangle:a[o.RoundRectRenderer]+1,CollabBorder:a[o.LineRenderer]+1,DataBar:a[o.GraphicsRender]+2,ChartRange:a[o.LineRenderer]+2,FormulaBackGroundMask:a[o.TextRenderer]+1,FormulaTextMask:a[o.TextRenderer]+1,SelectRowColHighlight:a[o.GraphicsRender]+7,ShapeToCellHighlight:a[o.GraphicsRender]+7};!function(e){e[e.DATE_REMINDER_ICON=0]="DATE_REMINDER_ICON"}(s||(s={}))},"../spread-sheet/src/core/view/spreadsheet-view/render-manager/alloy-excel/interface.ts":function(e,t,r){var i;r.d(t,{M:function(){return i}}),function(e){e[e.COLOR=0]="COLOR",e[e.FONT_SIZE=1]="FONT_SIZE",e[e.FONT_FAMILY=2]="FONT_FAMILY",e[e.BOLD=3]="BOLD",e[e.ITALIC=4]="ITALIC",e[e.UNDERLINE=5]="UNDERLINE",e[e.STRIKETHROUGH=6]="STRIKETHROUGH"}(i||(i={}))},"../spread-sheet/src/core/view/spreadsheet-view/render-manager/alloy-excel/table/body/cell-renders/impl/image-cell-render.ts":function(e,t,r){r.d(t,{f_:function(){return _},xl:function(){return p}});var i=r("../node_modules/@babel/runtime/helpers/esm/inheritsLoose.js"),o=r("../packages/model/src/embedded/index.ts"),n=r("../spread-sheet/src/core/view/spreadsheet-view/row-col-accessor/RowcolAccessor.ts"),s=r("../spread-sheet/src/core/view/spreadsheet-view/transform-table/cell.ts"),a=r("../spread-sheet/src/core/view/spreadsheet-view/render-manager/alloy-excel/table/body/cell-renders/base-cell-render.ts"),l=r("../node_modules/lodash/set.js"),c=r.n(l),d=r("../spread-sheet/src/core/view/spreadsheet-view/render-manager/alloy-excel/table/body/cell-renders/util.ts"),h=r("../spread-sheet/src/core/utils/ImageLoader.ts"),u=r("../node_modules/@tencent/docs-design-resources/pc/svg/placeholder_48_image.svg"),f=new Image;f.src=u;var g=function(e){function t(){var t;return(t=e.apply(this,arguments)||this).dwtRecordCellImage=window.__DWT__recordCellImage,t}(0,i.Z)(t,e);var o=t.prototype;return o.renderText=function(e,t){var r=t.x,i=t.y,o=t.cellWidth,n=t.cellHeight,s=t.transformCell,a=s.image,l=s.horizontalAlign,d=s.verticalAlign,u=t.row,g=t.col,_=e.bitmapCollector,v=a.url,w=h.ZP.getCachedImage(v);if(!w){if(!h.ZP.hasPicFailed(v))return;w=f}var m=p({image:a,cellWidth:o-1,cellHeight:n-1,horizontalAlign:l,verticalAlign:d,imageElement:w}),C={dx:r+m.dx,dy:i+m.dy,dWidth:m.dWidth,dHeight:m.dHeight,img:w,sx:m.sx,sy:m.sy,sWidth:m.sWidth,sHeight:m.sHeight};_.collect(C),this.dwtRecordCellImage&&c()(window,["cellImageConfigs",u,g],C)},o.renderTextCheck=function(e){var t=this,r=e.cellWidth,i=e.cellHeight,o=e.transformCell.image;if(!o||!o.url)return!1;if(h.ZP.hasPicFailed(o.url))return!0;var n=(0,h.yc)(o,r,i);return h.ZP.preLoadImageToAppCache(o.url,n).then((function(e){e&&t.tryRerender()})).catch((function(e){console.error(e),t.tryRerender()})),!0},o.tryRerender=function(){try{r.g.SpreadsheetApp.view.canvas.renderApi.renderNextTick()}catch(e){console.error(e)}},t}(a.Z);function p(e){var t=e.image,r=e.cellWidth,i=e.cellHeight,o=e.horizontalAlign,n=e.verticalAlign,s=e.imageElement,a=t.position.overlayPosition,l=a.widthPixels,c=a.heightPixels,u=t.clipInfo,f=u.clipBottom,g=u.clipLeft,p=u.clipRight,_=u.clipTop,v=l+g+p,w=c+_+f,m=0,C=0,y=0,R=0;if(s){var x=(0,h.L1)(s),D=x.naturalWidth,E=x.naturalHeight;m=D*l/v,C=E*c/w,y=D*g/v,R=E*_/w}var S=l/c,I=0,b=0;S>r/i?b=(I=r)/S:I=(b=i)*S;var T=I/l,A=(0,d.F)({cellWidth:r,cellHeight:i,dWidth:I,dHeight:b,horizontalAlign:o,verticalAlign:n});return{dx:A.dx,dy:A.dy,dWidth:I,dHeight:b,scale:T,sx:y,sy:R,sWidth:m,sHeight:C}}function _(e,t,r){var i=e.getCellImage(t,r),a=e.getCellDataAtPosition(t,r);if(!i||!a)return null;var l=p({image:i,cellWidth:e.getColWidth(r),cellHeight:(0,n.O)(e,t),horizontalAlign:(0,s.PE)(a),verticalAlign:(0,s.YW)(a)}),c=l.dx,d=l.dy,h=l.scale,u=i.position.overlayPosition,f=u.zIndex,g=u.heightPixels,_=u.widthPixels,v=i.clipInfo,w=v.clipBottom,m=v.clipLeft,C=v.clipRight,y=v.clipTop;return{overlayPosition:new o.OverlayPosition({anchorCell:{rowIndex:t,colIndex:r},offsetXpixels:c,offsetYpixels:d,zIndex:f,heightPixels:g*h,widthPixels:_*h}),clipInfo:new o.EmbeddedImageClip({clipLeft:m*h,clipRight:C*h,clipTop:y*h,clipBottom:w*h})}}t.ZP=g},"../spread-sheet/src/core/view/spreadsheet-view/render-manager/alloy-excel/table/body/cell-renders/util.ts":function(e,t,r){function i(e){var t=e.cellWidth,r=e.cellHeight,i=e.horizontalAlign,o=e.verticalAlign,n=e.dWidth,s=e.dHeight,a=e.marginX,l=void 0===a?0:a,c=e.marginY,d=void 0===c?0:c,h=0,u=0;switch(i.value){case"left":h=l;break;case"center":h=(t-n)/2;break;case"right":h=t-n-l}switch(o.value){case"top":u=d;break;case"middle":u=(r-s)/2;break;case"bottom":u=r-s-d}return{dx:h,dy:u}}function o(e){var t=e.match(/^([\d\\.]+)%$/);if(!t)return null;var r=Number(t[1]);return isNaN(r)||r<0||r>100?null:r}r.d(t,{F:function(){return i},G:function(){return o}}),r("../node_modules/core-js/modules/es.regexp.exec.js"),r("../node_modules/core-js/modules/es.string.match.js"),r("../node_modules/core-js/modules/es.number.constructor.js")},"../spread-sheet/src/core/view/spreadsheet-view/render-manager/alloy-excel/table/body/customize-textprop/customize-textprop.ts":function(e,t,r){r.d(t,{d:function(){return a}});var i=r("../packages/model/src/cell/metadata/CustomDataType.ts"),o=(r("../node_modules/core-js/modules/es.string.bold.js"),r("../node_modules/core-js/modules/es.string.italics.js"),r("../packages/editor/src/helper/utils.ts")),n=r("../spread-sheet/src/core/view/spreadsheet-view/model/Color.ts"),s=r("../spread-sheet/src/core/view/spreadsheet-view/model/TextProp.ts");function a(e,t,r){var a,l,c=null===(a=e.metadata)||void 0===a?void 0:a.customDataType;return c===i.ZP.STAFF_CARD||c===i.ZP.GROUP_CARD||c===i.ZP.SCHEDULE||c===i.ZP.THIRD_PARTY_APP||c===i.ZP.MINI_APP?function(e,t){var r=e.fontSize,i=e.fontFamily;return{hash:s.Z.newInstance({color:n.Z.newInstanceByHex("#267EF0"),bold:!1,italic:!1,underline:!1,strikethrough:!1,fontSize:r,fontFamily:i},t).hash,underline:!1,strikethrough:!1}}(t,r):(null===(l=null===e||void 0===e?void 0:e.todoRange)||void 0===l?void 0:l.isDone)?function(e,t){var r=e.color,i=e.fontSize,a=e.fontFamily,l=e.bold,c=e.italic,d=e.underline,h=e.strikethrough,u=n.Z.newInstanceByHex((0,o.s)(r)),f=u.red,g=u.green,p=u.blue;return{hash:s.Z.newInstance({color:n.Z.newInstanceByRGB(f,g,p,.4),fontSize:i,fontFamily:a,bold:l,italic:c,underline:d,strikethrough:h},t).hash,underline:d,strikethrough:h}}(t,r):{hash:t.hash,underline:t.underline,strikethrough:t.strikethrough}}},"../spread-sheet/src/core/view/spreadsheet-view/render-manager/alloy-excel/table/corner/utils/render-color.ts":function(e,t,r){r.d(t,{Et:function(){return s},a8:function(){return o},hB:function(){return n},zP:function(){return a}});var i=r("../spread-sheet/src/core/view/spreadsheet-view/model/Color.ts"),o=i.Z.newInstanceByHex("#babdc1"),n=i.Z.newInstanceByHex("#4b8cff"),s=i.Z.newInstanceByHex("#f9fafb"),a=i.Z.newInstanceByHex("#c2c2c2")},"../spread-sheet/src/core/view/spreadsheet-view/render-manager/alloy-excel/table/corner/utils/render-path.ts":function(e,t,r){function i(e,t){return[e-4,4,e-4,t-4,e-t+4,t-4]}function o(e,t){return[0,0,e,0,e,t,0,t]}r.d(t,{au:function(){return o},ns:function(){return i}})},"../spread-sheet/src/core/view/spreadsheet-view/render-manager/alloy-excel/utils.ts":function(e,t,r){var i,o;r.d(t,{j:function(){return i},v:function(){return o}}),function(e){e[e.NONE=0]="NONE",e[e.THIN=3]="THIN",e[e.MEDIUM=2]="MEDIUM",e[e.DASHED=1]="DASHED",e[e.DOTTED=4]="DOTTED",e[e.THICK=5]="THICK",e[e.DOUBLE=6]="DOUBLE",e[e.HAIR=7]="HAIR",e[e.MEDIUM_DASHED=8]="MEDIUM_DASHED",e[e.DASH_DOT=9]="DASH_DOT",e[e.MEDIUM_DASH_DOT=10]="MEDIUM_DASH_DOT",e[e.DASH_DOT_DOT=11]="DASH_DOT_DOT",e[e.MEDIUM_DASH_DOT_DOT=12]="MEDIUM_DASH_DOT_DOT",e[e.SLANTED_DASH_DOT=13]="SLANTED_DASH_DOT"}(i||(i={})),function(e){e[e.NONE=0]="NONE",e[e.THIN=1]="THIN",e[e.MEDIUM=2]="MEDIUM",e[e.THICK=3]="THICK"}(o||(o={}))},"../spread-sheet/src/core/view/spreadsheet-view/row-col-accessor/RowcolAccessor.ts":function(e,t,r){r.d(t,{O:function(){return h},Z:function(){return u}});var i=r("../node_modules/@babel/runtime/helpers/esm/assertThisInitialized.js"),o=r("../node_modules/@babel/runtime/helpers/esm/inheritsLoose.js"),n=(r("../node_modules/core-js/modules/es.object.keys.js"),r("../node_modules/core-js/modules/es.array.concat.js"),r("../spread-sheet/src/core/view/spreadsheet-view/accessor/BaseRowAccessor.ts")),s=function(e){function t(t){var i;return(i=e.call(this)||this)._handleRowChange=function(e){for(var t=e.ranges,r=e.sheetId,o=0;o<t.length;o++)for(var n=t[o],s=n.startIndex;s<=n.endIndex;s++)i._updateRowDisplayHeightIfNeed(s,r)},i._handleColChange=function(e){var t=i._spreadsheet.sheetManager.getSheetBySheetId(e.sheetId);if(t)for(var o=0;o<t.getRowCount();o++)i._updateRowDisplayHeightIfNeed(o,e.sheetId);else r.g.log.error("RecalculateListener _handleColChange: sheetId is invalid")},i._handleCellsChange=function(e){var t=e.startRow,o=e.endRow,n=e.sheetId;if(i._spreadsheet.sheetManager.getSheetBySheetId(e.sheetId))for(var s=t;s<=o;s++)i._updateRowDisplayHeightIfNeed(s,n);else r.g.log.error("RecalculateListener _handleCellsChange: sheetId is invalid")},i._dataCallView=t.dataCallView,i._spreadsheet=t.spreadsheet,i._getSetHeight=t.getSetHeight,i._calcRowDisplayHeight=t.calc,i._register(i._dataCallView.onSetRowHeight(i._handleRowChange)),i._register(i._dataCallView.onSetColWidth(i._handleColChange)),i._register(i._dataCallView.onSetColVisible(i._handleColChange)),i._register(i._dataCallView.onUpdateCells(i._handleCellsChange)),i}return(0,o.Z)(t,e),t.prototype._updateRowDisplayHeightIfNeed=function(e,t){"undefined"===typeof this._getSetHeight(e,t)&&this._calcRowDisplayHeight(e,t)},t}(r("../node_modules/@tencent/containerized/build/main/index.js").JT),a=r("../spread-sheet/src/core/view/spreadsheet-view/paragraph-accessor/ParagraphAccessor.ts"),l=r("../packages/model/src/config/index.ts");function c(e,t,r){for(var i,o=[],n=0;n<e.getColCount();n++){var s=e.getCellDataAtPosition(t,n);if(null===s||void 0===s?void 0:s.getMergeReference()){if(s.getMergeReference().startColIndex!==n)continue;var c=null===(i=s.getMergeReference())||void 0===i?void 0:i.getRowCount();if(c&&c>1)continue}var d=null;(d=r?r.getParagraph(t,n,e.getSheetId()):(0,a.F)(e,t,n).paragraph)&&o.push(d.height)}return Math.max.apply(Math,o.concat([l.DEFAULT_ROW_HEIGHT]))}function d(e,t){var r=(e.filterViewManager.getActiveFilterView()||e).getRowProperties(t);if(r&&null!==r.pixelSize&&0!==r.pixelSize)return r.pixelSize}function h(e,t,r){var i=d(e,t);return void 0!==i?i:(c(e,t,r)||l.DEFAULT_ROW_HEIGHT)>>0}var u=function(e){function t(t){var o;return(o=e.call(this,t)||this).inputCellRowHeight=0,o.shouldUseInputCellData=function(e){return o.inputCellData&&e===o.inputRow},o._calcRowDisplayHeight=function(e,t){var i=o.getTargetSheet(t);if(i){o._rowData[t]||o.init(t);var n=c(i,e,o._paragraphAccessor);o._setRowDisplayHeight(e,n,t)}else r.g.log.error("RowcolAccessor _calcRowDisplayHeight: sheetId is invalid")},o._paragraphAccessor=t.paragraphAccessor,o._recalculateListener=o._register(new s({dataCallView:o._dataCallView,spreadsheet:o._spreadsheet,getSetHeight:o.getRowSetHeight.bind((0,i.Z)(o)),calc:o._calcRowDisplayHeight})),o.init(t.spreadsheet.activeSheetId),o}(0,o.Z)(t,e);var n=t.prototype;return n.refresh=function(e){this._rowData[e]&&0!==Object.keys(this._rowData[e]).length||this.init(e)},n.setInputCellData=function(e,t,r){this.inputRow=e,this.inputCellData=r;var i,o=this._spreadsheet.activeSheet;(i=this._paragraphAccessor.getParagraph(e,t,o.getSheetId()))&&this.inputCellRowHeight!==i.height&&(this.inputCellRowHeight=i.height,this._dataCallView.setRowHeight(e,i.height,o.getSheetId()))},n.clearInputCellData=function(){this.inputRow=-1,this.inputCellData=null,this.inputCellRowHeight=0},n.getRowSetHeight=function(e,t){if(t){var r=this.getTargetSheet(t);if(r)return d(r,e)}return d(this._spreadsheet.activeSheet,e)},n.getColSetWidth=function(e,t){if(t){var r=this.getTargetSheet(t);if(r)return r.getColWidth(e)>>0}return this._spreadsheet.activeSheet.getColWidth(e)>>0},n.getRowDisplayHeight=function(e,t){var r,i,o=this.shouldUseInputCellData(e),n=t||this._spreadsheet.activeSheetId,s=this.getRowSetHeight(e,n);return void 0!==s?i=s:(i=((null===(r=this._rowData[n])||void 0===r?void 0:r.row_display_height[e])||l.DEFAULT_ROW_HEIGHT)>>0,o&&(i=Math.max(this.inputCellRowHeight,i)),i)},n.getRowCount=function(e){if(e){var t=this.getTargetSheet(e);if(t)return t.getRowCount()}return this._spreadsheet.activeSheet.getRowCount()},n.getColCount=function(e){if(e){var t=this.getTargetSheet(e);if(t)return t.getColCount()}return this._spreadsheet.activeSheet.getColCount()},n.getFrozenRowCount=function(e){if(e){var t=this.getTargetSheet(e);if(t)return t.getFrozenRowCount()}return this._spreadsheet.activeSheet.getFrozenRowCount()},n.getFrozenColCount=function(e){if(e){var t=this.getTargetSheet(e);if(t)return t.getFrozenColCount()}return this._spreadsheet.activeSheet.getFrozenColCount()},n.isRowHidden=function(e,t){if(t){var r=this.getTargetSheet(t);if(r)return r.isRowHidden(e)}return this._spreadsheet.activeSheet.isRowHidden(e)},n.isColHidden=function(e,t){if(t){var r=this.getTargetSheet(t);if(r)return r.isColHidden(e)}return this._spreadsheet.activeSheet.isColHidden(e)},n.init=function(e){var t;r.g.log.info("RowcolAccessor init",e);var i=this.getTargetSheet(e);if(i){this._rowData[e]=((t={}).row_display_height=[],t);for(var o=i.getRowCount()-1,n=0;n<=o;n++)this._calcRowDisplayHeight(n,i.getSheetId())}else r.g.log.error("RowcolAccessor _init: sheetId is invalid",e)},n.getColsWidth=function(e,t){for(var r=0,i=e;i<=t;i++)this.isColHidden(i)||(r+=this.getColSetWidth(i));return r},n.getRowsHeight=function(e,t){for(var r=0,i=e;i<=t;i++)this.isRowHidden(i)||(r+=this.getRowDisplayHeight(i));return r},n._setRowDisplayHeight=function(e,t,r){var i;this._rowData[r]||(this._rowData[r]=((i={}).row_display_height=[],i)),this._rowData[r].row_display_height[e]!==t&&(this._rowData[r].row_display_height[e]=t,this._dataCallView.setRowHeight(e,t,r))},t}(n.Z)},"../spread-sheet/src/core/view/spreadsheet-view/row-col-accessor/utils.ts":function(e,t,r){function i(e){for(var t=0,r=e.getRowCount();t<r;){if(!e.isRowHidden(t))return t;t+=1}return null}function o(e){for(var t=e.getRowCount()-1;t>=0;){if(!e.isRowHidden(t))return t;t-=1}return null}function n(e){for(var t=0,r=e.getColCount();t<r;){if(!e.isColHidden(t))return t;t+=1}return null}function s(e){for(var t=e.getColCount()-1;t>=0;){if(!e.isColHidden(t))return t;t-=1}return null}r.d(t,{HN:function(){return o},Ho:function(){return n},kq:function(){return i},qA:function(){return s}})},"../spread-sheet/src/core/view/spreadsheet-view/row-cover-accessor/utils.ts":function(e,t,r){r.d(t,{$G:function(){return n},NZ:function(){return o},bE:function(){return s}});var i=r("../spread-sheet/src/core/view/spreadsheet-view/transform-table/cell.ts");function o(e){return null===e||!(0,i.nv)(e).length}function n(e){return null!==e&&!!e.getMergeReference()}function s(e,t,r,i){var o=t.getMergeReference();if(!o)return e.getColSetWidth(r,i);for(var n=0,s=o.startColIndex;s<o.endColIndex;s++)e.isColHidden(s,i)||(n+=e.getColSetWidth(s,i));return n}},"../spread-sheet/src/core/view/spreadsheet-view/table-view/utils.ts":function(e,t,r){r.d(t,{$x:function(){return m},EL:function(){return h},Fs:function(){return w},Jj:function(){return g},Tk:function(){return u},Z6:function(){return f},gB:function(){return d},gi:function(){return p},hy:function(){return v},u_:function(){return C},vJ:function(){return _}});var i=r("../spread-sheet/src/core/data/configService/spreadConfig.ts"),o=r("../spread-sheet/src/core/feature/dataValidation/api/DataValidationUIUtils.ts"),n=r("../packages/model/src/range/index.ts"),s=r("../spread-sheet/src/core/feature/dataValidation/type.ts"),a=r("../packages/model/src/cell/index.ts"),l=r("../packages/model/src/cell/LinkIconType.ts"),c=r("../packages/model/src/cell/metadata/CustomDataType.ts");function d(e,t,i,o,n,s){var a;for(null===(a=r.g.log)||void 0===a||a.info("flow fragmentCellDataToCellView");t<=i;)e.cellDataToCellView(t,Math.min(t+50-1,i),o,n),t+=49,null===s||void 0===s||s()}function h(e,t,r){if(null===e)return!1;var i=e.getBasicFilter();if(null===i||void 0===i)return!1;var o=e.getCellDataAtPosition(t,r),s=i.range,a=null===o||void 0===o?void 0:o.getMergeReference();if(a){var l=new n.GridRange(s.sheetId,s.startRowIndex,s.startRowIndex,s.startColIndex,s.endColIndex);return t=a.startRowIndex,r=a.startColIndex,a.isCross(l)}return t===s.startRowIndex&&r>=s.startColIndex&&r<=s.endColIndex}function u(e,t,r){var i;if(null===e)return!1;var n=e.getCellDataAtPosition(t,r);if(!n)return!1;var a=n.getMergeReference();a&&(t=a.startRowIndex,r=a.startColIndex);var l=(0,o.Sc)(e,t,r);return!(!l||l.validType!==s.ob.LIST||!(null===(i=l.argTokens)||void 0===i?void 0:i.length))}function f(e,t){var r,i=!1;window.clientVars.isLogin&&window.clientVars.ownerNick&&(i=!0);var o=t.sheetStatus.workbookStatus.canEdit,n=function(e,t){if(null===e)return!1;var r=e.getBasicFilter();if(null===r||void 0===r)return!1;var i=r.range;return t.sheetStatus.getRangeCanEdit(i)&&t.sheetStatus.isRangeCanEditByHighWater(i)}(e,t),s=t.spreadsheet,a=s.isFilterSync,l=null===(r=s.activeSheet.getBasicFilter())||void 0===r?void 0:r.getIsLocalView();return i&&o&&!n&&a&&!l}function g(e){var t=!1,r=e.sheetStatus.canEdit;return i.q.getConfig("isLogin")&&(t=!0),t&&r}function p(e,t,r){var i=e.getCellDataAtPosition(t,r);return!!i&&!(!i.getHyperlink()&&!i.getHyperlinkRuns())&&(null===i||void 0===i?void 0:i.getHyperlinkType())!==a.HYPERLINK_TYPE.NORMAL&&i.getLinkIconStatus()===l.Z.WITH_IMAGE}function _(e,t,r){var i=e.getCellDataAtPosition(t,r);return(null===i||void 0===i?void 0:i.getCellType())===c.ZP.DATE_REMINDER}function v(e,t,r){var i=e.getCellDataAtPosition(t,r);return(null===i||void 0===i?void 0:i.isWeworkComponent())||!1}function w(e,t,r){var i=e.getCellViewAtPosition(t,r);return(null===i||void 0===i?void 0:i.mergeParent)?{row:t+i.mergeParent.y,col:r+i.mergeParent.x}:{row:t,col:r}}function m(e){e.mergeData&&(e.mergeData.colCount-=1,1===e.mergeData.colCount&&1===e.mergeData.rowCount&&(e.mergeData=void 0))}function C(e){e.mergeData&&(e.mergeData.rowCount-=1,1===e.mergeData.colCount&&1===e.mergeData.rowCount&&(e.mergeData=void 0))}},"../spread-sheet/src/core/view/spreadsheet-view/transform-table/DimensionMeta.ts":function(e,t,r){var i;r.d(t,{i:function(){return i}}),function(e){e[e.DEFAULT=0]="DEFAULT",e[e.SELECT_ACTIVE=100]="SELECT_ACTIVE",e[e.SELECT_SELECTED=200]="SELECT_SELECTED",e[e.FILTER_VIEW_ACTIVE=300]="FILTER_VIEW_ACTIVE",e[e.FILTER_VIEW_SELECTED=400]="FILTER_VIEW_SELECTED",e[e.FILTER_VIEW_DEFAULT=500]="FILTER_VIEW_DEFAULT"}(i||(i={}));var o=function(){function e(){this.index=0,this.status=i.DEFAULT,this.size=-1,this.fitLineExpand=0}var t=e.prototype;return t.setSize=function(e){this.size=e},t.expandFitLine=function(e){this.fitLineExpand=e},t.selected=function(e){this.status=e?i.FILTER_VIEW_SELECTED:i.SELECT_SELECTED},t.actived=function(e){if(this.status!==i.SELECT_SELECTED){if(e)return void(this.status=i.FILTER_VIEW_ACTIVE);this.status=i.SELECT_ACTIVE}},t.defaulted=function(e){e&&(this.status=i.FILTER_VIEW_DEFAULT)},t.resize=function(e){this.index=e,this.status=0,this.size=-1,this.fitLineExpand=0},e}();t.Z=o},"../spread-sheet/src/core/view/spreadsheet-view/transform-table/cell.ts":function(e,t,r){r.d(t,{FG:function(){return I},PE:function(){return R},PF:function(){return C},YW:function(){return x},fl:function(){return m},fs:function(){return D},jl:function(){return E},nv:function(){return w},qe:function(){return S},z1:function(){return y}});var i=r("../packages/model/src/cell/format/Color.ts"),o=r("../spread-sheet/src/core/view/spreadsheet-view/model/Color.ts"),n=r("../spread-sheet/src/core/view/config/default.ts"),s=r("../packages/model/src/index.ts"),a=r("../spread-sheet/src/core/view/spreadsheet-view/model/HorizontalAlign.ts"),l=r("../spread-sheet/src/core/view/spreadsheet-view/model/VerticalAlign.ts"),c=r("../spread-sheet/src/core/view/spreadsheet-view/model/WrapStrategy.ts"),d=r("../node_modules/@tencent/tdocs-format-render/lib/index.js"),h=r("../spread-sheet/src/core/view/spreadsheet-view/table-view/utils.ts"),u=r("../spread-sheet/src/core/view/spreadsheet-view/model/CellPadding.ts"),f=r("../packages/model/src/cell/LinkIconType.ts"),g=r("../spread-sheet/src/core/utils/cell.ts"),p=r("../spread-sheet/src/core/view/spreadsheet-view/model/TextProp.ts"),_=r("../packages/model/src/cell/metadata/CustomDataType.ts"),v=r("../packages/model/src/cell/index.ts");function w(e,t){var r,i=e.getEffectiveValue(),o=e.getFormattedValue();if(i&&i.type===s.Cell.EXTENDED_VALUE_TYPE.ERROR&&"object"===typeof i.value)return(null===(r=i.value)||void 0===r?void 0:r.displayText)||"";var n=null;return(null===o||void 0===o?void 0:o.type)!==s.Cell.FORMATTED_VALUE_TYPE.NORMAL&&(null===o||void 0===o?void 0:o.type)!==s.Cell.FORMATTED_VALUE_TYPE.ERROR||(n=o.value),e.getFormula()&&t&&(n=e.getEditValue()),n||""}function m(e,t,r){if(function(e,t,r){var i=e.getMergeReference();if(i){var o=i;return t===o.startRowIndex&&r===o.startColIndex}return!1}(e,t,r)){var i=e.getMergeReference();return{rowCount:i.endRowIndex-i.startRowIndex+1,colCount:i.endColIndex-i.startColIndex+1}}return null}function C(e,t,r){var i=e.getMergeReference();if(i){var o=i,n=o.startColIndex-r,s=o.startRowIndex-t;if(n||s)return{x:n,y:s}}return null}function y(e,t){if(!e)return n._4;var r=(0,g.getMergedFormatValue)(e,"getBackgroundColor");if(r){var s=i.Z.getColorRGBA(r,t),a=s.red,l=s.green,c=s.blue,d=s.alpha;return o.Z.newInstanceByRGB(a,l,c,d)}return n._4}function R(e){var t,r=(0,g.getMergedFormatValue)(e,"getHorizontalAlign"),i=e.getCellType();if((null===e||void 0===e?void 0:e.getLinkIconStatus())===f.Z.WITH_IMAGE||i===_.ZP.DATE_REMINDER||i==_.ZP.STAFF_CARD||i==_.ZP.GROUP_CARD||i==_.ZP.SCHEDULE||i==_.ZP.TODO||i===_.ZP.THIRD_PARTY_APP||i===_.ZP.MINI_APP)return t=n.YH;if(null!==r)t=r===s.Cell.Format.HORIZONTAL_ALIGN.LEFT?a.Z.newInstance(a.O.LEFT):r===s.Cell.Format.HORIZONTAL_ALIGN.CENTER?a.Z.newInstance(a.O.CENTER):a.Z.newInstance(a.O.RIGHT);else if(!r&&e.getEffectiveValue()){var o=s.Cell.cellDataUtils.getExportFormat(e),l=null===e||void 0===e?void 0:e.getHyperlinkType();if(l===v.HYPERLINK_TYPE.EMAIL_LINK||l===v.HYPERLINK_TYPE.PHONE_NUMBER_LINK)return n.YH;t=o&&(0,d.isTextCell)(o.getNumberFormat())?a.Z.newInstance(a.O.LEFT):e.getEffectiveValue().type===s.Cell.EXTENDED_VALUE_TYPE.BOOL||e.getEffectiveValue().type===s.Cell.EXTENDED_VALUE_TYPE.ERROR?a.Z.newInstance(a.O.CENTER):e.getEffectiveValue().type===s.Cell.EXTENDED_VALUE_TYPE.NUMBER?a.Z.newInstance(a.O.RIGHT):a.Z.newInstance(a.O.LEFT)}else t=n.YH;return t}function x(e){var t=(0,g.getMergedFormatValue)(e,"getVerticalAlign");return null!==t?t===s.Cell.Format.VERTICAL_ALIGN.TOP?l.Z.newInstance(l.o.TOP):t===s.Cell.Format.VERTICAL_ALIGN.MIDDLE?l.Z.newInstance(l.o.MIDDLE):l.Z.newInstance(l.o.BOTTOM):n.OC}function D(e){var t=(0,g.getMergedFormatValue)(e,"getWrapStrategy");return null!==t?t===s.Cell.Format.WRAP_STRATEGY.OVERFLOW_CELL?c.Z.newInstance(c.J.NOWRAP):t===s.Cell.Format.WRAP_STRATEGY.WRAP?c.Z.newInstance(c.J.NORMAL):n.mK:n.mK}function E(e,t,r){var i,o,s,a;if(s=(0,h.EL)(e,t,r)?u.i.ICON:((0,h.Tk)(e,t,r),u.i.TEXT),(0,h.gi)(e,t,r)||(0,h.vJ)(e,t,r)||(0,h.hy)(e,t,r)){var l=null===(o=null===(i=e.getCellDataAtPosition(t,r))||void 0===i?void 0:i.getUserEnteredFormat())||void 0===o?void 0:o.textFormat,c=((null===l||void 0===l?void 0:l.fontSize)||n.n5)/n.n5;a=u.i.TEXT+(u.i.ICON-u.i.TEXT)*c}else a=u.i.TEXT;return{paddingLeft:a,paddingRight:s}}function S(e,t){if(!e)return p.Z.newInstance(n.C8,t);var r=(0,g.getMergedFormatValue)(e,"getTextFormat")||{};return p.Z.newInstance(r,t)}function I(e,t){var r=i.Z.createColor(function(e,t){if(!e)return n.xw;var r=(0,g.getMergedFormatValue)(e,"getColor");if(!r)return n.xw;var s=i.Z.getColorRGBA(r,t),a=s.red,l=s.green,c=s.blue,d=s.alpha;return o.Z.newInstanceByRGB(a,l,c,d)}(e,t));return{textColor:r,bgColor:i.Z.createColor(y(e,t))}}},"../spread-sheet/src/core/view/spreadsheet-view/transform-table/head.ts":function(e,t,r){r.d(t,{BG:function(){return d},UW:function(){return h},Go:function(){return m},Lg:function(){return w}});var i,o=r("../spread-sheet/src/core/view/config/default.ts"),n=r("../spread-sheet/src/core/view/spreadsheet-view/model/Color.ts"),s=r("../spread-sheet/src/core/view/spreadsheet-view/render-manager/alloy-excel/utils.ts"),a=r("../packages/model/src/config/index.ts"),l=function(){function e(){this.hidden=!1,this.width=a.DEFAULT_COL_WIDTH,this.height=a.DEFAULT_ROW_HEIGHT,this.borderTop=null,this.borderRight=null,this.borderBottom=null,this.borderLeft=null,this.background=d[0],this.color=h[0],this.fitLineExpand=0}return e.prototype.reset=function(){this.hidden=!1,this.width=s.v.THIN,this.borderTop=null,this.borderRight=null,this.borderBottom=null,this.borderLeft=null,this.fitLineExpand=0},e}(),c=/(mobile)/i.test(null===(i=r.g.navigator)||void 0===i?void 0:i.userAgent.toLowerCase()),d={0:n.Z.newInstanceByHex("#f9fafb"),100:n.Z.newInstanceByHex("#eaebec"),200:n.Z.newInstanceByHex("#5f6266"),300:n.Z.newInstanceByHex("#81868f"),400:n.Z.newInstanceByHex("#c9ddff"),500:n.Z.newInstanceByHex("#464d5a")},h={0:n.Z.newInstanceByRGB(0,0,0,.88),100:n.Z.newInstanceByRGB(0,0,0,.88),200:n.Z.newInstanceByRGB(255,255,255,.88),300:n.Z.newInstanceByHex("#f5f5f5"),400:n.Z.newInstanceByRGB(0,0,0,.88),500:n.Z.newInstanceByHex("#f5f5f5")},u={0:o.Tx,100:o.Tx,200:o.Tx,300:o.u3,400:o.u3,500:o.u3},f={width:s.v.THIN,style:s.j.THIN,color:n.Z.newInstanceByHex("#4b8cff")},g={width:s.v.THIN,style:s.j.THIN,color:n.Z.newInstanceByHex("#1e6fff")},p={0:null,100:c?null:f,200:c?null:f,300:g,400:g},_=new l,v=new l;function w(e,t,r){var i=r.status,o=r.size;return _.reset(),_.hidden=t.isRowHidden(e),_.height=o>=0?o:t.getRowDisplayHeight(e),_.background=d[i],_.color=h[i],_.borderBottom=u[i],_.borderRight=p[i],_.fitLineExpand=r.fitLineExpand,_}function m(e,t,r){var i=r.status,o=r.size;return v.reset(),v.hidden=t.isColHidden(e),v.width=o>=0?o:t.getColSetWidth(e),v.background=d[i],v.color=h[i],v.borderRight=u[i],v.borderBottom=p[i],v.fitLineExpand=r.fitLineExpand,v}},"../spread-sheet/src/core/view/spreadsheet-view/transform-table/segment.ts":function(e,t,r){r.d(t,{r:function(){return c}}),r("../node_modules/core-js/modules/es.object.assign.js"),r("../node_modules/core-js/modules/web.dom-collections.for-each.js");var i=r("../spread-sheet/src/core/view/spreadsheet-view/model/VerticalAlign.ts"),o=r("../spread-sheet/src/core/view/spreadsheet-view/utils.ts"),n=r("../spread-sheet/src/core/view/spreadsheet-view/model/line/RichParagraph.ts"),s=r("../spread-sheet/src/core/view/spreadsheet-view/model/line/SimpleParagraph.ts"),a=r("../spread-sheet/src/core/view/spreadsheet-view/model/HorizontalAlign.ts"),l=r("../spread-sheet/src/core/view/spreadsheet-view/model/line/constant.ts");function c(e,t,r,c,h,u,f,g){var p=[];return f||(u&&e.content?p.push(Object.assign(Object.assign({},(0,l.U)(g)),{offsetX:0,offsetY:0})):s.Z.isTargetType(t)?p.push({segments:[t.segment],offsetX:0,offsetY:0,width:t.width,height:t.height}):t instanceof n.Z&&t.lines.forEach((function(e){p.push({segments:e.segments,offsetX:0,offsetY:0,width:e.width,height:e.height})}))),p.length>0&&(function(e,t,r,o,n){var s=t.style.verticalAlign.value;(t.mergeData&&o>r||t.isAutoWrap()&&o>r)&&(s=i.o.TOP),n&&(s=i.o.MIDDLE);var a=0;switch(s){case i.o.TOP:a=t.paddingTop;break;case i.o.MIDDLE:a=(r-o)/2;break;case i.o.BOTTOM:a=r-o-t.paddingBottom;break;default:console.error("verticalAlign: ",this._cell.style.verticalAlign)}for(var l=a,c=0;c<e.length;c++){var d=e[c].height,h=l+3*d/4;e[c].offsetY=Math.round(100*h)/100,l+=d>>0}}(p,e,(0,o.E)(r,e,c),t.height,u),function(e,t,r,i){var o=t.style.horizontalAlign.value;i&&(o=a.O.CENTER);for(var n=0;n<e.length;n++){var s=e[n];s.offsetX=d(t,o,s,r)}}(p,e,(0,o.o)(r,e,h),u)),p}function d(e,t,r,i){var o=0;switch(t){case a.O.LEFT:o=e.paddingLeft;break;case a.O.CENTER:o=(i-r.width)/2;break;case a.O.RIGHT:o=i-r.width-e.paddingRight}return o}},"../spread-sheet/src/core/view/spreadsheet-view/transform-table/utils.ts":function(e,t,r){function i(e,t,r){for(var i,o=e.getColCount(),n=e.data.colMetadata;(t+=1)<o;)if(!(i=n[t])||!i.hiddenByFilter&&!i.hiddenByUser)return e.getCellDataAtPosition(r,t);return null}function o(e,t,r){for(var i,o=e.getRowCount(),n=e.data.rowMetadata;(r+=1)<o;)if(!(i=n[r])||!i.hiddenByFilter&&!i.hiddenByUser)return e.getCellDataAtPosition(r,t);return null}function n(e){var t;if(!e)return!1;var r=null===(t=e.getEffectiveValue())||void 0===t?void 0:t.value;return"string"===typeof r?!/^\s*$/.test(r):null!==r&&void 0!==r}r.d(t,{F5:function(){return o},FE:function(){return n},Iv:function(){return i}})},"../spread-sheet/src/core/view/spreadsheet-view/utils.ts":function(e,t,r){r.d(t,{E:function(){return n},o:function(){return o}});var i=r("../packages/model/src/config/index.ts");function o(e,t,r){if(!t)return i.DEFAULT_COL_WIDTH;var o=0;if(!t.mergeData)return e.getColSetWidth(r);for(var n=0;n<t.mergeData.colCount;n++)e.isColHidden(r+n)||(o+=e.getColSetWidth(r+n));return o}function n(e,t,r){if(!t)return i.DEFAULT_ROW_HEIGHT;var o=0;if(!t.mergeData)return e.getRowDisplayHeight(r);for(var n=0;n<t.mergeData.rowCount;n++)e.isRowHidden(r+n)||(o+=e.getRowDisplayHeight(r+n));return o}}}]),window.jsExecEndTimeStamp=Date.now(),window.cachedPerformanceEntries||(window.cachedPerformanceEntries=[]),window.cachedPerformanceEntries.push({name:"jsExec: js/initial_core_part_2.f67f412d68b1bea41451.js",entryType:"jsExec",startTime:window.jsExecStartTimeStamp,endTime:window.jsExecEndTimeStamp});
//# sourceMappingURL=initial_core_part_2.f67f412d68b1bea41451.js.map