self.window=self,window.jsExecStartTimeStamp=Date.now(),(self.webpackChunk_tencent_alloy_builder=self.webpackChunk_tencent_alloy_builder||[]).push([["bundle_panel_init_pc"],{"../spread-sheet/src/base/util/html.ts":function(e,t,n){function o(e,t,n,o){return e.addEventListener?e.addEventListener(t,n,o):e.attachEvent&&e.attachEvent("on"+t,(function(){n(window.event)})),e}function a(e,t,n,o){e.removeEventListener?e.removeEventListener(t,n,o):e.detachEvent&&e.detachEvent("on"+t,(function(){n(window.event)}))}function r(e,t){e&&e.classList.add(t)}function i(e,t){e&&e.classList.remove(t)}n.d(t,{GM:function(){return l},IV:function(){return i},cn:function(){return r},vP:function(){return o},xC:function(){return a}}),n("../node_modules/core-js/modules/es.regexp.exec.js"),n("../node_modules/core-js/modules/es.string.replace.js"),n("../node_modules/core-js/modules/es.array.concat.js"),n("../node_modules/core-js/modules/web.dom-collections.for-each.js"),n("../node_modules/core-js/modules/es.object.keys.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.array.slice.js"),n("../packages/common-utils/src/index.ts");var s={CSS:{Sequence:function(){var e=/\\((([\dA-F]{2}|[\dA-F]{1,5})\s)|([\dA-F]{6}|[\dA-F]{4}))/gim;return e.unescape=function(e){var t=window,n=t.String.fromCharCode,o=t.parseInt;return e.replace(this,(function(e){return n(o(e.slice(2),16))}))},e}()}},l=function(e){return function(e){return e.replace(/(\\.)/g,(function(e){return e.slice(1)})).replace(/(\\[$\-+/():!^&'~{}<>= ])/g,(function(e){return e.slice(1)}))}(s.CSS.Sequence.unescape(e))}},"../spread-sheet/src/core/feature/dataValidation/api/DataValidationCalc.ts":function(e,t,n){n.d(t,{O:function(){return c}}),n("../node_modules/core-js/modules/es.number.constructor.js");var o=n("../node_modules/@tencent/sheet-formula-sdk/lib/index.js"),a=n("../packages/model/src/cell/data-validation/data-validation-utils.ts"),r=n("../packages/model/src/range/hexRangeUtils.ts"),i=n("../spread-sheet/src/core/feature/dataValidation/custom-formula/convert.ts"),s=n("../spread-sheet/src/core/feature/dataValidation/api/DataValidationUtils.ts"),l=n("../packages/model/src/cell/index.ts"),d=n("../packages/model/src/utils/numberFormat/FormatParseEngine.ts"),c=function(e,t,c,u){var p=e.spreadsheet.activeSheet.getCellDataAtPosition(c,t);if(null==p)return null;var h=p.getEffectiveValue();if(null==u&&(u=null===h||void 0===h?void 0:h.value),""===u)return null;var m=p.getDataValidation();if(m&&null!=u){var v=function(e,t,c,u,p,h){var m,v,f,g,w=e.spreadsheet.activeSheet.getSheetId(),x=h||w,b={rowIndex:c,colIndex:u,options:e.spreadsheet.sheetManager};if(null===(m=null===t||void 0===t?void 0:t.argTokens)||void 0===m?void 0:m.length){var C=t.argTokens[0],S=(0,a.o5)(C,{rowIndex:c,colIndex:u,options:e.spreadsheet.sheetManager}),E=(0,r.getRangeInfoFormHexRange)(e.spreadsheet,S).sheetId||w;if(!(null===(v=e.spreadsheet.sheetManager.getSheetBySheetId(E))||void 0===v?void 0:v.isLoaded))return null===(f=n.g.log)||void 0===f||f.log("数据验证跨表数据未加载"),!1}var y=(0,i.f)(t,b);if(!y)return!0;var j=(0,s.KN)(p);t.ruleType===l.DATA_VALIDATION_RULE_TYPE.DATE&&"number"===typeof j&&(0,d.isPrecisionBiggerThan16)(""+j)&&(j=Number((0,d.handleLongNumber)(""+j,void 0,!0)));var R=(0,s.Np)(j)||o.Pz.toCellId(c,u),_=null===(g=e.spreadsheet.sheetManager.getSheetBySheetId(x))||void 0===g?void 0:g.getCellDataAtPosition(c,u),k=(0,s.Dq)(R,_,p),P=function(e,t){var n=e.sheetId,o=e.calculator;if(t){var a=t.calcController.getResultBySingleFormula(o,n).result;if(null!=a)return!0===a||"TRUE"===a}return null}({calculator:(0,s.ko)(y,"$SLOT",k),col:u,row:c,sheetId:x},e);return!0===P}(e,m,c,t,u)&&(0,s.uU)(u,m);if(null!=v)return{isDataValid:v,dataValidation:m,cell:o.Pz.toCellId(c,t)}}return null}},"../spread-sheet/src/core/feature/index.ts":function(e,t,n){n.d(t,{Z:function(){return y}}),n("../node_modules/core-js/modules/es.array.sort.js");var o=n("../spread-sheet/src/core/feature/copyPaste/lib/smartSplit/SmartSplit.ts"),a=n("../spread-sheet/src/core/feature/dataValidation/api/DataValidationUtils.ts"),r=n("../spread-sheet/src/core/feature/dataValidation/api/DataValidationCalc.ts"),i=(n("../node_modules/core-js/modules/web.dom-collections.for-each.js"),n("../node_modules/core-js/modules/es.array.iterator.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/web.dom-collections.iterator.js"),n("../packages/model/src/cell/CellFormat.ts")),s=n("../packages/model/src/cell/format/Color.ts");function l(e,t,n){var o=function(e,t){for(var n=[],o=t.startRowIndex;o<=t.endRowIndex;o++){for(var a=[],r=t.startColIndex;r<=t.endColIndex;r++){var i=e.data.rowData[o]?e.data.rowData[o].values[r]:null;a.push(i)}n.push(a)}return n}(e,t);if(o.length<=1)return!1;for(var a=!1,r=function(e,t,n){var o=n[0],a=[];t.forEach((function(t){a.push(t.column-e.startColIndex)}));for(var r=0;r<o.length;r++)a.length&&-1===a.indexOf(r)&&a.push(r);return a}(t,n,o),i=0;i<r.length;i++){var s=c(o,r[i]);if(d(s[0]))return!1;if(a=u(e,t,s))break}return a}function d(e){return!(e&&!e.isEmpty())||!(e.getHyperlink()||e.getFormula()||e.getEditValue())}function c(e,t){var n=[];return e.forEach((function(e){n.push(e[t])})),n}function u(e,t,n){return!!function(e,t){var n=e.getBasicFilter(),o=e.properties;return!!function(e,t){var n=-1;return e&&(n=e.range.startRowIndex),n>-1&&t===n}(n,t.startRowIndex)||!!function(e,t){var n=0,o=e.gridProperties;if(o&&(n=o.frozenRowCount),n>0&&t+1===n)return!0}(o,t.startRowIndex)}(e,t)||!!function(e,t){var n=!1;if(e.length>=3){if(d(e[0])||d(e[1]))return!1;var o=e[0],a=e[1];!function(e,t,n){for(var o=2;o<e.length&&!p(t,e[o],n);o++);}(e,a,t),p(o,a,t)&&(n=!0)}return n}(n,e.spreadsheetReference)||!!function(e){var t,n,o="00000";if(e.length>=3){if(d(e[0])||d(e[1]))return!1;var a=(null===(t=e[0])||void 0===t?void 0:t.effectiveValue)?x(e[0].effectiveValue):o,r=(null===(n=e[1])||void 0===n?void 0:n.effectiveValue)?x(e[1].effectiveValue):o,i=function(e,t){for(var n,o="00000",a=!1,r=2;r<e.length;r++){if(((null===(n=e[r])||void 0===n?void 0:n.effectiveValue)?x(e[r].effectiveValue):o)!==t&&!d(e[r])){a=!0;break}if(d(e[r]))break}return a}(e,r);return a!==r&&!i}return!1}(n)}function p(e,t,n){var o,a,r=!1;if(e&&t){var s=i.Z.createInstance(),l=null!==(o=e.getUserEnteredFormat())&&void 0!==o?o:s,d=null!==(a=t.getUserEnteredFormat())&&void 0!==a?a:s;l&&d&&(r=["bold","italic","fontSize","fontColor","backgroundColor","numberFormat"].some((function(e){return function(e,t,n,o){return{bold:h,italic:m,fontSize:v,fontColor:f,backgroundColor:g,numberFormat:w}[e](t,n,o)}(e,l,d,n)})))}return r}function h(e,t){var n=!1;return(e.getBold()||!1)!==(t.getBold()||!1)&&(n=!0),n}function m(e,t){var n=!1;return(e.getItalic()||!1)!==(t.getItalic()||!1)&&(n=!0),n}function v(e,t){var n=!1;return(e.getFontSize()||10)!==(t.getFontSize()||10)&&(n=!0),n}function f(e,t,n){var o=!1,a=e.getColor()||s.Z.createColor("#000000"),r=t.getColor()||s.Z.createColor("#000000");return a&&r?s.Z.getColorHexCode(a,n)!==s.Z.getColorHexCode(r,n)&&(o=!0):(a||r)&&(o=!0),o}function g(e,t,n){var o=!1,a=e.getBackgroundColor()||s.Z.createColor("#FFFFFF"),r=t.getBackgroundColor()||s.Z.createColor("#FFFFFF");return a&&r?s.Z.getColorHexCode(a,n)!==s.Z.getColorHexCode(r,n)&&(o=!0):(a||r)&&(o=!0),o}function w(e,t){var n=!1,o=e.getNumberFormat(),a=t.getNumberFormat();return o&&a?o.equals(a)||(n=!0):(o&&0!==o.id||a&&0!==a.id)&&(n=!0),n}function x(e){var t="0001",n="";if(e&&3!==e.type){var o=String(e.value);n+=/[a-zA-Z\u4e00-\u9fa5]+/.test(o)?"1":"0",n+=/^-?(\d|([1-9]\d+))(\.\d+)?$/.test(o)?"1":"0",n+=/[!@#$%\\^&*)(+={}[\]/",<>~`?:;|]/.test(o)?"1":"0",/^#N\/A$|^#DIV\/0!$|#VALUE!$|^#REF!$|^#ERROR$|^#NUM!$|^#NAME\?$|^#NULL!$|^#PARAMS_LACK$/.test(o)?n=t:n+="1"}else e&&3===e.type&&(n=t);return n}var b,C=n("../spread-sheet/src/core/feature/sort/Sort.ts"),S=n("../spread-sheet/src/core/feature/dataValidation/DVInterface.ts"),E=n("../spread-sheet/src/core/feature/dataValidation/api/DataValidationError.ts");!function(e){!function(e){e.needCheckSmartSplit=o.IK,e.doSmartSplitMobile=o.jq}(e.smartSplit||(e.smartSplit={})),function(e){e.getUIDVAtPosition=a.Sc,e.getDropDownValues=a.ZK,e.viewCheckDataValid=r.O,e.compareMaxMinError=a.JU,e.isActiveCellContainDV=a.v1,e.VALID_TYPE=S.ob,e.DATA_TYPE=S.h6,e.DATE_OPERATE_MAP=S.y3,e.TEXT_OPERATE_MAP=S.Bb,e.NUMBER_OPERATE_MAP=S.UD,e.NUMBER_DATA_TYPE_MAP=S.Ju,e.error=E}(e.dataValidation||(e.dataValidation={})),function(e){e.checkSortTitle=l,e.checkExtendRange=C.Df,e.hasPositiveRef=C.Hq}(e.sort||(e.sort={}))}(b||(b={}));var y=b},"../spread-sheet/src/core/feature/sort/Sort.ts":function(e,t,n){n.d(t,{Df:function(){return s},Hq:function(){return i}});var o,a=n("../spread-sheet/src/core/behavior/index.ts");!function(e){e.EXTEND="extend",e.NOT_EXTEND="not-extend"}(o||(o={}));var r=function(e,t,n){var o=e.spreadsheet.activeSheet.getCellDataAtPosition(t,n),a=null===o||void 0===o?void 0:o.getFormula();return!!a&&a.hasRelativeReference()},i=function(e,t){for(var n=t,o=n.startRowIndex;o<=n.endRowIndex;o++)for(var a=n.startColIndex;a<=n.endColIndex;a++)if(r(e,o,a))return!0;return!1};function s(e,t){var n,o=t,r=function(e,t){return a.Z.Utils.searchCloseDataArea(e.spreadsheet.activeSheet,t)}(e,o),i=!r.equal(t),s=(n=o,!(0!==Math.abs(n.startColIndex-n.endColIndex)||0!==Math.abs(n.startRowIndex-n.endRowIndex))),l=function(e){return 0===Math.abs(e.startColIndex-e.endColIndex)||0===Math.abs(e.startRowIndex-e.endRowIndex)}(o);return{extRange:r,oriRange:o,canExtend:i,isOneCell:s,singleColOrRow:l}}},"../spread-sheet/src/external/rangeAuth/util/range-auth-error-util.ts":function(e,t,n){n.d(t,{J3:function(){return d},ZO:function(){return c},f$:function(){return u}}),n("../node_modules/regenerator-runtime/runtime.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.promise.js"),n("../node_modules/core-js/modules/es.array.iterator.js"),n("../node_modules/core-js/modules/es.string.iterator.js"),n("../node_modules/core-js/modules/web.dom-collections.iterator.js");var o=n("../node_modules/i18next/dist/esm/i18next.js"),a=n("../node_modules/lodash/throttle.js"),r=n.n(a),i=n("../packages/report/src/index.ts"),s=function(e,t,n,o){return new(n||(n=Promise))((function(a,r){function i(e){try{l(o.next(e))}catch(t){r(t)}}function s(e){try{l(o.throw(e))}catch(t){r(t)}}function l(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,s)}l((o=o.apply(e,t||[])).next())}))},l=function(){return s(void 0,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=3,Promise.resolve().then(n.bind(n,"../node_modules/@tencent/dui/lib/components/Snackbar/index.js"));case 3:case 6:return e.abrupt("return",e.sent);case 4:return e.next=6,Promise.resolve().then(n.bind(n,"../node_modules/@tencent/dui-mobile/lib/components/Snackbar/index.js"));case 7:case"end":return e.stop()}}),e)})))};function d(e){return s(this,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,l();case 2:t.sent.default.show({type:"error",message:e,autoClose:!0,style:{zIndex:10004}});case 4:case"end":return t.stop()}}),t)})))}var c=r()((function(){return s(void 0,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s(void 0,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=3,Promise.resolve().then(n.bind(n,"../node_modules/@tencent/dui/lib/components/Modal/index.js"));case 3:case 6:return e.abrupt("return",e.sent);case 4:return e.next=6,Promise.resolve().then(n.bind(n,"../node_modules/@tencent/dui-mobile/lib/components/Modal/index.js"));case 7:case"end":return e.stop()}}),e)})));case 2:e.sent.default.confirm({title:o.ZP.t("保护范围提示"),content:o.ZP.t("此范围已被保护。如需编辑，请联系创建者「{{value}}」授予权限。",{value:window.clientVars.ownerNick}),cancelText:null,okText:o.ZP.t("确定")}),i.ZP.kvrOss({itemname:"xls_rangeprotect_range_viewer_toast"});case 5:case"end":return e.stop()}}),e)})))}),300,{leading:!0,trailing:!1}),u=r()((function(e){return s(void 0,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,l();case 2:t.sent.default.show({type:"info",message:e,autoClose:!0,style:{zIndex:10004}});case 4:case"end":return t.stop()}}),t)})))}),300,{leading:!0,trailing:!1})},"../spread-sheet/src/external/view/main/panel/rangeSelectionPanel/index.tsx":function(e,t,n){n.r(t),n.d(t,{default:function(){return b}});var o=n("../node_modules/@babel/runtime/helpers/esm/createClass.js"),a=(n("../node_modules/core-js/modules/es.regexp.exec.js"),n("../node_modules/core-js/modules/es.string.replace.js"),n("../node_modules/core-js/modules/es.array.map.js"),n("../node_modules/core-js/modules/es.string.split.js"),n("../node_modules/core-js/modules/es.array.find-index.js"),n("../node_modules/i18next/dist/esm/i18next.js")),r=n("react"),i=n.n(r),s=n("../packages/model/src/range/GridRange.ts"),l=n("../node_modules/@tencent/dui/lib/components/Button/index.js"),d=n("../node_modules/@tencent/dui/lib/components/Modal/index.js"),c=n("../node_modules/@tencent/sheet-formula-sdk/lib/index.js"),u=n("../node_modules/@babel/runtime/helpers/esm/inheritsLoose.js"),p=(n("../node_modules/core-js/modules/web.dom-collections.for-each.js"),n("../node_modules/core-js/modules/es.array.join.js"),n("../spread-sheet/src/core/utils/index.ts")),h=n("../packages/model/src/range/hexRangeUtils.ts"),m=n("../node_modules/@tencent/dui/lib/components/Input/index.js"),v=n("../spread-sheet/src/base/event/event.ts"),f=n("../spread-sheet/src/external/view/main/panel/rangeSelectionPanel/util.ts"),g=function(e){function t(t){var n;return(n=e.call(this,t)||this).removeSelection=function(){n.setState({disabled:!0})},n.setRangeWhenSelection=function(){if(n.state.disabled)n.setState({disabled:!1});else{var e=n.app.view.canvas.normalSelectData.selectQueue,t=n.app.spreadsheet.activeSheet.getSheetId(),o=[];e.forEach((function(e){var a=""+(n.props.absolute?p.Z.range.select2AbsoluteHex(n.app.spreadsheet.activeSheet,e):p.Z.range.select2RelativeHex(n.app.spreadsheet.activeSheet,e)),r=n.props.multiSheet,i=n.app.spreadsheet.sheetManager.getSheetTitleBySheetId(t),s=r?"'"+i+"'!"+a:a;o.push((n.props.appendEqual?"=":"")+s)}));var a=o.join(",");n.onChange(a)}},n.onChange=function(e){n.setState({value:e});var t=n.props.appendEqual?e.replace(/^=/,""):e,o=(0,h.validateRangeString)(t);(n.props.checkSheetId?(0,h.isValidHexRangeOnSpreadsheet)(o,n.props.app.spreadsheet):(0,f.iK)(o,n.props.app.spreadsheet,n.props.multiSheet))?(n.setState({isError:!1,errorTip:""}),n.props.onChange(e)):n.setState({isError:!0,errorTip:n.props.checkSheetId?""+(e?f.lo:""):f.AM})},n.app=n.props.app,n.state={value:n.props.value||"",isError:!1,errorTip:"",disabled:!1},n}(0,u.Z)(t,e);var n=t.prototype;return n.componentDidMount=function(){v.ZP.sheetsBar.listen("switchSheet",this.removeSelection),this.modifySelectionDisposable=this.app.view.canvas.normalSelectData.onModifySelectData(this.setRangeWhenSelection)},n.componentWillUnmount=function(){v.ZP.sheetsBar.remove("switchSheet",this.removeSelection),this.modifySelectionDisposable.dispose()},n.render=function(){var e=this.state.isError?"range-selection-content-wrap--error":"";return i().createElement("div",{className:"range-selection-content-wrap "+e,style:{width:"100%"}},i().createElement(m.default,{label:"",placeholder:a.ZP.t("可用鼠标框选单元格，或直接输入范围"),value:this.state.value,onChange:this.onChange,onMouseDown:function(e){return e.stopPropagation()}}),this.state.errorTip?i().createElement("div",{className:"validation-input-tip"},this.state.errorTip):i().createElement(i().Fragment,null))},t}(i().Component),w=n("../spread-sheet/src/base/util/html.ts"),x=n("../spread-sheet/src/external/rangeAuth/util/range-auth-error-util.ts"),b=function(){function e(e){var t=this;this.isUseEnterKeyAsSelected=!0,this.enableSheetAction=!1,this.show=function(e,n,o){void 0===e&&(e=function(){}),void 0===n&&(n=function(){}),void 0===o&&(o={}),t.panelOptions=o,t.value=o.defaultValue?o.defaultValue:"",t.okCb=e,t.cancelCb=n,t.absolute=!(!o||!0!==o.absolute),t.appendEqual=!(!o||!0!==o.appendEqual);var r,i=t.app.view.canvas,s=o.enableSheetAction;t.enableSheetAction=s||!1,((null===o||void 0===o?void 0:o.col)||(null===o||void 0===o?void 0:o.row))&&(r=t.getLinkedRangeStyle(i,o)),t.dialog=d.default.confirm({title:a.ZP.t("选择单元格范围"),style:r,className:"range-selection-dialog",mask:!1,closable:!0,onClose:t.clickCancel,draggable:!0,content:t.renderContent(o.checkSheetId),footer:t.renderFooter(),destroyOnClose:!0}),(0,w.vP)(document,"keydown",t.onKeydown,!0),t.showing=!0,t.app.event.default.trigger("range-selection-panel-show"),setTimeout((function(){var e,n;null===(n=null===(e=t.app)||void 0===e?void 0:e.view)||void 0===n||n.canvas.inputManager.focus()}),300)},this.hide=function(){t.dialog&&t.dialog.close(),(0,w.xC)(document,"keydown",t.onKeydown,!0),t.showing=!1,t.app.event.default.trigger("range-selection-panel-hide")},this.onKeydown=function(e){t.app.view.canvas.inputManager.isInputtingState()||"Enter"===e.key&&t.isUseEnterKeyAsSelected&&(e.stopPropagation(),t.clickOk())},this.cancelButtonMouseEnter=function(){t.isUseEnterKeyAsSelected=!1},this.cancelButtonMouseLeave=function(){t.isUseEnterKeyAsSelected=!0},this.clickOk=function(){var e=t.appendEqual?t.value.replace(/^=/,""):t.value,n=e.split(",").map((function(e){return(0,c.R8)(e)})),o=t.app.spreadsheet.activeSheetId;if(t.isPassRangeAuthCheck(n)){t.hide();var a={isRow:!1,isCol:!1,endRowIndex:-1,endColIndex:-1},r=n.every((function(e){return(0,h.isValidHexRange)(e)})),i=t.app.spreadsheet.sheetManager.getSheetBySheetId(o);if(r&&i){var l=(0,h.hex2Range)(e,o),d=i.getRowCount()-1,u=i.getColCount()-1;0===l.startRowIndex&&l.endRowIndex===d&&0===l.startColIndex&&l.endColIndex===u||(0===l.startColIndex&&l.endColIndex===u?(a.isRow=!0,a.endColIndex=s.v):0===l.startRowIndex&&l.endRowIndex===d&&(a.isCol=!0,a.endRowIndex=s.v))}r?t.okCb(t.value,a,t.panelOptions):t.cancelCb(t.panelOptions)}},this.isPassRangeAuthCheck=function(e){if(t.panelOptions.noRangeAuthCheck)return!0;var n=t.app.spreadsheet.activeSheetId;return!t._checkCrossAuthRange(e.map((function(e){return(0,h.hex2Range)(e,n)})))||((0,x.ZO)(),!1)},this.clickCancel=function(){t.hide(),t.cancelCb(t.panelOptions)},this.app=e,this.dialog=null,this.value="",this.okCb=function(){},this.cancelCb=function(){},this.showing=!1,this.app.event.linkCenter.listen("showSelectRangePanel",this.show.bind(this))}var t=e.prototype;return t.getLinkedRangeStyle=function(e,t){var n=e.clientRect.distanceY+e.headSize.displayColHeadHeight+6,o=e.clientRect.distanceX+e.headSize.displayRowHeadWidth,a=e.clientRect.distanceY+e.clientRect.height,r=e.clientRect.distanceX+e.clientRect.width,i=t.row,s=t.col;if(void 0!==i&&void 0!==s){var l=e.tableView.getCellViewAtPosition(i,s);(null===l||void 0===l?void 0:l.mergeData)&&(i+=l.mergeData.rowCount-1)}var d=i?e.areaData.getDisplayViewBottomByRow(i)+n:n,c=s?e.areaData.getDisplayViewLeftByCol(s)+o:14;return c+386>r&&(c=r-386),d+214>a&&(d=a-214),{width:386,position:"absolute",top:d,left:c,padding:24}},t.renderContent=function(e){var t=this;return i().createElement(i().Fragment,null,i().createElement("div",{style:{width:"100%",height:"34px"}},i().createElement(g,{app:this.app,value:this.value,absolute:this.absolute,appendEqual:this.appendEqual,onChange:function(e){t.value=e},multiSheet:this.enableSheetAction,checkSheetId:e})))},t.renderFooter=function(){return i().createElement("div",{className:"range-selection-footer-wrap","data-testid":"range-selection-footer-wrap"},i().createElement("div",{className:"button-group-wrap"},i().createElement(l.default,{className:"common-button",size:"small",onClick:this.clickCancel,onMouseDown:function(e){return e.stopPropagation()},onMouseEnter:this.cancelButtonMouseEnter,onMouseLeave:this.cancelButtonMouseLeave},a.ZP.t("取消")),i().createElement(l.default,{type:"primary",size:"small",className:"common-button ml-16",onClick:this.clickOk,onMouseDown:function(e){return e.stopPropagation()}},a.ZP.t("确定"))))},t._checkCrossAuthRange=function(e){var t=this;return!(-1===e.findIndex((function(e){return!t.app.sheetStatus.getRangeCanEdit(e)})))},(0,o.Z)(e,[{key:"onSelecting",get:function(){return this.showing}}]),e}()},"../spread-sheet/src/external/view/main/panel/rangeSelectionPanel/util.ts":function(e,t,n){n.d(t,{AM:function(){return i},iK:function(){return l},lo:function(){return s},uQ:function(){return d}}),n("../node_modules/core-js/modules/es.regexp.exec.js"),n("../node_modules/core-js/modules/es.string.split.js"),n("../node_modules/core-js/modules/es.array.map.js");var o=n("../node_modules/i18next/dist/esm/i18next.js"),a=n("../packages/model/src/range/hexRangeUtils.ts"),r=(n("../packages/model/src/sheet/sheetUtils.ts"),n("../spread-sheet/src/core/utils/range.ts")),i=o.ZP.t("请输入正确的单元格范围，比如A1:C8"),s=o.ZP.t("请输入正确的单元格范围，比如'工作表1'!A1:C8"),l=function(e,t,n){return void 0===n&&(n=!1),""!==e&&e.split(",").every((function(e){return n&&(0,a.isValidHexRangeOnSpreadsheet)(e,t)||(0,a.isValidHexRangeOnSheet)(e,t.activeSheet)}))},d=function(e,t,n){var o=n.appendEqual,a=n.absolute,i=n.multiSheet,s=t.canvas.normalSelectData.selectQueue,l=e.activeSheet.getSheetId();return s.map((function(t){var n=(o?"=":"")+(a?(0,r.select2AbsoluteHex)(e.activeSheet,t):(0,r.select2RelativeHex)(e.activeSheet,t)),s=e.sheetManager.getSheetTitleBySheetId(l);return i?"'"+s+"'!"+n:n}))}},"../spread-sheet/src/external/view/main/panel/sidePanelMain/index.tsx":function(e,t,n){n.r(t),n.d(t,{default:function(){return a}}),n("../node_modules/core-js/modules/es.function.name.js"),n("../node_modules/core-js/modules/es.array.splice.js"),n("../node_modules/core-js/modules/web.dom-collections.for-each.js"),n("../node_modules/core-js/modules/es.array.filter.js");var o=n("../spread-sheet/src/base/event/event.ts"),a="page-editor"==n.j?function(){function e(e){var t=this;this.app=e,this.inited=!1,this.components=[],this.showingComponent=null,this.bigPanel=[],o.ZP.default.listen("hideAllPanel",(function(){t.hideAll()}))}var t=e.prototype;return t.initComponent=function(e){var t=this;if(!this.init())return null;var n=e.name,o=e.id,a=e.classname,r=e.isBig,i=this.getComponent(n);if(r&&this.bigPanel.push(n),i)return i;var s=document.createElement("div");return o&&(s.id=o,s.dataset.testid=o),a&&(s.className=a),this.root.appendChild(s),i={name:n,container:s,show:function(){t.show(n)},hide:function(){t.hide(n)},getIsShowing:function(){return t.getIsShowing(n)},showAnimationend:function(){var t;null===(t=e.afterShow)||void 0===t||t.call(e)},hideAnimationend:function(){var t;null===(t=e.afterHide)||void 0===t||t.call(e)}},this.components.push(i),i},t.destroyComponent=function(e){var t=this.getComponent(e);if(t){this.root.removeChild(t.container);var n=this.components.indexOf(t);this.components.splice(n,1)}},t.getShowPanelName=function(){var e;return null===(e=this.showingComponent)||void 0===e?void 0:e.name},t.hideAll=function(){var e=this;this.components.forEach((function(t){e.hide(t.name)}))},t.show=function(e){var t=this;this.showingComponent&&this.showingComponent.name!==e&&(this.showingComponent.container.style.display="none",o.ZP.default.trigger("sidePanelHide",this.showingComponent.name));var a=this.getComponent(e);if(a){var r=n.g.setTimeout((function(){var e,n;null===(n=null===(e=t.app.view)||void 0===e?void 0:e.canvas)||void 0===n||n.resize.resize(),r=0}),300);this.root.addEventListener("animationend",(function e(){r&&(n.g.clearTimeout(r),n.g.setTimeout((function(){var e,n;null===(n=null===(e=t.app.view)||void 0===e?void 0:e.canvas)||void 0===n||n.resize.resize()}),150)),t.root.style.display="block",a.showAnimationend(),t.root.removeEventListener("animationend",e)})),a.container.style.display="block",this.root.style.display="block",this.root.classList.remove("side-panel-hide"),this.bigPanel.indexOf(e)>-1?(this.root.classList.remove("side-panel-show"),this.root.classList.add("big-side-panel-show"),setTimeout((function(){document.body.classList.remove("side-panel-show"),document.body.classList.add("big-side-panel-show")}),500)):(this.root.classList.remove("big-side-panel-show"),this.root.classList.add("side-panel-show"),setTimeout((function(){document.body.classList.remove("big-side-panel-show"),document.body.classList.add("side-panel-show")}),500)),this.showingComponent=a,o.ZP.default.trigger("sidePanelShow",e)}},t.hide=function(e){var t=this;if(this.showingComponent){var a=this.getComponent(e);if(a){var r=n.g.setTimeout((function(){var e,n;null===(n=null===(e=t.app.view)||void 0===e?void 0:e.canvas)||void 0===n||n.resize.resize(),r=0}),300);this.root.addEventListener("animationend",(function e(){r&&(n.g.clearTimeout(r),n.g.setTimeout((function(){var e,n;null===(n=null===(e=t.app.view)||void 0===e?void 0:e.canvas)||void 0===n||n.resize.resize()}),150)),t.root.style.display="none",a.hideAnimationend(),t.root.removeEventListener("animationend",e)})),a.container.style.display="none",this.root.classList.remove("big-side-panel-show"),this.root.classList.remove("side-panel-show"),this.root.classList.add("side-panel-hide"),o.ZP.default.trigger("sidePanelHide",e),this.showingComponent=null,document.body.classList.remove("big-side-panel-show"),document.body.classList.remove("side-panel-show")}}},t.getIsShowing=function(e){return!(!this.showingComponent||this.showingComponent.name!==e)},t.getComponent=function(e){var t=this.components.filter((function(t){return t.name===e}));return t.length<1?null:t[0]},t.init=function(){if(this.inited)return!0;var e=document.createElement("div");e.id="side-panel-main",e.dataset.testid="side-panel-main",e.style.display="none",e.addEventListener("keydown",(function(e){return e.stopPropagation()}));var t=document.getElementById("mainContainer"),n=document.getElementById("canvasContainer");return!(!t||!n)&&(t.appendChild(e),this.canvasContainer=n,this.root=e,this.inited=!0,!0)},e}():null},"../spread-sheet/src/external/view/main/panel/validationErrorPanel/index.tsx":function(e,t,n){n.r(t),n.d(t,{default:function(){return v}}),n("../node_modules/regenerator-runtime/runtime.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.promise.js");var o=n("../node_modules/i18next/dist/esm/i18next.js"),a=n("react"),r=n.n(a),i=n("../node_modules/@tencent/dui/lib/components/Modal/index.js"),s=(n("../node_modules/@tencent/dui-mobile/lib/components/Modal/index.js"),n("../node_modules/@tencent/dui/lib/components/Button/index.js")),l=(n("../node_modules/@tencent/dui-mobile/lib/components/Button/index.js"),n("../spread-sheet/src/base/index.ts")),d=n("../spread-sheet/src/core/feature/index.ts"),c=n("../packages/report/src/index.ts"),u=n("../packages/model/src/cell/metadata/CustomDataType.ts"),p=function(e,t,n,o){return new(n||(n=Promise))((function(a,r){function i(e){try{l(o.next(e))}catch(t){r(t)}}function s(e){try{l(o.throw(e))}catch(t){r(t)}}function l(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,s)}l((o=o.apply(e,t||[])).next())}))},h=i.default,m=s.default,v="page-editor"==n.j?function(){function e(e){var t=this;this.clickRetry=function(e){void 0===e&&(e=!1),e||t.close(),t.app.view.canvas.selectApi.selectCells(t.app.view.canvas.normalSelectData,{xRange:[t.col,t.col],yRange:[t.row,t.row]},null),t.clickedRetry=!0,(0,u.wK)(t.app.spreadsheet.activeSheet,t.row,t.col)?e&&t.app.view.canvas.cellEditorManager.showMobileEditorPanel(t.row,t.col):e?(t.app.view.canvas.inputManager.focus(),t.app.view.canvas.inputManager.emitter.once(t.app.view.canvas.inputManager.EVENT.ENTER_INPUT,(function(){t.app.view.canvas.inputManager.setText(t.inputValue),t.app.view.canvas.inputManager.collapseToEnd()}))):(t.app.view.canvas.inputManager.handleEnterInput(),t.app.view.canvas.inputManager.setText(t.inputValue),t.app.view.canvas.inputManager.collapseToEnd())},this.app=e,this.dialog=null,this.clickedRetry=!1}var t=e.prototype;return t.verify=function(e,t,n,o){if(!1===o&&!1===this.clickedRetry)return!0;this.dialog&&this.close();var a=d.Z.dataValidation.error.getErrorMessage(this.app,e,t);if(!a)return!0;this.message=a,this.row=e,this.col=t,this.inputValue=n;var r=d.Z.dataValidation.viewCheckDataValid(this.app,t,e,n);return this.reportError(r),null==r||!1!==r.isDataValid||!0!==r.dataValidation.isStrict||(this.show(),this.showX=t,this.showY=e,!1)},t.show=function(){var e=this;return this.clickedRetry=!1,this.dialog=h.confirm({title:o.ZP.t("数据验证"),className:"validation-error-dialog",destroyOnClose:!0,style:{width:450},content:this.renderContent(),footer:this.renderFooter()}),l.Z.util.timer.wait(0).run((function(){e.app.view.canvas.inputManager.blur()})),this.dialog},t.showMobile=function(){return p(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new Promise((function(e){setTimeout((function(){e()}),100)}));case 2:this.app.view.canvas.inputManager.blur(),this.dialogMobile=h.confirm({title:o.ZP.t("数据验证"),content:this.message,okText:o.ZP.t("确定"),onOk:function(){return t.clickRetry(!0)},cancelText:null});case 4:case"end":return e.stop()}}),e,this)})))},t.hide=function(){this.close()},t.close=function(){var e;null===(e=this.dialog)||void 0===e||e.close(),this.dialog=null,this.app.view.canvas.inputManager.focus()},t.renderContent=function(){return r().createElement("div",{className:"validation-error-body"},this.message)},t.renderFooter=function(){var e=this;return r().createElement("div",{className:"validation-error-footer-wrap"},r().createElement("div",{className:"button-group-wrap"},r().createElement(m,{type:"primary",className:"common-button",onClick:function(){return e.clickRetry(!1)}},o.ZP.t("确定"))))},t.reportError=function(e){null!=e&&!1===e.isDataValid&&!0===e.dataValidation.isStrict&&this.message===o.ZP.t("你选择的不是下拉列表中的选项。")&&c.ZP.kvrOss({itemname:"xls_dropdown_illegalprohibited"}),null!=e&&!1===e.isDataValid&&!1===e.dataValidation.isStrict&&this.message===o.ZP.t("你选择的不是下拉列表中的选项。")&&c.ZP.kvrOss({itemname:"xls_dropdown_illegalinput"}),null!=e&&!0===e.isDataValid&&this.message===o.ZP.t("你选择的不是下拉列表中的选项。")&&c.ZP.kvrOss({itemname:"xls_dropdown_input"})},e}():null}}]),window.jsExecEndTimeStamp=Date.now(),window.cachedPerformanceEntries||(window.cachedPerformanceEntries=[]),window.cachedPerformanceEntries.push({name:"jsExec: js/bundle_panel_init_pc.d1f6f4e236b40f8f2fb6.js",entryType:"jsExec",startTime:window.jsExecStartTimeStamp,endTime:window.jsExecEndTimeStamp});
//# sourceMappingURL=bundle_panel_init_pc.d1f6f4e236b40f8f2fb6.js.map