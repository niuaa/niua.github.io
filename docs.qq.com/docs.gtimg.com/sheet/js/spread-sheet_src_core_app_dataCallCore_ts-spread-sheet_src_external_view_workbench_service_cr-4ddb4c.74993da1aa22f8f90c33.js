self.window=self,window.jsExecStartTimeStamp=Date.now(),(self.webpackChunk_tencent_alloy_builder=self.webpackChunk_tencent_alloy_builder||[]).push([["spread-sheet_src_core_app_dataCallCore_ts-spread-sheet_src_external_view_workbench_service_cr-4ddb4c","bundle_spreadsheet_tool_lazy"],{"../spread-sheet/src/core/app/dataCallCore.ts":function(e,t,o){o.d(t,{oh:function(){return M},I8:function(){return H}}),o("../node_modules/regenerator-runtime/runtime.js"),o("../node_modules/core-js/modules/es.object.to-string.js"),o("../node_modules/core-js/modules/es.promise.js"),o("../node_modules/core-js/modules/web.dom-collections.for-each.js"),o("../node_modules/core-js/modules/es.object.keys.js"),o("../node_modules/core-js/modules/es.array.includes.js"),o("../node_modules/core-js/modules/es.string.includes.js"),o("../node_modules/core-js/modules/es.string.trim.js"),o("../node_modules/core-js/modules/es.regexp.exec.js"),o("../node_modules/core-js/modules/es.string.replace.js"),o("../node_modules/core-js/modules/es.string.split.js"),o("../node_modules/core-js/modules/es.array.iterator.js"),o("../node_modules/core-js/modules/web.dom-collections.iterator.js");var r,n=o("../node_modules/i18next/dist/esm/i18next.js"),s=o("../spread-sheet/src/core/behavior/request/Type.ts"),a=o("../packages/report/src/index.ts"),i=o("../spread-sheet/src/base/config/report.ts"),d=o("../node_modules/@tencent/jank-sdk/lib/index.js"),c=o("../spread-sheet/src/base/error/index.ts"),u=o("../spread-sheet/src/base/error/errorCodeModalProxy.ts"),l=o("../spread-sheet/src/core/utils/config.ts"),f=o("../node_modules/@tencent/docs-connection/lib/index.js");function p(e){if(function(e){var t,o=null===(t=e.offlineEdit)||void 0===t?void 0:t.canWrite();return m(e)&&!o}(e))return e.messageCenterAdapter.socketAdapter.hideOfflineTips(),void function(e){e.messageCenterAdapter.socketAdapter.hadShowOfflineTip=!0,e.event.errorCode.trigger("errorCode",{type:"front",code:c.B.OFFLINE_INDEXDB_NOT_AVAILABLE}),e.permissions.activeShutdownStatus(!1)}(e);e.messageCenterAdapter.socketAdapter.hadShowOfflineTip||!(0,l.q)()&&function(e){var t,o=null===(t=e.offlineEdit)||void 0===t?void 0:t.canWrite();return m(e)&&o}(e)&&(e.messageCenterAdapter.socketAdapter.hadShowOfflineTip=!0,u.Z.client.showNetworkOfflineTip(e.sheetStatus.workbookStatus.canEdit,(function(t){e.messageCenterAdapter.socketAdapter.offlineSnackbar=t})))}function m(e){var t=e.messageCenter.networkStatusManager.getRoomStatus();return!e.sheetStatus.workbookStatus.isOnline||e.messageCenterAdapter.socketAdapter.isUnavailableTimeout()||t===f.RoomState.RECONNECTING_IN_CLOSED}!function(e){e.USER_CHANGE_NEW="userChangeNew",e.USER_CHANGE_UPDATE="userChangeUpdate",e.USER_CHANGE_COMMIT="userChangeCommit",e.USER_CHANGE_RETRY_COMMIT="userChangeRetryCommit",e.COMMITING_QUEUE_RESET="commitingQueueReset",e.UPDATE_WAITING_QUEUE_VERSION="updateWaitingQueueVersion",e.APPLY_CT="applyCt",e.ACCEPT_COMMIT="acceptCommit",e.COMMIT_WITH_ERROR_CODE="commitWithErrorCode",e.AFTER_APPLY_COLLAB_MUTATIONS="afterApplyCollabMutations"}(r||(r={}));var h=o("../spread-sheet/src/base/event/eventName.ts"),g=o("../packages/mutation/src/MutationId.ts"),v=o("../packages/model/src/sheet/SheetPropertiesSlotOperation.ts"),_=o("../spread-sheet/src/core/app/lazytool/index.ts"),C=o("../packages/model/src/workbookRange/WorkbookRangeType.ts"),w=o("../packages/mutation/src/workbook/workbookRange/DefineWorkbookRangeMutation.ts"),y=o("../packages/model/src/workbookRange/WorkbookRangeDelta.ts"),j=o("../packages/mutation/src/new-embedded/NewAddEmbeddedObjectMutation.ts"),k=o("../spread-sheet/src/core/data/configService/spreadConfig.ts"),x=o("../node_modules/@tencent/docs_offline/lib/index.js"),b=o("../spread-sheet/src/external/errorUI/client.ts"),S=o("../node_modules/@tencent/tdocs_support_bridge/lib/index.js"),T=o("../node_modules/lodash/isNil.js"),P=o.n(T),E=(o("../spread-sheet/src/base/util/domain-config.ts"),o("../node_modules/@tencent/docs-user-agent/dist/index.js"),o("../spread-sheet/src/core/utils/offline-env.ts")),I=o("../node_modules/@tencent/docs-collab/lib/src/messageCenter/index.js"),O=o("../packages/model/src/utils/index.ts"),Z=function(e,t,o,r){return new(o||(o=Promise))((function(n,s){function a(e){try{d(r.next(e))}catch(t){s(t)}}function i(e){try{d(r.throw(e))}catch(t){s(t)}}function d(e){var t;e.done?n(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(a,i)}d((r=r.apply(e,t||[])).next())}))},A=[s.Z.SET_SINGLE_VALUE_REQUEST,s.Z.PASTE_DATA_REQUEST,s.Z.SET_LINK_REQUEST,s.Z.MULTI_REQUEST],M=(0,d.Hr)((function(e,t,o,r,n,s){if(s)return D(t,o,r,n,s,!1);var d={},u=[];if(o&&0!==o.length){var l=!1;o.forEach((function(o){if(o.isNonPersistedLocalChange())u.push(o);else if(!o.isMultiSheetMutation()){var r=o.getAffectedSheetId();if(!r)throw e.event.errorCode.trigger("errorCode",{type:"front",code:c.B.SHEET_ID_NOT_EXIST}),new Error("mutation必须实现getAffectedSheetId接口才能提交！！！");"WORKBOOK"===r&&(l=!0,r=t),d[r]||(d[r]=[]),d[r].push(o)}}));var f=Object.keys(d);if(-1===f.indexOf(t)&&!f.every((function(e){return"WORKBOOK"===e})))throw e.event.errorCode.trigger("errorCode",{type:"front",code:c.B.MUTATION_SHEET_ID_NOT_BELONG_TO_WORKBOOK}),new Error("自动分组后，数据串表的校验会放开，可以同时产生对多个sheet的影响，但需要有当前sheet的修改，否则无法通过统一校验。如果以后有workbook的隐藏sheet修改，最好上层传入对应的sheetId。");f.forEach((function(e){var o=!1;l&&(o=e===t),D(o?t:e,d[e],r,n,!1,o)})),u.length&&e.mainThreadWorker.mutationData.syncNonPersistentMutationsToWorkerThread({mutations:u})}else a.ZP.run(i.CONFIG.COMMIT_EMPTY_MUTATION,[r,t,o,n])}),"commitMutationCore");function R(e,t,r,s){var d,u=o.g.SpreadsheetApp;(null===(d=u.messageCenter)||void 0===d?void 0:d.networkStatusManager.getRoomStatus())===I.RoomState.SHUTDOWN&&(a.ZP.run(i.CONFIG.DO_BEHAVIOR_AFTER_SHUTDOWN),(0,b.Hd)(i.CONFIG.DO_BEHAVIOR_AFTER_SHUTDOWN)||alert(n.ZP.t("表格遇到错误，请刷新页面后重试。")));var l=function(e,t,r){var n=o.g.SpreadsheetApp;try{for(var s=0;s<t.length;s++){var d=t[s];d&&n.mutationBehavior.serializeMutation(d)}return!0}catch(l){console.error(l);var u="";try{u=JSON.stringify(t)}catch(c){console.error(c)}return a.ZP.run(i.CONFIG.COMMIT_MUTATION_CATCH_ERROR,[r,e,u],null===l||void 0===l?void 0:l.stack),!1}}(e,t,r);return!!l&&!(!s&&!function(e,t){for(var r,n=o.g.SpreadsheetApp,s=0;s<t.length;s++){var d=t[s];if(d&&!d.isMultiSheetMutation()&&d.getAffectedSheetId()!==e&&"WORKBOOK"!==d.getAffectedSheetId())return a.ZP.run(i.CONFIG.COMMIT_MUTATION,[e,t]),null===(r=n.messageCenter)||void 0===r||r.shutDown(c.B.MUTATION_SHEET_ID_NOT_MATCH_SHEET),!1}return!0}(e,t))&&(p(u),!0)}function N(e,t,o,r,n){return{sheetId:e,taskId:0,data:t,requestId:o,head:!1,isWorkbook:n,oSubId:null,withKeyData:!1,isOfflineMessage:!1,allowAutoMerge:!1,keyframe:null,createTime:Date.now(),changesetType:void 0}}function U(e,t,r,n){var s,a,i=o.g.SpreadsheetApp,d=e,c=null,u=!1,l=null,f=void 0;if(t[0].id===g.ZP.INSERT_SHEET_MUTATION){u=!0;var p=t[0].sheetDelta.deltas[0].slotOperation===v.C.COPY_SHEET,m=n[0].sheetType,h=(0,O.getIsExternalSheetBySheetType)(m);if(p&&(d=n[0].newSheetId,u=!0,l=e,m=null===(s=i.spreadsheet.sheetManager.getSheetBySheetId(e))||void 0===s?void 0:s.getSheetType(),h=(0,O.getIsExternalSheetBySheetType)(m)),h||!(null===(a=n[0].mutations)||void 0===a?void 0:a.length)&&!p||(c=function(e,t){var o=e.spreadsheet,r=e.mutationBehavior,n=(0,_.createZipKeyframe)(t),s=[];return o.workbookRangeManager.each((function(o){if(t===o.range.sheetId){var n=e.spreadsheet.embeddedObjectManager.getEmbeddedObject(o.embeddedObjectId);switch(o.type){case C.Z.CHART:if(n){var a=new y.Z;a.setEmbeddedObjectId(n.objectId),s.push(r.serializeMutation(new w.Z({workbookRangeId:o.id,workbookRangeType:o.type,gridRange:o.range,workbookRangePropertiesDelta:a}))),s.push(r.serializeMutation(new j.Z({object:n})))}break;case C.Z.PRIVATE_RANGE:s.push(r.serializeMutation(new w.Z({workbookRangeId:o.id,workbookRangeType:o.type,gridRange:o.range,workbookRangePropertiesDelta:new y.Z})))}}})),s.length>0&&(n+="\n"+JSON.stringify([s])),n}(i,d)),h){var k=i.sheetAdapterManager.getAdapterBySheetType(m);c=null===k||void 0===k?void 0:k.getKeyframeBySheetId(d,p),f=function(e,t){null===k||void 0===k||k.handleCreateSheetAcceptCommit(d,t)}}}return{sheetId:d,taskId:0,data:t,requestId:r,head:u,oSubId:l,withKeyData:!1,isOfflineMessage:!1,allowAutoMerge:!1,keyframe:c,createTime:Date.now(),onSuccess:f}}function D(e,t,r,n,s,d){return Z(this,void 0,void 0,regeneratorRuntime.mark((function c(){var u,l,f,p,m;return regeneratorRuntime.wrap((function(c){for(;;)switch(c.prev=c.next){case 0:if(u=o.g.SpreadsheetApp,l=u.spreadsheet,f=u.messageCenterAdapter,R(e,t,r,s)){c.next=5;break}return c.abrupt("return");case 5:if(a.ZP.run(i.CONFIG.CACHE_DATA_FLOW_COMMIT_MUTATION,[r,e]),S.Jn.sendEvent("sheet","sheet_e_edit_"+r),p=s?U(e,t,r,n):N(e,t,r,0,d),F(0===k.q.getConfig("isUserChangeTitle")&&!0,r)&&(m=z(l,B)),!q(r)){c.next=14;break}return c.next=14,H(m);case 14:f.sendMessageCenterAdapter.addUserChange(p);case 15:case"end":return c.stop()}}),c)})))}function F(e,t){return!!t&&A.includes(t)&&e}function q(e){return!P()(e)&&(0,l.q)()}function B(e){return Z(this,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(k.q.getConfig("ver")<5)&&e){t.next=2;break}return t.abrupt("return");case 2:o.g.SpreadsheetApp.spreadsheet.setTitle(e),o.g.SpreadsheetApp.event.spreadsheetEvent.trigger(h.W1.TITLE_AUTO_CHANGE);case 4:case"end":return t.stop()}}),t)})))}function H(e){var t,r;return Z(this,void 0,void 0,regeneratorRuntime.mark((function n(){var s,a;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(n.prev=0,s=o.g.SpreadsheetApp,(0,E.j)()&&(null===(t=s.offlineOpen)||void 0===t?void 0:t.isDBAvaliable())&&(0,l.q)()){n.next=4;break}return n.abrupt("return");case 4:if(!e){n.next=8;break}return n.next=7,s.offlineOpen.offlineDataManager.getHelper().updatePadInfo(k.q.getConfig("globalPadId"),{title:e,last_modify_ts:Date.now()});case 7:k.q.setConfig({isUserChangeTitle:1,title:e});case 8:return a=s.offlineOpen.offlineDataManager.getHelper().clientVars2OfflineData(k.q.getConfig("globalPadId"),o.g.clientVars,!0),n.next=11,s.offlineOpen.offlineDataManager.getDatabase().update(x.me.DOCUMENT_DATA,a);case 11:return n.next=13,s.offlineOpen.tryToCreateFile();case 13:n.next=18;break;case 15:n.prev=15,n.t0=n.catch(0),null===(r=o.g.log)||void 0===r||r.error("标题同步数据库失败",null===n.t0||void 0===n.t0?void 0:n.t0.stack,null===n.t0||void 0===n.t0?void 0:n.t0.message);case 18:case"end":return n.stop()}}),n,null,[[0,15]])})))}function z(e,t){var o=/^[^\u4e00-\u9fa5a-zA-Z\d]+/,r=/[^\u4e00-\u9fa5a-zA-Z\d]+$/,n=function(e){var t="";if(e){var n=(t=e.replace(o,"").replace(r,"").trim()).split(/\s{10}/),s=n[n.length-1];s&&n.length>1&&(s=s.replace(/^\s*/,""),t=n[0]+"          "+s)}return t},s=function(e){if(e){for(var t="",r=0;r<e.data.rowData.length;r++)if(e.data.rowData[r]){for(var s=e.data.rowData[r].values,a=0;a<s.length;a++){var i=s[a];if(i){var d=i.getFormattedValue();if(!i.getFormula()&&(c=null===d||void 0===d?void 0:d.value)&&c.replace(o,"").length>0){t=n(null===d||void 0===d?void 0:d.value);break}}}if("string"===typeof t&&t)break}return t}var c}(e.activeSheet);return"function"===typeof t&&t(s),s}window.checkBeforeCommitForSmartSheet=function(){var e,t=o.g.SpreadsheetApp;return"SHUTDOWN"===(null===(e=t.messageCenter)||void 0===e?void 0:e.networkStatusManager.getRoomStatus())?(a.ZP.run(i.CONFIG.DO_BEHAVIOR_AFTER_SHUTDOWN),(0,b.Hd)(i.CONFIG.DO_BEHAVIOR_AFTER_SHUTDOWN)||alert(n.ZP.t("表格遇到错误，请刷新页面后重试。")),!1):(p(t),!0)}},"../spread-sheet/src/core/app/lazytool/index.ts":function(e,t,o){o.r(t),o.d(t,{createDataKeyframeStr:function(){return c},createSheetWithKeyframe:function(){return f},createZipKeyframe:function(){return u},getKeyframe:function(){return l}}),o("../node_modules/core-js/modules/es.array.iterator.js"),o("../node_modules/core-js/modules/es.object.to-string.js"),o("../node_modules/core-js/modules/web.dom-collections.iterator.js");var r=o("../packages/report/src/index.ts"),n=o("../spread-sheet/src/base/config/version.ts"),s=o("../spread-sheet/src/base/event/event.ts"),a=o("../spread-sheet/src/base/config/report.ts"),i=o("../spread-sheet/src/core/data/converter/tencentdoc/keyframeToSheetConverter.ts"),d=o("../spread-sheet/src/core/data/converter/keyframe/zip.ts");function c(e){var t,s=e||o.g.SpreadsheetApp.spreadsheet.activeSheetId,a=o.g.SpreadsheetApp.spreadsheet.sheetManager.getSheetBySheetId(s);return(null===a||void 0===a?void 0:a.isLoaded)?(t=JSON.stringify(a.serialize()),function(e){try{if(!e)return;for(var t=e.data.rowData,o=!1,n=0,s=t.length;n<s&&!o;n++){var a=t[n];if(a&&a.values)for(var i=0,d=a.values.length;i<d;i++){var c=a.values[i];if(c){var u=c.getFormula();if(u){var l=u.getParts();if(l&&0===l.length){r.ZP.monitor(33613232),o=!0;break}}}}}}catch(f){}}(a),{type:"k",k:t,startRow:0,startCol:0,ver:n.Z.KEYFRAME_VER,newSheetId:s}):null}function u(e){r.ZP.jank.stopReport(),r.ZP.jank.log({moduleValue:"keyframe",actionValue:"createKeyframe"}),r.ZP.jank.restartReport();var t=c(e);if(!t){r.ZP.monitor(33711501);var n=o.g.SpreadsheetApp.spreadsheet.sheetManager.getSheetBySheetId(e);return r.ZP.run(a.CONFIG.CREATE_ZIPKETFRAME,[e,null===n||void 0===n?void 0:n.isFetching,null===n||void 0===n?void 0:n.isLoaded]),null}var s=(0,d.cD)(t);return s||JSON.stringify([t])}function l(){var e,t,o=null===(t=null===(e=clientVars.collab_client_vars)||void 0===e?void 0:e.initialAttributedText)||void 0===t?void 0:t.text;return o?o=JSON.stringify(o):(console.error("获取不到子表 keyframe."),"")}function f(e,t){void 0===t&&(t="BB08J2");var r=o.g.SpreadsheetApp,n=r.spreadsheet.sheetManager.getSheetBySheetId(t);n?(r.spreadsheet.sheetManager.reInitSheetBySheetId(t),n=r.spreadsheet.sheetManager.getSheetBySheetId(t)):(n=r.spreadsheet.sheetManager.createSheet({id:t,name:t}),r.spreadsheet.sheetManager.insertSheet(n)),r.getCurrentMainThreadWorker().sheetData.clearAndReInitOneSheet({sheetId:t}),r.calcController.resetSheet(t);var a=n.getRowCount(),d=n.getColCount();(0,i.Z)(r.spreadsheet,t,JSON.parse(e),0,a-1);for(var c=0;c<a;c++)for(var u=0;u<d;u++)r.spreadsheet.autoUpdateCellData(t,c,u);n.isLoaded=!0,r.spreadsheet.activeSheetId=t,s.ZP.sheetsBar.trigger("switchSheet",t),r.getCurrentMainThreadWorker().loadSheetToWorkerIfNeeded(t)}},"../spread-sheet/src/core/data/converter/keyframe/zip.ts":function(e,t,o){o.d(t,{_v:function(){return f},cD:function(){return d},mS:function(){return u}}),o("../node_modules/core-js/modules/es.array.iterator.js"),o("../node_modules/core-js/modules/es.array-buffer.slice.js"),o("../node_modules/core-js/modules/es.object.to-string.js"),o("../node_modules/core-js/modules/es.typed-array.uint8-array.js"),o("../node_modules/core-js/modules/es.typed-array.copy-within.js"),o("../node_modules/core-js/modules/es.typed-array.every.js"),o("../node_modules/core-js/modules/es.typed-array.fill.js"),o("../node_modules/core-js/modules/es.typed-array.filter.js"),o("../node_modules/core-js/modules/es.typed-array.find.js"),o("../node_modules/core-js/modules/es.typed-array.find-index.js"),o("../node_modules/core-js/modules/es.typed-array.for-each.js"),o("../node_modules/core-js/modules/es.typed-array.includes.js"),o("../node_modules/core-js/modules/es.typed-array.index-of.js"),o("../node_modules/core-js/modules/es.typed-array.iterator.js"),o("../node_modules/core-js/modules/es.typed-array.join.js"),o("../node_modules/core-js/modules/es.typed-array.last-index-of.js"),o("../node_modules/core-js/modules/es.typed-array.map.js"),o("../node_modules/core-js/modules/es.typed-array.reduce.js"),o("../node_modules/core-js/modules/es.typed-array.reduce-right.js"),o("../node_modules/core-js/modules/es.typed-array.reverse.js"),o("../node_modules/core-js/modules/es.typed-array.set.js"),o("../node_modules/core-js/modules/es.typed-array.slice.js"),o("../node_modules/core-js/modules/es.typed-array.some.js"),o("../node_modules/core-js/modules/es.typed-array.sort.js"),o("../node_modules/core-js/modules/es.typed-array.subarray.js"),o("../node_modules/core-js/modules/es.typed-array.to-locale-string.js"),o("../node_modules/core-js/modules/es.typed-array.to-string.js"),o("../node_modules/core-js/modules/es.array.join.js"),o("../node_modules/core-js/modules/es.array.slice.js"),o("../node_modules/core-js/modules/es.regexp.exec.js"),o("../node_modules/core-js/modules/es.string.split.js"),o("../node_modules/core-js/modules/es.regexp.constructor.js"),o("../node_modules/core-js/modules/es.regexp.to-string.js"),o("../node_modules/core-js/modules/es.string.match.js"),o("../node_modules/core-js/modules/es.object.get-own-property-names.js"),o("../node_modules/core-js/modules/es.array.map.js"),o("../node_modules/core-js/modules/web.dom-collections.for-each.js"),o("../node_modules/core-js/modules/es.object.keys.js");var r=o("../node_modules/pako/index.js"),n=o.n(r),s=(o("../node_modules/atob/browser-atob.js"),o("../packages/report/src/index.ts")),a=o("../spread-sheet/src/base/config/report.ts"),i=6e3;function d(e){var t="";try{!function(e){if(e&&e.k){var t,o=e.k.st,r=e.k.s;if("set"===o){var n,s=0;try{s=c(JSON.stringify(r)).length}catch(a){o="z",t=n=p(r)}n||(n=p(r),.9*s>c(JSON.stringify(n)).length?(o="z",t=n):(o="set",t=r)),e.k.st=o,e.k.s=t}}}(e);var o=JSON.stringify([e]),r=n().deflate(o);if(r){var i={type:"k",z:u(r)};t=JSON.stringify([i])}else s.ZP.run(a.CONFIG.ZIP_KEYFRAME)}catch(d){s.ZP.run(a.CONFIG.ZIP_KEYFRAME_CATCH_ERROR,[null===d||void 0===d?void 0:d.stack])}return t}function c(e){return u(n().deflate(e))}function u(e){for(var t="",o=0,r=e.length;o*i<r;)t+=btoa(String.fromCharCode.apply(null,Array.prototype.slice.call(e,o*i,(o+1)*i))),o++;return t}function l(e){if(!e||!e.from||!e.to)return"";var t=function(e){if(!e||!e.from||!e.to)return[];var t={row:Math.min(e.from.row,e.to.row),col:Math.min(e.from.col,e.to.col)},o={row:Math.max(e.from.row,e.to.row),col:Math.max(e.from.col,e.to.col)};return[t,o]}(e),o=t[0],r=t[1];if(o&&r){if(o.col===r.col&&o.row===r.row)return f(o);var n=f(o),s=f(r);if(n&&s)return n+":"+s;if(n)return n;if(s)return s}return""}function f(e){var t="";if(e&&"number"===typeof e.col){var o="A".charCodeAt(0),r="Z".charCodeAt(0)-"A".charCodeAt(0)+1;if(!r)return"";var n=e.col||0,s=0,a=!0;do{s=Math.floor(n%r-(a?0:1)),n=Math.floor(n/r),t=String.fromCharCode(s+o)+t,a=!1}while(n);t+=e.row+1}return t}function p(e){var t=function(e){if(e&&e.length){for(var t=g(e),o=[],r=0,n=t.length;r<n;r++)for(var s=0,a=t[r].length;s<a;s++){var i=t[r][s];if(i&&(!i.isSearched||1!==i.isSearched)){var d={row:r,col:r},c=h(t,d,v(i));if(c){m(t,i,d,c);var u={from:d,to:c},f=g(i);delete f.isSearched;var p=[l(u),f];o.push(p)}}}return o}function v(e){var t=function(t){var o=function(e,t){if(null===e&&null===t)return!0;if(null===e||null===t)return!1;if("object"!==typeof e||"object"!==typeof t)return!1;if(e.isSearched&&1===e.isSearched)return!1;var o=!0;for(var r in t)t[r]!==e[r]&&(o=!1);return o}(t,e);return o};return t}}(e);return t}function m(e,t,o,r){if(o&&"number"===typeof o.row&&"number"===typeof o.col&&r&&"number"===typeof r.row&&"number"===typeof r.col){o||(o={row:0,col:0});for(var n=Object.getOwnPropertyNames(t).length-(t.isSearched?1:0),s=o.row;s<=r.row;s++)for(var a=o.col;a<=r.col;a++){var i=e[s][a];i&&(n===Object.getOwnPropertyNames(i).length-(i.isSearched?1:0)?i.isSearched=1:i.isSearched=2)}}}function h(e,t,o){if(e&&e.length&&e[t.row].length){var r,n,s;t||(t={row:0,col:0});var a=0,i={row:t.row,col:t.col};for(r=t.row,n=e.length;r<n;r++){var d=e[r];for(s=t.col,a=a?Math.min(a,d.length):d.length;s<a;s++){if(!o(d[s])){if(r===t.row)i.col=s-1,a=s;else if(r===e.length-1)i.row=e.length-1;else if(s<i.col+1)return i.row=r-1,i;break}s===d.length-1?(i.col=d.length-1,r===e.length-1&&(i.row=e.length-1)):r===e.length-1&&s===a-1&&(i.row=e.length-1)}}return i}}var g=function e(t){if(!t||"object"!==typeof t)return t;var o={};return Array.isArray(t)?o=t.map((function(t){return e(t)})):Object.keys(t).forEach((function(r){return o[r]=e(t[r])})),o}},"../spread-sheet/src/core/utils/url.ts":function(e,t,o){function r(e,t){return t?(e.indexOf("?")>=0?e+="&"+t:e+="?"+t,e):e}o.d(t,{_:function(){return r}})},"../spread-sheet/src/external/errorUI/client.ts":function(e,t,o){o.d(t,{$N:function(){return K},Bx:function(){return F},Hd:function(){return ee},I5:function(){return $},ID:function(){return X},OH:function(){return R},Pr:function(){return L},Q9:function(){return O},St:function(){return W},WT:function(){return I},Y6:function(){return q},YZ:function(){return E},Y_:function(){return Z},g$:function(){return Y},hn:function(){return Q},i9:function(){return N},iZ:function(){return z},jr:function(){return G},qe:function(){return M},sQ:function(){return B},uZ:function(){return J},wM:function(){return V},wc:function(){return U},x4:function(){return A}}),o("../node_modules/regenerator-runtime/runtime.js"),o("../node_modules/core-js/modules/es.object.to-string.js"),o("../node_modules/core-js/modules/es.promise.js"),o("../node_modules/core-js/modules/es.array.join.js"),o("../node_modules/core-js/modules/es.array.find.js"),o("../node_modules/core-js/modules/es.function.name.js"),o("../node_modules/core-js/modules/es.array.slice.js"),o("../node_modules/core-js/modules/es.object.assign.js");var r=o("../node_modules/i18next/dist/esm/i18next.js"),n=o("../node_modules/lodash/once.js"),s=o.n(n),a=o("../node_modules/@tencent/dui/lib/components/Modal/index.js"),i=o("../node_modules/@tencent/dui/lib/components/Snackbar/index.js"),d=o("../spread-sheet/src/external/errorUI/utils.ts"),c=o("../spread-sheet/src/base/event/event.ts"),u=o("../spread-sheet/src/external/offline-edit/clear-type.ts"),l=o("../packages/report/src/index.ts"),f=o("../spread-sheet/src/external/errorUI/collector.ts"),p=o("../node_modules/@tencent/docs-user-agent/dist/index.js"),m=o.n(p),h=o("../packages/common-utils/src/index.ts"),g=o("../spread-sheet/src/core/login/index.ts"),v=o("../spread-sheet/src/external/feedback/supportpage.ts"),_=o("../node_modules/@tencent/dui-mobile/lib/components/Toast/index.js"),C=o("../spread-sheet/src/core/data/configService/spreadConfig.ts"),w=o("../spread-sheet/src/core/app/utils.ts"),y=o("../spread-sheet/src/base/error/error-code-report.ts"),j=o("../spread-sheet/src/core/view/level-2/collab-center-ent/utils.ts"),k=(o("../spread-sheet/src/base/util/domain-config.ts"),o("../spread-sheet/src/base/index.ts")),x=o("../spread-sheet/src/core/view/spreadsheet-view/model/line-engine/split.ts"),b=o("../spread-sheet/src/base/util/appConfig.ts"),S=function(e,t,o,r){return new(o||(o=Promise))((function(n,s){function a(e){try{d(r.next(e))}catch(t){s(t)}}function i(e){try{d(r.throw(e))}catch(t){s(t)}}function d(e){var t;e.done?n(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(a,i)}d((r=r.apply(e,t||[])).next())}))},T=m().isMobilePhone?10:20,P={offline:{mobile:r.ZP.t("网络异常，编辑内容会在网络恢复后同步。"),pc:[r.ZP.t("网络异常，离线"),r.ZP.t("中，文档最新内容会在网络恢复后同步。")]},editCannotSave:[r.ZP.t("编辑内容暂无法保存"),r.ZP.t("。")],fileNotExist:{mobile:r.ZP.t("文件已被创建者删除，内容无法上传。为防止内容丢失，请将刚刚编辑的内容复制粘贴到本地进行备份，再点击刷新。"),pc:r.ZP.t("文件已被创建者删除，内容无法上传。为防止内容丢失，请将刚刚编辑的内容复制粘贴到本地或导出文件进行备份，再点击刷新。")},loginExpired:[r.ZP.t("登录过期，请重新登录"),r.ZP.t("。")],unAuth:{rangeAuth:r.ZP.t("所在行列包含保护范围，暂不支持此操作。"),mobileAuth:r.ZP.t("权限变化，编辑内容暂无法保存。"),commonAuth:[r.ZP.t("你在当前文档的权限已变更"),r.ZP.t("。")]},bigData:r.ZP.t("数据量较大，操作不成功"),security:[r.ZP.t("此内容因违规无法编辑"),r.ZP.t("。")],duplicateSheet:{actions:{insertNewSheet:r.ZP.t("新建工作表"),moveSheet:r.ZP.t("移动工作表"),copySheetById:r.ZP.t("创建副本"),deleteSheet:r.ZP.t("删除工作表"),renameSheet:r.ZP.t("重命名工作表")},message:r.ZP.t("失败，我们对此表示抱歉。可尝试刷新页面或联系我们反馈问题，我们将尽快为你修复。")},permissionChange:r.ZP.t("你在此文档的权限已发生变化。"),privateFilter:r.ZP.t("查看权限下筛选仅自己可见。"),collaborateFilter:r.ZP.t("有"+j.PJ+"覆盖了你的筛选"),filterChange:{actions:[r.ZP.t("筛选"),r.ZP.t("排序")],message:[r.ZP.t("有"+j.PJ),r.ZP.t("了内容。")]},shutDown:[r.ZP.t("表格遇到错误，请刷新页面后重试"),r.ZP.t("。")],offlineData:[r.ZP.t("离线数据同步失败，请连接网络后刷新"),r.ZP.t("。")],crashFeedBack:[r.ZP.t("加载表格时遇到未知错误，我们对此表示抱歉，可尝试刷新页面或联系我们反馈问题，我们将尽快为你修复"),r.ZP.t("。")],databaseError:r.ZP.t("表格离线数据处理遇到错误，请刷新页面后重试。"),serverConnect:[r.ZP.t("暂无法连接到服务器"),r.ZP.t("。")],netOfflineError:[r.ZP.t("暂无法连接到服务器，且离线编辑不可用，请检查网络后重试"),r.ZP.t("。")]};function E(e,t,o){if(void 0===e&&(e=!0),!m().isTencentDocsApp||!m().isTencentDocsAppVersionAboveOrEqual("2.2.0")||!m().isAndroidPad&&!m().isIPad){var n,s=e?r.ZP.t("编辑"):r.ZP.t("查看"),a=P.offline.pc.join(s);return n=i.default.show({id:o,message:a,style:{zIndex:10003},autoClose:!1,closable:!0}),t&&t(n),f.e.doms.push(n),(0,y.V)({errorCode:o,message:"errorUI-client-showNetworkOfflineTip()",snackbarMsg:a,tipsCustom:{upid:C.q.getConfig("upid")}}),n}}function I(e){var t=P.editCannotSave.join("("+e+")"),o=i.default.show({id:e,message:t,type:"error",style:{zIndex:10003},autoClose:!1,onClose:function(){return!0},action:[{text:r.ZP.t("如何处理"),onClick:function(){return(0,d.vT)(e),!1}}]});(0,y.V)({errorCode:e,message:"errorUI-client-showSaveFrontEndErrorTip()",snackbarMsg:t,tipsCustom:{upid:C.q.getConfig("upid")}}),f.e.doms.push(o)}function O(e){var t=P.fileNotExist.pc,o=P.editCannotSave.join("("+e+")"),n=i.default.show({id:e,message:o,type:"error",style:{zIndex:10003},autoClose:!1,onClose:function(){return!0},action:[{text:r.ZP.t("如何处理"),onClick:function(){return(0,d.vT)(e,!1,!1,t),!1}}]});(0,y.V)({errorCode:e,message:"errorUI-client-showFileNotExsitErrorTip()",snackbarMsg:o,tipsCustom:{upid:C.q.getConfig("upid")}}),f.e.doms.push(n)}function Z(e){var t,o=P.loginExpired.join("("+e+")"),n=m().isWxWork,s=i.default.show({id:e,message:o,style:{zIndex:10003},autoClose:!1,onClose:function(){return!0},action:[{text:n?r.ZP.t("刷新"):r.ZP.t("登录"),onClick:function(){n?location.reload():null===g.Z||void 0===g.Z||g.Z.login()}}]});null===(t=window.tdocs)||void 0===t||t.log({message:"[NETWORK WS ERROR TIPS]: 登录态过期(errorCode:"+e+")",level:"error"}),(0,y.V)({errorCode:e,message:"errorUI-client-showLoginExpiredTip()",snackbarMsg:o,tipsCustom:{upid:C.q.getConfig("upid")}}),f.e.doms.push(s)}function A(e){var t,n;c.ZP.spreadsheetEvent.trigger("clearOfflineStore",{type:u.N.ALL}),null===(n=null===(t=o.g.SpreadsheetApp.messageCenter)||void 0===t?void 0:t.localUserChangeManager)||void 0===n||n.clearAllUserChangeQueue();var s="40203"===e,a=P.unAuth.rangeAuth+"("+e+")",d=(P.unAuth.mobileAuth,P.unAuth.commonAuth.join("("+e+")")),l=s?a:d,p=i.default.show({id:e,message:l,type:s?"info":"error",style:{zIndex:10003},autoClose:!1,closable:s,onClose:s?function(){return!0}:function(){return!1},action:[{text:r.ZP.t("刷新"),onClick:function(){return s&&(o.g.refreshReason=w.QU),location.reload(),!1}}]});(0,y.V)({errorCode:e,message:"errorUI-client-showUnAuthTip()",snackbarMsg:l,tipsCustom:{upid:C.q.getConfig("upid")}}),f.e.doms.push(p)}function M(e,t){void 0===t&&(t=P.bigData);var o=i.default.show({id:e,message:t,type:"info",style:{zIndex:10003,height:"auto",minHeight:"52px"},autoClose:!1,closable:!0,onClose:function(){return l.ZP.tdwReport({module:"excel_tips",opername:"doc_excel_editor",action:"excel_tips_copypaste_click"}),!0},action:[{text:r.ZP.t("如何处理"),onClick:function(){return(0,d.vT)(e),!1}}]});f.e.doms.push(o),l.ZP.tdwReport({module:"excel_tips",opername:"doc_excel_editor",action:"excel_tips_copypaste_view"}),(0,y.V)({errorCode:e,message:"errorUI-client-showBigDataFromFrontTip()",snackbarMsg:t,tipsCustom:{upid:C.q.getConfig("upid")}})}function R(e){var t=P.security.join("("+e+")"),o=i.default.show({id:e,message:t,type:"error",style:{zIndex:10003},autoClose:!1,onClose:function(){return!0},action:[{text:r.ZP.t("了解详情"),onClick:function(){window.open("https://"+b.Z.getConfig("runtime.domainName")+"/doc/DWE9lbGhWTU9OV2VF","_blank")}}]});f.e.doms.push(o),(0,y.V)({errorCode:e,message:"errorUI-client-showSecurityTip()",snackbarMsg:t,tipsCustom:{upid:C.q.getConfig("upid")}})}function N(e,t){var o,n=P.duplicateSheet.actions[t]+P.duplicateSheet.message;o=a.default.confirm({title:r.ZP.t("系统消息"),content:n,okText:r.ZP.t("联系我们"),onOk:function(){window.open(b.Z.getConfig("links.feedback")+"?customInfo="+e,"_blank")},cancelText:r.ZP.t("刷新"),onCancel:function(){window.location.reload()},onClose:function(){window.location.reload()}}),f.e.doms.push(o),(0,y.V)({errorCode:e,message:"errorUI-client-showSheetBarDuplicateSheetId()",snackbarMsg:n,tipsCustom:{upid:C.q.getConfig("upid")}})}function U(e){var t,n;if(c.ZP.spreadsheetEvent.trigger("clearOfflineStore",{type:u.N.ALL}),null===(n=null===(t=o.g.SpreadsheetApp.messageCenter)||void 0===t?void 0:t.localUserChangeManager)||void 0===n||n.clearAllUserChangeQueue(),!o.g.__alreadyShowPermissionChangesTip){o.g.__alreadyShowPermissionChangesTip=!0;var s=P.permissionChange,a=i.default.show({id:e,message:s,style:{zIndex:10003},autoClose:!1,onClose:function(){return!0},action:[{text:r.ZP.t("刷新"),onClick:function(){window.location.reload()}}]});f.e.doms.push(a),(0,y.V)({errorCode:e,message:"errorUI-client-showPermissionChangesTip()",snackbarMsg:s,tipsCustom:{upid:C.q.getConfig("upid")}})}}function D(e){var t=C.q.getConfig("userId"),o=C.q.getConfig("userName");if(e===t)return o;var r=(C.q.getConfig("invitedUserInfos")||[]).find((function(t){return t.userId===e}));return null===r||void 0===r?void 0:r.name}var F=s()((function(){var e=P.privateFilter;i.default.show({message:e,zIndex:10003,autoClose:!0,id:"local_filter"})}));function q(){var e=P.collaborateFilter;i.default.show({message:e,zIndex:10003,action:r.ZP.t("好的"),autoClose:!1})}function B(e,t,o){var n=D(t),s=e?P.filterChange.actions[0]:P.filterChange.actions[1],a=P.filterChange.message.join(s),d="";n&&(d=n.length>T?"「"+function(e,t){if(k.Z.util.string.hasEmojiCharacter(e)){var o=new x.eE(e)._emojiString._match;return o.length>t?o.slice(0,t).join("")+"...":o.join("")}return e.substr(0,t)+"..."}(n,T)+"」":"「"+n+"」"),d&&(a=d+s+P.filterChange.message[1]);var c=i.default.show({message:a,zIndex:10003,autoClose:!1,action:r.ZP.t("好的"),onClickAction:function(){o(),l.ZP.tdwReport({opername:"doc_filter",module:"doc_filter_guest",action:"doc_"+(e?"filter":"rank")+"_guest_confirm",ver11:"pc"})},id:"collab_filter_reorder_tip"});return f.e.doms.push(c),c}var H=null;function z(e,t){return S(this,void 0,void 0,regeneratorRuntime.mark((function o(){var n,s,a;return regeneratorRuntime.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:if(!H){o.next=5;break}return H.close(),H=null,o.next=5,new Promise((function(e){return setTimeout(e,300)}));case 5:if(t||e){o.next=9;break}return n=r.ZP.t("已取消“筛选对所有人可见”。"),i.default.show({id:"filter-sync-close-tip",className:"filter-sync-close-tip",message:n,zIndex:10003,type:"success"}),o.abrupt("return");case 9:t&&(s=D(t),a=r.ZP.t("{{value0}} {{value1}}“筛选对所有人可见”。",{value0:s?"「"+(s.length>T?s.substr(0,T)+"...":s)+"」":"有"+j.PJ,value1:e?"开启":"关闭"}),H=i.default.show(Object.assign({message:a,zIndex:10003},e?{autoClose:!1,action:r.ZP.t("好的"),onClickAction:function(){H=null,l.ZP.tdwReport({opername:"doc_filter",module:"doc_filter_guest",action:"doc_filter_guest_click",ver11:"pc"})}}:{})),!e&&setTimeout((function(){H=null}),2e3));case 10:case"end":return o.stop()}}),o)})))}function W(){_.default.show({duration:3e3,content:r.ZP.t("已自动保存"),style:{zIndex:2e4},autoClose:!0})}function V(){_.default.show({duration:3e3,content:r.ZP.t("保存失败"),style:{zIndex:2e4},autoClose:!0})}function L(e){var t=P.netOfflineError.join("("+e+")"),o=i.default.show({id:e,message:t,style:{zIndex:10003},autoClose:!1,action:[{text:r.ZP.t("刷新"),onClick:function(){window.location.reload()}}]});f.e.doms.push(o),(0,y.V)({errorCode:e,message:"errorUI-client-showNetOfflineErrorTip()",snackbarMsg:t,tipsCustom:{upid:C.q.getConfig("upid")}})}function G(){var e,t;null===(t=null===(e=o.g.CoreSheet)||void 0===e?void 0:e.saveStatus)||void 0===t||t.showSaveTips("offline",null,r.ZP.t("正在离线编辑"),r.ZP.t("正在离线编辑")),(0,h.Ds)((function(){var e,t;null===(t=null===(e=o.g.CoreSheet)||void 0===e?void 0:e.saveStatus)||void 0===t||t.showSaveTips("offline",3e3,r.ZP.t("离线编辑保存成功"),r.ZP.t("离线编辑保存成功"))}),1e3)()}function K(){}function J(e){var t=P.serverConnect.join("("+e+")"),o=i.default.show({id:e,message:t,style:{zIndex:10003},autoClose:!1,onClose:function(){return!0},action:[{text:r.ZP.t("刷新"),onClick:function(){window.location.reload()}},{text:r.ZP.t("联系我们"),onClick:function(){(0,d.cx)(e)}}]});f.e.doms.push(o),(0,y.V)({errorCode:e,message:"errorUI-client-showServerConnectFailTip()",snackbarMsg:t,tipsCustom:{upid:C.q.getConfig("upid")}})}function Q(e){var t=P.shutDown.join(""),o=a.default.confirm({title:r.ZP.t("系统消息"),content:t,okText:r.ZP.t("刷新"),onOk:function(){window.location.reload()},cancelText:r.ZP.t("联系我们"),onCancel:function(){return(0,d.cx)(e),!1}});f.e.doms.push(o),(0,y.V)({errorCode:e,message:"errorUI-client-showCommonErrorModal1()",snackbarMsg:t,tipsCustom:{upid:C.q.getConfig("upid")}})}function Y(e){var t=P.databaseError,o=a.default.confirm({title:r.ZP.t("系统消息"),content:t,okText:r.ZP.t("刷新"),onOk:function(){window.location.reload()},cancelText:r.ZP.t("联系我们"),onCancel:function(){return(0,d.cx)(e),!1}});f.e.doms.push(o),(0,y.V)({errorCode:e,message:"errorUI-client-showDatabaseErrorModal()",snackbarMsg:t,tipsCustom:{upid:C.q.getConfig("upid")}})}function X(e){var t=P.crashFeedBack.join(""),o={title:r.ZP.t("系统消息"),content:t,cancelText:null,okText:r.ZP.t("反馈"),onOk:function(){(0,v.nz)()}},n=a.default.confirm(o);f.e.doms.push(n),(0,y.V)({errorCode:e,message:"errorUI-client-showCommonCrashAndFeedBackModal()",snackbarMsg:t,tipsCustom:{upid:C.q.getConfig("upid")}})}function $(e,t){void 0===t&&(t=!1);var o=P.offlineData.join("("+e+")"),n=i.default.show({id:e,message:o,style:{zIndex:10003},autoClose:!1,action:[t?{text:r.ZP.t("如何处理"),onClick:function(){return(0,d.vT)(e),!1}}:{text:r.ZP.t("刷新"),onClick:function(){window.location.reload()}}]});f.e.doms.push(n),(0,y.V)({errorCode:e,message:"errorUI-client-showOfflineSyncError()",snackbarMsg:o,tipsCustom:{upid:C.q.getConfig("upid")}})}function ee(e){var t,o=P.shutDown.join("");return t=a.default.confirm({title:r.ZP.t("系统消息"),content:o,okText:r.ZP.t("刷新"),onOk:function(){window.location.reload()},cancelText:r.ZP.t("联系我们"),onCancel:function(){window.open(b.Z.getConfig("links.feedback")+"?customInfo="+e,"_blank")},onClose:function(){window.location.reload()}}),f.e.doms.push(t),(0,y.V)({errorCode:e,message:"errorUI-client-showDoBehaviorAfterShutDownModal()",snackbarMsg:o,tipsCustom:{upid:C.q.getConfig("upid")}}),t}},"../spread-sheet/src/external/errorUI/collector.ts":function(e,t,o){o.d(t,{e:function(){return r}}),o("../node_modules/core-js/modules/web.dom-collections.for-each.js");var r={doms:[],destroy:function(){var e;null===(e=o.g.log)||void 0===e||e.debug("flow errorUICollector destroy()"),this.doms.forEach((function(e){e&&e.close&&e.close()})),this.doms=[]}}},"../spread-sheet/src/external/errorUI/utils.ts":function(e,t,o){o.d(t,{cx:function(){return p},vT:function(){return m}});var r=o("../node_modules/i18next/dist/esm/i18next.js"),n=o("../node_modules/@tencent/dui/lib/components/Modal/index.js"),s=o("react"),a=o.n(s);function i(e,t,o){return void 0===o&&(o=!0),a().createElement("div",null,a().createElement("div",null,e),a().createElement("div",{style:{opacity:.4}},o?r.ZP.t("错误码"):r.ZP.t("状态码"),":",t," ",function(){var e=new Date,t=e.getFullYear(),o=e.getMonth()+1<10?"0"+(e.getMonth()+1):e.getMonth()+1,r=e.getDate()<10?"0"+e.getDate():e.getDate();return t+"-"+o+"-"+r}()))}var d=o("../spread-sheet/src/base/event/event.ts"),c=o("../spread-sheet/src/external/offline-edit/clear-type.ts"),u=o("../spread-sheet/src/external/errorUI/collector.ts"),l=o("../spread-sheet/src/external/export/interface.ts"),f=o("../spread-sheet/src/base/util/appConfig.ts");function p(e){window.open(f.Z.getConfig("links.feedback")+"?customInfo="+e,"_blank")}function m(e,t,s,a){var f;void 0===t&&(t=!0),void 0===s&&(s=!0),d.ZP.spreadsheetEvent.trigger("onShowHowToHandleDataLostModal"),f=t?n.default.confirm({maskStyle:{zIndex:10004},title:r.ZP.t("如何处理"),content:i(a||r.ZP.t("为防止内容丢失，请将刚刚编辑的内容复制粘贴到本地或导出文件进行备份，再点击修复。"),e,s),okText:r.ZP.t("导出文件"),onOk:function(){var e;return null===(e=o.g.SpreadsheetApp)||void 0===e||e.getSheetExportManager().then((function(e){return e.export(l.I.xlsxServer)})),!1},cancelText:r.ZP.t("修复"),onCancel:function(){!function(e){var t;t=n.default.confirm({maskStyle:{zIndex:10004},title:r.ZP.t("提示"),content:i(r.ZP.t("修复过程将会清除本地缓存，可能造成部分内容丢失。请确认内容已备份到本地，再开始修复。"),e),okText:r.ZP.t("开始修复"),cancelText:"",onOk:function(){return d.ZP.spreadsheetEvent.trigger("clearOfflineStore",{type:c.N.UN_COMMITTED,callback:function(){window.location.reload()}}),!1},action:r.ZP.t("联系我们"),onClickAction:function(){return p(e),!1},onClose:function(){}}),u.e.doms.push(t)}(e)},action:r.ZP.t("联系我们"),onClickAction:function(){return p(e),!1},onClose:function(){}}):n.default.confirm({maskStyle:{zIndex:10004},title:r.ZP.t("如何处理"),content:i(a||r.ZP.t("为防止数据丢失，请勿刷新或关掉页面。建议先导出文件或将编辑的内容复制粘贴到本地，然后再刷新页面。"),e,s),okText:r.ZP.t("导出文件"),onOk:function(){var e;return null===(e=o.g.SpreadsheetApp)||void 0===e||e.getSheetExportManager().then((function(e){return e.export(l.I.xlsxServer)})),!1},cancelText:r.ZP.t("刷新"),onCancel:function(){window.location.reload()},action:r.ZP.t("联系我们"),onClickAction:function(){return p(e),!1},onClose:function(){}}),u.e.doms.push(f)}},"../spread-sheet/src/external/export/interface.ts":function(e,t,o){var r,n;o.d(t,{I:function(){return r},j:function(){return n}}),function(e){e.xlsx="xlsx",e.xlsxServer="xlsxServer",e.xlsxWithFiles="xlsxWithFiles",e.csv="csv"}(r||(r={})),function(e){e[e.LOOP_TIME_OUT=0]="LOOP_TIME_OUT",e[e.QUERY_ERROR_CATCH=1]="QUERY_ERROR_CATCH",e[e.QUERY_ERROR_UNEXPECT=2]="QUERY_ERROR_UNEXPECT",e[e.EXPORT_ERROR_CATCH=3]="EXPORT_ERROR_CATCH",e[e.EXPORT_ERROR_UNEXPECT=4]="EXPORT_ERROR_UNEXPECT"}(n||(n={}))},"../spread-sheet/src/external/feedback/supportpage.ts":function(e,t,o){o.d(t,{nz:function(){return v},vt:function(){return _}}),o("../node_modules/regenerator-runtime/runtime.js"),o("../node_modules/core-js/modules/es.object.to-string.js"),o("../node_modules/core-js/modules/es.promise.js"),o("../node_modules/core-js/modules/es.function.name.js"),o("../node_modules/core-js/modules/es.number.constructor.js"),o("../node_modules/core-js/modules/es.regexp.exec.js"),o("../node_modules/core-js/modules/es.string.replace.js");var r=o("../spread-sheet/src/core/data/configService/spreadConfig.ts"),n=o("../node_modules/@tencent/docs-multi-tools/dist/index.js"),s=o("../node_modules/@tencent/docs-user-agent/dist/index.js"),a=o.n(s),i=o("../spread-sheet/src/core/utils/url.ts"),d=o("../node_modules/@tencent/tencent_doc_open_url/dist/index.js"),c=o("../node_modules/qs/lib/index.js"),u=o.n(c),l=o("../spread-sheet/src/core/feature/relateFormEnt/enterpriseStatus.ts"),f=o("../packages/common-utils/src/index.ts"),p=o("./node_modules/axios/index.js"),m=o.n(p),h=(o("../spread-sheet/src/base/util/domain-config.ts"),o("../spread-sheet/src/base/util/appConfig.ts")),g=function(e,t,o,r){return new(o||(o=Promise))((function(n,s){function a(e){try{d(r.next(e))}catch(t){s(t)}}function i(e){try{d(r.throw(e))}catch(t){s(t)}}function d(e){var t;e.done?n(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(a,i)}d((r=r.apply(e,t||[])).next())}))};function v(){var e,t,s=Number(new Date),c=s-18e5,l=null===(t=null===(e=o.g.log)||void 0===e?void 0:e.report)||void 0===t?void 0:t.call(e,"TUCAO_EXCEL",{query:{startTs:c,endTs:s}}),f=r.q.getConfig("userName"),p=r.q.getConfig("userPic"),m=r.q.getConfig("uid")||"";m?"p"===m.charAt(0)&&(m=m.replace(/p./,"")):m=r.q.getConfig("uin");var g=o.g.location.href;try{g=encodeURIComponent(JSON.stringify({type:"excel",url:o.g.location.href,uid:(0,n.getUid)(),rid:l}))}catch(v){console.warn(v)}!function(e){var t=h.Z.getConfig("links.feedback");if(r.q.getConfig("isLogin"))if(a().isMiniProgram&&!a().isPC){var n=u().stringify({openid:e.openid,nickname:e.nickname,avatar:e.avatar,customInfo:e.customInfo,clientInfo:e.clientInfo}),s=(0,i._)(t,n);o.g.location.href=s}else{var c=document.createElement("form");for(var l in c.id="form",c.name="form",c.style.display="none",a().isMiniProgram&&a().isPC?c.setAttribute("target","_self"):c.setAttribute("target","_blank"),document.body.appendChild(c),e)if(Object.hasOwnProperty.call(e,l)){var f=document.createElement("input");f.type="text",f.name=l,f.value=e[l],c.appendChild(f)}c.method="POST",c.action=t,c.submit(),document.body.removeChild(c)}else{var p=u().stringify({customInfo:encodeURIComponent(o.g.location.href),clientInfo:o.g.navigator.userAgent}),m=(0,i._)(t,p);(0,d.tencentDocOpenUrlForAll)({url:m})}}({openid:m,nickname:f,avatar:p,customInfo:g,clientInfo:o.g.navigator.userAgent})}function _(){var e,t,n,s,i;return g(this,void 0,void 0,regeneratorRuntime.mark((function c(){var u,p,h,g,v,_;return regeneratorRuntime.wrap((function(c){for(;;)switch(c.prev=c.next){case 0:return u=r.q.getConfig("padId"),p=(0,f.IZ)("scode"),(h=new FormData).append("docid",u),h.append("share_code",p),h.append("scence","wedoc"),h.append("svr_type","report"),c.prev=7,c.next=10,m().post("/doc/feedback_to_ww",h);case 10:if(g=c.sent,v=g.data,0===(null===(e=v.head)||void 0===e?void 0:e.ret)){c.next=14;break}throw new Error("request /doc/feedback_to_ww fail, params: docid:"+u+", share_code:"+p);case 14:if(_=null===v||void 0===v?void 0:v.body.return_url){c.next=18;break}throw null===(t=window.tdocs)||void 0===t||t.log({message:"[CGI FAILED]: no url provided, params: docid:"+u+", share_code:"+p,level:"error"}),new Error("request /doc/feedback_to_ww fail, no url provided");case 18:(0,l.n_)()?a().isMobile?null===(s=null===(n=o.g.tdocs)||void 0===n?void 0:n.openUrl)||void 0===s||s.call(n,{url:_,target:3}):null===(i=o.g.tdocs)||void 0===i||i.openInBrowser({url:_}):(0,d.tencentDocOpenUrlForAll)({url:_}),c.next=24;break;case 21:c.prev=21,c.t0=c.catch(7),console.error(c.t0);case 24:case"end":return c.stop()}}),c,null,[[7,21]])})))}},"../spread-sheet/src/external/offline-edit/clear-type.ts":function(e,t,o){var r;o.d(t,{N:function(){return r}}),function(e){e.ALL="all",e.COMMITTED="committed",e.UN_COMMITTED="unCommitted"}(r||(r={}))},"../spread-sheet/src/external/view/workbench/service/create-new-doc.ts":function(e,t,o){o.d(t,{$e:function(){return i},Jz:function(){return c}}),o("../node_modules/@tencent/tencent_doc_open_url/dist/index.js"),o("../packages/common-utils/src/index.ts"),o("../node_modules/@tencent/docs-user-agent/dist/index.js"),o("../node_modules/qs/lib/index.js");var r,n,s,a,i,d=o("../node_modules/i18next/dist/esm/i18next.js");o("../spread-sheet/src/base/util/appConfig.ts").Z.getConfig("runtime.domainName"),function(e){e[e.doc=0]="doc",e[e.sheet=1]="sheet",e[e.form=2]="form",e[e.slide=4]="slide",e[e.pdf=6]="pdf",e[e.mindMap=90]="mindMap",e[e.flowChart=91]="flowChart",e[e.unknown=10]="unknown"}(i||(i={}));var c=((r={})[i.doc]="doc",r[i.sheet]="sheet",r[i.slide]="slide",r[i.mindMap]="mindMap",r[i.flowChart]="flowChart",r);(n={})[i.doc]=d.ZP.t("无标题文档"),n[i.sheet]=d.ZP.t("无标题表格"),n[i.slide]=d.ZP.t("无标题幻灯片"),n[i.mindMap]=d.ZP.t("无标题思维导图"),n[i.flowChart]=d.ZP.t("无标题流程图"),(s={})[i.doc]=31227,s[i.sheet]=20001,s[i.slide]=29e3,(a={})[i.doc]=2,a[i.sheet]=1,a[i.slide]=2,a[i.mindMap]=1,a[i.flowChart]=1}}]),window.jsExecEndTimeStamp=Date.now(),window.cachedPerformanceEntries||(window.cachedPerformanceEntries=[]),window.cachedPerformanceEntries.push({name:"jsExec: js/spread-sheet_src_core_app_dataCallCore_ts-spread-sheet_src_external_view_workbench_service_cr-4ddb4c.74993da1aa22f8f90c33.js",entryType:"jsExec",startTime:window.jsExecStartTimeStamp,endTime:window.jsExecEndTimeStamp});
//# sourceMappingURL=spread-sheet_src_core_app_dataCallCore_ts-spread-sheet_src_external_view_workbench_service_cr-4ddb4c.74993da1aa22f8f90c33.js.map