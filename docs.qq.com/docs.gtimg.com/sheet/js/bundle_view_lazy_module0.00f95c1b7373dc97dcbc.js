self.window=self,window.jsExecStartTimeStamp=Date.now(),(self.webpackChunk_tencent_alloy_builder=self.webpackChunk_tencent_alloy_builder||[]).push([["bundle_view_lazy_module0"],{"../spread-sheet/src/core/feature/dataValidation/api/DataValidationCalc.ts":function(e,t,n){n.d(t,{O:function(){return u}}),n("../node_modules/core-js/modules/es.number.constructor.js");var r=n("../node_modules/@tencent/sheet-formula-sdk/lib/index.js"),i=n("../packages/model/src/cell/data-validation/data-validation-utils.ts"),a=n("../packages/model/src/range/hexRangeUtils.ts"),o=n("../spread-sheet/src/core/feature/dataValidation/custom-formula/convert.ts"),s=n("../spread-sheet/src/core/feature/dataValidation/api/DataValidationUtils.ts"),c=n("../packages/model/src/cell/index.ts"),l=n("../packages/model/src/utils/numberFormat/FormatParseEngine.ts"),u=function(e,t,u,d){var h=e.spreadsheet.activeSheet.getCellDataAtPosition(u,t);if(null==h)return null;var p=h.getEffectiveValue();if(null==d&&(d=null===p||void 0===p?void 0:p.value),""===d)return null;var f=h.getDataValidation();if(f&&null!=d){var v=function(e,t,u,d,h,p){var f,v,g,m,x=e.spreadsheet.activeSheet.getSheetId(),y=p||x,w={rowIndex:u,colIndex:d,options:e.spreadsheet.sheetManager};if(null===(f=null===t||void 0===t?void 0:t.argTokens)||void 0===f?void 0:f.length){var b=t.argTokens[0],C=(0,i.o5)(b,{rowIndex:u,colIndex:d,options:e.spreadsheet.sheetManager}),_=(0,a.getRangeInfoFormHexRange)(e.spreadsheet,C).sheetId||x;if(!(null===(v=e.spreadsheet.sheetManager.getSheetBySheetId(_))||void 0===v?void 0:v.isLoaded))return null===(g=n.g.log)||void 0===g||g.log("数据验证跨表数据未加载"),!1}var I=(0,o.f)(t,w);if(!I)return!0;var M=(0,s.KN)(h);t.ruleType===c.DATA_VALIDATION_RULE_TYPE.DATE&&"number"===typeof M&&(0,l.isPrecisionBiggerThan16)(""+M)&&(M=Number((0,l.handleLongNumber)(""+M,void 0,!0)));var S=(0,s.Np)(M)||r.Pz.toCellId(u,d),j=null===(m=e.spreadsheet.sheetManager.getSheetBySheetId(y))||void 0===m?void 0:m.getCellDataAtPosition(u,d),D=(0,s.Dq)(S,j,h),E=function(e,t){var n=e.sheetId,r=e.calculator;if(t){var i=t.calcController.getResultBySingleFormula(r,n).result;if(null!=i)return!0===i||"TRUE"===i}return null}({calculator:(0,s.ko)(I,"$SLOT",D),col:d,row:u,sheetId:y},e);return!0===E}(e,f,u,t,d)&&(0,s.uU)(d,f);if(null!=v)return{isDataValid:v,dataValidation:f,cell:r.Pz.toCellId(u,t)}}return null}},"../spread-sheet/src/core/feature/index.ts":function(e,t,n){n.d(t,{Z:function(){return I}}),n("../node_modules/core-js/modules/es.array.sort.js");var r=n("../spread-sheet/src/core/feature/copyPaste/lib/smartSplit/SmartSplit.ts"),i=n("../spread-sheet/src/core/feature/dataValidation/api/DataValidationUtils.ts"),a=n("../spread-sheet/src/core/feature/dataValidation/api/DataValidationCalc.ts"),o=(n("../node_modules/core-js/modules/web.dom-collections.for-each.js"),n("../node_modules/core-js/modules/es.array.iterator.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/web.dom-collections.iterator.js"),n("../packages/model/src/cell/CellFormat.ts")),s=n("../packages/model/src/cell/format/Color.ts");function c(e,t,n){var r=function(e,t){for(var n=[],r=t.startRowIndex;r<=t.endRowIndex;r++){for(var i=[],a=t.startColIndex;a<=t.endColIndex;a++){var o=e.data.rowData[r]?e.data.rowData[r].values[a]:null;i.push(o)}n.push(i)}return n}(e,t);if(r.length<=1)return!1;for(var i=!1,a=function(e,t,n){var r=n[0],i=[];t.forEach((function(t){i.push(t.column-e.startColIndex)}));for(var a=0;a<r.length;a++)i.length&&-1===i.indexOf(a)&&i.push(a);return i}(t,n,r),o=0;o<a.length;o++){var s=u(r,a[o]);if(l(s[0]))return!1;if(i=d(e,t,s))break}return i}function l(e){return!(e&&!e.isEmpty())||!(e.getHyperlink()||e.getFormula()||e.getEditValue())}function u(e,t){var n=[];return e.forEach((function(e){n.push(e[t])})),n}function d(e,t,n){return!!function(e,t){var n=e.getBasicFilter(),r=e.properties;return!!function(e,t){var n=-1;return e&&(n=e.range.startRowIndex),n>-1&&t===n}(n,t.startRowIndex)||!!function(e,t){var n=0,r=e.gridProperties;if(r&&(n=r.frozenRowCount),n>0&&t+1===n)return!0}(r,t.startRowIndex)}(e,t)||!!function(e,t){var n=!1;if(e.length>=3){if(l(e[0])||l(e[1]))return!1;var r=e[0],i=e[1];!function(e,t,n){for(var r=2;r<e.length&&!h(t,e[r],n);r++);}(e,i,t),h(r,i,t)&&(n=!0)}return n}(n,e.spreadsheetReference)||!!function(e){var t,n,r="00000";if(e.length>=3){if(l(e[0])||l(e[1]))return!1;var i=(null===(t=e[0])||void 0===t?void 0:t.effectiveValue)?y(e[0].effectiveValue):r,a=(null===(n=e[1])||void 0===n?void 0:n.effectiveValue)?y(e[1].effectiveValue):r,o=function(e,t){for(var n,r="00000",i=!1,a=2;a<e.length;a++){if(((null===(n=e[a])||void 0===n?void 0:n.effectiveValue)?y(e[a].effectiveValue):r)!==t&&!l(e[a])){i=!0;break}if(l(e[a]))break}return i}(e,a);return i!==a&&!o}return!1}(n)}function h(e,t,n){var r,i,a=!1;if(e&&t){var s=o.Z.createInstance(),c=null!==(r=e.getUserEnteredFormat())&&void 0!==r?r:s,l=null!==(i=t.getUserEnteredFormat())&&void 0!==i?i:s;c&&l&&(a=["bold","italic","fontSize","fontColor","backgroundColor","numberFormat"].some((function(e){return function(e,t,n,r){return{bold:p,italic:f,fontSize:v,fontColor:g,backgroundColor:m,numberFormat:x}[e](t,n,r)}(e,c,l,n)})))}return a}function p(e,t){var n=!1;return(e.getBold()||!1)!==(t.getBold()||!1)&&(n=!0),n}function f(e,t){var n=!1;return(e.getItalic()||!1)!==(t.getItalic()||!1)&&(n=!0),n}function v(e,t){var n=!1;return(e.getFontSize()||10)!==(t.getFontSize()||10)&&(n=!0),n}function g(e,t,n){var r=!1,i=e.getColor()||s.Z.createColor("#000000"),a=t.getColor()||s.Z.createColor("#000000");return i&&a?s.Z.getColorHexCode(i,n)!==s.Z.getColorHexCode(a,n)&&(r=!0):(i||a)&&(r=!0),r}function m(e,t,n){var r=!1,i=e.getBackgroundColor()||s.Z.createColor("#FFFFFF"),a=t.getBackgroundColor()||s.Z.createColor("#FFFFFF");return i&&a?s.Z.getColorHexCode(i,n)!==s.Z.getColorHexCode(a,n)&&(r=!0):(i||a)&&(r=!0),r}function x(e,t){var n=!1,r=e.getNumberFormat(),i=t.getNumberFormat();return r&&i?r.equals(i)||(n=!0):(r&&0!==r.id||i&&0!==i.id)&&(n=!0),n}function y(e){var t="0001",n="";if(e&&3!==e.type){var r=String(e.value);n+=/[a-zA-Z\u4e00-\u9fa5]+/.test(r)?"1":"0",n+=/^-?(\d|([1-9]\d+))(\.\d+)?$/.test(r)?"1":"0",n+=/[!@#$%\\^&*)(+={}[\]/",<>~`?:;|]/.test(r)?"1":"0",/^#N\/A$|^#DIV\/0!$|#VALUE!$|^#REF!$|^#ERROR$|^#NUM!$|^#NAME\?$|^#NULL!$|^#PARAMS_LACK$/.test(r)?n=t:n+="1"}else e&&3===e.type&&(n=t);return n}var w,b=n("../spread-sheet/src/core/feature/sort/Sort.ts"),C=n("../spread-sheet/src/core/feature/dataValidation/DVInterface.ts"),_=n("../spread-sheet/src/core/feature/dataValidation/api/DataValidationError.ts");!function(e){!function(e){e.needCheckSmartSplit=r.IK,e.doSmartSplitMobile=r.jq}(e.smartSplit||(e.smartSplit={})),function(e){e.getUIDVAtPosition=i.Sc,e.getDropDownValues=i.ZK,e.viewCheckDataValid=a.O,e.compareMaxMinError=i.JU,e.isActiveCellContainDV=i.v1,e.VALID_TYPE=C.ob,e.DATA_TYPE=C.h6,e.DATE_OPERATE_MAP=C.y3,e.TEXT_OPERATE_MAP=C.Bb,e.NUMBER_OPERATE_MAP=C.UD,e.NUMBER_DATA_TYPE_MAP=C.Ju,e.error=_}(e.dataValidation||(e.dataValidation={})),function(e){e.checkSortTitle=c,e.checkExtendRange=b.Df,e.hasPositiveRef=b.Hq}(e.sort||(e.sort={}))}(w||(w={}));var I=w},"../spread-sheet/src/core/feature/sort/Sort.ts":function(e,t,n){n.d(t,{Df:function(){return s},Hq:function(){return o}});var r,i=n("../spread-sheet/src/core/behavior/index.ts");!function(e){e.EXTEND="extend",e.NOT_EXTEND="not-extend"}(r||(r={}));var a=function(e,t,n){var r=e.spreadsheet.activeSheet.getCellDataAtPosition(t,n),i=null===r||void 0===r?void 0:r.getFormula();return!!i&&i.hasRelativeReference()},o=function(e,t){for(var n=t,r=n.startRowIndex;r<=n.endRowIndex;r++)for(var i=n.startColIndex;i<=n.endColIndex;i++)if(a(e,r,i))return!0;return!1};function s(e,t){var n,r=t,a=function(e,t){return i.Z.Utils.searchCloseDataArea(e.spreadsheet.activeSheet,t)}(e,r),o=!a.equal(t),s=(n=r,!(0!==Math.abs(n.startColIndex-n.endColIndex)||0!==Math.abs(n.startRowIndex-n.endRowIndex))),c=function(e){return 0===Math.abs(e.startColIndex-e.endColIndex)||0===Math.abs(e.startRowIndex-e.endRowIndex)}(r);return{extRange:a,oriRange:r,canExtend:o,isOneCell:s,singleColOrRow:c}}},"../spread-sheet/src/core/view/level-1/orientation-operate/utils.ts":function(e,t,n){function r(e){return void 0===e&&(e=screen.orientation?screen.orientation.angle:Number(window.orientation)),!(90!==e&&-90!==e)}n.d(t,{m:function(){return r}}),n("../node_modules/core-js/modules/es.number.constructor.js")},"../spread-sheet/src/core/view/level-2/CanvasTooltip/index.tsx":function(e,t,n){n.d(t,{H:function(){return d}}),n("../node_modules/core-js/modules/es.array.find.js"),n("../node_modules/core-js/modules/es.object.assign.js");var r=n("react"),i=n("react-dom"),a=n.n(i),o=n("../node_modules/@tencent/dui/lib/components/Tooltip/index.js"),s=document.getElementById("canvasContainer"),c=document.createElement("div");null===s||void 0===s||s.appendChild(c);var l=null,u=[];function d(e,t){s&&(0===u.length&&requestAnimationFrame(h),u.push({iconArea:e,props:t}))}function h(){if(0!==u.length){var e=u.find((function(e){return e.props.visible}));u=[],e?p(e.iconArea,e.props):f()}}function p(e,t){var n=e.x,i=e.y,s=e.width,u=e.height;a().render(r.createElement(o.default,Object.assign({},t,{style:Object.assign({position:"absolute",left:n+"px",top:i+"px",pointerEvents:"none"},t.style),zIndex:1}),r.createElement("div",{style:{width:s+"px",height:u+"px"}})),c),l={iconArea:e,props:t}}function f(){if(l){var e=l,t=e.iconArea,n=e.props;p(t,Object.assign(Object.assign({},n),{visible:!1}))}}null===s||void 0===s||s.addEventListener("mouseleave",f),p({x:0,y:0,width:0,height:0},{visible:!1})},"../spread-sheet/src/core/view/level-2/cell-editors/CellEditorManager.tsx":function(e,t,n){n.r(t),n.d(t,{default:function(){return he}}),n("../node_modules/core-js/modules/es.array.iterator.js"),n("../node_modules/core-js/modules/es.map.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.string.iterator.js"),n("../node_modules/core-js/modules/esnext.map.delete-all.js"),n("../node_modules/core-js/modules/esnext.map.every.js"),n("../node_modules/core-js/modules/esnext.map.filter.js"),n("../node_modules/core-js/modules/esnext.map.find.js"),n("../node_modules/core-js/modules/esnext.map.find-key.js"),n("../node_modules/core-js/modules/esnext.map.includes.js"),n("../node_modules/core-js/modules/esnext.map.key-of.js"),n("../node_modules/core-js/modules/esnext.map.map-keys.js"),n("../node_modules/core-js/modules/esnext.map.map-values.js"),n("../node_modules/core-js/modules/esnext.map.merge.js"),n("../node_modules/core-js/modules/esnext.map.reduce.js"),n("../node_modules/core-js/modules/esnext.map.some.js"),n("../node_modules/core-js/modules/esnext.map.update.js"),n("../node_modules/core-js/modules/web.dom-collections.iterator.js"),n("../node_modules/core-js/modules/es.object.assign.js"),n("../node_modules/core-js/modules/es.array.includes.js"),n("../node_modules/core-js/modules/es.string.includes.js"),n("../node_modules/core-js/modules/web.dom-collections.for-each.js");var r=n("react-dom"),i=n.n(r),a=n("../node_modules/@babel/runtime/helpers/esm/toConsumableArray.js"),o=n("../node_modules/@babel/runtime/helpers/esm/inheritsLoose.js"),s=(n("../node_modules/core-js/modules/es.symbol.js"),n("../node_modules/core-js/modules/es.array.map.js"),n("../node_modules/core-js/modules/es.array.filter.js"),n("../node_modules/core-js/modules/es.array.find-index.js"),n("../node_modules/core-js/modules/es.array.concat.js"),n("../node_modules/i18next/dist/esm/i18next.js")),c=n("react"),l=n.n(c),u=n("../node_modules/@tencent/dui/lib/components/Select/index.js"),d=n("../node_modules/@tencent/docs-user-agent/dist/index.js"),h=n.n(d),p=n("../spread-sheet/src/base/event/event.ts"),f=n("../spread-sheet/src/base/event/eventName.ts"),v=function(){function e(e,t,n){var r=this;this.context=e,this.app=t,this.mutexManagement=n,this.supportMobilePhone=!1,this.isMobileCellPanelActionSheetShowing=function(){return!(!h().isMobilePhone&&!h().isAndroidPad)&&r.app.view.canvas.mobileCellPanelManager.isMobileCellPanelActionSheetShowing()}}var t=e.prototype;return t.hide=function(){this.context.hide()},t.show=function(){throw new Error("Method not implemented.")},t.updateOptions=function(e){this.options=e},t.shouldShowTransparentContainer=function(){return!1},t.shouldShowTransparentContainerBackground=function(){return!1},t.shouldDisableContainerPointerEvent=function(){return!1},t.restoreToDefaultValue=function(){},e}(),g=function(){return p.ZP.default.trigger(f.W1.UI_SHOW,f.Xs.CELL_EDITOR_M)},m=function(){return p.ZP.default.trigger(f.W1.UI_HIDE,f.Xs.CELL_EDITOR_M)},x=n("../packages/model/src/cell/metadata/CustomDataType.ts"),y=n("../node_modules/classnames/index.js"),w=n.n(y),b=n("../spread-sheet/src/core/view/spreadsheet-view/model/measurer/web/Measurer.ts"),C=n("../spread-sheet/src/core/view/spreadsheet-view/model/line/segment/TagSegment.ts"),_=n("../spread-sheet/src/core/view/level-2/cell-editors/editors/util.ts"),I=n("../spread-sheet/src/core/view/spreadsheet-view/transform-table/cell.ts"),M=n("../spread-sheet/src/core/view/lib/mutex-management/MutexManagement.ts");n("../node_modules/core-js/modules/es.array.from.js"),n("../node_modules/core-js/modules/es.set.js"),n("../node_modules/core-js/modules/esnext.set.add-all.js"),n("../node_modules/core-js/modules/esnext.set.delete-all.js"),n("../node_modules/core-js/modules/esnext.set.difference.js"),n("../node_modules/core-js/modules/esnext.set.every.js"),n("../node_modules/core-js/modules/esnext.set.filter.js"),n("../node_modules/core-js/modules/esnext.set.find.js"),n("../node_modules/core-js/modules/esnext.set.intersection.js"),n("../node_modules/core-js/modules/esnext.set.is-disjoint-from.js"),n("../node_modules/core-js/modules/esnext.set.is-subset-of.js"),n("../node_modules/core-js/modules/esnext.set.is-superset-of.js"),n("../node_modules/core-js/modules/esnext.set.join.js"),n("../node_modules/core-js/modules/esnext.set.map.js"),n("../node_modules/core-js/modules/esnext.set.reduce.js"),n("../node_modules/core-js/modules/esnext.set.some.js"),n("../node_modules/core-js/modules/esnext.set.symmetric-difference.js"),n("../node_modules/core-js/modules/esnext.set.union.js");var S,j,D,E=function(e,t,n){var r=[],i=[];return t.forEach((function(t){var a=t[n];if(e!==a){var o=a.indexOf(e);0===o&&r.push(t),o>0&&i.push(t)}else r.unshift(t)})),Array.from(new Set([].concat(r,i)))},T=n("../packages/model/src/cell/format/Color.ts"),N=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n};!function(e){e[e.ALL_MATCH=3]="ALL_MATCH",e[e.FIRST_MATCH=2]="FIRST_MATCH",e[e.OTHER_MATCH=1]="OTHER_MATCH"}(D||(D={}));var P,R=function(e){function t(){var t;return(t=e.apply(this,arguments)||this).state={activeTagId:"",visible:!1,chooseId:"",searchData:t.props.options},t.renderOption=function(){var e=t.props,n=e.options,r=void 0===n?[]:n,i=e.withColor,a=e.spreadsheet,o=w()("select-cell-editor-item",{"select-cell-editor-item-colored":i});return r.map((function(e){var n=e.id,r=e.text,s=e.textColor,c=e.bgColor;return l().createElement(u.default.Option,{className:t.getSelectOptionClassName(n),key:n,value:n,label:r},l().createElement("span",{className:o,style:i&&s&&c?{color:T.Z.getColorHexCode(s,a),backgroundColor:T.Z.getColorHexCode(c,a),border:"#ffffff"===T.Z.getColorHexCode(c,a)?"1px solid rgba(0, 0, 0, 0.08)":void 0}:void 0},r))}))},t.setKeyword=function(e){j="";var n=[],r=t.props.options,i=void 0===r?[]:r;n=e.length?E(e,i,"text"):t.props.options,t.setState({searchData:n,chooseId:""},(function(){t.handleScrollToView(n,[],!0)}))},t.renderEmptyContent=function(){return l().createElement("div",{className:"empty-wrap"},l().createElement("div",{className:"empty-wording"},s.ZP.t("无相关选项")))},t.renderMobileSelect=function(e,n,r){var i=t.props.showMobileSelectPanel;return l().createElement("div",{className:"select-cell-editor",style:e,onTouchEnd:i},l().createElement("div",{className:r,style:n}))},t.filterOptionMeature=function(e,t){var n=t.label,r=n.indexOf(e),i=!1;return e===n?i=D.ALL_MATCH:0===r?i=D.FIRST_MATCH:r>0&&(i=D.OTHER_MATCH),i},t.renderTag=function(e){var n,r,i=t.props,a=i.withColor,o=i.cellData;if(!a)return null;var s=(0,I.qe)(o,t.props.spreadsheet),c=C.Gy.PADDING_Y,u=C.Gy.MARGIN,d=b.Z.measureHeight(s)+2*c+1,h=e.children,p=e.value,f=h,v=f.props,g=p&&p===t.state.activeTagId,m="#ffffff"===(null===(n=v.style)||void 0===n?void 0:n.backgroundColor)?"rgba(0, 0, 0, 0.08)":"transparent",x=g?null===(r=v.style)||void 0===r?void 0:r.color:m,y={textDecoration:w()({"line-through":s.strikethrough,underline:s.underline}),font:s.font,height:d+"px",margin:u+"px",borderColor:x},_=w()("select-cell-text-tag",{"select-cell-text-tag-active":g});return l().cloneElement(f,{className:v.className+" "+_,style:Object.assign(Object.assign({},v.style),y),onClick:function(e){return t.handleClickTagItem(e,p)},key:e.value})},t.deleteActiveItem=function(){var e,n=t.state.activeTagId,r="alloy-rich-text-editor"===(null===(e=document.activeElement)||void 0===e?void 0:e.id);if(n&&r){var i=t.props,a=i.values;(0,i.onChange)(a.filter((function(e){return e!==n}))),t.setState({activeTagId:""})}},t.handleClickTagItem=function(e,n){e.stopPropagation();var r=t.state.activeTagId;t.setState({activeTagId:r===n?"":n})},t.handleKeydown=function(e){if(" "===e.key&&t.canChangeVisible(e))t.handleSpace();else{var n=t.state,r=n.activeTagId;if(n.visible&&"Escape"===e.key)t.setState({visible:!1});else{if(["Backspace","Delete"].includes(e.key)){if(!r)return;t.deleteActiveItem(),e.stopImmediatePropagation()}t.handleWithJump(e.key)}}},t.handleWithJump=function(e){var n=t.state,r=n.visible,i=n.chooseId,a=n.searchData,o=i;!i&&j&&(o=j),["ArrowDown","ArrowUp"].includes(e)&&r&&(t.jumpToChoose(e,o),t.handleScrollToView(a,[t.state.chooseId],!1))},t.handleSpace=function(){t.setState((function(e){return{visible:!e.visible}})),S=setTimeout((function(){t.state.visible&&t.handleOpenWithSearch()}),100)},t.handleSearchOperate=function(e){var n=t.state.chooseId;"Enter"===e.key&&(e.stopImmediatePropagation(),n&&t.saveWithEnter(n))},t.jumpToChoose=function(e,n){var r=t.state.searchData;if(0!==r.length){var i=r.findIndex((function(e){return e.id===n}));if("ArrowDown"===e){for(i+=1;i>=r.length;)i-=r.length;t.setState({chooseId:r[i].id})}else"ArrowUp"===e&&((i-=1)<0&&(i+=r.length),t.setState({chooseId:r[i].id}))}},t.saveWithEnter=function(e){var n=t.props,r=n.onChange,i=n.values,o=n.isMultiSelect;r(i.includes(e)?i.filter((function(t){return t!==e})):o?[].concat((0,a.Z)(i),[e]):[e]),t.setState({chooseId:"",visible:Boolean(o)})},t.handleVisibleChange=function(e){var n=document.querySelector(".select-cell-list");e?null===n||void 0===n||n.addEventListener("keydown",t.handleSearchOperate):null===n||void 0===n||n.removeEventListener("keydown",t.handleSearchOperate),t.setState({visible:e,chooseId:""}),e&&t.props.mutexManagement.mutexShow(M.d.CELL_EDITOR_DROPDOWN),S=setTimeout((function(){t.handleOpenWithSearch()}),100)},t.handleOpenWithSearch=function(){var e=t.props,n=e.options,r=e.values;t.handleScrollToView(n,r),t.setState({chooseId:""})},t.handleScrollToView=function(e,t,n){void 0===n&&(n=!1);var r,i=document.querySelector(".select-cell-list");r=e.findIndex((function(e){return t.includes(e.id)})),i&&r>=0&&(j=e[r].id,n?i.scrollTop=0:setTimeout((function(){var e;return null===(e=i.children[r])||void 0===e?void 0:e.scrollIntoView()}),0))},t}(0,o.Z)(t,e);var n=t.prototype;return n.componentDidMount=function(){var e=this.props,t=e.mutexManagement,n=e.containerDom;t.addMutexComponent(M.d.CELL_EDITOR_DROPDOWN,this),document.addEventListener("keydown",this.handleKeydown,!0),(0,_.St)(n)},n.componentWillUnmount=function(){this.props.mutexManagement.removeMutexComponent(M.d.CELL_EDITOR_DROPDOWN,this),document.removeEventListener("keydown",this.handleKeydown,!0),(0,_.NM)(),clearTimeout(S)},n.mutexHide=function(){this.setState({visible:!1})},n.render=function(){var e=this.props,t=e.cellWidth,n=e.cellHeight,r=e.values,i=e.isMultiSelect,a=e.onChange,o=e.cellData,c=e.options,d=void 0===c?[]:c,p=this.state.visible,f=(0,_.qz)(o),v=f.alignItems,g=f.justifyContent,m=N(f,["alignItems","justifyContent"]),x={width:t,height:n,alignItems:v},y="select-cell-arrow",b=Object.assign(Object.assign({},m),{backgroundColor:(0,I.z1)(o,this.props.spreadsheet).hex});if(h().isMobilePhone)return this.renderMobileSelect(x,b,y);var C=w()("select-cell-editor",{"select-cell-editor-mobile":!h().isPC});return l().createElement(u.default,{onChange:a,style:x,placement:"auto",value:i?r:r[0]||"",className:C,isMultiple:i,dropdownMatchSelectWidth:!1,textContainerClassName:"select-cell-text-container",textContainerStyle:{justifyContent:g},arrowClassName:y,arrowStyle:b,listClassName:"select-cell-list",placeholder:"",renderTag:this.renderTag,visible:p,onVisibleChange:this.handleVisibleChange,showSearch:d.length>10,searchPlacement:"dropdown",searchPlaceholer:s.ZP.t("搜索选项"),renderEmptyContent:this.renderEmptyContent,onSearch:this.setKeyword,filterOption:this.filterOptionMeature},l().createElement("div",{className:"select-cell-tip"},i?s.ZP.t("多选"):s.ZP.t("单选")),this.renderOption())},n.getSelectOptionClassName=function(e){var t=this.state.chooseId===e;return w()("select-cell-editor-option",{"select-cell-editor-option-choose":t})},n.canChangeVisible=function(e){var t,n,r,i="alloy-rich-text-editor"===(null===(t=e.target)||void 0===t?void 0:t.id),a=null===(n=e.target)||void 0===n?void 0:n.classList.contains("dui-dropdown-content-visible"),o=null===(r=e.target)||void 0===r?void 0:r.querySelector(".select-cell-text-container");return i||a||o},t}(l().Component),k=function(e){function t(){var t;return(t=e.apply(this,arguments)||this).type=x.ZP.SELECT,t.supportMobilePhone=!0,t.save=function(e){var n=t.options,r=n.row,i=n.col,a=e;"string"===typeof e&&(a=[e]),(0,_.Ks)(t.app,a,r,i),t.context.updateEditor({row:r,col:i}),(0,_.Cv)("choice")},t}(0,o.Z)(t,e);var n=t.prototype;return n.show=function(){var e=this.options,t=e.cellWidth,n=e.cellHeight,r=e.config,a=e.cellData,o=e.isPrivate?[]:(null===a||void 0===a?void 0:a.getRefIds())||[],s=this.context.getContainer();i().render(l().createElement(R,Object.assign({cellHeight:n,cellWidth:t,onChange:this.save,values:o,cellData:a,mutexManagement:this.mutexManagement,containerDom:s,showMobileSelectPanel:this.context.showMobileSelectPanel,spreadsheet:this.app.spreadsheet},r)),s)},n.shouldShowTransparentContainerBackground=function(){var e;return!(null===(e=this.options.config)||void 0===e?void 0:e.withColor)||h().isMobilePhone},n.restoreToDefaultValue=function(){this.save([])},t}(v),A=n("../node_modules/@tencent/dui/lib/components/Checkbox/index.js"),Z={width:x.K+x.Kw+16+"px",height:x.K+x.Kw+16+"px",margin:"-8px"},L=function(e){function t(){var t;return(t=e.apply(this,arguments)||this).handleClick=function(){var e=t.props,n=e.checked;(0,e.onChange)(!n)},t}return(0,o.Z)(t,e),t.prototype.render=function(){var e,t=this.props,n=t.cellHeight,r=t.cellWidth,i=t.checked,a=t.cellData,o=(0,_.qz)(a),s={width:r,height:n,justifyContent:o.justifyContent,alignItems:o.alignItems},c=w()("checkbox-cell-editor",{"checkbox-cell-editor-mobile":!h().isPC});return l().createElement("div",{style:s,className:c},l().createElement(A.default,Object.assign({className:"checkbox-cell-editor-checkbox",style:Z,checked:i,iconClassName:"checkbox-centered-icon"},((e={})[h().isPC?"onClick":"onTouchEnd"]=this.handleClick,e))))},t}(l().Component),O=function(e){function t(){var t;return(t=e.apply(this,arguments)||this).type=x.ZP.CHECKBOX,t.supportMobilePhone=!0,t.save=function(e){if(!t.context.isMobileContextMenuShowing()){var n=t.options,r=n.row,i=n.col;t.context.save({value:e?x.Nf:x.$$,row:r,col:i}),t.context.updateEditor({row:r,col:i}),(0,_.Cv)("checkbox")}},t}(0,o.Z)(t,e);var n=t.prototype;return n.show=function(){var e=this.options,t=e.cellWidth,n=e.cellHeight,r=e.cellData,a=e.isPrivate,o=null===r||void 0===r?void 0:r.getEffectiveValue(),s=!a&&(null===o||void 0===o?void 0:o.value)===x.Nf;i().render(l().createElement(L,{cellWidth:t,cellHeight:n,checked:s,onChange:this.save,cellData:r}),this.context.getContainer())},n.restoreToDefaultValue=function(){this.save(!1)},t}(v),H=n("../node_modules/lodash/throttle.js"),V=n.n(H),z=n("../node_modules/@babel/runtime/helpers/esm/createClass.js"),B=(n("../node_modules/core-js/modules/es.string.repeat.js"),n("../spread-sheet/src/core/view/level-2/cell-editors/editors/impl/star-cell-editor/StarList.tsx")),W=n("../node_modules/@tencent/dui-mobile/lib/components/PullPanel/index.js"),Y=function(e){function t(){var t;return(t=e.apply(this,arguments)||this).state={panelVisible:Boolean(t.props.initPanelVisible)},t.showPanel=function(){if(h().isMobilePhone||h().isAndroidPad){var e=t.props,n=e.isMobileCellPanelActionSheetShowing,r=e.isMobileContextMenuShowing;n()||r()||t.setState({panelVisible:!0},g)}},t.hidePanel=function(){h().isMobilePhone&&t.setState({panelVisible:!1},m)},t.handleChange=function(e){t.props.isMobileContextMenuShowing()||(t.props.onChange(e),setTimeout((function(){t.hidePanel()}),500))},t}(0,o.Z)(t,e);var n=t.prototype;return n.render=function(){var e=this.props,t=e.cellHeight,n=e.cellWidth,r=e.cellData,i=this.state.panelVisible,a=(0,_.qz)(r),o={width:n,height:t,justifyContent:a.justifyContent,alignItems:a.alignItems,padding:x.L6-x.NO+"px"},c=w()("star-cell-editor",{"star-cell-editor-mobile":!h().isPC});return l().createElement(l().Fragment,null,l().createElement("div",{style:o,className:c,onTouchEnd:this.showPanel},!h().isMobilePhone&&this.renderStarList()),h().isMobilePhone&&l().createElement(W.default,{visible:i,okText:"",onOk:this.hidePanel,zIndex:9999,showHeaderBorder:!1,header:l().createElement("div",{className:"panel-star-title"},this.value.lastIndexOf(x.KH)+1,s.ZP.t("星"))},l().createElement("div",{className:"panel-star-list-container"},this.renderStarList(!0))))},n.renderStarList=function(e){return void 0===e&&(e=!1),l().createElement(B.Z,{value:this.value,onChange:this.handleChange,itemClassName:(e?"panel":"editor")+"-star-item"})},(0,z.Z)(t,[{key:"value",get:function(){var e=this.props,t=e.cellData;return e.isPrivate?x.E.repeat(x.XZ):(0,_.rs)(t)}}]),t}(l().Component),G=function(e){function t(){var t;return(t=e.apply(this,arguments)||this).type=x.ZP.STAR,t.supportMobilePhone=!0,t.save=function(e){var n=t.options,r=n.row,i=n.col;(0,_.Y3)(t.app,e,r,i),t.context.updateEditor({row:r,col:i}),(0,_.Cv)("star")},t}(0,o.Z)(t,e);var n=t.prototype;return n.shouldShowTransparentContainer=function(){return h().isMobile},n.show=function(){var e=this.options,t=e.cellWidth,n=e.cellHeight,r=e.cellData,a=e.initPanelVisible,o=e.isPrivate;i().render(l().createElement(Y,{isMobileCellPanelActionSheetShowing:this.isMobileCellPanelActionSheetShowing,cellWidth:t,cellHeight:n,onChange:this.save,cellData:r,isMobileContextMenuShowing:this.context.isMobileContextMenuShowing,isPrivate:o,initPanelVisible:a}),this.context.getContainer())},n.restoreToDefaultValue=function(){this.save(0)},t}(v),U=n("../packages/model/src/range/index.ts"),Q=n("../spread-sheet/src/external/rangeAuth/util/range-auth-error-util.ts"),F=(n("../node_modules/core-js/modules/es.number.constructor.js"),n("../node_modules/@tencent/dui-mobile/lib/components/Slider/index.js")),J=n("../spread-sheet/src/core/view/spreadsheet-view/render-manager/alloy-excel/table/body/cell-renders/util.ts"),X=((P={})[x.ZP.TEXT]=s.ZP.t("输入文本"),P[x.ZP.NUMBER]=s.ZP.t("输入数字"),P[x.ZP.ID]=s.ZP.t("输入身份证"),P[x.ZP.PHONE_NUM]=s.ZP.t("输入手机号"),P[x.ZP.TELEPHONE_NUM]=s.ZP.t("输入电话号"),P[x.ZP.EMAIL]=s.ZP.t("输入邮箱"),P[x.ZP.TEMPERATURE]="0℃",P),K=function(e){var t=e.children,n=e.cellData,r=e.spreadsheet,i={font:(0,I.qe)(n,r).font};return l().createElement("div",{className:"cell-placeholder-text",style:i},t)},q=function(e){function t(){var t;return(t=e.apply(this,arguments)||this).type=[x.ZP.TEXT,x.ZP.NUMBER,x.ZP.ID,x.ZP.PHONE_NUM,x.ZP.TELEPHONE_NUM,x.ZP.EMAIL,x.ZP.TEMPERATURE],t.supportMobilePhone=!0,t}(0,o.Z)(t,e);var n=t.prototype;return n.shouldShowTransparentContainer=function(){var e;return Boolean(null===(e=this.options.cellData.getEffectiveValue())||void 0===e?void 0:e.value)||this.context.getInputManager().isInputtingState()},n.shouldDisableContainerPointerEvent=function(){return!0},n.show=function(){var e=this.options,t=e.cellWidth,n=e.cellHeight,r=e.cellData,a=r.getMetadata().customDataType,o=(0,_.qz)(r),s={width:t,height:n,justifyContent:o.justifyContent,alignItems:o.alignItems};i().render(l().createElement("div",{className:"placeholder-cell-editor",style:s},l().createElement(K,{spreadsheet:this.app.spreadsheet,cellData:r},X[a])),this.context.getContainer())},t}(v),$=function(e){function t(){var t;return(t=e.apply(this,arguments)||this).state={panelVisible:Boolean(t.props.initPanelVisible),percentage:t.props.initPercentage,isFromQuickFill:Boolean(t.props.initPanelVisible)},t.inputRef=l().createRef(),t.enablePanel=h().isMobilePhone||h().isAndroidPad,t.showPanel=function(){if(t.enablePanel){var e=t.props,n=e.isMobileCellPanelActionSheetShowing,r=e.isMobileContextMenuShowing;n()||r()||t.setState({panelVisible:!0},g)}},t.hidePanel=function(){t.state.panelVisible&&(t.setState({panelVisible:!1},m),setTimeout((function(){t.state.isFromQuickFill&&t.setState({isFromQuickFill:!1})}),300))},t.handleSliderChange=function(e){t.setState({percentage:e}),t.inputRef.current.value=String(e)},t.handleInputChange=function(e){var n=e.target.value,r=Number(n),i=!isNaN(r)&&r<=100&&r>=0;t.saveValue(i?r:n),i&&t.setState({percentage:r})},t.saveValue=function(e){t.props.onChange(e),(0,_.Cv)("progress",t.state.isFromQuickFill)},t}(0,o.Z)(t,e);var n=t.prototype;return n.componentDidUpdate=function(e,t){!t.panelVisible&&this.state.panelVisible&&this.handleSliderChange(this.props.initPercentage)},n.render=function(){var e=this.props,t=e.cellHeight,n=e.cellWidth,r=e.cellData,i=e.disablePointerEvent,a=e.spreadsheet,o=this.state,s=o.panelVisible,c=o.percentage,u=o.isFromQuickFill,d=(0,_.qz)(r),p={width:n,height:t,justifyContent:d.justifyContent,alignItems:d.alignItems},f=w()("progress-cell-editor",{"progress-cell-editor-mobile":!h().isPC,"progress-cell-editor-disable":i});return l().createElement(l().Fragment,null,l().createElement("div",{style:p,className:f,onTouchEnd:this.showPanel},l().createElement(K,{spreadsheet:a,cellData:r},"0%")),(this.enablePanel||u)&&l().createElement(W.default,{visible:s,okText:"",onOk:this.hidePanel,zIndex:2e4,showHeaderBorder:!1,enableKeyboardDetection:h().isAndroid&&h().isTencentDocsApp,headerClassName:"progress-panel-header",header:l().createElement("div",{className:"progress-input-container"},l().createElement("input",{ref:this.inputRef,className:"progress-input",onBlur:this.handleInputChange,inputMode:"decimal",defaultValue:c}))},l().createElement("div",{className:"progress-slider-container"},l().createElement(F.default,{min:0,max:100,step:1,className:"progress-slider",barClassName:"progress-slider-bar",fillClassName:"progress-slider-fill",dragClassName:"progress-slider-drag",value:c>>0,onChange:this.handleSliderChange,onChangeEnd:this.saveValue}))))},t}(l().Component),ee=function(e){function t(){var t;return(t=e.apply(this,arguments)||this).type=x.ZP.PROGRESS,t.supportMobilePhone=!0,t.save=function(e){var n=t.options,r=n.row,i=n.col;t.context.save({row:r,col:i,value:e}),t.context.updateEditor({row:r,col:i})},t}(0,o.Z)(t,e);var n=t.prototype;return n.shouldShowTransparentContainer=function(){var e,t=null===(e=this.options.cellData.getEffectiveValue())||void 0===e?void 0:e.value;return!!t||"boolean"===typeof t||0===t||this.shouldDisableContainerPointerEvent()},n.shouldDisableContainerPointerEvent=function(){return this.context.getInputManager().isInputtingState()},n.show=function(){var e=this.options,t=e.cellWidth,n=e.cellHeight,r=e.cellData,a=e.initPanelVisible,o=e.isPrivate?0:(0,J.G)(r.getEditValue()||"")||0;i().render(l().createElement($,{spreadsheet:this.app.spreadsheet,cellWidth:t,cellHeight:n,cellData:r,isMobileContextMenuShowing:this.context.isMobileContextMenuShowing,isMobileCellPanelActionSheetShowing:this.isMobileCellPanelActionSheetShowing,initPercentage:o,initPanelVisible:a,onChange:this.save,disablePointerEvent:this.shouldDisableContainerPointerEvent()}),this.context.getContainer())},t}(v),te=n("../node_modules/@babel/runtime/helpers/esm/assertThisInitialized.js"),ne=(n("../node_modules/regenerator-runtime/runtime.js"),n("../node_modules/core-js/modules/es.promise.js"),n("../node_modules/core-js/modules/es.regexp.exec.js"),n("../node_modules/core-js/modules/es.string.split.js"),n("../node_modules/@tencent/form-ui-components/lib/components/calendar/index.js")),re=(n("../node_modules/dayjs/locale/zh-cn.js"),n("../node_modules/dayjs/dayjs.min.js")),ie=n.n(re),ae=n("../node_modules/@tencent/dui/lib/components/Dropdown/index.js"),oe=n("../node_modules/@tencent/dui/lib/components/TimePicker/index.js"),se=n("../packages/model/src/cell/metadata/date-time/DateTimeTemplateType.ts"),ce=(n("../node_modules/@tencent/dui-mobile/lib/components/DateTimePicker/index.js"),function(e,t,n,r){return new(n||(n=Promise))((function(i,a){function o(e){try{c(r.next(e))}catch(t){a(t)}}function s(e){try{c(r.throw(e))}catch(t){a(t)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,s)}c((r=r.apply(e,t||[])).next())}))});ie().locale("zh-cn");var le=function(e){function t(){var t;return(t=e.apply(this,arguments)||this).state={currentDateTime:t.getInitDayjsValue(),mobilePanelVisible:Boolean(t.props.initPanelVisible),userSelected:!1,pcDropdownVisible:!1,isFromQuickFill:Boolean(t.props.initPanelVisible)},t.showPanel=function(){var e=t.props.isMobileContextMenuShowing;h().isMobilePhone&&!e()&&t.setState({mobilePanelVisible:!0},g)},t.savePanel=function(){t.setState({userSelected:!0}),t.saveCurrentDateTime(),t.hidePanel()},t.hidePanel=function(){t.state.mobilePanelVisible&&(t.setState({mobilePanelVisible:!1},m),setTimeout((function(){t.state.isFromQuickFill&&t.setState({isFromQuickFill:!1})}),300))},t.hideIfClickDate=function(e){var n=t.props.templateType,r=e.target,i=document.querySelector(".rc-calendar-tbody"),a=document.querySelector(".rc-calendar-footer-btn span"),o=document.querySelector(".rc-calendar-month-panel-tbody"),s=document.querySelector(".rc-calendar-month-panel-selected-cell"),c=document.querySelector(".rc-calendar-selected-day"),l=n===se.KS.YEAR_MONTH&&(null===o||void 0===o?void 0:o.contains(r));(null===i||void 0===i?void 0:i.contains(r))||(null===a||void 0===a?void 0:a.contains(r))||l?(l&&(null===s||void 0===s?void 0:s.contains(r))||(null===c||void 0===c?void 0:c.contains(r)))&&t.setState({userSelected:!0}):(e.stopPropagation(),e.nativeEvent.stopImmediatePropagation())},t.handlePickerHide=function(e){e||t.saveCurrentDateTime()},t.handleChange=function(e){var n=t.props.isDateValid;!h().isMobilePhone&&t.state.isFromQuickFill,!n||n(e)?t.setState({currentDateTime:e,userSelected:!0}):t.setState({currentDateTime:e,userSelected:!1})},t}(0,o.Z)(t,e);var n=t.prototype;return n.componentDidMount=function(){var e=this.props,t=e.mutexManagement,n=e.containerDom;(0,_.St)(n),t.addMutexComponent(M.d.CELL_EDITOR_DROPDOWN,this)},n.componentWillUnmount=function(){(0,_.NM)(),this.props.mutexManagement.removeMutexComponent(M.d.CELL_EDITOR_DROPDOWN,this)},n.mutexHide=function(){this.setState({pcDropdownVisible:!1})},n.render=function(){var e=this.props,t=e.value,n=e.cellWidth,r=e.cellHeight,i=e.templateType,a=e.iconBgColor,o=this.state,s=(o.currentDateTime,o.mobilePanelVisible,o.isFromQuickFill,w()("date-time-cell-editor",{"date-time-cell-editor-mobile":!h().isPC})),c=(0,se.Df)(i)?"date":"time",u=w()("date-time-cell-icon","date-time-cell-icon-"+c+"-"+(h().isPC?"pc":"mobile"),{"date-time-cell-icon-mobile":h().isMobile,"date-time-cell-icon-active":t}),d={width:n,height:r},p=l().createElement("div",{className:s,style:d,onTouchEnd:this.showPanel},l().createElement("div",{className:u,style:{backgroundColor:a}}));switch(this.editorType){case"date":return this.renderPcCalenderPicker(p);case"time":return this.renderPcTimePicker(p);case"datetime":return this.renderPcCombinedEditor(p);default:return null}},n.renderPcCalenderPicker=function(e,t){void 0===t&&(t=!0);var n=this.props,r=n.templateType,i=n.isDateValid,a=this.state,o=a.currentDateTime,s=a.pcDropdownVisible,c=l().createElement("div",{onClick:this.hideIfClickDate},l().createElement(ne.ZP,Object.assign({value:o,showDateInput:!1,onChange:this.handleChange,disabledDate:function(e){return!!i&&!i(e)}},r===se.KS.YEAR_MONTH?{mode:"month"}:{})));return l().createElement(ae.default,Object.assign({dropContent:c,placement:"auto",alignment:"auto",onVisibleChange:t?this.handleRootVisibleChange.bind(this,!0):this.handlePickerHide},t?{visible:s}:{}),e)},n.renderPcTimePicker=function(e,t){void 0===t&&(t=!0);var n=this.state,r=n.currentDateTime,i=n.pcDropdownVisible;return l().createElement(oe.default,Object.assign({input:e,value:r,onChange:this.handleChange,onOk:this.handleChange,onVisibleChange:t?this.handleRootVisibleChange.bind(this,!0):this.handlePickerHide,showSecond:!1},t?{visible:i}:{}))},n.renderPcCombinedEditor=function(e){var t=this.props.value,n=this.state.pcDropdownVisible,r=t.split(" "),i=r[0],a=r[1],o=w()("date-time-panel-input","date-time-panel-input-date"),s=w()("date-time-panel-input","date-time-panel-input-time"),c=l().createElement(ae.default.Keep,{className:"date-time-panel"},this.renderPcCalenderPicker(l().createElement("div",{className:o},i),!1),this.renderPcTimePicker(l().createElement("div",{className:s},a),!1));return l().createElement(ae.default,{dropContent:c,placement:"auto",alignment:"auto",visible:n,onVisibleChange:this.handleRootVisibleChange.bind(this,!1)},e)},n.handleRootVisibleChange=function(e,t){this.setState({pcDropdownVisible:t}),e&&this.handlePickerHide(t)},n.getInitDayjsValue=function(){var e=this.props,t=e.value,n=e.templateType,r=e.cellData;if(!t)return ie()();var i=n===se.KS.MONTH_DAY?r.getEditValue():t,a=ie()(i,this.format);return a.isValid()?a:ie()()},n.saveCurrentDateTime=function(){var e=this;this.forceUpdate((function(){var t=e.state,n=t.currentDateTime,r=t.userSelected,i=t.isFromQuickFill,a=e.props,o=a.onChange,s=a.templateType;r&&(o(n.format(e.format)),(0,_.Cv)("time",i,s))}))},(0,z.Z)(t,[{key:"format",get:function(){var e=this.props.templateType;return e===se.KS.MONTH_DAY?"YYYY/M/D":se.kV[e]}},{key:"dateTimePickerMode",get:function(){var e;return((e={})[se.KS.YEAR_MONTH_DAY]="date",e[se.KS.YEAR_MONTH]="month",e[se.KS.MONTH_DAY]="date",e[se.KS.HOUR_MINUTE]="time",e[se.KS.DATE_TIME]="datetime",e)[this.props.templateType]}},{key:"editorType",get:function(){var e=this.props.templateType;return e===se.KS.DATE_TIME?"datetime":e===se.KS.HOUR_MINUTE?"time":"date"}}]),t}(l().Component),ue=function(e){function t(){var t;return(t=e.apply(this,arguments)||this).type=x.ZP.DATE_TIME,t.supportMobilePhone=!0,t.save=function(e){return ce((0,te.Z)(t),void 0,void 0,regeneratorRuntime.mark((function t(){var n,r,i;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=this.options,r=n.row,i=n.col,t.next=3,this.app.view.getValidationErrorPanel();case 3:if(!1!==t.sent.verify(r,i,e,!0)){t.next=6;break}return t.abrupt("return");case 6:this.context.save({value:e,row:r,col:i}),this.context.updateEditor({row:r,col:i});case 8:case"end":return t.stop()}}),t,this)})))},t}(0,o.Z)(t,e);var n=t.prototype;return n.shouldShowTransparentContainerBackground=function(){return!0},n.show=function(){var e,t=this.options,n=t.cellWidth,r=t.cellHeight,a=t.cellData,o=t.initPanelVisible,s=t.isPrivate?"":(null===(e=a.getFormattedValue())||void 0===e?void 0:e.value)||"",c=this.context.getContainer(),u=(0,I.z1)(a,this.app.spreadsheet).hex,d=a.getDataValidation(),h=d&&(0,_.sk)(d);i().render(l().createElement(le,{cellData:a,cellWidth:n,cellHeight:r,value:s,isDateValid:h,onChange:this.save,templateType:this.getTemplateType(),isMobileContextMenuShowing:this.context.isMobileContextMenuShowing,initPanelVisible:o,containerDom:c,iconBgColor:u,mutexManagement:this.mutexManagement}),this.context.getContainer())},n.restoreToDefaultValue=function(){this.save("")},n.getTemplateType=function(){var e;return(null===(e=this.options.config)||void 0===e?void 0:e.templateType)||se.KS.YEAR_MONTH_DAY},t}(v),de=n("../spread-sheet/src/core/app/sheetStatus/auth-range.ts"),he=function(){function e(e){var t=this;this.stage=document.createElement("div"),this.container=document.createElement("div"),this.cellEditors=new Map,this.visible=!1,this.currentRow=-1,this.currentCol=-1,this.shouldSkipPrivacyCheck=!1,this.showMobileSelectPanel=function(){var e;!t.isMobileContextMenuShowing()&&(null===(e=t.mobileDataValidationCenter)||void 0===e||e.showPanel({isFromMetadata:!0,row:t.currentRow,col:t.currentCol},!1))},this.showMobileEditorPanel=function(e,n){t.getMobileEditorPanelType(e,n)&&(t.normalSelectData.resetSelection(),t.normalSelectData.addSelection({activation:{row:e,col:n},xRange:[n,n],yRange:[e,e]}),t.hide(),t.updateEditor({row:e,col:n,initPanelVisible:!0,shouldScrollIntoView:!0}))},this.isMobileContextMenuShowing=function(){var e;return Boolean(null===(e=t.mobileContextMenu)||void 0===e?void 0:e.showing)},this.updateActiveCellEditor=V()((function(){if(!t.spreadsheet.isExternalSheet()){var e=t.normalSelectData.select;if(!e)return t.updateEditor({row:-1,col:-1});var n=e.selectCol,r=e.selectRow,i=e.activation;if(n||r)return t.updateEditor({row:-1,col:-1});i&&t.updateEditor(i)}}),10),this.hide=function(){t.visible&&(t.container.style.visibility="hidden",i().unmountComponentAtNode(t.container),t.visible=!1)},this.renderAfterCell=function(e){var n=e.row,r=e.col;t.visible&&n===t.currentRow&&r===t.currentCol&&t.updateActiveCellEditor()},this.handleMouseDownOrTap=function(e){var n=e.currRow,r=e.currCol;if(-1!==r&&-1!==n){var i=n===t.currentRow&&r===t.currentCol;t.getCellEditor(n,r)&&t.triggerRangeAuthProtectedModal(i,n,r),t.shouldPreventUpdateOnTap(n,r,i)||t.updateEditor({row:n,col:r,shouldScrollIntoView:!0})}else t.hide()},Object.assign(this,e),this.initEvent(),this.initEditors(),this.stage.className="cell-editor-stage",this.container.className=w()("cell-editor-container",{"cell-editor-container-mobile":!h().isPC}),this.stage.appendChild(this.container),this.updateActiveCellEditor(),this.operateBoard.board.appendChild(this.stage),this.mutexManagement.addMutexComponent(M.d.CUSTOM_CELL_EDITOR,this)}var t=e.prototype;return t.mutexHide=function(){this.hide()},t.getMobileEditorPanelType=function(e,t){var n=this.getCellEditor(e,t);return n&&!Array.isArray(n.type)&&[x.d9.PROGRESS,x.d9.DATE_TIME,x.d9.STAR].includes(n.type)?n.type:null},t.getInputManager=function(){return this.inputManager},t.updateEditor=function(e){var t,n=e.row,r=e.col,i=e.shouldScrollIntoView,a=void 0!==i&&i,o=e.initPanelVisible,s=void 0!==o&&o,c=e.clearPrivacyContent,l=void 0!==c&&c,u=this.getReferedCell(n,r),d=u.row,h=u.col,p=u.mergeRef;d===this.currentRow&&h===this.currentCol||(this.currentRow=d,this.currentCol=h,this.shouldSkipPrivacyCheck=!1),l&&(this.shouldSkipPrivacyCheck=!0);var f=this.getValidEditor(d,h);if(!f)return this.hide();this.currentCellEditor=f;var v=this.currentCellEditor.options||{},g=v.row,m=void 0===g?-1:g,y=v.col;d===m&&h===(void 0===y?-1:y)||this.hide();var w=this.getCellWidthHeight(d,h,p),b=w.cellHeight,C=w.cellWidth,_=this.spreadsheet.activeSheet.getCellDataAtPosition(d,h);this.currentCellEditor.updateOptions({cellWidth:C-2*x.NO,cellHeight:b-2*x.NO,row:d,col:h,config:null===(t=_.getMetadata())||void 0===t?void 0:t.config,cellData:_,initPanelVisible:s,isPrivate:this.spreadsheetApp.sheetStatus.isCellPrivate(d,h)}),l&&this.currentCellEditor.restoreToDefaultValue(),this.handlePosition(d,h,a,p),this.showContainerDom(_),this.currentCellEditor.show(),this.visible=!0,this.mutexManagement.mutexShow(M.d.CUSTOM_CELL_EDITOR)},t.getContainer=function(){return this.container},t.save=function(e){var t=e.value,n=e.row,r=e.col;this.spreadsheetApp.requestApi.userEnter({text:t,colIndex:r,rowIndex:n})},t.getCellEditor=function(e,t){var n,r,i;if(!(0,de.tE)(this.spreadsheet.parent,e,t)){var a=this.spreadsheet.activeSheet,o=null===(r=null===(n=a.getCellDataAtPosition(e,t))||void 0===n?void 0:n.getMetadata())||void 0===r?void 0:r.customDataType,s=null===(i=a.getCellDataAtPosition(e,t))||void 0===i?void 0:i.getDataValidation();return o&&(0,x.J$)(o,s)?null:o&&this.getEditor(o)}},t.getValidEditor=function(e,t){var n=this.spreadsheetApp.sheetStatus;return e<0||t<0||!n.canEdit||!this.shouldSkipPrivacyCheck&&n.isCellPrivate(e,t)?null:this.getCellEditor(e,t)},t.getEditor=function(e){var t=this.cellEditors.get(e);return h().isMobilePhone?(null===t||void 0===t?void 0:t.supportMobilePhone)&&t:t},t.getReferedCell=function(e,t){var n,r=null===(n=this.spreadsheet.activeSheet.getCellDataAtPosition(e,t))||void 0===n?void 0:n.getMergeReference();return r?{row:r.startRowIndex,col:r.startColIndex,mergeRef:r}:{row:e,col:t}},t.showContainerDom=function(e){if(this.currentCellEditor.shouldShowTransparentContainerBackground())this.container.style.background="transparent";else{var t=(0,I.z1)(e,this.spreadsheet).hex;this.container.style.background=h().isPC?t:"linear-gradient(135deg, transparent, transparent 8px, "+t+" 8px, "+t+" 92%, transparent 92%),\n                linear-gradient(315deg, transparent, transparent 8px, "+t+" 8px, "+t+" 92%, transparent 92%)"}this.container.style.opacity=this.currentCellEditor.shouldShowTransparentContainer()?"0":"1",this.container.style.visibility="visible",this.currentCellEditor.shouldDisableContainerPointerEvent()?this.container.style.pointerEvents="none":this.container.style.removeProperty("pointer-events")},t.initEditors=function(){this.registerCellEditors([new k(this,this.spreadsheetApp,this.mutexManagement),new O(this,this.spreadsheetApp,this.mutexManagement),new G(this,this.spreadsheetApp,this.mutexManagement),new ee(this,this.spreadsheetApp,this.mutexManagement),new ue(this,this.spreadsheetApp,this.mutexManagement),new q(this,this.spreadsheetApp,this.mutexManagement)])},t.registerCellEditor=function(e,t){this.cellEditors.get(e)?console.error("register cell editor error， type of "+e+" already exists."):this.cellEditors.set(e,t)},t.registerCellEditors=function(e){var t=this;e&&e.length&&e.forEach((function(e){var n=e.type;(Array.isArray(n)?n:[n]).forEach((function(n){return t.registerCellEditor(n,e)}))}))},t.getRowUnscaledHeight=function(e){return this.rowColAccessor.isRowHidden(e)?0:this.rowColAccessor.getRowDisplayHeight(e)},t.getColUnscaledWidth=function(e){return this.rowColAccessor.isColHidden(e)?0:this.rowColAccessor.getColSetWidth(e)},t.getCellWidthHeight=function(e,t,n){var r=0,i=0;if(n){for(var a=n.startRowIndex;a<=n.endRowIndex;a++)i+=this.getRowUnscaledHeight(a);for(var o=n.startColIndex;o<=n.endColIndex;o++)r+=this.getColUnscaledWidth(o)}else r=this.getColUnscaledWidth(t),i=this.getRowUnscaledHeight(e);return{cellWidth:r-1,cellHeight:i-1}},t.handlePosition=function(e,t,n,r){var i=this.areaData.getDisplayViewTopByRow(e),a=this.areaData.getDisplayViewLeftByCol(t),o=r?r.endRowIndex:e,s=r?r.endColIndex:t,c=this.areaData.getDisplayViewBottomByRow(o),l=this.areaData.getDisplayViewRightByCol(s),u=this.stage.getBoundingClientRect(),d=u.width,h=u.height,p=this.areaData.col.flow.from-1,f=this.areaData.row.flow.from-1,v=p>=0?this.areaData.getDisplayViewRightByCol(p):0,g=f>=0?this.areaData.getDisplayViewBottomByRow(f):0,m=t>p?v:0,y=e>f?g:0,w=t>p&&a<v,b=l>d,C=e>f&&i<g,_=c>h,I=this.handleScrollIntoView({shouldScrollIntoView:n,tooLeft:w,tooRight:b,tooTop:C,tooBottom:_,startRow:e,startCol:t,endRow:o,endCol:s});I&&(i=this.areaData.getDisplayViewTopByRow(e),a=this.areaData.getDisplayViewLeftByCol(t));var M=this.getCellWidthHeight(e,t,r),S=M.cellHeight,j=M.cellWidth;this.stage.style.top=this.headSize.displayColHeadHeight+y+"px",this.stage.style.left=this.headSize.displayRowHeadWidth+m+"px",this.container.style.width=j-2*x.NO+"px",this.container.style.height=S-2*x.NO+"px";var D=a-m+x.NO*this.scale.scale,E=i-y+x.NO*this.scale.scale;return this.container.style.transform="translate("+D+"px,"+E+"px) scale("+this.scale.scale+")",I},t.handleScrollIntoView=function(e){var t=e.shouldScrollIntoView,n=e.tooLeft,r=e.tooRight,i=e.tooTop,a=e.tooBottom,o=e.startRow,s=e.endRow,c=e.startCol,l=e.endCol;if(t&&(n||r||i||a)){var u=void 0,d=void 0;return n&&(d=c),r&&(d=l),i&&(u=o),a&&(u=s),this.scrollApi.scrollToVisible({row:u,col:d}),!0}return!1},t.initEvent=function(){this.mouseOperate.onMousedown(this.handleMouseDownOrTap),this.touchOperate.onTap(this.handleMouseDownOrTap),this.normalSelectData.onUpdateSelectData(this.updateActiveCellEditor),this.areaData.onUpdateOffset(this.updateActiveCellEditor),window.addEventListener("resize",this.updateActiveCellEditor),this.scale.onScale(this.updateActiveCellEditor),this.spreadsheetApp.sheetStatus.change(this.updateActiveCellEditor),this.alloyExcel.onAfterCellRender(this.renderAfterCell),this.inputManager.emitter.on(this.inputManager.EVENT.ENTER_INPUT,this.updateActiveCellEditor)},t.triggerRangeAuthProtectedModal=function(e,t,n){var r=this.spreadsheetApp.sheetStatus.sheetsStatus,i=this.spreadsheet.activeSheetId,a=r.getSheetStatus(i),o=this.spreadsheetApp.sheetStatus.getRangeCanEdit(new U.GridRange(i,t,t,n,n));e&&!o&&(null===a||void 0===a?void 0:a.canEdit)&&(0,Q.ZO)()},t.shouldPreventUpdateOnTap=function(e,t,n){var r=this.normalSelectData.select;if(h().isMobile&&(null===r||void 0===r?void 0:r.selectCell)&&this.currentRow>=0){var i=r.xRange,a=r.yRange;if(t>=i[0]&&t<=i[1]&&e>=a[0]&&e<=a[1]&&!n)return!0}return!1},e}()},"../spread-sheet/src/core/view/level-2/cell-editors/editors/impl/star-cell-editor/StarList.tsx":function(e,t,n){n("../node_modules/core-js/modules/es.array.map.js"),n("../node_modules/core-js/modules/es.object.assign.js");var r=n("react"),i=n.n(r),a=n("../node_modules/@tencent/docs-user-agent/dist/index.js"),o=n.n(a),s=n("../packages/model/src/cell/metadata/CustomDataType.ts"),c=n("../node_modules/classnames/index.js"),l=n.n(c);t.Z=function(e){var t=e.value,n=e.onChange,r=e.itemStyle,a=e.itemClassName,c=e.disabled;return Array.prototype.map.call(t,(function(e,u){var d,h,p=l()("excel-star-list-item",((d={"excel-star-list-item-full":e===s.KH})[a]=a,d));return i().createElement("div",Object.assign({style:r,key:u,className:p},((h={})[o().isPC?"onClick":"onTouchEnd"]=function(){return function(e){if(!c){if(e===t.lastIndexOf(s.KH))return n(0);n(e+1)}}(u)},h)))}))}},"../spread-sheet/src/core/view/level-2/cell-editors/editors/util.ts":function(e,t,n){n.d(t,{Cv:function(){return _},Ks:function(){return x},NM:function(){return j},Nn:function(){return I},St:function(){return S},Y3:function(){return w},qz:function(){return y},rs:function(){return b},sk:function(){return D}}),n("../node_modules/core-js/modules/es.object.assign.js"),n("../node_modules/core-js/modules/es.string.repeat.js");var r,i,a,o=n("../packages/model/src/cell/format/index.ts"),s=n("../packages/model/src/cell/metadata/CustomDataType.ts"),c=n("../packages/model/src/range/GridRange.ts"),l=n("../spread-sheet/src/core/view/spreadsheet-view/transform-table/cell.ts"),u=n("../spread-sheet/src/core/view/level-2/render-plugin/utils.ts"),d=n("../packages/report/src/index.ts"),h=n("../node_modules/@tencent/docs-user-agent/dist/index.js"),p=n.n(h),f=n("../packages/model/src/cell/metadata/date-time/DateTimeTemplateType.ts"),v=n("../node_modules/dayjs/dayjs.min.js"),g=n.n(v),m=n("../packages/model/src/cell/index.ts");function x(e,t,n,r){var i,a;void 0===t&&(t=[]);var o=e.requestApi,s=e.spreadsheet.activeSheet,l=s.getSheetId(),u=null===(a=null===(i=s.getCellDataAtPosition(n,r))||void 0===i?void 0:i.getMetadata())||void 0===a?void 0:a.config;if(u){var d=u.getSelectedTextValue(t);o.setRefIds({sheetId:l,range:new c.Z(l,n,n,r,r),refIds:t,cellValue:d})}}function y(e){var t,n,r=(0,l.PE)(e).value,i=(0,l.YW)(e).value,a=((t={})[o.VERTICAL_ALIGN.TOP]={alignItems:"flex-start",top:u.Xf+"px"},t[o.VERTICAL_ALIGN.MIDDLE]={alignItems:"center",top:"50%",transform:"translateY(-50%)"},t[o.VERTICAL_ALIGN.BOTTOM]={alignItems:"flex-end",bottom:u.Xf+"px"},t),s=((n={})[o.HORIZONTAL_ALIGN.LEFT]={justifyContent:"flex-start"},n[o.HORIZONTAL_ALIGN.CENTER]={justifyContent:"center"},n[o.HORIZONTAL_ALIGN.RIGHT]={justifyContent:"flex-end"},n);return Object.assign(Object.assign({},a[i]),s[r])}function w(e,t,n,r){e.requestApi.userEnter({text:s.KH.repeat(t)+s.E.repeat(s.XZ-t),colIndex:r,rowIndex:n})}function b(e){var t,n=null===(t=null===e||void 0===e?void 0:e.getEffectiveValue())||void 0===t?void 0:t.value;return"string"!==typeof n?"":n}var C=((r={})[f.KS.YEAR_MONTH_DAY]="y_m_d",r[f.KS.YEAR_MONTH]="y_m",r[f.KS.MONTH_DAY]="m_d",r[f.KS.DATE_TIME]="d_c",r[f.KS.HOUR_MINUTE]="clock",r);function _(e,t,n){void 0===t&&(t=!1);var r=p().isMobilePhone?"Mobile_Excel":"PC_Excel",i={opername:"doc_excel_editor",module:"data_validation",action:"validation_fillin",ver10:e,ver11:r=t?"Mobile_row":r};n&&(i.ver13=C[n]),d.ZP.tdwReport(i)}function I(e,t){var n;void 0===t&&(t=!1);var r=((n={})[s.ZP.PROGRESS]=!p().isMobilePhone&&"progress",n[s.ZP.ID]="ID",n[s.ZP.PHONE_NUM]="phone",n[s.ZP.EMAIL]="mail",n[s.ZP.TEMPERATURE]="temperature",n)[e];r&&_(r,t)}var M=(null===(a=window.TouchEvent)||void 0===a?void 0:a.prototype.preventDefault)||function(){};function S(e){(p().isIPad||p().isAndroidPad)&&(TouchEvent.prototype.preventDefault=function(){e.contains(this.target)||M.call(this)})}function j(){(p().isIPad||p().isAndroidPad)&&(TouchEvent.prototype.preventDefault=M)}var D=function(e){return function(t){var n=e.ruleType,r=e.operator,i=e.argTokens;if(n!==m.DATA_VALIDATION_RULE_TYPE.DATE||!r||r===m.DATA_VALIDATION_CONDITION_TYPE.INCLUDE||r===m.DATA_VALIDATION_CONDITION_TYPE.NOT_INCLUDE||!(null===i||void 0===i?void 0:i.length))return!0;var a=i[0].userEnteredValue,o=i[1].userEnteredValue;if(!a)return!0;var s=g()(a),c=o?g()(o):void 0;return E[r](t,s,c)}},E=((i={})[m.DATA_VALIDATION_CONDITION_TYPE.BETWEEN]=function(e,t,n){return(e.isAfter(t,"day")||e.isSame(t,"day"))&&(e.isBefore(n,"day")||e.isSame(n,"day"))},i[m.DATA_VALIDATION_CONDITION_TYPE.NOT_BETWEEN]=function(e,t,n){return e.isBefore(t,"day")||e.isAfter(n,"day")},i[m.DATA_VALIDATION_CONDITION_TYPE.GREAT]=function(e,t){return e.isAfter(t,"day")},i[m.DATA_VALIDATION_CONDITION_TYPE.GREAT_EQUAL]=function(e,t){return e.isAfter(t,"day")||e.isSame(t,"day")},i[m.DATA_VALIDATION_CONDITION_TYPE.LESS]=function(e,t){return e.isBefore(t,"day")},i[m.DATA_VALIDATION_CONDITION_TYPE.LESS_EQUAL]=function(e,t){return e.isBefore(t,"day")||e.isSame(t,"day")},i[m.DATA_VALIDATION_CONDITION_TYPE.EQUAL]=function(e,t){return e.isSame(t,"day")},i[m.DATA_VALIDATION_CONDITION_TYPE.NOT_EQUAL]=function(e,t){return!e.isSame(t,"day")},i)},"../spread-sheet/src/core/view/level-2/chart/chart-center/ChartCenter.pc.ts":function(e,t,n){n.r(t),n.d(t,{default:function(){return le}}),n("../node_modules/core-js/modules/es.object.assign.js");var r,i,a,o=n("../spread-sheet/src/core/view/level-2/chart/charts/chart-data-api.ts"),s=(n("../node_modules/regenerator-runtime/runtime.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.promise.js"),n("../node_modules/core-js/modules/es.array.iterator.js"),n("../node_modules/core-js/modules/es.map.js"),n("../node_modules/core-js/modules/es.string.iterator.js"),n("../node_modules/core-js/modules/esnext.map.delete-all.js"),n("../node_modules/core-js/modules/esnext.map.every.js"),n("../node_modules/core-js/modules/esnext.map.filter.js"),n("../node_modules/core-js/modules/esnext.map.find.js"),n("../node_modules/core-js/modules/esnext.map.find-key.js"),n("../node_modules/core-js/modules/esnext.map.includes.js"),n("../node_modules/core-js/modules/esnext.map.key-of.js"),n("../node_modules/core-js/modules/esnext.map.map-keys.js"),n("../node_modules/core-js/modules/esnext.map.map-values.js"),n("../node_modules/core-js/modules/esnext.map.merge.js"),n("../node_modules/core-js/modules/esnext.map.reduce.js"),n("../node_modules/core-js/modules/esnext.map.some.js"),n("../node_modules/core-js/modules/esnext.map.update.js"),n("../node_modules/core-js/modules/web.dom-collections.iterator.js"),n("../node_modules/lodash/clone.js")),c=n.n(s),l=n("../node_modules/@babel/runtime/helpers/esm/toConsumableArray.js"),u=(n("../node_modules/core-js/modules/es.array.map.js"),n("../node_modules/core-js/modules/web.dom-collections.for-each.js"),n("../node_modules/core-js/modules/es.array.includes.js"),n("../node_modules/core-js/modules/es.string.includes.js"),n("../node_modules/core-js/modules/es.array.filter.js"),n("../node_modules/core-js/modules/es.array.fill.js"),n("../node_modules/core-js/modules/es.regexp.exec.js"),n("../node_modules/core-js/modules/es.string.replace.js"),n("../node_modules/i18next/dist/esm/i18next.js")),d=n("../spread-sheet/src/core/view/level-2/chart/alloy-charts/chart-render/configs/ProvinceConfig.ts"),h=function(){function e(e){this.asLegendIndex=-1,this.asXAxisIndex=-1,this.datas=[],this.rowCount=0,this.colCount=0,e&&(this.asLegendIndex=e.asLegendIndex,this.asXAxisIndex=e.asXAxisIndex,this.datas=e.datas,this.rowCount=this.datas.length,this.colCount=Math.max.apply(Math,(0,l.Z)(this.datas.map((function(e){return e.length})))),this.handleDuplicateSeriesNames())}var t=e.prototype;return t.handleDuplicateSeriesNames=function(){var e=this;if(!this.isEmpty()&&-1!==this.asLegendIndex){var t=this.findDuplicates(this.datas[this.asLegendIndex]);t.length&&t.forEach((function(t){for(var n,r=e.getDuplicateSeriesName(1),i=!1,a=0;a<e.datas[e.asLegendIndex].length;a++)if((n=""+e.datas[e.asLegendIndex][a])===t){if(!i){i=!0;continue}e.datas[e.asLegendIndex][a]=r(n)}}))}},t.findDuplicates=function(e){return e.map((function(e){return""+e})).reduce((function(e,t,n,r){return r.indexOf(t)===n||e.includes(t)||e.push(""+t),e}),[])},t.isEmpty=function(){if(0==this.datas.length)return!0;for(var e,t=!1,n=0;n<this.datas.length;n++){e=this.datas[n];for(var r=0;r<e.length;r++)("string"===typeof e[r]&&e[r].length>0||"number"===typeof e[r])&&(t=!0)}return!t},t.toSeriesDatas=function(){for(var e=[],t=0;t<this.colCount;t++)if(t!==this.asXAxisIndex){for(var n=[],r=0;r<this.rowCount;r++)r!==this.asLegendIndex&&n.push(this.datas[r][t]);n.length&&e.push(n)}return e},t.toLegendData=function(){var e=this,t=[];if(0<=this.asLegendIndex&&this.asLegendIndex<this.rowCount)return this.datas[this.asLegendIndex].map((function(e){return""+e})).filter((function(t,n){return n!==e.asXAxisIndex}));for(var n=this.getDefaultLegendLabel(1),r=0;r<this.colCount;r++)r!==this.asXAxisIndex&&t.push(n());return t},t.toXAxisData=function(){var e=this;if(0<=this.asXAxisIndex&&this.asXAxisIndex<this.colCount)return this.datas.map((function(t){return""+t[e.asXAxisIndex]})).filter((function(t,n){return n!==e.asLegendIndex}));var t=0<=this.asLegendIndex&&this.asLegendIndex<this.rowCount?this.datas.length-1:this.datas.length;return new Array(t).fill(0).map((function(e,t){return""+(t+1)}))},t.toGeoData=function(){var e=[];return this.datas.forEach((function(t){var n=function(e){return e.replace(/省|市|自治区|壮族|回族|维吾尔|特别|行政区|/gi,"")}(""+t[0]),r=t[1];(function(e){return-1!=d.P.indexOf(e)})(n)&&e.push({name:n,value:r})})),e},t.getDefaultLegendLabel=function(e){var t=e;return function(){var e=u.ZP.t("系列 {{index}}",{index:t});return t+=1,e}},t.getDuplicateSeriesName=function(e){var t=e;return function(e){return e+"("+(t+=1)+")"}},e}(),p=n("../spread-sheet/src/base/event/event.ts"),f=n("../packages/model/src/new-embedded/chart/ChartType.ts"),v=n("../node_modules/@babel/runtime/helpers/esm/inheritsLoose.js"),g=n("../spread-sheet/src/core/view/level-2/chart/alloy-charts/chart-render/configs/TooltipConfigs.ts");!function(e){e.CIRCLE="circle",e.RECT="rect",e.ROUNDRECT="roundRect",e.TRIANGLE="triangle",e.DIAMOND="diamond",e.PIN="pin",e.ARROW="arrow",e.NONE="none"}(r||(r={})),function(e){e.SOLID="solid",e.DASHED="dashed",e.DOTTED="dotted"}(i||(i={})),function(e){e.LEFT="left",e.RIGHT="right",e.TOP="top",e.BOTTOM="bottom",e.INSIDE="inside"}(a||(a={}));var m=n("../packages/common-utils/src/client/safe.ts"),x=n("../packages/model/src/new-embedded/chart/AnnotationOptions.ts"),y=(n("../node_modules/core-js/modules/es.function.name.js"),n("../spread-sheet/src/core/view/level-2/chart/alloy-charts/chart-render/charts/BaseChart.ts")),w=n("../spread-sheet/src/core/view/level-2/chart/alloy-charts/chart-render/configs/YAxisConfigs.ts"),b=(n("../node_modules/core-js/modules/es.symbol.js"),n("../spread-sheet/src/core/view/level-2/chart/alloy-charts/chart-render/configs/base.ts")),C=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n},_=function(e,t){var n=Object.assign(Object.assign({},t),e);return Object.assign(Object.assign({type:"bar"},M(n)),S(n))},I=function(e,t){var n=Object.assign(Object.assign({},t),e);return Object.assign({type:"line"},M(n))},M=function(e){var t,n=e.label,r=C(e,["label"]),i=Object.assign({},r);if(!n)return i;n.textStyle;var a=C(n,["textStyle"]);return i.label=Object.assign(Object.assign({},a),(0,b.P)(null!==(t=null===n||void 0===n?void 0:n.textStyle)&&void 0!==t?t:{})),i},S=function(e){var t=e.stackingType,n=C(e,["stackingType"]),r=Object.assign({},n);return t&&(r.stack="gridStack"),r},j=n("../packages/model/src/new-embedded/chart/GridChartOptions.ts"),D=(n("../node_modules/core-js/modules/es.number.constructor.js"),n("../node_modules/core-js/modules/es.number.to-fixed.js"),function(e){function t(t){var n;return(n=e.call(this,t)||this).transformToPercentData=function(e,t,n){if(e.stackingType===j.o.PERCENT)return function(e,t){return t.map((function(t,n){return Number((t/e[n]*100).toFixed(1))}))}(t.reduce((function(e,t){return function(e,t){for(var n,r=[],i=Math.max(e.length,t.length),a=0;a<i;a++)r.push((void 0===e[a]?0:Number(e[a]))+(null!==(n=Number(t[a]))&&void 0!==n?n:0));return r}(e,t)}),[]),n)},n}(0,v.Z)(t,e);var n=t.prototype;return n.draw=function(t,n,r){if(e.prototype.draw.call(this,t,n,r),t.isEmpty())this.drawEmpty();else{var i=this.transformToOptions(t,n);this.drawEchart(i)}},n.transformToOptions=function(e,t){var n=this.getBaseOptions(t),r=e.toSeriesDatas(),i=e.toLegendData(),a=e.toXAxisData(),o=t.legendConfigs,s=t.xAxisConfigs,c=t.yAxisConfigs,l=t.gridConfigs,d=t.tooltipConfigs,h=t.stackingType===j.o.PERCENT;if(n.series=this.getSeriesOptions(r,t,i),n.legend=this.getLegendOptions(i,o),Array.isArray(s)?n.xAxis=[this.getXAxisOptions(a,s[0]),this.getXAxisOptions(a,s[1])]:n.xAxis=this.getXAxisOptions(a,s),Array.isArray(c))n.yAxis=[this.getYAxisOptions([],c[0]),this.getYAxisOptions([],c[1])];else{var p=h?new w.Z({formatter:function(e){return e+" %"}}):void 0;n.yAxis=this.getYAxisOptions([],p)}return n.grid=this.getGridOptions(l),n.tooltip=this.getTooltipOptions(d||new g.ZP({trigger:g.ov.ITEM,formatter:function(e){var t,n="";return(null===(t=e.seriesName)||void 0===t?void 0:t.length)&&(n+=(0,g.j3)((0,m.r)(e.seriesName),g.Tc)),n+='<div style="display: flex; align-items: center;">',n+=(0,g.UD)(e.color||""),n+=""+(0,g.j3)((0,m.r)(e.name||u.ZP.t("值")),g.Tc/2)+(0,g.j3)(": "+(0,m.r)(String(h?(e.value||0)+" %":e.value||"")),g.Tc/2),n+="</div>"}})),n},n.getSeriesOptions=function(e,t,n){var r=this,i=t.seriesConfigs,o=void 0===i?[]:i,s=t.totalAnnotations,c=(null===s||void 0===s?void 0:s.type)===x.Mc.DATA,l=t.stackingType===j.o.PERCENT;return e.map((function(i,s){var u=o[s],d={stackingType:t.stackingType,name:n[s],data:l?r.transformToPercentData(t,e,i):i,label:{show:c,position:a.INSIDE}};return _(u,d)}))},t}(y.Z)),E=n("../spread-sheet/src/core/view/level-2/chart/alloy-charts/chart-render/configs/LegendConfigs.ts"),T=function(e){function t(t){var n;return(n=e.call(this,t)||this).defaultLegend={icon:E.ll.DEFAULT},n.type=f.Z.LINE_CHART,n}return(0,v.Z)(t,e),t.prototype.transformToOptions=function(e,t){var n,i=this.getBaseOptions(t),a=e.toSeriesDatas(),o=e.toLegendData(),s=e.toXAxisData(),c=(null===(n=null===t||void 0===t?void 0:t.totalAnnotations)||void 0===n?void 0:n.type)===x.Mc.DATA;return i.series=a.map((function(e,n){var i=(t.seriesConfigs||[])[n],a={name:o[n],data:e,symbol:c?r.CIRCLE:r.NONE,label:{show:c}};return I(i,a)})),i.legend=this.getLegendOptions(o,t.legendConfigs),Array.isArray(t.xAxisConfigs)?i.xAxis=[this.getXAxisOptions(s,t.xAxisConfigs[0]),this.getXAxisOptions(s,t.xAxisConfigs[1])]:i.xAxis=this.getXAxisOptions(s,t.xAxisConfigs),Array.isArray(t.yAxisConfigs)?i.yAxis=[this.getYAxisOptions([],t.yAxisConfigs[0]),this.getYAxisOptions([],t.yAxisConfigs[1])]:i.yAxis=this.getYAxisOptions(),i.grid=this.getGridOptions(t.gridConfigs),i.tooltip=this.getTooltipOptions(t.tooltipConfigs||new g.ZP({trigger:g.ov.AXIS,formatter:function(e){var t="",n=1===e.length;return n&&e[0].seriesName&&e[0].seriesName.length?t+=(0,g.j3)((0,m.r)(e[0].seriesName),g.Tc):!n&&e[0].axisValueLabel&&e[0].axisValueLabel.length&&(t+=(0,g.j3)((0,m.r)(e[0].axisValueLabel),g.Tc)),e.forEach((function(e){t+='<div style="display: flex; align-items: center;">',t+=(0,g.UD)(e.color||""),t+=""+(0,g.j3)((0,m.r)((n?e.axisValueLabel:e.seriesName)||u.ZP.t("值")),g.Tc/2)+(0,g.j3)(": "+(0,m.r)(String(e.value||"")),g.Tc/2),t+="</div>"})),t}})),i},t}(D),N=function(e){function t(t){var n;return(n=e.call(this,t)||this).type=f.Z.COLUMN_CHART,n}return(0,v.Z)(t,e),t}(D),P=function(e){function t(t){var n;return(n=e.call(this,t)||this).type=f.Z.BAR_CHART,n}return(0,v.Z)(t,e),t.prototype.draw=function(t,n,r){if(e.prototype.prepareBeforeDrawChart.call(this,t,n,r),t.isEmpty())this.drawEmpty();else{var i=this.transformToOptions(t,n),a=[i.yAxis,i.xAxis];i.xAxis=a[0],i.yAxis=a[1],this.drawEchart(i)}},t}(D),R=function(){function e(e){this.setProperties(e)}var t=e.prototype;return t.setProperties=function(e){"undefined"!==typeof e.left&&(this.left=e.left),"undefined"!==typeof e.top&&(this.top=e.top),"undefined"!==typeof e.width&&(this.width=e.width),"undefined"!==typeof e.height&&(this.height=e.height),"undefined"!==typeof e.name&&(this.name=e.name),"undefined"!==typeof e.center&&(this.center=e.center),"undefined"!==typeof e.radius&&(this.radius=e.radius),"undefined"!==typeof e.data&&(this.data=e.data)},t.toOptions=function(){var e={type:"pie",label:{formatter:"{b}\n{d}%"},avoidLabelOverlap:!0};return"undefined"!==typeof this.name&&(e.name=this.name),"undefined"!==typeof this.data&&(e.data=this.data),e},e}(),k=function(e){function t(t){var n;return(n=e.call(this,t)||this).type=f.Z.PIE_CHART,n}(0,v.Z)(t,e);var n=t.prototype;return n.draw=function(t,n,r){if(e.prototype.draw.call(this,t,n,r),t.isEmpty())this.drawEmpty();else try{var i=this.transformToOptions(t,n);this.drawEchart(i)}catch(a){this.drawEmpty()}},n.transformToOptions=function(e,t){var n=this.getBaseOptions(t),r=e.toSeriesDatas(),i=e.toLegendData(),a=e.toXAxisData();return t.seriesConfigs=t.seriesConfigs||new R({}),t.seriesConfigs.setProperties({name:i[0],data:a.map((function(e,t){return{name:e,value:Number(r[0][t])}}))}),n.series=[Object.assign(t.seriesConfigs.toOptions(),this.chartLayout.getGridOptionRect())],n.legend=this.getLegendOptions(a,t.legendConfigs),t.tooltipConfigs=t.tooltipConfigs||new g.ZP({}),t.tooltipConfigs.setProperties({trigger:g.ov.ITEM,formatter:function(e){var t,n="";return(null===(t=e.seriesName)||void 0===t?void 0:t.length)&&(n+=(0,g.j3)((0,m.r)(e.seriesName),g.Tc),n+="<br />"),n+='<div style="display: flex; align-items: center;">',n+=(0,g.UD)(e.color||""),n+=""+(0,g.j3)((0,m.r)(e.name||u.ZP.t("值")),g.Tc/2)+(0,g.j3)(": "+(0,m.r)(String(e.value||""))+" ("+e.percent+"%)",g.Tc/2),n+="</div>"}}),n.tooltip=this.getTooltipOptions(t.tooltipConfigs),n},t}(y.Z),A=n("../spread-sheet/src/core/view/level-2/chart/alloy-charts/chart-render/charts/GeoChart.ts"),Z=function(e){function t(t){var n;return(n=e.call(this,t)||this).type=f.Z.AREA_CHART,n}return(0,v.Z)(t,e),t.prototype.transformToOptions=function(e,t){var n,i=this.getBaseOptions(t),a=e.toSeriesDatas(),o=e.toLegendData(),s=e.toXAxisData(),c=(null===(n=null===t||void 0===t?void 0:t.totalAnnotations)||void 0===n?void 0:n.type)===x.Mc.DATA;return i.series=a.map((function(e,n){return function(e,t){var n=Object.assign(Object.assign({},t),e),r=n.isRightAxis,i=C(n,["isRightAxis"]),a=Object.assign({},i);return r&&(a.yAxisIndex=1),Object.assign({type:"line"},M(a))}((t.seriesConfigs||[])[n],{name:o[n],data:e,symbol:c?r.CIRCLE:r.NONE,areaStyle:{},label:{show:c}})})),i.legend=this.getLegendOptions(o,t.legendConfigs),Array.isArray(t.xAxisConfigs)?i.xAxis=[this.getXAxisOptions(s,t.xAxisConfigs[0]),this.getXAxisOptions(s,t.xAxisConfigs[1])]:i.xAxis=this.getXAxisOptions(s,t.xAxisConfigs),Array.isArray(t.yAxisConfigs)?i.yAxis=[this.getYAxisOptions([],t.yAxisConfigs[0]),this.getYAxisOptions([],t.yAxisConfigs[1])]:i.yAxis=this.getYAxisOptions(),i.grid=this.getGridOptions(t.gridConfigs),i.tooltip=this.getTooltipOptions(t.tooltipConfigs||new g.ZP({trigger:g.ov.AXIS,formatter:function(e){var t="",n=1===e.length;return n&&e[0].seriesName&&e[0].seriesName.length?t+=(0,g.j3)((0,m.r)(e[0].seriesName),g.Tc):!n&&e[0].axisValueLabel&&e[0].axisValueLabel.length&&(t+=(0,g.j3)((0,m.r)(e[0].axisValueLabel),g.Tc)),e.forEach((function(e){t+='<div style="display: flex; align-items: center;">',t+=(0,g.UD)(e.color||""),t+=""+(0,g.j3)((0,m.r)((n?e.axisValueLabel:e.seriesName)||u.ZP.t("值")),g.Tc/2)+(0,g.j3)(": "+(0,m.r)(String(e.value||"")),g.Tc/2),t+="</div>"})),t}})),i},t}(D),L=function(e){function t(t){var n;return(n=e.call(this,t)||this).type=f.Z.SCATTER_CHART,n}return(0,v.Z)(t,e),t.prototype.transformToOptions=function(e,t){var n,r=this.getBaseOptions(t),i=e.toSeriesDatas(),a=e.toLegendData(),o=e.toXAxisData(),s=(null===(n=null===t||void 0===t?void 0:t.totalAnnotations)||void 0===n?void 0:n.type)===x.Mc.DATA;return r.series=i.map((function(e,n){return function(e,t){var n=Object.assign(Object.assign({},t),e);return Object.assign({type:"scatter"},M(n))}((t.seriesConfigs||[])[n],{name:a[n],data:e,label:{show:s}})})),r.legend=this.getLegendOptions(a,t.legendConfigs),Array.isArray(t.xAxisConfigs)?r.xAxis=[this.getXAxisOptions(o,t.xAxisConfigs[0]),this.getXAxisOptions(o,t.xAxisConfigs[1])]:r.xAxis=this.getXAxisOptions(o,t.xAxisConfigs),Array.isArray(t.yAxisConfigs)?r.yAxis=[this.getYAxisOptions([],t.yAxisConfigs[0]),this.getYAxisOptions([],t.yAxisConfigs[1])]:r.yAxis=this.getYAxisOptions(),r.grid=this.getGridOptions(t.gridConfigs),r.tooltip=this.getTooltipOptions(t.tooltipConfigs||new g.ZP({trigger:g.ov.ITEM,formatter:function(e){var t,n="";return(null===(t=e.seriesName)||void 0===t?void 0:t.length)&&(n+=(0,g.j3)((0,m.r)(e.seriesName),g.Tc)),n+='<div style="display: flex; align-items: center;">',n+=(0,g.UD)(e.color||""),n+=""+(0,g.j3)((0,m.r)(e.name||u.ZP.t("值")),g.Tc/2)+(0,g.j3)(": "+(0,m.r)(String(e.value||"")),g.Tc/2),n+="</div>"}})),r},t}(D),O=function(e){function t(t){var n;return(n=e.call(this,t)||this).type=f.Z.COMBO_CHART,n}return(0,v.Z)(t,e),t.prototype.getSeriesOptions=function(e,t,n){var i=t.seriesConfigs,o=void 0===i?[]:i,s=t.totalAnnotations,c=(null===s||void 0===s?void 0:s.type)===x.Mc.DATA;return e.map((function(e,t){var i=o[t],s={name:n[t],data:e,symbol:c?r.CIRCLE:r.NONE,label:{show:c,position:a.TOP}};return 0===t?(s.label.position=a.INSIDE,_(i,s)):I(i,s)}))},t}(D),H=function(){function e(){}return e.newChart=function(e,t){switch(e){case f.Z.LINE_CHART:return new T(t);case f.Z.COLUMN_CHART:return new N(t);case f.Z.BAR_CHART:return new P(t);case f.Z.COMBO_CHART:return new O(t);case f.Z.PIE_CHART:return new k(t);case f.Z.GEO_CHART:return new A.Z(t);case f.Z.AREA_CHART:return new Z(t);case f.Z.SCATTER_CHART:return new L(t);default:return n.g.log.error("暂不支持该图表类型：",e),new N(t)}},e}(),V=function(e){function t(t){var n;return(n=e.call(this,t)||this).hide(),n}(0,v.Z)(t,e);var n=t.prototype;return n.hide=function(){var e={display:!1};this.topLeft.update(e),this.topCenter.update(e),this.topRight.update(e),this.middleLeft.update(e),this.middleRight.update(e),this.bottomLeft.update(e),this.bottomCenter.update(e),this.bottomRight.update(e)},n.display=function(){var e={display:!0};this.topLeft.update(e),this.topCenter.update(e),this.topRight.update(e),this.middleLeft.update(e),this.middleRight.update(e),this.bottomLeft.update(e),this.bottomCenter.update(e),this.bottomRight.update(e)},t}(n("../spread-sheet/src/core/view/level-2/drag-control/BaseDragControl.ts").Z),z=n("../spread-sheet/src/core/view/level-2/shape-edit-center/utils.ts"),B=function(e,t,n,r){return new(n||(n=Promise))((function(i,a){function o(e){try{c(r.next(e))}catch(t){a(t)}}function s(e){try{c(r.throw(e))}catch(t){a(t)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,s)}c((r=r.apply(e,t||[])).next())}))};function W(e){var t=e.scale,n=e.layoutData,r=e.areaData,i=(n.left+r.col.frozen.viewSize)/t,a=(n.top+r.row.frozen.viewSize)/t,o=r.getColByDisplayViewLeft(i-r.col.flow.offsetSize),s=r.getRowByDisplayViewTop(a-r.row.flow.offsetSize),c=n.width/t>>0,l=n.height/t>>0;return{x:i-r.getGlobalLeftByCol(o),y:a-r.getGlobalTopByRow(s),colIndex:o,rowIndex:s,width:c,height:l}}var Y,G=n("../spread-sheet/src/core/view/lib/tap-support.ts");!function(e){e.ENTER_ACTIVE_STATE="enter_active_state",e.LEAVE_ACTIVE_STATE="leave_active_state",e.SHOW_CHART_PANEL="show_chart_panel"}(Y||(Y={}));var U=function(e,t,n,r){return new(n||(n=Promise))((function(i,a){function o(e){try{c(r.next(e))}catch(t){a(t)}}function s(e){try{c(r.throw(e))}catch(t){a(t)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,s)}c((r=r.apply(e,t||[])).next())}))},Q=function(){function e(e){var t=this;this.box=document.createElement("div"),this.layoutData={top:0,left:0,width:0,height:0},this.isActive=!1,this.destroy=function(){t.box.remove(),t.chart.deleteChart()},this.leaveActiveState=function(){t.isActive=!1,t.box.classList.remove("active"),t.dragControl.hide(),p.ZP.chartEvent.trigger(Y.LEAVE_ACTIVE_STATE)},this.handleScale=function(e,n){var r=n.diffX,i=n.diffY,a=t.scale.scale;(0,z.rv)(t.layoutData,t.areaData,e,r*a,i*a),t.updateLayout()},this.handleScaleEnd=function(){if(!(Math.abs(t.operateData.currX-t.operateData.startX)<=1&&Math.abs(t.operateData.currY-t.operateData.startY)<=1)){var e=W({chartBoxId:t.chartBoxId,scale:t.scale.scale,layoutData:t.layoutData,areaData:t.areaData});o.H.layoutChange(t.chartBoxId,e)}},this.enterActiveState=function(){var e,n=t.sheetStatus,r=n.workbookStatus,i=n.sheetsStatus;r.canEdit&&!1!==(null===(e=i.getActiveSheetStatus())||void 0===e?void 0:e.canEdit)&&(t.isActive=!0,t.box.classList.add("active"),t.dragControl.display(),t.setActiveChartBox(t.chartBoxId),p.ZP.chartEvent.trigger(Y.ENTER_ACTIVE_STATE,t.chartBoxId))},this.showChartPanel=function(){t.isActive&&p.ZP.chartEvent.trigger(Y.SHOW_CHART_PANEL,t.chartBoxId)},this.handleDragStart=function(e){t.isActive&&(e.stopPropagation(),e.preventDefault(),document.addEventListener("mousemove",t.handleDragMove),document.addEventListener("mouseup",t.handleDragEnd),document.addEventListener("touchmove",t.handleDragMove),document.addEventListener("touchend",t.handleDragEnd))},this.handleDragMove=function(){if(t.isActive){var e=t.scale.scale;!function(e,t,n,r){var i=(0,z.vM)(t),a=i.left,o=i.top,s=t.col.flow.totalSize-e.width,c=t.row.flow.totalSize-e.height;e.left=Math.max(a,Math.min(e.left+n,s)),e.top=Math.max(o,Math.min(e.top+r,c))}(t.layoutData,t.areaData,t.operateData.diffX*e,t.operateData.diffY*e),t.updateLayout()}},this.handleDragEnd=function(){if(document.removeEventListener("mousemove",t.handleDragMove),document.removeEventListener("mouseup",t.handleDragEnd),document.removeEventListener("touchmove",t.handleDragMove),document.removeEventListener("touchend",t.handleDragEnd),!(Math.abs(t.operateData.currX-t.operateData.startX)<=1&&Math.abs(t.operateData.currY-t.operateData.startY)<=1)){var e=W({chartBoxId:t.chartBoxId,scale:t.scale.scale,layoutData:t.layoutData,areaData:t.areaData});o.H.layoutChange(t.chartBoxId,e)}},this.showContextMenu=function(e){e.preventDefault()},Object.assign(this,e),this.box.classList.add("chart-box"),e.stage.appendChild(this.box),this.chart=H.newChart(this.type,this.box)}var t=e.prototype;return t.initChartBox=function(){return U(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.chart.initEcharts();case 2:this.dragControl=new V({container:this.box,startCallback:function(){},moveCallback:this.handleScale,endCallback:this.handleScaleEnd,operateData:this.operateData}),this.initEventListener();case 4:case"end":return e.stop()}}),e,this)})))},t.draw=function(e,t,n){this.layoutData={top:n.top,left:n.left,width:n.width,height:n.height},this.updateLayout(),this.chart.draw(e,t,n)},t.initEventListener=function(){this.chart.container.addEventListener("mousedown",this.enterActiveState),this.chart.container.addEventListener("touchstart",this.enterActiveState),this.chart.container.addEventListener("dblclick",this.showChartPanel),this.box.addEventListener("mousedown",this.handleDragStart),this.box.addEventListener("contextmenu",this.showContextMenu),(0,G.C)(this.box),this.box.addEventListener("touchstart",this.handleDragStart),this.box.addEventListener("longTap",this.showContextMenu)},t.updateLayout=function(){Object.assign(this.box.style,{left:this.layoutData.left+"px",top:this.layoutData.top+"px",width:this.layoutData.width+"px",height:this.layoutData.height+"px"}),this.chart.resize()},e}(),F=n("../packages/lib/Keyboard.ts"),J=n("../packages/report/src/index.ts"),X=n("../spread-sheet/src/core/feature/copyPaste/interfaces.ts"),K=function(e){var t=this;this.delete=function(){return t.removeChart(),J.ZP.tdwReport({opername:"doc_charts",module:"delete",action:"charts_delete"}),J.ZP.kvrOss({itemname:"xls_chart_pic_delete"}),!1},this.esc=function(){return t.cancel(),!1},this.copy=function(){return J.ZP.kvrOss({itemname:"xls_chart_pic_ctrlc"}),t.copyChart(X.lb.copy),!1},this.container=e.container,this.removeChart=e.removeChart,this.cancel=e.cancel,this.copyChart=e.copyChart,this.keyboard=new F.ZP({root:this.container,bindings:[{key:F.ZP.KEYS.DELETE,handler:this.delete},{key:F.ZP.KEYS.BACKSPACE,handler:this.delete},{key:F.ZP.KEYS.ESCAPE,handler:this.esc},{key:"c",shortKey:!0,handler:function(){return t.copy(),!1}}]})},q=function(e,t,n,r){return new(n||(n=Promise))((function(i,a){function o(e){try{c(r.next(e))}catch(t){a(t)}}function s(e){try{c(r.throw(e))}catch(t){a(t)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,s)}c((r=r.apply(e,t||[])).next())}))},$=function(){function e(e){var t=this;this.chartBoxMap=new Map,this.stage=document.createElement("div"),this.activeChartBoxId="",this.chartBoxDataMap=new Map,this.mutexHide=function(){t.leaveActiveStateOfChartBox(t.activeChartBoxId)},this.setActiveChartBox=function(e){t.activeChartBoxId!==e&&(t.leaveActiveStateOfChartBox(t.activeChartBoxId),t.activeChartBoxId=e)},Object.assign(this,e),this.stage.classList.add("chart-stage-board"),this.stage.setAttribute("tabindex","4"),this.blockBoard.hiddenBoard.append(this.stage),this.initEventListener(),this.chartKeyboard=new K({container:this.stage,removeChart:function(){return o.H.delete(t.activeChartBoxId)},cancel:function(){return t.leaveActiveStateOfChartBox(t.activeChartBoxId)},copyChart:function(){return function(e,t){return B(this,void 0,void 0,regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,null===e||void 0===e?void 0:e.doChartCopy(t);case 2:case"end":return n.stop()}}),n)})))}(t.copyPaste,t.activeChartBoxId)}})}var t=e.prototype;return t.leaveActiveStateOfChartBox=function(e){var t=this.chartBoxMap.get(e);null===t||void 0===t||t.leaveActiveState(),this.activeChartBoxId=""},t.getActiveChartBoxId=function(){return this.activeChartBoxId},t.drawChartBox=function(e){return q(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n,r,i,a,o,s;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=e.id,r=e.rect,i=e.data,a=new h(i.table),o=this.chartBoxMap.get(n),this.blockBoard.isInBoard(r)){t.next=5;break}return t.abrupt("return");case 5:if((s=c()(r)).left-=this.blockBoard.globalOffsetX,s.top-=this.blockBoard.globalOffsetY,o&&o.type===i.type){t.next=13;break}return this.deleteChartBox(n),o=new Q({chartBoxId:n,type:i.type,operateData:this.operateData,scale:this.scale,areaData:this.areaData,stage:this.stage,setActiveChartBox:this.setActiveChartBox,sheetStatus:this.spreadsheetApp.sheetStatus}),t.next=13,o.initChartBox();case 13:o.draw(a,i.configs,s),this.chartBoxDataMap.set(n,e),this.chartBoxMap.set(n,o);case 16:case"end":return t.stop()}}),t,this)})))},t.updateChartBox=function(e,t){return q(this,void 0,void 0,regeneratorRuntime.mark((function n(){var r;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(r=this.chartBoxDataMap.get(e)){n.next=3;break}return n.abrupt("return");case 3:return Object.assign(r,t),n.next=6,this.drawChartBox(r);case 6:case"end":return n.stop()}}),n,this)})))},t.deleteChartBox=function(e){var t=this.chartBoxMap.get(e);t&&(t.destroy(),this.chartBoxMap.delete(e),this.chartBoxDataMap.delete(e))},t.getChartBox=function(e){return this.chartBoxMap.get(e)},t.initEventListener=function(){var e=this;this.stage.addEventListener("click",(function(t){t.stopPropagation(),e.stage.focus()}))},e}(),ee=n("../spread-sheet/src/core/view/lib/mutex-management/MutexManagement.ts"),te=n("../spread-sheet/src/core/view/level-2/chart/charts/transform/transform.ts"),ne=function(e,t,n,r){return new(n||(n=Promise))((function(i,a){function o(e){try{c(r.next(e))}catch(t){a(t)}}function s(e){try{c(r.throw(e))}catch(t){a(t)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,s)}c((r=r.apply(e,t||[])).next())}))},re=function(e){var t=this;this.enterActiveState=function(e){t.showChartRange(e),t.mutexManagement.mutexShow(ee.d.CHART)},this.leaveActiveState=function(){return ne(t,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.hideChartRange(),e.next=3,this.hideChartPanel();case 3:case"end":return e.stop()}}),e,this)})))},this.showChartPanel=function(e){return ne(t,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.spreadsheetApp.view.getChartPanel();case 2:t.sent.showWithChartId(e);case 4:case"end":return t.stop()}}),t,this)})))},this.hideChartPanel=function(){return ne(t,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.spreadsheetApp.view.getChartPanel();case 2:e.sent.hide();case 4:case"end":return e.stop()}}),e,this)})))},this.showChartRange=function(e){var n,r,i=t.spreadsheetApp.spreadsheet,a=i.embeddedObjectManager,o=i.workbookRangeManager,s=a.getEmbeddedObject(e),c=null===s||void 0===s?void 0:s.properties.chart;if(c){var l=c.headers,u=c.dataTransformation,d=c.transpose,h=(0,te.eo)(l,null===(n=null===u||void 0===u?void 0:u.colInfo)||void 0===n?void 0:n.columnIndex),p=h.asLegendIndex,f=h.asXAxisIndex;if(d){var v=[f,p];p=v[0],f=v[1]}var g=c.workbookRangeId[0];if(g){var m=o.getWorkbookRangeById(g);m&&(null===(r=t.spreadsheetApp.view.canvas)||void 0===r||r.chartRange.show(m.range,p,f,!!d))}}},this.hideChartRange=function(){var e,n;null===(n=null===(e=t.spreadsheetApp.view.canvas)||void 0===e?void 0:e.chartRangeRenderPlugin)||void 0===n||n.hide()},Object.assign(this,e),this.mutexManagement.addMutexComponent(ee.d.CHART,this.chartStage),p.ZP.chartEvent.listen(Y.ENTER_ACTIVE_STATE,this.enterActiveState),p.ZP.chartEvent.listen(Y.LEAVE_ACTIVE_STATE,this.leaveActiveState),p.ZP.chartEvent.listen(Y.SHOW_CHART_PANEL,this.showChartPanel)},ie=(n("../node_modules/core-js/modules/es.array.from.js"),n("../spread-sheet/src/core/view/utils/base-func.ts")),ae=n("../spread-sheet/src/core/network/datacenter/utils/load-cross-table-data.ts"),oe=n("../packages/model/src/new-embedded/index.ts"),se=function(e,t,n,r){return new(n||(n=Promise))((function(i,a){function o(e){try{c(r.next(e))}catch(t){a(t)}}function s(e){try{c(r.throw(e))}catch(t){a(t)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,s)}c((r=r.apply(e,t||[])).next())}))},ce=function(){function e(e){var t=this;this.updateAllChart=(0,ie.ad)((function(){t.spreadsheet.embeddedObjectManager.each((function(e){e.location.sheetId===t.spreadsheet.activeSheetId&&e.properties.type===oe.NEW_EMBEDDED_OBJECT_TYPE.CHART&&t.updateChart({object:e})}))})),this.addAllCharts=function(){var e=t.spreadsheet.embeddedObjectManager.embeddedObjectMap,r=Array.from(e.keys()),i=r.length,a=0;n.g.requestAnimationFrame((function o(){var s=r[a],c=e.get(s);(null===c||void 0===c?void 0:c.location.sheetId)===t.spreadsheet.activeSheetId&&c.properties.type===oe.NEW_EMBEDDED_OBJECT_TYPE.CHART&&t.addChart({object:c}),(a+=1)<i&&n.g.requestAnimationFrame(o)}))},this.addChart=function(e){return se(t,void 0,void 0,regeneratorRuntime.mark((function t(){var r,i,a,o,s,c,l;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(o=null===(r=e.object.properties.chart)||void 0===r?void 0:r.workbookRangeId[0]){t.next=4;break}return null===(i=n.g.log)||void 0===i||i.error("ChartKeeper._addChart: 插入图表数据异常, rangeId 为空"),t.abrupt("return");case 4:if(s=this.spreadsheet.workbookRangeManager.getChartWorkbookRangeById(o),(c=s.range.sheetId)===this.spreadsheet.activeSheetId){t.next=9;break}return t.next=9,(0,ae.A)(this.spreadsheet,c);case 9:if(l=(0,te.vs)(this.spreadsheet,e.object,this.areaData)){t.next=13;break}return null===(a=n.g.log)||void 0===a||a.error("ChartKeeper._addChart: 插入图表数据异常"),t.abrupt("return");case 13:l.rect.left*=this.scale.scale,l.rect.top*=this.scale.scale,l.rect.width*=this.scale.scale,l.rect.height*=this.scale.scale,this.chartStage.drawChartBox(l);case 18:case"end":return t.stop()}}),t,this)})))},this.deleteChart=function(e){t.chartStage.deleteChartBox(e.objectId),p.ZP.chartEvent.trigger(Y.LEAVE_ACTIVE_STATE)},this.updateChart=function(e){var r,i=(0,te.vs)(t.spreadsheet,e.object,t.areaData);i?(i.rect.left*=t.scale.scale,i.rect.top*=t.scale.scale,i.rect.width*=t.scale.scale,i.rect.height*=t.scale.scale,t.chartStage.updateChartBox(i.id,i)):null===(r=n.g.log)||void 0===r||r.error("ChartKeeper._updateChart: 更新图表数据异常")},Object.assign(this,e),this.dataCallView.onAddChart(this.addChart),this.dataCallView.onUpdateChart(this.updateChart),this.dataCallView.onDeleteChart(this.deleteChart),this.areaData.row.frozen.onUpdateViewSize(this.updateAllChart),this.areaData.row.flow.onUpdateViewSize(this.updateAllChart),this.areaData.col.frozen.onUpdateViewSize(this.updateAllChart),this.areaData.col.flow.onUpdateViewSize(this.updateAllChart),this.areaData.row.frozen.onUpdateTotalSize(this.updateAllChart),this.areaData.row.flow.onUpdateTotalSize(this.updateAllChart),this.areaData.col.frozen.onUpdateTotalSize(this.updateAllChart),this.areaData.col.flow.onUpdateTotalSize(this.updateAllChart),this.dataCallView.onSetColVisible(this.updateAllChart),this.dataCallView.onSetRowVisible(this.updateAllChart),this.addAllCharts()}return e.prototype.deleteAllCharts=function(){var e=this;this.spreadsheet.embeddedObjectManager.embeddedObjectMap.forEach((function(t){e.deleteChart({objectId:t.objectId,sheetId:e.spreadsheet.activeSheetId})}))},e}(),le=function(){function e(e){Object.assign(this,e),this.chartStage=new $({blockBoard:this.mainBoard.bottom.right,spreadsheet:this.spreadsheet,copyPaste:this.spreadsheetApp.feature._copyPaste,operateData:this.operateData,scale:this.scale,areaData:this.areaData,spreadsheetApp:this.spreadsheetApp}),this.chartKeeper=new ce({dataCallView:this.dataCallView,spreadsheet:this.spreadsheet,areaData:this.areaData,scale:this.scale,chartStage:this.chartStage}),new re({chartStage:this.chartStage,mutexManagement:this.mutexManagement,scale:this.scale,operateData:this.operateData,areaData:this.areaData,spreadsheetApp:this.spreadsheetApp}),o.H.init(this.spreadsheetApp)}return e.prototype.refresh=function(){this.chartKeeper.deleteAllCharts(),this.chartKeeper.addAllCharts()},e}()},"../spread-sheet/src/core/view/level-2/context-menu-center/ContextMenuCenter.pc.ts":function(e,t,n){n.r(t),n.d(t,{default:function(){return Ar}});var r,i=n("../node_modules/@babel/runtime/helpers/esm/createClass.js"),a=(n("../node_modules/core-js/modules/es.object.assign.js"),n("../node_modules/@babel/runtime/helpers/esm/inheritsLoose.js"));n("../node_modules/regenerator-runtime/runtime.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.promise.js"),function(e){e[e.ROW=0]="ROW",e[e.COL=1]="COL",e[e.ALL=2]="ALL",e[e.CELL=3]="CELL",e[e.SHAPE=4]="SHAPE",e[e.CHART=5]="CHART"}(r||(r={}));var o=function(e){this._permission=e.permission},s=function(e,t,n,r){return new(n||(n=Promise))((function(i,a){function o(e){try{c(r.next(e))}catch(t){a(t)}}function s(e){try{c(r.throw(e))}catch(t){a(t)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,s)}c((r=r.apply(e,t||[])).next())}))},c=function(){function e(e){this._buttons=[];for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];for(var i=0;i<n.length;i++)this._buttons.push(new n[i](e))}var t=e.prototype;return t.getConfigInCell=function(e){return s(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n,r,i;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=[],r=0;case 2:if(!(r<this._buttons.length)){t.next=10;break}return t.next=5,this._buttons[r].getConfigInCell(e);case 5:(i=t.sent)&&n.push(i);case 7:r++,t.next=2;break;case 10:return t.abrupt("return",n);case 11:case"end":return t.stop()}}),t,this)})))},t.getConfigInShape=function(e){return s(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n,r,i;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=[],r=0;case 2:if(!(r<this._buttons.length)){t.next=10;break}return t.next=5,this._buttons[r].getConfigInShape(e);case 5:(i=t.sent)&&n.push(i);case 7:r++,t.next=2;break;case 10:return t.abrupt("return",n);case 11:case"end":return t.stop()}}),t,this)})))},t.getConfigInChart=function(e){return s(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n,r,i;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=[],r=0;case 2:if(!(r<this._buttons.length)){t.next=10;break}return t.next=5,this._buttons[r].getConfigInChart(e);case 5:(i=t.sent)&&n.push(i);case 7:r++,t.next=2;break;case 10:return t.abrupt("return",n);case 11:case"end":return t.stop()}}),t,this)})))},e}(),l=c,u=n("../node_modules/@babel/runtime/helpers/esm/assertThisInitialized.js"),d=n("../node_modules/i18next/dist/esm/i18next.js"),h=(n("../node_modules/core-js/modules/es.array.find-index.js"),n("../packages/model/src/range/index.ts")),p=n("../spread-sheet/src/core/view/level-1/select-center/base/selection/CellSelection.ts"),f=n("../spread-sheet/src/core/view/level-1/select-center/base/selection/RowSelection.ts"),v=n("../spread-sheet/src/core/view/level-1/select-center/base/selection/ColSelection.ts"),g=function(e,t,n,r){return new(n||(n=Promise))((function(i,a){function o(e){try{c(r.next(e))}catch(t){a(t)}}function s(e){try{c(r.throw(e))}catch(t){a(t)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,s)}c((r=r.apply(e,t||[])).next())}))};function m(){var e=document.createElement("div");e.style.cssFloat="right";var t=document.createElement("div");return t.style.borderTop="4px solid transparent",t.style.borderBottom="4px solid transparent",t.style.borderLeft="5px solid rgba(0,0,0,.4)",t.style.display="inline-block",e.appendChild(t),e}var x=function(e){function t(){return e.apply(this,arguments)||this}return(0,a.Z)(t,e),t}(function(){function e(e){this._empty=null,this.disabledConfig={class:"context-menu-disabled",callback:function(){return Promise.resolve()}},this._app=e}var t=e.prototype;return t.getConfigInCell=function(e){return g(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this._empty);case 1:case"end":return e.stop()}}),e,this)})))},t.getConfigInRow=function(e){return g(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this._empty);case 1:case"end":return e.stop()}}),e,this)})))},t.getConfigInCol=function(e){return g(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this._empty);case 1:case"end":return e.stop()}}),e,this)})))},t.getConfigInAll=function(e){return g(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this._empty);case 1:case"end":return e.stop()}}),e,this)})))},t.getConfigInShape=function(e){return g(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this._empty);case 1:case"end":return e.stop()}}),e,this)})))},t.getConfigInChart=function(e){return g(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this._empty);case 1:case"end":return e.stop()}}),e,this)})))},t.isCellImage=function(){var e=this._app.view.canvas.normalSelectData,t=e.activeRow,n=e.activeCol;return!(n<0||t<0)&&Boolean(this._app.spreadsheet.activeSheet.getCellImage(t,n))},t.isWeworkComponent=function(){var e=this._app.view.canvas.normalSelectData,t=e.activeRow,n=e.activeCol;if(n<0||t<0)return!1;var r=this._app.spreadsheet.activeSheet.getCellDataAtPosition(t,n);return(null===r||void 0===r?void 0:r.isWeworkComponent())||!1},t.checkColRangeCanEdit=function(e){var t=this,n=e.xRange,r=this._app.sheetStatus.isCurrentColCanEdit({startCol:n[0],endCol:n[1]}),i=this._app.spreadsheet.activeSheet.mergeManager,a=this._app.spreadsheet.activeSheetId,o=i.mergeList.findIndex((function(e){return!!e.isCross(new h.GridRange(a,h.DEFAULT_DIMENSION_INDEX,h.DEFAULT_DIMENSION_INDEX,n[0],n[1]))&&!t._app.sheetStatus.getRangeCanEdit(e)}));return r&&-1===o},t.checkRowRangeCanEdit=function(e){var t=this,n=e.yRange,r=this._app.sheetStatus.isCurrentRowCanEdit({startRow:n[0],endRow:n[1]}),i=this._app.spreadsheet.activeSheet.mergeManager,a=this._app.spreadsheet.activeSheetId,o=i.mergeList.findIndex((function(e){return!!e.isCross(new h.GridRange(a,n[0],n[1],h.DEFAULT_DIMENSION_INDEX,h.DEFAULT_DIMENSION_INDEX))&&!t._app.sheetStatus.getRangeCanEdit(e)}));return r&&-1===o},t.isButtonNeedDisabled=function(){var e,t,n=null===(t=null===(e=this._app.view)||void 0===e?void 0:e.canvas)||void 0===t?void 0:t.normalSelectData.selectQueue;if(!n||0===n.length)return!1;for(var r=0;r<n.length;r++){var i=n[r];if(this.checkSelectNeedDisabled(i))return!0}return!1},t.checkSelectNeedDisabled=function(e){var t=this._app.sheetStatus.workbookStatus.canEdit,n=!0;if(e instanceof p.Z){var r=e.xRange,i=e.yRange;n=this._app.sheetStatus.getRangeCanEdit(new h.GridRange({sheetId:this._app.spreadsheet.activeSheetId,startRowIndex:i[0],endRowIndex:i[1],startColIndex:r[0],endColIndex:r[1]}))}return e instanceof f.Z&&(n=this.checkRowRangeCanEdit(e)),e instanceof v.Z&&(n=this.checkColRangeCanEdit(e)),t&&!n},e}()),y=x,w=n("../spread-sheet/src/core/utils/index.ts"),b=n("../packages/report/src/index.ts"),C=n("../packages/model/src/range/GridRange.ts"),_=n("../spread-sheet/src/external/rangeAuth/util/range-auth-parse-util.ts"),I=function(e,t){var n=document.createElement("div"),r=document.createTextNode(e),i=M(t);return n.appendChild(r),n.appendChild(i),n};function M(e){var t=document.createElement("div");t.className="context-menu-item-pc-desc";var n=document.createTextNode(e);return t.appendChild(n),t}function S(e){var t,n=(null===(t=e.view.canvas)||void 0===t?void 0:t.normalSelectData).select,r=n.xRange,i=n.yRange,a=e.spreadsheet.getActiveSheetId();return new C.Z({sheetId:a,startRowIndex:i[0],endRowIndex:i[1],startColIndex:r[0],endColIndex:r[1]})}function j(e,t){var n,r=(0,_.rk)().isSingleSelect,i=(null===(n=e.view.canvas)||void 0===n?void 0:n.normalSelectData).select;return!(!t.canEdit||!r)&&!(!i||i.selectAll||i.selectCol||i.selectRow)}n("../node_modules/core-js/modules/es.array.concat.js");var D=n("../spread-sheet/src/core/feature/copyPaste/interfaces.ts"),E=n("../spread-sheet/src/core/feature/copyPaste/index.ts"),T=n("../node_modules/@tencent/docs-user-agent/dist/index.js"),N=n.n(T),P=n("../spread-sheet/src/core/view/level-2/todo-ent/utils.ts"),R=function(e,t,n,r){return new(n||(n=Promise))((function(i,a){function o(e){try{c(r.next(e))}catch(t){a(t)}}function s(e){try{c(r.throw(e))}catch(t){a(t)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,s)}c((r=r.apply(e,t||[])).next())}))},k=function(e){function t(t){var n;return(n=e.call(this,t)||this)._callback=function(){return R((0,u.Z)(n),void 0,void 0,regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(0,P.TQ)(this._app)){e.next=2;break}return e.abrupt("return");case 2:t={copyType:D.lb.cut},E.default.apiDoCopy(this._app,t),b.ZP.tdwReport({module:"cut_copy_paste",opername:"doc_excel_editor",action:"cut_copy_paste_cut_click",ver10:"rightside_click"});case 5:case"end":return e.stop()}}),e,this)})))},n._default={element:I(d.ZP.t("剪切"),(N().isMac?"⌘":"Ctrl")+"+X"),callback:n._callback},n.disabled=Object.assign({element:I(d.ZP.t("剪切"),(N().isMac?"⌘":"Ctrl")+"+X")},n.disabledConfig),n}return(0,a.Z)(t,e),t.prototype.getConfigInCell=function(e){return R(this,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.isButtonNeedDisabled()){t.next=2;break}return t.abrupt("return",this.disabled);case 2:if(e.canEdit){t.next=4;break}return t.abrupt("return",this._empty);case 4:return t.abrupt("return",this._default);case 5:case"end":return t.stop()}}),t,this)})))},t}(y),A=function(e,t,n,r){return new(n||(n=Promise))((function(i,a){function o(e){try{c(r.next(e))}catch(t){a(t)}}function s(e){try{c(r.throw(e))}catch(t){a(t)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,s)}c((r=r.apply(e,t||[])).next())}))},Z=function(e){function t(){var t;return(t=e.apply(this,arguments)||this)._callback=function(){return A((0,u.Z)(t),void 0,void 0,regeneratorRuntime.mark((function e(){var t,n,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(r in t={copyType:D.lb.copy},E.default.apiDoCopy(this._app,t),n=[{module:"cut_copy_paste",opername:"doc_excel_editor",action:"cut_copy_paste_copy_click",ver10:"rightside_click"}],window.isRecordPreviewShowing&&n.push({opername:"doc_excel",module:"revise",action:"upv",ver10:"upv"}),n)Object.prototype.hasOwnProperty.call(n,r)&&b.ZP.tdwReport(n[r]);case 5:case"end":return e.stop()}}),e,this)})))},t}return(0,a.Z)(t,e),t.prototype.getConfigInCell=function(e){var t;return A(this,void 0,void 0,regeneratorRuntime.mark((function r(){var i;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(i={element:I(d.ZP.t("复制"),(N().isMac?"⌘":"Ctrl")+"+C"),callback:this._callback},!(null===(t=n.g.clientVars)||void 0===t?void 0:t.hotDocs)){r.next=3;break}return r.abrupt("return",i);case 3:if(!e.canCopy||this._app.sheetStatus.containsCanNotReadRange()){r.next=5;break}return r.abrupt("return",i);case 5:return r.abrupt("return",this._empty);case 6:case"end":return r.stop()}}),r,this)})))},t}(y),L=Z,O=n("../spread-sheet/src/core/ui/dialog/index.ts"),H=n("../spread-sheet/src/core/feature/copyPaste/api/copyPasteAPI.pc.ts"),V=function(e,t,n,r){return new(n||(n=Promise))((function(i,a){function o(e){try{c(r.next(e))}catch(t){a(t)}}function s(e){try{c(r.throw(e))}catch(t){a(t)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,s)}c((r=r.apply(e,t||[])).next())}))},z=function(e){function t(t){var r;return(r=e.call(this,t)||this).callback=function(){return V((0,u.Z)(r),void 0,void 0,regeneratorRuntime.mark((function e(){var t,r,i,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._app.feature.getCopyPaste();case 2:return t=e.sent,e.next=5,(0,H.S2)(t);case 5:if(r=e.sent,i=this._app.feature.copyPasteBase.apiJudgeForPaste(this._app,t,r),a=i.canPaste,i.visable&&a){e.next=9;break}return e.abrupt("return",O.dialog.confirm({title:d.ZP.t("粘贴提示"),content:d.ZP.t("无法粘贴内容，请试试快捷键 {{value}}+V 。",{value:N().isMac?"⌘":"Ctrl"}),onOk:function(e){return null===e||void 0===e||e.preventDefault(),null===e||void 0===e||e.stopPropagation(),n.g.focus(),!0}}));case 9:if(!(0,P.TQ)(this._app)){e.next=11;break}return e.abrupt("return");case 11:E.default.apiDoPaste(this._app);case 12:case"end":return e.stop()}}),e,this)})))},r.defaultValue={element:I(d.ZP.t("粘贴"),(N().isMac?"⌘":"Ctrl")+"+V"),callback:r.callback},r.disabled=Object.assign({element:I(d.ZP.t("粘贴"),(N().isMac?"⌘":"Ctrl")+"+V")},r.disabledConfig),r}(0,a.Z)(t,e);var r=t.prototype;return r.getConfigInCell=function(e){return V(this,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.isButtonNeedDisabled()){t.next=2;break}return t.abrupt("return",this.disabled);case 2:if(e.canEdit){t.next=4;break}return t.abrupt("return",this._empty);case 4:return t.next=6,this.getConfig();case 6:return t.abrupt("return",t.sent);case 7:case"end":return t.stop()}}),t,this)})))},r.getConfig=function(){return V(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t,n,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._app.feature.getCopyPasteBase();case 2:return t=e.sent,e.next=5,(0,H.S2)();case 5:return n=e.sent,e.next=8,this._app.feature.getCopyPaste();case 8:if(r=e.sent,t.apiJudgeForPaste(this._app,r,n).visable){e.next=12;break}return e.abrupt("return",this._empty);case 12:return e.abrupt("return",this.defaultValue);case 13:case"end":return e.stop()}}),e,this)})))},t}(y),B=n("../packages/model/src/dimension/index.ts"),W=function(e,t,n,r){return new(n||(n=Promise))((function(i,a){function o(e){try{c(r.next(e))}catch(t){a(t)}}function s(e){try{c(r.throw(e))}catch(t){a(t)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,s)}c((r=r.apply(e,t||[])).next())}))},Y=function(e){function t(){var t;return(t=e.apply(this,arguments)||this)._default={text:d.ZP.t("插入复制的单元格"),callback:t._callback.bind((0,u.Z)(t))},t}(0,a.Z)(t,e);var n=t.prototype;return n.getConfigInCell=function(e){return W(this,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.canEdit){t.next=2;break}return t.abrupt("return",this._empty);case 2:return t.next=4,this._getConfig();case 4:return t.abrupt("return",t.sent);case 5:case"end":return t.stop()}}),t,this)})))},n._callback=function(){return W(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._app.feature.getCopyPasteBase();case 2:e.sent.apiInsertCopy(this._app,{cbSucc:function(e){if(e===B.DIMENSION_TYPE.ROWS)try{b.ZP.tdwReport({module:"excel_menu",opername:"doc_excel_editor",action:"clk_insert_copy_row"})}catch(t){}else if(e===B.DIMENSION_TYPE.COLUMNS)try{b.ZP.tdwReport({module:"excel_menu",opername:"doc_excel_editor",action:"clk_insert_copy_col"})}catch(t){}},cbFail:function(){(0,O.showDialog1)(d.ZP.t("提示"),d.ZP.t("无法粘贴，因为复制区域与粘贴区域大小不一致。"))}});case 4:case"end":return e.stop()}}),e,this)})))},n._getConfig=function(){return W(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t,n,r,i,a,o,s,c;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._app.feature.getCopyPaste();case 2:return t=e.sent,e.next=5,this._app.feature.copyPasteBase.apiJudgeForInsertCopy(this._app,t);case 5:if(n=e.sent,r=n.canPaste,i=n.inValid,a=n.isCut,o=n.notSingle,s=n.cacheState,c=n.isSelectPic,!(!r||i||a||o||s.hasDonePaste)){e.next=14;break}return e.abrupt("return",this._empty);case 14:if(!N().isIPad||!c){e.next=16;break}return e.abrupt("return",this._empty);case 16:return e.abrupt("return",this._default);case 17:case"end":return e.stop()}}),e,this)})))},t}(y),G=Y,U=function(e,t,n,r){return new(n||(n=Promise))((function(i,a){function o(e){try{c(r.next(e))}catch(t){a(t)}}function s(e){try{c(r.throw(e))}catch(t){a(t)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,s)}c((r=r.apply(e,t||[])).next())}))},Q=function(e){function t(){var t;return(t=e.apply(this,arguments)||this)._default={text:d.ZP.t("插入剪切的单元格"),callback:t._callback.bind((0,u.Z)(t))},t}(0,a.Z)(t,e);var n=t.prototype;return n.getConfigInCell=function(e){return U(this,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.canEdit){t.next=2;break}return t.abrupt("return",this._empty);case 2:return t.next=4,this._getConfig();case 4:return t.abrupt("return",t.sent);case 5:case"end":return t.stop()}}),t,this)})))},n._callback=function(){return U(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._app.feature.getCopyPasteBase();case 2:e.sent.apiInsertCut(this._app,{cbSucc:function(e){if(e===B.DIMENSION_TYPE.ROWS)try{b.ZP.tdwReport({module:"excel_menu",opername:"doc_excel_editor",action:"clk_insert_cut_row"})}catch(t){}else if(e===B.DIMENSION_TYPE.COLUMNS)try{b.ZP.tdwReport({module:"excel_menu",opername:"doc_excel_editor",action:"clk_insert_cut_col"})}catch(t){}},cbFail:function(){(0,O.showDialog1)(d.ZP.t("提示"),d.ZP.t("无法粘贴，因为复制区域与粘贴区域大小不一致。"))}}),E.default.apiDoPaste(this._app);case 5:case"end":return e.stop()}}),e,this)})))},n._getConfig=function(){return U(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t,n,r,i,a,o,s,c;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._app.feature.getCopyPaste();case 2:return t=e.sent,e.next=5,this._app.feature.copyPasteBase.apiJudgeForInsertCopy(this._app,t);case 5:if(n=e.sent,r=n.canPaste,i=n.inValid,a=n.isCut,o=n.notSingle,s=n.cacheState,c=n.isSelectPic,r&&!i&&a&&!o&&!s.hasDonePaste){e.next=14;break}return e.abrupt("return",this._empty);case 14:if(!N().isIPad||!c){e.next=16;break}return e.abrupt("return",this._empty);case 16:return e.abrupt("return",this._default);case 17:case"end":return e.stop()}}),e,this)})))},t}(y),F=Q,J=(n("../node_modules/core-js/modules/web.dom-collections.for-each.js"),n("../node_modules/core-js/modules/es.array.iterator.js"),n("../node_modules/core-js/modules/es.string.iterator.js"),n("../node_modules/core-js/modules/web.dom-collections.iterator.js"),n("../node_modules/core-js/modules/es.array.filter.js"),n("../spread-sheet/src/base/index.ts")),X=n("../spread-sheet/src/core/feature/copyPaste/lib/PasteSpecial/logics/userAction.ts"),K=n("../spread-sheet/src/core/feature/copyPaste/lib/PasteSpecial/logics/pasteTypes.ts"),q=function(e,t,n,r){return new(n||(n=Promise))((function(i,a){function o(e){try{c(r.next(e))}catch(t){a(t)}}function s(e){try{c(r.throw(e))}catch(t){a(t)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,s)}c((r=r.apply(e,t||[])).next())}))},$=function(e){function t(t,n,r){var i;return(i=e.call(this,t)||this)._callback=function(){return q((0,u.Z)(i),void 0,void 0,regeneratorRuntime.mark((function e(){var t,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(0,P.TQ)(this._app)){e.next=2;break}return e.abrupt("return");case 2:return this._app.emitter.emit("removeRedSpot"),t=this.selectAreaCellRange,n=this._app.feature.copyPaste.copyPasteCache.getCacheData(),e.t0=X.z,e.t1=n,e.t2=this.type,e.t3=t,e.t4=[],e.next=12,this._app.feature.getCopyPaste();case 12:e.t5=e.sent,e.t6={pasteData:e.t1,type:e.t2,pasteRange:e.t3,smartSplitObj:e.t4,copyPaste:e.t5},(0,e.t0)(e.t6),this.report(this.type);case 16:case"end":return e.stop()}}),e,this)})))},i.type=n,i.title=r,i.setDefault(),i._disabled={element:i._default.element,class:"context-menu-disabled"},i}(0,a.Z)(t,e);var n=t.prototype;return n.getConfigInCell=function(e){return q(this,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.canEdit){t.next=2;break}return t.abrupt("return",this._empty);case 2:return t.next=4,this._getConfig();case 4:return t.abrupt("return",t.sent);case 5:case"end":return t.stop()}}),t,this)})))},n.report=function(e){switch(e){case K.jK:b.ZP.tdwReport({module:"copy_paste",opername:"doc_excel_editor",action:"selected_copy_paste_click",ver10:"keep"});case K.RY:b.ZP.tdwReport({module:"copy_paste",opername:"doc_excel_editor",action:"selected_copy_paste_click",ver10:"merge"});case K.Is:b.ZP.tdwReport({module:"copy_paste",opername:"doc_excel_editor",action:"selected_copy_paste_click",ver10:"data"});case K.UU:b.ZP.tdwReport({module:"copy_paste",opername:"doc_excel_editor",action:"selected_copy_paste_click",ver10:"change"});case K.yc:b.ZP.tdwReport({module:"copy_paste",opername:"doc_excel_editor",action:"selected_copy_paste_click",ver10:"clear"})}},n.setDefault=function(){this._default={element:I(this.title,""),callback:this._callback,appendLine:this.type===K.yc||this.type===K.UU}},n._getConfig=function(){return q(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t,n,r,i,a,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._app.feature.getCopyPasteBase();case 2:return t=e.sent,e.next=5,(0,H.S2)();case 5:return n=e.sent,e.next=8,this._app.feature.getCopyPaste();case 8:if(r=e.sent,i=t.apiJudgeForPaste(this._app,r,n),a=i.visable,o=this._app.feature.copyPaste.copyPasteCache.getCacheState(),a){e.next=13;break}return e.abrupt("return",this._empty);case 13:if(this.type!==K.qn&&o.valid){e.next=15;break}return e.abrupt("return",this._disabled);case 15:return e.abrupt("return",this._default);case 16:case"end":return e.stop()}}),e,this)})))},(0,i.Z)(t,[{key:"selectAreaCellRange",get:function(){var e=this._app.view.getSelection();return{xRange:[e.rangeSelections[0].startColIndex,e.rangeSelections[0].endColIndex],yRange:[e.rangeSelections[0].startRowIndex,e.rangeSelections[0].endRowIndex]}}}]),t}(y),ee=$,te=n("react"),ne=n.n(te);function re(){return O.dialog.confirm({title:d.ZP.t("选择性粘贴帮助"),content:ae(),onOk:function(e){return e.preventDefault(),e.stopPropagation(),window.focus(),!0}})}var ie=function(e){var t=document.createElement("div");t.classList.add("specail-paste-error-wrapper");var n=document.createElement("img"),r=document.createTextNode(e);return n.src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTYiIGhlaWdodD0iMTYiIHZpZXdCb3g9IjAgMCAxNiAxNiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48ZyBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPjxwYXRoIGQ9Ik04IDIuNWMxLjUxOSAwIDIuODk0LjYxNiAzLjg4OSAxLjYxMUE1LjQ4MyA1LjQ4MyAwIDAgMSAxMy41IDhhNS40ODMgNS40ODMgMCAwIDEtMS42MTEgMy44ODlBNS40ODMgNS40ODMgMCAwIDEgOCAxMy41YTUuNDgzIDUuNDgzIDAgMCAxLTMuODg5LTEuNjExQTUuNDgzIDUuNDgzIDAgMCAxIDIuNSA4YzAtMS41MTkuNjE2LTIuODk0IDEuNjExLTMuODg5QTUuNDgzIDUuNDgzIDAgMCAxIDggMi41eiIgc3Ryb2tlPSIjQ0JDREQxIi8+PHBhdGggZD0iTTggMTAuODEzYS42MjUuNjI1IDAgMSAxIDAgMS4yNS42MjUuNjI1IDAgMCAxIDAtMS4yNXptMC02LjVjLjY1NiAwIDEuMjc1LjIyNSAxLjc0NC42MzUuNDg3LjQyNy43NTYgMSAuNzU0IDEuNjE0IDAgLjkwNC0uNTk1IDEuNzE2LTEuNTE3IDIuMDdhLjc1NS43NTUgMCAwIDAtLjQ4My43di4zNTVhLjEyNS4xMjUgMCAwIDEtLjEyNS4xMjZoLS43NWEuMTI1LjEyNSAwIDAgMS0uMTI1LS4xMjZ2LS4zMzVhMS43NDYgMS43NDYgMCAwIDEgMS4xMjUtMS42NTNjLjUzMy0uMjA1Ljg3Ny0uNjUuODc3LTEuMTM2IDAtLjY5LS42NzMtMS4yNS0xLjUtMS4yNXMtMS41LjU2LTEuNSAxLjI1di4xMThhLjEyNS4xMjUgMCAwIDEtLjEyNS4xMjVoLS43NWEuMTI1LjEyNSAwIDAgMS0uMTI1LS4xMjV2LS4xMTljMC0uNjE0LjI2OS0xLjE4Ny43NTYtMS42MTRBMi42NDIgMi42NDIgMCAwIDEgOCA0LjMxMnoiIGZpbGw9IiNDQkNERDEiLz48L2c+PC9zdmc+",t.onclick=re,n.classList.add("specail-paste-error-text"),t.appendChild(r),t.appendChild(n),b.ZP.tdwReport({module:"copy_paste",opername:"doc_excel_editor",action:"selected_copy_paste_click",ver10:"quest"}),t},ae=function(){var e=N().isMac?"⌘":"Ctrl";return ne().createElement("div",{style:{maxWidth:"100%"}},ne().createElement("span",null," ",d.ZP.t("若粘贴不成功，请试试快捷键"),d.ZP.t(""+e),d.ZP.t("+V，然后点击右下角")),ne().createElement("img",{className:"specail-paste-error-img",src:"data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjQiIGhlaWdodD0iMjQiIHZpZXdCb3g9IjAgMCAyNCAyNCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cGF0aCBkPSJNMjAgMjFIMTB2LTJINWExIDEgMCAwIDEtMS0xVjZhMSAxIDAgMCAxIDEtMWgxdjFINXYxMmg1VjloNVY2aC0xVjVoMWExIDEgMCAwIDEgMSAxdjNoMWwzIDN2OXptLTQtMTFoLTV2MTBoOHYtN2gtM3YtM3ptMSAuNDE1VjEyaDEuNTg1TDE3IDEwLjQxNXpNMTEgM2ExIDEgMCAwIDEgMSAxdjFoMXYySDdWNWgxVjRhMSAxIDAgMCAxIDEtMWgyem0wIDFIOXYxaDJWNHoiIGZpbGw9IiM0NjRENUEiIGZpbGwtcnVsZT0ibm9uemVybyIvPjwvc3ZnPg=="}),ne().createElement("span",null,d.ZP.t("，进行选择性粘贴。")))},oe=function(e,t,n,r){return new(n||(n=Promise))((function(i,a){function o(e){try{c(r.next(e))}catch(t){a(t)}}function s(e){try{c(r.throw(e))}catch(t){a(t)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,s)}c((r=r.apply(e,t||[])).next())}))},se=function(e){function t(t){var n;return(n=e.call(this,t)||this).default={element:ie(d.ZP.t("选择性粘贴帮助")),callback:function(){return Promise.resolve()}},n.app=t,n}return(0,a.Z)(t,e),t.prototype.getConfigInCell=function(){return oe(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.default);case 1:case"end":return e.stop()}}),e,this)})))},t}(y),ce=n("../spread-sheet/src/external/userGuide/userGuideConfig.ts"),le=function(e,t,n,r){return new(n||(n=Promise))((function(i,a){function o(e){try{c(r.next(e))}catch(t){a(t)}}function s(e){try{c(r.throw(e))}catch(t){a(t)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,s)}c((r=r.apply(e,t||[])).next())}))},ue=K.bX.MERGESTYLES,de=K.bX.ONLYVALUES,he=K.bX.TRANSPOSE,pe=K.bX.KEEPDEFAULT,fe=K.bX.CLEARAUTOPARSE,ve=function(e){function t(t){var n;(n=e.call(this,t)||this).initRedDot(),n.setSubMenu(t),n._app.emitter.once("removeRedSpot",n.clearRedPoint.bind((0,u.Z)(n)));var r=n.setElement();return n._default={element:r},n.disabled=Object.assign({element:r},n.disabledConfig),n}(0,a.Z)(t,e);var n=t.prototype;return n.getConfigInCell=function(e){var t;return le(this,void 0,void 0,regeneratorRuntime.mark((function n(){var r,i=this;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!this.isButtonNeedDisabled()){n.next=2;break}return n.abrupt("return",this.disabled);case 2:if(e.canEdit){n.next=4;break}return n.abrupt("return",this._empty);case 4:if((null===(t=this._default.subMenu)||void 0===t?void 0:t.length)&&(this._default.subMenu=void 0),this._app.view.canvas.normalSelectData){n.next=8;break}throw new Error("未发现选区");case 8:return r=[],this._subMenu.forEach((function(t){r.push(t.getConfigInCell(e))})),n.next=12,Promise.all(r).then((function(e){(e=e.filter((function(e){return null!==e}))).length&&(i._default.subMenu=e)}));case 12:if(!this._default.subMenu){n.next=14;break}return n.abrupt("return",this._default);case 14:return n.abrupt("return",this._empty);case 15:case"end":return n.stop()}}),n,this)})))},n.setElement=function(){var e=this.renderElement();return e.appendChild(m()),e},n.setSubMenu=function(e){this._subMenu=[new ee(e,pe,d.ZP.t("保留源格式")),new ee(e,ue,d.ZP.t("合并格式")),new ee(e,de,d.ZP.t("仅粘贴值")),new ee(e,fe,d.ZP.t("清除自动识别")),new ee(e,he,d.ZP.t("转置行列")),new se(e)]},n.initRedDot=function(){var e=this._app.view.userGuide,n=function(n,r){var i=void 0===r[n];i&&e.setData(n,"true");var a=Date.now()<new Date("2020-11-05").getTime(),o=i||"true"===r[n]&&a;t.showSpecialSelectorDot=o};if(null===e||void 0===e?void 0:e.isInitialized()){var r=e.getData();n(ce.m.pc_specail_paste_red_dot_flag,r)}else J.Z.event.default.one(ce.A.userguideInitialized,(function(e){n(ce.m.pc_specail_paste_red_dot_flag,e)}))},n.clearRedPoint=function(){var e,n,r=this._app.view.userGuide;r&&(r.setData(ce.m.pc_specail_paste_red_dot_flag,"false"),t.showSpecialSelectorDot=!1,null===(n=null===(e=this.icon)||void 0===e?void 0:e.parentNode)||void 0===n||n.removeChild(this.icon))},n.renderElement=function(){var e=document.createElement("div");e.classList.add("paste-special-insert-button-reddot-container");var n=document.createElement("div");n.classList.add("text-container");var r=document.createTextNode(d.ZP.t("选择性粘贴"));return t.showSpecialSelectorDot&&(this.icon=document.createElement("div"),this.icon.classList.add("paste-special-button-reddot"),n.appendChild(this.icon)),n.appendChild(r),e.appendChild(n),e},t}(y),ge=n("../spread-sheet/src/base/util/appConfig.ts"),me=function(e,t,n,r){return new(n||(n=Promise))((function(i,a){function o(e){try{c(r.next(e))}catch(t){a(t)}}function s(e){try{c(r.throw(e))}catch(t){a(t)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,s)}c((r=r.apply(e,t||[])).next())}))},xe=function(e){function t(){var t;return(t=e.apply(this,arguments)||this).getDefault=function(){return{element:t.getRedButtonContent(d.ZP.t("复制为图片")),callback:t.callback}},t.callback=function(){return me((0,u.Z)(t),void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:E.default.apiDoRangeToImgCopy(this._app);case 1:case"end":return e.stop()}}),e,this)})))},t}(0,a.Z)(t,e);var n=t.prototype;return n.getConfigInCell=function(e){return me(this,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.canCopy||this._app.sheetStatus.containsCanNotReadRange()){t.next=3;break}return t.abrupt("return",this.getDefault());case 3:return t.abrupt("return",this._empty);case 4:case"end":return t.stop()}}),t,this)})))},n.getRedButtonContent=function(e){var t=document.createElement("div");t.classList.add("reddot-container");var n=document.createElement("div");n.classList.add("text-container");var r=document.createTextNode(e);return n.appendChild(r),t.appendChild(n),t},t}(y),ye=xe,we=function(e){function t(t){var n=[k,L,ye,z,G,F];return ge.Z.getConfig("contextMenu.pasteSpecialCombine")&&n.push(ve),e.call.apply(e,[this,t].concat(n))||this}return(0,a.Z)(t,e),t}(l),be=(n("../node_modules/core-js/modules/es.number.constructor.js"),function(){function e(){this.dom=this.initDom(),this.bindEvent()}var t=e.prototype;return t.initDom=function(){var e=document.createElement("input");return e.style.border="none",e.style.width="34px",e.style.height="18px",e.style.border="1px solid #dddddd",e.style.borderRadius="2px",e.style.textAlign="center",e.style.margin="0 10px",e},t.bindEvent=function(){var e=this;this.dom.addEventListener("click",(function(e){e.preventDefault(),e.stopPropagation()})),this.dom.addEventListener("dblclick",(function(e){e.preventDefault(),e.stopPropagation()})),this.dom.addEventListener("touchstart",(function(t){t.preventDefault(),t.stopPropagation(),e.dom.focus()})),this.dom.addEventListener("focus",(function(){e.dom.select(),e.dom.style.border="1px solid #0188fb"})),this.dom.addEventListener("blur",(function(){e.dom.style.border="1px solid #dddddd"})),this.dom.addEventListener("input",(function(t){var n=t.target.value;/^[0-9]+$/.test(n)||(n=void 0===n||""===n?"":e.defaultValue||"1"),Number(n)>999&&(n="999"),e.dom.value=n})),this.dom.addEventListener("keydown",(function(e){13===e.keyCode||e.stopPropagation()})),this.dom.addEventListener("mouseup",(function(e){e.preventDefault()}))},t.getValue=function(){return this.dom.value},t.setType=function(e){["button","checkbox","file","hidden","image","password","radio","reset","submit","text","number"].indexOf(e)>-1?this.dom.type=e:this.dom.type="text"},t.setValue=function(e){isNaN(Number(e))||(this.dom.value=e,this.defaultValue=e)},e}()),Ce=n("../spread-sheet/src/core/view/level-1/select-center/base/selection/AllSelection.ts"),_e=n("../packages/model/src/config/index.ts");function Ie(e,t){for(var n=e.selectAll?0:e.yRange[0],r=e.selectAll?t.getRowCount()-1:e.yRange[1],i=0;n<=r;n++)t.data.isRowHidden(n)||(i+=1);return i}function Me(e,t){var n;n=e instanceof Ce.Z?0:e.yRange[0]>0?e.yRange[0]-1:0;var r=f.Z.newInstance(n,n);return!t.checkRowRangeCanEdit(r)}function Se(e,t,n){var r;r=e instanceof Ce.Z?n.getRowCount():e.yRange[1]+1;var i=f.Z.newInstance(r,r);return!t.checkRowRangeCanEdit(i)}function je(e,t,n,r){var i=e.view.canvas.normalSelectData.selectQueue[0],a=e.spreadsheet.activeSheet.getRowCount(),o=e.spreadsheet.activeSheet.getColCount();t<=0||isNaN(t)||((a+t)*o<=_e.MAX_CELL_COUNT?(e.view.canvas.modifyDimensionBroker.insertRow([{index:n,amount:t}]),e.view.canvas.modifySelectionBroker.setSelection({yRange:[n,n+t-1],activation:{row:n,col:e.view.canvas.normalSelectData.activeCol}})):O.dialog.confirm({title:d.ZP.t("插入行列失败"),content:d.ZP.t("已达最大行列限制，建议删除无用行列或新建一个工作表。")}),function(e,t,n,r){if(e.selectRow&&r-n===0){var i=t>1?"more":"one";b.ZP.tdwReport({module:"excel_menu",opername:"doc_excel_editor",action:"insert_"+i+"_row"})}else e.selectRow&&r-n>0?b.ZP.tdwReport({module:"excel_menu",opername:"doc_excel_editor",action:"select_insert_more_row"}):b.ZP.tdwReport({module:"excel_menu",opername:"doc_excel_editor",action:"select_cell_insert_row"});t!==r-n+1&&b.ZP.tdwReport({module:"excel_menu",opername:"doc_excel_editor",action:"type_insert_col"})}(i,t,n,r))}var De=function(e,t,n,r){return new(n||(n=Promise))((function(i,a){function o(e){try{c(r.next(e))}catch(t){a(t)}}function s(e){try{c(r.throw(e))}catch(t){a(t)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,s)}c((r=r.apply(e,t||[])).next())}))},Ee=function(e){function t(t){var n;(n=e.call(this,t)||this)._callback=function(){return De((0,u.Z)(n),void 0,void 0,regeneratorRuntime.mark((function e(){var t,n,r,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=this._app.view.canvas.normalSelectData.selectQueue[0],n=t.yRange?t.yRange[1]+1:this._app.spreadsheet.activeSheet.getRowCount(),r=t.yRange?t.yRange[1]:this._app.spreadsheet.activeSheet.getRowCount()-1,i=Number(this._input.dom.value),je(this._app,i,n,r);case 5:case"end":return e.stop()}}),e,this)})))};var r=document.createElement("div"),i=document.createTextNode(d.ZP.t("在下方插入")),a=document.createElement("div"),o=new be,s=document.createTextNode(d.ZP.t("INSERT_ROW_BELOW"));return o.dom.style.fontSize="12px",o.dom.style.fontWeight="normal",a.style.cssFloat="right",a.appendChild(o.dom),a.appendChild(s),r.appendChild(i),r.appendChild(a),n._input=o,n._default={element:r,callback:n._callback},n.disabled=Object.assign({element:r},n.disabledConfig),n}return(0,a.Z)(t,e),t.prototype.getConfigInCell=function(){return De(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t,n,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._app.sheetStatus.canEditExceptRangeStatus){e.next=2;break}return e.abrupt("return",this._empty);case 2:if((t=this._app.view.canvas).normalSelectData){e.next=5;break}throw new Error("未发现选区");case 5:if(1===(n=t.normalSelectData.selectQueue).length){e.next=8;break}return e.abrupt("return",this._empty);case 8:if(!(r=n[0]).selectCol){e.next=11;break}return e.abrupt("return",this._empty);case 11:if(!Se(r,this,this._app.spreadsheet.activeSheet)){e.next=13;break}return e.abrupt("return",this.disabled);case 13:return this._input.dom.value=String(Ie(r,this._app.spreadsheet.activeSheet)),e.abrupt("return",this._default);case 15:case"end":return e.stop()}}),e,this)})))},t}(y),Te=Ee,Ne=function(e,t,n,r){return new(n||(n=Promise))((function(i,a){function o(e){try{c(r.next(e))}catch(t){a(t)}}function s(e){try{c(r.throw(e))}catch(t){a(t)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,s)}c((r=r.apply(e,t||[])).next())}))},Pe=function(e){function t(t){var n;(n=e.call(this,t)||this)._callback=function(){return Ne((0,u.Z)(n),void 0,void 0,regeneratorRuntime.mark((function e(){var t,n,r,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=this._app.view.canvas.normalSelectData.selectQueue[0],n=t.yRange?t.yRange[0]:0,r=t.yRange?t.yRange[1]:this._app.spreadsheet.activeSheet.getRowCount()-1,i=Number(this._input.dom.value),je(this._app,i,n,r);case 5:case"end":return e.stop()}}),e,this)})))};var r=document.createElement("div"),i=document.createTextNode(d.ZP.t("在上方插入")),a=document.createElement("div"),o=new be,s=document.createTextNode(d.ZP.t("INSERT_ROW_ABOVE"));return a.appendChild(o.dom),a.appendChild(s),a.style.cssFloat="right",o.dom.style.fontSize="12px",o.dom.style.fontWeight="normal",r.appendChild(i),r.appendChild(a),n._input=o,n._default={element:r,callback:n._callback},n.disabled=Object.assign({element:r},n.disabledConfig),n}return(0,a.Z)(t,e),t.prototype.getConfigInCell=function(){return Ne(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t,n,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._app.sheetStatus.canEditExceptRangeStatus){e.next=2;break}return e.abrupt("return",this._empty);case 2:if((t=this._app.view.canvas).normalSelectData){e.next=5;break}throw new Error("未发现选区");case 5:if(1===(n=t.normalSelectData.selectQueue).length){e.next=8;break}return e.abrupt("return",this._empty);case 8:if(!(r=n[0]).selectCol){e.next=11;break}return e.abrupt("return",this._empty);case 11:if(!Me(r,this)){e.next=13;break}return e.abrupt("return",this.disabled);case 13:return this._input.dom.value=String(Ie(r,this._app.spreadsheet.activeSheet)),e.abrupt("return",this._default);case 15:case"end":return e.stop()}}),e,this)})))},t}(y),Re=Pe,ke=function(e,t,n,r){return new(n||(n=Promise))((function(i,a){function o(e){try{c(r.next(e))}catch(t){a(t)}}function s(e){try{c(r.throw(e))}catch(t){a(t)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,s)}c((r=r.apply(e,t||[])).next())}))},Ae=function(e){function t(t){var n;return(n=e.call(this,t)||this)._callback=function(){return ke((0,u.Z)(n),void 0,void 0,regeneratorRuntime.mark((function e(){var t,n,r,i,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=this._app.view.canvas.normalSelectData.selectQueue,n=[],r=0;case 3:if(!(r<t.length)){e.next=12;break}if((i=t[r]).selectRow){e.next=7;break}throw new Error("非法执行隐藏行");case 7:a=i.yRange,n.push({index:a[0],amount:a[1]-a[0]+1});case 9:r++,e.next=3;break;case 12:this._app.view.canvas.modifyDimensionBroker.hideRows(n);case 13:case"end":return e.stop()}}),e,this)})))},n._default={element:I(d.ZP.t("隐藏行"),(N().isMac?"⌘+⌥":"Ctrl+Alt")+"+9"),callback:n._callback},n.disabled=Object.assign({element:I(d.ZP.t("隐藏行"),(N().isMac?"⌘+⌥":"Ctrl+Alt")+"+9")},n.disabledConfig),n}return(0,a.Z)(t,e),t.prototype.getConfigInCell=function(e){return ke(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n,r,i,a;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if((n=this._app.view.canvas).normalSelectData){t.next=3;break}throw new Error("未发现选区");case 3:if(0!==(r=n.normalSelectData.selectQueue).length){t.next=6;break}return t.abrupt("return",this._empty);case 6:i=0;case 7:if(!(i<r.length)){t.next=14;break}if(!((a=r[i]).selectAll||a.selectCell||a.selectCol)){t.next=11;break}return t.abrupt("return",this._empty);case 11:i++,t.next=7;break;case 14:if(!this.isButtonNeedDisabled()){t.next=16;break}return t.abrupt("return",this.disabled);case 16:if(e.canEdit){t.next=18;break}return t.abrupt("return",this._empty);case 18:return t.abrupt("return",this._default);case 19:case"end":return t.stop()}}),t,this)})))},t}(y),Ze=function(e,t,n,r){return new(n||(n=Promise))((function(i,a){function o(e){try{c(r.next(e))}catch(t){a(t)}}function s(e){try{c(r.throw(e))}catch(t){a(t)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,s)}c((r=r.apply(e,t||[])).next())}))},Le=function(e){function t(t){var n;return(n=e.call(this,t)||this)._callback=function(){return Ze((0,u.Z)(n),void 0,void 0,regeneratorRuntime.mark((function e(){var t,n,r,i,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=this._app.view.canvas.normalSelectData.selectQueue,n=[],r=0;case 3:if(!(r<t.length)){e.next=12;break}if((i=t[r]).selectRow){e.next=7;break}throw new Error("非法执行显示行");case 7:a=i.yRange,n.push({index:a[0],amount:a[1]-a[0]+1});case 9:r++,e.next=3;break;case 12:this._app.view.canvas.modifyDimensionBroker.showRows(n);case 13:case"end":return e.stop()}}),e,this)})))},n._default={element:I(d.ZP.t("取消隐藏行"),(N().isMac?"⌥+⇧":"Alt+Shift")+"+9"),callback:n._callback},n.disabled=Object.assign({element:I(d.ZP.t("取消隐藏行"),(N().isMac?"⌥+⇧":"Alt+Shift")+"+9")},n.disabledConfig),n}return(0,a.Z)(t,e),t.prototype.getConfigInCell=function(e){return Ze(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n,r,i,a;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if((n=this._app.view.canvas).normalSelectData){t.next=3;break}throw new Error("未发现选区");case 3:if(!(0===(r=n.normalSelectData.selectQueue).length||r.length>1)){t.next=6;break}return t.abrupt("return",this._empty);case 6:if((i=r[0]).selectRow){t.next=9;break}return t.abrupt("return",this._empty);case 9:if(!this.isButtonNeedDisabled()){t.next=11;break}return t.abrupt("return",this.disabled);case 11:if(e.canEdit){t.next=13;break}return t.abrupt("return",this._empty);case 13:a=i.yRange[0];case 14:if(!(a<i.yRange[1])){t.next=20;break}if(!this._app.spreadsheet.activeSheet.isRowHiddenByUser(a)){t.next=17;break}return t.abrupt("return",this._default);case 17:a++,t.next=14;break;case 20:return t.abrupt("return",this._empty);case 21:case"end":return t.stop()}}),t,this)})))},t}(y),Oe=function(e,t,n,r){return new(n||(n=Promise))((function(i,a){function o(e){try{c(r.next(e))}catch(t){a(t)}}function s(e){try{c(r.throw(e))}catch(t){a(t)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,s)}c((r=r.apply(e,t||[])).next())}))},He=function(e){function t(t){var n;return(n=e.call(this,t)||this)._callback=function(){return Oe((0,u.Z)(n),void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this._app.view.canvas.modifyDimensionBroker.showDialogForRowsSetting();case 1:case"end":return e.stop()}}),e,this)})))},n._default={text:d.ZP.t("设置行高"),callback:n._callback},n.disabled=Object.assign({text:d.ZP.t("设置行高")},n.disabledConfig),n}return(0,a.Z)(t,e),t.prototype.getConfigInCell=function(e){return Oe(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n,r,i,a;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if((n=this._app.view.canvas).normalSelectData){t.next=3;break}throw new Error("未发现选区");case 3:if(0!==(r=n.normalSelectData.selectQueue).length){t.next=6;break}return t.abrupt("return",this._empty);case 6:i=0;case 7:if(!(i<r.length)){t.next=14;break}if(!(a=r[i]).selectCell&&!a.selectCol){t.next=11;break}return t.abrupt("return",this._empty);case 11:i++,t.next=7;break;case 14:if(!this.isButtonNeedDisabled()){t.next=16;break}return t.abrupt("return",this.disabled);case 16:if(e.canEdit){t.next=18;break}return t.abrupt("return",this._empty);case 18:return t.abrupt("return",this._default);case 19:case"end":return t.stop()}}),t,this)})))},t}(y),Ve=function(e,t,n,r){return new(n||(n=Promise))((function(i,a){function o(e){try{c(r.next(e))}catch(t){a(t)}}function s(e){try{c(r.throw(e))}catch(t){a(t)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,s)}c((r=r.apply(e,t||[])).next())}))},ze=function(e){function t(t){var n;return(n=e.call(this,t)||this)._callback=function(){return Ve((0,u.Z)(n),void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this._app.view.canvas.modifyDimensionBroker.removeRow(),b.ZP.tdwReport({module:"excel_menu",opername:"doc_excel_editor",action:"clk_del_row"});case 2:case"end":return e.stop()}}),e,this)})))},n._default={text:d.ZP.t("删除所在行"),callback:n._callback},n.disabled=Object.assign({text:d.ZP.t("删除所在行")},n.disabledConfig),n}return(0,a.Z)(t,e),t.prototype.getConfigInCell=function(){return Ve(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t,n,r,i,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._app.sheetStatus.canEditExceptRangeStatus){e.next=2;break}return e.abrupt("return",this._empty);case 2:if((t=this._app.view.canvas).normalSelectData){e.next=5;break}throw new Error("未发现选区");case 5:if(0!==(n=t.normalSelectData.selectQueue).length){e.next=8;break}return e.abrupt("return",this._empty);case 8:r=0;case 9:if(!(r<n.length)){e.next=20;break}if(!(i=n[r]).selectCol&&!i.selectAll){e.next=13;break}return e.abrupt("return",this._empty);case 13:if(a=f.Z.newInstance(i.yRange[0],i.yRange[1]),this.checkRowRangeCanEdit(a)){e.next=17;break}return e.abrupt("return",this.disabled);case 17:r++,e.next=9;break;case 20:return e.abrupt("return",this._default);case 21:case"end":return e.stop()}}),e,this)})))},t}(y),Be=function(e){function t(t){return e.call(this,t,Re,Te,Ae,Le,He,ze)||this}return(0,a.Z)(t,e),t}(l);function We(e,t){for(var n=e.selectAll?0:e.xRange[0],r=e.selectAll?t.getColCount()-1:e.xRange[1],i=0;n<=r;n++)t.data.isColHidden(n)||(i+=1);return i}function Ye(e,t){var n,r;e instanceof Ce.Z?(n=0,r=0):(n=e.xRange[0]>0?e.xRange[0]-1:0,r=e.xRange[0]);var i=v.Z.newInstance(n,n),a=t.checkColRangeCanEdit(i),o=t.checkColRangeCanEdit(v.Z.newInstance(r,r));return!a&&!o}function Ge(e,t,n){var r,i;if(e instanceof Ce.Z){var a=n.getColCount();r=a,i=a}else i=e.xRange[1],r=e.xRange[1]+1;var o=v.Z.newInstance(r,r),s=t.checkColRangeCanEdit(o),c=t.checkColRangeCanEdit(v.Z.newInstance(i,i));return!s&&!c}function Ue(e,t,n,r){var i=e.view.canvas.normalSelectData.selectQueue[0],a=e.spreadsheet.activeSheet.getRowCount(),o=e.spreadsheet.activeSheet.getColCount();if(!(t<=0||isNaN(t))){if((o+t)*a<=_e.MAX_CELL_COUNT){if((0,P.cV)(e,"insert",n))return;e.view.canvas.modifyDimensionBroker.insertCol([{index:n,amount:t}]),e.view.canvas.modifySelectionBroker.setSelection({xRange:[n,n+t-1],activation:{col:n,row:e.view.canvas.normalSelectData.activeRow}})}else O.dialog.confirm({title:d.ZP.t("插入行列失败"),content:d.ZP.t("已达最大行列限制，建议删除无用行列或新建一个工作表。")});!function(e,t,n,r){if(e.selectCol&&r-n===0){var i=t>1?"more":"one";b.ZP.tdwReport({module:"excel_menu",opername:"doc_excel_editor",action:"insert_"+i+"_col"})}else e.selectCol&&r-n>0?b.ZP.tdwReport({module:"excel_menu",opername:"doc_excel_editor",action:"select_insert_more_col"}):b.ZP.tdwReport({module:"excel_menu",opername:"doc_excel_editor",action:"select_cell_insert_col"});t!==r-n+1&&b.ZP.tdwReport({module:"excel_menu",opername:"doc_excel_editor",action:"type_insert_row"})}(i,t,n,r)}}var Qe,Fe=function(e,t,n,r){return new(n||(n=Promise))((function(i,a){function o(e){try{c(r.next(e))}catch(t){a(t)}}function s(e){try{c(r.throw(e))}catch(t){a(t)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,s)}c((r=r.apply(e,t||[])).next())}))},Je=function(e){function t(t){var n;(n=e.call(this,t)||this)._callback=function(){return Fe((0,u.Z)(n),void 0,void 0,regeneratorRuntime.mark((function e(){var t,n,r,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=this._app.view.canvas.normalSelectData.selectQueue[0],n=Number(this._input.dom.value),r=t.xRange?t.xRange[0]:0,i=t.xRange?t.xRange[1]:this._app.spreadsheet.activeSheet.getColCount()-1,Ue(this._app,n,r,i);case 5:case"end":return e.stop()}}),e,this)})))};var r=document.createElement("div"),i=document.createTextNode(d.ZP.t("在左侧插入")),a=document.createElement("div"),o=new be,s=document.createTextNode(d.ZP.t("INSERT_COL_LEFT"));return a.style.cssFloat="right",o.dom.style.fontSize="12px",o.dom.style.fontWeight="normal",a.appendChild(o.dom),a.appendChild(s),r.appendChild(i),r.appendChild(a),n._input=o,n._default={element:r,callback:n._callback},n.disabled=Object.assign({element:r},n.disabledConfig),n}return(0,a.Z)(t,e),t.prototype.getConfigInCell=function(){return Fe(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t,n,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._app.sheetStatus.canEditExceptRangeStatus){e.next=2;break}return e.abrupt("return",this._empty);case 2:if((t=this._app.view.canvas).normalSelectData){e.next=5;break}throw new Error("未发现选区");case 5:if(1===(n=t.normalSelectData.selectQueue).length){e.next=8;break}return e.abrupt("return",this._empty);case 8:if(!(r=n[0]).selectRow){e.next=11;break}return e.abrupt("return",this._empty);case 11:if(!Ye(r,this)){e.next=13;break}return e.abrupt("return",this.disabled);case 13:return this._input.dom.value=String(We(r,this._app.spreadsheet.activeSheet)),e.abrupt("return",this._default);case 15:case"end":return e.stop()}}),e,this)})))},t}(y),Xe=Je,Ke=function(e,t,n,r){return new(n||(n=Promise))((function(i,a){function o(e){try{c(r.next(e))}catch(t){a(t)}}function s(e){try{c(r.throw(e))}catch(t){a(t)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,s)}c((r=r.apply(e,t||[])).next())}))},qe=function(e){function t(t){var n;(n=e.call(this,t)||this)._callback=function(){return Ke((0,u.Z)(n),void 0,void 0,regeneratorRuntime.mark((function e(){var t,n,r,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=this._app.view.canvas.normalSelectData.selectQueue[0],n=Number(this._input.dom.value),r=t.xRange?t.xRange[1]+1:this._app.spreadsheet.activeSheet.getColCount(),i=t.xRange?t.xRange[1]:this._app.spreadsheet.activeSheet.getColCount()-1,Ue(this._app,n,r,i);case 5:case"end":return e.stop()}}),e,this)})))};var r=document.createElement("div"),i=document.createTextNode(d.ZP.t("在右侧插入")),a=document.createElement("div"),o=new be,s=document.createTextNode(d.ZP.t("INSERT_COL_RIGHT"));return a.style.cssFloat="right",o.dom.style.fontSize="12px",o.dom.style.fontWeight="normal",a.appendChild(o.dom),a.appendChild(s),r.appendChild(i),r.appendChild(a),n._input=o,n._default={element:r,callback:n._callback},n.disabled=Object.assign({element:r},n.disabledConfig),n}return(0,a.Z)(t,e),t.prototype.getConfigInCell=function(){return Ke(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t,n,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._app.sheetStatus.canEditExceptRangeStatus){e.next=2;break}return e.abrupt("return",this._empty);case 2:if((t=this._app.view.canvas).normalSelectData){e.next=5;break}throw new Error("未发现选区");case 5:if(1===(n=t.normalSelectData.selectQueue).length){e.next=8;break}return e.abrupt("return",this._empty);case 8:if(!(r=n[0]).selectRow){e.next=11;break}return e.abrupt("return",this._empty);case 11:if(!Ge(r,this,this._app.spreadsheet.activeSheet)){e.next=13;break}return e.abrupt("return",this.disabled);case 13:return this._input.dom.value=String(We(r,this._app.spreadsheet.activeSheet)),e.abrupt("return",this._default);case 15:case"end":return e.stop()}}),e,this)})))},t}(y),$e=qe,et=function(e,t,n,r){return new(n||(n=Promise))((function(i,a){function o(e){try{c(r.next(e))}catch(t){a(t)}}function s(e){try{c(r.throw(e))}catch(t){a(t)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,s)}c((r=r.apply(e,t||[])).next())}))},tt=function(e){function t(t){var n;return(n=e.call(this,t)||this)._callback=function(){return et((0,u.Z)(n),void 0,void 0,regeneratorRuntime.mark((function e(){var t,n,r,i,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=this._app.view.canvas.normalSelectData.selectQueue,n=[],r=0;case 3:if(!(r<t.length)){e.next=12;break}if((i=t[r]).selectCol){e.next=7;break}throw new Error("非法执行隐藏列");case 7:a=i.xRange,n.push({index:a[0],amount:a[1]-a[0]+1});case 9:r++,e.next=3;break;case 12:this._app.view.canvas.modifyDimensionBroker.hideCols(n);case 13:case"end":return e.stop()}}),e,this)})))},n._default={element:I(d.ZP.t("隐藏列"),(N().isMac?"⌘+⌥":"Ctrl+Alt")+"+0"),callback:n._callback},n.disabled=Object.assign({element:I(d.ZP.t("隐藏列"),(N().isMac?"⌘+⌥":"Ctrl+Alt")+"+0")},n.disabledConfig),n}return(0,a.Z)(t,e),t.prototype.getConfigInCell=function(e){return et(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n,r,i,a;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if((n=this._app.view.canvas).normalSelectData){t.next=3;break}throw new Error("未发现选区");case 3:if(0!==(r=n.normalSelectData.selectQueue).length){t.next=6;break}return t.abrupt("return",this._empty);case 6:i=0;case 7:if(!(i<r.length)){t.next=14;break}if(!((a=r[i]).selectAll||a.selectCell||a.selectRow)){t.next=11;break}return t.abrupt("return",this._empty);case 11:i++,t.next=7;break;case 14:if(!this.isButtonNeedDisabled()){t.next=16;break}return t.abrupt("return",this.disabled);case 16:if(e.canEdit){t.next=18;break}return t.abrupt("return",this._empty);case 18:return t.abrupt("return",this._default);case 19:case"end":return t.stop()}}),t,this)})))},t}(y),nt=function(e,t,n,r){return new(n||(n=Promise))((function(i,a){function o(e){try{c(r.next(e))}catch(t){a(t)}}function s(e){try{c(r.throw(e))}catch(t){a(t)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,s)}c((r=r.apply(e,t||[])).next())}))},rt=function(e){function t(t){var n;return(n=e.call(this,t)||this)._callback=function(){return nt((0,u.Z)(n),void 0,void 0,regeneratorRuntime.mark((function e(){var t,n,r,i,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=this._app.view.canvas.normalSelectData.selectQueue,n=[],r=0;case 3:if(!(r<t.length)){e.next=12;break}if((i=t[r]).selectCol){e.next=7;break}throw new Error("非法执行显示列");case 7:a=i.xRange,n.push({index:a[0],amount:a[1]-a[0]+1});case 9:r++,e.next=3;break;case 12:this._app.view.canvas.modifyDimensionBroker.showCols(n);case 13:case"end":return e.stop()}}),e,this)})))},n._default={element:I(d.ZP.t("取消隐藏列"),(N().isMac?"⌥+⇧":"Alt+Shift")+"+0"),callback:n._callback},n.disabled=Object.assign({element:I(d.ZP.t("取消隐藏列"),(N().isMac?"⌥+⇧":"Alt+Shift")+"+0")},n.disabledConfig),n}return(0,a.Z)(t,e),t.prototype.getConfigInCell=function(e){return nt(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n,r,i,a;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if((n=this._app.view.canvas).normalSelectData){t.next=3;break}throw new Error("未发现选区");case 3:if(!(0===(r=n.normalSelectData.selectQueue).length||r.length>1)){t.next=6;break}return t.abrupt("return",this._empty);case 6:if((i=r[0]).selectCol){t.next=9;break}return t.abrupt("return",this._empty);case 9:if(!this.isButtonNeedDisabled()){t.next=11;break}return t.abrupt("return",this.disabled);case 11:if(e.canEdit){t.next=13;break}return t.abrupt("return",this._empty);case 13:a=i.xRange[0];case 14:if(!(a<i.xRange[1])){t.next=20;break}if(!this._app.spreadsheet.activeSheet.isColHiddenByUser(a)){t.next=17;break}return t.abrupt("return",this._default);case 17:a++,t.next=14;break;case 20:return t.abrupt("return",this._empty);case 21:case"end":return t.stop()}}),t,this)})))},t}(y),it=function(e,t,n,r){return new(n||(n=Promise))((function(i,a){function o(e){try{c(r.next(e))}catch(t){a(t)}}function s(e){try{c(r.throw(e))}catch(t){a(t)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,s)}c((r=r.apply(e,t||[])).next())}))},at=function(e){function t(t){var n;return(n=e.call(this,t)||this)._callback=function(){return it((0,u.Z)(n),void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this._app.view.canvas.modifyDimensionBroker.showDialogForColsSetting();case 1:case"end":return e.stop()}}),e,this)})))},n._default={text:d.ZP.t("设置列宽"),callback:n._callback},n.disabled=Object.assign({text:d.ZP.t("设置列宽")},n.disabledConfig),n}return(0,a.Z)(t,e),t.prototype.getConfigInCell=function(e){return it(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n,r,i,a;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if((n=this._app.view.canvas).normalSelectData){t.next=3;break}throw new Error("未发现选区");case 3:if(0!==(r=n.normalSelectData.selectQueue).length){t.next=6;break}return t.abrupt("return",this._empty);case 6:i=0;case 7:if(!(i<r.length)){t.next=14;break}if(!(a=r[i]).selectCell&&!a.selectRow){t.next=11;break}return t.abrupt("return",this._empty);case 11:i++,t.next=7;break;case 14:if(!this.isButtonNeedDisabled()){t.next=16;break}return t.abrupt("return",this.disabled);case 16:if(e.canEdit){t.next=18;break}return t.abrupt("return",this._empty);case 18:return t.abrupt("return",this._default);case 19:case"end":return t.stop()}}),t,this)})))},t}(y),ot=function(e,t,n,r){return new(n||(n=Promise))((function(i,a){function o(e){try{c(r.next(e))}catch(t){a(t)}}function s(e){try{c(r.throw(e))}catch(t){a(t)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,s)}c((r=r.apply(e,t||[])).next())}))},st=function(e){function t(t){var n;return(n=e.call(this,t)||this)._callback=function(){return ot((0,u.Z)(n),void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this._app.view.canvas.modifyDimensionBroker.removeCol(),b.ZP.tdwReport({module:"excel_menu",opername:"doc_excel_editor",action:"clk_del_col"});case 2:case"end":return e.stop()}}),e,this)})))},n._default={text:d.ZP.t("删除所在列"),callback:n._callback},n.disabled=Object.assign({text:d.ZP.t("删除所在列")},n.disabledConfig),n}return(0,a.Z)(t,e),t.prototype.getConfigInCell=function(){return ot(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t,n,r,i,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._app.sheetStatus.canEditExceptRangeStatus){e.next=2;break}return e.abrupt("return",this._empty);case 2:if((t=this._app.view.canvas).normalSelectData){e.next=5;break}throw new Error("未发现选区");case 5:if(0!==(n=t.normalSelectData.selectQueue).length){e.next=8;break}return e.abrupt("return",this._empty);case 8:r=0;case 9:if(!(r<n.length)){e.next=20;break}if(!(i=n[r]).selectRow&&!i.selectAll){e.next=13;break}return e.abrupt("return",this._empty);case 13:if(a=v.Z.newInstance(i.xRange[0],i.xRange[1]),this.checkColRangeCanEdit(a)){e.next=17;break}return e.abrupt("return",this.disabled);case 17:r++,e.next=9;break;case 20:return e.abrupt("return",this._default);case 21:case"end":return e.stop()}}),e,this)})))},t}(y),ct=function(e){function t(t){return e.call(this,t,Xe,$e,tt,rt,at,st)||this}return(0,a.Z)(t,e),t}(l),lt=(n("../node_modules/core-js/modules/es.array.splice.js"),n("../spread-sheet/src/core/utils/selection.ts")),ut=n("../spread-sheet/src/core/data/configService/spreadConfig.ts"),dt=function(e,t,n,r){return new(n||(n=Promise))((function(i,a){function o(e){try{c(r.next(e))}catch(t){a(t)}}function s(e){try{c(r.throw(e))}catch(t){a(t)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,s)}c((r=r.apply(e,t||[])).next())}))};!function(e){e[e.EMPTY=0]="EMPTY",e[e.MERGED=1]="MERGED",e[e.FORBID=2]="FORBID"}(Qe||(Qe={}));var ht,pt=function(e){function t(t){var n;return(n=e.call(this,t)||this)._callback=function(){return dt((0,u.Z)(n),void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((0,lt.hasMergeCell)(this._app)){this._app.requestApi.unmergeCells();try{b.ZP.tdwReport({module:"excel_menu",opername:"doc_excel_editor",action:"clk_menu_unmerge"})}catch(t){}}else{this._app.requestApi.mergeCells();try{b.ZP.tdwReport({module:"excel_menu",opername:"doc_excel_editor",action:"clk_menu_merge"})}catch(t){}}case 2:case"end":return e.stop()}}),e,this)})))},n._mergeConfig={element:I(d.ZP.t("合并单元格"),(N().isMac?"⌥+⇧":"Alt+Shift")+"+D"),callback:n._callback},n._unmergeConfig={element:I(d.ZP.t("取消合并单元格"),(N().isMac?"⌥+⇧":"Alt+Shift")+"+D"),callback:n._callback},n.disabledMerge=Object.assign({element:I(d.ZP.t("合并单元格"),(N().isMac?"⌥+⇧":"Alt+Shift")+"+D")},n.disabledConfig),n.disabledUnMerge=Object.assign({element:I(d.ZP.t("取消合并单元格"),(N().isMac?"⌥+⇧":"Alt+Shift")+"+D")},n.disabledConfig),n}(0,a.Z)(t,e);var n=t.prototype;return n.getConfigInCell=function(e){return dt(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=this._getState(),!this.isButtonNeedDisabled()){t.next=6;break}if(n!==Qe.EMPTY){t.next=4;break}return t.abrupt("return",this.disabledMerge);case 4:if(n!==Qe.MERGED){t.next=6;break}return t.abrupt("return",this.disabledUnMerge);case 6:if(e.canEdit){t.next=8;break}return t.abrupt("return",this._empty);case 8:t.t0=n,t.next=t.t0===Qe.EMPTY?11:t.t0===Qe.MERGED?12:t.t0===Qe.FORBID?13:14;break;case 11:return t.abrupt("return",this._mergeConfig);case 12:return t.abrupt("return",this._unmergeConfig);case 13:return t.abrupt("return",this._empty);case 14:case"end":return t.stop()}}),t,this)})))},n._getState=function(){var e=w.Z.selection.hasMergeCell(this._app);return!this._app.view.canvas.normalSelectData.select||this._app.view.canvas.normalSelectData.select.selectAll||w.Z.selection.singleRange(this._app)&&!e?Qe.FORBID:e?Qe.MERGED:!ut.q.getConfig("isOwner")&&this._app.sheetStatus.containsPrivateRange()?Qe.FORBID:Qe.EMPTY},t}(y),ft=n("../spread-sheet/src/core/behavior/request/range/config.ts"),vt=n("../spread-sheet/src/core/behavior/request/range/common/index.ts"),gt=function(e,t,n,r){return new(n||(n=Promise))((function(i,a){function o(e){try{c(r.next(e))}catch(t){a(t)}}function s(e){try{c(r.throw(e))}catch(t){a(t)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,s)}c((r=r.apply(e,t||[])).next())}))},mt=function(e){function t(t,n,r){var i;(i=e.call(this,t)||this).direction=n,i.type=r,i.renderElement=function(){var e=document.createElement("div");e.classList.add("paste-special-insert-button-reddot-container");var t=document.createElement("div");t.classList.add("text-container");var n=document.createTextNode(i.getText());return t.appendChild(n),e.appendChild(t),e},i.getText=function(){var e,t=(0,u.Z)(i).direction,n=((e={})[ft.ai.RIGHT]=d.ZP.t("InsertRangeDirection.RIGHT"),e[ft.ai.DOWN]=d.ZP.t("InsertRangeDirection.DOWN"),e[ft._z.LEFT]=d.ZP.t("DeleteRangeDirection.LEFT"),e[ft._z.UP]=d.ZP.t("DeleteRangeDirection.UP"),e);return d.ZP.t("现有单元格{{value}}移",{value:n[t]})},i.callback=function(){return gt((0,u.Z)(i),void 0,void 0,regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=S(this._app),this.type!==ft.Us.INSERT){e.next=4;break}return b.ZP.tdwReport({opername:"doc_excel_editor",module:"cell_edit",action:"cell_click",ver10:"rightside_click",ver11:"insert_cell"}),e.abrupt("return",this._app.requestApi.insertRange({range:t,direction:this.direction}));case 4:return b.ZP.tdwReport({opername:"doc_excel_editor",module:"cell_edit",action:"cell_click",ver10:"rightside_click",ver11:"delete_cell"}),e.abrupt("return",this._app.requestApi.deleteRange({range:t,direction:this.direction}));case 6:case"end":return e.stop()}}),e,this)})))};var a={element:i.renderElement()};return i.defaultConfig=Object.assign({callback:i.callback},a),i.disabledButtonConfig=Object.assign(Object.assign({},a),i.disabledConfig),i}return(0,a.Z)(t,e),t.prototype.getConfigInCell=function(){return gt(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((0,vt.N2)(this._app.spreadsheet.activeSheet,this._app.view.canvas.normalSelectData,this._app.sheetStatus,this.direction,this.type)){e.next=3;break}return e.abrupt("return",this.disabledButtonConfig);case 3:return e.abrupt("return",this.defaultConfig);case 4:case"end":return e.stop()}}),e,this)})))},t}(y),xt=mt,yt=function(e,t,n,r){return new(n||(n=Promise))((function(i,a){function o(e){try{c(r.next(e))}catch(t){a(t)}}function s(e){try{c(r.throw(e))}catch(t){a(t)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,s)}c((r=r.apply(e,t||[])).next())}))},wt=function(e){return function(t){function n(n){var r;(r=t.call(this,n)||this).getSubMenu=function(t){return e===ft.Us.INSERT?[new xt(t,ft.ai.RIGHT,ft.Us.INSERT),new xt(t,ft.ai.DOWN,ft.Us.INSERT)]:[new xt(t,ft._z.LEFT,ft.Us.DELETE),new xt(t,ft._z.UP,ft.Us.DELETE)]},r.renderElement=function(){var t=document.createElement("div");t.classList.add("paste-special-insert-button-reddot-container");var n=document.createElement("div");n.classList.add("text-container");var r=document.createTextNode(e===ft.Us.INSERT?d.ZP.t("插入单元格"):d.ZP.t("删除单元格"));return n.appendChild(r),t.appendChild(n),t.appendChild(m()),t},r.handleEnterMenu=function(){b.ZP.tdwReport({opername:"doc_excel_editor",module:"cell_edit",action:"cell_view"})};var i=r.renderElement();return r.defaultConfig={element:i,appendLine:e===ft.Us.DELETE,enter:r.handleEnterMenu},r.subMenu=r.getSubMenu(n),r}return(0,a.Z)(n,t),n.prototype.getConfigInCell=function(e){var t;return yt(this,void 0,void 0,regeneratorRuntime.mark((function n(){var r,i,a;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(j(this._app,e)){n.next=2;break}return n.abrupt("return",this._empty);case 2:return(null===(t=this.defaultConfig.subMenu)||void 0===t?void 0:t.length)&&(this.defaultConfig.subMenu=void 0),r=[],this.subMenu.forEach((function(t){r.push(t.getConfigInCell(e))})),n.next=7,Promise.all(r);case 7:return i=n.sent,(a=i.filter((function(e){return null!==e}))).length&&(this.defaultConfig.subMenu=a),n.abrupt("return",this.defaultConfig);case 11:case"end":return n.stop()}}),n,this)})))},n}(y)},bt=n("../packages/model/src/cell/metadata/CustomDataType.ts"),Ct=!1;!function(e){e.MENU="menu",e.TOOLBAR="toolbar",e.MOBILE_MENU="mobileMenu",e.MOBILE_TOOLBAR="mobileToolbar",e.CONTEXTMEMU="contextmenu",e.MOBILE_CONTEXT_MENU="mobileContextmenu"}(ht||(ht={}));var _t=n("../spread-sheet/src/external/badgeServiceExcelAdapter/badgeServiceExcelAdapter.interface.ts"),It=(n("../spread-sheet/src/base/util/domain-config.ts"),function(e,t,n,r){return new(n||(n=Promise))((function(i,a){function o(e){try{c(r.next(e))}catch(t){a(t)}}function s(e){try{c(r.throw(e))}catch(t){a(t)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,s)}c((r=r.apply(e,t||[])).next())}))}),Mt=function(e){function t(t){var n;return(n=e.call(this,t)||this).showIcon=!1,n._callback=function(){return It((0,u.Z)(n),void 0,void 0,regeneratorRuntime.mark((function e(){var t,n,r,i,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null===(t=this.badgeService)||void 0===t||t.removeBadgeOn(ht.CONTEXTMEMU,ce.m.pc_insert_linked_range),this.showIcon=!1,null===(r=null===(n=this.icon)||void 0===n?void 0:n.parentNode)||void 0===r||r.removeChild(this.icon),i=this._app.view.canvas.normalSelectData.activeCol,a=this._app.view.canvas.normalSelectData.activeRow,!(i<0||a<0)){e.next=7;break}throw new Error("选区状态异常，无法插入链接");case 7:this._app.view.canvas.linkCenter.addLink(a,i),b.ZP.tdwReport({opername:"doc_excel_editor",module:"excel_link",action:"excel_link_click",ver10:"rightside_menu"});case 10:case"end":return e.stop()}}),e,this)})))},n.getButtonConfig=function(e){var t=M(N().isMac?"⌘+K":"Ctrl+K"),r=document.createElement("div");r.classList.add("paste-special-insert-button-reddot-container");var i=document.createElement("div");i.classList.add("text-container");var a=document.createTextNode(e);return n.showIcon&&"链接"===e&&(n.icon=document.createElement("div"),n.icon.classList.add("paste-special-button-reddot"),i.appendChild(n.icon)),i.appendChild(a),r.appendChild(i),r.appendChild(t),r},ut.q.getConfig("isHistory")||n.initRedDot().then((function(){var e=n.getButtonConfig(d.ZP.t("链接")),t=n.getButtonConfig(d.ZP.t("修改链接"));n._insert={element:e,callback:n._callback},n._modify={element:t,callback:n._callback},n.disabled=Object.assign({element:e},n.disabledConfig)})),Ct||(Ct=!0,b.ZP.tdwReport({opername:"doc_excel_editor",module:"excel_link",action:"excel_link_view",ver10:"rightside_menu"})),n}(0,a.Z)(t,e);var n=t.prototype;return n.getConfigInCell=function(e){return It(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n,r,i,a,o;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if((n=w.Z.selection.singleRange(this._app))&&e.canEdit){t.next=3;break}return t.abrupt("return",this._empty);case 3:if(!this.isButtonNeedDisabled()){t.next=5;break}return t.abrupt("return",this.disabled);case 5:if(r=this._app.spreadsheet.activeSheet,i=this._app.view.getSelection().activeCell,a=i.rowIndex,o=i.colIndex,!(0,bt.lv)(r,a,o)){t.next=9;break}return t.abrupt("return",this.disabled);case 9:if(!n){t.next=13;break}if(!w.Z.selection.isLinkCell(this._app)){t.next=12;break}return t.abrupt("return",this._modify);case 12:return t.abrupt("return",this._insert);case 13:return t.abrupt("return",this._empty);case 14:case"end":return t.stop()}}),t,this)})))},n.initRedDot=function(){var e;return It(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this._app.instantiationService.invokeFunction((function(e){return It(n,void 0,void 0,regeneratorRuntime.mark((function t(){var n,r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.get(_t.P),r=n.getInstance(),t.next=4,r;case 4:this.badgeService=t.sent;case 5:case"end":return t.stop()}}),t,this)})))})).catch((function(e){console.error(e),console.error("加载红点服务失败")}));case 2:this.showIcon=!!(null===(e=this.badgeService)||void 0===e?void 0:e.isBadgeOn(ht.CONTEXTMEMU,ce.m.pc_insert_linked_range));case 3:case"end":return t.stop()}}),t,this)})))},t}(y),St=function(e,t,n,r){return new(n||(n=Promise))((function(i,a){function o(e){try{c(r.next(e))}catch(t){a(t)}}function s(e){try{c(r.throw(e))}catch(t){a(t)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,s)}c((r=r.apply(e,t||[])).next())}))},jt=function(e){function t(){var t;return(t=e.apply(this,arguments)||this)._callback=function(){return St((0,u.Z)(t),void 0,void 0,regeneratorRuntime.mark((function e(){var t,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this._app.view.canvas.normalSelectData.activeCol,n=this._app.view.canvas.normalSelectData.activeRow,!(t<0||n<0)){e.next=4;break}throw new Error("选区状态异常，无法插入批注");case 4:this._app.view.canvas.commentCenter.openComment(n,t),b.ZP.tdwReport({module:"excel_comment",opername:"doc_cooper",action:"cli_add"});case 6:case"end":return e.stop()}}),e,this)})))},t._default={element:I(d.ZP.t("批注"),(N().isMac?"⇧":"Shift")+"+F2"),callback:t._callback},t._enterprise={element:I(d.ZP.t("添加评论"),""),callback:t._callback},t}return(0,a.Z)(t,e),t.prototype.getConfigInCell=function(e){return St(this,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.canComment){t.next=2;break}return t.abrupt("return",this._empty);case 2:if(!w.Z.selection.singleRange(this._app)){t.next=4;break}return t.abrupt("return",this._default);case 4:return t.abrupt("return",this._empty);case 5:case"end":return t.stop()}}),t,this)})))},t}(y),Dt=jt,Et=n("../spread-sheet/src/core/view/level-2/shape-upload/ShapeUpload.ts"),Tt=n("../spread-sheet/src/core/ui/loading/index.ts"),Nt=function(e,t,n,r){return new(n||(n=Promise))((function(i,a){function o(e){try{c(r.next(e))}catch(t){a(t)}}function s(e){try{c(r.throw(e))}catch(t){a(t)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,s)}c((r=r.apply(e,t||[])).next())}))},Pt=function(e){function t(t){var n;(n=e.call(this,t)||this)._callback=function(){return Nt((0,u.Z)(n),void 0,void 0,regeneratorRuntime.mark((function e(){var t,n,r,i,a=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._app.emitter.emit("removeCellImgRedSpot"),r=this._app.view.canvas.normalSelectData.activeCol,i=this._app.view.canvas.normalSelectData.activeRow,!(r<0||i<0)){e.next=5;break}throw new Error("选区状态异常，无法加入图片");case 5:if(this.clearRedPoint(),!(null===(n=null===(t=this._app.spreadsheet.activeSheet.getCellDataAtPosition(i,r))||void 0===t?void 0:t.getEffectiveValue())||void 0===n?void 0:n.value)){e.next=8;break}return e.abrupt("return",O.dialog.confirm({title:d.ZP.t("上传图片"),content:d.ZP.t("上传图片会覆盖单元格中已有的内容，确定上传吗？"),cancelText:d.ZP.t("取消"),onOk:function(){a.confirmInsertCellImage(i,r)},onCancel:function(){}}));case 8:return e.abrupt("return",this.confirmInsertCellImage(i,r));case 9:case"end":return e.stop()}}),e,this)})))},n.initRedDot();var r=n.setElement();return n._default={element:r,callback:n._callback},n.disabled=Object.assign({element:r},n.disabledConfig),n}(0,a.Z)(t,e);var n=t.prototype;return n.getConfigInCell=function(e){return Nt(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n,r,i,a;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.canEdit){t.next=2;break}return t.abrupt("return",this._empty);case 2:if(n=this._app.spreadsheet.activeSheet,r=this._app.view.getSelection().activeCell,i=r.rowIndex,a=r.colIndex,!(0,bt.lv)(n,i,a)){t.next=6;break}return t.abrupt("return",this.disabled);case 6:return t.abrupt("return",this._default);case 7:case"end":return t.stop()}}),t,this)})))},n.confirmInsertCellImage=function(e,t){var n=this,r=this._app.spreadsheet.getActiveSheetId();this.loading=Tt.ZP.createInstance(this._app.event,this._app.view.canvas,e,t,r),b.ZP.tdwReport({opername:"doc_excel_editor",module:"excel_photo",action:"insert_photo_click",ver10:"pc_cell_photo_rightclick"}),this._app.view.canvas.shapeUpload.insertShape(this._app.spreadsheet.activeSheetId,e,t,{callback:function(e){var t,r;switch(e){case"start":null===(t=n.loading)||void 0===t||t.show();break;case"end":null===(r=n.loading)||void 0===r||r.hide()}}},Et.ShapeType.CELL).catch((function(){var e;null===(e=n.loading)||void 0===e||e.hide(),b.ZP.tdwReport({opername:"doc_excel_editor",module:"excel_photo",action:"photo_fail"})})),b.ZP.tdwReport({opername:"doc_excel_editor",module:"excel_photo",action:"insert_photo_success",ver10:"pc_cell_photo_rightclick"})},n.initRedDot=function(){var e=this._app.view.userGuide,n=function(n,r){var i=void 0===r[n];i&&e.setData(n,"true");var a=Date.now()<new Date("2020-12-07").getTime(),o=i||"true"===r[n]&&a;t.showInsertImageDot=o};if(null===e||void 0===e?void 0:e.isInitialized()){var r=e.getData();n(ce.m.pc_context_menu_insert_cell_img,r)}else J.Z.event.default.one(ce.A.userguideInitialized,(function(e){n(ce.m.pc_context_menu_insert_cell_img,e)}))},n.clearRedPoint=function(){var e,n,r=this._app.view.userGuide;r&&(r.setData(ce.m.pc_context_menu_insert_cell_img,"false"),t.showInsertImageDot=!1,null===(n=null===(e=this.icon)||void 0===e?void 0:e.parentNode)||void 0===n||n.removeChild(this.icon))},n.setElement=function(){return this.renderElement()},n.renderElement=function(){var e=document.createElement("div");e.classList.add("paste-special-insert-button-reddot-container");var n=document.createElement("div");n.classList.add("text-container");var r=document.createTextNode(d.ZP.t("单元格图片"));return t.showInsertImageDot&&(this.icon=document.createElement("div"),this.icon.classList.add("paste-special-button-reddot"),n.appendChild(this.icon)),n.appendChild(r),e.appendChild(n),e},t}(y),Rt=n("../spread-sheet/src/external/badgeServiceExcelAdapter/config.ts"),kt=function(e,t,n,r){return new(n||(n=Promise))((function(i,a){function o(e){try{c(r.next(e))}catch(t){a(t)}}function s(e){try{c(r.throw(e))}catch(t){a(t)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,s)}c((r=r.apply(e,t||[])).next())}))},At=function(e){function t(n){var r;r=e.call(this,n)||this,ut.q.getConfig("isHistory")||r.initRedDot(),r._app.emitter.once("removeCellImgRedSpot",r.clearRedPoint.bind((0,u.Z)(r))),r._subMenu=r.getSubMenu(n),t.showSelectorDot=!1;var i=r.setElement();return r._default={element:i,enter:r.handleEnterMenu.bind((0,u.Z)(r))},r}(0,a.Z)(t,e);var n=t.prototype;return n.getSubMenu=function(e){var t=[new Mt(e),new Dt(e)];return ge.Z.getConfig("contextMenu.insertImageButton")&&t.push(new Pt(e)),t},n.getConfigInCell=function(e){var t;return kt(this,void 0,void 0,regeneratorRuntime.mark((function n(){var r,i=this;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if((null===(t=this._default.subMenu)||void 0===t?void 0:t.length)&&(this._default.subMenu=void 0),this._app.view.canvas.normalSelectData){n.next=4;break}throw new Error("未发现选区");case 4:return r=[],this._subMenu.forEach((function(t){r.push(t.getConfigInCell(e))})),n.next=8,Promise.all(r).then((function(e){(e=e.filter((function(e){return null!==e}))).length&&(i._default.subMenu=e)}));case 8:if(!this._default.subMenu){n.next=10;break}return n.abrupt("return",this._default);case 10:return n.abrupt("return",this._empty);case 11:case"end":return n.stop()}}),n,this)})))},n.initRedDot=function(){var e=this,n=this._app.view.userGuide,r=function(e,r){var i=void 0===r[e];i&&n.setData(e,"true");var a=Date.now()<new Date("2020-12-07").getTime(),o=i||"true"===r[e]&&a;t.showSelectorDot=o};if(null===n||void 0===n?void 0:n.isInitialized()){var i=n.getData();r(ce.m.pc_context_menu_insert_cell_img,i)}else J.Z.event.default.one(ce.A.userguideInitialized,(function(e){r(ce.m.pc_context_menu_insert_cell_img,e)}));this.loadBadgeService(),J.Z.event.badge.listen(Rt.K.VALUE_CHANGE,(function(){var t;e.changeRedDotVisiblity(!!(null===(t=e.badgeService)||void 0===t?void 0:t.isBadgeOn(ht.CONTEXTMEMU,"insert")))}))},n.loadBadgeService=function(){var e=this;this._app.instantiationService.invokeFunction((function(t){return kt(e,void 0,void 0,regeneratorRuntime.mark((function e(){var n,r,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.get(_t.P),i=r.getInstance(),e.next=4,i;case 4:this.badgeService=e.sent,this.changeRedDotVisiblity(!!(null===(n=this.badgeService)||void 0===n?void 0:n.isBadgeOn(ht.CONTEXTMEMU,"insert")));case 6:case"end":return e.stop()}}),e,this)})))})).catch((function(e){console.error(e),console.error("加载红点服务失败")}))},n.clearRedPoint=function(){var e,n,r=this._app.view.userGuide;r&&(r.setData(ce.m.pc_context_menu_insert_cell_img,"false"),t.showSelectorDot=!1,null===(n=null===(e=this.icon)||void 0===e?void 0:e.parentNode)||void 0===n||n.removeChild(this.icon))},n.changeRedDotVisiblity=function(e){t.showSelectorDot=!e,this.icon&&Object.assign(this.icon.style,{visibility:e?"visible":"hidden"})},n.setElement=function(){var e=this.renderElement();return e.appendChild(m()),e},n.renderElement=function(){var e=document.createElement("div");e.classList.add("paste-special-insert-button-reddot-container");var t=document.createElement("div");t.classList.add("text-container");var n=document.createTextNode(d.ZP.t("插入"));return this.icon=document.createElement("div"),this.icon.classList.add("paste-special-button-reddot"),Object.assign(this.icon.style,{visibility:"hidden"}),t.appendChild(this.icon),t.appendChild(n),e.appendChild(t),e},n.handleEnterMenu=function(){},t}(y),Zt=function(e,t,n,r){return new(n||(n=Promise))((function(i,a){function o(e){try{c(r.next(e))}catch(t){a(t)}}function s(e){try{c(r.throw(e))}catch(t){a(t)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,s)}c((r=r.apply(e,t||[])).next())}))},Lt=function(e){function t(t){var n;return(n=e.call(this,t)||this)._callback=function(){return Zt((0,u.Z)(n),void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this._app.view.canvas.modifyCellBroker.clearFormat(),b.ZP.tdwReport({module:"excel_menu",opername:"doc_excel_editor",action:"clk_menu_clearformat"});case 2:case"end":return e.stop()}}),e,this)})))},n._default={text:d.ZP.t("清除格式"),callback:n._callback},n}return(0,a.Z)(t,e),t.prototype.getConfigInCell=function(e){return Zt(this,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.canEdit){t.next=2;break}return t.abrupt("return",this._empty);case 2:return t.abrupt("return",this._default);case 3:case"end":return t.stop()}}),t,this)})))},t}(y),Ot=function(e,t,n,r){return new(n||(n=Promise))((function(i,a){function o(e){try{c(r.next(e))}catch(t){a(t)}}function s(e){try{c(r.throw(e))}catch(t){a(t)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,s)}c((r=r.apply(e,t||[])).next())}))},Ht=function(e){function t(t){var n;return(n=e.call(this,t)||this)._callback=function(){return Ot((0,u.Z)(n),void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this._app.view.canvas.modifyCellBroker.clearContent(),b.ZP.tdwReport({module:"excel_menu",opername:"doc_excel_editor",action:"clk_menu_clearcontent"});case 2:case"end":return e.stop()}}),e,this)})))},n._default={text:d.ZP.t("清除内容"),callback:n._callback},n}return(0,a.Z)(t,e),t.prototype.getConfigInCell=function(e){return Ot(this,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.canEdit){t.next=2;break}return t.abrupt("return",this._empty);case 2:return t.abrupt("return",this._default);case 3:case"end":return t.stop()}}),t,this)})))},t}(y),Vt=function(e,t,n,r){return new(n||(n=Promise))((function(i,a){function o(e){try{c(r.next(e))}catch(t){a(t)}}function s(e){try{c(r.throw(e))}catch(t){a(t)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,s)}c((r=r.apply(e,t||[])).next())}))},zt=function(e){function t(t){var n;n=e.call(this,t)||this;var r=document.createElement("div"),i=document.createTextNode(d.ZP.t("清除"));return r.appendChild(i),r.appendChild(m()),n._subMenu=[new Lt(t),new Ht(t)],n._default={element:r},n.disabled=Object.assign({element:r},n.disabledConfig),n}return(0,a.Z)(t,e),t.prototype.getConfigInCell=function(e){var t;return Vt(this,void 0,void 0,regeneratorRuntime.mark((function n(){var r,i=this;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if((null===(t=this._default.subMenu)||void 0===t?void 0:t.length)&&(this._default.subMenu=void 0),!this.isButtonNeedDisabled()){n.next=3;break}return n.abrupt("return",this.disabled);case 3:if(e.canEdit){n.next=5;break}return n.abrupt("return",this._empty);case 5:if(this._app.view.canvas.normalSelectData){n.next=8;break}throw new Error("未发现选区");case 8:return r=[],this._subMenu.forEach((function(t){r.push(t.getConfigInCell(e))})),n.next=12,Promise.all(r).then((function(e){(e=e.filter((function(e){return null!==e}))).length&&(i._default.subMenu=e)}));case 12:if(!this._default.subMenu){n.next=14;break}return n.abrupt("return",this._default);case 14:return n.abrupt("return",this._empty);case 15:case"end":return n.stop()}}),n,this)})))},t}(y),Bt=function(e){function t(t){var n=[pt,At,zt];if(!1!==ge.Z.getConfig("custom.insertDeleteMoveRange")){var r=wt(ft.Us.INSERT),i=wt(ft.Us.DELETE);n.splice(1,0,r,i)}return e.call.apply(e,[this,t].concat(n))||this}return(0,a.Z)(t,e),t}(l),Wt=n("../spread-sheet/src/core/view/level-2/link-center/utils/checker.ts"),Yt=n("../spread-sheet/src/core/view/level-2/link-center/utils/hyperlink.ts"),Gt=n("../node_modules/classnames/index.js"),Ut=n.n(Gt),Qt=n("../packages/model/src/cell/LinkIconType.ts"),Ft=n("../node_modules/@babel/runtime/helpers/esm/toConsumableArray.js"),Jt=function(e,t){var n=[];return e.rangeSelections.forEach((function(e){t.spreadsheet.activeSheet.getCellDatasAtRange(e).forEach((function(e){e.forEach((function(e){null!==e&&void 0!==e&&n.push(e)}))}))})),n},Xt=function(e,t){var n=[];return e.rangeSelections.forEach((function(e){n.push.apply(n,(0,Ft.Z)(function(e,t){var n=[],r=t.startRowIndex,i=t.endRowIndex,a=t.startColIndex,o=t.endColIndex;t.isRow&&(a=0,o=e.getColCount()-1),t.isCol&&(r=0,i=e.getRowCount()-1);for(var s=r;s<=i;s++)for(var c=a;c<=o;c++)n.push({col:c,row:s});return n}(t.spreadsheet.activeSheet,e)))})),n},Kt=function(e,t,n,r){return new(n||(n=Promise))((function(i,a){function o(e){try{c(r.next(e))}catch(t){a(t)}}function s(e){try{c(r.throw(e))}catch(t){a(t)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,s)}c((r=r.apply(e,t||[])).next())}))},qt=function(e){function t(t){var n;(n=e.call(this,t)||this).callback=function(){return Kt((0,u.Z)(n),void 0,void 0,regeneratorRuntime.mark((function e(){var t=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:Xt(this._app.view.getSelection(),this._app).forEach((function(e){var n=e.col,r=e.row,i=t._app.spreadsheet.activeSheet.getCellDataAtPosition(r,n);i&&(0,Wt.Rw)((0,Yt.wI)(i))&&t._app.view.canvas.linkCenter.setHyperlinkIconVisibility({row:r,col:n,visibility:!1})}));case 2:case"end":return e.stop()}}),e,this)})))},n.getButtonConfig=function(e){var t,n=document.createElement("div");n.className=Ut()("hyperlink-menu-container","hyperlink-menu-container-disable");var r=document.createElement("div");r.className=Ut()("hyperlink-menu-tick",((t={})["hyperlink-menu-tick-selected"]=e,t));var i=document.createElement("div");i.className=Ut()("hyperlink-menu-icon","hyperlink-menu-icon-disable");var a=document.createElement("span");return a.className=Ut()("hyperlink-menu-text"),a.innerText=d.ZP.t("文字链"),n.appendChild(r),n.appendChild(i),n.appendChild(a),n};var r=n.getButtonConfig(!0),i=n.getButtonConfig(!1);return n.selected={element:r,callback:n.callback},n.unselected={element:i,callback:n.callback},n}return(0,a.Z)(t,e),t.prototype.getConfigInCell=function(e){return Kt(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n,r,i;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.canEdit){t.next=2;break}return t.abrupt("return",this._empty);case 2:if(n=Jt(this._app.view.getSelection(),this._app),r=0,i=0,n.forEach((function(e){e.getLinkIconStatus()===Qt.Z.PLAIN_TEXT?i+=1:r+=1})),0!==r){t.next=8;break}return t.abrupt("return",this.selected);case 8:if(0!==i){t.next=10;break}return t.abrupt("return",this.unselected);case 10:return t.abrupt("return",this.unselected);case 11:case"end":return t.stop()}}),t,this)})))},t}(y),$t=function(e,t,n,r){return new(n||(n=Promise))((function(i,a){function o(e){try{c(r.next(e))}catch(t){a(t)}}function s(e){try{c(r.throw(e))}catch(t){a(t)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,s)}c((r=r.apply(e,t||[])).next())}))},en=function(e){function t(t){var n;(n=e.call(this,t)||this).callback=function(){return $t((0,u.Z)(n),void 0,void 0,regeneratorRuntime.mark((function e(){var t=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:Xt(this._app.view.getSelection(),this._app).forEach((function(e){var n=e.col,r=e.row,i=t._app.spreadsheet.activeSheet.getCellDataAtPosition(r,n);i&&(0,Wt.Rw)((0,Yt.wI)(i))&&t._app.requestApi.setHyperlinkIconVisibility({row:r,col:n,visibility:!0})}));case 2:case"end":return e.stop()}}),e,this)})))},n.getButtonConfig=function(e){var t,n=document.createElement("div");n.className=Ut()("hyperlink-menu-container","hyperlink-menu-container-disable");var r=document.createElement("div");r.className=Ut()("hyperlink-menu-tick",((t={})["hyperlink-menu-tick-selected"]=e,t));var i=document.createElement("div");i.className=Ut()("hyperlink-menu-icon","hyperlink-menu-icon-enable");var a=document.createElement("span");return a.className=Ut()("hyperlink-menu-text"),a.innerText=d.ZP.t("图标+文字链"),n.appendChild(r),n.appendChild(i),n.appendChild(a),n};var r=n.getButtonConfig(!0),i=n.getButtonConfig(!1);return n.selected={element:r,callback:n.callback},n.unselected={element:i,callback:n.callback},n}return(0,a.Z)(t,e),t.prototype.getConfigInCell=function(e){return $t(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n,r,i;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.canEdit){t.next=2;break}return t.abrupt("return",this._empty);case 2:if(n=Jt(this._app.view.getSelection(),this._app),r=0,i=0,n.forEach((function(e){e.getLinkIconStatus()===Qt.Z.PLAIN_TEXT?i+=1:r+=1})),0!==r){t.next=8;break}return t.abrupt("return",this.unselected);case 8:if(0!==i){t.next=10;break}return t.abrupt("return",this.selected);case 10:return t.abrupt("return",this.unselected);case 11:case"end":return t.stop()}}),t,this)})))},t}(y),tn=function(e,t,n,r){return new(n||(n=Promise))((function(i,a){function o(e){try{c(r.next(e))}catch(t){a(t)}}function s(e){try{c(r.throw(e))}catch(t){a(t)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,s)}c((r=r.apply(e,t||[])).next())}))},nn=function(e){function t(t){var n;n=e.call(this,t)||this;var r=document.createElement("div"),i=document.createTextNode(d.ZP.t("更改链接样式"));return r.appendChild(i),r.appendChild(m()),n._subMenu=[new qt(t),new en(t)],n._default={element:r},n.disabled=Object.assign({element:r},n.disabledConfig),n}return(0,a.Z)(t,e),t.prototype.getConfigInCell=function(e){var t;return tn(this,void 0,void 0,regeneratorRuntime.mark((function n(){var r,i,a,o=this;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if((null===(t=this._default.subMenu)||void 0===t?void 0:t.length)&&(this._default.subMenu=void 0),!this.isButtonNeedDisabled()){n.next=3;break}return n.abrupt("return",this.disabled);case 3:if(e.canEdit){n.next=5;break}return n.abrupt("return",this._empty);case 5:if(this._app.view.canvas.normalSelectData){n.next=8;break}throw new Error("未发现选区");case 8:if(r=Jt(this._app.view.getSelection(),this._app).filter((function(e){return null!==e.getEditValue()&&""!==e.getEditValue()})),i=!0,r.forEach((function(e){(0,Wt.Rw)((0,Yt.wI)(e))||(i=!1)})),i&&0!==r.length){n.next=13;break}return n.abrupt("return",this._empty);case 13:return a=[],this._subMenu.forEach((function(t){a.push(t.getConfigInCell(e))})),n.next=17,Promise.all(a).then((function(e){(e=e.filter((function(e){return null!==e}))).length&&(o._default.subMenu=e)}));case 17:if(!this._default.subMenu){n.next=19;break}return n.abrupt("return",this._default);case 19:return n.abrupt("return",this._empty);case 20:case"end":return n.stop()}}),n,this)})))},t}(y),rn=function(e){function t(t){return e.call(this,t,nn)||this}return(0,a.Z)(t,e),t}(l),an=function(e,t,n,r){return new(n||(n=Promise))((function(i,a){function o(e){try{c(r.next(e))}catch(t){a(t)}}function s(e){try{c(r.throw(e))}catch(t){a(t)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,s)}c((r=r.apply(e,t||[])).next())}))},on=function(e){function t(t){var n;return(n=e.call(this,t)||this)._callback=function(){return an((0,u.Z)(n),void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._app.view.getCustomFormatPanel();case 2:e.sent.show(),b.ZP.tdwReport({module:"excel_menu",opername:"doc_excel_editor",action:"clk_menu_formatpanel"});case 4:case"end":return e.stop()}}),e,this)})))},n._default={text:d.ZP.t("设置数据格式"),callback:n._callback},n.disabled=Object.assign({text:d.ZP.t("设置数据格式")},n.disabledConfig),n}(0,a.Z)(t,e);var n=t.prototype;return n.getConfigInCell=function(e){return an(this,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.isButtonNeedDisabled()&&!this.checkMetadataTypeNeedDisable()){t.next=2;break}return t.abrupt("return",this.disabled);case 2:if(e.canEdit){t.next=4;break}return t.abrupt("return",this._empty);case 4:return t.abrupt("return",this._default);case 5:case"end":return t.stop()}}),t,this)})))},n.checkMetadataTypeNeedDisable=function(){var e=(0,lt.getActiveCell)(this._app);return(0,bt.jb)(null===e||void 0===e?void 0:e.getCellType())},t}(y),sn=function(e,t,n,r){return new(n||(n=Promise))((function(i,a){function o(e){try{c(r.next(e))}catch(t){a(t)}}function s(e){try{c(r.throw(e))}catch(t){a(t)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,s)}c((r=r.apply(e,t||[])).next())}))},cn=function(e){function t(t){var n;return(n=e.call(this,t)||this)._callback=function(){return sn((0,u.Z)(n),void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:b.ZP.tdwReport({opername:"doc_excel_editor",module:"excel_manual_split",action:"clk_menu"});case 1:case"end":return e.stop()}}),e)})))},n._default={text:d.ZP.t("智能分列"),callback:n._callback},n.disabled=Object.assign({text:d.ZP.t("智能分列")},n.disabledConfig),n}return(0,a.Z)(t,e),t.prototype.getConfigInCell=function(e){return sn(this,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.isButtonNeedDisabled()){t.next=2;break}return t.abrupt("return",this.disabled);case 2:if(e.canEdit){t.next=4;break}return t.abrupt("return",this._empty);case 4:return t.abrupt("return",this._default);case 5:case"end":return t.stop()}}),t,this)})))},t}(y),ln=(n("../node_modules/core-js/modules/es.array.find.js"),n("../spread-sheet/src/core/feature/index.ts")),un=n("../spread-sheet/src/core/view/level-2/data-context-menu/menu.ts"),dn=n("../spread-sheet/src/core/view/level-2/data-context-menu/config.tsx"),hn=(n("../node_modules/core-js/modules/es.regexp.to-string.js"),function(e,t,n,r){return new(n||(n=Promise))((function(i,a){function o(e){try{c(r.next(e))}catch(t){a(t)}}function s(e){try{c(r.throw(e))}catch(t){a(t)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,s)}c((r=r.apply(e,t||[])).next())}))}),pn=function(e){function t(n,r,i,a,o){var s;(s=e.call(this,n)||this).itemConfig=r,s.dataMenuInstance=i,s.selectedIds=a,s.parentId=o,s.handleClick=function(e){return hn((0,u.Z)(s),void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this.dataMenuInstance.handleClick(this.idInMenu,e);case 1:case"end":return t.stop()}}),t,this)})))},s.disabled=Object.assign({},s.disabledConfig);var c=s.getElement(r);return s.subMenu=[],r.subMenu&&r.subMenu.forEach((function(e){var i=new t(n,e,s.dataMenuInstance,s.selectedIds,r.id);s.subMenu.push(i)})),s.default=r.subMenu?Object.assign(Object.assign({},s.default),{element:c}):Object.assign(Object.assign({},s.default),{element:c,callback:s.handleClick}),s.default.appendLine=r.splitAfter,s.default.checked=s.isChecked,s}(0,a.Z)(t,e);var n=t.prototype;return n.getConfigInCell=function(e){return hn(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n,r=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.isButtonNeedDisabled()){t.next=2;break}return t.abrupt("return",this.disabled);case 2:if(e.canEdit){t.next=4;break}return t.abrupt("return",this._empty);case 4:if(this._app.view.canvas.normalSelectData){t.next=7;break}throw new Error("未发现选区");case 7:return n=[],this.subMenu.forEach((function(t){n.push(t.getConfigInCell(e))})),t.next=11,Promise.all(n).then((function(e){var t=e.filter((function(e){return null!==e}));t.length&&(r.default.subMenu=t)}));case 11:if(!this.default.subMenu){t.next=13;break}return t.abrupt("return",this.default);case 13:return t.abrupt("return",this.default);case 14:case"end":return t.stop()}}),t,this)})))},n.getElement=function(e){var t=document.createElement("div"),n=document.createElement("div");if(Object.assign(n.style,{display:"inline-block"}),n.innerText=e.text,t.setAttribute("attr-ids",this.idInMenu),t.appendChild(n),this.parentId||e.icon)if(e.icon){var r=document.createElement("img");r.className="menu-item-icon-img",r.src=e.icon,t.classList.add("menu-item-with-icon"),t.insertBefore(r,t.firstChild)}else this.setAssistText(t,e.id);else{var i=(0,un.pN)(Number(e.id));if(i){var a=document.createElement("div");a.setAttribute("class",i);var o=Number(e.id)===bt.ZP.PROGRESS?"11.5px":"8px";Object.assign(a.style,{float:"right","margin-top":o}),t.appendChild(a)}}return e.subMenu&&e.subMenu.length>0&&t.appendChild(m()),t},n.createAssistTextInfo=function(e){var t=document.createElement("div");return t.innerText=e,t.setAttribute("class","menu-item-assist-infos"),Object.assign(t.style,{float:"right"}),t},n.setAssistText=function(e,t){var n=(0,un.cl)(Number(this.parentId),Number(t));if(n&&(this.parentId+"_"+t!==this.selectedIds[1]&&Number(this.parentId)===bt.ZP.SELECT||Number(this.parentId)!==bt.ZP.SELECT)){var r=this.createAssistTextInfo(null===n||void 0===n?void 0:n.toString());e.appendChild(r)}if(this.parentId+"_"+t===this.selectedIds[1]&&Number(this.parentId)===bt.ZP.SELECT){var i=this.createAssistTextInfo(d.ZP.t("点击修改"));e.appendChild(i)}},(0,i.Z)(t,[{key:"idInMenu",get:function(){return this.parentId?this.parentId+"_"+this.itemConfig.id:this.itemConfig.id}},{key:"isChecked",get:function(){var e=this.idInMenu;return this.parentId?e===this.selectedIds[1]:e===this.selectedIds[0]}}]),t}(y),fn=n("../spread-sheet/src/external/userGuide/util.ts"),vn=function(e,t,n,r){return new(n||(n=Promise))((function(i,a){function o(e){try{c(r.next(e))}catch(t){a(t)}}function s(e){try{c(r.throw(e))}catch(t){a(t)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,s)}c((r=r.apply(e,t||[])).next())}))},gn=Date.now()>new Date("2021-01-27").getTime(),mn=function(e){function t(t){var n;return(n=e.call(this,t)||this).handleEnterMenu=function(){n.checkCloseToolbarRedDot(),(0,un.T4)()},n.checkCloseToolbarRedDot=function(){var e;n.showRedDot&&((0,fn.uo)(ce.m.pc_context_data_validation_dot,"true"),n.showRedDot=!1,Object.assign(null===(e=n._default.element)||void 0===e?void 0:e.getElementsByTagName("sup")[0].style,{visibility:"hidden"}))},n.disabled=Object.assign({text:d.ZP.t("数据验证")},n.disabledConfig),n._default={element:void 0,enter:n.handleEnterMenu},n._subMenu=[],n}(0,a.Z)(t,e);var n=t.prototype;return n.getConfigInCell=function(e){return vn(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n,r,i,a,o,s,c,l=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=this.getElement(),this._default.element=n,this._subMenu=[],this.dataMenuCenter=(0,un.oe)({from:dn.BD.CONTEXT,spreadsheetApp:this._app,selection:this._app.view.getSelection()}),r=this.dataMenuCenter.getInitData(),i=r.selectedIds,r.config.forEach((function(e){l._subMenu.push(new pn(l._app,e,l.dataMenuCenter,i))})),this.dataMenuCenter.cellHasValue.hasMeta.length>0&&this._subMenu.push(new pn(this._app,{text:d.ZP.t("移除数据验证"),id:"remove"},this.dataMenuCenter,i)),!this.isButtonNeedDisabled()){t.next=9;break}return t.abrupt("return",this.disabled);case 9:if(e.canEdit){t.next=11;break}return t.abrupt("return",this._empty);case 11:t.next=21;break;case 21:if((a=this._app.view.canvas).normalSelectData){t.next=24;break}throw new Error("未发现选区");case 24:return o=a.normalSelectData.activeRow,s=a.normalSelectData.activeCol,ln.Z.dataValidation.getUIDVAtPosition(this._app.spreadsheet.activeSheet,o,s),c=[],this._subMenu.forEach((function(t){c.push(t.getConfigInCell(e))})),t.next=31,Promise.all(c).then((function(e){(e=e.filter((function(e){return null!==e}))).length&&(l._default.subMenu=e)}));case 31:if(!this._default.subMenu){t.next=33;break}return t.abrupt("return",this._default);case 33:return t.abrupt("return",this._empty);case 34:case"end":return t.stop()}}),t,this)})))},n.getElement=function(){this.getRedDotStatus();var e=document.createElement("div"),t=document.createTextNode(d.ZP.t("数据验证")),n=document.createElement("sup");return n.innerText="NEW",Object.assign(n.style,{position:"relative","vertical-align":"baseline",display:"inline-block",height:"20px",width:"40px","min-width":"10px",right:"-5px","border-radius":"20px","font-size":"12px",transform:"scale(.8)",background:"#ef4e2f",color:"white","text-align":"center","font-weight":700,"line-height":"20px"}),e.appendChild(t),this.showRedDot&&e.appendChild(n),e.appendChild(m()),e},n.getRedDotStatus=function(){var e=this;gn||(0,fn.xt)((function(t){var n=!t[ce.m.pc_context_data_validation_dot];e.showRedDot=n}))},t}(y),xn=mn,yn=function(e){function t(t){return e.call(this,t,xn,cn,on)||this}return(0,a.Z)(t,e),t}(l),wn=n("../spread-sheet/src/core/data/converter/tencentdoc/utils/files.ts"),bn=n("./node_modules/axios/index.js"),Cn=n.n(bn),_n=n("../node_modules/@tencent/dui/lib/components/Snackbar/index.js"),In=n("../spread-sheet/src/external/export/download.ts"),Mn=n("../node_modules/@tencent/netcheck/lib/index.js"),Sn=function(e,t,n,r){return new(n||(n=Promise))((function(i,a){function o(e){try{c(r.next(e))}catch(t){a(t)}}function s(e){try{c(r.throw(e))}catch(t){a(t)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,s)}c((r=r.apply(e,t||[])).next())}))},jn="download-file-button-toast",Dn=function(e){function t(){var t;return(t=e.apply(this,arguments)||this).files=[],t.toast=null,t.handleClick=function(){return Sn((0,u.Z)(t),void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.startDownloadTask(),(0,wn.Qe)("click",this.selection);case 2:case"end":return e.stop()}}),e,this)})))},t}(0,a.Z)(t,e);var n=t.prototype;return n.getConfigInCell=function(e){return Sn(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.canCopy){t.next=2;break}return t.abrupt("return",this._empty);case 2:if(n=this._app.spreadsheet.activeSheet,this.selection=this._app.view.getSelection(),this.files=(0,wn.kZ)(n,this.selection.rangeSelections),0!==this.files.length&&this._app.sheetStatus.rangesStatus.canRead){t.next=7;break}return t.abrupt("return",this._empty);case 7:return(0,wn.Qe)("view",this.selection),t.abrupt("return",{text:d.ZP.t("导出附件"),callback:this.handleClick});case 9:case"end":return t.stop()}}),t,this)})))},n.startDownloadTask=function(){return Sn(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t,n,r=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.stopQuery(),Mn.network.isOnline){e.next=4;break}return _n.default.show({message:d.ZP.t("网络异常，离线编辑中，请在网络恢复后试试。"),id:jn}),e.abrupt("return");case 4:return e.prev=4,e.next=7,Cn().post("/v1/export/sheet/image/"+ut.q.getConfig("padId"),this.files,{params:{domainId:ut.q.getConfig("domainId")}});case 7:if(t=e.sent,n=t.data,this.checkCgiResult(n)){e.next=11;break}return e.abrupt("return");case 11:this.toast=_n.default.show({message:d.ZP.t("正在导出{{value}}个附件，请稍候...0%",{value:this.files.length}),autoClose:!1,id:jn}),this.startQueryProgress(n.operationId),(0,In.jh)(jn,this.files.length,(function(e){var t;return null===(t=r.toast)||void 0===t?void 0:t.update({message:d.ZP.t("正在导出{{value0}}个附件，请稍候...{{progress}}%",{value0:r.files.length,progress:e})})})),e.next=19;break;case 16:e.prev=16,e.t0=e.catch(4),this.handleNetworkError(e.t0);case 19:case"end":return e.stop()}}),e,this,[[4,16]])})))},n.startQueryProgress=function(e){return Sn(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n,r=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=Date.now(),this.queryPollingId=setInterval((function(){return Sn(r,void 0,void 0,regeneratorRuntime.mark((function t(){var r,i;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(Date.now()-n>6e5)){t.next=5;break}return this.stopQuery(),_n.default.show({message:d.ZP.t("导出超时，请重试。"),autoClose:!1,action:d.ZP.t("确定"),id:jn}),(0,wn.Qe)("fail",this.selection),t.abrupt("return");case 5:return t.prev=5,t.next=8,Cn().get("/v1/export/sheet/image/progress/"+ut.q.getConfig("padId"),{params:{operationId:e}});case 8:if(r=t.sent,i=r.data,this.checkCgiResult(i)){t.next=12;break}return t.abrupt("return");case 12:i.url&&(this.stopQuery(),(0,In.y5)(i.url),_n.default.show({message:d.ZP.t("导出成功"),type:"success",id:jn}),(0,wn.Qe)("success",this.selection)),t.next=18;break;case 15:t.prev=15,t.t0=t.catch(5),this.handleNetworkError(t.t0);case 18:case"end":return t.stop()}}),t,this,[[5,15]])})))}),3e3);case 2:case"end":return t.stop()}}),t,this)})))},n.stopQuery=function(){var e;clearInterval(this.queryPollingId),(0,In.PZ)(jn),null===(e=this.toast)||void 0===e||e.close(),this.toast=null},n.handleNetworkError=function(e){var t;this.stopQuery(),console.error(e),_n.default.show({message:e.response?d.ZP.t("出现网络错误({{value}})，导出失败，请稍候重试。",{value:null===(t=e.response)||void 0===t?void 0:t.status}):d.ZP.t("网络超时，导出不成功，请在网络恢复后试试。"),id:jn})},n.checkCgiResult=function(e){return 0===e.ret||(this.stopQuery(),_n.default.show({message:e.msg,id:jn,action:d.ZP.t("确定"),autoClose:!1}),!1)},t}(y),En=function(e){function t(t){return e.call(this,t,Dn)||this}return(0,a.Z)(t,e),t}(l),Tn=(n("../node_modules/core-js/modules/es.array.map.js"),n("../spread-sheet/src/core/view/level-2/context-menu-center/context-menu-config/pc/button/image/util.ts")),Nn=n("../spread-sheet/src/external/view/ui-layer/convert-image/float-image-to-cell-conflict-ui.tsx"),Pn=function(e,t,n,r){return new(n||(n=Promise))((function(i,a){function o(e){try{c(r.next(e))}catch(t){a(t)}}function s(e){try{c(r.throw(e))}catch(t){a(t)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,s)}c((r=r.apply(e,t||[])).next())}))},Rn=function(e){function t(t){var n;return(n=e.call(this,t)||this).callback=function(){return Pn((0,u.Z)(n),void 0,void 0,regeneratorRuntime.mark((function e(){var t,n,r,i,a=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=function(e,t){return e.rowIndex===t.rowIndex&&e.colIndex===t.colIndex},n=[],r=[],this.floatImages.forEach((function(e){var o,s=e.id;if(s){var c=a.getRelatedCell(s);if(c){var l=c.colIndex,u=c.rowIndex,d=a._app.spreadsheet.activeSheet.getCellDataAtPosition(u,l);if(null===(o=null===d||void 0===d?void 0:d.getEffectiveValue())||void 0===o?void 0:o.value)n.push({id:s,relatedCell:c,error:Nn.QS.ALREADY_HAVE_CONTENT});else{if(i&&t(i,c)){var h=r[r.length-1],p=n[n.length-1];if(p&&t(p.relatedCell,c))return;if(h&&t(h.relatedCell,c))return void n.push(Object.assign(Object.assign({},r.pop()),{error:Nn.QS.MULTIPLE_PICS}))}r.push({id:s,relatedCell:c}),i=c}}}})),r.length&&this.convertImage(r.map((function(e){return e.id}))),n.length&&(0,Nn.kl)(n,this._app.view);case 6:case"end":return e.stop()}}),e,this)})))},n.floatImages=[],n.defaultButtonConfig={text:d.ZP.t("转为单元格图片"),callback:n.callback},n.disabledButtonConfig=Object.assign({text:d.ZP.t("转为单元格图片")},n.disabledConfig),n}(0,a.Z)(t,e);var n=t.prototype;return n.getConfigInCell=function(e){return Pn(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n,r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.canEdit){t.next=2;break}return t.abrupt("return",this._empty);case 2:if(!this.isButtonNeedDisabled()){t.next=4;break}return t.abrupt("return",this.disabledButtonConfig);case 4:if(this._app.view.canvas.normalSelectData){t.next=7;break}throw new Error("未发现选区");case 7:if(n=this._app.view.getSelection(),r=n.rangeSelections,this.floatImages=(0,wn.Ll)(this._app.spreadsheet.activeSheet,r).files,this.floatImages.length){t.next=11;break}return t.abrupt("return",this._empty);case 11:return t.abrupt("return",Object.assign(Object.assign({},this.defaultButtonConfig),{text:""+this.defaultButtonConfig.text}));case 12:case"end":return t.stop()}}),t,this)})))},n.getRelatedCell=function(e){return(0,Tn.O7)(this._app,e)},n.convertImage=function(e){(0,Tn.mP)(this._app,e)},t}(y),kn=n("../packages/model/src/embedded/index.ts"),An=function(e,t,n,r){return new(n||(n=Promise))((function(i,a){function o(e){try{c(r.next(e))}catch(t){a(t)}}function s(e){try{c(r.throw(e))}catch(t){a(t)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,s)}c((r=r.apply(e,t||[])).next())}))},Zn=function(e){function t(t){var r;return(r=e.call(this,t)||this)._callback=function(){return An((0,u.Z)(r),void 0,void 0,regeneratorRuntime.mark((function e(){var t,r,i=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this._app.view.canvas.normalSelectData.activeCol,r=this._app.view.canvas.normalSelectData.activeRow,!(t<0||r<0)){e.next=5;break}return n.g.log.error("选区状态异常，无法转换浮动图片"),e.abrupt("return");case 5:b.ZP.tdwReport({opername:"doc_excel_editor",module:"excel_photo",action:"photo_change",ver10:"to_float_photo"}),this.cellImgPos.length&&this.cellImgPos.forEach((function(e){var t,n,r=e.row,a=e.col,o=null===(n=null===(t=i._app.spreadsheet.activeSheet.getCellDataAtPosition(r,a))||void 0===t?void 0:t.getRefIds())||void 0===n?void 0:n[0];o&&i._app.requestApi.convertImageType(o,kn.EMBEDDED_OBJECT_TYPE.IMAGE)}));case 7:case"end":return e.stop()}}),e,this)})))},r.cellImgPos=[],r._default={text:d.ZP.t("转为浮动图片"),callback:r._callback},r.disabled=Object.assign({text:d.ZP.t("转为浮动图片")},r.disabledConfig),r}(0,a.Z)(t,e);var r=t.prototype;return r.getCellImages=function(e){for(var t=e.startColIndex,n=e.endColIndex,r=e.startRowIndex,i=e.endRowIndex,a=r;a<=i;a++)for(var o=t;o<=n;o++){var s=this._app.spreadsheet.activeSheet.getCellDataAtPosition(a,o),c=null===s||void 0===s?void 0:s.getMetadata();c&&c.customDataType===bt.ZP.IMAGE&&this.cellImgPos.push({col:o,row:a})}},r.getConfigInCell=function(e){return An(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.cellImgPos=[],e.canEdit){t.next=3;break}return t.abrupt("return",this._empty);case 3:if(this._app.view.canvas.normalSelectData){t.next=6;break}throw new Error("未发现选区");case 6:if(this._app.view.getSelection().rangeSelections.forEach((function(e){n.getCellImages(e)})),this.cellImgPos.length){t.next=10;break}return t.abrupt("return",this._empty);case 10:if(!this.isButtonNeedDisabled()){t.next=12;break}return t.abrupt("return",this.disabled);case 12:return t.abrupt("return",Object.assign(Object.assign({},this._default),{text:""+this._default.text}));case 13:case"end":return t.stop()}}),t,this)})))},t}(y),Ln=Zn,On=function(e,t,n,r){return new(n||(n=Promise))((function(i,a){function o(e){try{c(r.next(e))}catch(t){a(t)}}function s(e){try{c(r.throw(e))}catch(t){a(t)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,s)}c((r=r.apply(e,t||[])).next())}))},Hn=function(e){function t(t){var n;n=e.call(this,t)||this;var r=document.createElement("div"),i=document.createTextNode(d.ZP.t("转换图片"));return r.appendChild(i),r.appendChild(m()),n.subMenuItems=[new Rn(t),new Ln(t)],n.defaultButtonConfig={element:r},n.disabledButtonConfig=Object.assign({element:r},n.disabledConfig),n}return(0,a.Z)(t,e),t.prototype.getConfigInCell=function(e){var t;return On(this,void 0,void 0,regeneratorRuntime.mark((function r(){var i,a=this;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if((null===(t=this.defaultButtonConfig.subMenu)||void 0===t?void 0:t.length)&&(this.defaultButtonConfig.subMenu=void 0),!this.isButtonNeedDisabled()){r.next=3;break}return r.abrupt("return",this.disabledButtonConfig);case 3:if(e.canEdit){r.next=5;break}return r.abrupt("return",this._empty);case 5:if(this._app.view.canvas.normalSelectData){r.next=9;break}return n.g.log.error("未发现选区"),r.abrupt("return",this._empty);case 9:return i=[],this.subMenuItems.forEach((function(t){i.push(t.getConfigInCell(e))})),r.next=13,Promise.all(i).then((function(e){var t=e.filter((function(e){return null!==e}));t.length&&(a.defaultButtonConfig.subMenu=t)}));case 13:if(!this.defaultButtonConfig.subMenu){r.next=15;break}return r.abrupt("return",this.defaultButtonConfig);case 15:return r.abrupt("return",this._empty);case 16:case"end":return r.stop()}}),r,this)})))},t}(y),Vn=function(e){function t(t){return e.call(this,t,Hn)||this}return(0,a.Z)(t,e),t}(l),zn=n("../spread-sheet/src/external/view/main/panel/rangeSelectionPanel/util.ts"),Bn=n("../packages/model/src/range/hexRangeUtils.ts"),Wn=n("../spread-sheet/src/core/feature/copyPaste/utils/hyperlink-convert.ts"),Yn=function(e,t,n,r){return new(n||(n=Promise))((function(i,a){function o(e){try{c(r.next(e))}catch(t){a(t)}}function s(e){try{c(r.throw(e))}catch(t){a(t)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,s)}c((r=r.apply(e,t||[])).next())}))},Gn=function(e){function t(){var t;return(t=e.apply(this,arguments)||this)._default={text:"",callback:t._callback.bind((0,u.Z)(t))},t}(0,a.Z)(t,e);var n=t.prototype;return n._callback=function(){return Yn(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t,n,r,i,a,o,s,c,l,u,p,f,v;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=(0,zn.uQ)(this._app.spreadsheet,this._app.view,{}),n=t[0],r=this._app.spreadsheet.getActiveSheetId(),i=(0,Bn.hex2Range)(n,r),a=i.startRowIndex,o=i.endRowIndex,s=i.startColIndex,c=i.endColIndex,l=new h.GridRange({sheetId:r,startRowIndex:a,endRowIndex:o,startColIndex:s,endColIndex:c}),e.next=6,this._app.view.canvas.modifyLinkBroker.addLinkedRange(l);case 6:return u=e.sent,p=this._app.spreadsheet.sheetManager.getSheetTitleBySheetId(r),f=this._app.spreadsheet.getTitle(),e.next=11,(0,Wn.Ag)(r,u);case 11:v=e.sent,this._app.feature.copyPaste.doCopyToClipboard({html:"",plain:d.ZP.t("「{{fileName}}」{{sheetName}}的{{rangeString}}区域 - ",{fileName:f,sheetName:p,rangeString:n})+v,type:D.GI.input}),_n.default.show({type:"success",message:d.ZP.t("已复制分享链接（{{rangeString}}）",{rangeString:n}),autoClose:!0,closable:!0}),b.ZP.kvrOss({itemname:"xls_rangelink_obtain_rightclickmenu"});case 15:case"end":return e.stop()}}),e,this)})))},n.getConfigInCell=function(e){return Yn(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.canEdit&&this._app.sheetStatus.workbookStatus.isOnline){t.next=2;break}return t.abrupt("return",this._empty);case 2:if(1===(n=(0,zn.uQ)(this._app.spreadsheet,this._app.view,{})).length){t.next=5;break}return t.abrupt("return",this._empty);case 5:return this._default.text=d.ZP.t("获取指向此范围的链接（{{value}}）",{value:n[0]}),t.abrupt("return",this._default);case 7:case"end":return t.stop()}}),t,this)})))},t}(y),Un=Gn,Qn=function(e){function t(t){return e.call(this,t,Un)||this}return(0,a.Z)(t,e),t}(l),Fn=function(e,t,n,r){return new(n||(n=Promise))((function(i,a){function o(e){try{c(r.next(e))}catch(t){a(t)}}function s(e){try{c(r.throw(e))}catch(t){a(t)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,s)}c((r=r.apply(e,t||[])).next())}))},Jn=function(){function e(e){this._group=[new we(e),new Be(e),new ct(e),new Bt(e),new yn(e),new Qn(e),new Vn(e),new rn(e),new En(e)]}return e.prototype.getConfigGroup=function(e){return Fn(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n,r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=[],r=0;case 2:if(!(r<this._group.length)){t.next=11;break}return t.t0=n,t.next=6,this._group[r].getConfigInCell(e);case 6:t.t1=t.sent,t.t0.push.call(t.t0,t.t1);case 8:r++,t.next=2;break;case 11:return t.abrupt("return",n);case 12:case"end":return t.stop()}}),t,this)})))},e}(),Xn=function(e,t,n,r){return new(n||(n=Promise))((function(i,a){function o(e){try{c(r.next(e))}catch(t){a(t)}}function s(e){try{c(r.throw(e))}catch(t){a(t)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,s)}c((r=r.apply(e,t||[])).next())}))},Kn=function(e){function t(){var t;return(t=e.apply(this,arguments)||this)._callback=function(){return Xn((0,u.Z)(t),void 0,void 0,regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this._app.feature.copyPasteBase.CopyType,e.next=3,this._app.feature.getCopyPaste();case 3:e.sent.doShapesCopy(t.cut);try{b.ZP.tdwReport({module:"excel_picture",opername:"doc_excel_editor",action:"picture_menu_cut"})}catch(n){}case 6:case"end":return e.stop()}}),e,this)})))},t._default={text:d.ZP.t("剪切"),callback:t._callback},t}return(0,a.Z)(t,e),t.prototype.getConfigInShape=function(e){return Xn(this,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.canEdit){t.next=2;break}return t.abrupt("return",this._empty);case 2:return t.abrupt("return",this._default);case 3:case"end":return t.stop()}}),t,this)})))},t}(y),qn=Kn,$n=function(e,t,n,r){return new(n||(n=Promise))((function(i,a){function o(e){try{c(r.next(e))}catch(t){a(t)}}function s(e){try{c(r.throw(e))}catch(t){a(t)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,s)}c((r=r.apply(e,t||[])).next())}))},er=function(e){function t(){var t;return(t=e.apply(this,arguments)||this)._callback=function(){return $n((0,u.Z)(t),void 0,void 0,regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this._app.feature.copyPasteBase.CopyType,e.next=3,this._app.feature.getCopyPaste();case 3:e.sent.doShapesCopy(t.copy);try{b.ZP.tdwReport({module:"excel_picture",opername:"doc_excel_editor",action:"picture_menu_copy"})}catch(n){}if(window.isRecordPreviewShowing)try{b.ZP.tdwReport({opername:"doc_excel",module:"revise",action:"upv"})}catch(n){}case 7:case"end":return e.stop()}}),e,this)})))},t._default={text:d.ZP.t("复制"),callback:t._callback},t}return(0,a.Z)(t,e),t.prototype.getConfigInShape=function(e){return $n(this,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.canCopy){t.next=2;break}return t.abrupt("return",this._empty);case 2:return t.abrupt("return",this._default);case 3:case"end":return t.stop()}}),t,this)})))},t}(y),tr=er,nr=function(e,t,n,r){return new(n||(n=Promise))((function(i,a){function o(e){try{c(r.next(e))}catch(t){a(t)}}function s(e){try{c(r.throw(e))}catch(t){a(t)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,s)}c((r=r.apply(e,t||[])).next())}))},rr=function(e){function t(){var t;return(t=e.apply(this,arguments)||this)._callback=function(){return nr((0,u.Z)(t),void 0,void 0,regeneratorRuntime.mark((function e(){var t,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:null===(n=null===(t=this._app.view.canvas.shapeEditCenter)||void 0===t?void 0:t.shapeEdit)||void 0===n||n.edit.enterCrop();case 1:case"end":return e.stop()}}),e,this)})))},t._default={text:d.ZP.t("裁剪"),callback:t._callback},t}return(0,a.Z)(t,e),t.prototype.getConfigInShape=function(e){return nr(this,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.canEdit){t.next=2;break}return t.abrupt("return",this._empty);case 2:return t.abrupt("return",this._default);case 3:case"end":return t.stop()}}),t,this)})))},t}(y),ir=rr,ar=function(e,t,n,r){return new(n||(n=Promise))((function(i,a){function o(e){try{c(r.next(e))}catch(t){a(t)}}function s(e){try{c(r.throw(e))}catch(t){a(t)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,s)}c((r=r.apply(e,t||[])).next())}))},or=function(e){function t(){var t;return(t=e.apply(this,arguments)||this)._callback=function(){return ar((0,u.Z)(t),void 0,void 0,regeneratorRuntime.mark((function e(){var t,n,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=this._app,null===(n=null===(t=r.view.canvas.shapeEditCenter)||void 0===t?void 0:t.shapeEdit)||void 0===n||n.edit.reset();case 3:case"end":return e.stop()}}),e,this)})))},t._default={text:d.ZP.t("查看原图"),callback:t._callback},t}return(0,a.Z)(t,e),t.prototype.getConfigInShape=function(){return ar(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this._default);case 1:case"end":return e.stop()}}),e,this)})))},t}(y),sr=or,cr=function(e,t,n,r){return new(n||(n=Promise))((function(i,a){function o(e){try{c(r.next(e))}catch(t){a(t)}}function s(e){try{c(r.throw(e))}catch(t){a(t)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,s)}c((r=r.apply(e,t||[])).next())}))},lr=function(e){function t(){var t;return(t=e.apply(this,arguments)||this)._callback=function(){return cr((0,u.Z)(t),void 0,void 0,regeneratorRuntime.mark((function e(){var t,n,r,i,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this._app.view.canvas.modifyShapeBroker.deleteShape(null===(n=null===(t=this._app.view.canvas.shapeEditCenter)||void 0===t?void 0:t.shapeEdit)||void 0===n?void 0:n.shapeId);try{b.ZP.tdwReport({module:"excel_picture",opername:"doc_excel_editor",action:"picture_menu_del"})}catch(o){}null===(a=null===(i=null===(r=this._app.view.canvas.shapeEditCenter)||void 0===r?void 0:r.shapeEdit)||void 0===i?void 0:i.hide)||void 0===a||a.call(i);case 3:case"end":return e.stop()}}),e,this)})))},t._default={text:d.ZP.t("删除"),callback:t._callback},t}return(0,a.Z)(t,e),t.prototype.getConfigInShape=function(e){return cr(this,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.canEdit){t.next=2;break}return t.abrupt("return",this._empty);case 2:return t.abrupt("return",this._default);case 3:case"end":return t.stop()}}),t,this)})))},t}(y),ur=lr,dr=n("../node_modules/@tencent/dui/lib/components/Modal/index.js"),hr=function(e,t,n,r){return new(n||(n=Promise))((function(i,a){function o(e){try{c(r.next(e))}catch(t){a(t)}}function s(e){try{c(r.throw(e))}catch(t){a(t)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,s)}c((r=r.apply(e,t||[])).next())}))},pr=function(e){function t(t){var n;return(n=e.call(this,t)||this).id="",n.enter=function(){return hr((0,u.Z)(n),void 0,void 0,regeneratorRuntime.mark((function e(){var t,n,r,i,a,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=null===(n=null===(t=this._app.view.canvas.shapeEditCenter)||void 0===t?void 0:t.shapeEdit)||void 0===n?void 0:n.shapeId,this.id=r,i=this.getRelatedCell(r)){e.next=5;break}return e.abrupt("return");case 5:a=i.colIndex,o=i.rowIndex,(0,Tn.XF)(this._app.view.canvas,o,a),this._app.view.canvas.shapeEditCenter.shapeToCellHighlightPlugin.showHighlight([{x:a,y:o}]);case 9:case"end":return e.stop()}}),e,this)})))},n.leave=function(){return hr((0,u.Z)(n),void 0,void 0,regeneratorRuntime.mark((function e(){var t,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.id&&(this._app.view.canvas.normalSelectData.resetSelection(),this._app.view.canvas.shapeEditCenter.shapeToCellHighlightPlugin.hideHighlight(),null===(n=null===(t=this._app.view.canvas.shapeEditCenter)||void 0===t?void 0:t.shapeEdit)||void 0===n||n.focus(this.id));case 1:case"end":return e.stop()}}),e,this)})))},n.callback=function(){return hr((0,u.Z)(n),void 0,void 0,regeneratorRuntime.mark((function e(){var t,n,r,i,a,o,s,c,l=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=this.id||(null===(n=null===(t=this._app.view.canvas.shapeEditCenter)||void 0===t?void 0:t.shapeEdit)||void 0===n?void 0:n.shapeId)){e.next=3;break}return e.abrupt("return");case 3:if(o=this.getRelatedCell(a)){e.next=6;break}return e.abrupt("return");case 6:if(s=o.colIndex,c=o.rowIndex,!(null===(i=null===(r=this._app.spreadsheet.activeSheet.getCellDataAtPosition(c,s))||void 0===r?void 0:r.getEffectiveValue())||void 0===i?void 0:i.value)){e.next=10;break}return dr.default.confirm({title:d.ZP.t("转为单元格图片"),content:d.ZP.t("插入单元格图片将会覆盖单元格内容，继续设置吗？"),onOk:function(){l.convertImage(a)}}),e.abrupt("return");case 10:this.convertImage(a);case 11:case"end":return e.stop()}}),e,this)})))},n.default={callback:n.callback,enter:n.enter,leave:n.leave},n}(0,a.Z)(t,e);var n=t.prototype;return n.getConfigInShape=function(e){var t;return hr(this,void 0,void 0,regeneratorRuntime.mark((function n(){var r,i,a;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(r=null===(t=this._app.view.canvas.shapeEdit)||void 0===t?void 0:t.shapeId,i=this.getRelatedCell(r),e.canCopy&&e.canEdit&&i){n.next=4;break}return n.abrupt("return",this._empty);case 4:if(a=this.getText(),!(0,Tn.Oi)(this._app,r)){n.next=7;break}return n.abrupt("return",Object.assign(Object.assign({},this.disabledConfig),{text:a}));case 7:return n.abrupt("return",Object.assign(Object.assign({},this.default),{text:a}));case 8:case"end":return n.stop()}}),n,this)})))},n.convertImage=function(e){(0,Tn.mP)(this._app,e),this._app.view.canvas.shapeEditCenter.shapeToCellHighlightPlugin.hideHighlight()},n.getText=function(){var e,t=this.getRelatedCell(null===(e=this._app.view.canvas.shapeEdit)||void 0===e?void 0:e.shapeId);if(!t)return d.ZP.t("转为单元格图片");var n=t.colIndex,r=t.rowIndex;return d.ZP.t("转为单元格图片({{value0}}{{value1}})",{value0:(0,Bn.colIndex2ColChar)(n),value1:r+1})},n.getRelatedCell=function(e){return(0,Tn.O7)(this._app,e)},t}(y),fr=function(e){function t(t){return e.call(this,t,qn,tr,ir,sr,pr,ur)||this}return(0,a.Z)(t,e),t}(l),vr=function(e,t,n,r){return new(n||(n=Promise))((function(i,a){function o(e){try{c(r.next(e))}catch(t){a(t)}}function s(e){try{c(r.throw(e))}catch(t){a(t)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,s)}c((r=r.apply(e,t||[])).next())}))},gr=function(){function e(e){this._group=[new fr(e)]}return e.prototype.getConfigGroup=function(e){return vr(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n,r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=[],r=0;case 2:if(!(r<this._group.length)){t.next=11;break}return t.t0=n,t.next=6,this._group[r].getConfigInShape(e);case 6:t.t1=t.sent,t.t0.push.call(t.t0,t.t1);case 8:r++,t.next=2;break;case 11:return t.abrupt("return",n);case 12:case"end":return t.stop()}}),t,this)})))},e}(),mr=function(e,t,n,r){return new(n||(n=Promise))((function(i,a){function o(e){try{c(r.next(e))}catch(t){a(t)}}function s(e){try{c(r.throw(e))}catch(t){a(t)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,s)}c((r=r.apply(e,t||[])).next())}))},xr=function(e){function t(t){var n;n=e.call(this,t)||this;var r=t.app;return n._cells=new Jn(r),n._shapeMenu=new gr(r),n}return(0,a.Z)(t,e),t.prototype.getConfig=function(e){return mr(this,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:t.t0=e,t.next=t.t0===r.COL||t.t0===r.ROW||t.t0===r.ALL||t.t0===r.CELL?3:t.t0===r.SHAPE?4:5;break;case 3:return t.abrupt("return",this._cells.getConfigGroup(this._permission));case 4:return t.abrupt("return",this._shapeMenu.getConfigGroup(this._permission));case 5:throw new Error("invalid menu type");case 6:case"end":return t.stop()}}),t,this)})))},t}(o),yr=n("../packages/lib/EventEmitter.ts"),wr=function(){function e(e){this.emitter=new yr.Z,this._container=e.container}return(0,i.Z)(e,[{key:"EVENT",get:function(){return e.EVENT}}]),e}();wr.EVENT={SHOW:"show",HIDE:"hide"};var br=wr,Cr=function(){function e(e){this._wrap=document.createElement("div"),this._container=e,e.appendChild(this._wrap)}return e.prototype.destroy=function(){this._container.contains(this._wrap)&&this._container.removeChild(this._wrap)},e}(),_r=n("../spread-sheet/src/core/view/lib/find-position.ts"),Ir=n("../spread-sheet/src/core/view/utils/base-func.ts"),Mr=n("../packages/lib/Keyboard.ts"),Sr=n("../spread-sheet/src/base/event/event.ts"),jr=function(e,t,n,r){return new(n||(n=Promise))((function(i,a){function o(e){try{c(r.next(e))}catch(t){a(t)}}function s(e){try{c(r.throw(e))}catch(t){a(t)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,s)}c((r=r.apply(e,t||[])).next())}))},Dr=function(e){function t(t){var n;return(n=e.call(this,t)||this).resize=function(e){n._wrap.innerHTML&&Object.assign(n._wrap.style,{"max-height":n._container.offsetHeight-n._wrap.offsetTop-3+"px"})},n.show=function(e,t,r){Sr.ZP.windowEvent.listen("resize",n.resize),n._wrap.innerHTML="",r=r.filter((function(e){return e.length>0}));for(var i=0;i<r.length;i++){for(var a=r[i],o=0;o<a.length;o++)n._wrap.appendChild(n._getBox(a[o])),a[o].appendLine&&n._wrap.appendChild(n._getLine());a.length>0&&i!==r.length-1&&n._wrap.appendChild(n._getLine())}if(n._wrap.innerHTML){n._wrap.style.display="block";var s=n._wrap.offsetWidth,c=n._wrap.offsetHeight,l=n._container.offsetWidth,u=n._container.offsetHeight,d=(0,_r.s)({width:s,height:c},{left:e,top:t,width:1,height:1},{minX:0,minY:0,maxX:l,maxY:u-23},{sourceXPoint:[0,1],sourceYDir:1,showAsMoreAsPossible:!0}),h=c;d.yDir>0&&(d.top>=0&&d.top+c>u&&(h=u-d.top),d.top<0&&(h=u,d.top=0)),d.yDir<0&&d.top<0&&(h+=d.top,d.top=0),Object.assign(n._wrap.style,{left:d.left+"px",top:d.top+"px","max-height":h+"px"}),n.showing=!0}},n.hide=function(){window.removeEventListener("resize",n.resize),n._wrap.style.display="none",n._wrap.style.maxHeight="";for(var e=n._wrap.nextElementSibling;null===e||void 0===e?void 0:e.classList.contains("sub-menu-area");)e.remove(),e=n._wrap.nextElementSibling;for(;n._wrap.hasChildNodes();)n._wrap.removeChild(n._wrap.firstChild);clearTimeout(n.autoRemoveTimer),n.showing=!1},n.getShowing=function(){return n.showing},n._wrap.classList.add("context-menu-list-pc"),n._wrap.addEventListener("mousedown",Ir.UW),n._wrap.addEventListener("wheel",Ir.UW),n}(0,a.Z)(t,e);var n=t.prototype;return n._getBox=function(e,t){var n,r=this,i=document.createElement("div");if(i.classList.add("context-menu-item-pc"),e.text?i.innerText=e.text:e.element&&i.appendChild(e.element),e.class&&i.classList.add(e.class),e.enter&&(i.onmouseenter=function(t){return jr(r,void 0,void 0,regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:null===(n=e.enter)||void 0===n||n.call(e);case 1:case"end":return t.stop()}}),t)})))}),e.leave&&(i.onmouseleave=function(t){return jr(r,void 0,void 0,regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:null===(n=null===e||void 0===e?void 0:e.leave)||void 0===n||n.call(e);case 1:case"end":return t.stop()}}),t)})))}),e.checked&&i.classList.add("context-menu-item-pc-checked"),null===(n=e.subMenu)||void 0===n?void 0:n.length){var a=document.createElement("div"),o=e.subMenu.some((function(e){return"boolean"===typeof e.checked}));a.classList.add("context-menu-list-pc"),a.classList.add("sub-menu-area"),o&&a.classList.add("context-menu-list-pc-checkable"),a.style.display="none",a.style.position="absolute",a.addEventListener("mousedown",Ir.UW),e.subMenu.forEach((function(e){a.appendChild(r._getBox(e,!0)),e.appendLine&&a.appendChild(r._getLine())}));var s=function(){var n;t||(r.curActivatedSubMenuBox=a,null===(n=r.curActivatedThirdSubMenuBox)||void 0===n||n.remove(),r.curActivatedThirdSubMenuBox=void 0),t&&e.subMenu&&(r.curActivatedThirdSubMenuBox=a),clearTimeout(r.autoRemoveTimer)};i.onmouseenter=function(n){return jr(r,void 0,void 0,regeneratorRuntime.mark((function r(){var i,o,c,l,u,d,h,p,f,v,g,m,x,y,w,b,C;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(null===(i=e.enter)||void 0===i||i.call(e),p=n.target,null!==(f=p.parentElement)){r.next=5;break}return r.abrupt("return");case 5:if(t||(this.curActivatedSubMenuBox&&(this.curActivatedSubMenuBox.style.display="none",this.curActivatedSubMenuBox.remove()),this.curActivatedThirdSubMenuBox&&(this.curActivatedThirdSubMenuBox.style.display="none",null===(o=this.curActivatedThirdSubMenuBox)||void 0===o||o.remove())),t&&this.curActivatedThirdSubMenuBox&&(this.curActivatedThirdSubMenuBox.style.display="none",null===(c=this.curActivatedThirdSubMenuBox)||void 0===c||c.remove()),s(),a.style.display="block",f.offsetLeft+f.clientWidth+198>this._container.offsetWidth?a.style.left=f.offsetLeft-198+"px":a.style.left=f.offsetLeft+f.clientWidth+"px",v=100,g=document.getElementById("filter-view-center"),m=g&&"none"!==g.style.display?40:0,x=document.getElementById("headerContainer"),y=null!==(u=null===(l=document.querySelector(".formula-bar"))||void 0===l?void 0:l.offsetHeight)&&void 0!==u?u:26,x&&(w=x.getBoundingClientRect(),v=w.height||0),b=p.getBoundingClientRect().top-v-y-m-6,(null===(d=f.parentNode)||void 0===d?void 0:d.clientHeight)-b-30*a.childNodes.length<0&&(b=(null===(h=f.parentNode)||void 0===h?void 0:h.clientHeight)-30*a.childNodes.length-y-6),a.style.top=b+"px",null!==(C=f.parentNode)){r.next=22;break}return r.abrupt("return");case 22:C.lastChild==f?C.appendChild(a):C.insertBefore(a,f.nextSibling);case 23:case"end":return r.stop()}}),r,this)})))},a.onmouseenter=function(e){return jr(r,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:s();case 1:case"end":return e.stop()}}),e)})))},i.onmouseleave=a.onmouseleave=function(e){return jr(r,void 0,void 0,regeneratorRuntime.mark((function n(){var r,i,a=this;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(r=e.relatedTarget){n.next=3;break}return n.abrupt("return");case 3:i=!!r.closest(".sub-menu-area"),clearTimeout(this.autoRemoveTimer),this.autoRemoveTimer=setTimeout((function(){var e,n,r;i||(null===(e=a.curActivatedSubMenuBox)||void 0===e||e.remove(),a.curActivatedSubMenuBox=void 0,null===(n=a.curActivatedThirdSubMenuBox)||void 0===n||n.remove(),a.curActivatedThirdSubMenuBox=void 0),t&&i&&(null===(r=a.curActivatedThirdSubMenuBox)||void 0===r||r.remove(),a.curActivatedThirdSubMenuBox=void 0)}),500);case 6:case"end":return n.stop()}}),n,this)})))}}if(e.callback){var c=e.callback;i.onclick=function(e){return jr(r,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,c(e);case 2:t.sent||this.hide();case 4:case"end":return t.stop()}}),t,this)})))},new Mr.ZP({root:i,bindings:[{key:Mr.ZP.KEYS.ENTER,handler:function(e){return c(e),r.hide(),!1}}]})}return i},n._getLine=function(){var e=document.createElement("div");return e.classList.add("context-menu-item-pc"),e.classList.add("context-menu-line-pc"),e},t}(Cr),Er=Dr,Tr=function(e,t,n,r){return new(n||(n=Promise))((function(i,a){function o(e){try{c(r.next(e))}catch(t){a(t)}}function s(e){try{c(r.throw(e))}catch(t){a(t)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,s)}c((r=r.apply(e,t||[])).next())}))},Nr=function(e){function t(t){var n;return(n=e.call(this,t)||this)._show=function(e,t,r){b.ZP.tdwReport({opername:"doc_excel",module:"rightmenu_pc",action:"rightmenu_show"}),n._ui.show(e,t,r),n.emitter.emit(br.EVENT.SHOW),document.addEventListener("mousedown",n._hide),n._areaDataUpdateOffsetDispose=n._areaData.onUpdateOffset(n._hide)},n._hide=function(){n.showing&&(n._ui.hide(),n.emitter.emit(br.EVENT.HIDE),document.removeEventListener("mousedown",n._hide),n._areaDataUpdateOffsetDispose.dispose())},n._mouseOperate=t.mouseOperate,n._scale=t.scale,n._operateData=t.operateData,n._config=t.config,n._areaData=t.areaData,n._ui=new Er(n._container),n._mouseOperate.onContextMenu((function(){n.show()})),n}(0,a.Z)(t,e);var n=t.prototype;return n.show=function(e,t,n){return void 0===n&&(n=r.CELL),Tr(this,void 0,void 0,regeneratorRuntime.mark((function r(){var i,a,o;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,this._config.getConfig(n);case 2:i=r.sent,a=e||this._operateData.currX*this._scale.scale,o=t||this._operateData.currY*this._scale.scale,this._show(a,o,i);case 6:case"end":return r.stop()}}),r,this)})))},n.hide=function(){this._hide()},n.mutexHide=function(){this._hide()},(0,i.Z)(t,[{key:"ui",get:function(){return this._ui}},{key:"EVENT",get:function(){return t.EVENT}},{key:"showing",get:function(){return this._ui.getShowing()}}]),t}(br);Nr.EVENT=Object.assign({},br.EVENT);var Pr=Nr,Rr=n("../spread-sheet/src/core/view/lib/mutex-management/MutexManagement.ts"),kr=function(e,t){var n=this;this._menu=e,this._mutexManagement=t.mutexManagement,this._mutexManagement.addMutexComponent(Rr.d.CONTEXT_MENU,this._menu),this._menu.emitter.on(this._menu.EVENT.SHOW,(function(){n._mutexManagement.mutexShow(Rr.d.CONTEXT_MENU)}))},Ar=function(){function e(e){this._contextMenuConfig=new xr({app:e.spreadsheetApp,permission:e.sheetStatus}),this._contextMenu=new Pr(Object.assign(Object.assign({},e),{config:this._contextMenuConfig})),this._feature=new kr(this._contextMenu,e)}return(0,i.Z)(e,[{key:"contextMenu",get:function(){return this._contextMenu}},{key:"config",get:function(){return this._contextMenuConfig}}]),e}()},"../spread-sheet/src/core/view/level-2/data-context-menu/menu.ts":function(e,t,n){n.d(t,{oe:function(){return _},pN:function(){return I},cl:function(){return M},T4:function(){return S}});var r,i=n("../node_modules/@babel/runtime/helpers/esm/toConsumableArray.js"),a=(n("../node_modules/regenerator-runtime/runtime.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.promise.js"),n("../node_modules/core-js/modules/es.number.constructor.js"),n("../node_modules/core-js/modules/es.array.map.js"),n("../node_modules/core-js/modules/es.regexp.to-string.js"),n("../node_modules/core-js/modules/web.dom-collections.for-each.js"),n("../node_modules/core-js/modules/es.symbol.js"),n("../node_modules/core-js/modules/es.symbol.description.js"),n("../node_modules/i18next/dist/esm/i18next.js")),o=n("../spread-sheet/src/core/view/level-2/data-context-menu/config.tsx"),s=n("../packages/model/src/cell/metadata/select/SelectConfig.ts"),c=n("../node_modules/@tencent/dui/lib/components/Modal/index.js"),l=n("../node_modules/@tencent/dui/lib/components/Snackbar/index.js"),u=(n("../node_modules/core-js/modules/es.array.iterator.js"),n("../node_modules/core-js/modules/web.dom-collections.iterator.js"),n("../packages/model/src/range/index.ts")),d=n("../packages/model/src/cell/metadata/Metadata.ts"),h=n("../spread-sheet/src/core/feature/relateForm/seeker-util.ts"),p=function(){function e(e){var t=this;this.sendRequest=function(e,n){var r=e?d.Z.createInstance({customDataType:e,config:n}):null;t.spreadsheetApp.requestApi.setMetadata({metadata:r})},this.spreadsheetApp=e.spreadsheetApp,this.currCol=e.currCol,this.from=e.from,this.selection=e.selection}var t=e.prototype;return t.getTargetRange=function(e){var t,n=this;return e===o.BD.COL?[new u.GridRange({sheetId:this.spreadsheetApp.spreadsheet.activeSheetId,startColIndex:this.currCol,endColIndex:this.currCol,startRowIndex:0,endRowIndex:this.spreadsheetApp.spreadsheet.activeSheet.getRowCount()})]:e===o.BD.SHEETBAR||e===o.BD.CONTEXT?null===(t=this.selection)||void 0===t?void 0:t.rangeSelections.map((function(e){return new u.GridRange({sheetId:n.spreadsheetApp.spreadsheet.activeSheetId,startColIndex:e.startColIndex,endColIndex:e.endColIndex,startRowIndex:e.startRowIndex,endRowIndex:e.endRowIndex})})):[]},t.getSelectionMetaData=function(e){var t,n,r,i,a,s,c,l,u;if(e===o.BD.COL&&void 0!==this.currCol)return null===(t=this.spreadsheetApp.spreadsheet.activeSheet.data.colMetadata[this.currCol])||void 0===t?void 0:t.columnTypeMetadata;if((null===(r=null===(n=this.selection)||void 0===n?void 0:n.selectQueue)||void 0===r?void 0:r.length)&&(null===(i=this.selection)||void 0===i?void 0:i.selectQueue[0].selectCol)){var d=null===(s=null===(a=this.selection)||void 0===a?void 0:a.selectQueue[0].activation)||void 0===s?void 0:s.col;return null===(c=this.spreadsheetApp.spreadsheet.activeSheet.data.colMetadata[d])||void 0===c?void 0:c.columnTypeMetadata}if(e===o.BD.SHEETBAR||e===o.BD.CONTEXT){var h=null===(l=this.selection)||void 0===l?void 0:l.activeCell,p=h.rowIndex,f=h.colIndex;return null===(u=this.spreadsheetApp.spreadsheet.activeSheet.getCellDataAtPosition(p,f))||void 0===u?void 0:u.getMetadata()}},t.getSelectionDataValidation=function(e){var t,n,r,i,a;if((e!==o.BD.COL||void 0===this.currCol)&&(!(null===(n=null===(t=this.selection)||void 0===t?void 0:t.selectQueue)||void 0===n?void 0:n.length)||!(null===(r=this.selection)||void 0===r?void 0:r.selectQueue[0].selectCol))&&(e===o.BD.SHEETBAR||e===o.BD.CONTEXT)){var s=null===(i=this.selection)||void 0===i?void 0:i.activeCell,c=s.rowIndex,l=s.colIndex;return null===(a=this.spreadsheetApp.spreadsheet.activeSheet.getCellDataAtPosition(c,l))||void 0===a?void 0:a.getDataValidation()}},t.checkAllCellEffectiveValue=function(e,t,n){var r=this,a=[],s=[],c=(0,h.ns)(this.spreadsheetApp.spreadsheet.activeSheet),l=e;return n===o.BD.COL&&c&&(l=[],e.forEach((function(e){var t;(t=l).push.apply(t,(0,i.Z)(e.getExcept(c,r.spreadsheetApp.spreadsheet.activeSheet)))}))),l.forEach((function(e){var r=[e.startRowIndex,e.endRowIndex],i=[e.startColIndex,e.endColIndex],l=!!c&&n===o.BD.COL&&e.startColIndex>=c.startColIndex&&e.endColIndex<=c.endColIndex;t.forEach((function(e,t){var n;t<r[0]||t>r[1]||c&&l&&t<=(null===c||void 0===c?void 0:c.endRowIndex)||null===(n=null===e||void 0===e?void 0:e.values)||void 0===n||n.map((function(e,n){var r;n<i[0]||n>i[1]||((null===(r=null===e||void 0===e?void 0:e.getEffectiveValue())||void 0===r?void 0:r.value)&&a.push([n,t]),(null===e||void 0===e?void 0:e.getMetadata())&&s.push([n,t]))}))}))})),{hasValue:a,hasMeta:s}},e}(),f=n("../packages/model/src/cell/metadata/CustomDataType.ts"),v=n("../packages/report/src/index.ts"),g=n("../packages/model/src/cell/format/Color.ts"),m=n("../packages/model/src/filter-view/utils/grid-range-util.ts"),x=n("../spread-sheet/src/external/view/ui-layer/data-validation/data-validation-utils.ts"),y=n("../spread-sheet/src/core/feature/dataValidation/constant.ts"),w=n("../spread-sheet/src/core/data/configService/spreadConfig.ts"),b=(n("../spread-sheet/src/base/util/domain-config.ts"),function(e,t,n,r){return new(n||(n=Promise))((function(i,a){function o(e){try{c(r.next(e))}catch(t){a(t)}}function s(e){try{c(r.throw(e))}catch(t){a(t)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,s)}c((r=r.apply(e,t||[])).next())}))}),C=function(){function e(e){var t=this;this.firstCustomTypeUsed=!1,this.firstRemoved=!1,this.update=function(e){t.from=e.from,t.currCol=e.currCol,t.spreadsheetApp=e.spreadsheetApp,t.selection=e.selection,t.closeCallBack=e.closeCallBack},this.handleClick=function(e,n){return b(t,void 0,void 0,regeneratorRuntime.mark((function t(){var r,i,o,s,l,u,d,h,p,v=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(null===n||void 0===n||n.stopPropagation(),s=(0,x.RQ)(e),void 0!==this.from&&null!==this.from){t.next=4;break}return t.abrupt("return");case 4:l=this.logic.getSelectionMetaData(this.from),u=(0,f.NI)(Number(s.customTypeId)),d=(null===l||void 0===l?void 0:l.customDataType)!==Number(s.customTypeId),!u&&((null===(r=this.cellHasValue.hasValue)||void 0===r?void 0:r.length)>0||(null===(i=this.cellHasValue.hasMeta)||void 0===i?void 0:i.length)>0)&&d&&!this.firstCustomTypeUsed||u&&(null===(o=this.cellHasValue.hasMeta)||void 0===o?void 0:o.length)>0&&d&&!this.firstCustomTypeUsed?(h=y.rX[(null===s||void 0===s?void 0:s.customUITypeId)||""],p=a.ZP.t("设置{{value}}，将覆盖原有单元格内容，继续设置吗？",{value:h.text}),c.default.confirm({title:a.ZP.t("{{value}}提示",{value:h.text}),okText:a.ZP.t("确定"),content:p,onOk:function(){v.setDataType(s),v.firstCustomTypeUsed=!0}})):this.setDataType(s),this.closeMenu();case 9:case"end":return t.stop()}}),t,this)})))},this.submitCallBack=function(e,n,r){var i;if(!(r.items.length<1)){var o=r.items.map((function(e){return{id:null===e||void 0===e?void 0:e.id,text:null===e||void 0===e?void 0:e.text,textColor:g.Z.createColor(null===e||void 0===e?void 0:e.textColor),bgColor:g.Z.createColor(null===e||void 0===e?void 0:e.bgColor)}}));i=s.Z.createInstance({isMultiSelect:r.multiChoice,withColor:r.showItemColor,templateType:r.templateType,options:o}),t.logic.sendRequest(f.ZP.SELECT,i),j(t.from,f.ZP.SELECT,r.templateType),i.isMultiSelect&&v.ZP.tdwReport({opername:"doc_excel_editor",module:"data_validation",action:"validation_multichoice"}),i.withColor&&v.ZP.tdwReport({opername:"doc_excel_editor",module:"data_validation",action:"validation_color"}),l.default.show({message:a.ZP.t("设置成功"),type:"success"})}},this.from=e.from,this.currCol=e.currCol,this.spreadsheetApp=e.spreadsheetApp,this.selection=e.selection,this.closeCallBack=e.closeCallBack}var t=e.prototype;return t.getInitData=function(){var e;this.logic=new p({spreadsheetApp:this.spreadsheetApp,currCol:this.currCol,from:this.from,selection:this.selection});var t=this.logic.getSelectionMetaData(this.from),n=null===t||void 0===t?void 0:t.customDataType,r=[],i=null===(e=null===t||void 0===t?void 0:t.config)||void 0===e?void 0:e.templateType;r=n!==f.ZP.SELECT&&n!==f.ZP.DATE_TIME||!i?[""+((null===n||void 0===n?void 0:n.toString())||0)]:[n.toString(),n.toString()+"_"+i.toString()];var a=this.spreadsheetApp.spreadsheet.activeSheet,o=(0,m.e6)(this.logic.getTargetRange(this.from),a);return o.length>0&&(this.cellHasValue=this.logic.checkAllCellEffectiveValue(o,a.data.rowData,this.from)),{selectedIds:r,config:this.getColConfig()}},t.closeMenu=function(){var e;null===(e=this.closeCallBack)||void 0===e||e.call(this)},t.getColConfig=function(){v.ZP.tdwReport({opername:"doc_excel",module:"privacy_fill",action:"view_row",ver6:w.q.getConfig("isOwner")?1:2});var e=(0,i.Z)(o.t),t=(0,i.Z)(o.MZ);return this.spreadsheetApp.sheetStatus.containsPrivateRange()?t.push((0,o.Fx)(this.spreadsheetApp)):t.push((0,o.QO)(w.q.getConfig("isOwner"))),e.push.apply(e,(0,i.Z)(t)),e},t.setDataType=function(e){return b(this,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.spreadsheetApp.view.getDataValidationPanel();case 2:t.sent.create({customDataType:Number(null===e||void 0===e?void 0:e.customTypeId)||void 0,templateType:Number(null===e||void 0===e?void 0:e.templateId)||void 0,colIndex:this.from===o.BD.COL?this.currCol:void 0});case 3:case"end":return t.stop()}}),t,this)})))},e}();function _(e){return r?(r.update({from:e.from,spreadsheetApp:e.spreadsheetApp,currCol:e.currCol,selection:e.selection,closeCallBack:e.closeCallBack}),r):r=new C({from:e.from,spreadsheetApp:e.spreadsheetApp,currCol:e.currCol,selection:e.selection,closeCallBack:e.closeCallBack})}function I(e){return Number(e)===f.ZP.STAR?"menu-item-star":Number(e)===f.ZP.CHECKBOX?"menu-item-checkbox":Number(e)===f.ZP.PROGRESS?"menu-item-progressbar":void 0}function M(e,t){var n="";return o.De.forEach((function(r){r.id===e.toString()&&r.subMenu&&r.subMenu.forEach((function(e){e.id===t.toString()&&"string"===typeof(null===e||void 0===e?void 0:e.description)&&(n=e.description)}))})),n}function S(){v.ZP.tdwReport({opername:"doc_excel_editor",module:"data_validation",action:"view_validation"})}function j(e,t,n){var r={opername:"doc_excel_editor",module:"data_validation",action:"set_validation",ver10:o.z8.customdatainfo[t],ver12:o.z8.from[e]};t===f.ZP.SELECT&&n&&(r.ver11=o.z8.selecttemplate[n]),t===f.ZP.SELECT&&n&&(r.ver13=o.z8.datetimetemplate[n]),v.ZP.tdwReport(r)}},"../spread-sheet/src/core/view/level-2/filter-center/FilterCenter.ts":function(e,t,n){n.r(t),n.d(t,{default:function(){return P}}),n("../node_modules/core-js/modules/es.object.assign.js");var r=n("../node_modules/@babel/runtime/helpers/esm/createClass.js"),i=n("../node_modules/@babel/runtime/helpers/esm/inheritsLoose.js"),a=n("../node_modules/i18next/dist/esm/i18next.js"),o=n("../spread-sheet/src/core/view/level-2/render-plugin/BaseRenderPlugin.ts"),s=n("../packages/model/src/index.ts"),c=(n("../node_modules/core-js/modules/web.dom-collections.for-each.js"),n("../node_modules/core-js/modules/es.object.keys.js"),{"1:-1:0:0":n("../spread-sheet/src/core/view/level-2/filter-center/style/sync-off/filter-triangle.svg"),"1:0:0:0":n("../spread-sheet/src/core/view/level-2/filter-center/style/sync-off/filter-down.svg"),"1:1:0:0":n("../spread-sheet/src/core/view/level-2/filter-center/style/sync-off/filter-up.svg"),"0:-1:0:0":n("../spread-sheet/src/core/view/level-2/filter-center/style/sync-off/half-filter.svg"),"0:0:0:0":n("../spread-sheet/src/core/view/level-2/filter-center/style/sync-off/down-triangle.svg"),"0:1:0:0":n("../spread-sheet/src/core/view/level-2/filter-center/style/sync-off/up-triangle.svg"),"1:-1:1:0":n("../spread-sheet/src/core/view/level-2/filter-center/style/sync-off/filter-triangle-hover.svg"),"1:0:1:0":n("../spread-sheet/src/core/view/level-2/filter-center/style/sync-off/filter-down-hover.svg"),"1:1:1:0":n("../spread-sheet/src/core/view/level-2/filter-center/style/sync-off/filter-up-hover.svg"),"0:-1:1:0":n("../spread-sheet/src/core/view/level-2/filter-center/style/sync-off/half-filter-hover.svg"),"0:0:1:0":n("../spread-sheet/src/core/view/level-2/filter-center/style/sync-off/down-triangle-hover.svg"),"0:1:1:0":n("../spread-sheet/src/core/view/level-2/filter-center/style/sync-off/up-triangle-hover.svg"),"1:-1:2:0":n("../spread-sheet/src/core/view/level-2/filter-center/style/sync-off/filter-triangle-active.svg"),"1:0:2:0":n("../spread-sheet/src/core/view/level-2/filter-center/style/sync-off/filter-down-active.svg"),"1:1:2:0":n("../spread-sheet/src/core/view/level-2/filter-center/style/sync-off/filter-up-active.svg"),"0:-1:2:0":n("../spread-sheet/src/core/view/level-2/filter-center/style/sync-off/half-filter-active.svg"),"0:0:2:0":n("../spread-sheet/src/core/view/level-2/filter-center/style/sync-off/down-triangle-active.svg"),"0:1:2:0":n("../spread-sheet/src/core/view/level-2/filter-center/style/sync-off/up-triangle-active.svg"),"1:-1:0:1":n("../spread-sheet/src/core/view/level-2/filter-center/style/sync-on/filter-triangle.svg"),"1:0:0:1":n("../spread-sheet/src/core/view/level-2/filter-center/style/sync-on/filter-down.svg"),"1:1:0:1":n("../spread-sheet/src/core/view/level-2/filter-center/style/sync-on/filter-up.svg"),"0:-1:0:1":n("../spread-sheet/src/core/view/level-2/filter-center/style/sync-on/half-filter.svg"),"0:0:0:1":n("../spread-sheet/src/core/view/level-2/filter-center/style/sync-on/down-triangle.svg"),"0:1:0:1":n("../spread-sheet/src/core/view/level-2/filter-center/style/sync-on/up-triangle.svg"),"1:-1:1:1":n("../spread-sheet/src/core/view/level-2/filter-center/style/sync-on/filter-triangle-hover.svg"),"1:0:1:1":n("../spread-sheet/src/core/view/level-2/filter-center/style/sync-on/filter-down-hover.svg"),"1:1:1:1":n("../spread-sheet/src/core/view/level-2/filter-center/style/sync-on/filter-up-hover.svg"),"0:-1:1:1":n("../spread-sheet/src/core/view/level-2/filter-center/style/sync-on/half-filter-hover.svg"),"0:0:1:1":n("../spread-sheet/src/core/view/level-2/filter-center/style/sync-on/down-triangle-hover.svg"),"0:1:1:1":n("../spread-sheet/src/core/view/level-2/filter-center/style/sync-on/up-triangle-hover.svg"),"1:-1:2:1":n("../spread-sheet/src/core/view/level-2/filter-center/style/sync-on/filter-triangle-active.svg"),"1:0:2:1":n("../spread-sheet/src/core/view/level-2/filter-center/style/sync-on/filter-down-active.svg"),"1:1:2:1":n("../spread-sheet/src/core/view/level-2/filter-center/style/sync-on/filter-up-active.svg"),"0:-1:2:1":n("../spread-sheet/src/core/view/level-2/filter-center/style/sync-on/half-filter-active.svg"),"0:0:2:1":n("../spread-sheet/src/core/view/level-2/filter-center/style/sync-on/down-triangle-active.svg"),"0:1:2:1":n("../spread-sheet/src/core/view/level-2/filter-center/style/sync-on/up-triangle-active.svg"),"1:-1:0:2":n("../spread-sheet/src/core/view/level-2/filter-center/style/private/filter-triangle.svg"),"1:0:0:2":n("../spread-sheet/src/core/view/level-2/filter-center/style/private/filter-down.svg"),"1:1:0:2":n("../spread-sheet/src/core/view/level-2/filter-center/style/private/filter-up.svg"),"0:-1:0:2":n("../spread-sheet/src/core/view/level-2/filter-center/style/private/half-filter.svg"),"0:0:0:2":n("../spread-sheet/src/core/view/level-2/filter-center/style/private/down-triangle.svg"),"0:1:0:2":n("../spread-sheet/src/core/view/level-2/filter-center/style/private/up-triangle.svg"),"1:-1:1:2":n("../spread-sheet/src/core/view/level-2/filter-center/style/private/filter-triangle-hover.svg"),"1:0:1:2":n("../spread-sheet/src/core/view/level-2/filter-center/style/private/filter-down-hover.svg"),"1:1:1:2":n("../spread-sheet/src/core/view/level-2/filter-center/style/private/filter-up-hover.svg"),"0:-1:1:2":n("../spread-sheet/src/core/view/level-2/filter-center/style/private/half-filter-hover.svg"),"0:0:1:2":n("../spread-sheet/src/core/view/level-2/filter-center/style/private/down-triangle-hover.svg"),"0:1:1:2":n("../spread-sheet/src/core/view/level-2/filter-center/style/private/up-triangle-hover.svg"),"1:-1:2:2":n("../spread-sheet/src/core/view/level-2/filter-center/style/private/filter-triangle-active.svg"),"1:0:2:2":n("../spread-sheet/src/core/view/level-2/filter-center/style/private/filter-down-active.svg"),"1:1:2:2":n("../spread-sheet/src/core/view/level-2/filter-center/style/private/filter-up-active.svg"),"0:-1:2:2":n("../spread-sheet/src/core/view/level-2/filter-center/style/private/half-filter-active.svg"),"0:0:2:2":n("../spread-sheet/src/core/view/level-2/filter-center/style/private/down-triangle-active.svg"),"0:1:2:2":n("../spread-sheet/src/core/view/level-2/filter-center/style/private/up-triangle-active.svg")}),l=function(){function e(){}return e.Base64ToImage=function(){Object.keys(c).forEach((function(t){e.IMG[t]=new Image,e.IMG[t].src=c[t]}))},e}();l.SIZE=18,l.IMG={},l.Base64ToImage();var u=l,d=n("../spread-sheet/src/core/view/level-2/render-plugin/utils.ts"),h=n("../spread-sheet/src/core/view/spreadsheet-view/table-view/utils.ts"),p=n("../spread-sheet/src/core/view/spreadsheet-view/model/CellPadding.ts"),f=n("../spread-sheet/src/core/view/level-2/CanvasTooltip/index.tsx"),v=n("../spread-sheet/src/base/index.ts"),g=n("../node_modules/@tencent/docs-user-agent/dist/index.js"),m=n.n(g),x=n("../spread-sheet/src/core/view/spreadsheet-view/utils.ts"),y=n("../spread-sheet/src/core/view/level-1/orientation-operate/utils.ts"),w=n("../spread-sheet/src/external/rangeAuth/util/range-auth-error-util.ts"),b=n("../spread-sheet/src/core/view/level-2/filter-center/util.ts"),C=n("../spread-sheet/src/core/view/spreadsheet-view/render-manager/alloy-excel/canvas/CollectEngine.ts"),_=n("../packages/report/src/index.ts"),I=n("../packages/model/src/filter-view/filter-view-util.ts"),M=n("../spread-sheet/src/base/error/errorCodeModalProxy.ts"),S=n("../spread-sheet/src/base/error/index.ts"),j=function(e){function t(n){var r;(r=e.call(this,n)||this)._activeCell=null,r._lastHoverCell={row:-1,col:-1},r.renderAfterCell=function(e){var t=e.x,n=e.y,i=e.row,a=e.col;if((0,h.EL)(r._spreadsheet.activeSheet,i,a)){var o=r._tableView.getCellViewAtPosition(i,a),s=(0,x.o)(r._rowcolAccessor,o,a)-p.i.TEXT,c=(0,x.E)(r._rowcolAccessor,o,i),l=(0,d.t9)(r._tableView,i,a,c,r._filterSize),v=r._isHoverCellFilterHeader(i,a),g=r._getIconName(a,v);if(!g||!u.IMG[g])return;var y={dx:t+s-r._filterSize,dy:n+l,dWidth:r._filterSize,dHeight:r._filterSize,img:u.IMG[g]};if(r._alloyExcel.collectEngine.bitmapCollector.collect(y,C.h.FILTER_HEADER),m().isPC&&!(0,I.xJ)(r._spreadsheet)){var w=r._getFilterHeaderTips(a,r._isFilterSync),b=r.scale.scale;w&&(0,f.H)({x:y.dx*b,y:y.dy*b,width:y.dWidth*b,height:y.dHeight*b},{visible:v,title:w,placement:"top"})}}},r._handleMove=function(){if(r.shouldHandleEvent()){var e=r._operateData.currRow,t=r._operateData.currCol;(0,h.EL)(r._spreadsheet.activeSheet,e,t)&&r._isHoverCellFilterHeader(e,t)?(e===r._lastHoverCell.row&&t===r._lastHoverCell.col||-1!==r._lastHoverCell.row&&-1!==r._lastHoverCell.col&&r._renderApi.renderNextTick(),r._renderApi.renderNextTick(),r._lastHoverCell.row=e,r._lastHoverCell.col=t):r._lastHoverCell.row>=0&&r._lastHoverCell.col>=0&&(r._renderApi.renderNextTick(),r._lastHoverCell.row=-1,r._lastHoverCell.col=-1)}},r.handleDown=function(e){if((!m().isMobilePhone||!(0,y.m)())&&e.isHoverCell()){var n=e.currRow,i=e.currCol;if((0,h.EL)(r._spreadsheet.activeSheet,n,i)&&r._isHoverCellFilterHeader(n,i)){var a=r._spreadsheet.activeSheet.getCellDataAtPosition(n,i),o=null===a||void 0===a?void 0:a.getMergeReference();o&&(i=o.startColIndex);var s=r._getFilterStateAtCol(i);if((null===s||void 0===s?void 0:s.isPrivate)||(null===s||void 0===s?void 0:s.isCanNotRead))return;if(r._spreadsheet.parent.sheetStatus.workbookStatus.status.full&&!(0,b.WA)(r._spreadsheet.parent)&&r._spreadsheet.isFilterSync)return void M.Z.server.showFullMemberTip(S.B.FULL_MEMBER);if(r._spreadsheet.parent.sheetStatus.workbookStatus.status.full&&!(0,b.WA)(r._spreadsheet.parent)&&r._spreadsheet.isFilterSync)return void M.Z.server.showFullMemberTip(S.B.FULL_MEMBER);if((0,h.Z6)(r._spreadsheet.activeSheet,r._spreadsheet.parent))return(0,w.ZO)(),void _.ZP.kvrOss({itemname:"xls_rangeprotect_range_viewer_toast"});if(r.showFilterWhenViewProtect())return(0,b.c5)(),void _.ZP.kvrOss({itemname:"xls_rangeprotect_range_viewer_toast"});var c={row:n,col:i};r.emitter.emit(t.EVENT.FOCUS_ICON,c)}}},r._getFilterHeaderTips=function(e,t){var n=r._getFilterStateAtCol(e);if(!n)return"";if(n.isPrivate)return a.ZP.t("存在不可见的隐私内容，无法筛选");if(n.isCanNotRead)return a.ZP.t("存在不可查看的被保护区域，无法筛选");var i=r.onlyVisibleToOneself(t)?a.ZP.t("筛选仅自己可见"):a.ZP.t("筛选对所有人可见"),o=n.setSort?n.sortState?a.ZP.t("升序"):a.ZP.t("降序"):"";return n.setFilter?a.ZP.t("此列被筛选{{value0}}{{sortWording}}，{{syncWording}}",{value0:o?a.ZP.t("和"):"",sortWording:o,syncWording:i}):n.setSort?a.ZP.t("此列被{{sortWording}}",{sortWording:o}):""+i},r.onlyVisibleToOneself=function(e){return(0,b.WA)(r._spreadsheet.parent)||!e},r._spreadsheet=n.spreadsheet,r._rowcolAccessor=n.rowcolAccessor,r._areaData=n.areaData,r._headSize=n.headSize,r._renderApi=n.renderApi,r._tableView=n.tableView,r._operateData=n.operateData,r.scale=n.scale,r.mainBoard=n.mainBoard;var i=n.mouseOperate;i&&(i.onMousedown(r.handleDown),i.onMousemove(r._handleMove));var o=n.touchOperate;return o&&o.onTap(r.handleDown),r._alloyExcel.onAfterCellRender(r.renderAfterCell),v.Z.event.view.listen("filterPanelVisibilityChange",(function(e){var t=e.visible,n=e.col,i=e.row;r._activeCell=t?{row:i,col:n}:null,r._renderApi.renderNextTick()})),r}(0,i.Z)(t,e);var n=t.prototype;return n._isHoverCellFilterHeader=function(e,t){var n=this._spreadsheet.activeSheet.getCellDataAtPosition(e,t),r=null===n||void 0===n?void 0:n.getMergeReference();r&&(e=r.startRowIndex,t=r.startColIndex);var i=this._areaData.getViewLeftByCol(t),a=this._areaData.getViewTopByRow(e),o=this._operateData.currX-i-this._headSize.rowHeadWidth,s=this._operateData.currY-a-this._headSize.colHeadHeight,c=this._tableView.getCellViewAtPosition(e,t),l=(0,x.o)(this._rowcolAccessor,c,t),u=(0,x.E)(this._rowcolAccessor,c,e),h=(0,d.t9)(this._tableView,e,t,u,this._filterSize),f=m().isMobile?5:0;return o>l-p.i.TEXT-this._filterSize-f&&o<l-p.i.TEXT+f&&s>h-f&&s<h+this._filterSize+f},n._getFilterStateAtCol=function(e){var t,n=this._spreadsheet.activeSheet.getBasicFilter();if(!n)return null;var r=!!n.criteriaMap.get(e)||!1,i=!1,a=-1;if(null===(t=n.sortSpecs)||void 0===t?void 0:t.length){var o=n.sortSpecs[0];(i=o.dimensionIndex===e)&&(a=o.sortOrder===s.Filter.SORT_ORDER.DESCENDING?0:1)}return{setFilter:r,setSort:i,sortState:a,isPrivate:(0,b.B5)(this._spreadsheet,e),isCanNotRead:(0,b.Gr)(this._spreadsheet,e)}},n.showFilterWhenViewProtect=function(){return!(0,h.Jj)(this._spreadsheet.parent)&&this._isFilterSync&&!(0,b.WA)(this._spreadsheet.parent)},n._getIconName=function(e,t){var n=this._getFilterStateAtCol(e);if(!n)return null;var r=n.setFilter,i=n.setSort,a=n.sortState,o=n.isPrivate,s=n.isCanNotRead,c=this._activeCell&&this._activeCell.col===e,l=this.onlyVisibleToOneself(this._isFilterSync);return(r?1:0)+":"+(i?a:-1)+":"+(c?2:t?1:0)+":"+(o||s?2:l?0:1)},n.shouldHandleEvent=function(){if(!this._operateData.isHoverCell())return!1;var e=this._operateData.e.target,t=this.mainBoard.element.parentElement;return!(e&&!(null===t||void 0===t?void 0:t.contains(e)))},(0,r.Z)(t,[{key:"_filterSize",get:function(){return u.SIZE}},{key:"_isFilterSync",get:function(){return this._spreadsheet.isFilterSync}}]),t}(o.Z);j.EVENT={FOCUS_ICON:"focus_icon"};var D=j,E=n("../node_modules/@babel/runtime/helpers/esm/assertThisInitialized.js"),T=(n("../node_modules/regenerator-runtime/runtime.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.promise.js"),function(e,t,n,r){return new(n||(n=Promise))((function(i,a){function o(e){try{c(r.next(e))}catch(t){a(t)}}function s(e){try{c(r.throw(e))}catch(t){a(t)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,s)}c((r=r.apply(e,t||[])).next())}))}),N=function(e){function t(t){var n;return(n=e.call(this)||this).show=function(e){return T((0,E.Z)(n),void 0,void 0,regeneratorRuntime.mark((function t(){var n,r,i,a,o,s,c,l,u,d,h,p;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=this.spreadsheetApp,i=r.spreadsheet,a=r.sheetStatus,o=r.view,s=i.activeSheet.getBasicFilter(),c=!0,l=!0,s){t.next=6;break}return t.abrupt("return");case 6:if(a.canEdit&&!s.getIsLocalView()||(c=!1,l=!1),u=s.range,d=e.row,!((h=e.col)<0||d<0)){t.next=11;break}return t.abrupt("return");case 11:return t.next=13,o.getFilterPanel();case 13:if(p=t.sent){t.next=16;break}return t.abrupt("return");case 16:null===(n=this.operateData.e)||void 0===n||n.preventDefault(),this.operateData.stopPropagation=!0,o.canvas.inputManager.hide(),p.toggle({range:u,col:h,row:d,filter:s,canSort:c,canToggleFilterSync:l});case 20:case"end":return t.stop()}}),t,this)})))},n.setShowHandler(n.show),Object.assign((0,E.Z)(n),t),n.filterHeaderRenderPlugin.emitter.on(D.EVENT.FOCUS_ICON,n.triggerShow),n}return(0,i.Z)(t,e),t}(function(){function e(){var e=this;this.triggerShow=function(t){e.showHandler(t)}}return e.prototype.setShowHandler=function(e){this.showHandler=e},e}()),P=function(){function e(e){this._filterHeader=new D(e),this._filterPanel=new N(Object.assign(Object.assign({},e),{filterHeaderRenderPlugin:this._filterHeader}))}return e.prototype.getFilterPanel=function(){return this._filterPanel},e}()},"../spread-sheet/src/core/view/level-2/mention/MentionCenter.pc.ts":function(e,t,n){n.r(t),n.d(t,{default:function(){return L}}),n("../node_modules/core-js/modules/es.object.assign.js");var r=n("../node_modules/@babel/runtime/helpers/esm/inheritsLoose.js"),i=(n("../node_modules/core-js/modules/es.object.keys.js"),n("../node_modules/core-js/modules/es.array.find.js"),n("../node_modules/core-js/modules/es.array.slice.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.function.name.js"),n("../node_modules/core-js/modules/es.array.from.js"),n("../node_modules/core-js/modules/es.string.iterator.js"),n("../node_modules/core-js/modules/es.symbol.js"),n("../node_modules/core-js/modules/es.symbol.description.js"),n("../node_modules/core-js/modules/es.symbol.iterator.js"),n("../node_modules/core-js/modules/es.array.iterator.js"),n("../node_modules/core-js/modules/web.dom-collections.iterator.js"),n("../spread-sheet/src/core/view/level-2/render-plugin/BaseRenderPlugin.ts")),a=n("../spread-sheet/src/core/view/spreadsheet-view/model/line/segment/MentionSegment.ts"),o=n("../spread-sheet/src/core/view/config/default.ts"),s=n("../spread-sheet/src/core/view/level-2/render-plugin/utils.ts"),c=n("../spread-sheet/src/core/view/level-2/mention/api/MentionApi.ts"),l=n("../spread-sheet/src/base/index.ts"),u=n("../spread-sheet/src/core/view/level-2/mention/utils.ts"),d=n("../spread-sheet/src/core/view/spreadsheet-view/transform-table/segment.ts"),h=n("../spread-sheet/src/core/view/spreadsheet-view/render-manager/alloy-excel/canvas/renderer/BaseRenderer.ts"),p=n("../spread-sheet/src/core/view/utils/base-func.ts"),f=n("../spread-sheet/src/core/view/spreadsheet-view/utils.ts"),v=(n("../spread-sheet/src/base/util/domain-config.ts"),n("../spread-sheet/src/core/view/spreadsheet-view/operate-context/operate-data/FingerData.ts"));function g(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){if(e){if("string"===typeof e)return m(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?m(e,t):void 0}}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0;return function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function m(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var x=function(e){function t(t){var r;return(r=e.call(this,t)||this).hoverMentionSegment=null,r.hoverMentionPosition={x:0,y:0},r.hoverRow=-1,r.lastClickPosition={row:-1,col:-1},r.activePosition={col:0,row:0},r.renderPendingRow=-1,r.renderAfterCell=function(e){var t=e.x,n=e.y,i=e.row,a=e.col,s=r.spreadsheet.activeSheet.getCellDataAtPosition(i,a),c=null===s||void 0===s?void 0:s.getMentionDetails();if(c){var l=r.tableView.getCellViewAtPosition(i,a),u=(0,f.o)(r.rowcolAccessor,l,a),d=(0,f.E)(r.rowcolAccessor,l,i);c&&Object.keys(c).find((function(e){return r.mentionHighlight.checkInHighlight({rowIndex:i,colIndex:a,id:e})}))&&r.mentionHighlightCollector.collect({color:o.eP,graphicsInfo:{path:(0,p.j9)(t,n,u,d)}})}},r.handleMove=function(){if(r.hoverMentionSegment&&(r.hoverMentionSegment.unfocus(),r.hoverMentionSegment=null),r.operateData.isHoverCell()){var e=r.operateData.currRow,t=r.operateData.currCol,n=r.operateData.currX-r.headSize.rowHeadWidth,i=r.operateData.currY-r.headSize.colHeadHeight,a=r.transformTable.getCellBackgroundHeight(e,t),o=r.rowCoverAccessor.getHiddenCellParents(e,t);if(null===o||void 0===o?void 0:o.length)for(var s,c=g(o);!(s=c()).done;){var l=s.value,d=l.rowIndex,h=l.colIndex;if(r.handleDetectHoverMention(d,h,a,n,i))break}else{var p=r.tableView.getCellViewAtPosition(e,t);(null===p||void 0===p?void 0:p.mergeParent)&&(e+=p.mergeParent.y,t+=p.mergeParent.x),r.handleDetectHoverMention(e,t,a,n,i)}}else(0,u.ir)("MentionRenderPlugin","handleMove","Mouse not on cells")},r.handleDown=function(e){r.handleMove();var t=e.e,i=t instanceof TouchEvent,a=r.lastClickPosition,o=a.row,s=a.col,l=o===e.currRow&&s===e.currCol;r.lastClickPosition={row:e.currRow,col:e.currCol};var d=e.currRow===r.activePosition.row&&e.currCol===r.activePosition.col,h=t instanceof MouseEvent&&0===t.button,p=t instanceof TouchEvent&&e.fingerData.mode===v.w.MOVE,f=h||p&&d;if(r.hoverMentionSegment&&(f||i)&&l){n.g.log.info("MentionRenderPlugin","handleDown - Mouse clicked mention segment");var g=r.hoverMentionSegment.size.height;c.Z.showRemindBoard(r.hoverMentionSegment.mention.mentionId,{x:r.hoverMentionPosition.x*r.scale.scale+r.headSize.displayRowHeadWidth,y:r.hoverMentionPosition.y*r.scale.scale+r.headSize.displayColHeadHeight},!0,g,void 0)}else(0,u.ir)("MentionRenderPlugin","handleDown","Mouse not clicked mention segment");r.activePosition={row:e.currRow,col:e.currCol}},r.handleSwitch=function(){(0,u.ir)("MentionRenderPlugin","handleSwitch","Triggered switch sheet action")},r.renderRowCells=function(e){r.renderApi.renderRowCells(e-1),r.renderApi.renderRowCells(e),r.renderApi.renderRowCells(e+1)},r.touchOperate=t.touchOperate,r.mouseOperate=t.mouseOperate,r.areaData=t.areaData,r.headSize=t.headSize,r.renderApi=t.renderApi,r.tableView=t.tableView,r.transformTable=t.transformTable,r.rowCoverAccessor=t.rowCoverAccessor,r.operateData=t.operateData,r.inputManager=t.inputManager,r.scale=t.scale,r.paragraphAccessor=t.paragraphAccessor,r.rowcolAccessor=t.rowcolAccessor,r.spreadsheet=t.spreadsheet,r.mentionHighlight=t.mentionHighlight,r.mentionHighlightCollector=t.mentionHighlightCollector,document.body.addEventListener("mousemove",r.handleMove),r.mouseOperate&&r.mouseOperate.onMousedown(r.handleDown),r.touchOperate&&r.touchOperate.onTouchstart(r.handleDown),l.Z.event.sheetsBar.listen("switchSheet",r.handleSwitch),r.mentionTriangleCollect=r._alloyExcel.collectEngine.generateCollector(h.g4.GraphicsRender,h.DF.MentionTriangle),r._alloyExcel.collectEngine.add("mention-triangle",r.mentionTriangleCollect),r.inputManager.emitter.on(r.inputManager.EVENT.ENTER_INPUT,(function(){(0,u.ir)("MentionRenderPlugin","inputManager","Hide after ENTER_INPUT")})),r.areaData.onUpdateOffset((function(){(0,u.ir)("MentionRenderPlugin","areaData","Hide after onUpdateOffset")})),r}(0,r.Z)(t,e);var i=t.prototype;return i.traversingSegment=function(e,t,n,r,i,o,s){var c=this.tableView.getCellViewAtPosition(e,t),l=this.tableView.getIsCellPrivate(e,t),u=this.tableView.getIsCellCanNotRead(e,t),h=(0,d.r)(c,n,this.rowcolAccessor,e,t,l,u,this.tableView._spreadsheet);if(h)for(var p,f=g(h);!(p=f()).done;){var v=p.value,m=r+v.offsetX,x=i+v.offsetY;if(!(x-3*v.height/4>>0<i+o))break;for(var y,w=g(v.segments);!(y=w()).done;){var b=y.value,C=b.size.width;if(a.Z.isTargetType(b)){if(s(m,x,b))return;m+=C}else m+=C}}},i.handleDetectHoverMention=function(e,t,n,r,i){var a=this,c=this.areaData.getViewLeftByCol(t),l=this.areaData.getViewTopByRow(e),d=this.paragraphAccessor.getParagraph(e,t),h=!1;return d&&(0,u.Pk)(d)&&this.traversingSegment(e,t,d,c,l,n,(function(e,t,n){var c=Math.round(t-.75*n.size.height)-o.li.OuterPadding;return!!(0,s.VD)([r,i],[e,c,n.size.width,n.size.height])&&(a.hoverMentionSegment=n,h=!0,n.focus(),a.hoverMentionPosition.x=e,a.hoverMentionPosition.y=c+n.size.height,!0)})),h?(this.renderApi.renderNextTick(),this.renderPendingRow=e):(this.hoverMentionSegment=null,this.hoverMentionPosition.x=0,this.hoverMentionPosition.y=0,-1!==this.renderPendingRow&&(this.renderRowCells(this.renderPendingRow),this.renderPendingRow=-1)),h},t}(i.Z),y=n("../node_modules/@babel/runtime/helpers/esm/createClass.js"),w=n("../packages/lib/Keyboard.ts"),b=n("../packages/model/src/cell/data-validation/data-validation-rule-type.ts"),C=(n("../node_modules/core-js/modules/es.regexp.exec.js"),n("../node_modules/core-js/modules/es.string.search.js"),n("../node_modules/core-js/modules/es.regexp.to-string.js"),n("../node_modules/core-js/modules/web.dom-collections.for-each.js"),n("../node_modules/lodash/throttle.js")),_=n.n(C),I=n("../node_modules/@tencent/docs-user-agent/dist/index.js"),M=n.n(I),S=n("../packages/editor/src/core/Selection.ts"),j=n("../spread-sheet/src/core/view/level-2/mention/enum.ts"),D=n("../spread-sheet/src/external/mention-ent/utils.tsx"),E=n("../spread-sheet/src/core/view/level-2/formula-ui-center/utils.ts"),T=function(e){function t(t){var r;return(r=e.call(this,t)||this).addListener(),n.g.log.info("MentionBroker","PcMentionBroker initialized."),r}(0,r.Z)(t,e);var i=t.prototype;return i.enterMention=function(){n.g.log.info("MentionBroker","enterMention"),e.prototype.enterInlineMention.call(this),this.bindControl()},i.exitMention=function(){n.g.log.info("MentionBroker","exitMention"),e.prototype.exitInlineMention.call(this),this.unbindControl()},i.canMention=function(){var e,t;return(null===(t=null===(e=this.inputManager.cellData)||void 0===e?void 0:e.dataValidation)||void 0===t?void 0:t.ruleType)===b.Z.CUSTOM_TEXT_MAIL?(n.g.log.warn("MentionBroker","canMention - Can not mention when cell type is email"),!1):!this.inputManager.isFormula||(n.g.log.warn("MentionBroker","canMention - Can not mention when cell contains formula"),!1)},i.chooseBefore=function(){n.g.log.info("MentionBroker","chooseBefore"),this.inputManager.focus()},i.bindControl=function(){n.g.log.info("MentionBroker","bindControl"),this.inputManager.alloyRTE.keyboard.addBindings(this.keyBindings)},i.unbindControl=function(){n.g.log.info("MentionBroker","unbindControl"),this.inputManager.alloyRTE.keyboard.removeBindings(this.keyBindings)},(0,y.Z)(t,[{key:"keyBindings",get:function(){var e=this;return[{key:w.ZP.KEYS.ESCAPE,ignore:!0,handler:function(t){c.Z.isMentionListVisible&&(t.stopPropagation(),t.preventDefault(),e.exitMention())}},{key:w.ZP.KEYS.UP,priority:!0,handler:u.PR},{key:w.ZP.KEYS.LEFT,priority:!0,handler:u.PR},{key:w.ZP.KEYS.DOWN,priority:!0,handler:u.$k},{key:w.ZP.KEYS.RIGHT,priority:!0,handler:u.$k},{key:w.ZP.KEYS.TAB,priority:!0,handler:u.Ys},{key:w.ZP.KEYS.ENTER,priority:!0,handler:u.Ys}]}}]),t}(function(){function e(e){var t=this;this.cacheSearchText="",this.canCurrentKeyCodeEnablesMention=!1,this.inputChange=function(){(0,p.ad)((function(){var e=t.inputManager.getSelection();if(!e)return n.g.log.error("MentionBroker","inputChange - Can not get correct selection"),void t.exitMention();if(-1!==t.cursorDistanceLast){var r=e.start,i=t.inputManager.getText(!0),a=Math.max(0,i.length-r),o=t.inputManager.isComposing();if(n.g.log.debug("MentionBroker","inputChange - getText(): "+i),!o){var s=a!==t.cursorDistanceLast,c=r<=t.mentionStartIndex;if(s||c)return n.g.log.debug("MentionBroker","inputChange - "+r+" "+t.mentionStartIndex+" "+a+" "+t.cursorDistanceLast),n.g.log.warn("MentionBroker","inputChange - Cursor out of border"),void t.exitMention()}var l=i.substring(t.mentionStartIndex+1,r);n.g.log.info("MentionBroker","inputChange - search: "+l),t.cacheSearchText!==l&&(t.mentionEndIndex=r,t.cacheSearchText=l,t.api.search(l))}}))()},this.setCanCurrentInputKeyEnablesMention=function(e){t.canCurrentKeyCodeEnablesMention=t.checkCanCurrentInputKeyEnablesMention(e),n.g.log.debug("MentionBroker","setCanCurrentInputKeyEnablesMention - this.canCurrentKeyCodeEnablesMention: "+t.canCurrentKeyCodeEnablesMention)},this.handleClickTouch=function(e){var r,i,a,o,s,l,u=e.target,d=u&&u.closest(".alloy-mention-block");if(d){var h;try{h=JSON.parse(d.dataset.mentionDetail)}catch(g){n.g.log.error("MentionBroker","handleClickTouch - Parse mentionDetail failed: "+g.toString())}if(h){var p=t.spreadsheet.parent.view.canvas.clientRect,f=d.getBoundingClientRect(),v={x:f.x||f.left-p.distanceX,y:(f.y||f.top)+f.height-p.distanceY,placement:t.getQuickRemindPlacement()};n.g.log.debug("MentionBroker","handleClickTouch - "+JSON.stringify(v)),null===(i=(r=t.api).closeRemindBoard)||void 0===i||i.call(r),null===(o=(a=t.api).showRemindBoard)||void 0===o||o.call(a,h.mentionId,v,!0,f.height),e.preventDefault(),e.stopImmediatePropagation(),n.g.log.info("MentionBroker","handleClickTouch - showRemindBoard")}}else c.Z.isQuickRemindMenuVisible&&(null===(l=(s=t.api).closeRemindBoard)||void 0===l||l.call(s))},this.onValueChange=function(){t.checkWhetherCanEnterMention()},this.updateMentionPosition=function(){var e=t.getMentionListPosition();t.setMentionMenu(e)},this.chooseCallback=function(e){n.g.log.info("MentionBroker","chooseCallback: "+JSON.stringify(e)),t.chooseBefore();var r=M().isIPad||"MacIntel"===navigator.platform&&navigator.maxTouchPoints>1;if(!M().isMobile||r&&t.inputManager.hasFocus())return n.g.log.info("MentionBroker","chooseAfter in advance"),void t.chooseAfter(e);t.inputManager.emitter.once(t.inputManager.EVENT.ENTER_INPUT,(function(){setTimeout((function(){n.g.log.info("MentionBroker","chooseAfter after ENTER_INPUT"),t.chooseAfter(e)}),10)}))},this.getCurrentLineHeight=function(){var e=t.inputManager.alloyRTE.getFormat(),n=(null===e||void 0===e?void 0:e.fontSize)||o.n5,r=document.createElement("span");r.style.fontSize=n+"pt",r.style.lineHeight="1em",r.style.opacity="0",r.innerText="You can't see me",document.body.appendChild(r);var i=r.getBoundingClientRect().height;return r.remove(),i},this.handleFriendSelectorModalVisible=function(){n.g.log.info("MentionBroker","handleFriendSelectorModalVisible"),t.inputManager.setEditPendingStatus(!0)},this.handleFriendSelectorModalInvisible=function(){n.g.log.info("MentionBroker","handleFriendSelectorModalInvisible"),t.inputManager.setEditPendingStatus(!1),t.exitMention()},this.checkCanCurrentInputKeyEnablesMention=function(e){n.g.log.debug("MentionBroker","checkCanCurrentInputKeyEnablesMention - key: "+e.key+", keyCode: "+e.keyCode);var t=(0,u.Mn)(e.key),r=8!==e.keyCode,i=46!==e.keyCode;return!!t||r&&i},this.inputManager=e.inputManager,this.spreadsheet=e.spreadsheet,this.rowcolAccessor=e.rowcolAccessor,this.sheetStatus=e.sheetStatus,this.areaData=e.areaData,this.api=c.Z,this.initListener(),n.g.log.info("MentionBroker","BaseMentionBroker initialized.")}var t=e.prototype;return t.enterInlineMention=function(){var e=this;n.g.log.info("MentionBroker","enterInlineMention"),this.enterCommonMention(),this.removeListener(),this.inputManager.alloyRTE.on(this.inputManager.alloyRTE.EVENT.VALUE_CHANGE,this.inputChange),this.inputManager.alloyRTE.on(this.inputManager.alloyRTE.EVENT.SELECTION_CHANGE,this.inputChange),this.areaDataUpdateOffsetDispose=this.areaData.onUpdateOffset(_()(this.updateMentionPosition,50)),this.inputManager.emitter.on(this.inputManager.EVENT.EXIT_INPUT,(function(){return e.exitMention()}))},t.exitInlineMention=function(){var e;n.g.log.info("MentionBroker","exitInlineMention"),this.exitCommonMention(),this.addListener(),this.inputManager.alloyRTE.off(this.inputManager.alloyRTE.EVENT.VALUE_CHANGE,this.inputChange),this.inputManager.alloyRTE.off(this.inputManager.alloyRTE.EVENT.SELECTION_CHANGE,this.inputChange),null===(e=this.areaDataUpdateOffsetDispose)||void 0===e||e.dispose(),this.inputManager.emitter.off(this.inputManager.EVENT.EXIT_INPUT,this.exitMention)},t.enterFullScreenMention=function(){n.g.log.info("MentionBroker","enterFullScreenMention"),this.enterCommonMention()},t.exitFullScreenMention=function(){n.g.log.info("MentionBroker","exitFullScreenMention"),this.exitCommonMention()},t.addListener=function(){var e=this;n.g.log.info("MentionBroker","addListener"),this.inputManager.alloyRTE.emitter.on(this.inputManager.alloyRTE.EVENT.VALUE_CHANGE,(function(){return e.checkWhetherCanEnterMention()})),this.inputManager.alloyRTE.emitter.on(this.inputManager.alloyRTE.EVENT.ON_KEY_DOWN,this.setCanCurrentInputKeyEnablesMention),this.inputManager.alloyRTE.emitter.on(this.inputManager.alloyRTE.EVENT.TOOLBAR_INSERT,this.setCanCurrentInputKeyEnablesMention.bind(this,void 0,{isToolbar:!0})),this.inputManager.alloyRTE.input.addEventListener("click",this.handleClickTouch),this.inputManager.alloyRTE.input.addEventListener("touchend",this.handleClickTouch),this.keyBoard=new w.ZP({root:this.spreadsheet.parent.view.canvas.container,bindings:[{key:w.ZP.KEYS.BACKSPACE,handler:function(){(0,u.ir)("MentionBroker","addListener","on BACKSPACE: closeRemindBoard")}},{key:w.ZP.KEYS.DELETE,handler:function(){(0,u.ir)("MentionBroker","addListsner","on DELETE: closeRemindBoard")}}]})},t.removeListener=function(){n.g.log.info("MentionBroker","removeListener"),this.inputManager.alloyRTE.emitter.off(this.inputManager.alloyRTE.EVENT.VALUE_CHANGE,this.checkWhetherCanEnterMention),this.inputManager.alloyRTE.emitter.off(this.inputManager.alloyRTE.EVENT.ON_KEY_DOWN,this.setCanCurrentInputKeyEnablesMention),this.inputManager.alloyRTE.input.removeEventListener("click",this.handleClickTouch),this.inputManager.alloyRTE.input.removeEventListener("touchend",this.handleClickTouch),this.keyBoard.destroy()},t.checkWhetherCanEnterMention=function(){var e,t,r,i;if(n.g.log.debug("MentionBroker","checkWhetherCanEnterMention"),c.Z.isQuickRemindMenuVisible&&(null===(t=(e=this.api).closeRemindBoard)||void 0===t||t.call(e)),this.sheetStatus.workbookStatus.isOnline){var a=this.inputManager.getSelection();if(a&&a.start===a.end){var o=this.canMention(),s=this.spreadsheet.parent.view.canvas.normalSelectData||{},l=s.activeRow,d=s.activeCol;if(!(0,D.W1)(l,d))if(o)if(this.inputManager.isComposing())n.g.log.error("MentionBroker","checkWhetherCanEnterMention - Can not mention when composing.");else{var h=this.inputManager.getText(!0),p=a.start;if(this.canCurrentKeyCodeEnablesMention&&(0,u.Mn)(h[p-1])){var f=null===(r=this.inputManager.cellData)||void 0===r?void 0:r.row,v=null===(i=this.inputManager.cellData)||void 0===i?void 0:i.col;if(null!=f&&null!=v){var g=this.spreadsheet.activeSheet.getCellDataAtPosition(f,v);if((0,E.AO)(g,h).isFormula)return}return this.cursorDistanceLast=Math.max(0,h.length-p),this.mentionStartIndex=p-1,this.mentionEndIndex=p,n.g.log.info("MentionBroker","checkWhetherCanEnterMention - User input triggers mention"),this.enterMention()}n.g.log.debug("MentionBroker","checkWhetherCanEnterMention - "+this.canCurrentKeyCodeEnablesMention+" "+(0,u.Mn)(h[p-1])+" "+h+" "+p)}else n.g.log.warn("MentionBroker","checkWhetherCanEnterMention - Can not mention due to insufficient permission.")}else n.g.log.error("MentionBroker","checkWhetherCanEnterMention - Current selection is not collapsed: "+(null===a||void 0===a?void 0:a.start)+":"+(null===a||void 0===a?void 0:a.end))}else n.g.log.error("MentionBroker","checkWhetherCanEnterMention - Workbook Offline")},t.insertMention=function(e){n.g.log.debug("MentionBroker","insertMention - mentionDetail: "+JSON.stringify(e));var t=null,r=(0,u.Ue)(e);if((t=(0,u.p1)())&&(r.forEach((function(e){t.insertNode(e),t.collapse(!1)})),M().isSafari||M().isOldEdge||M().isWxWork&&M().isIOS)){var i=document.createRange(),a=r[r.length-1];i.setStartAfter(a),i.setEndAfter(a);var o=document.getSelection();if(!o)return;o.removeAllRanges(),o.addRange(i)}},t.chooseAfter=function(e){var t=this;(null===e||void 0===e?void 0:e.length)&&this.prepareForInsertMention(),(null===e||void 0===e?void 0:e.length)&&e.forEach((function(e){t.insertMention((0,u.Si)(e))})),this.exitMention()},t.prepareForInsertMention=function(){var e=null;this.inputManager.alloyRTE.currSelection&&this.mentionStartIndex<=this.mentionEndIndex&&(this.inputManager.setSelection(new S.e6(Math.max(0,this.mentionStartIndex),this.mentionEndIndex)),null===(e=(0,u.p1)())||void 0===e||e.deleteContents())},t.getQuickRemindPlacement=function(){},t.enterCommonMention=function(){var e=this;l.Z.util.timer.wait(0).run((function(){n.g.log.info("MentionBroker","enterCommonMention");var t=e.getMentionListPosition();e.popMentionList(t)}))},t.exitCommonMention=function(){n.g.log.info("MentionBroker","exitCommonMention"),this.api.hideMentionList(),this.cursorDistanceLast=-1,this.cacheSearchText=""},t.initListener=function(){var e,t,r,i;n.g.log.info("MentionBroker","initListener"),null===(t=null===(e=n.g.SLR)||void 0===e?void 0:e.listen)||void 0===t||t.call(e,j.B.SHOW_FRIEND_SELECTOR,this.handleFriendSelectorModalVisible),null===(i=null===(r=n.g.SLR)||void 0===r?void 0:r.listen)||void 0===i||i.call(r,j.B.HIDE_FRIEND_SELECTOR,this.handleFriendSelectorModalInvisible)},t.popMentionList=function(e){n.g.log.info("MentionBroker","popMentionList");var t=this.spreadsheet.activeSheetId,r=this.getCurrentLineHeight();n.g.log.debug("MentionBroker","popMentionList - currentRowHeight: "+r),this.api.popMentionList(e,r,t,this.chooseCallback)},t.setMentionMenu=function(e){n.g.log.info("MentionBroker","setMentionMenu");var t=this.getCurrentLineHeight();n.g.log.debug("MentionBroker","popMentionList - currentRowHeight: "+t),this.api.setMentionMenu(!0,e,t)},t.getMentionListPosition=function(){var e=this.spreadsheet.parent.view.canvas.clientRect,t=(0,u.p1)();if(t){var r=t.getClientRects();if(null===r||void 0===r?void 0:r.length){var i=r[0];return{x:(i.x||i.left)-e.distanceX,y:(i.y||i.top)+i.height-e.distanceY}}}var a=this.inputManager.alloyRTE.input.getBoundingClientRect();return n.g.log.warn("MentionBroker","getMentionListPosition - Get nativeRange failed, fallback to getBoundingClientRect: "+JSON.stringify(a)),{x:(a.x||a.left)-e.distanceX,y:(a.y||a.top)+a.height-e.distanceY}},e}()),N=(n("../node_modules/regenerator-runtime/runtime.js"),n("../node_modules/core-js/modules/es.promise.js"),n("../node_modules/core-js/modules/es.string.replace.js"),n("../node_modules/core-js/modules/es.string.split.js"),n("../spread-sheet/src/external/resetLocation/utils.ts")),P=n("../spread-sheet/src/base/event/event.ts"),R=(n("../node_modules/core-js/modules/es.array.splice.js"),function(){function e(e){this._renderApi=e.renderApi,this._spreadsheet=e.spreadsheet,this._highlightArr=[]}var t=e.prototype;return t.checkInHighlight=function(e){return this._highlightArr.indexOf(e.id)>=0},t.animate=function(e){var t=this,n=function(n){t.highlightElement(e,!0),l.Z.util.timer.wait(300).run((function(){t.highlightElement(e,!1),null===n||void 0===n||n()}))};n((function(){return l.Z.util.timer.wait(300).run(n)}))},t.highlightElement=function(e,t){if(void 0===t&&(t=!0),t)this.checkInHighlight(e)||this._highlightArr.push(e.id);else if(this.checkInHighlight(e)){var n=this._highlightArr.indexOf(e.id);this._highlightArr.splice(n,1)}this._renderApi.renderRowCells(e.rowIndex)},e}()),k=n("../packages/common-utils/src/index.ts"),A=function(e,t,n,r){return new(n||(n=Promise))((function(i,a){function o(e){try{c(r.next(e))}catch(t){a(t)}}function s(e){try{c(r.throw(e))}catch(t){a(t)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,s)}c((r=r.apply(e,t||[])).next())}))},Z=function(e){function t(){return e.apply(this,arguments)||this}(0,r.Z)(t,e);var n=t.prototype;return n.start=function(e){return A(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n,r=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.getHighlightMentionInfo(e);case 2:if(n=t.sent){t.next=5;break}return t.abrupt("return");case 5:setTimeout((function(){r.animate(n)}),500);case 6:case"end":return t.stop()}}),t,this)})))},n.getHighlightMentionInfo=function(e){return A(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n,r,i,a,o,s,c,l,u,d=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=(0,k.IZ)("mainid",(e||"").replace(/&amp;/g,"&"))){t.next=3;break}return t.abrupt("return",null);case 3:if(r=n.split("|"),i=3===r.length&&r[2]||null){t.next=7;break}return t.abrupt("return",null);case 7:if(a="",3===r.length&&(a=r[0]),o=this._spreadsheet.activeSheetId,!a||a===this._spreadsheet.activeSheetId){t.next=13;break}return t.next=13,new Promise((function(e,t){P.ZP.sheetsBar.trigger("switchSheet",a,o,{onSwitchEnd:function(){return A(d,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e();case 1:case"end":return t.stop()}}),t)})))},onFail:function(){P.ZP.sheetsBar.trigger("switchSheet",o),t()}})}));case 13:return s=r[1],c=(0,N.fe)(!1,s),l=c.rowIndex,u=c.colIndex,t.abrupt("return",{rowIndex:l,colIndex:u,id:i});case 16:case"end":return t.stop()}}),t,this)})))},t}(R),L=(n("../spread-sheet/src/external/mention-ent/varsSettings.ts"),n("../spread-sheet/src/core/data/configService/spreadConfig.ts"),function(e){this.mentionHighlight=new Z(e),this.renderPlugin=new x(Object.assign({mentionHighlight:this.mentionHighlight},e)),this.broker=new T(e)})},"../spread-sheet/src/core/view/level-2/test-api/TestApi.ts":function(e,t,n){n.r(t);var r=n("../node_modules/@babel/runtime/helpers/esm/toConsumableArray.js"),i=(n("../node_modules/core-js/modules/es.array.from.js"),n("../node_modules/core-js/modules/es.string.iterator.js"),n("../node_modules/core-js/modules/web.dom-collections.for-each.js"),n("../node_modules/core-js/modules/es.array.join.js"),n("../node_modules/core-js/modules/es.array.filter.js"),n("../node_modules/core-js/modules/es.array.map.js"),n("../node_modules/core-js/modules/es.array.concat.js"),n("../node_modules/core-js/modules/es.regexp.exec.js"),n("../node_modules/core-js/modules/es.string.split.js"),n("../node_modules/core-js/modules/es.string.starts-with.js"),n("../node_modules/core-js/modules/es.array.iterator.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/web.dom-collections.iterator.js"),n("../node_modules/core-js/modules/es.string.ends-with.js"),n("../packages/model/src/cell/index.ts")),a=n("../spread-sheet/src/core/feature/index.ts"),o=function(){function e(e){this._spreadsheet=e.spreadsheet,this._areaData=e.areaData}var t=e.prototype;return t.isCellVisual=function(e,t){return(e>=this._areaData.row.frozen.renderFrom&&e<=this._areaData.row.frozen.renderTo||e>=this._areaData.row.flow.renderFrom&&e<=this._areaData.row.flow.renderTo)&&(t>=this._areaData.col.frozen.renderFrom&&t<=this._areaData.col.frozen.renderTo||t>=this._areaData.col.flow.renderFrom&&t<=this._areaData.col.flow.renderTo)},t.hasCellErrorCorner=function(e,t){var n=this._spreadsheet.activeSheet.getCellDataAtPosition(e,t);if(!n)return!1;var r=n.getEffectiveValue(),o=a.Z.dataValidation.error.getDataValidationError(n,{rowIndex:e,colIndex:t,options:this._spreadsheet.sheetManager}),s=r&&r.type===i.EXTENDED_VALUE_TYPE.ERROR;return!!o||!!s},t.getTitlebarDomSSR=function(e){var t,n,r=this,i=e.cloneNode(!0);Array.from(i.getElementsByClassName("resize-sensor")).forEach((function(e){return e.remove()}));var a=i.getElementsByClassName("user-info-container");null===(t=null===a||void 0===a?void 0:a[0])||void 0===t||t.remove();var o=null===(n=Array.from(i.getElementsByClassName("pc-header-title")))||void 0===n?void 0:n[0];o&&(o.innerHTML='<div id="workbench_title_ssr" class="melo-doc-title--pOUAC" autocomplete="off" style="color: rgb(0, 0, 0);"></div>');var s=["titlebar-home","titlebar-home-divide","titlebar-title","titlebar-collect","titlebar-move","titlebar-notification","titlebar-pusher","titlebar-form","titlebar-member","titlebar-timeline","titlebar-file","titlebar-edit","titlebar-share","titlebar-avatar-divide","titlebar-avatar"];Array.from(i.children).forEach((function(e,t){e.classList.add("ssrprefix_"+s[t])}));var c=i.outerHTML;return"<style>"+this.getElementAllClassnames(i).map((function(e){return r.getStyleByClassname(e,r.renderTitlebarClassStyle.bind(r))})).reduce((function(e,t){return e.concat(t)}),[]).filter((function(e,t,n){return n.indexOf(e)===t})).join(" ")+"</style>"+c},t.getToolbarDomSSR=function(e){var t=this,n=e.cloneNode(!0);["#hidden-toolbar","#fixed-toolbar-animation"].forEach((function(e){var t=n.querySelector(e);null===t||void 0===t||t.remove()}));var r=n.outerHTML;return"<style>"+this.getElementAllClassnames(n).map((function(e){return t.getStyleByClassname(e,t.renderToolbarClassStyle.bind(t))})).reduce((function(e,t){return e.concat(t)}),[]).filter((function(e,t,n){return n.indexOf(e)===t})).join("  ")+"</style>"+r},t.getElementAllClassnames=function(e){return[e].concat((0,r.Z)(Array.from(e.getElementsByTagName("*")))).map((function(e){return Array.from(e.classList)})).reduce((function(e,t){return e.concat(t)}),[]).filter((function(e,t,n){return n.indexOf(e)===t}))},t.getStyleByClassname=function(e,t){for(var n,r=[],i=0;i<document.styleSheets.length;i++){n=document.styleSheets[i];for(var a=void 0,o=0;o<n.cssRules.length;o++)if(1===(a=n.cssRules[o]).type){var s=t(a,e);s.length&&r.push(s)}}return r},t.renderTitlebarClassStyle=function(e,t){for(var n,r=e.selectorText,i=e.style,a=e.styleMap,o=r.split(","),s=[],c=0;c<o.length;c++){var l=(n=o[c]).split(" "),u=l[l.length-1];(t.startsWith("titlebar-icon")&&u==="."+t||!t.startsWith("titlebar-icon")&&u.indexOf("."+t)>=0)&&n.indexOf(":hover")<0&&n.indexOf(":active")<0&&n.indexOf(":focus")<0&&s.push(n)}if(s.length>0){var d=Array.from(a.keys()),h=[];return d.forEach((function(e){var t=i.getPropertyValue(e);t&&"initial"!==t&&h.push(e+": "+t)})),s.join(" ")+" { "+h.join(";")+"; }"}return""},t.renderToolbarClassStyle=function(e,t){for(var n,r=e.selectorText.split(","),i=0;i<r.length;i++){var a=(n=r[i]).split(" "),o=a[a.length-1];if(o.endsWith("*")||o.indexOf("."+t)>=0&&n.indexOf(":hover")<0&&n.indexOf(":active")<0&&n.indexOf(":focus")<0)return e.cssText}return""},e}();t.default=o},"../spread-sheet/src/external/badgeServiceExcelAdapter/badgeServiceExcelAdapter.interface.ts":function(e,t,n){n.d(t,{P:function(){return r}});var r=(0,n("../node_modules/@tencent/containerized/build/main/index.js").yh)("BadgeServiceExcelAdapter")},"../spread-sheet/src/external/badgeServiceExcelAdapter/config.ts":function(e,t,n){var r;n.d(t,{K:function(){return r}}),function(e){e[e.VALUE_CHANGE=0]="VALUE_CHANGE"}(r||(r={}))},"../spread-sheet/src/external/check-slr/sc-lazy-loader.ts":function(e,t,n){n.d(t,{FU:function(){return g},Hz:function(){return p},LL:function(){return w},Tf:function(){return b},XT:function(){return u},_3:function(){return f},e_:function(){return m},f_:function(){return h},h2:function(){return d},iK:function(){return x},rq:function(){return v},uo:function(){return C},wQ:function(){return y}}),n("../node_modules/regenerator-runtime/runtime.js"),n("../node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),n("../node_modules/core-js/modules/esnext.reflect.metadata.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.promise.js"),n("../node_modules/core-js/modules/es.array.iterator.js"),n("../node_modules/core-js/modules/es.string.iterator.js"),n("../node_modules/core-js/modules/web.dom-collections.iterator.js");var r=n("react"),i=n("../spread-sheet/src/base/util/decorator/loading-decorator.ts"),a=function(e,t,n,r){var i,a=arguments.length,o=a<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)o=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(a<3?i(o):a>3?i(t,n,o):i(t,n))||o);return a>3&&o&&Object.defineProperty(t,n,o),o},o=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},s=function(e,t,n,r){return new(n||(n=Promise))((function(i,a){function o(e){try{c(r.next(e))}catch(t){a(t)}}function s(e){try{c(r.throw(e))}catch(t){a(t)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,s)}c((r=r.apply(e,t||[])).next())}))},c=function(){function e(){}var t=e.prototype;return t.getSCMobileInput=function(){return s(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([n.e("initial_vendors_tencent_dui"),n.e("sc-mobile-input-dialog")]).then(n.t.bind(n,"../node_modules/@tencent/docs-scenario-components-mobile-input-dialog/dist/index.js",23));case 2:return t=e.sent,e.abrupt("return",t);case 4:case"end":return e.stop()}}),e)})))},t.getSCMobileFileSelector=function(){return s(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.e("sc-mobile-file-selector").then(n.t.bind(n,"../node_modules/@tencent/docs-scenario-components-mobile-file-selector/dist/index.js",23));case 2:return t=e.sent,e.abrupt("return",t);case 4:case"end":return e.stop()}}),e)})))},t.getSCPcFileSelector=function(){return s(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.e("sc-pc-file-selector").then(n.t.bind(n,"../node_modules/@tencent/docs-scenario-components-pc-file-selector/dist/index.js",23));case 2:return t=e.sent,e.abrupt("return",t);case 4:case"end":return e.stop()}}),e)})))},t.getSCPaletteOld=function(){return s(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.e("sc-palette-old").then(n.t.bind(n,"../node_modules/@tencent/docs-scenario-components-palette-old/dist/index.js",23));case 2:return t=e.sent,e.abrupt("return",t);case 4:case"end":return e.stop()}}),e)})))},t.getSCPaletteNew=function(){return s(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.e("sc-palette-new").then(n.t.bind(n,"../node_modules/@tencent/docs-scenario-components-pc-palette/dist/index.js",23));case 2:return t=e.sent,e.abrupt("return",t);case 4:case"end":return e.stop()}}),e)})))},t.getSCMobileMenu=function(){return s(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([n.e("initial_vendors_tencent_4"),n.e("sc-mobile-menu")]).then(n.t.bind(n,"../node_modules/@tencent/docs-scenario-components-mobile-menu/dist/index.js",23));case 2:return t=e.sent,e.abrupt("return",t);case 4:case"end":return e.stop()}}),e)})))},t.getSCMobileCamera=function(){return s(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.resolve().then(n.t.bind(n,"../node_modules/@tencent/docs-scenario-components-mobile-camera/dist/index.js",23));case 2:return t=e.sent,e.abrupt("return",t);case 4:case"end":return e.stop()}}),e)})))},t.getSCSaveTemplate=function(){return s(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([n.e("initial_vendors_tencent_dui"),n.e("sc-save-template")]).then(n.t.bind(n,"../node_modules/@tencent/docs-scenario-components-save-template/dist/index.js",23));case 2:return t=e.sent,e.abrupt("return",t);case 4:case"end":return e.stop()}}),e)})))},t.getScMobileMenuMoveFile=function(){return s(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([n.e("initial_vendors_tencent_4"),n.e("sc-mobile-menu-move-file")]).then(n.t.bind(n,"../node_modules/@tencent/docs-scenario-components-mobile-menu-move-file/dist/index.js",23));case 2:return t=e.sent,e.abrupt("return",t);case 4:case"end":return e.stop()}}),e)})))},t.getScMobileTipButton=function(){return s(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.e("sc-mobile-tip-button").then(n.t.bind(n,"../node_modules/@tencent/docs-scenario-components-mobile-tip-button/dist/index.js",23));case 2:return t=e.sent,e.abrupt("return",t);case 4:case"end":return e.stop()}}),e)})))},e}();a([(0,i.n)(),o("design:type",Function),o("design:paramtypes",[]),o("design:returntype",Promise)],c.prototype,"getSCMobileInput",null),a([(0,i.n)(),o("design:type",Function),o("design:paramtypes",[]),o("design:returntype",Promise)],c.prototype,"getSCMobileFileSelector",null),a([(0,i.n)(),o("design:type",Function),o("design:paramtypes",[]),o("design:returntype",Promise)],c.prototype,"getSCPcFileSelector",null),a([(0,i.n)(),o("design:type",Function),o("design:paramtypes",[]),o("design:returntype",Promise)],c.prototype,"getSCPaletteOld",null),a([(0,i.n)(),o("design:type",Function),o("design:paramtypes",[]),o("design:returntype",Promise)],c.prototype,"getSCPaletteNew",null),a([(0,i.n)(),o("design:type",Function),o("design:paramtypes",[]),o("design:returntype",Promise)],c.prototype,"getSCMobileMenu",null),a([(0,i.n)(),o("design:type",Function),o("design:paramtypes",[]),o("design:returntype",Promise)],c.prototype,"getSCMobileCamera",null),a([(0,i.n)(),o("design:type",Function),o("design:paramtypes",[]),o("design:returntype",Promise)],c.prototype,"getSCSaveTemplate",null),a([(0,i.n)(),o("design:type",Function),o("design:paramtypes",[]),o("design:returntype",Promise)],c.prototype,"getScMobileMenuMoveFile",null),a([(0,i.n)(),o("design:type",Function),o("design:paramtypes",[]),o("design:returntype",Promise)],c.prototype,"getScMobileTipButton",null);var l=new c,u="page-editor"==n.j?(0,r.lazy)((function(){return n.e("sc-palette-old").then(n.t.bind(n,"../node_modules/@tencent/docs-scenario-components-palette-old/dist/index.js",23))})):null,d="page-editor"==n.j?(0,r.lazy)((function(){return n.e("sc-palette-new").then(n.t.bind(n,"../node_modules/@tencent/docs-scenario-components-pc-palette/dist/index.js",23))})):null,h="page-editor"==n.j?(0,r.lazy)((function(){return n.e("sc-pc-menu-file-info").then(n.t.bind(n,"../node_modules/@tencent/docs-scenario-components-pc-menu-file-info/dist/index.js",23))})):null,p=l.getSCMobileInput,f=l.getSCMobileFileSelector,v=l.getSCPcFileSelector,g=l.getSCMobileMenu,m=l.getSCMobileCamera,x=l.getSCSaveTemplate,y=l.getScMobileMenuMoveFile,w=l.getSCPaletteOld,b=l.getSCPaletteNew,C=l.getScMobileTipButton},"../spread-sheet/src/external/mention-ent/utils.tsx":function(e,t,n){n.d(t,{W1:function(){return x},eN:function(){return m}}),n("../node_modules/regenerator-runtime/runtime.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.promise.js"),n("../node_modules/core-js/modules/es.array.iterator.js"),n("../node_modules/core-js/modules/es.string.iterator.js"),n("../node_modules/core-js/modules/web.dom-collections.iterator.js"),n("../node_modules/core-js/modules/es.function.name.js"),n("../node_modules/core-js/modules/es.array.concat.js"),n("../node_modules/core-js/modules/web.dom-collections.for-each.js"),n("../node_modules/core-js/modules/es.array.map.js"),n("../node_modules/core-js/modules/es.array.includes.js"),n("../node_modules/core-js/modules/es.string.includes.js");var r=n("../node_modules/lodash/castArray.js"),i=n.n(r),a=n("../node_modules/lodash/uniqWith.js"),o=n.n(a),s=n("../spread-sheet/src/external/mention-ent/varsSettings.ts"),c=n("../spread-sheet/src/core/data/configService/spreadConfig.ts"),l=n("../node_modules/@tencent/docs-user-agent/dist/index.js"),u=n.n(l),d=n("../packages/report/src/index.ts"),h=n("../packages/model/src/cell/metadata/CustomDataType.ts"),p=n("../packages/model/src/cell/index.ts"),f=function(e,t,n,r){return new(n||(n=Promise))((function(i,a){function o(e){try{c(r.next(e))}catch(t){a(t)}}function s(e){try{c(r.throw(e))}catch(t){a(t)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,s)}c((r=r.apply(e,t||[])).next())}))};function v(){return f(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.e("bundle_appwebcomponents").then(n.t.bind(n,"../node_modules/@tencent/web.appwebcomponents/dist/appwebcomponents.umd.js",23));case 2:return t=e.sent.default,e.abrupt("return",t.getWebComponentsInstance());case 4:case"end":return e.stop()}}),e)})))}var g=function(e){return{englishName:e.en_name,name:(null===e||void 0===e?void 0:e.realName)||(null===e||void 0===e?void 0:e.name),vid:e.vid,iconurl:e.imageUrl}};function m(e){var t;return void 0===e&&(e={}),f(this,void 0,void 0,regeneratorRuntime.mark((function r(){var a,l,h,p;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(!(null===(t=null===n.g||void 0===n.g?void 0:n.g.tdocs)||void 0===t?void 0:t.selectContacts)){r.next=2;break}return r.abrupt("return",n.g.tdocs.selectContacts({docId:c.q.getConfig("padId"),showConversationUsers:void 0!==e.showConversationUsers&&e.showConversationUsers,showRecentConvs:void 0!==e.showRecentConvs&&e.showRecentConvs,disabledUserIds:e.disabledUserIds,showExternalUsers:void 0===e.showExternalUsers||e.showExternalUsers,showChainsUsers:!0,showCircleUsers:void 0===e.showCircleUsers||e.showCircleUsers,showOtherContacts:void 0!==e.showOtherContacts&&e.showOtherContacts,showStarUsers:void 0!==e.showStarUsers&&e.showStarUsers,maxSelectCount:null===e||void 0===e?void 0:e.maxSelectCount,showWexinUsers:!0}).then((function(t){var n=t.selectedContacts,r=t.applyExternalVidList,i=t.applyWxList,a=t.selectedOtherContacts,o=n;return r&&r.length>0&&(o=o.concat(r)),i&&i.length>0&&(o=o.concat(i)),a&&a.length>0&&(o=o.concat(a),e.from)&&(d.ZP.kvrOss({itemname:{body:"excel_reaction_body_at",comment:"excel_reaction_comment_at",collab:"excel_reaction_xzz"}[e.from]}),a.forEach((function(t){d.ZP.kvrOss({biz:"wxwork",itemname:"doc_reaction_select_person",Extra1:t.vid,Extra2:0===(null===t||void 0===t?void 0:t.corpId)?2:1,Extra3:"collab"===e.from?2:1,Channel1:2,Channel2:u().isMac?"mac":u().isWindows?"win":u().isAndroid?"android":"ios"})}))),o.map(g)})));case 2:return a=(0,s.Ht)(),r.next=5,v();case 5:return l=r.sent,r.next=8,new Promise((function(t){var n;l.$contactSelector({selected:[],userInfo:{corpid:a},disabledContactIds:(null===(n=e.disabledUserIds)||void 0===n?void 0:n.map((function(e){return parseInt(e,10)})))||[],options:{deleteSelectedDisabled:!0,formatCheckedData:!0,hideSelectedAtRight:!0},cancelHandler:function(){t({action:!1,selected:{}})},comfirmHandler:function(e){(e=i()(e)).forEach((function(e){e.bParty=e.isFolder,e.id=e.isFolder?e.departmentId:e.userId,e.partyName=e.departmentName||"-",e.partyId=e.departmentId})),t({action:!0,selected:o()(JSON.parse(JSON.stringify(e)),(function(e,t){return e.id===t.id}))})}})}));case 8:if(!(h=r.sent).action){r.next=12;break}return p=h.selected.map((function(e){return{englishName:e.english_name,iconurl:e.iconurl,name:e.name,vid:e.userId}})),r.abrupt("return",p);case 12:return r.abrupt("return",[]);case 13:case"end":return r.stop()}}),r)})))}function x(e,t){var n,r,i=SpreadsheetApp.spreadsheet.activeSheet.getCellDataAtPosition(e,t),a=[h.ZP.CHECKBOX,h.ZP.SELECT,h.ZP.STAR],o=[p.DATA_VALIDATION_RULE_TYPE.LIST];return!(!a.includes(null===(n=null===i||void 0===i?void 0:i.getMetadata())||void 0===n?void 0:n.customDataType)&&!o.includes(null===(r=null===i||void 0===i?void 0:i.getDataValidation())||void 0===r?void 0:r.ruleType))}},"../spread-sheet/src/external/rangeAuth/util/range-auth-error-util.ts":function(e,t,n){n.d(t,{J3:function(){return l},ZO:function(){return u},f$:function(){return d}}),n("../node_modules/regenerator-runtime/runtime.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.promise.js"),n("../node_modules/core-js/modules/es.array.iterator.js"),n("../node_modules/core-js/modules/es.string.iterator.js"),n("../node_modules/core-js/modules/web.dom-collections.iterator.js");var r=n("../node_modules/i18next/dist/esm/i18next.js"),i=n("../node_modules/lodash/throttle.js"),a=n.n(i),o=n("../packages/report/src/index.ts"),s=function(e,t,n,r){return new(n||(n=Promise))((function(i,a){function o(e){try{c(r.next(e))}catch(t){a(t)}}function s(e){try{c(r.throw(e))}catch(t){a(t)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,s)}c((r=r.apply(e,t||[])).next())}))},c=function(){return s(void 0,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=3,Promise.resolve().then(n.bind(n,"../node_modules/@tencent/dui/lib/components/Snackbar/index.js"));case 3:case 6:return e.abrupt("return",e.sent);case 4:return e.next=6,Promise.resolve().then(n.bind(n,"../node_modules/@tencent/dui-mobile/lib/components/Snackbar/index.js"));case 7:case"end":return e.stop()}}),e)})))};function l(e){return s(this,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,c();case 2:t.sent.default.show({type:"error",message:e,autoClose:!0,style:{zIndex:10004}});case 4:case"end":return t.stop()}}),t)})))}var u=a()((function(){return s(void 0,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s(void 0,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=3,Promise.resolve().then(n.bind(n,"../node_modules/@tencent/dui/lib/components/Modal/index.js"));case 3:case 6:return e.abrupt("return",e.sent);case 4:return e.next=6,Promise.resolve().then(n.bind(n,"../node_modules/@tencent/dui-mobile/lib/components/Modal/index.js"));case 7:case"end":return e.stop()}}),e)})));case 2:e.sent.default.confirm({title:r.ZP.t("保护范围提示"),content:r.ZP.t("此范围已被保护。如需编辑，请联系创建者「{{value}}」授予权限。",{value:window.clientVars.ownerNick}),cancelText:null,okText:r.ZP.t("确定")}),o.ZP.kvrOss({itemname:"xls_rangeprotect_range_viewer_toast"});case 5:case"end":return e.stop()}}),e)})))}),300,{leading:!0,trailing:!1}),d=a()((function(e){return s(void 0,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,c();case 2:t.sent.default.show({type:"info",message:e,autoClose:!0,style:{zIndex:10004}});case 4:case"end":return t.stop()}}),t)})))}),300,{leading:!0,trailing:!1})},"../spread-sheet/src/external/userGuide/userGuideConfig.ts":function(e,t,n){var r,i;n.d(t,{A:function(){return i},m:function(){return r}}),function(e){e.mobile_double_click_edit="mobile_double_click_edit",e.excel_rightmenu_insert_dot_for_chart="excel_rightmenu_insert_dot_for_chart",e.excel_rightmenu_insert_chart_dot="excel_rightmenu_insert_chart_dot",e.excel_toolbar_protect_range_box_dot="excel_toolbar_protect_range_box_dot",e.excel_toolbar_protect_range_dot="excel_toolbar_protect_range_dot",e.mobile_toolbar_add_red_dot_flag="mobile_toolbar_add_red_dot_flag",e.mobile_toolbar_media_select_photo_red_dot_flag="mobile_toolbar_media_select_photo_red_dot_flag",e.mobile_toolbar_media_take_photo_red_dot_flag="mobile_toolbar_media_take_photo_red_dot_flag",e.toolbar_ind_filter="toolbar_ind_filter",e.ind_filter_switch="ind_filter_switch",e.mobile_file_selector_toolbar_add_red_dot_flag="mobile_file_selector_toolbar_add_red_dot_flag",e.pc_file_selector_toolbar_add_red_dot_flag="pc_file_selector_toolbar_add_red_dot_flag",e.mobile_file_selector_red_dot_flag="mobile_file_selector_red_dot_flag",e.pc_file_selector_red_dot_flag="pc_file_selector_red_dot_flag",e.quick_fill_used="quick_fill_used",e.pc_conditional_format_red_dot_flag="pc_conditional_format_red_dot_flag",e.pc_conditional_format_inner_red_dot_flag="pc_conditional_format_inner_red_dot_flag",e.pc_specail_paste_red_dot_flag="pc_specail_paste_red_dot_flag",e.pc_export_as="pc_export_as",e.pc_export_as_zip="pc_export_as_zip",e.pc_context_menu_insert_cell_img="pc_context_menu_insert_cell_img",e.pc_context_menu_insert_attachment="pc_context_menu_insert_attachment",e.pc_toolbar_insert_cell_img="pc_toolbar_insert_cell_img",e.pc_toobar_item_insert_cell_img="pc_toobar_item_insert_cell_img",e.pc_toolbar_insert_attachment="pc_toolbar_insert_attachment",e.pc_set_watermark_dot="pc_set_watermark_dot",e.excel_rightmenu_watermark_dot="excel_rightmenu_watermark_dot",e.pc_insert_linked_range="pc_insert_linked_range_dot",e.pc_toolbar_data_menu_dot="pc_toolbar_data_menu_dot",e.pc_toolbar_data_validation_submenu_dot="pc_toolbar_data_validation_submenu_dot",e.pc_context_data_validation_dot="pc_context_data_validation_dot",e.pc_excel_rightmenu_relate_dot="pc_excel_rightmenu_relate_dot",e.mobile_excel_rightmenu_relate_dot="mobile_excel_rightmenu_relate_dot",e.pc_sheetbar_add_sheet_dot="pc_sheetbar_add_sheet_dot",e.pc_sheetbar_add_smart_sheet_dot="pc_sheetbar_add_smart_sheet_dot",e.mobile_sheetbar_add_sheet_dot="mobile_sheetbar_add_sheet_dot",e.mobile_sheetbar_add_sheets_from_template_dot="mobile_sheetbar_add_sheets_from_template_dot",e.pad_sheetbar_add_sheet_dot="pad_sheetbar_add_sheet_dot",e.pad_sheetbar_add_smart_sheet_dot="pad_sheetbar_add_smart_sheet_dot"}(r||(r={})),function(e){e.userguideInitialized="userguide_initialized"}(i||(i={}))},"../spread-sheet/src/external/userGuide/util.ts":function(e,t,n){n.d(t,{uo:function(){return s},xt:function(){return o}});var r=n("../spread-sheet/src/base/event/event.ts"),i=n("../spread-sheet/src/external/userGuide/userGuideConfig.ts");function a(){var e,t=null===(e=window.SpreadsheetApp)||void 0===e?void 0:e.serviceCollection;return(null===t||void 0===t?void 0:t.services.get(t.CONFIG.USER_GUIDE))&&t.services.get(t.CONFIG.USER_GUIDE).instance}function o(e){var t=a();if(null===t||void 0===t?void 0:t.isInitialized()){var n=t.getData();null===e||void 0===e||e(n)}else r.ZP.default.one(i.A.userguideInitialized,(function(t){null===e||void 0===e||e(t)}))}function s(e,t){var n=a();n&&n.setData(e,t)}},"../spread-sheet/src/core/view/level-2/filter-center/style/private/down-triangle-active.svg":function(e){e.exports="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxOCIgaGVpZ2h0PSIxOCIgZmlsbC1ydWxlPSJldmVub2RkIj48cmVjdCB3aWR0aD0iMTgiIGhlaWdodD0iMTgiIGZpbGw9IiNlYmViZWIiIHJ4PSIxIi8+PHBhdGggZmlsbD0iI2NiY2RkMSIgZD0iTTE1IDEybC0yIDMtMi0zaDR6TTYuOCAzdjdoMi43TDYgMTVsLTMuNS01aDIuN1YzaDEuNnoiLz48L3N2Zz4="},"../spread-sheet/src/core/view/level-2/filter-center/style/private/down-triangle-hover.svg":function(e){e.exports="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxOCIgaGVpZ2h0PSIxOCIgZmlsbC1ydWxlPSJldmVub2RkIj48cmVjdCB3aWR0aD0iMTgiIGhlaWdodD0iMTgiIGZpbGw9IiNmNWY1ZjUiIHJ4PSIxIi8+PHBhdGggZmlsbD0iI2NiY2RkMSIgZD0iTTE1IDEybC0yIDMtMi0zaDR6TTYuOCAzdjdoMi43TDYgMTVsLTMuNS01aDIuN1YzaDEuNnoiLz48L3N2Zz4="},"../spread-sheet/src/core/view/level-2/filter-center/style/private/down-triangle.svg":function(e){e.exports="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxOCIgaGVpZ2h0PSIxOCIgZmlsbC1ydWxlPSJldmVub2RkIj48cmVjdCB3aWR0aD0iMTgiIGhlaWdodD0iMTgiIGZpbGw9IiNmZmYiIHJ4PSIxIi8+PHBhdGggZmlsbD0iI2NiY2RkMSIgZD0iTTE1IDEybC0yIDMtMi0zaDR6TTYuOCAzdjdoMi43TDYgMTVsLTMuNS01aDIuN1YzaDEuNnoiLz48L3N2Zz4="},"../spread-sheet/src/core/view/level-2/filter-center/style/private/filter-down-active.svg":function(e){e.exports="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxOCIgaGVpZ2h0PSIxOCIgZmlsbC1ydWxlPSJldmVub2RkIj48cmVjdCB3aWR0aD0iMTgiIGhlaWdodD0iMTgiIGZpbGw9IiNlYmViZWIiIHJ4PSIxIi8+PHBhdGggZmlsbD0iI2NiY2RkMSIgZD0iTTEyLjQzNSAzYy4zMTIgMCAuNTY1LjI3LjU2NS42YS42Mi42MiAwIDAgMS0uMTQ5LjQwNWwtNC4xMyA0Ljc4VjEyLjZMNi4yNzggMTVsLS4wMDEtNi4yMTYtNC4xMjgtNC43OGMtLjIxLS4yNDQtLjE5NS0uNjI0LjAzNS0uODQ4QS41NS41NSAwIDAgMSAyLjU2NSAzaDkuODd6TTE0LjYgOHYzLjVIMTZsLTIgMy0yLTNoMS40VjhoMS4yeiIvPjwvc3ZnPg=="},"../spread-sheet/src/core/view/level-2/filter-center/style/private/filter-down-hover.svg":function(e){e.exports="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxOCIgaGVpZ2h0PSIxOCIgZmlsbC1ydWxlPSJldmVub2RkIj48cmVjdCB3aWR0aD0iMTgiIGhlaWdodD0iMTgiIGZpbGw9IiNmNWY1ZjUiIHJ4PSIxIi8+PHBhdGggZmlsbD0iI2NiY2RkMSIgZD0iTTEyLjQzNSAzYy4zMTIgMCAuNTY1LjI3LjU2NS42YS42Mi42MiAwIDAgMS0uMTQ5LjQwNWwtNC4xMyA0Ljc4VjEyLjZMNi4yNzggMTVsLS4wMDEtNi4yMTYtNC4xMjgtNC43OGMtLjIxLS4yNDQtLjE5NS0uNjI0LjAzNS0uODQ4QS41NS41NSAwIDAgMSAyLjU2NSAzaDkuODd6TTE0LjYgOHYzLjVIMTZsLTIgMy0yLTNoMS40VjhoMS4yeiIvPjwvc3ZnPg=="},"../spread-sheet/src/core/view/level-2/filter-center/style/private/filter-down.svg":function(e){e.exports="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxOCIgaGVpZ2h0PSIxOCIgZmlsbC1ydWxlPSJldmVub2RkIj48cmVjdCB3aWR0aD0iMTgiIGhlaWdodD0iMTgiIGZpbGw9IiNmZmYiIHJ4PSIxIi8+PHBhdGggZmlsbD0iI2NiY2RkMSIgZD0iTTEyLjQzNSAzYy4zMTIgMCAuNTY1LjI3LjU2NS42YS42Mi42MiAwIDAgMS0uMTQ5LjQwNWwtNC4xMyA0Ljc4VjEyLjZMNi4yNzggMTVsLS4wMDEtNi4yMTYtNC4xMjgtNC43OGMtLjIxLS4yNDQtLjE5NS0uNjI0LjAzNS0uODQ4QS41NS41NSAwIDAgMSAyLjU2NSAzaDkuODd6TTE0LjYgOHYzLjVIMTZsLTIgMy0yLTNoMS40VjhoMS4yeiIvPjwvc3ZnPg=="},"../spread-sheet/src/core/view/level-2/filter-center/style/private/filter-triangle-active.svg":function(e){e.exports="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxOCIgaGVpZ2h0PSIxOCIgZmlsbC1ydWxlPSJldmVub2RkIj48cmVjdCB3aWR0aD0iMTgiIGhlaWdodD0iMTgiIGZpbGw9IiNlYmViZWIiIHJ4PSIxIi8+PHBhdGggZmlsbD0iI2NiY2RkMSIgZD0iTTEyLjQzNSAzYy4zMTIgMCAuNTY1LjI3LjU2NS42YS42Mi42MiAwIDAgMS0uMTQ5LjQwNWwtNC4xMyA0Ljc4VjEyLjZMNi4yNzggMTVsLS4wMDEtNi4yMTYtNC4xMjgtNC43OGMtLjIxLS4yNDQtLjE5NS0uNjI0LjAzNS0uODQ4QS41NS41NSAwIDAgMSAyLjU2NSAzaDkuODd6TTE2IDEwLjVsLTIgMy0yLTNoNHoiLz48L3N2Zz4="},"../spread-sheet/src/core/view/level-2/filter-center/style/private/filter-triangle-hover.svg":function(e){e.exports="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxOCIgaGVpZ2h0PSIxOCIgZmlsbC1ydWxlPSJldmVub2RkIj48cmVjdCB3aWR0aD0iMTgiIGhlaWdodD0iMTgiIGZpbGw9IiNmNWY1ZjUiIHJ4PSIxIi8+PHBhdGggZmlsbD0iI2NiY2RkMSIgZD0iTTEyLjQzNSAzYy4zMTIgMCAuNTY1LjI3LjU2NS42YS42Mi42MiAwIDAgMS0uMTQ5LjQwNWwtNC4xMyA0Ljc4VjEyLjZMNi4yNzggMTVsLS4wMDEtNi4yMTYtNC4xMjgtNC43OGMtLjIxLS4yNDQtLjE5NS0uNjI0LjAzNS0uODQ4QS41NS41NSAwIDAgMSAyLjU2NSAzaDkuODd6TTE2IDEwLjVsLTIgMy0yLTNoNHoiLz48L3N2Zz4="},"../spread-sheet/src/core/view/level-2/filter-center/style/private/filter-triangle.svg":function(e){e.exports="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxOCIgaGVpZ2h0PSIxOCIgZmlsbC1ydWxlPSJldmVub2RkIj48cmVjdCB3aWR0aD0iMTgiIGhlaWdodD0iMTgiIGZpbGw9IiNmZmYiIHJ4PSIxIi8+PHBhdGggZmlsbD0iI2NiY2RkMSIgZD0iTTEyLjQzNSAzYy4zMTIgMCAuNTY1LjI3LjU2NS42YS42Mi42MiAwIDAgMS0uMTQ5LjQwNWwtNC4xMyA0Ljc4VjEyLjZMNi4yNzggMTVsLS4wMDEtNi4yMTYtNC4xMjgtNC43OGMtLjIxLS4yNDQtLjE5NS0uNjI0LjAzNS0uODQ4QS41NS41NSAwIDAgMSAyLjU2NSAzaDkuODd6TTE2IDEwLjVsLTIgMy0yLTNoNHoiLz48L3N2Zz4="},"../spread-sheet/src/core/view/level-2/filter-center/style/private/filter-up-active.svg":function(e){e.exports="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxOCIgaGVpZ2h0PSIxOCIgZmlsbC1ydWxlPSJldmVub2RkIj48cmVjdCB3aWR0aD0iMTgiIGhlaWdodD0iMTgiIGZpbGw9IiNlYmViZWIiIHJ4PSIxIi8+PHBhdGggZmlsbD0iI2NiY2RkMSIgZD0iTTEyLjQzNSAzYy4zMTIgMCAuNTY1LjI3LjU2NS42YS42Mi42MiAwIDAgMS0uMTQ5LjQwNWwtNC4xMyA0Ljc4VjEyLjZMNi4yNzggMTVsLS4wMDEtNi4yMTYtNC4xMjgtNC43OGMtLjIxLS4yNDQtLjE5NS0uNjI0LjAzNS0uODQ4QS41NS41NSAwIDAgMSAyLjU2NSAzaDkuODd6TTE0IDhsMiAzaC0xLjR2My41aC0xLjJWMTFIMTJsMi0zeiIvPjwvc3ZnPg=="},"../spread-sheet/src/core/view/level-2/filter-center/style/private/filter-up-hover.svg":function(e){e.exports="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxOCIgaGVpZ2h0PSIxOCIgZmlsbC1ydWxlPSJldmVub2RkIj48cmVjdCB3aWR0aD0iMTgiIGhlaWdodD0iMTgiIGZpbGw9IiNmNWY1ZjUiIHJ4PSIxIi8+PHBhdGggZmlsbD0iI2NiY2RkMSIgZD0iTTEyLjQzNSAzYy4zMTIgMCAuNTY1LjI3LjU2NS42YS42Mi42MiAwIDAgMS0uMTQ5LjQwNWwtNC4xMyA0Ljc4VjEyLjZMNi4yNzggMTVsLS4wMDEtNi4yMTYtNC4xMjgtNC43OGMtLjIxLS4yNDQtLjE5NS0uNjI0LjAzNS0uODQ4QS41NS41NSAwIDAgMSAyLjU2NSAzaDkuODd6TTE0IDhsMiAzaC0xLjR2My41aC0xLjJWMTFIMTJsMi0zeiIvPjwvc3ZnPg=="},"../spread-sheet/src/core/view/level-2/filter-center/style/private/filter-up.svg":function(e){e.exports="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxOCIgaGVpZ2h0PSIxOCIgZmlsbC1ydWxlPSJldmVub2RkIj48cmVjdCB3aWR0aD0iMTgiIGhlaWdodD0iMTgiIGZpbGw9IiNmZmYiIHJ4PSIxIi8+PHBhdGggZmlsbD0iI2NiY2RkMSIgZD0iTTEyLjQzNSAzYy4zMTIgMCAuNTY1LjI3LjU2NS42YS42Mi42MiAwIDAgMS0uMTQ5LjQwNWwtNC4xMyA0Ljc4VjEyLjZMNi4yNzggMTVsLS4wMDEtNi4yMTYtNC4xMjgtNC43OGMtLjIxLS4yNDQtLjE5NS0uNjI0LjAzNS0uODQ4QS41NS41NSAwIDAgMSAyLjU2NSAzaDkuODd6TTE0IDhsMiAzaC0xLjR2My41aC0xLjJWMTFIMTJsMi0zeiIvPjwvc3ZnPg=="},"../spread-sheet/src/core/view/level-2/filter-center/style/private/half-filter-active.svg":function(e){e.exports="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxOCIgaGVpZ2h0PSIxOCIgZmlsbC1ydWxlPSJldmVub2RkIj48cmVjdCB3aWR0aD0iMTgiIGhlaWdodD0iMTgiIGZpbGw9IiNlYmViZWIiIHJ4PSIxIi8+PHBhdGggZmlsbD0iI2NiY2RkMSIgZD0iTTkuNyAxMHY1SDguNHYtNWgxLjN6TTExIDcuNnYxLjNIN1Y3LjZoNHptMi0yLjN2MS4zSDVWNS4zaDh6TTE1LjUgM3YxLjNoLTEzVjNoMTN6Ii8+PC9zdmc+"},"../spread-sheet/src/core/view/level-2/filter-center/style/private/half-filter-hover.svg":function(e){e.exports="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxOCIgaGVpZ2h0PSIxOCIgZmlsbC1ydWxlPSJldmVub2RkIj48cmVjdCB3aWR0aD0iMTgiIGhlaWdodD0iMTgiIGZpbGw9IiNmNWY1ZjUiIHJ4PSIxIi8+PHBhdGggZmlsbD0iI2NiY2RkMSIgZD0iTTkuNyAxMHY1SDguNHYtNWgxLjN6TTExIDcuNnYxLjNIN1Y3LjZoNHptMi0yLjN2MS4zSDVWNS4zaDh6TTE1LjUgM3YxLjNoLTEzVjNoMTN6Ii8+PC9zdmc+"},"../spread-sheet/src/core/view/level-2/filter-center/style/private/half-filter.svg":function(e){e.exports="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxOCIgaGVpZ2h0PSIxOCIgZmlsbC1ydWxlPSJldmVub2RkIj48cmVjdCB3aWR0aD0iMTgiIGhlaWdodD0iMTgiIGZpbGw9IiNmZmYiIHJ4PSIxIi8+PHBhdGggZmlsbD0iI2NiY2RkMSIgZD0iTTkuNyAxMHY1SDguNHYtNWgxLjN6TTExIDcuNnYxLjNIN1Y3LjZoNHptMi0yLjN2MS4zSDVWNS4zaDh6TTE1LjUgM3YxLjNoLTEzVjNoMTN6Ii8+PC9zdmc+"},"../spread-sheet/src/core/view/level-2/filter-center/style/private/up-triangle-active.svg":function(e){e.exports="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxOCIgaGVpZ2h0PSIxOCIgZmlsbC1ydWxlPSJldmVub2RkIj48cmVjdCB3aWR0aD0iMTgiIGhlaWdodD0iMTgiIGZpbGw9IiNlYmViZWIiIHJ4PSIxIi8+PHBhdGggZmlsbD0iI2NiY2RkMSIgZD0iTTE1IDEybC0yIDMtMi0zaDR6TTYgM2wzLjUgNUg2Ljh2N0g1LjJWOEgyLjVMNiAzeiIvPjwvc3ZnPg=="},"../spread-sheet/src/core/view/level-2/filter-center/style/private/up-triangle-hover.svg":function(e){e.exports="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxOCIgaGVpZ2h0PSIxOCIgZmlsbC1ydWxlPSJldmVub2RkIj48cmVjdCB3aWR0aD0iMTgiIGhlaWdodD0iMTgiIGZpbGw9IiNmNWY1ZjUiIHJ4PSIxIi8+PHBhdGggZmlsbD0iI2NiY2RkMSIgZD0iTTE1IDEybC0yIDMtMi0zaDR6TTYgM2wzLjUgNUg2Ljh2N0g1LjJWOEgyLjVMNiAzeiIvPjwvc3ZnPg=="},"../spread-sheet/src/core/view/level-2/filter-center/style/private/up-triangle.svg":function(e){e.exports="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxOCIgaGVpZ2h0PSIxOCIgZmlsbC1ydWxlPSJldmVub2RkIj48cmVjdCB3aWR0aD0iMTgiIGhlaWdodD0iMTgiIGZpbGw9IiNmZmYiIHJ4PSIxIi8+PHBhdGggZmlsbD0iI2NiY2RkMSIgZD0iTTE1IDEybC0yIDMtMi0zaDR6TTYgM2wzLjUgNUg2Ljh2N0g1LjJWOEgyLjVMNiAzeiIvPjwvc3ZnPg=="},"../spread-sheet/src/core/view/level-2/filter-center/style/sync-off/down-triangle-active.svg":function(e){e.exports="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxOCIgaGVpZ2h0PSIxOCIgZmlsbC1ydWxlPSJldmVub2RkIj48cmVjdCB3aWR0aD0iMTgiIGhlaWdodD0iMTgiIGZpbGw9IiNlYmViZWIiIHJ4PSIxIi8+PHBhdGggZmlsbD0iIzFlNmZmZiIgZD0iTTE1IDEybC0yIDMtMi0zaDR6TTYuOCAzdjdoMi43TDYgMTVsLTMuNS01aDIuN1YzaDEuNnoiLz48L3N2Zz4="},"../spread-sheet/src/core/view/level-2/filter-center/style/sync-off/down-triangle-hover.svg":function(e){e.exports="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxOCIgaGVpZ2h0PSIxOCIgZmlsbC1ydWxlPSJldmVub2RkIj48cmVjdCB3aWR0aD0iMTgiIGhlaWdodD0iMTgiIGZpbGw9IiNmNWY1ZjUiIHJ4PSIxIi8+PHBhdGggZmlsbD0iIzFlNmZmZiIgZD0iTTE1IDEybC0yIDMtMi0zaDR6TTYuOCAzdjdoMi43TDYgMTVsLTMuNS01aDIuN1YzaDEuNnoiLz48L3N2Zz4="},"../spread-sheet/src/core/view/level-2/filter-center/style/sync-off/down-triangle.svg":function(e){e.exports="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxOCIgaGVpZ2h0PSIxOCIgZmlsbC1ydWxlPSJldmVub2RkIj48cmVjdCB3aWR0aD0iMTgiIGhlaWdodD0iMTgiIGZpbGw9IiNmZmYiIHJ4PSIxIi8+PHBhdGggZmlsbD0iIzFlNmZmZiIgZD0iTTE1IDEybC0yIDMtMi0zaDR6TTYuOCAzdjdoMi43TDYgMTVsLTMuNS01aDIuN1YzaDEuNnoiLz48L3N2Zz4="},"../spread-sheet/src/core/view/level-2/filter-center/style/sync-off/filter-down-active.svg":function(e){e.exports="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxOCIgaGVpZ2h0PSIxOCIgZmlsbC1ydWxlPSJldmVub2RkIj48cmVjdCB3aWR0aD0iMTgiIGhlaWdodD0iMTgiIGZpbGw9IiNlYmViZWIiIHJ4PSIxIi8+PHBhdGggZmlsbD0iIzFlNmZmZiIgZD0iTTEyLjQzNSAzYy4zMTIgMCAuNTY1LjI3LjU2NS42YS42Mi42MiAwIDAgMS0uMTQ5LjQwNWwtNC4xMyA0Ljc4VjEyLjZMNi4yNzggMTVsLS4wMDEtNi4yMTYtNC4xMjgtNC43OGMtLjIxLS4yNDQtLjE5NS0uNjI0LjAzNS0uODQ4QS41NS41NSAwIDAgMSAyLjU2NSAzaDkuODd6TTE0LjYgOHYzLjVIMTZsLTIgMy0yLTNoMS40VjhoMS4yeiIvPjwvc3ZnPg=="},"../spread-sheet/src/core/view/level-2/filter-center/style/sync-off/filter-down-hover.svg":function(e){e.exports="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxOCIgaGVpZ2h0PSIxOCIgZmlsbC1ydWxlPSJldmVub2RkIj48cmVjdCB3aWR0aD0iMTgiIGhlaWdodD0iMTgiIGZpbGw9IiNmNWY1ZjUiIHJ4PSIxIi8+PHBhdGggZmlsbD0iIzFlNmZmZiIgZD0iTTEyLjQzNSAzYy4zMTIgMCAuNTY1LjI3LjU2NS42YS42Mi42MiAwIDAgMS0uMTQ5LjQwNWwtNC4xMyA0Ljc4VjEyLjZMNi4yNzggMTVsLS4wMDEtNi4yMTYtNC4xMjgtNC43OGMtLjIxLS4yNDQtLjE5NS0uNjI0LjAzNS0uODQ4QS41NS41NSAwIDAgMSAyLjU2NSAzaDkuODd6TTE0LjYgOHYzLjVIMTZsLTIgMy0yLTNoMS40VjhoMS4yeiIvPjwvc3ZnPg=="},"../spread-sheet/src/core/view/level-2/filter-center/style/sync-off/filter-down.svg":function(e){e.exports="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxOCIgaGVpZ2h0PSIxOCIgZmlsbC1ydWxlPSJldmVub2RkIj48cmVjdCB3aWR0aD0iMTgiIGhlaWdodD0iMTgiIGZpbGw9IiNmZmYiIHJ4PSIxIi8+PHBhdGggZmlsbD0iIzFlNmZmZiIgZD0iTTEyLjQzNSAzYy4zMTIgMCAuNTY1LjI3LjU2NS42YS42Mi42MiAwIDAgMS0uMTQ5LjQwNWwtNC4xMyA0Ljc4VjEyLjZMNi4yNzggMTVsLS4wMDEtNi4yMTYtNC4xMjgtNC43OGMtLjIxLS4yNDQtLjE5NS0uNjI0LjAzNS0uODQ4QS41NS41NSAwIDAgMSAyLjU2NSAzaDkuODd6TTE0LjYgOHYzLjVIMTZsLTIgMy0yLTNoMS40VjhoMS4yeiIvPjwvc3ZnPg=="},"../spread-sheet/src/core/view/level-2/filter-center/style/sync-off/filter-triangle-active.svg":function(e){e.exports="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxOCIgaGVpZ2h0PSIxOCIgZmlsbC1ydWxlPSJldmVub2RkIj48cmVjdCB3aWR0aD0iMTgiIGhlaWdodD0iMTgiIGZpbGw9IiNlYmViZWIiIHJ4PSIxIi8+PHBhdGggZmlsbD0iIzFlNmZmZiIgZD0iTTEyLjQzNSAzYy4zMTIgMCAuNTY1LjI3LjU2NS42YS42Mi42MiAwIDAgMS0uMTQ5LjQwNWwtNC4xMyA0Ljc4VjEyLjZMNi4yNzggMTVsLS4wMDEtNi4yMTYtNC4xMjgtNC43OGMtLjIxLS4yNDQtLjE5NS0uNjI0LjAzNS0uODQ4QS41NS41NSAwIDAgMSAyLjU2NSAzaDkuODd6TTE2IDEwLjVsLTIgMy0yLTNoNHoiLz48L3N2Zz4="},"../spread-sheet/src/core/view/level-2/filter-center/style/sync-off/filter-triangle-hover.svg":function(e){e.exports="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxOCIgaGVpZ2h0PSIxOCIgZmlsbC1ydWxlPSJldmVub2RkIj48cmVjdCB3aWR0aD0iMTgiIGhlaWdodD0iMTgiIGZpbGw9IiNmNWY1ZjUiIHJ4PSIxIi8+PHBhdGggZmlsbD0iIzFlNmZmZiIgZD0iTTEyLjQzNSAzYy4zMTIgMCAuNTY1LjI3LjU2NS42YS42Mi42MiAwIDAgMS0uMTQ5LjQwNWwtNC4xMyA0Ljc4VjEyLjZMNi4yNzggMTVsLS4wMDEtNi4yMTYtNC4xMjgtNC43OGMtLjIxLS4yNDQtLjE5NS0uNjI0LjAzNS0uODQ4QS41NS41NSAwIDAgMSAyLjU2NSAzaDkuODd6TTE2IDEwLjVsLTIgMy0yLTNoNHoiLz48L3N2Zz4="},"../spread-sheet/src/core/view/level-2/filter-center/style/sync-off/filter-triangle.svg":function(e){e.exports="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxOCIgaGVpZ2h0PSIxOCIgZmlsbC1ydWxlPSJldmVub2RkIj48cmVjdCB3aWR0aD0iMTgiIGhlaWdodD0iMTgiIGZpbGw9IiNmZmYiIHJ4PSIxIi8+PHBhdGggZmlsbD0iIzFlNmZmZiIgZD0iTTEyLjQzNSAzYy4zMTIgMCAuNTY1LjI3LjU2NS42YS42Mi42MiAwIDAgMS0uMTQ5LjQwNWwtNC4xMyA0Ljc4VjEyLjZMNi4yNzggMTVsLS4wMDEtNi4yMTYtNC4xMjgtNC43OGMtLjIxLS4yNDQtLjE5NS0uNjI0LjAzNS0uODQ4QS41NS41NSAwIDAgMSAyLjU2NSAzaDkuODd6TTE2IDEwLjVsLTIgMy0yLTNoNHoiLz48L3N2Zz4="},"../spread-sheet/src/core/view/level-2/filter-center/style/sync-off/filter-up-active.svg":function(e){e.exports="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxOCIgaGVpZ2h0PSIxOCIgZmlsbC1ydWxlPSJldmVub2RkIj48cmVjdCB3aWR0aD0iMTgiIGhlaWdodD0iMTgiIGZpbGw9IiNlYmViZWIiIHJ4PSIxIi8+PHBhdGggZmlsbD0iIzFlNmZmZiIgZD0iTTEyLjQzNSAzYy4zMTIgMCAuNTY1LjI3LjU2NS42YS42Mi42MiAwIDAgMS0uMTQ5LjQwNWwtNC4xMyA0Ljc4VjEyLjZMNi4yNzggMTVsLS4wMDEtNi4yMTYtNC4xMjgtNC43OGMtLjIxLS4yNDQtLjE5NS0uNjI0LjAzNS0uODQ4QS41NS41NSAwIDAgMSAyLjU2NSAzaDkuODd6TTE0IDhsMiAzaC0xLjR2My41aC0xLjJWMTFIMTJsMi0zeiIvPjwvc3ZnPg=="},"../spread-sheet/src/core/view/level-2/filter-center/style/sync-off/filter-up-hover.svg":function(e){e.exports="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxOCIgaGVpZ2h0PSIxOCIgZmlsbC1ydWxlPSJldmVub2RkIj48cmVjdCB3aWR0aD0iMTgiIGhlaWdodD0iMTgiIGZpbGw9IiNmNWY1ZjUiIHJ4PSIxIi8+PHBhdGggZmlsbD0iIzFlNmZmZiIgZD0iTTEyLjQzNSAzYy4zMTIgMCAuNTY1LjI3LjU2NS42YS42Mi42MiAwIDAgMS0uMTQ5LjQwNWwtNC4xMyA0Ljc4VjEyLjZMNi4yNzggMTVsLS4wMDEtNi4yMTYtNC4xMjgtNC43OGMtLjIxLS4yNDQtLjE5NS0uNjI0LjAzNS0uODQ4QS41NS41NSAwIDAgMSAyLjU2NSAzaDkuODd6TTE0IDhsMiAzaC0xLjR2My41aC0xLjJWMTFIMTJsMi0zeiIvPjwvc3ZnPg=="},"../spread-sheet/src/core/view/level-2/filter-center/style/sync-off/filter-up.svg":function(e){e.exports="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxOCIgaGVpZ2h0PSIxOCIgZmlsbC1ydWxlPSJldmVub2RkIj48cmVjdCB3aWR0aD0iMTgiIGhlaWdodD0iMTgiIGZpbGw9IiNmZmYiIHJ4PSIxIi8+PHBhdGggZmlsbD0iIzFlNmZmZiIgZD0iTTEyLjQzNSAzYy4zMTIgMCAuNTY1LjI3LjU2NS42YS42Mi42MiAwIDAgMS0uMTQ5LjQwNWwtNC4xMyA0Ljc4VjEyLjZMNi4yNzggMTVsLS4wMDEtNi4yMTYtNC4xMjgtNC43OGMtLjIxLS4yNDQtLjE5NS0uNjI0LjAzNS0uODQ4QS41NS41NSAwIDAgMSAyLjU2NSAzaDkuODd6TTE0IDhsMiAzaC0xLjR2My41aC0xLjJWMTFIMTJsMi0zeiIvPjwvc3ZnPg=="},"../spread-sheet/src/core/view/level-2/filter-center/style/sync-off/half-filter-active.svg":function(e){e.exports="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxOCIgaGVpZ2h0PSIxOCIgZmlsbC1ydWxlPSJldmVub2RkIj48cmVjdCB3aWR0aD0iMTgiIGhlaWdodD0iMTgiIGZpbGw9IiNlYmViZWIiIHJ4PSIxIi8+PHBhdGggZmlsbD0iIzFlNmZmZiIgZD0iTTkuNyAxMHY1SDguNHYtNWgxLjN6TTExIDcuNnYxLjNIN1Y3LjZoNHptMi0yLjN2MS4zSDVWNS4zaDh6TTE1LjUgM3YxLjNoLTEzVjNoMTN6Ii8+PC9zdmc+"},"../spread-sheet/src/core/view/level-2/filter-center/style/sync-off/half-filter-hover.svg":function(e){e.exports="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxOCIgaGVpZ2h0PSIxOCIgZmlsbC1ydWxlPSJldmVub2RkIj48cmVjdCB3aWR0aD0iMTgiIGhlaWdodD0iMTgiIGZpbGw9IiNmNWY1ZjUiIHJ4PSIxIi8+PHBhdGggZmlsbD0iIzFlNmZmZiIgZD0iTTkuNyAxMHY1SDguNHYtNWgxLjN6TTExIDcuNnYxLjNIN1Y3LjZoNHptMi0yLjN2MS4zSDVWNS4zaDh6TTE1LjUgM3YxLjNoLTEzVjNoMTN6Ii8+PC9zdmc+"},"../spread-sheet/src/core/view/level-2/filter-center/style/sync-off/half-filter.svg":function(e){e.exports="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxOCIgaGVpZ2h0PSIxOCIgZmlsbC1ydWxlPSJldmVub2RkIj48cmVjdCB3aWR0aD0iMTgiIGhlaWdodD0iMTgiIGZpbGw9IiNmZmYiIHJ4PSIxIi8+PHBhdGggZmlsbD0iIzFlNmZmZiIgZD0iTTkuNyAxMHY1SDguNHYtNWgxLjN6TTExIDcuNnYxLjNIN1Y3LjZoNHptMi0yLjN2MS4zSDVWNS4zaDh6TTE1LjUgM3YxLjNoLTEzVjNoMTN6Ii8+PC9zdmc+"},"../spread-sheet/src/core/view/level-2/filter-center/style/sync-off/up-triangle-active.svg":function(e){e.exports="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxOCIgaGVpZ2h0PSIxOCIgZmlsbC1ydWxlPSJldmVub2RkIj48cmVjdCB3aWR0aD0iMTgiIGhlaWdodD0iMTgiIGZpbGw9IiNlYmViZWIiIHJ4PSIxIi8+PHBhdGggZmlsbD0iIzFlNmZmZiIgZD0iTTE1IDEybC0yIDMtMi0zaDR6TTYgM2wzLjUgNUg2Ljh2N0g1LjJWOEgyLjVMNiAzeiIvPjwvc3ZnPg=="},"../spread-sheet/src/core/view/level-2/filter-center/style/sync-off/up-triangle-hover.svg":function(e){e.exports="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxOCIgaGVpZ2h0PSIxOCIgZmlsbC1ydWxlPSJldmVub2RkIj48cmVjdCB3aWR0aD0iMTgiIGhlaWdodD0iMTgiIGZpbGw9IiNmNWY1ZjUiIHJ4PSIxIi8+PHBhdGggZmlsbD0iIzFlNmZmZiIgZD0iTTE1IDEybC0yIDMtMi0zaDR6TTYgM2wzLjUgNUg2Ljh2N0g1LjJWOEgyLjVMNiAzeiIvPjwvc3ZnPg=="},"../spread-sheet/src/core/view/level-2/filter-center/style/sync-off/up-triangle.svg":function(e){e.exports="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxOCIgaGVpZ2h0PSIxOCIgZmlsbC1ydWxlPSJldmVub2RkIj48cmVjdCB3aWR0aD0iMTgiIGhlaWdodD0iMTgiIGZpbGw9IiNmZmYiIHJ4PSIxIi8+PHBhdGggZmlsbD0iIzFlNmZmZiIgZD0iTTE1IDEybC0yIDMtMi0zaDR6TTYgM2wzLjUgNUg2Ljh2N0g1LjJWOEgyLjVMNiAzeiIvPjwvc3ZnPg=="},"../spread-sheet/src/core/view/level-2/filter-center/style/sync-on/down-triangle-active.svg":function(e){e.exports="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxOCIgaGVpZ2h0PSIxOCIgZmlsbC1ydWxlPSJldmVub2RkIj48cmVjdCB3aWR0aD0iMTgiIGhlaWdodD0iMTgiIGZpbGw9IiNlYmViZWIiIHJ4PSIxIi8+PHBhdGggZmlsbD0iIzAxYmQ4OCIgZD0iTTE1IDEybC0yIDMtMi0zaDR6TTYuOCAzdjdoMi43TDYgMTVsLTMuNS01aDIuN1YzaDEuNnoiLz48L3N2Zz4="},"../spread-sheet/src/core/view/level-2/filter-center/style/sync-on/down-triangle-hover.svg":function(e){e.exports="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxOCIgaGVpZ2h0PSIxOCIgZmlsbC1ydWxlPSJldmVub2RkIj48cmVjdCB3aWR0aD0iMTgiIGhlaWdodD0iMTgiIGZpbGw9IiNmNWY1ZjUiIHJ4PSIxIi8+PHBhdGggZmlsbD0iIzAxYmQ4OCIgZD0iTTE1IDEybC0yIDMtMi0zaDR6TTYuOCAzdjdoMi43TDYgMTVsLTMuNS01aDIuN1YzaDEuNnoiLz48L3N2Zz4="},"../spread-sheet/src/core/view/level-2/filter-center/style/sync-on/down-triangle.svg":function(e){e.exports="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxOCIgaGVpZ2h0PSIxOCIgZmlsbC1ydWxlPSJldmVub2RkIj48cmVjdCB3aWR0aD0iMTgiIGhlaWdodD0iMTgiIGZpbGw9IiNmZmYiIHJ4PSIxIi8+PHBhdGggZmlsbD0iIzAxYmQ4OCIgZD0iTTE1IDEybC0yIDMtMi0zaDR6TTYuOCAzdjdoMi43TDYgMTVsLTMuNS01aDIuN1YzaDEuNnoiLz48L3N2Zz4="},"../spread-sheet/src/core/view/level-2/filter-center/style/sync-on/filter-down-active.svg":function(e){e.exports="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxOCIgaGVpZ2h0PSIxOCIgZmlsbC1ydWxlPSJldmVub2RkIj48cmVjdCB3aWR0aD0iMTgiIGhlaWdodD0iMTgiIGZpbGw9IiNlYmViZWIiIHJ4PSIxIi8+PHBhdGggZmlsbD0iIzAxYmQ4OCIgZD0iTTEyLjQzNSAzYy4zMTIgMCAuNTY1LjI3LjU2NS42YS42Mi42MiAwIDAgMS0uMTQ5LjQwNWwtNC4xMyA0Ljc4VjEyLjZMNi4yNzggMTVsLS4wMDEtNi4yMTYtNC4xMjgtNC43OGMtLjIxLS4yNDQtLjE5NS0uNjI0LjAzNS0uODQ4QS41NS41NSAwIDAgMSAyLjU2NSAzaDkuODd6TTE0LjYgOHYzLjVIMTZsLTIgMy0yLTNoMS40VjhoMS4yeiIvPjwvc3ZnPg=="},"../spread-sheet/src/core/view/level-2/filter-center/style/sync-on/filter-down-hover.svg":function(e){e.exports="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxOCIgaGVpZ2h0PSIxOCIgZmlsbC1ydWxlPSJldmVub2RkIj48cmVjdCB3aWR0aD0iMTgiIGhlaWdodD0iMTgiIGZpbGw9IiNmNWY1ZjUiIHJ4PSIxIi8+PHBhdGggZmlsbD0iIzAxYmQ4OCIgZD0iTTEyLjQzNSAzYy4zMTIgMCAuNTY1LjI3LjU2NS42YS42Mi42MiAwIDAgMS0uMTQ5LjQwNWwtNC4xMyA0Ljc4VjEyLjZMNi4yNzggMTVsLS4wMDEtNi4yMTYtNC4xMjgtNC43OGMtLjIxLS4yNDQtLjE5NS0uNjI0LjAzNS0uODQ4QS41NS41NSAwIDAgMSAyLjU2NSAzaDkuODd6TTE0LjYgOHYzLjVIMTZsLTIgMy0yLTNoMS40VjhoMS4yeiIvPjwvc3ZnPg=="},"../spread-sheet/src/core/view/level-2/filter-center/style/sync-on/filter-down.svg":function(e){e.exports="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxOCIgaGVpZ2h0PSIxOCIgZmlsbC1ydWxlPSJldmVub2RkIj48cmVjdCB3aWR0aD0iMTgiIGhlaWdodD0iMTgiIGZpbGw9IiNmZmYiIHJ4PSIxIi8+PHBhdGggZmlsbD0iIzAxYmQ4OCIgZD0iTTEyLjQzNSAzYy4zMTIgMCAuNTY1LjI3LjU2NS42YS42Mi42MiAwIDAgMS0uMTQ5LjQwNWwtNC4xMyA0Ljc4VjEyLjZMNi4yNzggMTVsLS4wMDEtNi4yMTYtNC4xMjgtNC43OGMtLjIxLS4yNDQtLjE5NS0uNjI0LjAzNS0uODQ4QS41NS41NSAwIDAgMSAyLjU2NSAzaDkuODd6TTE0LjYgOHYzLjVIMTZsLTIgMy0yLTNoMS40VjhoMS4yeiIvPjwvc3ZnPg=="},"../spread-sheet/src/core/view/level-2/filter-center/style/sync-on/filter-triangle-active.svg":function(e){e.exports="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxOCIgaGVpZ2h0PSIxOCIgZmlsbC1ydWxlPSJldmVub2RkIj48cmVjdCB3aWR0aD0iMTgiIGhlaWdodD0iMTgiIGZpbGw9IiNlYmViZWIiIHJ4PSIxIi8+PHBhdGggZmlsbD0iIzAxYmQ4OCIgZD0iTTEyLjQzNSAzYy4zMTIgMCAuNTY1LjI3LjU2NS42YS42Mi42MiAwIDAgMS0uMTQ5LjQwNWwtNC4xMyA0Ljc4VjEyLjZMNi4yNzggMTVsLS4wMDEtNi4yMTYtNC4xMjgtNC43OGMtLjIxLS4yNDQtLjE5NS0uNjI0LjAzNS0uODQ4QS41NS41NSAwIDAgMSAyLjU2NSAzaDkuODd6TTE2IDEwLjVsLTIgMy0yLTNoNHoiLz48L3N2Zz4="},"../spread-sheet/src/core/view/level-2/filter-center/style/sync-on/filter-triangle-hover.svg":function(e){e.exports="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxOCIgaGVpZ2h0PSIxOCIgZmlsbC1ydWxlPSJldmVub2RkIj48cmVjdCB3aWR0aD0iMTgiIGhlaWdodD0iMTgiIGZpbGw9IiNmNWY1ZjUiIHJ4PSIxIi8+PHBhdGggZmlsbD0iIzAxYmQ4OCIgZD0iTTEyLjQzNSAzYy4zMTIgMCAuNTY1LjI3LjU2NS42YS42Mi42MiAwIDAgMS0uMTQ5LjQwNWwtNC4xMyA0Ljc4VjEyLjZMNi4yNzggMTVsLS4wMDEtNi4yMTYtNC4xMjgtNC43OGMtLjIxLS4yNDQtLjE5NS0uNjI0LjAzNS0uODQ4QS41NS41NSAwIDAgMSAyLjU2NSAzaDkuODd6TTE2IDEwLjVsLTIgMy0yLTNoNHoiLz48L3N2Zz4="},"../spread-sheet/src/core/view/level-2/filter-center/style/sync-on/filter-triangle.svg":function(e){e.exports="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxOCIgaGVpZ2h0PSIxOCIgZmlsbC1ydWxlPSJldmVub2RkIj48cmVjdCB3aWR0aD0iMTgiIGhlaWdodD0iMTgiIGZpbGw9IiNmZmYiIHJ4PSIxIi8+PHBhdGggZmlsbD0iIzAxYmQ4OCIgZD0iTTEyLjQzNSAzYy4zMTIgMCAuNTY1LjI3LjU2NS42YS42Mi42MiAwIDAgMS0uMTQ5LjQwNWwtNC4xMyA0Ljc4VjEyLjZMNi4yNzggMTVsLS4wMDEtNi4yMTYtNC4xMjgtNC43OGMtLjIxLS4yNDQtLjE5NS0uNjI0LjAzNS0uODQ4QS41NS41NSAwIDAgMSAyLjU2NSAzaDkuODd6TTE2IDEwLjVsLTIgMy0yLTNoNHoiLz48L3N2Zz4="},"../spread-sheet/src/core/view/level-2/filter-center/style/sync-on/filter-up-active.svg":function(e){e.exports="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxOCIgaGVpZ2h0PSIxOCIgZmlsbC1ydWxlPSJldmVub2RkIj48cmVjdCB3aWR0aD0iMTgiIGhlaWdodD0iMTgiIGZpbGw9IiNlYmViZWIiIHJ4PSIxIi8+PHBhdGggZmlsbD0iIzAxYmQ4OCIgZD0iTTEyLjQzNSAzYy4zMTIgMCAuNTY1LjI3LjU2NS42YS42Mi42MiAwIDAgMS0uMTQ5LjQwNWwtNC4xMyA0Ljc4VjEyLjZMNi4yNzggMTVsLS4wMDEtNi4yMTYtNC4xMjgtNC43OGMtLjIxLS4yNDQtLjE5NS0uNjI0LjAzNS0uODQ4QS41NS41NSAwIDAgMSAyLjU2NSAzaDkuODd6TTE0IDhsMiAzaC0xLjR2My41aC0xLjJWMTFIMTJsMi0zeiIvPjwvc3ZnPg=="},"../spread-sheet/src/core/view/level-2/filter-center/style/sync-on/filter-up-hover.svg":function(e){e.exports="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxOCIgaGVpZ2h0PSIxOCIgZmlsbC1ydWxlPSJldmVub2RkIj48cmVjdCB3aWR0aD0iMTgiIGhlaWdodD0iMTgiIGZpbGw9IiNmNWY1ZjUiIHJ4PSIxIi8+PHBhdGggZmlsbD0iIzAxYmQ4OCIgZD0iTTEyLjQzNSAzYy4zMTIgMCAuNTY1LjI3LjU2NS42YS42Mi42MiAwIDAgMS0uMTQ5LjQwNWwtNC4xMyA0Ljc4VjEyLjZMNi4yNzggMTVsLS4wMDEtNi4yMTYtNC4xMjgtNC43OGMtLjIxLS4yNDQtLjE5NS0uNjI0LjAzNS0uODQ4QS41NS41NSAwIDAgMSAyLjU2NSAzaDkuODd6TTE0IDhsMiAzaC0xLjR2My41aC0xLjJWMTFIMTJsMi0zeiIvPjwvc3ZnPg=="},"../spread-sheet/src/core/view/level-2/filter-center/style/sync-on/filter-up.svg":function(e){e.exports="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxOCIgaGVpZ2h0PSIxOCIgZmlsbC1ydWxlPSJldmVub2RkIj48cmVjdCB3aWR0aD0iMTgiIGhlaWdodD0iMTgiIGZpbGw9IiNmZmYiIHJ4PSIxIi8+PHBhdGggZmlsbD0iIzAxYmQ4OCIgZD0iTTEyLjQzNSAzYy4zMTIgMCAuNTY1LjI3LjU2NS42YS42Mi42MiAwIDAgMS0uMTQ5LjQwNWwtNC4xMyA0Ljc4VjEyLjZMNi4yNzggMTVsLS4wMDEtNi4yMTYtNC4xMjgtNC43OGMtLjIxLS4yNDQtLjE5NS0uNjI0LjAzNS0uODQ4QS41NS41NSAwIDAgMSAyLjU2NSAzaDkuODd6TTE0IDhsMiAzaC0xLjR2My41aC0xLjJWMTFIMTJsMi0zeiIvPjwvc3ZnPg=="},"../spread-sheet/src/core/view/level-2/filter-center/style/sync-on/half-filter-active.svg":function(e){e.exports="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxOCIgaGVpZ2h0PSIxOCIgZmlsbC1ydWxlPSJldmVub2RkIj48cmVjdCB3aWR0aD0iMTgiIGhlaWdodD0iMTgiIGZpbGw9IiNlYmViZWIiIHJ4PSIxIi8+PHBhdGggZmlsbD0iIzAxYmQ4OCIgZD0iTTkuNyAxMHY1SDguNHYtNWgxLjN6TTExIDcuNnYxLjNIN1Y3LjZoNHptMi0yLjN2MS4zSDVWNS4zaDh6TTE1LjUgM3YxLjNoLTEzVjNoMTN6Ii8+PC9zdmc+"},"../spread-sheet/src/core/view/level-2/filter-center/style/sync-on/half-filter-hover.svg":function(e){e.exports="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxOCIgaGVpZ2h0PSIxOCIgZmlsbC1ydWxlPSJldmVub2RkIj48cmVjdCB3aWR0aD0iMTgiIGhlaWdodD0iMTgiIGZpbGw9IiNmNWY1ZjUiIHJ4PSIxIi8+PHBhdGggZmlsbD0iIzAxYmQ4OCIgZD0iTTkuNyAxMHY1SDguNHYtNWgxLjN6TTExIDcuNnYxLjNIN1Y3LjZoNHptMi0yLjN2MS4zSDVWNS4zaDh6TTE1LjUgM3YxLjNoLTEzVjNoMTN6Ii8+PC9zdmc+"},"../spread-sheet/src/core/view/level-2/filter-center/style/sync-on/half-filter.svg":function(e){e.exports="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxOCIgaGVpZ2h0PSIxOCIgZmlsbC1ydWxlPSJldmVub2RkIj48cmVjdCB3aWR0aD0iMTgiIGhlaWdodD0iMTgiIGZpbGw9IiNmZmYiIHJ4PSIxIi8+PHBhdGggZmlsbD0iIzAxYmQ4OCIgZD0iTTkuNyAxMHY1SDguNHYtNWgxLjN6TTExIDcuNnYxLjNIN1Y3LjZoNHptMi0yLjN2MS4zSDVWNS4zaDh6TTE1LjUgM3YxLjNoLTEzVjNoMTN6Ii8+PC9zdmc+"},"../spread-sheet/src/core/view/level-2/filter-center/style/sync-on/up-triangle-active.svg":function(e){e.exports="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxOCIgaGVpZ2h0PSIxOCIgZmlsbC1ydWxlPSJldmVub2RkIj48cmVjdCB3aWR0aD0iMTgiIGhlaWdodD0iMTgiIGZpbGw9IiNlYmViZWIiIHJ4PSIxIi8+PHBhdGggZmlsbD0iIzAxYmQ4OCIgZD0iTTE1IDEybC0yIDMtMi0zaDR6TTYgM2wzLjUgNUg2Ljh2N0g1LjJWOEgyLjVMNiAzeiIvPjwvc3ZnPg=="},"../spread-sheet/src/core/view/level-2/filter-center/style/sync-on/up-triangle-hover.svg":function(e){e.exports="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxOCIgaGVpZ2h0PSIxOCIgZmlsbC1ydWxlPSJldmVub2RkIj48cmVjdCB3aWR0aD0iMTgiIGhlaWdodD0iMTgiIGZpbGw9IiNmNWY1ZjUiIHJ4PSIxIi8+PHBhdGggZmlsbD0iIzAxYmQ4OCIgZD0iTTE1IDEybC0yIDMtMi0zaDR6TTYgM2wzLjUgNUg2Ljh2N0g1LjJWOEgyLjVMNiAzeiIvPjwvc3ZnPg=="},"../spread-sheet/src/core/view/level-2/filter-center/style/sync-on/up-triangle.svg":function(e){e.exports="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxOCIgaGVpZ2h0PSIxOCIgZmlsbC1ydWxlPSJldmVub2RkIj48cmVjdCB3aWR0aD0iMTgiIGhlaWdodD0iMTgiIGZpbGw9IiNmZmYiIHJ4PSIxIi8+PHBhdGggZmlsbD0iIzAxYmQ4OCIgZD0iTTE1IDEybC0yIDMtMi0zaDR6TTYgM2wzLjUgNUg2Ljh2N0g1LjJWOEgyLjVMNiAzeiIvPjwvc3ZnPg=="}}]),window.jsExecEndTimeStamp=Date.now(),window.cachedPerformanceEntries||(window.cachedPerformanceEntries=[]),window.cachedPerformanceEntries.push({name:"jsExec: js/bundle_view_lazy_module0.00f95c1b7373dc97dcbc.js",entryType:"jsExec",startTime:window.jsExecStartTimeStamp,endTime:window.jsExecEndTimeStamp});
//# sourceMappingURL=bundle_view_lazy_module0.00f95c1b7373dc97dcbc.js.map