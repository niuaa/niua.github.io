self.window=self,window.jsExecStartTimeStamp=Date.now(),(self.webpackChunk_tencent_alloy_builder=self.webpackChunk_tencent_alloy_builder||[]).push([["bundle_plugin_common_init"],{"../core-sheet/js/index.js":function(e,t,n){n.r(t),n.d(t,{default:function(){return R}});var o={};n.r(o),n.d(o,{getCurrSubId:function(){return d},getEditorBottom:function(){return E},getEditorTop:function(){return P},getHasAllLoad:function(){return _},getHeaderHeight:function(){return C},getMyUserInfo:function(){return f},getOffTop:function(){return v},getPadId:function(){return u},getSheetDocInfo:function(){return w},getTitle:function(){return p},isFullyConnected:function(){return h},setHasAllLoad:function(){return g},setMyUserInfo:function(){return m},setSheetDocInfo:function(){return b}}),n("../node_modules/core-js/modules/es.array.iterator.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.promise.js"),n("../node_modules/core-js/modules/es.string.iterator.js"),n("../node_modules/core-js/modules/web.dom-collections.iterator.js");var i=n("../packages/common-utils/src/index.ts"),r=n("../packages/utils/src/safe.ts"),s=window.log.getLogger("flow"),a=n("../node_modules/@tencent/docs-user-agent/dist/index.js"),c=n.n(a),l={title:"",myUserInfo:null,hasAllLoad:!1,coreSheetDocInfo:null};function d(){return SpreadsheetApp?SpreadsheetApp.spreadsheet.getActiveSheetId():(0,i.IZ)("tab")}function u(){return window.spreadConfig.getConfig("padId")}function p(){return window.SpreadsheetApp&&window.SpreadsheetApp.spreadsheet.getTitle()}function h(){var e,t;return"OPENED"===(null===(t=null===(e=SpreadsheetApp.messageCenter)||void 0===e?void 0:e.networkStatusManager)||void 0===t?void 0:t.getRoomStatus())}function f(){return l.myUserInfo}function m(){var e=window.clientVars||{};l.myUserInfo={userId:e.userId,name:e.userName,ip:e.clientIp,colorId:e.userColor||0,status:"connected",userLink:e.userLink,userPic:e.userPic,uin:e.uin,openTime:Date.now()}}function v(){return"182px"}function g(e){l.hasAllLoad=e}function _(){return l.hasAllLoad}function b(e){l.coreSheetDocInfo=e}function w(){return l.coreSheetDocInfo}function C(){return $("header").outerHeight()||44}function P(){var e=document.getElementById("mainContainer"),t=c().isIPad?C():0;return e?e.getBoundingClientRect().top+t:t}function E(){return c().isMobilePhone||c().isAndroidPad||c().isIPad?$("#mobile-sheetbox").outerHeight()||0:$(".tsSheetbox").outerHeight()||0}n("../node_modules/core-js/modules/es.object.assign.js");var T=n("../core-sheet/js/report/whitescreen.js"),x=n("../spread-sheet/src/base/event/event.ts"),k=n("../spread-sheet/src/base/event/eventName.ts"),I=n("../node_modules/@tencent/docs-service-worker/lib/index.esm.js"),S=function(){var e;"serviceWorker"in window.navigator&&!c().isPc&&!c().isWxWork&&c().isChrome&&(null===(e=n.g.log)||void 0===e||e.info("开始注册service-worker"),(0,I.z2)({disableRemoteControl:!0}))},y=function(){function e(){}var t=e.prototype;return t.init=function(){T.$F.start(),m(),this.startLazy();var e=n.g.AppConfig.normal,t=e.domain,o=e.runtime;"wecom"===t?navigator.serviceWorker&&navigator.serviceWorker.getRegistrations().then((function(e){e&&e.some((function(e){return e.active.scriptURL==="https://"+o.domainName+"/tabkit-sw.js"&&(e.unregister(),!0)}))})).catch((function(e){n.g.log.error(e)})):S(),T.$F.end()},t.startLazy=function(){var e=this;return new Promise((function(t,o){n.e("bundle_coresheet_lazy").then(n.bind(n,"../core-sheet/js/lazy/modules.js")).then((function(n){e.initLazy(n),t()})).catch((function(e){var t;throw null===(t=n.g.log)||void 0===t||t.error("import lazy/modules",e&&e.stack),o(e),e}))}))},t.initLazy=function(e){this.initLazyApp(e.app),this.initLazyNetwork(e.network),this.initLazyOther(e.other),this.initLazyConfig(e.config),CoreSheet.configurations=e.config.configurations,CoreSheet.templateInfo=e.app.templateInfo,CoreSheet=Object.assign(CoreSheet,e.app.init.getExport()),g(!0),x.ZP.init.trigger(k.W1.CORE_SHEET_LAZY_LOADED)},t.initLazyApp=function(e){e.init.initAfterCanvas()},t.initLazyNetwork=function(e){e.manualInitAjax()},t.initLazyOther=function(e){e.initAfterCanvas()},t.initLazyConfig=function(e){e.manulInitConfigurations()},e}(),M=n("../spread-sheet/src/core/script-loader/index.ts"),j=function(){},R=function(){s.info("initCoreSheet"),window.CoreSheet={util:{getQuery:i.IZ,getXsrf:r.f,getBkn:r.G,cookie:{get:i.ej}},lib:{getExif:function(){return n.e("bundle_exif").then(n.t.bind(n,"../core-sheet/js/app/lib/exif.js",23)).then((function(e){return e.default}))}},configurations:null,sheet:o,userAgent:c(),saveStatus:null,loadModule:M.$y||j};var e=new y;return e.init(),e}},"../spread-sheet/src/base/util/browser.ts":function(e,t,n){n.d(t,{j7:function(){return c},kw:function(){return s},r9:function(){return a}}),n("../node_modules/core-js/modules/es.regexp.exec.js"),n("../node_modules/core-js/modules/es.string.match.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.regexp.to-string.js");var o=n("../node_modules/@tencent/docs-user-agent/dist/index.js"),i=n.n(o),r=(n("../spread-sheet/src/base/util/timer.ts"),n("../packages/common-utils/src/index.ts"));function s(){return(i().isTencentDocsApp?document.body.offsetWidth:Math.min(window.innerWidth,document.body.offsetWidth))>=640}function a(){var e=(0,r.gr)()?window.screen.width:window.screen.height,t=window.innerWidth/e;return t<.4?.33:t>=.4&&t<.6?.5:t>=.6&&t<.9?.66:1}function c(){if(i().isIE){var e=window.screen;return e.deviceXDPI&&e.logicalXDPI?e.deviceXDPI/e.logicalXDPI*100:100}if(i().isFirefox)return 100;if(i().isChrome){var t=window.outerWidth/window.innerWidth;return i().isWindows&&Math.round(100*t)>95&&Math.round(100*t)<105&&(t=1),Math.round(100*t)}if(i().isSafari)return Math.round(window.outerWidth/window.innerWidth*100);var n=1;if(void 0!==window.devicePixelRatio&&(n=window.devicePixelRatio),void 0!==window.outerWidth&&void 0!==window.innerWidth){var o=window.outerWidth/window.innerWidth;100!==Math.round(100*o)&&0!==window.outerWidth||(n=1)}return Math.round(100*n)}},"../spread-sheet/src/core/ui/index.ts":function(e,t,n){n.d(t,{Z:function(){return x}});var o={};n.r(o),n.d(o,{hideModal:function(){return l},showModal:function(){return c}});var i={};n.r(i),n.d(i,{Progress:function(){return P},default:function(){return T}});var r=n("../spread-sheet/src/core/ui/dialog/index.ts"),s=n("../spread-sheet/src/core/ui/alert/index.ts"),a=n("../spread-sheet/src/core/ui/lazyLoad.ts"),c=function(e,t,n){(0,a.Fd)().then((function(o){o.default.showModal(e,t,n)}))},l=function(e,t){(0,a.Fd)().then((function(n){n.default.hideModal(e,t)}))},d=n("../spread-sheet/src/core/ui/toast/index.ts"),u=n("../spread-sheet/src/core/ui/tooltip/index.ts"),p=n("../node_modules/@babel/runtime/helpers/esm/createClass.js"),h=(n("../node_modules/regenerator-runtime/runtime.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.promise.js"),n("../node_modules/core-js/modules/es.object.assign.js"),n("../node_modules/core-js/modules/es.array.includes.js"),n("../node_modules/core-js/modules/es.string.includes.js"),n("../node_modules/core-js/modules/es.array.map.js"),n("../node_modules/core-js/modules/es.array.fill.js"),n("../node_modules/core-js/modules/web.dom-collections.for-each.js"),n("../node_modules/core-js/modules/es.object.keys.js"),n("../node_modules/core-js/modules/es.array.iterator.js"),n("../node_modules/core-js/modules/web.dom-collections.iterator.js"),n("../spread-sheet/src/core/view/spreadsheet-view/utils.ts")),f=n("../packages/model/src/dimension/index.ts"),m=n("react"),v=n.n(m),g=n("react-dom"),_=n.n(g),b=function(e){var t=e.progress;if(t<=.05)return v().createElement("img",{style:{width:"16px",height:"16px"},src:"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHN0eWxlPSJtYXJnaW46YXV0byIgd2lkdGg9IjQwIiBoZWlnaHQ9IjQwIiB2aWV3Qm94PSIwIDAgMTAwIDEwMCIgcHJlc2VydmVBc3BlY3RSYXRpbz0ieE1pZFlNaWQiIGRpc3BsYXk9ImJsb2NrIj48Y2lyY2xlIGN4PSI1MCIgY3k9IjUwIiByPSIzMCIgc3Ryb2tlPSIjZGFlOWZmODAiIHN0cm9rZS13aWR0aD0iMTAiIGZpbGw9Im5vbmUiLz48Y2lyY2xlIGN4PSI1MCIgY3k9IjUwIiByPSIzMCIgc3Ryb2tlPSIjNDg5MmZlIiBzdHJva2Utd2lkdGg9IjEwIiBzdHJva2UtbGluZWNhcD0icm91bmQiIGZpbGw9Im5vbmUiIHRyYW5zZm9ybT0icm90YXRlKDcwOC45NTIgNTAgNTApIj48YW5pbWF0ZVRyYW5zZm9ybSBhdHRyaWJ1dGVOYW1lPSJ0cmFuc2Zvcm0iIHR5cGU9InJvdGF0ZSIgcmVwZWF0Q291bnQ9ImluZGVmaW5pdGUiIGR1cj0iMS4yNXMiIHZhbHVlcz0iMCA1MCA1MDsxODAgNTAgNTA7NzIwIDUwIDUwIiBrZXlUaW1lcz0iMDswLjU7MSIvPjxhbmltYXRlIGF0dHJpYnV0ZU5hbWU9InN0cm9rZS1kYXNoYXJyYXkiIHJlcGVhdENvdW50PSJpbmRlZmluaXRlIiBkdXI9IjEuMjVzIiB2YWx1ZXM9IjE4Ljg0OTU1NTkyMTUzODc2IDE2OS42NDYwMDMyOTM4NDg4Mjs3NS4zOTgyMjM2ODYxNTUwMyAxMTMuMDk3MzM1NTI5MjMyNTQ7MTguODQ5NTU1OTIxNTM4NzYgMTY5LjY0NjAwMzI5Mzg0ODgyIiBrZXlUaW1lcz0iMDswLjU7MSIvPjwvY2lyY2xlPjwvc3ZnPg=="});var n=6.28*55*t;return v().createElement("svg",{width:"14px",height:"14px",version:"1.1",viewBox:"0 0 120 120",preserveAspectRatio:"none"},v().createElement("circle",{cx:"140",cy:"60",r:"52",fill:"none",stroke:"#D4D5D9",strokeWidth:"14",strokeDasharray:"360,20000",transform:"rotate(-90,100,100)"}),v().createElement("circle",{cx:"140",cy:"60",r:"52",fill:"none",stroke:"#0082EF",strokeWidth:"14",strokeDasharray:n+",20000",transform:"rotate(-90,100,100)",strokeLinecap:"round"}))},w=function(e,t){void 0===e&&(e=0),_().render(v().createElement(b,{progress:e}),t)},C=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function s(e){try{c(o.next(e))}catch(t){r(t)}}function a(e){try{c(o.throw(e))}catch(t){r(t)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((o=o.apply(e,t||[])).next())}))},P=function(){function e(e){var t=this;this.translateX=0,this.translateY=0,this._eventDisposes=[],this.show=function(){return C(t,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.initPosition(),Object.assign(this.progressView.style,{position:"absolute",backgroundColor:"white",zIndex:1,display:"flex",alignItems:"center",overflow:"hidden",fontSize:"13px",pointerEvents:"none",borderWidth:"0px",boxShadow:"0 0 0 1px #E2E4E8",boxSizing:"border-box"}),this.visibile=!0,this.valid=!0,this.container.appendChild(this.progressView);case 5:case"end":return e.stop()}}),e,this)})))},this.updateProgress=function(e){w(e,t.iconSpan)},this.hide=function(){t.visibile=!1,t.container.contains(t.progressView)&&t.container.removeChild(t.progressView),t.handleEvent(!1)},this.cancelUpload=function(){t.valid=!1,t.hide()},this.getPositionInfo=function(){return{sheetId:t.sheetId,row:t.row,col:t.col}},this.setVisible=function(){t.visibile=!0,t.progressView.style.display="flex"},this.setHidden=function(){t.visibile=!1,t.progressView.style.display="none"},this.handleUpdateCells=function(e){var n=e.startRow,o=e.endRow,i=e.startCol,r=e.endCol;t.row>=n&&t.row<=o&&t.col>=i&&t.col<=r&&t.onRemove(t.id)},this.handleChange=function(e){return function(n){var o=n.sheetId,i=n.index,r=n.amount,s=n.type;if(o===t.sheetId){var a=s===f.DIMENSION_TYPE.ROWS?"row":"col";e&&new Array(r).fill(i).map((function(e,t){return e+t})).includes(t[a])?t.onRemove(t.id):(e&&i+r-1>t[a]&&(t[a]=Math.max(0,t[a]-r)),!e&&i+r-1<=t[a]&&(t[a]=t[a]+r),t.initPosition())}}},this.toggleVisible=function(e){if(e===t.sheetId)return t.setVisible();t.setHidden()},this.handleEvent=function(e){var n=t._eventDisposes;if(!e)return n.forEach((function(e){e.dispose()})),t._eventDisposes=[],void t.app.event.sheetsBar.remove("switchSheet",t.toggleVisible);var o=t.app.view.canvas,i=o.areaData,r=o.resize,s=o.scale,a=o.dataCallView;n.push(i.onUpdateOffset(t.updatePosition)),n.push(r.onResize(t.initPosition)),n.push(s.onScale(t.initPosition)),n.push(a.onSetRowHeight(t.initPosition)),n.push(a.onSetRowVisible(t.initPosition)),n.push(a.onSetColWidth(t.initPosition)),n.push(a.onSetColVisible(t.initPosition)),n.push(a.onMergeUnmerge(t.initPosition)),n.push(a.onUpdateChart(t.initPosition)),n.push(a.onUpdateFreeze(t.initPosition)),n.push(a.onUpdateCells(t.handleUpdateCells)),n.push(a.onDeleteRow(t.handleChange(!0))),n.push(a.onDeleteCol(t.handleChange(!0))),n.push(a.onInsertRow(t.handleChange(!1))),n.push(a.onInsertCol(t.handleChange(!1))),t.app.event.sheetsBar.listen("switchSheet",t.toggleVisible)},this.initDOM=function(){t.iconSpan=document.createElement("span"),t.iconSpan.style.margin="0 4px",t.iconSpan.style.width="14px",t.iconSpan.style.height="14px",t.progressView.appendChild(t.iconSpan),w(0,t.iconSpan),t.textSpan=document.createElement("span"),t.textSpan.style.color="#3677FD",t.textSpan.style.textDecoration="underline",t.textSpan.style.textDecorationColor="#3677FD",t.textSpan.style.whiteSpace="nowrap",t.textSpan.style.textOverflow="ellipsis",t.textSpan.style.overflow="hidden",t.progressView.appendChild(t.textSpan),t.textSpan.textContent=t.text},this.initPosition=function(){var e=t.app.view.canvas,n=e.tableView,o=e.areaData,i=e.headSize,r=e.rowcolAccessor,s=e.clientRect,a=n.getCellViewAtPosition(t.row,t.col),c=t.col,l=t.row,d=(0,h.E)(r,a,t.row),u=(0,h.o)(r,a,t.col),p=o.getDisplayViewTopByRow(l);(null===a||void 0===a?void 0:a.mergeData)&&(l+=a.mergeData.rowCount-1);var f=o.getDisplayViewBottomByRow(l),m=s.height-i.displayColHeadHeight;t.progressView.style.bottom=m-p+"px",t.progressView.style.top=f-d+"px";var v=o.getDisplayViewLeftByCol(c);t.progressView.style.left=v+"px",t.progressView.style.width=u-1+"px",t.progressView.style.height=d-1+"px",t.progressView.style.backgroundSize=Math.min(u,40)+"px "+Math.min(d,40)+"px",t.translateX=o.getDisplayViewLeftByCol(c),t.translateY=o.getDisplayViewTopByRow(l)},this.updatePosition=function(){var e=t.app.view.canvas,n=e.tableView,o=e.areaData,i=n.getCellViewAtPosition(t.row,t.col),r=t.col,s=t.row;(null===i||void 0===i?void 0:i.mergeData)&&(s+=i.mergeData.rowCount-1);var a=o.getDisplayViewLeftByCol(r),c=o.getDisplayViewTopByRow(s);t.progressView.style.transform="translate("+(a-t.translateX)+"px, "+(c-t.translateY)+"px)"},this.id=e.id,this.app=e.app,this.container=e.app.view.canvas.mainBoard.element,this.row=e.row,this.col=e.col,this.sheetId=e.sheetId,this.visibile=!1,this.progressView=document.createElement("div"),this.text=e.text,this.onRemove=e.onRemove,this.initDOM(),this.handleEvent(!0)}return e.prototype.getProgressView=function(){return this.progressView},(0,p.Z)(e,[{key:"isVisible",get:function(){return this.visibile}},{key:"isValid",get:function(){return this.valid}}]),e}(),E=function(){function e(){}return e.createInstance=function(t,n,o,i,r,s,a){if(null===n.view.getSelection())return null;var c=new P({id:t,app:n,row:o,col:i,sheetId:r,text:s,onRemove:a});return e.value[t]=c},e.getInstance=function(t){return e.value[t]},e.removeInstance=function(t){var n;Object.keys(e.value).includes(t)&&(null===(n=e.value[t])||void 0===n||n.cancelUpload(),e.value[t]=void 0)},e.keys=function(){return Object.keys(e.value)},e}();E.value={};var T=E,x={dialog:r,alert:s,modal:o,toast:d,tooltip:u,progress:i}},"../spread-sheet/src/core/ui/tooltip/index.ts":function(e,t,n){n.r(t),n.d(t,{changeTooltipText:function(){return d},default:function(){return p},hideTooltip:function(){return l},horizontalTooltip:function(){return u},showTooltip:function(){return c},toolTip:function(){return a}});var o=n("../spread-sheet/src/core/ui/lazyLoad.ts"),i=n("../node_modules/@tencent/docs-user-agent/dist/index.js"),r=n.n(i),s=n("../spread-sheet/src/base/event/event.ts"),a=function(e,t){(0,o.gB)().then((function(n){n.tooltip(e,t)}))},c=function(e,t){(0,o.gB)().then((function(n){n.tooltip(e,t)}))},l=function(){(0,o.gB)().then((function(e){e.hideTooltip()}))},d=function(e){(0,o.gB)().then((function(t){t.changeTooltipText(e)}))},u=function(e,t,n){(0,o.gB)().then((function(o){o.horizontalTooltip(e,t,n)}))};function p(){s.ZP.windowEvent.listen("resize",(function(){$("#tooltip").remove()})),s.ZP.windowEvent.listen("keydown",(function(){$("#tooltip").remove()})),r().isMobilePhone||r().isAndroidPad||!window.SpreadsheetApp.sheetStatus.canEdit||a("#toolbar [data-tooltip]")}},"../spread-sheet/src/core/utils/config.ts":function(e,t,n){n.d(t,{q:function(){return i}});var o=n("../spread-sheet/src/core/data/configService/spreadConfig.ts");function i(){return-1!==["local","new"].indexOf(o.q.getConfig("padStatus"))}},"../spread-sheet/src/core/utils/url.ts":function(e,t,n){function o(e,t){return t?(e.indexOf("?")>=0?e+="&"+t:e+="?"+t,e):e}n.d(t,{_:function(){return o}})},"../spread-sheet/src/external/ariaHelp/index.ts":function(e,t,n){n.r(t);var o=n("../node_modules/i18next/dist/esm/i18next.js"),i=n("../node_modules/@tencent/docs-user-agent/dist/index.js"),r=n.n(i),s=function(){function e(){}var t=e.prototype;return t.init=function(){var e=this.getHelpInfo(),t=n.g.document.getElementById("ariaQuickTips");t&&(t.innerText=e)},t.getHelpInfo=function(){var e="Ctrl",t="Alt";return r().isMac&&(e="Cmd",t="Opt"),o.ZP.t("\n\t\t\t欢迎使用腾讯文档\n\t\t\t你可以使用{{ctrlKey}}+{{altKey}}+SHIFT+h重新听取帮助。\n\t\t\t{{ctrlKey}}+{{altKey}}+SHIFT+1 切换到表格内容区\n\t\t\t{{ctrlKey}}+{{altKey}}+SHIFT+2 切换到表格工具栏\n\t\t\t{{ctrlKey}}+{{altKey}}+SHIFT+3 切换到顶部菜单栏\n\t\t\t{{ctrlKey}}+{{altKey}}+SHIFT+4 切换到底部工具栏\n\t\t\t{{ctrlKey}}+{{altKey}}+SHIFT+5 切换到修改表格标题\n\t\t\t按F2进入表格编辑。\n\t\t",{ctrlKey:e,altKey:t})},e}();t.default=new s},"../spread-sheet/src/external/documentInfoSync/DocumentInfoSync.ts":function(e,t,n){n.r(t),n.d(t,{PadInfoKey:function(){return o}}),n("../node_modules/regenerator-runtime/runtime.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.promise.js"),n("../node_modules/core-js/modules/es.regexp.exec.js"),n("../node_modules/core-js/modules/es.string.replace.js");var o,i=n("./node_modules/axios/index.js"),r=n.n(i),s=n("../packages/utils/src/safe.ts"),a=n("../spread-sheet/src/core/data/configService/spreadConfig.ts"),c=n("../spread-sheet/src/base/error/index.ts"),l=n("../spread-sheet/src/base/event/event.ts"),d=n("../spread-sheet/src/external/offline-edit/clear-type.ts"),u=n("../spread-sheet/src/core/utils/config.ts"),p=n("../spread-sheet/src/base/util/appConfig.ts"),h=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function s(e){try{c(o.next(e))}catch(t){r(t)}}function a(e){try{c(o.throw(e))}catch(t){r(t)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((o=o.apply(e,t||[])).next())}))};!function(e){e[e.privilegeAttribute=1]="privilegeAttribute",e[e.title=2]="title"}(o||(o={}));var f=function(){function e(e){var t=this;this.SYNC_CGI_URL="//"+p.Z.getConfig("runtime.domainName")+"/cgi-go/padinfo/getpadinfo",this.handleNetworkStatusChange=function(e,n){n.isOnline&&!e.isOnline&&t.syncDocumentInfo(t.secretId)},this.app=e,this.secretId=location.pathname.replace(/\/sheet\/(history\/)?/,""),this.init()}var t=e.prototype;return t.init=function(){"D0000000000000001"!==this.secretId&&(this.syncDocumentInfo(this.secretId),this.app.sheetStatus.workbookStatus.status.change(this.handleNetworkStatusChange))},t.destory=function(){this.app.sheetStatus.workbookStatus.status.offChange(this.handleNetworkStatusChange)},t.syncDocumentInfo=function(e){return h(this,void 0,void 0,regeneratorRuntime.mark((function t(){var i,a,c=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(0,u.q)()){t.next=2;break}return t.abrupt("return");case 2:return i="&infoKeys=["+[o.privilegeAttribute,o.title]+"]",a=this.SYNC_CGI_URL+"?encodePadId="+e+i+"&xsrf="+(0,s.f)(),t.next=6,r()({method:"get",url:a,responseType:"json"}).then((function(e){return h(c,void 0,void 0,regeneratorRuntime.mark((function t(){var o,i,r,s,a;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(null===(o=n.g.log)||void 0===o||o.info(e),0!==(i=e.data).retcode){t.next=12;break}return r=i.data,s=r.privilegeAttribute,t.next=7,this.handlePrivilegeChange(s);case 7:return a=r.title,t.next=10,this.handleTitleChange(a);case 10:t.next=13;break;case 12:i.retcode;case 13:case"end":return t.stop()}}),t,this)})))})).catch((function(e){var t;null===(t=n.g.log)||void 0===t||t.error("syncDocumentInfo error",null===e||void 0===e?void 0:e.stack)}));case 6:case"end":return t.stop()}}),t,this)})))},t.handleTitleChange=function(e){var t,o;return h(this,void 0,void 0,regeneratorRuntime.mark((function i(){var r;return regeneratorRuntime.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:if(a.q.getConfig("title")!==e){i.next=3;break}return i.abrupt("return");case 3:return r=a.q.getConfig("globalPadId"),i.prev=4,i.next=7,null===(t=this.app.offlineOpen)||void 0===t?void 0:t.offlineDataManager.getHelper().updatePadInfo(r,{newTitle:e,last_modify_ts:Date.now()});case 7:i.next=12;break;case 9:i.prev=9,i.t0=i.catch(4),null===(o=n.g.log)||void 0===o||o.error("updatePadInfo error",null===i.t0||void 0===i.t0?void 0:i.t0.stack,null===i.t0||void 0===i.t0?void 0:i.t0.message);case 12:a.q.setConfig({title:e});case 13:case"end":return i.stop()}}),i,this,[[4,9]])})))},t.handlePrivilegeChange=function(e){return h(this,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:a.q.getConfig("canEdit")===e.can_edit&&a.q.getConfig("canRead")===e.can_read||(l.ZP.spreadsheetEvent.trigger("clearOfflineStore",{type:d.N.ALL}),this.app.messageCenter.shutDown(c.B.PERMISSION_CHANGE),this.app.permissions.activeShutdownStatus(!1),$("#editor").blur()),a.q.getConfig("canComment")!==e.can_comment&&(l.ZP.spreadsheetEvent.trigger("clearOfflineStore",{type:d.N.ALL}),this.app.permissions.setWorkbookStatusCanComment(!1),this.app.messageCenter.shutDown(c.B.PERMISSION_CHANGE)),a.q.getConfig("canCopy")!==e.can_copy&&(l.ZP.spreadsheetEvent.trigger("clearOfflineStore",{type:d.N.ALL}),this.app.permissions.setWorkbookStatusCanCopy(!1),this.app.messageCenter.shutDown(c.B.PERMISSION_CHANGE));case 3:case"end":return t.stop()}}),t,this)})))},e}();t.default=f},"../spread-sheet/src/external/errorCode/ErrorCode.ts":function(e,t,n){n.r(t),n.d(t,{default:function(){return f}}),n("../node_modules/regenerator-runtime/runtime.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.promise.js");var o=n("../spread-sheet/src/base/config/report.ts"),i=n("../packages/report/src/index.ts");function r(e){i.ZP.run(o.CONFIG.MESSAGECENTER_DATA_ERROR_TIP_IMPORTANT,"dataErrorTip",e),i.ZP.zzsStatus({attrid:o.ZZS_REPORT_ATTR.OFFLINE_INDEXDB_NOT_AVAILABLE,status:1})}var s=n("../spread-sheet/src/base/error/errorCodeModalProxy.ts"),a=n("../spread-sheet/src/base/util/domain-config.ts"),c=(n("../node_modules/@tencent/docs-user-agent/dist/index.js"),n("../node_modules/@tencent/tencent_doc_net/dist/index.js")),l=n("../node_modules/@tencent/netcheck/lib/index.js"),d=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function s(e){try{c(o.next(e))}catch(t){r(t)}}function a(e){try{c(o.throw(e))}catch(t){r(t)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((o=o.apply(e,t||[])).next())}))},u=function(){function e(e){this._app=e}var t=e.prototype;return t.checkCode=function(e){for(var t=this,o=[{code:["60000"],callback:function(){s.Z.server.showServerErrorTip(e)}},{code:["60001"],callback:function(e){l.network.isOnline?s.Z.server.showServerErrorTip(e):s.Z.client.showNetworkOfflineTip()}},{code:["60002"],callback:function(e){s.Z.server.showServerConnectTimeout(e)}},{code:["40001"],callback:function(e){s.Z.client.showFileNotExsitErrorTip(e)}},{code:["60003","60016","60017","40002","40003","40030"],callback:function(e){r(e),s.Z.client.showSaveFrontEndErrorTip(e)}},{code:["102"],callback:function(e){s.Z.client.showSaveFrontEndErrorTip(e)}},{code:["40028","60004","60005","60011","60013","60018","60019","60020","60022"],callback:function(e){s.Z.server.showServerTaskTimeout(e)}},{code:["60030","60031","60032","60033"],callback:function(e){s.Z.server.showBlacklistBlock(e)}},{code:["60006","60021"],callback:function(){return d(t,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:s.Z.client.showLoginExpiredTip(e);case 1:case"end":return t.stop()}}),t)})))}},{code:["60007","60015","40203","40204","40205"],callback:function(e){s.Z.client.showUnAuthTip(e)}},{code:["60008","40026","52003"],callback:function(e){r(e),s.Z.server.showBigDataFromServerTip(e)}},{code:["60010"],callback:function(){var e,t=null===(e=n.g.SpreadsheetApp)||void 0===e?void 0:e.serviceCollection,o=(null===t||void 0===t?void 0:t.services.get(t.CONFIG.FULL_MEMBER))&&t.services.get(t.CONFIG.FULL_MEMBER).instance;null===o||void 0===o||o.turnOnFullMember()}},{code:["INACTIVE"],callback:function(){var e,t=null===(e=n.g.SpreadsheetApp)||void 0===e?void 0:e.serviceCollection,o=(null===t||void 0===t?void 0:t.services.get(t.CONFIG.FULL_MEMBER))&&t.services.get(t.CONFIG.FULL_MEMBER).instance;null===o||void 0===o||o.setIsINACTIVE(!0)}},{code:["60014"],callback:function(e){s.Z.server.showFrequentEditTip(e)}},{code:["40000","40005","40006","40020","40022","40023","40035","40036","40037","40038","41001","41002","10000","10001"],callback:function(e){r(e),s.Z.server.showSaveBackEndErrorTip(e)}},{code:["40039"],callback:function(e){s.Z.server.showOverMaxAmountFromServerTip(e)}},{code:["40024","40029","40034"],callback:function(e){s.Z.server.showUpgradeTip(e)}},{code:["40025"],callback:function(e){s.Z.client.showSecurityTip(e)}},{code:["64010"],callback:function(e){s.Z.server.meetingErrorTips(e)}}],i=!0,a=0,c=o;a<c.length;a++){var u=c[a],p=u.code,h=u.callback;if(p.indexOf(e)>-1){h(e),i=!1;break}}i&&s.Z.server.showUpdatePadTip(e)},t.showError=function(e){var t,n;return d(this,void 0,void 0,regeneratorRuntime.mark((function o(){var i=this;return regeneratorRuntime.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:["60006"].indexOf(e)>-1&&a.xc,o.next=15;break;case 5:return this._app.permissions.unactiveTempStatus(),this._app.permissions.setWorkbookStatusFull(!1),this._app.messageCenter.eventManager.onRoomOpen((function(){c.renewService.renewSuccess(location.href)})),null===(n=null===(t=this._app.messageCenterAdapter)||void 0===t?void 0:t.socketAdapter)||void 0===n||n.reopenAfterShutdown(),o.abrupt("return");case 12:o.prev=12,o.t0=o.catch(2),console.error(o.t0);case 15:s.Z.server.checkVipToast(e,(function(t){if(t)return i._app.permissions.activeShutdownStatus(!1),void i._app.permissions.setWorkbookStatusFull(!0);i.checkCode(e)}));case 16:case"end":return o.stop()}}),o,this,[[2,12]])})))},e}(),p=n("../spread-sheet/src/base/error/index.ts"),h=function(){function e(){}return e.prototype.showError=function(e,t){switch(void 0===t&&(t={}),e){case p.B.APPLY_NEW_CHANGE_ERROR:r(e),s.Z.server.showApplyNewChangeErrorTip(p.B.APPLY_NEW_CHANGE_ERROR);break;case p.B.REQUEST_SIZE_LIMIT:s.Z.client.showBigDataFromFrontTip(p.B.REQUEST_SIZE_LIMIT,t.message);break;case p.B.KICK:case p.B.DATA_VERSION_TOO_LOW:s.Z.server.showUpgradeTip(e);break;case p.B.TASK_DUPLICATE_VERSION_TOO_LOW:s.Z.client.showSaveFrontEndErrorTip(e);break;case p.B.KEYFRAME_UNZIP_ERROR:s.Z.client.showCommonCrashAndFeedBackModal(p.B.KEYFRAME_UNZIP_ERROR);break;case p.B.DATABASE_ERROR:s.Z.client.showDatabaseErrorModal(p.B.DATABASE_ERROR);break;case p.B.MUTATION_SHEET_ID_NOT_MATCH_SHEET:case p.B.SHEET_ID_NOT_EXIST:case p.B.MUTATION_SHEET_ID_NOT_BELONG_TO_WORKBOOK:s.Z.client.showSaveFrontEndErrorTip(e);break;case p.B.SHEET_ID_INIT_OLD_DUPLICATE:console.error(e);break;case p.B.SHEET_ID_SHEET_BAR_OLD_DUPLICATE:s.Z.client.showSheetBarDuplicateSheetId(p.B.SHEET_ID_SHEET_BAR_OLD_DUPLICATE,t.actionType);break;case p.B.SHEET_ID_SHEET_BAR_NEW_DUPLICATE:s.Z.client.showSheetBarDuplicateSheetId(p.B.SHEET_ID_SHEET_BAR_NEW_DUPLICATE,t.actionType);break;case p.B.SOCKET_NOT_SET_UP:s.Z.client.showServerConnectFailTip(p.B.SOCKET_NOT_SET_UP);break;case p.B.OFFLINE_INDEXDB_NOT_AVAILABLE:r(e),s.Z.client.showNetOfflineErrorTip(p.B.OFFLINE_INDEXDB_NOT_AVAILABLE);break;case p.B.COMMIT_ERROR_CODE_UNDEFINED:s.Z.server.showUpdatePadTip(e);break;case p.B.COMMITING_QUEUE_BLOCK:s.Z.client.showSaveFrontEndErrorTip(p.B.COMMITING_QUEUE_BLOCK);break;case p.B.FRONTEND_SOCKET_ERROR_CODE_UNDEFINED:s.Z.client.showCommonErrorModal1(p.B.FRONTEND_SOCKET_ERROR_CODE_UNDEFINED);break;case p.B.PERMISSION_CHANGE:s.Z.client.showPermissionChangesTip();break;case p.B.RESPONSE_NOT_CONTINUE:case p.B.TO_LESS_THAN_FROM:case p.B.CGI_HTTP_ERROR:case p.B.RESPONSE_DATA_EMPTY:case p.B.RESPONSE_ARRAY_EMPTY:case p.B.RESPONSE_ERROR_CODE:console.error(e);break;case p.B.TASK_RUN_ERROR:case p.B.RELOAD:default:s.Z.server.showUpdatePadTip(e)}},e}(),f=function(e){var t=this;this._handleErrorCode=function(e){var n=e.type,o=e.code,i=e.data;switch(n){case"socket":t._socketErrorCode.showError(o);break;case"cgi":break;case"front":t._frontErrorCode.showError(o,i)}},this._app=e,this._socketErrorCode=new u(e),this._frontErrorCode=new h,this._app.event.errorCode.listen("errorCode",this._handleErrorCode)}},"../spread-sheet/src/external/errorUI/client.ts":function(e,t,n){n.d(t,{$N:function(){return K},Bx:function(){return U},Hd:function(){return ee},I5:function(){return $},ID:function(){return J},OH:function(){return O},Pr:function(){return q},Q9:function(){return j},St:function(){return H},WT:function(){return M},Y6:function(){return F},YZ:function(){return y},Y_:function(){return R},g$:function(){return Q},hn:function(){return Y},i9:function(){return D},iZ:function(){return W},jr:function(){return X},qe:function(){return Z},sQ:function(){return B},uZ:function(){return G},wM:function(){return z},wc:function(){return N},x4:function(){return A}}),n("../node_modules/regenerator-runtime/runtime.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.promise.js"),n("../node_modules/core-js/modules/es.array.join.js"),n("../node_modules/core-js/modules/es.array.find.js"),n("../node_modules/core-js/modules/es.function.name.js"),n("../node_modules/core-js/modules/es.array.slice.js"),n("../node_modules/core-js/modules/es.object.assign.js");var o=n("../node_modules/i18next/dist/esm/i18next.js"),i=n("../node_modules/lodash/once.js"),r=n.n(i),s=n("../node_modules/@tencent/dui/lib/components/Modal/index.js"),a=n("../node_modules/@tencent/dui/lib/components/Snackbar/index.js"),c=n("../spread-sheet/src/external/errorUI/utils.ts"),l=n("../spread-sheet/src/base/event/event.ts"),d=n("../spread-sheet/src/external/offline-edit/clear-type.ts"),u=n("../packages/report/src/index.ts"),p=n("../spread-sheet/src/external/errorUI/collector.ts"),h=n("../node_modules/@tencent/docs-user-agent/dist/index.js"),f=n.n(h),m=n("../packages/common-utils/src/index.ts"),v=n("../spread-sheet/src/core/login/index.ts"),g=n("../spread-sheet/src/external/feedback/supportpage.ts"),_=n("../node_modules/@tencent/dui-mobile/lib/components/Toast/index.js"),b=n("../spread-sheet/src/core/data/configService/spreadConfig.ts"),w=n("../spread-sheet/src/core/app/utils.ts"),C=n("../spread-sheet/src/base/error/error-code-report.ts"),P=n("../spread-sheet/src/core/view/level-2/collab-center-ent/utils.ts"),E=(n("../spread-sheet/src/base/util/domain-config.ts"),n("../spread-sheet/src/base/index.ts")),T=n("../spread-sheet/src/core/view/spreadsheet-view/model/line-engine/split.ts"),x=n("../spread-sheet/src/base/util/appConfig.ts"),k=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function s(e){try{c(o.next(e))}catch(t){r(t)}}function a(e){try{c(o.throw(e))}catch(t){r(t)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((o=o.apply(e,t||[])).next())}))},I=f().isMobilePhone?10:20,S={offline:{mobile:o.ZP.t("网络异常，编辑内容会在网络恢复后同步。"),pc:[o.ZP.t("网络异常，离线"),o.ZP.t("中，文档最新内容会在网络恢复后同步。")]},editCannotSave:[o.ZP.t("编辑内容暂无法保存"),o.ZP.t("。")],fileNotExist:{mobile:o.ZP.t("文件已被创建者删除，内容无法上传。为防止内容丢失，请将刚刚编辑的内容复制粘贴到本地进行备份，再点击刷新。"),pc:o.ZP.t("文件已被创建者删除，内容无法上传。为防止内容丢失，请将刚刚编辑的内容复制粘贴到本地或导出文件进行备份，再点击刷新。")},loginExpired:[o.ZP.t("登录过期，请重新登录"),o.ZP.t("。")],unAuth:{rangeAuth:o.ZP.t("所在行列包含保护范围，暂不支持此操作。"),mobileAuth:o.ZP.t("权限变化，编辑内容暂无法保存。"),commonAuth:[o.ZP.t("你在当前文档的权限已变更"),o.ZP.t("。")]},bigData:o.ZP.t("数据量较大，操作不成功"),security:[o.ZP.t("此内容因违规无法编辑"),o.ZP.t("。")],duplicateSheet:{actions:{insertNewSheet:o.ZP.t("新建工作表"),moveSheet:o.ZP.t("移动工作表"),copySheetById:o.ZP.t("创建副本"),deleteSheet:o.ZP.t("删除工作表"),renameSheet:o.ZP.t("重命名工作表")},message:o.ZP.t("失败，我们对此表示抱歉。可尝试刷新页面或联系我们反馈问题，我们将尽快为你修复。")},permissionChange:o.ZP.t("你在此文档的权限已发生变化。"),privateFilter:o.ZP.t("查看权限下筛选仅自己可见。"),collaborateFilter:o.ZP.t("有"+P.PJ+"覆盖了你的筛选"),filterChange:{actions:[o.ZP.t("筛选"),o.ZP.t("排序")],message:[o.ZP.t("有"+P.PJ),o.ZP.t("了内容。")]},shutDown:[o.ZP.t("表格遇到错误，请刷新页面后重试"),o.ZP.t("。")],offlineData:[o.ZP.t("离线数据同步失败，请连接网络后刷新"),o.ZP.t("。")],crashFeedBack:[o.ZP.t("加载表格时遇到未知错误，我们对此表示抱歉，可尝试刷新页面或联系我们反馈问题，我们将尽快为你修复"),o.ZP.t("。")],databaseError:o.ZP.t("表格离线数据处理遇到错误，请刷新页面后重试。"),serverConnect:[o.ZP.t("暂无法连接到服务器"),o.ZP.t("。")],netOfflineError:[o.ZP.t("暂无法连接到服务器，且离线编辑不可用，请检查网络后重试"),o.ZP.t("。")]};function y(e,t,n){if(void 0===e&&(e=!0),!f().isTencentDocsApp||!f().isTencentDocsAppVersionAboveOrEqual("2.2.0")||!f().isAndroidPad&&!f().isIPad){var i,r=e?o.ZP.t("编辑"):o.ZP.t("查看"),s=S.offline.pc.join(r);return i=a.default.show({id:n,message:s,style:{zIndex:10003},autoClose:!1,closable:!0}),t&&t(i),p.e.doms.push(i),(0,C.V)({errorCode:n,message:"errorUI-client-showNetworkOfflineTip()",snackbarMsg:s,tipsCustom:{upid:b.q.getConfig("upid")}}),i}}function M(e){var t=S.editCannotSave.join("("+e+")"),n=a.default.show({id:e,message:t,type:"error",style:{zIndex:10003},autoClose:!1,onClose:function(){return!0},action:[{text:o.ZP.t("如何处理"),onClick:function(){return(0,c.vT)(e),!1}}]});(0,C.V)({errorCode:e,message:"errorUI-client-showSaveFrontEndErrorTip()",snackbarMsg:t,tipsCustom:{upid:b.q.getConfig("upid")}}),p.e.doms.push(n)}function j(e){var t=S.fileNotExist.pc,n=S.editCannotSave.join("("+e+")"),i=a.default.show({id:e,message:n,type:"error",style:{zIndex:10003},autoClose:!1,onClose:function(){return!0},action:[{text:o.ZP.t("如何处理"),onClick:function(){return(0,c.vT)(e,!1,!1,t),!1}}]});(0,C.V)({errorCode:e,message:"errorUI-client-showFileNotExsitErrorTip()",snackbarMsg:n,tipsCustom:{upid:b.q.getConfig("upid")}}),p.e.doms.push(i)}function R(e){var t,n=S.loginExpired.join("("+e+")"),i=f().isWxWork,r=a.default.show({id:e,message:n,style:{zIndex:10003},autoClose:!1,onClose:function(){return!0},action:[{text:i?o.ZP.t("刷新"):o.ZP.t("登录"),onClick:function(){i?location.reload():null===v.Z||void 0===v.Z||v.Z.login()}}]});null===(t=window.tdocs)||void 0===t||t.log({message:"[NETWORK WS ERROR TIPS]: 登录态过期(errorCode:"+e+")",level:"error"}),(0,C.V)({errorCode:e,message:"errorUI-client-showLoginExpiredTip()",snackbarMsg:n,tipsCustom:{upid:b.q.getConfig("upid")}}),p.e.doms.push(r)}function A(e){var t,i;l.ZP.spreadsheetEvent.trigger("clearOfflineStore",{type:d.N.ALL}),null===(i=null===(t=n.g.SpreadsheetApp.messageCenter)||void 0===t?void 0:t.localUserChangeManager)||void 0===i||i.clearAllUserChangeQueue();var r="40203"===e,s=S.unAuth.rangeAuth+"("+e+")",c=(S.unAuth.mobileAuth,S.unAuth.commonAuth.join("("+e+")")),u=r?s:c,h=a.default.show({id:e,message:u,type:r?"info":"error",style:{zIndex:10003},autoClose:!1,closable:r,onClose:r?function(){return!0}:function(){return!1},action:[{text:o.ZP.t("刷新"),onClick:function(){return r&&(n.g.refreshReason=w.QU),location.reload(),!1}}]});(0,C.V)({errorCode:e,message:"errorUI-client-showUnAuthTip()",snackbarMsg:u,tipsCustom:{upid:b.q.getConfig("upid")}}),p.e.doms.push(h)}function Z(e,t){void 0===t&&(t=S.bigData);var n=a.default.show({id:e,message:t,type:"info",style:{zIndex:10003,height:"auto",minHeight:"52px"},autoClose:!1,closable:!0,onClose:function(){return u.ZP.tdwReport({module:"excel_tips",opername:"doc_excel_editor",action:"excel_tips_copypaste_click"}),!0},action:[{text:o.ZP.t("如何处理"),onClick:function(){return(0,c.vT)(e),!1}}]});p.e.doms.push(n),u.ZP.tdwReport({module:"excel_tips",opername:"doc_excel_editor",action:"excel_tips_copypaste_view"}),(0,C.V)({errorCode:e,message:"errorUI-client-showBigDataFromFrontTip()",snackbarMsg:t,tipsCustom:{upid:b.q.getConfig("upid")}})}function O(e){var t=S.security.join("("+e+")"),n=a.default.show({id:e,message:t,type:"error",style:{zIndex:10003},autoClose:!1,onClose:function(){return!0},action:[{text:o.ZP.t("了解详情"),onClick:function(){window.open("https://"+x.Z.getConfig("runtime.domainName")+"/doc/DWE9lbGhWTU9OV2VF","_blank")}}]});p.e.doms.push(n),(0,C.V)({errorCode:e,message:"errorUI-client-showSecurityTip()",snackbarMsg:t,tipsCustom:{upid:b.q.getConfig("upid")}})}function D(e,t){var n,i=S.duplicateSheet.actions[t]+S.duplicateSheet.message;n=s.default.confirm({title:o.ZP.t("系统消息"),content:i,okText:o.ZP.t("联系我们"),onOk:function(){window.open(x.Z.getConfig("links.feedback")+"?customInfo="+e,"_blank")},cancelText:o.ZP.t("刷新"),onCancel:function(){window.location.reload()},onClose:function(){window.location.reload()}}),p.e.doms.push(n),(0,C.V)({errorCode:e,message:"errorUI-client-showSheetBarDuplicateSheetId()",snackbarMsg:i,tipsCustom:{upid:b.q.getConfig("upid")}})}function N(e){var t,i;if(l.ZP.spreadsheetEvent.trigger("clearOfflineStore",{type:d.N.ALL}),null===(i=null===(t=n.g.SpreadsheetApp.messageCenter)||void 0===t?void 0:t.localUserChangeManager)||void 0===i||i.clearAllUserChangeQueue(),!n.g.__alreadyShowPermissionChangesTip){n.g.__alreadyShowPermissionChangesTip=!0;var r=S.permissionChange,s=a.default.show({id:e,message:r,style:{zIndex:10003},autoClose:!1,onClose:function(){return!0},action:[{text:o.ZP.t("刷新"),onClick:function(){window.location.reload()}}]});p.e.doms.push(s),(0,C.V)({errorCode:e,message:"errorUI-client-showPermissionChangesTip()",snackbarMsg:r,tipsCustom:{upid:b.q.getConfig("upid")}})}}function L(e){var t=b.q.getConfig("userId"),n=b.q.getConfig("userName");if(e===t)return n;var o=(b.q.getConfig("invitedUserInfos")||[]).find((function(t){return t.userId===e}));return null===o||void 0===o?void 0:o.name}var U=r()((function(){var e=S.privateFilter;a.default.show({message:e,zIndex:10003,autoClose:!0,id:"local_filter"})}));function F(){var e=S.collaborateFilter;a.default.show({message:e,zIndex:10003,action:o.ZP.t("好的"),autoClose:!1})}function B(e,t,n){var i=L(t),r=e?S.filterChange.actions[0]:S.filterChange.actions[1],s=S.filterChange.message.join(r),c="";i&&(c=i.length>I?"「"+function(e,t){if(E.Z.util.string.hasEmojiCharacter(e)){var n=new T.eE(e)._emojiString._match;return n.length>t?n.slice(0,t).join("")+"...":n.join("")}return e.substr(0,t)+"..."}(i,I)+"」":"「"+i+"」"),c&&(s=c+r+S.filterChange.message[1]);var l=a.default.show({message:s,zIndex:10003,autoClose:!1,action:o.ZP.t("好的"),onClickAction:function(){n(),u.ZP.tdwReport({opername:"doc_filter",module:"doc_filter_guest",action:"doc_"+(e?"filter":"rank")+"_guest_confirm",ver11:"pc"})},id:"collab_filter_reorder_tip"});return p.e.doms.push(l),l}var V=null;function W(e,t){return k(this,void 0,void 0,regeneratorRuntime.mark((function n(){var i,r,s;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!V){n.next=5;break}return V.close(),V=null,n.next=5,new Promise((function(e){return setTimeout(e,300)}));case 5:if(t||e){n.next=9;break}return i=o.ZP.t("已取消“筛选对所有人可见”。"),a.default.show({id:"filter-sync-close-tip",className:"filter-sync-close-tip",message:i,zIndex:10003,type:"success"}),n.abrupt("return");case 9:t&&(r=L(t),s=o.ZP.t("{{value0}} {{value1}}“筛选对所有人可见”。",{value0:r?"「"+(r.length>I?r.substr(0,I)+"...":r)+"」":"有"+P.PJ,value1:e?"开启":"关闭"}),V=a.default.show(Object.assign({message:s,zIndex:10003},e?{autoClose:!1,action:o.ZP.t("好的"),onClickAction:function(){V=null,u.ZP.tdwReport({opername:"doc_filter",module:"doc_filter_guest",action:"doc_filter_guest_click",ver11:"pc"})}}:{})),!e&&setTimeout((function(){V=null}),2e3));case 10:case"end":return n.stop()}}),n)})))}function H(){_.default.show({duration:3e3,content:o.ZP.t("已自动保存"),style:{zIndex:2e4},autoClose:!0})}function z(){_.default.show({duration:3e3,content:o.ZP.t("保存失败"),style:{zIndex:2e4},autoClose:!0})}function q(e){var t=S.netOfflineError.join("("+e+")"),n=a.default.show({id:e,message:t,style:{zIndex:10003},autoClose:!1,action:[{text:o.ZP.t("刷新"),onClick:function(){window.location.reload()}}]});p.e.doms.push(n),(0,C.V)({errorCode:e,message:"errorUI-client-showNetOfflineErrorTip()",snackbarMsg:t,tipsCustom:{upid:b.q.getConfig("upid")}})}function X(){var e,t;null===(t=null===(e=n.g.CoreSheet)||void 0===e?void 0:e.saveStatus)||void 0===t||t.showSaveTips("offline",null,o.ZP.t("正在离线编辑"),o.ZP.t("正在离线编辑")),(0,m.Ds)((function(){var e,t;null===(t=null===(e=n.g.CoreSheet)||void 0===e?void 0:e.saveStatus)||void 0===t||t.showSaveTips("offline",3e3,o.ZP.t("离线编辑保存成功"),o.ZP.t("离线编辑保存成功"))}),1e3)()}function K(){}function G(e){var t=S.serverConnect.join("("+e+")"),n=a.default.show({id:e,message:t,style:{zIndex:10003},autoClose:!1,onClose:function(){return!0},action:[{text:o.ZP.t("刷新"),onClick:function(){window.location.reload()}},{text:o.ZP.t("联系我们"),onClick:function(){(0,c.cx)(e)}}]});p.e.doms.push(n),(0,C.V)({errorCode:e,message:"errorUI-client-showServerConnectFailTip()",snackbarMsg:t,tipsCustom:{upid:b.q.getConfig("upid")}})}function Y(e){var t=S.shutDown.join(""),n=s.default.confirm({title:o.ZP.t("系统消息"),content:t,okText:o.ZP.t("刷新"),onOk:function(){window.location.reload()},cancelText:o.ZP.t("联系我们"),onCancel:function(){return(0,c.cx)(e),!1}});p.e.doms.push(n),(0,C.V)({errorCode:e,message:"errorUI-client-showCommonErrorModal1()",snackbarMsg:t,tipsCustom:{upid:b.q.getConfig("upid")}})}function Q(e){var t=S.databaseError,n=s.default.confirm({title:o.ZP.t("系统消息"),content:t,okText:o.ZP.t("刷新"),onOk:function(){window.location.reload()},cancelText:o.ZP.t("联系我们"),onCancel:function(){return(0,c.cx)(e),!1}});p.e.doms.push(n),(0,C.V)({errorCode:e,message:"errorUI-client-showDatabaseErrorModal()",snackbarMsg:t,tipsCustom:{upid:b.q.getConfig("upid")}})}function J(e){var t=S.crashFeedBack.join(""),n={title:o.ZP.t("系统消息"),content:t,cancelText:null,okText:o.ZP.t("反馈"),onOk:function(){(0,g.nz)()}},i=s.default.confirm(n);p.e.doms.push(i),(0,C.V)({errorCode:e,message:"errorUI-client-showCommonCrashAndFeedBackModal()",snackbarMsg:t,tipsCustom:{upid:b.q.getConfig("upid")}})}function $(e,t){void 0===t&&(t=!1);var n=S.offlineData.join("("+e+")"),i=a.default.show({id:e,message:n,style:{zIndex:10003},autoClose:!1,action:[t?{text:o.ZP.t("如何处理"),onClick:function(){return(0,c.vT)(e),!1}}:{text:o.ZP.t("刷新"),onClick:function(){window.location.reload()}}]});p.e.doms.push(i),(0,C.V)({errorCode:e,message:"errorUI-client-showOfflineSyncError()",snackbarMsg:n,tipsCustom:{upid:b.q.getConfig("upid")}})}function ee(e){var t,n=S.shutDown.join("");return t=s.default.confirm({title:o.ZP.t("系统消息"),content:n,okText:o.ZP.t("刷新"),onOk:function(){window.location.reload()},cancelText:o.ZP.t("联系我们"),onCancel:function(){window.open(x.Z.getConfig("links.feedback")+"?customInfo="+e,"_blank")},onClose:function(){window.location.reload()}}),p.e.doms.push(t),(0,C.V)({errorCode:e,message:"errorUI-client-showDoBehaviorAfterShutDownModal()",snackbarMsg:n,tipsCustom:{upid:b.q.getConfig("upid")}}),t}},"../spread-sheet/src/external/errorUI/collector.ts":function(e,t,n){n.d(t,{e:function(){return o}}),n("../node_modules/core-js/modules/web.dom-collections.for-each.js");var o={doms:[],destroy:function(){var e;null===(e=n.g.log)||void 0===e||e.debug("flow errorUICollector destroy()"),this.doms.forEach((function(e){e&&e.close&&e.close()})),this.doms=[]}}},"../spread-sheet/src/external/errorUI/index.ts":function(e,t,n){n.r(t),n.d(t,{default:function(){return P}});var o,i=n("../node_modules/i18next/dist/esm/i18next.js"),r=n("../spread-sheet/src/external/errorUI/client.ts"),s=(n("../node_modules/core-js/modules/es.array.join.js"),n("../node_modules/@tencent/dui/lib/components/Modal/index.js")),a=n("../spread-sheet/src/core/ui/index.ts"),c=n("../packages/common-utils/src/index.ts"),l=n("../node_modules/@tencent/dui/lib/components/Snackbar/index.js"),d=n("../spread-sheet/src/external/errorUI/utils.ts"),u=n("../spread-sheet/src/core/data/configService/spreadConfig.ts"),p=n("../spread-sheet/src/external/errorUI/collector.ts"),h=n("../node_modules/@tencent/tencent_doc_open_url/dist/index.js"),f=n("../spread-sheet/src/base/error/error-code-report.ts"),m=n("../spread-sheet/src/core/view/level-2/collab-center-ent/utils.ts"),v=n("../packages/report/src/index.ts"),g=n("../spread-sheet/src/base/util/appConfig.ts"),_="1"===(0,c.IZ)("switch_dialog_close"),b={serverError:i.ZP.t("服务器异常，请刷新重试。"),connectTimeout:{pc:[i.ZP.t("服务器连接超时，请刷新重试"),i.ZP.t("。")],mobile:[i.ZP.t("服务器超时，请刷新重试"),i.ZP.t("。")]},taskTimeout:{pc:[i.ZP.t("服务器处理超时，请刷新重试"),i.ZP.t("。")],mobile:[i.ZP.t("服务器超时，请刷新重试"),i.ZP.t("。")]},fullMember:i.ZP.t("可编辑的人数已达上限，当前仅可查看。"),fullMemberRefresh:i.ZP.t("编辑人数较多，转为只能查看。"),bigDataFromServer:[i.ZP.t("本次操作内容过多，无法应用"),i.ZP.t("。")],frequentEdit:[i.ZP.t("你的操作太频繁，请稍后再试"),i.ZP.t("。")],serverSaveError:{mobile:[i.ZP.t("编辑内容暂无法保存"),i.ZP.t("。")],pc:[i.ZP.t("服务器异常，编辑内容暂无法保存"),i.ZP.t("。")]},upgrade:[i.ZP.t("腾讯文档已升级到最新版本"),"。"],needUpgrade:[i.ZP.t("文档状态有更新"),"。"],fileDeleted:[i.ZP.t("文档已被彻底删除"),"。"],switchSheetError:[i.ZP.t("服务器异常，无法切换sheet。可尝试刷新或联系我们，我们将尽快为你修复"),"。"],applyNewChange:[i.ZP.t("其他"+m.PJ+"的内容有更新"),"。"],overMaxAmount:[i.ZP.t("已经超出工作表支持的最大单元格数或行列数, 新增内容无法保存"),"。"],docOccupied:i.ZP.t("该文档已被其他会议占用，无法开启跟随模式。"),errInMeeting:i.ZP.t("未知错误，无法开启跟随模式。")},w=[],C=n("../node_modules/@tencent/dui-mobile/lib/components/Toast/index.js"),P={client:{showNetworkOfflineTip:r.YZ,showSaveFrontEndErrorTip:r.WT,showLoginExpiredTip:r.Y_,showUnAuthTip:r.x4,showBigDataFromFrontTip:r.qe,showSecurityTip:r.OH,showSheetBarDuplicateSheetId:r.i9,showPermissionChangesTip:r.wc,showUserChangeSaveSuccessTip:r.St,showUserChangeSaveFailTip:r.wM,showNetOfflineErrorTip:r.Pr,showOfflineSyncError:r.I5,showOfflineEditingTip:r.jr,showSavedText:r.$N,showServerConnectFailTip:r.uZ,showCommonErrorModal1:r.hn,showCommonCrashAndFeedBackModal:r.ID,showDatabaseErrorModal:r.g$,showFileNotExsitErrorTip:r.Q9},server:{showServerErrorTip:function(e,t){var n=b.serverError,o=l.default.show({id:e,message:n,type:"info",style:{zIndex:10003},autoClose:!1,onClose:function(){return!0},action:[{text:i.ZP.t("刷新"),onClick:function(){window.location.reload()}},{text:i.ZP.t("联系我们"),onClick:function(){return(0,d.cx)(e),!1}}]});return p.e.doms.push(o),null===t||void 0===t||t(o),(0,f.V)({errorCode:e,message:"errorUI-server-showServerErrorTip()",snackbarMsg:n,tipsCustom:{upid:u.q.getConfig("upid")}}),o},showServerConnectTimeout:function(e,t){var n=b.connectTimeout.pc.join("("+e+")"),o=l.default.show({id:e,message:n,style:{zIndex:10003},autoClose:!1,onClose:function(){return!0},action:[{text:i.ZP.t("刷新"),onClick:function(){window.location.reload()}},{text:i.ZP.t("联系我们"),onClick:function(){return(0,d.cx)(e),!1}}]});return p.e.doms.push(o),null===t||void 0===t||t(o),(0,f.V)({errorCode:e,message:"errorUI-server-showServerConnectTimeout()",snackbarMsg:n,tipsCustom:{upid:u.q.getConfig("upid")}}),o},showServerTaskTimeout:function(e){var t,n=b.taskTimeout.pc.join("("+e+")"),o=l.default.show({id:e,message:n,style:{zIndex:10003},autoClose:!1,onClose:function(){return!0},action:[{text:i.ZP.t("刷新"),onClick:function(){window.location.reload()}},{text:i.ZP.t("联系我们"),onClick:function(){(0,d.cx)(e)}}]});v.ZP.idkey(291727,55),null===(t=window.tdocs)||void 0===t||t.log({message:"[NETWORK WS ERROR TIPS]: 服务器处理超时(errorCode:"+e+")",level:"error"}),p.e.doms.push(o),(0,f.V)({errorCode:e,message:"errorUI-server-showServerTaskTimeout()",snackbarMsg:n,tipsCustom:{upid:u.q.getConfig("upid")}})},showFullMemberTip:function(e,t){var n=b.fullMember;return null===o||void 0===o||o.close(),o=l.default.show({id:e,message:n,style:{zIndex:10003,top:"49px"},autoClose:!1,closable:!0,onClose:function(){o=null}}),p.e.doms.push(o),t&&w.push(t),w.forEach((function(e){null===e||void 0===e||e(o)})),(0,f.V)({errorCode:e,message:"errorUI-server-showFullMemberTip()",snackbarMsg:n,tipsCustom:{upid:u.q.getConfig("upid")}}),o},showBigDataFromServerTip:function(e){var t=b.bigDataFromServer.join("("+e+")"),n=l.default.show({message:t,type:"error",style:{zIndex:10003},autoClose:!1,onClose:function(){return!1},action:[{text:i.ZP.t("如何处理"),onClick:function(){return(0,d.vT)(e),!1}}]});p.e.doms.push(n),(0,f.V)({errorCode:e,message:"errorUI-server-showBigDataFromServerTip()",snackbarMsg:t,tipsCustom:{upid:u.q.getConfig("upid")}})},showFrequentEditTip:function(e){var t=b.frequentEdit.join("("+e+")"),n=l.default.show({id:e,message:t,style:{zIndex:10003},closable:!0,autoClose:!0,duration:3e3,action:[{text:i.ZP.t("确定"),onClick:function(){}}]});p.e.doms.push(n),(0,f.V)({errorCode:e,message:"errorUI-server-showFrequentEditTip()",snackbarMsg:t,tipsCustom:{upid:u.q.getConfig("upid")}})},showSaveBackEndErrorTip:function(e){var t=i.ZP.t("服务器异常，编辑内容暂无法保存")+"("+e+")。",n=l.default.show({id:e,message:t,type:"error",style:{zIndex:10003},autoClose:!1,onClose:function(){return!0},action:[{text:i.ZP.t("如何处理"),onClick:function(){return(0,d.vT)(e),!1}}]});p.e.doms.push(n),(0,f.V)({errorCode:e,message:"errorUI-server-showSaveBackEndErrorTip()",snackbarMsg:t,tipsCustom:{upid:u.q.getConfig("upid")}})},showBlacklistBlock:function(e){var t=b.serverSaveError.pc.join("("+e+")"),n=l.default.show({id:e,message:t,type:"error",style:{zIndex:10003},autoClose:!1,onClose:function(){return!0},action:[{text:i.ZP.t("如何处理"),onClick:function(){return(0,d.vT)(e),!1}}]});p.e.doms.push(n),(0,f.V)({errorCode:e,message:"errorUI-server-showBlacklistBlock()",snackbarMsg:t,tipsCustom:{upid:u.q.getConfig("upid")}})},showUpgradeTip:function(e){var t=b.upgrade.join("("+e+")"),n=l.default.show({id:e,message:t,type:"info",style:{zIndex:10003},autoClose:!1,onClose:function(){return!0},action:[{text:i.ZP.t("点击刷新"),onClick:function(){window.location.reload()}}]});p.e.doms.push(n),(0,f.V)({errorCode:e,message:"errorUI-server-showUpgradeTip()",snackbarMsg:t,tipsCustom:{upid:u.q.getConfig("upid")}})},showUpdatePadTip:function(e){var t=b.needUpgrade.join("("+e+")"),n=l.default.show({id:e,message:t,type:"error",style:{zIndex:10003},autoClose:!1,onClose:function(){return!0},action:[{text:i.ZP.t("刷新"),onClick:function(){window.location.reload()}}]});p.e.doms.push(n),(0,f.V)({errorCode:e,message:"errorUI-server-showUpdatePadTip()",snackbarMsg:t,tipsCustom:{upid:u.q.getConfig("upid")}})},showApplyNewChangeErrorTip:function(e){var t=b.applyNewChange.join("("+e+")"),n=l.default.show({id:e,message:t,style:{zIndex:10003},autoClose:!1,action:[{text:i.ZP.t("刷新"),onClick:function(){window.location.reload()}},{text:i.ZP.t("联系我们"),onClick:function(){return(0,d.cx)(e),!1}}]});p.e.doms.push(n),(0,f.V)({errorCode:e,message:"errorUI-server-showApplyNewChangeErrorTip()",snackbarMsg:t,tipsCustom:{upid:u.q.getConfig("upid")}})},switchSheetError:function(e){var t=b.switchSheetError.join("");s.default.confirm({maskStyle:{zIndex:10004},title:i.ZP.t("系统消息"),content:t,actions:[{text:i.ZP.t("刷新"),onClick:function(){window.location.reload()}},{text:i.ZP.t("联系我们"),onClick:function(){return(0,d.cx)(e),!1}}]}),p.e.doms.push(void 0),(0,f.V)({errorCode:e,message:"errorUI-server-switchSheetError()",snackbarMsg:t,tipsCustom:{upid:u.q.getConfig("upid")}})},checkVipToast:function(e,t){var n=u.q.getConfig("nick")||u.q.getConfig("fullName")||"";a.Z.toast.showVipToast({errorCode:e,nickName:n}).then((function(e){t(e)})).catch((function(){}))},showFullMemberTipWithRefresh:function(e){var t=b.fullMemberRefresh,n=l.default.show({id:e,message:t,style:{zIndex:10003},autoClose:!1,action:[{text:i.ZP.t("开始编辑"),onClick:function(){window.location.reload()}}]});p.e.doms.push(n),(0,f.V)({errorCode:e,message:"errorUI-server-showFullMemberTipWithRefresh()",snackbarMsg:t,tipsCustom:{upid:u.q.getConfig("upid")}})},showFileDeletedTip:function(e){var t=b.fileDeleted.join("("+e+")"),n=l.default.show({id:e,message:t,style:{zIndex:10003},autoClose:!1,action:[{text:i.ZP.t("刷新"),onClick:function(){window.location.reload()}},{text:i.ZP.t("联系我们"),onClick:function(){return(0,d.cx)(e),!1}}]});p.e.doms.push(n),(0,f.V)({errorCode:e,message:"errorUI-server-showFileDeletedTip()",snackbarMsg:t,tipsCustom:{upid:u.q.getConfig("upid")}})},showRefreshTips:function(e,t,n){void 0===n&&(n=!1);var o=g.Z.getConfig("links.feedback"),r=i.ZP.t("加载提示");if(!_){var a={title:r,content:t+"("+e+")",okText:i.ZP.t("刷新"),cancelText:null,onOk:function(){location.reload()},action:{text:n?i.ZP.t("反馈"):""},onClickAction:function(){(0,h.tencentDocOpenUrlForAll)({url:o})},onCancel:function(){return console.log("cancel")},closable:!1,maskClosable:!1};s.default.confirm(a),(0,f.V)({errorCode:e,message:"errorUI-server-showUpdatePadTip()",snackbarMsg:i.ZP.t("刷新"),tipsCustom:{upid:u.q.getConfig("upid")}})}},showOverMaxAmountFromServerTip:function(e){var t=b.overMaxAmount.join("("+e+")"),n=l.default.show({message:t,type:"error",style:{zIndex:10003},autoClose:!1,onClose:function(){return!1},action:[{text:i.ZP.t("如何处理"),onClick:function(){return(0,d.vT)(e),!1}}]});p.e.doms.push(n),(0,f.V)({errorCode:e,message:"errorUI-server-showOverMaxAmountFromServerTip()",snackbarMsg:t,tipsCustom:{upid:u.q.getConfig("upid")}})},docOccupiedTips:function(e,t){var n=b.docOccupied,o=l.default.show({id:e,message:n,style:{zIndex:10003},autoClose:!0});return p.e.doms.push(o),null===t||void 0===t||t(o),(0,f.V)({errorCode:e,message:"errorUI-server-docOccupiedTips()",snackbarMsg:n,tipsCustom:{upid:u.q.getConfig("upid")}}),o},meetingErrorTips:function(e,t){var n=b.errInMeeting+"（"+e+"）",o=l.default.show({id:e,message:n,style:{zIndex:10003},autoClose:!0});return p.e.doms.push(o),null===t||void 0===t||t(o),(0,f.V)({errorCode:e,message:"errorUI-server-meetingErrorTips()",snackbarMsg:n,tipsCustom:{upid:u.q.getConfig("upid")}}),o}},portraitToast:function(){C.default.portraitToastShown||(C.default.show({content:i.ZP.t("请切换屏幕方向后编辑"),position:"top",onClose:function(){C.default.portraitToastShown=!1}}),C.default.portraitToastShown=!0)},changePermission:function(){l.default.show({message:i.ZP.t("权限修改成功"),style:{zIndex:10003},autoClose:!0,duration:2e3})},showFormulaLayerCalcErrorTips:function(){l.default.show({message:i.ZP.t("抱歉，运算量过大，系统暂不支持"),style:{zIndex:10003},autoClose:!0,duration:5e3})}}},"../spread-sheet/src/external/errorUI/utils.ts":function(e,t,n){n.d(t,{cx:function(){return h},vT:function(){return f}});var o=n("../node_modules/i18next/dist/esm/i18next.js"),i=n("../node_modules/@tencent/dui/lib/components/Modal/index.js"),r=n("react"),s=n.n(r);function a(e,t,n){return void 0===n&&(n=!0),s().createElement("div",null,s().createElement("div",null,e),s().createElement("div",{style:{opacity:.4}},n?o.ZP.t("错误码"):o.ZP.t("状态码"),":",t," ",function(){var e=new Date,t=e.getFullYear(),n=e.getMonth()+1<10?"0"+(e.getMonth()+1):e.getMonth()+1,o=e.getDate()<10?"0"+e.getDate():e.getDate();return t+"-"+n+"-"+o}()))}var c=n("../spread-sheet/src/base/event/event.ts"),l=n("../spread-sheet/src/external/offline-edit/clear-type.ts"),d=n("../spread-sheet/src/external/errorUI/collector.ts"),u=n("../spread-sheet/src/external/export/interface.ts"),p=n("../spread-sheet/src/base/util/appConfig.ts");function h(e){window.open(p.Z.getConfig("links.feedback")+"?customInfo="+e,"_blank")}function f(e,t,r,s){var p;void 0===t&&(t=!0),void 0===r&&(r=!0),c.ZP.spreadsheetEvent.trigger("onShowHowToHandleDataLostModal"),p=t?i.default.confirm({maskStyle:{zIndex:10004},title:o.ZP.t("如何处理"),content:a(s||o.ZP.t("为防止内容丢失，请将刚刚编辑的内容复制粘贴到本地或导出文件进行备份，再点击修复。"),e,r),okText:o.ZP.t("导出文件"),onOk:function(){var e;return null===(e=n.g.SpreadsheetApp)||void 0===e||e.getSheetExportManager().then((function(e){return e.export(u.I.xlsxServer)})),!1},cancelText:o.ZP.t("修复"),onCancel:function(){!function(e){var t;t=i.default.confirm({maskStyle:{zIndex:10004},title:o.ZP.t("提示"),content:a(o.ZP.t("修复过程将会清除本地缓存，可能造成部分内容丢失。请确认内容已备份到本地，再开始修复。"),e),okText:o.ZP.t("开始修复"),cancelText:"",onOk:function(){return c.ZP.spreadsheetEvent.trigger("clearOfflineStore",{type:l.N.UN_COMMITTED,callback:function(){window.location.reload()}}),!1},action:o.ZP.t("联系我们"),onClickAction:function(){return h(e),!1},onClose:function(){}}),d.e.doms.push(t)}(e)},action:o.ZP.t("联系我们"),onClickAction:function(){return h(e),!1},onClose:function(){}}):i.default.confirm({maskStyle:{zIndex:10004},title:o.ZP.t("如何处理"),content:a(s||o.ZP.t("为防止数据丢失，请勿刷新或关掉页面。建议先导出文件或将编辑的内容复制粘贴到本地，然后再刷新页面。"),e,r),okText:o.ZP.t("导出文件"),onOk:function(){var e;return null===(e=n.g.SpreadsheetApp)||void 0===e||e.getSheetExportManager().then((function(e){return e.export(u.I.xlsxServer)})),!1},cancelText:o.ZP.t("刷新"),onCancel:function(){window.location.reload()},action:o.ZP.t("联系我们"),onClickAction:function(){return h(e),!1},onClose:function(){}}),d.e.doms.push(p)}},"../spread-sheet/src/external/export/interface.ts":function(e,t,n){var o,i;n.d(t,{I:function(){return o},j:function(){return i}}),function(e){e.xlsx="xlsx",e.xlsxServer="xlsxServer",e.xlsxWithFiles="xlsxWithFiles",e.csv="csv"}(o||(o={})),function(e){e[e.LOOP_TIME_OUT=0]="LOOP_TIME_OUT",e[e.QUERY_ERROR_CATCH=1]="QUERY_ERROR_CATCH",e[e.QUERY_ERROR_UNEXPECT=2]="QUERY_ERROR_UNEXPECT",e[e.EXPORT_ERROR_CATCH=3]="EXPORT_ERROR_CATCH",e[e.EXPORT_ERROR_UNEXPECT=4]="EXPORT_ERROR_UNEXPECT"}(i||(i={}))},"../spread-sheet/src/external/feedback/supportpage.ts":function(e,t,n){n.d(t,{nz:function(){return g},vt:function(){return _}}),n("../node_modules/regenerator-runtime/runtime.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.promise.js"),n("../node_modules/core-js/modules/es.function.name.js"),n("../node_modules/core-js/modules/es.number.constructor.js"),n("../node_modules/core-js/modules/es.regexp.exec.js"),n("../node_modules/core-js/modules/es.string.replace.js");var o=n("../spread-sheet/src/core/data/configService/spreadConfig.ts"),i=n("../node_modules/@tencent/docs-multi-tools/dist/index.js"),r=n("../node_modules/@tencent/docs-user-agent/dist/index.js"),s=n.n(r),a=n("../spread-sheet/src/core/utils/url.ts"),c=n("../node_modules/@tencent/tencent_doc_open_url/dist/index.js"),l=n("../node_modules/qs/lib/index.js"),d=n.n(l),u=n("../spread-sheet/src/core/feature/relateFormEnt/enterpriseStatus.ts"),p=n("../packages/common-utils/src/index.ts"),h=n("./node_modules/axios/index.js"),f=n.n(h),m=(n("../spread-sheet/src/base/util/domain-config.ts"),n("../spread-sheet/src/base/util/appConfig.ts")),v=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function s(e){try{c(o.next(e))}catch(t){r(t)}}function a(e){try{c(o.throw(e))}catch(t){r(t)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((o=o.apply(e,t||[])).next())}))};function g(){var e,t,r=Number(new Date),l=r-18e5,u=null===(t=null===(e=n.g.log)||void 0===e?void 0:e.report)||void 0===t?void 0:t.call(e,"TUCAO_EXCEL",{query:{startTs:l,endTs:r}}),p=o.q.getConfig("userName"),h=o.q.getConfig("userPic"),f=o.q.getConfig("uid")||"";f?"p"===f.charAt(0)&&(f=f.replace(/p./,"")):f=o.q.getConfig("uin");var v=n.g.location.href;try{v=encodeURIComponent(JSON.stringify({type:"excel",url:n.g.location.href,uid:(0,i.getUid)(),rid:u}))}catch(g){console.warn(g)}!function(e){var t=m.Z.getConfig("links.feedback");if(o.q.getConfig("isLogin"))if(s().isMiniProgram&&!s().isPC){var i=d().stringify({openid:e.openid,nickname:e.nickname,avatar:e.avatar,customInfo:e.customInfo,clientInfo:e.clientInfo}),r=(0,a._)(t,i);n.g.location.href=r}else{var l=document.createElement("form");for(var u in l.id="form",l.name="form",l.style.display="none",s().isMiniProgram&&s().isPC?l.setAttribute("target","_self"):l.setAttribute("target","_blank"),document.body.appendChild(l),e)if(Object.hasOwnProperty.call(e,u)){var p=document.createElement("input");p.type="text",p.name=u,p.value=e[u],l.appendChild(p)}l.method="POST",l.action=t,l.submit(),document.body.removeChild(l)}else{var h=d().stringify({customInfo:encodeURIComponent(n.g.location.href),clientInfo:n.g.navigator.userAgent}),f=(0,a._)(t,h);(0,c.tencentDocOpenUrlForAll)({url:f})}}({openid:f,nickname:p,avatar:h,customInfo:v,clientInfo:n.g.navigator.userAgent})}function _(){var e,t,i,r,a;return v(this,void 0,void 0,regeneratorRuntime.mark((function l(){var d,h,m,v,g,_;return regeneratorRuntime.wrap((function(l){for(;;)switch(l.prev=l.next){case 0:return d=o.q.getConfig("padId"),h=(0,p.IZ)("scode"),(m=new FormData).append("docid",d),m.append("share_code",h),m.append("scence","wedoc"),m.append("svr_type","report"),l.prev=7,l.next=10,f().post("/doc/feedback_to_ww",m);case 10:if(v=l.sent,g=v.data,0===(null===(e=g.head)||void 0===e?void 0:e.ret)){l.next=14;break}throw new Error("request /doc/feedback_to_ww fail, params: docid:"+d+", share_code:"+h);case 14:if(_=null===g||void 0===g?void 0:g.body.return_url){l.next=18;break}throw null===(t=window.tdocs)||void 0===t||t.log({message:"[CGI FAILED]: no url provided, params: docid:"+d+", share_code:"+h,level:"error"}),new Error("request /doc/feedback_to_ww fail, no url provided");case 18:(0,u.n_)()?s().isMobile?null===(r=null===(i=n.g.tdocs)||void 0===i?void 0:i.openUrl)||void 0===r||r.call(i,{url:_,target:3}):null===(a=n.g.tdocs)||void 0===a||a.openInBrowser({url:_}):(0,c.tencentDocOpenUrlForAll)({url:_}),l.next=24;break;case 21:l.prev=21,l.t0=l.catch(7),console.error(l.t0);case 24:case"end":return l.stop()}}),l,null,[[7,21]])})))}},"../spread-sheet/src/external/fullMember/fullMember.ts":function(e,t,n){n.r(t),n.d(t,{default:function(){return f}});var o=n("./node_modules/axios/index.js"),i=n.n(o),r=n("../packages/report/src/index.ts"),s=n("../spread-sheet/src/base/config/report.ts"),a=n("../packages/utils/src/safe.ts"),c=n("../spread-sheet/src/base/error/index.ts"),l=n("../spread-sheet/src/core/data/configService/spreadConfig.ts"),d=n("../spread-sheet/src/base/index.ts"),u=n("../spread-sheet/src/base/error/errorCodeModalProxy.ts"),p=n("../node_modules/@tencent/doc-visibilitychange/dist/tabkit.js"),h=n.n(p),f=function(){function e(e){var t=this;this.isFull=!1,this.isINACTIVE=!1,this.timer=0,this.fetchData=function(){r.ZP.monitor(33686980);var e=t.app.spreadsheet.activeSheetId,n="/dop-api/querydata?padid="+l.q.getConfig("globalPadId")+"&type=sheet&subid="+e;n+="&xsrf="+(0,a.f)(),n+="&room=1",i()({method:"get",url:n,responseType:"json"}).catch((function(n){t.showFullMemberServerErrorTip(),r.ZP.run(s.CONFIG.FETCH_DATA_ERROR,[e,n])})).then((function(n){var o,i=null===n||void 0===n?void 0:n.data;i&&0===i.retcode?(t.clearServerErrorTip(),t.isINACTIVE||i.isOverConNum?t.app.event.spreadsheetEvent.trigger("syncLatestData",i.rev):t.turnOffFullMember()):(r.ZP.run(s.CONFIG.FETCH_DATA_ERROR_2,[e,null===i||void 0===i?void 0:i.retcode],i,null===i||void 0===i?void 0:i.retcode),null===(o=t.fullMemberTip)||void 0===o||o.close(),t.showFullMemberServerErrorTip())}))},this.app=e,this.startLoop=this.startLoop.bind(this),this.endLoop=this.endLoop.bind(this),this.fetchData=this.fetchData.bind(this),this.init()}var t=e.prototype;return t.init=function(){l.q.getConfig("isCreator")||l.q.getConfig("isOverConNum")&&!l.q.getConfig("isOverUpdateConNum")&&(r.ZP.monitor(33686979),this.turnOnFullMember(),h().visibilitychange.registerOnVisible(this.startLoop),h().visibilitychange.registerOnHidden(this.endLoop))},t.turnOnFullMember=function(){var e=this;this.isFull=!0,0!=(2&l.q.getConfig("rightFlag"))&&(this.fullMemberTip||u.Z.server.showFullMemberTip(c.B.FULL_MEMBER,(function(t){e.fullMemberTip=t})),this.app.permissions.activeTempStatus(!1),this.app.permissions.setWorkbookStatusFull(!0),this.app.event.network.trigger("changeFullMemberStatus",!0)),this.startLoop()},t.startLoop=function(){var e=this;this.timer&&this.endLoop(),this.timer=setInterval((function(){e.fetchData()}),3e4)},t.endLoop=function(){n.g.clearInterval(this.timer)},t.turnOffFullMember=function(){var e,t,n,o;this.isFull=!1,this.endLoop(),0!=(2&l.q.getConfig("rightFlag"))&&(null===(e=this.fullMemberTip)||void 0===e||e.close(),this.fullMemberTip=null,this.app.permissions.unactiveTempStatus(),this.app.permissions.setWorkbookStatusFull(!1),this.app.event.network.trigger("changeFullMemberStatus",!1)),null===(o=null===(n=null===(t=this.app)||void 0===t?void 0:t.messageCenterAdapter)||void 0===n?void 0:n.socketAdapter)||void 0===o||o.reopenAfterShutdown(),h().visibilitychange.registerOnDestory(this.startLoop),h().visibilitychange.registerOnDestory(this.endLoop)},t.setIsINACTIVE=function(e){this.isINACTIVE!==e&&(this.isINACTIVE=e,this.startLoop(),l.q.getConfig("canEdit")&&u.Z.server.showFullMemberTipWithRefresh("INACTIVE"))},t.showFullMemberServerErrorTip=function(){var e=this;this.clearServerErrorTip(),d.Z.util.timer.wait(400).run((function(){u.Z.server.showServerErrorTip(c.B.FULL_MEMBER,(function(t){e.fullMemberServerErrorTip=t}))}))},t.clearServerErrorTip=function(){var e;null===(e=this.fullMemberServerErrorTip)||void 0===e||e.close(),this.fullMemberServerErrorTip=null},e}()},"../spread-sheet/src/external/offline-edit/clear-type.ts":function(e,t,n){var o;n.d(t,{N:function(){return o}}),function(e){e.ALL="all",e.COMMITTED="committed",e.UN_COMMITTED="unCommitted"}(o||(o={}))},"../spread-sheet/src/external/rangeAuth/range-auth-plugin.pc.ts":function(e,t,n){n.r(t);var o=n("../node_modules/@babel/runtime/helpers/esm/inheritsLoose.js"),i=(n("../node_modules/core-js/modules/es.array.find-index.js"),n("../node_modules/i18next/dist/esm/i18next.js")),r=n("../spread-sheet/src/external/rangeAuth/range-auth-plugin.ts"),s=n("../node_modules/@tencent/dui/lib/components/Snackbar/index.js"),a=n("../packages/model/src/range/GridRange.ts"),c=n("../spread-sheet/src/core/app/tool.ts"),l=n("../spread-sheet/src/base/event/eventName.ts"),d=n("../spread-sheet/src/external/rangeAuth/util/range-auth-report-util.ts"),u=n("../spread-sheet/src/core/app/sheetStatus/ranges.ts"),p=n("../spread-sheet/src/external/rangeAuth/util/range-auth-error-util.ts"),h=n("../packages/report/src/index.ts"),f=function(e){function t(){var t;return(t=e.apply(this,arguments)||this).initPcEvent=function(){var e=t.app.view.canvas;e.mouseOperate.onDblClick(t.handleDoubleClick),e.mouseOperate.onClick(t.handleClick),e.normalSelectData.onModifySelectData(t.handleSelectData),e.mouseOperate.onContextMenu(t.handleRightClick)},t.handleRightClick=function(){t.handleSelectData()},t.handleDoubleClick=function(){if(!t.isNeedHandleHistoryData()){var e=t.app.view.getSelection().rangeSelections;if(-1!==e.findIndex((function(e){return!t.app.sheetStatus.getRangeCanEdit(e)}))&&t.app.sheetStatus.canEditExceptRangeStatus)return(0,p.ZO)(),(0,d.vf)(),void h.ZP.kvrOss({itemname:"xls_rangeprotect_range_viewer_toast"});e.length>0&&t.app.sheetStatus.isGridRangeSetRangeStatus(e[0],u.BP.EDITABLE)&&(0,d.k7)()}},t.handleClick=function(e){t.isNeedHandleHistoryData()||t.app.sheetStatus.getRangeCanRead(new a.Z(t.app.spreadsheet.activeSheetId,e.currRow,e.currRow,e.currCol,e.currCol))||(0,p.f$)(i.ZP.t("此范围受保护，你没有查看权限。"))},t.isNeedHandleHistoryData=function(){var e=!1;if(t.isOwner)return e;var n=t.app.sheetStatus.workbookStatus.canEdit,o=t.app.sheetStatus.getActiveSheetStatus();return!n&&!!o&&o.canEdit&&(s.default.show({type:"info",message:i.ZP.t("你没有表格编辑权限。"),action:i.ZP.t("申请权限"),autoClose:!0,style:{zIndex:10004},onClickAction:function(){t.showAuthApply()}}),e=!0),e},t.showAuthApply=function(){"undefined"!==typeof c.Z.window.PermitApply?c.Z.window.PermitApply.permitApply("sheet",null):c.Z.window.SLR.load("PermitApply",(function(e){c.Z.window.PermitApply=e,c.Z.window.PermitApply.permitApply("sheet",null)}))},t}return(0,o.Z)(t,e),t.prototype.initDefault=function(){e.prototype.initDefault.call(this),c.Z.event.init.listen(l.W1.AFTER_ALL_RENDER,this.initPcEvent)},t}(r.Z);t.default=f},"../spread-sheet/src/external/uiManager/uiManager.ts":function(e,t,n){n.r(t),n.d(t,{default:function(){return v}});var o=n("../node_modules/@babel/runtime/helpers/esm/createClass.js"),i=(n("../node_modules/regenerator-runtime/runtime.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.promise.js"),n("../node_modules/core-js/modules/web.dom-collections.for-each.js"),n("../node_modules/@tencent/ioc/lib/esm/index.js")),r=n("../node_modules/@tencent/workbench/lib/esm/services/drawer/drawer-service.js"),s=n("../node_modules/@tencent/workbench/lib/esm/services/widget/mobile-widget-service.js"),a=n("../spread-sheet/src/base/event/eventName.ts"),c=n("../spread-sheet/src/base/util/browser.ts"),l=n("../spread-sheet/src/base/index.ts"),d=n("../spread-sheet/src/external/view/native/native-toolbar/index.ts"),u=n("../spread-sheet/src/external/view/schema/mobile-action-button-schema.ts"),p=n("../spread-sheet/src/external/view/workbench/service/notification.ts"),h=n("../spread-sheet/src/core/view/level-2/mention/api/MentionApi.ts"),f=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function s(e){try{c(o.next(e))}catch(t){r(t)}}function a(e){try{c(o.throw(e))}catch(t){r(t)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((o=o.apply(e,t||[])).next())}))},m=n.g,v=function(){function e(e){this.hideWorkbenchDrawer=function(){i.Am.get(r.zv).closeRightDrawer()},this.app=e,this.init()}var t=e.prototype;return t.init=function(){var e=this;this.app.event.init.listen(a.W1.AFTER_ALL_RENDER,(function(){e.initCommon(),e.initPC()}))},t.initCommon=function(){this.app.event.default.listen(a.W1.UI_SHOW,(function(){}))},t.initPC=function(){var e=this;this.app.event.default.listen(a.W1.UI_SHOW,(function(t){switch(t){case a.Xs.SEARCH_PANEL_PC:e.hideToolbarMorePC(),e.hideToolbarDropdownPC(),e.hideDropdownPC(),e.hideFilterPanelPCPad();break;case a.Xs.FORMULA_EDITOR_PANEL:e.hideCanvasCard()}})),this.app.event.toolBar.listen(a.W1.UI_SHOW,(function(t){t===a.Xs.FILTER_PANEL_PC&&e.hideSearchReplacePanelPc()})),this.event.toolBar.listen("beforePCFormulaPanelShow",(function(){e.hideChartPanel(),e.hideWorkbenchDrawer()})),this.event.toolBar.listen("chartPanelShow",(function(){e.hideFormulaPadPC(),e.hideWorkbenchDrawer()})),this.event.toolBar.listen("historyPanelBeforeShow",(function(){e.hideChartPanel(),e.hideFormulaPadPC(),e.hideWorkbenchDrawer()})),this.event.default.listen("showWorkbenchSidePanel",(function(){e.hideChartPanel(),e.hideFormulaPadPC(),(0,p.yK)()})),this.event.default.listen("record-hide-side",(function(){e.hideMentionPanel(0),e.hideWorkbenchDrawer()})),this.event.default.listen("discussShow",(function(){e.hideWorkbenchDrawer()}));var t=this.app.view.canvas.normalSelectionStage;[t.topLeft,t.topRight,t.bottomLeft,t.bottomRight].forEach((function(t){t.singleSelectionApi.rangeMoveDragger.onMouseDown((function(){e.hideCanvasCard(),e.hideMentionRemindBoard()}))}))},t.initPad=function(){var e,t,n,o=this,i=((e={})[a.Xs.FORMULA_BOARD]=function(){o.hideToolPanelMobilePad()},e[a.Xs.FILTER_PANEL_PC]=function(){o.hideToolPanelMobilePad(),o.hideCanvasCard(),o.hideContextMenuMobilePad(),o.hideWorkbenchDrawer(),o.hideTemplateInfoPCPad()},e[a.Xs.SEARCH_PANEL_M]=function(){o.hideToolPanelMobilePad(),o.hideMentionPanel(),o.hideContextMenuMobilePad()},e[a.Xs.MORE_MENU_M]=function(){o.hideQuickPanelAndToolPanelMobilePad(),o.hideToolPanelMobilePad(),o.hideMentionPanel()},e[a.Xs.AUTH_M]=function(){o.hideQuickPanelAndToolPanelMobilePad(),o.hideToolPanelMobilePad()},e[a.Xs.FORMULA_EDITOR_PANEL]=function(){o.hideCanvasCard()},e[a.Xs.COMMENT_PANEL_M]=function(){o.hideQuickPanelAndToolPanelMobilePad(),o.hideToolPanelMobilePad(),o.hideHeaderMobilePad(),o.hideSearchReplacePanelMobilePad()},e[a.Xs.SHAPE_PREVIEW_M]=function(){o.hideQuickPanelAndToolPanelMobilePad(),o.hideMobileToolbar()},e[a.Xs.QQ_SHARE_M]=function(){o.hideQuickPanelAndToolPanelMobilePad()},e[a.Xs.RENAME_DOCUMENT_M]=function(){o.hideToolPanelMobilePad(),o.hideContextMenuMobilePad()},e[a.Xs.QUICK_FILL_M]=function(){o.hideContextMenuMobilePad(),o.hideMobileToolbar(!0)},e[a.Xs.MOBILE_TOOLBAR]=function(){o.hideContextMenuMobilePad()},e);this.app.event.default.listen(a.W1.UI_SHOW,(function(e){var t;null===(t=i[e])||void 0===t||t.call(i)})),this.app.event.default.listen(a.W1.UI_HIDE,(function(e){var t=o.app.view.canvas.normalSelectData.isValid();switch(e){case a.Xs.SHAPE_PREVIEW_M:t&&o.showMobileToolbar();break;case a.Xs.QUICK_FILL_M:t&&o.showMobileToolbar(!0)}})),this.event.toolBar.listen("beforeToolPanelShow",(function(){o.hideCanvasCard(),o.hideWorkbenchDrawer(),o.hideTemplateInfoPCPad()})),this.event.toolBar.listen("beforePCFormulaPanelShow",(function(){o.hideCanvasCard(),o.hideWorkbenchDrawer(),o.hideTemplateInfoPCPad()})),null===(n=null===(t=this.app.view.canvas.linkCenter.card)||void 0===t?void 0:t.emitter)||void 0===n||n.on(this.app.view.canvas.linkCenter.card.EVENT.SHOW_MODIFY,(function(){o.hideFormulaPadPC(),o.hideToolPanelMobilePad(),o.hideWorkbenchDrawer(),o.hideTemplateInfoPCPad()})),this.event.default.listen("record-hide-side",(function(){o.hideMentionPanel(0),o.hideWorkbenchDrawer()})),this.event.toolBar.listen("headerMoreMenuShow",(function(){o.hideCanvasCard(),o.hideWorkbenchDrawer(),o.hideTemplateInfoPCPad()})),this.app.view.canvas.contextMenuCenter.contextMenu.emitter.on(this.app.view.canvas.contextMenuCenter.contextMenu.EVENT.SHOW,(function(){o.hideCanvasCard(),o.hideFilterPanelPCPad(),o.hideFormulaPadPC(),o.hideWorkbenchDrawer(),o.hideMentionPanel()})),m.addEventListener("resize",(function(){(0,c.r9)()<.5&&(o.hideFilterPanelPCPad(),o.hideCanvasCard(),o.hideContextMenuMobilePad(),o.hideWorkbenchDrawer(),o.hideTemplateInfoPCPad())})),this.app.event.view.listen(a.W1.ENTER_INPUT_STATUS,(function(){o.hideFilterPanelPCPad(),o.hideWorkbenchDrawer(),o.hideCanvasCard()})),this.event.toolBar.listen("validationListShow",(function(){o.hideFilterPanelPCPad(),o.hideWorkbenchDrawer()})),this.app.view.canvas.smartDrag.emitter.on(this.app.view.canvas.smartDrag.EVENT.ENTER_SMART_DRAG,(function(){o.hideToolPanelMobilePad()}))},t.initMobile=function(){var e,t,n=this,o=((e={})[a.Xs.FORMULA_BOARD]=function(){n.hideToolPanelMobilePad()},e[a.Xs.FILTER_PANEL_M]=function(){n.hideSearchReplacePanelMobilePad(),n.hideMentionPanel(),n.hideInputBoard(),n.hideMobileToolbar()},e[a.Xs.FORMULA_PANEL_M]=function(){n.hideMobileToolbar(!0)},e[a.Xs.NUMBER_FORMAT_PANEL_M]=function(){n.hideMobileToolbar(!0)},e[a.Xs.VALIDATION_LIST_CARD_M]=function(){n.hideSearchReplacePanelMobilePad(),n.hideCanvasCard(),n.hideMentionPanel(),n.hideQuickPanelAndToolPanelMobilePad()},e[a.Xs.SEARCH_PANEL_M]=function(){n.hideMobileToolbar(),n.hideHeaderMobilePad(),n.hideContextMenuMobilePad(),n.setBottombarVisible(!1),n.app.view.canvas.mobileStageStates.stop()},e[a.Xs.MORE_MENU_M]=function(){n.hideFilterPanelPCPad(),n.hideMentionPanel(),n.hideQuickPanelAndToolPanelMobilePad()},e[a.Xs.AUTH_M]=function(){n.hideQuickPanelAndToolPanelMobilePad()},e[a.Xs.QQ_SHARE_M]=function(){n.hideQuickPanelAndToolPanelMobilePad()},e[a.Xs.COMMENT_PANEL_M]=function(){n.hideSearchReplacePanelMobilePad(),n.hideMobileToolbar()},e[a.Xs.AT_MESSAGE]=function(){n.hideQuickPanelAndToolPanelMobilePad()},e[a.Xs.SHAPE_PREVIEW_M]=function(){n.hideQuickPanelAndToolPanelMobilePad(),n.hideMobileToolbar()},e[a.Xs.RENAME_DOCUMENT_M]=function(){n.hideToolPanelMobilePad(),n.hideContextMenuMobilePad()},e[a.Xs.QUICK_FILL_M]=function(){n.hideContextMenuMobilePad(),n.hideMobileToolbar()},e[a.Xs.ITEM_LIST_M]=function(){n.hideMobileToolbar()},e[a.Xs.RENAME_SHEET_NAME_M]=function(){n.hideContextMenuMobilePad()},e[a.Xs.DIALOG]=function(){n.hideMobileToolbar()},e[a.Xs.SHEET_LIST_BOX]=function(){n.hideMobileToolbar()},e[a.Xs.MOBILE_TOOLBAR]=function(){n.hideContextMenuMobilePad()},e[a.Xs.CELL_EDITOR_M]=function(){n.hideMobileToolbar()},e);this.app.event.default.listen(a.W1.UI_SHOW,(function(e){var t;null===(t=o[e])||void 0===t||t.call(o)})),this.app.event.default.listen(a.W1.UI_HIDE,(function(e){switch(e){case a.Xs.FILTER_PANEL_M:case a.Xs.FORMULA_PANEL_M:case a.Xs.NUMBER_FORMAT_PANEL_M:case a.Xs.VALIDATION_LIST_CARD_M:case a.Xs.AT_MESSAGE:case a.Xs.SHAPE_PREVIEW_M:case a.Xs.ITEM_LIST_M:case a.Xs.DIALOG:case a.Xs.SHEET_LIST_BOX:case a.Xs.QUICK_FILL_M:case a.Xs.CELL_EDITOR_M:n.app.event.view.trigger(a.W1.RESET_INTERACTION_STATUS);break;case a.Xs.SEARCH_PANEL_M:n.app.view.canvas.mobileStageStates.restore(),n.app.event.view.trigger(a.W1.RESET_INTERACTION_STATUS)}})),null===(t=this.app.view.orientationOperate)||void 0===t||t.onScreenRotate((function(e){"landscape"===e&&(n.hideFilterPanelPCPad(),n.hideQuickPanelAndToolPanelMobilePad(),n.hideToolPanelMobilePad(),n.hideMentionPanel())})),this.app.view.canvas.smartDrag.emitter.on(this.app.view.canvas.smartDrag.EVENT.ENTER_SMART_DRAG,(function(){n.hideToolPanelMobilePad()})),this.app.event.view.listen(a.W1.ENTER_INPUT_STATUS,(function(){n.hideCanvasCard(),n.hideValidationListPanel()})),this.app.view.canvas.contextMenuCenter.contextMenu.emitter.on(this.app.view.canvas.contextMenuCenter.contextMenu.EVENT.SHOW,(function(){n.hideMentionPanel()}))},t.hideToolPanelMobilePad=function(){var e,t,n=null===(e=this.app.view.mobileToolBar)||void 0===e?void 0:e.components.toolPanel;null===(t=null===n||void 0===n?void 0:n.panel)||void 0===t||t.hide()},t.hideQuickPanelAndToolPanelMobilePad=function(){var e;this.app.view.canvas.normalSelectData.isValid()||null===(e=this.app.view.mobileToolBar)||void 0===e||e.hide()},t.showMobileToolbar=function(e){var t;void 0===e&&(e=!1),e&&!(0,d.KK)()||null===(t=this.app.view.mobileToolBar)||void 0===t||t.show()},t.hideMobileToolbar=function(e){var t;void 0===e&&(e=!1),e&&!(0,d.KK)()||null===(t=this.app.view.mobileToolBar)||void 0===t||t.hide()},t.setBottombarVisible=function(e){i.Am.get(s.S).changeFloatWidgetVisbility(u.VX,e)},t.hideFormulaPadPC=function(){var e;null===(e=this.app.view.plugins.formulaEditorPanel)||void 0===e||e.hide()},t.hideContextMenuMobilePad=function(){var e;null===(e=this.app.view.canvas.contextMenuCenter.contextMenu)||void 0===e||e.hide()},t.hideFilterPanelPCPad=function(){var e;return f(this,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:null===(e=this.app.view.plugins.filterPanel)||void 0===e||e.hide();case 1:case"end":return t.stop()}}),t,this)})))},t.hideTemplateInfoPCPad=function(){return f(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.app.plugins.getTemplateInfoService();case 2:null===(t=e.sent)||void 0===t||t.hide();case 4:case"end":return e.stop()}}),e,this)})))},t.hideSearchReplacePanelMobilePad=function(){var e;null===(e=this.app.view.canvas.searchReplaceCenter)||void 0===e||e.close()},t.hideSearchReplacePanelPc=function(){var e=this.app.view.canvas.searchReplaceCenter;null===e||void 0===e||e.close()},t.hideCanvasCard=function(){this.app.view.canvas.cardCenter.hide()},t.hideInputBoard=function(){this.app.view.canvas.inputManager.blur()},t.hideHeaderMobilePad=function(){var e,t;null===(e=this.app.view.header)||void 0===e||e.exitFullScreen(),null===(t=this.app.view.header)||void 0===t||t.hideHeader()},t.hideToolbarMorePC=function(){this.app.event.toolBar.trigger("hide-more")},t.hideToolbarDropdownPC=function(){this.app.event.default.trigger("close-toolbar-dropdown")},t.hideDropdownPC=function(){l.Z.event.notificationCenter.trigger("closedropdown")},t.hideChartPanel=function(){var e,t;null===(t=null===(e=this.app.view.plugins)||void 0===e?void 0:e.chartPanel)||void 0===t||t.hide()},t.hideValidationListPanel=function(){var e,t;null===(t=null===(e=this.app.view.plugins)||void 0===e?void 0:e.validationListPanel)||void 0===t||t.close()},t.hideMentionPanel=function(e){void 0===e&&(e=1),0===e?l.Z.event.mentionEvent.trigger("cancelMentionAction"):l.Z.event.mentionEvent.trigger("hideQuickRemindMenu")},t.hideRangeAuth=function(){l.Z.event.rangeAuthEvent.trigger("hideRangeAuth")},t.hideMentionRemindBoard=function(){h.Z.isQuickRemindMenuVisible&&h.Z.closeRemindBoard()},(0,o.Z)(e,[{key:"event",get:function(){return this.app.event}}]),e}()},"../spread-sheet/src/external/userGuide/userGuide.ts":function(e,t,n){n.r(t),n.d(t,{default:function(){return p}}),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.promise.js"),n("../node_modules/core-js/modules/es.array.map.js"),n("../node_modules/core-js/modules/es.object.get-own-property-names.js"),n("../node_modules/core-js/modules/web.dom-collections.for-each.js"),n("../node_modules/core-js/modules/es.function.name.js");var o=n("../node_modules/i18next/dist/esm/i18next.js"),i=n("./node_modules/axios/index.js"),r=n.n(i),s=n("../spread-sheet/src/base/event/event.ts"),a=n("../node_modules/@tencent/dui-mobile/lib/components/Snackbar/index.js"),c=n("../spread-sheet/src/external/userGuide/userGuideConfig.ts"),l=n("../spread-sheet/src/core/data/configService/spreadConfig.ts"),d=n("../node_modules/@tencent/docs-user-agent/dist/index.js"),u=n.n(d),p=function(){function e(e){this.data={},this.initialized=!1,this.app=e,this.init()}var t=e.prototype;return t.destroy=function(){var e;null===(e=this.snackbar)||void 0===e||e.close()},t.getData=function(e){return e?this.data[e]:this.data},t.setData=function(e,t){var n=this;if(this.data[e]===t)return Promise.resolve();this.data[e]=t;var o=Object.getOwnPropertyNames(this.data).map((function(e){return{name:e,value:n.data[e]}}));return r()({method:"POST",url:"/v2/user/attribute/update",data:{userAttribute:JSON.stringify({attributes:o})}})},t.isInitialized=function(){return this.initialized},t.init=function(){var e=this;l.q.getConfig("isLogin")&&r()({method:"get",url:"/v2/user/attribute/get",responseType:"json"}).then((function(t){e.handleResponse(t.data)})).catch((function(t){e.handleError(t)}))},t.handleResponse=function(e){var t,n=this;if(0===(null===(t=e.header)||void 0===t?void 0:t.code)){var o=e.userAttribute;if(o)try{JSON.parse(o).attributes.forEach((function(e){var t=e.name;n.data[t]=e.value}))}catch(i){console.error("userAttribute json parse error",i),this.data={}}else this.data={};this.initialized=!0,s.ZP.default.trigger(c.A.userguideInitialized,this.data),this.handleMobileDoubleClickEditToast()}},t.handleError=function(e){console.error("get userAttribute error",e),this.data={},this.initialized=!0,s.ZP.default.trigger(c.A.userguideInitialized,this.data),this.handleMobileDoubleClickEditToast()},t.handleMobileDoubleClickEditToast=function(){var e=this;(u().isMobilePhone||u().isAndroidPad)&&this.app.sheetStatus.canEdit&&"true"!==this.data[c.m.mobile_double_click_edit]&&(this.snackbar=a.default.show({message:o.ZP.t("双击单元格开始填写"),type:"info",autoClose:!0,duration:3e3,action:o.ZP.t("知道了"),onClickAction:function(){var t;null===(t=e.snackbar)||void 0===t||t.close()},style:{zIndex:10004}}),this.setData(c.m.mobile_double_click_edit,"true"))},e}()},"../spread-sheet/src/external/userGuide/userGuideConfig.ts":function(e,t,n){var o,i;n.d(t,{A:function(){return i},m:function(){return o}}),function(e){e.mobile_double_click_edit="mobile_double_click_edit",e.excel_rightmenu_insert_dot_for_chart="excel_rightmenu_insert_dot_for_chart",e.excel_rightmenu_insert_chart_dot="excel_rightmenu_insert_chart_dot",e.excel_toolbar_protect_range_box_dot="excel_toolbar_protect_range_box_dot",e.excel_toolbar_protect_range_dot="excel_toolbar_protect_range_dot",e.mobile_toolbar_add_red_dot_flag="mobile_toolbar_add_red_dot_flag",e.mobile_toolbar_media_select_photo_red_dot_flag="mobile_toolbar_media_select_photo_red_dot_flag",e.mobile_toolbar_media_take_photo_red_dot_flag="mobile_toolbar_media_take_photo_red_dot_flag",e.toolbar_ind_filter="toolbar_ind_filter",e.ind_filter_switch="ind_filter_switch",e.mobile_file_selector_toolbar_add_red_dot_flag="mobile_file_selector_toolbar_add_red_dot_flag",e.pc_file_selector_toolbar_add_red_dot_flag="pc_file_selector_toolbar_add_red_dot_flag",e.mobile_file_selector_red_dot_flag="mobile_file_selector_red_dot_flag",e.pc_file_selector_red_dot_flag="pc_file_selector_red_dot_flag",e.quick_fill_used="quick_fill_used",e.pc_conditional_format_red_dot_flag="pc_conditional_format_red_dot_flag",e.pc_conditional_format_inner_red_dot_flag="pc_conditional_format_inner_red_dot_flag",e.pc_specail_paste_red_dot_flag="pc_specail_paste_red_dot_flag",e.pc_export_as="pc_export_as",e.pc_export_as_zip="pc_export_as_zip",e.pc_context_menu_insert_cell_img="pc_context_menu_insert_cell_img",e.pc_context_menu_insert_attachment="pc_context_menu_insert_attachment",e.pc_toolbar_insert_cell_img="pc_toolbar_insert_cell_img",e.pc_toobar_item_insert_cell_img="pc_toobar_item_insert_cell_img",e.pc_toolbar_insert_attachment="pc_toolbar_insert_attachment",e.pc_set_watermark_dot="pc_set_watermark_dot",e.excel_rightmenu_watermark_dot="excel_rightmenu_watermark_dot",e.pc_insert_linked_range="pc_insert_linked_range_dot",e.pc_toolbar_data_menu_dot="pc_toolbar_data_menu_dot",e.pc_toolbar_data_validation_submenu_dot="pc_toolbar_data_validation_submenu_dot",e.pc_context_data_validation_dot="pc_context_data_validation_dot",e.pc_excel_rightmenu_relate_dot="pc_excel_rightmenu_relate_dot",e.mobile_excel_rightmenu_relate_dot="mobile_excel_rightmenu_relate_dot",e.pc_sheetbar_add_sheet_dot="pc_sheetbar_add_sheet_dot",e.pc_sheetbar_add_smart_sheet_dot="pc_sheetbar_add_smart_sheet_dot",e.mobile_sheetbar_add_sheet_dot="mobile_sheetbar_add_sheet_dot",e.mobile_sheetbar_add_sheets_from_template_dot="mobile_sheetbar_add_sheets_from_template_dot",e.pad_sheetbar_add_sheet_dot="pad_sheetbar_add_sheet_dot",e.pad_sheetbar_add_smart_sheet_dot="pad_sheetbar_add_smart_sheet_dot"}(o||(o={})),function(e){e.userguideInitialized="userguide_initialized"}(i||(i={}))},"../spread-sheet/src/external/view/native/native-toolbar/index.ts":function(e,t,n){n.d(t,{ZP:function(){return V},KK:function(){return l.KK}});var o,i,r=n("../node_modules/@babel/runtime/helpers/esm/createClass.js"),s=n("../node_modules/@babel/runtime/helpers/esm/inheritsLoose.js"),a=(n("../node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),n("../node_modules/core-js/modules/esnext.reflect.metadata.js"),n("../node_modules/core-js/modules/es.function.name.js"),n("../node_modules/core-js/modules/es.object.assign.js"),n("../node_modules/core-js/modules/web.dom-collections.for-each.js"),n("../node_modules/core-js/modules/es.array.find.js"),n("../node_modules/core-js/modules/es.regexp.exec.js"),n("../node_modules/core-js/modules/es.string.replace.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.object.keys.js"),n("../node_modules/core-js/modules/es.array.splice.js"),n("../node_modules/lodash/flattenDeep.js")),c=n.n(a),l=n("../spread-sheet/src/external/view/native/native-toolbar/utils.ts"),d=n("../node_modules/@tencent/workbench/lib/esm/services/store/builtin-state.js"),u=n("../node_modules/@tencent/workbench/lib/esm/services/mobile-toolbar/mobile-toolbar-service.js"),p=n("../node_modules/@tencent/ioc/lib/esm/index.js"),h=n("../node_modules/@tencent/workbench/lib/esm/services/context/context-service.js"),f=n("../node_modules/@tencent/workbench/lib/esm/decorators/class/override.js"),m=n("../node_modules/@tencent/workbench/lib/esm/services/store/state-manager.js"),v=n("../node_modules/@tencent/workbench/lib/esm/services/event-emitter/event-emitter.js"),g=n("../node_modules/@tencent/docs-user-agent/dist/index.js"),_=n.n(g),b=n("react"),w=n.n(b),C=n("../node_modules/lodash/isEqual.js"),P=n.n(C),E=n("../node_modules/@tencent/workbench/lib/esm/services/store/with-state.js"),T=n("../node_modules/@tencent/workbench/lib/esm/components/mobile-toolbar/mobile-toolbar-impl.js"),x=n("../spread-sheet/src/core/app/SpreadsheetApp.interface.ts"),k=function(e,t,n,o){var i,r=arguments.length,s=r<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(e,t,n,o);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(r<3?i(s):r>3?i(t,n,s):i(t,n))||s);return r>3&&s&&Object.defineProperty(t,n,s),s},I=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},S=function(e){function t(){return e.apply(this,arguments)||this}(0,s.Z)(t,e);var n=t.prototype;return n.componentDidUpdate=function(e){this.mobileToolbarNativeService.initToolbarAndPanelConfigs(this.props.mobileToolbarConfig),this.mobileToolbarNativeService.hasInited()&&(this.props[d.j.ShowMobileToolbar]!==e[d.j.ShowMobileToolbar]&&this.setNativeToolbarVisible(),P()(this.props[d.j.MobileToolbarConfig],e[d.j.MobileToolbarConfig])||this.updateNativeToolbar())},n.render=function(){return null},n.setNativeToolbarVisible=function(){var e,t,n=this.props[d.j.ShowMobileToolbar];n&&(null===(t=null===(e=null===this||void 0===this?void 0:this.app)||void 0===e?void 0:e.spreadsheet)||void 0===t?void 0:t.isExternalSheet())||this.mobileToolbarNativeService.setNativeToolbarVisible(n)},n.updateNativeToolbar=function(){this.mobileToolbarNativeService.updateNativeToolbar(this.props[d.j.MobileToolbarConfig])},t}(w().Component);k([(0,p.tB)(u.n),I("design:type","function"===typeof(o="undefined"!==typeof V&&V)?o:Object)],S.prototype,"mobileToolbarNativeService",void 0),k([(0,p.tB)(x.m),I("design:type","function"===typeof(i="undefined"!==typeof x.m&&x.m)?i:Object)],S.prototype,"app",void 0);var y=(0,E.x)([d.j.ShowMobileToolbar])(S);(0,f.C)(T.E,(function(){return(0,l.KK)()}))(y),(0,l.KK)()&&p.Am.alias(y,T.E);var M,j=n("../node_modules/@tencent/workbench/lib/esm/components/mobile-toolbar/panel/mobile-panel-container.js"),R=function(e,t,n,o){var i,r=arguments.length,s=r<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(e,t,n,o);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(r<3?i(s):r>3?i(t,n,s):i(t,n))||s);return r>3&&s&&Object.defineProperty(t,n,s),s},A=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},Z=function(e){function t(){return e.apply(this,arguments)||this}(0,s.Z)(t,e);var n=t.prototype;return n.componentDidUpdate=function(e){var t=this.props[d.j.MobilePanels].find((function(e){return e.opened&&!e.forcePopup})),n=e[d.j.MobilePanels].find((function(e){return e.opened&&!e.forcePopup})),o=this.props[d.j.ShowMobileToolbar]&&!!t,i=e[d.j.ShowMobileToolbar]&&!!n;o&&!P()(t,n)&&this.mobileToolbarNativeService.updateNativePanel(),(o!==i||t&&t.name!==(null===n||void 0===n?void 0:n.name))&&this.mobileToolbarNativeService.setNativePanelVisible(o,null===t||void 0===t?void 0:t.name)},n.render=function(){return null},t}(w().Component);R([(0,p.tB)(u.n),A("design:type","function"===typeof(M="undefined"!==typeof V&&V)?M:Object)],Z.prototype,"mobileToolbarNativeService",void 0);var O=(0,E.x)([d.j.ShowMobileToolbar,d.j.MobilePanels])(Z);(0,f.C)(j.I,(function(){return(0,l.KK)()}))(O),(0,l.KK)()&&p.Am.alias(O,j.I);var D,N,L,U=function(e,t,n,o){var i,r=arguments.length,s=r<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(e,t,n,o);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(r<3?i(s):r>3?i(t,n,s):i(t,n))||s);return r>3&&s&&Object.defineProperty(t,n,s),s},F=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},B=function(e){function t(t,n){var o;return(o=e.call(this,t,n)||this).callbackMap={},o.inited=!1,o.bindEvents(),o}(0,s.Z)(t,e);var n=t.prototype;return n.hasInited=function(){return this.inited},n.addButtonClick=function(e,t){if(e.onClick){var n=e.onClick;this.callbackMap[(0,l.Rx)(e.name)+"-onClick"]=function(){n(),t&&t()}}e.onChange&&(this.callbackMap[(0,l.Rx)(e.name)+"-onChange"]=e.onChange)},n.setNativeToolbarVisible=function(e){(0,l.M4)()&&window.mqq.invoke("docx","setNativeToolbarShow",{show:e,key:this.uniqueKey},null)},n.setNativePanelVisible=function(e,t){void 0===t&&(t=""),(0,l.M4)()&&window.mqq.invoke("docx","setNativePanelShow",{show:e,name:(0,l.Rx)(t),key:this.uniqueKey},null)},n.initToolbarAndPanelConfigs=function(e){if((0,l.M4)()){var t=this.convertConfigs(this.store.get(d.j.MobilePanels).getValue()),n=this.getNativePanelConfigs(t);this.inited||0!==n.length&&0!==e.centerButton[0].buttons.length&&(this.inited=!0,window.mqq.invoke("docx","initToolbarConfig",{version:"2",key:this.uniqueKey,toolbar:this.convertConfigs(e),stylepanel:this.reduceDepth(this.adaptLinearLayout(n))},null))}},n.updateNativeToolbar=function(e){(0,l.M4)()&&window.mqq.invoke("docx","updateToolbarConfig",{version:2,toolbar:this.convertConfigs(e),key:this.uniqueKey},null)},n.updateNativePanel=function(){if((0,l.M4)()){var e=this.getUpdatedPanelConfig();e&&window.mqq.invoke("docx","updateStylePanelConfig",Object.assign(Object.assign({},this.convertConfigs(e)),{key:this.uniqueKey}),null)}},n.getNativePanelConfigs=function(e){var t=this,n=[];return e.forEach((function(e){var o={name:e.name,title:e.title||"",items:t.adaptConfig(e.groups),type:e.forcePopup?"pop":"linear"};n.push(o)})),n},n.getUpdatedPanelConfig=function(){var e,t=this,n=this.store.get(d.j.MobilePanels).getValue().find((function(e){return e.opened&&!e.forcePopup}));if(!n)return null;var o=[],i=[],r=!1,s=n.groups[0],a=n.forcePopup?"pop":null===(e=s.groupType)||void 0===e?void 0:e.replace("list","linear");return"list"!==s.groupType||n.forcePopup||s.items.forEach((function(e){var n=[];e.forEach((function(e){t.evaluateButtonConfig(e)&&n.push(e)})),n.length>0&&(r=!0),o.push(n)})),("grid"===s.groupType&&!n.forcePopup||"list"===s.groupType&&n.forcePopup)&&s.items.forEach((function(e){(t.evaluateButtonConfig(e)||_().isAndroid)&&i.push(e),"grid"===s.groupType&&!e.value&&e.text&&(e.value=e.text),i.length>0&&(r=!0)})),r?{name:n.name,title:n.title,rows:o,items:i,type:a,key:this.uniqueKey}:null},n.evaluateButtonConfig=function(e){e.enable=!0,e.active=!0,e.show=!0;var t=!1;if(e.shouldDisabled){var n=!e.shouldDisabled();e.enable!==n&&(e.enable=n,t=!0)}if(e.respectOffline&&!this.contextService.context.isOnline()&&(e.enable=!1),e.shouldCheck){var o=e.shouldCheck();e.active!==o&&(e.active=o,t=!0)}if(e.shouldHide){var i=e.shouldHide();e.show===i&&(e.show=!i,t=!0)}return t},n.convertConfigs=function(e){return function e(t){if("object"===typeof t){if(!t)return t;var n="[object Array]"===Object.prototype.toString.call(t)?[]:{};return Object.keys(t).forEach((function(o){"function"===typeof t[o]||("name"===o&&"string"===typeof t[o]?n[o]=(0,l.Rx)(t[o]):n[o]=e(t[o]))})),n}return t}(e)},n.adaptConfig=function(e){var t=this,n={groupType:"type",text:"value"};return null===e||void 0===e||e.forEach((function(e){"grid"===e.groupType&&(e.column=5),e=t.updateKey(e,n),c()(e.items).forEach((function(e){t.updateKey(e,n),t.adaptSubpanel(e),t.adaptSteps(e)}))})),e},n.adaptSubpanel=function(e){e.panel&&delete e.panel},n.adaptSteps=function(e){"steps"===e.type&&(e.type="regulator",e.actions=["dec","inc"])},n.adaptLinearLayout=function(e){return e.forEach((function(e){var t;null===(t=e.items)||void 0===t||t.forEach((function(t,n){if("list"===t.type){var o=[],i=[],r=[],s=[];t.items.forEach((function(e){Array.isArray(e)?(e.forEach((function(t,n){Array.isArray(t)?t.forEach((function(o,i){r.push(o),i===t.length-1&&n!==e.length-1&&r.push({type:"$stub",name:""})})):i.push(t)})),r.length>0&&(o.push({type:"rows-block",title:"",items:r}),r=[]),i.length>0&&(o.push({type:"rows",title:"",items:i}),i=[])):s.push(e)})),s.length>0&&(o.push({type:"list",title:"",items:s}),s=[]),o[0].title=t.title,e.items[n]=o}}))})),e},n.reduceDepth=function(e){e.forEach((function(e){var t,n=[];null===(t=e.items)||void 0===t||t.forEach((function(e){Array.isArray(e)?e.forEach((function(e){n.push(e)})):n.push(e)})),e.items=n}));for(var t=e.length-1;t>=0;t--)0===e[t].items.length&&e.splice(t,1);return e},n.updateKey=function(e,t){for(var n=0,o=Object.keys(e);n<o.length;n++){var i=o[n],r=t[i];r&&(e[r]=e[i])}return e},n.bindEvents=function(){var e=this;(0,l.M4)()&&(window.toolbarClick=function(t,n){var o,i,r=n?t+"-onChange":t+"-onClick";null===(i=(o=e.callbackMap)[r])||void 0===i||i.call(o,n)})},(0,r.Z)(t,[{key:"uniqueKey",get:function(){return(0,l.w2)()}}]),t}(u.n);U([(0,p.tB)(),F("design:type","function"===typeof(D="undefined"!==typeof h.O&&h.O)?D:Object)],B.prototype,"contextService",void 0);var V=B=U([(0,f.C)(u.n,(function(){return(0,l.KK)()})),F("design:paramtypes",["function"===typeof(N="undefined"!==typeof m.O&&m.O)?N:Object,"function"===typeof(L="undefined"!==typeof v.v&&v.v)?L:Object])],B);(0,l.KK)()&&p.Am.alias(B,u.n)},"../spread-sheet/src/external/view/schema/mobile-action-button-schema.ts":function(e,t,n){var o;n.d(t,{VX:function(){return r},em:function(){return i}});var i,r="mobile-action-button-bar";!function(e){e.EDIT="edit",e.QUICK_FILL="quick-fill",e.FILTER="filter",e.INSERT_RECORD="smart-sheet|insert-record",e.VIEW_SWITCH="smart-sheet|view-switch"}(i||(i={}));var s=((o={})[r]=[i.EDIT,i.QUICK_FILL,i.FILTER,i.VIEW_SWITCH,i.INSERT_RECORD],o);t.ZP="page-editor"==n.j?s:null},"../spread-sheet/src/external/waterMark/watermark-controller.ts":function(e,t,n){n.r(t),n.d(t,{WatermarkController:function(){return d}});var o=n("../spread-sheet/src/base/event/event.ts"),i=n("../spread-sheet/src/external/waterMark/utils.ts"),r=(n("../node_modules/regenerator-runtime/runtime.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.promise.js"),n("../spread-sheet/src/core/data/configService/spreadConfig.ts")),s=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function s(e){try{c(o.next(e))}catch(t){r(t)}}function a(e){try{c(o.throw(e))}catch(t){r(t)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((o=o.apply(e,t||[])).next())}))};function a(e){var t;e||(t={invokeFrom:"TitleBar"});var n=null===e||void 0===e?void 0:e.detail.invokeFrom,o=document.querySelector("#doc-sharebox-container");return t="Share"===n?c("Share",o):function(e){var t=".content-dialog-container";return"Cooperation"===e&&(t=".cooperationv2-ad-container"),c("Cooperation",document.querySelector(t))}(n),t}function c(e,t){if(t){t.style.visibility="hidden";var n={invokeFrom:e,onClose:function(){t.style.visibility="visible"}};return(0,i.xk)({action:"excel_watermark_click",ver10:"authority_enter"}),n}}var l=n("../spread-sheet/src/external/waterMark/watermark.tsx"),d=function(){function e(){}var t=e.prototype;return t.loadWatermark=function(){var e=this;!function(){var e,t=this;document.getElementById("canvasContainerOuter")||null===(e=window.SLR)||void 0===e||e.listen("SHOW_WATERMARK_FROM_ADVPER",(function(e){return s(t,void 0,void 0,regeneratorRuntime.mark((function t(){var n,o,s;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=a(e),o=r.q.getConfig("globalPadId"),s=r.q.getConfig("watermark"),t.next=5,(0,i.iY)();case 5:t.sent.WatermarkDialogManager.showDialog(n,s,o);case 8:case"end":return t.stop()}}),t)})))}))}();var t=r.q.getConfig("watermark");this.initWatermark(t,!1),o.ZP.network.listen("newWatermark",(function(t){return e.initWatermark(null===t||void 0===t?void 0:t.watermark,!0)}))},t.initWatermark=function(e,t){try{if(e){r.q.setConfig({watermark:e});var n=JSON.parse(e);(t||(0,i.CC)(n)||(0,i.eG)(n))&&(0,l.K)()}}catch(o){console.error("watermark 解析失败",o),(0,l.K)()}},e}()},"../spread-sheet/src/external/waterMark/watermark.tsx":function(e,t,n){n.d(t,{K:function(){return u},t:function(){return p}}),n("../node_modules/regenerator-runtime/runtime.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.promise.js"),n("../node_modules/core-js/modules/es.object.assign.js");var o=n("react"),i=n.n(o),r=n("react-dom"),s=n.n(r),a=n("../spread-sheet/src/external/waterMark/utils.ts"),c=n("../spread-sheet/src/external/waterMark/watermark-generate.ts"),l=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function s(e){try{c(o.next(e))}catch(t){r(t)}}function a(e){try{c(o.throw(e))}catch(t){r(t)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((o=o.apply(e,t||[])).next())}))},d={base64Data:"",base64NickData:"",canvasHeight:793,lineHeight:0};function u(e){return void 0===e&&(e=!0),l(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n,o,r,l,u,p,h,f,m;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=document.querySelector(".excel-container"),o=document.getElementById("canvasContainerOuter"),r=n||o,(l=document.createElement("div")).id="watermark-container",(u=document.getElementById("watermark-container"))&&(null===r||void 0===r||r.removeChild(u)),null===r||void 0===r||r.appendChild(l),p=new c.sI,t.next=11,p.generate(e);case 11:return h=t.sent,t.next=14,(0,a.iY)();case 14:f=t.sent,m=f.WatermarkGenerate,s().render(i().createElement(m,Object.assign({key:"sheet-watermark-generate"},h||d)),l);case 17:case"end":return t.stop()}}),t)})))}function p(e){return void 0===e&&(e=!0),l(this,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(0,a.ec)()){t.next=3;break}return t.next=3,u(e);case 3:case"end":return t.stop()}}),t)})))}}}]),window.jsExecEndTimeStamp=Date.now(),window.cachedPerformanceEntries||(window.cachedPerformanceEntries=[]),window.cachedPerformanceEntries.push({name:"jsExec: js/bundle_plugin_common_init.76e927c3e836ef159cb9.js",entryType:"jsExec",startTime:window.jsExecStartTimeStamp,endTime:window.jsExecEndTimeStamp});
//# sourceMappingURL=bundle_plugin_common_init.76e927c3e836ef159cb9.js.map